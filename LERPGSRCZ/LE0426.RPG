     H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas LE Rollover confirmation print')                 *
     F*****************************************************************
     F*                                                               *
     F*  Midas  Customer Lending Module
     F*                                                               *
     F*  LE0426 - ROLLOVER CONFIRMATIONS PRINT                        *
     F*                                                               *
     F*  Function: This program generates rollover confirmations from *
     F*  (I/C)     the CLOAN file either on request during input cycle*
     F*  (COB)     or automatically during COB                        *
     F*                                                               *
      *  (c) Misys International Banking Systems Ltd. 2001            *
      *                                                               *
      *  Last Amend No. CGL184             Date 07Dec16               *
      *  Prev Amend No. CLE154             Date 09Aug12               *
      *                 CLE141             Date 08Feb16               *
      *                 AR996895           Date 25Nov12               *
      *                 CLE134             Date 01Aug12               *
      *                 CLE148             Date 23Jul12               *
      *                 CRE073             Date 06Dec10               *
      *                 CLE143             Date 06Dec10               *
      *                 CLE064             Date 06Dec10               *
      *                 263666             Date 01Feb10               *
      *                 CER059             Date 19Jul10               *
      *                 CER016A            Date 19May08               *
      *                 CER020             Date 19May08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *                 246141             Date 26Mar07               *
      *                 164847             Date 30Nov06               *
      *                 CRE026             Date 19Feb07               *
      *                 BUG12990           Date 05Jan07               *
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 242286             Date 25Sep06               *
      *                 CSD031             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 CLE042             Date 06Sep05               *
      *                 CIR013             Date 25Apr05               *
      *                 CAS009             Date 16May05               *
      *                 CSW037A            Date 02May05               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 CLE025             Date 20Oct03               *
      *                 CGL029             Date 01Sep03               *
      *                 CAP074             Date 08Aug02               *
      *                 CLE033             Date 02Apr03               *
      *                 CLE031             Date 18Feb03               *
      *                 CAS005             Date 16Dec02               *
      *                 CLE028             Date 27Jun02               *
      *                 CAS004             Date 26Jun02               *
      * Midas Release 4.01 -------------------------------------------*
      *                 CLE015             Date 18Dec01               *
      * Midas Release 4 --------------- Base -------------------------*
      *                 179807             Date 17May01               *
      * Midas DBA 3.05 -----------------------------------------------*
      *                 CSD006             Date 15May01               *
      *                 CLE011             Date 07Nov00               *
      * Midas DBA 3.04 -----------------------------------------------*
      * Midas DBA 3.03 -----------------------------------------------*
      *                 CIR004             Date 20Jan00               *
      * Midas DBA 3.02 -----------------------------------------------*
      *                 163486             Date 14Oct99               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 154799             Date 24Feb99               *
      *                 151295             Date 18Feb99               *
      *                 139653             Date 28Apr99               *
      *                 154455             Date 20Jan99               *
      *                 144915             Date 28Oct98               *
      *                 144688             Date 15Oct98               *
      *                 135620             Date 21May98               *
      *                 CEU020             Date 13Mar98               *
     F*                 CEU004             Date 02Feb98               *
     F*                 121768             Date 19Feb98               *
     F*                 126017             Date 17Nov97               *
     F*                 091679             DATE 30OCT97
     F*                 CLE005             DATE 22May97               *
     F*                 CLE006             DATE 02DEC96               *
     F*                 097885             DATE 31JAN97               *
     F*                 CCG008             DATE 05FEB96               *
     F*                 S01408             DATE 03JAN96               *
     F*                 095244             DATE 01NOV95               *
     F*                 095238             DATE 31OCT95               *
     F*                 S01518             DATE 03OCT94               *
     F*                 066550             DATE 04FEB94               *
     F*                 061541             DATE 09DEC93               *
     F*                 BH3453             DATE 12AUG92               *
     F*                 BH3452             DATE 30JUL92               *
     F*                 S01270             DATE 16MAY92               *
     F*                                                               *
     F*---------------------------------------------------------------*
      *                                                               *
      *  CGL184 - New Frequencies for Account Statements (Recompile)  *
      *  CLE154 - Loan Repayment Schedule Enhancement (Recompile)     *
      *  CLE141 - Currency and Location Business Day Convention       *
      *           (Recompile)                                         *
      *  AR996895 - Incorrect acrrual interest calculation            *
      *             (Child: AR996897) (Recompile)                     *
      *  CLE134 - Past Due Call Loan Processing (Recompile)           *
      *  CLE148 - Alpha Loan Reference                                *
      *  CRE073 - Interest Rate Rounding (Recompile)                  *
      *  CLE143 - Original Loan Contract Date & Effective Interest    *
      *           Rate (Recompile)                                    *
      *  CLE064 - Enhancement of Lending Frequencies (Recompile)      *
      *  263666 - Recompiled due to changes in ZINTDYZ2               *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  CER016A - German Interest Calculation: Upgarde of FGE059     *
      *            to Midas Plus (Recompile)                          *
      *  CER020 - Enhanced Rollover Window: Upgrade FGE089 to         *
      *           Midas Plus (Recompile)                              *
      *  246141 - Recompiled due to changes in ZINTDYZ2               *
      *  164847 - Recompile over changes in /COPY ZINTDYZ2.           *
      *  CRE026 - Consumer Banking                                    *
      *  BUG12990 - Recompiled due to changes in ZINTDYZ2/ZINTDYZ2LE  *
      *  242286 - Recompile over changes in /COPY ZINTDYZ2.           *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CLE042 - Extended Loan Sub Type (Recompile)                  *
      *  CIR013 - Additional Calculation Method for FRA/IRS/CCF       *
      *           Recompile over GLINTC and ZINTDY.                   *
      *  CAS009 - EIR/AC Accounting (Recompile)                       *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  CLE025 - Credit Lines (Recompile)                            *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  CAP074 - Lending API enhancements - Loans input.             *
      *  CLE033 - Settlement method 09                                *
      *  CLE031 - Lending Enhancements.                               *
      *  CAS005 - Enhancements to CAS001, CAS002 and CAS004           *
      *           (Recompile)                                         *
      *  CLE028 - Flat Rate Personal Loans (Rule of 78s)              *
      *           (Recompile)                                         *
      *  CAS004 - Hedge Accounting Phase A (Recompile)                *
      *  CLE015 - Functionality moved from Syndicated Lending to      *
      *           Customer Lending                                    *
      *  179807 - Rollover Confirmations should print on same conf    *
      *           printer as normal Loan Confirmation but is totally  *
      *           different layout and size - amended Rollover layout *
      *           to standard Deal/Loan confirmation layout; recompile*
      *           over amended PRTF/LE0426P1.                         *
      *  CSD006 - Use long DS with SDBSRTPD.                          *
      *  CLE011 - Rate Fixing Days for Lending Rollover Processing    *
      *           Recompile                                           *
      *  CIR004 - Dealing Calculation Method Change.                  *
      *         - Recompiled due to GLINTC and ZINTDY changes         *
      *  163486 - Recompiled due to changes in LVNTROL.               *
      *  154799 - Recompiled due to changes in /COPY,ZACCH            *
      *  151295 - Problems authorising repayment schedules            *
      *           Recompiled due to changes in ZCHKH                  *
     F*  139653 - Recalculation of principal in rollover confirmation *
     F*           already includes the repayment amount at the        *
     F*           rollover date. Applied fix 098946.                  *
      *  154455 - Retrieval of the RE record in LEHISTL4 causes the   *
      *           program to loop endlessly.                          *
      *  144915 - Recompiled due to changes in LF/CLOAN.              *
      *  144688 - Include all types of loan that can be rolled over.  *
      *         - Applied fix 136103.                                 *
     F*  135620 - Incorrect value for multi-ccy rollover fields       *
     F*  CEU020 - EMU Lending Multi-currency Rollover                 *
     F*  CEU004 - LE Settlement Ccy conversion Upgrade to DBA R2.0    *
     F*  121768 - Recompile over changed GLINTCZ1                     *
     F*  126017 - Correction to interest calculation for calculation  *
     F*           basis 6 in SR/GLINTC. Add SR/ZDAT10                 *
     F*  091679 - Rollover Confs not showing interest amount, and
     F*           printing 'maturity' instead of 'interest date';
     F*           currency has incorrect decimal places and is not
     F*           edited correctly. Program changed as follows:
     F*         - Use ZSEDIT instead of ZEDIT to correctly format
     F*           amounts.
     F*         - Retrieve correct currency record before editing
     F*           principal amount.
     F*         - If no interest details, show maturity date.
     F*         - Rollover events not used at all, only I2 and M2
     F*           events so amendments done to 061541, and LF/LVNTROL
     F*           changed to only select I2 and M2 events.
     F*         - Save the branch code before call to ZSFILE in single
     F*           branch environment, and reset afterwards.
     F*         - Set off *IN91 before reading events file - change
     F*           to 061541.
     F*  CLE005 - Customer Lending Enhancements - Others (T3)         *
     F*  CLE006 - Customer Lending Enhancements - Rollovers           *
     F*  097885 - Recompiled for wrong calculation of number of day   *
     F*           interest (ZINTDYZ2).                                *
     F*  CCG008 - User Defined Correspondence - Lending               *
     F*  S01408 - Addition of core hook LE0426FFP1                    *
     F*           Addition of core hook LE0426IIP1                    *
     F*           Addition of core hook LE0426CCP1                    *
     F*           Addition of core hook LE0426CCP2                    *
     F*  095244 - Recompiled for Calculation method 3                 *
     F*  095238 - Recompiled for Calculation method 3                 *
     F*  S01518 - BLI Lending SWIFT Enhancements.                     *
     F*           Recompiled over amended PF/LOAMSDK whose format is  *
     F*           used by PF/ROLRECS.                                 *
     F*  066550 - GLINTC has had historical problems and inaccuracies *
     F*           and is now externaly descibed and changed to use    *
     F*           ZINTDYZ1. See document atached to error no on GEMS  *
     F*  061541 - Error on Rollover Confirmation due to wrong details *
     F*           picked up from the previous record. NOTE: Applied   *
     F*           Fix 051432 corrected to use ETYP2 COMP 'R5', and add*
     F*           call to AOCUSTR0 for Custemer name and address.     *
     F*           (Incorp.: RTNERR declared as character of length 1, *
     F*           and database error numbers made unique)             *
     F*  BH3453 - Should have rollover date on the confirmation       *
     F*  BH3452 - Using wrong dates                                   *
     F*  S01270 - New program                                         *
     F*                                                               *
     F*****************************************************************
     F*  C R E A T I O N     P A R A M E T E R S                      *
     F*                                                               *
     F*                                                               *
     F*****************************************************************
     FLVNTROL IF  E           K        DISK                                 0085
     FLVNTROX IF  E           K        DISK                               139653
     F            LVENTELF                          KRENAMELVENTEXF       139653
     FROLRECS IF  E           K        DISK                                 0085
     FCLOAN   UF  E           K        DISK
     F            CLOANHHF                          KIGNORE
     F**********  CLOANCKF                          KIGNORE               CLE006
     F            CLOANZ1F                          KIGNORE
     F***LEHISTL4IF  E           K        DISK                     135620 154455
     F*                                                                   S01408
     F/COPY WNCPYSRC,LE0426FFP1                                           S01408
     F*                                                                   S01408
     FLE0426P1O   E                    PRINTER      KINFDS SPOOL      UC
     FLE0426AUO   E                    PRINTER      KINFDS SPOOLU
     F/EJECT
     F*
     F*    FUNCTION OF INDICATORS                                      ¦*
     F*
     F*   01 - EOF Indicator of LF/LVNTROX                            *   139653
     F*       10         Display branch name on report                 ¦*
     F*       11         No interest details available                 ¦*   0085
     F*       12         No rollover details available - report        ¦*   0085
     F*       13         First event after rollover date found         ¦* 091679
     F*   17 - Narrative from SDNOSTPD Rel. to be printed             *   CLE006
     F*   23 - FACO is blank                                          *   CLE006
     F*   24 - SPI is blank                                           *   CLE006
     F*   26 - Output Beneficiary Bank details                        *   CLE006
     F*       31         Write maturity narrative                      ¦* 091679
     F*       32         Write interest date narrative                 ¦* 091679
     F*   37 - Processing type is 66                                  *   CLE006
     F*   38 - Processing type is 67                                  *   CLE006
     F*   39 - Processing type is 70                                  *   CLE006
     F*   49 - Pay is receive and vice versa                          *   CLE006
     F*   51 - Settlement Type 01, 07, or 08                          *   CLE006
     F*   52 -                 02                                     *   CLE006
     F*   53 -                 03 or 06                               *   CLE006
     F*   54 -                 04                                     *   CLE006
     F*   56 -                 12                                     *   CLE006
     F*   57 -                 14                                     *   CLE006
     F*   60 - work                                                   *   CLE006
     F*   61 - work                                                   *   CLE006
     F*       80         BIT5 of CNFI on                               ¦*   0085
     F*       81         BIT7 of CNFI on                               ¦*   0085
     F*       85         BIT6 of CNFI on - DUPLICATE                   ¦*   0085
     F*       91         End of file/no valid record on ROLRECS/CLOAN  ¦*   0085
     F*******************************************************************
      /EJECT
     F*****************************************************************
     F*
     F* SUBROUTINES INDEX:
     F* DETAIL    Todays rollovers to be processed                          0085
     F* REQS      Requested rollover confirmations                          0085
     F* *PSSR     Error handling
     F* REPORT    Report generation for P1 report
     F* AUDIT     Audit report generation
     F* INIT      Initial processing
     F*  CALPRN - Calculates the outstanding principal as of R/O date *   139653
     F*
     F*****************************************************************
     E/EJECT
     E                    TITL1E  1   2 68               OUR Nostro       CLE006
     E                    NAME1E  1   3 50               In Title & Name  CLE006
     E                    NAME3E  1   1 50               THEIR Nos.       CLE006
     E                    AR         72  1               Narrative Set Up CLE006
     E                    ZFMD   12  12  2               ZFREQB SR.ARRAY
     E/COPY ZSRSRC,ZPOWERZ1                                                                   CLE031
     E/COPY ZSRSRC,ZDATE2Z1
     E/COPY ZSRSRC,ZHOLE
     E*COPY*ZSRSRC,ZEDITZ1*********************************************   091679
     E/COPY ZSRSRC,ZSEDITZ1                                               091679
     E*
     E**  CPY@ Array holds copyright statement for object
     E*
     E                    CPY@    1   1 80
     E/COPY ZSRSRC,ZDATE9Z1                                               066550
     E/EJECT
     ICLOANCLF                                                              0085
     I              RECI                            RECIC                   0085
     I              INTR                            INTRC                   0085
     I              CPAM                            CPAMC                   0085
     I***HISTSHPF                                                  135620 154455
     I***********   VDAT                            VDATP          135620 154455
     I***********   CCY                             CCYP           135620 154455
     I***********   AMTP                            AMTPP          135620 154455
     I***********   PRAM                            PRAMP          135620 154455
     I***********   INTA                            INTAP          135620 154455
     I***********   LTYP                            LTYPP          132620 154455
     I***********   SUTP                            SUTPP          135620 154455
     I*                                                                   CLE006
     I** Settlement details                                               CLE006
     I*                                                                   CLE006
     I            DS                                                      CLE006
     I**********                              1  27 SETTLR                             CLE006 CGL029
     I                                        1  33 SETTLR                                    CGL029
     I                                        1   20PCST                  CLE006
     I                                        1   20SETP                  CLE006
     I**********                              3  14 OPCA                               CLE006 CGL029
     I**********                              3  14 OSAC                               CLE006 CGL029
     I**********                             15  24 TSCN                               CLE006 CGL029
     I**********                             15  24 TSEN                               CLE006 CGL029
     I**********                             25  27 OPSB                               CLE006 CGL029
     I**********                             25  27 OSBR                               CLE006 CGL029
     I                                        3  20 OPCA                                      CGL029
     I                                        3  20 OSAC                                      CGL029
     I                                       21  30 TSCN                                      CGL029
     I                                       21  30 TSEN                                      CGL029
     I                                       31  33 OPSB                                      CGL029
     I                                       31  33 OSBR                                      CGL029
     I*                                                                   CLE006
     I**********                             28  54 SETTLP                             CLE006 CGL029
     I**********                             28  290SCST                               CLE006 CGL029
     I**********                             28  290MDST                               CLE006 CGL029
     I                                       34  66 SETTLP                                    CGL029
     I                                       34  350SCST                                      CGL029
     I                                       34  350MDST                                      CGL029
     I**********                             30  41 OSCA                               CLE006 CGL029
     I**********                             30  41 OMDA                               CLE006 CGL029
     I**********                             42  51 TPCN                               CLE006 CGL029
     I**********                             42  51 TMAN                               CLE006 CGL029
     I**********                             52  54 OSSB                               CLE006 CGL029
     I**********                             52  54 OMDB                               CLE006 CGL029
     I                                       36  53 OSCA                                      CGL029
     I                                       36  53 OMDA                                      CGL029
     I                                       54  63 TPCN                                      CGL029
     I                                       54  63 TMAN                                      CGL029
     I                                       64  66 OSSB                                      CGL029
     I                                       64  66 OMDB                                      CGL029
     I*                                                                   CLE006
     I**********                             55  81 SETTL1                             CLE006 CGL029
     I**********                             55  560SDST                               CLE006 CGL029
     I                                       67  99 SETTL1                                    CGL029
     I                                       67  680SDST                                      CGL029
     I**********                             57  68 OSDA                               CLE006 CGL029
     I**********                             69  78 TSTN                               CLE006 CGL029
     I**********                             79  81 OSDB                               CLE006 CGL029
     I                                       69  86 OSDA                                      CGL029
     I                                       87  96 TSTN                                      CGL029
     I                                       97  99 OSDB                                      CGL029
     I*                                                                   CLE006
     I**********                             82 108 SETTL2                             CLE006 CGL029
     I**********                             82  830RDST                               CLE006 CGL029
     I                                      100 132 SETTL2                                    CGL029
     I                                      100 1010RDST                                      CGL029
     I**********                             84  95 ORVD                               CLE006 CGL029
     I**********                             96 105 THRN                               CLE006 CGL029
     I**********                            106 108 RLBR                               CLE006 CGL029
     I                                      102 119 ORVD                                      CGL029
     I                                      120 129 THRN                                      CGL029
     I                                      130 132 RLBR                                      CGL029
     I*                                                                   CLE006
     I            DS                                                      CLE006
     I                                        1 136 TITL12                CLE006
     I                                        1  12 PAYAT                 CLE006
     I                                       13  24 VALDAT                CLE006
     I                                       25  39 MATDAT                CLE006
     I                                       40  54 TOURAC                CLE006
     I                                       55  68 FEEDUE                CLE006
     I                                       69  83 ROLDAT                CLE006
     I*                                                                   CLE006
     I            DS                                                      CLE006
     I                                        1 150 NAME12                CLE006
     I                                        1  26 INSADV                CLE006
     I                                       27  50 CRTOAC                CLE006
     I                                       28  50 DRTOAC                CLE006
     I                                       51  62 SEND                  CLE006
     I                                       63  86 WAITR                 CLE006
     I                                       64  86 SENDR                 CLE006
     I                                       87  93 ASPER                 CLE006
     I                                       87 110 PERYOR                CLE006
     I                                       88 110 PEROUR                CLE006
     I                                      111 138 YOUCOL                CLE006
     I                                      112 138 WECOL                 CLE006
     I                                      139 148 YERSEL                CLE006
     I                                      140 148 OURSEL                CLE006
     I*                                                                   CLE006
     I            DS                                                      CLE006
     I                                        1  50 NAME34                CLE006
     I                                        1  10 PAY                   CLE006
     I                                       11  30 AWAITA                CLE006
     I                                       31  50 SPINST                CLE006
     I*                                                                   CLE006
     I** Fields used in CONF subroutine                                   CLE006
     I*                                                                   CLE006
     I            DS                                                      CLE006
     I                                        1   5 KEYDS                 CLE006
     I                                        1   1 TYPE                  CLE006
     I                                        2   30N                     CLE006
     I                                        4   40P                     CLE006
     I                                        5   5 PAYREC                CLE006
     I*                                                                   CLE006
     I** Fields used in MOVEA subroutine                                  CLE006
     I*                                                                   CLE006
     I            DS                                                      CLE006
     I                                        1  72 AR                    CLE006
     I                                        1  72 ARRAY                 CLE006
     I                                       73 141 ADDDS                 CLE006
     I                                       73  740LENGTH                CLE006
     I                                       75 141 ADD                   CLE006
     I                                      142 142 BLK1                  CLE006
     I                                      142 151 BLK10                 CLE006
     I                                      142 167 BLK25                 CLE006
     I                                      142 210 BLANK                 CLE006
     I*                                                                   CLE006
     I** Fields used in NOSTRO and CPNOS subroutines                      CLE006
     I*                                                                   CLE006
     I            DS                                                      CLE006
     I**********                              1  12 NOSTRO                             CLE006 CGL029
     I                                        1   2 NOS                   CLE006
     I                                        1   6 CUSTNO                CLE006
     I                                        1   8 CPSH                  CLE006
     I                                        1  10 RETAC                 CLE006
     I**********                              7  10 AC                                 CLE006 CGL029
     I**********                             11  12 SEQ                                CLE006 CGL029
     I**********                             13  15 BRC                                CLE006 CGL029
     I**********                             16  35 CPTN                               CLE006 CGL029
     I**********                             20  20 DASH                               CLE006 CGL029
     I**********                             21  22 SEQX                               CLE006 CGL029
     I**********                             23  23 DASH2                              CLE006 CGL029
     I**********                             24  26 BRCX                               CLE006 CGL029
     I                                        1  18 NOSTRO                                    CGL029
     I                                        7  16 AC                                        CGL029
     I                                       17  18 SEQ                                       CGL029
     I                                       19  21 BRC                                       CGL029
     I                                       22  41 CPTN                                      CGL029
     I                                       32  32 DASH                                      CGL029
     I                                       33  34 SEQX                                      CGL029
     I                                       35  35 DASH2                                     CGL029
     I                                       36  38 BRCX                                      CGL029
     I*                                                                   CLE006
     I            DS                                                      CLE006
     I                                       41  46 CNUMA                 CLE006
     I**********                             41  460CNUM                               CLE006 CSD027
     I**********                             41  460ISCN                               CLE006 CSD027
     I                                       41  46 CNUM                                      CSD027
     I                                       41  46 ISCN                                      CSD027
     I*                                                                   CLE006
     I** Fields used for beneficiary bank details                         CLE006
     I*                                                                   CLE006
     I            DS                                                      CLE006
     I                                        1  30 SPI1                  CLE006
     I                                        1   3 SPEC3                 CLE006
     I                                        1   5 SPEC5                 CLE006
     I                                        6   8 SPEC8                 CLE006
     I                                        1   8 SPEC9                 CLE006
     I                                        6  12 SPEC12                CLE006
     I                                        9  14 SPEC14                CLE006
     I                                        9  17 SPEC17                CLE006
     I                                       10  18 SPEC18                CLE006
     I                                        5  29 SPEC29                CLE006
     I                                        6  30 SPEC30                CLE006
     I**
     ILDA       E DSLDA
     I* Local datarea for database errors
     I*
     IRUNDAT    E DS
     I* Rundat datarea for system information
     ISPOOL       DS
     I** File Information Data Structure
     I                                       83  92 SFILE
     I                                    B 123 1240SFNUM
     ISPOOLU      DS
     I** File Information Data Structure
     I                                       83  92 SFILEU
     I                                    B 123 1240SFNUMU
     I**
     ISDBRCH    E DSSDBRCHPD
     I**  External DS for branch code details
     I              A8BRNM                          BRNM
     ISDBANK    E DSSDBANKPD
      **  External DS for bank details
     I              BJLCCY                          LOCY                  CLE006
     I              BJURPT                          TITL
     I*
     ISDTRAD    E DSSDTRADPD
     I*  External DS for trading details
     I*
     ISDCURR    E DSSDCURRPD
     I*  External DS for currency details
     I*
     ISDCUST    E DSSDCUSTPD
     I*  External DS for customer details
     I              BBCRNM                          CRNM                  CLE006
     I              BBCSID                          CSID                  CLE006
     I              BBCRTN                          CTWN                  CLE006
     I              BBTXA1                          TELX                  CLE006
     I              BBGSFM                          GSFM                  CLE006
     I              BBSTFG                          SWTX                  CLE006
     I              QQDFAC                          DFACBK                                    CGL029
     I*
     ISDGELR    E DSSDGELRPD
     I*  External DS for general ledger details
     I              BKALDI                          ACLD
     I              BKAPFQ                          APFQ
     I              QQACCD                          ACCDB1                                    CGL029
     I*                                                                     0085
     ISDBSRT    E DSSDBSRTPD                                                0085
      **  EXTERNAL DS FOR BASE RATE DETAILS                                 0085
     I              BANBRT                          NBRT                    0085
     I              BACBSR                          BRTE                    0085
     I**                                                                  CLE006
     ISDNOST    E DSSDNOSTPD                                              CLE006
     I** Nostro records                                                   CLE006
     I              A7ORAC                          ORAC                  CLE006
     I              A7CUST                          CNUMN                 CLE006
     I              QQACCD                          ACCDB2                                    CGL029
     I**                                                                  CLE006
     ISDALTN    E DSSDALTNPD                                              CLE006
     I** Customer                                                         CLE006
     I              BCCNA1                          CNA1                  CLE006
     I              BCCNA2                          CNA2                  CLE006
     I              BCCNA3                          CNA3                  CLE006
     I              BCCNA4                          CNA4                  CLE006
     I**                                                                  CLE006
     ISDCNST    E DSSDCNSTPD                                              CLE006
     I** Counterparty nostro code                                         CLE006
     I              AWCPNM                          CPNM                  CLE006
     I*                                                                   CLE006
     ISCSARD    E DSSCSARDPD                                              CLE006
     I*  SAR Details                                                      CLE006
     I*                                                                   S01408
     I              'Through Account'     C         THRACC                CLE033
      * 'Through account' constant  for CLE033                            CLE033
     I/COPY WNCPYSRC,LE0426IIP1                                           S01408
     I*                                                                   S01408
     I*
     IDSFDY     E DSDSFDY
     I* First DS for access programs, short data structure
     I*
     I*DSSDY     E DSDSSDY
     I* Second DS for access programs, long data structure
     I*
     I            DS
     I/COPY ZSRSRC,ZHOLI
     I/COPY ZSRSRC,ZHOLDS
     I/COPY ZSRSRC,ZINTDYZ1                                               066550
     I/COPY ZSRSRC,ZDATE9Z2                                               066550
     I/COPY ZSRSRC,ZDAT10Z1                                               126017
     I/COPY ZSRSRC,ZSEDITZ2                                               091679
     C/EJECT
     C*****************************************************************
     C*
     C* Main processing
     C*
     C** Initial subroutine access to ICD records and setup of
     C** database error handling
     C*
     C                     EXSR INIT
     C*
     C** Todays rollovers to be processed                                   0085
     C*
     C                     EXSR DETAIL
     C*                                                                     0085
     C** Rollover confirmations requested during input cycle                0085
     C*                                                                     0085
     C                     EXSR REQS                                        0085
     C*
     C** Generation of audit report
     C*
     C                     EXSR AUDIT
     C*
     C** Closing of P1 report spool file before ending the program
     C*
     C                     CLOSELE0426P1
     C/COPY WNCPYSRC,LE0426C006
     C*
     C/EJECT
     C*****************************************************************
     C*
     C* DETAIL    : Produce Rollover confirmations for rollovers            0085
     C*             occurring today                                         0085
     C* CALLED BY : Main processing
     C*
     C*
     C           DETAIL    BEGSR                           *** DETAIL ***
     C*
     C** Access to ROLRECS to retrieve records with rollovers occurring     0085
     C** today                                                              0085
     C*
     C                     READ ROLRECS                  90                 0085
     C*                                                                   CCG008
     C** Process only records with Confirmation Indicator = 'Y'           CCG008
     C           *IN90     DOWEQ'0'
     C           CNFY      ANDEQ'Y'                                       CCG008
     C/COPY WNCPYSRC,LE0426C016
      *                                                                   CLE006
     C           AMTP      IFEQ 'MC'                                      CLE006
     C           CLE006    ANDEQ'Y'                                       CLE006
     C           AMTP      OREQ 'MC'                                      CEU020
     C           CEU020    ANDEQ'Y'                                       CEU020
     C           AMTP      OREQ 'MC'                                      CLE015
     C           CLE007    ANDEQ'Y'                                       CLE015
     C                     EXSR MCDET                                     CLE006
     C                     ELSE                                           CLE006
     C*                                                                     0085
     C** Move the loan reference into the report field                      0085
     C*                                                                     0085
     C**********           Z-ADDLNRF      LNRFC                                          0085 CLE148
     C**********           Z-ADDLNRF      LNRFC1  60                                     0085 CLE148
     C                     MOVELLNRF      LNRFC                                               CLE148
     C                     MOVELLNRF      LNRFC1  6                                           CLE148
     C*                                                                     0085
     C** Convert the rollover day number to a date for the from date        0085
     C*                                                                     0085
     C                     Z-ADDVDAT      ZDAYNO  50                        0085
     C                     CALL 'ZA0140'  ZDT2                              0085
     C                     MOVE ZADATE    FRDATE  7                         0085
     C                     MOVE ZADATE    DATER                           BH3452
     C/COPY WNCPYSRC,LE0426C001
     C*                                                                     0085
     C** Access the events file to get the interest record for this         0085
     C** loan in order to output the correct info to the confirmation       0085
     C*                                                                     0085
     C           LNRF      SETLLLVNTROL                                     0085
     C                     MOVE '0'       *IN11                             0085
     C                     MOVE '0'       *IN91                           091679
     C                     READ LVNTROL                  91                 0085
     C*                                                                   091679
     C** Read events file until an event is found that is dated later     091679
     C** than rollover date, or until EOF or loan number changes          091679
     C** in which case no interest details message will be printed        091679
     C*                                                                   091679
     C                     SETOF                         13               091679
     C           *IN13     DOUEQ'1'                                       091679
     C           *IN11     OREQ '1'                                       091679
     C*                                                                   091679
     C           LNRFC     IFEQ LNRF                                      091679
     C           *IN91     ANDEQ'0'                                       091679
     C           EDAT      ANDGTVDAT                                      091679
     C                     SETON                         13               091679
     C                     END                                            091679
     C*                                                                   091679
     C           LNRFC     IFNE LNRF                                      091679
     C           *IN91     OREQ '1'                                       091679
     C                     SETON                         11               091679
     C                     END                                            091679
     C*                                                                   091679
     C           *IN13     IFNE '1'                                       091679
     C           *IN11     ANDNE'1'                                       091679
     C                     READ LVNTROL                  91               091679
     C                     END                                            091679
     C*                                                                   091679
     C                     END                             END DO-UNTIL   091679
     C*                                                                   061541
     C***If*type*is*not*ROLLOVER*CHECK*-*read*next*record*which*is*t061541091679
     C***ROLLOVER*-*If*not*reset*file*to*above*record.**************061541091679
     C***********ETYP2     IFNE 'R5'                                061541091679
     C***********LNRFC     ANDEQLNRF                                061541091679
     C************IN91     ANDEQ'0'                                 061541091679
     C***********EDAT      ANDEQVDAT                                061541091679
     C***********                                                   061541091679
     C***Read*file*again*to*pick*up*ROLLOVER*details.***************061541091679
     C***********          READ LVNTROL                  91         061541091679
     C***********                                                   061541091679
     C***If*End*of*File*or*Record*for*another*loan,*or*not*ROLLOVER*061541091679
     C***or*different*Action*Date,*reset*file*to*previous*read.*****061541091679
     C***********                                                   061541091679
     C************IN91     IFEQ '1'                                 061541091679
     C***********LNRFC     ORNE LNRF                                061541091679
     C***********ETYP2     ORNE 'R5'                                061541091679
     C***********EDAT      ORNE VDAT                                061541091679
     C***********                                                   061541091679
     C***********LNRFC     SETLLLVNTROL                             061541091679
     C***********          MOVE '0'       *IN11                     061541091679
     C***********          READ LVNTROL                  91         061541091679
     C***********                                                   061541091679
     C***********          END                                      061541091679
     C***********          END                                      061541091679
     C*                                                                     0085
     C** If there is a record process the details for the report            0085
     C** otherwise output a message that the interest details are           0085
     C** not known                                                          0085
     C*                                                                     0085
     C************IN91     IFEQ '0'                                   0085091679
     C***********LNRFC     ANDEQLNRF                                  0085091679
     C           *IN13     IFEQ '1'                                       091679
     C**
     C* Access clients name and address from SDCUSTPD
     C**
     C                     MOVE *BLANKS   KEYC1
     C                     MOVE CUNR      KEYC1                             0085
     C                     CALL 'AOCUSTR0'
     C                     PARM '*BLANKS' @RTCD
     C                     PARM '*KEY   ' @OPTN
     C                     PARM           KEYC1  10
     C                     PARM           KEYSTS  7
     C           SDCUST    PARM SDCUST    DSSDY
     C**
     C           @RTCD     IFNE *BLANKS
     C           *LOCK     IN   LDA
     C                     MOVELCUNR      DBKEY            ************     0085
     C                     MOVEL'SDCUSTPD'DBFILE           * DBERR 03 *
     C                     Z-ADD3         DBASE            ************
     C                     OUT  LDA
     C*
     C                     EXSR *PSSR
     C                     EXSR AUDIT
     C                     END
     C*
     C** Access currency name and decimal places from SDCURRPD
     C*
     C                     MOVE ECCY      @AJCD                             0085
     C*
     C                     CALL 'AOCURRR0'
     C                     PARM '*MSG   ' @RTCD   7
     C                     PARM '*KEY   ' @OPTN   7
     C                     PARM           @AJCD   3
     C           SDCURR    PARM SDCURR    DSSDY
     C*
     C** Error Processing
     C*
     C           @RTCD     IFNE *BLANKS
     C           *LOCK     IN   LDA
     C                     MOVEL'SDCURRPD'DBFILE           ************
     C                     Z-ADD4         DBASE            * DBERR 04 *
     C                     MOVEL@OPTN     DBOPTN  7        ************
     C                     MOVEL@AJCD     DBKEY
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     EXSR AUDIT
     C                     END
     C*
     C                     MOVE @AJCD     CCY2
     C                     Z-ADDA6NBDP    DNUM    10
     C                     MOVE A6CYNM    CNAME  14
     C*                                                                     0085
     C** Convert the interest outstanding amount to allow for the no.       0085
     C** of decimal places on the report                                    0085
     C*                                                                     0085
     C/COPY WNCPYSRC,LE0426C013
     C***********          MOVE EAMT      ZFIELD 16                   0085091679
     C***********          Z-ADDDNUM      ZADEC   10                  0085091679
     C***********          EXSR ZEDIT                                 0085091679
     C***********          MOVE ZFIELD    ZINTRA 16                   0085091679
     C*                                                                   091679
     C                     MOVE EAMT      ZFLD15                          091679
     C                     Z-ADDDNUM      ZDECS                           091679
     C                     MOVE 'J'       ZECODE                          091679
     C                     EXSR ZSEDIT                                    091679
     C                     MOVE ZOUT21    ZINTRA 21                       091679
     C*                                                                     0085
     C***Convert*the*event*day*(ie*interest*payment*date*or*rollover*0085 091679
     C***date*as*appears*on*the*event*record)*to*a*date**************0085 091679
     C************                                                   0085 091679
     C************         Z-ADDEDAT      ZDAYNO                     0085 091679
     C************         CALL 'ZA0140'  ZDT2                       0085 091679
     C************         MOVE ZADATE    TODATE                     0085 091679
      *                                                                   144688
     C           PTYP      IFEQ 61                                        144688
     C           PTYP      OREQ 68                                        144688
     C           PTYP      OREQ 69                                        144688
     C           NIDT      IFEQ *ZEROS                                    144688
     C           MDAT      ANDEQ*ZEROS                                    144688
     C                     Z-ADD*ZERO     ZDAYNO                          144688
     C                     MOVEL*BLANKS   ZINTRA                          144688
     C                     ENDIF                                          144688
     C                     ENDIF                                          144688
     C*                                                                     0085
     C** Access CLOAN record for the current principal amount (after        0085
     C** all todays events have been processed as they will have been       0085
     C** taken into accoutn in the interest calculations)                   0085
     C*                                                                     0085
     C           LNRF      CHAINCLOAN                72                     0085
     C*                                                                     0085
     C** Convert the event day (ie interest payment date or rollover      091679
     C** date as appears on the event record) to a date                   091679
     C** If no event date then use the maturity date                      091679
     C*                                                                   091679
     C                     SELEC                                          091679
     C           EDAT      WHNE *ZERO                                     091679
     C                     Z-ADDEDAT      ZDAYNO                          091679
     C           MDAT      WHNE *ZERO                                     091679
     C                     Z-ADDMDAT      ZDAYNO                          091679
     C                     OTHER                                          091679
     C                     Z-ADD*ZERO     ZDAYNO                          091679
     C                     ENDSL                                          091679
      *                                                                   091679
     C           ZDAYNO    IFNE *ZERO                                     091679
     C                     CALL 'ZA0140'  ZDT2                            091679
     C                     MOVE ZADATE    TODATE                          091679
     C                     ELSE                                           091679
     C                     MOVE *BLANKS   TODATE                          091679
     C                     END                                            091679
     C*                                                                     0085
     C** Set up the interest field for the report - as the rollover         0085
     C** has already aoccurred, this comes directly from the CLOAN          0085
     C** record                                                             0085
     C*                                                                     0085
     C                     Z-ADDINTR      FRATE  117                        0085
     C*                                                                     0085
     C** Convert the current principal amount to allow for the number       0085
     C** of decimal places on the report                                    0085
     C*                                                                     0085
     C/COPY WNCPYSRC,LE0426C014
     C***********          MOVE CPAMC     ZFIELD 16                   0085091679
     C***********          Z-ADDDNUM      ZADEC   10                  0085091679
     C***********          EXSR ZEDIT                                 0085091679
     C***********          MOVE ZFIELD    CPAMA  16                   0085091679
     C*                                                                     0085
     C                     MOVE CPAMC     ZFLD15                          091679
     C                     Z-ADDDNUM      ZDECS                           091679
     C                     MOVE 'J'       ZECODE                          091679
     C                     EXSR ZSEDIT                                    091679
     C                     MOVE ZOUT21    CPAMA  21                       091679
     C*                                                                     0085
     C** Before the report is output determine which sort of record       091679
     C** it is for the narrative                                          091679
     C*                                                                   091679
     C           ETYP2     IFEQ 'I2'                                      091679
     C                     MOVE '1'       *IN32                           091679
     C                     MOVE '0'       *IN31                           091679
     C                     ELSE                                           091679
     C                     MOVE '0'       *IN32                           091679
     C                     MOVE '1'       *IN31                           091679
     C                     END                                            091679
     C*                                                                   091679
     C** Else if there are no interest details on the events file           0085
     C** output a message to that effect                                    0085
     C*                                                                     0085
     C                     ELSE                                             0085
     C*                                                                   061541
     C** Access clients name and address from SDCUSTPD                    061541
     C*                                                                   061541
     C                     MOVE *BLANKS   KEYC1                           061541
     C                     MOVE CNUM      KEYC1                           061541
     C                     CALL 'AOCUSTR0'                                061541
     C                     PARM '*BLANKS' @RTCD                           061541
     C                     PARM '*KEY   ' @OPTN                           061541
     C                     PARM           KEYC1  10                       061541
     C                     PARM           KEYSTS  7                       061541
     C           SDCUST    PARM SDCUST    DSSDY                           061541
     C*                                                                   061541
     C           @RTCD     IFNE *BLANKS                                   061541
     C           *LOCK     IN   LDA                                       061541
     C                     MOVELCNUM      DBKEY            ************   061541
     C                     MOVEL'SDCUSTPD'DBFILE           * DBERR 07 *   061541
     C                     Z-ADD7         DBASE            ************   061541
     C                     OUT  LDA                                       061541
     C*                                                                   061541
     C                     EXSR *PSSR                                     061541
     C                     EXSR AUDIT                                     061541
     C                     END                                            061541
     C*                                                                   061541
     C** Access CLOAN record for the current principal amount (after      061541
     C** all todays events have been processed as they will have been     061541
     C** taken into account in the interest calculations)                 061541
     C*                                                                   061541
     C           LNRFC     CHAINCLOAN                72                   061541
     C*                                                                   061541
     C***Convert*the*Rollover Date into DDMMMYY Date format         061541091679
     C** Convert the Maturity Date into DDMMMYY Date format               091679
     C*                                                                   061541
     C************         Z-ADDRLDT      ZDAYNO                    061541091679
     C                     Z-ADDMDAT      ZDAYNO                          091679
     C           ZDAYNO    IFNE *ZERO                                     091679
     C                     CALL 'ZA0140'  ZDT2                            061541
     C                     MOVE ZADATE    TODATE                          061541
     C                     ELSE                                           091679
     C                     MOVE *BLANKS   TODATE                          091679
     C                     END                                            091679
     C/COPY WNCPYSRC,LE0426C002
     C*                                                                   061541
     C** Set up the interest field for the report - as the rollover       061541
     C** has already occurred, this comes directly from the CLOAN         061541
     C** record                                                           061541
     C*                                                                   061541
     C                     Z-ADDINTRC     FRATE  117                      061541
     C*                                                                   061541
     C***Convert*the*current*principal*amount*to*allow*for*the*numb061541 091679
     C***of*decimal*places*on*the*report***************************061541 091679
     C***********                                                  061541 091679
     C***********          MOVE CPAMC     ZFIELD 16                061541 091679
     C***********          Z-ADDDNUM      ZADEC   10               061541 091679
     C***********          EXSR ZEDIT                              061541 091679
     C***********          MOVE ZFIELD    CPAMA  16                061541 091679
     C*                                                                   061541
     C** Access currency name and decimal places from SDCURRPD            061541
     C*                                                                   061541
     C                     MOVE CCY       @AJCD                           061541
     C*                                                                   061541
     C                     CALL 'AOCURRR0'                                061541
     C                     PARM '*MSG   ' @RTCD   7                       061541
     C                     PARM '*KEY   ' @OPTN   7                       061541
     C                     PARM           @AJCD   3                       061541
     C           SDCURR    PARM SDCURR    DSSDY                           061541
     C*                                                                   061541
     C** Error Processing                                                 061541
     C*                                                                   061541
     C           @RTCD     IFNE *BLANKS                                   061541
     C           *LOCK     IN   LDA                                       061541
     C                     MOVEL'SDCURRPD'DBFILE           ************   061541
     C                     Z-ADD8         DBASE            * DBERR 08 *   061541
     C                     MOVEL@OPTN     DBOPTN  7        ************   061541
     C                     MOVEL@AJCD     DBKEY                           061541
     C                     OUT  LDA                                       061541
     C                     EXSR *PSSR                                     061541
     C                     EXSR AUDIT                                     061541
     C                     END                                            061541
     C*                                                                   061541
     C                     MOVE @AJCD     CCY2                            061541
     C                     Z-ADDA6NBDP    DNUM    10                      061541
     C                     MOVE A6CYNM    CNAME  14                       061541
     C*                                                                   091679
     C** Convert the current principal amount to allow for the number     091679
     C** of decimal places on the report                                  091679
     C*                                                                   091679
     C/COPY WNCPYSRC,LE0426C015
     C                     MOVE CPAMC     ZFLD15                          091679
     C                     Z-ADDDNUM      ZDECS                           091679
     C                     MOVE 'J'       ZECODE                          091679
     C                     EXSR ZSEDIT                                    091679
     C                     MOVE ZOUT21    CPAMA                           091679
     C*                                                                   091679
     C                     MOVE '1'       *IN11                             0085
     C*                                                                     0085
     C** and reset the fields from the last record output                   0085
     C*                                                                     0085
     C                     MOVE *BLANKS   ZINTRA                            0085
     C*                                                                   091679
     C** when no interest details, set on 31 to write maturity            091679
     C** narrative.                                                       091679
     C*                                                                   091679
     C***********          SETOF                     3132             0085091679
     C                     SETOF                       32                 091679
     C                     SETON                     31                   091679
     C*                                                                   091679
     C                     END                                              0085
     C*                                                                     0085
     C***Before*the*report*is*output*determine*which*sort*of*record***0085091679
     C***it*is*for*the*narrative**************************************0085091679
     C*                                                                     0085
     C***********ETYP2     IFEQ 'I2'                                  0085091679
     C***********ETYP2     OREQ 'R2'                                  0085091679
     C***********          MOVE '1'       *IN32                       0085091679
     C***********          MOVE '0'       *IN31                       0085091679
     C***********          ELSE                                       0085091679
     C***********          MOVE '0'       *IN32                       0085091679
     C***********          MOVE '1'       *IN31                       0085091679
     C***********          END                                        0085091679
      *                                                                                       CLE031
     C           CLE031    IFEQ 'Y'                                                           CLE031
      *                                                                                       CLE031
     C           PTYP      IFNE 66                                                            CLE031
     C           PTYP      ANDNE67                                                            CLE031
     C           PTYP      ANDNE69                                                            CLE031
     C           PTYP      ANDNE72                                                            CLE031
      *                                                                                       CLE031
     C                     MOVE CCY       @CYCD   3                                           CLE031
     C           PSCY      IFNE *BLANKS                                                       CLE031
     C           PSCY      ANDNECCY                                                           CLE031
     C                     MOVE PSCY      @SYCD   3                                           CLE031
     C                     MOVE PEXR      FCXR   138                                          CLE031
     C                     MOVE PEXI      FMDI    1                                           CLE031
     C                     EXSR SRCONV                                                        CLE031
     C                     MOVE WAMTA     RCONA                                               CLE031
     C                     MOVE @SYCD     RSPCY                                               CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
     C                     ELSE                                                               CLE031
      *                                                                                       CLE031
     C           SCCY      IFNE *BLANKS                                                       CLE031
     C           SCCY      ANDNECCY                                                           CLE031
     C                     MOVE SCCY      @SYCD                                               CLE031
     C                     MOVE REXR      FCXR   138                                          CLE031
     C                     MOVE REXI      FMDI    1                                           CLE031
     C                     EXSR SRCONV                                                        CLE031
     C                     MOVE WAMTA     RCONA                                               CLE031
     C                     MOVE @SYCD     RSPCY                                               CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
     C                     ENDIF                                                              CLE031
     C                     ENDIF                                                              CLE031
     C**
     C* Generate the confirmation
     C**
     C                     EXSR REPORT
     C*******************************                                       0085
     C**End*for*generating*the*report                                       0085
     C*******************************                                       0085
     C*********************END                                              0085
     C**
     C                     ENDIF                                          CLE006
     C/COPY WNCPYSRC,LE0426C017
      *                                                                   CLE006
     C* Next read of ROLRECS                                                0085
     C**
     C                     READ ROLRECS                  90                 0085
     C**
     C* End of ROLRECS do loop                                              0085
     C**
     C                     END
     C**
     C                     ENDSR
     C**
     C/EJECT
     C*****************************************************************     0085
     C*                                                                     0085
     C* REQS      : Produce Rollover confirmations for rollovers            0085
     C*             requested today                                         0085
     C* CALLED BY : Main processing                                         0085
     C*                                                                     0085
     C*                                                                     0085
     C           REQS      BEGSR                           *** REQS   ***   0085
     C*                                                                     0085
     C** Access to CLOAN to retrievs records with CNFI bits set for a       0085
     C** confirmation to be generated today                                 0085
     C*                                                                     0085
     C           *LOVAL    SETLLCLOAN                                       0085
     C                     READ CLOAN                    90                 0085
     C           *IN90     DOWEQ'0'                                         0085
     C/COPY WNCPYSRC,LE0426C018
     C*                                                                     0085
     C                     TESTB'5'       CNFI           80                 0085
     C                     TESTB'7'       CNFI           81                 0085
     C                     TESTB'6'       CNFI           85                 0085
     C*                                                                     0085
     C           *IN80     IFEQ '1'                                         0085
     C           *IN81     ANDEQ'0'                                         0085
     C*                                                                     0085
     C** Move the loan reference into the report field                      0085
     C*                                                                     0085
     C**********           Z-ADDLNRF      LNRFC                                          0085 CLE148
     C**********           Z-ADDLNRF      LNRFC1                                       BH3452 CLE148
     C                     MOVELLNRF      LNRFC                                               CLE148
     C                     MOVELLNRF      LNRFC1                                              CLE148
     C*                                                                     0085
     C** Convert the rollover day number to a date for the from date        0085
     C*                                                                     0085
     C                     Z-ADDRLDT      ZDAYNO                            0085
     C                     CALL 'ZA0140'  ZDT2                              0085
     C                     MOVE ZADATE    FRDATE                            0085
     C                     MOVE ZADATE    DATER                           BH3452
     C/COPY WNCPYSRC,LE0426C003
     C*                                                                     0085
     C** Set up the interest field for the report - if there are no         0085
     C** rollover details entered the rate will be the current one          0085
     C*                                                                     0085
     C           NBRA      IFEQ 0                                           0085
     C           NRTS      ANDEQ0                                           0085
     C                     MOVE '1'       *IN12                             0085
     C                     ELSE                                             0085
     C                     MOVE '0'       *IN12                             0085
     C                     END                                              0085
     C*                                                                     0085
     C           NBRA      IFNE 0                                           0085
     C                     MOVE CCY       KEY1                              0085
     C                     MOVE NBRA      KEY2                              0085
     C                     CALL 'AOBSRTR0'PLIST1                            0085
     C           @RTCD     IFNE *BLANKS                                     0085
     C           *LOCK     IN   LDA                                         0085
     C*                                                    ***************  0085
     C                     Z-ADD6         DBASE            ** DBERR 06  **  0085
     C                     MOVELKEY1      DBKEY            ***************  0085
     C                     MOVE NBRA      DBKEY                             0085
     C                     MOVE 'SDBSRTPD'DBFILE                            0085
     C                     SETON                     U7U8LR                 0085
     C                     OUT  LDA                                         0085
     C                     EXSR *PSSR                                       0085
     C                     EXSR AUDIT                                       0085
     C*                                                                     0085
     C                     END                                              0085
     C*                                                                     0085
     C** Add the base rate and spread if the spread indicator is 'A'        0085
     C** for add                                                            0085
     C*                                                                     0085
     C           NSIN      IFEQ 'A'                                         0085
     C           NBRT      ADD  NRTS      FRATE                             0085
     C                     ELSE                                             0085
     C**                                                                    0085
     C* Subtract the spread from the base rate if the spread indicator      0085
     C* is 'S' for subtract                                                 0085
     C**                                                                    0085
     C           NSIN      IFEQ 'S'                                         0085
     C           NBRT      SUB  NRTS      FRATE                             0085
     C                     ELSE                                             0085
     C*                                                                     0085
     C** Use the spread as a percentage of the base rate if the             0085
     C** indicator is 'P' for percentage                                    0085
     C*                                                                     0085
     C           NSIN      IFEQ 'P'                                         0085
     C           NRTS      DIV  100       WRK139 139                        0085
     C           WRK139    MULT NBRT      FRATE                             0085
     C** End for percentage                                                 0085
     C                     END                                              0085
     C** End for subtract                                                   0085
     C                     END                                              0085
     C** End for add                                                        0085
     C                     END                                              0085
     C*                                                                     0085
     C                     ELSE                                             0085
     C**                                                                    0085
     C* Use the spread/rate as the rate if the base code is blank           0085
     C**                                                                    0085
     C                     Z-ADDNRTS      FRATE                             0085
     C** End for check of which rate details to use                         0085
     C                     END                                              0085
     C***********                                                         BH3452
     C***Convert*the current principal amount to allow for the number     BH3452
     C***of*decimal places on the report                                  BH3452
     C***********                                                         BH3452
     C***********          MOVE CPAMC     ZFIELD 16                       BH3452
     C***********          Z-ADDDNUM      ZADEC   10                      BH3452
     C***********          EXSR ZEDIT                                     BH3452
     C***********          MOVE ZFIELD    CPAMA  16                       BH3452
     C*                                                                     0085
     C** Access the events file to get the interest record for this         0085
     C** loan in order to output the correct info to the confirmation       0085
     C*                                                                     0085
     C           LNRF      SETLLLVNTROL                                     0085
     C                     MOVE '0'       *IN11                             0085
     C                     MOVE '0'       *IN91                           091679
     C***********          READ LVNTROL                  11           0085091679
     C                     READ LVNTROL                  91               091679
      *                                                                   091679
      * Read events file until an event is found that is dated later      091679
      * than rollover date, or until EOF or loan number changes           091679
      * in which case no interest details message will be printed         091679
     C                     SETOF                         13               091679
     C           *IN13     DOUEQ'1'                                       091679
     C           *IN11     OREQ '1'                                       091679
      *                                                                   091679
     C           LNRFC     IFEQ LNRF                                      091679
     C           *IN91     ANDEQ'0'                                       091679
     C           EDAT      ANDGTRLDT                                      091679
     C                     SETON                         13               091679
     C                     END                                            091679
     C*                                                                   091679
     C           LNRFC     IFNE LNRF                                      091679
     C           *IN91     OREQ '1'                                       091679
     C                     SETON                         11               091679
     C                     END                                            091679
     C*                                                                   091679
     C           *IN13     IFNE '1'                                       091679
     C           *IN11     ANDNE'1'                                       091679
     C                     READ LVNTROL                  91               091679
     C                     END                                            091679
     C*                                                                   091679
     C                     END                             END DO-UNTIL   091679
     C*                                                                     0085
     C** If there is a record process the details for the report            0085
     C** otherwise output a message that the interest details are           0085
     C** not known                                                          0085
     C*                                                                     0085
     C************IN11     DOWEQ'0'                                   0085091679
     C***********PROCS     ANDEQ' '                                   0085091679
     C           *IN13     IFEQ '1'                                       091679
     C*                                                                     0085
     C***Check*that*the*date*of*the*interest*event*is*after*the*******0085091679
     C***rollover*date************************************************0085091679
     C*                                                                     0085
     C***********RLDT      IFLT EDAT                                  0085091679
     C***********          MOVE 'Y'       PROCS   1                   0085091679
     C**                                                                    0085
     C* Access clients name and address from SDCUSTPD                       0085
     C**                                                                    0085
     C                     MOVE *BLANKS   KEYC1                             0085
     C                     MOVE CUNR      KEYC1                             0085
     C                     CALL 'AOCUSTR0'                                  0085
     C                     PARM '*BLANKS' @RTCD                             0085
     C                     PARM '*KEY   ' @OPTN                             0085
     C                     PARM           KEYC1  10                         0085
     C                     PARM           KEYSTS  7                         0085
     C           SDCUST    PARM SDCUST    DSSDY                             0085
     C**                                                                    0085
     C           @RTCD     IFNE *BLANKS                                     0085
     C           *LOCK     IN   LDA                                         0085
     C                     MOVELCUNR      DBKEY            ************     0085
     C***********          MOVEL'SDCUSTPD'DBFILE           **DBERR*03*0085061541
     C***********          Z-ADD3         DBASE            ***********0085061541
     C                     MOVEL'SDCUSTPD'DBFILE           * DBERR 09 *   061541
     C                     Z-ADD9         DBASE            ************   061541
     C                     OUT  LDA                                         0085
     C*                                                                     0085
     C                     EXSR *PSSR                                       0085
     C                     EXSR AUDIT                                       0085
     C                     END                                              0085
     C*                                                                     0085
     C** Access currency name and decimal places from SDCURRPD              0085
     C*                                                                     0085
     C                     MOVE ECCY      @AJCD                             0085
     C*                                                                     0085
     C                     CALL 'AOCURRR0'                                  0085
     C                     PARM '*MSG   ' @RTCD   7                         0085
     C                     PARM '*KEY   ' @OPTN   7                         0085
     C                     PARM           @AJCD   3                         0085
     C           SDCURR    PARM SDCURR    DSSDY                             0085
     C*                                                                     0085
     C** Error Processing                                                   0085
     C*                                                                     0085
     C           @RTCD     IFNE *BLANKS                                     0085
     C           *LOCK     IN   LDA                                         0085
     C                     MOVEL'SDCURRPD'DBFILE           ************     0085
     C***********          Z-ADD4         DBASE            **DBERR*04*0085061541
     C                     Z-ADD10        DBASE            * DBERR 10 *   061541
     C                     MOVEL@OPTN     DBOPTN  7        ************     0085
     C                     MOVEL@AJCD     DBKEY                             0085
     C                     OUT  LDA                                         0085
     C                     EXSR *PSSR                                       0085
     C                     EXSR AUDIT                                       0085
     C                     END                                              0085
     C*                                                                     0085
     C                     MOVE @AJCD     CCY2                              0085
     C                     Z-ADDA6NBDP    DNUM    10                        0085
     C                     MOVE A6CYNM    CNAME  14                         0085
     C*                                                                     0085
     C** Convert the interest outstanding amount to allow for the no.       0085
     C** of decimal places on the report                                    0085
     C*                                                                     0085
     C***********          MOVE EAMT      ZFIELD 16                   0085091679
     C***********          Z-ADDDNUM      ZADEC   10                  0085091679
     C***********          EXSR ZEDIT                                 0085091679
     C***********          MOVE ZFIELD    ZINTRA 16                   0085091679
     C*                                                                   091679
     C                     MOVE EAMT      ZFLD15                          091679
     C                     Z-ADDDNUM      ZDECS                           091679
     C                     MOVE 'J'       ZECODE                          091679
     C                     EXSR ZSEDIT                                    091679
     C                     MOVE ZOUT21    ZINTRA 21                       091679
     C*                                                                     0085
     C** Convert the event day (ie interest payment date or rollover        0085
     C** date as appears on the event record) to a date                     0085
     C** If no event date then use the maturity date                      091679
     C*                                                                     0085
     C                     SELEC                                          091679
     C           EDAT      WHNE *ZERO                                     091679
     C                     Z-ADDEDAT      ZDAYNO                            0085
     C           MDAT      WHNE *ZERO                                     091679
     C                     Z-ADDMDAT      ZDAYNO                          091679
     C                     OTHER                                          091679
     C                     Z-ADD*ZERO     ZDAYNO                          091679
     C                     ENDSL                                          091679
      *                                                                   144688
     C           PTYP      IFEQ 61                                        144688
     C           PTYP      OREQ 68                                        144688
     C           PTYP      OREQ 69                                        144688
     C           NIDT      IFEQ *ZEROS                                    144688
     C           MDAT      ANDEQ*ZEROS                                    144688
     C                     Z-ADD*ZERO     ZDAYNO                          144688
     C                     MOVEL*BLANKS   ZINTRA                          144688
     C                     ENDIF                                          144688
     C                     ENDIF                                          144688
      *                                                                   091679
     C           ZDAYNO    IFNE *ZERO                                     091679
     C                     CALL 'ZA0140'  ZDT2                              0085
     C                     MOVE ZADATE    TODATE                            0085
     C                     ELSE                                           091679
     C                     MOVE *BLANKS   TODATE                          091679
     C                     END                                            091679
     C/COPY WNCPYSRC,LE0426C004
     C*                                                                   BH3452
     C** Convert the current principal amount to allow for the number     BH3452
     C** of decimal places on the report                                  BH3452
     C*                                                                   BH3452
     C***********          MOVE CPAMC     ZFIELD 16                 BH3452091679
     C***********          Z-ADDDNUM      ZADEC   10                BH3452091679
     C***********          EXSR ZEDIT                               BH3452091679
     C***********          MOVE ZFIELD    CPAMA  16                 BH3452091679
     C*                                                                   091679
      *                                                                   139653
      ** Calculate for oustanding principal as of rollover date.          139653
      *                                                                   139653
     C                     EXSR CALPRN                                    139653
      *                                                                   139653
     C***********          MOVE CPAMC     ZFLD15                   091679 139653
     C                     MOVE @CPAMC    ZFLD15                          139653
     C                     Z-ADDDNUM      ZDECS                           091679
     C                     MOVE 'J'       ZECODE                          091679
     C                     EXSR ZSEDIT                                    091679
     C                     MOVE ZOUT21    CPAMA  21                       091679
     C*                                                                     0085
     C***If*the*rollover*date*is*later*than*the*interest*date*read****0085091679
     C***the*next*record**********************************************0085091679
     C*                                                                     0085
     C***********          ELSE                                       0085091679
     C***********          READ LVNTROL                  11           0085091679
     C***********LNRF      IFNE LNRFC                                 0085091679
     C***********          MOVE '1'       *IN11                       0085091679
     C***********          END                                        0085091679
     C***********          END                                        0085091679
     C*                                                                     0085
     C***********          END                                        0085091679
     C**                                                                    0085
     C* Generate the confirmation                                           0085
     C**                                                                    0085
     C                     MOVE 'Y'       REQ     1                         0085
     C*                                                                     0085
     C** Before the report is output determine which sort of record         0085
     C** it is for the narrative                                            0085
     C*                                                                     0085
     C************IN11     IFEQ '0'                                   0085091679
     C           ETYP2     IFEQ 'I2'                                        0085
     C                     MOVE '1'       *IN32                             0085
     C                     MOVE '0'       *IN31                             0085
     C                     ELSE                                             0085
     C                     MOVE '0'       *IN32                             0085
     C                     MOVE '1'       *IN31                             0085
     C                     END                                              0085
     C                     ELSE                                             0085
     C*                                                                     0085
     C** and reset the fields from the last record output                   0085
     C*                                                                     0085
     C                     MOVE *BLANKS   ZINTRA                            0085
     C                     SETOF                     3132                   0085
     C                     END                                              0085
     C*                                                                     0085
     C                     EXSR REPORT                                      0085
     C                     MOVE ' '       REQ                               0085
     C***********          MOVE ' '       PROCS                       0085091679
     C**                                                                    0085
     C* End for generating the report                                       0085
     C**                                                                    0085
     C                     END                                              0085
     C/COPY WNCPYSRC,LE0426C019
     C**                                                                    0085
     C* Next read of CLOAN                                                  0085
     C**                                                                    0085
     C                     READ CLOAN                    90                 0085
     C**                                                                    0085
     C* End of CLOAN do loop                                                0085
     C**                                                                    0085
     C                     END                                              0085
     C**                                                                    0085
     C                     ENDSR                                            0085
     C**                                                                    0085
     C*****************************************************************     0085
     C/EJECT                                                              CLE006
     C*****************************************************************   CLE006
     C*                                                               *   CLE006
     C* MCDET - Multicurrency Rollover Processing                     *   CLE006
     C* CALLED BY: DETAIL                                             *   CLE006
     C*                                                               *   CLE006
     C*****************************************************************   CLE006
     C           MCDET     BEGSR                                          CLE006
      *                                                                   CLE006
      ** Chain to CLOAN to get other report details                       CLE006
      *                                                                   CLE006
     C                     MOVE CCY       WOCCY   3                       CEU020
     C***********          MOVE VDAT      VDATSV  50               135620 154455
     C                     Z-ADDVDAT      VDATSV  50                      154455
     C           LNRF      CHAINCLOANCLF             72                   CLE006
     C     N72   LNRF      CHAINCLOANCKF             72                   CLE006
      *                                                                   CLE006
     C           PTYP      COMP 66                       37               CLE006
     C           PTYP      COMP 67                       38               CLE006
     C           PTYP      COMP 70                       39               CLE006
      *                                                                   CLE005
     C           PTYP      IFEQ 69                                        CLE005
     C           CLE005    ANDEQ'Y'                                       CLE005
     C                     MOVE '1'       *IN37                           CLE005
     C                     ENDIF                                          CLE005
      *                                                                   CLE006
      ***Setup*the*'REF'*field*with*the*loan*reference*and*the*****CLE006 179807
      ***customer*number*******************************************CLE006 179807
      **********                                                   CLE006 179807
     C**********           MOVELLNRF      W0REF   7                CLE006 179807
     C**********           MOVE '-'       W0REF                    CLE006 179807
     C**********           MOVELW0REF     RREF                     CLE006 179807
     C**********           MOVE CNUM      RREF                     CLE006 179807
      *                                                                   CLE006
      ** Convert the rollover day number to a date for the 'From' date    CLE006
      *                                                                   CLE006
     C                     Z-ADDVDATSV    RLDT                            154455
     C                     Z-ADDRLDT      ZDAYNO                          CLE006
     C                     EXSR ZDATE2                                    CLE006
     C                     MOVE ZADATE    RFRDT                           CLE006
      *                                                                   CLE006
      ** If the next rollover day number is not zero, convert it to a     CLE006
      ** date for the 'To' date.  Else, use the maturity date.            CLE006
      *                                                                   CLE006
     C           NROD      IFNE *ZEROS                                    CLE006
     C                     Z-ADDNROD      ZDAYNO                          CLE006
     C           NIPD      IFNE *ZEROS                                    CLE006
     C           NIPD      ANDNERLDT                                      CLE006
     C           NIPD      ANDLTZDAYNO                                    CLE006
     C                     Z-ADDNIPD      ZDAYNO                          CLE006
     C                     ENDIF                                          CLE006
     C           NIDT      IFNE *ZEROS                                    CLE006
     C           NIDT      ANDNERLDT                                      CLE006
     C           NIDT      ANDLTZDAYNO                                    CLE006
     C                     Z-ADDNIDT      ZDAYNO                          CLE006
     C                     ENDIF                                          CLE006
     C                     ELSE                                           CLE006
     C                     Z-ADDMDAT      ZDAYNO                          CLE006
     C           NMDT      IFNE *ZEROS                                    CLE006
     C           MDAT      ANDEQRLDT                                      CLE006
     C                     Z-ADDNMDT      ZDAYNO                          CLE006
     C                     ENDIF                                          CLE006
     C           NIPD      IFNE *ZEROS                                    CLE006
     C           NIPD      ANDNERLDT                                      CLE006
     C           NIPD      ANDLTZDAYNO                                    CLE006
     C                     Z-ADDNIPD      ZDAYNO                          CLE006
     C                     ENDIF                                          CLE006
     C           NIDT      IFNE *ZEROS                                    CLE006
     C           NIDT      ANDNERLDT                                      CLE006
     C           NIDT      ANDLTZDAYNO                                    CLE006
     C                     Z-ADDNIDT      ZDAYNO                          CLE006
     C                     ENDIF                                          CLE006
     C                     END                                            CLE006
     C                     EXSR ZDATE2                                    CLE006
     C                     MOVE ZADATE    RTODT                           CLE006
      *                                                                   CLE006
      ** Set up 'Maturity Date'                                           CLE006
      *                                                                   CLE006
     C                     MOVE '       ' OMDAT   7                       CLE006
     C           MDAT      IFNE *ZEROS                                    CLE006
     C                     Z-ADDMDAT      ZDAYNO                          CLE006
     C           NMDT      IFNE 0                                         CLE006
     C           NMDT      ANDGTMDAT                                      CLE006
     C                     Z-ADDNMDT      ZDAYNO                          CLE006
     C                     ENDIF                                          CLE006
     C                     EXSR ZDATE2                                    CLE006
     C                     MOVE ZADATE    OMDAT                           CLE006
     C                     ELSE                                           CLE006
     C                     MOVEL'AT CALL' OMDAT                           CLE006
     C                     ENDIF                                          CLE006
      *                                                                   CLE006
      ** Add Narrative 'Participation' if Sold or Purchased               CLE006
      *                                                                   CLE006
     C                     MOVEL*BLANKS   PARTIC                          CLE006
     C           PTYP      IFGE 64                                        CLE006
     C           PTYP      ANDLE67                                        CLE006
     C                     MOVEL'PARTICIP'PARTIC                          CLE006
     C                     MOVE 'ATION'   PARTIC                          CLE006
     C                     ENDIF                                          CLE006
      *                                                                   CLE005
     C           CLE005    IFEQ 'Y'                                       CLE005
     C           PTYP      IFEQ 68                                        CLE005
     C           PTYP      OREQ 69                                        CLE005
     C                     MOVEL'PARTICIP'PARTIC                          CLE005
     C                     MOVE 'ATION'   PARTIC                          CLE005
     C                     ENDIF                                          CLE005
     C                     ENDIF                                          CLE005
      *                                                                   CLE006
      ** Access clients name and address from SDCUSTPD using the          CLE006
      ** loan's customer number                                           CLE006
      *                                                                   CLE006
     C                     MOVE *BLANKS   KEYC1                           CLE006
     C                     MOVE CNUM      KEYC1                           CLE006
     C                     CALL 'AOCUSTR0'PLIST2                          CLE006
      *                                                                   CLE006
     C           @RTCD     IFNE *BLANKS                                   CLE006
     C           *LOCK     IN   LDA                                       CLE006
     C                     MOVELCNUM      DBKEY            ************   CLE006
     C                     MOVEL'SDCUSTPD'DBFILE           * DBERR 11 *   CLE006
     C                     Z-ADD11        DBASE            ************   CLE006
     C                     OUT  LDA                                       CLE006
     C                     EXSR *PSSR                                     CLE006
     C                     EXSR AUDIT                                     CLE006
     C                     END                                            CLE006
      *                                                                   CLE006
     C                     MOVELBBCNA1    RONA1                           CLE006
     C                     MOVELBBCNA2    RONA2                           CLE006
      *                                                                   CLE006
      ** If Customer confirmation is not zero, access clients name        CLE006
      ** and address from SDCUSTPD                                        CLE006
      *                                                                   CLE006
     C********** COCU      IFNE *ZEROS                                                 CLE006 CSD027
     C           COCU      IFNE *BLANKS                                                       CSD027
      *                                                                   CLE006
     C                     MOVE *BLANKS   KEYC1                           CLE006
     C                     MOVE COCU      KEYC1                           CLE006
     C                     CALL 'AOCUSTR0'PLIST2                          CLE006
      *                                                                   CLE006
     C           @RTCD     IFNE *BLANKS                                   CLE006
     C           *LOCK     IN   LDA                                       CLE006
     C                     MOVELCOCU      DBKEY            ************   CLE006
     C                     MOVEL'SDCUSTPD'DBFILE           * DBERR 12 *   CLE006
     C                     Z-ADD12        DBASE            ************   CLE006
     C                     OUT  LDA                                       CLE006
     C                     EXSR *PSSR                                     CLE006
     C                     EXSR AUDIT                                     CLE006
     C                     END                                            CLE006
      *                                                                   CLE006
     C                     END                                            CLE006
      *                                                                   CLE006
     C                     MOVELBBCNA1    RCNA1                           CLE006
     C                     MOVELBBCNA2    RCNA2                           CLE006
     C                     MOVELBBCNA3    RCNA3                           CLE006
     C                     MOVELBBCNA4    RCNA4                           CLE006
      *                                                                   CLE006
      ** Set up the interest field for the report - if the record         CLE006
      ** comes from ROLRECS or if there are no rollover details, the      CLE006
      ** rate will be the current one from CLOAN file                     CLE006
      *                                                                   CLE006
     C           NBRA      IFEQ 0                                         CLE006
     C           NRTS      ANDEQ0                                         CLE006
     C                     Z-ADDINTRC     RINTR                           CLE006
     C                     ELSE                                           CLE006
      *                                                                   CLE006
      ** Else, compute for the interest rate if base code is not zero     CLE006
      *                                                                   CLE006
     C           NBRA      IFNE 0                                         CLE006
     C                     MOVE CCY       KEY1                            CLE006
     C                     MOVE NBRA      KEY2                            CLE006
     C                     CALL 'AOBSRTR0'PLIST1                          CLE006
      *                                                                   CLE006
     C           @RTCD     IFNE *BLANKS                                   CLE006
     C           *LOCK     IN   LDA                                       CLE006
     C                     Z-ADD13        DBASE            ************   CLE006
     C                     MOVELKEY1      DBKEY            * DBERR 13 *   CLE006
     C                     MOVE NBRA      DBKEY            ************   CLE006
     C                     MOVE 'SDBSRTPD'DBFILE                          CLE006
     C                     OUT  LDA                                       CLE006
     C                     EXSR *PSSR                                     CLE006
     C                     EXSR AUDIT                                     CLE006
     C                     END                                            CLE006
      *                                                                   CLE006
      ** Add the base rate and spread if the spread indicator is 'A'      CLE006
      ** for add                                                          CLE006
      *                                                                   CLE006
     C           NSIN      IFEQ 'A'                                       CLE006
     C           NBRT      ADD  NRTS      RINTR                           CLE006
     C                     ELSE                                           CLE006
      *                                                                   CLE006
      ** Subtract the spread from the base rate if the spread indicator   CLE006
      ** is 'S' for subtract                                              CLE006
      *                                                                   CLE006
     C           NSIN      IFEQ 'S'                                       CLE006
     C           NBRT      SUB  NRTS      RINTR                           CLE006
     C                     ELSE                                           CLE006
      *                                                                   CLE006
      ** Use the spread as a percentage of the base rate if the           CLE006
      ** indicator is 'P' for percentage                                  CLE006
      *                                                                   CLE006
     C           NSIN      IFEQ 'P'                                       CLE006
     C           NRTS      DIV  100       WRK139 139                      CLE006
     C           WRK139    MULT NBRT      RINTR                           CLE006
      ** End for percentage                                               CLE006
     C                     END                                            CLE006
      ** End for subtract                                                 CLE006
     C                     END                                            CLE006
      ** End for add                                                      CLE006
     C                     END                                            CLE006
      *                                                                   CLE006
     C                     ELSE                                           CLE006
      *                                                                   CLE006
      ** Use the spread/rate as the rate if the base code is blank        CLE006
      *                                                                   CLE006
     C                     Z-ADDNRTS      RINTR                           CLE006
      ** End for check of which rate details to use                       CLE006
     C                     END                                            CLE006
      ** End for check if a ROLRECS record                                CLE006
     C                     END                                            CLE006
      *                                                                   CLE006
      ** Set up input fields for standard subroutine GLINTC               CLE006
      *                                                                   CLE006
     C***********          Z-ADDPNAM      ZIAMT                    CLE006 135620
     C***********          Z-ADDPRAM      ZIAMT                    135620 154455
     C                     Z-ADDCPAMC     ZIAMT                           154455
     C           NRPD      IFEQ RLDT                                      CLE006
     C           ZIAMT     SUB  RAMT      ZIAMT                           CLE006
     C                     Z-ADDZIAMT     CPAMC                           CLE006
     C                     ENDIF                                          CLE006
     C                     Z-ADDRINTR     ZIRATE                          CLE006
     C                     Z-ADDRLDT      ZIBEG                           CLE006
      *                                                                   CLE006
      ** End date is either the next rollover date or maturity date       CLE006
      *                                                                   CLE006
     C           NROD      IFNE *ZEROS                                    CLE006
     C                     Z-ADDNROD      ZIEND                           CLE006
     C           NIPD      IFNE *ZEROS                                    CLE006
     C           NIPD      ANDNERLDT                                      CLE006
     C           NIPD      ANDLTZIEND                                     CLE006
     C                     Z-ADDNIPD      ZIEND                           CLE006
     C                     ENDIF                                          CLE006
     C           NIDT      IFNE *ZEROS                                    CLE006
     C           NIDT      ANDNERLDT                                      CLE006
     C           NIDT      ANDLTZIEND                                     CLE006
     C                     Z-ADDNIDT      ZIEND                           CLE006
     C                     ENDIF                                          CLE006
     C                     ELSE                                           CLE006
     C                     Z-ADDMDAT      ZIEND                           CLE006
     C           NMDT      IFNE *ZEROS                                    CLE006
     C           MDAT      ANDEQRLDT                                      CLE006
     C                     Z-ADDNMDT      ZIEND                           CLE006
     C                     ENDIF                                          CLE006
     C           NIPD      IFNE *ZEROS                                    CLE006
     C           NIPD      ANDNERLDT                                      CLE006
     C           NIPD      ANDLTZIEND                                     CLE006
     C                     Z-ADDNIPD      ZIEND                           CLE006
     C                     ENDIF                                          CLE006
     C           NIDT      IFNE *ZEROS                                    CLE006
     C           NIDT      ANDNERLDT                                      CLE006
     C           NIDT      ANDLTZIEND                                     CLE006
     C                     Z-ADDNIDT      ZIEND                           CLE006
     C                     ENDIF                                          CLE006
     C                     END                                            CLE006
      *                                                                   CLE006
     C                     MOVE ICBS      ZICALC                          CLE006
      *                                                                   CLE006
     C/COPY WNCPYSRC,LE0426C010
     C                     EXSR GLINTC                                    CLE006
     C/COPY WNCPYSRC,LE0426C011
      *                                                                   CLE006
      ** Access currency name and decimal places from SDCURRPD            CLE006
      *                                                                   CLE006
     C***********          MOVE CCY       RCCY                     CLE006 CEU020
     C***********          MOVE CCY       @CYCD                           CEU020
     C                     MOVE WOCCY     RCCY                            CEU020
     C                     MOVE WOCCY     @CYCD                           CEU020
     C***********          MOVE BRCA      BRCAP                    135620 154455
     C***********          Z-ADDCNUM      CNUMP                    135620 154455
     C***********          Z-ADDLNRF      LNRFP                    135620 154455
     C***********KOAMT     SETGTLEHISTL4                           135620 154455
     C***********KOAMT     REDPELEHISTL4                 60        135620 154455
      ***********                                                  135620 154455
     C************IN60     DOWEQ'0'                                135620 154455
     C***********AMTPP     ANDNE'RE'                               135620 154455
     C***********KOAMT     SETGTLEHISTL4                           135620 154455
     C***********KOAMT     REDPELEHISTL4                 60        135620 154455
     C***********          ENDDO                                   135620 154455
     C************IN60     IFEQ '1'                                135620 154455
     C***********AMTPP     ANDNE'RE'                               135620 154455
     C************LOCK     IN   LDA                        ********135620 154455
     C***********          MOVEL'LEHISTL4'DBFILE           * DBERR 135620 154455
     C***********          Z-ADD13        DBASE            ********135620 154455
     C***********          MOVELLNRF      DBKEY                    135620 154455
     C***********          OUT  LDA                                135620 154455
     C***********          EXSR *PSSR                              135620 154455
     C***********          EXSR AUDIT                              135620 154455
     C***********          ENDIF                                   135620 154455
      ***********                                                  135620 154455
     C                     CALL 'AOCURRR0'                                CLE006
     C                     PARM '*MSG   ' @RTCD                           CLE006
     C                     PARM '*KEY   ' @OPTN                           CLE006
     C                     PARM           @CYCD   3                       CLE006
     C           SDCURR    PARM SDCURR    DSSDY                           CLE006
      *                                                                   CLE006
      ** Error Processing                                                 CLE006
      *                                                                   CLE006
     C           @RTCD     IFNE *BLANKS                                   CLE006
     C           *LOCK     IN   LDA                                       CLE006
     C                     MOVEL'SDCURRPD'DBFILE           ************   CLE006
     C                     Z-ADD16        DBASE            * DBERR 16 *   CLE006
     C                     MOVEL@CYCD     DBKEY            ************   CLE006
     C                     OUT  LDA                                       CLE006
     C                     EXSR *PSSR                                     CLE006
     C                     EXSR AUDIT                                     CLE006
     C                     END                                            CLE006
      *                                                                   154455
     C                     Z-ADDREBT      PRAMP  150                      154455
     C                     Z-ADDCPAMC     WNPAM  150                      154455
      *                                                                   CLE006
      **  Reset number of decimal places indicator                        CLE006
      *                                                                   CLE006
     C                     SETOF                     454647               CLE006
     C                     SETOF                     48                   CLE006
      *                                                                   CLE006
     C           A6NBDP    IFEQ 0                                         CLE006
     C                     MOVE '1'       *IN45                           CLE006
     C***********          MOVE PRAM      RPAM0                    CLE006 135620
     C                     MOVE PRAMP     RPAM0                           135620
     C                     ENDIF                                          CLE006
      *                                                                   CLE006
     C           A6NBDP    IFEQ 1                                         CLE006
     C                     MOVE '1'       *IN46                           CLE006
     C***********          MOVE PRAM      RPAM1                    CLE006 135620
     C                     MOVE PRAMP     RPAM1                           135620
     C                     ENDIF                                          CLE006
      *                                                                   CLE006
     C           A6NBDP    IFEQ 2                                         CLE006
     C                     MOVE '1'       *IN47                           CLE006
     C***********          MOVE PRAM      RPAM2                    CLE006 135620
     C                     MOVE PRAMP     RPAM2                           135620
     C                     ENDIF                                          CLE006
      *                                                                   CLE006
     C           A6NBDP    IFEQ 3                                         CLE006
     C                     MOVE '1'       *IN48                           CLE006
     C***********          MOVE PRAM      RPAM3                    CLE006 135620
     C                     MOVE PRAMP     RPAM3                           135620
     C                     ENDIF                                          CLE006
      *                                                                   CLE006
      ** Access new currency name and decimal places from SDCURRPD        CLE006
      *                                                                   CLE006
     C                     MOVE RLCY      RNCCY                           CLE006
     C                     MOVE RLCY      @CYCD                           CLE006
     C                     CALL 'AOCURRR0'                                CLE006
     C                     PARM '*MSG   ' @RTCD                           CLE006
     C                     PARM '*KEY   ' @OPTN                           CLE006
     C                     PARM           @CYCD   3                       CLE006
     C           SDCURR    PARM SDCURR    DSSDY                           CLE006
      *                                                                   CLE006
      ** Error Processing                                                 CLE006
      *                                                                   CLE006
     C           @RTCD     IFNE *BLANKS                                   CLE006
     C           *LOCK     IN   LDA                                       CLE006
     C                     MOVEL'SDCURRPD'DBFILE           ************   CLE006
     C                     Z-ADD14        DBASE            * DBERR 14 *   CLE006
     C                     MOVEL@CYCD     DBKEY            ************   CLE006
     C                     OUT  LDA                                       CLE006
     C                     EXSR *PSSR                                     CLE006
     C                     EXSR AUDIT                                     CLE006
     C                     END                                            CLE006
      *                                                                   CLE006
      **  Reset number of decimal places indicator                        CLE006
      *                                                                   CLE006
     C                     SETOF                     404142               CLE006
     C                     SETOF                     43                   CLE006
      *                                                                   CLE006
      ** Setup indicator based on the no. of decimal places, move         CLE006
      ** principal and interest amounts to report fields, and compute     CLE006
      ** for the total amount                                             CLE006
      *                                                                   CLE006
     C           A6NBDP    IFEQ 0                                         CLE006
     C                     MOVE '1'       *IN40                           CLE006
     C***********          MOVE PNAM      RNPAM0                   CLE006 135620
     C***********          Z-ADDPRAM      RNPAM0                   135620 154455
     C                     MOVE WNPAM     RNPAM0                          154455
     C                     Z-ADDZINTR     RINT0                           CLE006
     C           RNPAM0    ADD  RINT0     RTOT0                           CLE006
     C                     ENDIF                                          CLE006
     C*                                                                   CLE006
     C           A6NBDP    IFEQ 1                                         CLE006
     C                     MOVE '1'       *IN41                           CLE006
     C***********          MOVE PNAM      RNPAM1                   CLE006 135620
     C***********          MOVE PRAM      RNPAM2                   135620 154455
     C                     MOVE WNPAM     RNPAM1                          154455
     C                     Z-ADDZINTR     RINT1                           CLE006
     C           RNPAM1    ADD  RINT1     RTOT1                           CLE006
     C                     ENDIF                                          CLE006
     C*                                                                   CLE006
     C           A6NBDP    IFEQ 2                                         CLE006
     C                     MOVE '1'       *IN42                           CLE006
     C***********          MOVE PNAM      RNPAM2                   CLE006 135620
     C***********          MOVE PRAM      RNPAM2                   135620 154455
     C                     MOVE WNPAM     RNPAM2                          154455
     C                     Z-ADDZINTR     ZINTR0 150                      CLE006
     C                     MOVE ZINTR0    RINT2                           CLE006
     C           RNPAM2    ADD  RINT2     RTOT2                           CLE006
     C                     ENDIF                                          CLE006
     C*                                                                   CLE006
     C           A6NBDP    IFEQ 3                                         CLE006
     C                     MOVE '1'       *IN43                           CLE006
     C***********          MOVE PNAM      RNPAM3                   CLE006 135620
     C***********          MOVE PRAM      RNPAM3                   135620 154455
     C                     MOVE WNPAM     RNPAM3                          154455
     C                     Z-ADDZINTR     RINT3                           CLE006
     C           RNPAM3    ADD  RINT3     RTOT3                           CLE006
     C                     ENDIF                                          CLE006
      *                                                                   CLE006
      ** Setup pay/receive instructions                                   CLE006
      *                                                                   CLE006
     C                     EXSR PAYRC                                     CLE006
      *                                                                                       CLE031
     C           CLE031    IFEQ 'Y'                                                           CLE031
     C           PTYP      ANDNE66                                                            CLE031
     C           PTYP      ANDNE67                                                            CLE031
     C           PTYP      ANDNE72                                                            CLE031
      *                                                                                       CLE031
     C                     MOVE CCY       @CYCD   3                                           CLE031
     C           PSCY      IFNE *BLANKS                                                       CLE031
     C           PSCY      ANDNECCY                                                           CLE031
     C                     MOVE PSCY      @SYCD   3                                           CLE031
     C                     MOVE PEXR      FCXR   138                                          CLE031
     C                     MOVE PEXI      FMDI    1                                           CLE031
     C                     Z-ADDPRAM      @VAMT  150                                          CLE031
     C                     EXSR SRCONV                                                        CLE031
     C                     MOVE WAMTA     RCONA                                               CLE031
     C                     MOVE @SYCD     RSPCY                                               CLE031
      *                                                                                       CLE031
     C                     Z-ADDINTR      @VAMT  150                                          CLE031
     C                     EXSR SRCONV                                                        CLE031
     C                     MOVE WAMTA     RIEQA                                               CLE031
      *                                                                                       CLE031
     C                     Z-ADDTAMT      @VAMT                                               CLE031
     C                     EXSR SRCONV                                                        CLE031
     C                     MOVE WAMTA     RTEQA                                               CLE031
      *                                                                                       CLE031
     C                     ELSE                                                               CLE031
     C           SCCY      IFNE *BLANKS                                                       CLE031
     C           SCCY      ANDNECCY                                                           CLE031
     C                     MOVE SCCY      @SYCD                                               CLE031
     C                     MOVE REXR      FCXR   138                                          CLE031
     C                     MOVE REXI      FMDI    1                                           CLE031
     C                     Z-ADDPRAM      @VAMT                                               CLE031
     C                     EXSR SRCONV                                                        CLE031
     C                     MOVE WAMTA     RCONA                                               CLE031
     C                     MOVE @SYCD     RSPCY                                               CLE031
      *                                                                                       CLE031
     C                     Z-ADDINTR      @VAMT                                               CLE031
     C                     EXSR SRCONV                                                        CLE031
     C                     MOVE WAMTA     RIEQA                                               CLE031
      *                                                                                       CLE031
     C                     Z-ADDTAMT      @VAMT                                               CLE031
     C                     EXSR SRCONV                                                        CLE031
     C                     MOVE WAMTA     RTEQA                                               CLE031
     C                     ENDIF                                                              CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
     C                     ENDIF                                                              CLE031
      *                                                                   CLE006
      ** Generate the confirmation                                        CLE006
      *                                                                   CLE006
     C                     EXSR REPORT                                    CLE006
      *                                                                   CLE006
     C                     ENDSR                                          CLE006
     C*****************************************************************   CLE006
     C/EJECT                                                              CLE006
     C*****************************************************************   CLE006
     C*                                                               *   CLE006
     C*  PAYRC  - Setup pay/receive instructions in the confirmation  *   CLE006
     C*  Called by: DETAIL                                            *   CLE006
     C*  Calls    : QNOSTR,CPNOS                                      *   CLE006
     C*                                                               *   CLE006
     C*****************************************************************   CLE006
     C*                                                                   CLE006
     C           PAYRC     BEGSR                                          CLE006
     C*                                                                   CLE006
     C                     MOVEATITL1E    TITL12                          CLE006
     C                     MOVEANAME1E    NAME12                          CLE006
     C                     MOVEANAME3E    NAME34                          CLE006
     C*                                                                   CLE006
     C** Check for blank SPI                                              CLE006
     C*                                                                   CLE006
     C           SPI1      IFEQ *BLANKS                                   CLE006
     C           SPI2      ANDEQ*BLANKS                                   CLE006
     C           SPI3      ANDEQ*BLANKS                                   CLE006
     C                     SETON                         24               CLE006
     C                     ELSE                                           CLE006
     C                     SETOF                         24               CLE006
     C                     END                                            CLE006
     C*                                                                   CLE006
     C** Check for blank FACO                                             CLE006
     C*                                                                   CLE006
     C           FACO      IFEQ *BLANKS                                   CLE006
     C                     SETON                         23               CLE006
     C                     ELSE                                           CLE006
     C                     SETOF                         23               CLE006
     C                     END                                            CLE006
     C*                                                                   CLE006
     C** Move settlement fields for loan/dep or N.A.Purch into            CLE006
     C** receipt/payment groups - see data structures                     CLE006
     C*                                                                   CLE006
     C                     SETOF                     49                   CLE006
     C  N37N38             SETON                     49                   CLE006
     C   49                MOVE SETTLP    SETTLR                          CLE006
     C   49                MOVE SETTL1    SETTLP                          CLE006
     C  N49                MOVE SETTL1    SETTLR                          CLE006
     C*                                                                   CLE006
     C** Set indicators for receipt settlement type                       CLE006
     C*                                                                   CLE006
     C                     EXSR SETTYP                                    CLE006
     C*                                                                   CLE006
     C** Set up OUR receipt nostro fields                                 CLE006
     C*                                                                   CLE006
     C                     SETOF                     6117                 CLE006
     C                     MOVE OPCA      NOSTRO                          CLE006
     C                     MOVE OPSB      BRC                             CLE006
     C                     EXSR QNOSTR                                    CLE006
     C                     MOVELARRAY     RTIT1                           CLE006
      *                                                                   CLE033
     C           CLE033    IFEQ 'Y'                                       CLE033
     C           PCST      ANDEQ09                                        CLE033
     C                     MOVELTHRACC    RNAM1                           CLE033
     C           OPSB      CAT  OPCA      RTWN1                           CLE033
     C                     ELSE                                           CLE033
     C                     MOVE CPNM      RNAM1                           CLE006
     C                     MOVELCPTN      RTWN1                           CLE006
     C                     ENDIF                                          CLE033
     C*                                                                   CLE006
     C** Set up THEIR payment nostro fields                               CLE006
     C*                                                                   CLE006
     C                     MOVELTSCN      NOSTRO                          CLE006
     C                     EXSR CPNOS                                     CLE006
     C                     MOVELARRAY     RTIT3                           CLE006
     C                     MOVE CPNM      RNAM3                           CLE006
     C                     MOVE CPTN      RTWN3                           CLE006
     C*                                                                   CLE006
     C** Set indicators for payment settlement type                       CLE006
     C*                                                                   CLE006
     C                     Z-ADDSCST      PCST                            CLE006
     C                     EXSR SETTYP                                    CLE006
     C*                                                                   CLE006
     C** Set up OUR payment nostro fields                                 CLE006
     C*                                                                   CLE006
     C                     SETON                     61                   CLE006
     C                     MOVE OSCA      NOSTRO                          CLE006
     C                     MOVE OSSB      BRC                             CLE006
     C                     EXSR QNOSTR                                    CLE006
     C                     MOVELARRAY     RTIT2                           CLE006
      *                                                                   CLE033
     C           CLE033    IFEQ 'Y'                                       CLE033
     C           PCST      ANDEQ09                                        CLE033
     C                     MOVELTHRACC    RNAM2                           CLE033
     C           OSSB      CAT  OSCA      RTWN2                           CLE033
     C                     ELSE                                           CLE033
     C                     MOVE CPNM      RNAM2                           CLE006
     C                     MOVELCPTN      RTWN2                           CLE006
     C                     ENDIF                                          CLE033
     C*                                                                   CLE006
     C** Special instructions                                             CLE006
     C*                                                                   CLE006
     C  N51N52N54                                                         CLE006
     CANN57                SETON                     24                   CLE006
     C  N24                MOVE SPINST    RTIT6  20                       CLE006
     C*                                                                   CLE006
     C** Ignore blank special instructions                                CLE006
     C*                                                                   CLE006
     C   24                GOTO BENEND                                    CLE006
     C*                                                                   CLE006
     C** Check for beneficiary bank details                               CLE006
     C*                                                                   CLE006
     C           SPEC5     COMP '/BEN/'              606026               CLE006
     C   60                GOTO BENEND                                    CLE006
     C*                                                                   CLE006
     C** Check for chips number                                           CLE006
     C*                                                                   CLE006
     C           SPEC8     COMP '/CH'                    60               CLE006
     C   60                MOVE SPEC14    WORK6   6                       CLE006
     C   60                MOVE *BLANKS   SPI1                            CLE006
     C   60                MOVE 'CHIPS'   SPEC5                           CLE006
     C   60                MOVE WORK6     SPEC12                          CLE006
     C   60                GOTO BENEND                                    CLE006
     C*                                                                   CLE006
     C** Check for fed. wire number                                       CLE006
     C*                                                                   CLE006
     C           SPEC8     COMP '/FW'                    60               CLE006
     C   60                MOVE SPEC17    WORK9   9                       CLE006
     C   60                MOVE *BLANKS   SPI1                            CLE006
     C   60                MOVE 'FED.WIRE'SPEC9                           CLE006
     C   60                MOVE WORK9     SPEC18                          CLE006
     C   60                GOTO BENEND                                    CLE006
     C*                                                                   CLE006
     C** Must now be 'ACCOUNT'                                            CLE006
     C*                                                                   CLE006
     C                     MOVE SPEC30    WORK25 25                       CLE006
     C                     MOVE *BLANKS   SPI1                            CLE006
     C                     MOVE 'A/C'     SPEC3                           CLE006
     C                     MOVE WORK25    SPEC29                          CLE006
     C*                                                                   CLE006
     C           BENEND    TAG                             * BENEND TAG * CLE006
     C*                                                                   CLE006
     C** Set up their receipt nostro fields                               CLE006
     C*                                                                   CLE006
     C                     MOVELTPCN      NOSTRO                          CLE006
     C                     EXSR CPNOS                                     CLE006
     C                     MOVELARRAY     RTIT4                           CLE006
     C                     MOVE CPNM      RNAM4                           CLE006
     C                     MOVE CPTN      RTWN4                           CLE006
     C*                                                                   CLE006
     C** Get for A/C of                                                   CLE006
     C*                                                                   CLE006
     C                     MOVELFACO      NOSTRO                          CLE006
     C   51N23             EXSR CPNOS                                     CLE006
     C*                                                                   CLE006
     C           *IN23     IFEQ '0'                                       CLE006
     C                     MOVE CPNM      RCPNM                           CLE006
     C                     MOVE CPTN      RCPTN                           CLE006
     C                     MOVE CPORAC    RORAC                           CLE006
     C                     ELSE                                           CLE006
     C                     MOVE *BLANKS   RCPNM                           CLE006
     C                     MOVE *BLANKS   RCPTN                           CLE006
     C                     MOVE *BLANKS   RORAC                           CLE006
     C                     END                                            CLE006
     C*                                                                   CLE006
     C           *IN24     IFEQ '0'                                       CLE006
     C                     MOVE BTB1      RBTB1                           CLE006
     C                     MOVE BTB2      RBTB2                           CLE006
     C                     MOVE BTB3      RBTB3                           CLE006
     C                     ELSE                                           CLE006
     C                     MOVE *BLANKS   RBTB1                           CLE006
     C                     MOVE *BLANKS   RBTB2                           CLE006
     C                     MOVE *BLANKS   RBTB3                           CLE006
     C                     END                                            CLE006
     C*                                                                   CLE006
     C** Get name and address lines and print confirmation                CLE006
     C*                                                                   CLE006
     C                     SETOF                     61                   CLE006
     C                     SETON                         69               CLE006
     C*                                                                   CLE006
     C           PIBN      IFEQ *BLANKS                                   CLE006
     C           PIBA      ANDEQ*BLANKS                                   CLE006
     C                     MOVE *BLANKS   RTIT3                           CLE006
     C                     MOVE *BLANKS   RNAM3                           CLE006
     C                     MOVE *BLANKS   RTWN3                           CLE006
     C                     END                                            CLE006
     C*                                                                   CLE006
     C                     MOVELAWBA      AWBW    6                       CLE006
     C           AWBW      IFEQ 'DIRECT'                                  CLE006
     C           AWBN      ANDEQ*BLANKS                                   CLE006
     C           AWBA      OREQ *BLANKS                                   CLE006
     C           AWBN      ANDEQ*BLANKS                                   CLE006
     C                     MOVE *BLANKS   RTIT4                           CLE006
     C                     MOVE *BLANKS   RNAM4                           CLE006
     C                     MOVE *BLANKS   RTWN4                           CLE006
     C                     END                                            CLE006
     C*                                                                   CLE006
     C                     ENDSR                                          CLE006
     C*                                                                   CLE006
     C/EJECT                                                              CLE006
     C*****************************************************************   CLE006
     C*                                                               *   CLE006
     C*  QNOSTR - Subroutine to get OUR nostro details                *   CLE006
     C*                                                               *   CLE006
     C*  Called by: CONF                                              *   CLE006
     C*  Calls    : MOVEA, TABCHN, CLICHN                             *   CLE006
     C*                                                               *   CLE006
     C*****************************************************************   CLE006
     C           QNOSTR    BEGSR                           ***  QNOSTR  **CLE006
     C*                                                                   CLE006
     C                     MOVE BLANK     CPNM                            CLE006
     C                     MOVE BLANK     CPTN                            CLE006
     C                     MOVE *BLANKS   CPORAC 25                       CLE006
     C*                                                                   CLE006
     C** Set up title                                                     CLE006
     C*                                                                   CLE006
     C                     Z-ADD1         A       30                      CLE006
     C                     MOVELPAYAT     ADDDS                           CLE006
     C                     EXSR MOVEA                                     CLE006
     C*                                                                   CLE006
     C                     MOVELROLDAT    ADDDS                           CLE006
     C                     EXSR MOVEA                                     CLE006
     C*                                                                   CLE006
     C  N61 51             MOVELTOURAC    ADD                             CLE006
     C  N61 51             MOVELTOURAC    ADD                             CLE006
     C   50 61                                                            CLE006
     COR 51 61                                                            CLE006
     COR 54                                                               CLE006
     COR 57                MOVEL'BY'      ADD                             CLE006
     C   50N61             MOVEL'TO'      ADD                             CLE006
     C                     EXSR MOVEA                                     CLE006
     C*                                                                   CLE006
     C** Set up narrative or name and town fields                         CLE006
     C** Settle. type 01 - get name & town from nostro & CLINT record  S  CLE006
     C*                                                                   CLE006
     C  N51                GOTO NONAME                                    CLE006
     C*                                                                   CLE006
     C** Is either CCY local and OURSELVES or nostro ind                  CLE006
     C** ON I.C.D. 2 blank                                                CLE006
     C*                                                                   CLE006
      *                                                                   CEU004
      **  Use Sett Ccy if defined on the record and if CEU004 is on       CEU004
      *                                                                   CEU004
     C           CEU004    IFEQ 'Y'                                       CEU004
     C           SCCY      ANDNE*BLANKS                                   CEU004
     C           SCCY      COMP LOCY                     60               CEU004
     C                     ELSE                                           CEU004
     C           CCY       COMP LOCY                     60               CLE006
     C                     ENDIF                                          CEU004
      *                                                                                       CLE031
     C           CLE031    IFEQ 'Y'                                                           CLE031
      *                                                                                       CLE031
     C           SCCY      IFNE *BLANKS                                                       CLE031
     C           SCCY      COMP LOCY                     60                                   CLE031
     C                     ELSE                                                               CLE031
     C           PSCY      IFNE *BLANKS                                                       CLE031
     C           PSCY      COMP LOCY                     60                                   CLE031
     C                     ELSE                                                               CLE031
     C           CCY       COMP LOCY                     60                                   CLE031
     C                     ENDIF                                                              CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
     C                     ENDIF                                                              CLE031
      *                                                                   CEU004
     C   18                SETOF                     60                   CLE006
     C   60                MOVELOURSEL    CPNM                            CLE006
     C   60                GOTO NONAME                                    CLE006
     C*                                                                   CLE006
     C** Is nostro code present                                           CLE006
     C*                                                                   CLE006
     C   51      NOS       COMP '  '                     67               CLE006
     C   51N67   NOS       COMP '00'                     67               CLE006
     C*                                                                   CLE006
     C** If the settlement details field for OUR nostros is blank         CLE006
     C** suppress the write to LEEXTAB.  Hence no message will be         CLE006
     C** produced.                                                        CLE006
     C*                                                                   CLE006
     C           *IN67     IFEQ '1'                                       CLE006
     C           *IN51     ANDEQ'1'                                       CLE006
     C                     MOVE '0'       *IN81                           CLE006
     C                     END                                            CLE006
     C*                                                                   CLE006
     C   51 67             GOTO NONAME                                    CLE006
     C*                                                                   CLE006
     C** Access SDNOSTPD                                                  CLE006
     C*                                                                   CLE006
      *                                                                   CEU004
      **  Use Sett Ccy if defined on the record and if CEU004 is on       CEU004
      *                                                                   CEU004
     C           CEU004    IFEQ 'Y'                                       CEU004
     C           SCCY      ANDNE*BLANKS                                   CEU004
     C                     MOVE SCCY      KEYB                            CEU004
     C                     ELSE                                           CEU004
     C                     MOVE CCY       KEYB                            CLE006
     C                     ENDIF                                          CEU004
      *                                                                   CEU004
     C           CLE031    IFEQ 'Y'                                                           CLE031
     C           SCCY      IFNE *BLANKS                                                       CLE031
     C                     MOVE SCCY      KEYB                                                CLE031
     C                     ELSE                                                               CLE031
     C           PSCY      IFNE *BLANKS                                                       CLE031
     C                     MOVE PSCY      KEYB                                                CLE031
     C                     ELSE                                                               CLE031
     C                     MOVE CCY       KEYB                                                CLE031
     C                     ENDIF                                                              CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
     C                     MOVE NOS       KEYE                            CLE006
     C                     CALL 'AONOSTR0'PLISTC                          CLE006
     C           @RTCD     COMP *BLANKS                  07               CLE006
     C  N07                MOVEL'NOSTRO'  ERM    16                       CLE006
     C  N07                MOVELERM       CPNM                            CLE006
     C  N07                GOTO ENDNOS                                    CLE006
     C  N61      ORAC      COMP BLK25                1717                 CLE006
     C*                                                                   CLE006
     C** Get client record.                                               CLE006
     C*                                                                   CLE006
     C           QCLINT    TAG                             ***  QCLINT ***CLE006
     C                     MOVELCNUMN     CKEY                            CLE006
     C   51                CALL 'AOCUSTR0'PLISTR                          CLE006
     C           @RTCD     COMP *BLANKS                  08               CLE006
     C  N08                MOVEL'NOSTRO'  ERM                             CLE006
     C  N08                MOVELERM       CPNM                            CLE006
     C   08                MOVELCRNM      CPNM                            CLE006
     C   08                MOVELCTWN      CPTN                            CLE006
     C   08                MOVELORAC      CPORAC                          CLE006
     C*                                                                   CLE006
     C           NONAME    TAG                             ***  NONAME ***CLE006
     C*                                                                   CLE006
     C** Blank out 'OUR A/C WITH' if 'INSTRS.TO BE ADVISED' or            CLE006
     C** 'OURSELVES' to be printed.                                       CLE006
     C*                                                                   CLE006
     C   51 60N61A         ADD  3         A                               CLE006
     C   51 60N61                                                         CLE006
     COR 51 67N61          EXSR MOVEA                                     CLE006
     C*                                                                   CLE006
     C   51 67                                                            CLE006
     COR 50                MOVELINSADV    CPNM                            CLE006
     C   50                                                               CLE006
     COR 51                GOTO ENDNOS                                    CLE006
     C*                                                                   CLE006
     C** Set up pay and receipt narratives                                CLE006
     C*                                                                   CLE006
     C   54                MOVELA7ACCD    AC                              CLE006
     C   54                MOVELAC        CPTN                            CLE006
     C   54                MOVE '-'       DASH                            CLE006
     C   54                MOVEL'01'      SEQ                             CLE006
     C   54                MOVE SEQ       SEQX                            CLE006
     C   54                MOVE '-'       DASH2                           CLE006
     C   54                MOVE BRC       BRCX                            CLE006
     C   57                MOVELRETAC     CPTN                            CLE006
     C   61                GOTO QPAY                                      CLE006
     C*                                                                   CLE006
     C** Receipt narrative                                                CLE006
     C*                                                                   CLE006
     C           REC       TAG                             ***  REC    ***CLE006
     C   52                MOVELWAITR     CPNM                            CLE006
     C   55                                                               CLE006
     COR 53                MOVELPEROUR    CPNM                            CLE006
     C   55                                                               CLE006
     COR 53                MOVELASPER     CPNM                            CLE006
     C   54                                                               CLE006
     COR 57                MOVELDRTOAC    CPNM                            CLE006
     C   56                MOVELWECOL     CPNM                            CLE006
     C                     GOTO ENDNOS                                    CLE006
     C*                                                                   CLE006
     C** Pay narrative                                                    CLE006
     C*                                                                   CLE006
     C           QPAY      TAG                             ***  QPAY   ***CLE006
     C   52                MOVELSENDR     CPNM                            CLE006
     C   52                MOVELSEND      CPNM                            CLE006
     C   55                                                               CLE006
     COR 53                MOVELPERYOR    CPNM                            CLE006
     C   54                                                               CLE006
     COR 57                MOVELCRTOAC    CPNM                            CLE006
     C   54                                                               CLE006
     COR 57                MOVEL'CRED'    CPNM                            CLE006
     C   56                MOVELYOUCOL    CPNM                            CLE006
     C   56                MOVEL'YOU'     CPNM                            CLE006
     C*                                                                   CLE006
     C           ENDNOS    ENDSR                           ***  ENDNOS  **CLE006
     C/EJECT                                                              CLE006
     C*                                                                   CLE006
     C*****************************************************************   CLE006
     C*                                                               *   CLE006
     C*  CPNOS  - Subroutine to get THEIR nostro and FOR A/C OF       *   CLE006
     C*           details                                             *   CLE006
     C*                                                               *   CLE006
     C*  Called by: CONF                                              *   CLE006
     C*  Calls    : MOVEA, TABCHN, CLICHN                             *   CLE006
     C*                                                               *   CLE006
     C*****************************************************************   CLE006
     C           CPNOS     BEGSR                           ***  CPNOS  ***CLE006
     C*                                                                   CLE006
     C                     MOVE BLANK     CPNM                            CLE006
     C                     MOVE BLANK     CPTN                            CLE006
     C                     MOVE BLANK     ARRAY                           CLE006
     C*                                                                   CLE006
     C** Set up title                                                     CLE006
     C*                                                                   CLE006
     C                     Z-ADD1         A                               CLE006
     C  N61                MOVE 'BY'      PAY                             CLE006
     C   61                MOVE 'TO'      PAY                             CLE006
     C   50                                                               CLE006
     COR 51                MOVELPAY       ADD                             CLE006
     C                     EXSR MOVEA                                     CLE006
     C*                                                                   CLE006
     C** Set up name                                                      CLE006
     C*                                                                   CLE006
     C           RETAC     COMP BLANK                    60               CLE006
     C   50                                                               CLE006
     COR 51 60             MOVELAWAITA    CPNM                            CLE006
     C  N51                                                               CLE006
     COR 60                GOTO ENDCPN                                    CLE006
     C*                                                                   CLE006
     C** Settlement types 01,07,08 and nostro non-blank - get name        CLE006
     C** and town from counterparty shortname or customer no.             CLE006
     C** If the settlement field details field for their nostro           CLE006
     C** is blank suppress the write to LEEXTAB.  Hence no message        CLE006
     C** is produced                                                      CLE006
     C*                                                                   CLE006
     C           CUSTNO    IFEQ *BLANKS                                   CLE006
     C           *IN51     ANDEQ'1'                                       CLE006
     C                     MOVE '0'       *IN81                           CLE006
     C                     END                                            CLE006
     C*                                                                   CLE006
     C           CUSTNO    COMP CNUMA                    60               CLE006
     C                     MOVELCUSTNO    CKEY                            CLE006
     C                     CALL 'AOCUSTR0'PLISTR                          CLE006
     C           @RTCD     COMP *BLANKS                  08               CLE006
     C   08                MOVELCRNM      CPNM                            CLE006
     C   08                MOVELCTWN      CPTN                            CLE006
     C  N08                MOVE CPSH      ARCD                            CLE006
     C  N08                CALL 'AOCNSTR0'PLISTF                          CLE006
     C  N08      @RTCD     COMP *BLANKS                  07               CLE006
     C  N07N08             MOVEL'NOSTRO'  ERM                             CLE006
     C  N07N08             MOVELERM       CPNM                            CLE006
     C*                                                                   CLE006
     C           ENDCPN    ENDSR                           ***  ENDCPN  **CLE006
     C/EJECT                                                              CLE006
     C*****************************************************************   CLE006
     C*                                                               *   CLE006
     C*  MOVEA  - Subroutine to insert words in narrative at variable *   CLE006
     C*           position and keep count of next position.  See data *   CLE006
     C*           structures                                          *   CLE006
     C*                                                               *   CLE006
     C*  Called by: CONF, NOSTRO, CPNOS                               *   CLE006
     C*  Calls    : None                                              *   CLE006
     C*                                                               *   CLE006
     C*****************************************************************   CLE006
     C           MOVEA     BEGSR                           ***  MOVEA  ***CLE006
     C                     MOVEAADD       AR,A                            CLE006
     C           A         ADD  LENGTH    A                               CLE006
     C                     MOVE BLANK     ADDDS                           CLE006
     C                     Z-ADD0         LENGTH                          CLE006
     C                     ENDSR                                          CLE006
     C/EJECT                                                              CLE006
     C*****************************************************************   CLE006
     C*                                                               *   CLE006
     C*  SETTYP - Subroutine to set indicators for settlement type    *   CLE006
     C*                                                               *   CLE006
     C*  Called by: PAYRC                                             *   CLE006
     C*  Calls    : None                                              *   CLE006
     C*                                                               *   CLE006
     C*****************************************************************   CLE006
     C           SETTYP    BEGSR                           ***  SETTYP  **CLE006
     C                     SETOF                     5657                 CLE006
     C                     SETOF                     535455               CLE006
     C           PCST      COMP 01                   525051               CLE006
     C   52      PCST      COMP 03                   545253               CLE006
     C   54      PCST      COMP 05                   535455               CLE006
     C   53      PCST      COMP 07                     5351               CLE006
     C  N51      PCST      COMP 08                   56  51               CLE006
     C   56      PCST      COMP 14                     5657               CLE006
      *                                                                   CLE033
      ** If CLE033 is on and Settle method is '09', do same processing    CLE033
      ** as Settle method '08'                                            CLE033
      *                                                                   CLE033
     C           CLE033    IFEQ 'Y'                                       CLE033
     C           PCST      ANDEQ09                                        CLE033
     C  N51      PCST      COMP 09                   56  51               CLE033
     C                     ENDIF                                          CLE033
      *                                                                   CLE033
     C                     ENDSR                                          CLE006
     C/EJECT                                                              139653
      *****************************************************************   139653
      *                                                                   139653
      * CALPRN    : Calculate outstanding principal as of rollover        139653
      *             date                                                  139653
      * CALLED BY : REQS                                                  139653
      *                                                                   139653
      *                                                                   139653
     C           CALPRN    BEGSR                           *** CALPRN *** 139653
      *                                                                   139653
      ** Define work variables.                                           139653
      *                                                                   139653
     C           *LIKE     DEFN CPAMC     @CPAMC                          139653
     C           *LIKE     DEFN LNRF      @LNRFX                          139653
     C           *LIKE     DEFN RLDT      @EVCDX                          139653
      *                                                                   139653
     C                     Z-ADDCPAMC     @CPAMC                          139653
     C**********           Z-ADDLNRF      @LNRFX                                       139653 CLE148
     C                     MOVELLNRF      @LNRFX                                              CLE148
      *                                                                   139653
      ** Determine the control date.                                      139653
      *                                                                   139653
     C           BKAPDT    IFLT BJDNWD                                    139653
     C                     Z-ADDBKAPDT    @EVCDX                          139653
     C                     ELSE                                           139653
     C           BJDNWD    SUB  1         @EVCDX                          139653
     C                     END                                            139653
      *                                                                   139653
      ** Define KLIST for LVNTROX.                                        139653
      *                                                                   139653
     C           LNXKEY    KLIST                                          139653
     C                     KFLD           @LNRFX                          139653
     C                     KFLD           @EVCDX                          139653
      *                                                                   139653
      ** Access the events file to get the principal records for this     139653
      ** loan after the control date to rollover date.                    139653
      *                                                                   139653
     C           LNXKEY    SETGTLVNTROX              01                   139653
      *                                                                   139653
     C           *IN01     IFEQ '0'                                       139653
     C                     READ LVNTROX                  01               139653
      *                                                                   139653
     C           *IN01     DOWEQ'0'                                       139653
     C           LNRFX     ANDEQ@LNRFX                                    139653
     C           EDATX     ANDGT@EVCDX                                    139653
     C           EDATX     ANDLERLDT                                      139653
      *                                                                   139653
      ** Add principal increase to current principal.                     139653
      *                                                                   139653
     C           ETYP2X    IFEQ 'V3'                                      139653
     C           ETYP2X    OREQ 'X2'                                      139653
     C           @CPAMC    ADD  EAMTX     @CPAMC                          139653
     C                     ELSE                                           139653
      *                                                                   139653
      ** Deduct principal repayment from current principal.               139653
      *                                                                   139653
     C           @CPAMC    SUB  EAMTX     @CPAMC                          139653
     C                     END                                            139653
      *                                                                   139653
     C                     READ LVNTROX                  01               139653
     C                     END                                            139653
      *                                                                   139653
     C                     END                                            139653
      *                                                                   139653
     C                     ENDSR                                          139653
      *                                                                   139653
      *****************************************************************   139653
     C/EJECT
     C/COPY ZSRSRC,GLINTCZ1
     C/EJECT
     C/COPY ZSRSRC,ZDATE1Z2
     C/EJECT
     C/COPY ZSRSRC,ZCHKH
     C/EJECT
     C/COPY ZSRSRC,ZFREQBZ2
     C/EJECT
     C/COPY ZSRSRC,ZACCH
     C/EJECT
     C/COPY ZSRSRC,ZRSTORZ1
     C/EJECT
     C/COPY ZSRSRC,ZDATE2Z2
     C/EJECT
     C/COPY ZSRSRC,ZSAVEZ1
     C/EJECT
     C/COPY ZSRSRC,ZBKDT
     C/EJECT
     C/COPY ZSRSRC,ZFWDT
     C/EJECT
     C*COPY*ZSRSRC,ZEDITZ2********************************************    091679
     C/COPY ZSRSRC,ZSEDITZ3                                               091679
     C/EJECT
     C*****************************************************************
     C*
     C* REPORT: GENERATE THE ROLLOVER CONFIRMATION
     C* CALLED BY: DETAIL
     C*
     C*****************************************************************
     C*
     C           REPORT    BEGSR                           *** REPORT ***
     C*                                                                   S01408
     C/COPY WNCPYSRC,LE0426CCP1                                           S01408
     C*                                                                   S01408
     C**
     C* If the branch name is to be included on the confirmation
     C* it needs to be retrieved from SDBRCHPD
     C**
     C**********           CALL 'AOBRCHR0'                                                    CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7
     C                     PARM '*KEY   ' @OPTN   7
     C                     PARM BRCA      @DSNB   3
     C********** SDBRCH    PARM SDBRCH    DSFDY                                               CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C*
     C** Error Processing
     C*
     C           @RTCD     IFNE *BLANKS
     C           *LOCK     IN   LDA
     C                     MOVE *BLANKS   DBKEY
     C                     MOVEL@DSNB     DBKEY            ************
     C                     MOVEL'SDBRCHPD'DBFILE           * DBERR 05 *
     C                     Z-ADD5         DBASE            ************
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     EXSR AUDIT
     C                     END
     C**
      **   If not multi-branching only need to call ZSFILE once.
      *
     C           AGMBIN    IFNE 'Y'
      *
      **   Open printer file
      *
     C           P1OP      IFNE 'Y'                                       061541
     C                     OPEN LE0426P1
     C                     MOVE 'Y'       P1OP    1                       061541
     C                     END                                            061541
      *
     C                     Z-ADDSFNUM     ZSNUM   60
     C**
      **  SAVE BRANCH CODE                                                091679
     C                     MOVE BRCA      BRCASV  3                       091679
     C                     MOVE *BLANKS   BRCA    3
     C**
     C                     CALL 'ZSFILE'
     C***********          PARM           SEQ                             CLE006
     C                     PARM           SEQR    5                       CLE006
     C                     PARM BRCA      SENTY   3
     C                     PARM           SFILE
     C                     PARM           ZSNUM
     C                     PARM           ZSERR   1
      *
      **   Error during ZSFILE processing, end pgm.
      *
     C           ZSERR     IFNE ' '
     C                     SETON                     U7U8LR
     C                     RETRN
     C                     ELSE                                           091679
      **  RESET THE BRANCH CODE                                           091679
     C                     MOVE BRCASV    BRCA                            091679
     C                     END
     C**
     C                     ELSE
      *
      **   If multi-branching need separate report for each branch
      *
     C                     CLOSELE0426P1
     C                     OPEN LE0426P1
      *
      ** Multi-branching so ensure that spool file recorded by R.C.F.
      *
     C                     Z-ADDSFNUM     ZSNUM   60
      *
     C                     MOVE BRCA      @BRCH   3
      *
     C                     CALL 'ZSFILE'
     C***********          PARM           SEQ                             CLE006
     C                     PARM           SEQR                            CLE006
     C                     PARM @BRCH     SENTY   3
     C                     PARM           SFILE
     C                     PARM           ZSNUM
     C                     PARM           ZSERR   1
      *
      **   Error during ZSFILE processing, end pgm.
      *
     C           ZSERR     IFNE ' '
      *
     C                     SETON                     U7U8LR
     C                     RETRN
     C                     END
      *
     C                     END
     C/COPY WNCPYSRC,LE0426C007
     C**
     C* Ooutput the confirmation
     C**
     C           CLE006    IFEQ 'Y'                                       CLE006
     C           AMTP      ANDEQ'MC'                                      CLE006
     C           CEU020    OREQ 'Y'                                       CEU020
     C           AMTP      ANDEQ'MC'                                      CEU020
     C           CLE007    OREQ 'Y'                                       CLE015
     C           AMTP      ANDEQ'MC'                                      CLE015
     C                     WRITELE0426D2                                  CLE006
     C                     ELSE                                           CLE006
     C                     WRITELE0426D1
     C                     ENDIF                                          CLE006
     C/COPY WNCPYSRC,LE0426C008
     C*                                                                     0085
     C**   Set on advice produced flag if this is a requested               0085
     C**   rollover confirmation                                            0085
     C*                                                                     0085
     C           REQ       IFEQ 'Y'                                         0085
     C                     BITOF'6'       CNFI
     C                     BITON'7'       CNFI
     C                     UPDATCLOANCLF
     C                     END                                              0085
     C**
     C* Count the number of confirmations generated
     C**
     C                     ADD  1         CCOUNT  50
     C**
     C                     ENDSR
     C*****************************************************************
     C/EJECT
     C********************************************************************
     C*
     C* AUDIT SUBROUTINE TO PRODUCE THE AUDIT REPORT
     C*
     C********************************************************************
     C*
     C           AUDIT     BEGSR                           *** AUDIT ***
     C**
     C* Print the header format
     C**
     C                     WRITELE0426AH
     C**
     C* Print the detail format if any confirmations have been printed
     C**
     C           CCOUNT    IFGT 0
     C**
     C                     WRITELE0426A1
     C**
     C                     ELSE
     C**
     C* Or the 'NO DETAILS TO REPORT' Format if no error...
     C**
     C           *INU7     IFEQ '0'
     C                     WRITELE0426A4
     C                     END
     C**
     C                     END
     C**
     C*  Output the Database Error Format if required..
     C**
     C           *INU7     IFEQ '1'
     C                     WRITELE0426A2
     C                     END
     C**
     C* Write the 'END OF REPORT' Format
     C**
     C                     WRITELE0426A3
     C**
     C* Ensure Report is sent to Correct Address via RCF function
     C**
     C                     Z-ADDSFNUMU    ZSNUMU  60
     C**
     C                     CALL 'ZSFILE'
     C***********          PARM           SEQ     5                       CLE006
     C                     PARM           SEQR                            CLE006
     C                     PARM *BLANK    SENTY   3
     C                     PARM           SFILEU
     C                     PARM           ZSNUMU
     C                     PARM           ZSERR   1
     C**
     C*  Error during ZSFILE processing
     C*
     C           ZSERR     IFNE ' '
     C**
     C                     SETON                     U7U8
     C                     END
     C*
     C** Exit program
     C*
     C                     MOVE '1'       *INLR
     C                     RETRN
     C*
     C                     ENDSR
     C*
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C*
     C* INIT      : INITIAL SUBROUTINE
     C* CALLED BY : MAIN PROCESSING
     C* CALLS     : NOTHING
     C*
     C*****************************************************************
     C*
     C           INIT      BEGSR                           *** INIT ***
     C*
     C**   Define LDA data area
     C*
     C           *NAMVAR   DEFN           LDA
     C*
     C** Set up the program name for database error handling
     C**
     C           *LOCK     IN   LDA
     C                     MOVE *BLANKS   DBPGM                           091679
     C                     MOVEL'LE0426'  DBPGM
     C                     OUT  LDA
     C*
     C**   Read in RUNDAT datarea
     C*
     C           *NAMVAR   DEFN           RUNDAT
     C                     IN   RUNDAT
     C/COPY WNCPYSRC,LE0426C005
     C**
     C** Parameter list for program 'AOGELRR0'
     C**
     C           PLISTB    PLIST
     C                     PARM '*MSG   ' @RTCD
     C                     PARM '*FIRST ' @OPTN
     C           SDGELR    PARM SDGELR    DSFDY
     C**
     C** Paramter list for pgm 'ZA0140' (Convert Day no to Date)
     C**
     C           ZDT2      PLIST
     C                     PARM           ZDAYNO                            0085
     C                     PARM           BJDFIN
     C                     PARM           ZDATE   60
     C                     PARM           ZADATE                            0085
     C***********          PARM           RTNERR  10                      061541
     C                     PARM           RTNERR  1                       061541
     C                     PARM           NUMDAT  80
     C**
     C** Paramter list for pgm 'ZA0270' (Convert Date to Dayno)
     C**
     C           ZDT1      PLIST
     C                     PARM           ZDATE
     C                     PARM           BJDFIN
     C***********          PARM           RTNERR  10                      061541
     C                     PARM           RTNERR  1                       061541
     C                     PARM           ZDAYNO
     C*                                                                     0085
     C* PARAMETER LIST FOR AOBSRTR0                                         0085
     C*                                                                     0085
     C           PLIST1    PLIST                                            0085
     C                     PARM '*MSG   ' @RTCD   7                         0085
     C                     PARM '*KEY   ' @OPTN   7                         0085
     C                     PARM           KEY1    3                         0085
     C                     PARM           KEY2    2                         0085
     C********** SDBSRT    PARM SDBSRT    DSFDY                       0085CSD006
     C           SDBSRT    PARM SDBSRT    DSSDY                           CSD006
     C*                                                                   CLE006
     C** Parameter list for AOCUSTR0                                      CLE006
     C*                                                                   CLE006
     C           PLIST2    PLIST                                          CLE006
     C                     PARM '*BLANKS' @RTCD                           CLE006
     C                     PARM '*KEY   ' @OPTN                           CLE006
     C                     PARM           KEYC1  10                       CLE006
     C                     PARM           KEYSTS  7                       CLE006
     C           SDCUST    PARM SDCUST    DSSDY                           CLE006
     C*                                                                   CLE006
     C** Parameter list for program 'AONOSTR0'                            CLE006
     C*                                                                   CLE006
     C           PLISTC    PLIST                                          CLE006
     C                     PARM '*MSG   ' @RTCD                           CLE006
     C                     PARM '*KEY   ' @OPTN                           CLE006
     C                     PARM           KEYA    6                    A  CLE006
     C                     PARM           KEYB    3                    B  CLE006
     C**********           PARM           KEYC    4                    C               CLE006 CGL029
     C                     PARM           KEYC   10                    C                      CGL029
     C                     PARM           KEYD    2                    D  CLE006
     C                     PARM           KEYE    2                    E  CLE006
     C                     PARM           KEYF    3                    F  CLE006
     C                     PARM           KEYG   10                    G  CLE006
     C                     PARM           KEYH    1                    H  CLE006
     C           SDNOST    PARM SDNOST    DSFDY                           CLE006
     C*                                                                   CLE006
     C           PLISTF    PLIST                                          CLE006
     C                     PARM '*MSG   ' @RTCD   7                       CLE006
     C                     PARM '*KEY   ' @OPTN                           CLE006
     C                     PARM           ARCD    8                       CLE006
     C           SDCNST    PARM SDCNST    DSFDY                           CLE006
     C*                                                                   CLE006
     C** Parameter list for program 'AOCUSTR0'                            CLE006
     C*                                                                   CLE006
     C           PLISTR    PLIST                                          CLE006
     C                     PARM '*MSG   ' @RTCD                           CLE006
     C                     PARM '*KEY   ' @OPTN                           CLE006
     C                     PARM           CKEY   10                       CLE006
     C                     PARM           KEYSTS  7                       CLE006
     C           SDCUST    PARM SDCUST    DSSDY                           CLE006
      ***********                                                  135620 154455
     C***********KOAMT     KLIST                                   135620 154455
     C***********          KFLD           BRCAP   3                135620 154455
     C***********          KFLD           CNUMP   60               135620 154455
     C***********          KFLD           LNRFP   60               135620 154455
     C***********          KFLD           VDATSV  50               135620 154455
     C*
     C**  Set up copyright
     C*
     C                     MOVEACPY@      BIS@   80
     C*
     C* Read first ICD details for audit report heading
     C*
     C                     CALL 'AOBANKR0'
     C                     PARM *BLANKS   @RTCD   7
     C                     PARM '*FIRST ' @OPTN   7
     C           SDBANK    PARM SDBANK    DSFDY
     C*
     C** Error Processing
     C*
     C           @RTCD     IFNE *BLANKS
     C           *LOCK     IN   LDA                        ************
     C                     MOVEL'SDBANKPD'DBFILE           * DBERR 01 *
     C                     Z-ADD1         DBASE            ************
     C                     MOVEL'*FIRST'  DBKEY
     C                     OUT  LDA
     C*
     C                     EXSR *PSSR
     C                     EXSR AUDIT
     C                     END
     C**
     C* Check whether the date format indicator Id set for DDMMYY or
     C* MMDDYY
     C           BJDFIN    IFEQ 'M'
     C                     MOVE '1'       *IN98
     C                     END
     C*
     C* Read trading details file to check whether the confirmation
     C* should include the branch code:- BLBNOC set to 'Y' if it should
     C*
     C                     CALL 'AOTRADR0'
     C                     PARM *BLANKS   @RTCD   7
     C                     PARM '*FIRST ' @OPTN   7
     C           SDTRAD    PARM SDTRAD    DSFDY
     C*
     C** Error Processing
     C*
     C           @RTCD     IFNE *BLANKS
     C           *LOCK     IN   LDA                        ************
     C                     MOVEL'SDTRADPD'DBFILE           * DBERR 02 *
     C                     Z-ADD2         DBASE            ************
     C                     MOVEL'*FIRST'  DBKEY
     C                     OUT  LDA
     C*
     C                     EXSR *PSSR
     C                     EXSR AUDIT
     C                     END
     C**
     C           BLBNOC    IFEQ 'Y'
     C                     MOVE '1'       *IN10
     C                     END
     C*                                                                   CLE006
     C** Test ourselves or nostro, and branch name on confirmation in DS  CLE006
     C*                                                                   CLE006
     C           BLONOC    COMP 'O'                  1818                 CLE006
      *                                                                   CLE006
      ** Check if CLE006 is switched on                                   CLE006
      *                                                                   CLE006
     C                     CALL 'AOSARDR0'                                CLE006
     C                     PARM *BLANKS   @RTCD                           CLE006
     C                     PARM '*KEY   ' @OPTN                           CLE006
     C                     PARM 'CLE006'  PSARD   6                       CLE006
     C           SCSARD    PARM SCSARD    DSFDY                           CLE006
     C*                                                                   CLE006
     C** Error Processing                                                 CLE006
     C*                                                                   CLE006
     C           @RTCD     IFEQ *BLANKS                                   CLE006
     C                     MOVE 'Y'       CLE006  1                       CLE006
     C                     ELSE                                           CLE006
     C                     MOVE 'N'       CLE006                          CLE006
     C           @RTCD     IFNE '*NRF    '                                CLE006
     C           *LOCK     IN   LDA                        ************   CLE006
     C                     MOVEL'SCSARDPD'DBFILE           * DBERR 15 *   CLE006
     C                     Z-ADD15        DBASE            ************   CLE006
     C                     MOVEL'CLE006'  DBKEY                           CLE006
     C                     OUT  LDA                                       CLE006
     C*                                                                   CLE006
     C                     EXSR *PSSR                                     CLE006
     C                     EXSR AUDIT                                     CLE006
     C                     ENDIF                                          CLE006
     C                     ENDIF                                          CLE006
      *                                                                   CLE005
      *                                                                   CLE015
      ** Check if CLE007 is switched on                                   CLE015
      *                                                                   CLE015
     C                     CALL 'AOSARDR0'                                CLE015
     C                     PARM *BLANKS   @RTCD                           CLE015
     C                     PARM '*KEY   ' @OPTN                           CLE015
     C                     PARM 'CLE007'  PSARD   6                       CLE015
     C           SCSARD    PARM SCSARD    DSFDY                           CLE015
     C*                                                                   CLE015
     C** Error Processing                                                 CLE015
     C*                                                                   CLE015
     C           @RTCD     IFEQ *BLANKS                                   CLE015
     C                     MOVE 'Y'       CLE007  1                       CLE015
     C                     ELSE                                           CLE015
     C                     MOVE 'N'       CLE007                          CLE015
     C           @RTCD     IFNE '*NRF    '                                CLE015
     C           *LOCK     IN   LDA                        ************   CLE015
     C                     MOVEL'SCSARDPD'DBFILE           * DBERR 20 *   CLE015
     C                     Z-ADD20        DBASE            ************   CLE015
     C                     MOVEL'CLE007'  DBKEY                           CLE015
     C                     OUT  LDA                                       CLE015
     C*                                                                   CLE015
     C                     EXSR *PSSR                                     CLE015
     C                     EXSR AUDIT                                     CLE015
     C                     ENDIF                                          CLE015
     C                     ENDIF                                          CLE015
      *                                                                   CLE015
      ** Check if CLE005 is switched on                                   CLE005
      *                                                                   CLE005
     C                     CALL 'AOSARDR0'                                CLE005
     C                     PARM *BLANKS   @RTCD                           CLE005
     C                     PARM '*KEY   ' @OPTN                           CLE005
     C                     PARM 'CLE005'  PSARD   6                       CLE005
     C           SCSARD    PARM SCSARD    DSFDY                           CLE005
     C*                                                                   CLE005
     C** Error Processing                                                 CLE005
     C*                                                                   CLE005
     C           @RTCD     IFEQ *BLANKS                                   CLE005
     C                     MOVE 'Y'       CLE005  1                       CLE005
     C                     ELSE                                           CLE005
     C                     MOVE 'N'       CLE005                          CLE005
     C           @RTCD     IFNE '*NRF    '                                CLE005
     C           *LOCK     IN   LDA                        ************   CLE005
     C                     MOVEL'SCSARDPD'DBFILE           * DBERR 17 *   CLE005
     C                     Z-ADD17        DBASE            ************   CLE005
     C                     MOVEL'CLE005'  DBKEY                           CLE005
     C                     OUT  LDA                                       CLE005
     C*                                                                   CLE005
     C                     EXSR *PSSR                                     CLE005
     C                     EXSR AUDIT                                     CLE005
     C                     ENDIF                                          CLE005
     C                     ENDIF                                          CLE005
      *                                                                   CEU004
      ** Check if CEU004 is installed                                     CEU004
      *                                                                   CEU004
     C                     CALL 'AOSARDR0'                                CEU004
     C                     PARM *BLANKS   @RTCD                           CEU004
     C                     PARM '*KEY   ' @OPTN                           CEU004
     C                     PARM 'CEU004'  PSARD   6                       CEU004
     C           SCSARD    PARM SCSARD    DSFDY                           CEU004
      *                                                                   CEU004
      ** Error Processing                                                 CEU004
      *                                                                   CEU004
     C           @RTCD     IFEQ *BLANKS                                   CEU004
     C                     MOVE 'Y'       CEU004  1                       CEU004
     C                     ELSE                                           CEU004
     C                     MOVE 'N'       CEU004                          CEU004
     C           @RTCD     IFNE '*NRF    '                                CEU004
     C           *LOCK     IN   LDA                        ************   CEU004
     C                     MOVEL'SCSARDPD'DBFILE           * DBERR 18 *   CEU004
     C                     Z-ADD18        DBASE            ************   CEU004
     C                     MOVEL'CEU004'  DBKEY                           CEU004
     C                     OUT  LDA                                       CEU004
     C                     EXSR *PSSR                                     CEU004
     C                     EXSR AUDIT                                     CEU004
     C                     ENDIF                                          CEU004
     C                     ENDIF                                          CEU004
      *                                                                   CEU020
      ** Check if CEU020 is Installed                                     CEU020
      *                                                                   CEU020
     C                     CALL 'AOSARDR0'                                CEU020
     C                     PARM *BLANKS   @RTCD                           CEU020
     C                     PARM '*KEY   ' @OPTN                           CEU020
     C                     PARM 'CEU020'  PSARD   6                       CEU020
     C           SCSARD    PARM SCSARD    DSFDY                           CEU020
      *                                                                   CEU020
      ** Error Processing                                                 CEU020
      *                                                                   CEU020
     C           @RTCD     IFEQ *BLANKS                                   CEU020
     C                     MOVE 'Y'       CEU020  1                       CEU020
     C                     ELSE                                           CEU020
     C                     MOVE 'N'       CEU020                          CEU020
     C           @RTCD     IFNE '*NRF    '                                CEU020
     C           *LOCK     IN   LDA                        ************   CEU020
     C                     MOVEL'SCSARDPD'DBFILE           * DBERR 19 *   CEU020
     C                     Z-ADD19        DBASE            ************   CEU020
     C                     MOVEL'CEU020'  DBKEY                           CEU020
     C                     OUT  LDA                                       CEU020
      *                                                                   CEU020
     C                     EXSR *PSSR                                     CEU020
     C                     EXSR AUDIT                                     CEU020
     C                     ENDIF                                          CEU020
     C                     ENDIF                                          CEU020
      *                                                                                       CLE031
      ** Access SAR details file to see if Customer Lending                                   CLE031
      ** Enhancements - settlement of other currencies allowed.                               CLE031
      *                                                                                       CLE031
     C                     CALL 'AOSARDR0'                                                    CLE031
     C                     PARM *BLANK    @RTCD                                               CLE031
     C                     PARM '*KEY   ' @OPTN                                               CLE031
     C                     PARM 'CLE031'  PSARD                                               CLE031
     C           SCSARD    PARM SCSARD    DSFDY                                               CLE031
      *                                                                                       CLE031
     C                     MOVE 'N'       CLE031                                              CLE031
     C           @RTCD     IFEQ *BLANK                                                        CLE031
     C                     MOVE 'Y'       CLE031  1                                           CLE031
     C                     ELSE                                                               CLE031
     C           @RTCD     IFNE '*NRF   '                                                     CLE031
     C           *LOCK     IN   LDA                                                           CLE031
     C                     MOVEL'SCSARDPD'DBFILE           ************                       CLE031
     C                     Z-ADD37        DBASE            * DBERR 31 *                       CLE031
     C                     MOVEL'CLE031'  DBKEY            ************                       CLE031
     C                     OUT  LDA                                                           CLE031
     C                     EXSR *PSSR                                                         CLE031
     C                     ENDIF                                                              CLE031
     C                     ENDIF                                                              CLE031
      *                                                                   CLE033
      ** Check if CLE033 is Installed                                     CLE033
      *                                                                   CLE033
     C                     CALL 'AOSARDR0'                                CLE033
     C                     PARM *BLANKS   @RTCD                           CLE033
     C                     PARM '*KEY   ' @OPTN                           CLE033
     C                     PARM 'CLE033'  PSARD                           CLE033
     C           SCSARD    PARM SCSARD    DSFDY                           CLE033
      *                                                                   CLE033
      ** Error Processing                                                 CLE033
      *                                                                   CLE033
     C           @RTCD     IFEQ *BLANKS                                   CLE033
     C                     MOVE 'Y'       CLE033  1                       CLE033
     C                     ELSE                                           CLE033
     C                     MOVE 'N'       CLE033                          CLE033
     C           @RTCD     IFNE '*NRF    '                                CLE033
     C           *LOCK     IN   LDA                        ************   CLE033
     C                     MOVEL'SCSARDPD'DBFILE           * DBERR 33 *   CLE033
     C                     Z-ADD33        DBASE            ************   CLE033
     C                     MOVEL'CLE033'  DBKEY                           CLE033
     C                     OUT  LDA                                       CLE033
      *                                                                   CLE033
     C                     EXSR *PSSR                                     CLE033
     C                     EXSR AUDIT                                     CLE033
     C                     ENDIF                                          CLE033
     C                     ENDIF                                          CLE033
     C*                                                                   S01408
     C/COPY WNCPYSRC,LE0426CCP2                                           S01408
     C*                                                                   S01408
     C*
     C                     ENDSR
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C*                                                               *
     C*    * P S S R -  T O   H A N D L E   A B N O R M A L I T I E S *
     C*    ~~~~~~~~~    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ *
     C*    CALLED FROM     :   ALL ABNORMAL CONDITIONS / ERRORS       *
     C*    CALLS           :   AUDIT                                  *
     C*                                                               *
     C*    THIS PROGRAM HANDLES ABNORMAL CONDITIONS SUCH AS READ FAIL *
     C*    CHAIN FAIL ETC, AND PRODUCES A FORMATTED RPG DUMP          *
     C*                                                               *
     C*****************************************************************
      *
     C           *PSSR     BEGSR
      *
     C                     SETON                     U7U8LR
     C           @RUN      IFEQ *BLANKS
     C                     MOVE 'Y'       @RUN    1
     C                     DUMP
     C                     END
      *
     C                     ENDSR
      *
     C********************************************************************
      /EJECT                                                                                  CLE031
      *****************************************************************                       CLE031
      *                                                               *                       CLE031
      *  SRCONV - Subroutine to convert amounts to Euro ccy equivalent*                       CLE031
      *                                                               *                       CLE031
      *  Called By: DETAILS-                                          *                       CLE031
      *             MCDETC -                                          *                       CLE031
      *                                                               *                       CLE031
      *  Calls    : EU0200 pgm                                        *                       CLE031
      *             *PSSR  - Program Error Processing                 *                       CLE031
      *                                                               *                       CLE031
      *****************************************************************                       CLE031
      *                                                                                       CLE031
     C           SRCONV    BEGSR                                                              CLE031
      *                                                                                       CLE031
      ** Access new currency name and decimal places from SDCURRPD                            CLE031
      ** for loan currency.                                                                   CLE031
     C                     CALL 'AOCURRR0'                                                    CLE031
     C                     PARM '*MSG   ' @RTCD                                               CLE031
     C                     PARM '*KEY   ' @OPTN                                               CLE031
     C                     PARM           @CYCD   3                                           CLE031
     C           SDCURR    PARM SDCURR    DSSDY                                               CLE031
      *                                                                                       CLE031
      ** Error Processing                                                                     CLE031
      *                                                                                       CLE031
     C           @RTCD     IFNE *BLANKS                                                       CLE031
     C           *LOCK     IN   LDA                                                           CLE031
     C                     MOVEL'SDCURRPD'DBFILE           ************                       CLE031
     C                     Z-ADD14        DBASE            * DBERR 14 *                       CLE031
     C                     MOVEL@CYCD     DBKEY            ************                       CLE031
     C                     OUT  LDA                                                           CLE031
     C                     EXSR *PSSR                                                         CLE031
     C                     EXSR AUDIT                                                         CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
     C                     MOVE A6INCY    LINCY   1                                           CLE031
     C                     MOVE A6NBDP    LNBDP   10                                          CLE031
      *                                                                                       CLE031
      ** Access new currency name and decimal places from SDCURRPD                            CLE031
      *                                                                                       CLE031
     C                     CALL 'AOCURRR0'                                                    CLE031
     C                     PARM '*MSG   ' @RTCD                                               CLE031
     C                     PARM '*KEY   ' @OPTN                                               CLE031
     C                     PARM           @SYCD   3                                           CLE031
     C           SDCURR    PARM SDCURR    DSSDY                                               CLE031
      *                                                                                       CLE031
      ** Error Processing                                                                     CLE031
      *                                                                                       CLE031
     C           @RTCD     IFNE *BLANKS                                                       CLE031
     C           *LOCK     IN   LDA                                                           CLE031
     C                     MOVEL'SDCURRPD'DBFILE           ************                       CLE031
     C                     Z-ADD14        DBASE            * DBERR 14 *                       CLE031
     C                     MOVEL@CYCD     DBKEY            ************                       CLE031
     C                     OUT  LDA                                                           CLE031
     C                     EXSR *PSSR                                                         CLE031
     C                     EXSR AUDIT                                                         CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
     C                     MOVE A6INCY    SINCY   1                                           CLE031
     C                     MOVE A6NBDP    SNBDP   10                                          CLE031
      *                                                                                       CLE031
     C           LINCY     IFEQ 'Y'                                                           CLE031
     C           SINCY     OREQ 'Y'                                                           CLE031
      *                                                                                       CLE031
     C                     CALL 'EU0200'                                                      CLE031
     C                     PARM *BLANKS   PRTCD   7                                           CLE031
     C                     PARM @VAMT     PFRAM  183                                          CLE031
     C                     PARM @CYCD     PFRCY   3                                           CLE031
     C                     PARM @SYCD     PTOCY   3                                           CLE031
     C                     PARM           WAMTA  150                                          CLE031
     C                     PARM           PINTA  183                                          CLE031
     C                     PARM           PEXRT  159                                          CLE031
     C                     PARM           PMDIN   1                                           CLE031
      *                                                                                       CLE031
      ** Handle Error                                                                         CLE031
      *                                                                                       CLE031
     C           PRTCD     IFNE *BLANKS                                                       CLE031
     C           *LOCK     IN   LDA                                                           CLE031
     C                     MOVEL'EU0200  'DBFILE           ************                       CLE031
     C                     MOVEL'*CALL   'DBKEY            * DBERR 09 *                       CLE031
     C                     Z-ADD9         DBASE            ************                       CLE031
     C                     OUT  LDA                                                           CLE031
     C                     EXSR *PSSR                                                         CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
     C                     ELSE                                                               CLE031
      *                                                                                       CLE031
      ** Convert event amount to facility currency                                            CLE031
      *                                                                                       CLE031
     C                     Z-ADDFCXR      ZEXCH  138                                          CLE031
     C                     MOVE FMDI      ZMD     1                                           CLE031
     C                     Z-ADD@VAMT     ZAMTCI 150                                          CLE031
     C                     MOVE @CYCD     ZCCYI   3                                           CLE031
     C                     MOVE @SYCD     ZCCYO   3                                           CLE031
     C                     Z-ADDLNBDP     ZCDPI   10                                          CLE031
     C                     Z-ADDSNBDP     ZCDPO   10                                          CLE031
     C                     EXSR ZCONV                                                         CLE031
     C                     Z-ADDZAMTCO    WAMTA  150                                          CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
     C                     ENDSR                                                              CLE031
      *****************************************************************                       CLE031
     C/COPY WNCPYSRC,LE0426C009
      /EJECT                                                              066550
     C/COPY ZSRSRC,ZINTDYZ2                                               066550
      /EJECT                                                              066550
     C/COPY ZSRSRC,ZDATE9Z3                                               066550
     C/COPY ZSRSRC,ZDAT10Z2                                               126017
     C/EJECT
     C/COPY WNCPYSRC,LE0426C012
     C/EJECT                                                                                  CLE031
     C/COPY ZSRSRC,ZCONVZ1                                                                    CLE031
      *
**   TITL1E  -  CONSTANT FIELDS USED IN OUR NOSTRO TITLES - SEE DATA STRUC (ENG)
11PAYMENT AT11VALUE DATE14MATURITY DATETO OUR A/C WITH13FEE DUE DATE
14ROLLOVER DATE
**   NAME1E  -  CONSTANT FIELDS USED IN OUR NOSTRO NAME - SEE DATA STRUCTU (ENG)
INSTRUCTIONS TO BE ADVISED DEBIT TO A/C NUMBER
WE WILL SENDWE AWAIT YOUR REMITTANCEAS PER YOUR IN
STRUCTIONS WE SHALL COLLECT REMITTANCEYOURSELVES
**   NAME3E  -  CONSTANT FIELDS USED IN THEIR NOSTRO, SET UP IN DATA STRUC (ENG)
PAYMENT   WE AWAIT YOUR ADVICESPECIAL INSTRUCTIONS
**   ZFMD  -  NUMBER OF DAYS IN THE MONTH
312831303130313130313031
**  POWER - ARRAY OF POWERS FOR CURRENCY CONVERSION                                           CLE031
0000001                                                                                       CLE031
0000010                                                                                       CLE031
0000100                                                                                       CLE031
0001000                                                                                       CLE031
0010000                                                                                       CLE031
0100000                                                                                       CLE031
1000000                                                                                       CLE031
**   ZYDY - YEARS IN DAYS CUMULATIVE IN FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
** CPY@   **      OBJECT COPYRIGHT
(c) Misys International Banking Systems Ltd. 2001
** @YD  USED BY SR. ZDATE9 - YEARS, IN DAYS, CUMULATIVE IN 4 YEAR SPAN
00366007310109601461
** @MD  USED BY SR. ZDATE9 - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
00000000310005900090001200015100181002120024300273003040033400365
