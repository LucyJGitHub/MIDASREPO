0001 H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas LE End of Day Pay/Rec.Telex Ext.')               *
0001 H***********
0002 F*****************************************************************
     F*                                                               *
0003 F*  Midas - Customer Lending Module                              *
0004 F*                                                               *
0005 F*  LE0430 - END OF DAY PAY/RECEIVE TELEX EXTRACT                *
0006 F*                                                               *
      *  (c) Finastra International Limited 2001                      *
      *                                                               *
      *  Last Amend No. MD027395           Date 06Nov19               *
      *  Prev Amend No. MD046248           Date 27Oct17               *
      *                 CLE148             Date 23Jul12               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *                 CPK028             Date 24Jan08               *
      *                 246923             Date 04Jun07               *
      * Midas Plus 1.4 Base ------------------------------------------*
      *                 245691             Date 19Feb07               *
      *                 244872             Date 08Jan07               *
      *                 244733             Date 27Dec06               *
      *                 244461             Date 15Dec06               *
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CSD031             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 CLE042             Date 06Sep05               *
      *                 CLE036             Date 16Oct03               *
      *                 230521             Date 28Oct04               *
      *                 BUG8289            Date 30Aug05               *
      *                 CSW037A            Date 02May05               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 CLE025             Date 20Oct03               *
      *                 CGL029             Date 01Sep03               *
      *                 222373             Date 28Oct03               *
      *                 218782             Date 26Jun03               *
      *                 CLE034             Date 21May03               *
      *                 CLE031             Date 07Feb03               *
      *                 CLE028             Date 27Jun02               *
      * Midas Release 4 --------------- Base -------------------------*
      *                 175758             Date 18May01               *
      * Midas DBA 3.05 -----------------------------------------------*
      *                 184775             Date 15Jan01               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 159932             Date 03May99               *
     F*                 158955 (E45515)    Date 25Jan99               *
     F*                 158956 (BD5315)    Date 04Jul97               *
     F*                 156586             Date 04Mar99               *
     F*                 153369             Date 04Mar99               *
     F*                 137920             Date 29Jun98               *
     F*                 CEU004             Date 02Feb98               *
     F*                 CLE007             Date 22May97               *
     F*                 079567             Date 15Jun95               *
     F*                 S01518             DATE 03OCT94               *
     F*                 036829             DATE 14APR94               *
     F*                 E45727             DATE 23NOV92               *
     F*                 S01270             DATE 12JUN90               *
     F*                 S2659              DATE 12JUN90               *
     F*                 S01194             DATE 04JAN90               *
     F*                 S01117             DATE 25/08/89              *
     F*                 E12046             DATE 25/07/88              *
0003 F*                 E12045             DATE 25/07/88              *
     F*                                                               *
0011 F*---------------------------------------------------------------*
      *                                                               *
      *  MD027395 - Risk loans incorrectly included                   *
      *  MD046248 - Finastra Rebranding                               *
      *  CLE148 - Alpha Loan Reference                                *
      *  CPK028 - Customer numbers should be alphanumeric.            *
      *  246923 - Do not extract principal transfers since settlement *
      *           is not relevant to transfers of principal.          *
      *           Applied DBA3 fix 214050.                            *
      *  245691 - FOOB in LE0530 - wrong hash total in LETX4ZZ        *
      *           Complete 230531 (keep negative sign) in LE0430.     *
      *           Applied part of 232133.                             *
      *  244872 - Allow negative values in hash totalling of LETX2ZZ. *
      *           In conjunction of LE0510's 219063.                  *
      *  244733 - Do not populate CNUM with POCN when fee is          *
      *           processed.                                          *
      *  244461 - Risk loans gnerated incorrect pay/receive message.  *
      *           Apply 218897 and 231337.                            *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CLE042 - Extended Loan Sub Type                              *
      *  CLE036 - Lending Enhancements for Nordea Phase 1 Priority 2: *
      *           Allow repayments in facility currency.              *
      *  230521 - Initialise new field added on PF/LEPXTAB.           *
      *           Recompile over changes in physical file LEPXTAB     *
      *           Applied fix 215643.                                 *
      *  BUG8289- Ensure settlement branch is populated               *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  CLE025 - Credit Lines (Recompile)                            *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  222373 - Parameter Mismatch                                  *
      *  218782 - Check system value Settlement09Postings to decide   *
      *           whether to use Settlement or Transaction Ccy.       *
      *  CLE034 - Lending Enhancements Phase 1 Priority 1A            *
      *  CLE031 - Lending Enhancements.                               *
      *  CLE028 - Flat Rate Personal Loans (Rule of 78s)              *
      *  175758 - Cover Message (MT202) not generated in EOD.         *
     F*  184775 - Truncated amount in case of different settlement    *
     F*           ccy. Apply                                         *
     F*  159932 - FOOB in LE0500, STX1, trailer says 2, calculated 1  *
     F*  158955 - DB error 008 in LE4510 occurred, causing COB to     *
     F*           fail.  LE4510 is looking for a record matured today *
     F*           in CLOAN which has been dropped. If loan is matured *
     F*           today do not output to LEPXTAB.                     *
     F*  158956 - SWIFT messages erroneously produced for settlement  *
     F*           type 01  (install fixes from GEMS passim)           *
     F*  156586 - Do not add 1 to output record count for LETX3PR
     F*           when EAMT zero (it will be excluded from STX3)
     F*  153369 - Future valued Manual Repayments should generate     *
     F*           SWIFT message in COB.                               *
     F*  137920 - EMU Additional Fixes for LE Settlement Currency     *
     F*           Conversion                                          *
      *  CEU004 - LE Settlement Ccy Conversion Upgrade to DBA R2.0    *
     F*  CLE007 - Customer Lending Enhancements - Others (T3)         *
     F*  079567 - Maturity of a risk loan do not need to generate     *
     F*           any messages if there is not interest/fees.         *
     F*           For risk loan , if interest/fee  only output        *
     F*           the interest/fee amount.                            *
     F*           Remove E12045 which was consequent to E48967 (from  *
     F*           LE0400) which has been removed by E20818.           *
     F*  S01518 - BLI Lending SWIFT Enhancements.                     *
     F*  036829 - DB error 009 in LE4510 occurred, causing COB to     *
     F*           fail.  LE4510 is looking for a record in LOAMSDK.   *
     F*           The fix is to make sure that loan amendments        *
     F*           dropped before calling LEC0701 should not be        *
     F*           outputted to LEPXTAB.                               *
     F*  E45727 - Addition of fee seq field to LETX3PR                *
     F*           to enable LE0520 to output a fee sequence on its    *
     F*           report.                                             *
     F*  S01270 - Output of loan fee telexes                          *
0007 F*  S2659  - Midas/CHIPS diskette                                *
     F*  S01194 - Standing data changes                               *
     F*  S01117 - Multibranching                                      *
0007 F*  E12046 - Risk loan appears on the Internal Settlements       *
0008 F*           report with start settlement of the principal       *
0006 F*           amount.                                             *
0007 F*  E12045 - On maturity of a risk loan the amount shown         *
0008 F*           on PAY/RECEIVE telex or internal settlement         *
0006 F*           report does not reflect the outstanding interest    *
0007 F*           only.                                               *
0007 F*                                                               *
0012 F*****************************************************************
     F*  C R E A T I O N     P A R A M E T E R S                      *
     F*                                                               *
     F*                                                               *
     F*****************************************************************
0013 F***LETLX***IP  F     320 24AI     2 DISK                            S01518
     F***LETLX***IP  F     949 24AI     2 DISK                     S01518 CEU004
     ****FLETLX   IP  F    1066 24AI     2 DISK                    CEU004 CLE031
     F***LETLX   IP  F    1087 24AI     2 DISK                     CLE031 CLE034
     F***LETLX   IP  F    1109 24AI     2 DISK                     CLE034 CAP075
     F***LETLX** IP  F    1176 24AI     2 DISK                                         CAP075 CGL029
     F***LETLX** IP  F    1230 24AI     2 DISK                                         CGL029 CLE036
     F*LETLX***IP**F****1268 24AI     2 DISK                                           CGL029 CLE042
     FLETLX   IP  F    1291 24AI     2 DISK                                                   CLE042
0014 F*FTLX   IS  F     180 20AI     2 DISK                               S01117
0014 F***CFTLX** IS  F     200 20AI     2 DISK                                         S01117 CGL029
     F*CFTLX***IS**F*****232 20AI     2 DISK                                           CGL029 CLE042
     FCFTLX   IS  F     236 20AI     2 DISK                                                   CLE042
0015 F*TABLE***IF  F      96 12AI     2 DISK                              S01194
     F*CLINT***IF  F     256  7AI     2 DISK                          U4  S01194
0016 FLETX1HH O   F     180            DISK
0017 F*ETX1PR O   F     180            DISK                               S01117
0017 F***LETX1PR*O   F     200            DISK                     S01117 CEU004
     F***LETX1PR O   F     210            DISK                                         CEU004 CGL029
     F*LETX1PR*O***F*****228            DISK                                           CGL029 CLE042
     FLETX1PR O   F     232            DISK                                                   CLE042
0018 FLETX1ZZ O   F     180            DISK
0016 FLETX2HH O   F     180            DISK
0017 F*ETX2PR O   F     180            DISK                               S01117
0017 F***LETX2PR*O   F     200            DISK                     S01117 CEU004
     F***LETX2PR O   F     210            DISK                                         CEU004 CGL029
     F*LETX2PR*O***F*****228            DISK                                           CGL029 CLE042
     FLETX2PR O   F     232            DISK                                                   CLE042
0018 FLETX2ZZ O   F     180            DISK
0016 FLETX3HH O   F     180            DISK
0017 F*ETX3PR O   F     180            DISK                               S01117
0017 F***LETX3PR*O   F     200            DISK                     S01117 CEU004
     F***LETX3PR O   F     210            DISK                                         CEU004 CGL029
     F*LETX3PR*O***F*****228            DISK                                           CGL029 CLE042
     FLETX3PR O   F     232            DISK                                                   CLE042
0018 FLETX3ZZ O   F     180            DISK
0016 FLETX4HH O   F     180            DISK
0017 F*ETX4PR O   F     180            DISK                               S01117
0017 F***LETX4PR*O   F     200            DISK                     S01117 CEU004
     F***LETX4PR O   F     210            DISK                                         CEU004 CGL029
     F*LETX4PR*O***F*****228            DISK                                           CGL029 CLE042
     FLETX4PR O   F     232            DISK                                                   CLE042
0018 FLETX4ZZ O   F     180            DISK
     FLEPXTAA O   F     320            DISK                           U4
     F***LEPXTAB*O***F     320            DISK                          U4S01518
     F***LEPXTAB*O   F     346            DISK                  U4 S01518 CEU004
     F***LEPXTAB O   F     356            DISK                           U4            CEU004 CGL029
     F***LEPXTAB O   F     392            DISK                           U4            CGL029 230521
     F*LEPXTAB*O***F*****398            DISK                           U4              230521 CLE042
     FLEPXTAB O   F     402            DISK                           U4                      CLE042
     F***LEPXTAC*O***F     320        DISK                            U4  CLE007
     FLEPXTAC UF  F     320            DISK                      A    U4  CLE007
0016 FLETX6HH O   F     180            DISK                           U1  S2659
0017 FLETX6PR O   F     200            DISK                           U1  S2659
0018 FLETX6ZZ O   F     180            DISK                           U1  S2659
0020 F*E0430P1O*  F     132            PRINTER                    S01124  S01117
0016 FLE0430AUO   F     132     OA     PRINTER                            S01117
     F/COPY WNCPYSRC,LE0430F001
0021 F*                                                                  *
0022 F* ID F  C  H  L    FUNCTION OF INDICATORS
0023 F* 01            PAY/RECIEVE REPORTING ACTIONS - HEADER
0024 F* 02            PAY/RECIEVE DETAILS
0025 F* 03            PAY/RECIEVE TRAILER
0026 F* 04            COMMITMENT FEE P/R REPORTING EXTRACT FILE - HEADER
0027 F* 05            COMMITMENT FEE - DETAIL
0028 F* 06            COMMITMENT FEE - TRAILER
0029 F**08******      TABLE FILE - BRANCH CODES                           S01194
0030 F**09******      TABLE FILE - ICD.1 RECORD                           S01194
0031 F**10******      TABLE FILE - ICD.2 RECORD                           S01194
0032 F**11******      TABLE FILE - ICD.5 RECORD                           S01194
0033 F**12******      TABLE FILE - NOSTROS TABLE                          S01194
     F**13******      CLIENT FILE - DETAIL RECORD A                       S01194
0034 F*    40         FIRST CYCLE
0035 F*    21         THEIR NOSTRO NUMERIC
0035 F*    22         SAR CLE007 is on.                                   CLE007
0035 F*    23         Update LEPXTAC                                      CLE007
0035 F*    24         Output extra-record for cover message.              175758
0035 F*    25         Avoid  extra-record to be outputed.                 175758
0036 F*    31         OUTPUT TO LETX1 INDICATOR
0037 F*    32         OUTPUT TO LETX2 INDICATOR
0038 F*    33         OUTPUT TO LETX3 INDICATOR
0039 F*    34         OUTPUT TO LETX4 INDICATOR
0040 F*    35         AMOUNT IS NEGATIVE
     F*    36         OUTPUT TO LEPXT INDICATOR
     F*****41*******  LCYN ='B'                                           S01194
     F*****42*******  CCY = LOCY                                          S01194
     F*    41         ICD:LOCAL CCY NOSTRO - TX OR BKRS' AUTH. = 'B'      S01194
     F*    42         CCY = LOCAL CCY                                     S01194
0042 F*    44         OSAC OR TSEN ARE BLANK
0043 F*    50         SETTLEMENT TYPE = 01
0044 F*    51         SETTLEMENT TYPE = 02 OR 12
     F*    52         SETTLEMENT TYPE = 07
0046 F*    53         SETTLEMENT TYPE = 03,04,05,06
0047 F*    54         INTEREST IS CAPITALISED AND INTEREST AMOUNT = PRAM
     F*    55         SETTLEMENT TYPE = 08
0048 F*    61         PROCESSING TYPE = 61,62,63
0049 F*    64         PROCESSING TYPE = 64,65
0050 F*    66         PROCESSING TYPE = 66,67
     F*****67***      CHAIN FAIL - TABLE                                  S01194
     F*****68***      CHAIN FAIL - CLINT                                  S01194
0051 F*    70         PROCESSING TYPE = 70
0052 F*    71         AMMENDMENT TYPE = 'PI' OR 'ST'
0053 F*    72         AMMENDMENT TYPE = 'MA'
0054 F*    73         AMMENDMENT TYPE = 'RE'
0055 F*    74         AMMENDMENT TYPE = 'IN'
0067 F*       75      PAY/RECEIVE TYPE IS 'P' - PAYMENT OR 'C' - CREDIT.  S2659
0068 F*       76      O/P TO LETX6, SETTLEMENT TYPE 07 - CHIPS PAY/CREDIT.S2659
0056 F*****80*******  DEFAULT BRANCH CODE = 0                             S01194
     F*    81         CREDIT TELEX
0058 F*    83         LETLX FILE OUT OF BALANCE
0059 F*    84         CFTLX FILE OUT OF BALANCE
0060 F*        L1     CHANGE OF BRANCH CODE
0075 F*          U1   CUST.LEND/CHIPS INTERFACE PRESENT                   S2659
     F*        U4     CUST.LEND/SWIFT MODULE PRESENT
0061 F*        U7+U8  DATABASE ERROR
     E                    CPY@    1   1 80
     E                    POWER   1   7  7 3             POWER ARRAY      CLE031
     E                    SVAL    1   1 20                                                    218782
0062 F*        U8     FILE CONTROLS OUT OF BALANCE
0069 I*
0070 I**      PAY/RECEIVE REPORTING ACTIONS - HEADER
0071 I*
0072 ILETLX   NS  01   1 CH
0073 I                                        1   1 RECI
0074 I*
0075 I**      DETAIL
0076 I*
0077 I        NS  02   1 CD
0078 I                                        1   1 RECI
0079 I**********                              2   70LNRF                                      CLE148
     I                                        2   7 LNRF                                      CLE148
0080 I                                        8  120VDAT
0081 I                                       13  150LASN
0082 I                                       16  160MRIN
0083 I                                       17  18 LTYP
0084 I                                       19  20 SUTP
0085 I                                       21  220PTYP
0086 I                                       23  24 AMTP
0087 I                                       25  260PRSQ
0088 I                                       27  280BRTT
0089 I                                    P  29  347RTSP
0090 I                                       35  37 CCY
0091 I                                    P  38  440PRAM
0092 I                                    P  45  510INTA
0093 I                                    P  52  580WTXA
0094 I                                    P  59  650FFAM
0095 I                                    P  66  720TAMT
0096 I***********                            73  750BRCD  L1              S01117
0096 I                                       73  75 BRCA  L1              S01117
0097 I**********                             76  810CNUM                                      CSD027
0097 I                                       76  81 CNUM                                      CSD027
0098 I                                       82  820REPT
0099 I                                       83  83 AUTO
0100 I                                       84  84 STAI
0101 I                                       85  860SETP
0102 I**********                             87  98 OSAC                                      CGL029
     I                                       87  98 OSACQQ                                    CGL029
0103 I                                       99 108 TSEN
0104 I                                      109 118 FACO
0105 I                                      119 208 SPI
0106 I                                      209 209 LAIN
0107 I                                    P 210 2157BRTE
0108 I                                      216 216 SPIN
0109 I                                      217 2170CALC
0110 I                                      218 218 WTIN
0111 I                                      219 219 LLAG
0112 I                                      220 220 LWOI
0113 I                                      221 2250XAVD
0114 I                                      226 2280XASQ
0115 I**********                            229 2340FCUS                                      CSD027
0115 I                                      229 234 FCUS                                      CSD027
0116 I                                      235 2370FTYP
0117 I                                      238 2390FSEQ
0118 I**********                            240 2450RLON                                      CSD027
     I                                      240 245 RLON                                      CSD027
0119 I                                      246 2470FECD
0120 I                                      248 248 PDNI
0121 I                                      249 249 ACTI
0122 I                                      250 250 CNFY
0123 I                                      251 251 TLXY
0124 I                                      252 252 CBLY
0125 I                                      253 253 INTC
0126 I                                      254 254 NACD
0127 I                                      255 255 ACBI
     I                                      261 263 OSBR                  S01117
0128 I                                    P 311 3130ORED
0129 I                                    P 314 3160LCD
0130 I                                      317 317 CHTP
0131 I                                    P 318 3200TNLU
     I                                      321 3220RSTM                  S01518
     I**********                            323 334 RONS                               S01518 CGL029
     I                                      323 334 RONSQQ                                    CGL029
     I                                      335 342 RIBN                  S01518
     I                                      343 377 RIBA                  S01518
     I**********                            378 3830ROBN                               S01518 CSD027
     I**********                            384 3890ROCN                               S01518 CSD027
     I                                      378 383 ROBN                                      CSD027
     I                                      384 389 ROCN                                      CSD027
     I                                      390 3910PSTM                  S01518
     I**********                            392 403 PONS                               S01518 CGL029
     I                                      392 403 PONSQQ                                    CGL029
     I                                      404 411 PIBN                  S01518
     I                                      412 446 PIBA                  S01518
     I**********                            447 4520POBN                               S01518 CSD027
     I**********                            453 4580POCN                               S01518 CSD027
     I                                      447 452 POBN                                      CSD027
     I                                      453 458 POCN                                      CSD027
     I                                      459 466 RCRN                  S01518
     I                                      467 501 RCRA                  S01518
     I                                      502 509 RVNO                  S01518
     I                                      510 517 AWBN                  S01518
     I                                      518 552 AWBA                  S01518
     I                                      553 560 BENN                  S01518
     I                                      561 595 BENA                  S01518
     I                                      596 630 DTP1                  S01518
     I                                      631 665 DTP2                  S01518
     I                                      666 700 DPT3                  S01518
     I                                      701 735 DPT4                  S01518
     I                                      736 738 DCHG                  S01518
     I                                      739 773 BTB1                  S01518
     I                                      774 808 BTB2                  S01518
     I                                      809 843 BTB3                  S01518
     I                                      844 878 BTB4                  S01518
     I                                      879 913 BTB5                  S01518
     I                                      914 948 BTB6                  S01518
     I                                      949 949 CVMR                  S01518
     I                                      976 976 GPRT                                      246923
     I                                     10611063 SCCY                  CEU004
     I                                     10641066 ICCY                  CEU004
     I                                     10671067 ECIN                  CEU020
     I                                     10681068 REPI                                      CAS005
     I                                    P106910750CHDU                                      CLE028
     I                                    P107610820INTN                                      CAS005
     I                                    P108310890PRAMN                                     CAS005
     I                                    P109010968REXR                  CLE031
     I                                     10971097 REXI                  CLE031
     I                                     10981100 PSCY                  CLE031
     I                                    P110111078PEXR                  CLE031
     I                                     11081108 PEXI                  CLE031
     I                                     11091109 STAL                                      CLE034
     I                                     11101129 FRNT                                      CAP075
     I                                     11301149 AFRT                                      CAP075
     I                                     11501150 REPA                                      CAP075
     I                                     11511176 TMST                                      CAP075
     I                                     11771194 OSAC                                      CGL029
     I                                     11951212 RONS                                      CGL029
     I                                     12131230 PONS                                      CGL029
     I                                     12801283 CLAS                                      CLE042
0132 I*
0133 I**      TRAILER
0134 I*
0135 I        NS  03   1 CT
0136 I                                        1   1 RECI
0137 I                                    P  17  190NOREA
0138 I*
0139 I**      CATCHALL
0140 I*
0141 I        NS
0142 I                                        1   1 RECI
0143 I*
0144 I**      COMMITMENT FEE P/R REPORTING EXTRACT FILE - HEADER
0145 I*
0146 ICFTLX   NS  04   1 CH
0147 I                                        1   1 RECI
0148 I*
0149 I**      DETAILS
0150 I*
0151 I        NS  05   1 CD
0152 I                                        2   2 PYRC
0153 I                                        3   40SETP
0154 I                                        5   7 CCY
0155 I**********                              8  19 OSAC                                      CGL029
     I                                        8  19 OSACQQ                                    CGL029
0156 I                                    P  20  220VDAT
0157 I                                       23  32 TSEN
0158 I**********                             33  380CNUM                                      CSD027
0158 I                                       33  38 CNUM                                      CSD027
0159 I                                       39  44 FCLN
0160 I                                    P  45  510EAMT
0161 I                                       52  52 RCDT
0162 I                                       53  54 AMTP
0163 I                                       55  570LASN
0164 I                                       58  67 FACO
0165 I                                       68 157 SPI
0166 I                                      158 1580PRI1
0167 I                                      159 1590PRI2
0168 I                                      160 1600PRI3
0169 I                                      161 1610PRI4
0170 I**********                            162 1670BICN                                      CSD027
0170 I                                      162 167 BICN                                      CSD027
0171 I                                      168 169 LTYP
0172 I                                      170 171 SUTP
0173 I                                      172 1730PTYP
0174 I                                      174 1740TIND
0175 I***********                           175 1770BRCD  L1              S01117
0175 I                                      175 177 BRCA  L1              S01117
0176 I                                      178 178 INTC
     I                                      179 181 OSBR                  S01117
     I                                      182 1830FEESEQ                E45727
     I                                      201 203 SCCY                                      CLE036
     I                                      215 232 OSAC                                      CGL029
     I                                      233 236 CLAS                                      CLE042
0177 I*
0178 I**    TRAILER
0179 I*
0180 I        NS  06   1 CT
0181 I                                        1   1 RECI
0182 I                                    P   2   40NORE
0183 I                                    P   5  120HRWN
0184 I                                    P  13  140HRDC
0185 I*
0186 I**   CATCHALL
0187 I*
0188 I        NS
0179 I*                                                                   CLE007
0146 ILEPXTAC NS       1 CT                                               CLE007
0181 I                                        1   1 RECI                  CLE007
0182 I                                    P   2   40NORE                  CLE007
0183 I                                    P   5  120HRWN                  CLE007
0184 I                                    P  13  140HRDC                  CLE007
0189 I*
0190 I*****TABLE*FILE*-*INSTALLATION*CONTROL*DATA*RECORD*1.               S01194
0191 I*                                                                   S01194
0192 I*TABLE***NS  09   2 C0   3 C1  12 C1                                S01194
0193 I*******AND      13 C0                                               S01194
0194 I**********                              1   1 RECI                  S01194
0195 I**********                              2   30RECT                  S01194
0196 I**********                             12  130RCDE                  S01194
0197 I**********                             14  66 TITL                  S01194
0198 I***********                            67  67 DATF                  S01194
0199 I**********                             68  700DFBR                  S01194
0200 I**********                             74  74 MODI1                 S01194
0201 I**********                             75  75 MODI2                 S01194
0202 I**********                             76  76 MODI3                 S01194
0203 I***********                         P  77  790RUND                  S01194
0204 I***********                            80  86 RUNA                  S01194
0205 I**********                             87  870SFLG                  S01194
0206 I**********                          P  90  920LCD                   S01194
0207 I**********                             93  93 CHTP                  S01194
0208 I**********                          P  94  960TNLU                  S01194
0209 I*
0210 I*****TABLE*FILE*-*INSTALLATION*CONTROL*DATA*RECORD*2.               S01194
0211 I*
0212 I********NS  10   1 CD   2 C0   3 C1                                 S01194
0213 I*******AND      12 C1  13 C1                                        S01194
0214 I**********                              1   1 RECI                  S01194
0215 I**********                              2   30RECT                  S01194
0216 I**********                             12  130RCDE                  S01194
0217 I**********                             14  16 BCCY                  S01194
0218 I**********                             17  19 BCYL                  S01194
0219 I**********                             20  22 HOCY                  S01194
0220 I**********                             23  280HEAD                  S01194
0221 I**********                          P  29  310APDA                  S01194
0222 I**********                             35  35 APFQ                  S01194
0223 I**********                          P  36  380LOGS                  S01194
0224 I**********                             39  40 CUZR                  S01194
0225 I**********                          P  41  430DNWD                  S01194
0226 I**********                             44  460BVLP                  S01194
0227 I**********                             47  49 LOCY                  S01194
0228 I**********                             50  510FDAY                  S01194
0229 I**********                             52  52 ACLD                  S01194
0230 I***********                            53  53 MBIN                  S01194
0231 I**********                             86  86 ISAV                  S01194
0232 I**********                          P  87  890LLOG                  S01194
0233 I**********                          P  90  920LCD                   S01194
0234 I**********                             93  93 CHTP                  S01194
0235 I**********                          P  94  960TNLU                  S01194
0236 I*                                                                   S01194
0237 I*****TABLE*FILE*-*INSTALLATION*CONTROL*DATA*RECORD*5.               S01194
0238 I*                                                                   S01194
0239 I********NS  11   1 CD   2 C0   3 C1                                 S01194
0240 I*******AND      12 C4  13 C0                                        S01194
0241 I**********                              1   1 RECI                  S01194
0242 I**********                              2   30RECT                  S01194
0243 I**********                             12  130RCDE                  S01194
0244 I**********                             18  210CSAC                  S01194
0245 I**********                             22  22 TLII                  S01194
0246 I**********                             23  23 MCRI                  S01194
0247 I**********                          P  24  250MCEP                  S01194
0248 I**********                             26  270MCLP                  S01194
0249 I**********                             28  28 FRDI                  S01194
0250 I**********                             29  29 BRCF                  S01194
0251 I**********                             30  350PSCN                  S01194
0252 I**********                             36  380DLBR                  S01194
0253 I**********                             39  420FRPA                  S01194
0254 I**********                             43  460FRPC                  S01194
0255 I**********                             47  49 USCY                  S01194
0256 I**********                             50  52 STCY                  S01194
0257 I**********                          P  53  553MBGE                  S01194
0258 I**********                             60  60 LCYN                  S01194
0259 I**********                          P  90  920LCD                   S01194
0260 I**********                             93  93 CHTP                  S01194
0261 I**********                          P  94  960TNLU                  S01194
0262 I*
0263 I********TABLE*FILE*-*BRANCH*CODES*TABLE                             S01194
0264 I*
0265 I********NS  08   1 CD   2 C1   3 C0                                 S01194
0266 I**********                              1   1 RECI                  S01194
0267 I**********                              2   30RECT                  S01194
0268 I***********                            11  130BRCD                  S01194
0269 I**********                             14  43 BRNM                  S01194
0270 I**********                             44  490BICN                  S01194
0271 I**********                             50  51 LOCC                  S01194
0272 I***********                            52  53 CMPY                  S01194
0273 I**********                          P  90  920LCD                   S01194
0274 I**********                             93  93 CHTP                  S01194
0275 I**********                          P  94  960TNLU                  S01194
0276 I*
0277 I*****TABLE*FILE*-*NOSTROS*RECORD.                                   S01194
0278 I*
0279 I********NS  12   1 CD   2 C7   3 C0                                 S01194
0280 I**********                              1   1 RECI                  S01194
0281 I**********                              2   30RECT                  S01194
0282 I**********                              9  11 CCY                   S01194
0283 I**********                             12  130NOSN                  S01194
0284 I**********                             16  29 ONAC                  S01194
0285 I**********                             30  350CNUMPH                S01194
0286 I**********                             36  370ACSQ                  S01194
0287 I**********                             38  410ACOD                  S01194
0288 I**********                          P  90  920LCD                   S01194
0289 I**********                             93  93 CHTP                  S01194
0290 I**********                          P  94  960TNLU                  S01194
0291 I*
0292 I*******CATCHALL*FOR*TABLE*FILE                                      S01194
0293 I*
0294 I********NS                                                          S01194
0295 I**********                              1   1 RECI                  S01194
0296 I*
     I*****CLIENT*FILE*-*CUSTOMER*STANDING*DATA*RECORD.                   S01194
     I*
     I*CLINT***NS  13   1 CD   8 CA                                       S01194
     I**********                              1   1 RECI                  S01194
     I**********                              2   70CNUMCL                S01194
     I**********                              8   8 RCDTCL                S01194
     I**********                              9  28 CRNM                  S01194
     I**********                             29  38 CTWN                  S01194
     I**********                             39  48 CSNM                  S01194
     I**********                             49  56 CASK                  S01194
     I**********                             57  68 TELX                  S01194
     I*
     I**********                             69  80 CSID                  S01194
     I**********                             81  82 ACOC                  S01194
     I**********                             83  83 CBSI                  S01194
     I**********                             84  85 CCTZ                  S01194
     I**********                             86  87 CLOC                  S01194
     I**********                             88  930CPAR                  S01194
0268 I***********                            11  130BRCD                  S01194
     I**********                             97  980LINS                  S01194
     I**********                             99 1010LIND                  S01194
     I**********                          P 102 1040DASU                  S01194
     I**********                          P 105 1070CDIC                  S01194
     I**********                          P 108 1100DADE                  S01194
     I**********                            111 111 CMIN                  S01194
     I**********                            112 112 CTYP                  S01194
     I**********                            113 124 TELF                  S01194
     I**********                            125 133 CHID                  S01194
     I**********                            134 136 CHAB                  S01194
     I**********                            195 195 GSFM                  S01194
     I**********                          P 250 2520LCD                   S01194
     I**********                            253 253 CHTP                  S01194
     I**********                          P 254 2560TNLU                  S01194
     I*
     I******CATCHALL                                                      S01194
     I*
     I********NS                                                          S01194
     I**********                              1   1 RECI                  S01194
     I/COPY WNCPYSRC,LE0430I002
0297 I********************************************************************
0298 I*
0299 I*
0300 I** DATA STRUCTURE
0301 I*
0302 I**********  DS                                                      S01194
0303 I**********                              1  12 NOSKEY                S01194
0304 I**********                              1   2 NOSTAB                S01194
0305 I**********                              8  10 CCY                   S01194
0306 I**********                             11  12 NOSNN                 S01194
0307 I*
0308 I**     LOCAL DATA AREA FOR DATABASE ERROR REFERENCE
0309 I*
0310 ILDA        UDS                            256
0271 I***********                           134 138 DBFILE                S01117
0272 I***********                           139 167 DBKEY                 S01117
0273 I***********                           168 175 DBPGM                 S01117
0274 I***********                           176 1770DBASE                 S01117
0271 I                                      134 141 DBFILE                S01117
0272 I                                      142 170 DBKEY                 S01117
0273 I                                      171 180 DBPGM                 S01117
0274 I                                      181 1830DBASE                 S01117
     ISDBANK    E DSSDBANKPD                                              S01194
      **  EXTERNAL DS FOR BANK DETAILS                                    S01194
     I              BJURPT                          TITL                  S01194
     I              BJLCCY                          LOCY                  S01194
     I************  BJRDNB                          RUNDAY         036829 158955
     I              BJDNWD                          DNWD                  158955
      *                                                                   S01194
     ISDGELR    E DSSDGELRPD                                              S01194
      **  EXTERNAL DS FOR GENERAL LEDGER DETAILS                          S01194
      **                                                                  S01194
     ISDTRAD    E DSSDTRADPD                                              S01194
      **  EXTERNAL DS FOR TRADING DETAILS                                 S01194
     I              QQACCD                          ACCDB1                                    CGL029
      **                                                                  S01194
     ISDBRCH    E DSSDBRCHPD                                              S01194
      **  EXTERNAL DS FOR BRANCH CODE DETAILS                             S01194
     I              A8BRNM                          BRNM                  S01194
     I*                                                                   S01194
     ISDCUST    E DSSDCUSTPD                                              S01194
      **  EXTERNAL DS FOR CUSTOMER DETAILS                                S01194
     I              BBCSID                          CSID                  S01194
     I              BBGSFM                          GSFM                  S01194
     I              QQDFAC                          DFACBK                                    CGL029
      *                                                                   CLE031
     ISDCURR    E DSSDCURRPD                                              CLE031
      **  EXTERNAL DS FOR CURRENCY DETAILS                                CLE031
      *                                                                   S01194
     ISDNOST    E DSSDNOSTPD                                              S01194
      **  EXTERNAL DS FOR NOSTRO DETAILS                                  S01194
     I              A7CUST                          CNUMPH                S01194
     I              QQACCD                          ACCDB2                                    CGL029
      *                                                                   S01194
     ISCSARD    E DSSCSARDPD                                              CLE007
     I** Switchable Feature details                                       CLE007
     I*                                                                   CLE007
     I*SDSVAL***E DSSDSVALPD                                                           218782 222373
      ****EXTERNAL DS FOR SYSTEM VALUES                                                218782 222373
      **********                                                                       218782 222373
     IDSFDY     E DSDSFDY                                                 S01194
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01194
     I*                                                                   S01194
     IDSSDY     E DSDSSDY                                                 S01194
     I* SECOND DS FOR ACCESS PROGRAMS, LONG DATA STRUCTURE                S01194
     I*                                                                   S01194
      **                                                                  S01117
0925 I**                                                                  S01117
     I**   FILE INFORMATION DATA STRUCTURE                                S01117
     I**                                                                  S01117
     ISPOOLU      DS                                                      S01117
     I                                       83  92 SFILEU                S01117
     I                                    B 123 1240SFNUMU                S01117
     I**                                                                  S01117
     IRUNDT       DS                                                      S01117
     I**  DATA AREA RUNDAT                                                S01117
     I                                        1   7 RUNA                  S01117
     I                                    P   8  100RUND                  S01117
     I                                       11  11 SSF                   S01117
     I                                       12  12 DATF                  S01117
     I                                       13  13 MBIN                  S01117
0315 I*
     I/COPY WNCPYSRC,LE0430I001
     I/EJECT                                                              S01117
0316 I********************************************************************
0317 I*
     C                     MOVEACPY@      BIS@   80
     C** PARAMETER LIST FOR PROGRAM 'AOBANKR0'                            S01194
     C           PLISTA    PLIST                                          S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDBANK    PARM SDBANK    DSFDY                           S01194
     C**                                                                  S01194
     C** PARAMETER LIST FOR PROGRAM 'AOGELRR0'                            S01194
     C           PLISTB    PLIST                                          S01194
     C                     PARM '*MSG   ' @RTCD                           S01194
     C                     PARM '*FIRST ' @OPTN                           S01194
     C********** SDGELR    PARM SDGELR    DSFDY                                        S01194 CGL029
     C           SDGELR    PARM SDGELR    DSSDY                                               CGL029
     C**                                                                  S01194
     C** PARAMETER LIST FOR PROGRAM 'AOTRADR0'                            S01194
     C           PLISTC    PLIST                                          S01194
     C                     PARM '*MSG   ' @RTCD                           S01194
     C                     PARM '*FIRST ' @OPTN                           S01194
     C           SDTRAD    PARM SDTRAD    DSFDY                           S01194
     C** PARAMETER LIST FOR PROGRAM 'AOBRCHR0'                            S01194
     C*                                                                   S01194
     C           PLIST1    PLIST                                          S01194
     C                     PARM '*MSG   ' @RTCD                           S01194
     C                     PARM '*KEY   ' @OPTN                           S01194
     C                     PARM           BKEY    3                    A  S01194
     C           SDBRCH    PARM SDBRCH    DSFDY                        B  S01194
     C*                                                                   S01194
     C** PARAMETER LIST FOR PROGRAM 'AONOSTR0'                            S01194
     C*                                                                   S01194
     C           PLIST2    PLIST                                          S01194
     C                     PARM '*MSG   ' @RTCD                           S01194
     C                     PARM '*KEY   ' @OPTN                           S01194
     C                     PARM           KEYA    6                    A  S01194
     C                     PARM           KEYB    3                    B  S01194
     C**********           PARM           KEYC    4                    C               S01194 CGL029
     C                     PARM           KEYC   10                                           CGL029
     C                     PARM           KEYD    2                    D  S01194
     C                     PARM           KEYE    2                    E  S01194
     C                     PARM           KEYF    3                    F  S01194
     C                     PARM           KEYG   10                    G  S01194
     C                     PARM           KEYH    1                    H  S01194
     C           SDNOST    PARM SDNOST    DSFDY                           S01194
     C*                                                                   S01194
     C** PARAMETER LIST FOR PROGRAM 'AOCUSTR0'                            S01194
     C*                                                                   S01194
     C           PLIST3    PLIST                                          S01194
     C                     PARM '*MSG   ' @RTCD                           S01194
     C                     PARM '*KEY   ' @OPTN                           S01194
     C                     PARM           CKEY   10                       S01194
     C                     PARM           KEYSTS  7                       S01194
     C           SDCUST    PARM SDCUST    DSSDY                           S01194
      *                                                                   175758
      ** Parameter list for program 'AOSARDR0'                            175758
      *                                                                   175758
     C           PLIST4    PLIST                                          175758
     C                     PARM *BLANKS   @RTCD                           175758
     C                     PARM '*VERIFY' @OPTN                           175758
     C                     PARM 'S01518 ' @SARD   6                       175758
     C           SCSARD    PARM SCSARD    DSFDY                           175758
     C*                                                                   S01194
0319 C**       FIRST CYCLE CALCULATIONS
0320 C*
0321 C   40                GOTO DETAIL
0322 C                     SETON                     40
      **                                                                  S01117
      **   IN THE DATAAREA RUNDAT                                         S01117
      **                                                                  S01117
     C           *NAMVAR   DEFN RUNDAT    RUNDT                           S01117
     C                     IN   RUNDT                                     S01117
     C*    DEFINE LDA                                                     S01117
     C           *NAMVAR   DEFN           LDA                             S01117
     C           *LOCK     IN   LDA                                       S01117
0323 C*
0324 C**         FOR DATABASE ERROR REFERENCE
0325 C*
0326 C                     MOVE 'LE0430'  DBPGM
0327 C                     MOVE ' '       BLANKS 29
0328 C                     MOVE BLANKS    DBKEY
0329 C**********           EXSR ZSYSTM                                    S01194
0330 C***99*****           SETON                     U7U8LR               S01194
0331 C***99*****           MOVE '01'      DBASE                           S01194
0332 C***99*****           MOVE 'TABLE'   DBFILE                          S01194
0333 C***99*****           MOVELZTABKY    DBKEY                           S01194
0334 C***99*****           GOTO ENDDET                                    S01194
0335 C**********           MOVE '11'      ZTABKY                          S01194
0336 C********** ZTABKY    CHAINTABLE                67                   S01194
0337 C**N10*****           SETON                     LRU7U8               S01194
0338 C**N10*****           MOVE '02'      DBASE                           S01194
0339 C**N10*****           MOVE 'TABLE'   DBFILE                          S01194
0340 C**N10*****           MOVE ZTABKY    DBKEY                           S01194
0341 C**N10*****           GOTO ENDDET                                    S01194
0342 C**********           MOVE '40'      ZTABKY                          S01194
0343 C********** ZTABKY    CHAINTABLE                67                   S01194
0344 C**N11*****           SETON                     U7U8LR               S01194
0345 C**N11*****           MOVE '06'      DBASE                           S01194
0346 C**N11*****           MOVE 'TABLE'   DBFILE                          S01194
0347 C**N11*****           MOVE ZTABKY    DBKEY                           S01194
0348 C**N11*****           GOTO ENDDET                                    S01194
     C*                                                                   S01194
     C**    ACCESS BANK DETAILS                                           S01194
     C*                                                                   S01194
     C                     CALL 'AOBANKR0'PLISTA                          S01194
     C           @RTCD     IFNE *BLANKS                                   S01194
     C                     SETON                     U7U8LR               S01194
     C                     MOVE '01'      DBASE                           S01194
     C                     MOVE 'SDBANKPD'DBFILE                          S01194
     C                     GOTO ENDDET                                    S01194
     C                     END                                            S01194
     C*                                                                   158955
     C**    SETUP DATE FOR CHECKING                                       158955
     C*                                                                   158955
     C           DNWD      SUB  1         WDATE   50                      158955
     C*                                                                   S01194
     C**    ACCESS GENERAL LEDGER DETAILS                                 S01194
     C*                                                                   S01194
     C**********           CALL 'AOGELRR0'PLISTB                                       S01194 CGL029
     C                     CALL 'AOGELRR1'PLISTB                                              CGL029
     C           @RTCD     IFNE *BLANKS                                   S01194
     C                     SETON                     U7U8LR               S01194
     C                     MOVE '02'      DBASE                           S01194
     C                     MOVE 'SDGELRPD'DBFILE                          S01194
     C                     GOTO ENDDET                                    S01194
     C                     END                                            S01194
     C*                                                                   S01194
     C**    ACCESS TRADING DETAILS                                        S01194
     C*                                                                   S01194
     C                     CALL 'AOTRADR0'PLISTC                          S01194
     C           @RTCD     IFNE *BLANKS                                   S01194
     C                     SETON                     U7U8LR               S01194
     C                     MOVE '06'      DBASE                           S01194
     C                     MOVE 'SDTRADPD'DBFILE                          S01194
     C                     GOTO ENDDET                                    S01194
     C                     END                                            S01194
      *                                                                   CLE007
      ** Check if CLE007 is ON                                            CLE007
      *                                                                   CLE007
     C                     CALL 'AOSARDR0'                                CLE007
     C                     PARM *BLANKS   @RTCD   7                       CLE007
     C                     PARM '*KEY   ' @OPTN   7                       CLE007
     C                     PARM 'CLE007'  PSARD   6                       CLE007
     C           SCSARD    PARM SCSARD    DSFDY                           CLE007
     C*                                                                   CLE007
     C           @RTCD     IFEQ *BLANK                                    CLE007
     C                     MOVE 'Y'       CLE007  1                       CLE007
     C                     MOVE *ON       *IN22                           CLE007
     C                     ELSE                                           CLE007
     C                     MOVE 'N'       CLE007                          CLE007
     C                     MOVE *OFF      *IN22                           CLE007
     C           @RTCD     IFNE '*NRF    '                                CLE007
     C                     SETON                     U7U8LR               CLE007
     C                     SETON                     99                   CLE007
     C                     MOVEL'SCSARDPD'DBFILE                          CLE007
     C                     MOVEL'CLE007'  DBKEY            ***************CLE007
     C                     MOVEL'04'      DBASE            * DBERROR 04  *CLE007
     C                     EXSR *PSSR                      ***************CLE007
     C                     GOTO ENDDET                                    CLE007
     C                     ENDIF                                          CLE007
     C                     ENDIF                                          CLE007
      *                                                                   CLE031
      ** Check if CLE031 is ON                                            CLE031
      *                                                                   CLE031
     C                     CALL 'AOSARDR0'                                CLE031
     C                     PARM *BLANKS   @RTCD   7                       CLE031
     C                     PARM '*KEY   ' @OPTN   7                       CLE031
     C                     PARM 'CLE031'  PSARD   6                       CLE031
     C           SCSARD    PARM SCSARD    DSFDY                           CLE031
     C*                                                                   CLE031
     C           @RTCD     IFEQ *BLANK                                    CLE031
     C                     MOVE 'Y'       CLE031  1                       CLE031
     C                     ELSE                                           CLE031
     C                     MOVE 'N'       CLE031                          CLE031
     C           @RTCD     IFNE '*NRF    '                                CLE031
     C                     SETON                     U7U8LR               CLE031
     C                     SETON                     99                   CLE031
     C                     MOVEL'SCSARDPD'DBFILE                          CLE031
     C                     MOVEL'CLE031'  DBKEY            ***************CLE031
     C                     MOVEL'13'      DBASE            * DBERROR 13  *CLE031
     C                     EXSR *PSSR                      ***************CLE031
     C                     GOTO ENDDET                                    CLE031
     C                     ENDIF                                          CLE031
     C                     ENDIF                                          CLE031
     C*                                                                                       218782
     C**  Read switchable features file SCSARDPD using access object                          218782
     C**  to determine if switchable feature (CLE033) is switched ON                          218782
     C*                                                                                       218782
     C                     MOVE 'N'       CLE033  1                                           218782
     C*                                                                                       218782
     C                     CALL 'AOSARDR0'                                                    218782
     C                     PARM *BLANKS   @RTCD                                               218782
     C                     PARM '*VERIFY' @OPTN   7                                           218782
     C                     PARM 'CLE033'  @SARD   6                                           218782
     C           SCSARD    PARM SCSARD    DSFDY                                               218782
     C*                                                                                       218782
     C**  If feature is on, set up CLE033 variable                                            218782
     C*                                                                                       218782
     C           @RTCD     IFEQ *BLANKS                                                       218782
      *                                                                                       218782
     C                     MOVE 'Y'       CLE033                                              218782
      *                                                                                       218782
     C                     CALL 'AOSVALR0'                                                    218782
     C                     PARM *BLANKS   @RTCD                                               218782
     C                     PARM SVAL,1    P@OP01 20                                           218782
     C                     PARM *BLANKS   P@VL01200                                           218782
     C                     PARM *BLANKS   P@OP02 20                                           218782
     C                     PARM *BLANKS   P@VL02200                                           218782
     C                     PARM *BLANKS   P@OP03 20                                           218782
     C                     PARM *BLANKS   P@VL03200                                           218782
     C                     PARM *BLANKS   P@OP04 20                                           218782
     C                     PARM *BLANKS   P@VL04200                                           218782
     C                     PARM *BLANKS   P@OP05 20                                           218782
     C                     PARM *BLANKS   P@VL05200                                           218782
     C                     PARM *BLANKS   P@OP06 20                                           218782
     C                     PARM *BLANKS   P@VL06200                                           218782
     C                     PARM *BLANKS   P@OP07 20                                           218782
     C                     PARM *BLANKS   P@VL07200                                           218782
     C                     PARM *BLANKS   P@OP08 20                                           218782
     C                     PARM *BLANKS   P@VL08200                                           218782
     C                     PARM *BLANKS   P@OP09 20                                           218782
     C                     PARM *BLANKS   P@VL09200                                           218782
     C                     PARM *BLANKS   P@OP10 20                                           218782
     C                     PARM *BLANKS   P@VL10200                                           218782
     C********** SDSVAL    PARM SDSVAL    DSSDY                                        218782 222373
      *                                                                                       218782
     C           @RTCD     IFNE *BLANKS                                                       218782
     C                     MOVEL'LE0430  'DBPGM                                               218782
     C                     MOVEL'SDSVALPD'DBFILE                                              218782
     C                     MOVELSVAL,1    DBKEY                                               218782
     C                     Z-ADD17        DBASE                                               218782
     C                     SETON                     U7U8LR               S01194
     C                     GOTO ENDDET                                                        218782
     C                     ENDIF                                                              218782
      *                                                                                       218782
      ** Save value of Settlement09Postings in a one character field                          218782
     C                     MOVELP@VL01    SET09   1                                           218782
     C                     ENDIF                                                              218782
      *                                                                   CEU004
      ** Access SAR details file to see if CEU004 is installed            CEU004
      *                                                                   CEU004
     C                     MOVE 'N'       CEU004  1        Set SAR Flag   CEU004
      *                                                                   CEU004
     C                     CALL 'AOSARDR0'                 Rtv SAR Dtls   CEU004
      *                                                    Input:         CEU004
     C                     PARM *BLANKS   P@RTCD  7        -Return Code   CEU004
     C                     PARM '*VERIFY' P@OPTN  7        -Option        CEU004
     C                     PARM 'CEU004'  P@SARD  6        -SAR No        CEU004
      *                                                    Output:        CEU004
     C           SCSARD    PARM SCSARD    DSFDY            -Format        CEU004
      *                                                                   CEU004
     C           P@RTCD    IFEQ *BLANKS                    If Found       CEU004
     C                     MOVE 'Y'       CEU004            Set SAR Flag  CEU004
      *                                                                   CEU004
     C                     ELSE                            Else           CEU004
     C           P@RTCD    IFNE '*NRF   '                   If # NoRecFnd CEU004
     C                     MOVEL'SCSARDPD'DBFILE             Set File     CEU004
     C                     MOVEL'*VERIFY' DBKEY              Set Key      CEU004
     C                     Z-ADD5         DBASE              Set DBase RefCEU004
     C                     SETON                     U7U8LR  Set Ind      CEU004
     C                     GOTO ENDDET                       Bypass       CEU004
     C                     ENDIF                            End If        CEU004
     C                     ENDIF                           End If         CEU004
      *                                                                   CEU004
     C/COPY WNCPYSRC,LE0430C007
      *                                                                   CEU004
      ** Check if Flat Rate Personal Loans (Rule of 78s) is installed                         CLE028
      *                                                                                       CLE028
     C                     CALL 'AOSARDR0'                                                    CLE028
     C                     PARM *BLANKS   PRTCD   7                                           CLE028
     C                     PARM '*VERIFY' POPTN   7                                           CLE028
     C                     PARM 'CLE028'  PSARD                                               CLE028
     C           SCSARD    PARM SCSARD    DSFDY                                               CLE028
      *                                                                                       CLE028
     C           PRTCD     IFNE *BLANKS                                                       CLE028
     C           PRTCD     ANDNE'*NRF   '                                                     CLE028
     C                     MOVE *ON       *INU7                                               CLE028
     C                     MOVE *ON       *INU8                                               CLE028
     C           *LOCK     IN   LDA                                                           CLE028
     C                     MOVEL'SCSARDPD'DBFILE                                              CLE028
     C                     Z-ADD13        DBASE                                               CLE028
     C                     MOVELPSARD     DBKEY                                               CLE028
     C                     OUT  LDA                                                           CLE028
     C                     GOTO ENDDET                                                        CLE028
     C                     ENDIF                                                              CLE028
      *                                                                                       CLE028
     C           PRTCD     IFEQ *BLANKS                                                       CLE028
     C                     MOVE 'Y'       CLE028  1                                           CLE028
     C                     ELSE                                                               CLE028
     C                     MOVE 'N'       CLE028                                              CLE028
     C                     ENDIF                                                              CLE028
     C*                                                                   S01194
     C******CHECK*LCYN*INDICATOR                                          S01194
     C**    CHECK LOCAL CCY NOSTRO INDICATOR FOR                          S01194
     C**    TELEX OR BANKERS' AUTHORISATION                               S01194
     C********** LCYN      COMP 'B'                      41               S01194
     C           BLLCTB    COMP 'B'                      41               S01194
0349 C*
0350 C******IF*DEFAULT*BRCD*ON*ICRI*CHAIN*TO*BRANCH*CODES*TABLE*FOR       S01117
0350 C*****IF*SINGLE*BRANCH*NON-ZERO*CHAIN*TO*BRANCH*CODES*TABLE*FORS01117S01194
0350 C**    IF SINGLE BRANCH NON-ZERO CHAIN TO SDBRCHPD TABLE FOR   S01117S01194
0351 C*        CUSTOMER NUMBER - ELSE SET ON 80
0352 C***********DFBR      COMP 0                        80               S01117
0353 C**N80*****           MOVEL'10      'ZTABKY                          S01194
0354 C**N80******          MOVE DFBR      ZTABKY                          S01117
0355 C**N80***** ZTABKY    CHAINTABLE                67                   S01194
0356 C**N80N67** RECI      COMP 'D'                  6767                 S01194
     C           MBIN      IFEQ 'N'                                       S01194
     C                     MOVE BJSBRC    BKEY                            S01194
     C**********           CALL 'AOBRCHR0'PLIST1                                       S01194 CGL029
     C                     CALL 'AOBRCHR1'PLIST1                                              CGL029
     C           @RTCD     IFNE *BLANKS                                   S01194
     C                     SETON                     U7U8LR               S01194
     C                     MOVE '03'      DBASE                           S01194
     C                     MOVE 'SDBRCHPD'DBFILE                          S01194
     C                     MOVE BKEY      DBKEY                           S01194
     C                     GOTO ENDDET                                    S01194
     C                     END                                            S01194
     C                     END                                            S01194
      *                                                                   175758
      ** Check if Lending Swift feature is switched ON                    175758
      *                                                                   175758
     C                     CALL 'AOSARDR0'PLIST4                          175758
      *                                                                   175758
     C                     MOVE '0'       *IN30                           175758
     C           @RTCD     IFEQ *BLANKS                                   175758
     C                     MOVE '1'       *IN30                           175758
     C                     ELSE                                           175758
     C           @RTCD     IFNE '*NRF    '                                175758
     C                     MOVE '1'       *INU7                           175758
     C                     MOVE '1'       *INU8                           175758
     C                     MOVE '1'       *INLR                           175758
     C                     MOVEL'SCSARDPD'DBFILE                          175758
     C                     MOVEL'*VERIFY 'DBKEY                           175758
     C                     Z-ADD12        DBASE                           175758
     C                     GOTO ENDDET                                    175758
     C                     END                                            175758
     C                     END                                            175758
      *                                                                   175758
0357 C***67*****           SETON                     LRU7U8               S01194
0358 C***67*****           MOVE '03'      DBASE                           S01194
0359 C***67*****           MOVE 'TABLE'   DBFILE                          S01194
0360 C***67*****           MOVE ZTABKY    DBKEY                           S01194
0361 C***67*****           GOTO ENDDET                                    S01194
     C/COPY WNCPYSRC,LE0430C001
0362 C*
0363 C**         KEEP TOTAL OF HEADER INPUT AND HEADERS OUTPUT
0364 C*
0365 C                     Z-ADD1         NUMREC  50
0366 C                     Z-ADD1         NORE1
0367 C                     Z-ADD1         NORE2
0368 C                     Z-ADD1         NORE3
0369 C                     Z-ADD1         NORE4
     C   U4                Z-ADD1         NORE5
0426 C   U1                Z-ADD1         NORE6                           S2659
0370 C*
0371 C********** FOR CHAINING TO NOSTRO TABLE                             S01194
0372 C**********                                                          S01194
0373 C**********           MOVE '70'      NOSTAB                          S01194
0374 C                     MOVE ' '       BLNK1  10
0375 C**********           MOVE ' '       BLNK2  12                                           CGL029
     C                     MOVE *BLANKS   BLNK2  18                                           CGL029
0376 C*
0377 C********************************************************************
0378 C*
0379 C**       DETAIL PROCESSING
0380 C*
0381 C           DETAIL    TAG                             ** DETAIL TAG**
      *                                                                                       230521
      ** Initialise field.                                                                    230521
      *                                                                                       230521
     C**********           Z-ADD0         LFCN    60                                   230521 CPK028
     C                     MOVE *BLANKS   LFCN    6                                           CPK028
      *                                                                                       230521
      *                                                                   175758
     C                     MOVE '0'       *IN24                           175758
     C                     MOVE '0'       *IN25                           175758
     C                     MOVE '0'       *IN37                           175758
0382 C*
      *                                                                   CEU004
      *                                                                   CEU004
      ** If feature CEU004 is on, clear output fields.                    CEU004
      *                                                                   CEU004
     C           CEU004    IFEQ 'Y'                        If Feature On  CEU004
      *                                                                   CEU004
     C                     Z-ADD0         OTAM   130        Reset OtAmt   CEU004
     C                     MOVE *BLANKS   OTCY    3         Clr OthCcy    CEU004
      *                                                                   CEU004
     C                     ENDIF                           End If         CEU004
      *                                                                   CEU004
      ** If CLE031 is on, clear other ccy and other ccy amt fields.       CLE031
      *                                                                   CLE031
     C           CLE031    IFEQ 'Y'                                       CLE031
     C                     MOVE *BLANKS   OTCY                            CLE031
     C                     Z-ADD0         OTAM                            CLE031
     C                     ENDIF                                          CLE031
      *                                                                   CLE031
0383 C**       IF S/CFTLX HEADER ADD TO RECORD COUNT
0384 C*
0385 C   04      NUMRCD    ADD  1         NUMRCD  50
0386 C*
0387 C**   IF A HEADER GOTO END.IF A TRAILER GOTO TRAILER PROCESSING
0388 C*
0389 C   03
0390 COR 06                GOTO TRAPRO
0391 C  N02N05             GOTO ENDDET
0392 C*
0393 C*****IF*NO*DEFAULT*BRANCH*ON*ICR1*THEN*BANKS*OWN*CUSTOMER           S01194
0394 C***********NUMBER*REQUIRED*AT*EACH*CHANGE*OF*BRANCH*CODE            S01194
0393 C**   IF BRANCH CHANGES,GET BRANCH INTERNAL CUSTOMER NUMBER          S01194
0394 C**         AT EACH CHANGE OF BRANCH                                 S01194
0395 C*
0396 C***L1*80**           EXSR BRNCHN                                    S01194
0397 C**N67*80*L1RECI      COMP 'D'                  6767                 S01194
     C           *INL1     IFEQ '1'                                       S01194
     C                     MOVE BRCA      BKEY                            S01194
     C**********           CALL 'AOBRCHR0'PLIST1                                       S01194 CGL029
     C                     CALL 'AOBRCHR1'PLIST1                                              CGL029
     C           @RTCD     IFNE *BLANKS                                   S01194
     C                     SETON                     U7U8LR               S01194
     C                     MOVE '07'      DBASE                           S01194
     C                     MOVE 'SDBRCHPD'DBFILE                          S01194
     C                     MOVE BKEY      DBKEY                           S01194
     C                     GOTO ENDDET                                    S01194
     C                     END                                            S01194
     C                     END                                            S01194
0398 C***67*L1**           SETON                     LRU7U8               S01194
0399 C***67*L1**           MOVE '07'      DBASE                           S01194
0400 C***67*L1**           MOVE 'TABLE'   DBFILE                          S01194
0401 C***67*L1**           MOVE ZTABKY    DBKEY                           S01194
0402 C***67*L1**           GOTO ENDDET                                    S01194
0403 C*                                                                   S01194
0404 C**    KEEP RECORD COUNT AND HASH TOTAL FOR EVERY DETAIL RECORD
0405 C*
0406 C   02      NUMREC    ADD  1         NUMREC
0407 C   05      NUMRCD    ADD  1         NUMRCD
0408 C*                                                                   E12046
0409 C**    IF ACTION IS START OF A RISK LOAN, NO AMOUNT IS TO BE         E12046
0410 C*     SETTLED, SO SKIP PROCESSING AND RECORD IS NOT EXTRACTED.      E12046
0411 C*                                                                   E12046
0412 C  N02                GOTO NOTRK                                     E12046
     C/COPY WNCPYSRC,LE0430C009
0413 C           PTYP      COMP 70                       70               E12046
     C********** PTYP      COMP 71                       70                          CLE031 MD027395
     C  N70      PTYP      COMP 71                       70                                 MD027395
0414 C  N70                GOTO NOTRK                                     E12046
0415 C           AMTP      COMP 'ST'                     70               E12046
     C/COPY WNCPYSRC,LE0430C008
     C*                                                                   079567
     C*  For risk loan.                                                   079567
     C** If maturity and no fee/interest do not exctract a record         079567
     C           PTYP      IFEQ 70                                        079567
     C           AMTP      ANDEQ'MA'                                      079567
     C           PRAM      ANDEQTAMT                                      079567
     C           PTYP      OREQ 71                                        CLE031
     C           AMTP      ANDEQ'MA'                                      CLE031
     C           PRAM      ANDEQTAMT                                      CLE031
     C                     SETON                         70               079567
     C                     END                                            079567
     C*                                                                   079567
0416 C   70                SETOF                     313233               E12046
     C   70                SETOF                     3436                 E12046
     C/COPY WNCPYSRC,LE0430C003
     C   70                GOTO ENDDET                                    E12046
     C*                                                                   E12046
0419 C           NOTRK     TAG                              **NOTRK TAG** E12046
      *                                                                                       244461
      ** If RISK Part/Sold, Maturity with Interest, seton 82.                                 244461
      *                                                                                       244461
     C                     MOVE '0'       *IN85                                               244461
     C                     MOVE '0'       *IN82                                               244461
     C           AMTP      IFEQ 'MA'                                                          244461
     C           PTYP      ANDEQ72                                                            244461
     C           PRAM      ANDNETAMT                                                          244461
     C           AMTP      OREQ 'IN'                                                          244461
     C           PTYP      ANDEQ72                                                            244461
     C           PRAM      ANDNETAMT                                                          244461
     C                     MOVE '1'       *IN82                                               244461
     C                     MOVE '1'       PRI2                                                244461
     C                     ENDIF                                                              244461
      *                                                                                       244461
      ** If RISK Part/Purchased, Maturity with Interest, seton 85.                            244461
      ** If RISK loan, Maturity with Interest, seton 85.                                      244461
      *                                                                                       244461
     C           AMTP      IFEQ 'MA'                                                          244461
     C           PRAM      ANDNETAMT                                                          244461
     C           AMTP      OREQ 'IN'                                                          244461
     C           PRAM      ANDNETAMT                                                          244461
     C           PTYP      IFEQ 71                                                            244461
     C           PTYP      OREQ 70                                                            244461
     C                     MOVE '1'       *IN85                                               244461
     C                     MOVE '1'       PRI2                                                244461
     C                     ENDIF                                                              244461
     C                     ENDIF                                                              244461
0408 C*
0409 C**    SET ON INDICATORS FOR SETTLEMENT TYPE
0410 C*
0411 C                     SETOF                     505152
0412 C                     SETOF                     53
0413 C           SETP      COMP 01                       50
0414 C           SETP      COMP 02                       51
0415 C  N51      SETP      COMP 12                       51
0416 C           SETP      COMP 07                       52
     C           SETP      COMP 08                       55
     C  N50N51N52
     CANN55                SETON                     53
      *                                                                                       246923
      ** Do not include Principal Transfer Events                                             246923
      *                                                                                       246923
     C           *IN53     IFEQ '1'                                                           246923
     C           AMTP      ANDEQ'PT'                                                          246923
     C           AMTP      OREQ 'ST'                                                          246923
     C           GPRT      ANDEQ'Y'                                                           246923
     C                     MOVE '0'       *IN53                                               246923
     C                     ENDIF                                                              246923
0419 C*
0420 C**    IF INTEREST PAYMENT EVENT,IS INTEREST BEING CAPITALISED
0421 C*
0422 C                     SETOF                     54
0423 C           AMTP      COMP 'IN'                     74
0424 C   74      INTC      COMP 'Y'                      54
0425 C   54      INTA      COMP PRAM                     54
0426 C  N54                MOVE 'N'       INTC
0427 C*
0428 C**    IF S/CFTLX DETAIL SKIP TO LAST CALCULATIONS
0429 C*
0430 C   05                GOTO FILTYP
0431 C*
0432 C**    SET INDICATORS FOR OTHER AMENDMENT TYPES
0433 C*
0434 C           AMTP      COMP 'PI'                     71
0435 C  N71      AMTP      COMP 'ST'                     71
0436 C           AMTP      COMP 'MA'                     72
0437 C           AMTP      COMP 'RE'                     73
0437 C  N73      AMTP      COMP 'MR'                     73               153369
0438 C*
0439 C*
0440 C**    SET ON INIDICATORS FOR PROCESSING TYPES
0441 C*
0442 C                     SETOF                     616664
0443 C                     SETOF                     706263
     C                     SETOF                     65                                       CLE031
0444 C           PTYP      COMP 64                     61  *PTYP=61,62,63*
     C           CLE028    IFEQ 'Y'                                                           CLE028
     C           PTYP      ANDEQ80                                                            CLE028
     C                     MOVE *ON       *IN61                                               CLE028
     C                     ENDIF                                                              CLE028
0445 C  N61      PTYP      COMP 66                     64  *    =64,65   *
0446 C**N64N61***PTYP      COMP 70                     6670* =66,67 /=70 *                    CLE031
     C  N64N61   PTYP      COMP 68                     66  *PTYP=66,67   *                    CLE031
     C           PTYP      IFEQ 68                                                            CLE031
     C                     SETON                     64                                       CLE031
     C                     ENDIF                                                              CLE031
     C           PTYP      IFEQ 69                                                            CLE031
     C           PTYP      OREQ 72                                                            CLE031
     C                     SETON                     66                                       CLE031
     C                     ENDIF                                                              CLE031
     C           PTYP      IFEQ 70                                                            CLE031
     C           PTYP      OREQ 71                                                            CLE031
     C                     SETON                     70                                       CLE031
     C                     ENDIF                                                              CLE031
0447 C   61
0448 COR 64                SETON                     62    * COMBINATIONS*
0449 C   62                                                * TO DETERMINE*
0450 COR 70                SETON                     63    * IF TELEX IS *
0451 C   61                                                * PAY,RECEIVE *
0452 COR 70                SETON                     65    * OR CREDIT   *
0453 C*
0454 C**    SET ON RELEVENT TELEX INDICATORS - DETERMINED BY AMTP
0455 C*
0456 C   71                MOVE '1'       PRI1
0457 C   72                MOVE '1'       PRI2
0458 C   73                MOVE '1'       PRI4
0459 C   74                MOVE '1'       PRI3
0460 C*
0461 C**    DETERMINE PAY RECEIVE REPORTING SECTION - DEPENDS ON PTYP
0462 C*
0463 C   65                MOVE '1'       TIND
0464 C   64                MOVE '2'       TIND
0465 C   66                MOVE '3'       TIND
0466 C*
0467 C**   DETERMINE WHETHER PAY,CREDIT OR RECEIVE TELEX
0468 C*
0469 C   71 62             EXSR NOSCHN                     *AMTP=PI OR ST*
0470 C   71 62N81          MOVE 'P'       PYRC
0471 C   71 62 81          MOVE 'C'       PYRC
0472 C   71 66             MOVE 'R'       PYRC
0473 C*                                                    * AMTP=MA     *
0474 C   72 66             EXSR NOSCHN
0475 C   72 66N81          MOVE 'P'       PYRC
0476 C   72 66 81          MOVE 'C'       PYRC
0477 C   72 62             MOVE 'R'       PYRC
      *                                                                                       244461
      ** Maturity event for risk loans (for interest only) should                             244461
      ** produce pay/receive messages.                                                        244461
      *                                                                                       244461
     C           *IN72     IFEQ '1'                                                           244461
     C           *IN63     ANDEQ'1'                                                           244461
     C                     MOVE 'R'       PYRC                                                244461
     C                     ENDIF                                                              244461
0478 C*                                                    * AMTP=RE     *
0479 C   73 66             EXSR NOSCHN
0480 C   73 66N81          MOVE 'P'       PYRC
0481 C   73 66 81          MOVE 'C'       PYRC
0482 C   73 62             MOVE 'R'       PYRC
0483 C*                                                    * AMTP=IN
0484 C   74 66             EXSR NOSCHN
0485 C   74 66N81          MOVE 'P'       PYRC
0486 C   74 66 81          MOVE 'C'       PYRC
0487 C   74 63             MOVE 'R'       PYRC
      *                                                                                       244461
     C           *IN82     IFEQ '1'                                                           244461
     C                     EXSR NOSCHN                                                        244461
     C           *IN81     IFEQ '0'                                                           244461
     C                     MOVE 'P'       PYRC                                                244461
     C                     ELSE                                                               244461
     C                     MOVE 'C'       PYRC                                                244461
     C                     ENDIF                                                              244461
     C                     ENDIF                                                              244461
      *                                                                                       244461
     C           *IN85     IFEQ '1'                                                           244461
     C                     EXSR NOSCHN                                                        244461
     C           *IN81     IFEQ '0'                                                           244461
     C                     MOVE 'R'       PYRC                                                244461
     C                     ELSE                                                               244461
     C                     MOVE 'C'       PYRC                                                244461
     C                     ENDIF                                                              244461
     C                     ENDIF                                                              244461
     C*                                                                   S01518
     C**   FOR ROLLOVER OF A DISCOUNTED LOAN PYRC SHOULD BE AN "R"        S01518
     C*                                                                   S01518
     C           AMTP      IFEQ 'RO'                                      S01518
     C           PTYP      ANDEQ63                                        S01518
0487 C                     MOVE 'R'       PYRC                            S01518
     C                     END                                            S01518
     C*                                                                   S01270
     C***  ADDITIONAL CHECKING TO PROCESS LOAN FEE TELEXES.               S01270
     C*                                                                   S01270
     C           AMTP      IFEQ *BLANKS                                   S01270
     C           PTYP      ANDEQ*ZEROS                                    S01270
     C           TLXY      ANDEQ'R'                                       S01270
     C           CLE007    ANDEQ'N'                                       CLE007
     C                     MOVE 'R'       PYRC                            S01270
     C                     END                                            S01270
      *                                                                   S01270
     C           AMTP      IFEQ *BLANKS                                   CLE007
     C           PTYP      ANDEQ*ZEROS                                    CLE007
     C           CLE007    ANDEQ'Y'                                       CLE007
     C                     MOVE TLXY      PYRC                            CLE007
     C                     END                                            CLE007
      *                                                                   CLE007
     C*                                                                   S01270
0488 C*
0489 C*      MOVE LETLX INFORMATION INTO RELEVENT OUTPUT FIELDS
0490 C*
0491 C                     Z-ADDTAMT      EAMT
     C**
     C**  FOR RISK LOANS, EXCLUDE PRINCIPAL AMOUNT FROM TOTAL AMOUNT
     C**  IF AMENDMENT TYPE IS 'MA'
     C***70*72***TAMT      SUB  PRAM      EAMT                            E12045
     C   70 72   TAMT      SUB  PRAM      EAMT                            079567
      *                                                                                       244461
     C           *IN82     IFEQ '1'                                                           244461
     C           *IN85     OREQ '1'                                                           244461
     C           TAMT      SUB  PRAM      EAMT                                                244461
     C                     ENDIF                                                              244461
     C***
     C***  FOR START OF A DISCOUNT OUTPUT PRINCIPAL MINUS DISCOUNT
     C***
     C           AMTP      COMP 'ST'                     75
     C   75 61   PRAM      SUB  INTA      EAMT
     C***
0492 C                     MOVE LNRF      FCLN
0493 C                     MOVE LLAG      RCDT
      *                                                                   CEU004
      *                                                                   CEU004
      ** If feature CEU004 is on,                                         CEU004
      ** Or CLE031 is on                                                  CLE031
      ** If the Settlement currency *NE transaction Ccy, convert amount   CEU004
      * (but ignore settlement currency if Settlement Method is 09                            218782
      * and System Value Settlement09Postings = 'T' for transaction)                          218782
      *                                                                   CEU004
     C           CEU004    IFEQ 'Y'                        If Feature On  CEU004
     C           CLE031    OREQ 'Y'                                       CLE031
      *                                                                                       218782
     C           CLE033    IFNE 'Y'                                                           218782
     C           SET09     ORNE 'T'                                                           218782
     C           SETP      ORNE 09                                                            218782
      *                                                                   CLE031
      ** If CEU004 is on AND receipt settlement ccy is present AND        CLE031
      ** receipt settlement ccy is not equal to event currency            CLE031
      *                                                                   CLE031
     C           CEU004    IFEQ 'Y'                                       CLE031
     C           SCCY      ANDNE*BLANKS                                   CLE031
     C           SCCY      ANDNECCY                                       CLE031
     C           CLE031    ANDNE'Y'                                       CLE031
      *                                                                   CLE031
      ** OR CLE031 is on AND pay/receive indicator = 'Receive' AND        CLE031
      ** receipt settlement ccy is present AND receipt settlement         CLE031
      ** ccy does not equal event ccy                                     CLE031
      *                                                                   CLE031
     C           CLE031    OREQ 'Y'                                       CLE031
     C           PYRC      ANDEQ'R'                                       CLE031
     C           SCCY      ANDNE*BLANKS                                   CLE031
     C           SCCY      ANDNECCY                                       CLE031
      *                                                                   CLE031
      ** OR CLE031 is on AND pay/receive indicator does not equal         CLE031
      ** 'Receive' AND pay settlement ccy is present AND pay settlement   CLE031
      ** does not equal event ccy                                         CLE031
      *                                                                   CLE031
     C           CLE031    OREQ 'Y'                                       CLE031
     C           PYRC      ANDNE'R'                                       CLE031
     C           PSCY      ANDNE*BLANKS                                   CLE031
     C           PSCY      ANDNECCY                                       CLE031
      *                                                                   CEU004
     C                     MOVE CCY       CCYSV   3         Set Ccy sv fldCEU004
     C                     MOVE EAMT      AMTSV  130        Set Amt sv fldCEU004
      *                                                                   CEU004
     C           SCCY      IFNE *BLANKS                     If StCcy # BlkCEU004
     C           SCCY      ANDNECCY                         And Ccys # EqlCEU004
      *                                                                   CEU004
     C*********************MOVE EAMT      P@FRAM      -Set Amnt ParmCEU004184775
     C                     Z-ADDEAMT      P@FRAM            -Set Amnt Parm184775
     C                     MOVE CCY       P@FRCY            -Set FrCcy PrmCEU004
     C                     MOVE SCCY      P@TOCY            -Set ToCcy PrmCEU004
      *                                                                   CEU004
     C                     EXSR XCAMT                        Cvrt Amount  CEU004
     C                     MOVE P@OUTA    EAMT               Set Cvrt Amt CEU004
     C**********           MOVE SCCY      CCY         Set Cvrt Ccy CEU004 CLE031
     C                     MOVE CVCCY     CCY                Set Cvrt Ccy CLE031
     C                     ENDIF                            End If        CEU004
      *                                                                   CEU004
      ** For Payments, populate the other amount/currency fields          CEU004
      ** according to whether the 'In' Ccy is equal to the transaction ccyCEU004
      *                                                                   CEU004
     C           PYRC      IFEQ 'P'                         If a Payment  CEU004
      *                                                                   CEU004
     C           ICCY      IFNE *BLANKS                      If InCcy # BlCEU004
      *                                                                   CEU004
     C           ICCY      IFEQ CCYSV                         If Ccys # EqCEU004
      *                                                                   CEU004
     C                     MOVE CCYSV     OTCY                 Set OthCcy CEU004
     C                     MOVE AMTSV     OTAM                 Set OthAmt CEU004
      *                                                                   CEU004
     C                     ELSE                               Else If     CEU004
      *                                                                   CEU004
     C*********************MOVE AMTSV     P@FRAM        -Set Amt Pm CEU004184775
     C                     Z-ADDAMTSV     P@FRAM              -Set Amt Pm 184775
     C                     MOVE CCYSV     P@FRCY              -Set FCy Pm CEU004
     C                     MOVE ICCY      P@TOCY              -Set TCy Pm CEU004
      *                                                                   CEU004
     C                     EXSR XCAMT                          Cvrt AmountCEU004
     C                     MOVE P@OUTA    OTAM                 Set Cvt AmtCEU004
     C                     MOVE ICCY      OTCY                 Set Cvt CcyCEU004
      *                                                                   CEU004
     C                     ENDIF                              End If      CEU004
      *                                                                   CEU004
     C                     ENDIF                             End If       CEU004
      *                                                                   CEU004
     C                     ENDIF                            End If        CEU004
      *                                                                   CEU004
     C                     ENDIF                                          CLE031
      *                                                                   CLE031
     C                     ENDIF                                                              218782
      *                                                                                       218782
     C                     ENDIF                           End If         CEU004
      *                                                                   CEU004
      *                                                                   CEU004
      *                                                                   CEU004
     C*
     C*****************************************************************
0494 C*
0495 C**   DETERMINE WHICH TELEX FILE TO OUTPUT RECORDS TO
0496 C*
0497 C           FILTYP    TAG                             ** FILTYP TAG**
0498 C                     SETOF                     313233
     C                     SETOF                     3436
     C/COPY WNCPYSRC,LE0430C004
0569 C                     SETOF                     7576                 S2659
0500 C*
0501 C**   IF EVENT TYPE = INTEREST PAYMENT AND INTC=Y OUTPUT TO LETX4
0502 C**     IP SETP=00,03,04,05,06 OR 14 OUTPUT TO LETX4 ASWELL
0503 C*
0504 C   74 54
0505 COR 53                SETON                     34
0506 C   34                GOTO TAG1
0507 C*
     C*
     C**    IF SETP=08, U4 ON, AND NOSTRO IS SWIFT MEMBER,
     C**    OUTPUT TO LEPXT
     C*
     C   55 U4             EXSR CHKSW
     C   U7 U8 LR          GOTO ENDDET
     C           *IN55     IFEQ '1'                                       036829
     C           *INU4     ANDEQ'1'                                       036829
     C           LLAG      ANDEQ'A'                                       036829
     C********** VDAT      ANDLERUNDAY                             036829 158955
     C           VDAT      ANDLEWDATE                                     158955
     C           AMTP      OREQ 'MA'                                      158955
     C           VDAT      ANDLEWDATE                                     158955
     C                     MOVE '0'       *IN36                           036829
     C                     END                                            036829
      *                                                                                       244461
     C           *IN82     IFEQ '1'                                                           244461
     C           *IN85     OREQ '1'                                                           244461
     C                     MOVE '1'       *IN36                                               244461
     C                     ENDIF                                                              244461
      *                                                                                       244461
     C   55 36             GOTO TAG1
0595 C**                                                                  S2659
0588 C**   CHIPS INTERFACE PRESENT, SETTLEMENT TYPE 07                    S2659
0589 C**   & IS CREDIT OR PAYMENT OUTPUT TO S/LETX6.                      S2659
0590 C**                                                                  S2659
0591 C   U1 52   PYRC      COMP 'C'                      75               S2659
0592 C   U1 52N75PYRC      COMP 'P'                      75               S2659
0593 C   U1 52 75          SETON                     76                   S2659
0594 C   U1 76             GOTO TAG1                                      S2659
0596 C**                                                                  S2659
     C*
     C**    IF SETP=08, BUT NOT SATISFY ABOVE, OR SETP=07,
     C**    CALCULATE IF COMPLETE OR INCOMPLETE AND OUTPUT TO LETX1/2
     C*
     C   55N36             SETON                     52
0510 C*
0511 C   52                EXSR NOSCHN
0512 C   52N44             SETON                     31
0513 C   52 44             SETON                     32
     C   52                GOTO TAG1
     C*
     C*****************************************************************
0514 C*
0515 C**  IF SETP=02 OR 12 OUTPUT TO LETX3
0516 C*
0517 C   51                SETON                     33
     C   51                GOTO TAG1
     C*
     C*****************************************************************
     C/COPY WNCPYSRC,LE0430C005
     C*
     C**    SETP=01:-
     C**    IF LOCAL CCY AND LCYN=B, OUTPUT TO LETX3
0520 C*
     C   50      CCY       COMP LOCY                     42
     C   50 42 41          SETON                     33
     C   50 33             GOTO TAG1
     C*
     C**    LOCAL CCY BUT LCYN=T, OR NOT LOCAL CCY,
     C**
     C**    IF U4 AND NOSTRO IS SWIFT MEMBER, USE LEPXT.
     C**    ELSE USE LETX1 OR LETX2
     C*
     C   50 U4             EXSR CHKSW
     C   U7 U8 LR          GOTO ENDDET
     C**                                                                  158955
     C**    ENSURE THAT LAONS DROPPED DURING THIS RUN WILL NOT            158955
     C**    BE OUTPUT TO LLEPXTAB                                         158955
     C           *IN55     IFEQ '1'                                       158955
     C           *INU4     ANDEQ'1'                                       158955
     C           LLAG      ANDEQ'A'                                       158955
     C           VDAT      ANDLEWDATE                                     158955
     C           AMTP      OREQ 'MA'                                      158955
     C           VDAT      ANDLEWDATE                                     158955
     C                     MOVE '0'       *IN36                           158955
     C                     END                                            158955
     C**                                                                  158955
     C   50 36             GOTO TAG1
     C*
0525 C   50                EXSR NOSCHN
0526 C   50N44             SETON                     31
0527 C   50 44             SETON                     32
     C*
     C*****************************************************************
     C*
0528 C           TAG1      TAG                             ** TAG1 TAG  **
     C*
     C**    IF OUTPUT IS LEPXT AND PAY/REC IND = 'C', CHANGE TO 'P'
     C*
     C   36      PYRC      COMP 'C'                      81
     C   36 81             MOVE 'P'       PYRC
      *                                                                   175758
      ** If Lending Swift feature is switched ON and settlement type is   175758
      ** 01 or 08                                                         175758
      *                                                                   175758
     C                     MOVE '0'       *IN37                           175758
     C           *IN30     IFEQ '1'                                       175758
     C           *IN55     ANDEQ'1'                                       175758
     C           *IN30     OREQ '1'                                       175758
     C           *IN50     ANDEQ'1'                                       175558
      *                                                                   175758
      **  Check if event refers to a loan amendment type 'ST'             175758
      *                                                                   175758
     C           AMTP      IFEQ 'ST'                       B00            175758
      *                                                                   175758
      ** Loan amendment type is 'MA' and processing type 66 or 67         175758
      *                                                                   175758
     C           AMTP      OREQ 'MA'                                      175758
     C           PTYP      ANDEQ66                                        175758
     C           AMTP      OREQ 'MA'                                      175758
     C           PTYP      ANDEQ67                                        175758
     C           AMTP      OREQ 'MA'                                      CLE031
     C           PTYP      ANDEQ69                                        CLE031
     C           AMTP      OREQ 'MA'                                      CLE031
     C           PTYP      ANDEQ72                                        CLE031
      *                                                                   175758
     C           CVMI      DOUNE'P'                        DO1            175758
      *                                                    ** LEPXT HASH *175758
     C                     MOVE '1'       *IN25                           175758
     C                     MOVE '1'       *IN37                           175758
     C   36    25          MOVE EAMT      ZZAMT                           175758
     C***36*35*25          Z-SUBZZAMT     ZZAMT                                        175758 245691
     C   36    25          Z-ADDEAMTI5    ZZTOTI                          175758
     C   36    25          Z-ADDEAMTD5    ZZTOTD                          175758
     C   36    25          EXSR GLZADD                                    175758
     C   36    25          Z-ADDZZTOTI    EAMTI5 150                      175758
     C   36    25          Z-ADDZZTOTD    EAMTD5  30                      175758
      *                                                                   175758
      ** Set up ordering customer/bank for PF/LEPXTAB                     175758
      *                                                                   175758
     C           PYRC      IFNE 'R'                        B01            175758
      *                                                                   175758
      ** If beneficiary is a bank, 'CNUMP1' is ordering bank, otherwise   175758
      ** ordering customer                                                175758
      *                                                                   175758
     C********** POBN      IFEQ 0                          B02                         175758 CSD027
     C********** POCN      ANDEQ0                                                      175758 CSD027
     C           POBN      IFEQ *BLANKS                    B02                                CSD027
     C           POCN      ANDEQ*BLANKS                                                       CSD027
     C                     MOVELCNUM      CNUMP1                          175758
     C                     ELSE                            X02            175758
     C********** POBN      IFNE 0                          B03                         175758 CSD027
     C           POBN      IFNE *BLANKS                    B03                                CSD027
     C                     MOVELPOBN      CNUMP1                          175758
     C                     ELSE                            X03            175758
     C                     MOVELPOCN      CNUMP1                          175758
     C                     END                             E03            175758
     C                     END                             E02            175758
     C                     END                             E01            175758
      *                                                                   175758
     C           PYRC      IFEQ 'R'                        B01            175758
      *                                                                   175758
      ** If beneficiary is a bank, 'CNUMPH' is ordering bank, otherwise   175758
      ** ordering customer                                                175758
      *                                                                   175758
     C********** ROBN      IFEQ 0                          B02                         175758 CSD027
     C********** ROCN      ANDEQ0                                                      175758 CSD027
     C           ROBN      IFEQ *BLANKS                    B02                                CSD027
     C           ROCN      ANDEQ*BLANKS                                                       CSD027
     C                     MOVELCNUM      CNUMP1                          175758
     C                     ELSE                            X02            175758
     C********** ROBN      IFNE 0                          B03                         175758 CSD027
     C           ROBN      IFNE *BLANKS                    B03                                CSD027
     C                     MOVELROBN      CNUMP1                          175758
     C                     ELSE                            X03            175758
     C                     MOVELROCN      CNUMP1                          175758
     C                     END                             E03            175758
     C                     END                             E02            175758
     C                     END                             E01            175758
      *                                                                   175758
      ** If MT202 part of MT100 / supplementary MT202 message being       175758
      ** produced, set up details as below                                175758
      *                                                                   175758
     C           CVMI      IFEQ 'P'                        B01            175758
     C           CVMR      ANDEQ'Y'                                       175758
     C           PYRC      ANDNE'R'                                       175758
     C                     MOVE *BLANKS   FACO                            175758
     C                     MOVE *BLANKS   TSEN                            175758
     C                     MOVELRVNO      FACO                            175758
     C                     MOVELRCRN      TSEN                            175758
     C                     MOVE *BLANKS   OSAC                            175758
     C                     MOVELPONS      OSAC                            175758
     C                     MOVE 'S'       CVMI                            175758
     C                     END                             E01            175758
      *                                                                   175758
      ** If MT100 part of MT100 / supplementary MT202 message being       175758
      ** produced, set up details as below                                175758
      *                                                                   175758
     C           CVMI      IFEQ ' '                        B01            175758
     C           CVMR      ANDEQ'Y'                                       175758
     C           PYRC      ANDNE'R'                                       175758
     C                     MOVE *BLANKS   OSAC                            175758
     C                     MOVELRVNO      OSAC                            175758
     C                     MOVE 'P'       CVMI                            175758
     C                     END                             E01            175758
      *                                                                   175758
     C   36      NORE5     ADD  1         NORE5   50                      175758
     C                     MOVE '1'       *IN24                           175758
     C                     EXCPTCOVER                                     175758
     C                     MOVE '0'       *IN24                           175758
     C                     ENDDO                           ENDDO1         175758
      *                                                                   175758
      ** Initialise CVMI                                                  175758
      *                                                                   175758
     C                     MOVE *BLANK    CVMI    1                       175758
     C                     END                             E00            175758
     C                     END                                            175758
      *                                                                   175758
      ** If Lending Swift feature is switched ON and settlement type is   175758
      ** 01 or 08                                                         175758
      *                                                                   175758
     C                     MOVE '0'       *IN37                           175758
     C           *IN25     IFEQ '0'                                       175758
     C           *IN30     IFEQ '1'                                       175758
     C           *IN55     ANDEQ'1'                                       175758
     C           *IN30     OREQ '1'                                       175758
     C           *IN50     ANDEQ'1'                                       175758
      *                                                                   175758
      ** Set up ordering customer/bank fro PF/LEPXTAB                     175758
      *                                                                   175758
     C           PYRC      IFNE 'R'                                       175758
     C           *IN05     ANDEQ'0'                                                           244733
      *                                                                   175758
      ** If beneficiary is a bank, 'CNUMP1' is ordering bank, otherwise   175758
      ** ordering customer                                                175758
      *                                                                   175758
     C                     MOVE '1'       *IN37                           175758
     C********** POBN      IFEQ 0                                                      175758 CSD027
     C********** POCN      ANDEQ0                                                      175758 CSD027
     C**********           MOVELCNUM      CNUMP1  60                                   175758 CSD027
     C           POBN      IFEQ *BLANKS                                                       CSD027
     C           POCN      ANDEQ*BLANKS                                                       CSD027
     C                     MOVELCNUM      CNUMP1  6                                           CSD027
     C                     ELSE                                           175758
     C********** POBN      IFNE 0                                                      175758 CSD027
     C           POBN      IFNE *BLANKS                                                       CSD027
     C                     MOVELPOBN      CNUMP1                          175758
     C                     ELSE                                           175758
     C                     MOVELPOCN      CNUMP1                          175758
     C                     END                                            175758
     C                     END                                            175758
     C                     END                                            175758
      *                                                                   175758
     C                     END                                            175758
     C                     END                                            175758
0529 C*
0530 C**      KEEP HASH TOTALS AND RECORD COUNT FOR EACH TELEX FILE
0531 C*
0532 C   31      NORE1     ADD  1         NORE1   50
0533 C   32      NORE2     ADD  1         NORE2   50
0534 C   33      NORE3     ADD  1         NORE3   50
0535 C   34      NORE4     ADD  1         NORE4   50
     C***36***** NORE5     ADD  1         NORE5   50                      175758
     C   36N25   NORE5     ADD  1         NORE5   50                      175758
0659 C   76      NORE6     ADD  1         NORE6   50                      S2659
0536 C**         CHECK FOR NEGATIVE AMOUNT
0537 C*                                                    * LETX1 HASH  *
0538 C   31                MOVE EAMT      ZZAMT
0539 C           EAMT      COMP 0                      35
0540 C***31*35**           Z-SUBZZAMT     ZZAMT                                               245691
0541 C   31                Z-ADDEAMTI1    ZZTOTI
0542 C   31                Z-ADDEAMTD1    ZZTOTD
0543 C   31                EXSR GLZADD
0544 C   31                Z-ADDZZTOTI    EAMTI1 150
0545 C   31                Z-ADDZZTOTD    EAMTD1  30
0546 C*                                                    * LETX2 HASH  *
0547 C   32                MOVE EAMT      ZZAMT
0548 C***32*35**           Z-SUBZZAMT     ZZAMT                                               244872
0549 C   32                Z-ADDEAMTI2    ZZTOTI
0550 C   32                Z-ADDEAMTD2    ZZTOTD
0551 C   32                EXSR GLZADD
0552 C   32                Z-ADDZZTOTI    EAMTI2 150
0553 C   32                Z-ADDZZTOTD    EAMTD2  30
0554 C*                                                    * LETX3 HASH  *
0555 C   33                MOVE EAMT      ZZAMT
0556 C***33*35**           Z-SUBZZAMT     ZZAMT                                               245691
     C   33      EAMT      IFEQ 0                                         156586
     C                     SUB  1         NORE3                           156586
     C                     END                                            156586
0557 C   33                Z-ADDEAMTI3    ZZTOTI
0558 C   33                Z-ADDEAMTD3    ZZTOTD
0559 C   33                EXSR GLZADD
0560 C   33                Z-ADDZZTOTI    EAMTI3 150
0561 C   33                Z-ADDZZTOTD    EAMTD3  30
0562 C*                                                    * LETX4 HASH  *
0563 C   34                MOVE EAMT      ZZAMT
0564 C***34*35**           Z-SUBZZAMT     ZZAMT                                               245691
0565 C   34                Z-ADDEAMTI4    ZZTOTI
0566 C   34                Z-ADDEAMTD4    ZZTOTD
0567 C   34                EXSR GLZADD
0568 C   34                Z-ADDZZTOTI    EAMTI4 150
0569 C   34                Z-ADDZZTOTD    EAMTD4  30
     C********************************************************LEPXT*HASH *175758
     C***36*****           MOVE EAMT      ZZAMT                           175758
     C***36*35**           Z-SUBZZAMT     ZZAMT                           175758
     C***36*****           Z-ADDEAMTI5    ZZTOTI                          175758
     C***36*****           Z-ADDEAMTD5    ZZTOTD                          175758
     C***36*****           EXSR GLZADD                                    175758
     C***36*****           Z-ADDZZTOTI    EAMTI5 150                      175758
     C***36*****           Z-ADDZZTOTD    EAMTD5  30                      175758
      *                                                    ** LEPXT HASH *175758
     C   36   N25          MOVE EAMT      ZZAMT                           175758
     C***36*35N25          Z-SUBZZAMT     ZZAMT                                        175758 245691
     C   36   N25          Z-ADDEAMTI5    ZZTOTI                          175758
     C   36   N25          Z-ADDEAMTD5    ZZTOTD                          175758
     C   36   N25          EXSR GLZADD                                    175758
     C   36   N25          Z-ADDZZTOTI    EAMTI5 150                      175758
     C   36   N25          Z-ADDZZTOTD    EAMTD5  30                      175758
0710 C*                                                                   S2659
0703 C   76                MOVE EAMT      ZZAMT                           S2659
0704 C***76*35**           Z-SUBZZAMT     ZZAMT                                         S2659 245691
0705 C   76                Z-ADDEAMTI6    ZZTOTI                          S2659
0706 C   76                Z-ADDEAMTD6    ZZTOTD                          S2659
0707 C   76                EXSR GLZADD                                    S2659
0708 C   76                Z-ADDZZTOTI    EAMTI6 150                      S2659
0709 C   76                Z-ADDZZTOTD    EAMTD6  30                      S2659
0405 C*                                                                   S01117
0404 C**    IF SETTLEMENT BRANCH BLANK, DEFAULT TO BRCA                   S01117
0405 C*                                                                   S01117
0406 C           OSBR      IFEQ *BLANK                                    S01117
     C                     MOVE BRCA      OSBR                            S01117
     C                     END                                            S01117
     C/COPY WNCPYSRC,LE0430C002
0570 C*
0571 C                     GOTO ENDDET
0572 C*
0573 C********************************************************************
0574 C*
0575 C**         TRAILER PROCESSING
0576 C*
0577 C           TRAPRO    TAG
0578 C*
0579 C**      ADD 1 FOR S/LETLX TRAILER
0580 C*
0581 C   03      NUMREC    ADD  1         NUMREC
0582 C   03      NUMREC    COMP NOREA                8383
0583 C   83                SETON                     U8
0584 C*
0585 C**      ADD 1 FOR S/CFTLX TRAILER
0586 C*
0587 C   06      NUMRCD    ADD  1         NUMRCD
0588 C   06      NUMRCD    COMP NORE                 8484
0589 C   84                SETON                     U8
0590 C*
0591 C**        ADD TRAILERS OUTPUT TO RECORD COUNT
0592 C*
0593 C           ENDDET    TAG                             * ENDDET TAG *
0594 CLR         NORE1     ADD  1         NORE1
0595 CLR         NORE2     ADD  1         NORE2
0596 CLR         NORE3     ADD  1         NORE3
0597 CLR         NORE4     ADD  1         NORE4
     CLR U4      NORE5     ADD  1         NORE5
     CLR U4 22             READ LEPXTAC                  90               CLE007
     CLR U4 22   *IN90     IFEQ *OFF                                      CLE007
     CLR U4 22   NORE      ADD  NORE5     NORE5                           CLE007
0541 CLR U4 22   HRWN      MULT 1000      WHRWN  150                      CLE007
0541 CLR U4 22             ADD  HRDC      WHRWN                           CLE007
0541 CLR U4 22             MOVE WHRWN     ZZAMT                           CLE007
0541 CLR U4 22             Z-ADDEAMTI5    ZZTOTI                          CLE007
0542 CLR U4 22             Z-ADDEAMTD5    ZZTOTD                          CLE007
0543 CLR U4 22             EXSR GLZADD                                    CLE007
0544 CLR U4 22             Z-ADDZZTOTI    EAMTI5 150                      CLE007
0545 CLR U4 22             Z-ADDZZTOTD    EAMTD5  30                      CLE007
0543 CLR U4 22             MOVE *ON       *IN23                           CLE007
0543 CLR U4 22             EXCPT                                          CLE007
0543 CLR U4 22             MOVE *OFF      *IN23                           CLE007
     CLR                   ENDIF                                          CLE007
0739 CLR U1      NORE6     ADD  1         NORE6                           S2659
      *                                                                   159932
      ** The fix would ensure that a header and trailer is always         159932
      ** written though detail file is empty.  Thus, number of record     159932
      ** on trailer should also be 2, at least.                           159932
      *                                                                   159932
     CLR         NORE1     IFEQ 1                                         159932
     CLR                   ADD  1         NORE1                           159932
     CLR                   ENDIF                                          159932
     CLR         NORE2     IFEQ 1                                         159932
     CLR                   ADD  1         NORE2                           159932
     CLR                   ENDIF                                          159932
     CLR         NORE3     IFEQ 1                                         159932
     CLR                   ADD  1         NORE3                           159932
     CLR                   ENDIF                                          159932
     CLR         NORE4     IFEQ 1                                         159932
     CLR                   ADD  1         NORE4                           159932
     CLR                   ENDIF                                          159932
     CLR U4      NORE5     IFEQ 1                                         159932
     CLR                   ADD  1         NORE5                           159932
     CLR                   ENDIF                                          159932
     CLR U1      NORE6     IFEQ 1                                         159932
     CLR                   ADD  1         NORE6                           159932
     CLR                   ENDIF                                          159932
     C**
     CLR U7 U8             EXSR *PSSR                                     S01117
0598 C********************************************************************
0599 C**
0600 C*******BRNCHN*SR.*TO*CHAIN*TO*BRANCH*TABLE*IF*DEFAULT*BRANCH        S01194
0601 C********************CODE*IS*BLANK                                   S01194
0602 C**********                                                          S01194
0603 C********** BRNCHN    BEGSR                                          S01194
0604 C**********           MOVEL'10      'ZTABKY                          S01194
0605 C***********          MOVE BRCD      ZTABKY                          S01194
0606 C********** ZTABKY    CHAINTABLE                67                   S01194
0607 C**********           ENDSR                                          S01194
0608 C**********                                                          S01194
0609 C*
0610 C********************************************************************
     C*
     C**    SUBROUTINE TO CHECK IF NOSTRO IS SWIFT MEMBER
     C*
     C           CHKSW     BEGSR                           ***  CHKSW  ***
     C*
     C**    GET NOSTRO CUST.NO.
     C*
     C           OSAC      COMP BLNK2                    44
     C   44                GOTO CHKEND
     C*
     C**********           MOVELOSAC      NOSNN                           S01194
     C**********           SETOF                     12                   S01194
     C********** NOSKEY    CHAINTABLE                67                   S01194
     C                     MOVELOSAC      KEYE                            S01194
     C                     MOVE CCY       KEYB                            S01194
      *-------------------------------------------------------------------137920
     C           CEU004    IFEQ 'Y'                        If EMU Feature 137920
     C           SCCY      ANDNE*BLANKS                    And Set Ccy # b137920
     C           CLE031    ANDNE'Y'                                       CLE031
      *                                                                   CLE031
      ** OR CLE031 is active AND pay/receive indicator = 'Receive'        CLE031
      ** AND receipt settlement ccy is present                            CLE031
      *                                                                   CLE031
     C           CLE031    OREQ 'Y'                                       CLE031
     C           PYRC      ANDEQ'R'                                       CLE031
     C           SCCY      ANDNE*BLANKS                                   CLE031
      *                                                                   CLE031
     C                     MOVE SCCY      KEYB              Set Key Ccy   137920
     C                     ENDIF                           End If         137920
      *                                                                   CLE031
      ** If CLE031 is active AND pay/receive indicator does not           CLE031
      ** equal 'Receive' AND pay settlement ccy is present                CLE031
      *                                                                   CLE031
     C           CLE031    IFEQ 'Y'                                       CLE031
     C           PYRC      ANDNE'R'                                       CLE031
     C           PSCY      ANDNE*BLANKS                                   CLE031
      *                                                                   CLE031
     C                     MOVE PSCY      KEYB                            CLE031
     C                     ENDIF                                          CLE031
      *                                                                   CLE031
      *-------------------------------------------------------------------137920
     C                     CALL 'AONOSTR0'PLIST2                          S01194
     C           @RTCD     IFNE *BLANKS                                   S01194
     C                     SETON                     U7U8LR               S01194
     C                     MOVE '08'      DBASE                           S01194
     C                     MOVELKEYB      DBKEY                           S01194
     C                     MOVE KEYE      DBKEY                           S01194
     C                     MOVE 'SDNOSTPD'DBFILE                          S01194
     C                     GOTO CHKEND                                    S01194
     C                     END                                            S01194
     C**N12*****           SETON                     U7U8LR               S01194
     C**N12*****           MOVE '08'      DBASE                           S01194
     C**N12*****           MOVELNOSKEY    DBKEY                           S01194
     C**N12*****           MOVE 'TABLE'   DBFILE                          S01194
     C**N12*****           GOTO CHKEND                                    S01194
     C*                                                                   S01194
     C**********           SETOF                     13                   S01194
     C**********           MOVELCNUMPH    CUSKEY  7                       S01194
     C**********           MOVE 'A'       CUSKEY                          S01194
     C********** CUSKEY    CHAINCLINT                68                   S01194
      *                                                                                      BUG8289
      ** ENSURE THAT OSBR WILL HAVE CORRECT VALUE FOR LOANS WITH                             BUG8289
      ** SETTLEMENT ACCOUNT TO AVOID DATABASE ERROR                                          BUG8289
     C           OSBR      IFEQ *BLANKS                                                      BUG8289
     C                     MOVE A7BRCD    OSBR                                               BUG8289
     C                     ENDIF                                                             BUG8289
      *                                                                                      BUG8289
     C                     MOVELCNUMPH    CKEY                            S01194
     C                     MOVEL'*CNUM'   KEYSTS                          S01194
     C                     CALL 'AOCUSTR0'PLIST3                          S01194
     C           @RTCD     IFNE *BLANKS                                   S01194
     C                     SETON                     U7U8LR               S01194
     C                     MOVELCKEY      DBKEY                           S01194
     C                     MOVE 'SDCUSTPD'DBFILE                          S01194
     C                     MOVE '09'      DBASE                           S01194
     C                     ELSE                                           S01194
     C           GSFM      COMP 'Y'                      3636=SWIFT MBR   S01194
     C                     END                                            S01194
     C***13******CSID******COMP ' '                  3636  36=SWIFT MBR   S01117
     C***13***** GSFM      COMP 'Y'                      3636=SWIFT MBR   S01194
     C*
     C**N13*****           SETON                     U7U8LR               S01194
     C**N13*****           MOVELCUSKEY    DBKEY                           S01194
     C**N13*****           MOVE 'CLINT'   DBFILE                          S01194
     C**N13*****           MOVE '09'      DBASE                           S01194
     C**  SWIFT message not appropriate for method 01                     158956
     C***    (whatever GSFM is)                                           158956
     C**
     C           SETP      IFEQ 01                                        158956
     C                     MOVE '0'       *IN36                           158956
     C                     END                                            158956
     C*
     C           CHKEND    ENDSR                           ** CHKEND TAG *
     C*
0611 C**
0612 C******NOSCHN*SR.*TO*CHAIN*TO*NOSTRO*TABLE*AND*THEN*CALCULATE        S01194
0612 C**    NOSCHN SR. TO ACCESS SDNOSTPD AND THEN CALCULATE              S01194
0613 C**              IF TELEX INSTRUCTIONS COMPLETE
0614 C           NOSCHN    BEGSR                           *** NOSCHN ***
0615 C                     SETOF                     81
0616 C           OSAC      COMP BLNK2                    44
0617 C  N44      TSEN      COMP BLNK1                    44
0618 C   44                GOTO ENDCHN
0619 C**********           MOVELOSAC      NOSNN                           S01194
0620 C********** NOSKEY    CHAINTABLE                67                   S01194
     C                     MOVELOSAC      KEYE                            S01194
     C                     MOVE CCY       KEYB                            S01194
      *                                                                                       218782
      * Do not use settlement currency if Settlement Method is 09 &                           218782
      * System Value 'Settlement09Postings' = 'T' for transaction)                            218782
     C           CLE033    IFNE 'Y'                                                           218782
     C           SET09     ORNE 'T'                                                           218782
     C           SETP      ORNE 09                                                            218782
      *-------------------------------------------------------------------137920
     C           CEU004    IFEQ 'Y'                        If EMU Feature 137920
     C           SCCY      ANDNE*BLANKS                    And Set Ccy # b137920
     C           CLE031    ANDNE'Y'                                       CLE031
      *                                                                   CLE031
      ** OR CLE031 is active AND pay/receive indicator = 'Receive'        CLE031
      ** AND receipt settlement ccy is present                            CLE031
      *                                                                   CLE031
     C           CLE031    OREQ 'Y'                                       CLE031
     C           PYRC      ANDEQ'R'                                       CLE031
     C           SCCY      ANDNE*BLANKS                                   CLE031
      *                                                                   CLE031
     C                     MOVE SCCY      KEYB              Set Key Ccy   137920
     C                     ENDIF                           End If         137920
      *                                                                   CLE031
      ** If CLE031 is active AND pay/receive indicator does not           CLE031
      ** equal 'Receive' AND pay settlement ccy is present                CLE031
      *                                                                   CLE031
     C           CLE031    IFEQ 'Y'                                       CLE031
     C           PYRC      ANDNE'R'                                       CLE031
     C           PSCY      ANDNE*BLANKS                                   CLE031
      *                                                                   CLE031
     C                     MOVE PSCY      KEYB                            CLE031
     C                     ENDIF                                          CLE031
      *                                                                   CLE031
     C                     ENDIF                                                              218782
      *-------------------------------------------------------------------137920
     C                     CALL 'AONOSTR0'PLIST2                          S01194
     C           @RTCD     IFNE *BLANKS                                   S01194
     C                     SETON                     U7U8LR               S01194
     C                     MOVE '05'      DBASE                           S01194
     C                     MOVELKEYB      DBKEY                           S01194
     C                     MOVE KEYE      DBKEY                           S01194
     C                     MOVE 'SDNOSTPD'DBFILE                          S01194
     C                     GOTO ENDCHN                                    S01194
     C                     END                                            S01194
      *                                                                                      BUG8289
      ** ENSURE THAT OSBR WILL HAVE CORRECT VALUE FOR LOANS WITH                             BUG8289
      ** SETTLEMENT ACCOUNT TO AVOID DATABASE ERROR                                          BUG8289
     C           OSBR      IFEQ *BLANKS                                                      BUG8289
     C                     MOVE A7BRCD    OSBR                                               BUG8289
     C                     ENDIF                                                             BUG8289
      *                                                                                      BUG8289
0621 C**N12*****           SETON                     U7U8LR               S01194
0622 C**N12*****           MOVE '05'      DBASE                           S01194
0623 C**N12*****           MOVE 'TABLE'   DBFILE                          S01194
0624 C**N12*****           MOVE NOSKEY    DBKEY                           S01194
0625 C**N12*****           GOTO ENDCHN                                    S01194
0626 C*
0627 C**    CHECK IF FIRST SIX CHARACTERS FO TSEN ARE NUMERIC
0628 C*
0629 C                     MOVELTSEN      ALPHA6  6
0630 C                     MOVELALPHA6    NUM7    70
0631 C                     MOVELNUM7      ALP6    6
0632 C           ALPHA6    COMP ALP6                     21 * 21-NUMERIC *
     C*
     C**    CHECK IF IS CREDIT TELEX
     C*
0633 C***21*****           MOVELTSEN      NUM6    60                      S01194
0633 C   21                MOVELTSEN      NUM6    6                       S01194
0634 C   21      NUM6      COMP CNUMPH                   81 * 81-CREDIT *
0635 C           ENDCHN    ENDSR
0636 C*
0637 C********************************************************************
0638 C********************************************************************
0639 C**
0640 C*****ZSYSTM SR. TO CHAIN TO THE INSTALLATION CONTROL DATA RECORD.   S01194
0641 C**                                                                  S01194
0642 C********** ZSYSTM    BEGSR                           *** ZSYSTM *** S01194
0643 C**********                                                          S01194
0644 C*****SET*UP KEY FOR INSTALLATION CONTROL RECORD.                    S01194
0645 C**********           MOVEL'01      'ZTABKY 12                       S01194
0646 C**********           MOVE '  10'    ZTABKY                          S01194
0647 C**********                                                          S01194
0648 C********** ZTABKY    CHAINTABLE                99    ON NOT THERE   S01194
0649 C**N99***** RECI      COMP 'D'                  9999  ON, IS DELETED S01194
0650 C**********                                                          S01194
0651 C*****CHECK*SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.                    S01194
0652 C********** DATF      COMP 'M'                      98MMDDYY, 98 ON  S01194
0653 C**********                                                          S01194
0654 C**********           ENDSR                                          S01194
0655 C**
0656 C**
0657 C********************************************************************
0658 C* SUBROUTINE TO ADD AN AMOUNT (ZZAMT) TO THE TOTAL (ZZTOTI,ZZTOTD)
0659 C*   IND '99' IS SET BY AN OVERFLOW ERROR
0660 C*
0661 CSR         GLZADD    BEGSR                           *** GLZADD ****
0662 C*
0663 CSR                   Z-ADDZZAMT     ZZAMT  153     91-DEFINE ZZAMT
0664 CSR 91                GOTO ZZAEND                     AMT = 0.BYPASS
0665 C*
0666 C* SPLIT ZZAMT INTO INTEGER AND DECIMAL FIELDS
0667 CSR                   Z-ADDZZAMT     ZZAMTI 150       INTEGER FIELD
0668 CSR                   MOVE ZZAMT     ZZAMTD  30       DECIMAL FIELD
0669 C* BOTH ZZAMTI AND ZZAMTD CONTAIN A 'SIGN' ZONE NOW
0670 C*
0671 CSR                   EXSR GLZSUM
0672 CSR         ZZAEND    ENDSR                           ** ZZAEND TAG *
0673 C*
0674 C********************************************************************
0675 C* SUBROUTINE TO CARRY OUT THE ADDITION FOR SUBROUTINES -
0676 C*                        GLZADD, GLZSUB, GLZCMP.
0677 C*          PARAMETERS PASSED -
0678 C*                     I/P ZZAMTI ZZAMTD
0679 C*                     O/P ZZTOTI ZZTOTD ZZNEGD IND 96 IND 99.
0680 C*
0681 CSR         GLZSUM    BEGSR                           *** GLZSUM ****
0682 C*
0683 CSR                   Z-ADDZZTOTI    ZZTOTI 150       DEFINE ZZTOTI
0684 CSR                   Z-ADDZZTOTD    ZZTOTD  30       DEFINE ZZTOTD
0685 CSR                   SETOF                     919293
0686 CSR                   SETOF                     949599
0687 C*
0688 C*    DETERMINE SIGN OF ZZAMTI & D,   92 IF NEG
0689 CSR         ZZAMTI    COMP 0                      9293
0690 CSR 93      ZZAMTD    COMP 0                      9293
0691 CSR 93                GOTO ZZSEND                     ZERO BYPASS
0692 C*
0693 C*    DETERMINE SIGN OF ZZTOTI & D, 91 IF NEG.
0694 CSR         ZZTOTI    COMP 0                      9193
0695 CSR 93      ZZTOTD    COMP 0                      9193
0696 C*
0697 C*    IF ZZTOTAL IS ZERO, RETURN ZZAMOUNT.
0698 CSR 93                Z-ADDZZAMTI    ZZTOTI
0699 CSR 93                Z-ADDZZAMTD    ZZTOTD
0700 CSR 93                GOTO ZZSEND                     ZERO BYPASS
0701 C*    IF SIGNS DIFFER BYPASS OVERFLOW CHECKS.
0702 CSR 91N92
0703 CORN91 92             GOTO ZZOFPS
0704 C*
0705 CSR         ZZAMTD    ADD  ZZTOTD    ZZWK2   40
0706 CSR         ZZWK2     COMP 999                  93    '93' = CARRY
0707 CSRN93      ZZWK2     COMP -999                   93    INTO INTEGER.
0708 C*
0709 CSR 93N92   ZZAMTI    ADD  1         ZZWK3  150       ADD 'CARRY' +VE
0710 CSR    93 92ZZAMTI    SUB  1         ZZWK3            SUB 'CARRY' -VE
0711 CSR 93      ZZTOTI    ADD  ZZWK3     ZZWK3
0712 CSRN93      ZZTOTI    ADD  ZZAMTI    ZZWK3
0713 C*
0714 C* IF THE MODULUS OF ZZWK3 IS LT MOD. ZZTOTI THEN O/F HAS OCCURED
0715 CSRN92      ZZWK3     COMP ZZTOTI                 99  -92 MEANS NOS.
0716 CSR 92      ZZWK3     COMP ZZTOTI               99     NEGATIVE
0717 CSRN99                Z-ADDZZWK2     ZZTOTD
0718 CSRN99                Z-ADDZZWK3     ZZTOTI
0719 C*
0720 C* IF O/F ZEROIZE ZZAMT , IND '99' SET AND ZZTOT FIELDS LEFT INTACT.
0721 CSR 99                Z-ADD0         ZZAMT  153
0722 CSR                   GOTO ZZSEND
0723 C*
0724 C* THE 'SIGNS' ARE DIFFERENT
0725 CSR         ZZOFPS    TAG                             ** ZZOFPS TAG**
0726 C* IF ZZAMT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZTOT
0727 C*
0728 CSR 92                Z-SUBZZAMTI    ZZAMTI 150
0729 CSR 92                Z-SUBZZAMTD    ZZAMTD  30
0730 C*
0731 C* IF ZZTOT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZAMT.
0732 C*
0733 CSR 91                Z-SUBZZTOTI    ZZTOTI
0734 CSR 91                Z-SUBZZTOTD    ZZTOTD
0735 C* BOTH ZZAMT AND ZZTOT ARE NOW POSITIVE.
0736 C*
0737 CSR         ZZTOTI    COMP ZZAMTI               93  95
0738 CSR 95      ZZTOTD    COMP ZZAMTD               93  95
0739 C*
0740 C* IF ZZTOT EQ. ZZAMT RETURN ZERO.
0741 CSR 95                Z-ADD0         ZZTOTI
0742 CSR 95                Z-ADD0         ZZTOTD
0743 CSR 95                GOTO ZZSEND
0744 C*
0745 C* IF ZZTOT GT. ZZAMT.
0746 CSR 93      ZZAMTD    COMP ZZTOTD               94
0747 CSR 93 94   ZZTOTI    SUB  1         ZZTOTI
0748 CSR 93 94   ZZTOTD    ADD  1000      ZZWK2
0749 CSR 93      ZZTOTI    SUB  ZZAMTI    ZZTOTI
0750 CSR 93 94   ZZWK2     SUB  ZZAMTD    ZZTOTD
0751 CSR 93N94   ZZTOTD    SUB  ZZAMTD    ZZTOTD
0752 C*
0753 C*
0754 C* IF ZZAMT GT. ZZTOT.
0755 CSRN93      ZZTOTD    COMP ZZAMTD               94
0756 CSRN93 94   ZZAMTI    SUB  1         ZZWK3  150
0757 CSRN93 94   ZZAMTD    ADD  1000      ZZWK2
0758 CSRN93 94   ZZWK3     SUB  ZZTOTI    ZZTOTI
0759 CSRN93N94   ZZAMTI    SUB  ZZTOTI    ZZTOTI
0760 CSRN93 94   ZZWK2     SUB  ZZTOTD    ZZTOTD
0761 CSRN93N94   ZZAMTD    SUB  ZZTOTD    ZZTOTD
0762 C*
0763 C* REVERSE SIGN OF ZZTOT IF LARGER I/P FIELDS WERE NEGATIVE
0764 CSR                   SETOF                     94
0765 CSR 93 91
0766 CORN93 92             SETON                     94
0767 CSR 94                Z-SUBZZTOTI    ZZTOTI
0768 CSR 94                Z-SUBZZTOTD    ZZTOTD
0769 C**
0770 C**   RESTORE SIGN OF ZZAMTI & ZZAMTD IF IT WAS REVERSED.
0771 CSR 92                Z-SUBZZAMTI    ZZAMTI
0772 CSR 92                Z-SUBZZAMTD    ZZAMTD
0773 CSR         ZZSEND    TAG                             ** ZZSEND TAG *
0774 C**
0775 C**   IF ZZTOTD IS ZERO, AND ZZTOTI IS NEG. SET UP ZZNEGD.
0776 CSR                   SETOF                     96
0777 CSR         ZZTOTD    COMP 0                        91
0778 CSR 91      ZZTOTI    COMP 0                      96
0779 CSR 96                MOVE '.000-'   ZZNEGD  5
0780 CSR                   ENDSR                             ** ENDSR **
0781 C********************************************************************
     C/EJECT                                                              CEU004
     C           XCAMT     BEGSR                                          CEU004
      *===================================================================CEU004
      * XCAMT: Convert Amount.                                            CEU004
      *                                                                   CEU004
      *                                                                   CEU004
      ** Convert Transaction Amount into Settlement Amount.               CEU004
      *                                                                   CEU004
      ** Determine if currencies are 'In' ccy's                           CLE031
      ** First check if event ccy is an 'In' ccy                          CLE031
      *                                                                   CLE031
     C                     CALL 'AOCURRR0'                                CLE031
     C                     PARM '*BLANKS' @RTCD                           CLE031
     C                     PARM '*KEY   ' @OPTN                           CLE031
     C                     PARM CCYSV     CURKEY  3                       CLE031
     C           SDCURR    PARM SDCURR    DSSDY                           CLE031
      *                                                                   CLE031
     C           @RTCD     IFNE *BLANKS                                   CLE031
     C           *LOCK     IN   LDA                                       CLE031
     C                     MOVEL'LE0430  'DBPGM                           CLE031
     C                     MOVE 'SDCURRPD'DBFILE           ************   CLE031
     C                     MOVE CCYSV     DBKEY            * DBERR 14 *   CLE031
     C                     Z-ADD14        DBASE            ************   CLE031
     C                     OUT  LDA                                       CLE031
     C                     EXSR *PSSR                                     CLE031
     C                     ENDIF                                          CLE031
      *                                                                   CLE031
     C                     MOVE A6INCY    CCYIN   1                       CLE031
     C                     MOVE A6NBDP    CCYDP   10                      CLE031
      *                                                                   CLE031
      ** Now check if receipt settlement ccy is an 'In' ccy               CLE031
      *                                                                   CLE031
     C                     CALL 'AOCURRR0'                                CLE031
     C                     PARM '*BLANKS' @RTCD                           CLE031
     C                     PARM '*KEY   ' @OPTN                           CLE031
     C                     PARM SCCY      CURKEY                          CLE031
     C           SDCURR    PARM SDCURR    DSSDY                           CLE031
      *                                                                   CLE031
     C           @RTCD     IFNE *BLANKS                                   CLE031
     C           *LOCK     IN   LDA                                       CLE031
     C                     MOVEL'LE0430  'DBPGM                           CLE031
     C                     MOVE 'SDCURRPD'DBFILE           ************   CLE031
     C                     MOVE SCCY      DBKEY            * DBERR 15 *   CLE031
     C                     Z-ADD15        DBASE            ************   CLE031
     C                     OUT  LDA                                       CLE031
     C                     EXSR *PSSR                                     CLE031
     C                     ENDIF                                          CLE031
      *                                                                   CLE031
     C                     MOVE A6INCY    SCCYIN  1                       CLE031
     C                     MOVE A6NBDP    SCCYDP  10                      CLE031
      *                                                                   CLE031
      ** If event currency or receipt settlement ccy is an 'In' ccy       CLE031
      *                                                                   CLE031
     C           CCYIN     IFEQ 'Y'                                       CLE031
     C           SCCYIN    OREQ 'Y'                                       CLE031
      *                                                                   CLE031
     C                     CALL 'EU0200'                                  CEU004
      *                                                    Input:         CEU004
     C                     PARM *BLANKS   P@RTCD  7        -Return Code   CEU004
     C                     PARM           P@FRAM 183       -FROM Ccy Amt  CEU004
     C                     PARM           P@FRCY  3        -FROM Currency CEU004
     C                     PARM           P@TOCY  3        -TO Currency   CEU004
      *                                                    Output:        CEU004
     C                     PARM           P@OUTA 150       -Outright Amt  CEU004
     C                     PARM           P@INTA 183       -Interim Amt   CEU004
     C                     PARM           P@EXRT 159       -Exchange Rate CEU004
     C                     PARM           P@MDIN  1        -Mult/Div Ind. CEU004
      *                                                                   CEU004
     C           P@RTCD    IFNE *BLANK                     If Error       CEU004
      *                                                                   CEU004
     C                     MOVEL'EU0200  'DBFILE            Set File      CEU004
     C                     MOVELCCY       DBKEY             Set Key       CEU004
     C                     Z-ADD10        DBASE             Set Ref       CEU004
     C                     SETON                     U7U8LR Set Inds      CEU004
     C                     ENDIF                           End If         CEU004
      *                                                                   CLE031
     C                     MOVE SCCY      CVCCY   3                       CLE031
      *                                                                   CLE031
     C                     ELSE                                           CLE031
      *                                                                   CLE031
     C           PYRC      IFEQ 'R'                                       CLE031
      *                                                                   CLE031
      ** Convert event amount to receipt settlement ccy                   CLE031
      *                                                                   CLE031
     C                     Z-ADDAMTSV     ZAMTCI                          CLE031
     C                     Z-ADDREXR      ZEXCH                           CLE031
     C                     MOVE REXI      ZMD                             CLE031
     C                     MOVE CCYSV     ZCCYI                           CLE031
     C                     MOVE SCCY      ZCCYO                           CLE031
     C                     Z-ADDCCYDP     ZCDPI                           CLE031
     C                     Z-ADDSCCYDP    ZCDPO                           CLE031
     C                     EXSR ZCONV                                     CLE031
     C                     Z-ADDZAMTCO    P@OUTA                          CLE031
      *                                                                   CLE031
     C                     MOVE SCCY      CVCCY                           CLE031
      *                                                                   CLE031
     C                     ELSE                                           CLE031
      *                                                                   CLE031
      ** First check number of decimal places on pay settlement ccy       CLE031
      ** then convert event amount to pay settlement ccy                  CLE031
      *                                                                   CLE031
     C                     CALL 'AOCURRR0'                                CLE031
     C                     PARM '*BLANKS' @RTCD                           CLE031
     C                     PARM '*KEY   ' @OPTN                           CLE031
     C                     PARM PSCY      CURKEY                          CLE031
     C           SDCURR    PARM SDCURR    DSSDY                           CLE031
      *                                                                   CLE031
     C           @RTCD     IFNE *BLANKS                                   CLE031
     C           *LOCK     IN   LDA                                       CLE031
     C                     MOVEL'LE0430  'DBPGM                           CLE031
     C                     MOVE 'SDCURRPD'DBFILE           ************   CLE031
     C                     MOVE PSCY      DBKEY            * DBERR 16 *   CLE031
     C                     Z-ADD16        DBASE            ************   CLE031
     C                     OUT  LDA                                       CLE031
     C                     EXSR *PSSR                                     CLE031
     C                     ENDIF                                          CLE031
      *                                                                   CLE031
     C                     MOVE A6NBDP    PSCYDP  10                      CLE031
      *                                                                   CLE031
     C                     Z-ADDAMTSV     ZAMTCI                          CLE031
     C                     Z-ADDPEXR      ZEXCH                           CLE031
     C                     MOVE PEXI      ZMD                             CLE031
     C                     MOVE CCYSV     ZCCYI                           CLE031
     C                     MOVE PSCY      ZCCYO                           CLE031
     C                     Z-ADDCCYDP     ZCDPI                           CLE031
     C                     Z-ADDPSCYDP    ZCDPO                           CLE031
     C                     EXSR ZCONV                                     CLE031
     C                     Z-ADDZAMTCO    P@OUTA                          CLE031
      *                                                                   CLE031
     C                     MOVE PSCY      CVCCY                           CLE031
      *                                                                   CLE031
     C                     ENDIF                                          CLE031
      *                                                                   CLE031
     C                     ENDIF                                          CLE031
      *                                                                   CEU004
      *===================================================================CEU004
     C                     ENDSR                                          CEU004
     C********************************************************************S01117
     C*                                                                   S01117
     C*  *PSSR --- SUBROUTINE TO HANDLE ABNORMAL ERROR CONDITIONS         S01117
     C*                                                                   S01117
     C*  CALLED FROM: AFTER ABNORMAL OPERATION OCCURS                     S01117
     C*                                                                   S01117
     C*  CALLS: NOTHING                                                   S01117
     C*                                                                   S01117
     C********************************************************************S01117
     C*                                                                   S01117
     C           *PSSR     BEGSR                           ** *PSSR **    S01117
     C*                                                                   S01117
     C           @RUN      IFEQ *BLANKS                                   S01117
     C                     MOVE 'Y'       @RUN    1                       S01117
     C                     DUMP                                           S01117
     C                     END                                            S01117
     C                     ENDSR                           ** *PSSR **    S01117
     C*                                                                   S01117
0341 C********************************************************************S01117
     C/COPY WNCPYSRC,LE0430C006
      /TITLE SR/ZCONV                                                                         CLE031
     C/COPY ZSRSRC,ZCONVZ1                                                                    CLE031
0782 O*
0783 O***LETX1HH*D        01                                              159932
     OLETX1HH T        LR                                                 159932
0784 O                                    1 'H'
0785 OLETX1PR D        02 31
0786 O       OR        05 31
0787 O                                    1 'D'
0788 O                         PYRC       2
0789 O                         SETP       4
0790 O                         CCY        7
0791 O**********               OSAC      19                                                   CGL029
     O                         OSACQQ    19                                                   CGL029
0792 O                         VDAT      22P
0793 O                         TSEN      32
0794 O                         CNUM      38
0795 O                         FCLN      44
0796 O                         EAMT      51P
0797 O                         RCDT      52
0798 O                         AMTP      54
0799 O                         LASN      57
0800 O                         FACO      67
0801 O                         SPI      157
0802 O                         PRI1   B 158
0803 O                         PRI2   B 159
0804 O                         PRI3   B 160
0805 O                         PRI4   B 161
0806 O                         BICN     167
0807 O                         LTYP     169
0808 O                         SUTP     171
0809 O                         PTYP     173
0810 O                         TIND     174
0846 O***********              BRCD     177                               S01117
0846 O                         BRCA     177                               S01117
0812 O                         INTC     178
     O                         OSBR     181                               S01117
     O                         OTAM     207P                              CEU004
     O                         OTCY     210                               CEU004
     O                         OSAC     228                                                   CGL029
     O                         CLAS     232                                                   CLE042
0813 OLETX1ZZ T        LR
0814 O                                    1 'T'
0815 O                         NORE1      4P
0816 O                         EAMTI1    12P
0817 O                         EAMTD1    14P
0818 O***LETX2HH*D        01                                              159932
     OLETX2HH T        LR                                                 159932
0819 O                                    1 'H'
0820 OLETX2PR D        02 32
0821 O       OR        05 32
0822 O                                    1 'D'
0823 O                         PYRC       2
0824 O                         SETP       4
0825 O                         CCY        7
0826 O**********               OSAC      19                                                   CGL029
     O                         OSACQQ    19                                                   CGL029
0827 O                         VDAT      22P
0828 O                         TSEN      32
0829 O                         CNUM      38
0830 O                         FCLN      44
0831 O                         EAMT      51P
0832 O                         RCDT      52
0833 O                         AMTP      54
0834 O                         LASN      57
0835 O                         FACO      67
0836 O                         SPI      157
0837 O                         PRI1   B 158
0838 O                         PRI2   B 159
0839 O                         PRI3   B 160
0840 O                         PRI4   B 161
0841 O                         BICN     167
0842 O                         LTYP     169
0843 O                         SUTP     171
0844 O                         PTYP     173
0845 O                         TIND     174
0846 O***********              BRCD     177                               S01117
0846 O                         BRCA     177                               S01117
0847 O                         INTC     178
     O                         OSBR     181                               S01117
     O                         OTAM     207P                              CEU004
     O                         OTCY     210                               CEU004
     O                         OSAC     228                                                   CGL029
     O                         CLAS     232                                                   CLE042
0848 OLETX2ZZ T        LR
0849 O                                    1 'T'
0850 O                         NORE2      4P
0851 O                         EAMTI2    12P
0852 O                         EAMTD2    14P
0853 O***LETX3HH*D        01                                              159932
     OLETX3HH T        LR                                                 159932
0854 O                                    1 'H'
0855 OLETX3PR D        02 33
0856 O       OR        05 33
0857 O                                    1 'D'
0858 O                         PYRC       2
0859 O                         SETP       4
0860 O                         CCY        7
0861 O**********               OSAC      19                                                   CGL029
     O                         OSACQQ    19                                                   CGL029
0862 O                         VDAT      22P
0863 O                         TSEN      32
0864 O                         CNUM      38
0865 O                         FCLN      44
0866 O                         EAMT      51P
0867 O                         RCDT      52
0868 O                         AMTP      54
0869 O                         LASN      57
0870 O                         FACO      67
0871 O                         SPI      157
0872 O                         PRI1   B 158
0873 O                         PRI2   B 159
0874 O                         PRI3   B 160
0875 O                         PRI4   B 161
0876 O                         BICN     167
0877 O                         LTYP     169
0878 O                         SUTP     171
0879 O                         PTYP     173
0880 O                         TIND     174
0881 O***********              BRCD     177                               S01117
0881 O                         BRCA     177                               S01117
0882 O                         INTC     178
     O                         OSBR     181                               S01117
     O                 05      FEESEQ   183                               E45727
     O                         OTAM     207P                              CEU004
     O                         OTCY     210                               CEU004
     O                         OSAC     228                                                   CGL029
     O                         CLAS     232                                                   CLE042
0883 OLETX3ZZ T        LR
0884 O                                    1 'T'
0885 O                         NORE3      4P
0886 O                         EAMTI3    12P
0887 O                         EAMTD3    14P
0888 O***LETX4HH*D        01                                              159932
     OLETX4HH T        LR                                                 159932
0889 O                                    1 'H'
0890 OLETX4PR D        02 34
0891 O       OR        05 34
0892 O                                    1 'D'
0893 O                         PYRC       2
0894 O                         SETP       4
0895 O                         CCY        7
0896 O**********               OSAC      19                                                   CGL029
     O                         OSACQQ    19                                                   CGL029
0897 O                         VDAT      22P
0898 O                         TSEN      32
0899 O                         CNUM      38
0900 O                         FCLN      44
0901 O                         EAMT      51P
0902 O                         RCDT      52
0903 O                         AMTP      54
0904 O                         LASN      57
0905 O                         FACO      67
0906 O                         SPI      157
0907 O                         PRI1   B 158
0908 O                         PRI2   B 159
0909 O                         PRI3   B 160
0910 O                         PRI4   B 161
0911 O                         BICN     167
0912 O                         LTYP     169
0913 O                         SUTP     171
0914 O                         PTYP     173
0915 O                         TIND     174
0916 O***********              BRCD     177                               S01117
0916 O                         BRCA     177                               S01117
0917 O                         INTC     178
     O                         OSBR     181                               S01117
     O                         OTAM     207P                              CEU004
     O                         OTCY     210                               CEU004
     O                         OSAC     228                                                   CGL029
     O                         CLAS     232                                                   CLE042
0918 OLETX4ZZ T        LR
0919 O                                    1 'T'
0920 O                         NORE4      4P
0921 O                         EAMTI4    12P
0922 O                         EAMTD4    14P
     O*
     O***LEPXTAA*D***     01 U4                                           CLE007
     O***LEPXTAA*D***     01 U4N22                                  CLE007159932
     OLEPXTAA T        LR U4                                              159932
     O                                    1 'H'
     OLEPXTAB D        02 U4 36
     O       AND      N25                                                 175758
     O       OR        05 U4 36
     O       AND      N25                                                 175758
     O                                    1 'D'
     O                         FCLN       7
     O                         VDAT      10P
     O                         LASN      13
     O                         LTYP      16
     O                         SUTP      18
     O                         PTYP      20
     O                         AMTP      22
     O                         OSBR      25                               S01117
     O                         CCY       35
     O                         EAMT      70P
     O***********              BRCD      73                               S01117
     O                         BRCA      73                               S01117
     O**********               CNUM      79                               175758
     O                N37      CNUM      79                               175758
     O                 37      CNUMP1    79                               175758
     O                         OSBR      82                               S01117
     O                         SETP      84
     O**********               OSAC      96                                                   CGL029
     O                         OSACQQ    96                                                   CGL029
     O                         TSEN     106
     O                         FACO     116
     O                         SPI      206
     O                         RCDT     217
     O                         PYRC     249
     O                         INTC     251
     O                         CSID     265
     O                         RSTM     279                               S01518
     O**********               RONS     291                                            S01518 CGL029
     O                         RONSQQ   291                                                   CGL029
     O                         RIBN     299                               S01518
     O                         RIBA     334                               S01518
     O                         ROBN     340                               S01518
     O                         ROCN     346                               S01518
     O                         OTAM     353P                              CEU004
     O                         OTCY     356                               CEU004
     O                         OSAC     374                                                   CGL029
     O                         RONS     392                                                   CGL029
     O                         CLAS     402                                                   CLE042
     OLEPXTAB E        02 U4 36COVER                                      175758
     O       AND       24                                                 175758
     O       OR        05 U4 36                                           175758
     O       AND       24                                                 175758
     O                                    1 'D'                           175758
     O                         FCLN       7                               175758
     O                         VDAT      10P                              175758
     O                         LASN      13                               175758
     O                         LTYP      16                               175758
     O                         SUTP      18                               175758
     O                         PTYP      20                               175758
     O                         AMTP      22                               175758
     O                         OSBR      25                               175758
     O                         CCY       35                               175758
     O                         EAMT      70P                              175758
     O                         BRCA      73                               175758
     O                N37      CNUM      79                               175758
     O                 37      CNUMP1    79                               175758
     O                         OSBR      82                               175758
     O                         SETP      84                               175758
     O**********               OSAC      96                               175758       175758 CGL029
     O                         OSACQQ    96                                                   CGL029
     O                         TSEN     106                               175758
     O                         FACO     116                               175758
     O                         SPI      206                               175758
     O                         RCDT     217                               175758
     O                         PYRC     249                               175758
     O                         INTC     251                               175758
     O                         CSID     265                               175758
     O                         CVMI     277                               175758
     O                         RSTM     279                               175758
     O**********               RONS     291                                            175758 CGL029
     O                         RONSQQ   291                                                   CGL029
     O                         RIBN     299                               175758
     O                         RIBA     334                               175758
     O                         ROBN     340                               175758
     O                         ROCN     346                               175758
     O                         OSAC     374                                                   CGL029
     O                         RONS     392                                                   CGL029
     O                         CLAS     402                                                   CLE042
     O*
     OLEPXTAC E        23                                                 CLE007
     O                         NORE5      4P                              CLE007
     O                         EAMTI5    12P                              CLE007
     O                         EAMTD5    14P                              CLE007
     O*
     O***LEPXTAC*T***     LR U4                                           CLE007
     OLEPXTAC TADD     LR U4N22                                           CLE007
     O                                    1 'T'
     O                         NORE5      4P
     O                         EAMTI5    12P
     O                         EAMTD5    14P
1139 O**   CHIPS PAYMENTS/CREDITS FILE.                                   S2659
1140 O**                                                                  S2659
1141 O***LETX6HH*D        U1 01                                     S2659 159932
     OLETX6HH T        U1 LR                                              159932
1142 O                                    1 'H'                           S2659
1143 OLETX6PR D        U1 02 76                                           S2659
1144 O       OR        U1 05 76                                           S2659
1145 O                                    1 'D'                           S2659
1146 O                         PYRC       2                               S2659
1147 O                         SETP       4                               S2659
1148 O                         CCY        7                               S2659
1149 O                         OSAC      19                               S2659
1150 O                         VDAT      22P                              S2659
1151 O                         TSEN      32                               S2659
1152 O                         CNUM      38                               S2659
1153 O                         FCLN      44                               S2659
1154 O                         EAMT      51P                              S2659
1155 O                         RCDT      52                               S2659
1156 O                         AMTP      54                               S2659
1157 O                         LASN      57                               S2659
1158 O                         FACO      67                               S2659
1159 O                         SPI      157                               S2659
1160 O                         PRI1   B 158                               S2659
1161 O                         PRI2   B 159                               S2659
1162 O                         PRI3   B 160                               S2659
1163 O                         PRI4   B 161                               S2659
1164 O                         BICN     167                               S2659
1165 O                         LTYP     169                               S2659
1166 O                         SUTP     171                               S2659
1167 O                         PTYP     173                               S2659
1168 O                                  174 ' '                           S2659
1169 O                         BRCA     177                               S2659
1170 O                         INTC     178                               S2659
1170 O                         OSBR     181                               S2659
1171 OLETX6ZZ T        U1 LR                                              S2659
1172 O                                    1 'T'                           S2659
1173 O                         NORE6      4P                              S2659
1174 O                         EAMTI6    12P                              S2659
1175 O                         EAMTD6    14P                              S2659
1176 O**                                                                  S2659
     O/COPY WNCPYSRC,LE0430O002
     O*
0923 O*E0430P1T**203   LR                                                 S01124
     OLE0430AUT  203   LR                                                 S01117
0924 O***********                        22 'REFERENCE LE0430'            S01117
0924 O                                   24 'REFERENCE LE0430AU'          S01117
0925 O                         TITL      89
0926 O                                  104 'DATE'
0927 O                         RUNA     112
0928 O                                  122 'PAGE'
0929 O                         PAGE  Z  127
0930 O        T  1     LR
0931 O                                   58 'END OF DAY PAY/RECEIVE'
0932 O                                   79 'TELEX EXTRACT - FILE'
0933 O                                   88 'CONTROLS'
0934 O        T  3     LR
0935 O                                   59 '-----------------------'
0936 O                                   80 '---------------------'
0937 O                                   88 '--------'
0938 O********T*32     U7 U8 LR                                           S01117
0939 O***********                        42 '*** REFERENCE'               S01117
0940 O***********              DBPGM     51                               S01117
0941 O***********                        71 '-DATABASE ERROR AT'          S01117
0942 O***********              DBASE     74                               S01117
0943 O********T**   20 U7 U8 LR                                           S01117
0944 O***********                        17 'FILE NAME'                   S01117
0945 O***********              DBFILE    23                               S01117
0946 O***********                        28 'KEY'                         S01117
0947 O***********              DBKEY     58                               S01117
0948 O        T  1     LR
0949 O                                   28 'S/LETLX - RUN CONTROLS'
0950 O                                   59 'NUMBER'
0951 O                                   84 'VALUE'
0952 O        T  2     LR
0953 O                                   28 '----------------------'
0954 O                                   59 'OF RECORDS'
0955 O                                   84 'OF RECORDS'
0956 O        T  2     LR
0957 O                                   29 'TOTAL RECORDS ON FILE'
0958 O                      NU7NOREA 3   59
0959 O        T  3     LR
0960 O                                   29 'TOTAL RECORDS ON FILE'
0961 O                                   42 '- CALCULATED'
0962 O                         NUMREC3   59
0963 O                 U8NU7 83         111 '***   DIFFERENCE   ***'
0964 O        T  1     LR
0965 O                                   28 'S/CFTLX - RUN CONTROLS'
0966 O        T  2     LR
0967 O                                   28 '----------------------'
0968 O        T  2     LR
0969 O                                   29 'TOTAL RECORDS ON FILE'
0970 O                      NU7NORE  3   59
0971 O        T  3     LR
0972 O                                   29 'TOTAL RECORDS ON FILE'
0973 O                                   42 '-CALCULATED'
0974 O                         NUMRCD3   59
0975 O        T  2     LR
0976 O                                   29 ' '
0977 O                 U8NU7 84         111 '***   DIFFERENCE   ***'
0978 O        T  1     LR
0979 O                                   28 'S/LETX1 - RUN CONTROLS'
0980 O        T  2     LR
0981 O                                   28 '----------------------'
0982 O        T  3     LR
0983 O                                   29 'TOTAL RECORDS ON FILE'
0984 O                         NORE1 3   59
0985 O                         EAMTI1Z   81
0986 O**********               EAMTD1    84                                                   245691
0986 O                         EAMTD1L   85                                                   245691
0987 O        T  1     LR
0988 O                                   28 'S/LETX2 - RUN CONTROLS'
0989 O        T  2     LR
0990 O                                   28 '----------------------'
0991 O        T  3     LR
0992 O                                   29 'TOTAL RECORDS ON FILE'
0993 O                         NORE2 3   59
0994 O                         EAMTI2Z   81
0995 O**********               EAMTD2    84                                                   245691
0995 O                         EAMTD2L   85                                                   245691
0996 O        T  1     LR
0997 O                                   28 'S/LETX3 - RUN CONTROLS'
0998 O        T  2     LR
0999 O                                   28 '----------------------'
1000 O        T  3     LR
1001 O                                   29 'TOTAL RECORDS ON FILE'
1002 O                         NORE3 3   59
1003 O                         EAMTI3Z   81
1004 O**********               EAMTD3    84                                                   245691
1004 O                         EAMTD3L   85                                                   245691
1005 O        T  1     LR
1006 O                                   28 'S/LETX4 - RUN CONTROLS'
1007 O        T  2     LR
1008 O                                   28 '----------------------'
1009 O        T  3     LR
1010 O                                   29 'TOTAL RECORDS ON FILE'
1011 O                         NORE4 3   59
1012 O                         EAMTI4Z   81
1013 O**********               EAMTD4    84                                                   245691
1013 O                         EAMTD4L   85                                                   245691
     O        T  1     LR U4
     O                                   28 'S/LEPXT - RUN CONTROLS'
     O        T  2     LR U4
     O                                   28 '----------------------'
     O        T  3     LR U4
     O                                   29 'TOTAL RECORDS ON FILE'
1013 O                         NORE5 3   59
1013 O                         EAMTI5Z   81
1013 O**********               EAMTD5    84                                                   245691
1013 O                         EAMTD5L   85                                                   245691
1277 O        T  1     LR U1                                              S2659
1278 O                                   28 'S/LETX6 - RUN CONTROLS'      S2659
1279 O        T  2     LR U1                                              S2659
1280 O                                   28 '----------------------'      S2659
1281 O        T  3     LR U1                                              S2659
1282 O                                   29 'TOTAL RECORDS ON FILE'       S2659
1283 O                         NORE6 3   59                               S2659
1284 O                         EAMTI6Z   81                               S2659
1285 O**********               EAMTD6    84                                             S2659 245691
     O                         EAMTD6L   85                                                   245691
     O/COPY WNCPYSRC,LE0430O001
0938 O        T 32     U7 U8 LR                                           S01117
0939 O                                   39 '*** REFERENCE'               S01117
0940 O                         DBPGM     51                               S01117
0941 O                                   71 'DATABASE ERROR AT'           S01117
0942 O                         DBASE     75                               S01117
0943 O        T     20 U7 U8 LR                                           S01117
0944 O                                   39 'FILENAME'                    S01117
0945 O                         DBFILE    48                               S01117
0946 O                                   52 'KEY'                         S01117
0947 O                         DBKEY     82                               S01117
1014 O********T*1      LR                                                 S01117
1015 O***********                        76 '*** END OF REPORT ***'       S01117
** CPY@   **      OBJECT COPYRIGHT
(c) Finastra International Limited 2001
**  POWER - ARRAY OF POWERS FOR CURRENCY CONVERSION                       CLE031
0000001                                                                   CLE031
0000010                                                                   CLE031
0000100                                                                   CLE031
0001000                                                                   CLE031
0010000                                                                   CLE031
0100000                                                                   CLE031
1000000                                                                   CLE031
**   SVAL  -  SYSTEM VALUES ARRAY                                                             218782
Settlement09Postings                                                                          218782
