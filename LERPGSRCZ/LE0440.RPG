0001 H        1                                                           S01117
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas LE Loan amendments update - phase II')           *
0001 H***********                                                         S01117
0002 F*****************************************************************
0003 F*                                                               *
0004 F*  Midas - Customer Lending Module                              *
0005 F*                                                               *
0006 F*  LE0440 - LOAN AMENDMENTS PHASE II UPDATE                     *
0007 F*                                                               *
      *  (c) Misys International Banking Systems Ltd. 2001            *
      *                                                               *
      *  Last Amend No. AR847588           Date 09Mar15               *
      *  Prev Amend No. AR786878           Date 06Jun13               *
      *                 AR1056323          Date 14Nov12               *
      *                 AR700107           Date 01Aug12               *
      *                 CLE134             Date 01Aug12               *
      *                 CLE148             Date 23Jul12               *
      *                 CRE073             Date 06Dec10               *
      *                 AR698840           Date 21Jan11               *
      *                 CER059             Date 19Jul10               *
      *                 CER020             Date 19May08               *
      *                 BUG27199           Date 26May10               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      *                 BUG27358           Date 05Apr10               *
      *                 258399             Date 15Jan09               *
      *                 CSC042             Date 16Feb09               *
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *                 CPK028             Date 24Jan08               *
      *                 248570             Date 19Jun07               *
      *                 246490             Date 23Mar07               *
      * Midas Plus 1.4 Base ------------------------------------------*
      *                 242385A            Date 16Nov06               *
      *                 BUG13515           Date 01Mar07               *
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 240114             Date 31May06               *
      *                 CSD031             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 CLE042             Date 06Sep05               *
      *                 BUG9195            Date 10Nov05               *
      *                 BUG9021            Date 21Oct03               *
      *                 CLE036             Date 15Oct03               *
      *                 BUG4775            Date 24Nov04               *
      *                 BUG4081            Date 13Sep04               *
      *                 CGL029             Date 01Sep03               *
      *                 CAP075             Date 08Aug02               *
      *                 219424             Date 05Jul03               *
      *                 CLE034             Date 05May03               *
      *                 216543             Date 02Apr03               *
      *                 CLE031             Date 10Feb03               *
      *                 CAS006             Date 21Jan03               *
      *                 CAS005             Date 16Dec02               *
      *                 CGL020             Date 12Dec02               *
      *                 217652             Date 15May03               *
      *                 CLE028             Date 27Jun02               *
      * Midas Release 4.01.03 ----------------------------------------*
      *                 213200             Date 07Jan03               *
      * Midas Release 4.01.02 ----------------------------------------*
      *                 201123             Date 05Mar02               *
      * Midas Release 4.01 -------------------------------------------*
      * Midas Release 4 --------------- Base -------------------------*
      *                 180044             Date 17Jul01               *
      *                 189590             Date 12Jun01               *
      * Midas DBA 3.05 -----------------------------------------------*
      *                 CLE011             Date 07Nov00               *
      * Midas DBA 3.03 -----------------------------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 157591             Date 04May99               *
      *                 157556             Date 28Apr99               *
      *                 155572             Date 16Feb99               *
      *                 140610             Date 13Aug98               *
      *                 136484             DATE 29SEP98               *
      *                 CEU004             Date 02Feb98               *
     F*                 127718             Date 21Nov97               *
     F*                 127660             Date 14Nov97               *
     F*                 CLE007             Date 22May97               *
     F*                 CLE005             Date 22May97               *
     F*                 S01408             DATE 05SEP96               *
     F*                 CAC001             DATE 23AUG96               *
     F*                 S01408             DATE 23MAY96               *
     F*                 S01408             DATE 25APR96               *
     F*                 S01518             DATE 03OCT94               *
     F*                 061369             DATE 17FEB94               *
     F*                 S01392             DATE 14SEP92               *
     F*                 E26745             DATE 31MAR92               *
     F*                 S01220             DATE 15MAR91               *
     F*                 BHF660             DATE 24SEP90               *
     F*                 BHF067             DATE 16MAY90               *
     F*                 S01260             DATE 12MAR90               *
     F*                 S01194             DATE 04JAN90               *
     F*                 S01117             DATE 28/08/89              *
     F*                 E11641             DATE 23/09/87              *
     F*                 86108              DATE 03/03/87              *
     F*                 86107              DATE 03/03/87              *
     F*                                                               *
     F*---------------------------------------------------------------*
      *                                                               *
      *  AR847588 - Allow system to create/drop a negative past due   *
      *             since negative spread rate is now allowed.        *
      *             (Child: AR847588). Applied for MD033488.          *
      *  AR786878 - New processing for manual repayment and           *
      *             repayment schedule for PDCL's. (Child:AR786879)   *
      *  AR1056323 - Revert back changes of CLE134 for LKEY1DP and    *
      *              LKEYFED (Recompile)                              *
      *  AR700107 - Prevent generation of RE/MR events for PDCLs that *
      *             have settlement a/c block all debit = 'Y'.        *
      *             (Child: AR700108)                                 *
      *  CLE134 - Past Due Call Loan Processing                       *
      *  CLE148 - Alpha Loan Reference                                *
      *  CRE073 - Interest Rate Rounding                              *
      *  AR698840 - LEC06A 00010 Data mapping error on member LOAMSDK *
      *             (Child: AR698841)                                 *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  CER020 - Enhanced Rollover Window: Upgrade FGE089 to         *
      *           Midas Plus                                          *
      *  BUG27199 - Incorrect computation of hash totals when a new   *
      *             past due is created with AMTP = 'RE'              *
      *  BUG27358 - LEC06A Seq. 00010, data mapping error on LOAMSDK, *
      *             applied GEMS Fix 261321                           *
      *  258399 - Records added to NLAMSDK should also be added to    *
      *           NLAMSQD (CLOAMSQD).                                 *
      *  CSC042 - COB Performance fix. Only access AOBRCHR0 on change of *
      *           branch rather than every record as input file sorted by*
      *           branch                                                 *
      *           Pgm makes thousands of calls to AOCURRR* for decimal*
      *           places. Store these in an array in first cycle      *
      *  CPK028 - Customer numbers should be alphanumeric.            *
      *  248570 - Don't terminate the program if system value         *
      *           "ZeroPastDueRiskLoan" is not found.                 *
      *  246490 - Invalid data on ROLN field in LOAMSDK after COB     *
      *           (Apply GEMS 235579 and 244214A). Include remaining  *
      *           LOAMS fields RSTM, FRAM, FINT, FIXA and FTOT        *
      *  244214A - Rest of fields for LOAM record still has           *
      *            corrupt value ('++++'). Further amendment          *
      *            to 244214 / 235579.                                *
      *  244214 - Data Mapping error when confirming authorise of     *
      *           a Principal Transfer (apply GEMS 235579).           *
      *  235579 - The invalid defined numeric fields in the I-Spec    *
      *           and O-SPEC of ACTN3DK caused decimal data error.    *
      *  242385A - Guarantee loans should not be automatically settled*
      *           on maturity date and corresponding past due records *
      *           must be produced and reported. Applied local fix    *
      *           for CIC-LDN at DBA3.5 (GEMS 213846). It will be     *
      *           made switchable here via zonal system value         *
      *           "ZeroPastDueRiskLoan". This is reopen of initial    *
      *           fix GEMS 242385.                                    *
      *  BUG13515 - Empty OLNO caused a database error 81 in LE0470   *
      *  240114 - Repayment type 2 loans should also generate past    *
      *           due interest account keys. Applied fix 195050.      *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CLE042 - Extended Loan Sub Type                              *
      *  BUG9195 - Status is blank when writing records to NLAMSDK    *
      *  BUG9021 - A Past Due Loan with REPT = 1 produced an RE for   *
      *            interest due to Grace days for Interest. Make STAL *
      *            'N' as there are no allocations for this RE, and   *
      *            generate a new PCRF for it.                        *
      *  CLE106 - Syndication Manager                                 *
      *  CLE036 - Lending Enhancements for Nordea Phase 1 Priority 2: *
      *           Allow repayments in facility currency               *
      *  BUG4775 - Event Control date should not be checked if Past   *
      *            Due A/C keys are to be generated - the Taken date  *
      *            in Settlement Currency may be after the ECDT date. *
      *            EMGFIX is included in this fix which is intended to*
      *            correct problem with time stamp.                   *
      *  BUG4081 - Repayment type should not be set to 1 for Past Due,*
      *            should be the same value as in CLOANCL.            *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  CAP075 - Lending API enhancements - Loan Amendment.          *
      *           (amendment in common with CAP079)                   *
      *  219424 - LOAMSDK Settlement Allocation flag overwritten by   *
      *           STAL from CLOANCL. Amendment to CLE034.             *
      *  CLE034 - Lending Enhancements Phase 1 Priority 1A            *
      *  216543 - Amendment to 213200 - ensure that PCRF is in I-specs*
      *           of ACTN5DK, to prevent duplicate PCRF on Past Dues. *
      *  CLE031 - Lending Enhancements.                               *
      *  CAS006 - Hedge Accounting Phase B (Recompile)                *
      *  CAS005 - Enahancements to CAS001, CAS002 and CAS004          *
      *           (Recompile)                                         *
      *  CGL020 - Midas Compliance Watch - Additional A/C Posting     *
      *           Information                                         *
      *  217652 - SCCY, ICCY, ECIN & REPI are corrupted.              *
      *  CLE028 - Flat Rate Personal Loans (Rule of 78s)              *
      *  213200 - Ensure that generated past due loan amendments      *
      *           always have pcrf values or Loan Manager download    *
      *           will fail with duplicate key error.                 *
      *  201123 - Include Original Borrower in this report when       *
      *           processing type of loan is either 64, 65, 68 or 71. *
      *  180044 - Report details of the reversed past due record in   *
      *           LE0440P1 with narrative 'REVERSED'.                 *
      *         - Do not generate PD account key for the reversal. PD *
      *           a/key will be generated by LE0450.                  *
      *  189590 - Past due report shows incorrect sequence number.    *
      *           Remove fix of CLE005 which adds 1 to the sequence   *
      *           number since the sequence number is already checked *
      *           by SR/CHECSQ.                                       *
      *  CLE011 - Rate Fixing Days for Lending Rollover Processing    *
      *           Recompile                                           *
      *  157591 - File out of balance in LE0600.                      *
      *  157556 - Grace days for repayments should consider repayment *
      *           types.                                              *
     F*  155572 - Change title of P1 report                           *
     F*  140610 - Due date of past due event in LE0610P1 is wrong.    *
     F*           Rename VDAT in CLOAN to VDATX so that VDAT in       *
     F*           ACTN6 or LAUPD is not overwritten.                  *
     F*  136484 - Past due repayments for loans which have been paid  *
     F*           today must not be reflected in LE0440P1 report.     *
     F*  CEU004 - EMU Lending Settlement Currency Conversion.         *
     F*  127718 - PD records are being dropped                        *
     F*  127660 - OOB in PDUE                                         *
     F*  CLE007 - Customer Lending Enhancements - Others (T3)         *
     F*  CLE005 - Customer Lending Enhancements - Tranche 3           *
     F*  S01408 - Addition of core hook LE0440CP15                    *
     F*  CAC001 - Profit Centre Accounting Development:               *
     F*           Output Funding Information on new loan amendments   *
     F*           file.                                               *
     F*  S01408 - Addition of core hook LE0440FFP2                    *
     F*           Addition of core hook LE0440CP11                    *
     F*           Addition of core hook LE0440CP12                    *
     F*           Addition of core hook LE0440CP13                    *
     F*           Addition of core hook LE0440CP14                    *
     F*  S01408 - Addition of core hook LE0440FFP1                    *
     F*           Addition of core hook LE0440CCP1                    *
     F*           Addition of core hook LE0440CCP2                    *
     F*           Addition of core hook LE0440IIP1                    *
     F*  S01518 - BLI Lending Swift Enhancements.                     *
     F*  061369 - Loans with processing type 70 (guarantees) should   *
     F*           have zero principal and should not be output to     *
     F*           PDUE and NLAMS files.                               *
     F*  S01392 - JAPANESE SUB MODULE ENHANCEMENTS                    *
     F*  E26745 - INCORRECT CHECK ON RECOURSE IND - IT IS NOW Y/N     *
     F*  S01220 - AMENDED FOR STRATEGIC RISK MANAGEMENT               *
     F*           RELEASE 10 TO ALLOW THE INPUT OF A BOOK             *
     F*           CODE AGAINST A LOAN.                                *
     F*  BHF660 - INCORRECT LAYOUT FOR THE REPORT WHEN NO             *
     F*           DETAILS TO REPORT.                                  *
     F*  BHF067 - OVERPRINTING ON PAST DUE PAYMENTS DROPPED           *
     F*           REPORT                                              *
     F*  S01260 - ORIGINAL BORROWER ON PARTICIPATIONS PURCHASED.      *
     F*  S01194 - STANDING DATA CHANGES                               *
     F*  S01117 - MULTIBRANCHING                                      *
     F*  E11641 - Loan amendments trailer update value may not        *
     F*           process negative values correctly .                 *
     F*           Code dependent on 1 output record being             *
     F*           produced from a single input (uses I spec.ind.)     *
     F*  86108  - FULL REPAYMENT AMOUNT SHOULD NOT BE REPORTED        *
     F*           UNDER 'PRIN PAST DUE' WHEN REPAYMENT IND EQUALS     *
     F*           3.                                                  *
     F*  86107  - PAST DUE RECORD PRODUCED ALTHOUGH MANUAL            *
     F*           REPAYMENT WAS INPUT ON DAY AMOUNT WOULD BECOME      *
     F*           PAST DUE. CAUSES PAST DUE FIGURE OF 0 ON REPORT     *
     F*           DROPPED AUTOMATICALLY NEXT DAY. PD RECORD           *
     F*           SHOULD BE DROPPED ON RUN DATE.                      *
     F*                                                               *
0012 F*****************************************************************
     F*                                                               *
     F*  C R E A T I O N     P A R A M E T E R S                      *
     F*                                                               *
     F*                                                               *
     F*****************************************************************
0011 F*                                                                  *
0013 F*CTN6***IP*AF     320 10AI     2 DISK
0013 F***ACTN6L1*IP AF     320 10AI     2 DISK                     S01117 S01518
     F***ACTN6L1*IP AF     949 10AI     2 DISK                     S01518 CAC001
0014 F***LAUPD***IS AF     320 14AI     2 DISK                            S01518
     F***LAUPD***IS AF     949 14AI     2 DISK                     S01518 CAC001
0015 F*TABLE***IF**F      96 12AI     2 DISK                              S01194
     F*CLOAN***IF**F*****400  7AI     2 DISK                        S01260S01220
     F***CLOAN***IF  F     436  7AI     2 DISK                      S01220S01518
     F***CLOAN***IF  F    1087  7AI     2 DISK                     S01518 CAC001
     F***ACTN6L1*IP*AF     969 10AI     2 DISK                     CAC001 CLE005
     F***LAUPD***IS*AF     969 14AI     2 DISK                     S01518 CLE005
     F***CLOAN***IF**F    1187  7AI     2 DISK                     S01518 CLE005
     F***ACTN6L1*IP AF    1060 10AI     2 DISK                                         CLE005 CLE028
     F***ACTN6L1*IP AF    1075 10AI     2 DISK                                         CLE028 CLE031
     F***ACTN6L1 IP AF    1108 10AI     2 DISK                                         CLE031 CLE034
     F***ACTN6L1 IP AF    1109 10AI     2 DISK                                         CLE034 CAP075
     F***ACTN6L1 IP AF    1176 10AI     2 DISK                                         CAP075 CGL029
     F***ACTN6L1 IP AF    1230 10AI     2 DISK                                         CGL029 CLE036
     F*ACTN6L1*IP*AF****1278 10AI     2 DISK                                           CLE036 CLE042
     FACTN6L1 IP AF    1291 10AI     2 DISK                                                   CLE042
     F***LAUPD***IS AF    1060 14AI     2 DISK                     CLE005 CEU004
     F***LAUPD***IS AF    1066 14AI     2 DISK                                         CEU004 CLE028
     F***LAUPD** IS AF    1075 14AI     2 DISK                                         CLE028 CLE031
     F***LAUPD** IS AF    1108 14AI     2 DISK                                         CLE031 CLE034
     F***LAUPD** IS AF    1109 14AI     2 DISK                                         CLE034 CAP075
     F***LAUPD** IS AF    1176 14AI     2 DISK                                         CAP075 CGL029
     F***LAUPD** IS AF    1230 14AI     2 DISK                                         CGL029 CLE036
     F*LAUPD***IS*AF****1278 14AI     2 DISK                                           CLE036 CLE042
     FLAUPD   IS AF    1291 14AI     2 DISK                                                   CLE042
     F*CLOAN***IF**F    1284  7AI     2 DISK                       CLE005 CLE011
     F***CLOAN***IF  F    1310  7AI     2 DISK                                         CLE011 CLE028
     F***CLOAN   IF  F    1375  7AI     2 DISK                                         CLE028 CLE031
     F***CLOAN** IF  F    1492  7AI     2 DISK                                         CLE031 CLE034
     F***CLOAN** IF  F    1493  7AI     2 DISK                                         CLE034 CAP074
     F***CLOAN** IF  F    1560  7AI     2 DISK                                         CAP074 CGL029
     F*CLOAN***IF**F****1632  7AI     2 DISK                                           CGL029 CLE042
     F***CLOAN** IF  F    1773  7AI     2 DISK                                         CLE042 CER020
     F***CLOAN** IF  F    1782  7AI     2 DISK                                         CER020 CRE073
     F***CLOAN** IF  F    1829  7AI     2 DISK                                         CRE073 CLE134
     FCLOAN   IF  F    1874  7AI     2 DISK                                                   CLE134
0016 FNLAMSDH O   F     320            DISK
0016 F***NLAMSDK*O   F     320            DISK                            S01518
     F***NLAMSDK*O   F     949            DISK                     S01518 CAC001
     F***NLAMSDK*O   F     969            DISK                     CAC001 CLE005
     F***NLAMSDK*O   F    1060            DISK                     CLE005 CEU004
     F***NLAMSDK*O   F    1066            DISK                                         CEU004 CLE028
     F***NLAMSDK O   F    1075            DISK                                         CLE028 CLE031
     F***NLAMSDK O   F    1108            DISK                                         CLE031 CLE034
     F***NLAMSDK O   F    1109            DISK                                         CLE034 CAP075
     F***NLAMSDK O   F    1176            DISK                                         CAP075 CGL029
     F***NLAMSDK O   F    1230            DISK                                         CGL029 CLE036
     F*NLAMSDK*O***F****1278            DISK                                           CLE036 CLE042
     FNLAMSDK O   F    1291            DISK                                                   CLE042
     FNLAMSQD O   F      37            DISK                                                   258399
0016 FNLAMSZ1 O   F     320            DISK
0017 FPDUEHH  O   F      64            DISK
0017 FPDUEDU  O   F      64            DISK
0017 FPDUEZX  O   F      64            DISK
     FLKEY3HH O   E                    DISK                           UC  CLE005
     FLKEY3DP O   E                    DISK                           UC  CLE005
     FLKEY3ZZ O   E                    DISK                           UC  CLE005
     F*E0440P1O** F     132     OF     PRINTER                            S01117
     FLE0440P1O   F     132     OF     PRINTER      KINFDS SPOOL      UC  S01117
     FLE0440P2O   E             22     PRINTER      KINFDS SPOOL2     UC  CLE005
     FLE0440AUO   F     132     OA     PRINTER      KINFDS SPOOLU         S01117
     F*                                                                   S01408
     F/COPY WNCPYSRC,LE0440FFP1                                           S01408
     F*                                                                   S01408
0011 F*                                                                  *
0019 F* ID F  C  H  L    FUNCTION OF INDICATORS
0020 F**01*******     ACTN6 - CONTROL RECORD                              S01117
0020 F* 01            ACTN6L1-CONTROL RECORD                              S01117
0021 F* 02                  - DETAIL
0022 F* 03            LAUPD - DETAIL
0023 F* 04                  - CATCHALL
     F* 05            CLOAN - DETAIL                                      S01260
0024 F*    20         TOTAL AMOUNT NEGATIVE
     F*       21      OUTPUT LKEY3 RUN TOTALS FOR CLE005                  CLE005
     F*       22      OVERFLOW INDICATOR FOR LE0440P2                     CLE005
0032 F*       33      MULTIBRANCHING INDICATOR (MBIN) = Y                 S01117
0025 F*       35-37   MULTIPLE USE
0026 F*       40      FIRST CYCLE
0027 F*       41      OUTPUT TO NLAMS UNCHANGED
0028 F*       42      LOAN AMEND GENERATED PAST DUE RECORD
0029 F*       43      LOAN GENERATED PAST DUE RECORD
0030 F*       44      OUTPUT NEW PAST DUE RECORD TO NLAMS
0031 F*       45      OUTPUT TO PDUE
0032 F*       47      PAST DUE NOTICES REQUIRED
0033 F*       48      OUTPUT HEADINGS ON REPORT AND FILES
0034 F*       49      DETAIL OUTPUT TO REPORT
0035 F*       50      NARRATIVE 'REPAID' - N50 'MATURED'
0036 F*       51      LAUPD OUT OF BALANCE
0037 F********52*     ACTN6 OUT OF BALANCE                                S01117
0037 F*       52      ACTN6L1 OUT OF BALANCE                              S01117
     F*       53      PRINCIPAL PAST DUE PROCESSING                       CLE005
     F*       54      INTEREST PAST DUE PROCESSING                        CLE005
     F*       55      RE-WRITE OF 'MR' AS 'PD' RECORD                     CLE007
     F*       55      OR RE-WRITE 'PD' AS 'RE' RECORD DUE TO GRACE DAYS                      BUG9021
0038 F*       61-68   USED IN PDUESR SUBROUTINE
     F*       69      OUTPUT 0 TO INTA FIELD                              S01392
     F*       70      NO DETAILS TO REPORT FOR ANY BRANCH                 BHF660
     F*       71      DETAILS TO REPORT FOR A BRANCH                      BHF660
     F*       72      LENDING SWIFT ENHANCEMENT S01518 ON                 S01518
     F*       73      PAYMENT TYPE IS '66' OR '67'                        S01518
     F*       81      PARTICIPATION PURCHASED                             S01260
     F*       82      CHAIN FAIL TO S/CLOAN                               S01260
     F*       83      RECOURSE INDICATOR = N ON S/CLOAN                   S01260
0039 F*       90-99   STANDARD SUBROUTINES
0040 F*       U7,U8   STANDARD MIDAS USAGE
     F/COPY WNCPYSRC,LE0440FFP2                                           S01408
     F/EJECT                                                              S01117
0041 E                    PDAT        8  5 0             PAST DUE DATES
0042 E                    PDUE        8  3 0             PAST DUE DAYS
0069 E********************AKY        10  1               A/C KEY                       CLE005 CLE042
0069 E                    AKY        14  1               A/C KEY                              CLE042
     E/COPY ZSRSRC,ZDATE2Z1
     E/COPY ZSRSRC,ZSEDITZ1                                               CLE005
     E                    STAMP   1   1 26                                                    CLE034
      ** Array containing dummy timestamp                                                     CLE034
     E                    CPY@    1   1 80
     E                    CURR      150  3               All CCYS                             CSC042
     E                    CCDP      150  1 0             Dec Places/CCY                       CSC042
     E                    ##BR      999  3               Branch Codes                         CSC042
     E                    ##BN      999 30               Branch Names                         CSC042
     E                    ##BM      999 10               MQ for sent msgs                     CSC042
     E/COPY WNCPYSRC,LE0440E001
     E/EJECT                                                              S01117
0046 I*
0047 I*    LOAN AMENDMENTS TO ACTION TODAY - CONTROL RECORD
0048 I*
0049 I*CTN6***NS* 01   1 CD  23 CC  24 CO                                 S01117
0049 IACTN6L1 NS  01   1 CD  23 CC  24 CO                                 S01117
0050 I                                        1   1 RECI
0051 I**********                              2   70LNRF  L3M3                                CLE148
     I                                        2   7 LNRF  L3M3                                CLE148
0052 I                                        8  120VDAT    M2
0053 I                                       13  150LASN    M1
0054 I                                       16  160MRIN
0055 I                                       17  18 LTYP
0056 I                                       19  20 SUTP
0057 I                                       21  220PTYP
0058 I                                       23  24 AMTP
0059 I                                       25  260PRSQ
0060 I                                       27  27 CTRQ
0061 I                                       28  28 RBVA
0062 I                                       29  29 RBVS
0063 I                                       30  30 INPY
0064 I                                    P  31  330LIVD
0065 I                                       34  34 ACCR
0066 I                                       35  37 CCY
0067 I***********                            73  750BRCD                  S01117
0067 I                                       73  75 BRCA  L4M4            S01117
0068 I**********                             76  810CNUM                                      CSD027
0068 I                                       76  81 CNUM                                      CSD027
0069 I                                       82  82 RBSA
0070 I                                       83  83 IBSA
0071 I                                       84  84 MBSA
0072 I                                       85  85 LNMA
0073 I                                       86  86 LNRV
0074 I                                    P  87  890LTVD
0075 I                                    P  90  920ECDT
0076 I                                    P  96  980PLCD
0077 I                                    P  99 1010PLND
0078 I                                    P 102 1040CTXD
0079 I                                    P 105 1070EXTD
0080 I                                    P 108 1100NIAD
0081 I                                    P 111 1170AITC
0082 I                                      118 118 ICRQ
0083 I                                    P 119 1250TINP
0084 I                                    P 126 1320TIPD
0085 I                                    P 133 1387WTAX
0086 I                                      139 139 NACD
0087 I                                      140 140 BTIN
     I                                    P 321 3270ACDA                  CAC001
     I                                    P 328 3340TCPD                  CAC001
     I                                    P 335 3410TCFP                  CAC001
     I                                    P 342 3440NFCD                  CAC001
     I                                      366 369 CLAS                                      CLE042
0088 I*
0089 I*    CUSTOMER LENDING ACTIONS TODAY FILE - DETAIL
0090 I*
0091 I        NS  02   1 CD
     I       OR   08   1 CR  23 CP  24 CD                                 180044
0092 I                                        1   1 RECI
0093 I**********                              2   70LNRF  L3M3                                CLE148
     I                                        2   7 LNRF  L3M3                                CLE148
0094 I                                        8  120VDAT    M2
0095 I                                       13  150LASN    M1
0096 I                                       16  160MRIN
0097 I                                       17  18 LTYP
0098 I                                       19  20 SUTP
0099 I                                       21  220PTYP
0100 I                                       23  24 AMTP
0101 I                                       25  260PRSQ
0102 I                                       27  280BRTT
0103 I                                    P  29  347RTSP
0104 I                                       35  37 CCY
0105 I                                    P  38  440PRAM
0106 I                                    P  45  510INTA
0107 I                                    P  52  580WTXA
0108 I                                    P  59  650FEAM
0109 I***                                 P  66  720TAMT          20      E11641
0109 I                                    P  66  720TAMT                  E11641
0110 I***********                            73  750BRCD                  S01117
0110 I                                       73  75 BRCA  L4M4            S01117
0111 I**********                             76  810CNUM                                      CSD027
0111 I                                       76  81 CNUM                                      CSD027
0112 I                                       82  820REPT
0113 I                                       83  83 AUTO
0114 I                                       84  84 STAI
0115 I                                       85  860SETP
0116 I**********                             87  98 OSAC                                      CGL029
     I                                       87  98 OSACQQ
0117 I                                       99 108 TSEN
0118 I                                      109 118 FACO
0119 I                                      119 148 SPI1
0120 I                                      149 178 SPI2
0121 I                                      179 208 SPI3
0122 I                                      209 209 LAIN
0123 I                                    P 210 2157BRTE
0124 I                                      216 216 SPIN
0125 I                                      217 2170CALC
0126 I                                      218 218 WTIN
0127 I                                      219 219 LLAG
0128 I                                      220 220 LWOI
0129 I                                      221 2250XAVD
0130 I                                      226 2280XASQ
0131 I**********                            229 2340FCUS                                      CSD027
0131 I                                      229 234 FCUS                                      CSD027
0132 I                                      235 2370FTYP
0133 I                                      238 2390FSEQ
0134 I**********                            240 2450RLON                                      CLE148
     I                                      240 245 RLON                                      CLE148
0135 I                                      246 2470FECD
0136 I                                      248 248 PDNI
0137 I                                      249 249 ACTI
0138 I                                      250 250 CNFY
0139 I                                      251 251 TLXY
0140 I                                      252 252 CBLY
0141 I                                      253 253 INTC
     I                                    P 257 2580LSWCC                                     235579
     I                                    P 259 2600LSWSC                                     235579
     I                                      261 263 OSBR                  S01117
     I                                    P 267 2690LSMD                                      235579
     I                                    P 270 2760REBT                  S01392
0142 I                                    P 311 3130ORED
0143 I                                    P 314 3160LCD
0144 I                                      317 317 CHTP
0145 I                                    P 318 3200TNLU
     I                                      321 3220RSTM                  S01518
     I**********                            323 334 RONS                               S01518 CGL029
     I                                      323 334 RONSQQ                                    CGL029
     I                                      335 342 RIBN                  S01518
     I                                      343 377 RIBA                  S01518
     I**********                            378 3830ROBN                               S01518 CSD027
     I**********                            384 3890ROCN                               S01518 CSD027
     I                                      378 383 ROBN                                      CSD027
     I                                      384 389 ROCN                                      CSD027
     I                                      390 3910PSTM                  S01518
     I**********                            392 403 PONS                               S01518 CGL029
     I                                      392 403 PONSQQ                                    CGL029
     I                                      404 411 PIBN                  S01518
     I                                      412 446 PIBA                  S01518
     I**********                            447 4520POBN                               S01518 CSD027
     I**********                            453 4580POCN                               S01518 CSD027
     I                                      447 452 POBN                                      CSD027
     I                                      453 458 POCN                                      CSD027
     I                                      459 466 RCRN                  S01518
     I                                      467 501 RCRA                  S01518
     I                                      502 509 RVNO                  S01518
     I                                      510 517 AWBN                  S01518
     I                                      518 552 AWBA                  S01518
     I                                      553 560 BENN                  S01518
     I                                      561 595 BENA                  S01518
     I                                      596 630 DTP1                  S01518
     I                                      631 665 DTP2                  S01518
     I                                      666 700 DPT3                  S01518
     I                                      701 735 DPT4                  S01518
     I                                      736 738 DCHG                  S01518
     I                                      739 773 BTB1                  S01518
     I                                      774 808 BTB2                  S01518
     I                                      809 843 BTB3                  S01518
     I                                      844 878 BTB4                  S01518
     I                                      879 913 BTB5                  S01518
     I                                      914 948 BTB6                  S01518
     I                                      949 949 CVMR                  S01518
     I                                    P 950 9557FSRP                  CAC001
     I                                      956 956 FSGN                  CAC001
     I                                      957 960 FPRC                  CAC001
     I                                    P 961 9670COFA                  CAC001
     I                                      968 968 IRCF                  CAC001
     I                                      969 969 FRCF                  CAC001
     I**********                            978 9830ROLN                               235579 CLE148
     I                                      978 983 ROLN                                      CLE148
     I                                      984 9860ROSN                                      235579
     I**********                            990 9950RORC                               235579 CPK028
     I                                      990 995 RORC                                      CPK028
     I                                      996 996 PDGN                  CLE005
     I                                    P100110070PNAM                                      235579
     I                                     10081008 PAST                  CLE005
     I                                     10091009 ASTS                  CLE031
     I                                     10101019 IUSR                  CLE031
     I                                     10201029 AUSR                  CLE031
     I                                     10301039 XUSR                  CLE031
     I                                     10401054 PCRF                  CLE031
     I                                     10551057 PCOB                  CLE031
     I                                     10581058 MTPD                  CLE031
     I                                     10591059 PDDI                  CLE031
     I                                     10601060 PTDI                  CLE031
     I                                     10611063 SCCY                  CLE031
     I                                     10641066 ICCY                  CLE031
     I                                     10671067 ECIN                  CLE031
     I                                     10681068 REPI                  CLE031
     I                                    P106910750CHDU                                      CLE028
     I                                    P107610820INTN                                      CAS005
     I                                    P108310890FSPRAM                                    CAS005
     I                                    P109010968REXR                  CLE031
     I                                     10971097 REXI                  CLE031
     I                                     10981100 PSCY                  CLE031
     I                                    P110111078PEXR                  CLE031
     I                                     11081108 PEXI                  CLE031
     I                                     11091109 STAL                                      CLE034
     I                                     11101129 FRNT                                      CAP075
     I                                     11301149 AFRT                                      CAP075
     I                                     11501150 REPA                                      CAP075
     I                                     11511176 TMST                                      CAP075
     I                                     11771194 OSAC                                      CGL029
     I                                     11951212 RONS                                      CGL029
     I                                     12131230 PONS                                      CGL029
     I************************************ 12311233 FRCY                               CLE036 CLE042
     I************************************P123412400FRAM                               CLE036 CLE042
     I************************************P124112470FINT                               CLE036 CLE042
     I************************************P124812540FTXA                               CLE036 CLE042
     I************************************P125512610FTOT                               CLE036 CLE042
     I************************************P126212680FPEN                               CLE036 CLE042
     I                                     12321234 FRCY                                      CLE042
     I                                    P123512410FRAM                                      CLE042
     I                                    P124212480FINT                                      CLE042
     I                                    P124912550FTXA                                      CLE042
     I                                    P125612620FTOT                                      CLE042
     I                                    P126312690FPEN                                      CLE042
     I                                     12801283 CLAS                                      CLE042
0146 I**   THE FOLLOWING 2 FIELDS WERE ADDED FOR THIS PROGRAM
0147 I                                        1 160 RECA
0148 I                                      161 320 RECB
0148 I***********                           321 949 RECC           S01518 CAC001
     I                                      321 969 RECC                  CAC001
     I**********                            9701060 RECD                               CLE005 CLE028
     I**********                            9701075 RECD                               CLE028 CLE031
     I**********                            9701108 RECD                               CLE031 CLE034
     I**********                            9701109 RECD                               CLE034 CAP075
     I**********                            9701176 RECD                               CAP075 CLE036
     I                                      9701225 RECD                                      CLE036
     I**********                           11771230 RECE                               CGL029 CLE036
     I*************************************12261278 RECE                               CLE036 CLE042
     I                                     12261291 RECE                                      CLE042
0149 I*
0150 I*    ACTIONS TODAY - TRAILER
0151 I*
0152 I        NS       1 CT
0153 I                                        1   1 RECI
0154 I**********                              2   70LNRF                                      CLE148
     I                                        2   7 LNRF                                      CLE148
0155 I                                        8  120VDAT
0156 I                                       13  150LASN
0157 I**   THE FOLLOWING FIELDS WERE CHANGED FOR PROGRAM
0158 I                                    P  17  190NOREA
0159 I                                    P  20  220FLSZA
0160 I                                    P  23  250NLRB
0161 I                                    P  26  280NINS
0162 I                                    P  29  310NDEL
0163 I                                    P  32  340NLRA
0164 I                                    P  35  420VLBF
0165 I                                    P  43  440VLBL
0166 I                                    P  45  520VRIF
0167 I                                    P  53  540VRIL
0168 I                                    P  55  620VRDF
0169 I                                    P  63  640VRDL
0170 I                                    P  65  720VRAF
0171 I                                    P  73  740VRAL
0172 I**   THE FOLLOWING 2 FIELDS WERE CHANGED FOR PROGRAM
0173 I                                    P  75  820VRRFA
0174 I                                    P  83  840VRRLA
0175 I                                    P 314 3160LCD
0176 I                                      317 317 CHTP
0177 I                                    P 318 3200TNLU
0178 I        NS
0179 I**********                              2   70LNRF  L3M3                                CLE148
     I                                        2   7 LNRF  L3M3                                CLE148
0180 I                                        8  120VDAT    M2
0181 I                                       13  150LASN    M1
0182 I*                                                                   S01117
     I                                       73  75 BRCA  L4M4            S01117
0182 I*
0183 I*    CUSTOMER LENDING LOAN AMENDMENTS FILE - DETAIL
0184 I*
0185 ILAUPD   NS  03   1 CD
0186 I                                        1   1 RECI
0187 I**********                              2   70LNRF  L3M3                                CLE148
     I                                        2   7 LNRF  L3M3                                CLE148
     I                                        8  120VDAT    M2
0189 I                                       13  150LASN    M1
0190 I                                       16  160MRIN
0191 I                                       17  18 LTYP
0192 I                                       19  20 SUTP
0193 I                                       21  220PTYP
0194 I                                       23  24 AMTP
0195 I                                       25  260PRSQ
0196 I                                       27  280BRTT
0197 I                                    P  29  347RTSP
0198 I                                       35  37 CCY
0199 I                                    P  38  440PRAM
0200 I                                    P  45  510INTA
0201 I                                    P  52  580WTXA
0202 I                                    P  59  650FEAM
0109 I***                                 P  66  720TAMT          20      E11641
0109 I                                    P  66  720TAMT                  E11641
0204 I***********                            73  750BRCD                  S01117
0204 I                                       73  75 BRCA  L4M4            S01117
0205 I**********                             76  810CNUM                                      CSD027
0205 I                                       76  81 CNUM                                      CSD027
0206 I                                       82  820REPT
0207 I                                       83  83 AUTO
0208 I                                       84  84 STAI
0209 I                                       85  860SETP
0210 I**********                             87  98 OSAC                                      CGL029
     I                                       87  98 OSACQQ                                    CGL029
0211 I                                       99 108 TSEN
0212 I                                      109 118 FACO
0213 I                                      119 148 SPI1
0214 I                                      149 178 SPI2
0215 I                                      179 208 SPI3
0216 I                                      209 209 LAIN
0217 I                                    P 210 2157BRTE
0218 I                                      216 216 SPIN
0219 I                                      217 2170CALC
0220 I                                      218 218 WTIN
0221 I                                      219 219 LLAG
0222 I                                      220 220 LWOI
0223 I                                      221 2250XAVD
0224 I                                      226 2280XASQ
0225 I**********                            229 2340FCUS                                      CSD027
0225 I                                      229 234 FCUS                                      CSD027
0226 I                                      235 2370FTYP
0227 I                                      238 2390FSEQ
0228 I**********                            240 2450RLON                                      CLE148
     I                                      240 245 RLON                                      CLE148
0229 I                                      246 2470FECD
0230 I                                      248 248 PDNI
0231 I                                      249 249 ACTI
0232 I                                      250 250 CNFY
0233 I                                      251 251 TLXY
0234 I                                      252 252 CBLY
0235 I                                      253 253 INTC
0236 I                                      254 254 NACD
     I                                    P 257 2580LSWCC                                     235579
     I                                    P 259 2600LSWSC                                     235579
     I                                      261 263 OSBR                  S01117
     I                                    P 267 2690LSMD                                      235579
0237 I                                    P 311 3130ORED
0238 I                                    P 314 3160LCD
0239 I                                      317 317 CHTP
0240 I                                    P 318 3200TNLU
     I*                                                                   S01518
     I                                      321 3220RSTM                  S01518
     I**********                            323 334 RONS                               S01518 CGL029
     I                                      323 334 RONSQQ                                    CGL029
     I                                      335 342 RIBN                  S01518
     I                                      343 377 RIBA                  S01518
     I**********                            378 3830ROBN                               S01518 CSD027
     I**********                            384 3890ROCN                               S01518 CSD027
     I                                      378 383 ROBN                                      CSD027
     I                                      384 389 ROCN                                      CSD027
     I                                      390 3910PSTM                  S01518
     I**********                            392 403 PONS                               S01518 CGL029
     I                                      392 403 PONSQQ                                    CGL029
     I                                      404 411 PIBN                  S01518
     I                                      412 446 PIBA                  S01518
     I**********                            447 4520POBN                               S01518 CSD027
     I**********                            453 4580POCN                               S01518 CSD027
     I                                      447 452 POBN                                      CSD027
     I                                      453 458 POCN                                      CSD027
     I                                      459 466 RCRN                  S01518
     I                                      467 501 RCRA                  S01518
     I                                      502 509 RVNO                  S01518
     I                                      510 517 AWBN                  S01518
     I                                      518 552 AWBA                  S01518
     I                                      553 560 BENN                  S01518
     I                                      561 595 BENA                  S01518
     I                                      596 630 DTP1                  S01518
     I                                      631 665 DTP2                  S01518
     I                                      666 700 DTP3                  S01518
     I                                      701 735 DTP4                  S01518
     I                                      736 738 DCHG                  S01518
     I                                      739 773 BTB1                  S01518
     I                                      774 808 BTB2                  S01518
     I                                      809 843 BTB3                  S01518
     I                                      844 878 BTB4                  S01518
     I                                      879 913 BTB5                  S01518
     I                                      914 948 BTB6                  S01518
     I                                      949 949 CVMR                  S01518
     I                                    P 950 9557FSRP                  CAC001
     I                                      956 956 FSGN                  CAC001
     I                                      957 960 FPRC                  CAC001
     I                                    P 961 9670COFA                  CAC001
     I                                      968 968 IRCF                  CAC001
     I                                      969 969 FRCF                  CAC001
     I**********                            978 9830ROLN                               235579 CLE148
     I                                      978 983 ROLN                                      CLE148
     I                                      984 9860ROSN                                      235579
     I**********                            990 9950RORC                               235579 CPK028
     I                                      990 995 RORC                                      CPK028
     I                                      996 996 PDGN                  CLE005
     I                                    P100110070PNAM                                      235579
     I                                     10081008 PAST                  CLE005
     I                                     10401054 PCRF                  213200
     I                                     10611063 SCCY                  CEU004
     I                                     10641066 ICCY                  CEU004
     I                                     10671067 ECIN                  CLE031
     I                                     10681068 REPI                  CLE031
     I                                    P106910750CHDU                                      CLE028
     I                                    P107610820INTN                                      CAS005
     I                                    P108310890PRAMN                                     CAS005
     I                                    P109010968REXR                  CLE031
     I                                     10971097 REXI                  CLE031
     I                                     10981100 PSCY                  CLE031
     I                                    P110111078PEXR                  CLE031
     I                                     11081108 PEXI                  CLE031
     I                                     11091109 STAL                                      CLE034
     I                                     11101129 FRNT                                      CAP075
     I                                     11301149 AFRT                                      CAP075
     I                                     11501150 REPA                                      CAP075
     I                                     11511176 TMST                                      CAP075
     I                                     11771194 OSAC                                      CGL029
     I                                     11951212 RONS                                      CGL029
     I                                     12131230 PONS                                      CGL029
     I                                    P123512410FRAM                                      246490
     I                                    P124212480FINT                                      246490
     I                                    P124912550FTXA                                      246490
     I                                    P125612620FTOT                                      246490
     I                                    P127012757BASR                                    BUG27358
     I                                     12801283 CLAS                                      CLE042
0241 I**   THE FOLLOWING FIELDS WERE INSERTED FOR THIS PROGRAM
0242 I                                        1 160 RECA
0243 I                                      161 320 RECB
     I***********                           321 949 RECC           S01518 CAC001
     I                                      321 969 RECC                  CAC001
     I**********                            9701060 RECD                               CLE005 CLE028
     I**********                            9701075 RECD                               CLE028 CLE031
     I*********                             9701108 RECD                               CLE031 CLE034
     I*********                             9701109 RECD                               CLE034 CAP075
     I**********                            9701176 RECD                               CAP075 CLE036
     I                                      9701225 RECD                                      CLE036
     I**********                           11771230 RECE                               CGL029 CLE036
     I*************************************12261278 RECE                               CLE036 CLE042
     I                                     12261291 RECE                                      CLE042
0244 I*
0245 I*    LOAN AMENDMENTS FILE - TRAILER
0246 I*
0247 I        NS       1 CT
0248 I                                        1   1 RECI
0249 I**********                              2   70LNRF                                      CLE148
     I                                        2   7 LNRF                                      CLE148
0250 I                                        8  120VDAT
0251 I                                       13  150LASN
0252 I                                    P  17  190NOREL
0253 I                                    P  23  250NLRB
0254 I                                    P  26  280NINS
0255 I                                    P  29  310NDEL
0256 I                                    P  32  340NLRA
0257 I                                    P  35  420VLBF
0258 I                                    P  43  440VLBL
0259 I                                    P  45  520VRIF
0260 I                                    P  53  540VRIL
0261 I                                    P  55  620VRDF
0262 I                                    P  63  640VRDL
0263 I                                    P  65  720VRAF
0264 I                                    P  73  740VRAL
0265 I                                    P  75  820VRRF
0266 I                                    P  83  840VRRL
0267 I                                    P 314 3160LCD
0268 I                                      317 317 CHTP
0269 I                                    P 318 3200TNLU
0270 I        NS  04
0271 I**********                              2   70LNRF  L3M3                                CLE148
     I                                        2   7 LNRF  L3M3                                CLE148
     I                                        8  120VDAT    M2
0273 I                                       13  150LASN    M1
0274 I*                                                                   S01117
     I                                       73  75 BRCA  L4M4            S01117
0274 I**************                                                      S01194
0275 I*****TABLE*FILE - INSTALLATION CONTROL DATA RECORD 1.               S01194
0276 I**************                                                      S01194
0277 I*TABLE***NS***    2 C0   3 C1  12 C1                                S01194
0278 I*******AND****  13 C0                                               S01194
0279 I**************                          1   1 RECI                  S01194
0280 I**************                         12  130RCDE                  S01194
0281 I**************                         14  66 TITL                  S01194
0282 I***********                            67  67 DATF                  S01194
0283 I***********                            68  700DFBR                  S01194
0284 I**************                         74  74 MODI1                 S01194
0285 I**************                         75  75 MODI2                 S01194
0286 I**************                         76  76 MODI3                 S01194
0287 I***********                         P  77  790RUND                  S01194
0288 I***********                            80  86 RUNA                  S01194
0289 I**************                         87  870SFLG                  S01194
0290 I**************                                                      S01194
0291 I*****TABLE*FILE - INSTALLATION CONTROL DATA RECORD 6.               S01194
0292 I**************                                                      S01194
0293 I********NS****   2 C0   3 C1  12 C5                                 S01194
0294 I*******AND****  13 C0                                               S01194
0295 I**************                          1   1 RECI                  S01194
0296 I**************                          2   30RECT                  S01194
0297 I**************                         12  130RCDE                  S01194
0298 I**************                         14  14 BTIN                  S01194
0299 I**************                         15  160BDAY                  S01194
0300 I**************                      P  17  32 PDUE                  S01194
0301 I**************                      P  33  380LARG                  S01194
0302 I**************                         39  39 BRLF                  S01194
0303 I**************                         40  420ELAC                  S01194
0304 I**************                      P  90  920LCD                   S01194
0305 I**************                         93  93 CHTP                  S01194
0306 I**************                      P  94  960TNLU                  S01194
     I*                                                                   S01260
     I*  CUSTOMER LENDING LOANS FILE  'A' RECORD                          S01260
     I*                                                                   S01260
     ICLOAN   NS  05   1 CD   8 CA                                        S01260
     I       OR        1 CM   8 CA                                        S01260
     I       OR        1 CR   8 CA                                        S01260
     I                                        1   1 RECI                  S01260
     I**********                              2   70LNRF                               S01260 CLE148
     I                                        2   7 LNRF                                      CLE148
     I                                        8   8 RCDT                  S01260
     I                                        9   90MRIN                  S01260
     I                                       10  110PTYP                  S01260
     I**********                             12  170CNUM                               S01260 CSD027
     I                                       12  17 CNUM                                      CSD027
     I                                       18  200BRCD                  S01260
     I                                       21  22 LTYP                  S01260
     I                                       23  24 SUTP                  S01260
     I                                    P  25  270DDAT                  S01260
     I***********                         P  28  300VDAT           S01260 140610
     I                                    P  28  300VDATX                 140610
     I                                    P  31  330MDAT                  S01260
     I                                       34  350LASQ                  S01260
     I**********                             36  410FCUS                               S01260 CSD027
     I                                       36  41 FCUS                                      CSD027
     I                                       42  440FTYP                  S01260
     I                                       45  460FSEQ                  S01260
     I                                       47  49 CCY                   S01260
     I                                    P  50  560CPAM                  S01260
     I/COPY WNCPYSRC,LE0440I003
     I                                       57  57 INTC                  S01260
     I/COPY WNCPYSRC,LE0440I004
     I                                    P  58  637INTR                  S01260
     I                                       64  650BRTT                  S01260
     I                                    P  66  717BRTE                  S01260
     I                                    P  72  777RTSP                  S01260
     I                                    P  78  815MARG                  S01260
     I                                       82  82 SPIN                  S01260
     I                                       83  83 CHIN                  S01260
     I                                    P  84  897WTRT                  S01260
     I                                       90  90 WTIN                  S01260
     I/COPY WNCPYSRC,LE0440I001
     I                                       91  910REPT                  S01260
     I/COPY WNCPYSRC,LE0440I002
     I                                    P  92  980RAMT                  S01260
     I                                    P  99 1010NRPD                  S01260
     I                                      102 102 RFRQ                  S01260
     I                                      103 1040RDYN                  S01260
     I                                      105 107 FCCY                  S01260
     I                                      108 1100LIND                  S01260
     I                                      111 112 CRSK                  S01260
     I                                      113 114 ACOF                  S01260
     I                                      115 115 NACD                  S01260
     I                                      116 116 RELI                  S01260
     I                                      117 117 AUTO                  S01260
     I                                    P 118 1240PSAM                  S01260
     I                                    P 125 1318BCXR                  S01260
     I                                    P 132 1388FCXR                  S01260
     I                                      139 1400SDST                  S01260
     I**********                            141 152 OSDA                               S01260 CGL029
     I                                      141 152 OSDAQQ                                    CGL029
     I                                      153 162 TSTN                  S01260
     I                                      163 1640MDST                  S01260
     I**********                            165 176 OMDA                               S01260 CGL029
     I                                      165 176 OMDAQQ                                    CGL029
     I                                      177 186 TMAN                  S01260
     I                                      187 196 FACO                  S01260
     I                                    P 197 1990RLDT                  S01260
     I                                    P 200 2020NROD                  S01260
     I                                      203 203 RLFQ                  S01260
     I                                      204 2050RLDY                  S01260
     I                                      207 2080NBRA                  S01260
     I                                    P 209 2147NRTS                  S01260
     I                                      215 215 NSIN                  S01260
     I                                      216 2160NCAC                  S01260
     I                                    P 217 2230AWTP                  S01260
     I                                    P 224 2300WTRD                  S01260
     I                                    P 231 2370WTWD                  S01260
     I                                    P 238 2440IWOD                  S01260
     I                                    P 245 2510PWOD                  S01260
     I                                      252 252 BMDI                  S01260
     I                                      253 253 FMDI                  S01260
     I                                    P 254 2600PDIN                  S01260
     I                                      287 287 BTIN                  S01260
     I                                      288 2890BLDY                  S01260
     I**********                            290 2950OLNO                               S01260 CSD027
     I                                      290 295 OLNO                                      CSD027
     I                                      296 296 RCSI                  S01260
     I                                      297 2970ICBS                  S01260
     I                                      298 298 IPFR                  S01260
     I                                    P 299 3050TOTI                  S01260
     I                                    P 306 3080NIDT                  S01260
     I                                    P 309 3110IBDT                  S01260
     I                                    P 312 3140SLID                  S01260
     I                                    P 315 3210AIPD                  S01260
     I                                    P 322 3240DLRC                  S01260
     I                                    P 325 3270IACD                  S01260
     I                                    P 328 3340AITC                  S01260
     I                                    P 335 3410TFEP                  S01260
     I                                    P 342 3480AIAP                  S01260
     I                                    P 349 3550IPRD                  S01260
     I                                    P 356 3620IPRM                  S01260
     I                                    P 363 3690ICTD                  S01260
     I                                    P 370 3760AIMN                  S01260
     I                                    P 377 3790RBDT                  S01260
     I                                    P 380 3810NOPS                  S01260
     I                                      384 3850IFDY                  S01260
     I                                      386 386 LONI                  S01260
     I                                      387 387 CNFI                  S01260
     I                                      388 388 ACEI                  S01260
     I                                      389 389 TLXI                  S01260
     I                                      390 390 CBLI                  S01260
     I                                    P 391 3930ORED                  S01260
     I                                    P 394 3960LCD                   S01260
     I                                      397 397 CHTP                  S01260
     I                                    P 398 4000TNLU                  S01260
     I*
     I**  BOOK CODE ADDITION FOR EXPOSURE MANAGEMENT                      S01220
     I                                      435 436 BOKC                  S01220
     I                                     120212030GDPR                  CLE005
     I                                     120412050GDIN                  CLE005
     I                                     13491349 ADIF                                      CLE028
     I                                     13501350 ADCF                                      CLE028
     I                                    P135113570CHGA                                      CLE028
     I                                     13581358 ICIF                                      CLE028
     I                                    P135913650FLTI                                      CLE028
     I                                    P136613680FRPD                                      CLE028
     I                                    P136913750ACCH                                      CLE028
      *                                                                   CLE031
     I                                    P146714730FPAM                  CLE031
     I                                    P147414808REXR                  CLE031
     I                                     14811481 REXI                  CLE031
     I                                     14821484 PSCY                  CLE031
     I                                    P148514918PEXR                  CLE031
     I                                     14921492 PEXI                  CLE031
     I**********                           13751375 STAL                               CLE034 219424
     I**********                           13751375 STALK                              219424 CLE034
     I                                     14931493 STALK                                     CLE034
     I                                     14941513 FRNT                                      CAP074
     I                                     15141533 AFRT                                      CAP074
     I                                     15341534 REPA                                      CAP074
     I                                     15351560 TMST                                      CAP074
     I                                     15611578 OSDA                                      CGL029
     I                                     15791596 OMDA                                      CGL029
     I                                     15971614 RONS                                      CGL029
     I                                     16151632 PONS                                      CGL029
     I                                     17621765 CLAS                                      CLE042
     I                                     17801782 LOIC                                      CER020
     I                                     17831788 CNSP                                      CRE073
     I                                     17891789 CNSG                                      CRE073
     I                                     17901796 RDMT                                      CRE073
     I                                     17971800 RDFD                                      CRE073
     I                                     18011806 NNSP                                      CRE073
     I                                     18071807 NNSG                                      CRE073
     I                                     18081814 NDMT                                      CRE073
      *                                                                                       CLE134
     I                                     18301830 FAMU                                      CLE134
     I                                     18311831 FPNR                                      CLE134
      *                                                                                       CLE134
     I                                    P183218340RIDT                                      CLE134
     I                                    P183518360RIDC                                      CLE134
     I                                     183718370RCAT                                      CLE134
     I                                    P183818390RCAC                                      CLE134
     I                                    P184018420RCSD                                      CLE134
     I                                    P184318440RCDY                                      CLE134
     I                                    P184518460RCCY                                      CLE134
      *                                                                                       CLE134
     I                                    P184718490BIDT                                      CLE134
     I                                    P185018510BIDC                                      CLE134
     I                                     185218520BCAT                                      CLE134
     I                                    P185318540BCAC                                      CLE134
     I                                    P185518570BCSD                                      CLE134
     I                                    P185818590BCDY                                      CLE134
     I                                    P186018610BICC                                      CLE134
      *                                                                                       CLE134
     I                                     18621864 XRFI                                      CLE134
     I                                     186518740XRFN                                      CLE134
     I**                                                                  S01260
     I        NS                                                          S01260
     I/COPY WNCPYSRC,LE0440I006
     I*                                                                   S01194
     ISDBANK    E DSSDBANKPD                                              S01194
     I**  EXTERNAL DS FOR BANK DETAILS                                    S01194
     I              BJURPT                          TITL                  S01194
     I*                                                                   S01194
     ISDBRCH    E DSSDBRCHPD                                              S01117
     I**  EXTERNAL DS FOR BRANCH CODE DETAILS                             S01117
     I              A8BRNM                          BRNM                  S01117
     I                                        1 250 ##T01                                     CSC042
     I                                      251 500 ##T02                                     CSC042
     I*                                                                   S01194
     ISDCLND    E DSSDCLNDPD                                              S01194
     I**  EXTERNAL DS FOR CUSTOMER LENDING DETAILS                        S01194
     I*                                                                   CLE005
     ISDCURR    E DSSDCURRPD                                              CLE005
     I** Currency details                                                 CLE005
     I*
     ISCSARD    E DSSCSARDPD                                              S01518
     I** SAR Details                                                      S01518
     I              LCD                             LCDX                  S01518
     I*                                                                   S01518
     I/COPY WNCPYSRC,LE0440I005
     IDSFDY     E DSDSFDY                                                 S01194
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01194
     I*                                                                   S01194
     IDSSDY     E DSDSSDY                                                 S01194
     I* SECOND DS FOR ACCESS PROGRAMS, LONG DATA STRUCTURE                S01194
     I*                                                                   S01194
     I**                                                                  S01117
0307 I**   LOCAL DATA AREA FOR DATABASE ERROR IDENTIFICATION
0308 ILDA        UDS                            256
0309 I***********                           134 138 DBFILE                S01117
0310 I***********                           139 167 DBKEY                 S01117
0311 I***********                           168 175 DBPGM                 S01117
0312 I***********                           176 177 DBASE                 S01117
0309 I                                      134 141 DBFILE                S01117
0310 I                                      142 170 DBKEY                 S01117
0311 I                                      171 180 DBPGM                 S01117
0312 I                                      181 1830DBASE                 S01117
     I**                                                                  S01117
     I**   FILE INFORMATION DATA STRUCTURE                                S01117
     I**                                                                  S01117
     ISPOOL       DS                                                      S01117
     I                                       83  92 SFILE                 S01117
     I                                    B 123 1240SFNUM                 S01117
     I**                                                                  CLE005
     I**   FILE INFORMATION DATA STRUCTURE - P2                           CLE005
     I**                                                                  CLE005
     ISPOOL2      DS                                                      CLE005
     I                                       83  92 SFILE2                CLE005
     I                                    B 123 1240SFNUM2                CLE005
     I**                                                                  S01117
     I**   FILE INFORMATION DATA STRUCTURE                                S01117
     I**                                                                  S01117
     ISPOOLU      DS                                                      S01117
     I                                       83  92 SFILEU                S01117
     I                                    B 123 1240SFNUMU                S01117
     I**                                                                  S01117
     IRUNDT       DS                                                      S01117
     I**  DATA AREA RUNDAT                                                S01117
     I                                        1   7 RUNA                  S01117
     I                                    P   8  100RUND                  S01117
     I                                       11  11 SSF                   S01117
     I                                       12  12 DATF                  S01117
     I                                       13  13 MBIN                  S01117
      *                                                                                      242385A
      ** Datastructure to hold input parameter for AOSVALR0.                                 242385A
     I            DS                                                                         242385A
     I                                        1  20 WPARM                                    242385A
     I                                        1   5 WPARM1                                   242385A
     I                                        6  10 WPARM2                                   242385A
     I                                       11  15 WPARM3                                   242385A
     I                                       16  20 WPARM4                                   242385A
      *                                                                                      242385A
     I**                                                                  S01117
     ISRECC       DS                            649                       CLE005
     I*                                                                   S01408
     ILEALLO    E DSLEALLO                                                213200
     I*                                                                   213200
     I/COPY WNCPYSRC,LE0440IIP1                                           S01408
     I*                                                                   S01408
     I/COPY ZSRSRC,ZSEDITZ2                                               CLE005
     I/EJECT                                                              S01117
     C**********           MOVEACPY@      BIS@   80                                           CSC042
      *                                                                                       CLE134
     C           *ENTRY    PLIST                                                              CLE134
     C                     PARM           WPNAM  10                                           CLE134
0313 C**
0314 C**   FIRST CYCLE CALCS
0315 C**
0316 C   40                GOTO ENDFC
0317 C***********          SETON                     4048                 S01194
0317 C                     SETON                     40                   S01194
     C                     MOVEACPY@      BIS@   80                                           CSC042
     C                     Z-ADD0         ##BNDX  40                                          CSC042
     C           *LIKE     DEFN ##BNDX    B                                                   CSC042
     C           *LIKE     DEFN ##BNDX    ##BSV                                               CSC042
      *                                                                                       CSC042
     C/COPY WNCPYSRC,LE0440CP15                                           S01408
     C**                                                                  213200
     C** DEFINE LEALLO FOR ALLOCATING PCRF VALUES                         213200
     C********** *NAMVAR   DEFN           LEALLO                                       213200 CLE148
     C**                                                                  S01117
     C**   IN THE DATAAREA RUNDAT                                         S01117
     C**                                                                  S01117
     C           *NAMVAR   DEFN RUNDAT    RUNDT                           S01117
     C                     IN   RUNDT                                     S01117
     C*    DEFINE LDA                                                     S01117
     C           *NAMVAR   DEFN           LDA                             S01117
     C           *LOCK     IN   LDA                                       S01117
     C**                                                                  S01117
     C*     IF MBIN=Y, SET ON *IN33                                       S01117
     C**                                                                  S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C                     SETON                     33                   S01117
     C                     END                                            S01117
0318 C**
0319 C                     EXSR ZSYSTM
0320 C***99*********       SETON                     U7U8LR               S01194
0321 C***99*********       Z-ADD1         DBASE            DBASE 1        S01194
0322 C   99                GOTO END
0323 C**
0324 C**   ACCESS ICDR6 FOR PAST DUE PERIODS
0325 C**
0326 C**************       MOVE '50'      ZTABKY                          S01194
0327 C***********ZTABKY    CHAINTABLE                99                   S01194
     C**                                                                  S01194
     C** ACCESS CUSTOMER LENDING DATA                                     S01194
     C**                                                                  S01194
     C                     CALL 'AOCLNDR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C********** SDCLND    PARM SDCLND    DSFDY                                        S01194 CLE134
     C           SDCLND    PARM SDCLND    DSSDY                                               CLE134
0328 C**N99******RECI      COMP 'D'                  9999                 S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     SETON                     99                   S01194
     C                     MOVEL'SDCLNDPD'DBFILE                          S01194
     C                     END                                            S01194
     C   99                MOVEL@OPTN     DBKEY            ***************S01194
0329 C   99                Z-ADD2         DBASE            DBASE 2
0330 C   99                SETON                     U7U8LR
0331 C   99                GOTO END
     C*                                                                   S01518
     C**  Access SAR details file to see if S01518 is installed           S01518
     C*                                                                   S01518
     C                     CALL 'AOSARDR0'                                S01518
     C                     PARM '       ' @RTCD   7                       S01518
     C                     PARM '*VERIFY' @OPTN   7                       S01518
     C                     PARM 'S01518'  @SARD   6                       S01518
     C           SCSARD    PARM SCSARD    DSFDY                           S01518
     C*                                                                   S01518
     C           @RTCD     IFEQ *BLANKS                                   S01518
     C                     MOVE '1'       *IN72                           S01518
     C                     ELSE                                           S01518
     C                     MOVE '0'       *IN72                           S01518
     C           @RTCD     IFNE '*NRF   '                                 S01518
     C                     MOVEL'SCSARDPD'DBFILE           ************   S01518
     C                     MOVEL'*VERIFY' DBKEY            * DBERR 04 *   S01518
     C                     Z-ADD4         DBASE            ************   S01518
     C                     SETON                     U7U8LR               S01518
     C                     GOTO END                                       S01518
     C                     END                                            S01518
     C                     END                                            S01518
      *                                                                   CLE005
      **  Access SAR details file to see if CLE005 is installed           CLE005
      *                                                                   CLE005
     C                     CALL 'AOSARDR0'                                CLE005
     C                     PARM '       ' @RTCD                           CLE005
     C                     PARM '*VERIFY' @OPTN                           CLE005
     C                     PARM 'CLE005'  @SARD                           CLE005
     C           SCSARD    PARM SCSARD    DSFDY                           CLE005
      *                                                                   CLE005
     C           @RTCD     IFEQ *BLANKS                                   CLE005
     C                     MOVE 'Y'       CLE005  1                       CLE005
     C                     MOVE '1'       *IN21                           CLE005
     C                     OPEN LKEY3HH                                   CLE005
     C                     OPEN LKEY3DP                                   CLE005
     C                     OPEN LKEY3ZZ                                   CLE005
     C           *LIKE     DEFN RECA      SRECA                           CLE005
     C           *LIKE     DEFN RECB      SRECB                           CLE005
     C           *LIKE     DEFN RECD      SRECD                           CLE005
     C           *LIKE     DEFN RECE      SRECE                                               CGL029
     C                     Z-ADD2         NORE                            CLE005
     C                     ELSE                                           CLE005
     C                     MOVE 'N'       CLE005                          CLE005
     C           @RTCD     IFNE '*NRF   '                                 CLE005
     C                     MOVEL'SCSARDPD'DBFILE           ************   CLE005
     C                     MOVEL'CLE005 ' DBKEY            * DBERR 05 *   CLE005
     C                     Z-ADD5         DBASE            ************   CLE005
     C                     SETON                     U7U8LR               CLE005
     C                     GOTO END                                       CLE005
     C                     ENDIF                                          CLE005
     C                     ENDIF                                          CLE005
      *                                                                   CLE007
      **  Access SAR details file to see if CLE007 is installed           CLE007
      *                                                                   CLE007
     C                     CALL 'AOSARDR0'                                CLE007
     C                     PARM '       ' @RTCD                           CLE007
     C                     PARM '*VERIFY' @OPTN                           CLE007
     C                     PARM 'CLE007'  @SARD                           CLE007
     C           SCSARD    PARM SCSARD    DSFDY                           CLE007
      *                                                                   CLE007
     C           @RTCD     IFEQ *BLANKS                                   CLE007
     C                     MOVE 'Y'       CLE007  1                       CLE007
     C                     ELSE                                           CLE007
     C                     MOVE 'N'       CLE007                          CLE007
     C           @RTCD     IFNE '*NRF   '                                 CLE007
     C                     MOVEL'SCSARDPD'DBFILE           ************   CLE007
     C                     MOVEL'CLE007 ' DBKEY            * DBERR 06 *   CLE007
     C                     Z-ADD6         DBASE            ************   CLE007
     C                     SETON                     U7U8LR               CLE007
     C                     GOTO END                                       CLE007
     C                     ENDIF                                          CLE007
     C                     ENDIF                                          CLE007
      *                                                                                       CLE028
      ** Access SAR details file to see if CLE028 is installed                                CLE028
      *                                                                                       CLE028
     C                     MOVE 'N'       CLE028  1                                           CLE028
      *                                                                                       CLE028
     C                     CALL 'AOSARDR0'                                                    CLE028
      *                                                                                       CLE028
     C                     PARM *BLANKS   P@RTCD                                              CLE028
     C                     PARM '*VERIFY' P@OPTN                                              CLE028
     C                     PARM 'CLE028'  P@SARD                                              CLE028
     C           SCSARD    PARM SCSARD    DSFDY                                               CLE028
      *                                                                                       CLE028
     C           P@RTCD    IFEQ *BLANKS                                                       CLE028
     C                     MOVE 'Y'       CLE028                                              CLE028
     C                     ELSE                                                               CLE028
     C           P@RTCD    IFNE '*NRF   '                                                     CLE028
     C                     MOVEL'SCSARDPD'DBFILE                                              CLE028
     C                     MOVEL'*VERIFY' DBKEY                                               CLE028
     C                     Z-ADD9         DBASE                                               CLE028
     C                     MOVE *ON       *INU7                                               CLE028
     C                     MOVE *ON       *INU8                                               CLE028
     C                     MOVE *ON       *INLR                                               CLE028
     C                     GOTO END                                                           CLE028
     C                     ENDIF                                                              CLE028
     C                     ENDIF                                                              CLE028
      *                                                                   CEU004
      ** Access SAR details file to see if CEU004 is installed            CEU004
      *                                                                   CEU004
     C                     MOVE 'N'       CEU004  1        Set SAR Flag   CEU004
      *                                                                   CEU004
     C                     CALL 'AOSARDR0'                 Rtv SAR Dtls   CEU004
      *                                                    Input:         CEU004
     C                     PARM *BLANKS   P@RTCD  7        -Return Code   CEU004
     C                     PARM '*VERIFY' P@OPTN  7        -Option        CEU004
     C                     PARM 'CEU004'  P@SARD  6        -SAR No        CEU004
      *                                                    Output:        CEU004
     C           SCSARD    PARM SCSARD    DSFDY            -Format        CEU004
      *                                                                   CEU004
     C           P@RTCD    IFEQ *BLANKS                    If Found       CEU004
     C                     MOVE 'Y'       CEU004            Set SAR Flag  CEU004
      *                                                                   CEU004
     C                     ELSE                            Else           CEU004
     C           P@RTCD    IFNE '*NRF   '                   If # NoRecFnd CEU004
     C                     MOVEL'SCSARDPD'DBFILE             Set File     CEU004
     C                     MOVEL'*VERIFY' DBKEY              Set Key      CEU004
     C                     Z-ADD7         DBASE              Set DBase RefCEU004
     C                     SETON                     U7U8LR  Set Ind      CEU004
     C                     GOTO END                          Bypass       CEU004
     C                     ENDIF                            End If        CEU004
     C                     ENDIF                           End If         CEU004
      *                                                                                       CLE034
      ** Check if CLE034 is installed.                                                        CLE034
      *                                                                                       CLE034
     C                     CALL 'AOSARDR0'                                                    CLE034
     C                     PARM *BLANKS   P@RTCD                                              CLE034
     C                     PARM '*VERIFY' P@OPTN                                              CLE034
     C                     PARM 'CLE034'  P@SARD                                              CLE034
      *                                                                                       CLE034
     C           P@RTCD    IFEQ *BLANKS                                                       CLE034
     C                     MOVE 'Y'       CLE034  1                                           CLE034
     C                     ELSE                                                               CLE034
     C                     MOVE 'N'       CLE034                                              CLE034
     C           P@RTCD    IFNE '*NRF    '                                                    CLE034
     C                     MOVEL'SCSARDPD'DBFILE                                              CLE034
     C                     Z-ADD10        DBASE                                               CLE034
     C                     MOVEL'CLE034'  DBKEY                                               CLE034
     C                     MOVE *ON       *INU7                                               CLE034
     C                     MOVE *ON       *INU8                                               CLE034
     C                     MOVE *ON       *INLR                                               CLE034
     C                     GOTO END                                                           CLE034
     C                     ENDIF                                                              CLE034
     C                     ENDIF                                                              CLE034
      *                                                                                       CLE106
      ** Check if CLE106 is installed.                                                        CLE106
      *                                                                                       CLE106
     C                     CALL 'AOSARDR0'                                                    CLE106
     C                     PARM *BLANKS   P@RTCD                                              CLE106
     C                     PARM '*VERIFY' P@OPTN                                              CLE106
     C                     PARM 'CLE106'  P@SARD                                              CLE106
      *                                                                                       CLE106
     C           P@RTCD    IFEQ *BLANKS                                                       CLE106
     C                     MOVE 'Y'       CLE106  1                                           CLE106
     C                     ELSE                                                               CLE106
     C                     MOVE 'N'       CLE106                                              CLE106
     C           P@RTCD    IFNE '*NRF    '                                                    CLE106
     C                     MOVEL'SCSARDPD'DBFILE                                              CLE106
     C                     Z-ADD11        DBASE                                               CLE106
     C                     MOVEL'CLE106'  DBKEY                                               CLE106
     C                     MOVE *ON       *INU7                                               CLE106
     C                     MOVE *ON       *INU8                                               CLE106
     C                     MOVE *ON       *INLR                                               CLE106
     C                     GOTO END                                                           CLE106
     C                     ENDIF                                                              CLE106
     C                     ENDIF                                                              CLE106
      *                                                                                     AR700107
      ** Access Switchable SAR details                                                      AR700107
      *                                                                                     AR700107
     C                     CALL 'AOSARDR0'                                                  AR700107
     C                     PARM *BLANK    P@RTCD                                            AR700107
     C                     PARM '*VERIFY' P@OPTN                                            AR700107
     C                     PARM 'CLE134'  P@SARD                                            AR700107
     C           SCSARD    PARM SCSARD    DSFDY                                             AR700107
      *                                                                                     AR700107
      ** Feature found if return code is blank                                              AR700107
      *                                                                                     AR700107
     C           PRTCD     IFEQ *BLANK                                                      AR700107
     C                     MOVE 'Y'       CLE134  1                                         AR700107
     C                     ELSE                                                             AR700107
     C                     MOVE 'N'       CLE134                                            AR700107
     C                     ENDIF                                                            AR700107
      *                                                                                     AR786878
     C                     MOVE 'N'       NEWCOB  1                                         AR786878
     C           CLE134    IFEQ 'Y'                                                         AR786878
     C           WPNAM     ANDEQ'NEWLECOB'                                                  AR786878
     C                     MOVE 'Y'       NEWCOB                                            AR786878
     C                     ENDIF                                                            AR786878
      *                                                                                       CLE034
      *                                                                   CEU004
      *                                                                   CEU004
     C/COPY WNCPYSRC,LE0440C009
0332 C**
0333 C**   LOAD ARRAY OF PAST DUE DATES
0334 C**
0335 C                     Z-ADD0         X       10
     C                     Z-ADDBPPND1    PDUE,1                          S01194
     C                     Z-ADDBPPND2    PDUE,2                          S01194
     C                     Z-ADDBPPND3    PDUE,3                          S01194
     C                     Z-ADDBPPND4    PDUE,4                          S01194
     C                     Z-ADDBPPND5    PDUE,5                          S01194
     C                     Z-ADDBPPND6    PDUE,6                          S01194
     C                     Z-ADDBPPND7    PDUE,7                          S01194
     C                     Z-ADDBPPND8    PDUE,8                          S01194
0336 C           PLOP      TAG                             ** PLOP TAG ***
0337 C           X         ADD  1         X
0338 C           X         COMP 9                        35
0339 C  N35      PDUE,X    COMP 0                        35
0340 C   35                GOTO PLOPE
0341 C**
0342 C           RUND      SUB  PDUE,X    PDAT,X
0343 C                     GOTO PLOP
0344 C           PLOPE     TAG                             ** PLOPE TAG **
0345 C**
     C/COPY WNCPYSRC,LE0440C005
0346 C**   SET UP HASH FIELDS
0347 C**
0348 C                     Z-ADD2         ANORE   50
0349 C                     Z-ADD1         LNORE   50
0350 C                     Z-ADD0         LHASHF 150
0351 C                     Z-ADD0         LHASHL  30
0352 C**
     C           *LIKE     DEFN Q         ##INDX                                              CSC042
     C                     Z-ADD0         ##INDX                                              CSC042
      *                                                                                       CSC042
0353 C                     Z-ADD2         NNORE   50
0354 C                     Z-ADD0         NHASHF 150
0355 C                     Z-ADD0         NHASHL  30
0356 C                     Z-ADD2         PNORE   50
0357 C**
0358 C                     Z-ADD0         ZERO11 110
0359 C                     Z-ADD0         ZERO13 130
0360 C                     Z-ADD0         ZERO5   50
0361 C                     Z-ADD0         ZERO15 150
0362 C                     Z-ADD0         ZERO3   30
0363 C***********          Z-ADD0         DROP    50                      S01117
     C**   OUTPUT HEADERS HERE AS AN EXCEPTION IN ORDER TO PREVENT        S01117
     C*         MULTIPLE HEADERS IN MB ENVIRONMENT                        S01117
     C                     EXCPTHEADER                                    S01117
0364 C                     GOTO END
0365 C           ENDFC     TAG                             ** ENDFC TAG **
0366 C**
0367 C**   MAIN PROCESSING
0368 C**
     C                     SETOF                     8183                 S01260
0369 C                     SETOF                     414250
0370 C                     SETOF                     434445
0371 C                     SETOF                     474849
     C                     SETOF                     69                   S01392
0372 C                     BITOF'01234567'PDBI    1
     C                     MOVE 'N'       WNEWRC  1                       157591
0373 C   L3                Z-ADD0         PDPRIN 130
     C/COPY WNCPYSRC,LE0440C024
      *                                                                   CLE005
      ** Access CLOANCL for some fields on change of loan reference       CLE005
      *                                                                   CLE005
     C           *INL3     IFEQ '1'                                       CLE005
     C           CLE005    ANDEQ'Y'                                       CLE005
      *                                                                   CLE005
      ** Save main file's fields to avoid being overwritten               CLE005
      *                                                                   CLE005
     C                     MOVE RECA      SRECA                           CLE005
     C                     MOVE RECB      SRECB                           CLE005
     C                     MOVE RECC      SRECC                           CLE005
     C                     MOVE RECD      SRECD                           CLE005
     C                     MOVE RECE      SRECE                                               CGL029
      *                                                                   CLE005
     C                     MOVELLNRF      CLNKEY  7                       CLE005
     C                     MOVE 'A'       CLNKEY                          CLE005
     C                     SETOF                     0582                 CLE005
     C           CLNKEY    CHAINCLOAN                82                   CLE005
     C           *IN05     IFEQ '0'                                       CLE005
     C           *IN82     OREQ '1'                                       CLE005
     C                     SETON                     U7U8LR***************CLE005
     C                     Z-ADD7         DBASE            *  DBASE 07   *CLE005
     C                     MOVE 'CLOAN'   DBFILE           ***************CLE005
     C                     MOVELCLNKEY    DBKEY                           CLE005
     C                     GOTO END                                       CLE005
     C                     ELSE                                           CLE005
      *                                                                   CLE005
      ** Save the following fields for later use                          CLE005
      *                                                                   CLE005
     C                     Z-ADDGDPR      WLGDPR  20                      CLE005
     C                     Z-ADDMDAT      WLMDAT  50                      CLE005
     C                     Z-ADDINTR      WLINTR 117                      CLE005
     C                     MOVE FACO      WLFACO 10                       CLE005
     C                     Z-ADDORED      WLORED  50                      CLE005
     C                     Z-ADDGDIN      WLGDIN  20                      CLE005
     C                     Z-ADDBRTT      WLBRTT  20                      CLE005
     C                     Z-ADDCPAM      WLCPAM 130                      CLE005
     C                     MOVE PRFC      WLPRFC  4                       CLE005
     C**********           Z-ADDOLNO      WLOLNO  60                                   CLE005 CSD027
     C**********           MOVE *BLANKS   WLOLNO  6                                  CSD027 BUG13515
     C                     MOVE OLNO      WLOLNO  6                                         BUG13515
     C***********          Z-ADDVDAT      WLVDAT  50               CLE005 140610
     C                     Z-ADDVDATX     WLVDAT  50                      140610
     C                     Z-ADDBRTE      WLBRTE 117                      CLE005
     C                     Z-ADDICBS      WLICBS  10                      CLE005
     C                     MOVE BOKC      WLBOKC  2                       CLE005
     C                     MOVE PTFR      WLPTFR  4                       CLE005
     C                     Z-ADDSLID      WLSLID  50                      CLE005
     C                     Z-ADDRTSP      WLRTSP 117                      CLE005
     C                     MOVE ACOF      WLACOF  2                       CLE005
     C/COPY WNCPYSRC,LE0440C025
     C                     ENDIF                                          CLE005
      *                                                                   CLE005
     C                     MOVE SRECA     RECA                            CLE005
     C                     MOVE SRECB     RECB                            CLE005
     C                     MOVE SRECC     RECC                            CLE005
     C                     MOVE SRECD     RECD                            CLE005
     C                     MOVE SRECE     RECE                                                CGL029
     C                     ENDIF                                          CLE005
     C/COPY WNCPYSRC,LE0440C017
0374 C**
0375 C**   MAINTAIN HASH TOTALS OF RECORDS READ IN
0376 C**
0377 C   01
0378 COR 02      ANORE     ADD  1         ANORE
0379 C   03
0380 COR 04      LNORE     ADD  1         LNORE
0381 C   03                Z-ADDLHASHF    ZZTOTI
0382 C   03                Z-ADDLHASHL    ZZTOTD
0383 C***03                MOVE TAMT      ZZAMT                           E11641
0383 C   03                MOVE TAMT      ZZAMT        20                 E11641
0384 C   03 20             Z-SUBZZAMT     ZZAMT
0385 C   03                EXSR GLZADD
0386 C   03                Z-ADDZZTOTI    LHASHF
0387 C   03                Z-ADDZZTOTD    LHASHL
     C/COPY WNCPYSRC,LE0440CP11                                           S01408
0388 C**
0389 C**   EXECUTE SUBROUTINE ACCORDING TO INPUT
0390 C**
0391 C                     MOVE PCRF      PCRFA  15                                          BUG9021
0391 C   02NMR             EXSR ACUNM
0392 C***02*MR**           EXSR MATCH                                     180044
      *                                                                   180044
     C           *IN02     IFEQ '1'                                       180044
     C           *INMR     ANDEQ'1'                                       180044
     C           *IN08     OREQ '1'                                       180044
     C                     EXSR MATCH                                     180044
     C                     ENDIF                                          180044
      *                                                                   180044
0393 C   03NMR             EXSR LAUNM
     C**                                                                  S01117
     C**   MULTIBRANCH MAIN PROCESSING                                    S01117
     C**                                                                  S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C           *INL4     IFEQ '1'                                       S01117
     C                     CLOSELE0440P1                                  S01117
     C**                                                                  S01117
     C*    IF MBIN=YES AND A LEVEL BREAK,                                 S01117
     C*    OPEN LE0440P1                                                  S01117
     C**                                                                  S01117
     C***********          SETON                       48           S01117BHF660
     C                     SETON                     4871                 BHF660
     C                     MOVE 'Y'       P1OP    1                       S01117
     C                     OPEN LE0440P1                                  S01117
     C                     Z-ADD0         PAGE                            S01117
     C                     Z-ADD0         PAGE1                           S01117
0363 C                     Z-ADD0         DROP    50                      S01117
     C**                                                                  S01117
     C*    ENSURE REPORT SPOOL FILE RECORDED BY RCF                       S01117
     C**                                                                  S01117
     C                     Z-ADDSFNUM     ZSNUM   60
     C                     OUT  LDA                                       S01117
     C**                                                                  S01117
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           SEQ                             S01117
     C                     PARM BRCA      SENTY   3                       S01117
     C                     PARM           SFILE                           S01117
     C                     PARM           ZSNUM                           S01117
     C                     PARM           ZSERR   1                       S01117
     C           *LOCK     IN   LDA                                       S01117
     C**                                                                  S01117
      **  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM       S01117
     C           ZSERR     IFEQ 'Y'                                       S01117
     C                     SETON                     U7U8LR               S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
      *                                                                   CLE005
      ** Ensure P2 report spool file is recorded by RCF                   CLE005
      ** If error exists, return to calling program                       CLE005
      *                                                                   CLE005
     C           CLE005    IFEQ 'Y'                                       CLE005
     C           P2OP      IFEQ 'Y'                                       CLE005
     C           RNORE     IFEQ *ZEROS                                    CLE005
     C                     WRITENODTLP2                                   CLE005
     C                     ELSE                                           CLE005
     C                     WRITETRAILP2                                   CLE005
     C                     ENDIF                                          CLE005
     C                     ENDIF                                          CLE005
      *                                                                   CLE005
     C                     CLOSELE0440P2                                  CLE005
     C                     OPEN LE0440P2                                  CLE005
     C                     MOVE 'Y'       P2OP    1                       CLE005
     C                     Z-ADD*ZEROS    RNORE                           CLE005
      *                                                                   CLE005
     C                     Z-ADDSFNUM2    ZSNUM                           CLE005
     C                     OUT  LDA                                       CLE005
     C                     CALL 'ZSFILE'                                  CLE005
     C                     PARM           SEQ                             CLE005
     C                     PARM BRCA      SENTY                           CLE005
     C                     PARM           SFILE2                          CLE005
     C                     PARM           ZSNUM                           CLE005
     C                     PARM           ZSERR                           CLE005
     C           *LOCK     IN   LDA                                       CLE005
      *                                                                   CLE005
     C           ZSERR     IFEQ 'Y'                                       CLE005
     C                     SETON                     U7U8LR               CLE005
     C                     RETRN                                          CLE005
     C                     ENDIF                                          CLE005
     C                     ENDIF                                          CLE005
     C**                                                                  S01117
     C*    TO GET BRANCH NAME(IN BRNM) :                                  S01117
     C**                                                                  S01117
     C                     MOVELBRCA      ##KB                                                CSC042
     C                     EXSR ##CHKB                                                        CSC042
      * If branch is in the array then use the details                                        CSC042
     C           ##FIC     IFEQ 'Y'                        *** B10                            CSC042
     C                     EXSR ##SETB                                                        CSC042
     C                     ELSE                            *** X10                            CSC042
     C**********           CALL 'AOBRCHR0'                                             S01117 CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       S01117
     C                     PARM '*KEY   ' @OPTN   7                       S01117
     C                     PARM BRCA      @DSNB   3                       S01117
     C********** SDBRCH    PARM SDBRCH    DSFDY                                        S01117 CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANKS                                   S01117
     C                     MOVE *BLANKS   DBKEY                           S01117
     C                     MOVEL@DSNB     DBKEY                           S01117
     C                     MOVEL'SDBRCHPD'DBFILE           ************   S01117
     C                     Z-ADD3         DBASE            * DBASE 03 *   S01117
     C                     SETON                     U7U8LR************   S01117
     C                     GOTO END                                       S01117
     C                     ELSE                                                               CSC042
      * Details found on the DB so add them to the array                                      CSC042
      * if the array still has room                                                           CSC042
     C                     EXSR ##ADDB                                                        CSC042
     C                     END                                            S01117
     C                     END                             *** E10                            CSC042
      *                                                                   CLE005
     C           CLE005    IFEQ 'Y'                                       CLE005
     C                     WRITEHEADP2                                    CLE005
     C                     MOVE BRCA      RBRCA                           CLE005
     C                     ENDIF                                          CLE005
     C**                                                                  S01117
     C                     END                                            S01117
     C**                                                                  S01117
     C                     ELSE                                           S01117
     C**                                                                  S01117
     C*    IF MBIN='N' AND FIRST CYCLE,                                   S01117
     C*    OPEN LE0440P1                                                  S01117
     C**                                                                  S01117
     C           P1OP      IFNE 'Y'                                       S01117
     C                     SETON                       48                 S01117
     C                     MOVE 'Y'       P1OP    1                       S01117
     C                     OPEN LE0440P1                                  S01117
     C                     Z-ADD0         PAGE                            S01117
     C                     Z-ADD0         PAGE1                           S01117
0363 C                     Z-ADD0         DROP    50                      S01117
     C**                                                                  S01117
     C*    ENSURE REPORT SPOOL FILE RECORDED BY RCF                       S01117
     C**
     C                     Z-ADDSFNUM     ZSNUM   60                      S01117
     C                     OUT  LDA                                       S01117
     C**                                                                  S01117
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           SEQ                             S01117
     C                     PARM BRCA      SENTY   3                       S01117
     C                     PARM           SFILE                           S01117
     C                     PARM           ZSNUM                           S01117
     C                     PARM           ZSERR   1                       S01117
     C           *LOCK     IN   LDA                                       S01117
      **  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM       S01117
     C           ZSERR     IFEQ 'Y'                                       S01117
     C                     SETON                     U7U8LR               S01117
     C                     RETRN                                          S01117
     C                     END
      *                                                                   CLE005
      ** Ensure P2 report spool file is recorded by RCF                   CLE005
      ** If error exists, return to calling program                       CLE005
      *                                                                   CLE005
     C           CLE005    IFEQ 'Y'                                       CLE005
     C                     OPEN LE0440P2                                  CLE005
     C                     Z-ADD*ZEROS    RNORE                           CLE005
      *                                                                   CLE005
     C                     Z-ADDSFNUM2    ZSNUM                           CLE005
     C                     OUT  LDA                                       CLE005
     C                     CALL 'ZSFILE'                                  CLE005
     C                     PARM           SEQ                             CLE005
     C                     PARM BRCA      SENTY                           CLE005
     C                     PARM           SFILE2                          CLE005
     C                     PARM           ZSNUM                           CLE005
     C                     PARM           ZSERR                           CLE005
     C           *LOCK     IN   LDA                                       CLE005
     C           ZSERR     IFEQ 'Y'                                       CLE005
     C                     SETON                     U7U8LR               CLE005
     C                     RETRN                                          CLE005
     C                     ENDIF                                          CLE005
      *                                                                   CLE005
     C                     WRITEHEADP2                                    CLE005
     C                     ENDIF                                          CLE005
      *                                                                   S01117
     C                     END                                            S01117
     C                     END                                            S01117
      *                                                                   S01117
0394 C**
0395 C**   CHECK FOR PAST DUES AND SEQUENCE
0396 C**
     C*  IF OUTPUTTING TO S/PDUE, DO PARTIC. PURCH. PROCESSING            S01260
     C*                                                                   S01260
     C   45                EXSR PARTP                                     S01260
     C*                                                                   S01260
0397 C   45                EXSR PDUESR
0391 C                     MOVE PCRFA     PCRF                                               BUG9021
0398 C   41
0399 COR 44                EXSR CHECSQ
0400 C**
0401 C**   SAVE LOAN REFERENCE, VALUE DATE AND SEQUENCE
0402 C**   OF LAST RECORD OUTPUT TO NLAMS.
0403 C**
     C/COPY WNCPYSRC,LE0440C010
0404 C  N41N44             GOTO END
0405 C**********           MOVE LNRF      LNRFS   60                                          CLE148
     C                     MOVE LNRF      LNRFS   6                                           CLE148
0406 C                     MOVE VDAT      VDATS   50
0407 C                     MOVE LASN      LASNS   30
0408 C           END       TAG                             ** END TAG ****
     C**
     CL3                   MOVE ' '       LNMA
     C**
0409 C**
0410 C**   LAST RECORD CALCS
0411 C**
     C**
     CLR                   Z-ADDSFNUMU    ZSNUMU  60                      S01117
     CLR                   OUT  LDA                                       S01117
     C**
     CLR                   CALL 'ZSFILE'                                  S01117
     CLR                   PARM           SEQ     5                       S01117
     CLR                   PARM *BLANK    SENTY   3                       S01117
     CLR                   PARM           SFILEU                          S01117
     CLR                   PARM           ZSNUMU                          S01117
     CLR                   PARM           ZSERR   1                       S01117
      *                                                                   S01117
     CLR         *LOCK     IN   LDA                                       S01117
     CLR         ZSERR     IFEQ 'Y'                                       S01117
      **  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM       S01117
     CLR                   SETON                     U7U8                 S01117
     CLR                   RETRN                                          S01117
     CLR                   END
0412 CLR U7                GOTO LRTAG
0413 C**
0414 CLR         NNORE     SUB  2         NNLRA   50
     C**                                                                  S01117
0415 CLR         NOREL     COMP LNORE                5151
0416 CLRN51      VRRF      COMP LHASHF               5151
0417 CLRN51      VRRL      COMP LHASHL               5151
0418 CLR 51                SETON                     U8
0419 C**
0420 CLR         ANORE     COMP NOREA                5252
0421 CLR 52                SETON                     U8
      *                                                                   CLE005
      ** Write trailer of last open report file and A/C key files         CLE005
      *                                                                   CLE005
     CLR         CLE005    IFEQ 'Y'                                       CLE005
     CLR         P2OP      IFEQ 'Y'                                       CLE005
     CLR         RNORE     IFEQ *ZEROS                                    CLE005
     CLR                   WRITENODTLP2                                   CLE005
     CLR                   ELSE                                           CLE005
     CLR                   WRITETRAILP2                                   CLE005
     CLR                   ENDIF                                          CLE005
     CLR                   ENDIF                                          CLE005
     CLR                   MOVE 'H'       RECI                            CLE005
     CLR                   WRITELKEY1HHF                                  CLE005
     CLR                   MOVE 'T'       RECI                            CLE005
     CLR                   WRITELKEY1ZZF                                  CLE005
     CLR                   ENDIF                                          CLE005
0422 C**
0423 CLR         LRTAG     TAG                             ** LRTAG TAG **
     C**                                                                  S01117
     C**    WHEN LR INDICATOR SET ON WITHOUT EXECUTING THE FIRST          S01117
     C**    CYCLE                                                         S01117
     C**                                                                  S01117
     CLR         P1OP      IFNE 'Y'                                       S01117
     CLR                   EXSR #ZZ                                       S01117
     CLR                   END                                            S01117
0424 CLR U7                MOVE 'LE0440'  DBPGM
     CLR U7 U8             EXSR *PSSR                                     S01117
0425 C*R*U7******          MOVE 'TABLE'   DBFILE                          S01117
0426 C*R*U7******          MOVELZTABKY    DBKEY                           S01117
0427 C********************************************************************
     C*                                                                   S01260
     C*  PARTP SUBROUTINE TO DETERMINE WHETHER TO OUTPUT ORIGINAL         S01260
     C*  CUSTOMER NUMBER TO S/PDUE FOR PARTS. PURCHASED                   S01260
     C*                                                                   S01260
     C*       ROUTINE CALLED FROM - MAIN PROCESSING                       S01260
     C*       ROUTINE CALLS NO SUBROUTINE                                 S01260
     C*                                                                   S01260
     C           PARTP     BEGSR                           *** PARTP ***  S01260
     C           PTYP      COMP 64                       81               S01260
     C  N81      PTYP      COMP 65                       81               S01260
      *                                                                   CLE005
     C           *IN81     IFEQ '0'                                       CLE005
     C           CLE005    ANDEQ'Y'                                       CLE005
     C           PTYP      IFEQ 68                                        CLE005
     C           PTYP      OREQ 71                                        CLE005
     C                     MOVE '1'       *IN81                           CLE005
     C                     ENDIF                                          CLE005
     C                     ENDIF                                          CLE005
      *                                                                   CLE005
     C  N81                GOTO PRTEND                                    S01260
     C                     MOVE VDAT      SVDAT   50                      S01260
     C                     MOVELLNRF      CLNKEY  7                       S01260
     C                     MOVE 'A'       CLNKEY                          S01260
     C                     SETOF                     0582                 S01260
     C/COPY WNCPYSRC,LE0440C003
     C           CLNKEY    CHAINCLOAN                82                   S01260
     C/COPY WNCPYSRC,LE0440C004
     C  N05                SETON                     U7U8LR***************S01260
     C  N05                Z-ADD3         DBASE             DBASE 03      S01260
     C  N05                MOVE 'CLOAN'   DBFILE           ***************S01260
     C  N05                MOVELCLNKEY    DBKEY                           S01260
     C  N05                GOTO PRTEND                                    S01260
     C                     MOVE SVDAT     VDAT                            S01260
     C***********RCSI      COMP ' '                      83         S01260E26745
     C           RCSI      IFNE 'Y'                                       E26745
     C                     SETON                     83                   E26745
     C                     END                                            E26745
     C           PRTEND    ENDSR                           *** PRTEND *** S01260
     C*                                                                   S01260
0427 C********************************************************************
0428 C*                                                                  *
0429 C*****ACUNM*SR. TO PROCESS UNMATCHED RECORDS ON ACTN6               *S01117
0429 C*    ACUNM SR. TO PROCESS UNMATCHED RECORDS ON ACTN6L1             *S01117
0430 C*                                                                  *
0431 C*            ROUTINE CALLED FROM - MAIN PROCESSING
0432 C*            ROUTINE CALLS - COUNT
0433 C*
0434 C           ACUNM     BEGSR                           ** ACUNM BEGSR
0435 C**
0436 C**   TYPE PD - OUTPUT TO NLAMS AND PDUE
0437 C**
0438 C           AMTP      COMP 'PD'                     35
     C**   TO DROP THOSE PAST DUES WITH ZERO AMT.                         E86107
     C           *IN35     IFEQ '1'                                       E86107
     C/COPY WNCPYSRC,LE0440C011
     C           PRAM      COMP 0                      3636               E86107
      *                                                                                     AR847588
      ** Consider a negative interest and negative total amount in the                      AR847588
      ** computation.                                                                       AR847588
      *                                                                                     AR847588
     C***36***** INTA      COMP 0                      3636                          E86107 AR847588
     C   36      INTA      COMP 0                        36                                 AR847588
     C   36      WTXA      COMP 0                      3636               E86107
     C***36***** TAMT      COMP 0                      3636                          E86107 AR847588
     C   36      TAMT      COMP 0                        36                                 AR847588
     C/COPY WNCPYSRC,LE0440C012
     C           *IN36     IFEQ '1'                                       E86107
     C                     SETON                     4950                 E86107
      *                                                                   136484
     C           ORED      IFEQ RUND                                      136484
     C                     SETOF                     49                   136484
     C                     ENDIF                                          136484
      *                                                                   136484
     C                     EXSR SRDROP                                    E86107
     C                     ELSE                                           E86107
     C           PDPRIN    ADD  PRAM      PDPRIN                          E86107
     C                     SETON                     414345               E86107
     C           CLE005    IFEQ 'Y'                                       CLE005
     C                     EXSR SRPAST                                    CLE005
     C                     ENDIF                                          CLE005
     C                     END                                            E86107
     C                     END                                            E86107
0439 C***35******PDPRIN****ADD  PRAM      PDPRIN                          E86107
0440 C***35****************SETON                     414345               E86107
0441 C**
0442 C**   TYPE MA, NON-AUTO,PRINCIPAL GT 0 OUTPUT TO NLAMS,PDUE
0443 C**
0444 C           AMTP      COMP 'MA'                     35
0445 C   35      AUTO      COMP 'N'                      36
     C/COPY WNCPYSRC,LE0440C018
0446 C   35 36   PRAM      SUB  PDPRIN    PRAM       37
0448 C***35*36N37INTA      COMP 0                    37                                     AR847588
     C   35 36N37INTA      COMP 0                    3737                                   AR847588
0447 C   35 36 37TAMT      SUB  PDPRIN    TAMT
     C/COPY WNCPYSRC,LE0440C019
0449 C   35 36 37          SETON                     4544
     C           *IN35     IFEQ '1'                                       CLE005
     C           *IN36     ANDEQ'1'                                       CLE005
     C           *IN37     ANDEQ'1'                                       CLE005
     C           CLE005    IFEQ 'Y'                                       CLE005
     C                     EXSR SRPAST                                    CLE005
     C                     ENDIF                                          CLE005
     C                     ENDIF                                          CLE005
     C*                                                                   S01518
     C           *IN72     IFEQ '1'                                       S01518
     C*                                                                   S01518
     C** Check payment type for output on PF/NLAMSDK                      S01518
     C*                                                                   S01518
     C           PTYP      IFEQ 66                                        S01518
     C           PTYP      OREQ 67                                        S01518
     C           PTYP      OREQ 69                                        CLE005
     C           CLE005    ANDEQ'Y'                                       CLE005
     C           PTYP      OREQ 72                                        CLE005
     C           CLE005    ANDEQ'Y'                                       CLE005
     C                     MOVE '1'       *IN73                           S01518
     C                     ELSE                                           S01518
     C                     MOVE '0'       *IN73                           S01518
     C                     END                                            S01518
     C*                                                                   S01518
     C                     MOVELTSEN      @TSEN   8                       S01518
     C*                                                                   S01518
     C                     END                                            S01518
     C/COPY WNCPYSRC,LE0440C001
     C*                                                                   061369
      ** Perform non-repayment of principal for Risk/Guarantee                               242385A
      ** loans if system value "ZeroPastDueRiskLoan" = Y (default)                           242385A
      *                                                                                      242385A
     C           PDZERO    IFEQ 'Y'                                                          242385A
      *                                                                                      242385A
     C** For RISK/GUARANTEE loans there is no repayment of principal      061369
     C*                                                                   061369
     C           PTYP      IFEQ 70                                        061369
     C           AMTP      ANDEQ'MA'                                      061369
     C           AUTO      ANDEQ'N'                                       061369
     C           PTYP      OREQ 71                                        CLE005
     C           CLE005    ANDEQ'Y'                                       CLE005
     C           AMTP      ANDEQ'MA'                                      CLE005
     C           AUTO      ANDEQ'N'                                       CLE005
     C           TAMT      SUB  PRAM      TAMT                            061369
     C                     Z-ADD*ZEROS    PRAM                            061369
     C*                                                                   061369
     C** Do not output if amount is zero                                  061369
     C*                                                                   061369
     C           TAMT      IFLE 0                                         061369
     C                     MOVE '0'       *IN44                           061369
     C                     MOVE '0'       *IN45                           061369
     C                     END                                            061369
     C*                                                                   061369
     C                     END                                            061369
      *                                                                                      242385A
     C                     END                                                               242385A
      *                                                                                      242385A
     C/COPY WNCPYSRC,LE0440C002
      *                                                                   CLE007
      ** CLE007 past due processing for 'MR'- accounting must be done     CLE007
      ** and a new PD record written to NLAMSDK                           CLE007
      *                                                                   CLE007
     C           CLE007    IFEQ 'Y'                                       CLE007
     C           AMTP      ANDEQ'MR'                                      CLE007
     C           PAST      ANDEQ'Y'                                       CLE007
     C                     EXSR SRPDMR                                    CLE007
     C                     ENDIF                                          CLE007
0450 C**
0451 C**   IF INTEREST IS CAPITALISED ZEROISE INTEREST AMOUNT
0452 C**
0453 C   35      INTC      COMP 'Y'                      36
0454 C   35 36             Z-ADD0         INTA
0455 C***35*****           Z-ADD1         REPT                                               BUG4081
0456 C   45                EXSR COUNT
0457 C**
0458 C                     ENDSR
0459 C*                                                                  *
0460 C********************************************************************
0461 C********************************************************************
0462 C*                                                                  *
0463 C*    MATCH SR. TO PROCESS MATCHED RECORDS                          *
0464 C*                                                                  *
0465 C*            ROUTINE CALLED FROM - MAIN PROCESSING
0466 C*            ROUTINE CALLS COUNT
0467 C*
0468 C           MATCH     BEGSR                           ** MATCH BEGSR
     C**
     C**   TYPE 'PD' MATURITY INDICATOR 'Y' - OUTPUT TO REPORT AND DROP
     C**
0472 C           AMTP      COMP 'PD'                     35
0492 C   35      LNMA      COMP 'Y'                      36
     C/COPY WNCPYSRC,LE0440C013
0493 C   35 36             SETON                     49
      *                                                                   136484
     C           *IN35     IFEQ '1'                                       136484
     C           *IN36     ANDEQ'1'                                       136484
     C           ORED      ANDEQRUND                                      136484
     C                     SETOF                     49                   136484
     C                     ENDIF                                          136484
      *                                                                   180044
      ** if reversed past due record                                      180044
      *                                                                   180044
     C           *IN08     IFEQ '1'                                       180044
     C                     MOVE '1'       *IN35                           180044
     C                     MOVE '1'       *IN36                           180044
     C                     MOVE '1'       *IN49                           180044
     C                     ENDIF                                          180044
      *                                                                   136484
0494 C   35 36             EXSR SRDROP
      *                                                                   180044
     C           *IN08     IFEQ '0'                                       180044
     C                     ENDIF                                          180044
     C   35 36             GOTO MATEND
     C**   MATURITY INDICATOR NOT 'Y' AND
0469 C**
0470 C**   TYPE PD - OUTPUT TO NLAMS AND PDUE
0471 C**
     C           *IN35     IFEQ '1'
     C           PRAM      COMP 0                      3636
      *                                                                                     AR847588
      ** Consider a negative interest and negative total amount in the                      AR847588
      ** computation.                                                                       AR847588
      *                                                                                     AR847588
     C***36***** INTA      COMP 0                      3636                                 AR847588
     C   36      INTA      COMP 0                        36                                 AR847588
     C   36      WTXA      COMP 0                      3636
     C***36***** TAMT      COMP 0                      3636                                 AR847588
     C   36      TAMT      COMP 0                        36                                 AR847588
     C/COPY WNCPYSRC,LE0440C014
     C           *IN36     IFEQ '1'
     C                     SETON                     4950
      *                                                                   136484
     C           ORED      IFEQ RUND                                      136484
     C                     SETOF                     49                   136484
     C                     ENDIF                                          136484
     C                     EXSR SRDROP
     C                     ELSE
     C           PDPRIN    ADD  PRAM      PDPRIN
     C                     SETON                     414542
     C           CLE005    IFEQ 'Y'                                       CLE005
     C                     EXSR SRPAST                                    CLE005
     C                     ENDIF                                          CLE005
     C                     EXSR COUNT
0476 C**
     C                     END                                            S01194
     C                     END                                            S01194
      *                                                                   CLE007
      ** CLE007 past due processing for 'MR'- accounting must be done     CLE007
      ** and a new PD record written to NLAMSDK                           CLE007
      *                                                                   CLE007
     C           CLE007    IFEQ 'Y'                                       CLE007
     C           AMTP      ANDEQ'MR'                                      CLE007
     C           PAST      ANDEQ'Y'                                       CLE007
     C                     EXSR SRPDMR                                    CLE007
     C                     ENDIF                                          CLE007
     C/COPY WNCPYSRC,LE0440CP12                                           S01408
     C           MATEND    ENDSR
0478 C*                                                                  *
0479 C********************************************************************
     C/EJECT                                                              CLE005
      *****************************************************************   CLE005
      *    SRPAST SR TO PROCESS PAST DUE RECORDS                      *   CLE005
      *                                                               *   CLE005
      *            ROUTINE CALLED FROM - ACUNM, MATCH                 *   CLE005
      *            ROUTINE CALLS - SRPDKY, CHECSQ, COUNT              *   CLE005
      *                                                               *   CLE005
     C           SRPAST    BEGSR                                          CLE005
     C/COPY WNCPYSRC,LE0440C020
      *                                                                   CLE005
      ** (1) Processing for past due against principal repayment          CLE005
      ** (2) Processing for past due against interest repayment           CLE005
      *                                                                   CLE005
     C                     Z-ADD1         WPCNT   10                      CLE005
     C                     Z-ADDTAMT      WTAMT  130                      CLE005
     C                     MOVE PDGN      WPDGN   1                       CLE005
     C           WLGDPR    ADD  VDAT      WDTPR   50                      CLE005
     C           WLGDIN    ADD  VDAT      WDTIN   50                      CLE005
     C           AMTP      IFEQ 'MA'                                      CLE005
     C                     MOVE '1'       *IN43                           CLE005
     C                     ENDIF                                          CLE005
      *                                                                                       CLE028
     C                     MOVE *OFF      *IN38                                               CLE028
     C                     Z-ADD*ZERO     WINTA0 130                                          CLE028
      *                                                                   CLE005
     C***********WPCNT     DOUGT2                                  CLE005 157556
      *                                                                   CLE005
      ** If not going past due on principal and interest, do not          CLE005
      ** output to NLAMSDK and PDUEDU                                     CLE005
      *                                                                   CLE005
     C           WDTPR     IFGT ECDT                                      CLE005
     C           WDTIN     ANDGTECDT                                      CLE005
     C           PDGN      ANDNE'Y'                                                          BUG4775
     C                     MOVE '0'       *IN41                           CLE005
     C                     MOVE '0'       *IN44                           CLE005
     C                     MOVE '0'       *IN45                           CLE005
     C***********          LEAVE                                   CLE005 157556
     C                     ENDIF                                          CLE005
      *                                                                   157556
     C           REPT      IFEQ 1                                         157556
     C           REPT      OREQ 3                                         157556
     C           WPCNT     DOUGT2                                         157556
      *                                                                   CLE005
      ** Do not output a zero event amount                                CLE005
      *                                                                   CLE005
     C           WPCNT     IFEQ 1                                         CLE005
     C           PRAM      ANDEQ*ZEROS                                    CLE005
     C           WPCNT     OREQ 2                                         CLE005
     C           INTA      ANDEQ*ZEROS                                    CLE005
      *                                                                                       CLE028
      ** Do not output past due interest when add on interest                                 CLE028
      ** set to 'Y' for flat rate loans                                                       CLE028
      *                                                                                       CLE028
     C           CLE028    OREQ 'Y'                                                           CLE028
     C           WPCNT     ANDEQ2                                                             CLE028
     C           PTYP      ANDEQ80                                                            CLE028
     C           ADIF      ANDEQ'Y'                                                           CLE028
      *                                                                                       CLE028
     C           CLE028    IFEQ 'Y'                                                           CLE028
     C           WPCNT     ANDEQ2                                                             CLE028
     C           PTYP      ANDEQ80                                                            CLE028
     C           ADIF      ANDEQ'Y'                                                           CLE028
     C                     MOVE *ON       *IN38                                               CLE028
     C                     ENDIF                                                              CLE028
      *                                                                                       CLE028
     C                     ADD  1         WPCNT                           CLE005
     C                     ITER                                           CLE005
     C                     ENDIF                                          CLE005
      *                                                                   CLE005
      ** First pass is for principal, next is for interest                CLE005
      *                                                                   CLE005
     C           WPCNT     IFEQ 1                                         CLE005
     C                     Z-ADDWDTPR     WFNVD   50                      CLE005
     C                     MOVEA'100'     *IN,53                          CLE005
     C                     ELSE                                           CLE005
     C                     Z-ADDWDTIN     WFNVD                           CLE005
     C                     MOVEA'010'     *IN,53                          CLE005
     C                     ENDIF                                          CLE005
      *                                                                   CLE005
      ** Create a past due account key if applicable                      CLE005
      *                                                                   CLE005
     C           WFNVD     IFLE ECDT                                      CLE005
     C           PDGN      IFEQ 'Y'                                       CLE005
     C                     EXSR SRPDKY                                    CLE005
     C                     MOVE 'N'       WPDGN                           CLE005
     C                     ENDIF                                          CLE005
     C/COPY WNCPYSRC,LE0440C021
      *                                                                   CLE005
      ** Create a new past due record in the NLAMSDK                      CLE005
      ** with AMTP = 'RE', for either interest or principal                                  BUG9021
      *                                                                   CLE005
     C                     ELSE                                           CLE005
     C           WPCNT     IFEQ 1                                         CLE005
     C                     SUB  INTA      WTAMT                           CLE005
     C                     SUB  PRAM      TAMT                            CLE005
     C                     Z-ADD*ZEROS    PRAM                            CLE005
     C                     ELSE                                           CLE005
     C                     SUB  PRAM      WTAMT                           CLE005
     C                     SUB  INTA      TAMT                            CLE005
     C                     Z-ADD*ZEROS    INTA                            CLE005
     C                     ENDIF                                          CLE005
      * Generate a new PCRF for this record:                                                 BUG9021
     C                     MOVEL*BLANKS   PCRF                                               BUG9021
     C                     EXSR CHECSQ                                    CLE005
     C                     EXCPTNEWREC                                    CLE005
     C                     EXCPTNRECQD                                                        258399
     C**********           Z-ADDLNRF      LNRFS                                        CLE005 CLE148
     C                     MOVELLNRF      LNRFS                                               CLE148
     C                     Z-ADDVDAT      VDATS                           CLE005
     C                     Z-ADDLASN      LASNS                           CLE005
      *                                                                   157591
      ** Compute file controls for PNORE only if record written is        157591
      ** Past Due.                                                        157591
      *                                                                   157591
     C                     MOVE 'Y'       WNEWRC                          157591
     C                     EXSR COUNT                                     CLE005
     C                     MOVE 'N'       WNEWRC                          157591
     C                     ADD  1         LASN                            CLE005
     C                     ENDIF                                          CLE005
      *                                                                   CLE005
     C                     ADD  1         WPCNT                           CLE005
     C                     ENDDO                                          CLE005
      *                                                                   157556
     C                     ENDIF                                          157556
      *                                                                   157556
      ** Create a past due account key for repayment type 2.              157556
      *                                                                   157556
     C           REPT      IFEQ 2                                         157556
     C           PDGN      ANDEQ'Y'                                       157556
     C********** PRAM      IFGT 0                                                      157556 240114
     C**********           Z-ADD1         WPCNT                                        157556 240114
     C**********           ELSE                                                        157556 240114
     C**********           Z-ADD2         WPCNT                                        157556 240114
     C**********           ENDIF                                                       157556 240114
      ** Create a principal PD A/C key                                                        240114
      *                                                                                       240114
     C           PRAM      IFNE *ZEROS                                                        240114
     C                     Z-ADD1         WPCNT                                               240114
     C                     EXSR SRPDKY                                    157556
     C                     ENDIF                                                              240114
      *                                                                                       240114
     C           INTA      IFNE *ZEROS                                                        240114
     C                     Z-ADD2         WPCNT                                               240114
     C                     EXSR SRPDKY                                                        240114
     C                     ENDIF                                                              240114
      *                                                                                       240114
     C                     MOVE 'N'       WPDGN                           157556
     C                     ENDIF                                          157556
     C/COPY WNCPYSRC,LE0440C022
      *                                                                   157556
     C                     MOVE WPDGN     PDGN                            CLE005
      *                                                                   CLE005
     C                     ENDSR                                          CLE005
      *****************************************************************   CLE005
     C/EJECT                                                              CLE007
      *****************************************************************   CLE007
      *    SRPDMR SR TO PROCESS 'MR' RECORDS THAT ARE PAST DUE        *   CLE007
      *                                                               *   CLE007
      *            ROUTINE CALLED FROM - ACUNM, MATCH                 *   CLE007
      *            ROUTINE CALLS - SRPDKY, CHECSQ, COUNT              *   CLE007
      *                                                               *   CLE007
     C           SRPDMR    BEGSR                                          CLE007
      *                                                                   CLE007
     C           CLE005    IFEQ 'Y'                                       CLE007
     C           PDGN      ANDEQ'Y'                                       CLE007
      *                                                                   CLE007
      ** Create a principal PD A/C key                                    CLE007
      *                                                                   CLE007
     C           PRAM      IFNE *ZEROS                                    CLE007
     C                     Z-ADD1         WPCNT                           CLE007
     C                     EXSR SRPDKY                                    CLE007
     C                     ENDIF                                          CLE007
      *                                                                   CLE007
      ** Create an interest PD A/C key                                    CLE007
      *                                                                   CLE007
     C           INTA      IFNE *ZEROS                                    CLE007
     C                     Z-ADD2         WPCNT                           CLE007
     C                     EXSR SRPDKY                                    CLE007
     C                     ENDIF                                          CLE007
     C                     ENDIF                                          CLE007
      *                                                                   CLE007
      ** Re-write the 'MR' record as 'PD' with same details               CLE007
      *                                                                   CLE007
     C                     MOVEA'001'     *IN,53                          CLE007
     C                     MOVE '1'       *IN45                           LER014
     C***********          Z-ADDTAMT      WTAMT                    CLE007 127718
     C                     Z-SUBTAMT      WTAMT                           127718
     C                     Z-SUBPRAM      WPRAM  130                      127718
     C                     Z-SUBINTA      WINTA  130                      127718
     C                     Z-SUBWTXA      WWTXA  130                      127718
     C                     Z-SUBFTOT      WFTOT  130                                          CLE036
     C                     Z-SUBFRAM      WFRAM  130                                          CLE036
     C                     Z-SUBFINT      WFINT  130                                          CLE036
     C                     Z-SUBFTXA      WFTXA  130                                          CLE036
     C                     EXSR CHECSQ                                    CLE007
     C                     EXCPTNEWREC                                    CLE007
     C                     EXCPTNRECQD                                                        258399
     C**********           Z-ADDLNRF      LNRFS                                        CLE007 CLE148
     C                     MOVELLNRF      LNRFS                                               CLE148
     C                     Z-ADDVDAT      VDATS                           CLE007
     C                     Z-ADDLASN      LASNS                           CLE007
     C                     EXSR COUNT                                     CLE007
     C**********           ADD  1         LASN                     CLE005 189590
      *                                                                   CLE007
     C                     ENDSR                                          CLE007
      *****************************************************************   CLE007
     C/EJECT                                                              CLE005
      *****************************************************************   CLE005
      *    SRPDKY SR TO GENERATE PD A/C ENTRIES                       *   CLE005
      *                                                               *   CLE005
      *            ROUTINE CALLED FROM - SRPAST                       *   CLE005
      *            ROUTINE CALLS - NOTHING                            *   CLE005
      *                                                               *   CLE005
     C           SRPDKY    BEGSR                                          CLE005
      *                                                                   CLE005
      ** Output to LKEY3DP                                                CLE005
      *                                                                   CLE005
     C                     MOVEALTYP      AKY,1                           CLE005
     C                     MOVE 'P'       AKY,3                           CLE005
     C                     MOVEASUTP      AKY,4                           CLE005
     C                     MOVEACLAS      AKY,11                                              CLE042
     C           WPCNT     IFEQ 1                                         CLE005
     C                     MOVE 'A'       AKY,10                          CLE005
     C                     Z-ADDPRAM      EAMT                            CLE005
     C                     ELSE                                           CLE005
     C                     MOVE 'I'       AKY,10                          CLE005
     C                     Z-ADDINTA      EAMT                            CLE005
     C                     ENDIF                                          CLE005
     C           EAMT      IFLT *ZEROS                                    CLE005
     C           WPCNT     ANDEQ1                                                           AR847588
     C                     Z-SUBEAMT      EAMT                            CLE005
     C                     ENDIF                                          CLE005
     C                     MOVEAAKY       AKEY                            CLE005
     C                     MOVE LNRF      LNNO                            CLE005
     C                     Z-ADDVDAT      EDAT                            CLE005
     C                     Z-ADDLASQ      ACSQ                            CLE005
     C                     MOVE CCY       ECCY                            CLE005
     C                     Z-ADD*ZEROS    OTHA                            CLE005
     C                     MOVE *BLANKS   OTHC                            CLE005
     C                     Z-ADD*ZEROS    EXRT                            CLE005
     C                     Z-ADDWLVDAT    STDT                            CLE005
     C                     Z-ADDWLSLID    SLID                            CLE005
     C                     Z-ADDWLMDAT    MDAT                            CLE005
     C                     Z-ADDWLBRTT    BRTT                            CLE005
     C                     Z-ADDWLBRTE    BRTE                            CLE005
     C                     Z-ADDWLRTSP    RTSP                            CLE005
     C                     Z-ADDWLINTR    INTR                            CLE005
     C                     Z-ADDWLCPAM    CPAM                            CLE005
     C                     Z-ADD*ZEROS    PACD                            CLE005
     C                     Z-ADDWLICBS    ICBS                            CLE005
     C                     MOVE WLACOF    ACOF                            CLE005
     C                     MOVE WLFACO    FACO                            CLE005
     C                     MOVE WLPRFC    PRFC                            CLE005
     C                     MOVE WLBOKC    BOKC                            CLE005
     C                     Z-ADDWLORED    ORED                            CLE005
     C**********           Z-ADDWLOLNO    OLNO                                         CLE005 CSD027
     C                     MOVE WLOLNO    OLNO                                                CSD027
     C                     MOVE WLPTFR    PTFR                            CLE005
      *                                                                                       CGL020
     C                     MOVE *BLANK    F1FFLG  1                                           CGL020
     C                     Z-ADD0         F1FVAL 130                                          CGL020
     C                     Z-ADD0         F1FPCT  52                                          CGL020
     C                     MOVE *BLANKS   F1RACT 20                                           CGL020
     C                     MOVE *BLANKS   F1RCTY  2                                           CGL020
     C                     MOVE *BLANKS   F1RBNK 20                                           CGL020
     C                     MOVE *BLANKS   F1RCDE 11                                           CGL020
     C                     MOVE *BLANKS   F1PACT 20                                           CGL020
     C                     MOVE *BLANKS   F1PCTY  2                                           CGL020
     C                     MOVE *BLANKS   F1PBNK 20                                           CGL020
     C                     MOVE *BLANKS   F1PCDE 11                                           CGL020
     C                     MOVE *BLANKS   F1DACT 35                                           CGL020
     C                     MOVE *BLANKS   F1DCTY  2                                           CGL020
     C                     MOVE *BLANKS   F1DBNK 20                                           CGL020
     C                     Z-ADD0         F1SDAT  50                                          CGL020
      *                                                                                       CGL020
     C                     WRITELKEY1DPF                                  CLE005
      *                                                                   CLE005
      ** Accumulate hash totals                                           CLE005
      *                                                                   CLE005
     C           EAMT      DIV  1000      ZZAMT                           CLE005
     C           ZZAMT     IFLT *ZEROS                                    CLE005
     C                     Z-SUBZZAMT     ZZAMT                           CLE005
     C                     ENDIF                                          CLE005
     C                     Z-ADDVLRF      ZZTOTI                          CLE005
     C                     Z-ADDVLRL      ZZTOTD                          CLE005
     C                     ADD  1         NORE                            CLE005
     C                     EXSR GLZADD                                    CLE005
     C                     Z-ADDZZTOTI    VLRF                            CLE005
     C                     Z-ADDZZTOTD    VLRL                            CLE005
      *                                                                   CLE005
      ** Write detail line to P2 printer file                             CLE005
      *                                                                   CLE005
     C                     ADD  1         RNORE                           CLE005
     C                     MOVE CNUM      RCNUM                           CLE005
      *                                                                                       201123
     C           PTYP      IFEQ 64                                                            201123
     C           PTYP      OREQ 65                                                            201123
     C           PTYP      OREQ 68                                                            201123
     C           PTYP      OREQ 71                                                            201123
     C                     MOVE OLNO      OLNOZ                                               201123
     C                     ELSE                                                               201123
     C                     MOVE *BLANKS   OLNOZ                                               201123
     C                     ENDIF                                                              201123
      *                                                                                       201123
     C                     MOVE LNNO      RLNNO                           CLE005
     C                     MOVE AKEY      RAKEY                           CLE005
     C                     MOVE ECCY      RECCY                           CLE005
     C                     MOVE REVI      RREVI                           CLE005
      *                                                                   CLE005
      * Check in array before calling AO                                                      CSC042
     C                     MOVELECCY      ##KC                                                CSC042
     C                     EXSR ##CHKC                                                        CSC042
      * Found the data in the array so use it rather than call AO pgm                         CSC042
     C           ##FIC     IFEQ 'Y'                                                           CSC042
     C                     MOVE CURR,Q    A6CYCD                                              CSC042
     C                     Z-ADDCCDP,Q    A6NBDP                                              CSC042
     C                     ELSE                                                               CSC042
      * Not in array so get details from DB                                                   CSC042
     C                     CALL 'AOCURRR0'                                CLE005
     C                     PARM *BLANKS   @RTCD                           CLE005
     C                     PARM '*KEY   ' @OPTN                           CLE005
     C                     PARM ECCY      @CURR   3                       CLE005
     C           SDCURR    PARM SDCURR    DSSDY                           CLE005
     C           @RTCD     IFNE *BLANKS                                   CLE005
     C                     MOVEL'SDCURRPD'DBFILE           ************   CLE005
     C                     MOVEL@CURR     DBKEY            * DBERR 08 *   CLE005
     C                     Z-ADD8         DBASE            ************   CLE005
     C                     SETON                     U7U8LR               CLE005
     C                     ELSE                                                               CSC042
      * Data found by AO pgm so add to array if there is space                                CSC042
     C           ##INDX    IFLT 150                                                           CSC042
     C                     ADD  1         ##INDX                                              CSC042
     C                     Z-ADD##INDX    Q                                                   CSC042
     C                     MOVEL##KC      CURR,Q                                              CSC042
     C                     Z-ADDA6NBDP    CCDP,Q                                              CSC042
      * Update saved Q so ##CHKC looks at this value first next time                          CSC042
     C                     Z-ADDQ         ##QSV                                               CSC042
     C                     END                                                                CSC042
      *                                                                                       CSC042
     C                     ENDIF                                          CLE005
     C                     END                                                                CSC042
     C                     Z-ADDEAMT      ZFLD15                          CLE005
     C                     MOVE 'J'       ZECODE                          CLE005
     C                     Z-ADDA6NBDP    ZDECS                           CLE005
     C                     EXSR ZSEDIT                                    CLE005
     C                     MOVE ZOUT21    REAMT                           CLE005
      *                                                                   CLE005
     C           *IN22     IFEQ '1'                                       CLE005
     C                     WRITEHEADP2                                    CLE005
     C                     ENDIF                                          CLE005
     C                     WRITEDETLP2                                    CLE005
      *                                                                   CLE005
     C                     ENDSR                                          CLE005
      *****************************************************************   CLE005
      /EJECT                                                                                  CSC042
     C********************************************************************                    CSC042
     C*                                                                                       CSC042
     C*  ##CHKC  - Check the currency details                                                 CSC042
     C*                                                                                       CSC042
     C********************************************************************                    CSC042
     C           ##CHKC    BEGSR                                                              CSC042
      *                                                                                       CSC042
     C           *LIKE     DEFN BJCYCD    ##KC                                                CSC042
     C           *LIKE     DEFN Q         ##QSV                                               CSC042
      *                                                                                       CSC042
      * Set off the currency found indicator                                                  CSC042
     C                     MOVEL*BLANK    ##FIC   1                                           CSC042
      *                                                                                       CSC042
      * Save the state of indicator 87 so it can be reset at the end                          CSC042
      * of the SR as it may be used elsewhere in the code                                     CSC042
     C           *IN87     IFEQ *ON                                                           CSC042
     C                     MOVEL'Y'       #IN87   1                                           CSC042
     C                     ELSE                                                               CSC042
     C                     MOVEL'N'       #IN87                                               CSC042
     C                     END                                                                CSC042
      *                                                                                       CSC042
     C                     SETOF                         87                                   CSC042
      *                                                                                       CSC042
      * Restore Q from ##QSV in case Q is used elsewhere in the code                          CSC042
     C                     Z-ADD##QSV     Q       40                                          CSC042
      *                                                                                       CSC042
      * Are we looking for the same details as the last time this                             CSC042
      * subroutine was called i.e. is Q already set correctly?                                CSC042
      * If so then use the data rather than do another LOKUP                                  CSC042
      * First make sure that we don't reference the 0th array element                         CSC042
     C           Q         IFEQ 0                                                             CSC042
     C                     Z-ADD1         Q                                                   CSC042
     C                     END                                                                CSC042
      * Now see if this search is same as last one performed                                  CSC042
      * If we have a match then seton 87 so the code after this                               CSC042
      * subroutine knows it can use Q directly                                                CSC042
     C           ##KC      IFEQ CURR,Q                                                        CSC042
     C                     SETON                         87                                   CSC042
     C                     ELSE                                                               CSC042
      * Otherwise hunt in the array and seton 87 if found                                     CSC042
     C                     Z-ADD1         Q                                                   CSC042
     C           ##KC      LOKUPCURR,Q                   87                                   CSC042
     C                     END                                                                CSC042
      *                                                                                       CSC042
      * Save Q for next time                                                                  CSC042
     C           *IN87     IFEQ *ON                                                           CSC042
     C                     Z-ADDQ         ##QSV                                               CSC042
      * Set the indicator to show the data was found                                          CSC042
     C                     MOVEL'Y'       ##FIC                                               CSC042
     C                     END                                                                CSC042
      *                                                                                       CSC042
      * Reset the state of indicator 87.                                                      CSC042
     C           #IN87     IFEQ 'Y'                                                           CSC042
     C                     MOVEL*ON       *IN87                                               CSC042
     C                     ELSE                                                               CSC042
     C                     MOVEL*OFF      *IN87                                               CSC042
     C                     END                                                                CSC042
      *                                                                                       CSC042
     C                     ENDSR                                                              CSC042
      *                                                                                       CSC042
     C********************************************************************                    CSC042
      /EJECT                                                                                  CSC042
0480 C********************************************************************
0481 C*                                                                  *
0482 C*    LAUNM SR. TO PROCESS UNMATCHED RECORDS ON LAUPD               *
0483 C*                                                                  *
0484 C*            ROUTINE CALLED FROM - MAIN PROCESSING
0485 C*            ROUTINE CALLS - SRDROP (4),COUNT,GLZADD
0486 C*
0487 C           LAUNM     BEGSR                           ** LAUNM BEGSR
0488 C**
0489 C**   TYPE 'PD' MATURITY INDICATOR 'Y' - OUTPUT TO REPORT AND DROP
0490 C**
0491 C           AMTP      COMP 'PD'                     35
0492 C   35      LNMA      COMP 'Y'                      36
     C/COPY WNCPYSRC,LE0440C015
0493 C   35 36             SETON                     49
      *                                                                   136484
     C           *IN35     IFEQ '1'                                       136484
     C           *IN36     ANDEQ'1'                                       136484
     C           ORED      ANDEQRUND                                      136484
     C                     SETOF                     49                   136484
     C                     ENDIF                                          136484
      *                                                                   136484
0494 C   35 36             EXSR SRDROP
0495 C   35 36             GOTO LAEND
     C*                                                                   S01408
     C/COPY WNCPYSRC,LE0440CCP1                                           S01408
     C*                                                                   S01408
0496 C**
0497 C**   ALL AMOUNTS LE 0 - OUTPUT TO REPORT AND DROP
0498 C**
0499 C   35      PRAM      COMP 0                      3636
0500 C***35*36***INTA      COMP 0                      3636               S01392
      *                                                                   136484
     C           *IN35     IFEQ '1'                                       136484
     C           *IN36     ANDEQ'1'                                       136484
     C           ORED      ANDEQRUND                                      136484
     C                     SETOF                     49                   136484
     C                     ENDIF                                          136484
      *                                                                                     AR847588
      ** All types of loan might now have a negative interest.                              AR847588
      *                                                                                     AR847588
     C****************************************************************               S01392 AR847588
     C****ALLOW*NEGATIVE*INTEREST*FOR*DISCOUNTED*LOAN*****************               S01392 AR847588
     C****************************************************************               S01392 AR847588
     C   35 36             DO                                             S01392
     C********** PTYP      IFEQ 63                                                   S01392 AR847588
     C           INTA      COMP 0                        36               S01392
     C**********           ELSE                                                      S01392 AR847588
     C********** INTA      COMP 0                      3636                          S01392 AR847588
     C**********           END                                                       S01392 AR847588
     C                     END                                            S01392
0501 C   35 36   WTXA      COMP 0                      3636
     C/COPY WNCPYSRC,LE0440C016
0502 C   35 36             SETON                     4950
      *                                                                   136484
     C           *IN35     IFEQ '1'                                       136484
     C           *IN36     ANDEQ'1'                                       136484
     C           ORED      ANDEQRUND                                      136484
     C                     SETOF                     49                   136484
     C                     ENDIF                                          136484
      *                                                                   136484
0503 C   35 36             EXSR SRDROP
0504 C   35 36             GOTO LAEND
0505 C**
0505 C**
0506 C**   OTHER PD - UPDATE PDPRIN AND OUTPUT TO NLAMS AND PDUE
0507 C**
0508 C   35      PRAM      ADD  PDPRIN    PDPRIN
0509 C   35                SETON                     4145
     C/COPY WNCPYSRC,LE0440C023
0510 C   41                EXSR COUNT
0511 C   41                GOTO LAEND
0512 C**
0513 C**   TYPE 'RE' - CHECK IF REPAID
0514 C**
0515 C           AMTP      COMP 'RE'                     35
0516 C   35      PRAM      COMP 0                      3636
0517 C   35 36   INTA      COMP 0                      3636
0518 C   35 36   WTXA      COMP 0                      3636
     C   35 36   TAMT      COMP 0                      3636
0519 C   35 36             SETON                     4950
      *                                                                   136484
     C           *IN35     IFEQ '1'                                       136484
     C           *IN36     ANDEQ'1'                                       136484
     C                     SETOF                     49                   136484
     C                     ENDIF                                          136484
      *                                                                   136484
0520 C   35 36             EXSR SRDROP
0521 C   35 36             GOTO LAEND
      *                                                                                     AR700107
      ** If Event is MR/RE for a PDCL and settlement account block all                      AR700107
      ** debit is Y then prevent output to NLAMSDK                                          AR700107
      *                                                                                     AR700107
     C           CLE134    IFEQ 'Y'                                                         AR700107
     C                     MOVELLTYP      WLTYP   1                                         AR700107
     C           WLTYP     IFEQ 'X'                                                         AR700107
     C           WLTYP     OREQ 'Y'                                                         AR700107
     C           WLTYP     OREQ 'Z'                                                         AR700107
     C           AMTP      IFEQ 'MR'                                                        AR700107
     C           AMTP      OREQ 'RE'                                                        AR700107
     C                     EXSR RTVACC                                                      AR700107
     C           WBLCKD    IFEQ 'Y'                                                         AR700107
     C                     GOTO LAEND                                                       AR700107
     C                     ENDIF                                                            AR700107
     C                     ENDIF                                                            AR700107
     C                     ENDIF                                                            AR700107
     C                     ENDIF                                                            AR700107
      *                                                                                     AR786878
      ** Also do not output to NLAMSDK when MR or RE is                                     AR786878
      ** against a PDCL.                                                                    AR786878
      *                                                                                     AR786878
     C           CLE134    IFEQ 'Y'                                                         AR786878
     C           NEWCOB    ANDEQ'N'                                                         AR786878
     C           WLTYP     IFEQ 'X'                                                         AR786878
     C           WLTYP     OREQ 'Y'                                                         AR786878
     C           WLTYP     OREQ 'Z'                                                         AR786878
     C           AMTP      IFEQ 'MR'                                                        AR786878
     C           VDAT      ANDLTBJDNWD                                                      AR786878
     C           AMTP      OREQ 'RE'                                                        AR786878
     C           VDAT      ANDLTBJDNWD                                                      AR786878
     C                     GOTO LAEND                                                       AR786878
     C                     ENDIF                                                            AR786878
     C                     ENDIF                                                            AR786878
     C                     ENDIF                                                            AR786878
0522 C**
0523 C**   ALL OTHERS OUTPUT TO NLAMS
0524 C**
     C*                                                                   S01408
     C/COPY WNCPYSRC,LE0440CCP2                                           S01408
     C*                                                                   S01408
0525 C                     SETON                     41
0526 C           NNORE     ADD  1         NNORE
0527 C                     Z-ADDNHASHF    ZZTOTI
0528 C                     Z-ADDNHASHL    ZZTOTD
0529 C***                  MOVE TAMT      ZZAMT                           E11641
0529 C                     MOVE TAMT      ZZAMT        20  *20=-VE.       E11641
0530 C   20                Z-SUBZZAMT     ZZAMT
0531 C                     EXSR GLZADD
0532 C                     Z-ADDZZTOTI    NHASHF
0533 C                     Z-ADDZZTOTD    NHASHL
0534 C**
0535 C           LAEND     ENDSR                           ** LAEND ENDSR
0536 C*                                                                  *
0537 C********************************************************************
0538 C********************************************************************
0539 C*                                                                  *
0540 C*    SRDROP SR. TO KEEP COUNT OF REPAYMENTS DROPPED                *
0541 C*    AND CONVERT VALUE DATE.                                       *
0542 C*                                                                  *
0543 C*            ROUTINE CALLED FROM - LAUNM
0544 C*            ROUTINE CALLS - ZDATE2
0545 C           SRDROP    BEGSR                           ** SRDROP BEGSR
0546 C**
     C           *IN49     IFEQ '1'                                       136484
0547 C           DROP      ADD  1         DROP
     C                     ENDIF                                          136484
0548 C                     Z-ADDVDAT      ZDAYNO
0549 C                     EXSR ZDATE2
0550 C                     MOVE ZADATE    AVDAT   7
0551 C**
     C           CLE034    IFEQ 'Y'                                                           CLE034
     C           STAL      ANDEQ'Y'                                                           CLE034
      *                                                                                       CLE034
     C                     MOVEL'LA'      PTYPE   4                                           CLE034
     C                     MOVE AMTP      PTYPE                                               CLE034
     C                     MOVEASTAMP,1   PTMST                                               CLE034
     C                     CALL 'AOSTALU0'                                                    CLE034
     C                     PARM           PRTCD   7                                           CLE034
     C                     PARM           PTYPE                                               CLE034
     C                     PARM 'D'       PACTN   1                                           CLE034
     C                     PARM           LNRF                                                CLE034
     C                     PARM           VDAT                                                CLE034
     C                     PARM           LASN                                                CLE034
     C                     PARM *BLANKS   PCNUM   6                                           CLE034
     C                     PARM *BLANKS   PFACL   5                                           CLE034
     C                     PARM *BLANKS   PFESQ   2                                           CLE034
     C                     PARM           PTMST  26                                           CLE034
     C                     PARM *BLANKS   PPCRF  15                                           CLE034
      *                                                                                       CLE034
     C                     ENDIF                                                              CLE034
      *                                                                                       CLE034
0552 C                     ENDSR
0553 C*                                                                  *
0554 C********************************************************************
0555 C********************************************************************
0556 C*                                                                  *
0557 C*    COUNT SR. TO MAINTAIN HASH TOTALS OF RECORDS                  *
0558 C*    OUTPUT TO PDUE AND NLAMS.                                     *
0559 C*                                                                  *
0560 C*            ROUTINE CALLED FROM - ACUNM,MATCH,LAUNM
0561 C*            ROUTINE CALLS - GLZADD
0562 C*
0563 C           COUNT     BEGSR                           ** COUNT BEGSR
0564 C**
0565 C***********PNORE     ADD  1         PNORE                           S01392
0566 C***********NNORE     ADD  1         NNORE                           S01392
0567 C***********          Z-ADDNHASHF    ZZTOTI                          S01392
0568 C***********          Z-ADDNHASHL    ZZTOTD                          S01392
0529 C***********          MOVE TAMT      ZZAMT                    E11641 S01392
0529 C***********          MOVE TAMT      ZZAMT        20  *20=-VE.E11641 S01392
0570 C***20******          Z-SUBZZAMT     ZZAMT                           S01392
0571 C***********          EXSR GLZADD                                    S01392
0572 C***********          Z-ADDZZTOTI    NHASHF                          S01392
0573 C***********          Z-ADDZZTOTD    NHASHL                          S01392
0574 C**
0575 C**   SET UP AMTO FIELD FOR PDUE
0576 C**
0577 C***********REPT******COMP 3                        35               E86108
0578 C***35****************Z-ADDTAMT      AMTO   130                      E86108
0579 C**N35****************Z-ADDPRAM      AMTO                            E86108
     C                     Z-ADDPRAM      AMTO   130                      E86108
     C*                                                                   S01392
     C**  PAST-DUE AMOUNT SHOULD HANDLE DIFFERENTLY FOR EACH              S01392
     C**  CASE.                                                           S01392
     C*                                                                   S01392
     C           PTYP      IFEQ 63                                        S01392
     C                     SETON                     69                   S01392
     C   02NMR   AMTO      SUB  REBT      AMTO                            S01392
     C   02NMR   TAMT      SUB  REBT      TAMT                            S01392
     C   02NMR             Z-SUBREBT      INTA                            S01392
     C   03NMR                                                            S01392
     COR 02 MR             DO                                             S01392
     C           PRAM      ADD  INTA      AMTO                            S01392
     C                     END                                            S01392
     C                     END                                            S01392
     C           WNEWRC    IFEQ 'N'                                       157591
     C           PNORE     ADD  1         PNORE                           S01392
     C                     ENDIF                                          157591
     C           NNORE     ADD  1         NNORE                           S01392
     C                     Z-ADDNHASHF    ZZTOTI                          S01392
     C                     Z-ADDNHASHL    ZZTOTD                          S01392
     C           WNEWRC    IFEQ 'N'                                                         BUG27199
     C                     MOVE TAMT      ZZAMT        20                 S01392
     C   20                Z-SUBZZAMT     ZZAMT                           S01392
     C                     ELSE                                                             BUG27199
     C                     MOVE WTAMT     ZZAMT        20                                   BUG27199
     C   20                Z-SUBWTAMT     ZZAMT                                             BUG27199
     C                     ENDIF                                                            BUG27199
     C                     EXSR GLZADD                                    S01392
     C                     Z-ADDZZTOTI    NHASHF                          S01392
     C                     Z-ADDZZTOTD    NHASHL                          S01392
0580 C                     ENDSR
0581 C*                                                                  *
0582 C********************************************************************
0583 C********************************************************************
0584 C*                                                                  *
0585 C*    PDUESR SR. TO DETERMINE IF P/DUE NOTICES ARE DUE              *
0586 C*                                                                  *
0587 C*            ROUTINE CALLED FROM - MAIN PROCESSING
0588 C*
0589 C           PDUESR    BEGSR                           ** PDUESR BEGSR
0590 C**
0591 C**   SET UP INDEX ACCORDING TO FIRST BIT SETTING OFF
0592 C**
0593 C                     Z-ADD0         Y       10
0594 C                     TESTB'0'       PDNI       35
0595 C   35                Z-ADD1         Y
0596 C   35                GOTO PTAG
0597 C**
0598 C                     TESTB'1'       PDNI       35
0599 C   35                Z-ADD2         Y
0600 C   35                GOTO PTAG
0601 C**
0602 C                     TESTB'2'       PDNI       35
0603 C   35                Z-ADD3         Y
0604 C   35                GOTO PTAG
0605 C**
0606 C                     TESTB'3'       PDNI       35
0607 C   35                Z-ADD4         Y
0608 C   35                GOTO PTAG
0609 C**
0610 C                     TESTB'4'       PDNI       35
0611 C   35                Z-ADD5         Y
0612 C   35                GOTO PTAG
0613 C**
0614 C                     TESTB'5'       PDNI       35
0615 C   35                Z-ADD6         Y
0616 C   35                GOTO PTAG
0617 C**
0618 C                     TESTB'6'       PDNI       35
0619 C   35                Z-ADD7         Y
0620 C   35                GOTO PTAG
0621 C**
0622 C                     TESTB'7'       PDNI       35
0623 C   35                Z-ADD8         Y
0624 C**
0625 C           PTAG      TAG                             ** PTAG TAG ***
0626 C**
0627 C**   CHECK VALUE DATE AGAINST RELEVANT PAST DUE DATE
0628 C**
0629 C           Y         COMP 0                        35
0630 C  N35      Y         COMP 8                    35
0631 C   35                GOTO PEND
0632 C**
     C/COPY WNCPYSRC,LE0440C006
0633 C           VDAT      COMP PDAT,Y                 3535
0634 C   35                SETON                     47
0635 C  N35                GOTO PEND
0636 C**
0637 C           Y         COMP 2                      6162
0638 C           Y         COMP 3                        63
0639 C           Y         COMP 4                        64
0640 C           Y         COMP 5                        65
0641 C           Y         COMP 6                        66
0642 C           Y         COMP 7                    68  67
0643 C**
0644 C**   SET ON RELEVANT BIT SETTINGS
0645 C**
0646 C   61                BITON'0'       PDNI
0647 C   62                BITON'1'       PDNI
0648 C   63                BITON'2'       PDNI
0649 C   64                BITON'3'       PDNI
0650 C   65                BITON'4'       PDNI
0651 C   66                BITON'5'       PDNI
0652 C   67                BITON'6'       PDNI
0653 C   68                BITON'7'       PDNI
0654 C**
0655 C   61                BITON'0'       PDBI
0656 C   62                BITON'1'       PDBI
0657 C   63                BITON'2'       PDBI
0658 C   64                BITON'3'       PDBI
0659 C   65                BITON'4'       PDBI
0660 C   66                BITON'5'       PDBI
0661 C   67                BITON'6'       PDBI
0662 C   68                BITON'7'       PDBI
0663 C**
0664 C           Y         ADD  1         Y
     C/COPY WNCPYSRC,LE0440C007
0665 C                     GOTO PTAG
     C/COPY WNCPYSRC,LE0440C008
0666 C**
0667 C           PEND      ENDSR
0668 C*                                                                  *
0669 C********************************************************************
0670 C********************************************************************
0671 C*                                                                  *
0672 C*    CHECSQ SR. TO CHECK SEQUENCE IF NEW PD RECORD                 *
0673 C*    OUTPUT TO NLAMS.                                              *
      *    Also to ensure that PC Reference field is not left blank       213200
0674 C*                                                                  *
0675 C*            ROUTINE CALLED FROM - MAIN PROCESSING
0676 C           CHECSQ    BEGSR                           ** CHECSQ BEGSR
0677 C**
      *                                                                   213200
      * ALLOCATE A PC REFERENCE (PCRF) IF NOT ALREADY DONE                213200
      *                                                                   213200
     C           PCRF      IFEQ *BLANK                                    213200
     C**                                                                  213200
     C*    GET BRANCH DETAILS TO IDENTIFY CODE TO BE USED IN FIRST 3      213200
     C*    CHARACTERS OF THE NEW PCRF                                     213200
     C**                                                                  213200
     C                     MOVELBRCA      ##KB                                                CSC042
     C                     EXSR ##CHKB                                                        CSC042
      * If branch is in the array then use the details                                        CSC042
     C           ##FIC     IFEQ 'Y'                        *** B10                            CSC042
     C                     EXSR ##SETB                                                        CSC042
     C                     ELSE                            *** X10                            CSC042
     C**********           CALL 'AOBRCHR0'                                             213200 CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       213200
     C                     PARM '*KEY   ' @OPTN   7                       213200
     C                     PARM BRCA      @DSNB   3                       213200
     C********** SDBRCH    PARM SDBRCH    DSFDY                                        213200 CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANKS                                   213200
     C                     MOVE *BLANKS   DBKEY                           213200
     C                     MOVEL@DSNB     DBKEY                           213200
     C                     MOVEL'SDBRCHPD'DBFILE           ************   213200
     C                     Z-ADD9         DBASE            * DBASE 09 *   213200
     C                     SETON                     U7U8LR************   213200
     C                     GOTO END                                       213200
     C                     ELSE                                                               CSC042
      * Details found on the DB so add them to the array                                      CSC042
      * if the array still has room                                                           CSC042
     C                     EXSR ##ADDB                                                        CSC042
     C                     END                                            213200
     C                     END                             *** E10                            CSC042
      *                                                                                       CSC042
     C********** *LOCK     IN   LEALLO                                                 213200 CLE148
     C********** PCLAST    ADD  1         PCNEXT  80                                   213200 CLE148
     C                     CALL 'LEALLO'                                                      CLE148
     C                     PARM *BLANKS   PRTCD                                               CLE148
     C                     PARM 'Y'       PUPDT   1                                           CLE148
     C                     PARM *BLANKS   PCLAST                                              CLE148
     C                     PARM *BLANKS   PCNEXT  8                                           CLE148
      *                                                                                       CLE148
     C           A8MQSM    IFNE *BLANKS                                   213200
     C                     MOVELA8MQSM    W1ST11 11                       213200
     C                     ELSE                                           213200
     C                     MOVELA8BRCD    W1ST11                          213200
     C                     ENDIF                                          213200
     C********** CLE106    IFNE 'Y'                                                    CLE106 CLE148
     C**********           MOVEL'9'       PCNEXT                                       213200 CLE148
     C**********           ENDIF                                                       CLE106 CLE148
     C                     MOVE PCNEXT    W1ST11                          213200
     C                     MOVELW1ST11    PCRF                            213200
     C                     MOVE '0001'    PCRF                            213200
     C**********           Z-ADDPCNEXT    PCLAST                                       213200 CLE148
     C**********           OUT  LEALLO                                                 213200 CLE148
     C                     ENDIF                                          213200
      *                                                                   213200
0678 C           LASN      COMP 999                      35
0679 C  N35                GOTO CHEND
0680 C**
0681 C           LNRF      COMP LNRFS                3535
0682 C  N35      VDAT      COMP VDATS                3535
0683 C   35                Z-ADD1         LASN
0684 C  N35      LASNS     ADD  1         LASN
0685 C**
     C/COPY WNCPYSRC,LE0440CP14                                           S01408
0686 C           CHEND     ENDSR                           ** CHEND ENDSR
     C/COPY WNCPYSRC,LE0440CP13                                           S01408
0687 C*                                                                  *
0688 C********************************************************************
      /EJECT
     C/COPY ZSRSRC,ZDATE2Z4
      /EJECT
0779 C********************************************************************
      /EJECT                                                                                  CSC042
     C********************************************************************                    CSC042
      *                                                                                       CSC042
      * ##CHKB - Subroutine to check the Branch in the arrays                                 CSC042
      *                                                                                       CSC042
     C           ##CHKB    BEGSR                                                              CSC042
      *                                                                                       CSC042
     C           *LIKE     DEFN A8BRCD    ##KB                                                CSC042
      *                                                                                       CSC042
      * Set off the branch found indicator                                                    CSC042
     C                     MOVEL*BLANK    ##FIC   1                                           CSC042
      *                                                                                       CSC042
      * Save the state of indicator 30 so it can be reset at the end                          CSC042
      * of the SR as it may be used elsewhere in the code                                     CSC042
     C           *IN30     IFEQ *ON                                                           CSC042
     C                     MOVEL'Y'       #IN30   1                                           CSC042
     C                     ELSE                                                               CSC042
     C                     MOVEL'N'       #IN30                                               CSC042
     C                     END                                                                CSC042
      *                                                                                       CSC042
     C                     SETOF                         30                                   CSC042
      *                                                                                       CSC042
      * Restore the saved Value of B                                                          CSC042
     C                     Z-ADD##BSV     B                                                   CSC042
      *                                                                                       CSC042
     C* Check whether details for Branch already in array                                     CSC042
      *                                                                                       CSC042
      * Is this the same as the last LOKUP, if so we can bypass                               CSC042
      * the LOKUP                                                                             CSC042
      * Defend against B being 0                                                              CSC042
     C           B         IFEQ 0                                                             CSC042
     C                     Z-ADD1         B                                                   CSC042
     C                     END                                                                CSC042
      *                                                                                       CSC042
      * If the branch being checked is the same then use these                                CSC042
      * details rather than doing a LOKUP                                                     CSC042
     C           ##KB      IFEQ ##BR,B                                                        CSC042
      * Found so seton 30                                                                     CSC042
     C                     SETON                         30                                   CSC042
     C                     ELSE                                                               CSC042
     C                     Z-ADD1         B                                                   CSC042
     C           ##KB      LOKUP##BR,B                   30                                   CSC042
     C                     END                                                                CSC042
      *                                                                                       CSC042
      * Save the last update to B                                                             CSC042
     C           *IN30     IFEQ *ON                                                           CSC042
     C                     Z-ADDB         ##BSV                                               CSC042
      * Set the indicator to show the data was found                                          CSC042
     C                     MOVEL'Y'       ##FIC                                               CSC042
     C                     END                                                                CSC042
      *                                                                                       CSC042
      * Reset the state of indicator 30.                                                      CSC042
     C           #IN30     IFEQ 'Y'                                                           CSC042
     C                     MOVEL*ON       *IN30                                               CSC042
     C                     ELSE                                                               CSC042
     C                     MOVEL*OFF      *IN30                                               CSC042
     C                     END                                                                CSC042
      *                                                                                       CSC042
     C                     ENDSR                                                              CSC042
      ********************************************************************                    CSC042
      /EJECT                                                                                  CSC042
      ********************************************************************                    CSC042
      *                                                                                       CSC042
      * ##SETB - Sets up the SDBRCHPD fields used in the code from the                        CSC042
      * arrays                                                                                CSC042
      *                                                                                       CSC042
     C           ##SETB    BEGSR                                                              CSC042
      *                                                                                       CSC042
     C                     MOVEL##BR,B    A8BRCD                                              CSC042
     C                     MOVEL##BN,B    BRNM                                                CSC042
     C                     MOVEL##BM,B    A8MQSM                                              CSC042
      *                                                                                       CSC042
     C                     ENDSR                                                              CSC042
      *                                                                                       CSC042
      ********************************************************************                    CSC042
      /EJECT                                                                                  CSC042
      ********************************************************************                    CSC042
      *                                                                                       CSC042
      * ##ADDB - Adds the SDBRCHPD fields used in the code to the                             CSC042
      * arrays                                                                                CSC042
      *                                                                                       CSC042
     C           ##ADDB    BEGSR                                                              CSC042
      *                                                                                       CSC042
      * If there is still room in the array then add the details                              CSC042
     C           ##BNDX    IFLT 999                                                           CSC042
     C                     ADD  1         ##BNDX                                              CSC042
     C                     Z-ADD##BNDX    B                                                   CSC042
     C                     MOVELA8BRCD    ##BR,B                                              CSC042
     C                     MOVELBRNM      ##BN,B                                              CSC042
     C                     MOVELA8MQSM    ##BM,B                                              CSC042
     C                     END                                                                CSC042
      *                                                                                       CSC042
      * Update ##BSV  so next call to ##CHKB checks this latest adddition                     CSC042
      * to the array firss                                                                    CSC042
     C                     Z-ADDB         ##BSV                                               CSC042
      *                                                                                       CSC042
     C                     ENDSR                                                              CSC042
      ********************************************************************                    CSC042
      /EJECT                                                                                  CSC042
0780 C* SUBROUTINE TO ADD AN AMOUNT (ZZAMT) TO THE TOTAL (ZZTOTI,ZZTOTD)
0781 C*   IND '99' IS SET BY AN OVERFLOW ERROR
0782 C*
0783 CSR         GLZADD    BEGSR                           *** GLZADD ****
0784 C*
0785 CSR                   Z-ADDZZAMT     ZZAMT  153     91-DEFINE ZZAMT
0786 CSR 91                GOTO ZZAEND                     AMT = 0.BYPASS
0787 C*
0788 C* SPLIT ZZAMT INTO INTEGER AND DECIMAL FIELDS
0789 CSR                   Z-ADDZZAMT     ZZAMTI 150       INTEGER FIELD
0790 CSR                   MOVE ZZAMT     ZZAMTD  30       DECIMAL FIELD
0791 C* BOTH ZZAMTI AND ZZAMTD CONTAIN A 'SIGN' ZONE NOW
0792 C*
0793 CSR                   EXSR GLZSUM
0794 CSR         ZZAEND    ENDSR                           ** ZZAEND TAG *
0795 C*
0796 C********************************************************************
0797 C********************************************************************
0798 C* SUBROUTINE TO CARRY OUT THE ADDITION FOR SUBROUTINES -
0799 C*                        GLZADD, GLZSUB, GLZCMP.
0800 C*          PARAMETERS PASSED -
0801 C*                     I/P ZZAMTI ZZAMTD
0802 C*                     O/P ZZTOTI ZZTOTD ZZNEGD IND 96 IND 99.
0803 C*
0804 CSR         GLZSUM    BEGSR                           *** GLZSUM ****
0805 C*
0806 CSR                   Z-ADDZZTOTI    ZZTOTI 150       DEFINE ZZTOTI
0807 CSR                   Z-ADDZZTOTD    ZZTOTD  30       DEFINE ZZTOTD
0808 CSR                   SETOF                     919293
0809 CSR                   SETOF                     949599
0810 C*
0811 C*    DETERMINE SIGN OF ZZAMTI & D,   92 IF NEG
0812 CSR         ZZAMTI    COMP 0                      9293
0813 CSR 93      ZZAMTD    COMP 0                      9293
0814 CSR 93                GOTO ZZSEND                     ZERO BYPASS
0815 C*
0816 C*    DETERMINE SIGN OF ZZTOTI & D, 91 IF NEG.
0817 CSR         ZZTOTI    COMP 0                      9193
0818 CSR 93      ZZTOTD    COMP 0                      9193
0819 C*
0820 C*    IF ZZTOTAL IS ZERO, RETURN ZZAMOUNT.
0821 CSR 93                Z-ADDZZAMTI    ZZTOTI
0822 CSR 93                Z-ADDZZAMTD    ZZTOTD
0823 CSR 93                GOTO ZZSEND                     ZERO BYPASS
0824 C*    IF SIGNS DIFFER BYPASS OVERFLOW CHECKS.
0825 CSR 91N92
0826 CORN91 92             GOTO ZZOFPS
0827 C*
0828 CSR         ZZAMTD    ADD  ZZTOTD    ZZWK2   40
0829 CSR         ZZWK2     COMP 999                  93    '93' = CARRY
0830 CSRN93      ZZWK2     COMP -999                   93    INTO INTEGER.
0831 C*
0832 CSR 93N92   ZZAMTI    ADD  1         ZZWK3  150       ADD 'CARRY' +VE
0833 CSR    93 92ZZAMTI    SUB  1         ZZWK3            SUB 'CARRY' -VE
0834 CSR 93      ZZTOTI    ADD  ZZWK3     ZZWK3
0835 CSRN93      ZZTOTI    ADD  ZZAMTI    ZZWK3
0836 C*
0837 C* IF THE MODULUS OF ZZWK3 IS LT MOD. ZZTOTI THEN O/F HAS OCCURED
0838 CSRN92      ZZWK3     COMP ZZTOTI                 99  -92 MEANS NOS.
0839 CSR 92      ZZWK3     COMP ZZTOTI               99     NEGATIVE
0840 CSRN99                Z-ADDZZWK2     ZZTOTD
0841 CSRN99                Z-ADDZZWK3     ZZTOTI
0842 C*
0843 C* IF O/F ZEROIZE ZZAMT , IND '99' SET AND ZZTOT FIELDS LEFT INTACT.
0844 CSR 99                Z-ADD0         ZZAMT  153
0845 CSR                   GOTO ZZSEND
0846 C*
0847 C* THE 'SIGNS' ARE DIFFERENT
0848 CSR         ZZOFPS    TAG                             ** ZZOFPS TAG**
0849 C* IF ZZAMT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZTOT
0850 C*
0851 CSR 92                Z-SUBZZAMTI    ZZAMTI 150
0852 CSR 92                Z-SUBZZAMTD    ZZAMTD  30
0853 C*
0854 C* IF ZZTOT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZAMT.
0855 C*
0856 CSR 91                Z-SUBZZTOTI    ZZTOTI
0857 CSR 91                Z-SUBZZTOTD    ZZTOTD
0858 C* BOTH ZZAMT AND ZZTOT ARE NOW POSITIVE.
0859 C*
0860 CSR         ZZTOTI    COMP ZZAMTI               93  95
0861 CSR 95      ZZTOTD    COMP ZZAMTD               93  95
0862 C*
0863 C* IF ZZTOT EQ. ZZAMT RETURN ZERO.
0864 CSR 95                Z-ADD0         ZZTOTI
0865 CSR 95                Z-ADD0         ZZTOTD
0866 CSR 95                GOTO ZZSEND
0867 C*
0868 C* IF ZZTOT GT. ZZAMT.
0869 CSR 93      ZZAMTD    COMP ZZTOTD               94
0870 CSR 93 94   ZZTOTI    SUB  1         ZZTOTI
0871 CSR 93 94   ZZTOTD    ADD  1000      ZZWK2
0872 CSR 93      ZZTOTI    SUB  ZZAMTI    ZZTOTI
0873 CSR 93 94   ZZWK2     SUB  ZZAMTD    ZZTOTD
0874 CSR 93N94   ZZTOTD    SUB  ZZAMTD    ZZTOTD
0875 C*
0876 C*
0877 C* IF ZZAMT GT. ZZTOT.
0878 CSRN93      ZZTOTD    COMP ZZAMTD               94
0879 CSRN93 94   ZZAMTI    SUB  1         ZZWK3  150
0880 CSRN93 94   ZZAMTD    ADD  1000      ZZWK2
0881 CSRN93 94   ZZWK3     SUB  ZZTOTI    ZZTOTI
0882 CSRN93N94   ZZAMTI    SUB  ZZTOTI    ZZTOTI
0883 CSRN93 94   ZZWK2     SUB  ZZTOTD    ZZTOTD
0884 CSRN93N94   ZZAMTD    SUB  ZZTOTD    ZZTOTD
0885 C*
0886 C* REVERSE SIGN OF ZZTOT IF LARGER I/P FIELDS WERE NEGATIVE
0887 CSR                   SETOF                     94
0888 CSR 93 91
0889 CORN93 92             SETON                     94
0890 CSR 94                Z-SUBZZTOTI    ZZTOTI
0891 CSR 94                Z-SUBZZTOTD    ZZTOTD
0892 C**
0893 C**   RESTORE SIGN OF ZZAMTI & ZZAMTD IF IT WAS REVERSED.
0894 CSR 92                Z-SUBZZAMTI    ZZAMTI
0895 CSR 92                Z-SUBZZAMTD    ZZAMTD
0896 CSR         ZZSEND    TAG                             ** ZZSEND TAG *
0897 C**
0898 C**   IF ZZTOTD IS ZERO, AND ZZTOTI IS NEG. SET UP ZZNEGD.
0899 CSR                   SETOF                     96
0900 CSR         ZZTOTD    COMP 0                        91
0901 CSR 91      ZZTOTI    COMP 0                      96
0902 CSR 96                MOVE '.000-'   ZZNEGD  5
0903 CSR                   ENDSR                             ** ENDSR **
0904 C********************************************************************
0905 C********************************************************************
0906 C**
0907 C**   ZSYSTM SR. TO CHAIN TO THE INSTALLATION CONTROL DATA RECORD.
0908 C**
0909 C           ZSYSTM    BEGSR                           *** ZSYSTM ***
0910 C**************                                                      S01194
0911 C*****SET*UP*KEY FOR INSTALLATION CONTROL RECORD.                    S01194
0912 C**************       MOVEL'01      'ZTABKY 12                       S01194
0913 C**************       MOVE '  10'    ZTABKY                          S01194
0914 C**************                                                      S01194
0915 C***********ZTABKY    CHAINTABLE                99    ON NOT THERE   S01194
0916 C**N99******RECI      COMP 'D'                  9999  ON, IS DELETED S01194
     C**                                                                  S01194
     C**   ACCESS BANK DETAILS                                            S01194
     C**                                                                  S01194
     C                     CALL 'AOBANKR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDBANK    PARM SDBANK    DSFDY                           S01194
     C*                                                                   S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     SETON                     U7U8LR               S01194
     C                     SETON                     99                   S01194
     C                     MOVEL'SDBANKPD'DBFILE           ***************S01194
     C                     MOVEL@OPTN     DBKEY            * DBERROR 001 *S01194
     C                     Z-ADD1         DBASE            ***************S01194
     C                     ELSE                                           S01194
0917 C**
0918 C**   CHECK SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.
0919 C           DATF      COMP 'M'                      98MMDDYY, 98 ON
0920 C**
     C                     END                                            S01194
      *                                                                                      242385A
      ** CHECK SYSTEM VALUE: Zeroise Principal Past Due Amount for                           242385A
      ** Guaranteed or Risk Loan (Processing Type 70) ?                                      242385A
      ** Set up AOSVALR0 parameter with GISVAL "ZeroPastDueRiskLoan"                         242385A
     C                     MOVE *BLANKS   WPARM                                              242385A
     C                     MOVEL'ZeroP'   WPARM1                                             242385A
     C                     MOVEL'astDu'   WPARM2                                             242385A
     C                     MOVEL'eRisk'   WPARM3                                             242385A
     C                     MOVEL'Loan'    WPARM4                                             242385A
     C                     MOVELWPARM     SVALK1                                             242385A
      * Call Access object:                                                                  242385A
     C                     CALL 'AOSVALR0'                                                   242385A
     C                     PARM           RTNCDE  7                                          242385A
     C                     PARM           SVALK1 20                                          242385A
     C                     PARM           SVAL1 200                                          242385A
     C                     PARM           SVALK2 20                                          242385A
     C                     PARM           SVAL2 200                                          242385A
     C                     PARM           SVALK3 20                                          242385A
     C                     PARM           SVAL3 200                                          242385A
     C                     PARM           SVALK4 20                                          242385A
     C                     PARM           SVAL4 200                                          242385A
     C                     PARM           SVALK5 20                                          242385A
     C                     PARM           SVAL5 200                                          242385A
     C                     PARM           SVALK6 20                                          242385A
     C                     PARM           SVAL6 200                                          242385A
     C                     PARM           SVALK7 20                                          242385A
     C                     PARM           SVAL7 200                                          242385A
     C                     PARM           SVALK8 20                                          242385A
     C                     PARM           SVAL8 200                                          242385A
     C                     PARM           SVALK9 20                                          242385A
     C                     PARM           SVAL9 200                                          242385A
     C                     PARM           SVALK0 20                                          242385A
     C                     PARM           SVAL10200                                          242385A
      **If*the*system*value*is*not*found*then*issue*a*database*error****              242385A 248570
     C           RTNCDE    IFNE '        '                                                   242385A
     C**********           SETON                     U7U8LR                           242385A 248570
     C**********           MOVEL'SDSVALPD'DBFILE           ************               242385A 248570
     C**********           Z-ADD12        DBASE            * DBERR 12 *               242385A 248570
     C**********           MOVEL'SVALK1'  DBKEY            ************               242385A 248570
     C**********           GOTO END                                                   242385A 248570
     C                     MOVE *BLANK    WRK01                                               248570
     C                     MOVE 'N'       PDZERO                                              248570
     C                     ELSE                                                              242385A
      * Isolate the first character of SVAL1 which = 'Y' or 'N'.                             242385A
     C                     MOVELSVAL1     WRK01   1        1 character fld                   242385A
     C           WRK01     IFEQ 'Y'                                                          242385A
     C                     MOVE 'Y'       PDZERO  1                                          242385A
     C                     ELSE                                                              242385A
     C                     MOVE 'N'       PDZERO                                             242385A
     C                     ENDIF                                                             242385A
     C                     ENDIF                                                             242385A
0921 C                     ENDSR
0922 C**
0924 C********************************************************************
     C/SPACE 3                                                            S01117
     C********************************************************************S01117
     C*                                                                   S01117
     C* SUBROUTINE : #ZZ                                                  S01117
     C*                                                                   S01117
     C* CALLED BY MAIN PROCESSING DURING TOTAL TIME CALCULATIONS IF       S01117
     C* THE P1 FILES HAVE NOT ALREADY BEEN OPENED (IE, IF THERE ARE       S01117
     C* NO RECORDS READ AND THEREFORE FILES OPENING NOT PERFORMED)        S01117
     C*                                                                   S01117
     C           #ZZ       BEGSR                                          S01117
     C*                                                                   S01117
     C** OPEN P1 SPOOL FILE                                               S01117
     C*                                                                   S01117
     C                     OPEN LE0440P1                                  S01117
     C**********           SETON                       4870         S01117BHF660
     C                     SETON                       70                 BHF660
     C*                                                                   S01117
     C** ENSURE REPORT SPOOL FILE RECORDED BY RCF                         S01117
     C**                                                                  S01117
     C                     Z-ADDSFNUM     ZSNUM   60                      S01117
     C                     OUT  LDA                                       S01117
     C*                                                                   S01117
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           SEQ                             S01117
     C                     PARM *BLANKS   SENTY   3                       S01117
     C                     PARM           SFILE                           S01117
     C                     PARM           ZSNUM                           S01117
     C                     PARM           ZSERR   1                       S01117
     C           *LOCK     IN   LDA                                       S01117
      **  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM       S01117
     C           ZSERR     IFEQ 'Y'                                       S01117
     C                     SETON                     U7U8LR               S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C                     Z-ADD0         DROP                            S01117
      *                                                                   CLE005
      ** Ensure P2 report spool file is recorded by RCF                   CLE005
      ** If error exists, return to calling program                       CLE005
      *                                                                   CLE005
     C           CLE005    IFEQ 'Y'                                       CLE005
     C                     OPEN LE0440P2                                  CLE005
     C                     Z-ADD*ZEROS    RNORE                           CLE005
      *                                                                   CLE005
     C                     Z-ADDSFNUM2    ZSNUM                           CLE005
     C                     OUT  LDA                                       CLE005
     C                     CALL 'ZSFILE'                                  CLE005
     C                     PARM           SEQ                             CLE005
     C                     PARM BRCA      SENTY                           CLE005
     C                     PARM           SFILE2                          CLE005
     C                     PARM           ZSNUM                           CLE005
     C                     PARM           ZSERR                           CLE005
     C           *LOCK     IN   LDA                                       CLE005
      *                                                                   CLE005
     C           ZSERR     IFEQ 'Y'                                       CLE005
     C                     SETON                     U7U8LR               CLE005
     C                     RETRN                                          CLE005
     C                     ENDIF                                          CLE005
      *                                                                   CLE005
     C                     WRITEHEADP2                                    CLE005
     C                     WRITENODTLP2                                   CLE005
     C                     ENDIF                                          CLE005
     C*                                                                   S01117
     C                     ENDSR                                          S01117
0340 C**                                                                  S01117
     C********************************************************************S01117
     C*                                                                   S01117
     C*  *PSSR --- SUBROUTINE TO HANDLE ABNORMAL ERROR CONDITIONS         S01117
     C*                                                                   S01117
     C*  CALLED FROM: AFTER ABNORMAL OPERATION OCCURS                     S01117
     C*                                                                   S01117
     C*  CALLS: NOTHING                                                   S01117
     C*                                                                   S01117
     C********************************************************************S01117
     C*                                                                   S01117
     C           *PSSR     BEGSR                           ** *PSSR **    S01117
     C*                                                                   S01117
     C           @RUN      IFEQ *BLANKS                                   S01117
     C                     MOVE 'Y'       @RUN    1                       S01117
     C                     DUMP                                           S01117
     C                     END                                            S01117
     C                     ENDSR                           ** *PSSR **    S01117
     C*                                                                   S01117
     C********************************************************************S01117
     C           RTVACC    BEGSR                                                            AR700107
      *                                                                                     AR700107
     C                     MOVE *BLANKS   WOSAC  18                                         AR700107
     C                     MOVE *BLANKS   WSETP   20                                        AR700107
      *                                                                                     AR700107
     C           PTYP      IFNE 66                                                          AR700107
     C           PTYP      ANDNE67                                                          AR700107
     C           PTYP      ANDNE69                                                          AR700107
     C           PTYP      ANDNE72                                                          AR700107
     C                     MOVE RONS      WOSAC                                             AR700107
     C                     MOVE RSTM      WSETP                                             AR700107
     C                     ELSE                                                             AR700107
     C                     MOVE PONS      WOSAC                                             AR700107
     C                     MOVE PSTM      WSETP                                             AR700107
     C                     ENDIF                                                            AR700107
      *                                                                                     AR700107
      ** Retrieve sett account and priority                                                 AR700107
      *                                                                                     AR700107
     C                     MOVE CNUM      ILCNUM  6                                         AR700107
     C                     CALL 'LE007054'                                                  AR700107
     C                     PARM CCY       CCYL    3                                         AR700107
     C                     PARM           ILCNUM                                            AR700107
     C                     PARM SCCY      KSCCY   3                                         AR700107
     C                     PARM           WOSAC                                             AR700107
     C                     PARM           WSETP                                             AR700107
     C                     PARM           OLNO                                              AR700107
     C                     PARM           OSBR    3                                         AR700107
      *                                                                                     AR700107
     C                     PARM *BLANKS   WBLCKD  1                                         AR700107
      *                                                                                     AR700107
     C                     ENDSR                                                            AR700107
      *****************************************************************                     AR700107
     C/EJECT                                                              S01117
      /COPY ZSRSRC,ZSEDITZ3                                               CLE005
      /EJECT                                                              CLE005
0925 O**
0926 O**   NLAMS- NEW LOAN AMENDMENTS FILE - HEADER
0927 O**
0928 O*LAMSDH H        48                                                 S01117
0928 ONLAMSDH E                HEADER                                     S01117
0929 O                                    1 'H'
0930 O                         ZERO5     18P
0931 O                         RUND     316P
0932 O                                  317 'I'
0933 O                         ZERO5    320P
0934 O**
0935 O*****DETAIL RECORD UNCHANGED FROM ACTN6 OR LAUPD                    S01117
0935 O**   DETAIL RECORD UNCHANGED FROM ACTN6L1 OR LAUPD                  S01117
0936 O**
0937 ONLAMSDK D        41
0938 O                         RECA     160
0939 O                         RECB     320
     O                 03      SCCY    1063                               CEU004
     O                 03      ICCY    1066                               CEU004
     O***********              RECC     949                        S01518 CAC001
     O                         RECC     969                               CAC001
0940 O                         LASN      15
     O**********               RECD    1060                                            CLE005 CLE028
     O**********               RECD    1075                                            CLE028 CLE031
     O**********               RECD    1108                                            CLE031 CLE034
     O**********               RECD    1109                                            CLE034 CAP075
     O**********               RECD    1176                                            CAP075 CLE036
     O                         RECD    1225                                                   CLE036
     O**********               RECE    1230                                            CGL029 CLE036
     O*************************RECE    1278                                            CLE036 CLE042
     O                         RECE    1291                                                   CLE042
0940 O                         LASN      15
     O                         PRAM      44P                              CLE005
     O                         INTA      51P                              CLE005
     O                         TAMT      72P                              CLE005
0941 O                                  228 '00000000'
0942 O                         PDNI     248
0943 O                                  252 '    '
     O                         LSWCC    258P                                                  235579
     O                         LSWSC    260P                                                  235579
     O                         LSMD     269P                                                  235579
     O                         REBT     276P                                                 244214A
0944 O                       43RUND     313P
0945 O                       42RUND     316P
0946 O                       43RUND     316P
0947 O                       42         317 'A'
0948 O                       43         317 'I'
0949 O                       43ZERO5    320P
     O                         RSTM     322                                                   246490
     O                         ROBN     383                                                  244214A
     O                         ROCN     389                                                  244214A
     O                         PSTM     391                                                  244214A
     O                         POBN     452                                                  244214A
     O                         POCN     458                                                  244214A
     O                         ROLN     983                                                  244214A
     O                         ROSN     986                                                  244214A
     O                         RORC     995                                                  244214A
     O                         PDGN     996                               CLE005
     O                         PNAM    1007P                                                 244214A
     O                                 1009 'A'                                              BUG9195
     O                         PCRF    1054                               213200
     O                         CHDU    1075P                                                 244214A
     O                         INTN    1082P                                                 244214A
     O                         FSPRAM  1089P                                                 244214A
     O                         REXR    1096P                                                 244214A
     O                         PEXR    1107P                                                 244214A
     O                         STAL    1109                                                   CLE034
     O                         FRNT    1129                                                   CAP075
     O                         AFRT    1149                                                   CAP075
     O                         REPA    1150                                                   CAP075
     O                         TMST    1176                                                   CAP075
     O                         FRAM    1241P                                                  246490
     O                         FINT    1248P                                                  246490
     O                         FTXA    1255P                                                  246490
     O                         FTOT    1262P                                                  246490
     O/COPY WNCPYSRC,LE0440O002
0950 O**
0951 O**   DETAIL RECORD - PAST DUE
0952 O**
0953 O        D        44
0954 O                                    1 'D'
0955 O                         LNRF       7
0956 O                         VDAT      12
0957 O                         LASN      15
0958 O                                   16 '2'
0959 O                         LTYP      18
0960 O                         SUTP      20
0961 O                         PTYP      22
     O/COPY WNCPYSRC,LE0440O001
0962 O                                   28 'PD0000'
0963 O                         ZERO11    34P
0964 O                         CCY       37
0965 O                         PRAM      44P
0966 O                         INTA      51P
0967 O                         WTXA      58P
0968 O                         ZERO13    65P
0969 O                         TAMT      72P
0970 O***********              BRCD      75                               S01117
0970 O                         BRCA      75                               S01117
0971 O                         CNUM      81
0972 O                         REPT      82
0973 O                                   83 'N'
0974 O                         SETP      86
0975 O**********               OSAC      98                                                   CGL029
     O                         OSACQQ    98                                                   CGL029
0976 O                         TSEN     108
0977 O                         LAIN     209
0978 O                         ZERO11   215P
0979 O                                  217 '0'
0980 O                         LLAG     219
0981 O                                  228 '00000000'
0982 O                         FCUS     234
0983 O                         FTYP     237
0984 O                         FSEQ     239
0985 O                                  247 '00000000'
0986 O                         PDNI     248
0987 O                         NACD     254
     O                         LSWCC    258P                                                  235579
     O                         LSWSC    260P                                                  235579
     O                         OSBR     263                               S01117
     O                         LSMD     269P                                                  235579
     O                         REBT     276P                                                 244214A
0988 O                         RUND     313P
0989 O                         RUND     316P
0990 O                                  317 'I'
     O                         ZERO5    320P
     O                         RSTM     322                                                 AR698840
     O                 72N73   SETP     322                               S01518
     O**********       72N73   OSAC     334                                            S01518 CGL029
     O                 72N73   OSACQQ   334                                                   CGL029
     O                 72N73   @TSEN    342                               S01518
     O                         ROBN     383                                                 BUG27358
     O                         ROCN     389                                                 BUG27358
     O                         PSTM     391                                                 BUG27358
     O                         POBN     452                                                 BUG27358
     O                         POCN     458                                                 BUG27358
     O                 72 73   SETP     391                               S01518
     O**********       72N73   OSAC     403                                            S01518 CGL029
     O                 72 73   OSACQQ   403                                                   CGL029
     O                 72 73   @TSEN    517                               S01518
     O                         ZERO11   955P                              CAC001
     O                                  956 ' '                           CAC001
     O                                  960 '    '                        CAC001
     O                         ZERO13   967P                              CAC001
     O                                  968 ' '                           CAC001
     O                                  969 ' '                           CAC001
     O                         ROLN     983                                                  244214A
     O                         ROSN     986                                                  244214A
     O                         RORC     995                                                  244214A
     O                         PDGN     996                               CLE005
     O                         PNAM    1007P                                                 244214A
     O                                 1009 'A'                                              BUG9195
     O                         PCRF    1054                               213200
     O**********               CHDU    1075                                            CLE028 217652
     O                         CHDU    1075P                                                  217652
     O                         INTN    1082P                                                 244214A
     O                         FSPRAM  1089P                                                 244214A
     O                         REXR    1096P                                                 244214A
     O                         PEXR    1107P                                                 244214A
     O                         STAL    1109                                                   CLE034
     O                         FRNT    1129                                                   CAP075
     O                         AFRT    1149                                                   CAP075
     O                         REPA    1150                                                   CAP075
     O                         TMST    1176                                                   CAP075
     O********                 OSAC    1177                                           CGL029 BUG4775
     O                 72N73   OSAC    1212                                                   CGL029
     O                 72 73   OSAC    1230                                                   CGL029
     O                         OSAC    1194                                                  BUG4775
     O*************************        1233 '   '                                      CLE036 CLE042
     O*************************ZERO13  1240P                                           CLE036 CLE042
     O*************************ZERO13  1247P                                           CLE036 CLE042
     O*************************ZERO13  1254P                                           CLE036 CLE042
     O*************************ZERO13  1261P                                           CLE036 CLE042
     O*************************ZERO13  1268P                                           CLE036 CLE042
     O                                 1234 '   '                                             CLE042
     O                         ZERO13  1241P                                                  CLE042
     O                         ZERO13  1248P                                                  CLE042
     O                         ZERO13  1255P                                                  CLE042
     O                         ZERO13  1262P                                                  CLE042
     O                         ZERO13  1269P                                                  CLE042
     O                         BASR    1275P                                                BUG27358
     O                         CLAS    1283                                                   CLE042
      *                                                                   CLE005
     ONLAMSDK E                NEWREC                                     CLE005
      ** New RE from PD/MA or new PD from MR                              CLE005
      *                                                                   CLE005
     O                         RECA     160                               CLE005
     O                         RECB     320                               CLE005
     O                         RECC     969                               CLE005
     O**********               RECD    1060                                            CLE005 CLE028
     O**********               RECD    1075                                            CLE028 CLE031
     O**********               RECD    1108                                            CLE031 CLE034
     O**********               RECD    1109                                            CLE034 CAP075
     O**********               RECD    1176                                            CAP075 CLE036
     O                         RECD    1225                                                   CLE036
     O**********               RECE    1230                                            CGL029 CLE036
     O*************************RECE    1278                                            CLE036 CLE042
     O                         RECE    1291                                                   CLE042
     O                         LASN      15                               CLE005
     O                N55                24 'RE'                          CLE005
     O                 55                24 'PD'                          CLE005
     O                 54      ZERO13    44P                              CLE005
     O                 53      ZERO13    51P                              CLE005
     O                 55      WPRAM     44P                              127718
     O                 55      WINTA     51P                              127718
     O                 55      WWTXA     58P                              127718
     O                         WTAMT     72P                              CLE005
     O                         LSWCC    258P                                                  235579
     O                         LSWSC    260P                                                  235579
     O                         LSMD     269P                                                  235579
     O                         REBT     276P                                                 244214A
     O                 43      RUND     313P                              CLE005
     O                 42      RUND     316P                              CLE005
     O                 43      RUND     316P                              CLE005
     O                 42               317 'A'                           CLE005
     O                 43               317 'I'                           CLE005
     O                 43      ZERO5    320P                              CLE005
     O                         RSTM     322                                                   246490
     O                         ROLN     983                                                  244214A
     O                         ROSN     986                                                  244214A
     O                         RORC     995                                                  244214A
     O                         PDGN     996                               CLE005
     O                 55               996 'N'                           CLE005
     O                         PNAM    1007P                                                 244214A
     O                                 1009 'A'                                              BUG9195
     O                         PCRF    1054                               216543
     O                         CHDU    1075P                                                 244214A
     O                         INTN    1082P                                                 244214A
     O                         FSPRAM  1089P                                                 244214A
     O                         REXR    1096P                                                 244214A
     O                         PEXR    1107P                                                 244214A
     O***********              STAL    1109                                           CLE034 BUG9021
     O                                 1109 'N'                                              BUG9021
     O                         FRNT    1129                                                   CAP075
     O                         AFRT    1149                                                   CAP075
     O                         REPA    1150                                                   CAP075
     O                         TMST    1176                                                   CAP075
     O**********       55      WFRAM   1240P                                           CLE036 246490
     O**********       55      WFINT   1247P                                           CLE036 246490
     O**********       55      WFTXA   1254P                                           CLE036 246490
     O**********       55      WFTOT   1261P                                           CLE036 246490
     O                 55      FRAM    1241P                                                  246490
     O                 55      FINT    1248P                                                  246490
     O                 55      FTXA    1255P                                                  246490
     O                 55      FTOT    1262P                                                  246490
      *                                                                                       258399
     ONLAMSQD D        41                                                                     258399
     O       OR        44                                                                     258399
     O                         LNRF       6                                                   258399
     O                         VDAT      11                                                   258399
     O                         LASN      14                                                   258399
     O                         BRCA      17                                                   258399
      *                                                                                       258399
     ONLAMSQD E                NRECQD                                                         258399
     O                         LNRF       6                                                   258399
     O                         VDAT      11                                                   258399
     O                         LASN      14                                                   258399
     O                         BRCA      17                                                   258399
      *                                                                                       258399
     O/COPY WNCPYSRC,LE0440O003
0992 O**
0992 O**
0993 O**   TRAILER
0994 O**
0995 ONLAMSZ1 T        LRNU7
0996 O                                    1 'T'
0997 O                                   15 '99999999999999'
0998 O                         NNORE     19P
0999 O                         NNLRA     25P
1000 O                         ZERO5     28P
1001 O                         ZERO5     31P
1002 O                         NNLRA     34P
1003 O                         NHASHF    42P
1004 O                         NHASHL    44P
1005 O                         ZERO15    52P
1006 O                         ZERO3     54P
1007 O                         ZERO15    62P
1008 O                         ZERO3     64P
1009 O                         ZERO15    72P
1010 O                         ZERO3     74P
1011 O                         NHASHF    82P
1012 O                         NHASHL    84P
1013 O                         RUND     316P
1014 O                                  317 'I'
1015 O                         ZERO5    320P
1016 O**
1017 O**   PDUE - PAST DUE FILE
1018 O**
1019 O*DUEHH  H        48                                                 S01117
1019 OPDUEHH  E                HEADER                                     S01117
1020 O                                    1 'H'
1021 OPDUEDU  D        45
1022 O                                    1 'D'
1023 O                         LNRF       7
1024 O                         VDAT      12
1025 O                         LASN      15
1026 O***********              BRCD      18                               S01117
1026 O                         BRCA      18                               S01117
1027 O                         CCY       21
1028 O                         CNUM      27
     O                    83   OLNO      27                               S01260
1029 O                         AMTO      34P
1030 O                         REPT      35
1031 O                       47          36 'Y'
1032 O                         NACD      37
1033 O                         PDBI      38
1034 O**********               INTA      45P                                                  CLE028
     O                N38      INTA      45P                                                  CLE028
     O                 38      WINTA0    45P                                                  CLE028
     O                       69ZERO13    45P                              S01392
1035 O                         WTIN      46
1036 O                         WTXA      53P
1036 O                         PTYP      55
1042 O**
1037 OPDUEZX  T        LRNU7
1038 O                                    1 'T'
1039 O                         PNORE      4P
1040 O**
1041 O**   PAST DUE REPAYMENTS REPORT
1042 O**
     OLE0440P1H   03   48
1044 O       OR        OF
1045 O***********                        22 'REFERENCE LE0440'            S01117
1045 O                                   24 'REFERENCE LE0440P1'          S01117
1046 O                         TITL      89
1047 O                                  104 'DATE'
1048 O                         RUNA     112
1049 O                                  122 'PAGE'
1050 O                         PAGE  3  127
1051 O        H   05   48
1052 O       OR        OF
1053 O***********                        76 'PAST DUE REPAYMENTS DROP'    155572
1054 O***********                        79 'PED'                         155572
     O                                   74 'REPAYMENTS DROPPED'          155572
0421 O                    33             90 'BRANCH'                      S01117
0422 O                    33   BRCA      94                               S01117
     O                    33             95 '-'                           S01117
     O                    33   BRNM     125                               S01117
1055 O        H   06   48                                                 S01117
1056 O       OR        OF                                                 S01117
1057 O***********                        76 '------------------------'    155572
1058 O***********                        79 '---'                         155572
     O                                   74 '------------------'          155572
1059 O        H   09   48
1060 O       OR        OF
1061 O                                   27 'LOAN NO.'
1062 O                                   59 'VALUE DATE'
1063 O                                   86 'SEQUENCE'
1064 O                                  114 'NARRATIVE'
1065 O********D  2     49                                                 BHF067
     O        D 2      49                                                 BHF067
1066 O                         LNRF      26
1067 O                         AVDAT     57
1068 O                         LASN      83
1069 O                      N50         113 'MATURED'
1070 O                       50         112 'REPAID'
     O                       08         113 'REVERSE'                     180044
     O                       08         114 'D'                           180044
     O        T   03   L4 70                                              S01117
1045 O                                   24 'REFERENCE LE0440P1'          S01117
1046 O                         TITL      89                               S01117
1047 O                                  104 'DATE'                        S01117
1048 O                         RUNA     112                               S01117
1049 O                                  122 'PAGE'                        S01117
1050 O                         PAGE  3  127                               S01117
1051 O        T   05   L4 70                                              S01117
1053 O***********                      76 'PAST DUE REPAYMENTS DROP'S01117155572
1054 O***********                        79 'PED'                   S01117155572
     O                                   74 'REPAYMENTS DROPPED'          155572
0421 O***********                        90 'BRANCH'                S01117BHF660
0422 O***********         33   BRCA      94                         S01117BHF660
     O***********         33             95 '-'                     S01117BHF660
     O***********         33   BRNM     125                         S01117BHF660
1055 O        T   06   L4 70                                              S01117
1057 O***********                      76 '------------------------'S01117155572
1058 O***********                        79 '---'                   S01117155572
     O                                   74 '------------------'          155572
1059 O********T**209   L4 70                                        S01117BHF660
1061 O***********                        27 'LOAN NO.'              S01117BHF660
1062 O***********                        59 'VALUE DATE'            S01117BHF660
1063 O***********                        86 'SEQUENCE'              S01117BHF660
1064 O***********                       114 'NARRATIVE'             S01117BHF660
1071 O********T*2      LR                                                 S01117
1071 O        T 2      L4 70                                              S01117
1071 O       OR        L4 71                                              BHF660
1072 O***********                        43 'TOTAL OF PAST DUE REPAYM'    155572
     O                                   43 'TOTAL OF REPAYM'             155572
1073 O                                   55 'ENTS DROPPED'
1074 O                         DROP  3   62
1075 O********T*32     LR U7                                              S01117
1075 O        T 32     L4 U7 70                                           S01117
     O                                   71 'DATABASE IN ERROR'           S01117
1076 O***********                        51 'REFERENCE LE0440'            S01117
1077 O***********                        71 'DATABASE ERROR AT'           S01117
1078 O***********              DBASE     74                               S01117
1079 O********T**      LR U7                                              S01117
1080 O***********                        37 'FILENAME'                    S01117
1081 O***********              DBFILE    43                               S01117
1082 O***********                        48 'KEY'                         S01117
1083 O***********              DBKEY     78                               S01117
     O*LE0440P1T*3      L4 33 70                                    S01117BHF660
     O        T 3      L4 33 71                                           BHF660
     O                                   66 '*** END OF REPORT FOR'       S01117
     O                                   74 ' BRANCH '                    S01117
     O                         BRCA      77                               S01117
     O                                   81 ' ***'                        S01117
     O********T*3      LRN33 70                                     S01117BHF660
     O        T 3      LRN33                                              BHF660
     O       OR        LR 33 70                                           BHF660
     O                                   76 '*** END OF REPORT ***'       S01117
1084 O**
1085 O**   CONTROL REPORT
1086 O**
     O*E0440AUT**                                                         S01117
1087 O********T** 03   LR                                                 S01117
1087 OLE0440AUT   03   LR                                                 S01117
1088 O***********                        22 'REFERENCE LE0440'            S01117
1088 O                                   24 'REFERENCE LE0440AU'          S01117
1089 O                         TITL      89
1090 O                                  104 'DATE'
1091 O                         RUNA     112
1092 O                                  127 'PAGE    1'
1093 O        T 2      LR
1094 O                                   66 'LOAN AMENDMENTS PHASE II'
1095 O                                   89 'UPDATE - FILE CONTROLS'
1096 O        T 1      LR
1097 O                                   66 '------------------------'
1098 O                                   89 '-----------------------'
1099 O        T 3      LR
1100 O                                   28 'S/LAUPD - RUN CONTROLS'
1101 O                                   59 'NUMBER'
1102 O                                   84 'VALUE'
1103 O        T 1      LR
1104 O                                   28 '----------------------'
1105 O                                   59 'OF RECORDS'
1106 O                                   84 'OF RECORDS'
1107 O        T 2      LR
1108 O                                   29 'TOTAL RECORDS ON FILE'
1109 O                      NU7NOREL 3   59
1110 O                      NU7VRRF  4   81
1111 O                      NU7VRRL      84
1112 O        T 2      LR
1113 O                                   29 'TOTAL RECORDS ON FILE'
1114 O                                   42 '- CALCULATED'
1115 O                         LNORE 3   59
1116 O                         LHASHF4   81
1117 O                         LHASHL    84
1118 O                       51         111 '***   DIFFERENCE   ***'
1119 O        T 3      LR
1120 O***********                        28 'S/ACTN6 - RUN CONTROLS'      S01117
1120 O                                   30 'S/ACTN6L1 - RUN CONTROLS'    S01117
1121 O        T 1      LR
1122 O***********                        28 '----------------------'      S01117
     O                                   30 '------------------------'    S01117
1123 O        T 2      LR
1124 O                                   29 'TOTAL RECORDS ON FILE'
1125 O                      NU7NOREA 3   59
1126 O        T 2      LR
1127 O                                   29 'TOTAL RECORDS ON FILE'
1128 O                                   42 '- CALCULATED'
1129 O                         ANORE 3   59
1130 O                       52         111 '***   DIFFERENCE   ***'
1131 O        T 3      LR
1132 O                                   28 'S/NLAMS - RUN CONTROLS'
1133 O        T 1      LR
1134 O                                   28 '----------------------'
1135 O        T 2      LR
1136 O                                   29 'TOTAL RECORDS ON FILE'
1137 O                         NNORE 3   59
1138 O                         NHASHF4   81
1139 O                         NHASHL    84
1140 O        T 3      LR
1141 O                                   28 'S/PDUE  - RUN CONTROLS'
1142 O        T 1      LR
1143 O                                   28 '----------------------'
1144 O        T 2      LR
1145 O                                   29 'TOTAL RECORDS ON FILE'
1146 O                         PNORE 3   59
     O        T 3      LR 21                                              CLE005
     O                                   28 'S/LKEY3 - RUN CONTROLS'      CLE005
     O        T 1      LR 21                                              CLE005
     O                                   28 '----------------------'      CLE005
     O        T 2      LR 21                                              CLE005
     O                                   29 'TOTAL RECORDS ON FILE'       CLE005
     O                         NORE  3   59                               CLE005
     O                         VLRF  4   81                               CLE005
     O                         VLRL      84                               CLE005
1075 O        T 32     LR U7                                              S01117
1076 O                                   51 'REFERENCE LE0440'            S01117
1077 O                                   71 'DATABASE ERROR AT'           S01117
1078 O                         DBASE     75                               S01117
1079 O        T        LR U7                                              S01117
1080 O                                   37 'FILENAME'                    S01117
1081 O                         DBFILE    48                               S01117
1082 O                                   52 'KEY'                         S01117
1083 O                         DBKEY     82                               S01117
1147 O********T*3      LR                                                 S01117
1148 O***********                        76 '*** END OF REPORT ***'       S01117
1084 O**                                                                  S01117
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
** STAMP - Dummy timestamp                                                                    CPK015
0001-01-01-00.00.00.000000                                                                    CPK015
** CPY@   **      OBJECT COPYRIGHT
(c) Misys International Banking Systems Ltd. 2001
