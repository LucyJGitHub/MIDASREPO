     H DEBUG DFTNAME(S01117)
      *****************************************************************
/*S******RPGBASE*******************************************************                       CLE134
/*STD *  RPGBASEBND                                                   *                       CLE134
/*EXI *  TEXT('Midas LE Loans update phase 2')                        *
0001 H***********                                                         S01117
0002 F*****************************************************************
0003 F*                                                               *
0004 F*  Midas - Customer Lending Module                              *
0005 F*                                                               *
0006 F*  LE0450 - CLOAN FILE UPDATE PHASE II                          *
0007 F*                                                               *
      *  (c) Misys International Banking Systems Ltd. 2001            *
      *                                                               *
      *  Last Amend No. MD049078           Date 12Jan18               *
      *  Prev Amend No. MD048557           Date 27Nov17               *
      *                 MD048609           Date 22Nov17               *
      *                 MD046080           Date 21Sep17               *
      *                 MD047993           Date 23Sep17               *
      *                 MD035545           Date 11Sep15               *
      *                 MD033575           Date 20Jun17               *
      *                 MD045091           Date 10May17               *
      *                 MD039672           Date 12May17               *
      *                 MD045010           Date 05Apr17               *
      *                 CGL184             Date 07Dec16               *
      *                 MD038365           Date 20Apr16               *
      *                 MD037915           Date 24Feb16               *
      *                 MD012157           Date 23Oct13               *
      *                 CLE154             Date 02Aug12               *
      *                 CLE141A            Date 28Apr16               *
      *                 CLE141             Date 01Mar16               *
      *                 CLE141             Date 08Feb16               *
      *                 MD031736           Date 02Mar15               *
      *                 MD021302           Date 29Jan15               *
      *                 MD020134A          Date 29Jan15               *
      *                 CGL165             Date 17Mar15               *
      *                 AR897086           Date 10Mar15               *
      *                 MD027718           Date 23Sep14               *
      *                 CLE164             Date 02Dec14               *
      *                 MD030334           Date 02Dec14               *
      *                 MD028338           Date 02Dec14               *
      *                 MD027475           Date 19Aug14               *
      *                 MD022510A          Date 13May14               *
      *                 MD024248           Date 05May14               *
      *                 MD023320A          Date 25Apr14               *
      *                 MD023320           Date 25Apr14               *
      *                 MD023310           Date 24Apr14               *
      *                 CDL093             Date 07Apr14               *
      *                 CSD095             Date 08Apr14               *
      *                 MD022450           Date 18Sep13               *
      *                 259708             Date 18Sep13               *
      *                 AR1007486          Date 21Jun13               *
      *                 AR706513B          Date 21Jun13               *
      *                 AR786878           Date 05Jun13               *
      *                 AR1083279          Date 29May13               *
      *                 MD020563           Date 21May13               *
      *                 MD019872           Date 08May13               *
      *                 MD020210           Date 01May13               *
      *                 AR830785           Date 07May13               *
      *                 AR1085229          Date 06Feb13               *
      *                 AR1081005          Date 25Jan13               *
      *                 AR954080           Date 05May12               *
      *                 AR996719           Date 24Apr13               *
      *                 MD020118           Date 24Apr13               *
      *                 MD019942           Date 16Apr13               *
      *                 AR1095440          Date 26Mar13               *
      *                 AR1097176          Date 22Mar13               *
      *                 AR1076968A         Date 07Feb13               *
      *                 CFC006             Date 06Aug12               *
      *                 AR1083003          Date 12Feb13               *
      *                 AR855749           Date 09Feb13               *
      *                 260891             Date 09Feb13               *
      *                 AR1078443          Date 17Jan12               *
      *                 AR996895           Date 25Nov12               *
      *                 AR1056323          Date 14Nov12               *
      *                 AR760500           Date 09Nov12               *
      *                 AR641069           Date 09Nov12               *
      *                 AR1031595          Date 13Sep12               *
      *                 AR1031359          Date 12Sep12               *
      *                 AR720106           Date 14Oct12               *
      *                 AR748269           Date 14Oct12               *
      *                 AR689431           Date 14Oct12               *
      *                 AR741212           Date 14Oct12               *
      *                 AR700107           Date 01Aug12               *
      *                 AR736589           Date 01Aug12               *
      *                 AR628773           Date 01Aug12               *
      *                 AR571427           Date 01Aug12               *
      *                 AR402543           Date 01Aug12               *
      *                 264060A            Date 01Aug12               *
      *                 AR217244           Date 01Aug12               *
      *                 AR217563           Date 01Aug12               *
      *                 263427             Date 01Aug12               *
      *                 263740             Date 01Aug12               *
      *                 263411             Date 01Aug12               *
      *                 263416             Date 01Aug12               *
      *                 263074             Date 01Aug12               *
      *                 262967             Date 01Aug12               *
      *                 262597             Date 01Aug12               *
      *                 262508             Date 01Aug12               *
      *                 CLE134             Date 01Aug12               *
      *                 CLE148             Date 23Jul12               *
      *                 AR988948           Date 13Jun12               *
      *                 AR317587           Date 19Aug11               *
      *                 AR947093A          Date 04May12               *
      *                 AR851638           Date 24Nov11               *
      *                 AR814238           Date 11Aug11               *
      *                 AR824724           Date 05Sep11               *
      *                 AR821740           Date 29Aug11               *
      *                 CRE073             Date 06Dec10               *
      *                 AR755951           Date 19May11               *
      *                 CLE139             Date 06Dec10               *
      *                 CLE064             Date 06Dec10               *
      *                 263666             Date 01Feb10               *
      *                 CER059             Date 19Jul10               *
      *                 BUG23094           Date 26Feb09               *
      *                 BUG22966           Date 18Feb09               *
      *                 CER016A            Date 19May08               *
      *                 CER047             Date 19May08               *
      *                 CER020             Date 19May08               *
      *                 CER043             Date 19May08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      *  Last Amend No. BUG22968           Date 07Mar09               *
      *  Prev Amend No. CCB016             Date 12Apr07               *
      *                 CSC042             Date 16Feb09               *
      *                 239569             Date 26Jul06               *
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *                 257871             Date 28Nov08               *
      *                 254593             Date 28May08               *
      *                 247953             Date 25May07               *
      *                 247263             Date 22May07               *
      *                 246141             Date 26Mar07               *
      *                 244734             Date 15Mar07               *
      *                 095907             Date 16Feb07               *
      *                 CAS016             Date 29May07               *
      *                 245082             Date 30Jan07               *
      *                 164847             Date 30Nov06               *
      *                 243360             Date 01Dec06               *
      *                 BUG13140           Date 05Feb07               *
      *                 BUG12970           Date 07Jan07
      *                 BUG12990           Date 05Jan07               *
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 BUG12852           Date 14Dec06
      *                 242286             Date 26Sep06               *
      *                 242195             Date 04Sep06               *
      *                 239970             Date 17Jul06               *
      *                 240956             Date 12Jul06               *
      *                 205683             Date 06Jun06               *
      *                 CSD031             Date 10Apr06               *
      *                 CSD027A            Date 10May06               *
      *                 CSD027             Date 09Dec05               *
      *                 BUG10712           Date 27Feb06               *
      *                 CLE042             Date 06Sep05               *
      *                 BUG9253            Date 15Nov05               *
      *                 BUG9201            Date 10Nov05               *
      *                 235060             Date 20Jul05               *
      *                 BUG9190            Date 09Nov05               *
      *                 234555             Date 17Oct05               *
      *                 BUG8568            Date 14Sep05               *
      *                 BUG8570            Date 14Sep05               *
      *                 BUG8569            Date 13Sep05               *
      *                 CLE106             Date 01Aug04               *
      *                 CLE038             Date 10May04               *
      *                 CLE036             Date 22Sep03               *
      *                 233545             Date 18May05               *
      *                 233887             Date 13Apr05               *
      *                 232348             Date 21Feb05               *
      *                 232315             Date 28Feb05               *
      *                 CAS009             Date 04May04               *
      *                 226074             Date 26Mar04               *
      *                 CSW037A            Date 02May05               *
      *                 CIR013             Date 25Apr05               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 BUG5047            Date 01Dec04               *
      *                 CLE025             Date 20Oct03               *
      *                 CGL029             Date 01Sep03               *
      *                 222373             Date 28Oct03               *
      *                 CAP074             Date 08Aug02               *
      *                 219314             Date 02Jul03               *
      *                 219141             Date 24Jun03               *
      *                 218782             Date 25Jun03               *
      *                 218755             Date 13Jun03               *
      *                 CLE034             Date 05May03               *
      *                 CLE031             Date 17Mar03               *
      *                 221413             Date 17Sep03               *
      *                 220565             Date 13Aug03               *
      *                 CAS005             Date 16Dec02               *
      *                 218778             Date 13Jun03               *
      *                 CGL020             Date 12Dec02               *
      *                 214980             Date 21Feb03               *
      *                 209805             Date 23Sep02               *
      *                 CLE028             Date 27Jun02               *
      *                 CAS004             Date 26Jun02               *
      *                 216832             Date 30Apr03               *
      * Midas Release 4.01.03 ----------------------------------------*
      *                 215250             Date 24Feb03               *
      *                 209420             Date 09Jan03               *
      *                 203896             Date 08Jan03               *
      * Midas Release 4.01.02 ----------------------------------------*
      *                 186816             Date 19Sep02               *
      *                 201123             Date 23Aug02               *
      *                 201762             Date 07Jun02               *
      *                 204452             Date 02May02               *
      * Midas Release 4.01 -------------------------------------------*
      *                 CLE023             Date 19Nov01               *
      *                 CAS001             Date 18Sep01               *
      *                 CLE015             Date 13Dec01               *
      *                 199197             Date 02Jan02               *
      *                 191755             Date 17Oct01               *
      *                 185526             Date 17Oct01               *
      *                 191069             Date 10Oct01               *
      *                 185822             Date 29Aug01               *
      * Midas Release 4 --------------- Base -------------------------*
      *                 180044             Date 18Jul01               *
      *                 180051             Date 18Jul01               *
      *                 194962             Date 28Jun01               *
      *                 189035             Date 28Jun01               *
      *                 174873             Date 28Jun01               *
      *                 183896             Date 14Jun01               *
      * Midas DBA 3.05 -----------------------------------------------*
      *                 166149             Date 05Apr01               *
      *                 180161             Date 27Jan01               *
      *                 CLE011             Date 07Nov00               *
      *                 157669             Date 08Dec00               *
      *                 187867             Date 21Dec00               *
      * Midas DBA 3.04 -----------------------------------------------*
      *                 131520             Date 18Sep00               *
      * Midas DBA 3.03 -----------------------------------------------*
      *                 182711             Date 25Aug00               *
      *                 176823             Date 17Jul00               *
      *                 CIR004             Date 20Jan00               *
      * Midas DBA 3.02 -----------------------------------------------*
      *                 169623             Date 07Jan00               *
      *                 CPB001             Date 01Jun99               *
      *                 160856             Date 13Oct99               *
      *                 169210             Date 14Jun99               *
      *                 165977             Date 25Aug99               *
      *                 164797             Date 23Jul99               *
      *                 163483             Date 21Jul99               *
      *                 CLE009             Date 10May99               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 134725             Date 14Jun99               *
      *                 159924             Date 11Jun99               *
      *                 160625             Date 07Jun99               *
      *                 159199             Date 18May99               *
      *                 153980             Date 11May99               *
      *                 159204             Date 04May99               *
     F*                 CPL002             DATE 08Mar99               *
      *                 158212             Date 28Apr99               *
      *                 154221             Date 26Apr99               *
      *                 158270             Date 09Apr99               *
      *                 157750             Date 07Apr99               *
      *                 156501             Date 18Mar99               *
      *                 156585             Date 17Mar99               *
     F*                 157643             DATE 23Jun98                  *E43239
     F*                 135147             DATE 03Jun98                  *E43239
     F*                 135145             DATE 03Jun98                  *E43239
     F*                 133913             DATE 21May98               *
      *                 154799             Date 24Feb99               *
      *                 153368             Date 22Jan99               *
      *                 151309             Date 17Feb99               *
      *                 151304             Date 04Jan99               *
      *                 151295             Date 18Feb99               *
      *                 147744             Date 16Nov98               *
      *                 146013             Date 09Nov98               *
      *                 145917             Date 29Oct98               *
      *                 144089             Date 14Oct98               *
      *                 142405             Date 29Oct98               *
      *                 135349             Date 12Feb99               *
      *                 141453             Date 17Feb99               *
      *                 138350             Date 11Feb99               *
      *                 144915             Date 20Nov98               *
      *                 144916             Date 17Oct98               *
      *                 143511             Date 27Sep98               *
     F*                 145393             Date 28Oct98               *
     F*                 138979             Date 24Sep98               *
      *                 CEU020             Date 13Mar98               *
      *                 135621             Date 21May98               *
     F*                 134798             Date 07May98               *
     F*                 CEU004             DATE 02Feb98               *
     F*                 126030             DATE 26FEB98               *
     F*                 117756             DATE 25FEB98               *
     F*                 113271             DATE 25FEB98               *
     F*                 121768             DATE 19FEB98               *
      *                 124017             Date 02FEB98               *
     F*                 126017             DATE 17NOV97               *
     F*                 128054             Date 23Dec97               *
     F*                 CLE005             Date 11Jul97               *
     F*                 123335             Date 24Sep97               *
     F*                 122098             Date 16Sep97               *
     F*                 121147             Date 10Sep97               *
     F*                 CLE004             DATE 30MAY97               *
     F*                 117334             DATE 17APR97               *
     F*                 116330             DATE 08APR97               *
     F*                 116329             DATE 08APR97               *
     F*                 111688             DATE 27FEB97               *
     F*                 097885             DATE 31JAN97               *
     F*                 S01408             DATE 05SEP96               *
     F*                 CAC001             DATE 01FEB96               *
     F*                 S01408             DATE 07JUN96               *
     F*                 100515             DATE 22MAY96               *
     F*                 S01408             DATE 15MAY96               *
     F*                 S01408             DATE 25APR96               *
     F*                 S01408             DATE 10APR96               *
     F*                 097002             DATE 22JAN96               *
     F*                 095244             DATE 01NOV95               *
     F*                 095238             DATE 31OCT95               *
     F*                 088120             DATE 06JUL95               *
     F*                 090155             DATE 18OCT95               *
     F*                 091165             DATE 28JUL95               *
     F*                 089457             DATE 26JUN95               *
     F*                 085345             DATE 15JUN95               *
     F*                 085677             DATE 29MAR95               *
     F*                 082480             DATE 18APR95               *
     F*                 078889             DATE 18APR95               *
     F*                 085807             DATE 10MAR95               *
     F*                 083571             DATE 15MAR95               *
     F*                 082149             DATE 25JAN95               *
     F*                 082151             DATE 25JAN95               *
     F*                 S01408             DATE 10MAR95               *
     F*                 S01486             DATE 20OCT94               *
     F*                 S01518             DATE 02DEC94               *
     F*                 072582             DATE 12OCT94               *
     F*                 S01408             DATE 19AUG94               *
     F*                 S01408             DATE 18MAY94               *
     F*                 059141             DATE 21APR94               *
     F*                 S01465             DATE 22MAR94               *
     F*                 066550             DATE 04FEB94               *
     F*                 059878             DATE 14DEC93               *
     F*                 060536             DATE 14DEC93               *
     F*                 046303             DATE 09DEC93               *
     F*                 047546             DATE 10NOV92               *
     F*                 056072             DATE 26OCT93               *
     F*                 052512             DATE 17MAY93               *
     F*                 046648             DATE 04NOV92               *
     F*                 S01392             DATE 02OCT92               *
     F*                 042529             DATE 28JUL92               *
     F*                 S01392             DATE 14SEP92               *
     F*                 BH3482             DATE 19AUG92               *
     F*                 041445 NY #(41775) DATE 29JUN92               *
     F*                 NY #(41776)        DATE 18JUN92               *
     F*                 BH3409             DATE 07JUL92               *
     F*                 BH1022             DATE 02JUN92               *
     F*                 BHF976             DATE 02JUN92               *
     F*                 BCC122             DATE 02JUN92               *
     F*                 E9688              DATE 02JUN92               *
     F*                 E26745             DATE 31MAR92               *
     F*                 BHF499             DATE 31MAR92               *
     F*                 S10227             DATE 09SEP91               *
     F*                 S01270             DATE 05FEB91               *
     F*                 BHF659             DATE 27AUG90               *
     F*                 S01220             DATE 22AUG90               *
     F*                 BHF420             DATE 13AUG90               *
     F*                 E21849             DATE 18JUL90               *
     F*                 S01260             DATE 14MAY90               *
     F*                 LN0169             DATE 15MAY90               *
     F*                 E21291             DATE 05MAR90               *
     F*                 S01194             DATE 04JAN90               *
     F*                 E10921             DATE 13DEC89               *
     F*                 E86114             DATE 13DEC89               *
     F*                 E16442             DATE 13DEC89               *
     F*                 E47260             DATE 13DEC89               *
     F*                 E19721             DATE 30NOV89               *
     F*                 S01117             DATE 15/06/89              *
     F*                 S01195             DATE 15/06/89              *
     F*                 E43688             DATE 14/11/88              *
     F*                 E14936             DATE 09/09/88              *
     F*                 E86099             DATE 25/05/88              *
     F*                 E13532             DATE 16/05/88              *
     F*                 E12011             DATE 07/04/88              *
     F*                 S01147             DATE 09/12/87              *
     F*                 S05452             DATE 20/08/87              *
     F*                 E86115             DATE 05/05/87              *
     F*                 E10007             DATE 23/10/86              *
     F*                 E47259             DATE 25/06/86              *
     F*                 E80945             DATE 25/06/86              *
     F*                 E47220             DATE 18/06/86              *
     F*                 E43546             DATE 12/06/86              *
     F*                                                               *
      *---------------------------------------------------------------*
      *                                                               *
      *  MD049078 - Wrong postings of MR and RE of PDCL loan          *
      *  MD048557 - Failing COB Component - LEC000471A                *
      *  MD048609 - Failing COB Component - LEC0000456 seq 00001   	  *
      *  MD046080 - Gap between CLE031 (Settlement to different       *
      *             currency) and CLE134 (PDCL processing)            *
      *  MD047993 - Modified MD035545. Removed dependency on Accrue   *
      *             on Last Day indicator.                            *
      *  MD035545 - LE: Interest Calculation in Leap year. Consider   *
      *             Accrue on Last Day Indicator for method 6.        *
      *  MD033575 - Added interest part of LS on split narrative      *
      *             introduced by MD027475.                           *
      *  MD045091 - When loan matures, system generates separate      *
      *             partial repayment and maturity postings on same   *
      *             value date. Introduce new system value            *
      *             'RepayDateOnMaturity' to control clearing of      *
      *             repayment details, with the following settings:   *
      *             1.'A' which means repayment details cleared if    *
      *             next date is AFTER maturity date.                 *
      *             2.'O' which means repayment details cleared if    *
      *             next date is ON or AFTER maturity date.           *
      *  MD039672 - Block LOTA3S and LOTA4 wrong output position      *
      *             causing data corruption in file MCLONCL for field *
      *           - Applied for MD-45031                              *
      *  MD045010 - Component LEC06A 10008 looping during COB caused  *
      *             by CGL184. Recompile due to changes in ZFRQB3.    *
      *  CGL184 - New Frequencies for Account Statements (Recompile)  *
      *  MD038365 - Incorrect update of data area LESTAT due to       *
      *             LDA field DAYRUN overridden value                 *
      *  MD037915 - Auto Settle Indicator for Manual Repayment        *
      *             not being considered for account balance check    *
      *  MD012157 - A/C movements show rundate instead of value date  *
      *             after inserting a backvalued 'LS'. Use the value  *
      *             of VDAT instead of RUND in SR/LOANSR.             *
      *  CLE154 - Loan Repayment Schedule Enhancement                 *
      *           (Amendable Payment Type)                            *
      *  CLE141A - CLE141 Change Control 1                            *
      *  CLE141 - Currency and Location Business Day Convention for   *
      *           Lending Transactions - Phase 2                      *
      *  CLE141 - Currency and Location Business Day Convention       *
      *  MD031736 - Update DLRC with latest value date recorded on    *
      *             rates file.                                       *
      *  MD021302 - Further change on MD020134A. Added checking if    *
      *             RE, IN and MA value date is between PRUN and RUND.*
      *  MD020134A - For auto-generated loan repayments, set value    *
      *              date equal to posting date. (Request from RBAL)  *
      *  CGL165 - Dual Withholding Tax (Recompile)                    *
      *  AR897086 - Amended program to ensure that when interest rate *
      *             is less than 0, daily accruals will be processed  *
      *             and posted accordingly.                           *
      *           - Applied for MD033488                              *
      *  MD027718 - -MRs for OL should be processed with PDCL loans   *
      *             to have correct split narratives on LEC000471A.   *
      *  CLE164 - CLE134 Enhancement F (Repayment Methodology)        *
      *  MD030334 - Add the missing Else from mp1.4 fix of AR641069.  *
      *             Also ensured record will be output to PDCL file   *
      *             only when a/c details is valid.                   *
      *  MD028338 - Interest calculation has rounding difference for  *
      *             Rollover of Facility Exchange Rate only. Reset    *
      *             value of FX Rate Chg Only Ind if actioned today.  *
      *  MD027475 - Narrative PDCL_loan event (subtype_change).       *
      *             Generate the account keys required when system    *
      *             value SplitPrinInterestFlg is installed.          *
      *  MD022510A - Prevent Unnecessary accrual penalty for PDCL     *
      *              loan.                                            *
      *  MD024248 - ABLC is not correct for both MidasPlus and        *
      *             BankFusion                                        *
      *  MD023320A - Next Repayment Date for 'non-ruble' loans has    *
      *              wrong value                                      *
      *  MD023320 - Next Repayment Date for 'non-ruble' loans has     *
      *             wrong value                                       *
      *  MD023310 - Wrong interest transfer to PDCL due to incorrect *
      *             account keys                                     *
      *  CDL093 - MM Interest calculation type 9.                     *
      *  CSD095 - Allow Deal Sub-Type and Branch for MM and FX SSIs   *
      *           (Recompile)                                         *
      *  MD022450 - Dont output Account key with ZERO for AKY3 = R    *
      *           and AKY10 = A  ( FACHISA recon and RSACMT Recon)    *
      *  259708 - Reverse fix 209805. Repayment details should not be *
      *           blanked out.                                        *
      *         - Applied for MD022450                                *
      *  AR1007486 - OSDB of PDCL fee was changed from 001 to 100.    *
      *              Rename the OSDB field on other files to avoid    *
      *              corrupting the value on CLOANCL.                 *
      *              (Child: AR1007487)                               *
      *  AR706513B - CLE134 branch was lost in setttlement account    *
      *              (FEE). Rename field OMDB to prevent values from  *
      *              being overriden with values from LEFEED.         *
      *              (Child: AR719825B)                               *
      *  AR786878 - New processing for manual repayment and           *
      *             repayment schedule for PDCL's. (Child:AR786879)   *
      *  AR1083279 - Rollover Fixing Days field is changed back to 00 *
      *              after COB. Rename field RFDY and other fields of *
      *              CLOANCL to prevent them from overwriting LOUPDCL *
      *              fields when PSAM > CPAM. (Child: AR1083280)      *
      *  MD020563 - CFC006 issues                                     *
      *  MD019872 - Erroneous posting shown if settlement ccy is diff *
      *             from transaction ccy. Execute SR/SR38A only if    *
      *             there's a settlement amount allocation given,     *
      *             i.e, STAL = 'Y'                                   *
      *  MD020210 - Differences found in SEPCKO due to incorrect      *
      *             field type of IFLOAN field                        *
      *  AR830785 - Recompiled due to changes in core hook RULE78Z1.  *
      *             (Child: AR830786)                                 *
      *  AR1085229 - Loan A/C Keys corrupted. Fix 233887 place FEOURS *
      *              in position 55 instead of 378.(Child: AR1085230) *
      *  AR1081005 - System zeroises interest amount for Stop Accrual *
      *              event. Reverse GEMS 240956. (Child: AR1081006)   *
      *  AR954080 - Loan repaid automatically before maturity date.   *
      *             Clear values of RLDT, RLDY & RLFQ if NROD passes  *
      *             a date to RLDT that is greater than or equal to   *
      *             maturity date. (Child: AR954083)                  *
      *  AR996719 - CLE148: Incorrect repayment order (maturity date) *
      *             Amend Module Priority such that SEPCKM and SEPCKT *
      *             will always have the same value for interest on   *
      *             Original Loan. (Child: AR996720)                  *
      *  MD020118 - LE0320P1 and LE0450P2 reports flagged as          *
      *             suppressed are still generated                    *
      *  MD019942 - Spread indicator from rollover details not used   *
      *             in the interest computation.                      *
      *  AR1095440 - LEC000471A encountered FOOB in Day 0 COB in EN   *
      *  AR1097176 - Accessing AOCOMR0 multiple times slows down the  *
      *              system                                           *
      *  AR1076968A - System did not generate PDCL fees for unpaid    *
      *               portion of Fee due                              *
      *  CFC006 - COB Restructure - Remove reports from COB           *
      *  AR1083003 - Erroneous amount was debited from the retail     *
      *              account after COB. Populate W6NBDP with the      *
      *              correct value when settlement 14 is used.        *
      *  AR855749 - XRFN duplicates are written by LEC07004 and       *
      *             LEC06A 00010. Rename all fields shared by CLOANCL *
      *             and LOUPDCL to avoid corruption. Changed field    *
      *             RCCY to RICC based on list of field in CLOANCL.   *
      *             (Child: AR855750)                                 *
      *  260891 - Wrong projection in LOAC. Add LCD as a key.         *
      *           Recompiled due to changes in LF/HISTR.              *
      *  AR1078443 - LEC000456 component failed during Day 2 COB      *
      *  AR996895 - Incorrect accrual interest calculation            *
      *             (Child: AR996897) (Recompile)                     *
      *  AR1056323 - Revert back changes of CLE134 for LKEY1DP and    *
      *              LKEYFED                                          *
      *  AR760500 - Waste records on LEACCNPD. Do not drop matured    *
      *             loans from CLOANCL if program was called from     *
      *             PDCL component - LEC07004. (Child: AR760501)      *
      *  AR641069 - Repayment account keys not extracted to LEPK1PD   *
      *             resulting to incorrect update of facility amount. *
      *             Reverse AR402544 and correct the conditions to    *
      *             allow ouput on LEPK1PD.                           *
      *  AR1031595 - LEC06A in MSGW status (Child:AR1031597)          *
      *  AR1031359 - Tried to divide by zero (Child:AR1031360)        *
      *  AR720106 - Negative MR does not affect available balance.    *
      *             Output 'xxRyy    B' ackey of negative MR's to     *
      *             LKEY1DP instead of LEPK1DP. (Child: AR720107)     *
      *  AR748269 - PDCL generated on I/C created an unexpected       *
      *             increase on the amount. Reverse part of AR689431  *
      *             conditions as 2 PDCL's (P and I type in LEPDUEPD) *
      *             will generate one MR with both PRAM and INTA > 0. *
      *             (Child: AR748270)                                 *
      *  AR689431 - PDCL was transferred twice. Fix is to read PDCL   *
      *             loans file to verify if PDCL was inserted today   *
      *             on Input Cycle. (Child: AR689432)                 *
      *  AR741212 - Manual Repayment settling against a nostro account*
      *             created a PDCL. Only output records into LEPK2DP  *
      *             if settlement account is Retail.                  *
      *             or if Settlement account is GL (this one is as    *
      *             per banks's request) (Child: AR741213)            *
      *  AR700107 - Do not create MA account keys for PDCLs with      *
      *             block all debit = 'Y'. (Child: AR700108)          *
      *  AR736589 - A manually-entered PDCL from a fee was posted     *
      *             against the loan settlement account instead of    *
      *             against the Take-on account. Always set field     *
      *             YDECRE to 'N' for all PDCLs generated from Fees.  *
      *             (Child: AR736590)                                 *
      *  AR628773 - PDIN should never be negative. (Child: AR628774)  *
      *  AR571427 - Amend Priority Module for Original Loan           *
      *             Interest repayment (Child: AR571428)              *
      *  AR402543 - If auto-settle = 'C' then the repayment a/c key   *
      *             ending by 'B' must be output to LEPK1DP also in   *
      *             the case where it is not defined in ACKEYAL or    *
      *             it exists but does not have posting ref 2.        *
      *             (Child: AR402544)                                 *
      *  264060A - Don't drop loans to MCLON if they are autosettle   *
      *            'C' and linked to at least 1 live PDCL.            *
      *  AR217244 - Settlement Account Key not generated for Manual   *
      *             Repayment when a PDCL was also created today.     *
      *             (Child: AR217245)                                 *
      *  263427 - Incorrect interest calculated after negative MR was *
      *           inserted. Update PDIN when Past due ind for MR is   *
      *           equal to 'Y'.                                       *
      *  263740 - Wrong update of LEPk1ZZ trailer when INTA is -ve    *
      *  263411 - Remove enhanced setting of maturity flag (262508).  *
      *         - Prevent output to MCLONCL with PDCLs exists.        *
      *  263416 - IF MR is input on the same day as PDCL with Decre   *
      *           = 'Y' is created, for the MR input manually the XP  *
      *           and XI account keys should not be generated         *
      *  263074 - Wrong Postings when interest and principal are paid *
      *           on the same day                                     *
      *           CLE134 / SWIFT                                      *
      *  262967 - When PDCL is created in I/C with decrease Y, the    *
      *           following repayment account keys should be          *
      *           created: xxRyy----A, xxRyy----I and xxRyy---XP      *
      *           and xxRyy----XI and xxRyy----B should be suppressed *
      *           CLE134 / SWIFT                                      *
      *  262597 - OSDB (start branch) in some cases does not          *
      *           correspond to the start settlement retail a/c       *
      *           branch. For Value date account key, set branch      *
      *           from Account file instead of OSDB from CLOANCL      *
      *  262508 - Issues with maturing loans (CLE134)                 *
      *  CLE134 - Past Due Call Loan Processing                       *
      *  CLE148 - Alpha Loan Reference                                *
      *  AR988948 - Rolled over loan displayed the Spread in field    *
      *             Interest Rate in Loan Details                     *
      *  AR317587 - Matured Loan can't be recovered using maturity    *
      *             date as the value date of the manual repayment.   *
      *             Amended program to allow value date of MR greater *
      *             than Maturity date for past due loans.            *
      *             (Child: AR810533)                                 *
      *  AR947093A - Base Rate amendment resulted to 0 interest rate  *
      *  AR851638 - CRE073 fields not updated properly                *
      *  AR814238 - Wrong difference amount in LE0450P2               *
      *             (Child: AR814239)                                 *
      *  AR824724 - CRE073 fields not updated properly                *
      *  AR821740 - COB - No stamp tax account keys generated         *
      *             (Recompile)                                       *
      *  CRE073 - Interest Rate Rounding                              *
      *  AR755951 - Data mapping error on member CLOANCK              *
      *             (Child: AR755952)                                 *
      *  CLE139 - Lending Fee Capitalisation                          *
      *  CLE064 - Enhancement of Lending Frequencies (Recompile)      *
      *  263666 - Recompiled due to changes in ZINTDYZ2               *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  BUG23094 - Data mapping error on member CLOANCL              *
      *  BUG22966 - New fields introduced by CER020 are truncated     *
      *           internally described file needs to match actual     *
      *  CER016A - German Interest Calculation: Upgarde of FGE059     *
      *            to Midas Plus (Recompile)                          *
      *  CER047 - German Features LF037-00 Reporting §24c             *
      *           (Recompile)                                         *
      *  CER020 - Enhanced Rollover Window: Upgrade FGE089 to         *
      *           Midas Plus                                          *
      *  CER043 - German Features LF041-00 New Fields and Defaulting  *
      *           (Recompile)                                         *
      *  BUG22968 - Ensure that location code and currency are passed *
      *             when computing for the previous or next working   *
      *             day                                               *
      *  CCB016 - CoB Performance Enhancements                        *
      *           JNSTAT should not be allocated for update as it can *
      *           lock the dataarea causing other components to wait. *
      *  CSC042 - COB Performance fix. RZB Sofia calls AOBRCHR* 276K  *
      *           times. Save data in array and reuse.                *
      *           Pgm calls AOCURRR* when there is a routine CCYDSP   *
      *           to get details from the arrays created in first cyc *
      *           All calls to AOCURRR* removed                       *
      *  239569 - Changed value date postings of principal from system*
      *           rundate to value date of LS.                        *
      *  257871 - Prevent RFRQ, RDYN to be overwritten.               *
      *  254593 - Applied core fix 254075.                            *
      *  254075 - Interest accruals account key not generated.        *
      *           Reverse fix 247263.                                 *
      *  247953 - Default spread indicator to 'A' when it is blank    *
      *           and rate changed.                                   *
      *  247263 - Correct the posting for LE Module. Back value       *
      *           interest Repayment.                                 *
      *  246141 - Recompiled due to changes in ZINTDYZ2               *
      *  244734 - SLTP, SLST and SLCL are blanking out                *
      *  095907 - Drop Processing SE II Enhancement. Applied 127891   *
     F*  127891 - WHEN LOAN REMOVED FROM CLOANCL, DELETE CORRESPONDING*
     F*           RECORDS IN PMMFHLPP                                 *
      *  CAS016 - IAS18 EIR Recalculation (Fee Amortisation Over      *
      *           Whole Period) -Recompile.                           *
      *  245082 - Loans with first and last day accrual should be     *
      *           treated as first day accruals until maturity        *
      *           date.  Then add one day on the maturity date.       *
      *           Applied fix 235784 from Release 4.                  *
      *  164847 - Recompile over changes in /COPY ZINTDYZ2.           *
      *  243360 - Incorrect mapping of rollover settlement data.      *
      *  BUG13140 - Doubling of amounts of Total Adj. to yield fees   *
      *             and Total FDP on LE004620P1 report                *
      *  BUG12970 - Nonpayment on maturity not throwing past due      *
      *              event. Applied fix 235826.                       *
      *  BUG12990 - Recompiled due to changes in ZINTDYZ2/ZINTDYZ2LE  *
      *  BUG12852 - Incorrect computation of accrued withholding tax  *
      *             not yet posted                                    *
      *  242286 - Recompile over changes in /COPY ZINTDYZ2.           *
      *  242195 - Incorrect data being written to RRCA (CLOANCK)      *
      *  239970 - Incorrect output of settlement accounts.            *
      *  240956 - When Stop Accrual Indicator is on, previous         *
      *           accruals should not be reversed but should rather   *
      *           be posted on next payment date.                     *
      *  205683 - Incorrect loan rollover date. Consider settlement   *
      *           type on the calculation of rollover date.           *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027A - Conversion Of Customer Number to Alpha             *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  BUG10712 - Data mapping error when writing to MCLONCL.       *
      *  CLE042 - Extended Loan Sub Type                              *
      *  BUG9253 - Ensure that the beneficiary customer will be       *
      *            populated correctly.                               *
      *  BUG9201- Loan activities with STAL were not posted correctly *
      *           to the accounts                                     *
      *  235060 - New replacement Settlement Allocation was given a   *
      *           duplicate sequence number. Amendment to CLE038.     *
      *  BUG9190- Rollover settle payment account no. was blanked out *
      *           after COB                                           *
      *  234555 - Amendment to CLE038 - Allocations by Amount using   *
      *           a settlement currency had the wrong amounts on the  *
      *           account keys & subsequently on the facility history *
      *  BUG8568- Settlement entries are being posted into a wrong    *
      *           account                                             *
      *  BUG8570- Data written in MCLONCL are corrupted               *
      *  BUG8569- Program dump in calling AOSTALU0                    *
      *  CLE106 - Syndications Manager.                               *
      *  CLE038 - Lending Enhancement for Nordea: Allocation by Amount*
      *  225656 - Apply core fix 209420                               *
      *  CLE036 - Lending Enhancements for Nordea Phase 1 Priority 2: *
      *           Allow specific base rates                           *
      *           Allow repayments in facility currency               *
      *  233545 - Cut-off Date (Recompile)                            *
      *  233887 - Ensure Correct Postings on Subtype change           *
      *  232348 - Introduce cut-off date for non-linear amortisation  *
      *  232315 - Linear amortisation account keys are still being    *
      *           generated when amortisation flag is 'N'             *
      *  CAS009 - Effective Interest Rate/Amortised Cost Accounting   *
      *  226074 - UP/UL keys output on report eventhough amount is 0  *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  CIR013 - Additional Calculation Method for FRA/IRS/CCF       *
      *           Recompile over GLINTC and ZINTDY.                   *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  BUG5047- Duplicate key error in MLOAN1 as OLNRF is corrupted *
      *  CLE025 - Credit Lines (Recompile)                            *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  222373 - Parameter mismatch.                                 *
      *  CAP074 - Lending API enhancements - Loans input.             *
      *  219314 - R_B keys generated on rollover date for full loan   *
      *           amount if rollover not to a new principal amount.   *
      *  219141 - R_B key not be generated for settlement allocation  *
      *  218782 - Check system value Settlement09Postings to decide   *
      *           whether to use Settlement or Transaction Ccy.       *
      *  218755 - Fields corrupted on CLOANCK. Add field RSTA to      *
      *           LOUPDL2 and correct LOT* field definitions.         *
      *  CLE034 - Lending Enhancements Phase 1 Priority 1A            *
      *           SECCY2 should only be called once. Save and         *
      *           restore the settlement currencies from action file  *
      *           as well as the loan file.                           *
      *           WLONR flag not initialised to blanks. Only process  *
      *           'RE' records as loan amendments if the loan         *
      *           amendment sequence number is not zero. This is      *
      *           because 'RE' records are produced for repayment     *
      *           schedules AND frequency based repayments defined    *
      *           on the loan.                                        *
      *           Half adjust splitting of amount in SR34B            *
      *           Set up exchange rate from settlement allocation     *
      *  CLE031 - Calculation of facility amount after the current    *
      *           principal amount or facility exchange rate has      *
      *           changed needs to take account of the change in      *
      *           decimal places that can occur.                      *
      *  221413 - Incorrect reversal entries for deleted loans.       *
      *           No reversal for hedge entries for maturing loans.   *
      *  220565 - Missing Charge Amortisation Account Key for Flat    *
      *           Rate Personal Loans with Add on Charges Flag equal  *
      *           to 'Y'.                                             *
      *  CAS005 - Enhancements to CAS001, CAS002 and CAS004           *
      *  218778 - Include Forward Yield curve in I and O specs to     *
      *           avoid being lost in COB
      *  CGL020 - Compliance Watch - Additional A/C Postings          *
      *           Information                                         *
      *  214980 - No amortisation for loan with Auto-settle 'No'.     *
      *  209805 - Repayment fields should be cleared if next repayment*
      *           date is equal to maturity date, or principal amount *
      *           is equal to zero.                                   *
      *  CLE028 - Flat Rate Personal Loans (Rule of 78s)              *
      *  CAS004 - Hedge Accounting Phase A                            *
      *  216832 - If Interest frequency IPFR is 'R', do not overwrite *
      *           with the rollover frequency.                        *
      *  215250 - Do not update RTSP to zero if only Funding Info is  *
      *           changed and allow change to Funding Info if CDE002  *
      *           is installed.                                       *
      *  209420 - Do not seton *IN46 if accrual amount is less than   *
      *           zero to avoid full reversal of margin amounts.      *
      *  203896 - No events replicated for ToF/Meridian Interface.    *
      *  186816 - Fix 131520 causes ACDA to be corrupted.             *
      *           Added renames for fields shared by CLOANCL and HISTR*
      *  201123 - Include Original Borrower in this report when       *
      *           processing type of loan is either 64, 65, 68 or 71. *
      *  201762 - Matured loans remain in CLOANCL file after monthend *
      *           CoB due to incorrect value of NOPS field.  Reversed *
      *           part of core fix 138350 which corrupts NOPS value   *
      *           on parts sold loan's maturity.                      *
      *  204452 - Recompiled due to changed PF/LEFEED.                *
      *  CLE023 - Lending Facilty History Improvements.               *
      *  CAS001 - Net Present Valuation (NPV) Accounting              *
      *  CLE015 - Functionality moved from Syndicated Lending to      *
      *           Customer Lending                                    *
      *  199197 - Generate account key xxRyy____B for interest when   *
      *           a loan whose repayment type <> 2 is converted to EUR*
      *  191755 - The NIDT does not get updated if it is a Holiday    *
      *           yet the Interest Payment is actioned today. This    *
      *           results to a duplicate IN event to be generated on  *
      *           the next working day because NIDT was still in the  *
      *           past although it has already taken place.           *
      *  185526 - Part Sold Amount wrong for multi-currency rollover. *
      *           Corrected validation in PARTS subroutine. NCCY hasnt*
      *           been read yet, and RLDT has already been updated.   *
      *           Chain to CLOANCK to get NCCY and NFCE.              *
      *  191069 - Auto-settlement indicator of non-autosettle loans   *
      *           with 0 outstanding and with reversed PD record      *
      *           should have a 'Y' value when rundate is greater than*
      *           maturity date.                                      *
      *  185822 - Generate loan sub-type A/C keys for risk loans.     *
      *  180044 - Additional code.  Event date for PD reversal a/key  *
      *           should be the reversed PD record's value date.      *
      *         - Generate Past due A/C keys with reversal indicator  *
      *           equal to one for reversed PD records in the Loan    *
      *           Amendments Maintenance menu.                        *
      *  180051 - Part sold amount exceeds the loan's current         *
      *           principal amount.                                   *
      *  194962 - Update Repayment amount with multicurrency          *
      *           rollover's New repayment amount only if the         *
      *           multicurrency rollover is being processed;          *
      *           Amendment Type = 'MC'.                              *
      *  189035 - New Repayment amount not written to PF/CLOANCL for  *
      *           'MC' currency rollover and future next repayment    *
      *           date updated to next date according to the freq.    *
      *           when 'MC' rollover.                                 *
      *  174873 - Do not update NIDT with NIPD value if NIPD is equal *
      *           to rundate instead zeroise this field.              *
      *  183896 - Auto-settlement indicator of risk loans, risk part. *
      *           purchased loans, or risk parts. sold loans should   *
      *           not be automatically set to 'Y' on maturity date.   *
      *  166149 - Repayment amount was not converted to EUR when      *
      *           rolled over.                                        *
      *  180161 - If interest payment frequency is 'R' and CLE005 is  *
      *           on, next interest payment must be based on rollover *
      *           setup.  Pass rollover setup before executing SR/    *
      *           ZFRQB3, as 'R' in SR/ZFRQB3 means monthly interest  *
      *           6 days before monthend.                             *
      *  CLE011 - Rate Fixing Days for Lending Rollover Processing    *
      *  157669 - Cost of Funds are being reported incorrectly        *
      *  187867 - Field OINR (Original Interest Rate) is being        *
      *           corrupted during COB.                               *
     F*  131520 - Add subroutine to recalculate ABLN from the full    *
     F*           loans history file instead of adding daily          *
     F*           increments. Patterned fix from 123552 and 100198.   *
      *  182711 - Accrued interest was reversed after manual repayment*
      *           Remove fix 160856                                   *
      *  176823 - Wrong interest pay date after COB.  Check holidays  *
      *           for local ccy if maturity sett. type is other than  *
      *           01, 07 and 08.                                      *
      *  CIR004 - Dealing Calculation Method Change.                  *
      *         - Recompiled due to GLINTC and ZINTDY changes         *
      *  169623 - Missing Account keys for a multi-currency rollover  *
      *           and maturity date becomes 0 even the loan is a term *
      *           loan.                                               *
      *  CPB001 - Meridian DBA Middleware Replication Customization.  *
      *           Midas/TOF Interface.                                *
      *  160856 - Incorrect matured amount due to backvalued          *
      *           principal increase. Applied fix 158698.             *
      *  169210 - Duplicate core hooks - LE0450C001, LE0450C002,      *
      *           LE0450C003 renamed to LE0450CABJ, LE0450CABK,       *
      *           LE0450CABL                                          *
      *  165977 - Wrong account keys generated for multi-ccy rollover *
      *           for discounted loans.                               *
      *  164797 - A/c keys for syndicated parts sold should not have  *
      *           a 'S' if the bank is not an agent.                  *
      *  163483 - Recompute interest base date when equal w/ previous *
      *  CLE009 - LE I/C Swift Message Generation for Fees            *
      *           Recompiled due to changes in LEFEED                 *
      *  134725 - PSAM of original loan should be updated if there is *
      *           a multi-ccy rollover.                               *
      *  159924 - Payment due date should also be considered for      *
      *           repayment type 2 in calculating next repayment date *
      *  160625 - If New Interest Payment Date Not entered, do not    *
      *           update Next Interest Date during Multi-ccy Rollover *
      *           unless interest payment date has been reached.      *
      *  159199 - If a New Interest Payment Date has been entered on  *
      *           Multi-Currency rollover screen, then use it, even   *
      *           if there is a frequency (IPFR) entered.             *
      *  153980 - Euro amounts have 0 decimal places on LE0450P1
      *  159204 - Next Rollover Date should be used to update RLDT.   *
     F*  CPL002 - Midas-Plato Interface                               *
     F*           Addition of Original Interest Rate                  *
      *  158212 - Manual Repayment of past due interest does not      *
      *           reverse previous past due postings.                 *
      *  154221 - Calculations added for payment due/taken indicators *
      *           for repayment types 1 and 3.                        *
      *  158270 - Principal Transfer 'To' key not correct for         *
      *           syndicated loan                                     *
      *  157750 - Branch name is displayed incorrectly in the heading *
      *           of LE0450P1/P2                                      *
      *  156501 -  Wrong rate when 'R' is used for base rate changes  *
      *  156585 - Write GASS field for manual repayment actions       *
     F*  157643 - Add transfer from / to loan to account key          *
     F*  135147 - Add syndication indicator to Account Key            *
     F*  135145 - Add agent customer number to LKEY1DP                *
     F*  133913 - Change PDDI to WPDDI to avoid being overwritten.    *
      *  154799 - Recompiled due to changes in /COPY,ZACCH            *
      *  153368 - There should be an 'R' in position 7 of the         *
      *           principal increase a/c key if 'Recourse' indicator  *
      *           is 'Y' on the original loan.                        *
      *  151309 - Penalty account keys should have 'R' in pos 3. Pos 8*
      *           having 'S' for syndicated loans should have been    *
      *           fixed by 146013.                                    *
      *  151304 - A/c keys for syndicated trans should not have 'S'   *
      *           if bank is not an agent.                            *
      *  151295 - Problems authorising repayment schedules            *
      *           Recompiled due to changes in ZCHKH                  *
      *  147744 - Allow matured loan records to stay for three months *
      *  146013 - A/c keys for syndicated trans should have 'S'       *
      *           in position 8                                       *
      *  145917 - Header missing on first page of report              *
      *           (Already exists as core fix 124017)                 *
     F*  144089 - Add processing for modified payment due day         *
     F*           indicator.                                          *
     F*  142405 - New field, OIDT, added to CLOANCL to counter SWIFT  *
     F*           pay/receive problem.                                *
      *  135349 - Amount sold is not being updated when a principal   *
      *           transfer of the part sold amount occured.           *
      *  141453 - Recompiled due to changes in PF/LEFEED              *
     F*  138350 - Amount sold is not updated properly                 *
      *  144915 - Update loan settlements with rollover settlements   *
      *           for multi-currency rollover                         *
      *  144916 - Uses old ccy base rate in calculating outstanding   *
      *           interest after multi-ccy rollover                   *
      *  143511 - Base ccy exchange rate doesn't change after multi-  *
      *           ccy rollover.                                       *
     F*  145393 - Manual repayment not settled accross EURO account   *
     F*           input in Loan Amendment Maintenance when settlement *
     F*           currency of loan is blank in PF/CLOANCL.            *
     F*  138979 - Check if CLE004 lending enhancement is on before    *
     F*           processing rollovers of discounted participations   *
     F*           sold and purchased. Amendment to 122098.            *
     F*  CEU020 - EMU Lending Multi-currency Rollover                 *
     F*  135621 - Divide by zero error in LE0480 due to zero BCXR and *
     F*           FCXR                                                *
     F*  134798 - Missing EMU codes                                   *
     F*  CEU004 - EMU Lending Settlement Currency Conversion.         *
     F*  126030 - When rolling over a discounted loan and reducing the*
     F*           principal, update the loan principal by the 'New    *
     F*           Principal', as entered on the Rollover, not the     *
     F*           difference. Modify amounts output to account keys.  *
     F*  117756 - When the loan subtype is amended from processing    *
     F*           type 62 to 61, avoid posting of incorrect accrued   *
     F*           interest amount.                                    *
     F*  113271 - When the loan subtype is amended, the capitalised   *
     F*           interest for the previous subtype should not be     *
     F*           reversed. Applied fix 107481.                       *
     F*  121768 - Recompile over changed GLINTCZ1                     *
      *  124017 - Set on indicator *INOF after OPEN operation for     *
      *           LE0450P1 and indicator *INOV after OPEN operation   *
      *           for LE0450P2 to print heading details.              *
     F*  126017 - Correction to interest calculation for calculation  *
     F*           basis 6 in SR/GLINTC. Add SR/ZDAT10                 *
     F*  128054 - Output Additional Days Indicator to MCLONCL         *
     F*  CLE005 - Customer Lending Enhancements - Tranche 3           *
     F*  123335 - Replace 'old' base and facility ccy exchange rates  *
     F*           with 'new' rates when on multi-currency rollover.   *
     F*  122098 - Add processing to calculate the details for rollover*
     F*           of Discounted PP/PSs.                               *
     F*  121147 - Remove 117334, see fix in le0390.                   *
     F*  CLE004 - Customer Lending Enhancements.                      *
     F*           Tranche 2.                                          *
     F*  117334 - Do not update Interest Accrual Control Date for     *
     F*           amendment type MI. Further to 114482 in le0400.     *
     F*  116330 - If back-valuations (CLE003) are present, rate       *
     F*           detail from the action record may not be the most   *
     F*           recent. Hence, access history for latest SC, BC,    *
     F*           BR, RO, as appropriate.                             *
     F*  116329 - Back-valued rollover causes incorrect setting of    *
     F*           next interest date.                                 *
     F*  111688 - OUTPUT OF BOOK CODE IN LEKEY1DP                     *
     F*  097885 - Recompiled for wrong calculation of number of day   *
     F*           interest (ZINTDYZ2).                                *
     F*  S01408 - Core hook added LE0450CP23                          *
     F*  CAC001 - Profit Centre Accounting Development:               *
     F*           New account keys will be produced on loan value     *
     F*           date, rollover date, accrual date, interest payment *
     F*           date, manual repayment, maturity date and interest  *
     F*           capitalisation date.  Two sets of keys will be      *
     F*           produced on each date: one for the transaction      *
     F*           profit centre and one for the funding profit centre.*
     F*  S01408 - Core hook added LE0450FFP3                          *
     F*           Core hook added LE0450IIP3                          *
     F*           Core hook added LE0450CP15                          *
     F*           Core hook added LE0450CP16                          *
     F*           Core hook added LE0450CP17                          *
     F*           Core hook added LE0450CP18                          *
     F*           Core hook added LE0450CP19                          *
     F*           Core hook added LE0450CP20                          *
     F*           Core hook added LE0450CP21                          *
     F*           Core hook added LE0450CP22                          *
     F*  100515 - Recompile program due to changes in LEFEED.         *
     F*  S01408 - Core hook added LE0450FFP2                          *
     F*  S01408 - Core hook added LE0450IIP1                          *
     F*           Core hook added LE0450IIP2                          *
     F*           Core hook added LE0450CP10                          *
     F*           Core hook added LE0450CP11                          *
     F*           Core hook added LE0450CP12                          *
     F*           Core hook added LE0450CP13                          *
     F*           Core hook added LE0450CP14                          *
     F*  S01408 - Core hook added LE0450CCP1                          *
     F*           Core hook added LE0450CCP2                          *
     F*           Core hook added LE0450CCP3                          *
     F*           Core hook added LE0450CCP4                          *
     F*           Core hook added LE0450CCP5                          *
     F*           Core hook added LE0450CCP6                          *
     F*           Core hook added LE0450CCP7                          *
     F*           Core hook added LE0450CCP8                          *
     F*           Core hook added LE0450CCP9                          *
     F*           Core hook added LE0450FFP1                          *
     F*  097002 - Remove 78889 & 91165 - Part sold amount higher than *
     F*           original loan amount (keep correction 91165 in      *
     F*           LE0400)                                             *
     F*  095244 - Recompiled for Calculation method 3                 *
     F*  095238 - Recompiled for Calculation method 3                 *
     F*  088120 - Do not accrue interest for negative principal (i.e  *
     F*           if loan has been overpaid)                          *
     F*  090155 - Amend 'F' and 'O' Specs for MCLONCL due to changes  *
     F*           in this file.                                       *
     F*  091165 - For manual repayment of part. sold, its' amount is  *
     F*           being deducted twice from the sold amount of the    *
     F*           original loan.                                      *
     F*  089457 - If loan is not output to to NCLON* because there    *
     F*           fees outstanding, set on *IN62 to output record to  *
     F*           CLOAN* (Amendment to 085677)                        *
     F*  085345 - Interest Pay-Date should be defaulted to Rollover   *
     F*           Date if Next Interest Pay-Date is blank.            *
     F*  085677 - Do not allow loan to mature if there are fees o/s   *
     F*  082480 - Initialisation subroutine FIRST was not getting     *
     F*           called in all (most ?) instances because it was     *
     F*           conditioned by something irrelevant.                *
     F*           The symptom in this case is that Matured loans      *
     F*           were not being archived to MCLONCL.                 *
     F*  078889 - Amount Sold on loan is not being updated when a     *
     F*           manual repayment is made against the Parts Sold     *
     F*           loan.                                               *
     F*  085807 - Wrong layout on LKEY1DP                   .         *
     F*  083571 - Do not update Interest day number if frequency is   *
     F*           fortnightly or weekly                               *
     F*  082149 - ADD PTFR TO MCLONCL, LDA IS DEFINED IN UPDATE MODE  *
     F*  082151 - USE CORRECT RETURN CODE                             *
     F*  S01408 - Addition of core hook  LE0450CCPG                   *
     F*  S01486 - Portfolio Management Upgrade to Release 10.         *
     F*  S01518 - BLI Lending Swift Enhancements.                     *
     F*  072582 - Margin posting amounts are calculated wrongly.      *
     F*  S01408 - Core hook LE0450OPG  added                          *
     F*           Core hook LE0450PDR  added                          *
     F*  S01408 - Core hook LE0450FFPG added                          *
     F*           Core hook LE0450OOPG added                          *
     F*           Core hook LE0450CBDU added                          *
     F*           Core hook LE0450CBUW added                          *
     F*  059141 - System should check for monthend for all            *
     F*           frequencies if ANWD = '2'.  Applied BN4619          *
     F*  S01465 - BLI Lending and Guarantees Issued Enhancements      *
     F*  066550 - GLINTC has had historical problems and inaccuracies *
     F*           and is now externaly descibed and changed to use    *
     F*           ZINTDYZ1. See document atached to error no on GEMS  *
     F*  059878 - Wrong interest rate appear on interest accrual      *
     F*           report.  E10921 saves the old rate only if there is *
     F*           a rate mov. (base rate, base code, spread rate chg, *
     F*           rollover). Otherwise OINTR is zero or contain the   *
     F*           old rate of the previous loan. FIX: the old rate    *
     F*           (INTRL) is transferred to OINTR at the start when   *
     F*           loan is read. (Apply DDB-FFT SC#038784)             *
     F*  060536 - Save the value of the current principal (CPAM)      *
     F*           before update in sr/CPAMUP and sr/LOANB.            *
     F*  046303 - /COPY source subr. ZFWDT amended to prevent array   *
     F*           error if no holiday record found - fixed by S01434. *
     F*           Program recompiled.                                 *
     F*  047546 - INTEREST RATE WAS NOT OUTPUT TO LKEY1DP CORRECTLY   *
     F*           FOR SOME LOANS.                                     *
     F*  056072 - Move the set up of indicator for discount rollover  *
     F*  052512 - DO NOT OUTPUT KEYS FOR BACKVALUATIONS               *
     F*  046648 - EARLY MATURED DISCOUNTED LOANS CAN NOT MATURE       *
     F*           IF AUTO SETTLE IS NO                                *
     F*  S01392 - JAPANESE SUB MODULE ENHANCEMENTS                    *
     F*  042529 - WHEN A LOAN MATURES, PROCESSING TYPES 70 ARE NOT    *
     F*           DROPPED FROM THE HISTORY FILE                       *
     F*  S01392 - JAPANESE SUB MODULE ENHANCEMENTS                    *
     F*  BH3482 - Generate Loan sub-type amendment A/C keys           *
     F*           correctly.                                          *
     F*  041445 - NY # 41775 - Facility aggregates are not updated    *
     F*           correctly if ANWD = '2'. If APDA < DNWD - 1, it     *
     F*           was not determined whether it was a MONTHEND run.   *
     F*           Thus, LE0860 is not run at all.                     *
     F*  E41776 - NY # 41776 - Loan aggregates are not updated        *
     F*           correctly if non-working day has passed. If a       *
     F*           holiday has passed, make sure that the no. of days  *
     F*           to compute for the aggregate balances is correct.   *
     F*           This happens when ANWD='2' and it is monthly accr.  *
     F*  BH3409 - Loan sub-type amendment account keys are being      *
     F*           generated incorrectly                               *
     F*  BH1022 - FILL NEW FIELDS ON MLOAN FOR USE IN PROCESSING      *
     F*           FOR LE0900.                                         *
     F*  BHF976   FIX BCCI22, SOME VERY CONFUSED PROCESSING           *
     F*  BCCI22 - RETAIN MATURED LOAN HISTORY                         *
     F*  E9688  - ERROR FIX FOR AAIB APPLIED TO CCF UPGRADE           *
     F*  E26745 - INCORRECT CHECK ON RECOURSE IND - IT IS NOW Y/N     *
     F*  BHF499 - PART SOLD NOT UPDATED FOR PRINCIPAL INCREASE        *
     F*           ON THE LOAN THE PART SOLD IS BOOKED AGAINST.        *
     F*           APPLY NY ERROR FIX E21301                           *
     F*  S10227 - RETAIN MATURED LOAN HISTORY                         *
     F*  S01270 - CUSTOMER LENDING AMENDMENTS                         *
     F*  BHF659 - OVERFLOW PROBLEM SET OF HEADERS PRODUCED AT LR      *
     F*  S01220 - Amended for Strategic Risk Management Release 10    *
     F*           to allow update of the Book Code.                   *
     F*  BHF420 - SHOULD BE USING 6 ZONED VERSION OF OLNO             *
     F*  E21849 - OUTPUT NEW AMOUNT AFTER PRINCIPAL INCREASE.         *
     F*  S01260 - ORIGINAL BORROWER ON PARTICIPATIONS PURCHASED.      *
     F*  LN0169 - LKEY1DP FIELDS FOR R2 AND R10 OVERLAP - 129->,      *
     F*           SO PROFIT CENTRE AND SETTLE.BRANCH NEED TO CHANGE   *
     F*  E21291 - RECOURSE IND. OUTPUT TO ACCOUNT KEY EVEN IF LOAN    *
     F*           ENTERED WITHOUT RECOURSE.                           *
     F*  S01194 - STANDING DATA CHANGES.                              *
     F*  E10921 - SAVE OLD RATE FOR OUTPUT TO REPORT.                 *
     F*  E86114 - INCORRECT YTD INTEREST FOR CUSTOMERS WITH DROPPED   *
     F*           MATURED LOANS INPUT LAST YEAR.                      *
     F*  E16442 - ACCOUNT KEY GENERATED AT MATURITY PRINTS ZERO       *
     F*           PRINCIPAL INSTEAD OF AMOUNT USED IN INTEREST CALC.  *
     F*  E47260 - WRONG FROM DATE ON INTEREST ACCRUAL REPORT DUE TO   *
     F*           AN ACCRUAL/PROFIT DATE OCCURRING SINCE LAST         *
     F*           INTEREST DATE OF THE LOAN.                          *
     F*  E19721 - DO NOT DROP FINAL REPAYMENT DETAILS WHEN FINAL      *
     F*           REPAYMENT DATE EQUALS MATURITY DATE.                *
     F*  S01117 - MULTIBRANCHING                                      *
     F*  S01195 - HOLIDAY AMENDMENT                                   *
     F*  E43688 - IF STOP ACCRUAL IS SPECIFIED FOR A LOAN WHICH       *
     F*           MATURES BEFORE ACCRUAL PROFIT DATE, THEN INTEREST   *
     F*           FROM LAST ACCRUAL DATE UP TO STOP ACCRUAL IS NOT    *
     F*           POSTED.                                             *
     F*  E14936 - MISSING MESSAGES WHEN THERE ARE NO DETAILS TO       *
     F*           REPORT AND AT THE END OF THE REPORT.                *
     F*  E86099 - SYSTEM CANNOT HANDLE SKIPPING OF WORKING DAYS       *
     F*           THUS CORRUPTS THE AGGREGATE BALANCE HELD ON         *
     F*           S/CLOAN, B RECORD.                                  *
     F*  E13532 - INTEREST WAS NOT BEING CAPITALISED AT MATURITY FOR  *
     F*           A NON-AUTOSETTLE LOAN.                              *
     F*  E12011 - FOR A PAST DUE LOAN WITH AUTO SETTLE = N IF MANUAL  *
     F*           REPAYMENT ONLY REPAYS PRINCIPAL BUT NOT INTEREST    *
     F*           THE AUTO SETTLE INDICATOR WILL TURN TO Y AFTER A    *
     F*           DAY RUN, THUS THE OUTSTANDING INTEREST WILL SETTLE  *
     F*           AUTOMATICALLY ON THE FOLLOWING RUN.                 *
     F*  S01147 - RELEASE 22 (AMENDMENT TO GLINTC)                    *
     F*  S05452 - INCLUSION OF AUTO RECONCILIATIONS.                  *
     F*  E86115 - SYSTEM CANNOT CALCULATE YTD INTEREST WHEN LOAN IS   *
     F*           BACKVALUED ACROSS THE PREVIOUS YEAR.                *
     F*  E10007 - DATABASE ERROR CAUSED IN SW0320 WHENEVER LOAN IS    *
     F*           DROPPED AT EOM BEFORE PRODUCING SW/PAY-RECEIVE      *
     F*  E47259 - 'TO DATE' IN INTEREST ACCRUAL REPORT IS INCORRECT   *
     F*  E80945 - INDICATOR 98 SETTING IS SAVED AND RESTORED          *
     F*           WHEN S.R.GLINTC IS PERFORMED.                       *
     F*  E47220 - DOES NOT UPDATE START/LAST INTEREST DATE CORRECTLY  *
     F*  E43546 - LOAN DOES NOT MATURE IF AUTO SETTLE NO              *
     F*                                                               *
0012 F*****************************************************************
0013 F*OUPD***IP*AF     400  7AI     2 DISK                               S01117
0013 F*LOUPDL1*IP*AF*****400 10AI     2 DISK                        S01117S01220
0013 F***LOUPDL1*IP*AF     436 10AI     2 DISK                     S01220 S01465
0013 F***LOUPDL1*IP AF     458 10AI     2 DISK                     S01465 S01518
     F***LOUPDL1*IP AF    1087 10AI     2 DISK                     S01518 S01486
     F***LOUPDL1*IP AF    1092 10AI     2 DISK                     S01486 CAC001
     F***LOUPDL1 IP AF    1187 10AI     2 DISK                     CAC001 CLE004
     F***LOUPDL1*IP AF    1284 10AI     2 DISK                     CLE004 CEU004
     F***LOUPDL1 IP AF    1290 10AI     2 DISK                     CEU004 142405
     F***LOUPDL1 IP AF    1293 10AI     2 DISK                     142405 CPL002
     F***LOUPDL1 IP AF    1299 10AI     2 DISK                     CPL002 CPB001
     F*LOUPDL1*IP*AF    1300 10AI     2 DISK                       CPB001 CLE011
     F*LOUPDL1IP*AF****1310 10AI     2 DISK                                            CLE011 CAS001
     F***LOUPDL1*IP AF    1348 10AI     2 DISK                                         CAS001 CLE028
     F*LOUPDL1*IP*AF    1375 10AI     2 DISK                                           CLE028 CAS004
     F***LOUPDL1 IP AF    1362 10AI     2 DISK                                         CAS004 CAS005
     F***LOUPDL1*IP AF    1466 10AI     2 DISK                                         CAS005 CLE031
     F***LOUPDL1*IP AF    1492 10AI     2 DISK                                         CLE031 CLE034
     F***LOUPDL1*IP AF    1493 10AI     2 DISK                                         CLE034 CAP074
     F***LOUPDL1 IP AF    1560 10AI     2 DISK                                         CAP074 CGL029
     F***LOUPDL1 IP AF    1632 10AI     2 DISK                                         CGL029 CAS009
     F***LOUPDL1 IP AF    1744 10AI     2 DISK                                         CAS009 CLE106
     F*LOUPDL1*IP*AF****1761 10AI     2 DISK                                           CLE106 CLE042
     F***LOUPDL1 IP AF    1773 10AI     2 DISK                                         CLE042 CER020
     F***LOUPDL1 IP AF    1782 10AI     2 DISK                                         CER020 CRE073
     F***LOUPDL1   IP  AF 1829    10AIDISK    KEYLOC(2)                                CRE073 CLE134
     F***LOUPDL1   IP  AF 1905    10AIDISK    KEYLOC(2)                                CLE134 CLE141
     FLOUPDL1   IP  AF 2025    10AIDISK    KEYLOC(2)                                          CLE141
     FLELOMKL1  IF   E           K DISK                                                       CLE134
     F                                     IGNORE(LOAMSDHF)                                   CLE134
     F                                     RENAME(LOAMSDKF:LOMNEWF)                           CLE134
     F                                     IGNORE(LOAMSZ1F)                                   CLE134
     FLEFEEDLG  IF   E           K DISK
     F                                     RENAME(LEFEEDF:LEFEEDFF)
     FCLOANCL   IF   E             DISK                                         180051
     F*                                                                   S01408
     F/COPY WNCPYSRC,LE0450FFP2                                           S01408
     F*                                                                   S01408
0014 F*CTN6***IS*AF     320 15AI     2 DISK                               S01117
0014 F***ACTN6L1*IS AF     320 18AI     2 DISK                     S01117 S01518
     F***ACTN6L1*IS AF     949 18AI     2 DISK                     S01518 CAC001
     F***ACTN6L1*IS AF     969 18AI     2 DISK                     CAC001 CLE004
     F***LEACT5L0IS*AF    1057 18AI     2 DISK                     CLE004 CLE005
     F***LEACT5L0IS*AF    1060 18AI     2 DISK                     CLE005 CEU004
     F***LEACT5L0IS AF    1066 18AI     2 DISK                     CEU004 CEU020
     F***LEACT5L0IS*AF    1067 18AI     2 DISK                                         CEU020 CLE028
     F***LEACT5L0IS AF    1075 18AI     2 DISK                                         CLE028 CAS005
     F***LEACT5L0IS AF    1090 18AI     2 DISK                                         CAS005 CLE031
     F***LEACT5L0IS AF    1108 18AI     2 DISK                                         CLE031 CLE034
     F***LEACT5L0IS*AF    1109 18AI     2 DISK                                         CLE034 CAP075
     F***LEACT5L0IS AF    1176 18AI     2 DISK                                         CAP075 CGL029
     F***LEACT5L0IS AF    1230 18AI     2 DISK                                         CGL029 CLE036
     F*LEACT5L0IS*AF****1268 18AI     2 DISK                                           CLE036 CLE042
     FLEACT5L0  IS  AF 1291    18AIDISK    KEYLOC(2)
0015 F*PTSL***IS*AF      40  6AI     2 DISK                               S01117
0015 FSPTSL     IS  AF   40     9AIDISK    KEYLOC(2)                            S01117
0013 F***LOUPDL2*IS AF     403  9AI     2 DISK                      S01117S01518
     F***LOUPDL2*IS AF     472  9AI     2 DISK                     S01518 CAC001
     F***LOUPDL2 IS AF     567  9AI     2 DISK                     CAC001 CLE004
     F***LOUPDL2*IS AF    1201  9AI     2 DISK                     CLE004 123335
     F***LOUPDL2*IS AF    1209  9AI     2 DISK                     C12335 CEU004
     F***LOUPDL2 IS AF    1218  9AI     2 DISK                     CEU004 CEU020
     F***LOUPDL2 IS AF    1219  9AI     2 DISK                     CEU020 144915
     F***LOUPDL2*IS AF    1256  9AI     2 DISK                                         144915 CLE028
     F***LOUPDL2*IS AF    1290  9AI     2 DISK                                         CLE028 218778
     F***LOUPDL2*IS AF    1295  9AI     2 DISK                                         218778 CLE034
     F***LOUPDL2*IS AF    1296  9AI     2 DISK                                         CLE034 CAP074
     F***LOUPDL2 IS AF    1363  9AI     2 DISK                                         CAP074 CGL029
     FLOUPDL2   IS  AF 1387     9AIDISK    KEYLOC(2)
0013 FLOUPDZ1   IF   F  400        DISK                                         S01117
0016 F*TABLE***IF  F      96 12AI     2 DISK                              S01194
0017 F*TABLED**IF  F      96 12AI     2 DISK                              S01194
     F***SDCURRPDIF  E                    DISK                                         S01194 CSC042
     FSDCURRPD  IF   E             DISK    USROPN
     F***MLOAN***IF**F     436  6AI     2 DISK                      BH1022S01518
     F***MLOAN***IF  F    1089  6AI     2 DISK                                         S01518 CLE031
     F***MLOAN   IF  F    1492  6AI     2 DISK                                         CLE031 CLE034
     F***MLOAN   IF  F    1493  6AI     2 DISK                                         CLE034 CAP074
     F***MLOAN** IF  F    1560  6AI     2 DISK                                         CAP074 CER020
     FMLOAN     IF   F 1782     6AIDISK    KEYLOC(2)
     FLEFEED    IF   E           K DISK                                         085677
     FPMCHTVPD  UF A E           K DISK    USROPN                               S01486
     FHISTR     IF   E           K DISK                                         131520
     FCLOAN     IF   E           K DISK    INFSR(*PSSR)
     F                                     IGNORE(CLOANHHF)
     F                                     IGNORE(CLOANZ1F)
     F                                     IGNORE(CLOANCLF)
     F***LEHISTL0IF  F     147  6AI    12 DISK                                         116330 CAS005
     F***LEHISTL2IF  F     147  6AI    12 DISK                                         116330 CAS005
     F/COPY WNCPYSRC,LEH00565
     FLEHISTL0  IF   F  206     6AIDISK    KEYLOC(12)
     FLEHISTL2  IF   F  206     6AIDISK    KEYLOC(12)
     FLEHISTLK  IF   F  206     6AIDISK    KEYLOC(12)                                       MD031736
     F***LEPARTL1IF  E           K        DISK                                         138350 CLE106
     FLEFCLTLO  IF   E           K DISK
     F                                     RENAME(FCLTYFMF:FCLTYFMX)
     FLEXSTAL7  UF A E           K DISK    USROPN
     F                                     RENAME(LESTALD0:XESTAL7)
     FCLOANL4   IF   E           K DISK    INFSR(*PSSR)                                       CLE164
     F                                     PREFIX(F4_)                                        CLE164
     F                                     RENAME(CLOANCLF:CLOANCLF4)                         CLE164
     F*                                                                   S01408
     F** Core hook for externalisation.                                   S01408
     F/COPY WNCPYSRC,LE0450FFPG                                           S01408
     F*                                                                   S01408
0019 FNCLONHH   O    F  400        DISK
0019 F*NCLONCL*O***F**** 400            DISK                              S01220
0019 F***NCLONCL*O***F     436            DISK                     S01220 S01465
     F***NCLONCL*O   F     458            DISK                     S01465 S01518
0019 F***NCLONCK*O   F     400            DISK                            S01518
     F***NCLONCL*O   F    1087            DISK                     S01518 S01486
     F***NCLONCL*O   F    1092            DISK                     S01486 CAC001
     F***NCLONCL O   F    1187            DISK                     CAC001 CLE004
     F***NCLONCL*O   F    1284            DISK                     CLE004 CEU004
     F***NCLONCL O   F    1290            DISK                     CEU004 142405
     F***NCLONCL O   F    1293            DISK                     142405 CPL002
     F***NCLONCL*O   F    1299            DISK                     CPL002 CPB001
     F*NCLONCL*O***F    1300            DISK                       CPB001 CLE011
     F*NCLONCLO***F****1310            DISK                                            CLE011 CAS001
     F***NCLONCL*O   F    1348            DISK                                         CAS001 CLE028
     F***NCLONCL*O   F    1375            DISK                                         CLE028 CAS004
     F***NCLONCL O   F    1389            DISK                                         CAS004 CAS005
     F*NCLONCLO***F****1466            DISK                                            CAS005 CLE031
     F*NCLONCLO***F****1492            DISK                                            CLE031 CLE034
     F***NCLONCL O   F    1493            DISK                                         CLE034 CAP074
     F***NCLONCL O   F    1560            DISK                                         CAP074 CGL029
     F***NCLONCL O   F    1632            DISK                                         CGL029 CAS009
     F***NCLONCL O   F    1744            DISK                                         CAS009 CLE106
     F*NCLONCL*O***F****1748            DISK                                           CLE106 CLE042
     F***NCLONCL O   F    1773            DISK                                       CLE042 BUG22966
     F***NCLONCL O   F    1782            DISK                                       BUG22966 CRE073
     F***NCLONCL   O    F 1829        DISK                                             CRE073 CLE134
     F***NCLONCL   O    F 1905        DISK                                             CLE134 CLE141
     FNCLONCL   O    F 2025        DISK                                                       CLE141
     F***NCLONCK O   F     469            DISK                     S01518 CLE004
     F***NCLONCK*O   F    1103            DISK                     CLE004 123335
     F***NCLONCK*O   F    1111            DISK                     123335 CEU004
     F***NCLONCK*O   F    1120            DISK                     CEU004 CEU020
     F***NCLONCK*O   F    1121            DISK                     CEU020 144915
     F*NCLONCKO***F****1158            DISK                                            144915 CAS001
     F***NCLONCK*O   F    1163            DISK                                         CAS001 CLE031
     F***NCLONCK O   F    1179            DISK                                         CLE031 CLE034
     F***NCLONCK O   F    1180            DISK                                         CLE034 CAP074
     F***NCLONCK O   F    1247            DISK                                         CAP074 CGL029
     FNCLONCK   O    F 1319        DISK
0019 FNCLONZ1   O    F  400        DISK
0019 F*MCLONCL*O***F*****400            DISK                       S10227 S01220
0019 F***MCLONCL*O***F     436            DISK                     S01220 S01465
     F***MCLONCL*O***F     460            DISK                      S01465S01518
     F***MCLONCL*O***F    1089            DISK                      S01518082149
     F**MCLONCL O   F    1094            DISK                       082149090155
     F***MCLONCL*O   F    1092            DISK                     090155 CAC001
     F***MCLONCL*O   F    1187            DISK                     CAC001 CLE004
     F***MCLONCL*O   F    1284            DISK                     CLE004 CEU004
     F***MCLONCL O   F    1284            DISK                     CEU004 134798
     F***MCLONCL O   F    1290            DISK                     134798 142405
     F***MCLONCL O   F    1293            DISK                     142405 CPL002
     F***MCLONCL*O   F    1299            DISK                     CPL002 CPB001
     F*MCLONCL*O***F    1300            DISK                       CPB001 CLE011
     F*MCLONCLO***F****1310            DISK                                            CLE011 CAS001
     F***MCLONCL*O   F    1348            DISK                                         CAS001 CLE028
     F***MCLONCL*O   F    1375            DISK                                         CLE028 CAS004
     F***MCLONCL O   F    1389            DISK                                         CAS004 CAS005
     F***MCLONCL O   F    1466            DISK                                         CAS005 CLE031
     F***MCLONCL O   F    1492            DISK                                         CLE031 CLE034
     F***MCLONCL O   F    1493            DISK                                         CLE034 CAP074
     F***MCLONCL O   F    1560            DISK                                         CAP074 CGL029
     F***MCLONCL O   F    1565            DISK                                         CGL029 CAS011
     F***MCLONCL O   F    1677            DISK                                         CAS009 CLE036
     F*MCLONCL*O***F****1756            DISK                                           CLE036 CLE042
     F***MCLONCL O   F    1773            DISK                                         CLE042 CER020
     F***MCLONCL O   F    1776            DISK                                         CER020 CRE073
     F***MCLONCL   O    F 1805        DISK                                             CRE073 CLE134
     F***MCLONCL   O    F 1881        DISK                                             CLE134 CLE141
     FMCLONCL   O    F 2001        DISK                                                       CLE141
0019 F***MCLONCK*O***F     400            DISK                      S10227S01518
0019 F***MCLONCK O   F     469            DISK                     S01518 CLE004
     F***MCLONCK*O   F    1103            DISK                     CLE004 123335
     F***MCLONCK*O   F    1111            DISK                     123335 CEU004
     F***MCLONCK*O   F    1120            DISK                            CEU004
     F***MCLONCK*O   F    1121            DISK                     CEU020 144915
     F*MCLONCKO***F****1158            DISK                                            144915 CAS001
     F***MCLONCK*O   F    1163            DISK                                         CAS001 CLE031
     F***MCLONCK O   F    1179            DISK                                         CLE031 CLE034
     F***MCLONCK O   F    1180            DISK                                         CLE034 CAP074
     F***MCLONCK O   F    1247            DISK                                         CAP074 CGL029
     FMCLONCK   O    F 1319        DISK
0020 FMATLNHH   O    F  128        DISK
0020 F***MATLNMT*O***F     128            DISK                            S01486
0020 F***MATLNMT O   F     132            DISK                                         S01486 CER020
     FMATLNMT   O    F  135        DISK
0020 FMATLNZX   O    F  128        DISK
0021 FLKEY1HH   O    F  128        DISK
0021 F*KEY1DP*O*  F     128            DISK                               S01117
0021 F******LKEY1DP O   F     141            DISK                  S01117 LN0169
0021 F******LKEY1DP O   F     143            DISK                  LN0169 S01260
0021 F*KEY1DP*O***F     147            DISK                         S01260BHF420
0021 F***LKEY1DP*O***F     149            DISK                      BHF420085807
0021 F***LKEY1DP*O   F     153            DISK                     085807 CEU004
0021 F***LKEY1DP O   F     156            DISK                     CEU004 135145
0021 F***LKEY1DP O   F     162            DISK                     135145 157643
0021 F***LKEY1DP O   F     168            DISK                     157643 156585
0021 F***LKEY1DP O   F     169            DISK                                         156585 CGL020
0021 F***LKEY1DP*O   F     348            DISK                                         CGL020 CLE031
0021 F***LKEY1DP O   F     360            DISK                                         CLE031 CGL029
     F*LKEY1DP*O***F*****378            DISK                                           CGL029 CLE042
     F***LKEY1DP   O    F  392        DISK                                                    CLE134
     F***LKEY1DP   O    F  396        DISK                                          CLE134 AR1056323
     FLKEY1DP   O    F  392        DISK                                                    AR1056323
0021 FLKEY1ZZ   O    F  128        DISK
      *                                                                                       CLE134
     FLEPK1DPD  IF A E             DISK    INFSR(*PSSR)                                       CLE134
     F                                     RENAME(LKEY1DPF:LKEYF1DF)                          CLE134
     FLEPK1HH   IF A E             DISK    INFSR(*PSSR)                                       CLE134
     F                                     RENAME(LKEY1HHF:LKEYF1AF)                          CLE134
     FLEPK1ZZ   UF A E             DISK    INFSR(*PSSR)                                       CLE134
     F                                     RENAME(LKEY1ZZF:LKEYF1ZF)                          CLE134
     F***LEACCNL5  UF   E           K DISK    INFSR(*PSSR)                             CLE134 CLE164
     FLEPDUEL2  IF   E           K DISK    INFSR(*PSSR)                                       CLE134
     FLEPDUEL1  UF   E           K DISK    INFSR(*PSSR)                                       CLE134
     F                                     RENAME(LEPDUED0:LEPDUED1)                          CLE134
     FLEPDUEL4  IF   E           K DISK    INFSR(*PSSR)                                       CLE134
     F                                     RENAME(LEPDUED0:LEPDUED4)                          CLE134
     FLEPDUEL5  IF   E           K DISK    INFSR(*PSSR)                                       CLE134
     F                                     RENAME(LEPDUED0:LEPDUED5)                          CLE134
     FLEPDUFL1  UF   E           K DISK    INFSR(*PSSR)                                       CLE134
     FLEPDUFL6  IF   E           K DISK    INFSR(*PSSR)                                       CLE134
     F                                     RENAME(LEPDUFD0:LEPDUFD6)                          CLE134
     FACCNT     IF   E           K DISK    INFSR(*PSSR)                                       CLE134
     F                                     IGNORE(ACCNTACF)                                   CLE134
     F                                     IGNORE(ACCNTAAF)                                   CLE134
     FACCNTL1   IF   E           K DISK    INFSR(*PSSR)                                       CLE134
     F                                     RENAME(ACCNTABF:ACCNTB1F)                          CLE134
     FLELOANLZ  IF   E           K DISK    INFSR(*PSSR)                                       CLE134
     F                                     RENAME(CLOANCLF:CLOANCLZ)                          CLE134
     FACKEY     IF   E           K DISK    INFSR(*PSSR)                                       CLE134
     F                                     IGNORE(ACKEYAKF)                                   CLE134
      *                                                                                       CLE134
     F/COPY WNCPYSRC,LE0450F001
     FLE0450AU  O    F  132        PRINTER INFDS(SPOOLU)                        S01117
0022 F*E0450P3O** F     132            PRINTER                     S01124 S01117
0023 F*E0450P2O** F     132     OV     PRINTER                     S01124 S01117
     FLE0450P2  O    F  132        PRINTER INFDS(SPOOL2)                        S01117
     F                                     OFLIND(*INOV)
     F                                     USROPN
0024 F*E0450P1O** F     132     OF     PRINTER                     S01124 S01117
     FLE0450P1  O    F  132        PRINTER INFDS(SPOOL1)                        S01117
     F                                     OFLIND(*INOF)
     F                                     USROPN
     FPMMFHLL1  UF   E           K DISK                                         127891
     FFCLTYL1   IF   E           K DISK    INFSR(*PSSR)                         135147
      *                                                                                       CAS009
     FLEEIRDL5  UF   E           K DISK    INFSR(*PSSR)
      ** Midas LE Effective Interest Rate Details - Update Index                              CAS009
      *                                                                                       CAS009
     FCLOAMQL0  IF   E           K DISK    INFSR(*PSSR)
      ** Settlement Allocation by RONS                                             MD046080 MD049078
     F***LESTALLG  IF   E           K DISK    INFSR(*PSSR)                         MD046080 MD049078
     F**********                           PREFIX(G_)                              MD046080 MD049078
      ** Settlement Allocation by PONS                                             MD046080 MD049078
     F***LESTALLH  IF   E           K DISK    INFSR(*PSSR)                         MD046080 MD049078
     F**********                           RENAME(LESTALD0:LESTALD1)               MD046080 MD049078
     F**********                           PREFIX(H_)                              MD046080 MD049078
      ** Midas LE Loan amendments extension file                                              CRE073
     FCLOANZI0  UF   E           K DISK    INFSR(*PSSR)                                       CLE164
     F*                                                                   S01408
     F/COPY WNCPYSRC,LE0450FFP1                                           S01408
     F*                                                                   S01408
0025 F**
0026 F* ID F  C  H  L    FUNCTION OF INDICATORS
0027 F*
0028 F* 01            ACTION FILE HEADER RECORD - FIRST CYCLE IND
0029 F* 02            CLOAN 'A' RECORD
0030 F* 03            ACTION FILE CONTROL RECORD
0031 F* 04            ACTION FILE DETAIL RECORD
0032 F* 05            PARTS SOLD MOVEMENTS FILE DETAIL RECORD
0033 F* 06            CLOAN 'B' RECORD
0032 F* 07            ZERO ACCOUNT KEYS.                                  E14936
0033 F* 08            ZERO PARTS. SOLD.                                   E14936
0033 F* 10            WORK INDICATOR                                      E86099
0033 F* 11            MATURED LOAN DETAIL                                 BCCI22
      **12************Work*indicator*for*XESTAL7*and*LEPARTL1**********                CLE038 CLE106
      * 12            Work indicator for XESTAL7 and LEFCLTLO                                 CLE106
      *   13  - EOF indicator for CLOANCL                                 180051
      *   14  - Loan's PSAM is greater than its CPAM                      180051
      *   15  - Reversed PD record                                        180044
      *   17          Maturing discounted loan not being rolled-over                        AR317587
     F*    18         Output base currency exchange rate/ind              135621
     F*    19         Output facility currency exchange rate/ind          135621
0034 F*    20         MAT DATE ZERO
     F*    21         REVERSAL INDICATOR '1' FOR A MATCHED TO PD REC      CLE005
     F*    23         CLE034 is installed and rollover today                                  218755
     F*    25         SWITCHABLE FEATURE S01465 SWITCHED ON               S01465
     F*    26         GUARANTEES ISSUED IS ACTIVE                         S01465
      *    28         Rollover of FX Rate Chg Only actioned today                           MD028338
     F*    31         PARTICIPATION PURCHASED                             S01260
     F*    32         'FACO' ON THE ACTION FILE IS BLANK                  S05452
     F*    33         MULTIBRANCHING INDICATOR (MBIN = Y)                 S01117
     F*****34*********RECOURSE INDICATOR = ' '                     S01260 E26745
     F*    34         RECOURSE INDICATOR = 'N'                            E26745
     F*    35         IACD WAS USED AS SLIDL                              072582
     F*       38      HISTR                                               131520
0035 F********40******ACCRUE ON LAST DAY IND = 'Y'                        S01392
0036 F*       41      FIRST WORKING DAY OF YEAR
0037 F*       42      LAST WORKING DAY OF MONTH
0038 F*       43      LAST WORKING DAY OF YEAR
0039 F*       44      ACCRUAL DAY PROCESSING REQUIRED
0040 F*       45      DISCOUNTED LOAN
0041 F*       46      LOAN REVERSED TODAY
0042 F*       47      LOAN MATURING TODAY
0043 F*       48      STOP ACCRUALS IND ON
0044 F*       49      WITHOLDING TAX IND IS 'G' OR 'R'
0045 F*       50      OUTPUT TO LKEY1
0046 F*       51      INTEREST CAPT. IND = 'Y'
0047 F*       52      RECOURSE IND NON BLANK
     F*       53      Reversal A/C key for loan sub-type change           S01270
     F*       54      Set RECI to 'S' for loan sub-type change A/C key    S01270
0048 F*       55      0 DEC PLACES
0049 F*       56      1 DEC PLACE
0050 F*       57      2 DEC PLACES
0051 F*       58      3 DEC PLACES
0052 F*       60      GENERATED ADJUSTMENT FOR INT POSTED
0053 F*       61      GENERATED ADJUSTMENT FOR MANUAL ADJUSTMENTS
0054 F*       62      OUTPUT TO NCLON
0055 F********63      OUTPUT TO MATLN                                     S10227
0055 F*       63      OUTPUT TO MATLN AND MCLONCL,CK                      S10227
0056 F*       64      OUTPUT TO PARTS SOLD EXCEPTION REPORT
0057 F*       65      ACCRUAL KEY
0057 F*       67      GENERATED ASSIGNMENTS FIELD                         156585
0057 F*       68      READ FAIL ON LOUPD TRAILER                          S01117
0058 F*       70      S/LOUPD OUT OF BALANCE
0059 F*       71      S/ACTN6 OUT OF BALANCE
0060 F*       72      S/SPTSL OUT OF BALANCE
     F*       73      LOAN MATURED IN PREVIOUS RUN
     F*       75      CHAIN on PMCHTVPD.                                  S01486
      *       77      CHAIN on CLOANCK.                                                       185526
0061 F*       80      ACCOUNT KEY AMOUNT NEGATIVE
     F*       81      ROLLOVER OF DISCOUNTED LOAN                         S01392
0061 F*       82      DEAL DATE PROCESSING FOR BV LOAN INTO PREV YEAR     E86115
     F*       83      MANUAL REPAYMENT OR REPAYMENT SCHEDULE ACTIONED
     F*       84      WORK IND. USED IN PARTS SR.
0062 F*       85      WRITE OFF IND = 'Y'
0063 F*       86      WORK IND FOR ACTNS SUBROUTINE
0064 F*       87      WORK IND
0065 F*       88      WORK IND
0066 F*       89      WORK IND
0067 F*       90-99   STANDARD SUBROUTINES
0068 F*       L1      CHANGE OF BRANCH                                    S01117
0068 F*       U3      SECOND RUN OF DAY
     F/COPY WNCPYSRC,LE0450FFP3                                           S01408
     D***/COPY*ZSRSRC,ZDATE2Z1                                                                CLE134
     D/COPY ZSRSRC,ZDATE2Z1LE                                                                 CLE134
0069 D********************AKY        10  1               A/C KEY                              CLE042
0070 D TABDIS          S              2  0 DIM(3) CTDATA PERRCD(3)              DISC P.TYPES
0071 D POWR            S              7  3 DIM(7) CTDATA PERRCD(1)              POWERS OF TEN
     D***/COPY ZSRSRC,ZFREQBZ1                                                         S01392 CLE134
     D/COPY ZSRSRC,ZFREQBZ1LE                                                                 CLE134
0077 D***********         HCCY       25  3               HOL. CURRENCIES  S01195
0078 D XCYA            S              3    DIM(150)                             CURRENCIES
0079 D XDPA            S              1  0 DIM(150)                             DEC. PLACES
0080 D XSPA            S             13  8 DIM(150)                             SPOT RATES
0081 D**********          XMDA      150  1 0             MULT/DIV INDS    S01194
0081 D XMDA            S              1    DIM(150)                             MULT/DIV INDS    S01
0082 D PDUE            S              3  0 DIM(8)                               PAST DUE
     D XINA            S              1    DIM(150)                             IN CCY IND
     D CPY@            S             80    DIM(1) CTDATA PERRCD(1)
     D STAMP           S             26    DIM(1) CTDATA PERRCD(1)
     D***SVAL            S             20    DIM(1) CTDATA PERRCD(1)                        MD027475
     D SVAL            S             20    DIM(2) CTDATA PERRCD(1)                          MD027475
     D***WSET            S             18A                                         MD046080 MD049078
     D***WWCCY           S              3A                                         MD046080 MD049078
     D WCLE134         S              1A                                                    MD049078
                                                                                              CLE164
      ** CLE164 Enhancement F variables for LE000801                                          CLE164
                                                                                              CLE164
     D pRTCDRP         S              7A                                                      CLE164
     D pCATC           S              5A                                                      CLE164
     D pFILE           S             10A                                                      CLE164
     D pLOAN           S              6A                                                      CLE164
     D pBRCH           S              3A                                                      CLE164
     D pCUST           S              6A                                                      CLE164
     D pFCLT           S              5S 0                                                    CLE164
     D pFESE           S              2S 0                                                    CLE164
     D pREPR           S              8S 0                                                    CLE164
     D pCAPR           S              8S 0                                                    CLE164
                                                                                              CLE164
     D KEYLNNO         S              6A                                                      CLE164
     D***/COPY*ZSRSRC,ZHOLE                                                            S01195 CLE134
     D***/COPY*ZSRSRC,ZDATE9Z1                                                         066550 CLE134
     D***/COPY*ZSRSRC,ZPOWERZ1                                                         134725 CLE134
     D/COPY ZSRSRC,ZHOLELE                                                                    CLE134
     D/COPY ZSRSRC,ZDATE9Z1LE                                                                 CLE134
     D/COPY ZSRSRC,ZPOWERZ1IL                                                                 CLE134
     D ##BR            S              3    DIM(999)                             Branch Codes
     D ##BN            S             30    DIM(999)                             Branch Name
     D ##BL            S              3    DIM(999)                             Branch Locn
     D ##BS            S              6    DIM(999)                             Syn Agen Cust Ref
     D ##BM            S             10    DIM(999)                             MQ Sent Messages
      *                                                                   180051
      ** DS TO SPLIT ZDATE (DDMMYY OR MMDDYY FROM ZDATE2)                 S01486
     D WWDATE          DS                                                       S01486
     D  WWDAY                  1      2  0                                      S01486
     D  WWMTHN                 3      4  0                                      S01486
     D  WWYEAR                 5      6  0                                      S01486
     D*                                                                   S01486
     D CHTVDS          DS                                                       S01486
     D**********                              1   60SCCNUM                             S01486 CSD027
     D  SCCNUM                 1      6
     D  SCPTFR                 7     10                                         S01486
     D  SCINNR                11     13                                         S01486
     D  SCICCY                14     16                                         S01486
     D  SCLIND                17     19  0                                      S01486
     D  SCYRNO                20     21  0                                      S01486
     D  SCMTHN                22     23  0                                      S01486
     D  SCLOIC                24     26
     D*                                                                   S01486
     D TAT6DS          DS                                                       S01486
     D  ATCD                   1      2                                         S01486
     D  AUCD                   3      4                                         S01486
     D  AUCL                   5      8
     D*                                                                   S01486
      *                                                                   S01194
      ** Loan reference from CLOANCL.                                     131520
      *                                                                   131520
     D                 DS                                                       131520
     D  LOAN                   1     15                                         131520
     D  BRCDCL                 1      3                                         131520
     D**********                              4   90CNUMCL                             131520 CSD027
     D  CNUMCL                 4      9
     D**LNRFCL**              10     15  0                                             131520 CLE134
     D  LNRFCL                10     15                                                       CLE134
      *                                                                   131520
      ** Loan reference from HISTSHM/HP/HQ.                               131520
      *                                                                   131520
     D                 DS                                                       131520
     D  LOANH                  1     15                                         131520
     D  HBRCA                  1      3                                         131520
     D**********                              4   90HCNUM                              131520 CSD027
     D  HCNUM                  4      9
     D**HLNRF***              10     15  0                                             131520 CLE134
     D  HLNRF                 10     15                                                       CLE134
      *                                                                   131520
      **OLNO*field*-*alpha*and*numeric                                                 CSD027 CLE134
     D**********       DS                                                              CSD027 CLE134
     D**OLNOA***               1      6                                                CSD027 CLE134
     D**OLNON***               1      6  0                                             CSD027 CLE134
      *                                                                                       CSD027
     D                 DS
     D**KTRAN***               1      6  0                                             CAS009 CLE148
     D  KTRAN                  1      6                                                       CLE148
0556 D**
0557 D**   LOCAL DATA AREA TO IDENTIFY DATABASE ERRORS
0558 D**   AND TO DETERMINE TYPE OF RUN
0559 D**
0560 D***LDA********UDS                            256                    082151
0560 D LDA             DS           256                                         082151
0561 D***********                           134 138 DBFILE                S01117
0562 D***********                           139 167 DBKEY                 S01117
0563 D***********                           168 175 DBPGM                 S01117
0564 D***********                           176 1770DBASE                 S01117
0565 D***********                           178 185 DAYRUN                S01117
0561 D  DBFILE               134    141                                         S01117
0562 D  DBKEY                142    170                                         S01117
0563 D  DBPGM                171    180                                         S01117
0564 D  DBASE                181    183  0                                      S01117
0565 D  DAYRUN               184    191                                         S01117
     D**                                                                  S01117
     D STLNS1          DS           110
      ** Set work fields                                                                      CGL020
      *                                                                                       CGL020
     D**********                              1   60WWROCN                             CGL020 CSD027
     D**********                              7  120WWROBN                             CGL020 CSD027
     D**********                             13  180WWPOCN                             CGL020 CSD027
     D**********                             19  240WWPOBN                             CGL020 CSD027
     D  WWROCN                 1      6
     D  WWROBN                 7     12
     D  WWPOCN                13     18
     D  WWPOBN                19     24
     D  WWBENN                25     32
     D  WWBENA                33     67
     D  WWAWBN                68     75
     D  WWAWBA                76    110
     D STLNS2          DS           110
      ** Set work fields from LEACT5L0                                                        CGL020
      *                                                                                       CGL020
     D**********                              1   60ROCN                               CGL020 CSD027
     D**********                              7  120ROBN                               CGL020 CSD027
     D**********                             13  180POCN                               CGL020 CSD027
     D**********                             19  240POBN                               CGL020 CSD027
     D  ROCN                   1      6
     D  ROBN                   7     12
     D  POCN                  13     18
     D  POBN                  19     24
     D  BENN                  25     32
     D  BENA                  33     67
     D  AWBN                  68     75
     D  AWBA                  76    110
     D STLNS3          DS           110
      ** Set work fields from CLOANCL                                                         CGL020
      *                                                                                       CGL020
     D**********                              1   60ROCNL                              CGL020 CSD027
     D**********                              7  120ROBNL                              CGL020 CSD027
     D**********                             13  180POCNL                              CGL020 CSD027
     D**********                             19  240POBNL                              CGL020 CSD027
     D  ROCNL                  1      6
     D  ROBNL                  7     12
     D  POCNL                 13     18
     D  POBNL                 19     24
     D  BENNL                 25     32
     D  BENAL                 33     67
     D  AWBNL                 68     75
     D  AWBAL                 76    110
     D STLNS4          DS           110
      ** Set work fields from LOUPDL2                                                         CGL020
      *                                                                                       CGL020
     D**********                              1   60RROC                               CGL020 CSD027
     D**********                              7  120RROB                               CGL020 CSD027
     D**********                             13  180RPOC                               CGL020 CSD027
     D**********                             19  240RPOB                               CGL020 CSD027
     D  RROC                   1      6
     D  RROB                   7     12
     D  RPOC                  13     18
     D  RPOB                  19     24
     D  RBEN                  25     32
     D  RBNA                  33     67
     D  RAWB                  68     75
     D  RAWA                  76    110
     D/COPY WNCPYSRC,LEH00624
      *                                                                                       CGL020
     D SDBRCH        E DS                  EXTNAME(SDBRCHPD)                    S01117
     D**  EXTERNAL DS FOR BRANCH CODE DETAILS                             S01117
     D  BRNM         E                     EXTFLD(A8BRNM)                       S01194
     D  LOCC         E                     EXTFLD(A8LCCD)                       S01194
     D SDMMOD        E DS                  EXTNAME(SDMMODPD)                    S01194
      **  EXTERNAL DS FOR MIDAS MODULE DETAILS                            S01194
      **                                                                  S01194
     D SDBANK        E DS                  EXTNAME(SDBANKPD)                    S01195
      **  EXTERNAL DS FOR BANK DETAILS                                    S01195
     D  LCCY         E                     EXTFLD(BJLCCY)                       S01195
     D  SYSL         E                     EXTFLD(BJSLCD)                       S01195
     D  DNWD         E                     EXTFLD(BJDNWD)                       S01194
     D  EOYD         E                     EXTFLD(BJEYD)                        S01194
     D  TITL         E                     EXTFLD(BJURPT)                       S01194
     D  LEYD         E                     EXTFLD(BJPEYD)                       S01194
     D  RDNB         E                     EXTFLD(BJRDNB)                       BH1022
      **                                                                  S01194
     D SDGELR        E DS                  EXTNAME(SDGELRPD)                    S01194
      **  EXTERNAL DS FOR GENERAL LEDGER DETAILS                          S01194
     D*****         BKAPDT                          APDA                  S01194
     D**************BKALDI                          ACLD            S01194S01392
     D  APFQ         E                     EXTFLD(BKAPFQ)                       S01194
     D  ANWD         E                     EXTFLD(BKANWD)                       E41776
      **                                                                  S01194
     D SDCLND        E DS                  EXTNAME(SDCLNDPD)                    S01194
      **  EXTERNAL DS                                                     S01194
     D  ELAC         E                     EXTFLD(BPELAP)                       S01194
      **                                                                  S01194
     D SDNOST        E DS                  EXTNAME(SDNOSTPD)                    S01195
      **  EXTERNAL DS FOR NOSTRO DETAILS                                  S01195
     D  CSNM         E                     EXTFLD(A7NOSN)                       S01195
     D  ACCDBK       E                     EXTFLD(QQACCD)
     D*                                                                   S01465
     D SDHEDG        E DS                  EXTNAME(SDHEDGPD)
      ** Hedging ICD Data Structure                                                           CAS009
      *                                                                                       CAS009
     D SCSARD        E DS                  EXTNAME(SCSARDPD)                    S01465
     D**  SAR File Details Accessed via Access Program AOSARDR0           S01465
     D*                                                                   S01194
     D*                                                                   S01194
     D SDLOAN        E DS                  EXTNAME(SDLOANPD)                    S01486
     D**  Loan/Sub type via Access Program AOLOANR0                       S01486
     D*                                                                   S01486
     D SDPLIN        E DS                  EXTNAME(SDPLINPD)                    S01486
     D** Dummy record format for access to Instrument Types               S01486
     D*                                                                   S01486
     D SDPCAC        E DS                  EXTNAME(SDPCACPD)                    CAC001
     D**  PCA ICD                                                         CAC001
     D*                                                                   CAC001
      * Do NOT use AOCURR* Use SR CCYDSP to get CCY details from array                        CSC042
     D***SDCURR    E DSSDCURRPD                                                        CLE031 CSC042
     D**  EXTERNAL DS                                                                         CLE031
      * Do NOT use AOCURR* Use SR CCYDSP to get CCY details from array                        CSC042
     D*                                                                                       CLE031
     D SDCUST        E DS                  EXTNAME(SDCUSTPD)                    CPB001
     D**  External Data Structure for Customer Details.                   CPB001
     D  DFACBK       E                     EXTFLD(QQDFAC)
     D SDLOAN1       E DS                  EXTNAME(SDLOANPD)                                  CLE164
     D                                     PREFIX(LN_)                                        CLE164
     D SDFACT1       E DS                  EXTNAME(SDFACTPD)                                  CLE164
     D                                     PREFIX(FC_)                                        CLE164
     D*                                                                   CPB001
     D LESTAL        E DS                  EXTNAME(LESTALPD)
      ** External data structures for Settlement Allocation File                              CLE034
      *                                                                                       CLE034
     D  STVDAT       E                     EXTFLD(VDAT)                                     MD048609
     D  STPSTM       E                     EXTFLD(PSTM)
     D  STPONS       E                     EXTFLD(PONS)
     D  STPOBR       E                     EXTFLD(POBR)
     D  STPIBN       E                     EXTFLD(PIBN)
     D  STRSTM       E                     EXTFLD(RSTM)
     D  STRONS       E                     EXTFLD(RONS)
     D  STROBR       E                     EXTFLD(ROBR)
     D  STRIBN       E                     EXTFLD(RIBN)
     D  STREXR       E                     EXTFLD(REXR)
     D  STREXI       E                     EXTFLD(REXI)
     D  STPEXR       E                     EXTFLD(PEXR)
     D  STPEXI       E                     EXTFLD(PEXI)
     D  STPSCY       E                     EXTFLD(PSCY)
     D  STRIBA       E                     EXTFLD(RIBA)
     D  STROBN       E                     EXTFLD(ROBN)
     D  STROCN       E                     EXTFLD(ROCN)
     D  STCVMR       E                     EXTFLD(CVMR)
     D  STBENN       E                     EXTFLD(BENN)
     D  STBTB1       E                     EXTFLD(BTB1)
     D  STBTB2       E                     EXTFLD(BTB2)
     D  STBTB3       E                     EXTFLD(BTB3)
     D  STBTB4       E                     EXTFLD(BTB4)
     D  STSEQ        E                     EXTFLD(SEQ)
     D  STLASQ       E                     EXTFLD(LASQ)
     D  STTYPE       E                     EXTFLD(TYPE)
     D  STPOBN       E                     EXTFLD(POBN)
     D  STPOCN       E                     EXTFLD(POCN)
     D  STAWBN       E                     EXTFLD(AWBN)
     D  STAWBA       E                     EXTFLD(AWBA)
     D  STBENA       E                     EXTFLD(BENA)
     D  STPCRF       E                     EXTFLD(PCRF)
     D  STRCRN       E                     EXTFLD(RCRN)
     D  STRCRA       E                     EXTFLD(RCRA)
     D  STRVNO       E                     EXTFLD(RVNO)
     D  STPYBA       E                     EXTFLD(PYBA)
     D  STPYAM       E                     EXTFLD(PYAM)
     D  STRCBA       E                     EXTFLD(RCBA)
     D  STRCAM       E                     EXTFLD(RCAM)
     D  STCCY        E                     EXTFLD(CCY)
      *                                                                                       CLE034
     D*SDSVAL***E*DSSDSVALPD*                                                          218782 222373
      ****EXTERNAL*DS*FOR*SYSTEM*VALUES*                                               218782 222373
      ***********                                                                      218782 222373
     D DSFDY         E DS                  EXTNAME(DSFDY)                       S01194
     D* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01194
     D*                                                                   S01194
     D DSSDY         E DS                  EXTNAME(DSSDY)                       S01194
     D* SECOND DS FOR ACCESS PROGRAMS, LONG DATA STRUCTURE                S01194
     D*                                                                   S01194
     D DSLDY         E DS                  EXTNAME(DSLDY)                       CPB001
     D* THIRD DS FOR ACCESS PROGRAMS, VERY LONG DATA STRUCTURE            CPB001
     D*                                                                   CPB001
     D LEALLO        E DS                  EXTNAME(LEALLO)
      *                                                                                       CLE038
      ** DS for calculating PC reference.                                                     CLE038
      *                                                                                       CLE038
     D SDEXST        E DS                  EXTNAME(SDEXSTPD)
      *                                                                                       CLE038
      ** External DS for Extended settlement Instruction.                                     CLE038
      *                                                                                       CLE038
     D ACCNTAT       E DS                  EXTNAME(ACCNTAB)                                   CLE164
     D                                     PREFIX(A_)                                         CLE164
      ** External data structures to retrieve Account Type                                    CLE164
                                                                                              CLE164
      **                                                                  S01195
     D DSCSNM          DS            10                                         S01195
      ** DATA AREA FOR THE LOCATION CODE IN CUSTOMER SHORTNAME FIELD      S01195
     D  NRLC                   8     10                                         S01195
      **                                                                  S01195
     D***/COPY*ZSRSRC,ZHOLI                                                            S01195 CLE134
     D/COPY ZSRSRC,ZHOLILE                                                                    CLE134
      **  EXTERNAL DS FOR HOLIDAY DETAILS                                 S01195
     D**   JNSTAT DATA AREA
     D*JNSTAT****UDS*****                       200                                           CCB016
     D JNSTAT          DS           200
     D  PRUN                 103    105P 0
     D**                                                                  S01117
     D**   FILE INFORMATION DATA STRUCTURE - P1 AND P2                    S01117
     D**                                                                  S01117
     D SPOOL1          DS                                                       S01117
     D  SFILE1                83     92                                         S01117
     D  SFNUM1               123    124B 0                                      S01117
     D**                                                                  S01117
     D SPOOL2          DS                                                       S01117
     D  SFILE2                83     92                                         S01117
     D  SFNUM2               123    124B 0                                      S01117
     D**                                                                  S01117
     D**   FILE INFORMATION DATA STRUCTURE - AU                           S01117
     D**                                                                  S01117
     D SPOOLU          DS                                                       S01117
     D  SFILEU                83     92                                         S01117
     D  SFNUMU               123    124B 0                                      S01117
     D**                                                                  S01117
     D RUNDT           DS                                                       S01117
     D**  DATA AREA RUNDAT                                                S01117
     D  RUNA                   1      7                                         S01117
     D  RUND                   8     10P 0                                      S01117
     D  SSF                   11     11                                         S01117
     D  DATF                  12     12                                         S01117
     D  MBIN                  13     13                                         S01117
     D                 DS
     D  AKY                    1     14
     D                                     DIM(14)                              A/C KEY
     D  SHAKY                  1     10
     D************DS                                                160856182711
     D****DATA*AREA AKYS                                            160856182711
     D************                            1  10 AKYS            160856182711
     D************                            3   3 AKYS3           160856182711
     D************                           10  10 AKYS10          160856182711
     D**                                                                  S01117
     D*                                                                   S01408
     D                 DS                                                                     263411
     D  DSPDST                 1     10                                                       263411
      *                                                                                       263411
      *                                                                                       CLE134
      ** Moved the data structure copysource from I to D specs                                CLE134
      *                                                                                       CLE134
     D/COPY ZSRSRC,ZINTDYZ1LE                                                                 CLE134
     D/COPY ZSRSRC,ZDATE9Z2LE                                                                 CLE134
     D/COPY ZSRSRC,ZDAT10Z1LE                                                                 CLE134
     D/COPY ZSRSRC,ZFEB29Z1LE                                                                 CDL093
      ** +--------------------------------------+                                             CLE164
      ** ¦ Program Prototypes                   ¦                                             CLE164
      ** ¦ ==================                   ¦                                             CLE164
      ** +--------------------------------------+                                             CLE164
     D UPDATE_MATRIX   PR                  Extpgm('LE000506')                                 CLE164
     D    pRetCode                    7A                                                      CLE164
     D    pAction                     8A                                                      CLE164
     D    pFileName                  10A                                                      CLE164
     D    pLoanRef                    6A                                                      CLE164
     D    pBranch                     3A                                                      CLE164
     D    pCustomer                   6A                                                      CLE164
     D    pFeeFclty                   5S 0                                                    CLE164
     D    pFeeLoan                    6A                                                      CLE164
     D    pFeeSeqn                    2S 0                                                    CLE164
     D    pLSPDPGrpID                 3A                                                      CLE164
     D    pFTPDPGrpID                 3A                                                      CLE164
     D    pFCPDPGrpID                 3A                                                      CLE164
     D    pCategory                   5A                                                      CLE164
                                                                                              CLE164
      ** Variable declaration                                                                 CLE164
     D  Loan_Prefix    S              1A   INZ(*ZEROS)                                        CLE164
     D  wRetCode       S              7A                                                      CLE164
     D  wAction        S              8A                                                      CLE164
     D  wFile          S             10A                                                      CLE164
     D  wCustomer      S              6A   INZ(*BLANKS)                                       CLE164
     D  wFeeFclty      S              5S 0 INZ(*ZEROS)                                        CLE164
     D  wFeeLoan       S              6A   INZ(*BLANKS)                                       CLE164
     D  wFeeSeqn       S              2S 0 INZ(*ZEROS)                                        CLE164
     D  wCategory      S              5A   INZ(*BLANKS)                                       CLE164
     D  wBranch        S              3A   INZ(*BLANKS)                                       CLE164
                                                                                              CLE164
     D  aCAT           S              5A   DIM(4)                                             CLE164
     D  aORIGLN        S              5A   DIM(4)                                             CLE164
     D  aPDCL_X        S              5A   DIM(4)                                             CLE164
     D  aPDCL_Y        S              5A   DIM(4)                                             CLE164
     D  aPDCL_Z        S              5A   DIM(4)                                             CLE164
     D  aCATCOD        S              5A   DIM(4)                                             CLE164
     D  N              S              1  0 INZ(0)                                             CLE164
                                                                                              CLE164
     D  Index          S              2S 0 INZ(*ZEROS)                                        CLE164
     D  MAX_CATEGORY   S              2S 0 INZ(*ZEROS)                                        CLE164
     D  CUR_AUTO       S              1A   INZ(*BLANKS)                                       CLE164
     D  wLoanRef       S              6A   INZ(*BLANKS)                                       CLE164
     D  wLSPDPGrpID    S              3A   INZ(*BLANKS)                                       CLE164
     D  wFTPDPGrpID    S              3A   INZ(*BLANKS)                                       CLE164
     D  wFCPDPGrpID    S              3A   INZ(*BLANKS)                                       CLE164
     D  wLREF          S              6A                                                      CLE164
     D  @LNTY          S              2A                                                      CLE164
     D  @SUTP          S              2A                                                      CLE164
     D  @CLAS          S              4A                                                      CLE164
     D  @FTYP          S              3A                                                      CLE164
     D***WSKEY          S              1A                                          MD048557 MD049078
     D WACAMT          S             13P 0                                                  MD048557
      *                                                                                       CLE134
     D AMLPRI          C                   CONST('ZAAMLSETLE')
     D SECTN1          C                   CONST('LE0450001')                                 CFC006
     D SECTN2          C                   CONST('LE0450002')                                 CFC006
     D WPARML          S             20A   INZ('LECalcBasis6LeapYear')                      MD035545
     D WPARML1         S             20A   INZ('RepayDateOnMaturity')                       MD045091
     I*                                                                   S01408
      *                                                                                       CLE134
     ILKEYF1DF                                                                                CLE134
     I              RECI                        KRECI                                         CLE134
     I              QQAKEY                      KQQAKE                                        CLE134
     I              LNNO                        KLNNO                                         CLE134
     I              CNUM                        KCNUM                                         CLE134
     I              BRCA                        KBRCA                                         CLE134
     I              ACSQ                        KACSQ                                         CLE134
     I              EDAT                        KEDAT                                         CLE134
     I              EAMT                        KEAMT                                         CLE134
     I              ECCY                        KECCY                                         CLE134
     I              SETP                        KSETP                                         CLE134
     I              OSACQQ                      KOSACQ                                        CLE134
     I              REVI                        KREVI                                         CLE134
     I              OTHA                        KOTHA                                         CLE134
     I              OTHC                        KOTHC                                         CLE134
     I              EXRT                        KEXRT                                         CLE134
     I              STDT                        KSTDT                                         CLE134
     I              SLID                        KSLID                                         CLE134
     I              MDAT                        KMDAT                                         CLE134
     I              BRTT                        KBRTT                                         CLE134
     I              BRTE                        KBRTE                                         CLE134
     I              RTSP                        KRTSP                                         CLE134
     I              INTR                        KINTR                                         CLE134
     I              SSEQ                        KSSEQ                                         CLE134
     I              CPAM                        KCPAM                                         CLE134
     I              PACD                        KPACD                                         CLE134
     I              ICBS                        KICBS                                         CLE134
     I              ACOF                        KACOF                                         CLE134
     I              ZZ002                       KZZ002                                        CLE134
     I              FACO                        KFACO                                         CLE134
     I              PRFC                        KPRFC                                         CLE134
     I              OSBR                        KOSBR                                         CLE134
     I              BOKC                        KBOKC                                         CLE134
     I              PELAP                       KPELAP                                        CLE134
     I              ORED                        KORED                                         CLE134
     I              OLNO                        KOLNO                                         CLE134
     I              PTFR                        KPTFR                                         CLE134
     I              SCCY                        KSCCY                                         CLE134
     I              ANUM                        KANUM                                         CLE134
     I              ROLN                        KROLN
     I              GASS                        KGASS                                         CLE134
     I              F1FFLG                      KF1FFL                                        CLE134
     I              F1FVAL                      KF1FVA                                        CLE134
     I              F1FPCT                      KF1FPC                                        CLE134
     I              F1RACT                      KF1RAC                                        CLE134
     I              F1RCTY                      KF1RCT                                        CLE134
     I              F1RBNK                      KF1RBN                                        CLE134
     I              F1RCDE                      KF1RCD                                        CLE134
     I              F1PACT                      KF1PAC                                        CLE134
     I              F1PCTY                      KF1PCT                                        CLE134
     I              F1PBNK                      KF1PBN                                        CLE134
     I              F1PCDE                      KF1PCD                                        CLE134
     I              F1DACT                      KF1DAC                                        CLE134
     I              F1DCTY                      KF1DCT                                        CLE134
     I              F1DBNK                      KF1DBN                                        CLE134
     I              F1SDAT                      KF1SDA                                        CLE134
     I              SIND                        KSIND                                         CLE134
     I              RIND                        KRIND                                         CLE134
     I              OKEY                        KOKEY                                         CLE134
     I              OSAC                        KOSAC                                         CLE134
     I              AKEY                        KAKEY                                         CLE134
     I              AAMT                        KAAMT                                         CLE134
     I              PAMT                        KPAMT                                         CLE134
     I              IAMT                        KIAMT                                         CLE134
     I              ABRCA                       KABRCA                                        CLE134
     I              ACNUM                       KACNUM                                        CLE134
     I              AVDAT                       KAVDAT                                        CLE134
     I              APRSQ                       KAPRSQ                                        CLE134
     I              ALASN                       KALASN                                        CLE134
     I              IPFL                        KIPFL                                         CLE134
      *                                                                                       CLE134
      ** Rename fields                                                                        CLE134
      *                                                                                       CLE134
     ILEPDUED0                                                                                CLE134
      *                                                                                       CLE134
      ** Rename fields                                                                        CLE134
      *                                                                                       CLE134
     I              YTKPACL                     YTKPAC                                        CLE134
     I              YTKPABR                     YTKPAB                                        CLE134
     I              YTKPAAC                     YTKPAA                                        CLE134
     I              YTKPASE                     YTKPAS                                        CLE134
     I              YTKPACY                     YTKPCY
      *                                                                                       CLE134
     I              YTKIACL                     YTKIAC                                        CLE134
     I              YTKIABR                     YTKIAB                                        CLE134
     I              YTKIAAC                     YTKIAA                                        CLE134
     I              YTKIASE                     YTKIAS                                        CLE134
     I              YTKIACY                     YTKICY                                        CLE134
      *                                                                                       CLE134
     ILEPDUED1                                                                                CLE134
      *                                                                                       CLE134
      ** Rename fields                                                                        CLE134
      *                                                                                       CLE134
     I              YTKPACL                     YTKPAC                                        CLE134
     I              YTKPABR                     YTKPAB                                        CLE134
     I              YTKPAAC                     YTKPAA                                        CLE134
     I              YTKPASE                     YTKPAS                                        CLE134
     I              YTKPACY                     YTKPCY                                        CLE134
      *                                                                                       CLE134
     I              YTKIACL                     YTKIAC                                        CLE134
     I              YTKIABR                     YTKIAB                                        CLE134
     I              YTKIAAC                     YTKIAA                                        CLE134
     I              YTKIASE                     YTKIAS                                        CLE134
     I              YTKIACY                     YTKICY                                        CLE134
      *                                                                                       CLE134
     ILEPDUED4                                                                                CLE134
      *                                                                                       CLE134
      ** Rename fields                                                                        CLE134
      *                                                                                       CLE134
     I              YTKPACL                     YTKPAC                                        CLE134
     I              YTKPABR                     YTKPAB                                        CLE134
     I              YTKPAAC                     YTKPAA                                        CLE134
     I              YTKPASE                     YTKPAS                                        CLE134
     I              YTKPACY                     YTKPCY                                        CLE134
      *                                                                                       CLE134
     I              YTKIACL                     YTKIAC                                        CLE134
     I              YTKIABR                     YTKIAB                                        CLE134
     I              YTKIAAC                     YTKIAA
     I              YTKIASE                     YTKIAS                                        CLE134
     I              YTKIACY                     YTKICY                                        CLE134
      *                                                                                       CLE134
     ILEPDUED5                                                                                CLE134
      *                                                                                       CLE134
      ** Rename fields                                                                        CLE134
      *                                                                                       CLE134
     I              YTKPACL                     YTKPAC                                        CLE134
     I              YTKPABR                     YTKPAB
     I              YTKPAAC                     YTKPAA                                        CLE134
     I              YTKPASE                     YTKPAS                                        CLE134
     I              YTKPACY                     YTKPCY                                        CLE134
      *                                                                                       CLE134
     I              YTKIACL                     YTKIAC                                        CLE134
     I              YTKIABR                     YTKIAB                                        CLE134
     I              YTKIAAC                     YTKIAA                                        CLE134
     I              YTKIASE                     YTKIAS                                        CLE134
     I              YTKIACY                     YTKICY
      *                                                                                       CLE134
     ILEPDUFD0                                                                                CLE134
      *                                                                                       CLE134
      ** Rename fields                                                                        CLE134
      *                                                                                       CLE134
     I              YTKPACL                     YTKPAC                                        CLE134
     I              YTKPABR                     YTKPAB                                        CLE134
     I              YTKPAAC                     YTKPAA                                        CLE134
     I              YTKPASE                     YTKPAS                                        CLE134
     I              YTKPACY                     YTKPCY                                        CLE134
      *                                                                                       CLE134
     ILEPDUFD6                                                                                CLE134
      *                                                                                       CLE134
      ** Rename fields                                                                        CLE134
      *                                                                                       CLE134
     I              YTKPACL                     YTKPAC                                        CLE134
     I              YTKPABR                     YTKPAB                                        CLE134
     I              YTKPAAC                     YTKPAA                                        CLE134
     I              YTKPASE                     YTKPAS                                        CLE134
     I              YTKPACY                     YTKPCY                                        CLE134
      *                                                                                       CLE134
     ICLOANCLZ                                                                                CLE134
      *                                                                                       CLE134
      ** Rename fields                                                                        CLE134
      *                                                                                       CLE134
     I              RECI                        XRECI                                         CLE134
     I              BRCA                        XBRCA                                         CLE134
     I              LNRF                        XLNRF                                         CLE134
     I              CNUM                        XCNUM                                         CLE134
     I              CPAM                        XCPAM                                         CLE134
      *                                                                                       CLE134
     IACCNTABF                                                                                CLE134
      *                                                                                       CLE134
      ** Rename fields                                                                        CLE134
      *                                                                                       CLE134
     I              RECI                        PRECI                                         CLE134
     I              CNUM                        PCNUM                                         CLE134
     I              CCY                         PCCY                                          CLE134
     I              ACODQQ                      PACODQ                                        CLE134
     I              ACSQ                        PACSQ                                         CLE134
     I              ZZ006                       PZZ006                                        CLE134
     I              BRCA                        PBRCA                                         CLE134
     I              ATYP                        PATYP                                         CLE134
     I              STYP                        PSTYP                                         CLE134
     I              MFFQ                        PMFFQ                                         CLE134
     I              ACST                        PACST                                         CLE134
     I              DACO                        PDACO                                         CLE134
     I              DACC                        PDACC                                         CLE134
     I              ANAM                        PANAM                                         CLE134
     I              LDBL                        PLDBL                                         CLE134
     I              CLBL                        PCLBL                                         CLE134
     I              STFQ                        PSTFQ                                         CLE134
     I              STDY                        PSTDY                                         CLE134
     I              LSTD                        PLSTD                                         CLE134
     I              NSTD                        PNSTD                                         CLE134
     I              LSTP                        PLSTP                                         CLE134
     I              CFSB                        PCFSB                                         CLE134
     I              LMVD                        PLMVD                                         CLE134
     I              EPLB                        PEPLB                                         CLE134
     I              EPCB                        PEPCB                                         CLE134
     I              YTDB                        PYTDB                                         CLE134
     I              GLBT                        PGLBT                                         CLE134
     I              ADREF1                      PADREF                                        CLE134
     I              PRFC                        PPRFC                                         CLE134
     I              ZZ004                       PZZ004                                        CLE134
     I              ORED                        PORED                                         CLE134
     I              DLIM                        PDLIM                                         CLE134
     I              LRCR                        PLRCR                                         CLE134
     I              RTCB                        PRTCB                                         CLE134
     I              RTLB                        PRTLB                                         CLE134
     I              DITM                        PDITM                                         CLE134
     I              CITM                        PCITM                                         CLE134
     I              ADREF2                      PADRF2                                        CLE134
     I              ZZ002                       PZZ002                                        CLE134
     I              CDIR                        PCDIR                                         CLE134
     I              CCIR                        PCCIR                                         CLE134
     I              ACNO                        PACNO                                         CLE134
     I              RETB                        PRETB                                         CLE134
     I              ODSC                        PODSC                                         CLE134
     I              ODLN                        PODLN                                         CLE134
     I              ODED                        PODED                                         CLE134
     I              DIOD                        PDIOD                                         CLE134
     I              FACT                        PFACT                                         CLE134
     I              FCNO                        PFCNO                                         CLE134
     I              EFAC                        PEFAC                                         CLE134
     I              HELD                        PHELD                                         CLE134
     I              MINB                        PMINB                                         CLE134
     I              LACD                        PLACD                                         CLE134
     I              LISP                        PLISP                                         CLE134
     I              RRNM                        PRRNM                                         CLE134
     I              DRIB                        PDRIB                                         CLE134
     I              DRIS                        PDRIS                                         CLE134
     I              DRCD                        PDRCD                                         CLE134
     I              DRIC                        PDRIC                                         CLE134
     I              DRIF                        PDRIF                                         CLE134
     I              DRDY                        PDRDY                                         CLE134
     I              NDID                        PNDID                                         CLE134
     I              LDID                        PLDID                                         CLE134
     I              LDIA                        PLDIA                                         CLE134
     I              SDAP                        PSDAP                                         CLE134
     I              LPAR                        PLPAR                                         CLE134
     I              DIIE                        PDIIE                                         CLE134
     I              DAIC                        PDAIC                                         CLE134
     I              MADI                        PMADI                                         CLE134
     I              GADI                        PGADI                                         CLE134
     I              DDIS                        PDDIS                                         CLE134
     I              DDIA                        PDDIA                                         CLE134
     I              OLDR                        POLDR
     I              OLDB                        POLDB                                         CLE134
     I              OLDS                        POLDS                                         CLE134
     I              CRIB                        PCRIB                                         CLE134
     I              CRIS                        PCRIS                                         CLE134
     I              CRCD                        PCRCD                                         CLE134
     I              CRIC                        PCRIC                                         CLE134
     I              CRIF                        PCRIF                                         CLE134
     I              CRDY                        PCRDY                                         CLE134
     I              NCID                        PNCID                                         CLE134
     I              LCID                        PLCID                                         CLE134
     I              LCIA                        PLCIA                                         CLE134
     I              SCAP                        PSCAP                                         CLE134
     I              LPAP                        PLPAP                                         CLE134
     I              CIIE                        PCIIE                                         CLE134
     I              CAIC                        PCAIC                                         CLE134
     I              MACI                        PMACI                                         CLE134
     I              GACI                        PGACI                                         CLE134
     I              CDIS                        PCDIS                                         CLE134
     I              DCIA                        PDCIA                                         CLE134
     I              OLCR                        POLCR                                         CLE134
     I              OLCB                        POLCB                                         CLE134
     I              OLCS                        POLCS                                         CLE134
     I              LCD                         PLCD                                          CLE134
     I              CHTP                        PCHTP                                         CLE134
     I              TNLU                        PTNLU                                         CLE134
     I              BRTCA                       PBRTCA                                        CLE134
     I              NACSG                       PNACSG                                        CLE134
     I              R4ACNT                      PR4ACN                                        CLE134
     I              ENOC                        PENOC                                         CLE134
     I              EPNO                        PEPNO                                         CLE134
     I              ECFB                        PECFB                                         CLE134
     I              LTAB                        PLTAB                                         CLE134
     I              LTACQQ                      PLTACQ
     I              LTAS                        PLTAS                                         CLE134
     I              HCFB                        PHCFB                                         CLE134
     I              PTFR                        PPTFR                                         CLE134
     I              HLEX                        PHLEX                                         CLE134
     I              A5TIAC                      PA5TIC                                        CLE134
     I              A5TIAN                      PA5TIN                                        CLE134
     I              A5TIAS                      PA5TIS                                        CLE134
     I              EUSB                        PEUSB                                         CLE134
     I              IBAN                        PIBAN                                         CLE134
     I              IBSEQN                      PIBSEQ                                        CLE134
     I              FRNT                        PFRNT                                         CLE134
     I              AFRT                        PAFRT                                         CLE134
     I              REPA                        PREPA                                         CLE134
     I              TMST                        PTMST                                         CLE134
     I              REPI                        PREPI                                         CLE134
     I              ACOD                        PACOD                                         CLE134
     I              LTAC                        PLTAC                                         CLE134
     I              FCCU                        PFCCU                                         CLE134
     I              COLF                        PCOLF                                         CLE134
     I              BCOA                        PBCOA                                         CLE134
     I              COLA                        PCOLA                                         CLE134
     I              PFCU                        PPFCU                                         CLE134
     I              PFTP                        PPFTP                                         CLE134
     I              PFSQ                        PPFSQ                                         CLE134
     I              A5ACKY                      PA5CKY                                        CLE134
     I              A5INTL                      PA5INT                                        CLE134
     I              A5TIAB                      PA5TIB                                        CLE134
     I              AUTH                        PAUTH                                         CLE134
      *                                                                                       263416
     ILOMNEWF                                                                                 236416
     I              RECI                        RECI2                                         263416
     I              LNRF                        LNRF2                                         236416
     I              VDAT                        VDAT2                                         263416
     I              LASN                        LASN2                                         236416
     I              MRIN                        MRIN2                                         263416
     I              LTYP                        LTYP2                                         236416
     I              SUTP                        SUTP2                                         263416
     I              PTYP                        PTYP2                                         236416
     I              AMTP                        AMTP2                                         263416
     I              PRSQ                        PRSQ2                                         236416
     I              BRTT                        BRTT2                                         263416
     I              RTSP                        RTSP2                                         236416
     I              CCY                         CCY2                                          263416
     I              PRAM                        PRAM2                                         236416
     I              INTA                        INTA2                                         263416
     I              WTXA                        WTXA2                                         236416
     I              FEAM                        FEAM2                                         263416
     I              TAMT                        TAMT2                                         236416
     I              BRCA                        BRCA2                                         263416
     I              CNUM                        CNUM2                                         236416
     I              REPT                        REPT2                                         263416
     I              AUTO                        AUTO2                                         236416
     I              STAI                        STAI2                                         263416
     I              SETP                        SETP2                                         236416
     I              OSACQQ                      OSAC2Q                                        263416
     I              TSEN                        TSEN2                                         236416
     I              FACO                        FACO2                                         263416
     I              SPI1                        SPI12                                         236416
     I              SPI2                        SPI22                                         263416
     I              SPI3                        SPI32                                         236416
     I              LAIN                        LAIN2                                         263416
     I              BRTE                        BRTE2                                         236416
     I              SPIN                        SPIN2                                         263416
     I              CALC                        CALC2                                         236416
     I              WTIN                        WTIN2                                         263416
     I              LLAG                        LLAG2                                         236416
     I              LWOI                        LWOI2                                         263416
     I              XAVD                        XAVD2                                         236416
     I              XASQ                        XASQ2                                         236416
     I              FCUS                        FCUS2                                         263416
     I              FTYP                        FTYP2                                         236416
     I              FSEQ                        FSEQ2                                         263416
     I              RLON                        RLON2                                         236416
     I              FECD                        FECD2                                         236416
     I              PONI                        PONI2                                         263416
     I              ACTI                        ACTI2                                         236416
     I              CNFY                        CNFY2                                         263416
     I              TLXY                        TLXY2                                         236416
     I              CBLY                        CBLY2                                         236416
     I              INTC                        INTC2                                         263416
     I              NACD                        NACD2                                         263416
     I              ACBI                        ACBI2                                         236416
     I              ZZ001                       ZZ0012                                        236416
     I              LSWCC                       LSWC2                                         263416
     I              LSWSC                       LSWS2                                         236416
     I              OSBR                        OSBR2                                         263416
     I              FCLB                        FCLB2                                         236416
     I              LSMD                        LSMD2                                         236416
     I              REBT                        REBT2                                         263416
     I              ZZ034                       ZZ0342                                        263416
     I              ORED                        ORED2                                         236416
     I              LCD                         LCD2                                          236416
     I              CHTP                        CHTP2                                         263416
     I              TNLU                        TNLU2                                         236416
     I              RSTM                        RSTM2                                         263416
     I              RONSQQ                      RONS2Q                                        236416
     I              RIBN                        RIBN2                                         236416
     I              RIBA                        RIBA2                                         263416
     I              ROBN                        ROBN2                                         263416
     I              ROCN                        ROCN2                                         236416
     I              PSTM                        PSTM2                                         236416
     I              PONSQQ                      PONS2Q                                        263416
     I              PIBN                        PIBN2                                         236416
     I              PIBA                        PIBA2                                         263416
     I              POBN                        POBN2                                         236416
     I              POCN                        POCN2                                         236416
     I              RCRN                        RCRN2                                         263416
     I              RCRA                        RCRA2                                         263416
     I              RVNO                        RVNO2                                         236416
     I              AWBN                        AWBN2                                         236416
     I              AWBA                        AWBA2                                         263416
     I              BENN                        BENN2                                         236416
     I              BENA                        BENA2                                         263416
     I              DTP1                        DTP12                                         236416
     I              DTP2                        DTP22                                         236416
     I              DTP3                        DTP32                                         263416
     I              DTP4                        DTP42                                         263416
     I              DCHG                        DCHG2                                         236416
     I              BTB1                        BTB12                                         236416
     I              BTB2                        BTB22                                         263416
     I              BTB3                        BTB32                                         236416
     I              BTB4                        BTB42                                         263416
     I              BTB5                        BTB52                                         236416
     I              BTB6                        BTB62                                         236416
     I              CVMR                        CVMR2                                         263416
     I              FSRP                        FSRP2                                         236416
     I              FSGN                        FSGN2                                         263416
     I              FPRC                        FPRC2                                         236416
     I              COFA                        COFA2                                         236416
     I              IRCF                        IRCF2                                         263416
     I              FRCF                        FRCF2                                         263416
     I              DFTP                        DFTP2                                         236416
     I              DFST                        DFST2                                         236416
     I              MNSG                        MNSG2                                         263416
     I              GASS                        GASS2                                         236416
     I              GPRT                        GPRT2                                         263416
     I              NRLI                        NRLI2                                         236416
     I              ROLN                        ROLN2                                         236416
     I              ROSN                        ROSN2                                         263416
     I              ROBR                        ROBR2                                         263416
     I              RORC                        RORC2                                         236416
     I              PDGN                        PDGN2                                         236416
     I              GRIN                        GRIN2                                         263416
     I              RLCY                        RLCY2                                         236416
     I              PNAM                        PNAM2                                         263416
     I              PAST                        PAST2                                         236416
     I              ASTS                        ASTS2                                         236416
     I              IUSR                        IUSR2                                         263416
     I              AUSR                        AUSR2                                         263416
     I              XUSR                        XUSR2                                         236416
     I              PCRF                        PCRF2                                         236416
     I              PCOB                        PCOB2                                         263416
     I              MTPD                        MTPD2                                         236416
     I              PDDI                        PDDI2                                         263416
     I              PTDI                        PTDI2                                         236416
     I              SCCY                        SCCY2                                         236416
     I              ICCY                        ICCY2                                         263416
     I              ECIN                        ECIN2                                         236416
     I              REPI                        REPI2                                         263416
     I              CHDU                        CHDU2                                         236416
     I              INTN                        INTN2                                         236416
     I              FSPRAM                      FSPR2M                                        263416
     I              REXR                        REXR2                                         236416
     I              REXI                        REXI2                                         263416
     I              PSCY                        PSCY2                                         236416
     I              PEXR                        PEXR2                                         236416
     I              PEXI                        PEXI2                                         263416
     I              STAL                        STAL2                                         263416
     I              FRNT                        FRNT2                                         236416
     I              AFRT                        AFRT2                                         236416
     I              REPA                        REPA2                                         263416
     I              TMST                        TMST2                                         236416
     I              OSAC                        OSAC2                                         263416
     I              RONS                        RONS2                                         236416
     I              PONS                        PONS2                                         236416
     I              AUTH                        AUTH2                                         263416
     I              FRCY                        FRCY2                                         236416
     I              FRAM                        FRAM2                                         263416
     I              FINT                        FINT2                                         236416
     I              FTXA                        FTXA2                                         236416
     I              FTOT                        FTOT2                                         263416
     I              FPEN                        FPEN2                                         236416
     I              BASR                        BASR2                                         263416
     I              SLTP                        SLTP2                                         263416
     I              SLST                        SLST2                                         263416
     I              CLAS                        CLAS2                                         263416
     I              DFCL                        DFCL2                                         263416
     I              SLCL                        SLCL2                                         263416
      *                                                                                       262597
     IACCNTB1F                                                                                262597
      *                                                                                       262597
      ** Rename fields                                                                        262597
      *                                                                                       262597
     I              RECI                        ZRECI                                         262597
     I              CNUM                        ZCNUM                                         262597
     I              CCY                         ZCCY                                          262597
     I              ACODQQ                      ZACODQ                                        262597
     I              ACSQ                        ZACSQ                                         262597
     I              ZZ006                       ZZZ006                                        262597
     I              BRCA                        ZBRCA                                         262597
     I              ATYP                        ZATYP                                         262597
     I              STYP                        ZSTYP                                         262597
     I              MFFQ                        ZMFFQ                                         262597
     I              ACST                        ZACST                                         262597
     I              DACO                        ZDACO                                         262597
     I              DACC                        ZDACC                                         262597
     I              ANAM                        ZANAM                                         262597
     I              LDBL                        ZLDBL                                         262597
     I              CLBL                        ZCLBL                                         262597
     I              STFQ                        ZSTFQ                                         262597
     I              STDY                        ZSTDY                                         262597
     I              LSTD                        ZLSTD                                         262597
     I              NSTD                        ZNSTD                                         262597
     I              LSTP                        ZLSTP                                         262597
     I              CFSB                        ZCFSB                                         262597
     I              LMVD                        ZLMVD                                         262597
     I              EPLB                        ZEPLB                                         262597
     I              EPCB                        ZEPCB                                         262597
     I              YTDB                        ZYTDB                                         262597
     I              GLBT                        ZGLBT                                         262597
     I              ADREF1                      ZADREF                                        262597
     I              PRFC                        ZPRFC                                         262597
     I              ZZ004                       ZZZ004                                        262597
     I              ORED                        ZORED                                         262597
     I              DLIM                        ZDLIM                                         262597
     I              LRCR                        ZLRCR                                         262597
     I              RTCB                        ZRTCB                                         262597
     I              RTLB                        ZRTLB                                         262597
     I              DITM                        ZDITM                                         262597
     I              CITM                        ZCITM                                         262597
     I              ADREF2                      ZADRF2                                        262597
     I              ZZ002                       ZZZ002                                        262597
     I              CDIR                        ZCDIR                                         262597
     I              CCIR                        ZCCIR                                         262597
     I              ACNO                        ZACNO                                         262597
     I              RETB                        ZRETB                                         262597
     I              ODSC                        ZODSC                                         262597
     I              ODLN                        ZODLN                                         262597
     I              ODED                        ZODED                                         262597
     I              DIOD                        ZDIOD                                         262597
     I              FACT                        ZFACT                                         262597
     I              FCNO                        ZFCNO                                         262597
     I              EFAC                        ZEFAC                                         262597
     I              HELD                        ZHELD                                         262597
     I              MINB                        ZMINB                                         262597
     I              LACD                        ZLACD                                         262597
     I              LISP                        ZLISP                                         262597
     I              RRNM                        ZRRNM                                         262597
     I              DRIB                        ZDRIB                                         262597
     I              DRIS                        ZDRIS                                         262597
     I              DRCD                        ZDRCD                                         262597
     I              DRIC                        ZDRIC                                         262597
     I              DRIF                        ZDRIF                                         262597
     I              DRDY                        ZDRDY                                         262597
     I              NDID                        ZNDID                                         262597
     I              LDID                        ZLDID                                         262597
     I              LDIA                        ZLDIA                                         262597
     I              SDAP                        ZSDAP                                         262597
     I              LPAR                        ZLPAR                                         262597
     I              DIIE                        ZDIIE                                         262597
     I              DAIC                        ZDAIC                                         262597
     I              MADI                        ZMADI                                         262597
     I              GADI                        ZGADI                                         262597
     I              DDIS                        ZDDIS                                         262597
     I              DDIA                        ZDDIA                                         262597
     I              OLDR                        ZOLDR                                         262597
     I              OLDB                        ZOLDB                                         262597
     I              OLDS                        ZOLDS                                         262597
     I              CRIB                        ZCRIB                                         262597
     I              CRIS                        ZCRIS                                         262597
     I              CRCD                        ZCRCD                                         262597
     I              CRIC                        ZCRIC                                         262597
     I              CRIF                        ZCRIF                                         262597
     I              CRDY                        ZCRDY                                         262597
     I              NCID                        ZNCID                                         262597
     I              LCID                        ZLCID                                         262597
     I              LCIA                        ZLCIA                                         262597
     I              SCAP                        ZSCAP                                         262597
     I              LPAP                        ZLPAP                                         262597
     I              CIIE                        ZCIIE                                         262597
     I              CAIC                        ZCAIC                                         262597
     I              MACI                        ZMACI                                         262597
     I              GACI                        ZGACI                                         262597
     I              CDIS                        ZCDIS                                         262597
     I              DCIA                        ZDCIA                                         262597
     I              OLCR                        ZOLCR                                         262597
     I              OLCB                        ZOLCB                                         262597
     I              OLCS                        ZOLCS                                         262597
     I              LCD                         ZLCD                                          262597
     I              CHTP                        ZCHTP                                         262597
     I              TNLU                        ZTNLU                                         262597
     I              BRTCA                       ZBRTCA                                        262597
     I              NACSG                       ZNACSG                                        262597
     I              R4ACNT                      ZR4ACN                                        262597
     I              ENOC                        ZENOC                                         262597
     I              EPNO                        ZEPNO                                         262597
     I              ECFB                        ZECFB                                         262597
     I              LTAB                        ZLTAB                                         262597
     I              LTACQQ                      ZLTACQ                                        262597
     I              LTAS                        ZLTAS                                         262597
     I              HCFB                        ZHCFB                                         262597
     I              PTFR                        ZPTFR                                         262597
     I              HLEX                        ZHLEX                                         262597
     I              A5TIAC                      ZA5TIC                                        262597
     I              A5TIAN                      ZA5TIN                                        262597
     I              A5TIAS                      ZA5TIS                                        262597
     I              EUSB                        ZEUSB                                         262597
     I              IBAN                        ZIBAN                                         262597
     I              IBSEQN                      ZIBSEQ                                        262597
     I              FRNT                        ZFRNT                                         262597
     I              AFRT                        ZAFRT                                         262597
     I              REPA                        ZREPA                                         262597
     I              TMST                        ZTMST                                         262597
     I              REPI                        ZREPI                                         262597
     I              ACOD                        ZACOD                                         262597
     I              LTAC                        ZLTAC                                         262597
     I              FCCU                        ZFCCU                                         262597
     I              COLF                        ZCOLF                                         262597
     I              BCOA                        ZBCOA                                         262597
     I              COLA                        ZCOLA                                         262597
     I              PFCU                        ZPFCU                                         262597
     I              PFTP                        ZPFTP                                         262597
     I              PFSQ                        ZPFSQ                                         262597
     I              A5ACKY                      ZA5CKY                                        262597
     I              A5INTL                      ZA5INT                                        262597
     I              A5TIAB                      ZA5TIB                                        262597
     I              AUTH                        ZAUTH                                         262597
      *                                                                                       262597
     I/COPY WNCPYSRC,LE0450IIP2                                           S01408
     I*                                                                   S01408
0083 I**
0084 I**   CUSTOMER LENDING LOANS FILE - HEADER RECORD
0085 I**
0086 I*OUPD***NS*      1 CH                                               S01117
0087 I***********                             1   1 RECI                  S01117
0088 I***********                             2   70LNRF                  S01117
0089 I***********                             8   8 RCDT                  S01117
0090 I**
0091 I**   LOANS FILE - DETAIL 1 - SOME FIELDS HAVE 'L' ON END
0092 I**
0093 I********NS* 02   1 CD   8 CA                                        S01117
     ILOUPDL1   NS  02    1 CD    8 CA                                          S01117
0094 I         OR         1 CM    8 CA
0095 I         OR         1 CR    8 CA
0096 I                                  1    1  RECIL
0097 I**********                        2    7 0LNRF            M2                            CLE148
     I                                  2    7  LNRF            M2                            CLE148
0098 I                                  8    8  RCDT
0099 I                                  9    9 0MRIN            M1
0100 I                                 10   11 0PTYP
0101 I**********                             12  170CNUML                                     CSD027
0101 I                                 12   17  CNUML
0102 I***********                            18  200BRCDL                 S01117
0102 I                                 18   20  BRCA          L1M3              S01117
0103 I                                 21   22  LTYP
0104 I                                 23   24  SUTP
0105 I                             P   25   27 0DDAT
0106 I                             P   28   30 0VDATL
0107 I                             P   31   33 0MDAT                    20
0108 I                                 34   35 0LASQ
0109 I**********                             36  410FCUS                                      CSD027
0109 I                                 36   41  FCUS
0110 I                                 42   44 0FTYP
0111 I                                 45   46 0FSEQ
0112 I                                 47   49  CCYL
0113 I                             P   50   56 0CPAM
0114 I                                 57   57  INTC
0115 I                             P   58   63 7INTRL
0116 I                                 64   65 0BRTTL
0117 I                             P   66   71 7BRTEL
L118 I                             P   72   77 7RTSPL
0119 I                             P   78   81 5MARG
0120 I                                 82   82  SPINL
     I                                 83   83  CHINL
0122 I                             P   84   89 7WTRTL
0123 I                                 90   90  WTINL
0124 I                                 91   91 0REPTL
0125 I                             P   92   98 0RAMT
0126 I                             P   99  101 0NRPD
0127 I                                102  102  RFRQ
0128 I                                103  104 0RDYN
0129 I                                105  107  FCCY
0130 I                                108  110 0LIND
0131 I                                111  112  CRSK
0132 I                                113  114  ACOF
0133 I                                115  115  NACD
0134 I                                116  116  RELI
0135 I                                117  117  AUTOL
0136 I                             P  118  124 0PSAM
0137 I                             P  125  131 8BCXR
0138 I                             P  132  138 8FCXR
0139 I                                139  140 0SDST
0140 I**********                            141 152 OSDA                                      CGL029
     I                                141  152  OSDAQQ
0141 I                                153  162  TSTN
0142 I                                163  164 0MDST
0143 I**********                            165 176 OMDA                                      CGL029
     I                                165  176  OMDAQQ
0144 I                                177  186  TMAN
0145 I***********************************   187 196 FACO                  S05452
     I                                187  196  FACOL                           S05452
0146 I                             P  197  199 0RLDT
0147 I                             P  200  202 0NROD
0148 I                                203  203  RLFQ
0149 I                                204  205 0RLDY
     I                                206  206  RDFC                            S01392
0150 I                                207  208 0NBRA
0151 I                             P  209  214 7NRTS
0152 I                                215  215  NSIN
0153 I                                216  216 0NCAC
0154 I                             P  217  223 0AWTP
0155 I                             P  224  230 0WTRD
0156 I                             P  231  237 0WTWD
0157 I                             P  238  244 0IWOD
0158 I                             P  245  251 0PWOD
0159 I                                252  252  BMDI
0160 I                                253  253  FMDI
0161 I                             P  254  260 0PDIN
     I                             P  261  262 0LSWCL                                       MD039672
     I                             P  263  264 0LSWSL                                       MD039672
     I                                265  267  OSDB                            S01117
     I                                268  270  OMDB                            S01117
     I                                271  273  ORBR                            S01117
     I                                274  277  PRFC                            S01117
     I                                278  280  FCLB                            S01117
0162 I                                287  287  BTIN
     I/COPY WNCPYSRC,LE0450I003
0163 I                                288  289 0BLDY
     I/COPY WNCPYSRC,LE0450I004
0164 I**********                            290 2950OLNO                                      CSD027
     I                                290  295  OLNO
0165 I                                296  296  RCSI
0166 I                                297  297 0ICBS
0167 I                                298  298  IPFR
0168 I                             P  299  305 0TOTI
0169 I                             P  306  308 0NIDT
0170 I                             P  309  311 0IBDT
0171 I                             P  312  314 0SLID
0172 I                             P  315  321 0AIPD
0173 I                             P  322  324 0DLRC
0174 I                             P  325  327 0IACD
0175 I                             P  328  334 0AITC
     I                             P  328  334 0AITCL                           S01392
0176 I                             P  335  341 0TFEP
0177 I                             P  342  348 0AIAP
0178 I                             P  349  355 0IPRD
0179 I                             P  356  362 0IPRM
0180 I                             P  363  369 0ICTD
0181 I                             P  370  376 0AIMN
0182 I                             P  377  379 0RBDT
0183 I                             P  380  381 0NOPS
     I                                382  382  NCHI
0184 I                                384  385 0IFDY
0185 I                                386  386  LONI
0186 I                                387  387  CNFI
0187 I                                388  388  ACEI
0188 I                                389  389  TLXI
0189 I                                390  390  CBLI
0190 I***********                         P 391 3930ORED                  E47260
0190 I                             P  391  393 0LORED                           E47260
0191 I                             P  394  396 0LCD
0192 I                                397  397  CHTP
0193 I                             P  398  400 0TNLU
     I                                401  401  ADDI                            S01392
     I                                402  404 0ORMD                                              AR
0193 I                                435  436  BOKC                            S01220
     I**********                            437 4420COCU                               S01465 CSD027
     I**********                            443 4480RECE                               S01465 CSD027
     I                                437  442  COCU
     I                                443  448  RECE
     I                             P  449  451 0OMDT                            S01465
     I                             P  452  454 0NIPD                            S01465
     I                             P  455  457 0NMDT                            S01465
     I                                458  458  APMI                            S01465
     I                                459  460 0RSTML                           S01518
     I**********                            461 472 RONSL                              S01518 CGL029
     I                                461  472  QQRONS
     I                                473  480  RIBNL                           S01518
     I                                481  515  RIBAL                           S01518
     I**********                            516 5210ROBNL                              S01518 CSD027
     I**********                            522 5270ROCNL                              S01518 CSD027
     I                                516  521  ROBNL
     I                                522  527  ROCNL
     I                                528  529 0PSTML                           S01518
     I**********                            530 541 PONSL                              S01518 CGL029
     I                                530  541  QQPONS
     I                                542  549  PIBNL                           S01518
     I                                550  584  PIBAL                           S01518
     I**********                            585 5900POBNL                              S01518 CSD027
     I**********                            591 5960POCNL                              S01518 CSD027
     I                                585  590  POBNL
     I                                591  596  POCNL
     I                                597  604  RCRNL                           S01518
     I                                605  639  RCRAL                           S01518
     I                                640  647  RVNOL                           S01518
     I                                648  655  AWBNL                           S01518
     I                                656  690  AWBAL                           S01518
     I                                691  698  BENNL                           S01518
     I                                699  733  BENAL                           S01518
     I                                734  768  DTP1L                           S01518
     I                                769  803  DTP2L                           S01518
     I                                804  838  DTP3L                           S01518
     I                                839  873  DTP4L                           S01518
     I                                874  876  DCHGL                           S01518
     I                                877  911  BTB1L                           S01518
     I                                912  946  BTB2L                           S01518
     I                                947  981  BTB3L                           S01518
     I                                982 1016  BTB4L                           S01518
     I                               1017 1051  BTB5L                           S01518
     I                               1052 1086  BTB6L                           S01518
     I                               1087 1087  CVMRL                           S01518
     I                               1088 1091  PTFR                            S01486
     I                               1092 1092  HLEX                            S01486
     I                             P 1093 1098 7FSRPL                           CAC001
     I                               1099 1099  FSGNL                           CAC001
     I                               1100 1103  FPRCL                           CAC001
     I                             P 1104 1110 0TCOF                            CAC001
     I                             P 1111 1117 0ACPD                            CAC001
     I                             P 1118 1124 0ACDA                            CAC001
     I                             P 1125 1131 0ACAJ                            CAC001
     I                             P 1132 1138 0ACAP                            CAC001
     I                             P 1139 1145 0COFD                            CAC001
     I                             P 1146 1152 0COFM                            CAC001
     I                             P 1153 1159 0CFCD                            CAC001
     I                             P 1160 1165 7NFRS                            CAC001
     I                               1166 1166  NFSN                            CAC001
     I                               1167 1170  NFPC                            CAC001
     I                             P 1171 1177 0PDCF                            CAC001
     I                             P 1178 1180 0FCTD                            CAC001
     I                             P 1181 1187 0FWOD                            CAC001
     I***********                          12001200 PDDI           CLE005 133913
     I                               1200 1200  WPDDI                           133913
     I/COPY WNCPYSRC,LE0450I005
     I                             P 1279 1281 0LRLD                            CLE004
     I                             P 1282 1284 0LMCD                            CLE004
     I                               1285 1287  SCCYL                           CEU004
     I                               1288 1290  ICCYL                           CEU004
     I                             P 1291 1296 7OINR                            CPL002
     I                             P 1297 1299 0OIDT                            142405
     I                               1300 1300  REPI                            CPB001
     I                               1301 1302  RFDY                            CLE011
     I                               1303 1303  RFRI                            CLE011
     I                             P 1304 1309 7RFRT                            CLE011
     I                               1310 1310  RFAR                            CLE011
     I                               1311 1315  FSYLDC
     I                               1316 1320  FSFYLD
     I                             P 1321 1327 0FSURPL
     I                             P 1328 1334 0FSPLAM
     I                             P 1335 1341 0FSPLDT
     I                             P 1342 1348 0FSYUPL
     I                               1349 1349  ADIF
     I                               1350 1350  ADCF
     I                             P 1351 1357 0CHGA
     I                               1358 1358  ICIF
     I                             P 1359 1365 0FLTI
     I                             P 1366 1368 0FRPD
     I                             P 1369 1375 0ACCH
     I                             P 1376 1382 0FSEFUP
     I                             P 1383 1389 0FSECUP
     I                             P 1390 1396 0AIPN
     I                             P 1397 1403 0AITN
     I                             P 1397 1403 0AITNL
     I                             P 1404 1410 0AIAN
     I                             P 1411 1417 0IPRN
     I                             P 1418 1424 0AINN
     I                             P 1425 1431 0TOTN
     I                             P 1432 1438 0ICTN
     I                             P 1439 1445 0IWON
     I                             P 1446 1452 0IPNM
     I                             P 1453 1459 0PDNN
     I                             P 1460 1466 0FSCPAM
     I                             P 1467 1473 0FPAML
     I                             P 1474 1480 8REXRL
     I                               1481 1481  REXIL
     I                               1482 1484  PSCYL
     I                             P 1485 1491 8PEXRL
     I                               1492 1492  PEXIL
     I                               1493 1493  STALL
     I                               1494 1513  FRNTL
     I                               1514 1533  AFRTL
     I                               1534 1534  REPAL
     I                               1535 1560  TMSTL
     I                               1561 1578  OSDA
     I                               1579 1596  OMDA
     I                               1597 1614  RONSL
     I                               1615 1632  PONSL
     I************************************P163316400TFDP                               CAS009 CLE042
     I************************************P164116480TFDPA                              CAS009 CLE042
     I************************************P164916560TFAM                               CAS009 CLE042
     I************************************P165716640TFAC                               CAS009 CLE042
     I************************************P166516720TFOF                               CAS009 CLE042
     I************************************P167316800AFDP                               CAS009 CLE042
     I************************************P168116880CFDP                               CAS009 CLE042
     I************************************P168916960AMDS                               CAS009 CLE042
     I************************************P169717040AMADJ                              CAS009 CLE042
     I************************************P170517120ANADJ                              CAS009 CLE042
     I************************************P171317200DSAM                               CAS009 CLE042
     I************************************P172117280AMCOST                             CAS009 CLE042
     I************************************P172917360YMCOST                             CAS009 CLE042
     I************************************P173717440YAINT                              CAS009 CLE042
     I                             P 1634 1641 0TFDP
     I                             P 1642 1649 0TFDPA
     I                             P 1650 1657 0TFAM
     I                             P 1658 1665 0TFAC
     I                             P 1666 1673 0TFOF
     I                             P 1674 1681 0AFDP
     I                             P 1682 1689 0CFDP
     I                             P 1690 1697 0AMDS
     I                             P 1698 1705 0AMADJ
     I                             P 1706 1713 0ANADJ
     I                             P 1714 1721 0DSAM
     I                             P 1722 1729 0AMCOST
     I                             P 1730 1737 0YMCOST
     I                             P 1738 1745 0YAINT
     I                             P 1746 1751 7BASRL
     I                             P 1752 1757 7NBSR
     I                               1758 1759  SLTP
     I                               1760 1761  SLST
     I                               1762 1765  CLAS
     I                               1766 1769  DFCL
     I                               1770 1773  SLCL
     I                             P 1774 1776 0ISDT
     I                             P 1777 1779 0FMDT
     I                               1780 1782  LOIC
     I                             P 1783 1785 0OCDT
     I                             P 1786 1793 8EAIR
     I                             P 1794 1799 7CNSP
     I                               1800 1800  CNSG
     I                               1801 1807  RDMT
     I                               1808 1811  RDFD
     I                             P 1812 1817 7NNSP
     I                               1818 1818  NNSG
     I                               1819 1825  NDMT
     I                               1826 1829  NDFD
      *                                                                                       CLE134
     I                               1830 1830  FAMU                                          CLE134
     I                               1831 1831  FPNR                                          CLE134
     I                             P 1832 1834 0RIDT                                          CLE134
     I                             P 1835 1836 0RIDC                                          CLE134
     I                               1837 1837 0RCAT                                          CLE134
     I                             P 1838 1839 0RCAC                                          CLE134
     I                             P 1840 1842 0RCSD                                          CLE134
     I                             P 1843 1844 0RCDY                                          CLE134
     I**********                   P 1845 1846 0RCCY                                 CLE134 AR855749
     I                             P 1845 1846 0RICC                                        AR855749
      *                                                                                       CLE134
     I                             P 1847 1849 0BIDT                                          CLE134
     I                             P 1850 1851 0BIDC                                          CLE134
     I                               1852 1852 0BCAT                                          CLE134
     I                             P 1853 1854 0BCAC                                          CLE134
     I                             P 1855 1857 0BCSD                                          CLE134
     I                             P 1858 1859 0BCDY                                          CLE134
     I                             P 1860 1861 0BICC                                          CLE134
      *                                                                                       CLE134
     I                               1862 1864  XRFI                                          CLE134
     I                               1865 1874 0XRFN                                          CLE134
     I                               1906 1935  CCYPR                                         CLE141
     I                               1936 1965  LOCPR                                         CLE141
     I                               1966 1995  CCYPI                                         CLE141
     I                               1996 2025  LOCPI                                         CLE141
0194 I**
0195 I**   /FIELDS TO DEFINE WHOLE RECORD
0196 I**
0197 I                                  1  256  LOTA1
0198 I**********                            257 400 LOTA2                 S01220
0198 I**************************************257 436 LOTA2          S01220 S01465
     I                                257  458  LOTA2                           S01465
     I***********                           4591284 LOTA3          CLE004 CEU004
     I***********                           4591290 LOTA3          CEU004 CPL002
     I***********                           4591299 LOTA3          CPL002 CPB001
     I**********                            4591300 LOTA3          CPB001 CLE011
     I**********                            4591310 LOTA3                              CLE011 CAS001
     I***********                           4591187 LOTA3          CAC001 CLE004
     I***********                           4591092 LOTA3          S01486 CAC001
     I***********                           4591087 LOTA3          S01518 S01486
     I**********                            4591348 LOTA3                              CAS001 CLE028
     I**********                            4591375 LOTA3                              CLE028 CAS004
     I**********                            4591389 LOTA3                              CAS004 CAS005
     I**********                            4591466 LOTA3                              CAS005 CLE031
     I**********                            4591492 LOTA3                              CLE031 CLE034
     I**********                            4591493 LOTA3                              CLE034 CAP074
     I**********                            4591560 LOTA3                              CAP074 CGL029
     I**********                            4591632 LOTA3                              CGL029 CAS009
     I**********                            4591744 LOTA3                              CAS009 CLE106
     I**************************************4591748 LOTA3                              CLE106 CLE042
     I**********                            4591773 LOTA3                            CLE042 BUG23094
     I**********                            4591782 LOTA3                            BUG23094 CRE073
     I                                459 1829  LOTA3
     I**********                            4591565 LOTA3M                           BUG5047 BUG8570
     I                                459 1493  LOTA3M                                             B
     I**********                           15611632 LOTA3S                                   BUG5047
     I**********                           15611744 LOTA3S                             CAS009 CLE106
     I*************************************15611748 LOTA3S                             CLE106 CLE042
     I**********                           15611773 LOTA3S                             CLE042 CER020
     I**********                           15611776 LOTA3S                           CER020 BUG22966
     I**********                           15611782 LOTA3S                         BUG22966 BUG23094
     I**********                           15611776 LOTA3S                           BUG23094 CRE073
     I**********                     1561 1829  LOTA3S                                      MD039672
     I                               1561 1773  LOTA3S                                      MD039672
     I                               1780 1811  LOTA4A                                      MD039672
     I                               1830 1905  LOTA4                                         CLE134
     I                               1906 2025  LOTA5                                         CLE141
0270 I**                                                                  S01117
0271 I**   CATCH ALL                                                      S01117
0272 I**                                                                  S01117
0273 I          NS                                                              S01117
0274 I                                  1    1  RECI                            S01117
0239 I*                                                                   S01117
0199 I**
0200 I**   LOANS FILE - DETAIL 2 - SOME FIELDS HAVE 'L' ON END
0201 I**
0202 I********NS* 06   1 CD   8 CB                                        S01117
0202 ILOUPDL2   NS  06    1 CD    8 CB                                          S01117
0203 I         OR         1 CM    8 CB
0204 I         OR         1 CR    8 CB
0205 I                                  1    1  RECI
0206 I**********                        2    7 0LNRF            M2                            CLE134
     I                                  2    7  LNRF            M2                            CLE134
0207 I                                  8    8  RCDT
0208 I                                  9    9 0MRIN            M1
0209 I                                 10   44  NAR1
0210 I                                 45   79  NAR2
0211 I                                 80  114  NAR3
0212 I                                115  149  NAR4
0213 I                             P  150  156 0OPAM
0214 I                                157  161 0FRBC
0215 I                             P  162  168 0YPLN
0216 I                             P  169  175 0YFLN
0217 I                             P  176  182 0YWLN
0218 I                             P  183  189 0ABLN
0219 I                             P  190  196 0YPLC
0220 I                             P  197  203 0YFLC
0221 I                             P  204  210 0YWLC
0222 I                             P  211  217 0ABLC
0223 I                             P  218  224 0WWLN
0224 I                             P  225  231 0IWLN
0225 I                             P  232  238 0PWLN
      *                                                                                     MD028338
      ** Reuse filler ZZ004 for FX Rate Chg Only Indicator                                  MD028338
      *                                                                                     MD028338
     I                                239  242  FRCO                                        MD028338
     I**********                            243 244 RDST                             S01392 AR755951
     I                                243  244 0RDST                                              AR
0226 I                                245  274  SPI1
0227 I                                275  304  SPI2
0228 I                                305  334  SPI3
0229 I                             P  335  341 0YILN
     I**********                            343 354 ORVD                               S01392 CGL029
     I**********                            355 364 THRN                               S01392 CGL029
     I**********                          P 365 3710NPRAM                              S01392 CGL029
     I**********                          P 372 3780NDAM                               S01392 CGL029
     I**********                            379 381 RLBR                               S01392 CGL029
0230 I**********                          P 391 3930ORED                                      CGL029
0231 I**********                          P 394 3960LCD                                       CGL029
0232 I**********                            397 397 CHTP                                      CGL029
0233 I**********                          P 398 4000TNLU                                      CGL029
     I**********                            401 4020RRST                               S01518 CGL029
     I**********                            403 414 RRON                               S01518 CGL029
     I**********                            415 422 RRIB                               S01518 CGL029
     I**********                            423 457 RRBA                               S01518 CGL029
     I**********                            458 4630RROB                               S01518 CGL029
     I**********                            464 4690RROC                               S01518 CGL029
     I**********                            470 472 NCCY                               CLE004 CGL029
     I**********                            473 4790NCPA                               CLE004 CGL029
     I**********                          P 480 4868NFCE                               123335 CGL029
     I**********                            487 487 NFMD                               123335 CGL029
     I**********                          P 488 4940NLRAX                              166149 CGL029
     I**********                            541 543 RLSB                               144915 CGL029
     I**********                            5441103 ROLPAY                             144915 CGL029
     I**********                            601 6060RPOB                               CGL020 CGL029
     I**********                            607 6120RPOC                               CGL020 CGL029
     I**********                            664 671 RAWB                               CGL020 CGL029
     I**********                            672 706 RAWA                               CGL020 CGL029
     I**********                            707 714 RBEN                               CGL020 CGL029
     I**********                            715 749 RBNA                               CGL020 CGL029
     I**********                          P110411108NBCE                               123335 CGL029
     I**********                           11111111 NBMD                               123335 CGL029
0233 I**************************************401 403 BRCA    M3      S01117S01518
     I***********                           470 472 BRCA    M3     S01518 CLE004
     I***********                          11041106 BRCA    M3     CLE004 123335
     I**********                           11121114 BRCA    M3                         123335 CGL029
     I**********                           12101212 RRSC                               CEU004 CGL029
     I**********                           12131215 RPSC                               CEU004 CGL029
     I**********                           12161218 RICY                               CEU004 CGL029
     I**********                           12191219 ECIN                               CEU020 CGL029
     I**********                           122012210RPSM                               144915 CGL029
     I**********                           12221233 RPOS                               144915 CGL029
     I**********                           12341243 RPTS                               144915 CGL029
     I**********                           12441246 RPSB                               144915 CGL029
     I**********                           12471256 RFAO                               144915 CGL029
     I**********                           125712570REPT                               CLE028 CGL029
     I**********                          P125812600NRPD78                             CLE028 CGL029
     I**********                           12611261 RFRQ                               CLE028 CGL029
     I**********                           126212630RDYN                               CLE028 CGL029
     I**********                           12641264 ADIF                               CLE028 CGL029
     I**********                           12651265 ADCF                               CLE028 CGL029
     I**********                          P126612720CHGA                               CLE028 CGL029
     I**********                           12731273 ICIF                               CLE028 CGL029
     I**********                          P127412800FLTI                               CLE028 CGL029
     I**********                          P128112830FRPD                               CLE028 CGL029
     I**********                          P128412900ACCH                               CLE028 CGL029
     I**********                           12911295 FSFYLB                             218778 CGL029
     I**********                           12961296 RSTA                               CLE034 CGL029
     I**********                           12971316 FRNT                               CAP074 CGL029
     I**********                           13171336 AFRT                               CAP074 CGL029
     I**********                           13371337 REPA                               CAP074 CGL029
     I**********                           13381363 TMST                               CAP074 CGL029
     I                                343  360  ORVD
     I                                361  370  THRN
     I                             P  371  377 0NPRAM
     I                             P  378  384 0NDAM
     I                                385  387  RLBR
0230 I                             P  397  399 0ORED
0231 I                             P  400  402 0LCD
0232 I                                403  403  CHTP
0233 I                             P  404  406 0TNLU
     I                                407  408 0RRST
     I                                409  426  RRON
     I                                427  434  RRIB
     I                                435  469  RRBA
     I**********                            470 4750RROB                               CGL029 CSD027
     I**********                            476 4810RROC                               CGL029 CSD027
     I                                470  475  RROB
     I                                476  481  RROC
     I                                482  484  NCCY
     I                                485  491 0NCPA
     I                             P  492  498 8NFCE
     I                                499  499  NFMD
     I                             P  500  506 0NLRAX
     I                                553  555  RLSB
     I                                556  557 0RPST
     I***********                           5561115 ROLPAY                             CGL029 243360
     I                                558  575  RPON                                               B
     I                                576 1121  ROLPAY
     I**********                            619 6240RPOB                               CGL029 CSD027
     I**********                            625 6300RPOC                               CGL029 CSD027
     I                                619  624  RPOB
     I                                625  630  RPOC
     I                                631  638  RRCRX
     I                                639  673  RRCAX
     I                                682  689  RAWB
     I                                690  724  RAWA
     I                                725  732  RBEN
     I                                733  767  RBNA
     I                             P 1122 1128 8NBCE
     I                               1129 1129  NBMD
     I                               1130 1132  BRCA            M3
     I                               1228 1230  RRSC
     I                               1231 1233  RPSC
     I                               1234 1236  RICY
     I                               1237 1237  ECIN
     I                               1238 1239 0RPSM
     I                               1240 1257  RPOS
     I                               1258 1267  RPTS
     I                               1268 1270  RPSB
     I                               1271 1280  RFAO
     I                               1281 1281 0REPT
     I                             P 1282 1284 0NRPD78
     I**********                           12851285 RFRQ                               CGL029 257871
     I**********                           128612870RDYN                               CGL029 257871
     I                               1288 1288  ADIF
     I                               1289 1289  ADCF
     I                             P 1290 1296 0CHGA
     I                               1297 1297  ICIF
     I                             P 1298 1304 0FLTI
     I                             P 1305 1307 0FRPD
     I                             P 1308 1314 0ACCH
     I                               1315 1319  FSFYLB
     I                               1320 1320  RSTA
     I                               1321 1340  FRNT
     I                               1341 1360  AFRT
     I                               1361 1361  REPA
     I**********                     1362 1387  TMST                                   CGL029 CLE134
     I                             Z 1362 1387  TMST                                          CLE134
0234 I**
0235 I**   FIELDS TO DEFINE WHOLE RECORD
0236 I**
0237 I                                  1  256  LOTB1
0238 I**********                            257 400 LOTB2                                     CGL029
     I***********                           401 469 LOTB3          S01518 CEU004
     I***********                           4011218 LOTB3          CEU004 134798
     I**********                            401 469 LOTB3                              134798 CGL029
     I**********                            4701103 LOTB4                              CLE004 CGL029
     I                                257  341  LOTB2
     I                                361  408  LOTB3
     I                                427  557  LOTB4
     I                                576 1129  LOTB5
0270 I**                                                                  S01117
0271 I**   CATCH ALL                                                      S01117
0272 I**                                                                  S01117
0273 I          NS                                                              S01117
0274 I                                  1    1  RECI                            S01117
0239 I*
0240 I*    LOANS FILE - TRAILER - SOME FIELDS HAVE 'L' ON END
0241 I*
0242 I********NS*      1 CT                                               S01117
0242 ILOUPDZ1   NS        1 CT                                                  S01117
0243 I                                  1    1  RECI
0244 I**********                        2    7 0LNRF                                          CLE148
     I                                  2    7  LNRF                                          CLE148
0245 I                                  8    8  RCDT
0246 I                             P   17   19 0NOREL
0247 I                             P   20   22 0FLSZ
0248 I                             P   23   25 0NLRB
0249 I                             P   26   28 0NINS
0250 I                             P   29   31 0NDEL
0251 I                             P   32   34 0NLRA
0252 I                             P   35   42 0VLBF
0253 I                             P   43   44 0VLBL
0254 I                             P   45   52 0VRIF
0255 I                             P   53   54 0VRIL
0256 I                             P   55   62 0VRDF
0257 I                             P   63   64 0VRDL
0258 I                             P   65   72 0VLAF
0259 I                             P   73   74 0VLAL
0260 I                             P   75   77 0DTMR
0261 I                             P   78   80 0ITMR
0262 I                             P  394  396 0LCD
0263 I                                397  397  CHTP
0264 I                             P  398  400 0TNLU
0265 I**
0266 I**   FIELDS TO DEFINE WHOLE RECORD
0267 I**
0268 I                                  1  256  LOTT1
0269 I                                257  400  LOTT2
0270 I**
0271 I**   CATCH ALL
0272 I**
0273 I          NS
0274 I                                  1    1  RECI
0275 I**
0276 I**   ACTIONS FILE HEADER RECORD
0277 I**
0278 I*CTN6***NS* 01   1 CH                                               S01117
0278 I***ACTN6L1 NS  01   1 CH                                     S01117 CLE004
     ILEACT5L0  NS  01    1 CH                                                  CLE004
0279 I                                  1    1  RECI
0280 I**********                        2    7 0LNRF                                          CLE134
     I                                  2    7  LNRF                                          CLE134
0281 I                                  8   12 0VDAT
0282 I                                 13   15 0LASN
0283 I                             P   16   18 0EVCD
0284 I                                 19   19  PAQI
0284 I                             P   20   22 0PELAP                           E47260
0285 I**
0286 I**   ACTION FILE CONTROL RECORD
0287 I**
0288 I          NS  03    1 CD   23 CC   24 CO
0289 I                                  1    1  RECI
0290 I**********                        2    7 0LNRF            M2                            CLE148
     I                                  2    7  LNRF            M2                            CLE148
0291 I                                  8   12 0VDAT
0292 I                                 13   15 0LASN
0293 I                                 16   16 0MRIN            M1
0336 I**********                             17  18 LTYP                  S01270
0337 I**********                             19  20 SUTP                  S01270
0336 I                                 17   18  LTYPA                           S01270
0337 I                                 19   20  SUTPA                           S01270
0296 I                                 21   22 0PTYP
0297 I                                 23   24  AMTP
0298 I                                 25   26 0PRSQ
0299 I                                 27   27  CTRQ
0300 I                                 28   28  RBVA
0301 I                                 29   29  RBVS
0302 I                                 30   30  INPY
0303 I                             P   31   33 0LIVD
0304 I                                 34   34  ACCR
0305 I                                 35   37  CCY
0306 I***********                            73  750BRCD                  S01117
0306 I                                 73   75  BRCA            M3              S01117
0307 I**********                             76  810CNUM                                      CSD027
0307 I                                 76   81  CNUM
0308 I                                 82   82  RBSA
0309 I                                 83   83  IBSA
0310 I                                 84   84  MBSA
0311 I                                 85   85  LNMA
0312 I                                 86   86  LNRV
0313 I                             P   87   89 0LTVD
0314 I                             P   90   92 0ECDT
0315 I                             P   96   98 0PLCD
0316 I                             P   99  101 0PLND
0317 I                             P  102  104 0CTXD
0318 I                             P  105  107 0EXTD
0319 I                             P  108  110 0NIAD
0320 I                             P  111  117 0AITC
0321 I                                118  118  ICRQ
0322 I                             P  119  125 0TINP
0323 I                             P  126  132 0TIPD
0324 I                             P  133  138 7WTRT
0325 I                                139  139  NACD
0326 I                                140  140  BTIN
     I                                244  244  ADDI                            S01392
     I                             P  321  327 0ACDA                            CAC001
     I                             P  328  334 0TCPD                            CAC001
     I                             P  335  341 0TCFP                            CAC001
     I                             P  342  344 0NFCD                            CAC001
     I                             P  345  351 0AITN
     I                             P  352  358 0TNNP
     I                             P  359  365 0TNPD
     I                                366  369  CLASA
0327 I**
0328 I**   ACTION FILE DETAIL RECORD
0329 I**
0330 I          NS  04    1 CD
     I         OR   04    1 CR   23 CP   24 CD                                  180044
0331 I                                  1    1  RECI
0332 I**********                        2    7 0LNRF            M2                            CLE148
     I                                  2    7  LNRF            M2                            CLE148
0333 I                                  8   12 0VDAT
0334 I                                 13   15 0LASN
0335 I                                 16   16 0MRIN            M1
0294 I**********                             17  18 LTYP                  S01270
0295 I**********                             19  20 SUTP                  S01270
0294 I                                 17   18  LTYPA                           S01270
0295 I                                 19   20  SUTPA                           S01270
0338 I                                 21   22 0PTYP
0339 I                                 23   24  AMTP
0340 I                                 25   26 0PRSQ
0341 I                                 27   28 0BRTT
0342 I                             P   29   34 7RTSP
0343 I                                 35   37  CCY
0344 I                             P   38   44 0PRAM
0345 I                             P   45   51 0INTA
0346 I                             P   52   58 0WTXA
0347 I                             P   59   65 0FEAM
0348 I                             P   66   72 0TAMT
0349 I***********                            73  750BRCD                  S01117
0349 I                                 73   75  BRCA            M3              S01117
0350 I**********                             76  810CNUM                                      CSD027
0350 I                                 76   81  CNUM
0351 I                                 82   82 0REPT
0352 I                                 83   83  AUTO
0353 I                                 84   84  STAI
0354 I                                 85   86 0SETP
0355 I**********                             87  98 OSAC                                      CGL029
     I                                 87   98  OSACQQ
0356 I                                 99  108  TSEN
0357 I*******************************       109 118 FACO                  S05452
0357 I                                109  118  FACO                    32      S05452
0358 I                                119  148  SPI1
0359 I                                149  178  SPI2
0360 I                                179  208  SPI3
0361 I                                209  209  LAIN
0362 I                             P  210  215 7BRTE
0363 I                                216  216  SPIN
0364 I                                217  217 0CALC
0365 I                                218  218  WTIN
0366 I                                219  219  LLAG
0367 I                                220  220  LWOI
0368 I                                221  225 0XAVD
0369 I                                226  228 0XASQ
0370 I**********                            229 2340FCUS                                      CSD027
0370 I                                229  234  FCUS
0371 I                                235  237 0FTYP
0372 I                                238  239 0FSEQ
0373 I**********                            240 2450RLON                                      CSD027
     I                                240  245  RLON
0374 I                                246  247  FECD
0375 I                                248  248  PDNI
0376 I                                249  249  ACTI
0377 I                                250  250  CNFY
0378 I                                251  251  TLXY
0379 I                                252  252  CBLY
     I/COPY WNCPYSRC,LE0450I001
0380 I                                253  253  INTC
     I/COPY WNCPYSRC,LE0450I002
     I                                256  256  CHIN
     I                                261  263  OSBR                            S01117
     I                             P  267  269 0LSMD                            S01270
     I                             P  270  276 0REBT                            S01392
0381 I                             P  311  313 0ORED
0382 I                             P  314  316 0LCD
0383 I                                317  317  CHTP
0384 I                             P  318  320 0TNLU
     I                                321  322 0RSTM                            S01518
     I**********                            323 334 RONS                               S01518 CGL029
     I                                323  334  RONSQQ
     I                                335  342  RIBN                            S01518
     I                                343  377  RIBA                            S01518
     I**********                            378 3830ROBN                               S01518 CSD027
     I**********                            384 3890ROCN                               S01518 CSD027
     I                                378  383  ROBN
     I                                384  389  ROCN
     I                                390  391 0PSTM                            S01518
     I**********                            392 403 PONS                               S01518 CGL029
     I                                392  403  PONSQQ
     I                                404  411  PIBN                            S01518
     I                                412  446  PIBA                            S01518
     I**********                            447 4520POBN                               S01518 CSD027
     I**********                            453 4580POCN                               S01518 CSD027
     I                                447  452  POBN
     I                                453  458  POCN
     I                                459  466  RCRN                            S01518
     I                                467  501  RCRA                            S01518
     I                                502  509  RVNO                            S01518
     I                                510  517  AWBN                            S01518
     I                                518  552  AWBA                            S01518
     I                                553  560  BENN                            S01518
     I                                561  595  BENA                            S01518
     I                                596  630  DTP1                            S01518
     I                                631  665  DTP2                            S01518
     I                                666  700  DPT3                            S01518
     I                                701  735  DPT4                            S01518
     I                                736  738  DCHG                            S01518
     I                                739  773  BTB1                            S01518
     I                                774  808  BTB2                            S01518
     I                                809  843  BTB3                            S01518
     I                                844  878  BTB4                            S01518
     I                                879  913  BTB5                            S01518
     I                                914  948  BTB6                            S01518
     I                                949  949  CVMR                            S01518
     I                                390  949  PAYSET                          144915
     I                             P  950  955 7FSRP                            CAC001
     I                                956  956  FSGN                            CAC001
     I                                957  960  FPRC                            CAC001
     I                             P  961  967 0COFA                            CAC001
     I                                968  968  IRCF                            CAC001
     I                                969  969  FRCF                            CAC001
     I                                975  975  GASS                            156585
     I                                976  976  GPRT1
     I                                978  983  ROLN                            157643
     I                                996  996  PDGN
     I                                998 1000  RLCY                            CLE004
     I                             P 1001 1007 0PNAM                            CLE004
     I                               1008 1008  PAST                            CLE005
     I                               1058 1058  MTPD                            CLE005
     I                               1059 1059  PDDI                            CLE005
     I                               1060 1060  PTDI                            CLE005
     I                               1061 1063  SCCYA                           CEU004
     I                               1064 1066  ICCY                            CEU004
     I                               1067 1067  ECIN                            CEU020
     I                               1068 1068  REPI                                       AR1078443
     I                             P 1069 1075 0CHDU
     I**********                     1076 1076  REPI                                       AR1078443
     I**********                   P 1077 1083 0INTN                                       AR1078443
     I**********                   P 1084 1090 0FSPRAM                                     AR1078443
     I                             P 1076 1082 0INTN                                       AR1078443
     I                             P 1083 1089 0FSPRAM                                     AR1078443
     I                             P 1090 1096 8REXRA
     I                               1097 1097  REXIA
     I                               1098 1100  PSCYA
     I                             P 1101 1107 8PEXRA
     I                               1108 1108  PEXIA
     I                               1109 1109  STAL
     I                               1110 1129  FRNT
     I                               1130 1149  AFRT
     I                               1150 1150  REPA
     I**********                     1151 1176  TMST                                   CAP075 CLE134
     I**********                   Z 1151 1176  TMST                                   CLE134 CLE164
     I                             Z 1151 1176  TMST5                                         CLE164
     I                               1177 1194  OSAC
     I                               1195 1212  RONS
     I                               1213 1230  PONS
     I                               1280 1283  CLASA
0385 I**
0386 I**   ACTN6 FILE - TRAILER RECORD. - SOME FIELDS HAVE 'A' ON END
0387 I**
0388 I          NS        1 CT
0389 I                                  1    1  RECI
0390 I                             P   17   19 0NOREA
0391 I**
0392 I**   ACTN6 FILE CATCHALL
0393 I**
0394 I          NS
0395 I                                  1    1  RECI
0396 I**
0397 I**   PARTICIPATIONS SOLD MOVEMENTS FILE HEADER RECORD
0398 I**
0399 ISPTSL     NS        1 CH
0400 I                                  1    1  RECI
0401 I**
0402 I**   PARTICIPATIONS SOLD MOVEMENTS FILE DETAIL RECORD
0403 I**
0404 I          NS  05    1 CD
0405 I                                  1    1  RECI
0406 I**********                        2    7 0LNRF            M2                            CLE148
     I                                  2    7  LNRF            M2                            CLE148
0407 I                                  8    9  AMTP
0408 I                             P   10   16 0AMNT
0409 I                                 17   17 0MRIN            M1
     I                                 18   18  AUTOP
     I                                 38   40  BRCA            M3              S01117
0410 I**
0411 I**   PARTICIPATIONS SOLD MOVEMENTS FILE TRAILER - NORE = NOREP
0412 I**
0413 I          NS        1 CT
0414 I                                  1    1  RECI
0415 I                             P    2    4 0NOREP
0416 I**
0417 I**    PARTICIPATIONS SOLD MOVEMENTS FILE CATCHALL
0418 I**
0419 I          NS
0420 I                                  1    1  RECI
     IMLOAN     NS  11    1 CD                                                  BCCI22
0094 I         OR         1 CM                                                  BCCI22
0096 I                                  1    1  RECIX                           BCCI22
0097 I**********                        2    7 0LNRFX                                  BCCI22 CLE148
     I                                  2    7  LNRFX                                         CLE148
0421 I*
0422 I*****TABLE*FILE*-*INSTALLATION*CONTROL*DATA*RECORD*1.               S01194
0423 I*
0424 I*TABLE***NS       2 C0   3 C1  12 C1                                S01194
0425 I*******AND      13 C0                                               S01194
0426 I**********                              1   1 RECI                  S01194
0427 I**********                              2   30RECT                  S01194
0428 I**********                             12  130RCDE                  S01194
0429 I**********                             14  66 TITL                  S01194
0430 I***********                            67  67 DATF                  S01194
0431 I***********                            68  700DFBR                  S01194
     I**********                             73  73 SWIM                  E10007
0432 I**********                             74  74 MODI1                 S01194
0433 I**********                             75  75 MODI2                 S01194
0434 I**********                             76  76 MODI3                 S01194
0435 I***********                         P  77  790RUND                  S01194
0436 I***********                            80  86 RUNA                  S01194
0437 I**********                             87  870SFLG                  S01194
0438 I*
0439 I*
0440 I*****TABLE*FILE*-*INSTALLATION*CONTROL*DATA*RECORD*2.               S01194
0441 I*
0442 I********NS       1 CD   2 C0   3 C1                                 S01194
0443 I*******AND      12 C1  13 C1                                        S01194
0444 I**********                              1   1 RECI                  S01194
0445 I**********                              2   30RECT                  S01194
0446 I**********                             12  130RCDE                  S01194
0447 I**********                             14  16 BCCY                  S01194
0448 I**********                             17  19 BCYL                  S01194
0449 I**********                             20  22 HOCY                  S01194
0450 I**********                             23  280HEAD                  S01194
0451 I**********                          P  29  310APDA                  S01194
0452 I**********                             35  35 APFQ                  S01194
0454 I**********                             39  40 CUZR                  S01194
0455 I**********                          P  41  430DNWD                  S01194
0456 I**********                             44  460BVLP                  S01194
0457 I**********                             47  49 LOCY                  S01194
0458 I**********                             50  510FDAY                  S01194
0459 I**********                             52  52 ACLD                  S01194
0460 I***********                            53  53 MBIN                  S01194
     I**********                          P  54  560EOYD                  S01194
     I**********                          P  57  590LEYD                  S01194
0461 I**********                             86  86 ISAV                  S01194
0463 I*
0464 I*
0465 I*****TABLE*FILE*-*INSTALLATION*CONTROL*DATA*RECORD*6.               S01194
0466 I*
0467 I********NS       1 CD   2 C0   3 C1                                 S01194
0468 I*******AND      12 C5  13 C0                                        S01194
0469 I**********                              1   1 RECI                  S01194
0470 I**********                              2   30RECT                  S01194
0471 I**********                             12  130RCDE                  S01194
0472 I**********                             14  14 BTIN                  S01194
0473 I**********                             15  160BDAY                  S01194
0474 I**********                          P  17  32 PDUE                  S01194
0475 I**********                          P  33  380LARG                  S01194
0476 I**********                             39  39 BRLF                  S01194
0477 I**********                          P  40  420ELAC                  S01194
0478 I***********                                                         S01195
0479 I*****TABLE*FILE - HOLIDAY RECORD.                                   S01195
0480 I********E-EXCLUDE, I-INCLUDE.                                       S01195
0481 I***********                                                         S01195
0482 I********NS*      1 CD   2 C2   3 C2                                 S01195
0483 I*******AND*     14 CE                                               S01195
0484 I*******OR**      1 CD   2 C2   3 C2                                 S01195
0485 I*******AND*     14 CI                                               S01195
0486 I***********                             1   1 RECI                  S01195
0487 I***********                             2   30RECT                  S01195
0488 I***********                             8  120HOL                   S01195
0489 I***********                            13  130SREC                  S01195
0490 I***********                            14  14 INEX                  S01195
0491 I***********                            15  89 HCCY                  S01195
0492 I**
0493 I*****TABLE*FILE*CATCHALL                                            S01194
0494 I**
0495 I********NS                                                          S01194
0496 I**********                              1   1 RECI                  S01194
0497 I                                  2    3 0RECT
0498 I*
0499 I*****TABLE*FILE*-*CURRENCIES*RECORD*1.                              S01194
0500 I*
0501 I*TABLED**NS       2 C2   3 C0                                       S01194
0502 I**********                              1   1 RECI                  S01194
0503 I**********                              2   30RECT                  S01194
0504 I**********                             10  12 CCY                   S01194
0505 I**********                             13  130SREC                  S01194
0506 I**********                             14  27 CCNM                  S01194
0507 I**********                          P  28  348SPOT                  S01194
0508 I**********                             35  37 CCYS                  S01194
0509 I**********                             38  380CDP                   S01194
0510 I**********                             39  390TNOT                  S01194
0511 I**********                             40  40 DCCY                  S01194
0512 I**********                             41  44 SRC1                  S01194
0513 I**********                             45  48 SRC2                  S01194
0514 I**********                             49  520TACC                  S01194
0515 I**********                             53  560TEQV                  S01194
0516 I**********                             57  600SWQV                  S01194
0517 I**********                             61  640TAC4                  S01194
0518 I**********                             65  680TAC5                  S01194
0519 I**********                             69  69 HIND                  S01194
0520 I**********                          P  70  768PART                  S01194
0521 I**********                             77  780SSNO                  S01194
0522 I**********                          P  79  858ERLC                  S01194
0523 I**********                             86  860MDIN                  S01194
0524 I**********                             87  870MDIA                  S01194
0525 I**********                             88  880MDIB                  S01194
0526 I**
0527 I*****TABLED*FILE*CATCHALL                                           S01194
0528 I**
0529 I********NS                                                          S01194
0530 I**********                              1   1 RECI                  S01194
0531 I**********                              2   30RECT                  S01194
      *                                                                   131520
      ** Redefined fields for HISTR                                       131520
      *                                                                   131520
     IHISTSHMF                                                                  131520
     I              RECI                        HRECI                           131520
     I              RCDT                        HRCDT                           131520
     I              BRCA                        HBRCA                           131520
     I              CNUM                        HCNUM                           131520
     I              LNRF                        HLNRF                           131520
     I              VDAT                        VDATH                           131520
     I              PRSQ                        HPRSQ                           131520
     I              LASN                        HLASN                           131520
     I              FCUS                        HFCUS                           131520
     I              FTYP                        HFTYP                           131520
     I              FSEQ                        HFSEQ                           131520
     I              PTYP                        HPTYP                           131520
     I              CCY                         HCUCY                           131520
     I              AMTP                        AMTPH                           131520
     I              PRAM                        PRAMH                           131520
     I              BRTT                        HBRTT                           131520
     I              BRTE                        HBRTE                           131520
     I              RTSP                        HRTSP                           131520
     I              SPIN                        HSPIN                           131520
     I              CALC                        HCALC                           131520
     I              WTIN                        HWTIN                           131520
     I              REPT                        HREPT                           131520
     I              INTC                        HINTC                           131520
     I              LTYP                        HLTYP                           131520
     I              SUTP                        HSUTP                           131520
     I              TOTI                        HTOTI                           131520
     I              FCLB                        HFCLB                           131520
     I**********    LCD                         HLCD                                   131520 260891
     I              LCD                         LCDH                                          260891
     I              CPAM                        CPAMH                           131520
     I              AITC                        HAITC                           131520
     I              INTR                        HINTR                           131520
     I              AIAP                        HAIAP                           131520
     I              IPRD                        HIPRD                           131520
     I              ACDA                        HACDA
     I              COFR                        HCOFR
     I              ACAP                        HACAP
     I              COFD                        HCOFD
     I              AITN                        HAITN
     I              AIAN                        HAIAN
     I              IPRN                        HIPRN
     I              FSPRAM                      HFPRAM
     I              FSCPAM                      HFCPAM
     I              CLAS                        HCLAS
     I              OCDT                        HOCDT                                             AR
     I              EAIR                        HEAIR                                             AR
     I              CNSP                        HCNSP
     I              CNSG                        HCNSG
     I              RDMT                        HRDMT
     I              RDFD                        HRDFD
      *                                                                   131520
      ** HISTSHP                                                          131520
      *                                                                   131520
     IHISTSHPF                                                                  131520
     I              RECI                        HRECI                           131520
     I              RCDT                        HRCDT                           131520
     I              BRCA                        HBRCA                           131520
     I              CNUM                        HCNUM                           131520
     I              LNRF                        HLNRF                           131520
     I              VDAT                        VDATH                           131520
     I              LCD                         LCDH                                          260891
     I              PRSQ                        HPRSQ                           131520
     I              LASN                        HLASN                           131520
     I              FCUS                        HFCUS                           131520
     I              FTYP                        HFTYP                           131520
     I              FSEQ                        HFSEQ                           131520
     I              PTYP                        HPTYP                           131520
     I              CCY                         HCUCY                           131520
     I              AMTP                        AMTPH                           131520
     I              PRAM                        PRAMH                           131520
     I              INTA                        HINTA                           131520
     I              WTXA                        HWTXA                           131520
     I              FEAM                        HFEAM                           131520
     I              FECD                        HFECD                           131520
     I              WOIN                        HWOIN                           131520
     I              EXVD                        HEXVD                           131520
     I              LTYP                        HLTYP                           131520
     I              SUTP                        HSUTP                           131520
     I**********    LCD                         LCDP                                   131520 260891
     I              CPAM                        CPAMP                           131520
     I              AITC                        PAITC                           131520
     I              INTR                        PINTR                           131520
     I              AIAP                        PAIAP                           131520
     I              IPRD                        PIPRD                           131520
     I              ROLN                        ROLNQ                           131520
     I              ACDA                        PACDA
     I              COFR                        PCOFR
     I              ACAP                        PACAP
     I              COFD                        PCOFD
     I              REPI                        PREPI
     I              AITN                        PAITN
     I              IPRN                        PIPRN
     I              INTN                        PINTN
     I              FSPRAM                      PFPRAM
     I              FSCPAM                      PFCPAM
     I              CLAS                        HCLAS
     I              REPT                        HREPT                                         CLE154
      *                                                                   131520
      ** HISTSHQ                                                          131520
      *                                                                   131520
     IHISTSHQF                                                                  131520
     I              RECI                        HRECI                           131520
     I              RCDT                        HRCDT                           131520
     I              BRCA                        HBRCA                           131520
     I              CNUM                        HCNUM                           131520
     I              LNRF                        HLNRF                           131520
     I              VDAT                        VDATH                           131520
     I              LCD                         LCDH                                          260891
     I              PRSQ                        HPRSQ                           131520
     I              LASN                        HLASN                           131520
     I              FCUS                        HFCUS                           131520
     I              FTYP                        HFTYP                           131520
     I              FSEQ                        HFSEQ                           131520
     I              PTYP                        HPTYP                           131520
     I              CCY                         HCUCY                           131520
     I              AMTP                        AMTPH                           131520
     I              BRTT                        HBRTT                           131520
     I              BRTE                        HBRTE                           131520
     I              RTSP                        HRTSP                           131520
     I              SPIN                        HSPIN                           131520
     I              PRINRO                      PRAMQ                           131520
     I**********    LCD                         QLCD                                   131520 260891
     I              CPAM                        CPAMQ                           131520
     I              AITC                        QAITC                           131520
     I              INTR                        QINTR                           131520
     I              AIAP                        QAIAP                           131520
     I              IPRD                        QIPRD                           131520
     I              MNSG                        QMNSG
     I              RLCY                        QRLCY
     I              ACDA                        QACDA
     I              COFR                        QCOFR
     I              ACAP                        QACAP
     I              COFD                        QCOFD
     I              AITN                        QAITN
     I              AIAN                        QAIAN
     I              IPRN                        QIPRN
     I              FSCPAM                      QFCPAM
     I              OCDT                        QOCDT                                             AR
     I              EAIR                        QEAIR                                             AR
     I              CNSP                        QCNSP
     I              CNSG                        QCNSG
     I              RDMT                        QRDMT
     I              RDFD                        QRDFD
     I/COPY WNCPYSRC,LE0450IIP3                                           S01408
     I*LEPARTD0*                                                                       138350 CLE106
     I**********    BRCA                            BRCAA                              138350 CLE106
     I**********    CNUM                            CNUMA                              138350 CLE106
     I**********    CCY                             CCYA                               138350 CLE106
     I**********    PTAI                            PTAIA                              138350 CLE106
     I**********    OSDB                            OSDBA                              138350 CLE106
     I**********    OMDB                            OMDBA                              138350 CLE106
     I**********    RSTM                            RSTMA                              138350 CLE106
     I**********    RONS                            RONSA                              138350 CLE106
     I**********    RIBN                            RIBNA                              138350 CLE106
     I**********    RIBA                            RIBAA                              138350 CLE106
     I**********    ROBN                            ROBNA                              138350 CLE106
     I**********    ROCN                            ROCNA                              138350 CLE106
     I**********    PSTM                            PSTMA                              138350 CLE106
     I**********    PONS                            PONSA                              138350 CLE106
     I**********    PIBN                            PIBNA                              138350 CLE106
     I**********    PIBA                            PIBAA                              138350 CLE106
     I**********    POBN                            POBNA                              138350 CLE106
     I**********    POCN                            POCNA                              138350 CLE106
     I**********    RCRN                            RCRNA                              138350 CLE106
     I**********    RCRA                            RCRAA                              138350 CLE106
     I**********    RVNO                            RVNOA                              138350 CLE106
     I**********    AWBN                            AWBNA                              138350 CLE106
     I**********    AWBA                            AWBAA                              138350 CLE106
     I**********    BENN                            BENNA                              138350 CLE106
     I**********    BENA                            BENAA                              138350 CLE106
     I**********    DTP1                            DTP1A                              138350 CLE106
     I**********    DTP2                            DTP2A                              138350 CLE106
     I**********    DTP3                            DTP3A                              138350 CLE106
     I**********    DTP4                            DTP4A                              138350 CLE106
     I**********    DCHG                            DCHGA                              138350 CLE106
     I**********    BTB1                            BTB1A                              138350 CLE106
     I**********    BTB2                            BTB2A                              138350 CLE106
     I**********    BTB3                            BTB3A                              138350 CLE106
     I**********    BTB4                            BTB4A                              138350 CLE106
     I**********    BTB5                            BTB5A                              138350 CLE106
     I**********    BTB6                            BTB6A                              138350 CLE106
     I**********    CVMR                            CVMRA                              138350 CLE106
     I**********    PCRF                            PCRFA                              138350 CLE106
     I**********    PCOB                            PCOBA                              138350 CLE106
     ISDCURRD0                                                                  S01194
     I**   CURRENCY DETAILS                                               S01194
     I              A6NBDP                      CDP                             S01194
     I              A6CYCD                      CCY                             S01194
     I              A6SPRT                      SPOT                            S01194
     I              A6MDIN                      MDIN                            S01194
      *                                                                   116330
     ILEHISTL0  NS                                                              116330
     I                                 18   22 0VDAT#H                          116330
     I                                 46   47 0BRTT#H                          116330
     I                             P   48   53 7BRTE#H                          116330
      *                                                                   116330
     ILEHISTL2  NS                                                              116330
     I                                 18   22 0VDAT#H                          116330
     I                                 44   45  AMTP#H                          116330
     I                             P   54   59 7RTSP#H                          116330
     I                             P  101  106 7FSRP#H                          116330
     I                                107  107  FSGN#H                          116330
     I                                108  108  IRCF#H                          116330
     I                                109  109  FRCF#H                          116330
     I                                110  113  FPRC#H                          116330
     I                                 60   60  SPIN#H                                      MD019942
     ILEHISTLK  NS                                                                          MD031736
     I                                 18   22 0VDAT#H                                      MD031736
     I                                 44   45  AMTP#H                                      MD031736
     I                             P   54   59 7RTSP#H                                      MD031736
     I                                 60   60  SPIN#H                                      MD031736
     I                             P  101  106 7FSRP#H                                      MD031736
     I                                107  107  FSGN#H                                      MD031736
     I                                108  108  IRCF#H                                      MD031736
     I                                109  109  FRCF#H                                      MD031736
     I                                110  113  FPRC#H                                      MD031736
      *                                                                   S01486
     I**  Redefine all unneeded FCLTY fields for safety                   135147
     IFCLTYFMF                                                                  135147
     I              RECI                        FRECI                           135147
     I              CNUM                        FCNUM                           135147
     I              FACT                        FFACT                           135147
     I              FCNO                        FFCNO                           135147
     I              RCTP                        FRCTP                           135147
     I              BRCA                        FBRCA                           135147
     I              FCTI                        FFCTI                           135147
     I              FCCY                        FFCCY                           135147
     I              FAMT                        FFAMT                           135147
     I              OVPC                        FOVPC                           135147
     I              DTAP                        FDTAP                           135147
     I              DTEX                        FDTEX                           135147
     I              RVCR                        FRVCR                           135147
     I              SECI                        FSECI                           135147
     I              MCCY                        FMCCY                           135147
     I              MCSI                        FMCSI                           135147
     I              NACD                        FNACD                           135147
     I              CRSK                        FCRSK                           135147
     I              DLFS                        FDLFS                           135147
     I              NOMR                        FNOMR                           135147
     I              RVDT                        FRVDT                           135147
     I              RVFR                        FRVFR                           135147
     I              RVDY                        FRVDY                           135147
     I              NAR1                        FNAR1                           135147
     I              NAR2                        FNAR2                           135147
     I              NAR3                        FNAR3                           135147
     I              NAR4                        FNAR4                           135147
     I              MTDH                        FMTDH                           135147
     I              MTDL                        FMTDL                           135147
     I              MTDA                        FMTDY                           135147
     I              QTDA                        FQTDA                           135147
     I              YTDA                        FYTDA                           135147
     I              ACOF                        FACOF                           135147
     I              ORBR                        FORBR                           135147
     I              ZZ001                       FZZ001                          135147
     I              RVCD                        FRVCD                           135147
     I              ZZ002A                      FZ002A                          135147
     I              ORED                        FORED                           135147
     I              LCD                         FLCD                            135147
     I              CHTP                        FCHTP                           135147
     I              TNLU                        FTNLU                           135147
     I              DTPS                        FDTPS                           135147
     I              DICB                        FDICB                           135147
     I              RTPS                        FRTPS                           135147
     I              RLPD                        FRLPD                           135147
     I              CSEL                        FCSEL                           135147
     I              ALCY                        FALCY                           135147
     I              COMD                        FCOMD                           135147
     I              CDTE                        FCDTE                           135147
     I              AVLD                        FAVLD                           135147
     I              LPTP                        FLPTP                           135147
     I              LPBR                        FLPBR                           135147
     I              LPAM                        FLPAM                           135147
     I              LPPS                        FLPPS                           135147
     I              DFTP                        FDFTP                           135147
     I              DFST                        FDFST                           135147
     I              TRCA                        FTRCA                           135147
     I              CANM                        FCANM                           135147
     I              CAFT                        FCAFT                           135147
     I              CAFN                        FCAFN                           135147
     I              ACSQ                        FACSQ                           135147
     I              FSTS                        FFSTS                           135147
     I              IUSR                        FIUSR                           135147
     I              AUSR                        FAUSR                           135147
     I              XUSR                        FXUSR                           135147
     I              SYCP                        FSYCP                           135147
     I              PCRF                        FPCRF                           135147
     I              PRTR                        FPRTR                           135147
     I              PMFC                        FPMFC                           135147
     I              PMFT                        FPMFT                           135147
     I              PMFN                        FPMFN                           135147
     I              INUM                        FINUM                           135147
     I              JDTE                        FJDTE                           135147
     I              SHTP                        FSHTP                           135147
     I              SHPC                        FSHPC                           135147
     I              RCSI                        FRCSI                           135147
     I              SKIR                        FSKIR                           135147
     I              SKIS                        FSKIS                           135147
     I              SKFR                        FSKFR                           135147
     I              SKFS                        FSKFS                           135147
     I              VDTC                        FVDTC                           135147
     I              OSDB                        FOSDB                           135147
     I              OMDB                        FOMDB                           135147
     I              RSTM                        FRSTM                           135147
     I**********    RONS                            FRONS                            135147 BUG23094
     I              RONSQQ                      FRONS                                             BU
     I              RIBN                        FRIBN                           135147
     I              RIBA                        FRIBA                           135147
     I              ROBN                        FROBN                           135147
     I              ROCN                        FROCN                           135147
     I              PSTM                        FPSTM                           135147
     I**********    PONS                            FPONS                            135147 BUG23094
     I              PONSQQ                      FPONS                                             BU
     I              PIBN                        FPIBN                           135147
     I              PIBA                        FPIBA                           135147
     I              POBN                        FPOBN                           135147
     I              POCN                        FPOCN                           135147
     I              RCRN                        FRCRN                           135147
     I              RCRA                        FRCRA                           135147
     I              RVNO                        FRVNO                           135147
     I              AWBN                        FAWBN                           135147
     I              AWBA                        FAWBA                           135147
     I              BENN                        FBENN                           135147
     I              BENA                        FBENA                           135147
     I              DTP1                        FDTP1                           135147
     I              DTP2                        FDTP2                           135147
     I              DTP3                        FDTP3                           135147
     I              DTP4                        FDTP4                           135147
     I              DCHG                        FDCHG                           135147
     I              BTB1                        FBTB1                           135147
     I              BTB2                        FBTB2                           135147
     I              BTB3                        FBTB3                           135147
     I              BTB4                        FBTB4                           135147
     I              BTB5                        FBTB5                           135147
     I              BTB6                        FBTB6                           135147
     I              CVMR                        FCMVR                           135147
     I              PCOB                        FPCOB                           135147
     I              CAXR                        FCAXR                           135147
     I              CMDI                        FCMDI                           135147
     I              CACY                        FCACY                           135147
     I              PFTI                        FPFTI                           135147
     I              REPI                        FREPI
     I              DFCL                        FDFCL
      *                                                                   180051
     ICLOANCLF                                                                  180051
      *                                                                   180051
      ** Rename fields of CLOANCLF                                        180051
      *                                                                   180051
     I              RECI                        RECIX                           180051
     I              LNRF                        LNRFX                           180051
     I              RCDT                        RCDTX                           180051
     I              MRIN                        MRINX                           180051
     I              PTYP                        PTYPX                           180051
     I              CNUM                        CNUMX                           180051
     I              BRCA                        BRCAX                           180051
     I              LTYP                        LTYPX                           180051
     I              SUTP                        SUTPX                           180051
     I              DDAT                        DDATX                           180051
     I              VDAT                        VDATX                           180051
     I              MDAT                        MDATX                           180051
     I              LASQ                        LASQX                           180051
     I              FCUS                        FCUSX                           180051
     I              FTYP                        FTYPX                           180051
     I              FSEQ                        FSEQX                           180051
     I              CCY                         CCYX                            180051
     I              CPAM                        CPAMX                           180051
     I              INTC                        INTCX                           180051
     I              INTR                        INTRX                           180051
     I              BRTT                        BRTTX                           180051
     I              BRTE                        BRTEX                           180051
     I              RTSP                        RTSPX                           180051
     I              MARG                        MARGX                           180051
     I              SPIN                        SPINX                           180051
     I              CHIN                        CHINX                           180051
     I              WTRT                        WTRTX                           180051
     I              WTIN                        WTINX                           180051
     I              REPT                        REPTX                           180051
     I              RAMT                        RAMTX                           180051
     I              NRPD                        NRPDX                           180051
     I              RFRQ                        RFRQX                           180051
     I              RDYN                        RDYNX                           180051
     I              FCCY                        FCCYX                           180051
     I              LIND                        LINDX                           180051
     I              CRSK                        CRSKX                           180051
     I              ACOF                        ACOFX                           180051
     I              NACD                        NACDX                           180051
     I              RELI                        RELIX                           180051
     I              AUTO                        AUTOX                           180051
     I              PSAM                        PSAMX                           180051
     I              BCXR                        BCXRX                           180051
     I              FCXR                        FCXRX                           180051
     I              SDST                        SDSTX                           180051
     I              OSDA                        OSDAX                           180051
     I              TSTN                        TSTNX                           180051
     I              MDST                        MDSTX                           180051
     I              OMDA                        OMDAX                           180051
     I              TMAN                        TMANX                           180051
     I              FACO                        FACOX                           180051
     I              RLDT                        RLDTX                           180051
     I              NROD                        NRODX                           180051
     I              RLFQ                        RLFQX                           180051
     I              RLDY                        RLDYX                           180051
     I              RDFC                        RDFCX                           180051
     I              NBRA                        NBRAX                           180051
     I              NRTS                        NRTSX                           180051
     I              NSIN                        NSINX                           180051
     I              NCAS                        NCASX                           180051
     I              AWTP                        AWTPX                           180051
     I              WTRD                        WTRDX                           180051
     I              WTWD                        WTWDX                           180051
     I              IWOD                        IWODX                           180051
     I              PWOD                        PWODX                           180051
     I              BMDI                        BMDIX                           180051
     I              FMDI                        FMDIX                           180051
     I              PDIN                        PDINX                           180051
     I              LSWC                        LSWCX                           180051
     I              LSWS                        LSWSX                           180051
     I              OSDB                        OSDBX                           180051
     I              OMDB                        OMDBX                           180051
     I              ORBR                        ORBRX                           180051
     I              PRFC                        PRFCX                           180051
     I              FCLB                        FCLBX                           180051
     I              MLNR                        MLNRX                           180051
     I              BTIN                        BTINX                           180051
     I              BLDY                        BLDYX                           180051
     I              OLNO                        OLNOX                           180051
     I              RCSI                        RCSIX                           180051
     I              ICBS                        ICBSX                           180051
     I              IPFR                        IPFRX                           180051
     I              TOTI                        TOTIX                           180051
     I              NIDT                        NIDTX                           180051
     I              IBDT                        IBDTX                           180051
     I              SLID                        SLIDX                           180051
     I              AIPD                        AIPDX                           180051
     I              DLRC                        DLRCX                           180051
     I              IACD                        IACDX                           180051
     I              AITC                        AITCX                           180051
     I              TFEP                        TFEPX                           180051
     I              AIAP                        AIAPX                           180051
     I              IPRD                        IPRDX                           180051
     I              IPRM                        IPRMX                           180051
     I              ICTD                        ICTDX                           180051
     I              AIMN                        AIMNX                           180051
     I              RBDT                        RBDTX                           180051
     I              NOPS                        NOPSX                           180051
     I              NCHI                        NCHIX                           180051
     I              ZZ001A                      ZZ01AX                          180051
     I              IFDY                        IFDYX                           180051
     I              LONI                        LONIX                           180051
     I              CNFI                        CNFIX                           180051
     I              ACEI                        ACEIX                           180051
     I              TLXI                        TLXIX                           180051
     I              CBLI                        CBLIX                           180051
     I              ORED                        OREDX                           180051
     I              LCD                         LCDX                            180051
     I              CHTP                        CHTPX                           180051
     I              TNLU                        TNLUX                           180051
     I              ADDI                        ADDIX                           180051
     I              ORMD                        ORMDX                           180051
     I              ORTI                        ORTIX                           180051
     I              ZZ023A                      ZZ23AX                          180051
     I              BOKC                        BOKCX                           180051
     I              COCU                        COCUX                           180051
     I              RECE                        RECEX                           180051
     I              OMDT                        OMDTX                           180051
     I              NIPD                        NIPDX                           180051
     I              NMDT                        NMDTX                           180051
     I              APMI                        APMIX                           180051
     I              RSTM                        RSTMX                           180051
     I**********    RONS                            RONSX                            180051 BUG23094
     I              RONSQQ                      RONSX                                             BU
     I              RIBN                        RIBNX                           180051
     I              RIBA                        RIBAX                           180051
     I              ROBN                        ROBNX                           180051
     I              ROCN                        ROCNX                           180051
     I              PSTM                        PSTMX                           180051
     I**********    PONS                            PONSX                            180051 BUG23094
     I              PONSQQ                      PONSX                                             BU
     I              PIBN                        PIBNX                           180051
     I              PIBA                        PIBAX                           180051
     I              POBN                        POBNX                           180051
     I              POCN                        POCNX                           180051
     I              RCRN                        RCRNX                           180051
     I              RCRA                        RCRAX                           180051
     I              RVNO                        RVNOX                           180051
     I              AWBN                        AWBNX                           180051
     I              AWBA                        AWBAX                           180051
     I              BENN                        BENNX                           180051
     I              BENA                        BENAX                           180051
     I              DTP1                        DTP1X                           180051
     I              DTP2                        DTP2X                           180051
     I              DTP3                        DTP3X                           180051
     I              DTP4                        DTP4X                           180051
     I              DCHG                        DCHGX                           180051
     I              BTB1                        BTB1X                           180051
     I              BTB2                        BTB2X                           180051
     I              BTB3                        BTB3X                           180051
     I              BTB4                        BTB4X                           180051
     I              BTB5                        BTB5X                           180051
     I              BTB6                        BTB6X                           180051
     I              CVMR                        CVMRX                           180051
     I              PTFR                        PTFRX                           180051
     I              HLEX                        HLEXX                           180051
     I              FSRP                        FSRPX                           180051
     I              FSGN                        FSGNX                           180051
     I              FPRC                        FPRCX                           180051
     I              TCOF                        TCOFX                           180051
     I              ACPD                        ACPDX                           180051
     I              ACDA                        ACDAX                           180051
     I              ACAJ                        ACAJX                           180051
     I              ACAP                        ACAPX                           180051
     I              COFD                        COFDX                           180051
     I              COFM                        COFMX                           180051
     I              CFCD                        CFCDX                           180051
     I              NFRS                        NFRSX                           180051
     I              NFSN                        NFSNX                           180051
     I              NFPC                        NFPCX                           180051
     I              PDCF                        PDCFX                           180051
     I              FCTD                        FCTDX                           180051
     I              FWOD                        FWODX                           180051
     I              DFTP                        DFTPX                           180051
     I              DFST                        DFSTX                           180051
     I              MCRA                        MCRAX                           180051
     I              FCRA                        FCRAX                           180051
     I              PDDI                        PDDIX                           180051
     I              PTDI                        PTDIX                           180051
     I              GDPR                        GDPRX                           180051
     I              GDIN                        GDINX                           180051
     I              LNKS                        LNKSX                           180051
     I              MNSG                        MNSGX                           180051
     I              GASS                        GASSX                           180051
     I              GPRT                        GPRTX                           180051
     I              TOLN                        TOLNX                           180051
     I              LSTS                        LSTSX                           180051
     I              IUSR                        IUSRX                           180051
     I              AUSR                        AUSRX                           180051
     I              XUSR                        XUSRX                           180051
     I              RATF                        RATFX                           180051
     I              CNCF                        CNCFX                           180051
     I              PCRF                        PCRFX                           180051
     I              LPFI                        LPFIX                           180051
     I              PTFC                        PTFCX                           180051
     I              PTFT                        PTFTX                           180051
     I              PTFN                        PTFNX                           180051
     I              PCOB                        PCOBX                           180051
     I              LRLD                        LRLDX                           180051
     I              LMCD                        LMCDX                           180051
     I              OIDT                        OIDTX                           180051
     I              REPI                        REPIX
     I              AIPN                        AIPNX
     I              AITN                        AITNX
     I              AIAN                        AIANX
     I              IPRN                        IPRNX
     I              AINN                        AINNX
     I              TOTN                        TOTNX
     I              ICTN                        ICTNX
     I              IWON                        IWONX
     I              IPNM                        IPNMX
     I              PDNN                        PDNNX
     I              FSCPAM                      FCPAMX
     I              FPAM                        FPAMX
     I              REXR                        REXRX
     I              REXI                        REXIX
     I              PSCY                        PSCYX
     I              PEXR                        PEXRX
     I              PEXI                        PEXIX
     I              TFDP                        TFDPX
     I              TFDPA                       TFDPAX
     I              TFAM                        TFAMX
     I              TFAC                        TFACX
     I              TFOF                        TFOFX
     I              AFDP                        AFDPX
     I              CFDP                        CFDPX
     I              AMDS                        AMDSX
     I              AMADJ                       AMADJX
     I              ANADJ                       ANADJX
     I              DSAM                        DSAMX
     I              AMCOST                      AMCOSX
     I              YMCOST                      YMCOSX
     I              YAINT                       YAINTX
     I              NBSR                        NBSRX
     I              CLAS                        CLASX
     I              DFCL                        DFCLX
     I              SLCL                        SLCLX                                       AR855749
     I              FAMU                        FAMUX                                       AR855749
     I              FPNR                        FPNRX                                       AR855749
     I              RIDT                        RIDTX                                       AR855749
     I              RIDC                        RIDCX                                       AR855749
     I              RCAT                        RCATX                                       AR855749
     I              RCAC                        RCACX                                       AR855749
     I              RCSD                        RCSDX                                       AR855749
     I              RCDY                        RCDYX                                       AR855749
     I              RICC                        RICCX                                       AR855749
     I              BIDT                        BIDTX                                       AR855749
     I              BIDC                        BIDCX                                       AR855749
     I              BCAT                        BCATX                                       AR855749
     I              BCAC                        BCACX                                       AR855749
     I              BCSD                        BCSDX                                       AR855749
     I              BCDY                        BCDYX                                       AR855749
     I              BICC                        BICCX                                       AR855749
     I              XRFI                        XRFIX                                       AR855749
     I              XRFN                        XRFNX                                       AR855749
     I              LOIC                        LOICX
     I              OCDT                        OCDTX                                             AR
     I              EAIR                        EAIRX                                             AR
     I              CNSP                        CNSPX
     I              CNSG                        CNSGX
     I              RDMT                        RDMTX
     I              RDFD                        RDFDX
     I              NNSP                        NNSPX
     I              NNSG                        NNSGX
     I              NDMT                        NDMTX
     I              SCCY                        SCCYX                                      AR1083279
     I              ICCY                        ICCYX                                      AR1083279
     I              OINR                        OINRX                                      AR1083279
     I              RFDY                        RFDYX                                      AR1083279
     I              RFRI                        RFRIX                                      AR1083279
     I              RFRT                        RFRTX                                      AR1083279
     I              RFAR                        RFARX                                      AR1083279
     I              FSYLDC                      FSYLDX                                     AR1083279
     I              FSFYLD                      FSFYLX                                     AR1083279
     I              FSURPL                      FSURPX                                     AR1083279
     I              FSPLAM                      FSPLAX                                     AR1083279
     I              FSPLDT                      FSPLDX                                     AR1083279
     I              FSYUPL                      FSYUPX                                     AR1083279
     I              ADIF                        ADIFX                                      AR1083279
     I              ADCF                        ADCFX                                      AR1083279
     I              CHGA                        CHGAX                                      AR1083279
     I              ICIF                        ICIFX                                      AR1083279
     I              FLTI                        FLTIX                                      AR1083279
     I              FRPD                        FRPDX                                      AR1083279
     I              ACCH                        ACCHX                                      AR1083279
     I              FSEFUP                      FSEFUX                                     AR1083279
     I              FSECUP                      FSECUX                                     AR1083279
     I              STAL                        STALX                                      AR1083279
     I              FRNT                        FRNTX                                      AR1083279
     I              AFRT                        AFRTX                                      AR1083279
     I              REPA                        REPAX                                      AR1083279
     I              TMST                        TMSTX                                      AR1083279
     I              AUTH                        AUTHX                                      AR1083279
     I              BASR                        BASRX                                      AR1083279
     I              SLTP                        SLTPX                                      AR1083279
     I              SLST                        SLSTX                                      AR1083279
      *                                                                                       185526
      **  Redefine some of the unneeded CLOANCK fields for safety                             185526
     ICLOANCKF
     I              RECI                        CRECI
     I              LNRF                        CLNRF
     I              MRIN                        CMRIN
     I              RCDT                        CRCDT
     I              RDST                        CRDST
     I              ORED                        CORED
     I              LCD                         CLCD
     I              CHTP                        CCHTP
     I              NLRA                        CNLRA
     I              SPI1                        CSPI1
     I              SPI2                        CSPI2
     I              SPI3                        CSPI3
     I              TNLU                        CTNLU
     I              ECIN                        CECIN
     I              NCPA                        CNCPA
      *                                                                                       CLE038
     IXESTAL7
      *                                                                                       CLE038
      ** Rename fields of XESTALPD                                                            CLE038
      *                                                                                       CLE038
     I              PSTM                        STPSTM
     I              PONS                        STPONS
     I              POBR                        STPOBR
     I              PIBN                        STPIBN
     I              RSTM                        STRSTM
     I              RONS                        STRONS
     I              ROBR                        STROBR
     I              RIBN                        STRIBN
     I              REXR                        STREXR
     I              REXI                        STREXI
     I              PEXR                        STPEXR
     I              PEXI                        STPEXI
     I              PSCY                        STPSCY
     I              RIBA                        STRIBA
     I              ROBN                        STROBN
     I              ROCN                        STROCN
     I              CVMR                        STCVMR
     I              BENN                        STBENN
     I              BTB1                        STBTB1
     I              BTB2                        STBTB2
     I              BTB3                        STBTB3
     I              BTB4                        STBTB4
     I              SEQ                         STSEQ
     I              LASQ                        STLASQ
     I              TYPE                        STTYPE
     I              PCRF                        STPCRF
     I              RCRN                        STRCRN
     I              RCRA                        STRCRA
     I              RVNO                        STRVNO
     I              PYBA                        STPYBA
     I              PYAM                        STPYAM
     I              RCBA                        STRCBA
     I              RCAM                        STRCAM
     I              CCY                         STCCY
      *                                                                                    AR706513B
     ILEFEEDFF                                                                             AR706513B
     I              OMDB                        OMDB2                                      AR706513B
     I              OSDB                        OSDB2                                      AR1007486
     ILEFEEDF                                                                              AR706513B
     I              OMDB                        OMDB3                                      AR706513B
     I              OSDB                        OSDB3                                      AR1007486
     IFCLTYFMX                                                                             AR706513B
     I              OMDB                        OMDB4                                      AR706513B
     I              OSDB                        OSDB4                                      AR1007486
     I/COPY WNCPYSRC,LEH00623
      *                                                                                       CGL020
     I***/COPY*WNCPYSRC,LE0450IIP1***                                                  S01408 CFC006
     I/COPY WNCPYSRC,LE0450IIP1                                                             MD020563
     I*                                                                   S01408
      *                                                                                       CLE134
      ** Remove the ff data structure and move to D specs,                                    CLE134
      ** also replace OPM to RPGLE copysource                                                 CLE134
      *                                                                                       CLE134
     I***/COPY*ZSRSRC,ZINTDYZ1                                                         066550 CLE134
     I***/COPY*ZSRSRC,ZDATE9Z2                                                         066550 CLE134
     I***/COPY*ZSRSRC,ZDAT10Z1                                                         126017 CLE134
     I/EJECT                                                              S01117
     C**********           MOVEACPY@      BIS@   80                                           CSC042
     C** PARAMETER LIST FOR PROGRAM 'AOBANKR0'                            S01194
     C     PLISTA        PLIST                                                                 S0119
     C                   PARM      '*MSG   '     @RTCD             7                           S0119
     C                   PARM      '*FIRST '     @OPTN             7                           S0119
     C     SDBANK        PARM      SDBANK        DSFDY                                         S0119
     C**                                                                  S01194
     C** PARAMETER LIST FOR PROGRAM 'AOGELRR0'                            S01194
     C     PLISTB        PLIST                                                                 S0119
     C                   PARM      '*MSG   '     @RTCD                                         S0119
     C                   PARM      '*FIRST '     @OPTN                                         S0119
     C********** SDGELR    PARM SDGELR    DSFDY                                        S01194 CGL029
     C     SDGELR        PARM      SDGELR        DSSDY
     C**                                                                  S01194
     C** PARAMETER LIST FOR PROGRAM 'AOCLNDR0'                            S01194
     C     PLISTC        PLIST                                                                 S0119
     C                   PARM      '*MSG   '     @RTCD                                         S0119
     C                   PARM      '*FIRST '     @OPTN                                         S0119
     C*****SDCLND        PARM      SDCLND        DSFDY                                 S01194 CLE134
     C     SDCLND        PARM      SDCLND        DSSDY
     C** PARAMETER LIST FOR PROGRAM 'AOMMODR0'                            S01194
     C     PLISTE        PLIST                                                                 S0119
     C                   PARM      '*MSG   '     @RTCD                                         S0119
     C                   PARM      '*FIRST '     @OPTN                                         S0119
     C     SDMMOD        PARM      SDMMOD        DSFDY                                         S0119
      *                                                                   CLE004
      * Parameter list for program aosardr0.                              CLE004
     C     PLISTF        PLIST                                                                 CLE00
     C                   PARM      *BLANKS       @RTCD                                         CLE00
     C                   PARM      '*VERIFY'     @OPTN                                         CLE00
     C                   PARM                    @SARD             6                           CLE00
     C                   PARM                    DSFDY                                         CLE00
     C*===================================================================S01486
     C*                                                                   S01486
     C** CALCULATION SPECIFICATIONS:KEY LISTS                             S01486
     C*                                                                   S01486
     C** DEFINE KEY LIST FOR CHAINING TO PMCHTVPD                         S01486
      *                                                                                       263416
     C     KMANL         KLIST                                                                263416
     C                   KFLD                    BRCA                                         263416
     C                   KFLD                    LNRF                                         263416
     C                   KFLD                    VDAT                                         263416
     C                   KFLD                    LASN                                         263416
      *                                                                                       263416
     C*****KSTAL         KLIST                                                     MD046080 MD049078
     C**********         KFLD                    LNRF                              MD046080 MD049078
     C**********         KFLD                    WSET                              MD046080 MD049078
      *                                                                            MD046080 MD049078
     C     KPDCL         KLIST
     C                   KFLD                    LNRF
     C                   KFLD                    VDAT
      *                                                                                       CLE134
     C     KPDCL5        KLIST
     C                   KFLD                    BRCA
     C                   KFLD                    LNRF
      *                                                                                       CLE134
     C     KPACC         KLIST
     C                   KFLD                    YKCNUM
     C                   KFLD                    YKCCY
     C                   KFLD                    YKACOD
     C                   KFLD                    YKACSQ
     C                   KFLD                    YKBRCA
      *                                                                                       CLE134
     C                   MOVE      *BLANKS       KACCK            14
      *                                                                                       CLE134
     C     *LIKE         DEFINE    YTKPAC        WTKPAC
     C     *LIKE         DEFINE    YTKPAB        WTKPAB
     C     *LIKE         DEFINE    YTKPAA        WTKPAA
     C     *LIKE         DEFINE    YTKPAS        WTKPAS
     C     *LIKE         DEFINE    YTKPCY        WTKPCY
     C     *LIKE         DEFINE    YTKIAC        WTKIAC
     C     *LIKE         DEFINE    YTKIAB        WTKIAB
     C     *LIKE         DEFINE    YTKIAA        WTKIAA
     C     *LIKE         DEFINE    YTKIAS        WTKIAS
     C     *LIKE         DEFINE    YTKICY        WTKICY
      *                                                                                       CLE134
     C     *LIKE         DEFINE    VLRF          L1VLRF
     C     *LIKE         DEFINE    VLRL          L1VLRL
     C     *LIKE         DEFINE    NORE          L1NORE
     C     *LIKE         DEFINE    OSAC          WOSAC
     C     *LIKE         DEFINE    SETP          WSETP
     C     *LIKE         DEFINE    OSBR          WOSBR
      *                                                                                       CLE134
     C     *LIKE         DEFINE    YTKPAC        YKCNUM
     C     *LIKE         DEFINE    YTKPAA        YKACOD
     C     *LIKE         DEFINE    YTKPAS        YKACSQ
     C     *LIKE         DEFINE    YTKPAB        YKBRCA
     C     *LIKE         DEFINE    YTKPCY        YKCCY
     C*                                                                   S01486
     C     CHTVKY        KLIST                                                                 S0148
     C                   KFLD                    SCCNUM                                        S0148
     C                   KFLD                    SCPTFR                                        S0148
     C                   KFLD                    SCINNR                                        S0148
     C                   KFLD                    SCICCY                                        S0148
     C**********           KFLD           SCLIND                                       S01486 CER020
     C                   KFLD                    SCLOIC
     C                   KFLD                    SCYRNO                                        S0148
     C                   KFLD                    SCMTHN                                        S0148
     C*                                                                   S01486
      ** Key list for LEFEED                                              085677
     C     *LIKE         DEFINE    FEBRCA        @FBRCH                                        08567
     C     *LIKE         DEFINE    FECNUM        @FCNUM                                        08567
     C     *LIKE         DEFINE    FEFACL        @FFACL                                        08567
     C     *LIKE         DEFINE    FELOAN        @FLOAN                                        08567
     C     *LIKE         DEFINE    FEFSEQ        @FFSEQ                                        08567
      *                                                                                       CGL020
      ** AML Fields                                                                           CGL020
      *                                                                                       CGL020
     C     *LIKE         DEFINE    F1RACT        WRACT
     C     *LIKE         DEFINE    F1RCTY        WRCTY
     C     *LIKE         DEFINE    F1RBNK        WRBNK
     C     *LIKE         DEFINE    F1RCDE        WRCDE
     C     *LIKE         DEFINE    F1PACT        WPACT
     C     *LIKE         DEFINE    F1PCTY        WPCTY
     C     *LIKE         DEFINE    F1PBNK        WPBNK
     C     *LIKE         DEFINE    F1PCDE        WPCDE
     C     *LIKE         DEFINE    F1DACT        WDACT
     C     *LIKE         DEFINE    F1DCTY        WDCTY
     C     *LIKE         DEFINE    F1DBNK        WDBNK
     C     *LIKE         DEFINE    F1SDAT        WSDAT
      *                                                                                       CGL020
     C     KEYFEE        KLIST                                                                 08567
     C                   KFLD                    @FBRCH                                        08567
     C                   KFLD                    @FCNUM                                        08567
     C                   KFLD                    @FFACL                                        08567
     C                   KFLD                    @FLOAN                                        08567
     C                   KFLD                    @FFSEQ                                        08567
     C*                                                                   085677
     C     MFHLKY        KLIST                                                                 12789
     C                   KFLD                    QFCNUM                                        12789
     C                   KFLD                    QFMODI                                        12789
     C                   KFLD                    QFTRNB                                        12789
     C                   KFLD                    QFTDSS                                        12789
     C                   KFLD                    QFTXT2                                        12789
     C                   KFLD                    QFPTFR                                        12789
     C*                                                                   127891
     C     MFHLK1        KLIST                                                                 12789
     C                   KFLD                    QFCNUM                                        12789
     C                   KFLD                    QFMODI                                        12789
     C                   KFLD                    QFTRNB                                        12789
     C*                                                                   127891
     C     KEYFCL        KLIST                                                                 13514
     C                   KFLD                    FCLB                                          13514
     C                   KFLD                    FCUS                                          13514
     C                   KFLD                    FTYP                                          13514
     C                   KFLD                    FSEQ                                          13514
      *                                                                                       185526
      ** Define key list for chaining to CLOANCK                                              185526
      *                                                                                       185526
     C     CLOKEY        KLIST
     C                   KFLD                    WLNRF
     C                   KFLD                    WRCDT
      *                                                                                       CLE038
      ** Define a key list for chaining to XESTAL7                                            CLE038
      *                                                                                       CLE038
     C     STALKY        KLIST
     C                   KFLD                    KSTYPE
     C                   KFLD                    KSLNRF
     C                   KFLD                    KSVDAT
     C*===================================================================S01486
      /EJECT                                                              S01486
     C**                                                                  S01117
     C**   DEFN JNSTAT
     C     *DTAARA       DEFINE                  JNSTAT
     C                   IN        JNSTAT
      *                                                                   131520
     C     HKEY          KLIST                                                                 13152
     C                   KFLD                    BRCDCL                                        13152
     C                   KFLD                    CNUMCL                                        13152
     C                   KFLD                    LNRFCL                                        13152
     C                   KFLD                    VDATH                                         13152
     C                   KFLD                    HPRSQ                                         13152
     C                   KFLD                    LCDH                                         260891
     C                   KFLD                    HLASN                                         13152
     C***/COPY*WNCPYSRC,LE0450C054***                                                         CFC006
     C/COPY WNCPYSRC,LE0450C054                                                             MD020563
      ****************************************************************              CFC006 AR1097176
      ***Enable*output*indicator*for*LE0450P1*and*LE0450P2************              CFC006 AR1097176
      ****************************************************************              CFC006 AR1097176
     C**********         MOVEL     *ON           *IN59                              CFC006 AR1097176
     C**********         MOVEL     *ON           *IN36                              CFC006 AR1097176
     C**********         CALL      'AOCOMR0'                                        CFC006 AR1097176
     C**********         PARM      'LEC06A '     PNAME            10                CFC006 AR1097176
     C**********         PARM      '*ALL '       PCSEQ             5                CFC006 AR1097176
     C**********         PARM      SECTN1        PSCTN            50                CFC006 AR1097176
     C**********         PARM      *BLANKS       PRTCD                              CFC006 AR1097176
      ****************************************************************              CFC006 AR1097176
     C*****PRTCD         IFEQ      'Y      '                                        CFC006 AR1097176
     C**********         MOVEL     *OFF          *IN59                              CFC006 AR1097176
     C**********         ENDIF                                                      CFC006 AR1097176
      ****************************************************************              CFC006 AR1097176
     C**********         CALL      'AOCOMR0'                                        CFC006 AR1097176
     C**********         PARM      'LEC06A '     PNAME                              CFC006 AR1097176
     C**********         PARM      '*ALL '       PCSEQ                              CFC006 AR1097176
     C**********         PARM      SECTN2        PSCTN                              CFC006 AR1097176
     C**********         PARM      *BLANKS       PRTCD                              CFC006 AR1097176
      ****************************************************************              CFC006 AR1097176
     C**********         IFEQ      'Y      '                                        CFC006 AR1097176
     C**********         MOVEL     *OFF          *IN36                              CFC006 AR1097176
     C**********         ENDIF                                                      CFC006 AR1097176
0566 C**
0567 C**   EXECUTE FIRST CYCLE
0568 C**
0569 C***01*************   EXSR FIRST                                     082480
     C     #FIRST        IFNE      'N'                                                         08248
     C                   EXSR      FIRST                                                       08248
     C                   MOVE      'N'           #FIRST            1                           08248
     C                   END                                                                   08248
0570 C**
0571 C**   SET OFF OUTPUT INDICATORS
0572 C**
0573 C                   SETOFF                                       626364
0573 C                   SETOFF                                       83
0573 C                   SETOFF                                       09                       BHF65
     C                   MOVE      *BLANKS       WBLN12           12
     C/COPY WNCPYSRC,LE0450C007
0574 C**
0575 C**   PROCESS LOAN 'A' RECORD
0576 C**
0577 C   02              EXSR      LOANA
      *                                                                   135147
     C*** Chain to FCLTY to obtain syndication ind. and agent number      135147
     C***02******KEYFCL    CHAINFCLTYL1              89            135147 146013
     C***02******          SETOF                     68            135147 146013
     C***02******SYIN      COMP 'Y'                      68        135147 146013
      ***********                                                  135147 146013
0578 C**
0579 C**   PROCESS ACTION FILE CONTROL RECORD
0580 C**
0581 C   03              EXSR      ACTCO
0582 C**
0583 C**   PROCESS ACTION FILE DETAIL RECORDS
0584 C**
0585 C   04              EXSR      ACTNS
0586 C**
0587 C**   PROCESS PARTS SOLD RECORDS
0588 C**
0589 C   05              EXSR      PARTS
0590 C**
0591 C**   PROCESS LOAN 'B' RECORD
0592 C**
0593 C   06              EXSR      LOANB
     C/COPY WNCPYSRC,LE0450CP15                                           S01408
     CL1   NORKR         COMP      0                                      07                   S0111
     CL1   NORPRT        COMP      0                                      08                   S0111
0594 C**
0595 C**   LAST RECORD PROCESSING
0596 C**
      *                                                                                       CLE134
      ** CLE134: Update new a/c key trailer file                                              CLE134
      *                                                                                       CLE134
     CLR   CLE134        IFEQ      'Y'                                                        CLE134
     CLR                 EXSR      STRAIL                                                     CLE134
     CLR                 END                                                                  CLE134
      *                                                                                       CLE134
     CLR                 READ      LOUPDZ1                                68                   S0111
     CLR   P1OP          IFEQ      'Y'                                                         S0111
0591 CLR   NORKR         COMP      0                                      07                   E1493
0590 CLR   NORPRT        COMP      0                                      08                   E1493
     CLR                 END                                                                   S0111
0596 C**                                                                  E14936
0597 CLR   NORL          COMP      NOREL                              7070      LOUPD OOB
0598 CLR   NORA          COMP      NOREA                              7171      ACTN6 OOB
0599 CLR   NORP          COMP      NOREP                              7272      SPTSL OOB
0600 C**
0601 CLRN70VLBFL         COMP      VLBF                               7070      LOUPD HASH TOT
0602 CLRN70VLBLL         COMP      VLBL                               7070      OUT OF BALANCE
0603 C**
0604 CLR 70
0605 COR 71
0606 COR 72              SETON                                        U8
     C*                                                                   S01117
     C**   ENSURE TOTALS SPOOL FILE RECORDED BY RCF                       S01117
     C*                                                                   S01117
     CLR                 Z-ADD     SFNUMU        ZSNUMU                                        S0111
     CLR                 OUT       LDA                                                         S0111
      *                                                                   S01117
     CLR                 CALL      'ZSFILE'                                                    S0111
     CLR                 PARM                    SEQ               5                           S0111
     CLR                 PARM      *BLANKS       SENTY             3                           S0111
     CLR                 PARM                    SFILEU                                        S0111
     CLR                 PARM                    ZSNUMU            6 0                         S0111
     CLR                 PARM                    ZSERR             1                           S0111
     C/COPY WNCPYSRC,LEH00845
      *                                                                   S01117
     CLR   *LOCK         IN        LDA                                                         S0111
     CLR   ZSERR         IFEQ      'Y'                                                         S0111
      **  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM       S01117
     CLR                 SETON                                        U7U8                     S0111
     CLR                 RETURN                                                                S0111
     CLR                 END                                                                   S0111
     C*                                                                   S01117
     C**                                                                  S01117
     C**    WHEN LR INDICATOR SET ON WITHOUT EXECUTING THE FIRST          S01117
     C**    CYCLE                                                         S01117
     C**                                                                  S01117
     CLR   P1OP          IFNE      'Y'                                                         S0111
     CLR                 EXSR      #ZZ                                                         S0111
     CLR                 END                                                                   S0111
     CLR U7
     CAN U8              EXSR      *PSSR                                                       S0111
     C/COPY WNCPYSRC,LE0450CP16                                           S01408
0607 C********************************************************************
0608 C**
0609 C**   SUBROUTINE TO EXECUTE FIRST CYCLE PROCESSING - FIRST
0610 C**
0611 C**   CALLED FROM MAIN PROCESSING
0612 C*****CALLS*ZSYSTM,ZDATE1(2),ZDATE2(2),CCYARS,CCYDSP                 S01195
0612 C**   CALLS ZSYSTM,ZDATE1(2),ZDATE2(2),CCYARS,CCYDSP,ZCHKH           S01195
0613 C**
0614 C     FIRST         BEGSR                                                  ***  FIRST  ***
0615 C**
     C     *ENTRY        PLIST                                                                CLE134
     C                   PARM                    WPNAM            10                          CLE134
      *                                                                                       CLE134
     C                   MOVEA     CPY@          BIS@             80
0616 C                   MOVEL     'LE0450  '    DBPGM
0617 C***********          SETON                     OFOV                 S01117
     C/COPY WNCPYSRC,LE0450C018
     C**                                                                  S01117
     C                   Z-ADD     0             ##BNDX            4 0
     C     *LIKE         DEFINE    ##BNDX        B
     C     *LIKE         DEFINE    ##BNDX        ##BSV
      *                                                                                       CSC042
     C**   IN THE DATAAREA RUNDAT                                         S01117
     C**                                                                  S01117
     C     *DTAARA       DEFINE    RUNDAT        RUNDT                                         S0111
     C                   IN        RUNDT                                                       S0111
     C*    DEFINE LDA                                                     S01117
     C     *DTAARA       DEFINE                  LDA                                           S0111
     C     *LOCK         IN        LDA                                                         S0111
     C**                                                                  S01117
     C**                                                                  S01117
     C*     IF MBIN=Y, SET ON *IN33                                       S01117
     C**                                                                  S01117
     C     MBIN          IFEQ      'Y'                                                         S0111
     C                   SETON                                        33                       S0111
     C                   END                                                                   S0111
0618 C**
0619 C**********           EXSR ZSYSTM                     1CDR1 FOR DATE S01194
0620 C**                                                   AND FORMAT
0621 C***99*****           Z-ADD1         DBASE            ***************S01194
0622 C***99*****           GOTO ENDDBE                     ***  DB  1  ***S01194
0623 C**                                                   ***************
0624 C**********           MOVE '11'      ZTABKY           ICDR2          S01194
0625 C**********           SETOF                     89                   S01194
0626 C********** ZTABKY    CHAINTABLE                89                   S01194
0627 C**N89***** RECI      COMP 'D'                  8989  ***************S01194
0628 C***89*****           Z-ADD2         DBASE            ***  DB  2  ***S01194
0629 C***89*****           GOTO ENDDBE                     ***************S01194
0630 C**
     C**    ACCESS BANK DETAILS                                           S01194
     C*                                                                   S01194
     C                   CALL      'AOBANKR0'    PLISTA                                        S0119
     C     @RTCD         IFNE      *BLANKS                                                     S0119
     C                   SETON                                        U7U8LR                   S0119
     C                   MOVE      '01'          DBASE                                         S0119
     C                   MOVE      'SDBANKPD'    DBFILE                                        S0119
     C                   GOTO      ENDDBE                                                      S0119
     C                   END                                                                   S0119
     C*                                                                   S01194
0651 C*    CHECK SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.                    S01194
0652 C     DATF          COMP      'M'                                    98    MMDDYY, 98 ON  S0119
     C*                                                                   S01194
     C**    ACCESS GENERAL LEDGER DETAILS                                 S01194
     C*                                                                   S01194
     C**********           CALL 'AOGELRR0'PLISTB                                       S01194 CGL029
     C                   CALL      'AOGELRR1'    PLISTB
     C     @RTCD         IFNE      *BLANKS                                                     S0119
     C                   SETON                                        U7U8LR                   S0119
     C                   MOVE      '02'          DBASE                                         S0119
     C                   MOVE      'SDGELRPD'    DBFILE                                        S0119
     C                   GOTO      ENDDBE                                                      S0119
     C                   END                                                                   S0119
     C                   CALL      'AOMMODR0'    PLISTE                                        S0119
     C     @RTCD         IFNE      *BLANKS                                                     S0119
     C                   SETON                                        U7U8LR                   S0119
     C                   MOVE      '04'          DBASE                                         S0119
     C                   MOVE      'SDMMODPD'    DBFILE                                        S0119
     C                   GOTO      ENDDBE                                                      S0119
     C                   END                                                                   S0119
     C*                                                                   CAC001
     C** If Analytical Accounting is available, retrieve Primary          CAC001
     C** Funding Profit Centre from PF/SDPCACPD.                          CAC001
     C*                                                                   CAC001
     C     BGN0ST        IFEQ      'Y'                                                         CAC00
      *                                                                   CAC001
     C                   CALL      'AOPCACR0'                                                  CAC00
     C                   PARM      *BLANKS       @RTCD                                         CAC00
     C                   PARM      '*FIRST '     @OPTN                                         CAC00
     C     SDPCAC        PARM      SDPCAC        DSFDY                                         CAC00
     C     @RTCD         IFNE      *BLANKS                                                     CAC00
     C                   SETON                                        U7U8LR                   CAC00
     C                   MOVE      '16'          DBASE                                         CAC00
     C                   MOVE      'SDPCACPD'    DBFILE                                        CAC00
     C                   GOTO      ENDDBE                                                      CAC00
     C                   ENDIF                                                                 CAC00
      *                                                                   CAC001
     C                   ENDIF                                                                 CAC00
      *                                                                   S01486
      ** Open if PM On.                                                   S01486
      *                                                                   S01486
     C     BGPFMG        IFEQ      'Y'                                                         S0148
     C                   OPEN      PMCHTVPD                                                    S0148
     C                   END                                                                   S0148
     C*                                                                   S01194
0631 C**********           MOVE '50'      ZTABKY           ICDR6          S01194
0632 C********** ZTABKY    CHAINTABLE                89                   S01194
0633 C**N89***** RECI      COMP 'D'                  8989  ***************S01194
0634 C***89*****           Z-ADD3         DBASE            ***  DB  3  ***S01194
0635 C***89*****           GOTO ENDDBE                     ***************S01194
0707 C**                                                                  S01195
     C*                                                                   S01465
     C**  Read switchable features file SCSARDPD using access object      S01465
     C**  to determine if Lending and Guarantees Issued Enhancements      S01465
     C**  feature is switched ON                                          S01465
     C*                                                                   S01465
     C                   CALL      'AOSARDR0'                                                  S0146
     C                   PARM      *BLANKS       @RTCD                                         S0146
     C                   PARM      '*VERIFY'     @OPTN                                         S0146
     C                   PARM      'S01465'      @SARD             6                           S0146
     C     SCSARD        PARM      SCSARD        DSFDY                                         S0146
     C                   MOVE      '0'           *IN25                                         S0146
     C*                                                                   S01465
     C**  If feature is on, set up SAR indicator  (*IN25)                 S01465
     C*                                                                   S01465
     C     @RTCD         IFEQ      *BLANKS                                                     S0146
     C                   MOVE      '1'           *IN25                                         S0146
     C                   ELSE                                                                  S0146
     C*                                                                   S01465
     C** else, database error (return code other than *NRF)               S01465
     C*                                                                   S01465
     C     @RTCD         IFNE      '*NRF   '                                                   S0146
     C                   MOVEL     'LE0450'      DBPGM                                         S0146
     C                   MOVEL     'SCSARDPD'    DBFILE                         ************   S0146
     C                   MOVEL     '*VERIFY'     DBKEY                          * DBERR 12 *   S0146
     C                   Z-ADD     12            DBASE                          ************   S0146
     C                   SETON                                        U7U8LR                   S0146
     C                   GOTO      ENDDBE                                                      S0146
     C                   END                                                                   S0146
     C*                                                                   S01465
     C                   END                                                                   S0146
     C/COPY WNCPYSRC,LE0450C014
      *                                                                   116330
      * Check for Back-valuations feature.                                116330
     C                   CALL      'AOSARDR0'                                                  11633
     C                   PARM      *BLANKS       @RTCD                                         11633
     C                   PARM      '*VERIFY'     @OPTN                                         11633
     C                   PARM      'CLE003'      @SARD             6                           11633
     C                   PARM                    DSFDY                                         11633
      *                                                                   116330
     C                   SELECT                                                                11633
     C     @RTCD         WHENEQ    *BLANKS                                                     11633
     C                   MOVE      'Y'           CLE003            1                           11633
     C     @RTCD         WHENEQ    '*NRF'                                                      11633
     C                   MOVE      'N'           CLE003                                        11633
     C                   OTHER                                                                 11633
     C                   MOVEL     'LE0450'      DBPGM                                         11633
     C                   MOVEL     'SCSARDPD'    DBFILE                                        11633
     C                   MOVEL     '*VERIFY'     DBKEY                                         11633
     C                   Z-ADD     16            DBASE                                         11633
     C                   SETON                                        U7U8LR                   11633
     C                   GOTO      ENDDBE                                                      11633
     C                   ENDSL                                                                 11633
      *                                                                   CLE004
      * Check if CLE007 switched on                                                           CLE015
     C                   CALL      'AOSARDR0'
     C                   PARM      *BLANKS       @RTCD
     C                   PARM      '*VERIFY'     @OPTN
     C                   PARM      'CLE007'      @SARD             6
     C                   PARM                    DSFDY
      *                                                                                       CLE015
     C                   SELECT
     C     @RTCD         WHENEQ    *BLANKS
     C                   MOVE      'Y'           CLE007            1
     C     @RTCD         WHENEQ    '*NRF'
     C                   MOVE      'N'           CLE007
     C                   OTHER
     C                   MOVEL     'LE0450'      DBPGM
     C                   MOVEL     'SCSARDPD'    DBFILE
     C                   MOVEL     '*VERIFY'     DBKEY                          ************
     C                   Z-ADD     20            DBASE                          * DBERR 20 *
     C                   SETON                                        U7U8LR    ************
     C                   GOTO      ENDDBE
     C                   ENDSL
      *                                                                   CLE004
      * Access switchable features.                                       CLE004
     C                   MOVE      'N'           CLE004            1                           CLE00
     C                   MOVE      'N'           CLE006            1                           CLE00
     C                   MOVEL     'CLE004'      @SARD                                         CLE00
     C                   CALL      'AOSARDR0'    PLISTF                                        CLE00
     C     @RTCD         IFEQ      *BLANKS                                                     CLE00
     C                   MOVE      'Y'           CLE004                                        CLE00
     C                   MOVEL     'CLE006'      @SARD                                         CLE00
     C                   CALL      'AOSARDR0'    PLISTF                                        CLE00
     C     @RTCD         IFEQ      *BLANKS                                                     CLE00
     C                   MOVE      'Y'           CLE006                                        CLE00
     C                   ENDIF                                                                 CLE00
     C                   ENDIF                                                                 CLE00
      *                                                                   CLE005
      ** Access switchable features for CLE005                            CLE005
      *                                                                   CLE005
     C                   MOVEL     'CLE005'      @SARD                                         CLE00
     C                   CALL      'AOSARDR0'    PLISTF                                        CLE00
     C     @RTCD         IFEQ      *BLANKS                                                     CLE00
     C                   MOVE      'Y'           CLE005            1                           CLE00
     C                   ELSE                                                                  CLE00
     C                   MOVE      'N'           CLE005                                        CLE00
     C                   ENDIF                                                                 CLE00
      *                                                                   CEU004
      ** Access SAR details file to see if CEU004 is installed            CEU004
      *                                                                   CEU004
     C                   MOVE      'N'           CEU004            1            Set SAR Flag   CEU00
      *                                                                   CEU004
     C                   CALL      'AOSARDR0'                                   Rtv SAR Dtls   CEU00
      *                                                    Input:         CEU004
     C                   PARM      '       '     @RTCD             7            -Return Code   CEU00
     C                   PARM      '*VERIFY'     @OPTN             7            -Option        CEU00
     C                   PARM      'CEU004'      @SARD             6            -SAR No        CEU00
      *                                                    Output:        CEU004
     C     SCSARD        PARM      SCSARD        DSFDY                          -Format        CEU00
      *                                                                   CEU004
     C     @RTCD         IFEQ      *BLANK                                       If Found       CEU00
     C                   MOVE      'Y'           CEU004                          Set SAR Flag  CEU00
      *                                                                   CEU004
     C                   ELSE                                                   Else           CEU00
     C     @RTCD         IFNE      '*NRF   '                                     If # NoRecFnd CEU00
     C                   MOVEL     'SCSARDPD'    DBFILE                           Set File     CEU00
     C                   MOVEL     '*VERIFY'     DBKEY                            Set Key      CEU00
     C***********          Z-ADD6         DBASE              Set D CEU004 134798
     C                   Z-ADD     17            DBASE                            Set DBase Ref13479
     C                   SETON                                        U7U8LR      Set Inds     CEU00
     C                   GOTO      ENDDBE                                         Bypass       CEU00
     C                   ENDIF                                                   End If        CEU00
     C                   ENDIF                                                  End If         CEU00
      *                                                                   CEU004
      ** Check whether SAR CEU020 is installed                            CEU020
      *                                                                   CEU020
     C                   MOVE      'N'           CEU020            1                           CEU02
     C                   CALL      'AOSARDR0'                                                  CEU02
     C                   PARM      '       '     @RTCD             7                           CEU02
     C                   PARM      '*VERIFY'     @OPTN             7                           CEU02
     C                   PARM      'CEU020'      @SARD             6                           CEU02
     C     SCSARD        PARM      SCSARD        DSFDY                                         CEU02
      *                                                                   CEU020
     C     @RTCD         IFEQ      *BLANK                                                      CEU02
     C                   MOVE      'Y'           CEU020                                        CEU02
     C                   ELSE                                                                  CEU02
     C     @RTCD         IFNE      '*NRF   '                                                   CEU02
     C                   MOVEL     'SCSARDPD'    DBFILE                                        CEU02
     C                   MOVEL     'CEU020 '     DBKEY                                         CEU02
     C                   Z-ADD     18            DBASE                                         CEU02
     C                   SETON                                        U7U8LR                   CEU02
     C                   GOTO      ENDDBE                                                      CEU02
     C                   ENDIF                                                                 CEU02
     C                   ENDIF                                                                 CEU02
      *                                                                   CLE011
      ** Check whether SAR CLE011 is installed                            CLE011
      *                                                                   CLE011
     C                   MOVE      'N'           CLE011            1                           CLE01
     C                   CALL      'AOSARDR0'                                                  CLE01
     C                   PARM      *BLANKS       @RTCD             7                           CLE01
     C                   PARM      '*VERIFY'     @OPTN             7                           CLE01
     C                   PARM      'CLE011'      @SARD             6                           CLE01
     C     SCSARD        PARM      SCSARD        DSFDY                                         CLE01
      *                                                                   CLE011
     C     @RTCD         IFEQ      *BLANK                                                      CLE01
     C                   MOVE      'Y'           CLE011                                        CLE01
     C                   ELSE                                                                  CLE01
     C     @RTCD         IFNE      '*NRF   '                                                   CLE01
     C                   MOVEL     'SCSARDPD'    DBFILE                                        CLE01
     C                   MOVEL     'CLE011 '     DBKEY                                         CLE01
     C                   Z-ADD     27            DBASE                                         CLE01
     C                   MOVE      *ON           *INU7                                         CLE01
     C                   MOVE      *ON           *INU8                                         CLE01
     C                   MOVE      *ON           *INLR                                         CLE01
     C                   GOTO      ENDDBE                                                      CLE01
     C                   ENDIF                                                                 CLE01
     C                   ENDIF                                                                 CLE01
      *                                                                   CLE011
      *                                                                                       CAS001
      ***Check*if*NPV*Accounting*(CAS011)*is*installed*****************                CAS001 CAS004
      ** Check if NPV Accounting (CAS001) is installed                                        CAS004
      *                                                                                       CAS001
     C                   CALL      'AOSARDR0'
     C                   PARM      *BLANKS       PRTCD             7
     C                   PARM      '*VERIFY'     POPTN             7
     C                   PARM      'CAS001'      PSARD             6
     C     SCSARD        PARM      SCSARD        DSFDY
      *                                                                                       CAS001
     C     PRTCD         IFNE      *BLANKS
     C     PRTCD         ANDNE     '*NRF   '
     C                   MOVEL     'SCSARDPD'    DBFILE
     C                   MOVEL     PSARD         DBKEY
     C                   Z-ADD     028           DBASE
     C                   MOVE      *ON           *INU7
     C                   MOVE      *ON           *INU8
     C                   MOVE      *ON           *INLR
     C                   GOTO      ENDDBE
     C                   ENDIF
      *                                                                                       CAS001
     C     PRTCD         IFEQ      *BLANK
     C                   MOVEL     'Y'           CAS001            1
     C                   ELSE
     C                   MOVEL     'N'           CAS001
     C                   ENDIF
      *                                                                                       CAS004
      ** Check if Hedge Accounting (CAS004) is installed                                      CAS004
      *                                                                                       CAS004
     C                   CALL      'AOSARDR0'
     C                   PARM      *BLANKS       PRTCD             7
     C                   PARM      '*VERIFY'     POPTN             7
     C                   PARM      'CAS004'      PSARD             6
     C     SCSARD        PARM      SCSARD        DSFDY
      *                                                                                       CAS004
     C     PRTCD         IFNE      *BLANKS
     C     PRTCD         ANDNE     '*NRF   '
     C                   MOVEL     'SCSARDPD'    DBFILE
     C                   MOVEL     PSARD         DBKEY
     C                   Z-ADD     029           DBASE
     C                   MOVE      *ON           *INU7
     C                   MOVE      *ON           *INU8
     C                   MOVE      *ON           *INLR
     C                   GOTO      ENDDBE
     C                   ENDIF
      *                                                                                       CAS004
     C     PRTCD         IFEQ      *BLANK
     C                   MOVEL     'Y'           CAS004            1
     C                   ELSE
     C                   MOVEL     'N'           CAS004
     C                   ENDIF
      *                                                                                       CAS004
      ** Access SAR details to check if CLE023 is installed                                   CLE023
      *                                                                                       CLE023
     C                   MOVE      'N'           CLE023            1
     C                   CALL      'AOSARDR0'
     C                   PARM      *BLANKS       @RTCD
     C                   PARM      '*VERIFY'     @OPTN
     C                   PARM      'CLE023'      @SARD
     C     SCSARD        PARM      SCSARD        DSFDY
      *                                                                                       CLE023
     C     @RTCD         IFEQ      *BLANK
     C                   MOVE      'Y'           CLE023
     C                   ELSE
     C     @RTCD         IFNE      '*NRF   '
     C                   MOVEL     'SCSARDPD'    DBFILE
     C                   MOVEL     'CLE023 '     DBKEY
     C                   Z-ADD     28            DBASE
     C                   MOVE      *ON           *INU7
     C                   MOVE      *ON           *INU8
     C                   MOVE      *ON           *INLR
     C                   GOTO      ENDDBE
     C                   ENDIF
     C                   ENDIF
     C/COPY WNCPYSRC,LEH00566
      *                                                                                       CGL020
      ** Determine if Midas Compliance Watch Additional                                       CGL020
      ** Account Postings Information is installed                                            CGL020
      *                                                                                       CGL020
     C                   MOVE      'N'           CGL020            1
     C                   CALL      'AOSARDR0'
     C                   PARM      *BLANKS       PRTCD
     C                   PARM      '*VERIFY'     POPTN
     C                   PARM      'CGL020'      PSARD
     C     SCSARD        PARM      SCSARD        DSFDY
      *                                                                                       CGL020
     C     PRTCD         IFNE      *BLANKS
     C     PRTCD         ANDNE     '*NRF   '
     C                   MOVEL     'LE0450'      DBPGM
     C                   MOVEL     'SCSARDPD'    DBFILE
     C                   Z-ADD     30            DBASE
     C                   MOVEL     PSARD         DBKEY
     C                   MOVE      *ON           *INU7
     C                   MOVE      *ON           *INU8
     C                   MOVE      *ON           *INLR
     C                   GOTO      ENDDBE
     C                   ENDIF
      *                                                                                       CGL020
     C     PRTCD         IFEQ      *BLANKS
     C                   MOVE      'Y'           CGL020
     C                   ENDIF
      *                                                                                      BUG9253
      ** Access switchable feature for CLE106                                                BUG9253
      *                                                                                      BUG9253
     C                   MOVEL     'CLE106'      @SARD
     C                   CALL      'AOSARDR0'    PLISTF
     C     @RTCD         IFEQ      *BLANKS
     C                   MOVE      'Y'           CLE106            1
     C                   ELSE
     C                   MOVE      'N'           CLE106
     C                   ENDIF
      *                                                                                       CLE134
      ** Access Switchable SAR details                                                        CLE134
      *                                                                                       CLE134
     C                   CALL      'AOSARDR0'                                                 CLE134
     C                   PARM      *BLANK        PRTCD                                        CLE134
     C                   PARM      '*VERIFY'     POPTN                                        CLE134
     C                   PARM      'CLE134'      PSARD                                        CLE134
     C     SCSARD        PARM      SCSARD        DSFDY                                        CLE134
      *                                                                                       CLE134
      ** Feature found if return code is blank                                                CLE134
      *                                                                                       CLE134
     C     PRTCD         IFEQ      *BLANK                                                     CLE134
     C                   MOVE      'Y'           CLE134            1                          CLE134
     C                   ELSE                                                                 CLE134
     C                   MOVE      'N'           CLE134                                       CLE134
     C                   ENDIF                                                                CLE134
      *                                                                                       CLE134
     C                   MOVE      'N'           NEWCOB            1                          CLE134
     C     CLE134        IFEQ      'Y'                                                        CLE134
     C     WPNAM         ANDEQ     'NEWCOB'                                                   CLE134
     C                   MOVE      'Y'           NEWCOB            1                          CLE134
     C                   ENDIF                                                                CLE134
      *                                                                                       CLE134
      ** Initialize Fee Flag, Fee Value and Fee Percent                                       CLE134
      *                                                                                       CGL020
     C                   MOVE      *BLANK        F1FFLG
     C                   Z-ADD     0             F1FVAL
     C                   Z-ADD     0             F1FPCT
     C                   MOVE      *BLANKS       WRACT
     C                   MOVE      *BLANKS       WRCTY
     C                   MOVE      *BLANKS       WRBNK
     C                   MOVE      *BLANKS       WRCDE
     C                   MOVE      *BLANKS       WPACT
     C                   MOVE      *BLANKS       WPCTY
     C                   MOVE      *BLANKS       WPBNK
     C                   MOVE      *BLANKS       WPCDE
     C                   MOVE      *BLANKS       WDACT
     C                   MOVE      *BLANKS       WDCTY
     C                   MOVE      *BLANKS       WDBNK
     C                   Z-ADD     0             WSDAT
      *                                                                                       215250
      **  Access SAR details file to see if CDE002 is installed                               215250
      *                                                                                       215250
     C                   MOVE      'N'           CDE002            1
     C                   CALL      'AOSARDR0'
     C                   PARM      '       '     @RTCD
     C                   PARM      '*VERIFY'     @OPTN
     C                   PARM      'CDE002'      @SARD
      *                                                                                       215250
     C     @RTCD         IFNE      *BLANK
     C     @RTCD         ANDNE     '*NRF   '
     C                   MOVEL     'SCSARDPD'    DBFILE
     C                   MOVEL     'CDE002'      DBKEY
     C                   Z-ADD     20            DBASE
     C                   SETON                                        U7U8LR
     C                   GOTO      ENDDBE
     C                   ELSE
      *                                                                                       215250
     C     @RTCD         IFEQ      *BLANK
     C                   MOVE      'Y'           CDE002
     C                   ENDIF
      *                                                                                       215250
     C                   ENDIF
     C/COPY WNCPYSRC,LE0450C070
      *                                                                                       CLE028
      ** Check whether SAR CLE028 is installed                                                CLE028
      *                                                                                       CLE028
     C                   MOVE      'N'           CLE028            1
     C                   CALL      'AOSARDR0'
     C                   PARM      *BLANKS       PRTCD             7
     C                   PARM      '*VERIFY'     POPTN             7
     C                   PARM      'CLE028'      PSARD             6
     C     SCSARD        PARM      SCSARD        DSFDY
      *                                                                                       CLE028
     C     PRTCD         IFEQ      *BLANK
     C                   MOVE      'Y'           CLE028
     C                   ELSE
     C     PRTCD         IFNE      '*NRF   '
     C                   MOVEL     'SCSARDPD'    DBFILE
     C                   MOVEL     'CLE028 '     DBKEY
     C                   Z-ADD     30            DBASE
     C                   MOVE      *ON           *INU7
     C                   MOVE      *ON           *INU8
     C                   MOVE      *ON           *INLR
     C                   GOTO      ENDDBE
     C                   ENDIF
     C                   ENDIF
      *                                                                                       CAS005
      ** Check if CAS005 is installed                                                         CAS005
      *                                                                                       CAS005
     C                   CALL      'AOSARDR0'
     C                   PARM      *BLANKS       PRTCD
     C                   PARM      '*VERIFY'     POPTN
     C                   PARM      'CAS005'      PSARD
     C     SCSARD        PARM      SCSARD        DSFDY
      *                                                                                       CAS005
     C     PRTCD         IFNE      *BLANKS
     C     PRTCD         ANDNE     '*NRF   '
     C                   MOVEL     'SCSARDPD'    DBFILE
     C                   MOVEL     PSARD         DBKEY
     C                   Z-ADD     31            DBASE
     C                   MOVE      *ON           *INU7
     C                   MOVE      *ON           *INU8
     C                   MOVE      *ON           *INLR
     C                   GOTO      ENDDBE
     C                   ENDIF
      *                                                                                       CAS005
     C     PRTCD         IFEQ      *BLANK
     C                   MOVEL     'Y'           CAS005            1
     C                   ELSE
     C                   MOVEL     'N'           CAS005
     C                   ENDIF
      *                                                                                       CLE031
      ** Access SAR details to check if CLE031 is installed                                   CLE031
      *                                                                                       CLE031
     C                   MOVE      'N'           CLE031            1
     C                   CALL      'AOSARDR0'
     C                   PARM      *BLANKS       @RTCD
     C                   PARM      '*VERIFY'     @OPTN
     C                   PARM      'CLE031'      @SARD
     C     SCSARD        PARM      SCSARD        DSFDY
      *                                                                                       CLE031
     C     @RTCD         IFEQ      *BLANK
     C                   MOVE      'Y'           CLE031
     C                   ELSE
     C     @RTCD         IFNE      '*NRF   '
     C                   MOVEL     'SCSARDPD'    DBFILE
     C                   MOVEL     'CLE031 '     DBKEY
     C                   Z-ADD     29            DBASE
     C                   MOVE      *ON           *INU7
     C                   MOVE      *ON           *INU8
     C                   MOVE      *ON           *INLR
     C                   GOTO      ENDDBE
     C                   ENDIF
     C                   ENDIF
     C*                                                                                       218782
     C**  Read switchable features file SCSARDPD using access object                          218782
     C**  to determine if switchable feature (CLE033) is switched ON                          218782
     C*                                                                                       218782
     C                   MOVE      'N'           CLE033            1
     C*                                                                                       218782
     C                   CALL      'AOSARDR0'
     C                   PARM      *BLANKS       @RTCD
     C                   PARM      '*VERIFY'     @OPTN             7
     C                   PARM      'CLE033'      @SARD             6
     C     SCSARD        PARM      SCSARD        DSFDY
     C*                                                                                       218782
     C**  If feature is on, set up CLE033 variable                                            218782
     C*                                                                                       218782
     C     @RTCD         IFEQ      *BLANKS
      *                                                                                       218782
     C                   MOVE      'Y'           CLE033
      *                                                                                       218782
     C                   CALL      'AOSVALR0'
     C                   PARM      *BLANKS       @RTCD
     C                   PARM      SVAL(1)       P@OP01           20
     C                   PARM      *BLANKS       P@VL01          200
     C                   PARM      *BLANKS       P@OP02           20
     C                   PARM      *BLANKS       P@VL02          200
     C                   PARM      *BLANKS       P@OP03           20
     C                   PARM      *BLANKS       P@VL03          200
     C                   PARM      *BLANKS       P@OP04           20
     C                   PARM      *BLANKS       P@VL04          200
     C                   PARM      *BLANKS       P@OP05           20
     C                   PARM      *BLANKS       P@VL05          200
     C                   PARM      *BLANKS       P@OP06           20
     C                   PARM      *BLANKS       P@VL06          200
     C                   PARM      *BLANKS       P@OP07           20
     C                   PARM      *BLANKS       P@VL07          200
     C                   PARM      *BLANKS       P@OP08           20
     C                   PARM      *BLANKS       P@VL08          200
     C                   PARM      *BLANKS       P@OP09           20
     C                   PARM      *BLANKS       P@VL09          200
     C                   PARM      *BLANKS       P@OP10           20
     C                   PARM      *BLANKS       P@VL10          200
     C***********SDSVAL    PARM SDSVAL    DSSDY                                        218782 222373
      *                                                                                       218782
     C     @RTCD         IFNE      *BLANKS
     C                   MOVEL     'LE0450  '    DBPGM
     C                   MOVEL     'SDSVALPD'    DBFILE
     C                   MOVEL     SVAL(1)       DBKEY
     C                   Z-ADD     24            DBASE
     C                   MOVE      *ON           *INU7
     C                   MOVE      *ON           *INU8
     C                   MOVE      *ON           *INLR
     C                   GOTO      ENDDBE
     C                   ENDIF
      *                                                                                       218782
      ** Save value of Settlement09Postings in a one character field                          218782
     C                   MOVEL     P@VL01        SET09             1
     C                   ENDIF
      *                                                                                     MD027475
     C                   CALL      'AOSVALR0'                                               MD027475
     C                   PARM      *BLANKS       @RTCD                                      MD027475
     C                   PARM      SVAL(2)       P@OP01           20                        MD027475
     C                   PARM      *BLANKS       P@VL01          200                        MD027475
     C                   PARM      *BLANKS       P@OP02           20                        MD027475
     C                   PARM      *BLANKS       P@VL02          200                        MD027475
     C                   PARM      *BLANKS       P@OP03           20                        MD027475
     C                   PARM      *BLANKS       P@VL03          200                        MD027475
     C                   PARM      *BLANKS       P@OP04           20                        MD027475
     C                   PARM      *BLANKS       P@VL04          200                        MD027475
     C                   PARM      *BLANKS       P@OP05           20                        MD027475
     C                   PARM      *BLANKS       P@VL05          200                        MD027475
     C                   PARM      *BLANKS       P@OP06           20                        MD027475
     C                   PARM      *BLANKS       P@VL06          200                        MD027475
     C                   PARM      *BLANKS       P@OP07           20                        MD027475
     C                   PARM      *BLANKS       P@VL07          200                        MD027475
     C                   PARM      *BLANKS       P@OP08           20                        MD027475
     C                   PARM      *BLANKS       P@VL08          200                        MD027475
     C                   PARM      *BLANKS       P@OP09           20                        MD027475
     C                   PARM      *BLANKS       P@VL09          200                        MD027475
     C                   PARM      *BLANKS       P@OP10           20                        MD027475
     C                   PARM      *BLANKS       P@VL10          200                        MD027475
      *                                                                                     MD027475
     C     @RTCD         IFNE      *BLANKS                                                  MD027475
     C                   MOVEL     'LE0450  '    DBPGM                                      MD027475
     C                   MOVEL     'SDSVALPD'    DBFILE                                     MD027475
     C                   MOVEL     SVAL(2)       DBKEY                                      MD027475
     C                   Z-ADD     25            DBASE                                      MD027475
     C                   MOVE      *ON           *INU7                                      MD027475
     C                   MOVE      *ON           *INU8                                      MD027475
     C                   MOVE      *ON           *INLR                                      MD027475
     C                   GOTO      ENDDBE                                                   MD027475
     C                   ENDIF                                                              MD027475
      *                                                                                     MD027475
      ** Save value of SplitPrinInterestFlg in a one character field                        MD027475
     C                   MOVEL     P@VL01        SPLITF            1                        MD027475
     C                   MOVEL     P@VL02        WCALC6            1                        MD035545
     C********** WCALC6    IFEQ 'Y'                                                MD035545 MD047993
     C********** BKALDI    ANDEQ'Y'                                                MD035545 MD047993
     C**********           MOVE 'Y'       WCALC6                                   MD035545 MD047993
     C**********           ELSE                                                    MD035545 MD047993
     C**********           MOVE 'N'       WCALC6                                   MD035545 MD047993
     C**********           ENDIF                                                   MD035545 MD047993
      *                                                                                     MD045091
     C                   CALL      'AOSVALR0'                                               MD045091
     C                   PARM      *BLANKS       @RTCD                                      MD045091
     C                   PARM      WPARML1       P@OP01                                     MD045091
     C                   PARM      *BLANKS       P@VL01                                     MD045091
     C                   PARM      *BLANKS       P@OP02                                     MD045091
     C                   PARM      *BLANKS       P@VL02                                     MD045091
     C                   PARM      *BLANKS       P@OP03                                     MD045091
     C                   PARM      *BLANKS       P@VL03                                     MD045091
     C                   PARM      *BLANKS       P@OP04                                     MD045091
     C                   PARM      *BLANKS       P@VL04                                     MD045091
     C                   PARM      *BLANKS       P@OP05                                     MD045091
     C                   PARM      *BLANKS       P@VL05                                     MD045091
     C                   PARM      *BLANKS       P@OP06                                     MD045091
     C                   PARM      *BLANKS       P@VL06                                     MD045091
     C                   PARM      *BLANKS       P@OP07                                     MD045091
     C                   PARM      *BLANKS       P@VL07                                     MD045091
     C                   PARM      *BLANKS       P@OP08                                     MD045091
     C                   PARM      *BLANKS       P@VL08                                     MD045091
     C                   PARM      *BLANKS       P@OP09                                     MD045091
     C                   PARM      *BLANKS       P@VL09                                     MD045091
     C                   PARM      *BLANKS       P@OP10                                     MD045091
     C                   PARM      *BLANKS       P@VL10                                     MD045091
      *                                                                                     MD045091
     C     @RTCD         IFNE      *BLANKS                                                  MD045091
     C                   MOVEL     'LE0450  '    DBPGM                                      MD045091
     C                   MOVEL     'SDSVALPD'    DBFILE                                     MD045091
     C                   MOVEL     WPARML1       DBKEY                                      MD045091
     C                   Z-ADD     26            DBASE                                      MD045091
     C                   MOVE      *ON           *INU7                                      MD045091
     C                   MOVE      *ON           *INU8                                      MD045091
     C                   MOVE      *ON           *INLR                                      MD045091
     C                   GOTO      ENDDBE                                                   MD045091
     C                   ENDIF                                                              MD045091
      *                                                                                     MD045091
      ** Save value of 'RepayDateOnMaturity'                                                MD045091
      *                                                                                     MD045091
     C                   MOVEL     P@VL01        REDATM            1                        MD045091
      *                                                                                       CLE034
      ** Access SAR details to check if CLE034 is installed                                   CLE034
      *                                                                                       CLE034
     C                   MOVE      'N'           CLE034            1
     C                   CALL      'AOSARDR0'
     C                   PARM      *BLANKS       @RTCD
     C                   PARM      '*VERIFY'     @OPTN
     C                   PARM      'CLE034'      @SARD
     C     SCSARD        PARM      SCSARD        DSFDY
      *                                                                                       CLE034
     C     @RTCD         IFEQ      *BLANK
     C                   MOVE      'Y'           CLE034
     C                   ELSE
     C     @RTCD         IFNE      '*NRF   '
     C                   MOVEL     'SCSARDPD'    DBFILE
     C                   MOVEL     'CLE034 '     DBKEY
     C                   Z-ADD     31            DBASE
     C                   MOVE      *ON           *INU7
     C                   MOVE      *ON           *INU8
     C                   MOVE      *ON           *INLR
     C                   GOTO      ENDDBE
     C                   ENDIF
     C                   ENDIF
      *                                                                                       CAS009
      ** Check if CAS009 is enabled.                                                          CAS009
      *                                                                                       CAS009
     C                   CALL      'AOSARDR0'
     C                   PARM      *BLANKS       PRTCD
     C                   PARM      '*VERIFY'     POPTN
     C                   PARM      'CAS009'      PSARD
     C     SCSARD        PARM      SCSARD        DSFDY
      *                                                                                       CAS009
     C                   MOVE      'N'           CAS009            1
     C     PRTCD         IFEQ      *BLANKS
     C                   MOVE      'Y'           CAS009
     C                   ELSE
      *                                                                                       CAS009
     C     PRTCD         IFNE      '*NRF   '
     C                   MOVEL     'SCSARDPD'    DBFILE
     C                   MOVEL     PSARD         DBKEY
     C                   Z-ADD     101           DBASE
     C                   MOVE      *ON           *INU7
     C                   MOVE      *ON           *INU8
     C                   MOVE      *ON           *INLR
     C                   GOTO      ENDDBE
     C                   ENDIF
      *                                                                                       CAS009
     C                   ENDIF
      *                                                                                       CAS009
      ** Access hedging details if CAS009 is enabled.                                         CAS009
      *                                                                                       CAS009
     C     CAS009        IFEQ      'Y'
      *                                                                                       CAS009
     C                   CALL      'AOHEDGR0'
     C                   PARM      *BLANKS       PRTCD
     C                   PARM      '*FIRST '     POPTN
     C     SDHEDG        PARM      SDHEDG        DSFDY
      *                                                                                       CAS009
     C     PRTCD         IFNE      *BLANKS
     C                   MOVEL     'SDHEDGPD'    DBFILE
     C                   MOVEL     POPTN         DBKEY
     C                   Z-ADD     102           DBASE
     C                   MOVE      *ON           *INU7
     C                   MOVE      *ON           *INU8
     C                   MOVE      *ON           *INLR
     C                   GOTO      ENDDBE
     C                   ENDIF
      *                                                                                       CAS009
     C                   ENDIF
1     *                                                                                       CLE038
      ** Access SAR details to check if CLE038 is installed                                   CLE038
      *                                                                                       CLE038
     C                   MOVE      'N'           CLE038            1
      *                                                                                       CLE038
     C     CLE034        IFEQ      'Y'
     C                   CALL      'AOSARDR0'
     C                   PARM      *BLANKS       @RTCD
     C                   PARM      '*VERIFY'     @OPTN
     C                   PARM      'CLE038'      @SARD
     C     SCSARD        PARM      SCSARD        DSFDY
      *                                                                                       CLE038
     C     @RTCD         IFEQ      *BLANK
     C                   MOVE      'Y'           CLE038
     C                   ELSE
     C     @RTCD         IFNE      '*NRF   '
     C                   MOVEL     'SCSARDPD'    DBFILE
     C                   MOVEL     'CLE038 '     DBKEY
     C                   Z-ADD     33            DBASE
     C                   MOVE      *ON           *INU7
     C                   MOVE      *ON           *INU8
     C                   MOVE      *ON           *INLR
     C                   GOTO      ENDDBE
     C                   ENDIF
     C                   ENDIF
     C                   ENDIF
      ** Open file if CLE038 on:                                                              CLE038
      *                                                                                       CLE038
     C     CLE038        IFEQ      'Y'
     C                   OPEN      LEXSTAL7
     C                   END
      *                                                                                       CLE036
      ** Access SAR details to check if CLE036 is installed                                   CLE036
      *                                                                                       CLE036
     C                   MOVE      'N'           CLE036            1
     C                   CALL      'AOSARDR0'
     C                   PARM      *BLANKS       @RTCD
     C                   PARM      '*VERIFY'     @OPTN
     C                   PARM      'CLE036'      @SARD
     C     SCSARD        PARM      SCSARD        DSFDY
      *                                                                                       CLE036
     C     @RTCD         IFEQ      *BLANK
     C                   MOVE      'Y'           CLE036
     C                   ELSE
     C     @RTCD         IFNE      '*NRF   '
     C                   MOVEL     'SCSARDPD'    DBFILE
     C                   MOVEL     'CLE036 '     DBKEY
     C                   Z-ADD     32            DBASE
     C                   MOVE      *ON           *INU7
     C                   MOVE      *ON           *INU8
     C                   MOVE      *ON           *INLR
     C                   GOTO      ENDDBE
     C                   ENDIF
     C                   ENDIF
      *                                                                                       CRE073
     C                   MOVE      'N'           CRE073            1
     C                   CALL      'AOSARDR0'
     C                   PARM      *BLANKS       @RTCD
     C                   PARM      '*VERIFY'     @OPTN
     C                   PARM      'CRE073'      @SARD
     C     SCSARD        PARM      SCSARD        DSFDY
      *                                                                                       CRE073
     C     @RTCD         IFEQ      *BLANK
     C                   MOVE      'Y'           CRE073
     C                   ELSE
     C     @RTCD         IFNE      '*NRF   '
     C                   MOVEL     'SCSARDPD'    DBFILE
     C                   MOVEL     'CRE073 '     DBKEY
     C                   Z-ADD     32            DBASE
     C                   MOVE      *ON           *INU7
     C                   MOVE      *ON           *INU8
     C                   MOVE      *ON           *INLR
     C                   GOTO      ENDDBE
     C                   ENDIF
     C                   ENDIF
                                                                                              CLE141
      ** Determine if CLE141 is installed                                                     CLE141
                                                                                              CLE141
     C                   MOVE      'N'           CLE141            1                          CLE141
     C                   CALL      'AOSARDR0'                                                 CLE141
     C                   PARM      *BLANK        @RTCD                                        CLE141
     C                   PARM      '*VERIFY'     @OPTN                                        CLE141
     C                   PARM      'CLE141'      @SARD                                        CLE141
     C     SCSARD        PARM      SCSARD        DSFDY                                        CLE141
                                                                                              CLE141
     C     @RTCD         IFEQ      *BLANK                                                     CLE141
     C                   MOVE      'Y'           CLE141                                       CLE141
     C                   ELSE                                                                 CLE141
     C                   MOVE      'N'           CLE141                                       CLE141
     C                   ENDIF                                                                CLE141
      *                                                                                       CLE154
      ** Access SAR details to check if CLE154 is installed                                   CLE154
      *                                                                                       CLE154
     C                   MOVE      'N'           CLE154            1                          CLE154
     C                   CALL      'AOSARDR0'                                                 CLE154
     C                   PARM      *BLANKS       @RTCD                                        CLE154
     C                   PARM      '*VERIFY'     @OPTN                                        CLE154
     C                   PARM      'CLE154'      @SARD                                        CLE154
     C     SCSARD        PARM      SCSARD        DSFDY                                        CLE154
      *                                                                                       CLE154
     C     @RTCD         IFEQ      *BLANK                                                     CLE154
     C                   MOVE      'Y'           CLE154                                       CLE154
     C                   ELSE                                                                 CLE154
     C     @RTCD         IFNE      '*NRF   '                                                  CLE154
     C                   MOVEL     'SCSARDPD'    DBFILE                                       CLE154
     C                   MOVEL     'CLE154 '     DBKEY                                        CLE154
     C                   Z-ADD     41            DBASE                                        CLE154
     C                   MOVE      *ON           *INU7                                        CLE154
     C                   MOVE      *ON           *INU8                                        CLE154
     C                   MOVE      *ON           *INLR                                        CLE154
     C                   GOTO      ENDDBE                                                     CLE154
     C                   ENDIF                                                                CLE154
     C                   ENDIF                                                                CLE154
      *
     C**********         MOVE      'N'           CFC006            1              AR1097176 MD020563
     C**********         CALL      'AOSARDR0'                                     AR1097176 MD020563
     C**********         PARM      *BLANKS       @RTCD                            AR1097176 MD020563
     C**********         PARM      '*VERIFY'     @OPTN                            AR1097176 MD020563
     C**********         PARM      'CFC006'      @SARD                            AR1097176 MD020563
     C*****SCSARD        PARM      SCSARD        DSFDY                            AR1097176 MD020563
      *****************************************************************           AR1097176 MD020563
     C*****@RTCD         IFEQ      *BLANK                                         AR1097176 MD020563
     C**********         MOVE      'Y'           CFC006                           AR1097176 MD020563
     C**********         ELSE                                                     AR1097176 MD020563
      *****************************************************************           AR1097176 MD020563
     C*****@RTCD         IFNE      '*NRF   '                                      AR1097176 MD020563
     C**********         MOVEL     'SCSARDPD'    DBFILE                           AR1097176 MD020563
     C**********         MOVEL     'CFC006 '     DBKEY                            AR1097176 MD020563
     C**********         Z-ADD     35            DBASE                            AR1097176 MD020563
     C**********         MOVE      *ON           *INU7                            AR1097176 MD020563
     C**********         MOVE      *ON           *INU8                            AR1097176 MD020563
     C**********         MOVE      *ON           *INLR                            AR1097176 MD020563
     C**********         GOTO      ENDDBE                                         AR1097176 MD020563
     C**********         ENDIF                                                    AR1097176 MD020563
     C**********         ENDIF                                                    AR1097176 MD020563
      *                                                                                    AR1097176
     C                   MOVEL     *ON           *IN59                                     AR1097176
     C                   MOVEL     *ON           *IN36                                     AR1097176
     C                   MOVEL     *ON           *IN39                                      MD020118
      *                                                                                    AR1097176
     C*****CFC006        IFEQ      'Y'                                            AR1097176 MD020563
      *                                                                                    AR1097176
      ** Enable output indicator for LE0450P1 and LE0450P2                                 AR1097176
      *                                                                                    AR1097176
     C                   CALL      'AOCOMR0'                                               AR1097176
     C                   PARM      'LEC06A '     PNAME            10                       AR1097176
     C                   PARM      '*ALL '       PCSEQ             5                       AR1097176
     C                   PARM      SECTN1        PSCTN            50                       AR1097176
     C                   PARM      *BLANKS       PRTCD                                     AR1097176
      *                                                                                    AR1097176
     C     PRTCD         IFEQ      'Y      '                                               AR1097176
     C                   MOVEL     *OFF          *IN59                                     AR1097176
     C                   ENDIF                                                             AR1097176
      *                                                                                    AR1097176
     C                   CALL      'AOCOMR0'                                               AR1097176
     C                   PARM      'LEC06A '     PNAME                                     AR1097176
     C                   PARM      '*ALL '       PCSEQ                                     AR1097176
     C                   PARM      SECTN2        PSCTN                                     AR1097176
     C                   PARM      *BLANKS       PRTCD                                     AR1097176
      *                                                                                    AR1097176
     C     PRTCD         IFEQ      'Y      '                                               AR1097176
     C**********         MOVEL     *OFF          *IN36                            AR1097176 MD020118
     C                   MOVEL     *OFF          *IN39                                      MD020118
     C                   ENDIF                                                             AR1097176
      *                                                                                    AR1097176
     C**********         ENDIF                                                    AR1097176 MD020563
      *
     C/COPY WNCPYSRC,LEH01313
     C*                                                                   S01465
     C                   CALL      'AOCLNDR0'    PLISTC                                        S0119
     C     @RTCD         IFNE      *BLANKS                                                     S0119
     C                   SETON                                        U7U8LR                   S0119
     C                   MOVE      '03'          DBASE                                         S0119
     C                   MOVE      'SDCLNDPD'    DBFILE                                        S0119
     C                   GOTO      ENDDBE                                                      S0119
     C                   END                                                                   S0119
      *                                                                                       CAS001
     C     CAS001        IFEQ      'Y'
     C     BPBCPL        ANDEQ     'Y'
     C                   MOVE      'Y'           WBOOK             1
     C                   ELSE
     C                   MOVE      *BLANK        WBOOK
     C                   ENDIF
     C*                                                                   S01408
     C/COPY WNCPYSRC,LE0450CCP1                                           S01408
     C*                                                                   S01408
     C** Core hook for externalisation.                                   S01408
     C/COPY WNCPYSRC,LE0450CBUW                                           S01408
     C*                                                                   S01408
     C                   MOVE      '0'           *IN26                                         S0146
     C*                                                                   S01465
     C**  If Guarantees Issued is active, set up indicator 26             S01465
     C*                                                                   S01465
     C     BPGIAV        IFEQ      'Y'                                                         S0146
     C                   MOVE      '1'           *IN26                                         S0146
     C                   END                                                                   S0146
0636 C**
0637 C*****CHECK*FOR*LAST*DAY*ACCRUALS                                    S01392
0638 C**
0639 C***********ACLD      COMP 'Y'                      40               S01392
0640 C**
0641 C**   BLANK OUT LDA FOR TYPE OF RUN
0642 C**
0643 C                   MOVE      '        '    DAYRUN
0644 C**
     C**   CALCULATE DAYNO FOR 1ST DAY OF THIS FINANCIAL YEAR
     C**   BY INCREASING LAST END OF YEAR DAYNO BY ONE
     C**
     C     LEYD          ADD       1             JAN1              5 0
0652 C**
0653 C   U3              GOTO      LASTD
0654 C**
     C**   CHECK IF IT IS THE 1ST WORKING DAY OF THE YEAR
     C**
     C**                         .                                        S01117
     C     PRUN          COMP      LEYD                                 4141
     C   41RUND          COMP      LEYD                               41        1ST W.DAY OF YR
0669 C**
0670 C   41              GOTO      DAYCLC
0671 C**
0672 C**   IF FIRST RUN OF DAY CHECK IF THERE WILL BE A SECOND
0673 C**   IF SO DO NOT SET LDA OR INDICS FOR MATLN OUTPUT
0674 C**
0675 C     DNWD          SUB       1             WRK05
0676 C*****      APDA      COMP WRK05                  86
0676 C     BKAPDT        COMP      WRK05                                86
     C     ANWD          IFEQ      '2'                                                         04144
     C***********APFQ      ANDEQ'M'                                041445 059141
     C************IN86     ANDEQ'1'                                041445 059141
     C                   GOTO      LASTD                                                       04144
     C                   END                                                                   04144
0677 C   86              GOTO      DAYCLC
0678 C**
0679 C**   CHECK IF LAST WORKING DAY OF MONTH
0680 C**
0681 C     LASTD         TAG                                                    ** LASTD TAG **
0682 C**
0683 C                   MOVE      DNWD          ZDAYNO
0684 C                   EXSR      ZDATE2
0685 C                   MOVE      RUNA          WRK5              5
0686 C                   MOVEL     WRK5          MONTH             3
0687 C     ZMNM(ZMTH)    COMP      MONTH                              4242
     C**   IF DNWD > EOYD, THEN IT IS THE LAST WORKING DAY OF THE YEAR
     C     DNWD          COMP      EOYD                               43
0689 C   42              MOVE      'MONTHEND'    DAYRUN
0690 C   43              MOVE      'YEAREND '    DAYRUN
      *                                                                   CLE005
      ** Store event control date                                         CLE005
      *                                                                   CLE005
     C     CLE005        IFEQ      'Y'                                                         CLE00
     C                   Z-ADD     1             WEVCD             2 0                         CLE00
     C     MONTH         LOOKUP    ZMNM(WEVCD)                            36                   CLE00
      ***********                                                   147744169210
     C*COP**WN*PYSRC*LE0450C001************************************ 147744169210
      ***********                                                   147744169210
      *                                                                   169210
     C/COPY WNCPYSRC,LE0450CABJ                                           169210
      *                                                                   169210
     C                   ENDIF                                                                 CLE00
0691 C**
0692 C  N43              GOTO      DAYCLC
0693 C**
     C**   SET LAST DAY OF YEAR TO END OF YEAR DATE
     C                   Z-ADD     EOYD          DEC31             5 0
0700 C**
0701 C**   CALCULATE NO. OF DAYS OVER WHICH AGGREGATE BALANCE
0702 C**   IS TO BE CALCULATED
0703 C**
0704 C     DAYCLC        TAG                                                    ** DAYCLC TAG *
0705 C**
0706 C   41              MOVE      JAN1          DAY1              5 0
0707 C**N41                MOVE RUND      DAY1                            E86099
0707 C**                                                                  E86099
0707 C**   IF PRUN+1 = RUND AND IS A HOLIDAY ADD ZERO TO THE NO. OF       E86099
0707 C**   DAYS, IF NOT A HOLIDAY USE RUND AS THE VALUE FOR DAY1.         E86099
0707 C**   IF PRUN1 <> RUND AND NOT A HOLIDAY USE PRUN1 AS DAY1,          E86099
0707 C**   IF IT IS A HOLIDAY ADD ANOTHER DAY TO PRUN1 THEN REPEAT        E86099
0707 C**   THE HOLIDAY AND ADD CHECK UNTIL DATE HELD IN PRUN1 IS          E86099
0707 C**   NOT A HOLIDAY - USE PRUN1 AS DAY1.                             E86099
0707 C**                                                                  E86099
     C                   Z-ADD     0             @HCTR             2 0                         E4177
0707 C     *IN41         IFEQ      '0'                                                         E8609
0707 C     PRUN          ADD       1             PRUN1             5 0                         E8609
0707 C     PRUN1         IFEQ      RUND                                                        E8609
0707 C                   MOVE      RUND          ZDAYNO                                        E8609
0707 C***********          EXSR ZDATE5                           E86099   S01195
0707 C************IN99     IFEQ '1'                              E86099   S01195
      *                                                                   S01195
     C                   MOVE      LCCY          ZCCY                                          S0119
     C                   MOVE      SYSL          ZLOC                                          S0119
0707 C                   EXSR      ZCHKH                                                       S0119
0707 C     ZIND          IFEQ      'H'                                                         S0119
0707 C                   SETON                                        89                       E8609
0707 C                   GOTO      ZERDAY                                                      E8609
0707 C                   ELSE                                                                  E8609
0707 C                   MOVE      RUND          DAY1                                          E8609
0707 C                   END                                                                   E8609
0707 C                   ELSE                                                                  E8609
0707 C                   SETOFF                                       10                       E8609
0707 C     *IN10         DOWEQ     '0'                                                         E8609
0707 C                   MOVE      PRUN1         ZDAYNO                                        E8609
0707 C***********          EXSR ZDATE5                           E86099   S01195
0707 C************IN99     IFEQ '1'                              E86099   S01195
      *                                                                   S01195
     C                   MOVE      LCCY          ZCCY                                          S0119
     C                   MOVE      SYSL          ZLOC                                          S0119
0707 C                   EXSR      ZCHKH                                                       S0119
      *                                                                   S01195
     C     ZIND          IFEQ      'H'                                                         S0119
0707 C     PRUN1         ADD       1             PRUN1                                         E8609
     C                   ADD       1             @HCTR             2 0          Holiday ctr.   E4177
0707 C                   ELSE                                                                  E8609
0707 C                   SETON                                        10                       E8609
0707 C                   MOVE      PRUN1         DAY1                                          E8609
     C     ANWD          IFEQ      '2'                                                         E4177
     C***********APFQ      ANDEQ'M'                                E41776 059141
     C                   SUB       @HCTR         DAY1                                          E4177
     C                   END                                                                   E4177
0707 C                   END                                                                   E8609
0707 C                   END                                                                   E8609
0707 C                   END                                                                   E8609
0707 C                   END                                                                   E8609
      *                                                                   S01195
0708 C   U3ELAC          ADD       1             DAY1
0709 C**
0710 C   43DEC31         COMP      EVCD                                 89
     C   43
0711 CAN 89              MOVE      DEC31         DAY2              5 0
0712 C  N43
     COR 43
0713 CANN89              MOVE      EVCD          DAY2
0714 C**
0715 C     DAY2          SUB       DAY1          ADAYS             5 0
0716 C     ADAYS         ADD       1             ADAYS                  89
0717 C     ZERDAY        TAG                                                    ** ZERDAY TAG *E8609
0717 C   89              Z-ADD     0             ADAYS
      *                                                                   131520
      ** ABLN Calculation Initialisation                                  131520
      *                                                                   131520
     C                   Z-ADD     0             ZERO5             5 0                         13152
     C                   Z-ADD     0             ZERO13           13 0                         13152
      *                                                                   131520
      ** Calculate first day of year.                                     131520
      *                                                                   131520
     C     LEYD          ADD       1             FIRY              5 0                         13152
0718 C**
0719 C**   CHECK IF ACCRUAL PROCESSING REQUIRED
0720 C**
0721 C     PAQI          COMP      'Y'                                    44
0722 C**
0723 C**   SET UP CURRENCY ARRAYS
0724 C**
0725 C                   EXSR      CCYARS
0726 C**
0727 C**   GET SPOT RATE AND DEC PLACES FOR LOCAL CCY
0728 C**
     C                   MOVE      LCCY          XCCY                                          S0119
0729 C**********           MOVE LOCY      XCCY                            S01194
0730 C                   EXSR      CCYDSP
0731 C  N99              Z-ADD     XDECP         DECLOC            1 0
0732 C  N99              Z-ADD     XSPOT         SPTLOC           13 8
0733 C**N99*****           Z-ADDXMDIN     MDILOC  10                      S01194
0733 C  N99              MOVEL     XMDIN         MDILOC            1                           S0119
0734 C**
0735 C***99*****           MOVE XCYKEY    ZTABKY           ***************S01194
0736 C***99*****           MOVEL'1'       WRK4    4        ***  DB  5  ***S01194
0737 C***99*****           MOVE LOCY      WRK4             ***************S01194
0738 C***99*****           MOVE WRK4      ZTABKY                          S01194
0739 C***99*****           Z-ADD5         DBASE                           S01194
0740 C***99*****           GOTO ENDDBE                                    S01194
     C     *IN99         IFEQ      '1'                                          ***************S0119
0739 C                   Z-ADD     5             DBASE                          ***  DB  5  ***S0119
0737 C                   MOVE      LCCY          DBKEY                          ***************S0119
     C                   SETON                                        U7U8LR                   S0119
     C                   MOVE      'SDCURRPD'    DBFILE                                     ***S0119
0740 C                   GOTO      ENDDBE                                                      S0119
     C                   END                                                                   S0119
0741 C**
0742 C**   SET UP COUNT FIELDS
0743 C**
0744 C                   Z-ADD     2             NORKP             5 0                        CLE134
0744 C                   Z-ADD     2             NORK              5 0
0745 C                   Z-ADD     2             NORNL             5 0
0746 C                   Z-ADD     2             NORMT             5 0
0747 C                   Z-ADD     2             NORL              5 0
0748 C                   Z-ADD     2             NORA              5 0
0749 C                   Z-ADD     2             NORP              5 0
0750 C**
0751 C                   Z-ADD     0             Z5                5 0
0752 C                   Z-ADD     0             Z13              13 0
0749 C                   Z-ADD     0             NORKR                                         S0111
0749 C                   Z-ADD     0             NORPRT                                        S0111
0753 C***********          MOVE 'Y'       ZOPT                            S01117
0754 C**
      ** If Private Banking Module is installed.                                              203896
     C     BGN4ST        IFEQ      'Y'                                           Begin BGN4ST
      *                                                                                       203896
      ** Set up Replication Processing Indicator.                                             203896
     C                   MOVE      'Y'           WUREPL            1
      *                                                                                       203896
     C                   ENDIF                                                   End BGN4ST
      *                                                                                       CLE134
     C     CLE134        IFEQ      'Y'                                                        CLE134
     C     1             SETLL     LEPK1DPD                                                   CLE134
     C     1             SETLL     LEPK1HH                                                    CLE134
     C                   READ      LEPK1HH                                88                  CLE134
     C     *IN88         IFEQ      *ON                                                        CLE134
     C                   MOVE      'H'           RECI                                         CLE134
     C                   WRITE     LKEYF1AF                                                   CLE134
     C                   ENDIF                                                                CLE134
     C                   ENDIF                                                                CLE134
      *                                                                                       CLE134
      ** store existing trailers amount                                                       CLE134
      *                                                                                       CLE134
     C                   Z-ADD     0             L1VLRF                                       CLE134
     C                   Z-ADD     0             L1VLRL                                       CLE134
     C                   Z-ADD     0             L1NORE                                       CLE134
      *                                                                                       CLE134
     C     1             SETLL     LEPK1ZZ                                                    CLE134
     C                   READ      LEPK1ZZ                                88                  CLE134
     C     *IN88         IFEQ      *OFF                                                       CLE134
     C                   Z-ADD     NORE          L1NORE                                       CLE134
     C                   Z-ADD     VLRF          L1VLRF                                       CLE134
     C                   Z-ADD     VLRL          L1VLRL                                       CLE134
     C                   ENDIF                                                                CLE134
      *                                                                                       203896
0755 C                   GOTO      ENDFC
0756 C**
0757 C*****DATABASE*ERROR*ON*TABLE                                        S01194
0758 C**
0759 C     ENDDBE        TAG                                                    ** ENDDBE TAG *
     C   U7              SETON                                        09                       BHF65
0760 C**
0761 C**********           MOVE 'TABLE'   DBFILE                          S01194
0762 C**********           MOVELZTABKY    DBKEY                           S01194
0763 C**********           SETON                     U7U8LR               S01194
      **********                                                                       CPB001 203896
      ***If*Private*Banking*Module*is*installed.***                                    CPB001 203896
     C********** BGN4ST    IFEQ 'Y'                         Begin BGN4ST               CPB001 203896
      **********                                                                       CPB001 203896
      ***Set*up*Replication*Processing*Indicator.***                                   CPB001 203896
     C**********           MOVE 'Y'       WUREPL  1                                    CPB001 203896
      **********                                                                       CPB001 203896
     C**********           ENDIF                            End BGN4ST                 CPB001 203896
      *                                                                                       CLE023
     C     *LIKE         DEFINE    NCCY          WNCCY
     C     *LIKE         DEFINE    NCPA          WNCPA
     C     *LIKE         DEFINE    NFCE          WNFCE
     C     *LIKE         DEFINE    NFMD          WNFMD
     C     *LIKE         DEFINE    NBCE          WNBCE
     C     *LIKE         DEFINE    NBMD          WNBMD
     C     *LIKE         DEFINE    NLRA          WNLRA
     C     *LIKE         DEFINE    NPRAM         WNPRAM
     C     *LIKE         DEFINE    FRCO          WFRCO                                      MD028338
     C**********         Z-ADD     0             QQLNNO                                    AR1056323
0764 C**
     C                   EVAL      SETRID = *ZEROS                                            CLE164
                                                                                              CLE164
0765 C     ENDFC         ENDSR                                                  ***  ENDFC  ***
0766 C**
0767 C**
      *****************************************************************                       CLE134
      *                                                               *                       CLE134
      *  STRAIL - Update trailer record on LEPK1ZZ                    *                       CLE134
      *                                                               *                       CLE134
      *  Called from MAIN Processing                                  *                       CLE134
      *                                                               *                       CLE134
      *****************************************************************                       CLE134
     C     STRAIL        BEGSR                                                                CLE134
      *                                                                                       CLE134
     C     1             SETLL     LEPK1ZZ                                                    CLE134
     C                   READ      LEPK1ZZ                                88                  CLE134
     C                   Z-ADD     L1NORE        NORE                                         CLE134
     C                   Z-ADD     L1VLRF        VLRF                                         CLE134
     C                   Z-ADD     L1VLRL        VLRL                                         CLE134
     C     *IN88         IFEQ      *ON                                                        CLE134
     C                   MOVE      'T'           RECI                                         CLE134
     C                   ADD       2             NORE                                         CLE134
     C                   WRITE     LKEYF1ZF                                                   CLE134
     C                   ELSE                                                                 CLE134
     C     NORE          IFEQ      0                                                          CLE134
     C                   ADD       2             NORE                                         CLE134
     C                   MOVE      'T'           RECI                                         CLE134
     C                   END                                                                  CLE134
     C                   UPDATE    LKEYF1ZF                                                   CLE134
     C                   ENDIF                                                                CLE134
      *                                                                                       CLE134
     C                   ENDSR                                                                CLE134
      *                                                                                       CLE134
0768 C********************************************************************
0769 C********************************************************************
0770 C**
0771 C**   SUBROUTINE TO PROCESS LOAN 'A' RECORD - LOANA
0772 C**
0773 C**   CALLED FROM MAIN PROCESSING
0774 C**   CALLS CCYDSP,GLZADD,GLINTC(2)
0775 C**
0776 C     LOANA         BEGSR                                                  *** LOANA  ***
     C*                                                                   072582
     C                   MOVE      '0'           *IN23
     C                   MOVE      '0'           *IN35                                         07258
     C                   MOVEA     '00'          *IN(18)                                       13562
     C                   Z-ADD     0             W#MC
     C                   MOVE      '0'           *IN22
     C                   MOVE      *OFF          *IN28                                      MD028338
     C                   MOVE      'N'           WROTDY            1
     C                   MOVE      'N'           SVFPAM            1
     C                   Z-ADD     REPTL         WWREPT            1 0                        CLE154
      *                                                                                       CLE031
      ** If feature CLE031 is on, save values for CPAM and FCXR                               CLE031
      *                                                                                       CLE031
     C     CLE031        IFEQ      'Y'
     C                   MOVE(P)   CPAM          CPAMSV           13 0
     C                   MOVE(P)   FCXR          FCXRSV           13 8
     C                   ENDIF
      *                                                                                       CLE031
     C     CAS009        IFEQ      'Y'
     C********** LORED     ANDEQRDNB                                                 CAS009 BUG13140
     C     LORED         ANDEQ     BKAPDT
     C     RECIL         ANDEQ     'D'
      *                                                                                       232348
      ** Only process EIR cost accounting if loan's value date is same                        232348
      ** as or after the non-linear amortisation cut-off date                                 232348
     C     VDAT          ANDGE     FSNLAC
      *                                                                                       232348
     C                   ADD       TOTI          TFDP
     C                   ADD       TOTI          TFDPA
     C                   ENDIF
     C/COPY WNCPYSRC,LE0450C024
      *                                                                   CEU004
      ** If feature CEU004 is on, set currency field on LKEY1DP           CEU004
      ** If Settlement currency from the LOAN is not blank.               CEU004
      *                                                                   CEU004
     C     CEU004        IFEQ      'Y'                                          If Feature On  CEU00
      *                                                                   CEU004
     C     SCCYL         IFNE      *BLANKS                                       If SetCcy # BlCEU00
     C                   MOVE      SCCYL         LKSCCY            3              Set Outpt CcyCEU00
     C                   ELSE                                                    Else
     C                   MOVE      *BLANKS       LKSCCY                          Clr Outpt Ccy CEU00
     C                   ENDIF                                                   End If        CEU00
      *                                                                   CEU004
     C                   ENDIF                                                  End If         CEU00
      *                                                                   CEU004
     C     CLE028        IFEQ      'Y'
     C     PTYP          ANDEQ     80
     C     ADCF          ANDEQ     'Y'
     C                   Z-ADD     ACCH          WACCH            13 0
     C                   ELSE
     C                   Z-ADD     *ZERO         WACCH
     C                   ENDIF
      *                                                                   CEU004
     C*                                                                   059878
     C** The old rate is saved for output to reports.                     059878
     C*                                                                   059878
     C                   Z-ADD     INTRL         OINTR                                         05987
      *                                                                   131520
      ** Initialised for DS loan for later comparison.                    131520
      *                                                                   131520
     C                   MOVEL     BRCA          BRCDCL                                        13152
     C**********           Z-ADDCNUML     CNUMCL                                       131520 CSD027
     C                   MOVE      CNUML         CNUMCL
     C**********         Z-ADD     LNRF          LNRFCL                                131520 CLE148
     C                   MOVEL     LNRF          LNRFCL
      *                                                                   CAC001
     C     BGN0ST        IFEQ      'Y'                                                         CAC00
     C     FPRCL         ANDNE     *BLANKS                                                     CAC00
     C                   EXSR      SRFUND                                                      CAC00
     C                   ENDIF                                                                 CAC00
     C/COPY WNCPYSRC,LE0450C023
     C*                                                                   S01117
     C     *INL1         IFEQ      '1'                                                         S0111
     C                   Z-ADD     0             NORPRT                                        S0111
     C                   Z-ADD     0             NORKR                                         S0111
     C                   CLOSE     LE0450P2                                                    S0111
     C                   CLOSE     LE0450P1                                                    S0111
     C                   SETON                                        74                       S0111
     C/COPY WNCPYSRC,LE0450C010
     C**********           SETON                     OVOF          S01117 124017
     C/COPY WNCPYSRC,LE0450C011
     C                   MOVE      'Y'           P1OP              1                           S0111
     C                   OPEN      LE0450P1                                                    S0111
     C                   MOVE      '1'           *INOF                                         12401
     C**                                                                  S01117
     C*    ENSURE REPORT SPOOL FILE RECORDED BY RCF                       S01117
     C**                                                                  S01117
     C******LOCK         IN        LDA                                               CLE164 MD038365
     C                   Z-ADD     SFNUM1        ZSNUM1            6 0                         S0111
     C                   OUT       LDA                                                         S0111
     C**                                                                  S01117
     C                   CALL      'ZSFILE'                                                    S0111
     C                   PARM                    SEQ                                           S0111
     C                   PARM      BRCA          SENTY             3                           S0111
     C                   PARM                    SFILE1                                        S0111
     C                   PARM                    ZSNUM1                                        S0111
     C                   PARM                    ZSERR             1                           S0111
      *                                                                   S01117
     C     *LOCK         IN        LDA                                                         S0111
     C     ZSERR         IFEQ      'Y'                                                         S0111
      **  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM       S01117
     C                   SETON                                        U7U8LR                   S0111
     C                   RETURN                                                                S0111
     C                   END                                                                   S0111
     C**                                                                  S01117
     C                   OPEN      LE0450P2                                                    S0111
     C                   MOVE      '1'           *INOV                                         12401
     C**                                                                  S01117
     C*    ENSURE REPORT SPOOL FILE RECORDED BY RCF                       S01117
     C**                                                                  S01117
     C                   Z-ADD     SFNUM2        ZSNUM2            6 0                         S0111
     C                   OUT       LDA                                                         S0111
     C**                                                                  S01117
     C                   CALL      'ZSFILE'                                                    S0111
     C                   PARM                    SEQ                                           S0111
     C                   PARM      BRCA          SENTY                                         S0111
     C                   PARM                    SFILE2                                        S0111
     C                   PARM                    ZSNUM2                                        S0111
     C                   PARM                    ZSERR             1                           S0111
      *                                                                   S01117
     C     *LOCK         IN        LDA                                                         S0111
     C     ZSERR         IFEQ      'Y'                                                         S0111
      **  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM       S01117
     C                   SETON                                        U7U8LR                   S0111
     C                   RETURN                                                                S0111
     C                   END                                                                   S0111
     C**                                                                  S01117
     C                   Z-ADD     0             PAGE1                                         S0111
     C                   Z-ADD     0             PAGE2                                         S0111
     C/COPY WNCPYSRC,LE0450C012
     C**                                                                  S01117
     C** To get Branch Name(in BRNM) :                                    S01117
     C**                                                                  S01117
     C     MBIN          IFEQ      'Y'                                                         S0111
     C                   MOVEL     BRCA          ##KB
     C                   EXSR      ##CHKB
      * If branch is in the array then use the details                                        CSC042
     C     ##FIC         IFEQ      'Y'                                          *** B10
     C                   EXSR      ##SETB
     C                   ELSE                                                   *** X10
     C**********           CALL 'AOBRCHR0'                                             S01117 CGL029
     C                   CALL      'AOBRCHR1'
     C                   PARM      '*MSG   '     @RTCD             7                           S0111
     C                   PARM      '*KEY   '     @OPTN             7                           S0111
     C                   PARM      BRCA          @DSNB             3                           S0111
     C********** SDBRCH    PARM SDBRCH    DSFDY                                        S01117 CGL029
     C     SDBRCH        PARM      SDBRCH        DSSDY
     C     @RTCD         IFNE      *BLANKS                                                     S0111
     C                   MOVE      *BLANKS       DBKEY                                         S0111
     C                   MOVEL     @DSNB         DBKEY                                         S0111
     C                   MOVEL     'SDBRCHPD'    DBFILE                         ************   S0111
     C                   Z-ADD     10            DBASE                          * DBASE 10 *   S0111
     C                   SETON                                        U7U8LR                   S0111
     C                   GOTO      LONAEN                                                      S0111
     C                   ELSE
      * Details found on the DB so add them to the array                                      CSC042
      * if the array still has room                                                           CSC042
     C                   EXSR      ##ADDB
     C                   END                                                                   S0111
     C                   END                                                    *** E10
     C                   MOVEL     *BLANKS       WBRNM            30                           15775
     C                   MOVEL     BRNM          WBRNM                                         15775
     C                   END                                                                   S0111
     C**                                                                  S01117
     C                   END                                                                   S0111
     C*                                                                   S01408
     C/COPY WNCPYSRC,LE0450CP10                                           S01408
     C*                                                                   S01408
0777 C**
     C***********          SETOF                         82        E86115 S01392
     C                   SETOFF                                           81    82             S0139
0853 C     RECIL         COMP      'M'                                    73
0777 C**
0778 C**   SET UP A/C KEY WITH LOAN TYPE AND SUB-TYPE
0779 C**
0780 C                   MOVEA     LTYP          AKY(1)
0781 C                   MOVEA     SUTP          AKY(4)
0781 C                   MOVEA     CLAS          AKY(11)
     C*                                                                   S01465
     C**  If Guarantees Issued is active, reset the receiver work field   S01465
     C*                                                                   S01465
     C     *IN26         IFEQ      '1'                                                         S0146
     C*                                                                   S01465
     C                   MOVE      *BLANKS       WORECE            6                           S0146
     C                   MOVE      *BLANKS       WWRECE            6                           S0146
     C*                                                                   S01465
     C**  If the processing type of the loan is '70', get the             S01465
     C**  receiver of the guarantee of the loan                           S01465
     C**  Processing type 71 is risk parts purchased for CLE005           CLE005
     C*                                                                   S01465
     C     PTYP          IFEQ      70                                                          S0146
     C     PTYP          OREQ      71                                                          CLE00
     C     CLE005        ANDEQ     'Y'                                                         CLE00
     C                   MOVE      RECE          WWRECE                                        S0146
     C                   END                                                                   S0146
     C*                                                                   S01465
     C**  If the receiver is not blank, save the guarantee receiver       S01465
     C**  into a work field                                               S01465
     C*                                                                   S01465
     C     WWRECE        IFNE      *BLANKS                                                     S0146
     C     WWRECE        ANDNE     *ZEROS                                                      S0146
     C                   MOVE      WWRECE        WORECE                                        S0146
     C                   END                                                                   S0146
     C*                                                                   S01465
     C                   END                                                                   S0146
     C*                                                                   S01260
     C***IF*PARTICIPATION*PURCH.*AND*NO*RECOURSE,*SETON*INDICATOR**       S01260              201123
     C***TO*OUTPUT*ORIGINAL*CUST.*NO.*TO*REPORT**                         S01260              201123
     C*                                                                   S01260
     C**********           SETOF                     34                   S01260              201123
     C********** PTYP      COMP 64                       31               S01260              201123
     C**N31***** PTYP      COMP 65                       31               S01260              201123
      *                                                                   CLE005
      ***Processing*types*68*and*71*are*call*and*risk*parts*purchased,**  CLE005              201123
      ***respectively,*introduced*by*CLE005***                            CLE005              201123
      *                                                                   CLE005
     C********** *IN31     IFEQ '0'                                       CLE005              201123
     C********** CLE005    ANDEQ'Y'                                       CLE005              201123
     C********** PTYP      IFEQ 68                                        CLE005              201123
     C********** PTYP      OREQ 71                                        CLE005              201123
     C**********           MOVE '1'       *IN31                           CLE005              201123
     C**********           ENDIF                                          CLE005              201123
     C**********           ENDIF                                          CLE005              201123
     C***31******RCSI      COMP ' '                      34        S01260 E26745
     C***31***** RCSI      COMP 'Y'                  3434                 E26745              201123
      *                                                                                       201123
      ** Include original borrower                                                            201123
      *                                                                                       201123
     C                   MOVEL     *BLANKS       OLNOZ             6
     C     PTYP          IFEQ      64
     C     PTYP          OREQ      65
     C     PTYP          OREQ      68
     C     PTYP          OREQ      71
     C                   MOVEL     OLNO          OLNOZ
     C                   ENDIF
     C*                                                                   S01260
0782 C**
0783 C**   ZEROISE ACCUMULATIVE AMOUNTS
0784 C**
0785 C                   Z-ADD     0             ORIGPR
0786 C                   Z-ADD     0             YTDPRW
0787 C                   Z-ADD     0             YTDFED
0788 C                   Z-ADD     0             YTDINP
0789 C                   Z-ADD     0             YTDINW
0790 C                   Z-ADD     0             YTDWTW
0791 C                   Z-ADD     0             YTDWTP
0792 C                   Z-ADD     0             AGBAL
0793 C                   Z-ADD     0             IAEND
0794 C                   Z-ADD     0             AIPDT
0795 C                   Z-ADD     0             AIMNS
     C                   MOVE      'N'           WROLD             1            ROLLOVER 63    S0139
     C     CEU020        IFEQ      'Y'                                                         14491
     C                   MOVE      'N'           WMCYR             1                           14491
     C                   ENDIF                                                                 14491
0797 C**   STORE THE CURRENT PRINCIPAL FOR LATER USE                      E16442
0798 C**                                                                  E16442
0799 C                   Z-ADD     CPAM          OCPAM            13 0                         E1644
     C/COPY WNCPYSRC,LE0450C042
0796 C**
0797 C**   GET CURRENCY DETAILS
0798 C**
0799 C                   MOVE      CCYL          XCCY
0800 C                   EXSR      CCYDSP
0801 C     XDECP         COMP      1                                    5556
0802 C     XDECP         COMP      2                                  58  57
0803 C                   Z-ADD     XDECP         DECLON            1 0
0804 C                   Z-ADD     XSPOT         SPTLON           13 8
0805 C**********           Z-ADDXMDIN     MDILON  10                      S01194
0805 C                   MOVEL     XMDIN         MDILON            1                           S0119
     C     *IN99         IFEQ      '1'                                                         S0119
     C                   Z-ADD     7             DBASE                                         S0119
     C                   MOVE      CCYL          DBKEY                          ***************S0119
     C                   SETON                                        U7U8LR    ***  DB 7   ***S0119
     C                   MOVE      'SDCURRPD'    DBFILE                         ***************S0119
0740 C                   GOTO      LONAEN                                                      S0119
     C                   END                                                                   S0119
0806 C***99*****           MOVE '1'       WRK4                            S01194
0807 C***99*****           MOVELCCYL      WRK4                            S01194
0808 C***99*****           MOVE WRK4      XCYKEY                          S01194
0809 C***99*****           Z-ADD7         DBASE            ***************S01194
0810 C***99*****           MOVELXCYKEY    DBKEY            ***  DB  7  ***S01194
0811 C***99*****           MOVE 'TABLE'   DBFILE           ***************S01194
0812 C***99*****           SETON                     U7U8LR               S01194
0813 C***99*****           GOTO LONAEN                                    S01194
0814 C**
0815 C**   CALCULATE CROSS RATE TO LOCAL CCY
0816 C**
0817 C********** MDILOC    COMP 0                        86               S01194
0817 C     MDILOC        COMP      'D'                                    86                   S0119
0818 C********** MDILON    COMP 0                        87               S01194
0818 C     MDILON        COMP      'D'                                    87                   S0119
0819 C***86*****           Z-ADD1         MDILON                          S01194
0820 C**N86*****           Z-ADD0         MDILON                          S01194
0819 C   86              MOVE      'M'           MDILON                                        S0119
0820 C  N86              MOVE      'D'           MDILON                                        S0119
     C   86
0821 CANN87
     CORN86
0822 CAN 87SPTLOC        MULT(H)   SPTLON        SPTLON
     C   86
0823 CAN 87
     CORN86
0824 CANN87SPTLOC        DIV(H)    SPTLON        SPTLON
0825 C**
0826 C                   MOVE      CCYL          ZCCY
0827 C                   Z-ADD     IACD          IACDL             5 0
0828 C                   Z-ADD     SLID          SLIDL             5 0
0829 C**
0830 C**   CHECK WITHOLDING TAX TYPE
0831 C**
0832 C     WTINL         COMP      'G'                                    49
0833 C  N49WTINL         COMP      'R'                                    49
0834 C**
0835 C**   SET INDICATORS FOR STOP ACCRUALS,INT CAP AND SET OFF REV IND
0836 C**
0837 C                   TESTB     '3'           LONI                     48
0838 C     INTC          COMP      'Y'                                    51
0839 C                   SETOFF                                           46
0840 C**
0841 C**   TEST FOR DISC LOAN AND CHECK FOR RECOUSE IND
0842 C**
0843 C     PTYP          LOOKUP    TABDIS                                 45
0844 C***********RCSI      COMP ' '                  5252                 E21291
0844 C     RCSI          COMP      'Y'                                    52                   E2129
      *                                                                   146013
      ** Determine if syndicated                                          146013
      *                                                                   146013
     C     KEYFCL        CHAIN     FCLTYL1                            89                       14601
      *                                                                   151304
      ** Determine Agent on Branch                                        151304
      *                                                                   151304
     C                   MOVEL     FBRCA         ##KB
     C                   EXSR      ##CHKB
      * If branch is in the array then use the details                                        CSC042
     C     ##FIC         IFEQ      'Y'                                          *** B10
     C                   EXSR      ##SETB
     C                   ELSE                                                   *** X10
     C**********           CALL 'AOBRCHR0'                                             151304 CGL029
     C                   CALL      'AOBRCHR1'
     C                   PARM      '*MSG   '     @RTCD                                         15130
     C                   PARM      '*KEY   '     @OPTN                                         15130
     C                   PARM      FBRCA         @DSNB                                         15130
     C     SDBRCH        PARM      SDBRCH        DSSDY                                         15130
     C     @RTCD         IFNE      *BLANKS                                                     15130
     C                   MOVE      *BLANKS       DBKEY                                         15130
     C                   MOVEL     @DSNB         DBKEY                                         15130
     C                   MOVEL     'SDBRCHPD'    DBFILE                         ************   15130
     C                   Z-ADD     17            DBASE                          * DBASE 17 *   15130
     C                   SETON                                        U7U8LR    ************   15130
     C                   GOTO      LONAEN                                                      15130
     C                   ELSE
      * Details found on the DB so add them to the array                                      CSC042
      * if the array still has room                                                           CSC042
     C                   EXSR      ##ADDB
     C                   ENDIF                                                                 15130
     C                   END                                                    *** E10
     C*                                                                   151304
     C                   MOVE      '0'           *IN68                                         14601
     C     SYIN          COMP      'Y'                                    68                   14601
      *                                                                   146013
     C     *IN68         IFEQ      '0'                                                         13514
0845 C   52              MOVE      ' R  '        BKAKY             4
0846 C  N52              MOVE      '    '        BKAKY
     C                   ELSE                                                                  13514
0845 C***52******          MOVE ' T  '    BKAKY                    135147 146013
0845 C**N52******          MOVE ' S  '    BKAKY                    135147 146013
      *                                                                   146013
      ** Set position 8 to 'S' for syndicated                             146013
      ** Unless Agent on Branch is not same as the Agent on the Fclty     151304
      *                                                                   146013
     C     A8SYCU        IFEQ      ANUM                                                        15130
     C   52              MOVE      ' RS '        BKAKY                                         14601
     C  N52              MOVE      '  S '        BKAKY                                         14601
     C                   ELSE                                                                  16479
0845 C   52              MOVE      ' R  '        BKAKY                                         16479
0846 C  N52              MOVE      '    '        BKAKY                                         16479
     C                   ENDIF                                                                 15130
     C                   END                                                                   13514
0847 C**
0848 C**   ACCUMULATE HASH TOTALS AND COUNT OF NO. OF RECORDS
0849 C**
0850 C     NORL          ADD       1             NORL
0851 C**
0852 C     RECIL         COMP      'D'                                    89
0853 C     RECIL         COMP      'M'                                    88
     C  N89
0854 CANN88              GOTO      LONAEN
0855 C**
0856 C     CPAM          DIV       1000          ZZAMT                  89
0857 C   89              Z-SUB     ZZAMT         ZZAMT
0858 C                   Z-ADD     VLBFL         ZZTOTI
0859 C                   Z-ADD     VLBLL         ZZTOTD
0860 C                   EXSR      GLZADD
0861 C                   Z-ADD     ZZTOTI        VLBFL            15 0
0862 C                   Z-ADD     ZZTOTD        VLBLL             3 0
0863 C**
0864 C**   ACCUMULATE AGGREGATE BALANCE FOR LIVE RECORDS ONLY
0865 C**
0866 C**   CHECK IF BACKVALUED LOAN INTO PREVIOUS YEAR, IF SO CHECK IF    E86115
0866 C**   INT TO END OF LAST YEAR CALCULATED, IF NOT DO CALCULATION.     E86115
0866 C**                                                                  E86115
     C     *IN41         IFEQ      '0'                                                         E8611
     C     VDATL         COMP      JAN1                                 82                     E8611
0866 C   82              TESTB     '0'           ACEI                 82                       E8611
     C     *IN82         IFEQ      '1'                                                         E8611
     C                   Z-ADD     IACD          ZIBEG                                         E8611
0879 C                   Z-ADD     JAN1          ZIEND                                         E8611
0880 C***40******ZIEND     SUB  1         ZIEND                    E86115 S01392
     C     ADDI          IFEQ      'L'                                                         S0139
     C     ZIEND         SUB       1             ZIEND                                         S0139
     C                   END                                                                   S0139
0881 C     ZIBEG         COMP      ZIEND                              88                       E8611
0865 C*                                                                   088120
0865 C**   CALCULATE INTEREST IF CURRENT PRINCIPAL > 0                    088120
0865 C*                                                                   088120
0865 C     CPAM          IFGT      0                                                           08812
     C/COPY WNCPYSRC,LE0450C043
0865 C*                                                                   088120
0882 C                   Z-ADD     ICBS          ZICALC                                        E8611
0883 C                   Z-ADD     INTRL         ZIRATE                                        E8611
0884 C                   Z-ADD     CPAM          ZIAMT                                         E8611
     C*                                                                   S01408
     C/COPY WNCPYSRC,LE0450CCP2                                           S01408
     C*                                                                   S01408
     C     CLE028        IFEQ      'Y'
     C     PTYP          ANDEQ     80
     C                   EXSR      SRPCAL
     C                   ELSE
     C/COPY WNCPYSRC,LEH01314
0887 C                   EXSR      GLINTC                                                      E8611
     C                   ENDIF
0906 C***********          Z-ADDZINTR     WRK13     H               E86115S01392
     C*                                                                   S01408
     C/COPY WNCPYSRC,LE0450CCP3                                           S01408
     C*                                                                   S01408
     C*                                                                   S01392
     C**  ROUND DOWN IF REQUIRED                                          S01392
     C*                                                                   S01392
     C     RDFC          IFEQ      'Y'                                                         S0139
     C                   Z-ADD     ZINTR         WRK13                                         S0139
     C                   ELSE                                                                  S0139
     C                   Z-ADD(H)  ZINTR         WRK13                                         S0139
     C                   END                                                                   S0139
0865 C*                                                                   088120
0865 C                   ELSE                                                                  08812
0865 C*                                                                   088120
0865 C*  IF PRINCIPAL NOT GREATER THAN 0, INTEREST IS 0                   088120
0889 C                   Z-ADD     0             WRK13                                         08812
0865 C                   END                                                                   08812
0865 C*                                                                   088120
0865 C*  IF END OF PERIOD IS BEFORE START OF PERIOD, INTEREST IS 0        088120
     C   88              Z-ADD     0             WRK13                                         E8611
     C     WRK13         ADD       AITC          IAEND                                         E8611
     C     IAEND         ADD       AIAP          IAEND                                         E8611
     C                   END                                                                   E8611
     C                   END                                                                   E8611
0886 C**                                                                  E86115
0866 C                   TESTB     '1'           ACEI                     89
0867 C   88
0868 CORN89              GOTO      LONAEN
0869 C**
     C   89
0870 CAN 41VDATL         SUB       JAN1          WRK05             5 088
0871 C   88ADAYS         SUB       WRK05         DAY1
     C   89
0872 CANN88              Z-ADD     ADAYS         DAY1
0873 C   89CPAM          MULT      DAY1          AGBAL            13 0
0874 C**
0875 C**   IF FIRST WORKING DAY OF YEAR CALCULATE INTEREST
0876 C**   ACCRUED TO END OF PREVIOUS YEAR
0877 C**
0878 C                   Z-ADD     IACD          ZIBEG
0879 C                   Z-ADD     JAN1          ZIEND
0880 C***40******ZIEND     SUB  1         ZIEND                           S01392
     C*                                                                   S01392
     C**  CHECK ADDI AND AMEND ZIEND WHEN NECESSARY.                      S01392
     C*                                                                   S01392
     C     ADDI          IFEQ      'L'                                                         S0139
     C     ZIEND         SUB       1             ZIEND                                         S0139
     C                   END                                                                   S0139
     C********** ADDI      IFEQ 'B'                                                    S01392 245082
     C********** ZIBEG     ANDGTVDATL                                                  S01392 245082
     C********** ZIEND     SUB  1         ZIEND                                        S01392 245082
     C**********           END                                                         S01392 245082
0881 C     ZIBEG         COMP      ZIEND                              88
0865 C*                                                                   088120
0885 C  N41              GOTO      DAILY                                                       08812
0865 C*                                                                   088120
0865 C**   CALCULATE INTEREST IF CURRENT PRINCIPAL > 0                    088120
0865 C*                                                                   088120
0865 C     CPAM          IFGT      0                                                           08812
     C/COPY WNCPYSRC,LE0450C044
0865 C*                                                                   088120
0882 C                   Z-ADD     ICBS          ZICALC
0883 C                   Z-ADD     INTRL         ZIRATE
0884 C                   Z-ADD     CPAM          ZIAMT
0885 C**N41******          GOTO DAILY                                     088120
     C*                                                                   S01408
     C/COPY WNCPYSRC,LE0450CCP4                                           S01408
     C*                                                                   S01408
0886 C**
     C     CLE028        IFEQ      'Y'
     C     PTYP          ANDEQ     80
     C                   EXSR      SRPCAL
     C                   ELSE
     C/COPY WNCPYSRC,LEH01315
0887 C                   EXSR      GLINTC
     C                   ENDIF
0888 C***********          Z-ADDZINTR     WRK13  130H                     S01392
     C*                                                                   S01408
     C/COPY WNCPYSRC,LE0450CCP5                                           S01408
     C*                                                                   S01408
     C*                                                                   S01392
     C**  ROUND DOWN IF REQUIRED                                          S01392
     C*                                                                   S01392
     C     RDFC          IFEQ      'Y'                                                         S0139
     C                   Z-ADD     ZINTR         WRK13                                         S0139
     C                   ELSE                                                                  S0139
     C                   Z-ADD(H)  ZINTR         WRK13            13 0                         S0139
     C                   END                                                                   S0139
0865 C*                                                                   088120
0865 C                   ELSE                                                                  08812
0865 C*                                                                   088120
0865 C*  IF PRINCIPAL NOT GREATER THAN 0, INTEREST IS 0                   088120
0889 C                   Z-ADD     0             WRK13                                         08812
0865 C                   END                                                                   08812
0865 C*                                                                   088120
0865 C*  IF END OF PERIOD IS BEFORE START OF PERIOD, INTEREST IS 0        088120
0889 C   88              Z-ADD     0             WRK13
0865 C*                                                                   088120
0890 C     WRK13         ADD       AITC          IAEND            13 0
0891 C     IAEND         ADD       AIAP          IAEND
0892 C**
0893 C*****IF*DAILY*ACCRUALS*AND*ACCRUAL*DAY*CALCULATE*ACCRUED***         088120
0893 C**   IF DAILY ACCRUALS -OR- ACCRUAL DAY, CALCULATE ACCRUED          088120
0894 C**   INTEREST POSTED TO DATE WITH NO BACK VALUATIONS
0895 C**
0896 C     DAILY         TAG                                                    ** DAILY TAG **
0897 C**
0898 C     APFQ          COMP      'D'                                    89
0899 C  N89
0900 CORN44              GOTO      LONAEN
0901 C**
0902 C                   Z-ADD     EVCD          ZIEND
     C     EVCD          IFGT      MDAT                                                        04664
     C     MDAT          ANDNE     0                                                           04664
     C                   Z-ADD     MDAT          ZIEND                                         04664
     C                   END                                                                   04664
0903 C**N40******ZIEND     ADD  1         ZIEND                           S01392
     C     ADDI          IFEQ      'F'                                          FIRST DAY ACCR S0139
     C     MDAT          IFEQ      0                                            NOT MATURED CR 04664
     C     MDAT          ORGT      ZIEND                                        NOT MATURED CR 04664
     C     ZIEND         ADD       1             ZIEND                                         S0139
     C                   END                                                                   S0139
     C                   END                                                                   04664
     C     ADDI          IFEQ      'B'                                          FIRST & LAST   S0139
     C********** ZIBEG     ANDEQVDATL                                                  S01392 245082
     C     ZIEND         ADD       1             ZIEND                                         S0139
     C                   END                                                                   S0139
0904 C     ZIBEG         COMP      ZIEND                              88
0865 C*                                                                   088120
0865 C**   CALCULATE INTEREST IF CURRENT PRINCIPAL > 0                    088120
0865 C*                                                                   088120
0865 C     CPAM          IFGT      0                                                           08812
0865 C*                                                                   088120
     C*                                                                   S01408
     C/COPY WNCPYSRC,LE0450CCP6                                           S01408
     C*                                                                   S01408
     C     CLE028        IFEQ      'Y'
     C     PTYP          ANDEQ     80
     C                   EXSR      SRPCAL
     C                   ELSE
     C/COPY WNCPYSRC,LEH01339
0905 C                   EXSR      GLINTC
     C                   ENDIF
0906 C***********          Z-ADDZINTR     WRK13     H                     S01392
     C*                                                                   S01408
     C/COPY WNCPYSRC,LE0450CCP7                                           S01408
     C*                                                                   S01408
     C*                                                                   S01392
     C**  ROUND DOWN IF REQUIRED                                          S01392
     C*                                                                   S01392
     C     RDFC          IFEQ      'Y'                                                         S0139
     C                   Z-ADD     ZINTR         WRK13                                         S0139
     C                   ELSE                                                                  S0139
     C                   Z-ADD(H)  ZINTR         WRK13                                         S0139
     C                   END                                                                   S0139
0865 C*                                                                   088120
0865 C                   ELSE                                                                  08812
0865 C*                                                                   088120
0865 C*  IF PRINCIPAL NOT GREATER THAN 0, INTEREST IS 0                   088120
0889 C                   Z-ADD     0             WRK13                                         08812
0865 C                   END                                                                   08812
0865 C*                                                                   088120
0865 C*  IF END OF PERIOD IS BEFORE START OF PERIOD OR STOP ACCRUALS      088120
0865 C*  INDICATOR IS ON, AMOUNT ACCRUED IS 0                             088120
0907 C   88              Z-ADD     0             WRK13
0908 C   48              Z-ADD     0             WRK13
0865 C*                                                                   088120
0909 C     WRK13         ADD       AITC          AIPDT            13 0
0910 C     AIPDT         ADD       AIAP          AIPDT
0911 C     AIPDT         ADD       AIMN          AIPDT
0912 C                   Z-ADD     AIMN          AIMNS            13 0
0913 C**
0914 C********** LONAEN    ENDSR                           ***  LONAEN ***BHF659
0914 C     LONAEN        TAG                                                    ***  LONAEN ***BHF65
     C/COPY WNCPYSRC,LE0450CP17                                           S01408
     C   U7              SETON                                        09                       BHF65
0914 C                   ENDSR                                                              ***BHF65
0915 C**
0916 C**
0917 C********************************************************************
0918 C********************************************************************
0919 C**
0920 C**   SUBROUTINE TO PROCESS ACTION CONTROL RECORD - ACTCO
0921 C**
0922 C**   CALLED FROM MAIN PROCESSING
0923 C**   CALLS NO OTHER SUBROUTINES
0924 C**
0925 C     ACTCO         BEGSR                                                  ***  ACTCO  ***
0926 C**
0927 C**   ACCUMULATE NUMBER OF RECORDS READ
0928 C**
0929 C     NORA          ADD       1             NORA
0930 C**
0931 C     LNMA          COMP      'Y'                                    47
      *                                                                                       CLE134
      ** Check if the loan is linked to a live Original loan or a live                        CLE134
      ** PDCL, if it is then the loan cannot mature                                           CLE134
      *                                                                                       CLE134
     C                   MOVE      *BLANKS       DSPDST                                       CLE134
      *                                                                                       263411
     C     CLE134        IFEQ      'Y'                                                        263411
     C                   MOVE      *OFF          *IN27                                        263411
     C                   MOVE      *OFF          *IN24                                        263411
     C                   MOVEL     LTYP          LTYP1A            1                          263411
      *                                                                                       263411
     C     LTYP1A        IFEQ      'X'                                                        263411
     C     LTYP1A        OREQ      'Y'                                                        263411
     C     LTYP1A        OREQ      'Z'                                                        263411
     C                   MOVE      'Y'           WPDCLL                                       263411
      *                                                                                       263411
     C                   ELSE                                                                 263411
     C                   MOVE      'Y'           WORIGL                                       263411
     C                   ENDIF                                                                263411
      *                                                                                       CLE134
      ** If loan processed is an original loan                                                CLE134
      *                                                                                       263411
     C     WORIGL        IFEQ      'Y'                                                        263411
     C     LNRF          SETLL     LEPDUEL2                                                   263411
      *                                                                                       263411
     C     *IN27         DOWEQ     *OFF                                                       263411
      *                                                                                       CLE134
     C     LNRF          READE     LEPDUEL2                               27                  CLE134
      *                                                                                       CLE134
     C     *IN27         IFEQ      *OFF                                                       CLE134
     C     YPLON         CHAIN     LELOANLZ                           24                      CLE134
     C     *IN24         IFEQ      *OFF                                                       CLE134
     C     XCPAM         ANDNE     *ZERO                                                      CLE134
     C**********         MOVE *OFF *IN47                                               CLE134 263411
     C                   MOVEL     '*LIVE'       DSPDST                                       263411
     C                   ENDIF                                                                263411
      *                                                                                       CLE134
     C                   ENDIF                                                                CLE134
      *                                                                                       CLE134
     C                   ENDDO                                                                CLE134
     C                   ENDIF                                                                CLE134
      *                                                                                       CLE134
      ** If loan processed is a PDCL                                                          CLE134
      *                                                                                       263411
     C     WPDCLL        IFEQ      'Y'                                                        263411
      *                                                                                       CLE134
      ** PDCL generated by a loan                                                             CLE134
      *                                                                                       CLE134
     C     LTYP1A        IFEQ      'X'                                                        CLE134
     C     LTYP1A        OREQ      'Y'                                                        CLE134
     C     LNRF          SETLL     LEPDUEL1                                                   CLE134
     C     *IN27         DOWEQ     *OFF                                                       CLE134
      *                                                                                       CLE134
     C     LNRF          READE     LEPDUEL1                               27                  CLE134
      *                                                                                       263411
     C     *IN27         IFEQ      *OFF                                                       263411
     C     YPORG         CHAIN     LELOANLZ                           24                      263411
      *                                                                                       263411
     C     *IN24         IFEQ      *OFF                                                       263411
     C     XCPAM         ANDNE     *ZERO                                                      263411
     C**********           MOVE *OFF      *IN47                                        CLE134 263411
     C                   MOVEL     '*LIVE'       DSPDST                                       263411
     C                   ENDIF                                                                263411
     C                   ENDIF                                                                263411
     C                   ENDDO                                                                263411
      *                                                                                       CLE134
     C                   ENDIF                                                                CLE134
      *                                                                                       CLE134
      ** PDCL generated by a fee                                                              CLE134
      *                                                                                       CLE134
     C     LTYP1A        IFEQ      'Z'                                                        CLE134
     C     LNRF          SETLL     LEPDUFL1                                                   CLE134
     C     *IN27         DOWEQ     *OFF                                                       CLE134
      *                                                                                       CLE134
     C     LNRF          READE     LEPDUFL1                               27                  CLE134
      *                                                                                       263411
     C     *IN27         IFEQ      *OFF                                                       263411
     C**********           MOVE *OFF      *IN47                                        CLE134 263411
     C                   MOVE      YBRCA         @FBRCH                                       263411
     C                   MOVE      YECNUM        @FCNUM                                       263411
     C                   MOVE      YEFACL        @FFACL                                       263411
     C                   MOVE      YPORG         @FLOAN                                       263411
     C                   MOVE      YESEQ         @FFSEQ                                       263411
     C     KEYFEE        CHAIN     LEFEED                             24                      263411
      *                                                                                       263411
     C     *IN24         IFEQ      *OFF                                                       263411
     C     FERECI        ANDEQ     'D'                                                        263411
     C     FEPEND        ANDGT     RDNB                                                       263411
     C**********           MOVE *OFF      *IN47                                        CLE134 263411
     C                   MOVEL     '*LIVE'       DSPDST                                       263411
     C                   ENDIF                                                                263411
     C                   ENDIF                                                                263411
     C                   ENDDO                                                                263411
      *                                                                                       CLE134
     C                   ENDIF                                                                CLE134
      *                                                                                       CLE134
     C                   ENDIF                                                                CLE134
     C                   ENDIF                                                                CLE134
      *                                                                                       CLE134
     C********** CLE134    IFNE 'Y'                                                    262508 263411
     C********** CLE134    OREQ 'Y'                                                    262508 263411
     C********** WORIGL    ANDNE'Y'                                                    262508 263411
     C********** CLE134    OREQ 'Y'                                                    262508 263411
     C********** WORIGL    ANDEQ'Y'                                                    262508 263411
     C********** NEWCOB    ANDEQ'Y'                                                    262508 263411
     C********** CLE134    OREQ 'Y'                                                    262508 263411
     C********** WORIGL    ANDEQ'Y'                                                    262508 263411
     C********** NEWCOB    ANDNE'Y'                                                    262508 263411
     C********** LCD       ANDLTRDNB                                                   262508 263411
0932 C   47              MOVE      'M'           RECIL
     C**********           ENDIF                                                       262508 263411
0933 C**
0934 C**   CALCULATE ACTUAL INTEREST ACCRUED TO CONTROL DATE
0935 C**
0936 C     AITC          SUB       AIAP          AITC
0937 C     AITC          SUB       AIMN          AITC
      *                                                                   CAC001
      **  Calculate Accrued Interest Adjustment Posted                    CAC001
      *                                                                   CAC001
     C     BGN0ST        IFEQ      'Y'                                                         CAC00
     C     FPRCL         ANDNE     *BLANKS                                                     CAC00
     C                   SUB       ACAP          ACDA                                          CAC00
     C                   SUB       ACAJ          ACDA                                          CAC00
     C     NFCD          IFNE      0                                                           CAC00
     C                   Z-ADD     NFCD          FCTD                                          CAC00
     C                   ENDIF                                                                 CAC00
     C                   ENDIF                                                                 CAC00
      *                                                                                       CAS005
     C     CAS005        IFEQ      'Y'
     C     AITN          SUB       AIAN          AITN
     C     AITN          SUB       AINN          AITN
     C                   ENDIF
0938 C**
0939 C**   UPDATE INTEREST ACCRUAL CONTROL DATE
0940 C**
      **Save*the*current*iacd*as*it*may*be*reset*when*processing*MI.117334121147
     C************LIKE     DEFN IACD      IACDMI                    117334121147
     C***********          Z-ADDIACD      IACDMI                    117334121147
0941 C                   MOVE      NIAD          IACD
     C/COPY WNCPYSRC,LE0450C045
0942 C**
0943 C                   ENDSR
0944 C**
0945 C**
0946 C********************************************************************
0947 C********************************************************************
0948 C**
0949 C**   SUBROUTINE TO PROCESS ACTION FILE DETAIL RECORDS - ACTNS
0950 C**
0951 C**   CALLED FROM MAIN PROCESSING
0952 C**   CALLS REVERS,DLDATE,STDATE,MANINT,STOPAC,PRININ,MANREP,
0953 C**   INTPAY,PASTDU,REPSCD,SPCHNG,BRCHNG,BCCHNG,ROLLOV,MATRTY
0954 C**
0955 C     ACTNS         BEGSR                                                  ***  ACTNS  ***
     C/COPY WNCPYSRC,LE0450CP18                                           S01408
      *                                                                                       CGL020
     C     CGL020        IFEQ      'Y'
     C                   MOVEL     STLNS2        STLNS1
     C                   EXSR      SRAMPR
     C                   ENDIF
0956 C**
0957 C**   ACCUMULATE NUMBER OF RECORDS READ
0958 C**
     C                   MOVE      *BLANKS       WORIGL            1                          CLE134
     C                   MOVE      *BLANKS       WORIGA            1                          CLE134
     C                   MOVE      *BLANKS       WMRAUT            1                          263416
     C                   MOVE      *BLANKS       WPDCLL            1                          CLE134
     C                   MOVE      *BLANKS       WPDCLA            1                          CLE134
     C                   MOVE      *BLANKS       WPDCLR            1                          CLE134
     C                   EVAL      WCLE134 = ' '                                            MD049078
      *                                                                                       CLE134
     C                   MOVE      '0'           *IN15                                         18004
0959 C     NORA          ADD       1             NORA
     C/COPY WNCPYSRC,LE0450C025
      *                                                                                       CLE034
     C     CLE034        IFEQ      'Y'
     C     AMTP          IFEQ      'ST'
     C     AMTP          OREQ      'DD'
     C     AMTP          OREQ      'IN'
     C     AMTP          OREQ      'MA'
     C                   MOVE      'Y'           WLONR             1
     C                   ELSE
     C                   MOVE      *BLANK        WLONR
     C                   ENDIF
     C                   ENDIF
0960 C**
0961 C**   DETERMINE TYPE OF ACTION RECORD
0962 C**
0963 C     AMTP          COMP      'RV'                                   86    REVERSAL
0964 C   86              EXSR      REVERS
0965 C   86              GOTO      ACTEN
0966 C**
0967 C     AMTP          COMP      'DD'                                   86    DEAL DATE
0968 C   86              EXSR      DLDATE
0969 C   86              GOTO      ACTEN
0970 C**
0971 C     AMTP          COMP      'ST'                                   86    START DATE
0972 C   86              EXSR      STDATE
0973 C   86              GOTO      ACTEN
0974 C**
0975 C     AMTP          COMP      'MI'                                   86    MAN.INT.ADJ
0976 C   86              EXSR      MANINT
0977 C   86              GOTO      ACTEN
0978 C**
0979 C     AMTP          COMP      'SA'                                   86    STOP ACCRUALS
0980 C   86              EXSR      STOPAC
0981 C   86              GOTO      ACTEN
0982 C**
0983 C     AMTP          COMP      'PI'                                   86    PRIN.INCREASE
0984 C   86              EXSR      PRININ
0985 C   86              GOTO      ACTEN
0986 C**
0987 C     AMTP          COMP      'MR'                                   86    MAN.REPAYMENT
0988 C   86              EXSR      MANREP
0989 C   86              GOTO      ACTEN
      *                                                                   180044
      ** If record ID is 'R' and amendment type is 'PD', set on *IN15     180044
      *                                                                   180044
     C     *IN86         IFEQ      '0'                                                         18004
     C     AMTP          ANDEQ     'PD'                                                        18004
     C     RECI          ANDEQ     'R'                                                         18004
     C                   MOVE      '1'           *IN15                                         18004
     C     NORA          SUB       1             NORA                                          18004
     C                   Z-ADD     VDAT          ACDATE                                        18004
     C                   EXSR      MANREP                                                      18004
     C                   GOTO      ACTEN                                                       18004
     C                   ENDIF                                                                 18004
0990 C**
0991 C     AMTP          COMP      'IN'                                   86    INT.PAYMENT
     C     CLE028        IFEQ      'Y'
     C     PTYP          ANDEQ     80
     C     *IN86         ANDEQ     *ON
     C                   EXSR      SRINTA
     C                   ELSE
0992 C   86              EXSR      INTPAY
     C                   ENDIF
0993 C   86              GOTO      ACTEN
0994 C**
0995 C     AMTP          COMP      'PD'                                   86    PAST DUE
0996 C   86              EXSR      PASTDU
0997 C   86              GOTO      ACTEN
0998 C**
0999 C     AMTP          COMP      'RE'                                   86    REP.SCHEDULE
1000 C   86              EXSR      REPSCD
1001 C   86              GOTO      ACTEN
1002 C**
1003 C     AMTP          COMP      'SC'                                   86    SPREAD CHANGE
1004 C   86              EXSR      SPCHNG
1005 C   86              GOTO      ACTEN
1006 C**
1007 C     AMTP          COMP      'BR'                                   86    BASE RT.CHANGE
1008 C   86              EXSR      BRCHNG
1009 C   86              GOTO      ACTEN
1010 C**
1011 C     AMTP          COMP      'BC'                                   86    BASE CODE CHNGE
1012 C   86              EXSR      BCCHNG
1013 C   86              GOTO      ACTEN
1014 C**
1015 C     AMTP          COMP      'RO'                                   86    ROLLOVER
1016 C   86              EXSR      ROLLOV
1017 C   86              GOTO      ACTEN
1018 C**
1019 C     AMTP          COMP      'MA'                                   86    MATURITY
1020 C   86              EXSR      MATRTY
1021 C   86              GOTO      ACTEN
1018 C**                                                                  S01270
     C     AMTP          IFEQ      'LS'                                         *LOAN SUB-TYPE S0127
     C                   EXSR      LOANSR                                                      S0127
1021 C                   GOTO      ACTEN                                                       S0127
     C                   END                                                                   S0127
      *                                                                   CLE004
     C     CLE004        IFEQ      'Y'                                                         CLE00
     C     AMTP          IFEQ      'PT'                                                        CLE00
     C                   EXSR      PRINTO                                                      CLE00
     C                   GOTO      ACTEN                                                       CLE00
     C                   ENDIF                                                                 CLE00
      *                                                                   CLE004
     C     AMTP          IFEQ      'PF'                                                        CLE00
     C                   EXSR      PRINFR                                                      CLE00
     C                   GOTO      ACTEN                                                       CLE00
     C                   ENDIF                                                                 CLE00
      *                                                                   CLE004
     C     AMTP          IFEQ      'MC'                                                        CLE00
     C     CLE006        ANDEQ     'Y'                                                         CLE00
     C     CEU020        OREQ      'Y'                                                         CEU02
     C     AMTP          ANDEQ     'MC'                                                        CEU02
     C     CLE007        OREQ      'Y'                                                         CLE01
     C     AMTP          ANDEQ     'MC'                                                        CLE01
     C                   EXSR      MROLL                                                       CLE00
     C                   GOTO      ACTEN                                                       CLE00
     C                   ENDIF                                                                 CLE00
     C                   ENDIF                                                                 CLE00
      *                                                                   CEU020
     C     CLE004        IFEQ      'N'                                                         CEU02
     C     CEU020        IFEQ      'Y'                                                         CEU02
     C     ECIN          ANDEQ     'Y'                                                         CEU02
     C     AMTP          ANDEQ     'MC'                                                        CEU02
     C                   EXSR      MROLL                                                       CEU02
     C                   GOTO      ACTEN                                                       CEU02
     C                   ENDIF                                                                 CEU02
     C                   ENDIF                                                                 CEU02
      *                                                                                       CLE028
      ** Charge payment                                                                       CLE028
      *                                                                                       CLE028
     C     CLE028        IFEQ      'Y'
     C     PTYP          ANDEQ     80
     C     AMTP          ANDEQ     'CH'
     C                   EXSR      SRCHGP
     C                   GOTO      ACTEN
     C                   ENDIF
     C*                                                                   S01408
     C/COPY WNCPYSRC,LE0450CP11                                           S01408
     C*                                                                   S01408
     C*                                                                   S01270
1022 C**
1023 C**   DATABASE ERROR IF NOT ACTIONED ABOVE
1024 C**
1025 C                   Z-ADD     9             DBASE                          ***************
1026 C                   MOVE      'ACTN6'       DBFILE                         ***  DB  9  ***
1027 C                   MOVEL     'INVALID'     WRK22            22            ***************
1028 C                   MOVEL     'ACTION'      WRK14            14
1029 C                   MOVEL     'TYPE'        WRK7              7
1030 C                   MOVE      AMTP          WRK7
1031 C                   MOVE      WRK7          WRK14
1032 C                   MOVE      WRK14         WRK22
1033 C                   MOVEL     WRK22         DBKEY
1034 C                   SETON                                        U7U8LR
1034 C                   SETON                                        09                       BHF65
1035 C**
     C/COPY WNCPYSRC,LE0450C026
1036 C**
1037 C     ACTEN         ENDSR                                                  ***  ACTEN  ***
1038 C**
1039 C**
1040 C********************************************************************
1041 C********************************************************************
1042 C**
1043 C**   SUBROUTINE TO PROCESS REVERSAL ACTION RECORDS - REVERS
1044 C**
1045 C**   CALLED FROM ACTNS
1046 C**   CALLS NO OTHER SUBROUTINES
1047 C**
1048 C     REVERS        BEGSR                                                  **** REVERS ***
1049 C**
1050 C     RECIL         COMP      'R'                                    89
1051 C  N89              SETON                                        U7U8LR
1052 C  N89              MOVEL     '      A '    DBKEY                          ***************
1053 C  N89              MOVEL     LNRF          DBKEY                          ***  DB  8  ***
1054 C  N89              Z-ADD     8             DBASE                          ***************
1055 C  N89              MOVE      'LOUPD'       DBFILE
1057 C  N89              SETON                                        09                       BHF65
     C*                                                                   S01408
     C/COPY WNCPYSRC,LE0450CP12                                           S01408
     C*                                                                   S01408
1056 C**
1057 C                   SETON                                        46
1058 C**
1059 C                   ENDSR
1060 C**
1061 C**
1062 C********************************************************************
1063 C********************************************************************
1064 C**
1065 C**   SUBROUTINE TO PROCESS DEAL DATE ACTION RECORDS - DLDATE
1066 C**
1067 C**   CALLED FROM ACTNS
1068 C*    CALLS AKYOUT(3)
1069 C**
1070 C     DLDATE        BEGSR                                                  ***  DLDATE ***
1071 C**
1072 C**   SET ON DEAL DATE BIT ON LOANS 'A' RECORD
1073 C**
1074 C                   BITON     '0'           ACEI
1075 C**
1076 C**   GENERATE A/C KEY FOR DEAL DATE AND TEST FOR DISC LOAN
1077 C**
1078 C                   Z-ADD     VDAT          ACDATE            5 0
1079 C                   Z-ADD     CPAM          ACAMNT           13 0    89
1080 C                   MOVE      'D'           AKY(3)
1081 C                   MOVEA     BKAKY         AKY(6)
1082 C                   MOVE      'A'           AKY(10)
1083 C  N89              EXSR      AKYOUT
     C*                                                                   S01465
     C**  Account key generated with 'R' in AKY (in position 8) if        S01465
     C**  the receiver of guarantee is different to blanks                S01465
     C*                                                                   S01465
     C     *IN26         IFEQ      '1'                                                         S0146
     C     WORECE        IFNE      *BLANKS                                                     S0146
     C**********           Z-ADDCNUML     WORK2   60                                   S01465 CSD027
     C                   MOVE      CNUML         WORK2             6
     C                   MOVE      WORECE        CNUML                                         S0146
     C                   MOVE      'R'           AKY(8)                                        S0146
     C  N89              EXSR      AKYOUT                                                      S0146
     C**********           Z-ADDWORK2     CNUML                                        S01465 CSD027
     C                   MOVE      WORK2         CNUML
     C                   MOVE      ' '           AKY(8)                                        S0146
     C                   END                                                                   S0146
     C                   END                                                                   S0146
     C/COPY WNCPYSRC,LE0450C046
1084 C**
1085 C  N45              GOTO      DLEND
1086 C**
1087 C                   Z-ADD     TOTI          ACAMNT                 8889
1088 C   88              MOVE      'P'           AKY(10)
1089 C   88              Z-SUB     ACAMNT        ACAMNT
1090 C  N88              MOVE      'D'           AKY(10)
1091 C  N89              EXSR      AKYOUT
1092 C**
1093 C     CPAM          SUB       TOTI          ACAMNT                   89
1094 C                   MOVE      'B'           AKY(10)
1095 C  N89              EXSR      AKYOUT
1096 C**
1097 C     DLEND         ENDSR                                                  ***  DLEND  ***
1098 C**
1099 C**
1100 C********************************************************************
      *                                                                                       CLE028
      *****************************************************************                       CLE028
      *                                                               *                       CLE028
      *  SRCHGP - Subroutine to generate charge account key           *                       CLE028
      *                                                               *                       CLE028
      *  Called by: ACTNS subroutine                                  *                       CLE028
      *                                                               *                       CLE028
      *  Calls: None                                                  *                       CLE028
      *                                                               *                       CLE028
      *****************************************************************                       CLE028
     C     SRCHGP        BEGSR
      *                                                                                       CLE028
      ** Produce charge account key if add on charge set to 'Y'                               CLE028
      *                                                                                       CLE028
     C                   Z-ADD     VDAT          ACDATE
     C                   MOVEA     BKAKY         AKY(6)
     C                   MOVEA     'V'           AKY(3)
     C                   MOVEA     'H'           AKY(10)
     C                   Z-ADD     CHDU          ACAMNT                   89
     C     *IN89         IFEQ      *OFF
     C                   EXSR      AKYOUT
     C                   ENDIF
      *                                                                                       CLE028
      ** Update current principal amount with charge amount                                   CLE028
      *                                                                                       CLE028
     C                   Z-ADD     CHDU          AMOUNT
     C                   EXSR      CPAMUP
     C     ACRBAL        ADD       AMOUNT        ACRBAL
      *                                                                                       CLE028
     C                   ENDSR
      *****************************************************************                       CLE028
      *                                                                                       CLE028
      *****************************************************************                       CLE028
      *                                                               *                       CLE028
      *  SRINTA - Subroutine to generate interest capitalised account *                       CLE028
      *           key for add on interest                             *                       CLE028
      *                                                               *                       CLE028
      *  Called by: ACTN subroutine                                   *                       CLE028
      *                                                               *                       CLE028
      *  Calls: None                                                  *                       CLE028
      *                                                               *                       CLE028
      *****************************************************************                       CLE028
     C     SRINTA        BEGSR
      *                                                                                       CLE028
      ** Produce add on interest account key                                                  CLE028
      *                                                                                       CLE028
     C                   Z-ADD     VDAT          ACDATE
     C                   MOVEA     BKAKY         AKY(6)
     C                   MOVEA     'V'           AKY(3)
     C                   MOVEA     'C'           AKY(10)
     C                   Z-ADD     INTA          ACAMNT                   89
     C     *IN89         IFEQ      *OFF
     C                   EXSR      AKYOUT
     C                   ENDIF
      *                                                                                       CLE028
      ** Update current principal amount with total flat interest amount                      CLE028
      *                                                                                       CLE028
     C                   Z-ADD     INTA          AMOUNT
     C                   EXSR      CPAMUP
     C     ACRBAL        ADD       AMOUNT        ACRBAL
      *                                                                                       CLE028
     C                   ENDSR
      *                                                                                       CLE028
1101 C********************************************************************
1102 C**
1103 C**   SUBROUTINE TO PROCESS START DATE ACTION RECORDS - STDATE
1104 C**
1105 C**   CALLED FROM ACTNS
1106 C*****CALLS AKYOUT(3)                                                                    CLE031
1106 C**   CALLS AKYOUT(3),SETCCY,SETTLE,SECCY2,SETRST                                        CLE031
1107 C**
1108 C     STDATE        BEGSR                                                  ***  STDATE ***
1109 C**
1110 C**   SET ON START DATE BIT ON LOANS 'A' RECORD
1111 C**
      *                                                                                       CLE134
      ** CLE134 - Past Due Call Loans process                                                 CLE134
      *                                                                                       262597
      ** IF Settlement type is 14 and OSAC is not blanks,                                     262597
      ** then retrieve settlement branch from settlement a/c                                  262597
      *                                                                                       262597
     C     SETP          IFEQ      14                                                         262597
     C     OSAC          ANDNE     *BLANKS                                                    262597
     C                   MOVEL     OSAC          KACNO            10 0                        262597
     C     KACNO         CHAIN     ACCNTL1                            24                      262597
     C     *IN24         IFEQ      *OFF                                                       262597
     C                   MOVE      ZBRCA         OSBR                                         262597
     C                   ENDIF                                                                262597
     C                   ENDIF                                                                262597
      *                                                                                       CLE134
     C                   MOVE      'N'           WPDCLL                                       CLE134
     C                   MOVE      'N'           WPDCLA                                       CLE134
     C                   MOVE      'N'           WPDCLR                                       CLE134
     C                   MOVE      'N'           WORIGL                                       CLE134
     C                   MOVE      'N'           WORIGA                                       CLE134
     C                   MOVE      'N'           WMRAUT                                       263416
      *                                                                                       CLE134
      ** If AUTO = 'C', check whether the processed loan is a PDCL or                         CLE134
      ** an original loan by checking the 1st character of the loan                           CLE134
      ** type. If it is X, Y, Z then the loan is a Past Due Call Loan.                        CLE134
      *                                                                                       CLE134
     C     CLE134        IFEQ      'Y'                                                        CLE134
     C     AUTO          ANDEQ     'C'                                                        CLE134
     C     CLE134        OREQ      'Y'                                                        CLE134
     C     AUTOX         ANDEQ     'C'                                                        CLE134
     C                   MOVEL     LTYP          LTYP1A            1                          CLE134
     C                   EVAL      WCLE134 = 'Y'                                            MD049078
     C     LTYP1A        IFEQ      'X'                                                        CLE134
     C     LTYP1A        OREQ      'Y'                                                        CLE134
     C     LTYP1A        OREQ      'Z'                                                        CLE134
     C                   MOVE      'Y'           WPDCLL                                       CLE134
     C                   ELSE                                                                 CLE134
     C                   MOVE      'Y'           WORIGL                                       CLE134
     C                   ENDIF                                                                CLE134
     C                   ENDIF                                                                CLE134
      *                                                                                       CLE134
      ** If PDCL has been created in I/C with field YDECRE = N, then                          CLE134
      ** use Take on account instead of settlement account                                    CLE134
      *                                                                                       CLE134
     C********** NEWCOB    IFNE 'Y'                                                    CLE134 262508
     C********** WPDCLL    ANDEQ'Y'                                                    CLE134 262508
     C     WPDCLL        IFEQ      'Y'                                                        262508
      *                                                                                       CLE134
      ** Clear fields before chain to LEPDUEPD or LEPDUFPD                                    CLE134
      *                                                                                       CLE134
     C                   CLEAR                   YTKPAC                                       CLE134
     C                   CLEAR                   YTKPAB                                       CLE134
     C                   CLEAR                   YTKPAA                                       CLE134
     C                   CLEAR                   YTKPAS                                       CLE134
     C                   CLEAR                   YTKPCY                                       CLE134
      *                                                                                       CLE134
     C                   CLEAR                   YTKIAC                                       CLE134
     C                   CLEAR                   YTKIAB                                       CLE134
     C                   CLEAR                   YTKIAA                                       CLE134
     C                   CLEAR                   YTKIAS                                       CLE134
     C                   CLEAR                   YTKICY                                       CLE134
     C                   CLEAR                   YPDINT                                       CLE134
     C                   CLEAR                   YPCPAM                                       CLE134
      *                                                                                       CLE134
      ** PDCL generated by a loan                                                             CLE134
      *                                                                                       CLE134
     C     LTYP1A        IFEQ      'X'                                                        CLE134
     C     LTYP1A        OREQ      'Y'                                                        CLE134
      *                                                                                       CLE134
     C*****KPDCL         CHAIN     LEPDUEL1                           24             CLE134 MD023310
     C     LNRF          SETLL     LEPDUEL1                                                 MD023310
     C     LNRF          READE     LEPDUEL1                               24                MD023310
      *                                                                                       CLE134
     C                   ELSE                                                                 CLE134
      *                                                                                       CLE134
      ** PDCL generated by a fee                                                              CLE134
      *                                                                                       CLE134
     C*****KPDCL         CHAIN     LEPDUFL1                           24           AR736589 MD023310
     C     LNRF          SETLL     LEPDUFL1                                                 MD023310
     C     LNRF          READE     LEPDUFL1                               24                MD023310
     C     *IN24         IFEQ      *OFF                                                     AR736589
     C                   MOVE      'N'           YDECRE                                     AR736589
     C                   ENDIF                                                                CLE134
      *                                                                                       CLE134
     C                   ENDIF                                                                CLE134
      *                                                                                       CLE134
      ** if loan is a PDCL created in I/C and field Decrease (YDECRE)                         CLE134
      ** is equal to 'N', then - create standard Value Date account                           CLE134
      ** key but use Take on account instead of transaction accounts.                         CLE134
      *                                                                                       CLE134
     C     *IN24         IFEQ      *OFF
     C********** YLCD      ANDEQRDNB                                                   CLE134 262508
     C********** YTYLC     ANDEQ'I'                                                    CLE134 262508
     C     YPCBIC        IFEQ      'I'                                                        262508
     C     YDECRE        ANDEQ     'N'                                                        CLE134
     C                   MOVE      'Y'           WPDCLA                                       CLE134
     C                   ENDIF                                                                CLE134
     C     YDECRE        IFEQ      'Y'                                                        CLE134
     C     YPCBIC        OREQ      'C'                                                        262508
     C                   MOVE      'Y'           WPDCLR                                       CLE134
     C                   ENDIF                                                                CLE134
     C                   ENDIF                                                                CLE134
      *                                                                                       CLE134
     C                   ENDIF                                                                CLE134
      *                                                                                       CLE134
1112 C                   BITON     '1'           ACEI
1113 C**
1114 C**   GENERATE A/C KEY FOR START DATE
1115 C**
1116 C                   Z-ADD     VDAT          ACDATE
1117 C                   Z-ADD     CPAM          ACAMNT                   89
1118 C                   MOVE      'V'           AKY(3)
1119 C                   MOVEA     BKAKY         AKY(6)
1120 C                   MOVE      'A'           AKY(10)
      *                                                                                       CLE134
      ** If PDCL has been generated by COB or it has been generated                           CLE134
      ** during I/C and YDECRE is 'Y' then create account key ending by                       CLE134
      ** 'XA' instead of 'A'. In the case where both the principal                            CLE134
      ** and the interest are not zero, then create an extra XA a/c key                       CLE134
      ** to store the interest and the principal separately.                                  CLE134
      *                                                                                       CLE134
     C     WPDCLL        IFEQ      'Y'                                                        CLE134
     C     WPDCLA        ANDNE     'Y'                                                        CLE134
     C     WPDCLR        ANDEQ     'Y'                                                        CLE134
     C                   MOVEA     'XA'          AKY(9)                                       CLE134
      *                                                                                       CLE134
      ** If YPDINT is not zero and YPCPAM is not zero, then there must                        CLE134
      ** be 2 PDCL value date account keys (XA) to post the interest                          CLE134
      ** and the principal separately                                                         CLE134
      *                                                                                       CLE134
     C     YPDINT        IFGT      0                                                          CLE134
     C     YPCPAM        ANDGT     0                                                          CLE134
     C                   Z-ADD     YPDINT        ACAMNT                   89                  CLE134
     C  N89              EXSR      AKYOUT                                                     CLE134
     C                   Z-ADD     YPCPAM        ACAMNT                   89                  CLE134
     C                   ENDIF                                                                CLE134
      *                                                                                       CLE134
     C                   ENDIF                                                                CLE134
      *                                                                                       CLE134
      ** If PDCL generated in I/C and field YDECRE = 'N'                                      CLE134
      ** then use take on account                                                             CLE134
      *                                                                                       CLE134
     C     NEWCOB        IFEQ      'N'                                                        CLE134
     C     WPDCLA        ANDEQ     'Y'                                                        CLE134
     C                   MOVE      OSAC          WOSAC                                        CLE134
     C                   MOVE      SETP          WSETP                                        CLE134
     C                   MOVE      OSBR          WOSBR                                        CLE134
     C                   CLEAR                   OSAC                                         CLE134
      *                                                                                       CLE134
      ** Access ACCNTAB by Interest take on account                                           CLE134
      *                                                                                       CLE134
     C     YPDINT        IFNE      0                                                          CLE134
     C     YTKIAC        ANDNE     *BLANKS                                                    CLE134
      *                                                                                       CLE134
     C                   MOVE      YTKIAC        YKCNUM                                       CLE134
     C                   MOVE      YTKIAB        YKBRCA                                       CLE134
     C                   MOVE      YTKIAA        YKACOD                                       CLE134
     C                   MOVE      YTKIAS        YKACSQ                                       CLE134
     C                   MOVE      YTKICY        YKCCY                                        CLE134
     C                   EXSR      STAKEA                                                     CLE134
      *                                                                                       CLE134
      ** if Past Due principal from LEPDUEPD is not zero,                                     CLE134
      ** then create an additional account key type V for the                                 CLE134
      ** Interest amount and interest take on account                                         CLE134
      *                                                                                       CLE134
     C     YPCPAM        IFNE      0                                                          CLE134
     C                   Z-ADD     YPDINT        ACAMNT                   89                  CLE134
     C  N89              EXSR      AKYOUT                                                     CLE134
     C                   Z-ADD     YPCPAM        ACAMNT                   89                  CLE134
     C                   ENDIF                                                                CLE134
      *                                                                                       CLE134
     C                   ENDIF                                                                CLE134
      *                                                                                       CLE134
      ** Access ACCNTAB by Principal take on account                                          CLE134
      *                                                                                       CLE134
     C     YPCPAM        IFNE      0                                                          CLE134
     C     YTKPAC        ANDNE     *BLANKS                                                    CLE134
     C                   MOVE      YTKPAC        YKCNUM                                       CLE134
     C                   MOVE      YTKPAB        YKBRCA                                       CLE134
     C                   MOVE      YTKPAA        YKACOD                                       CLE134
     C                   MOVE      YTKPAS        YKACSQ                                       CLE134
     C                   MOVE      YTKPCY        YKCCY                                        CLE134
     C                   EXSR      STAKEA                                                     CLE134
      *                                                                                       CLE134
     C                   ENDIF                                                                CLE134
     C                   ENDIF                                                                CLE134
      *                                                                                       CLE034
      ** If CLE034 is installed                                                               CLE034
      *                                                                                       CLE034
     C     CLE034        IFEQ      'Y'
     C     STAL          ANDEQ     'Y'
     C                   MOVE      'S'           WTYPE
     C                   EXSR      SR34A
     C                   ELSE
     C                   MOVE      'Y'           WRKFLD
     C                   MOVE      '*EOF   '     PRTCD
     C                   ENDIF
      *                                                                                       CLE034
     C     WRKFLD        DOWEQ     'Y'
     C     PRTCD         OREQ      *BLANKS
     C     CLE034        IFEQ      'Y'
     C     STAL          ANDEQ     'Y'
     C                   EXSR      SR34B
     C                   ENDIF
      *                                                                                       CLE031
      ** If feature CLE031 is on set work type to start & call SR/SETCCY                      CLE031
      *                                                                                       CLE031
     C     CLE031        IFEQ      'Y'
     C                   MOVE      'S'           WTYPE
     C**********           EXSR SETCCY                                                 CLE031 218782
      *                                                                                       CLE031
     C**********           MOVE OSAC      OSACSV 12                                    CLE031 CGL029
     C                   MOVE      OSAC          OSACSV           18
     C                   MOVE      SETP          SETPSV            2 0
      *                                                                                       CLE031
     C     PTYP          IFNE      66
     C     PTYP          ANDNE     67
     C     PTYP          ANDNE     69
     C     PTYP          ANDNE     72
     C                   MOVE      PONS          OSAC
     C                   MOVE      PSTM          SETP
     C                   ELSE
     C                   MOVE      RONS          OSAC
     C                   MOVE      RSTM          SETP
     C                   ENDIF
      *                                                                                       218782
     C                   EXSR      SETCCY
      *                                                                                       CLE031
     C                   ENDIF
      *                                                                                       CLE031
1121 C  N89              EXSR      AKYOUT
      *                                                                                       CLE134
      ** Reset values                                                                         CLE134
      *                                                                                       CLE134
     C     WPDCLL        IFEQ      'Y'                                                        CLE134
     C     WPDCLA        ANDNE     'Y'                                                        CLE134
     C     WPDCLR        ANDEQ     'Y'                                                        CLE134
     C                   MOVEA     ' A'          AKY(9)                                       CLE134
     C                   ENDIF                                                                CLE134
      *                                                                                       CLE134
     C     NEWCOB        IFEQ      'N'                                                        CLE134
     C     WPDCLA        ANDEQ     'Y'                                                        CLE134
     C                   MOVE      WOSAC         OSAC                                         CLE134
     C                   MOVE      WSETP         SETP                                         CLE134
     C                   MOVE      WOSBR         OSBR                                         CLE134
     C                   Z-ADD     CPAM          ACAMNT                   89                  CLE134
     C                   ENDIF                                                                CLE134
      *                                                                                       CLE031
      ** If feature CLE031 is on  call SR/SETTLE                                              CLE031
      *                                                                                       CLE031
     C     CLE031        IFEQ      'Y'
     C     WCLE134       ANDEQ     ' '                                                      MD049078
     C                   MOVE      OSACSV        OSAC
     C                   MOVE      SETPSV        SETP
     C                   EXSR      SETTLE
     C                   ENDIF
      *                                                                                       CLE034
     C     CLE034        IFEQ      'Y'
     C     STAL          ANDEQ     'Y'
     C                   EXSR      SR34C
     C                   ELSE
     C                   MOVE      *BLANKS       WRKFLD
     C                   ENDIF
     C                   ENDDO
      *                                                                                       CLE034
     C     CLE034        IFEQ      'Y'
     C     STAL          ANDEQ     'Y'
     C                   EXSR      SR34E
     C                   ENDIF
      *                                                                   CAC001
      ** Generate value date account keys                                 CAC001
      *                                                                   CAC001
     C     BGN0ST        IFEQ      'Y'                                                         CAC00
     C     FPRCL         ANDNE     *BLANKS                                                     CAC00
      *                                                                   CAC001
      ** Transaction Profit Centre                                        CAC001
      *                                                                   CAC001
     C                   MOVEA     'T   '        AKY(6)                                        CAC00
     C     *IN89         IFEQ      '0'                                                         CAC00
     C                   EXSR      AKYOUT                                                      CAC00
     C                   ENDIF                                                                 CAC00
      *                                                                   CAC001
      ** Funding Profit Centre                                            CAC001
      *                                                                   CAC001
     C                   MOVEA     'F   '        AKY(6)                                        CAC00
     C                   MOVEL     PRFC          WPRFC             4                           CAC00
     C                   MOVEL     FPRCL         PRFC                                          CAC00
     C     *IN89         IFEQ      '0'                                                         CAC00
     C                   EXSR      AKYOUT                                                      CAC00
     C                   ENDIF                                                                 CAC00
     C                   MOVEL     WPRFC         PRFC                                          CAC00
     C                   MOVEA     BKAKY         AKY(6)                                        CAC00
      *                                                                   CAC001
     C                   ENDIF                                                  - BGN0ST       CAC00
     C*                                                                   S01465
     C**  Account key generated with 'R' in AKY (in position 8) if        S01465
     C**  the receiver of guarantee is different to blanks                S01465
     C*                                                                   S01465
     C     *IN26         IFEQ      '1'                                                         S0146
     C     WORECE        IFNE      *BLANKS                                                     S0146
     C**********           Z-ADDCNUML     WORK2                                        S01465 CSD027
     C                   MOVE      CNUML         WORK2
     C                   MOVE      WORECE        CNUML                                         S0146
     C                   MOVE      'R'           AKY(8)                                        S0146
     C  N89              EXSR      AKYOUT                                                      S0146
     C**********           Z-ADDWORK2     CNUML                                        S01465 CSD027
     C                   MOVE      WORK2         CNUML
     C                   MOVE      ' '           AKY(8)                                        S0146
     C                   END                                                                   S0146
     C                   END                                                                   S0146
     C/COPY WNCPYSRC,LE0450C047
1122 C**
1123 C**   CHECK FOR DISC LOAN AND GENERATE A/C KEYS FOR DISC/PREMIUM
1124 C**   AND TOTAL AMOUNTS IF REQUIRED
1125 C**
1126 C  N45              GOTO      STAGG
1127 C**
     C     CAS009        IFEQ      'Y'
      *                                                                                       232348
      ** Only process EIR cost accounting if loan's value date is same                        232348
      ** as or after the non-linear amortisation cut-off date                                 232348
      *                                                                                       232348
     C     VDAT          ANDGE     FSNLAC
     C                   EXSR      SRRTVI
     C                   ENDIF
     C     CAS009        IFEQ      'Y'
     C     *IN45         ANDEQ     '1'
     C     FSAMRM        ANDEQ     'N'
     C     AYACAI        ANDEQ     'Y'
      *                                                                                       232348
      ** Only process EIR cost accounting if loan's value date is same                        232348
      ** as or after the non-linear amortisation cut-off date                                 232348
     C     VDAT          ANDGE     FSNLAC
      *                                                                                       CAS009
      ** Suppress Dicount/Premium Amount for Discount Loans when                              CAS009
      ** the Amortisation Method is 'N'on-Linear.                                             CAS009
      *                                                                                       CAS009
     C                   ELSE
1128 C                   Z-ADD     TOTI          ACAMNT                 8889
1129 C   88              MOVE      'P'           AKY(10)
1130 C   88              Z-SUB     ACAMNT        ACAMNT
1131 C  N88              MOVE      'D'           AKY(10)
1132 C  N89              EXSR      AKYOUT
     C                   ENDIF
1133 C**
1134 C     CPAM          SUB       TOTI          ACAMNT                   89
1135 C                   MOVE      'B'           AKY(10)
      *                                                                                       CLE034
      ** If CLE034 is installed                                                               CLE034
      *                                                                                       CLE034
     C     CLE034        IFEQ      'Y'
     C     STAL          ANDEQ     'Y'
     C                   EXSR      SR34A
     C                   ELSE
     C                   MOVE      'Y'           WRKFLD
     C                   MOVE      '*EOF   '     PRTCD
     C                   ENDIF
      *                                                                                       CLE034
     C     WRKFLD        DOWEQ     'Y'
     C     PRTCD         OREQ      *BLANKS
     C     CLE034        IFEQ      'Y'
     C     STAL          ANDEQ     'Y'
     C                   EXSR      SR34B
     C                   EXSR      SETCCY
     C                   ELSE
      *                                                                                       CLE031
      ** If feature CLE031 is on call SR/SECCY2                                               CLE031
      *                                                                                       CLE031
     C     CLE031        IFEQ      'Y'
     C                   EXSR      SECCY2
     C                   ENDIF
     C                   ENDIF
      *                                                                                       CLE031
1136 C  N89              EXSR      AKYOUT
      *                                                                                       CLE031
      ** If feature CLE031 is on call SR/SETRST                                               CLE031
      *                                                                                       CLE031
     C     CLE031        IFEQ      'Y'
     C                   EXSR      SETRST
     C                   ENDIF
      *                                                                                       CLE034
     C     CLE034        IFEQ      'Y'
     C     STAL          ANDEQ     'Y'
     C                   EXSR      SR34C
     C                   ELSE
     C                   MOVE      *BLANKS       WRKFLD
     C                   ENDIF
     C                   ENDDO
      *                                                                                       CLE034
     C     CLE034        IFEQ      'Y'
     C     STAL          ANDEQ     'Y'
     C                   EXSR      SR34E
     C                   ENDIF
1137 C**
1138 C**   CALCULATE AGGREGATE BALANCE
1139 C**
1140 C     STAGG         TAG                                                    ** STAGG TAG **
1141 C**
1142 C     VDAT          COMP      JAN1                                 89
1143 C   89              Z-ADD     JAN1          DAY1
1144 C  N89              Z-ADD     VDAT          DAY1
1145 C**
1146 C   43DEC31         COMP      EVCD                                 89
     C   43
1147 CAN 89              Z-ADD     DEC31         WRK05
1148 C  N43
     COR 43
1149 CANN89              Z-ADD     EVCD          WRK05
1150 C     WRK05         SUB       DAY1          WRK05
1151 C     WRK05         ADD       1             WRK05                  89
1152 C     CPAM          MULT      WRK05         AGBAL
1153 C   89              Z-ADD     0             AGBAL
      *                                                                                       CLE038
      ** Once Start Date has been processed, remove                                           CLE038
      ** the Settlement Allocatations by Amount                                               CLE038
      *                                                                                       CLE038
     C     CLE038        IFEQ      'Y'
     C     STALL         ANDEQ     'Y'
     C                   EXSR      SR38B
     C                   ENDIF
      *                                                                                       CLE038
      *                                                                                       CLE028
      ** Generate advance amortisation of interest for flat                                   CLE028
      ** rate personal loan                                                                   CLE028
      *                                                                                       CLE028
     C     CLE028        IFEQ      'Y'
     C     PTYP          ANDEQ     80
      *                                                                                       CLE028
      ** Only generate amortisation on start date when                                        CLE028
      ** rundate is less than the next repayment date                                         CLE028
      *                                                                                       CLE028
     C     RDNB          IFLT      NRPD
     C                   Z-ADD     VDATL         ZIBEG
     C                   Z-ADD     VDATL         ZIEND
     C                   EXSR      SRPCAL
     C**********           Z-ADDAITC      ACAMNT                                       CLE028 214980
     C                   Z-ADD     ZINTR         ACAMNT
     C                   MOVE      'A'           AKY(3)
     C                   MOVEA     BKAKY         AKY(6)
     C     ADIF          IFEQ      'Y'
     C                   MOVE      'D'           AKY(10)
     C                   ELSE
     C                   MOVE      'I'           AKY(10)
     C                   ENDIF
      *                                                                                       CLE028
     C     ACAMNT        IFNE      *ZERO
     C                   EXSR      AKYOUT
     C                   ENDIF
     C                   ENDIF
     C                   ENDIF
1154 C**
1155 C                   ENDSR
1156 C**
1157 C**
1158 C********************************************************************
1159 C********************************************************************
1160 C**
1161 C**   SUBROUTINE TO PROCESS MANUAL ADJ.TO INT. - MANINT
1162 C**
1163 C**   CALLED FROM ACTNS
1164 C**   CALLS NO OTHER SUBROUTINES
1165 C**
1166 C     MANINT        BEGSR                                                  ***  MANINT ***
1167 C**
1168 C**   ADD UP MAN ADJ NOT POSTED AND POSTED AND ZEROISE NOT POSTED
1169 C**
1170 C     AIMN          ADD       AIAP          AIAP
1171 C                   Z-ADD     0             AIMN
      *                                                                   CAC001
      **  Calculate Accrued COF Manual Adjustment Posted                  CAC001
      *                                                                   CAC001
     C     BGN0ST        IFEQ      'Y'                                                         CAC00
     C     FPRCL         ANDNE     *BLANKS                                                     CAC00
     C                   ADD       ACAJ          ACAP                                          CAC00
     C                   Z-ADD     0             ACAJ                                          CAC00
     C                   ENDIF                                                                 CAC00
      *                                                                                       CAS005
     C     CAS005        IFEQ      'Y'
     C     AINN          ADD       AIAN          AIAN
     C                   Z-ADD     0             AINN
     C                   ENDIF
      *                                                             117334121147
     C***********          Z-ADDIACDMI    IACD                      117334121147
1172 C**
1173 C                   ENDSR
1174 C**
1175 C**
1176 C********************************************************************
1177 C********************************************************************
1178 C**
1179 C**   SUBROUTINE TO PROCESS STOP ACCRUALS ACTION RECORDS - STOPAC
1180 C**
1181 C**   CALLED FROM ACTNS
1182 C**   CALLS NO OTHER SUBROUTINES
1183 C**
1184 C     STOPAC        BEGSR                                                  ***  STOPAC ***
1185 C**
      *                                                                                       CLE134
      ** CLE134 - Past Due Call Loans process                                                 CLE134
      *                                                                                       CLE134
     C                   MOVE      'N'           WPDCLL                                       CLE134
     C                   MOVE      'N'           WPDCLA                                       CLE134
     C                   MOVE      'N'           WPDCLR                                       CLE134
     C                   MOVE      'N'           WORIGL                                       CLE134
     C                   MOVE      'N'           WORIGA                                       CLE134
     C                   MOVE      'N'           WMRAUT                                       263416
      *                                                                                       CLE134
1186 C     STAI          COMP      'Y'                                    48
1187 C   48              BITON     '3'           LONI
1188 C  N48              BITOFF    '3'           LONI
1189 C**
1190 C                   ENDSR
1191 C**
1192 C**
1193 C********************************************************************
1194 C********************************************************************
1195 C**
1196 C**   SUBROUTINE TO PROCESS PRINCIPAL INCREASES - PRININ
1197 C**
1198 C**   CALLED FROM ACTNS
1199 C*****CALLS CPAMUP,AKYOUT                                                                CLE031
1199 C**   CALLS CPAMUP,AKYOUT,SETCCY,SETTLE                                                  CLE031
1200 C**
1201 C     PRININ        BEGSR                                                  *** PRININ  ***
1202 C**
      ** CLE134 - Past Due Call Loans process                                                 CLE134
      *                                                                                       CLE134
     C                   MOVE      'N'           WPDCLL                                       CLE134
     C                   MOVE      'N'           WPDCLA                                       CLE134
     C                   MOVE      'N'           WPDCLR                                       CLE134
     C                   MOVE      'N'           WORIGL                                       CLE134
     C                   MOVE      'N'           WORIGA                                       CLE134
     C                   MOVE      'N'           WMRAUT                                       263416
      *                                                                                       CLE134
      * if AUTO = 'C', check whether the processed loan is a PDCL or                          CLE134
      * an original loan by checking the 1st character of the                                 CLE134
      * loan type. If it is X, Y, Z then the loan is                                          CLE134
      * a Past Due Call Loan.                                                                 CLE134
      *                                                                                       CLE134
     C     CLE134        IFEQ      'Y'                                                        CLE134
      *                                                                                       CLE134
     C     AUTO          ANDEQ     'C'                                                        CLE134
     C     CLE134        OREQ      'Y'                                                        CLE134
     C     AUTOX         ANDEQ     'C'                                                        CLE134
     C                   MOVEL     LTYP          LTYP1A            1                          CLE134
     C                   EVAL      WCLE134 = 'Y'                                            MD049078
     C     LTYP1A        IFEQ      'X'                                                        CLE134
     C     LTYP1A        OREQ      'Y'                                                        CLE134
     C     LTYP1A        OREQ      'Z'                                                        CLE134
     C                   MOVE      'Y'           WPDCLL                                       CLE134
     C                   ELSE                                                                 CLE134
     C                   MOVE      'Y'           WORIGL                                       CLE134
     C                   ENDIF                                                                CLE134
      *                                                                                       CLE134
     C                   ENDIF                                                                CLE134
      *                                                                                       CLE134
1203 C**   UPDATE CURRENT PRINCIPAL AMOUNT
1204 C**
1205 C                   Z-ADD     PRAM          AMOUNT           13 0
1206 C                   EXSR      CPAMUP
     C     GPRT1         IFNE      'F'
1207 C**
1208 C**   UPDATE ORIGINAL PRINCIPAL
1209 C**
1210 C     ORIGPR        ADD       PRAM          ORIGPR           13 0
     C                   Z-ADD     CPAM          OCPAM                                         E2184
      *                                                                   145393
      ** If feature CEU004 is on, set currency field on LKEY1DP           145393
      ** if settlement currency from the ACTN is not blank.               145393
      *                                                                   145393
     C     CEU004        IFEQ      'Y'                                          If Feature On  14539
      *                                                                   145393
     C     SCCYA         IFNE      *BLANKS                                       If SetCcy # Bl14539
     C                   MOVE      SCCYA         LKSCCY                           Set Outpt Ccy14539
     C                   ELSE                                                    Else
     C                   MOVE      *BLANKS       LKSCCY                          Clr Outpt Ccy
     C                   ENDIF                                                   End If        14539
      *                                                                   145393
     C                   ENDIF                                                   End If        14539
1211 C**
1212 C**   GENERATE A/C KEY FOR INCREASE AMOUNT
1213 C**
1214 C                   Z-ADD     VDAT          ACDATE
1215 C                   Z-ADD     PRAM          ACAMNT                   89
1216 C                   MOVE      'V'           AKY(3)
1217 C***********          MOVEA'   '     AKY,6                           153368
     C                   MOVEA     BKAKY         AKY(6)                                        15336
1218 C                   MOVE      'I'           AKY(9)
1219 C                   MOVE      'A'           AKY(10)
      *                                                                                       CLE134
      ** if PDCL has been generated by COB or it has been generated                           CLE134
      ** during I/C and YDECRE is 'N' then create account key                                 CLE134
      ** ending by 'XA' instead of 'A'                                                        CLE134
      *                                                                                       CLE134
     C     WPDCLL        IFEQ      'Y'                                                        CLE134
     C     WPDCLA        ANDNE     'Y'                                                        CLE134
     C**********           MOVEA'XA'      AKY,9                                               CLE134
     C                   ENDIF                                                                CLE134
      *                                                                                       CLE134
      *                                                                                       CLE034
      ** If CLE034 is installed                                                               CLE034
      *                                                                                       CLE034
     C     CLE034        IFEQ      'Y'
     C     STAL          ANDEQ     'Y'
     C                   MOVE      'S'           WTYPE
     C                   EXSR      SR34A
     C                   ELSE
     C                   MOVE      'Y'           WRKFLD
     C                   MOVE      '*EOF   '     PRTCD
     C                   ENDIF
      *                                                                                       CLE034
     C     WRKFLD        DOWEQ     'Y'
     C     PRTCD         OREQ      *BLANKS
     C     CLE034        IFEQ      'Y'
     C     STAL          ANDEQ     'Y'
     C                   EXSR      SR34B
     C                   ENDIF
      *                                                                                       CLE031
      ** If feature CLE031 is on set work type to start & call SR/SETCCY                      CLE031
      *                                                                                       CLE031
     C     CLE031        IFEQ      'Y'
     C                   MOVE      'S'           WTYPE
     C                   EXSR      SETCCY
     C                   ENDIF
      *                                                                                       CLE031
1220 C  N89              EXSR      AKYOUT
      *                                                                                       CLE134
      ** Reset a/c key                                                                        CLE134
      *                                                                                       CLE134
     C     WPDCLL        IFEQ      'Y'                                                        CLE134
     C     WPDCLA        ANDNE     'Y'                                                        CLE134
     C                   MOVEA     'IA'          AKY(9)                                       CLE134
     C                   ENDIF                                                                CLE134
      *                                                                                       CLE031
      ** If feature CLE031 is on call SR/SETTLE                                               CLE031
      *                                                                                       CLE031
     C     CLE031        IFEQ      'Y'
     C     WCLE134       ANDEQ     ' '                                                      MD049078
     C                   EXSR      SETTLE
     C                   ENDIF
      *                                                                                       CLE034
     C     CLE034        IFEQ      'Y'
     C     STAL          ANDEQ     'Y'
     C                   EXSR      SR34C
     C                   ELSE
     C                   MOVE      *BLANKS       WRKFLD
     C                   ENDIF
     C                   ENDDO
      *                                                                                       CLE034
     C     CLE034        IFEQ      'Y'
     C     STAL          ANDEQ     'Y'
     C                   EXSR      SR34E
     C                   ENDIF
      *                                                                   CAC001
      ** Generate account keys for principal increase.                    CAC001
      *                                                                   CAC001
     C     BGN0ST        IFEQ      'Y'                                                         CAC00
     C     FPRCL         ANDNE     *BLANKS                                                     CAC00
      *                                                                   CAC001
      ** Transaction Profit Centre                                        CAC001
      *                                                                   CAC001
     C                   MOVE      'T'           AKY(6)                                        CAC00
     C     *IN89         IFEQ      '0'                                                         CAC00
     C                   EXSR      AKYOUT                                                      CAC00
     C                   ENDIF                                                                 CAC00
      *                                                                   CAC001
      ** Funding Profit Centre                                            CAC001
      *                                                                   CAC001
     C                   MOVE      'F'           AKY(6)                                        CAC00
     C                   MOVEL     PRFC          WPRFC             4                           CAC00
     C                   MOVEL     FPRCL         PRFC                                          CAC00
     C     *IN89         IFEQ      '0'                                                         CAC00
     C                   EXSR      AKYOUT                                                      CAC00
     C                   ENDIF                                                                 CAC00
     C                   MOVEL     WPRFC         PRFC                                          CAC00
     C                   MOVE      ' '           AKY(6)                                        CAC00
      *                                                                   CAC001
     C                   ENDIF                                                  - BGN0ST       CAC00
     C*                                                                   S01465
     C**  Account key generated with 'R' in AKY (in position 8) if        S01465
     C**  the receiver of guarantee is different to blanks                S01465
     C*                                                                   S01465
     C     *IN26         IFEQ      '1'                                                         S0146
     C     WORECE        IFNE      *BLANKS                                                     S0146
     C**********           Z-ADDCNUML     WORK2                                        S01465 CSD027
     C                   MOVE      CNUML         WORK2
     C                   MOVE      WORECE        CNUML                                         S0146
     C                   MOVE      'R'           AKY(8)                                        S0146
     C  N89              EXSR      AKYOUT                                                      S0146
     C**********           Z-ADDWORK2     CNUML                                        S01465 CSD027
     C                   MOVE      WORK2         CNUML
     C                   MOVE      ' '           AKY(8)                                        S0146
     C                   END                                                                   S0146
     C                   END                                                                   S0146
     C                   ENDIF
1221 C**
1222 C                   ENDSR
1223 C**
1224 C**
1225 C********************************************************************
1226 C********************************************************************
1227 C**
1228 C**   SUBROUTINE TO PROCESS MANUAL REPAYMENT ACTIONS - MANREP
1229 C**
1230 C**   CALLED FROM ACTNS
1231 C*****CALLS CPAMUP,AKYOUT(3),INTRST                                                      CLE031
1231 C**   CALLS CPAMUP,AKYOUT(3),INTRST,SETCCY,SETTLE,SECCY2,SETRST                          CLE031
1232 C**
1233 C     MANREP        BEGSR                                                  *** MANREP  ***
     C/COPY WNCPYSRC,LEH00467
1234 C**
1235 C**   UPDATE CURRENT PRINCIPAL AMOUNT
1236 C**
      *                                                                   180044
     C     *IN15         IFEQ      '0'                                                         18004
     C                   SETON                                        83
     C                   Z-ADD     CPAM          ACRBAL           13 0
1237 C                   Z-SUB     PRAM          AMOUNT
      *                                                                                       CLE028
      ** Include interest and charge refund in updating CPAM                                  CLE028
      ** amount if the interest and charge were added on to                                   CLE028
      ** principal at start date for flat rate personal loans                                 CLE028
      ** early payoffs                                                                        CLE028
      *                                                                                       CLE028
     C     CLE028        IFEQ      'Y'
     C     PTYP          ANDEQ     80
     C     ADIF          IFEQ      'Y'
     C     REBT          ANDNE     *ZERO
     C                   SUB       REBT          AMOUNT
     C                   ENDIF
     C     ADCF          IFEQ      'Y'
     C     CHDU          ANDNE     *ZERO
     C                   SUB       CHDU          AMOUNT
     C                   ENDIF
     C                   ENDIF
1238 C                   EXSR      CPAMUP
      **********                                                                       209805 259708
      ***If*outstanding*principal*is*zero,*blanked*out*repayment*details               209805 259708
      **********                                                                       209805 259708
     C*****CPAM*         IFLE      *ZERO                                                      259708
     C**********         Z-ADD     *ZEROS        RBDT                                         259708
     C**********         Z-ADD     *ZEROS        NRPD                                         259708
     C**********         Z-ADD     *ZEROS        RAMT                                         259708
     C     CLE028        IFEQ      'N'
     C     PTYP          ORNE      80
     C**********         Z-ADD     *ZEROS        RDYN                                         259708
     C**********         MOVE      ' '           RFRQ                                         259708
     C                   ENDIF
     C**********         ENDIF                                                                259708
1239 C**
1240 C**   IF WRITTEN OFF UPDATE PRINC WRITTEN OFF FIELD
1241 C**
1242 C     LWOI          COMP      'Y'                                    85
1243 C   85PRAM          ADD       PWOD          PWOD
1244 C   85YTDPRW        ADD       PRAM          YTDPRW           13 0
      *                                                                   145393
      ** If feature CEU004 is on, set currency field on LKEY1DP           145393
      ** if settlement currency from the ACTN is not blank.               145393
      *                                                                   145393
     C     CEU004        IFEQ      'Y'                                          If Feature On  14539
      *                                                                   145393
     C     SCCYA         IFNE      *BLANKS                                       If SetCcy # Bl14539
     C                   MOVE      SCCYA         LKSCCY                           Set Outpt Ccy14539
     C                   ELSE                                                    Else
     C                   MOVE      *BLANKS       LKSCCY                          Clr Outpt Ccy
     C                   ENDIF                                                   End If        14539
      *                                                                   145393
     C                   ENDIF                                                   End If        14539
      *                                                                                       CLE134
      ** CLE134 - Past Due Call Loans process                                                 CLE134
      *                                                                                       CLE134
     C                   MOVE      'N'           WPDCLL                                       CLE134
     C                   MOVE      'N'           WPDCLA                                       CLE134
     C                   MOVE      'N'           WPDCLR                                       CLE134
     C                   MOVE      'N'           WORIGL                                       CLE134
     C                   MOVE      'N'           WORIGA                                       CLE134
     C                   MOVE      'N'           WMRAUT                                       263416
      *                                                                                       CLE134
      ** if AUTO = 'C', check whether the processed loan is a PDCL                            CLE134
      ** or an original loan by checking the 1st character of the loan                        CLE134
      ** type. If it is X, Y, Z then the loan is a Past Due Call Loan.                        CLE134
      *                                                                                       CLE134
     C     CLE134        IFEQ      'Y'                                                        CLE134
     C     AUTO          ANDEQ     'C'                                                        CLE134
     C     CLE134        OREQ      'Y'                                                        CLE134
     C     AUTOX         ANDEQ     'C'                                                        CLE134
     C     CLE134        OREQ      'Y'                                                        262967
     C     AUTOL         ANDEQ     'C'                                                        262967
      *                                                                                       CLE134
     C                   MOVEL     LTYP          LTYP1A            1                          CLE134
     C                   EVAL      WCLE134 = 'Y'                                            MD049078
      *                                                                                       CLE134
     C     LTYP1A        IFEQ      'X'                                                        CLE134
     C     LTYP1A        OREQ      'Y'                                                        CLE134
     C     LTYP1A        OREQ      'Z'                                                        CLE134
     C                   MOVE      'Y'           WPDCLL                                       CLE134
     C                   ELSE                                                                 CLE134
     C                   MOVE      'Y'           WORIGL                                       CLE134
     C                   ENDIF                                                                CLE134
      *                                                                                       CLE134
     C                   ENDIF                                                                CLE134
      *                                                                                       CLE134
      ** If Original Loan repayment, check whether a PDCL has been                            CLE134
      ** generated today in I/C with field "Decrease" (YDECRE) = 'Y'.                         CLE134
      ** If it has, then the Original Loan manual repayment event                             CLE134
      ** generates a new account keys                                                         CLE134
      *                                                                                       CLE134
     C     NEWCOB        IFNE      'Y'                                                        CLE134
     C     WORIGL        ANDEQ     'Y'                                                        CLE134
      *                                                                                       CLE134
     C                   MOVE      '0'           *IN24                                      AR689431
     C*****KPDCL         CHAIN     LEPDUEL2                           24             CLE134 AR689431
     C     KPDCL         SETLL     LEPDUEL2                                                 AR689431
     C     *IN24         DOWEQ     '0'                                                      AR689431
     C*****KPDCL         READE     LEPDUEL2                             24        AR689431 AR1078443
     C     KPDCL         READE     LEPDUEL2                               24               AR1078443
      *                                                                                       CLE134
      ** If record found, check whether it has been created today                             CLE134
      ** and whether field YDECRE is Y                                                        CLE134
      *                                                                                       CLE134
     C     *IN24         IFEQ      *OFF                                                       CLE134
     C     YLCD          ANDEQ     RDNB                                                       CLE134
     C     YTYLC         ANDEQ     'I'                                                        CLE134
     C     YDECRE        ANDEQ     'Y'                                                        CLE134
     C********** YPCPAM    ANDEQPRAM                                               AR689431 AR748269
     C********** YPDINT    ANDEQINTA                                               AR689431 AR748269
      *                                                                                       CLE134
     C                   MOVE      'Y'           WORIGA                                       CLE134
     C                   MOVE      '1'           *IN24                                      AR689431
      *                                                                                       CLE134
     C                   ENDIF                                                                CLE134
     C                   ENDDO                                                              AR689431
      *                                                                                       CLE134
      ** Check if Manual Repayment has been created manually                                  263416
      ** in I/C or by PDCL                                                                    263416
      *                                                                                       263416
     C     KMANL         CHAIN     LOMNEWF                            24                      CLE134
     C     *IN24         IFEQ      *OFF                                                       CLE134
      *                                                                                       CLE134
     C                   MOVE      'Y'           WMRAUT                                       CLE134
      *                                                                                       CLE134
     C                   ENDIF                                                                CLE134
      *                                                                                       263416
     C                   ENDIF                                                                CLE134
1245 C**
1246 C**   GENERATE AN A/C KEY FOR PRINCIPAL REPAYMENT
1247 C**
1248 C                   Z-ADD     VDAT          ACDATE
1249 C                   Z-ADD     PRAM          ACAMNT                   89
1250 C                   MOVE      'R'           AKY(3)
     C/COPY WNCPYSRC,LEH00468
1251 C                   MOVEA     BKAKY         AKY(6)
     C/COPY WNCPYSRC,LEH00469
1252 C   85              MOVE      'W'           AKY(9)
1253 C                   MOVE      'A'           AKY(10)
      *                                                                                       CLE134
      ** WORIGA = Y: Original*Loan Repayment must generate a/c key DP                  CLE134 262967
      ** 262967 - allow for creation of core account key                               CLE134 262967
      *                                                                                       CLE134
     C********** WORIGA    IFEQ 'Y'                                                    CLE134 262967
     C********** *IN85     ANDEQ*OFF                                                   CLE134 262967
     C**********           MOVEA'XP'      AKY,9                                        CLE134 262967
     C**********           ENDIF                                                       CLE134 262967
      *                                                                                       CLE034
      ** If CLE034 is installed                                                               CLE034
      *                                                                                       CLE034
     C     CLE034        IFEQ      'Y'
     C     STAL          ANDEQ     'Y'
     C     *IN89         ANDEQ     *OFF
     C                   MOVE      'E'           WTYPE
     C                   EXSR      SR34A
     C                   ELSE
     C                   MOVE      'Y'           WRKFLD
     C                   MOVE      '*EOF   '     PRTCD
     C                   ENDIF
      *                                                                                       CLE034
     C     WRKFLD        DOWEQ     'Y'
     C     PRTCD         OREQ      *BLANKS
     C     CLE034        IFEQ      'Y'
     C     STAL          ANDEQ     'Y'
     C                   EXSR      SR34B
     C     *IN89         IFEQ      *OFF
     C                   EXSR      SETCCY
     C                   ENDIF
     C                   ELSE
      *                                                                                       CLE031
      ** If feature CLE031 is on and indicator 89 is off then                                 CLE031
      ** set work type to end and call SR/SETCCY                                              CLE031
      *                                                                                       CLE031
     C     CLE031        IFEQ      'Y'
     C     *IN89         ANDEQ     *OFF
     C                   MOVE      'E'           WTYPE
     C                   EXSR      SETCCY
     C                   ENDIF
     C                   ENDIF
     C  N89              EXSR      AKYOUT
      *                                                                                       262967
      ** WORIGA = Y: Original Loan Repayment with PDCL generated in                           262967
      ** I/C and field DECRESE = 'Y' then generate an additional                              262967
      ** account key XP                                                                       262967
      *                                                                                       262967
     C  N89WORIGA        IFEQ      'Y'                                                        262967
     C     *IN85         ANDEQ     *OFF                                                       262967
     C     WMRAUT        ANDEQ     'Y'                                                        262967
     C                   MOVEA     'XP'          AKY(9)                                       262967
     C                   EXSR      AKYOUT                                                     262967
     C                   ENDIF                                                                262967
      *                                                                                       CLE134
      ** Reset a/c key                                                                        CLE134
      *                                                                                       CLE134
     C     WORIGA        IFEQ      'Y'                                                        CLE134
     C     *IN85         ANDEQ     *OFF                                                       CLE134
     C                   MOVEA     ' A'          AKY(9)                                       CLE134
     C                   ENDIF                                                                CLE134
      *                                                                                       CLE031
      ** If feature CLE031 is on and indicator 89 is off, call SR/SETTLE                      CLE031
      *                                                                                       CLE031
     C     CLE031        IFEQ      'Y'
     C     *IN89         ANDEQ     *OFF
     C     WCLE134       ANDEQ     ' '                                                      MD049078
     C                   EXSR      SETTLE
     C                   ENDIF
      *                                                                                       CLE034
     C     CLE034        IFEQ      'Y'
     C     STAL          ANDEQ     'Y'
     C                   EXSR      SR34C
     C                   ELSE
     C                   MOVE      *BLANKS       WRKFLD
     C                   ENDIF
     C                   ENDDO
      *                                                                                       CLE034
     C     CLE034        IFEQ      'Y'
     C     STAL          ANDEQ     'Y'
     C                   EXSR      SR34E
     C                   ENDIF
      *                                                                   180044
     C                   ENDIF                                                                 18004
      *                                                                   CLE005
      ** Generate the past due A/C key for CLE005 as a reversal if        CLE005
      ** matched to PD record id set to 'Y'                               CLE005
      *                                                                   CLE005
     C/COPY WNCPYSRC,LEH00470
     C     CLE005        IFEQ      'Y'                                                         CLE00
     C     MTPD          ANDEQ     'Y'                                                         CLE00
     C     PRAM          ANDNE     *ZEROS                                                      CLE00
     C     CLE005        OREQ      'Y'                                                         18004
     C     PRAM          ANDNE     *ZEROS                                                      18004
     C     *IN15         ANDEQ     '1'                                                         18004
     C                   MOVEA     AKY           WSAKY            10                           CLE00
     C                   MOVE      'P'           AKY(3)                                        CLE00
     C                   MOVEA     '    '        AKY(6)                                        CLE00
     C                   MOVE      '1'           *IN21                                         CLE00
      *                                                                   180044
     C     *IN15         IFEQ      '1'                                                         18004
     C                   MOVE      'A'           AKY(10)                                       18004
     C                   Z-ADD     PRAM          ACAMNT                                        18004
     C                   ENDIF                                                                 18004
      *                                                                   180044
     C                   EXSR      AKYOUT                                                      CLE00
     C                   MOVEA     WSAKY         AKY                                           CLE00
     C                   MOVE      '0'           *IN21                                         CLE00
     C                   ENDIF                                                                 CLE00
      ***********                                                  CLE004 CLE005
      **Penalty*key*if*penalty*amount*is*non-zero******************CLE004 CLE005
     C***********PNAM      IFNE *ZERO                              CLE004 CLE005
     C***********          Z-ADDPNAM      ACAMNT                   CLE004 CLE005
     C***********          MOVE *BLANK    AKY,9                    CLE004 CLE005
     C***********          MOVE 'Y'       AKY,10                   CLE004 CLE005
     C***********          EXSR AKYOUT                             CLE004 CLE005
     C***********          ENDIF                                   CLE004 CLE005
      *                                                                   CAC001
      **  Generate Manual Repayment Account Keys                          CAC001
      *                                                                   CAC001
     C     *IN15         IFEQ      '0'                                                         18004
      *                                                                   180044
     C     BGN0ST        IFEQ      'Y'                                                         CAC00
     C     FPRCL         ANDNE     *BLANKS                                                     CAC00
      *                                                                   CAC001
      **  Principal Written Off (principal repayment write off,           CAC001
      **  *IN85 ON) or Principal Repayment (*IN85 OFF) --                 CAC001
      **  -- Transaction Profit Centre                                    CAC001
      *                                                                   CAC001
     C                   MOVEA     'T '          AKY(6)                                        CAC00
     C   85              MOVE      'W'           AKY(9)                                        CLE00
     C                   MOVE      'A'           AKY(10)                                       CLE00
      *                                                                                       CLE134
      ** WORIGA*= Y:*Original*Loan Repayment must generate a/c key DP                  CLE134 262967
     C********** WORIGA    IFEQ 'Y'                                                    CLE134 262967
     C********** *IN85     ANDEQ*OFF                                                   CLE134 262967
     C**********           MOVEA'XP'      AKY,9                                        CLE134 262967
     C**********           ENDIF                                                       CLE134 262967
      *                                                                                       CLE134
     C                   Z-ADD     PRAM          ACAMNT                   89                   CLE00
     C     *IN89         IFEQ      '0'                                                         CAC00
     C                   EXSR      AKYOUT                                                      CAC00
     C                   ENDIF                                                                 CAC00
      *                                                                                       262967
      ** WORIGA = Y: Original Loan Repayment must generate a/c key DP                         262967
      *                                                                                       262967
     C  N89WORIGA        IFEQ      'Y'                                                        262967
     C     *IN85         ANDEQ     *OFF                                                       262967
     C                   MOVEA     'XP'          AKY(9)                                       262967
     C                   EXSR      AKYOUT                                                     262967
     C                   ENDIF                                                                262967
      *                                                                                       262967
      ** Reset a/c key                                                                        CLE134
      *                                                                                       CLE134
     C     WORIGA        IFEQ      'Y'                                                        CLE134
     C     *IN85         ANDEQ     *OFF                                                       CLE134
     C                   MOVEA     ' A'          AKY(9)                                       CLE134
     C                   ENDIF                                                                CLE134
      ***********                                                  CLE004 CLE005
      **Penalty*key*if*penalty*amount*is*non-zero******************CLE004 CLE005
     C***********PNAM      IFNE *ZERO                              CLE004 CLE005
     C***********          Z-ADDPNAM      ACAMNT                   CLE004 CLE005
     C***********          MOVE *BLANK    AKY,9                    CLE004 CLE005
     C***********          MOVE 'Y'       AKY,10                   CLE004 CLE005
     C***********          EXSR AKYOUT                             CLE004 CLE005
     C***********          ENDIF                                   CLE004 CLE005
      *                                                                   CAC001
      **  Principal Written Off (principal repayment write off,           CAC001
      **  *IN85 ON) or Principal Repayment (*IN85 OFF) --                 CAC001
      **  -- Funding Profit Centre                                        CAC001
      *                                                                   CAC001
     C                   MOVEA     'F '          AKY(6)                                        CAC00
     C   85              MOVE      'W'           AKY(9)                                        CLE00
     C                   MOVE      'A'           AKY(10)                                       CLE00
      *                                                                                       CLE134
      ** WORIGA = Y: Original*Loan Repayment*must generate a/c key DP                  CLE134 262967
      *                                                                                       CLE134
     C********** WORIGA    IFEQ 'Y'                                                    CLE134 262967
     C********** *IN85     ANDEQ*OFF                                                   CLE134 262967
     C**********           MOVEA'XP'      AKY,9                                        CLE134 262967
     C**********           END                                                         CLE134 262967
      *                                                                                       CLE134
     C                   Z-ADD     PRAM          ACAMNT                   89                   CLE00
     C                   MOVEL     PRFC          WPRFC                                         CAC00
     C                   MOVEL     FPRCL         PRFC                                          CAC00
     C     *IN89         IFEQ      '0'                                                         CAC00
     C                   EXSR      AKYOUT                                                      CAC00
     C                   ENDIF                                                                 CAC00
      *                                                                                       262967
      ** WORIGA = Y: Original Loan Repayment must generate a/c key DP                         262967
      *                                                                                       262967
     C  N89WORIGA        IFEQ      'Y'                                                        262967
     C     *IN85         ANDEQ     *OFF                                                       262967
     C                   MOVEA     'XP'          AKY(9)                                       262967
     C                   EXSR      AKYOUT                                                     262967
     C                   ENDIF                                                                262967
      *                                                                                       262967
      ** Reset a/c key                                                                        CLE134
      *                                                                                       262967
     C     WORIGA        IFEQ      'Y'                                                        CLE134
     C     *IN85         ANDEQ     *OFF                                                       CLE134
     C                   MOVEA     ' A'          AKY(9)                                       CLE134
     C                   ENDIF                                                                CLE134
      ***********                                                  CLE004 CLE005
      **Penalty*key*if*penalty*amount*is*non-zero******************CLE004 CLE005
     C***********PNAM      IFNE *ZERO                              CLE004 CLE005
     C***********          Z-ADDPNAM      ACAMNT                   CLE004 CLE005
     C***********          MOVE *BLANK    AKY,9                    CLE004 CLE005
     C***********          MOVE 'Y'       AKY,10                   CLE004 CLE005
     C***********          EXSR AKYOUT                             CLE004 CLE005
     C***********          ENDIF                                   CLE004 CLE005
     C                   MOVEL     WPRFC         PRFC                                          CAC00
     C                   MOVEA     BKAKY         AKY(6)                                        CAC00
     C   85              MOVE      'W'           AKY(9)                                        CAC00
      *                                                                   CAC001
     C                   ENDIF                                                                 CAC00
     C*                                                                   S01465
     C**  Account key generated with 'R' in AKY (in position 8) if        S01465
     C**  the receiver of guarantee is different to blanks                S01465
     C*                                                                   S01465
     C     *IN26         IFEQ      '1'                                                         S0146
     C     WORECE        IFNE      *BLANKS                                                     S0146
     C**********           Z-ADDCNUML     WORK2                                        S01465 CSD027
     C                   MOVE      CNUML         WORK2
     C                   MOVE      WORECE        CNUML                                         S0146
     C                   MOVE      'R'           AKY(8)                                        S0146
     C  N89              EXSR      AKYOUT                                                      S0146
     C**********           Z-ADDWORK2     CNUML                                        S01465 CSD027
     C                   MOVE      WORK2         CNUML
     C                   MOVE      ' '           AKY(8)                                        S0146
     C                   END                                                                   S0146
     C                   END                                                                   S0146
      *                                                                   180044
     C                   ENDIF                                                                 18004
     C/COPY WNCPYSRC,LEH00471
1255 C**
1256 C**   PROCESS INTEREST PORTION OF RECORD
1257 C**
1258 C                   Z-ADD     INTA          AMOUNT                   89
     C/COPY WNCPYSRC,LE0450C027
1259 C**N89*****           EXSR INTRST                                    180044
      *                                                                                       CLE028
      ** No repayment of interest for add on interest type of loan                            CLE028
      ** as the interest payment already included in principal                                CLE028
      ** payment                                                                              CLE028
      *                                                                                       CLE028
     C                   MOVE      *OFF          *IN77
     C                   MOVE      *BLANK        WEARLY
     C     CLE028        IFEQ      'Y'
     C     PTYP          ANDEQ     80
     C     ADIF          IFEQ      'Y'
     C                   MOVE      *ON           *IN77
      *                                                                                       CLE028
      ** If rebate amount for loan processing type is not                                     CLE028
      ** zero, generate rebate account key for interest                                       CLE028
      *                                                                                       CLE028
     C     REBT          IFNE      *ZERO
      *                                                                                       CLE028
      ** If the principal = 0, the early maturity flat rate loan has                          CLE028
      ** gone past due and has been repaid thru manual repayment.                             CLE028
      ** thus, the rebate A/C key has already been generated and                              CLE028
      ** do not need to generate again.                                                       CLE028
      *                                                                                       CLE028
     C     PRAM          ANDNE     *ZERO
     C                   Z-ADD     REBT          ACAMNT
     C                   MOVE      'R'           AKY(3)
     C                   MOVEA     BKAKY         AKY(6)
     C                   MOVE      'E'           AKY(10)
     C                   EXSR      AKYOUT
     C                   MOVE      'Y'           WEARLY            1
     C                   ENDIF
     C                   ENDIF
      *                                                                                       CLE028
      ** If charge amount for loan processing type is not                                     CLE028
      ** zero, generate charge refund account key                                             CLE028
      *                                                                                       CLE028
     C     ADCF          IFEQ      'Y'
     C     CHDU          IFNE      *ZERO
      *                                                                                       CLE028
      ** If the principal = 0, the early maturity flat rate loan has                          CLE028
      ** gone psat due and has been repaid thru manual repayment.                             CLE028
      ** thus, the rebate A/C key has already been generated and                              CLE028
      ** do not need to generate again.                                                       CLE028
      *                                                                                       CLE028
     C     PRAM          ANDNE     *ZERO
     C                   Z-ADD     CHDU          ACAMNT
     C                   MOVE      'R'           AKY(3)
     C                   MOVEA     BKAKY         AKY(6)
     C                   MOVE      'H'           AKY(9)
     C                   MOVE      'E'           AKY(10)
     C                   EXSR      AKYOUT
     C                   MOVE      'Y'           WEARLY
     C                   ENDIF
     C                   ENDIF
     C                   ENDIF
     C     *IN89         IFEQ      '0'                                                         18004
     C     *IN15         ANDEQ     '0'                                                         18004
     C                   EXSR      INTRST                                                      18004
     C                   ENDIF                                                                 18004
      *                                                                   CLE005
      ** Generate the past due A/C key for CLE005 as a reversal if        CLE005
      ** matched to PD record is set to 'Y'                               CLE005
      *                                                                   CLE005
     C     CLE005        IFEQ      'Y'                                                         CLE00
     C     MTPD          ANDEQ     'Y'                                                         CLE00
     C     INTA          ANDNE     *ZEROS                                                      CLE00
     C     CLE005        OREQ      'Y'                                                         18004
     C     INTA          ANDNE     *ZEROS                                                      18004
     C     *IN15         ANDEQ     '1'                                                         18004
     C                   Z-ADD     INTA          ACAMNT                                        15821
     C                   MOVE      'P'           AKY(3)                                        CLE00
     C                   MOVEA     '    '        AKY(6)                                        CLE00
     C                   MOVE      'I'           AKY(10)                                       CLE00
     C                   MOVE      '1'           *IN21                                         CLE00
     C                   EXSR      AKYOUT                                                      CLE00
     C                   MOVE      '0'           *IN21                                         CLE00
      *                                                                   180044
     C     *IN15         IFEQ      '1'                                                         18004
     C     INTA          ANDNE     *ZEROS                                                      18004
     C     PDIN          SUB       INTA          PDIN                                          18004
     C     PDIN          IFLT      0                                                        AR628773
     C                   Z-ADD     0             PDIN                                       AR628773
     C                   ENDIF                                                              AR628773
     C                   ENDIF                                                                 18004
      *                                                                   180044
     C     CAS005        IFEQ      'Y'
     C     *IN15         ANDEQ     '1'
     C     INTN          ANDNE     *ZEROS
     C     PDNN          SUB       INTN          PDNN
     C                   ENDIF
      *                                                                                       CAS005
     C     CPAM          IFEQ      *ZEROS
     C     PDIN          ANDEQ     *ZEROS
     C     MDAT          ANDLE     RUND
     C     AUTOL         ANDNE     'C'                                                        CLE134
     C                   MOVE      'Y'           AUTOL
     C                   ENDIF
      *                                                                                       191069
     C                   ENDIF                                                                 CLE00
1260 C**
1261 C**   PROCESS FEE PORTION OF RECORD
1262 C**
     C     *IN15         IFEQ      '0'                                                         18004
      *                                                                   180044
1263 C                   Z-ADD     FEAM          ACAMNT                   89
1264 C                   MOVE      'R'           AKY(3)
1265 C                   MOVEA     BKAKY         AKY(6)
1266 C                   MOVEA     FECD          AKY(8)
1267 C                   MOVE      'F'           AKY(10)
      *                                                                                       CGL020
      ** If Midas Compliance Watch (CGL020) is installed, set Fee                             CGL020
      ** Flag = 'F', Fee Value = Fee Amount and Fee Percent = 100                             CGL020
      *                                                                                       CGL020
     C     CGL020        IFEQ      'Y'
     C                   MOVE      'F'           F1FFLG            1
     C                   Z-ADD     FEAM          F1FVAL           13 0
     C                   Z-ADD     100           F1FPCT            5 2
     C                   ENDIF
      *                                                                                       CGL020
1268 C  N89              EXSR      AKYOUT
1269 C**
1270 C**   UPDATE ACCUMULATIVE FEE AMOUNTS
1271 C**
1272 C     TFEP          ADD       FEAM          TFEP
1273 C     YTDFED        ADD       FEAM          YTDFED           13 0
1274 C**
1275 C**   GENERATE A/C KEY FOR TOTAL AMOUNT
1276 C**
1277 C                   Z-ADD     TAMT          ACAMNT                   89
1278 C                   MOVEA     BKAKY         AKY(6)
1279 C                   MOVE      'B'           AKY(10)
      *                                                                                       CLE034
      ** If CLE034 is installed                                                               CLE034
      *                                                                                       CLE034
     C     CLE034        IFEQ      'Y'
     C     STAL          ANDEQ     'Y'
     C     *IN89         ANDEQ     *OFF
     C     *IN85         ANDEQ     *OFF
     C                   EXSR      SR34A
     C                   ELSE
     C                   MOVE      'Y'           WRKFLD
     C                   MOVE      '*EOF   '     PRTCD
     C                   ENDIF
      *                                                                                       CLE034
     C     WRKFLD        DOWEQ     'Y'
     C     PRTCD         OREQ      *BLANKS
     C     CLE034        IFEQ      'Y'
     C     STAL          ANDEQ     'Y'
     C                   EXSR      SR34B
     C     *IN89         IFEQ      *OFF
     C     *IN85         ANDEQ     *OFF
     C                   EXSR      SETCCY
     C                   ENDIF
     C                   ELSE
      *                                                                                       CLE031
      ** If feature CLE031 is on and indicator 89 and indicator 85                            CLE031
      ** are both off then call SR/SECCY2                                                     CLE031
      *                                                                                       CLE031
     C     CLE031        IFEQ      'Y'
     C     *IN85         ANDEQ     *OFF
     C     *IN89         ANDEQ     *OFF
     C                   EXSR      SECCY2
     C                   ENDIF
     C                   ENDIF
      *                                                                                       CLE031
      ** WORIGA = Y: Original Loan Repayment must generate a/c key DP                         CLE134
      *                                                                                       CLE134
     C     WORIGA        IFNE      'Y'                                                        CLE134
     C     WMRAUT        ORNE      'Y'                                                      AR217244
     C  N89
1280 CANN85              EXSR      AKYOUT
     C                   ENDIF                                                                CLE134
      *                                                                                       CLE031
      ** If feature CLE031 is on and indicator 89 and indicator 85                            CLE031
      ** are both off then call SR/SETRST                                                     CLE031
      *                                                                                       CLE031
     C     CLE031        IFEQ      'Y'
     C     *IN85         ANDEQ     *OFF
     C     *IN89         ANDEQ     *OFF
     C                   EXSR      SETRST
     C                   ENDIF
      *                                                                                       CLE034
     C     CLE034        IFEQ      'Y'
     C     STAL          ANDEQ     'Y'
     C                   EXSR      SR34C
     C                   ELSE
     C                   MOVE      *BLANKS       WRKFLD
     C                   ENDIF
     C                   ENDDO
      *                                                                                       CLE034
     C     CLE034        IFEQ      'Y'
     C     STAL          ANDEQ     'Y'
     C                   EXSR      SR34E
     C                   ENDIF
1281 C**
1282 C**   UPDATE STORED VALUE OF SLID FOR OUTPUT TO LKEY1
1283 C**
1284 C                   Z-ADD     SLID          SLIDL
      *                                                                   CLE005
      ** Generate penalty account key for a penalty amount                CLE005
      *                                                                   CLE005
     C     CLE005        IFEQ      'Y'                                                         CLE00
     C     PNAM          ANDNE     *ZERO                                                       CLE00
     C                   MOVE      PNAM          ACAMNT                                        CLE00
     C***********          MOVE 'V'       AKY,3                    CLE005 151309
     C                   MOVE      'R'           AKY(3)                                        15130
     C                   MOVEA     '   '         AKY(6)                                        CLE00
     C                   MOVE      'P'           AKY(9)                                        CLE00
     C                   MOVE      'A'           AKY(10)                                       CLE00
      *                                                                                       CLE034
      ** If CLE034 is installed                                                               CLE034
      *                                                                                       CLE034
     C     CLE034        IFEQ      'Y'
     C     STAL          ANDEQ     'Y'
     C                   EXSR      SR34A
     C                   ELSE
     C                   MOVE      'Y'           WRKFLD
     C                   MOVE      '*EOF   '     PRTCD
     C                   ENDIF
      *                                                                                       CLE034
     C     WRKFLD        DOWEQ     'Y'
     C     PRTCD         OREQ      *BLANKS
     C     CLE034        IFEQ      'Y'
     C     STAL          ANDEQ     'Y'
     C                   EXSR      SR34B
     C                   EXSR      SETCCY
     C                   ELSE
      *                                                                                       CLE031
      ** If feature CLE031 is on call SR/SECCY2                                               CLE031
      *                                                                                       CLE031
     C     CLE031        IFEQ      'Y'
     C                   EXSR      SECCY2
     C                   ENDIF
     C                   ENDIF
      *                                                                                       CLE031
     C                   EXSR      AKYOUT                                                      CLE00
      *                                                                                       CLE031
      ** If feature CLE031 is on set work penalty to penalty and                              CLE031
      ** call SR/SETTLE then set work penalty to blanks                                       CLE031
      *                                                                                       CLE031
     C     CLE031        IFEQ      'Y'
     C     WCLE134       ANDEQ     ' '                                                      MD049078
     C                   MOVE      'P'           WPNLTY            1
     C                   EXSR      SETTLE
     C                   MOVE      *BLANKS       WPNLTY
     C                   ENDIF
      *                                                                                       CLE034
     C     CLE034        IFEQ      'Y'
     C     STAL          ANDEQ     'Y'
     C                   EXSR      SR34C
     C                   ELSE
     C                   MOVE      *BLANKS       WRKFLD
     C                   ENDIF
     C                   ENDDO
      *                                                                                       CLE034
     C     CLE034        IFEQ      'Y'
     C     STAL          ANDEQ     'Y'
     C                   EXSR      SR34E
     C                   ENDIF
      *                                                                   CLE005
      ** Generate PCA penalty account keys (transaction and funding       CLE005
      ** profit centres)                                                  CLE005
      *                                                                   CLE005
     C     BGN0ST        IFEQ      'Y'                                                         CLE00
     C     FPRCL         ANDNE     *BLANKS                                                     CLE00
     C                   MOVE      'T'           AKY(6)                                        CLE00
     C                   EXSR      AKYOUT                                                      CLE00
     C                   MOVE      'F'           AKY(6)                                        CLE00
     C                   MOVEL     PRFC          WPRFC                                         CLE00
     C                   MOVEL     FPRCL         PRFC                                          CLE00
     C                   EXSR      AKYOUT                                                      CLE00
     C                   MOVEL     WPRFC         PRFC                                          CLE00
     C                   ENDIF                                                                 CLE00
     C                   ENDIF                                                                 CLE00
1285 C**
1286 C                   SETOFF                                       85
1287 C**
1287 C**   IF DISCOUNTED LOAN IF ZERO CURRENT PRINCIPLE AND IF PAST
1287 C**   MATURITY DATE, THEN SET AUTOSETTLE TO YES
1287 C**
1287 C**N45****************GOTO*NODIS                                     E43546
1287 C**   CHECK IF NO INTEREST PAST DUE BEFORE SET AUTOSETTLE TO YES     E12011
1287 C**                                                                  E12011
1287 C     CPAM          COMP      0                                      89
1287 C   89PDIN          COMP      0                                      89                   E1201
1287 C   89MDAT          COMP      RUND                                 89
     C/COPY WNCPYSRC,LE0450C061
     C   89              MOVE      AUTOL         WAUTOL            1                          CLE134
1287 C   89              MOVE      'Y'           AUTOL
     C   89CLE134        IFEQ      'Y'                                                        CLE134
     C     WAUTOL        ANDEQ     'C'                                                        CLE134
     C                   MOVE      'C'           AUTOL                                        CLE134
     C                   ENDIF                                                                CLE134
     C/COPY WNCPYSRC,LE0450C062
1287 C     NODIS         TAG
      *                                                                   CLE005
      ** Re-activate a matured loan if past due and total manual          CLE005
      ** repayment is negative, for CLE005                                CLE005
      *                                                                   CLE005
     C     CLE005        IFEQ      'Y'                                                         CLE00
     C     PAST          ANDEQ     'Y'                                                         CLE00
     C     RECIL         ANDEQ     'M'                                                         CLE00
     C     TAMT          ANDLT     *ZERO                                                       CLE00
     C                   MOVE      'D'           RECIL                                         CLE00
     C                   ENDIF                                                                 CLE00
      *                                                                   180044
     C                   ENDIF                                                                 18004
      *                                                                                     AR317587
      ** For discounted loan, Z-ADD AITC to AITCL to have an accrued                        AR317587
      ** interest. Once CPAM is zero, Z-ADD the TOTI value to IPRD.                         AR317587
      *                                                                                     AR317587
     C     *IN45         IFEQ      '1'
     C                   Z-ADD     AITC          AITCL
     C     CPAM          IFEQ      *ZEROS
     C                   Z-ADD     TOTI          IPRD
     C                   ENDIF
     C                   ENDIF
     C     CLE005        IFEQ      'Y'                                                        263427
     C     PAST          ANDEQ     'Y'                                                        263427
     C     PDIN          SUB       INTA          PDIN                                         263427
     C     PDIN          IFLT      0                                                        AR628773
     C                   Z-ADD     0             PDIN                                       AR628773
     C                   ENDIF                                                              AR628773
     C                   ENDIF                                                                263427
1287 C**
     C/COPY WNCPYSRC,LE0450CP19                                           S01408
1288 C                   ENDSR
1289 C**
1290 C**
1291 C********************************************************************
1292 C********************************************************************
1293 C**
1294 C**   SUBROUTINE TO PROCESS INTEREST PAYMENT ACTIONS - INTPAY
1295 C**
1296 C**   CALLED FROM ACTNS
1297 C**   CALLS INTRST,AKYOUT,INDTUP
1298 C**
1299 C     INTPAY        BEGSR                                                  ***  INTPAY ***
1300 C**
1301 C**   PROCESS INTEREST AMOUNT                                        E47220
1302 C**
      *                                                                                       CLE134
      ** CLE134 - Past Due Call Loans process                                                 CLE134
      *                                                                                       CLE134
     C                   MOVE      'N'           WPDCLL                                       CLE134
     C                   MOVE      'N'           WPDCLA                                       CLE134
     C                   MOVE      'N'           WPDCLR                                       CLE134
     C                   MOVE      'N'           WORIGL                                       CLE134
     C                   MOVE      'N'           WORIGA                                       263416
     C                   MOVE      'N'           WMRAUT                                       CLE134
      *                                                                                       CLE134
      ** If AUTO = 'C', check whether the processed loan is a PDCL or                         CLE134
      ** an original loan by checking the 1st character of the loan                           CLE134
      ** type. If it is X, Y, Z then the loan is a Past Due Call Loan.                        CLE134
      *                                                                                       CLE134
     C     CLE134        IFEQ      'Y'                                                        CLE134
     C     AUTO          ANDEQ     'C'                                                        CLE134
     C     CLE134        OREQ      'Y'                                                        CLE134
     C     AUTOX         ANDEQ     'C'                                                        CLE134
     C                   MOVEL     LTYP          LTYP1A            1                          CLE134
     C     LTYP1A        IFEQ      'X'                                                        CLE134
     C     LTYP1A        OREQ      'Y'                                                        CLE134
     C     LTYP1A        OREQ      'Z'                                                        CLE134
     C                   MOVE      'Y'           WPDCLL                                       CLE134
     C                   ELSE                                                                 CLE134
     C                   MOVE      'Y'           WORIGL                                       CLE134
     C                   ENDIF                                                                CLE134
     C                   ENDIF                                                                CLE134
      *                                                                                       CLE134
      ** If Original Loan repayment, check whether a PDCL has been                            CLE134
      ** generated today in I/C with field "Decrease" (YDECRE) = 'Y'.                         CLE134
      ** If it has, then the Original Loan manual repayment event                             CLE134
      ** generates a new account keys                                                         CLE134
      *                                                                                       CLE134
     C     NEWCOB        IFNE      'Y'                                                        CLE134
     C     WORIGL        ANDEQ     'Y'                                                        CLE134
     C     KPDCL         CHAIN     LEPDUEL2                           24                      CLE134
      *                                                                                       CLE134
      * If record found, check whether it has been created today                              CLE134
      * and whether field YDECRE is Y                                                         CLE134
      *                                                                                       CLE134
     C     *IN24         IFEQ      *OFF                                                       CLE134
     C     YLCD          ANDEQ     RDNB                                                       CLE134
     C     YTYLC         ANDEQ     'I'                                                        CLE134
     C     YDECRE        ANDEQ     'Y'                                                        CLE134
     C                   MOVE      'Y'           WORIGA                                       CLE134
     C                   ENDIF                                                                CLE134
      *                                                                                       CLE134
     C                   ENDIF                                                                CLE134
      *                                                                                       CLE134
1303 C                   Z-ADD     INTA          AMOUNT                   89
     C   89VDAT          COMP      SLID                               87                       E4722
     C   89
     CAN 87              Z-ADD     VDAT          SLID                                          E4722
     C/COPY WNCPYSRC,LE0450C028
     C                   MOVE      *OFF          *IN77
1304 C  N89              EXSR      INTRST
1305 C**
1306 C**   GENERATE A/C KEY FOR TOTAL AMOUNT
1307 C**
1308 C                   Z-ADD     VDAT          ACDATE
1309 C                   Z-ADD     TAMT          ACAMNT                   89
1310 C                   MOVE      'R'           AKY(3)
1311 C                   MOVEA     BKAKY         AKY(6)
1312 C                   MOVE      'B'           AKY(10)
      *                                                                                       CLE034
      ** If CLE034 is installed                                                               CLE034
      *                                                                                       CLE034
     C     CLE034        IFEQ      'Y'
     C     STAL          ANDEQ     'Y'
     C     *IN89         ANDEQ     *OFF
     C                   EXSR      SR34A
     C                   ELSE
     C                   MOVE      'Y'           WRKFLD
     C                   MOVE      '*EOF   '     PRTCD
     C                   ENDIF
      *                                                                                       CLE034
     C     WRKFLD        DOWEQ     'Y'
     C     PRTCD         OREQ      *BLANKS
     C     CLE034        IFEQ      'Y'
     C     STAL          ANDEQ     'Y'
     C                   EXSR      SR34B
     C     *IN89         IFEQ      *OFF
     C                   EXSR      SETCCY
     C                   ENDIF
     C                   ELSE
      **********                                                                       CLE031 218782
      ***If*feature*CLE031*is*on*and*indicator*89*is*off*call*SR/SECCY2*               CLE031 218782
      **********                                                                       CLE031 218782
     C********** CLE031    IFEQ 'Y'                                                    CLE031 218782
     C********** *IN89     ANDEQ*OFF                                                   CLE031 218782
     C**********           EXSR SECCY2                                                 CLE031 218782
      *                                                                                       CLE031
     C**********           MOVE OSAC      OSACSV 12                                    CLE031 CGL029
     C                   MOVE      OSAC          OSACSV
     C                   MOVE      SETP          SETPSV            2 0
      *                                                                                       CLE031
     C     PTYP          IFNE      66
     C     PTYP          ANDNE     67
     C     PTYP          ANDNE     69
     C     PTYP          ANDNE     72
     C                   MOVE      RONS          OSAC
     C                   MOVE      RSTM          SETP
     C                   ELSE
     C                   MOVE      PONS          OSAC
     C                   MOVE      PSTM          SETP
     C                   ENDIF
      *                                                                                       218782
      ** If feature CLE031 is on and indicator 89 is off call SR/SECCY2                       218782
      *                                                                                       218782
     C     CLE031        IFEQ      'Y'
     C     *IN89         ANDEQ     *OFF
     C                   EXSR      SECCY2
     C                   ENDIF
     C                   ENDIF
      *                                                                                       CLE031
     C**********           ENDIF                                                       CLE031 218782
      *                                                                                       CLE031
     C     WORIGA        IFNE      'Y'                                                        CLE134
1313 C  N89              EXSR      AKYOUT
     C                   ENDIF                                                                CLE134
      *                                                                                       CLE031
      ** If feature CLE031 is on and indicator 89 is off call SR/SETRST                       CLE031
      *                                                                                       CLE031
     C     CLE031        IFEQ      'Y'
     C     *IN89         ANDEQ     *OFF
     C                   MOVE      OSACSV        OSAC
     C                   MOVE      SETPSV        SETP
     C                   EXSR      SETRST
     C                   ENDIF
      *                                                                                       CLE034
     C     CLE034        IFEQ      'Y'
     C     STAL          ANDEQ     'Y'
     C                   EXSR      SR34C
     C                   ELSE
     C                   MOVE      *BLANKS       WRKFLD
     C                   ENDIF
     C                   ENDDO
      *                                                                                       CLE034
     C     CLE034        IFEQ      'Y'
     C     STAL          ANDEQ     'Y'
     C                   EXSR      SR34E
     C                   ENDIF
1314 C**
1315 C**   UPDATE PAY DATE AND INDS
1316 C**
      * Do not update Next Interest Payment Date if this 'IN' event was   160625
      * only due to a Multi-ccy Rollover (NIDT not yet reached)           160625
      ** BUT if NIDT is in the future yet it is being actioned today                          191755
      ** and the Rollover Date is not today, update NIDT.                                     191755
     C     NIDT          IFLE      RUND                                         If its NIDT,   16062
     C     NIDT          ORGT      RUND
     C     RLDT          ANDNE     RUND
     C/COPY WNCPYSRC,LE0450C029
1317 C                   EXSR      INDTUP
     C                   ENDIF                                                  End            16062
1318 C**
1319 C                   Z-ADD     SLID          SLIDL
1320 C**
     C/COPY WNCPYSRC,LE0450CP23                                           S01408
1321 C                   ENDSR
1322 C**
1323 C**
1324 C********************************************************************
1325 C********************************************************************
1326 C**
1327 C**   SUBROUTINE TO PROCESS REPAYMENT SCHEDULE ACTIONS - REPSCD
1328 C**
1329 C**   CALLED FROM ACTNS
1330 C*****CALLS CPAMUP,AKYOUT(2),INTRST,RPDTUP                                               CLE031
1330 C**   CALLS CPAMUP,AKYOUT(2),INTRST,RPDTUP,SETCCY,SETTLE,SECCY2                          CLE031
1330 C**         SETRST                                                                       CLE031
1331 C**
1332 C     REPSCD        BEGSR                                                  ***  REPSCD ***
1333 C**
      *                                                                                       CLE134
      ** CLE134 - Past Due Call Loans process                                                 CLE134
      *                                                                                       CLE134
     C                   MOVE      'N'           WPDCLL                                       CLE134
     C                   MOVE      'N'           WPDCLA                                       CLE134
     C                   MOVE      'N'           WPDCLR                                       CLE134
     C                   MOVE      'N'           WORIGL                                       CLE134
     C                   MOVE      'N'           WORIGA                                       CLE134
     C                   MOVE      'N'           WMRAUT                                       263416
                                                                                            AR786878
      ** Check if record is a Past Due Call loan (i.e. X, Y or Z).                          AR786878
                                                                                            AR786878
     C     CLE134        IFEQ      'Y'                                                      AR786878
     C     AUTO          ANDEQ     'C'                                                      AR786878
     C     CLE134        OREQ      'Y'                                                      AR786878
     C     AUTOX         ANDEQ     'C'                                                      AR786878
     C     CLE134        OREQ      'Y'                                                      AR786878
     C     AUTOL         ANDEQ     'C'                                                      AR786878
     C                   MOVEL     LTYP          LTYP1A                                     AR786878
     C                   EVAL      WCLE134 = 'Y'                                            MD049078
     C     LTYP1A        IFEQ      'X'                                                      AR786878
     C     LTYP1A        OREQ      'Y'                                                      AR786878
     C     LTYP1A        OREQ      'Z'                                                      AR786878
     C                   MOVE      'Y'           WPDCLL                                     AR786878
     C                   ELSE                                                               AR786878
     C                   MOVE      'Y'           WORIGL                                     AR786878
     C                   ENDIF                                                              AR786878
     C                   ENDIF                                                              AR786878
      *                                                                                       CLE134
1334 C**   UPDATE CURRENT PRINCIPAL AMOUNT
1335 C**
     C                   SETON                                        83
     C                   Z-ADD     CPAM          ACRBAL
1336 C                   Z-SUB     PRAM          AMOUNT
1337 C                   EXSR      CPAMUP
      *                                                                   145393
      ** If feature CEU004 is on, set currency field on LKEY1DP           145393
      ** if settlement currency from the ACTN is not blank.               145393
      *                                                                   145393
     C     CEU004        IFEQ      'Y'                                          If Feature On  14539
      *                                                                   145393
     C     SCCYA         IFNE      *BLANKS                                       If SetCcy # Bl14539
     C                   MOVE      SCCYA         LKSCCY                           Set Outpt Ccy14539
     C                   ELSE                                                    Else
     C                   MOVE      *BLANKS       LKSCCY                          Clr Outpt Ccy
     C                   ENDIF                                                   End If        14539
      *                                                                   145393
     C                   ENDIF                                                   End If        14539
1338 C**
1339 C**   GENERATE AN A/C KEY FOR PRINCIPAL REPAYMENT
1340 C**
1341 C                   Z-ADD     VDAT          ACDATE
1342 C                   Z-ADD     PRAM          ACAMNT                   89
      *                                                                   CEU020
      ** Generate the decrease in amount in old ccy for mccy rollover     CEU020
      *                                                                   CEU020
     C     CEU020        IFEQ      'Y'                                                         CEU02
     C     ECIN          ANDEQ     'Y'                                                         CEU02
     C                   MOVE      'V'           AKY(3)                                        CEU02
     C                   MOVEA     BKAKY         AKY(6)                                        CEU02
     C                   MOVEA     'DA'          AKY(9)                                        CEU02
     C     ACAMNT        IFNE      *ZEROS                                                      CEU02
      *                                                                                       CLE034
      ** If CLE034 is installed                                                               CLE034
      *                                                                                       CLE034
     C     CLE034        IFEQ      'Y'
     C     STAL          ANDEQ     'Y'
     C     *IN89         ANDEQ     *OFF
     C                   MOVE      'S'           WTYPE
     C                   EXSR      SR34A
     C                   ELSE
     C                   MOVE      'Y'           WRKFLD
     C                   MOVE      '*EOF   '     PRTCD
     C                   ENDIF
      *                                                                                       CLE034
     C     WRKFLD        DOWEQ     'Y'
     C     PRTCD         OREQ      *BLANKS
     C     CLE034        IFEQ      'Y'
     C     STAL          ANDEQ     'Y'
     C                   EXSR      SR34B
     C                   ENDIF
      *                                                                                       CLE031
      ** If feature CLE031 is on set work type to start & call SR/SETCCY                      CLE031
      *                                                                                       CLE031
     C     CLE031        IFEQ      'Y'
     C                   MOVE      'S'           WTYPE
     C                   EXSR      SETCCY
     C                   ENDIF
      *                                                                                       CLE031
     C                   EXSR      AKYOUT                                                      CEU02
      *                                                                                       CLE031
      ** If feature CLE031 is on call SR/SETTLE                                               CLE031
      *                                                                                       CLE031
     C     CLE031        IFEQ      'Y'
     C     WCLE134       ANDEQ     ' '                                                      MD049078
     C                   EXSR      SETTLE
     C                   ENDIF
      *                                                                                       CLE034
     C     CLE034        IFEQ      'Y'
     C     STAL          ANDEQ     'Y'
     C                   EXSR      SR34C
     C                   ELSE
     C                   MOVE      *BLANKS       WRKFLD
     C                   ENDIF
     C                   ENDDO
      *                                                                                       CLE034
     C     CLE034        IFEQ      'Y'
     C     STAL          ANDEQ     'Y'
     C                   EXSR      SR34E
     C                   ENDIF
      *                                                                                       CLE031
     C                   ENDIF                                                                 CEU02
      *                                                                   CEU020
      ** Generate the amount rolled over from the old currency            CEU020
      *                                                                   CEU020
     C                   MOVE      'R'           AKY(3)                                        CEU02
     C                   MOVEA     BKAKY         AKY(6)                                        CEU02
     C                   MOVE      'R'           AKY(10)                                       CEU02
     C     ACAMNT        IFNE      *ZEROS                                                      CEU02
     C                   EXSR      AKYOUT                                                      CEU02
     C                   ENDIF                                                                 CEU02
     C                   MOVE      'A'           AKY(10)                                       CEU02
      *                                                                   189035
      ** Indicator for 'MC' repayment                                     189035
      *                                                                   189035
     C     RBDT          IFGT      RDNB                                                        18903
     C                   MOVE      'Y'           NNRPD             1                           18903
     C                   END                                                                   18903
      *                                                                   CEU020
      ** Not a repayment for multi-ccy rollover                           CEU020
      *                                                                   CEU020
     C                   ELSE                                                                  CEU02
1343 C                   MOVE      'R'           AKY(3)
1344 C                   MOVEA     BKAKY         AKY(6)
1345 C                   MOVE      'A'           AKY(10)
      *                                                                                       CLE034
      ** If CLE034 is installed                                                               CLE034
      *                                                                                       CLE034
     C     CLE034        IFEQ      'Y'
     C     STAL          ANDEQ     'Y'
     C     *IN89         ANDEQ     *OFF
     C                   MOVE      'E'           WTYPE
     C                   EXSR      SR34A
     C                   ELSE
     C                   MOVE      'Y'           WRKFLD
     C                   MOVE      '*EOF   '     PRTCD
     C                   ENDIF
      *                                                                                       CLE034
     C     WRKFLD        DOWEQ     'Y'
     C     PRTCD         OREQ      *BLANKS
     C     CLE034        IFEQ      'Y'
     C     STAL          ANDEQ     'Y'
     C                   EXSR      SR34B
     C                   ENDIF
      *                                                                                       CLE031
      ** If feature CLE031 is on and indicator 89 is off then set                             CLE031
      ** work type to 'end' and call SR/SETCCY                                                CLE031
      *                                                                                       CLE031
     C     CLE031        IFEQ      'Y'
     C     *IN89         ANDEQ     *OFF
     C                   MOVE      'E'           WTYPE
     C                   EXSR      SETCCY
      *                                                                                       CLE031
     C**********           MOVE OSAC      OSACSV 12                                    CLE031 CGL029
     C                   MOVE      OSAC          OSACSV
     C                   MOVE      SETP          SETPSV            2 0
      *                                                                                       CLE031
     C     PTYP          IFNE      66
     C     PTYP          ANDNE     67
     C     PTYP          ANDNE     69
     C     PTYP          ANDNE     72
     C                   MOVE      RONS          OSAC
     C                   MOVE      RSTM          SETP
     C                   ELSE
     C                   MOVE      PONS          OSAC
     C                   MOVE      PSTM          SETP
     C                   ENDIF
      *                                                                                       CLE031
     C                   ENDIF
      *                                                                                       CLE031
1346 C  N89              EXSR      AKYOUT
      *                                                                                       CLE031
      ** If feature CLE031 is on and indicator 89 is off then                                 CLE031
      ** call SR/SETTLE                                                                       CLE031
      *                                                                                       CLE031
     C     CLE031        IFEQ      'Y'
     C     *IN89         ANDEQ     *OFF
     C     WCLE134       ANDEQ     ' '                                                      MD049078
     C                   MOVE      OSACSV        OSAC
     C                   MOVE      SETPSV        SETP
     C                   EXSR      SETTLE
     C                   ENDIF
      *                                                                                       CLE031
     C     CLE034        IFEQ      'Y'
     C     STAL          ANDEQ     'Y'
     C                   EXSR      SR34C
     C                   ELSE
     C                   MOVE      *BLANKS       WRKFLD
     C                   ENDIF
     C                   ENDDO
      *                                                                                       CLE034
     C     CLE034        IFEQ      'Y'
     C     STAL          ANDEQ     'Y'
     C                   EXSR      SR34E
     C                   ENDIF
      *                                                                                       CLE034
     C                   ENDIF                                                                 CEU02
      *                                                                   CAC001
      **  Generate Interest Payment Account Keys (Scheduled Repayments)   CAC001
      *                                                                   CAC001
     C     BGN0ST        IFEQ      'Y'                                                         CAC00
     C     FPRCL         ANDNE     *BLANKS                                                     CAC00
      *                                                                   CAC001
      **  Principal Repayment - Transaction Profit Centre                 CAC001
      *                                                                   CAC001
     C                   MOVEA     'T   '        AKY(6)                                        CAC00
     C     *IN89         IFEQ      '0'                                                         CAC00
     C                   EXSR      AKYOUT                                                      CAC00
     C                   ENDIF                                                                 CAC00
      *                                                                   CAC001
      **  Principal Repayment - Funding Profit Centre                     CAC001
      *                                                                   CAC001
     C                   MOVEA     'F   '        AKY(6)                                        CAC00
     C                   MOVEL     PRFC          WPRFC                                         CAC00
     C                   MOVEL     FPRCL         PRFC                                          CAC00
     C     *IN89         IFEQ      '0'                                                         CAC00
     C                   EXSR      AKYOUT                                                      CAC00
     C                   ENDIF                                                                 CAC00
     C                   MOVEL     WPRFC         PRFC                                          CAC00
     C                   MOVEA     BKAKY         AKY(6)                                        CAC00
      *                                                                   CAC001
     C                   ENDIF                                                                 CAC00
     C*                                                                   S01465
     C**  Account key generated with 'R' in AKY (in position 8) if        S01465
     C**  the receiver of guarantee is different to blanks                S01465
     C*                                                                   S01465
     C     *IN26         IFEQ      '1'                                                         S0146
     C     WORECE        IFNE      *BLANKS                                                     S0146
     C**********           Z-ADDCNUML     WORK2                                        S01465 CSD027
     C                   MOVE      CNUML         WORK2
     C                   MOVE      WORECE        CNUML                                         S0146
     C                   MOVE      'R'           AKY(8)                                        S0146
     C  N89              EXSR      AKYOUT                                                      S0146
     C**********           Z-ADDWORK2     CNUML                                        S01465 CSD027
     C                   MOVE      WORK2         CNUML
     C                   MOVE      ' '           AKY(8)                                        S0146
     C                   END                                                                   S0146
     C                   END                                                                   S0146
      *                                                                   165977
      ** Generate maturity keys if repayment is for a discount loan       165977
      ** and used for a multi-ccy rollover                                165977
      *                                                                   165977
     C     *IN45         IFEQ      *ON                                                         16597
     C     RLCY          ANDNE     *BLANKS                                                     16597
     C     ECIN          ANDEQ     'N'                                                         16597
      *                                                                   165977
     C     TOTI          ADD       AITCL         ACAMNT                                        16597
     C     ACAMNT        SUB       AIPD          ACAMNT                                        16597
     C                   Z-ADD     ACAMNT        XACMT                                         16597
     C     CAS005        IFEQ      'Y'
     C     TOTN          ADD       AITNL         WACMNT           13 0
     C     WACMNT        SUB       AIPN          WACMNT
     C                   Z-ADD     WACMNT        XACMTN           13 0
     C                   ENDIF
     C                   MOVE      'A'           AKY(3)                                        16597
     C                   MOVE      BKAKY         AKY(6)                                        16597
     C     ACAMNT        IFGT      0                                                           16597
     C                   MOVE      'D'           AKY(10)                                       16597
     C                   ELSE                                                                  16597
     C                   MOVE      'P'           AKY(10)                                       16597
     C                   Z-SUB     ACAMNT        ACAMNT                                        16597
     C                   ENDIF                                                                 16597
     C                   MOVE      *ON           *IN65                                         16597
     C     ACAMNT        IFNE      0                                                           16597
      *                                                                                       CAS009
      ** If CAS009 is enabled, generate discount amount a/c keys only if                      CAS009
      ** the hedging amortisation method is not 'N' (non-linear).                             CAS009
      *                                                                                       CAS009
     C     CAS009        IFEQ      'Y'
      *                                                                                       232348
      ** Only process EIR cost accounting if loan's value date is same                        232348
      ** as or after the non-linear amortisation cut-off date                                 232348
     C     VDAT          ANDGE     FSNLAC
      *                                                                                       232348
     C                   EXSR      SRRTVI
     C                   ENDIF
     C     CAS009        IFEQ      'Y'
     C     *IN45         ANDEQ     '1'
     C     FSAMRM        ANDEQ     'N'
     C     AYACAI        ANDEQ     'Y'
      *                                                                                       232348
      ** Only process EIR cost accounting if loan's value date is same                        232348
      ** as or after the non-linear amortisation cut-off date                                 232348
     C     VDAT          ANDGE     FSNLAC
      *                                                                                       CAS009
      ** Suppress Linear Amortisation for Discount Loans when                                 CAS009
      ** the Amortisation Method is 'N'on-Linear.                                             CAS009
      *                                                                                       CAS009
     C                   ELSE
     C                   EXSR      AKYOUT                                                      16597
     C                   ENDIF
      *                                                                                       CAS009
     C                   ENDIF                                                                 16597
     C                   MOVE      *OFF          *IN65                                         16597
      *                                                                   165977
      ** Total amount for settlement                                      165977
      *                                                                   165977
     C                   Z-ADD     PRAM          ACAMNT                                        16597
     C                   MOVE      'R'           AKY(3)                                        16597
     C                   MOVEA     BKAKY         AKY(6)                                        16597
     C                   MOVE      'B'           AKY(10)                                       16597
     C     ACAMNT        IFNE      0                                                           16597
      *                                                                                       CLE034
      ** If CLE034 is installed                                                               CLE034
      *                                                                                       CLE034
     C     CLE034        IFEQ      'Y'
     C     STAL          ANDEQ     'Y'
     C     WTYPE         IFEQ      'S'
     C                   MOVE      'E'           WTYPE
     C**********           MOVE 'Y'       WCHGD   1                                    CLE034 219141
     C                   ENDIF
     C                   EXSR      SR34A
     C**********           ENDIF                                                       CLE034 219141
     C********** WCHGD     IFEQ 'Y'                                                    CLE034 219141
     C**********           MOVE 'S'       WTYPE                                        CLE034 219141
     C**********           MOVE ' '       WCHGD                                        CLE034 219141
     C**********           ENDIF                                                       CLE034 219141
     C                   ELSE
     C                   MOVE      'Y'           WRKFLD
     C                   MOVE      '*EOF   '     PRTCD
     C                   ENDIF
      *                                                                                       CLE034
     C     WRKFLD        DOWEQ     'Y'
     C     PRTCD         OREQ      *BLANKS
     C     CLE034        IFEQ      'Y'
     C     STAL          ANDEQ     'Y'
     C                   EXSR      SR34B
     C                   EXSR      SETCCY
     C                   ELSE
      *                                                                                       CLE031
      ** If feature CLE031 is on                                                              CLE031
      *                                                                                       CLE031
     C     CLE031        IFEQ      'Y'
      *                                                                                       CLE031
      ** If work type is 'start' set work type to 'end' & call SR/SETCCY                      CLE031
      ** Else call SR/SECCY2                                                                  CLE031
      *                                                                                       CLE031
     C     WTYPE         IFEQ      'S'
     C                   MOVE      'E'           WTYPE
     C                   EXSR      SETCCY
     C                   ELSE
     C**********           EXSR SECCY2                                                 CLE031 218782
      *                                                                                       CLE031
     C**********           MOVE OSAC      OSACSV 12                                    CLE031 CGL029
     C                   MOVE      OSAC          OSACSV
     C                   MOVE      SETP          SETPSV            2 0
      *                                                                                       CLE031
     C     PTYP          IFNE      66
     C     PTYP          ANDNE     67
     C     PTYP          ANDNE     69
     C     PTYP          ANDNE     72
     C                   MOVE      RONS          OSAC
     C                   MOVE      RSTM          SETP
     C                   ELSE
     C                   MOVE      PONS          OSAC
     C                   MOVE      PSTM          SETP
     C                   ENDIF
      *                                                                                       218782
     C                   EXSR      SECCY2
      *                                                                                       CLE031
     C                   ENDIF
      *                                                                                       CLE031
     C                   ENDIF
      *                                                                                       CLE034
     C                   ENDIF
      *                                                                                       CLE031
     C                   EXSR      AKYOUT                                                      16597
      *                                                                                       CLE031
      ** If feature CLE031 is on call SR/SETRST                                               CLE031
      *                                                                                       CLE031
     C     CLE031        IFEQ      'Y'
     C                   MOVE      OSACSV        OSAC
     C                   MOVE      SETPSV        SETP
     C                   EXSR      SETRST
     C                   ENDIF
      *                                                                                       CLE031
     C     CLE034        IFEQ      'Y'
     C     STAL          ANDEQ     'Y'
     C                   EXSR      SR34C
     C                   ELSE
     C                   MOVE      *BLANKS       WRKFLD
     C                   ENDIF
     C                   ENDDO
      *                                                                                       CLE034
     C     CLE034        IFEQ      'Y'
     C     STAL          ANDEQ     'Y'
     C                   EXSR      SR34E
     C                   ENDIF
      *                                                                                       CLE034
     C                   ENDIF                                                                 16597
      *                                                                   165977
     C                   ELSE                                                                  16597
1347 C**
1348 C**   PROCESS INTEREST PORTION OF RECORD
1349 C**
1350 C                   Z-ADD     INTA          AMOUNT                   89
     C**                                                                  E47220
     C**  UPDATE LAST INTEREST DATE FOR REPAYMENT TYPE 1 & 3              E47220
     C**  WHEN INTA = 0                                                   E47220
     C**                                                                  E47220
     C   89REPT          COMP      1                                      87                   E4722
     C   89
     CANN87REPT          COMP      3                                      87                   E4722
     C   89
     CAN 87VDAT          COMP      SLID                               87                       E4722
     C   89
     CAN 87              Z-ADD     VDAT          SLID                                          E4722
      *                                                                                       CLE028
      ** No repayment of interest for add on interest type of loan                            CLE028
      ** as the interest payment already included in principal                                CLE028
      ** payment                                                                              CLE028
      *                                                                                       CLE028
     C                   MOVE      *OFF          *IN77
     C     CLE028        IFEQ      'Y'
     C     PTYP          ANDEQ     80
     C     ADIF          IFEQ      'Y'
     C                   MOVE      *ON           *IN77
     C                   ENDIF
      *                                                                                       CLE028
      ** Accrue charges due for the period                                                    CLE028
      *                                                                                       CLE028
     C     ADCF          IFEQ      'Y'
     C                   ADD       CHDU          WCHDU            13 0
     C                   ADD       CHDU          WACCH
     C                   ENDIF
     C                   ENDIF
     C**                                                                  E47220
1351 C  N89              EXSR      INTRST
1352 C**
1353 C**   GENERATE A/C KEY FOR TOTAL AMOUNT
1354 C**
     C     CEU020        IFEQ      'N'                                                         CEU02
     C     CEU020        OREQ      'Y'                                                         CEU02
     C     ECIN          ANDNE     'Y'                                                         CEU02
1355 C                   Z-ADD     TAMT          ACAMNT                   89
1356 C                   MOVE      'R'           AKY(3)
1357 C                   MOVEA     BKAKY         AKY(6)
1358 C                   MOVE      'B'           AKY(10)
      *                                                                                       CLE034
      ** If CLE034 is installed                                                               CLE034
      *                                                                                       CLE034
     C     CLE034        IFEQ      'Y'
     C     STAL          ANDEQ     'Y'
     C     WTYPE         IFEQ      'S'
     C                   MOVE      'E'           WTYPE
     C**********           MOVE 'Y'       WCHGD   1                                    CLE034 219141
     C                   ENDIF
     C                   EXSR      SR34A
     C**********           ENDIF                                                       CLE034 219141
     C********** WCHGD     IFEQ 'Y'                                                    CLE034 219141
     C**********           MOVE 'S'       WTYPE                                        CLE034 219141
     C**********           MOVE ' '       WCHGD                                        CLE034 219141
     C**********           ENDIF                                                       CLE034 219141
     C                   ELSE
     C                   MOVE      'Y'           WRKFLD
     C                   MOVE      '*EOF   '     PRTCD
     C                   ENDIF
      *                                                                                       CLE034
     C     WRKFLD        DOWEQ     'Y'
     C     PRTCD         OREQ      *BLANKS
     C     CLE034        IFEQ      'Y'
     C     STAL          ANDEQ     'Y'
     C                   EXSR      SR34B
     C                   EXSR      SETCCY
     C                   ELSE
      *                                                                                       CLE031
      ** If feature CLE031 is on...                                                           CLE031
      *                                                                                       CLE031
     C     CLE031        IFEQ      'Y'
      **********                                                                       CLE031 218782
      ***If*work*type*is*start*set*work*type*to*end*and*goto*SR/SETCCY**               CLE031 218782
      ***Else*goto*SR/SECCY2*********************************************              CLE031 218782
      **********                                                                       CLE031 218782
     C********** WTYPE     IFEQ 'S'                                                    CLE031 218782
     C**********           MOVE 'E'       WTYPE                                        CLE031 218782
     C**********           EXSR SETCCY                                                 CLE031 218782
     C**********           ELSE                                                        CLE031 218782
     C**********           EXSR SECCY2                                                 CLE031 218782
     C**********           ENDIF                                                       CLE031 218782
      *                                                                                       CLE031
     C**********           MOVE OSAC      OSACSV 12                                    CLE031 CGL029
     C                   MOVE      OSAC          OSACSV
     C                   MOVE      SETP          SETPSV            2 0
      *                                                                                       CLE031
     C     PTYP          IFNE      66
     C     PTYP          ANDNE     67
     C     PTYP          ANDNE     69
     C     PTYP          ANDNE     72
     C                   MOVE      RONS          OSAC
     C                   MOVE      RSTM          SETP
     C                   ELSE
     C                   MOVE      PONS          OSAC
     C                   MOVE      PSTM          SETP
     C                   ENDIF
      *                                                                                       CLE031
      ** If work type is start set work type to end and goto SR/SETCCY                        218782
      ** Else goto SR/SECCY2                                                                  218782
      *                                                                                       218782
     C     WTYPE         IFEQ      'S'
     C                   MOVE      'E'           WTYPE
     C                   EXSR      SETCCY
     C                   ELSE
     C                   EXSR      SECCY2
     C                   ENDIF
      *                                                                                       CLE031
     C                   ENDIF
     C                   ENDIF
      *                                                                                       CLE031
1359 C  N89              EXSR      AKYOUT
      *                                                                                       CLE031
      ** If feature CLE031 is on goto SR/SETRST                                               CLE031
      *                                                                                       CLE031
     C     CLE031        IFEQ      'Y'
     C                   MOVE      OSACSV        OSAC
     C                   MOVE      SETPSV        SETP
     C                   EXSR      SETRST
     C                   ENDIF
      *                                                                                       CLE031
     C     CLE034        IFEQ      'Y'
     C     STAL          ANDEQ     'Y'
     C                   EXSR      SR34C
     C                   ELSE
     C                   MOVE      *BLANKS       WRKFLD
     C                   ENDIF
     C                   ENDDO
      *                                                                                       CLE034
     C     CLE034        IFEQ      'Y'
     C     STAL          ANDEQ     'Y'
     C                   EXSR      SR34E
     C                   ENDIF
      *                                                                                       CLE034
     C                   ENDIF                                                                CEU020
      *                                                                                       199197
      ** If the repayment type is not 2 and this is an MC rollover,                           199197
      ** need to output total key, but for interest amount only.                              199197
      *                                                                                       199197
     C     CEU020        IFEQ      'Y'
     C     ECIN          ANDEQ     'Y'
     C     REPT          ANDNE     2
     C     CEU020        OREQ      'Y'                                                        CLE154
     C     ECIN          ANDEQ     'Y'                                                        CLE154
     C     REPT          ANDEQ     2                                                          CLE154
     C     INTA          ANDNE     *ZERO                                                      CLE154
     C     CLE154        ANDEQ     'Y'                                                        CLE154
     C                   Z-ADD     INTA          ACAMNT                   89
     C                   MOVE      'R'           AKY(3)
     C                   MOVEA     BKAKY         AKY(6)
     C                   MOVE      'B'           AKY(10)
     C  N89              EXSR      AKYOUT
     C                   ENDIF
      *                                                                                       199197
     C                   ENDIF                                                                 16597
1360 C**
1361 C**   UPDATE REPAY DATE AND INDS IF LOAN GENERATED
1362 C**
1363 C     LLAG          COMP      'L'                                    89
1364 C   89              EXSR      RPDTUP
1365 C**
1366 C**   UPDATE STORED VALUE OF SLID
1367 C**
1368 C                   Z-ADD     SLID          SLIDL
      *                                                                   189035
      ** Reset value of 'MC' indicator for repayment.                     189035
      *                                                                   189035
     C                   MOVE      *BLANK        NNRPD                                         18903
1369 C**
     C/COPY WNCPYSRC,LE0450CP20                                           S01408
      *                                                                                       CLE154
     C     CLE154        IFEQ      'Y'                                                        CLE154
     C                   Z-ADD     REPT          WWREPT                                       CLE154
     C                   END                                                                  CLE154
      *                                                                                       CLE154
1370 C                   ENDSR
1371 C**
1372 C**
1373 C********************************************************************
1374 C********************************************************************
1375 C**
1376 C**   SUBROUTINE TO PROCESS PAST DUE ACTIONS - PASTDU
1377 C**
1378 C**   CALLED FROM ACTNS
1379 C**   CALLS INDTUP,RPDTUP
1380 C**
1381 C     PASTDU        BEGSR                                                  ***  PASTOU ***
1382 C**
      *                                                                                       CLE134
      ** CLE134 - Past Due Call Loans process                                                 CLE134
      *                                                                                       CLE134
     C                   MOVE      'N'           WPDCLL                                       CLE134
     C                   MOVE      'N'           WPDCLA                                       CLE134
     C                   MOVE      'N'           WPDCLR                                       CLE134
     C                   MOVE      'N'           WORIGL                                       CLE134
     C                   MOVE      'N'           WORIGA                                       CLE134
     C                   MOVE      'N'           WMRAUT                                       263416
      *                                                                                       CLE134
1383 C     LLAG          COMP      'L'                                    89
1384 C  N89              GOTO      PDINT
1385 C**
1386 C**   IF LOAN GENERATED UPDATE EITHER REPAYMENT,DATES
1387 C**   OR INTEREST DATES
1388 C**
1389 C     REPT          COMP      1                                      88
1390 C   88REPTL         COMP      2                                      88
     C/COPY WNCPYSRC,LE0450C030
1391 C   88              EXSR      INDTUP                                       INT.PAYMENT PD
     C/COPY WNCPYSRC,LE0450C031
1392 C  N88              EXSR      RPDTUP                                       REPAYMENT PD
     C/COPY WNCPYSRC,LE0450C032
1393 C**
1394 C**   UPDATE PAST DUE INTEREST FIELD ON LOAN 'A' RECORD
1395 C**
1396 C     PDINT         TAG                                                    ** PDINT TAG **
1397 C**
1398 C     PDIN          ADD       INTA          PDIN
1399 C   49PDIN          ADD       WTXA          PDIN
      *                                                                   CAC001
     C     BGN0ST        IFEQ      'Y'                                                         CAC00
     C     FPRCL         ANDNE     *BLANKS                                                     CAC00
     C                   ADD       COFA          PDCF                                          CAC00
     C                   ENDIF                                                                 CAC00
      *                                                                                       CAS005
     C     CAS005        IFEQ      'Y'
     C     PDNN          ADD       INTN          PDNN
     C     *IN49         IFEQ      *ON
     C     PDNN          ADD       WTXA          PDNN
     C                   ENDIF
     C                   ENDIF
      *                                                                                       CLE028
      ** Accrue charges due for the period                                                    CLE028
      *                                                                                       CLE028
     C     CLE028        IFEQ      'Y'
     C     PTYP          ANDEQ     80
     C     ADCF          IFEQ      'Y'
     C                   ADD       CHDU          WPDCH            13 0
     C                   ADD       CHDU          WACCH
     C                   ENDIF
      *                                                                                       CLE028
      ** Set an indicator to determine a past due payment                                     CLE028
      *                                                                                       CLE028
     C                   MOVE      'Y'           WPASTD            1
     C                   ELSE
     C                   MOVE      *BLANK        WPASTD
     C                   ENDIF
1400 C**
1401 C                   ENDSR
1402 C**
1403 C**
1404 C********************************************************************
1405 C********************************************************************
1406 C**
1407 C**   SUBROUTINE TO PROCESS SPREAD CHANGE ACTIONS - SPCHNG
1408 C**
1409 C**   CALLED FROM ACTNS
1410 C**   CALLS RATECH
1411 C**
1412 C     SPCHNG        BEGSR                                                  ***  SPCHNG ***
1413 C**
      ** CLE134 - Past Due Call Loans process                                                 CLE134
      *                                                                                       CLE134
     C                   MOVE      'N'           WPDCLL                                       CLE134
     C                   MOVE      'N'           WPDCLA                                       CLE134
     C                   MOVE      'N'           WPDCLR                                       CLE134
     C                   MOVE      'N'           WORIGL                                       CLE134
     C                   MOVE      'N'           WORIGA                                       CLE134
     C                   MOVE      'N'           WMRAUT                                       263416
      *                                                                                       CLE134
1414 C**   UPDATE WITH NEW SPREAD RATE AND CALC NEW EFF. RATE
1415 C**
     C     BGN0ST        IFEQ      'N'                                                         CAC00
     C     CDE002        ANDEQ     'N'
     C     CDE002        OREQ      'Y'
     C     IRCF          ANDEQ     'Y'
     C     BGN0ST        OREQ      'Y'                                                         CAC00
     C     IRCF          ANDEQ     'Y'                                                         CAC00
1416 C                   Z-ADD     RTSP          RTSPL
     C                   EXSR      NEWSRT
      *                                                                   116330
      **Get*latest*'sc'*'ro'*from*history.*************************116330 CLE004
      * Get latest 'sc' 'ro' 'mc' from history.                           CLE004
     C     CLE003        IFEQ      'Y'                                                         11633
     C     LNRF          SETGT     LEHISTL2                                                    11633
     C     LNRF          READPE    LEHISTL2                               69                   11633
     C     *IN69         DOWEQ     *OFF                                                        11633
     C     BGN0ST        IFEQ      'N'                                                         11633
     C     BGN0ST        OREQ      'Y'                                                         11633
     C     IRCF#H        ANDEQ     'Y'                                                         11633
     C                   Z-ADD     RTSP#H        RTSPL                                         11633
     C                   Z-ADD     VDAT#H        VDAT                                          11633
     C                   LEAVE                                                                 11633
     C                   ENDIF                                                                 11633
      *                                                                   116330
     C     LNRF          READPE    LEHISTL2                               69                   11633
     C                   ENDDO                                                                 11633
     C                   ENDIF                                                                 11633
      *                                                                   116330
1417 C                   EXSR      RATECH
     C                   ENDIF                                                                 CAC00
      *                                                                   CAC001
     C     BGN0ST        IFEQ      'Y'                                                         CAC00
     C     FPRCL         ANDNE     *BLANKS                                                     CAC00
     C     CDE002        OREQ      'Y'
     C     FRCF          IFEQ      'Y'                                                         CAC00
     C                   Z-ADD     FSRP          FSRPL                                         CAC00
      *                                                                   116330
      **Get*latest*'sc'*'ro'*from*history.*************************116330 CLE004
      * Get latest 'sc' 'ro' 'mc' from history.                           CLE004
     C     CLE003        IFEQ      'Y'                                                         11633
     C     LNRF          SETGT     LEHISTL2                                                    11633
     C     LNRF          READPE    LEHISTL2                               69                   11633
     C     *IN69         DOWEQ     *OFF                                                        11633
     C     FRCF#H        IFEQ      'Y'                                                         11633
     C                   Z-ADD     FSRP#H        FSRPL                                         11633
     C                   MOVE      FSGN#H        FSGNL                                         11633
     C                   LEAVE                                                                 11633
     C                   ENDIF                                                                 11633
      *                                                                   116330
     C     LNRF          READPE    LEHISTL2                               69                   11633
     C                   ENDDO                                                                 11633
     C                   ENDIF                                                                 11633
      *                                                                   116330
     C                   ENDIF                                                                 CAC00
     C                   EXSR      SRFUND                                                      CAC00
     C                   ENDIF                                                                 CAC00
1418 C**
1419 C                   ENDSR
1420 C**
1421 C**
1422 C********************************************************************
1423 C********************************************************************
1424 C**
1425 C**   SUBROUTINE TO PROCESS BASE RATE CHANGE ACTIONS - BRCHNG
1426 C**
1427 C**   CALLED FROM ACTNS
1428 C**   CALLS RATECH
1429 C**
1430 C     BRCHNG        BEGSR                                                  ***  BRCHNG ***
1431 C**
      ** CLE134 - Past Due Call Loans process                                                 CLE134
      *                                                                                       CLE134
     C                   MOVE      'N'           WPDCLL                                       CLE134
     C                   MOVE      'N'           WPDCLA                                       CLE134
     C                   MOVE      'N'           WPDCLR                                       CLE134
     C                   MOVE      'N'           WORIGL                                       CLE134
     C                   MOVE      'N'           WORIGA                                       CLE134
     C                   MOVE      'N'           WMRAUT                                       263416
      *                                                                                       CLE134
1432 C**   UPDATE WITH NEW BASE RATE AND CALC NEW EFF. RATE
1433 C**
1434 C                   Z-ADD     BRTE          BRTEL
     C                   EXSR      NEWSRT
      *                                                                   116330
      **Get*latest*'br'*'bc'*'ro'*from*history.********************116330 CLE004
      * Get latest 'br' 'bc' 'ro' 'mc' from history.                      CLE004
     C     CLE003        IFEQ      'Y'                                                         11633
     C     LNRF          SETGT     LEHISTL0                                                    11633
     C     LNRF          READPE    LEHISTL0                               69                   11633
     C     *IN69         IFEQ      *OFF                                                        11633
     C                   Z-ADD     BRTE#H        BRTEL                                         11633
     C                   Z-ADD     VDAT#H        VDAT                                          11633
     C                   ENDIF                                                                 11633
     C                   ENDIF                                                                 11633
      *                                                                   116330
1435 C                   EXSR      RATECH
     C*                                                                   CAC001
     C     BGN0ST        IFEQ      'Y'                                                         CAC00
     C     FPRCL         ANDNE     *BLANKS                                                     CAC00
     C                   EXSR      SRFUND                                                      CAC00
     C                   ENDIF                                                                 CAC00
1436 C**
     C/COPY WNCPYSRC,LEH00609
1437 C                   ENDSR
1438 C**
1439 C**
1440 C********************************************************************
1441 C********************************************************************
1442 C**
1443 C**   SUBROUTINE TO PROCESS BASE RATE CODE CHANGE ACTIONS - BCCHNG
1444 C**
1445 C**   CALLED FROM ACTNS
1446 C**   CALLS RATECH
1447 C**
1448 C     BCCHNG        BEGSR                                                  ***  BCCHNG ***
1449 C**
      ** CLE134 - Past Due Call Loans process                                                 CLE134
      *                                                                                       CLE134
     C                   MOVE      'N'           WPDCLL                                       CLE134
     C                   MOVE      'N'           WPDCLA                                       CLE134
     C                   MOVE      'N'           WPDCLR                                       CLE134
     C                   MOVE      'N'           WORIGL                                       CLE134
     C                   MOVE      'N'           WORIGA                                       CLE134
     C                   MOVE      'N'           WMRAUT                                       263416
      *                                                                                       CLE134
1450 C**   UPDATE WITH NEW BASE CODE AND RATE AND CALC NEW EFF.  RATE
1451 C**
1452 C                   Z-ADD     BRTT          BRTTL
1453 C                   Z-ADD     BRTE          BRTEL
     C                   EXSR      NEWSRT
      *                                                                   116330
      **Get*latest*'br'*'bc'*'ro'*from*history.********************116330 CLE004
      * Get latest 'br' 'bc' 'ro' 'mc' from history.                      CLE004
     C     CLE003        IFEQ      'Y'                                                         11633
     C     LNRF          SETGT     LEHISTL0                                                    11633
     C     LNRF          READPE    LEHISTL0                               69                   11633
     C     *IN69         IFEQ      *OFF                                                        11633
     C                   Z-ADD     BRTT#H        BRTTL                                         11633
     C                   Z-ADD     BRTE#H        BRTEL                                         11633
     C                   Z-ADD     VDAT#H        VDAT                                          11633
     C                   ENDIF                                                                 11633
     C                   ENDIF                                                                 11633
      *                                                                                       CLE036
     C     CLE036        IFEQ      'Y'
     C     BRTTL         IFEQ      0
     C                   Z-ADD     BRTEL         BASRL
     C                   ELSE
     C                   Z-ADD     0             BASRL
     C                   ENDIF
     C                   ENDIF
      *                                                                   116330
1454 C                   EXSR      RATECH
     C*                                                                   CAC001
     C     BGN0ST        IFEQ      'Y'                                                         CAC00
     C     FPRCL         ANDNE     *BLANKS                                                     CAC00
     C                   EXSR      SRFUND                                                      CAC00
     C                   ENDIF                                                                 CAC00
1455 C**
     C/COPY WNCPYSRC,LEH00610
1456 C                   ENDSR
1457 C**
1458 C**
1459 C********************************************************************
1460 C********************************************************************
1461 C**
1462 C**   SUBROUTINE TO PROCESS ROLLOVER ACTIONS - ROLLOV
1463 C**
1464 C**   CALLED FROM ACTNS
1465 C*****CALLS FREQIN,RATECH                                                                CLE031
1465 C**   CALLS FREQIN,RATECH,ROLDIF                                                         CLE031
1466 C**
1467 C     ROLLOV        BEGSR                                                  ***  ROLLOV ***
      *                                                                                       CLE134
      ** CLE134 - Past Due Call Loans process                                                 CLE134
      *                                                                                       CLE134
     C                   MOVE      'N'           WPDCLL                                       CLE134
     C                   MOVE      'N'           WPDCLA                                       CLE134
     C                   MOVE      'N'           WPDCLR                                       CLE134
     C                   MOVE      'N'           WORIGL                                       CLE134
     C                   MOVE      'N'           WORIGA                                       CLE134
     C                   MOVE      'N'           WMRAUT                                       263416
      *                                                                                       CLE034
     C     CLE034        IFEQ      'Y'
     C                   MOVE      'R'           WRKROL            1
     C                   ENDIF
1468 C**
     C**   SET OF BITS 4, 5, 6 AND 7 OF THE CONFIRMATION INDICATOR        S01270
     C**   FIELD                                                          S01270
     C*                                                                   S01270
     C*********************BITOF'4567'    CNFI                        S012700085
     C                   BITOFF    '567'         CNFI                                            008
     C                   Z-ADD     RLDT          ROLLDT            5 0                         S0139
     C*                                                                   S01270
1471 C                   Z-ADD     NROD          RLDT                     89
1472 C                   Z-ADD     0             NROD
      *                                                                                     AR954080
     C     *IN89         IFEQ      '0'                                                      AR954080
     C     RLDT          ANDGE     MDAT                                                     AR954080
     C     MDAT          ANDNE     0                                                        AR954080
     C                   Z-ADD     0             RLDT                                       AR954080
     C                   Z-ADD     0             RLDY                                       AR954080
     C                   MOVE      ' '           RLFQ                                       AR954080
     C                   ENDIF                                                              AR954080
      *                                                                                     AR954080
1473 C  N89              GOTO      INTAM
1474 C                   Z-ADD     VDAT          ZDAYNO
1475 C                   Z-ADD     RLDY          ZMDAY
1476 C                   MOVE      RLFQ          ZFREQ
1477 C                   EXSR      FREQIN
1478 C                   Z-ADD     ZDAYNO        RLDT
1479 C                   Z-ADD     ZMDAY         RLDY
1480 C                   MOVE      ZFREQ         RLFQ
      *                                                                   CLE005
      ** Update next interest date and base date with rollover date if    CLE005
      ** interest frequency is 'R' (at rollover); reset bit settings      CLE005
      ** if bits were on for this payment, ie rund not later than vdat    CLE005
      *                                                                   CLE005
     C     CLE005        IFEQ      'Y'                                                         CLE00
     C     IPFR          ANDEQ     'R'                                                         CLE00
     C                   Z-ADD     ZDAYNO        IBDT                                          CLE00
     C                   Z-ADD     ZDAYNO        NIDT                                          CLE00
     C     *IN89         IFEQ      '0'                                                         CLE00
     C     RUND          IFLE      VDAT                                                        CLE00
     C                   BITOFF    '2'           TLXI                                          CLE00
     C                   BITOFF    '01'          CBLI                                          CLE00
     C                   ENDIF                                                                 CLE00
     C                   ELSE                                                                  CLE00
     C                   Z-ADD     ZMDAY         IFDY                                          CLE00
     C                   MOVE      ZFREQ         IPFR                                          CLE00
     C                   ENDIF                                                                 CLE00
     C                   ENDIF                                                                 CLE00
1481 C**
1482 C**   UPDATE INTEREST DETAILS IF NEEDED
1483 C**
1484 C     INTAM         TAG                                                    ** INTAM TAG **
1485 C**
1486 C                   Z-ADD     BRTT          BRTTL
1487 C                   Z-ADD     BRTE          BRTEL
1488 C                   Z-ADD     RTSP          RTSPL
1489 C                   MOVE      SPIN          SPINL
1490 C***********          Z-ADDCALC      ICBS                            S01392
     C                   MOVE      CHIN          CHINL
      ** Override values of Interest Rounding fields for Rollover                           AR988948
     C     CRE073        IFEQ      'Y'
     C     NNSP          IFGT      0
     C     NNSG          ANDNE     *BLANKS
     C     NDMT          ANDNE     *BLANKS
     C     NDFD          ANDNE     *BLANKS
     C                   Z-ADD     NNSP          CNSP
     C                   MOVEL     NNSG          CNSG
     C                   MOVEL     NDMT          RDMT
     C                   MOVEL     NDFD          RDFD
     C                   ENDIF
     C                   ENDIF
     C                   EXSR      NEWSRT
      *                                                                   116330
      **Get*latest*'br'*'bc'*'ro'*from*history.********************116330 CLE004
      * Get latest 'br' 'bc' 'ro' 'mc' from history.                      CLE004
     C     CLE003        IFEQ      'Y'                                                         11633
     C     LNRF          SETGT     LEHISTL0                                                    11633
     C     LNRF          READPE    LEHISTL0                               69                   11633
     C     *IN69         IFEQ      *OFF                                                        11633
     C                   Z-ADD     BRTT#H        BRTTL                                         11633
     C                   Z-ADD     BRTE#H        BRTEL                                         11633
     C                   Z-ADD     VDAT#H        VDAT                                          11633
     C                   ENDIF                                                                 11633
      *                                                                   116330
      **Get*latest*'sc'*'ro'*from*history.*************************116330 CLE004
      * Get latest 'sc' 'ro' 'mc' from history.                           CLE004
     C     LNRF          SETGT     LEHISTL2                                                    11633
     C     LNRF          READPE    LEHISTL2                               69                   11633
     C     *IN69         IFEQ      *OFF                                                        11633
     C                   Z-ADD     RTSP#H        RTSPL                                         11633
     C     SPINL         IFNE      SPIN#H                                                   MD019942
     C                   MOVEL     SPIN#H        SPINL                                      MD019942
     C                   ENDIF                                                              MD019942
     C     VDAT#H        IFGT      VDAT                                                        11633
     C                   Z-ADD     VDAT#H        VDAT                                          11633
     C                   ENDIF                                                                 11633
     C                   ENDIF                                                                 11633
     C                   ENDIF                                                                 11633
      *                                                                                       CLE036
     C     CLE036        IFEQ      'Y'
     C     BRTTL         IFEQ      0
     C                   Z-ADD     BRTEL         BASRL
     C                   ELSE
     C                   Z-ADD     0             BASRL
     C                   ENDIF
     C                   ENDIF
      *                                                                   CAC001
     C**********           EXSR NEWSRT                                               CRE073 AR824724
     C     BGN0ST        IFEQ      'Y'                                                         CAC00
     C     FPRC          ANDNE     *BLANKS                                                     CAC00
     C                   Z-ADD     FSRP          FSRPL                                         CAC00
     C                   MOVE      FSGN          FSGNL                                         CAC00
     C                   MOVEL     FPRC          FPRCL                                         CAC00
      *                                                                   116330
      **Get*latest*'sc'*'ro'*from*history.*************************116330 CLE004
      * Get latest 'sc' 'ro' 'mc' from history.                           CLE004
     C     CLE003        IFEQ      'Y'                                                         11633
     C     LNRF          SETGT     LEHISTL2                                                    11633
     C     LNRF          READPE    LEHISTL2                               69                   11633
     C     *IN69         DOWEQ     *OFF                                                        11633
     C     FRCF#H        IFEQ      'Y'                                                         11633
     C     AMTP#H        ANDEQ     'SC'                                                        11633
     C     FPRC#H        ORNE      *BLANKS                                                     11633
     C     AMTP#H        ANDEQ     'RO'                                                        11633
     C     FPRC#H        ORNE      *BLANKS                                                     CLE00
     C     AMTP#H        ANDEQ     'MC'                                                        CLE00
     C                   Z-ADD     FSRP#H        FSRPL                                         11633
     C                   MOVE      FSGN#H        FSGNL                                         11633
     C                   LEAVE                                                                 11633
     C                   ENDIF                                                                 11633
      *                                                                   116330
     C     LNRF          READPE    LEHISTL2                               69                   11633
     C                   ENDDO                                                                 11633
     C                   ENDIF                                                                 11633
      *                                                                   116330
     C                   ENDIF                                                                 CAC00
     C*                                                                   S01392
     C**  PROCESSING FOR ROLLOVER OF DISCOUNTED LOAN                      S01392
     C*                                                                   S01392
     C     PTYP          IFEQ      63                                                          S0139
     C     PTYP          OREQ      65                                                          12209
     C     CLE004        ANDEQ     'Y'                                                         13897
     C     PTYP          OREQ      67                                                          12209
     C     CLE004        ANDEQ     'Y'                                                         13897
     C                   SETON                                        81                       05607
     C                   EXSR      ROLDIS                                                      S0139
     C***********          SETON                     81            S01392 056072
     C                   ELSE                                                                  S0139
     C                   SETOFF                                       81                       S0139
     C                   END                                                                   S0139
     C                   Z-ADD     CALC          ICBS                                          S0139
     C/COPY WNCPYSRC,LE0450C013
      *                                                                                       CLE031
      ** If feature CLE031 is on goto SR/ROLDIF                                               CLE031
      *                                                                                       CLE031
     C     CLE031        IFEQ      'Y'
     C                   EXSR      ROLDIF
     C                   ENDIF
     C*                                                                   S01392
1491 C**
1492 C**   CHECK FOR CHANGE OF DETAILS
1493 C**
1494 C     NBRA          COMP      0                                  8989
1495 C  N89NRTS          COMP      0                                  8989
1496 C  N89NSIN          COMP      ' '                                8989
1497 C  N89NCAC          COMP      0                                  8989
      *                                                                                       CLE036
     C     CLE036        IFEQ      'Y'
     C     *IN89         ANDEQ     '0'
     C     NBSR          IFNE      0
     C                   MOVE      '1'           *IN89
     C                   ENDIF
     C                   ENDIF
1498 C**
      *                                                                   156501
      ** Allow to calculate interest rate when change indicator is R      156501
      *                                                                   156501
     C     *IN89         IFEQ      '0'                                                         15650
     C     BRTTL         ANDNE     0                                                           15650
     C     CHINL         ANDEQ     'R'                                                         15650
     C     *IN89         OREQ      '0'
     C     BASRL         ANDNE     0
     C     CHINL         ANDEQ     'R'
     C     CLE036        ANDEQ     'Y'
     C                   MOVE      '1'           *IN89                                         15650
     C                   ENDIF                                                                 15650
      *                                                                   156501
1499 C   89              EXSR      RATECH
      *                                                                   CAC001
     C     BGN0ST        IFEQ      'Y'                                                         CAC00
     C     *IN89         IFEQ      '1'                                                         CAC00
     C     NFPC          ORNE      *BLANKS                                                     CAC00
     C                   EXSR      SRFUND                                                      CAC00
     C                   ENDIF                                                                 CAC00
     C                   ENDIF                                                                 CAC00
1500 C**
1501 C**   ZEROISE NEXT ROLL DETAILS
1502 C**
1503 C                   Z-ADD     0             NBRA
     C     CLE036        IFEQ      'Y'
     C                   Z-ADD     0             NBSR
     C                   ENDIF
1504 C                   Z-ADD     0             NRTS
1505 C                   MOVE      ' '           NSIN
1506 C                   Z-ADD     0             NCAC
     C                   MOVE      ' '           NCHI
      *                                                                   CAC001
     C     BGN0ST        IFEQ      'Y'                                                         CAC00
     C                   Z-ADD     0             NFRS                                          CAC00
     C                   MOVE      *BLANKS       NFSN                                          CAC00
     C                   MOVE      *BLANKS       NFPC                                          CAC00
     C                   ENDIF                                                                 CAC00
     C*                                                                   S01465
     C**  Perform the following only if switchable feature is ON          S01465
     C*                                                                   S01465
     C     *IN25         IFEQ      '1'                                                         S0146
     C*                                                                   S01465
     C**  Update maturity date with the new value from new maturity       S01465
     C**  date field (if not blank)                                       S01465
     C*                                                                   S01465
     C     NMDT          IFNE      *ZEROS                                                      S0146
     C                   Z-ADD     NMDT          MDAT                                          S0146
     C                   END                                                                   S0146
     C/COPY WNCPYSRC,LE0450C057
     C                   Z-ADD     *ZEROS        NMDT                                          S0146
     C*                                                                   S01465
     C**  New processing for rollover of next interest payment date       S01465
     C*                                                                   S01465
     C**  If new interest payment date is not zero,                       S01465
     C****and*interest*pay*frequency*is*blank,**********************S01465159199
     C**  update the next interest payment date on the loan.              S01465
     C*                                                                   S01465
     C     CLE003        IFEQ      'N'                                                         11632
     C     CLE003        OREQ      'Y'                                                         11632
     C     NIPD          ANDGT     SLID                                                        11632
     C     NIPD          IFNE      *ZEROS                                                      S0146
     C***********IPFR      ANDEQ' '                                 S01465159199
     C                   Z-ADD     NIPD          NIDT                                          S0146
      *                                                                   174873
     C     NIPD          IFLE      RUND                                                        17487
     C                   Z-ADD     0             NIDT                                          17487
     C                   ENDIF                                                                 17487
      *                                                                   174873
     C                   END                                                                   S0146
     C                   ENDIF                                                                 11632
     C                   Z-ADD     *ZEROS        NIPD                                          S0146
     C*                                                                   S01465
     C                   END                                                                   S0146
      *                                                                   CLE004
      * Update last rollover date                                         CLE004
     C                   Z-ADD     VDAT          LRLD                                          CLE00
      *                                                                   CLE011
     C     CLE011        IFEQ      'Y'                                                         CLE01
     C                   MOVE      *BLANKS       RFRI                                          CLE01
     C                   Z-ADD     *ZERO         RFRT                                          CLE01
     C                   ENDIF                                                                 CLE01
      *                                                                                       CLE023
      ** If CLE023 is installed and New facility exchange rate and                            CLE023
      ** indicator is not zero and blank, set on indicator to output                          CLE023
      ** these fields to NCLONCL                                                              CLE023
      *                                                                                       CLE023
     C     CLE023        IFEQ      'Y'
     C     CLE034        OREQ      'Y'
     C                   MOVE      'Y'           WROTDY
     C                   ENDIF
      *                                                                   CPB001
      **  If Replication Processing running.                              CPB001
     C********** WUREPL    IFEQ *ON                        Begin WUREPL                CPB001 203896
     C     WUREPL        IFEQ      'Y'                                          Begin WUREPL
     C                   EXSR      REPLIC                                                      CPB00
      *                                                                   CPB001
     C                   ENDIF                                                  End WUREPL     CPB00
1507 C**
     C*                                                                   S01408
     C** Core hook for externalisation.                                   S01408
     C/COPY WNCPYSRC,LE0450PDR                                            S01408
     C*                                                                   S01408
      *                                                                                       CLE034
     C     CLE034        IFEQ      'Y'
     C                   MOVE      *BLANK        WRKROL
     C                   ENDIF
      *                                                                                       CLE034
1508 C                   ENDSR
1509 C**
1510 C********************************************************************
1511 C********************************************************************
1512 C**
1513 C**   SUBROUTINE TO PROCESS MATURITY ACTIONS - MATRTY
1514 C**
1515 C**   CALLED FROM ACTNS
1516 C*****CALLS CPAMUP,AKYOUT(2),INTRST                                                      CLE031
1516 C**   CALLS CPAMUP,AKYOUT(2),INTRST,SETCCY,SETTLE,SECCY2,SETRST                          CLE031
1517 C**
1518 C     MATRTY        BEGSR                                                  ***  MATRTY ***
      *                                                                                       CLE134
      ** CLE134 - Past Due Call Loans process                                                 CLE134
      *                                                                                       CLE134
     C                   MOVE      'N'           WPDCLL                                       CLE134
     C                   MOVE      'N'           WPDCLA                                       CLE134
     C                   MOVE      'N'           WPDCLR                                       CLE134
     C                   MOVE      'N'           WORIGL                                       CLE134
     C                   MOVE      'N'           WORIGA                                       CLE134
     C                   MOVE      'N'           WMRAUT                                       263416
1519 C**
      ** If AUTO = 'C', check whether the processed loan is a PDCL or                       AR700107
      ** an original loan by checking the 1st character of the loan                         AR700107
      ** type. If it is X, Y, Z then the loan is a Oast Due Call Loan.                      AR700107
      *                                                                                     AR700107
     C     CLE134        IFEQ      'Y'                                                      AR700107
     C     AUTO          ANDEQ     'C'                                                      AR700107
     C     CLE134        OREQ      'Y'                                                      AR700107
     C     AUTOX         ANDEQ     'C'                                                      AR700107
     C     CLE134        OREQ      'Y'                                                      AR700107
     C     AUTOL         ANDEQ     'C'                                                      AR700107
     C                   MOVEL     LTYP          LTYP1A            1                        AR700107
     C                   EVAL      WCLE134 = 'Y'                                            MD049078
     C     LTYP1A        IFEQ      'X'                                                      AR700107
     C     LTYP1A        OREQ      'Y'                                                      AR700107
     C     LTYP1A        OREQ      'Z'                                                      AR700107
     C                   MOVE      'Y'           WPDCLL                                     AR700107
     C                   ELSE                                                               AR700107
     C                   MOVE      'Y'           WORIGL                                     AR700107
     C                   ENDIF                                                              AR700107
     C                   ENDIF                                                              AR700107
      *                                                                                     AR700107
1520 C**   IF THE MATURITY IND ON THE CONTROL RECORD IS ON LOAN
1521 C**   IS MATURING TODAY
1522 C**
1523 C  N47              GOTO      NONMAT                                       NON AUTO
1524 C**
1525 C**   GENERATE MATURITY KEYS FOR DISCOUNTED LOANS
1526 C**
1527 C  N45              GOTO      NOTDIS
1528 C**
1529 C**   PRINCIPAL REPAYMENT
1530 C**
     C                   Z-ADD     VDAT          ACDATE
1531 C                   Z-ADD     PRAM          ACAMNT                   89
1532 C                   MOVE      'R'           AKY(3)
1533 C                   MOVEA     BKAKY         AKY(6)
1534 C                   MOVE      'A'           AKY(10)
      *                                                                                       CLE034
      ** If CLE034 is installed                                                               CLE034
      *                                                                                       CLE034
     C     CLE034        IFEQ      'Y'
     C     STAL          ANDEQ     'Y'
     C     *IN89         ANDEQ     *OFF
     C                   MOVE      'E'           WTYPE
     C                   EXSR      SR34A
     C                   ELSE
     C                   MOVE      'Y'           WRKFLD
     C                   MOVE      '*EOF   '     PRTCD
     C                   ENDIF
      *                                                                                       CLE034
     C     WRKFLD        DOWEQ     'Y'
     C     PRTCD         OREQ      *BLANKS
     C     CLE034        IFEQ      'Y'
     C     STAL          ANDEQ     'Y'
     C                   EXSR      SR34B
     C                   ENDIF
      *                                                                                       CLE031
      ** If feature CLE031 is on and indicator 89 is off then                                 CLE031
      ** set work type to 'end' and goto SR/SETCCY                                            CLE031
      *                                                                                       CLE031
     C     CLE031        IFEQ      'Y'
     C     *IN89         ANDEQ     *OFF
     C                   MOVE      'E'           WTYPE
     C                   EXSR      SETCCY
     C                   ENDIF
      *                                                                                       CLE031
1535 C**N89*****           EXSR AKYOUT                                                      AR317587
     C                   EXSR      AKYOUT
      *                                                                                       CLE031
      ** If feature CLE031 is on and indicator 89 is off then                                 CLE031
      ** set work type to 'end' and goto SR/SETTLE                                            CLE031
      *                                                                                       CLE031
     C     CLE031        IFEQ      'Y'
     C     *IN89         ANDEQ     *OFF
     C     WCLE134       ANDEQ     ' '                                                      MD049078
     C                   EXSR      SETTLE
     C                   ENDIF
      *                                                                                       CLE034
     C     CLE034        IFEQ      'Y'
     C     STAL          ANDEQ     'Y'
     C                   EXSR      SR34C
     C                   ELSE
     C                   MOVE      *BLANKS       WRKFLD
     C                   ENDIF
     C                   ENDDO
      *                                                                                       CLE034
     C     CLE034        IFEQ      'Y'
     C     STAL          ANDEQ     'Y'
     C                   EXSR      SR34E
     C                   ENDIF
     C*                                                                   S01465
     C**  Account key generated with 'R' in AKY (in position 8) if        S01465
     C**  the receiver of guarantee is different to blanks                S01465
     C*                                                                   S01465
     C     *IN26         IFEQ      '1'                                                         S0146
     C     WORECE        IFNE      *BLANKS                                                     S0146
     C**********           Z-ADDCNUML     WORK2                                        S01465 CSD027
     C                   MOVE      CNUML         WORK2
     C                   MOVE      WORECE        CNUML                                         S0146
     C                   MOVE      'R'           AKY(8)                                        S0146
     C**N89*****           EXSR AKYOUT                                               S01465 AR317587
     C                   EXSR      AKYOUT
     C**********           Z-ADDWORK2     CNUML                                        S01465 CSD027
     C                   MOVE      WORK2         CNUML
     C                   MOVE      ' '           AKY(8)                                        S0146
     C                   END                                                                   S0146
     C                   END                                                                   S0146
1536 C**
1537 C**   ACCRUED DISCOUNT/PREMIUM NOT POSTED
1538 C**
     C*                                                                   S01392
     C**  GENERATE REBATE ON DISCOUNT KEY                                 S01392
     C**  IF EARLY PAYMENT                                                S01392
     C*                                                                   S01392
     C     REBT          IFNE      0                                                           S0139
     C*                                                                   S01392
     C**  IF THE PRINCIPAL = 0, THE EARLY MATURITY DISC. LOAN HAS         S01392
     C**  GONE PAST DUE AND HAS BEEN REPAID THRU MANUAL REPAYMENT.        S01392
     C**  THUS, THE REBATE A/C KEY HAS ALREADY BEEN GENERATED AND         S01392
     C**  DO NOT NEED TO GENERATE AGAIN.                                  S01392
     C*                                                                   S01392
     C     PRAM          ANDNE     0                                                           S0139
     C                   Z-ADD     REBT          ACAMNT                                        S0139
     C                   MOVE      'R'           AKY(3)                                        S0139
     C                   MOVEA     BKAKY         AKY(6)                                        S0139
     C                   MOVE      'E'           AKY(10)                                       S0139
     C                   EXSR      AKYOUT                                                      S0139
     C                   END                                                                   S0139
1539 C***********TOTI      SUB  AIPD      ACAMNT       8889               S01392
      *                                                                                     AR317587
      ** There should be no outstanding interest for maturing                               AR317587
      ** discounted loans.                                                                  AR317587
      *                                                                                     AR317587
     C     *LIKE         DEFINE    TOTI          INTDIF
     C                   Z-ADD     0             INTDIF
     C     TOTI          SUB       AIPD          INTDIF
      *                                                                                     AR317587
      ** If the loan is not being 'rolled-over', no account                                 AR317587
      ** key is needed to be generated.                                                     AR317587
      *                                                                                     AR317587
     C     ORMD          IFEQ      0
     C     *IN47         ANDEQ     '1'
     C     INTDIF        ANDEQ     0
     C                   MOVE      *ON           *IN17
     C                   ELSE
     C                   MOVE      *OFF          *IN17
     C                   ENDIF
      *                                                                                     AR317587
     C     TOTI          ADD       AITCL         ACAMNT                                        S0139
     C     ACAMNT        SUB       AIPD          ACAMNT                 8889                   S0139
     C                   Z-ADD     ACAMNT        XACMT                          SAVE DATA      S0139
     C     CAS005        IFEQ      'Y'
     C     TOTN          ADD       AITNL         WACMNT
     C     WACMNT        SUB       AIPN          WACMNT
     C                   Z-ADD     WACMNT        XACMTN           13 0
     C                   ENDIF
1540 C                   MOVE      'A'           AKY(3)
1541 C                   MOVEA     BKAKY         AKY(6)
1542 C  N88              MOVE      'D'           AKY(10)
1543 C   88              MOVE      'P'           AKY(10)
1544 C   88              Z-SUB     ACAMNT        ACAMNT
     C                   SETON                                        65
      *                                                                                       CAS009
      ** If CAS009 is enabled, generate discount amount a/c keys only if                      CAS009
      ** the hedging amortisation method is not 'N' (non-linear).                             CAS009
      *                                                                                       CAS009
     C     CAS009        IFEQ      'Y'
      *                                                                                       232348
      ** Only process EIR cost accounting if loan's value date is same                        232348
      ** as or after the non-linear amortisation cut-off date                                 232348
     C     VDAT          ANDGE     FSNLAC
      *                                                                                       232348
     C                   EXSR      SRRTVI
     C                   ENDIF
     C     CAS009        IFEQ      'Y'
     C     *IN45         ANDEQ     '1'
     C     FSAMRM        ANDEQ     'N'
     C     AYACAI        ANDEQ     'Y'
      *                                                                                       232348
      ** Only process EIR cost accounting if loan's value date is same                        232348
      ** as or after the non-linear amortisation cut-off date                                 232348
     C     VDAT          ANDGE     FSNLAC
      *                                                                                       CAS009
      ** Suppress Linear Amortisation for Discount Loans when                                 CAS009
      ** the Amortisation Method is 'N'on-Linear.                                             CAS009
      *                                                                                       CAS009
     C                   ELSE
1545 C**N89*****           EXSR AKYOUT                                                      AR317587
     C     *IN17         IFEQ      '0'
     C                   EXSR      AKYOUT
     C                   ENDIF
     C                   ENDIF
      *                                                                                       CAS009
     C                   SETOFF                                       65
1546 C**
1547 C**   TOTAL AMOUNT FOR SETTLEMENT
1548 C**
1549 C***********          Z-ADDPRAM      ACAMNT         89               S01392
     C*                                                                   S01392
     C**  IF PRINCIPAL = 0, DO NOT NEED TO DEDUCT REBATE FROM IT.         S01392
     C*                                                                   S01392
     C     PRAM          IFEQ      0                                                           S0139
     C                   Z-ADD     PRAM          ACAMNT                   89                   S0139
     C                   ELSE                                                                  S0139
     C     PRAM          SUB       REBT          ACAMNT                   89                   S0139
     C                   END                                                                   S0139
1550 C                   MOVE      'R'           AKY(3)
1551 C                   MOVEA     BKAKY         AKY(6)
1552 C                   MOVE      'B'           AKY(10)
      *                                                                                       CLE034
      ** If CLE034 is installed                                                               CLE034
      *                                                                                       CLE034
     C     CLE034        IFEQ      'Y'
     C     STAL          ANDEQ     'Y'
     C     *IN89         ANDEQ     *OFF
     C                   EXSR      SR34A
     C                   ELSE
     C                   MOVE      'Y'           WRKFLD
     C                   MOVE      '*EOF   '     PRTCD
     C                   ENDIF
      *                                                                                       CLE034
     C     WRKFLD        DOWEQ     'Y'
     C     PRTCD         OREQ      *BLANKS
     C     CLE034        IFEQ      'Y'
     C     STAL          ANDEQ     'Y'
     C                   EXSR      SR34B
     C                   EXSR      SETCCY
     C                   ELSE
      *                                                                                       CLE031
      ** If feature CLE031 is on and indicator 89 is off goto SR/SECCY2                       CLE031
      *                                                                                       CLE031
     C     CLE031        IFEQ      'Y'
     C     *IN89         ANDEQ     *OFF
     C                   EXSR      SECCY2
     C                   ENDIF
     C                   ENDIF
      *                                                                                       CLE031
1553 C**N89*****           EXSR AKYOUT                                                      AR317587
     C                   EXSR      AKYOUT
      *                                                                                       CLE031
      ** If feature CLE031 is on and indicator 89 is off goto SR/SETRST                       CLE031
      *                                                                                       CLE031
     C     CLE031        IFEQ      'Y'
     C     *IN89         ANDEQ     *OFF
     C                   EXSR      SETRST
     C                   ENDIF
      *                                                                                       CLE034
     C     CLE034        IFEQ      'Y'
     C     STAL          ANDEQ     'Y'
     C                   EXSR      SR34C
     C                   ELSE
     C                   MOVE      *BLANKS       WRKFLD
     C                   ENDIF
     C                   ENDDO
      *                                                                                       CLE034
     C     CLE034        IFEQ      'Y'
     C     STAL          ANDEQ     'Y'
     C                   EXSR      SR34E
     C                   ENDIF
1554 C**
1555 C**   UPDATE FILE AMOUNTS
1556 C**
     C*                                                                   S01392
     C**  TO ELIMINATE 1 UNIT OF CCY DIFF FOR ENQUIRY OF DISCOUNT         S01392
     C**  LOAN INTEREST AFTER MATURITY DATE                               S01392
     C*                                                                   S01392
     C     AIAP          IFEQ      0                                                           S0139
     C     CPAM          IFGT      0
     C                   ADD       TOTI          AITCL                                         S0139
     C                   ENDIF
     C                   Z-ADD     AITCL         AITC                                          S0139
     C                   END                                                                   S0139
1557 C***********          Z-ADDTOTI      AIPD                            S01392
1558 C***********          Z-ADDTOTI      IPRD                            S01392
      *                                                                                     AR317587
      ** Accrued interest posted to date has already been done.                             AR317587
      *                                                                                     AR317587
     C     *IN17         IFEQ      *OFF
     C                   ADD       XACMT         AIPD                                          S0139
     C                   ENDIF
     C     CPAM          IFGT      0
     C                   ADD       TOTI          IPRD                                          S0139
     C                   ENDIF
     C     CAS005        IFEQ      'Y'
     C     AIAN          IFEQ      0
     C                   ADD       TOTN          AITNL
     C                   Z-ADD     AITNL         AITN
     C                   ENDIF
     C                   ADD       XACMTN        AIPN
     C                   ADD       TOTN          IPRN
     C                   ENDIF
1559 C                   Z-ADD     VDAT          SLIDL
1560 C                   Z-SUB     PRAM          AMOUNT
1561 C                   EXSR      CPAMUP
1562 C**
1563 C                   GOTO      MATEND
1564 C**
1565 C     NOTDIS        TAG                                                    ** NOTDIS TAG *
1566 C**
1567 C**   PROCESS INTEREST PORTION OF RECORD
1568 C**
1569 C                   Z-ADD     VDAT          ACDATE
1570 C                   Z-ADD     INTA          AMOUNT                   89
      *                                                                                       CLE028
      ** No repayment of interest for add on interest type of loan                            CLE028
      ** as the interest payment already included in principal                                CLE028
      ** payment                                                                              CLE028
      *                                                                                       CLE028
     C                   MOVE      *OFF          *IN77
     C     CLE028        IFEQ      'Y'
     C     PTYP          ANDEQ     80
     C     ADIF          IFEQ      'Y'
     C                   MOVE      *ON           *IN77
     C                   ENDIF
      *                                                                                       CLE028
      ** Accrue remaining charges                                                             CLE028
      *                                                                                       CLE028
     C     ADCF          IFEQ      'Y'
     C                   ADD       CHDU          WCHDU
     C                   ADD       CHDU          WACCH
      *                                                                                       CLE028
      ** Generate charge amortisation account key for                                         CLE028
      ** add on charges type of loan                                                          CLE028
      *                                                                                       CLE028
     C     WCHDU         IFNE      0
     C                   Z-ADD     VDAT          ACDATE
     C                   Z-ADD     WCHDU         ACAMNT
     C                   MOVEA     BKAKY         AKY(6)
     C                   MOVE      'A'           AKY(3)
     C                   MOVE      'H'           AKY(10)
     C                   EXSR      AKYOUT
     C                   Z-ADD     *ZERO         WCHDU
     C                   ENDIF
     C                   ENDIF
     C                   ENDIF
     C*
     C**   EXECUTE SUBROUTINE TO GET ACCRUAL A/C KEY WHICH MAY NOT BE
     C**   ZERO.  THERE IS ANOTHER CHECK FOR ZERO INTA.
1571 C                   EXSR      INTRST
1572 C**
1573 C**   UPDATE CURRENT PRINCIPAL AMOUNT
1574 C**
1575 C                   Z-SUB     PRAM          AMOUNT
1576 C                   EXSR      CPAMUP
1577 C**
1578 C**   GENERATE AN A/C KEY FOR PRINCIPAL REPAYMENT
1579 C**
1580 C                   Z-ADD     PRAM          ACAMNT                   89
1581 C                   MOVE      'R'           AKY(3)
1582 C                   MOVEA     BKAKY         AKY(6)
1583 C                   MOVE      'A'           AKY(10)
      *                                                                                       CLE034
      ** If CLE034 is installed                                                               CLE034
      *                                                                                       CLE034
     C     CLE034        IFEQ      'Y'
     C     STAL          ANDEQ     'Y'
     C     *IN89         ANDEQ     *OFF
     C                   MOVE      'E'           WTYPE
     C                   EXSR      SR34A
     C                   ELSE
     C                   MOVE      'Y'           WRKFLD
     C                   MOVE      '*EOF   '     PRTCD
     C                   ENDIF
      *                                                                                       CLE034
     C     WRKFLD        DOWEQ     'Y'
     C     PRTCD         OREQ      *BLANKS
     C     CLE034        IFEQ      'Y'
     C     STAL          ANDEQ     'Y'
     C                   EXSR      SR34B
     C                   ENDIF
      *                                                                                       CLE031
      ** If feature CLE031 is on and indicator 89 is off then set                             CLE031
      ** work type to 'end' and goto SR/SETCCY                                                CLE031
      *                                                                                       CLE031
     C     CLE031        IFEQ      'Y'
     C     *IN89         ANDEQ     *OFF
     C                   MOVE      'E'           WTYPE
     C                   EXSR      SETCCY
     C                   ENDIF
      *                                                                                       CLE031
1584 C**N89*****           EXSR AKYOUT                                                      AR317587
     C                   EXSR      AKYOUT
      *                                                                                       CLE031
      ** If feature CLE031 is on and indicator 89 is off goto SR/SETTLE                       CLE031
      *                                                                                       CLE031
     C     CLE031        IFEQ      'Y'
     C     *IN89         ANDEQ     *OFF
     C     WCLE134       ANDEQ     ' '                                                      MD049078
     C                   EXSR      SETTLE
     C                   ENDIF
      *                                                                                       CLE034
     C     CLE034        IFEQ      'Y'
     C     STAL          ANDEQ     'Y'
     C                   EXSR      SR34C
     C                   ELSE
     C                   MOVE      *BLANKS       WRKFLD
     C                   ENDIF
     C                   ENDDO
      *                                                                                       CLE034
     C     CLE034        IFEQ      'Y'
     C     STAL          ANDEQ     'Y'
     C                   EXSR      SR34E
     C                   ENDIF
      *                                                                   CAC001
      **  Generate Maturity Date Account Keys                             CAC001
      *                                                                   CAC001
     C     BGN0ST        IFEQ      'Y'                                                         CAC00
     C     FPRCL         ANDNE     *BLANKS                                                     CAC00
      *                                                                   CAC001
      **  Principal - Transaction Profit Centre                           CAC001
      *                                                                   CAC001
     C                   MOVEA     'T   '        AKY(6)                                        CAC00
     C********** *IN89     IFEQ '0'                                                  CAC001 AR317587
     C                   EXSR      AKYOUT                                                      CAC00
     C**********           ENDIF                                                     CAC001 AR317587
      *                                                                   CAC001
      **  Principal - Funding Profit Centre                               CAC001
      *                                                                   CAC001
     C                   MOVEA     'F   '        AKY(6)                                        CAC00
     C                   MOVEL     PRFC          WPRFC                                         CAC00
     C                   MOVEL     FPRCL         PRFC                                          CAC00
     C********** *IN89     IFEQ '0'                                                  CAC001 AR317587
     C                   EXSR      AKYOUT                                                      CAC00
     C**********           ENDIF                                                     CAC001 AR317587
     C                   MOVEL     WPRFC         PRFC                                          CAC00
     C                   MOVEA     BKAKY         AKY(6)                                        CAC00
      *                                                                   CAC001
     C                   ENDIF                                                                 CAC00
     C*                                                                   S01465
     C**  Account key generated with 'R' in AKY (in position 8) if        S01465
     C**  the receiver of guarantee is different to blanks                S01465
     C*                                                                   S01465
     C     *IN26         IFEQ      '1'                                                         S0146
     C     WORECE        IFNE      *BLANKS                                                     S0146
     C**********           Z-ADDCNUML     WORK2                                        S01465 CSD027
     C                   MOVE      CNUML         WORK2
     C                   MOVE      WORECE        CNUML                                         S0146
     C                   MOVE      'R'           AKY(8)                                        S0146
     C**N89*****           EXSR AKYOUT                                               S01465 AR317587
     C                   EXSR      AKYOUT
     C**********           Z-ADDWORK2     CNUML                                        S01465 CSD027
     C                   MOVE      WORK2         CNUML
     C                   MOVE      ' '           AKY(8)                                        S0146
     C                   END                                                                   S0146
     C                   END                                                                   S0146
1585 C**
1586 C**   GENERATE A/C KEY FOR TOTAL AMOUNT
1587 C**
1588 C                   Z-ADD     TAMT          ACAMNT                   89
1589 C                   MOVE      'R'           AKY(3)
1590 C                   MOVEA     BKAKY         AKY(6)
1591 C                   MOVE      'B'           AKY(10)
      *                                                                                       CLE034
      ** If CLE034 is installed                                                               CLE034
      *                                                                                       CLE034
     C     CLE034        IFEQ      'Y'
     C     STAL          ANDEQ     'Y'
     C     *IN89         ANDEQ     *OFF
     C                   EXSR      SR34A
     C                   ELSE
     C                   MOVE      'Y'           WRKFLD
     C                   MOVE      '*EOF   '     PRTCD
     C                   ENDIF
      *                                                                                       CLE034
     C     WRKFLD        DOWEQ     'Y'
     C     PRTCD         OREQ      *BLANKS
     C     CLE034        IFEQ      'Y'
     C     STAL          ANDEQ     'Y'
     C                   EXSR      SR34B
     C                   EXSR      SETCCY
     C                   ELSE
      *                                                                                       CLE031
      ** If feature CLE031 is on and indicator 89 is off goto SR/SECCY2                       CLE031
      *                                                                                       CLE031
     C     CLE031        IFEQ      'Y'
     C     *IN89         ANDEQ     *OFF
     C                   EXSR      SECCY2
     C                   ENDIF
     C                   ENDIF
      *                                                                                       CLE031
1592 C**N89*****           EXSR AKYOUT                                                      AR317587
     C                   EXSR      AKYOUT
      *                                                                                       CLE031
      ** If feature CLE031 is on and indicator 89 is off goto SR/SETRST                       CLE031
      *                                                                                       CLE031
     C     CLE031        IFEQ      'Y'
     C     *IN89         ANDEQ     *OFF
     C                   EXSR      SETRST
     C                   ENDIF
      *                                                                                       CLE034
     C     CLE034        IFEQ      'Y'
     C     STAL          ANDEQ     'Y'
     C                   EXSR      SR34C
     C                   ELSE
     C                   MOVE      *BLANKS       WRKFLD
     C                   ENDIF
     C                   ENDDO
      *                                                                                       CLE034
     C     CLE034        IFEQ      'Y'
     C     STAL          ANDEQ     'Y'
     C                   EXSR      SR34E
     C                   ENDIF
1593 C**
1594 C                   Z-ADD     SLID          SLIDL
1595 C**
1596 C**   ZEROIZE PAST DUE INTEREST
1597 C**
1598 C                   Z-ADD     0             PDIN
      *                                                                   CAC001
     C     BGN0ST        IFEQ      'Y'                                                         CAC00
     C     FPRCL         ANDNE     *BLANKS                                                     CAC00
     C                   Z-ADD     0             PDCF                                          CAC00
     C                   ENDIF                                                                 CAC00
      *                                                                                       CAS005
     C     CAS005        IFEQ      'Y'
     C                   Z-ADD     *ZEROS        PDNN
     C                   ENDIF
1599 C**
1600 C                   GOTO      MATEND
1601 C**
1602 C**   IF NON AUTO SETT PROCESS AS PAST DUE
1603 C**
1604 C     NONMAT        TAG                                                    ** NONMAT TAG *
1605 C**
      *                                                                                       CLE028
      ** Accrue charges for non-autosettle flat rate                                          CLE028
      ** personal loan                                                                        CLE028
      *                                                                                       CLE028
     C     CLE028        IFEQ      'Y'
     C     PTYP          ANDEQ     80
     C     ADCF          ANDEQ     'Y'
     C     CHGA          SUB       WACCH         WTOTCH           13 0
     C                   ADD       WTOTCH        WPDCH
     C                   ADD       WTOTCH        WACCH
     C                   ENDIF
     C     BGN0ST        IFEQ      'Y'                                                         CAC00
     C     FPRCL         ANDNE     *BLANKS                                                     CAC00
     C     *IN51         ANDEQ     '0'                                                         CAC00
     C                   ADD       COFA          PDCF                                          CAC00
     C                   ENDIF                                                                 CAC00
      *                                                                   CAC001
     C     CAS005        IFEQ      'Y'
     C     *IN51         ANDEQ     *OFF
     C     PDNN          ADD       INTN          PDNN
     C     *IN49         IFEQ      *ON
     C     PDNN          ADD       WTXA          PDNN
     C                   ENDIF
     C                   ENDIF
      *                                                                                       CAS005
     C     CLE007        IFEQ      'N'
     C     CLE007        OREQ      'Y'
     C     PDGN          ANDEQ     'Y'
1606 C  N51PDIN          ADD       INTA          PDIN
     C  N51
1607 CAN 49PDIN          ADD       WTXA          PDIN
     C                   ENDIF
1608 C**
     C**   CAPITALISE  INTEREST IF NECESSARY                              E13532
     C                   MOVE      *OFF          *IN77
     C   51              EXSR      INTRST                                                      E1353
     C**                                                                  E13532
     C**   SETON AUTO-SETTLE ONLY IF BOTH PRIN. AND INT. ARE ZERO
1609 C     PRAM          COMP      0                                      89
     C  N89              GOTO      MATEND
     C*
     C                   Z-ADD     0             CKINT            13 0
     C     AITC          ADD       AIMN          CKINT
     C     CKINT         ADD       AIAP          CKINT
     C     CKINT         SUB       IPRD          CKINT
     C     CKINT         SUB       ICTD          CKINT
     C     CKINT         SUB       IWOD          CKINT                    89
     C/COPY WNCPYSRC,LE0450C048
1610 C   89              MOVE      'Y'           AUTOL
     C   89CLE134        IFEQ      'Y'                                                        CLE134
     C     AUTO          ANDEQ     'C'                                                        CLE134
     C                   MOVE      'C'           AUTOL                                        CLE134
     C                   ENDIF                                                                CLE134
     C/COPY WNCPYSRC,LE0450C063
1611 C**
1612 C     MATEND        TAG                                                    ** MATEND TAG *
      *                                                                                       CAS001
      ** If switchable feature CAS001 is present, reverse any outstanding                     CAS001
      ** unrealized profit/loss                                                               CAS001
      *                                                                                       CAS001
     C     CAS001        IFEQ      'Y'
     C                   MOVEA     LTYP          AKY(1)
     C                   MOVE      'A'           AKY(3)
     C                   MOVEA     SUTP          AKY(4)
0781 C                   MOVEA     CLAS          AKY(11)
     C                   MOVEA     '  '          AKY(6)
      *                                                                                       CAS001
     C     WBOOK         IFEQ      'Y'
     C                   MOVEA     BOKC          AKY(6)
     C                   ENDIF
      *                                                                                       CAS001
     C                   MOVE      ' '           AKY(8)
     C                   Z-ADD     FSPLDT        ACAMNT
      *                                                                                       CAS001
     C     ACAMNT        IFGE      0
     C                   MOVEA     'UP'          AKY(9)
     C                   Z-SUB     ACAMNT        ACAMNT
     C                   ELSE
     C                   MOVEA     'UL'          AKY(9)
     C                   ENDIF
      *                                                                                       CAS001
     C**********           Z-SUBACAMNT    ACAMNT                                       CAS001 CAS004
     C     ACAMNT        IFNE      0
     C                   EXSR      AKYOUT
     C                   ENDIF
     C                   ENDIF
      *                                                                                       221413
      ** If hedge accounting is installed                                                     221413
      *                                                                                       221413
     C     CAS004        IFEQ      'Y'
     C                   MOVEA     LTYP          AKY(1)
     C                   MOVE      'A'           AKY(3)
     C                   MOVEA     SUTP          AKY(4)
0781 C                   MOVEA     CLAS          AKY(11)
     C                   MOVEA     '  '          AKY(6)
      *                                                                                       221413
     C     WBOOK         IFEQ      'Y'
     C                   MOVEA     BOKC          AKY(6)
     C                   ENDIF
      *                                                                                       221413
     C     FSEFUP        IFGT      0
     C                   MOVEA     'FIP'         AKY(8)
     C                   Z-SUB     FSEFUP        ACAMNT
     C                   EXSR      AKYOUT
     C                   ENDIF
      *                                                                                       221413
     C     FSEFUP        IFLT      0
     C                   MOVEA     'FIL'         AKY(8)
     C                   Z-ADD     FSEFUP        ACAMNT
     C                   EXSR      AKYOUT
     C                   ENDIF
      *                                                                                       221413
     C                   Z-ADD     0             FSEFUP
      *                                                                                       221413
     C     FSECUP        IFGT      0
     C                   MOVEA     'CIP'         AKY(8)
     C                   Z-SUB     FSECUP        ACAMNT
     C                   EXSR      AKYOUT
     C                   ENDIF
      *                                                                                       221413
     C     FSECUP        IFLT      0
     C                   MOVEA     'CIL'         AKY(8)
     C                   Z-ADD     FSECUP        ACAMNT
     C                   EXSR      AKYOUT
     C                   ENDIF
      *                                                                                       221413
     C                   Z-ADD     0             FSECUP
      *                                                                                       221413
     C                   ENDIF
     C/COPY WNCPYSRC,LE0450C059
1613 C**
1614 C**   SET ON ACCOUNTING ENTRIES BIT
1615 C**
     C     CLE007        IFEQ      'N'
     C     CLE007        OREQ      'Y'
     C     PDGN          ANDEQ     'Y'
     C     CLE007        OREQ      'Y'
     C     *IN47         ANDEQ     '1'
1616 C                   BITON     '2'           ACEI
     C                   ENDIF
      *                                                                   CPB001
      **  If Replication Processing running.                              CPB001
     C     WUREPL        IFEQ      'Y'                                          Begin WUREPL   CPB00
     C                   EXSR      REPLIC                                                      CPB00
      *                                                                   CPB001
     C                   ENDIF                                                  End WUREPL     CPB00
     C/COPY WNCPYSRC,LE0450CP21                                           S01408
1617 C**
1618 C                   ENDSR
1619 C**
1620 C**
1621 C********************************************************************
      ********************************************************************CLE004
      **                                                                  CLE004
      **   SUBROUTINE TO PROCESS TRANSFER OF PRINCIPAL TO                 CLE004
      **                                                                  CLE004
      **   CALLED FROM ACTNS                                              CLE004
      **   CALLS CPAMUP,AKYOUT                                            CLE004
      **                                                                  CLE004
     C     PRINTO        BEGSR                                                                 CLE00
      **                                                                  CLE004
      ** CLE134 - Past Due Call Loans process                                                 CLE134
      *                                                                                       CLE134
     C                   MOVE      'N'           WPDCLL                                       CLE134
     C                   MOVE      'N'           WPDCLA                                       CLE134
     C                   MOVE      'N'           WPDCLR                                       CLE134
     C                   MOVE      'N'           WORIGL                                       CLE134
     C                   MOVE      'N'           WORIGA                                       CLE134
     C                   MOVE      'N'           WMRAUT                                       263416
      *                                                                                       CLE134
      **   Update current principal amount                                CLE004
     C                   Z-ADD     PRAM          AMOUNT           13 0                         CLE00
     C                   EXSR      CPAMUP                                                      CLE00
      **                                                                  CLE004
      **   Update original principal                                      CLE004
     C     ORIGPR        ADD       PRAM          ORIGPR           13 0                         CLE00
     C                   Z-ADD     CPAM          OCPAM                                         CLE00
      **                                                                  CLE004
      **   Generate a/c key for transfer amount                           CLE004
     C                   Z-ADD     VDAT          ACDATE                                        CLE00
     C                   Z-ADD     PRAM          ACAMNT                   89                   CLE00
     C                   MOVE      'V'           AKY(3)                                        CLE00
     C***********          MOVEA'   '     AKY,6                    CLE004 158270
     C                   MOVEA     BKAKY         AKY(6)                                        15827
     C                   MOVE      'T'           AKY(9)                                        CLE00
     C                   MOVE      'A'           AKY(10)                                       CLE00
     C  N89              EXSR      AKYOUT                                                      CLE00
      *                                                                   CLE004
      ** Generate account keys for transfer of principal to.              CLE004
     C     BGN0ST        IFEQ      'Y'                                                         CLE00
     C     FPRCL         ANDNE     *BLANKS                                                     CLE00
      *                                                                   CLE004
      ** Transaction Profit Centre                                        CLE004
     C                   MOVE      'T'           AKY(6)                                        CLE00
     C     *IN89         IFEQ      '0'                                                         CLE00
     C                   EXSR      AKYOUT                                                      CLE00
     C                   ENDIF                                                                 CLE00
      *                                                                   CLE004
      ** Funding Profit Centre                                            CLE004
     C                   MOVE      'F'           AKY(6)                                        CLE00
     C                   MOVEL     PRFC          WPRFC             4                           CLE00
     C                   MOVEL     FPRCL         PRFC                                          CLE00
     C     *IN89         IFEQ      '0'                                                         CLE00
     C                   EXSR      AKYOUT                                                      CLE00
     C                   ENDIF                                                                 CLE00
     C                   MOVEL     WPRFC         PRFC                                          CLE00
     C                   MOVE      ' '           AKY(6)                                        CLE00
      *                                                                   CLE004
     C                   ENDIF                                                                 CLE00
      *                                                                   CLE004
      **  Account key generated with 'R' in AKY (in position 8) if        CLE004
      **  the receiver of guarantee is different to blanks                CLE004
     C     *IN26         IFEQ      '1'                                                         CLE00
     C     WORECE        IFNE      *BLANKS                                                     CLE00
     C**********           Z-ADDCNUML     WORK2                                        CLE004 CSD027
     C                   MOVE      CNUML         WORK2
     C                   MOVE      WORECE        CNUML                                         CLE00
     C                   MOVE      'R'           AKY(8)                                        CLE00
     C  N89              EXSR      AKYOUT                                                      CLE00
     C**********           Z-ADDWORK2     CNUML                                        CLE004 CSD027
     C                   MOVE      WORK2         CNUML
     C                   MOVE      ' '           AKY(8)                                        CLE00
     C                   END                                                                   CLE00
     C                   END                                                                   CLE00
      **                                                                  CLE004
     C                   ENDSR                                                                 CLE00
      **                                                                  CLE004
      **                                                                  CLE004
      ********************************************************************CLE004
      ********************************************************************CLE004
      **                                                                  CLE004
      **   SUBROUTINE TO PROCESS TRANSFER OF PRINCIPAL FROM               CLE004
      **                                                                  CLE004
      **   CALLED FROM ACTNS                                              CLE004
      **   CALLS CPAMUP,AKYOUT(3),INTRST                                  CLE004
      **                                                                  CLE004
     C     PRINFR        BEGSR                                                                 CLE00
      **                                                                  CLE004
      ** CLE134 - Past Due Call Loans process                                                 CLE134
      *                                                                                       CLE134
     C                   MOVE      'N'           WPDCLL                                       CLE134
     C                   MOVE      'N'           WPDCLA                                       CLE134
     C                   MOVE      'N'           WPDCLR                                       CLE134
     C                   MOVE      'N'           WORIGL                                       CLE134
     C                   MOVE      'N'           WORIGA                                       CLE134
     C                   MOVE      'N'           WMRAUT                                       263416
      *                                                                                       CLE134
      **   Update current principal amount                                CLE004
     C                   SETON                                        83                       CLE00
     C                   Z-ADD     CPAM          ACRBAL           13 0                         CLE00
     C                   Z-SUB     PRAM          AMOUNT                                        CLE00
     C                   EXSR      CPAMUP                                                      CLE00
      **                                                                  CLE004
      **   Generate an a/c key for transfer of principal from             CLE004
     C                   Z-ADD     VDAT          ACDATE                                        CLE00
     C                   Z-ADD     PRAM          ACAMNT                   89                   CLE00
     C                   MOVE      'R'           AKY(3)                                        CLE00
     C                   MOVEA     BKAKY         AKY(6)                                        CLE00
     C                   MOVE      'F'           AKY(9)                                        CLE00
     C                   MOVE      'A'           AKY(10)                                       CLE00
     C  N89              EXSR      AKYOUT                                                      CLE00
      *                                                                   CLE004
      **  Generate Transfer From Account Keys                             CLE004
     C     BGN0ST        IFEQ      'Y'                                                         CLE00
     C     FPRCL         ANDNE     *BLANKS                                                     CLE00
      *                                                                   CLE004
      **  -- Transaction Profit Centre                                    CLE004
     C                   MOVEA     'T '          AKY(6)                                        CLE00
     C     *IN89         IFEQ      '0'                                                         CLE00
     C                   EXSR      AKYOUT                                                      CLE00
     C                   ENDIF                                                                 CLE00
      *                                                                   CLE004
      **  -- Funding Profit Centre                                        CLE004
     C                   MOVEA     'F '          AKY(6)                                        CLE00
     C                   MOVEL     PRFC          WPRFC                                         CLE00
     C                   MOVEL     FPRCL         PRFC                                          CLE00
     C     *IN89         IFEQ      '0'                                                         CLE00
     C                   EXSR      AKYOUT                                                      CLE00
     C                   ENDIF                                                                 CLE00
     C                   MOVEL     WPRFC         PRFC                                          CLE00
     C                   MOVEA     BKAKY         AKY(6)                                        CLE00
      *                                                                   CLE004
     C                   ENDIF                                                                 CLE00
      *                                                                   CLE004
      **  Account key generated with 'R' in AKY (in position 8) if        CLE004
      **  the receiver of guarantee is not blank                          CLE004
     C     *IN26         IFEQ      '1'                                                         CLE00
     C     WORECE        IFNE      *BLANKS                                                     CLE00
     C**********           Z-ADDCNUML     WORK2                                        CLE004 CSD027
     C                   MOVE      CNUML         WORK2
     C                   MOVE      WORECE        CNUML                                         CLE00
     C                   MOVE      'R'           AKY(8)                                        CLE00
     C  N89              EXSR      AKYOUT                                                      CLE00
     C**********           Z-ADDWORK2     CNUML                                        CLE004 CSD027
     C                   MOVE      WORK2         CNUML
     C                   MOVE      ' '           AKY(8)                                        CLE00
     C                   END                                                                   CLE00
     C                   END                                                                   CLE00
      **                                                                  CLE004
     C                   ENDSR                                                                 CLE00
      **                                                                  CLE004
      **                                                                  CLE004
      ********************************************************************CLE004
      ********************************************************************CLE004
      **                                                                  CLE004
      **   SUBROUTINE TO PROCESS MULTI-CURRENCY ROLLOVER ACTIONS          CLE004
      **                                                                  CLE004
      **   CALLED FROM ACTNS                                              CLE004
      *****CALLS FREQIN,RATECH                                                         CLE004 CLE031
      **   CALLS FREQIN,RATECH,SETCCY,SETTLE,SECCY2,SETRST                                    CLE031
      **                                                                  CLE004
     C     MROLL         BEGSR                                                                 CLE00
      *                                                                                       CLE034
      ** CLE134 - Past Due Call Loans process                                                 CLE134
      *                                                                                       CLE134
     C                   MOVE      'N'           WPDCLL                                       CLE134
     C                   MOVE      'N'           WPDCLA                                       CLE134
     C                   MOVE      'N'           WPDCLR                                       CLE134
     C                   MOVE      'N'           WORIGL                                       CLE134
     C                   MOVE      'N'           WORIGA                                       CLE134
     C                   MOVE      'N'           WMRAUT                                       263416
      *                                                                                       CLE134
     C     CLE034        IFEQ      'Y'
     C                   MOVE      'R'           WRKROL            1
     C                   ENDIF
      **                                                                  CLE004
     C                   BITOFF    '567'         CNFI                                          CLE00
     C                   Z-ADD     RLDT          ROLLDT            5 0                         CLE00
      *                                                                   CLE004
      ** Save old currency for converting part sold amount.                                   185526
      *                                                                                       185526
     C                   MOVE      CCYL          W#CCY             3
      *                                                                                       185526
      * New currency amount key:-                                         CLE004
     C                   MOVE      RLCY          CCYL                                          CLE00
     C                   MOVE      CCYL          XCCY                                          15398
     C                   EXSR      CCYDSP                                                      15398
     C     XDECP         COMP      1                                    5556                   15398
     C     XDECP         COMP      2                                  58  57                   15398
      *                                                                   153980
     C     *IN99         IFEQ      '1'                                                         15398
     C                   Z-ADD     19            DBASE                                         15398
     C                   MOVE      CCYL          DBKEY                          ***************15398
     C                   SETON                                        U7U8LR    ***  DB19   ***15398
     C                   MOVE      'SDCURRPD'    DBFILE                         ***************15398
     C                   GOTO      ENDMC                                                       15398
     C                   ENDIF                                                                 15398
      *                                                                   153980
     C                   Z-ADD     PRAM          ACAMNT                                        CLE00
      *                                                                   CEU020
      ** Generate the increase in amount in Euro ccy for mccy rollover    CEU020
      *                                                                   CEU020
     C     CEU020        IFEQ      'Y'                                                         CEU02
     C     ECIN          ANDEQ     'Y'                                                         CEU02
     C                   MOVE      'R'           AKY(3)                                        CEU02
     C                   MOVEA     BKAKY         AKY(6)                                        CEU02
     C                   MOVEA     'IA'          AKY(9)                                        CEU02
     C     ACAMNT        IFNE      *ZEROS                                                      CEU02
      *                                                                                       CLE034
      ** If CLE034 is installed                                                               CLE034
      *                                                                                       CLE034
     C     CLE034        IFEQ      'Y'
     C     STAL          ANDEQ     'Y'
     C                   MOVE      'E'           WTYPE
     C                   EXSR      SR34A
     C                   ELSE
     C                   MOVE      'Y'           WRKFLD
     C                   MOVE      '*EOF   '     PRTCD
     C                   ENDIF
      *                                                                                       CLE034
     C     WRKFLD        DOWEQ     'Y'
     C     PRTCD         OREQ      *BLANKS
     C     CLE034        IFEQ      'Y'
     C     STAL          ANDEQ     'Y'
     C                   EXSR      SR34B
     C                   ENDIF
      *                                                                                       CLE031
      ** If CLE031 is on set work type to 'end' and goto SR/SETCCY                            CLE031
      *                                                                                       CLE031
     C     CLE031        IFEQ      'Y'
     C                   MOVE      'E'           WTYPE
     C                   EXSR      SETCCY
     C                   ENDIF
      *                                                                                       CLE031
     C                   EXSR      AKYOUT                                                      CEU02
      *                                                                                       CLE031
      ** If CLE031 is on goto SR/SETTLE                                                       CLE031
      *                                                                                       CLE031
     C     CLE031        IFEQ      'Y'
     C                   EXSR      SETTLE
     C                   ENDIF
      *                                                                                       CLE034
     C     CLE034        IFEQ      'Y'
     C     STAL          ANDEQ     'Y'
     C                   EXSR      SR34C
     C                   ELSE
     C                   MOVE      *BLANKS       WRKFLD
     C                   ENDIF
     C                   ENDDO
      *                                                                                       CLE034
     C     CLE034        IFEQ      'Y'
     C     STAL          ANDEQ     'Y'
     C                   EXSR      SR34E
     C                   ENDIF
      *                                                                                       CLE031
     C                   ENDIF                                                                 CEU02
      *                                                                   CEU020
      ** Generate rolled over amount in Euro ccy                          CEU020
      *                                                                   CEU020
     C                   MOVE      'V'           AKY(3)                                        CEU02
     C                   MOVEA     BKAKY         AKY(6)                                        CEU02
     C                   MOVE      'R'           AKY(10)                                       CEU02
     C     ACAMNT        IFNE      *ZEROS                                                      CEU02
     C                   EXSR      AKYOUT                                                      CEU02
     C                   ENDIF                                                                 CEU02
     C                   MOVE      'A'           AKY(10)                                       CEU02
      *                                                                   CEU020
      ** Not a multiccy rollover in Euro                                  CEU020
      *                                                                   CEU020
     C                   ELSE                                                                  CEU02
     C                   MOVE      'V'           AKY(3)                                        CLE00
     C                   MOVEA     '    '        AKY(6)                                        CLE00
     C                   MOVEA     BKAKY         AKY(6)                                        16597
     C                   MOVE      'A'           AKY(10)                                       CLE00
     C     ACAMNT        IFNE      *ZERO                                                       CLE00
      *                                                                                       CLE034
      ** If CLE034 is installed                                                               CLE034
      *                                                                                       CLE034
     C     CLE034        IFEQ      'Y'
     C     STAL          ANDEQ     'Y'
     C                   MOVE      'S'           WTYPE
     C                   EXSR      SR34A
     C                   ELSE
     C                   MOVE      'Y'           WRKFLD
     C                   MOVE      '*EOF   '     PRTCD
     C                   ENDIF
      *                                                                                       CLE034
     C     WRKFLD        DOWEQ     'Y'
     C     PRTCD         OREQ      *BLANKS
     C     CLE034        IFEQ      'Y'
     C     STAL          ANDEQ     'Y'
     C                   EXSR      SR34B
     C                   ENDIF
      *                                                                                       CLE031
      ** If feature CLE031 is on set work type to start & goto SR/SETCCY                      CLE031
      *                                                                                       CLE031
     C     CLE031        IFEQ      'Y'
     C                   MOVE      'S'           WTYPE
     C                   EXSR      SETCCY
      *                                                                                       CLE031
     C**********           MOVE OSAC      OSACSV 12                                    CLE031 CGL029
     C                   MOVE      OSAC          OSACSV
     C                   MOVE      SETP          SETPSV            2 0
      *                                                                                       CLE031
     C     PTYP          IFNE      66
     C     PTYP          ANDNE     67
     C     PTYP          ANDNE     69
     C     PTYP          ANDNE     72
     C                   MOVE      RONS          OSAC
     C                   MOVE      RSTM          SETP
     C                   ELSE
     C                   MOVE      PONS          OSAC
     C                   MOVE      PSTM          SETP
     C                   ENDIF
      *                                                                                       CLE031
     C                   ENDIF
      *                                                                                       CLE031
     C                   EXSR      AKYOUT                                                      CLE00
      *                                                                                       CLE031
      ** If feature CLE031 is on goto SR/SETTLE                                               CLE031
      *                                                                                       CLE031
     C     CLE031        IFEQ      'Y'
     C                   MOVE      OSACSV        OSAC
     C                   MOVE      SETPSV        SETP
     C                   EXSR      SETTLE
     C                   ENDIF
      *                                                                                       CLE034
     C     CLE034        IFEQ      'Y'
     C     STAL          ANDEQ     'Y'
     C                   EXSR      SR34C
     C                   ELSE
     C                   MOVE      *BLANKS       WRKFLD
     C                   ENDIF
     C                   ENDDO
      *                                                                                       CLE034
     C     CLE034        IFEQ      'Y'
     C     STAL          ANDEQ     'Y'
     C                   EXSR      SR34E
     C                   ENDIF
      *                                                                                       CLE031
     C                   ENDIF                                                                 CLE00
     C                   ENDIF                                                                 CEU02
      *                                                                   CLE004
      ** Profit Centre Accounting                                         CLE004
     C     BGN0ST        IFEQ      'Y'                                                         CLE00
     C     FPRCL         ANDNE     *BLANKS                                                     CLE00
      *                                                                   CLE004
      **  - Transaction Profit Centre                                     CLE004
     C                   MOVE      'T'           AKY(6)                                        CLE00
     C     ACAMNT        IFNE      *ZERO                                                       CLE00
     C                   EXSR      AKYOUT                                                      CLE00
     C                   ENDIF                                                                 CLE00
      *                                                                   CLE004
      ** Funding Profit Centre                                            CLE004
     C                   MOVE      'F'           AKY(6)                                        CLE00
     C                   MOVEL     PRFC          WPRFC             4                           CLE00
     C                   MOVEL     FPRCL         PRFC                                          CLE00
     C     ACAMNT        IFNE      *ZERO                                                       CLE00
     C                   EXSR      AKYOUT                                                      CLE00
     C                   ENDIF                                                                 CLE00
      *                                                                   CLE004
     C                   MOVEL     WPRFC         PRFC                                          CLE00
     C                   MOVE      ' '           AKY(6)                                        CLE00
     C                   ENDIF                                                                 CLE00
      *                                                                   CLE004
     C                   Z-ADD     NROD          RLDT                     89                   CLE00
     C                   Z-ADD     0             NROD                                          CLE00
      *  Only calculate next rollover date using Frequency & Day number   159204
      *           if a 'Next Rollover Date' was not entered.              159204
     C***********RLDT      IFNE *ZERO                               CLE004159204
     C     RLDT          IFEQ      *ZERO                                                       15920
     C                   Z-ADD     VDAT          ZDAYNO                                        CLE00
     C                   Z-ADD     RLDY          ZMDAY                                         CLE00
     C                   MOVE      RLFQ          ZFREQ                                         CLE00
     C                   EXSR      FREQIN                                                      CLE00
     C                   Z-ADD     ZDAYNO        RLDT                                          CLE00
     C                   Z-ADD     ZMDAY         RLDY                                          CLE00
     C                   MOVE      ZFREQ         RLFQ                                          CLE00
     C                   ELSE                                                               AR954080
     C     RLDT          IFGE      MDAT                                                     AR954080
     C     MDAT          ANDNE     0                                                        AR954080
     C                   Z-ADD     0             RLDT                                       AR954080
     C                   Z-ADD     0             RLDY                                       AR954080
     C                   MOVE      ' '           RLFQ                                       AR954080
     C                   ENDIF                                                              AR954080
     C                   ENDIF                                                                 CLE00
      **                                                                  CLE004
      **   Update interest details if needed                              CLE004
     C                   Z-ADD     BRTT          BRTTL                                         CLE00
     C                   Z-ADD     BRTE          BRTEL                                         CLE00
     C                   Z-ADD     RTSP          RTSPL                                         CLE00
     C                   MOVE      SPIN          SPINL                                         CLE00
     C                   MOVE      CHIN          CHINL                                         CLE00
      *                                                                   123335
      ** Update new exchange rates and indicators                         123335
      *                                                                   123335
     C***********          Z-ADDNBCE      BCXR                     123335 135621
     C***********          MOVE NBMD      BMDI                     123335 135621
     C***********          Z-ADDNFCE      FCXR                     123335 135621
     C***********          MOVE NFMD      FMDI                     123335 135621
     C                   MOVE      '1'           *IN19                                         13562
      *                                                                                       CLE023
      ** If CLE023 is installed, output new exchange rate                                     CLE023
      ** and indicators by using *IN22                                                        CLE023
      *                                                                                       CLE023
     C                   MOVE      '1'           *IN22
      *                                                                                       CLE023
     C***********CLE006    IFEQ 'Y'                                CEU020 143511
     C***********          MOVE '1'       *IN18                    135621 143511
     C***********          ENDIF                                   CEU020 143511
      *                                                                   CLE004
      * Get latest 'br' 'bc' 'ro' 'mc' from history.                      CLE004
     C     CLE003        IFEQ      'Y'                                                         CLE00
     C     LNRF          SETGT     LEHISTL0                                                    CLE00
     C     LNRF          READPE    LEHISTL0                               69                   CLE00
     C     *IN69         IFEQ      *OFF                                                        CLE00
     C                   Z-ADD     BRTT#H        BRTTL                                         CLE00
     C                   Z-ADD     BRTE#H        BRTEL                                         CLE00
     C                   Z-ADD     VDAT#H        VDAT                                          CLE00
     C                   ENDIF                                                                 CLE00
      *                                                                   CLE004
      * Get latest 'sc' 'ro' 'mc' from history.                           CLE004
     C     LNRF          SETGT     LEHISTL2                                                    CLE00
     C     LNRF          READPE    LEHISTL2                               69                   CLE00
     C     *IN69         IFEQ      *OFF                                                        CLE00
     C                   Z-ADD     RTSP#H        RTSPL                                         CLE00
     C     VDAT#H        IFGT      VDAT                                                        CLE00
     C                   Z-ADD     VDAT#H        VDAT                                          CLE00
     C                   ENDIF                                                                 CLE00
     C                   ENDIF                                                                 CLE00
     C                   ENDIF                                                                 CLE00
      *                                                                                       CLE036
     C     CLE036        IFEQ      'Y'
     C     BRTTL         IFEQ      0
     C                   Z-ADD     BRTEL         BASRL
     C                   ELSE
     C                   Z-ADD     0             BASRL
     C                   ENDIF
     C                   ENDIF
      *                                                                   CLE004
     C     BGN0ST        IFEQ      'Y'                                                         CLE00
     C     FPRC          ANDNE     *BLANKS                                                     CLE00
     C                   Z-ADD     FSRP          FSRPL                                         CLE00
     C                   MOVE      FSGN          FSGNL                                         CLE00
     C                   MOVEL     FPRC          FPRCL                                         CLE00
      *                                                                   CLE004
      * Get latest 'sc' 'ro' 'mc' from history.                           CLE004
     C     CLE003        IFEQ      'Y'                                                         CLE00
     C     LNRF          SETGT     LEHISTL2                                                    CLE00
     C     LNRF          READPE    LEHISTL2                               69                   CLE00
     C     *IN69         DOWEQ     *OFF                                                        CLE00
     C     FRCF#H        IFEQ      'Y'                                                         CLE00
     C     AMTP#H        ANDEQ     'SC'                                                        CLE00
     C     FPRC#H        ORNE      *BLANKS                                                     CLE00
     C     AMTP#H        ANDEQ     'RO'                                                        CLE00
     C     FPRC#H        ORNE      *BLANKS                                                     CLE00
     C     AMTP#H        ANDEQ     'MC'                                                        CLE00
     C                   Z-ADD     FSRP#H        FSRPL                                         CLE00
     C                   MOVE      FSGN#H        FSGNL                                         CLE00
     C                   LEAVE                                                                 CLE00
     C                   ENDIF                                                                 CLE00
      *                                                                   CLE004
     C     LNRF          READPE    LEHISTL2                               69                   CLE00
     C                   ENDDO                                                                 CLE00
     C                   ENDIF                                                                 CLE00
      *                                                                   CLE004
     C                   ENDIF                                                                 CLE00
     C                   Z-ADD     CALC          ICBS                                          CLE00
      *                                                                   169623
      ** Loan is a discounted loan                                        169623
      *                                                                   169623
     C     PTYP          IFEQ      63                                                          16962
     C     PTYP          OREQ      65                                                          16962
     C     PTYP          OREQ      67                                                          16962
     C                   Z-ADD     RLDT          MDAT                                          16597
     C                   ENDIF                                                                 16962
      *                                                                   CLE004
      **                                                                  CLE004
      **   CHECK FOR CHANGE OF DETAILS                                    CLE004
      **                                                                  CLE004
     C     CEU020        IFEQ      'Y'                                                         14491
     C     AMTP#H        ANDEQ     'MC'                                                        14491
     C     RLCY          ANDNE     *BLANKS                                                     14491
     C     BRTTL         ANDNE     *ZEROS                                                      14491
     C     NBRA          ANDEQ     *ZEROS                                                      14491
     C                   Z-ADD     BRTTL         NBRA                                          14491
     C                   ENDIF                                                                 14491
      *                                                                                       CLE036
     C     CEU020        IFEQ      'Y'
     C     CLE036        ANDEQ     'Y'
     C     AMTP#H        ANDEQ     'MC'
     C     RLCY          ANDNE     *BLANKS
     C     BASRL         ANDNE     *ZEROS
     C     NBSR          ANDEQ     *ZEROS
     C                   Z-ADD     BASRL         NBSR
     C                   ENDIF
      *                                                                                       CLE036
     C     NBRA          COMP      0                                  8989                     CLE00
     C  N89NRTS          COMP      0                                  8989                     CLE00
     C  N89NSIN          COMP      ' '                                8989                     CLE00
     C  N89NCAC          COMP      0                                  8989                     CLE00
      *                                                                                       CLE036
     C     CLE036        IFEQ      'Y'
     C     *IN89         ANDEQ     '0'
     C     NBSR          IFNE      0
     C                   MOVE      '1'           *IN89
     C                   ENDIF
     C                   ENDIF
      **                                                                  CLE004
      *                                                                   156501
      ** Allow to calculate interest rate when change indicator is R      156501
      *                                                                   156501
     C     *IN89         IFEQ      '0'                                                         15650
     C     BRTTL         ANDNE     0                                                           15650
     C     CHINL         ANDEQ     'R'                                                         15650
     C                   MOVE      '1'           *IN89                                         15650
     C                   ENDIF                                                                 15650
      *                                                                                       CLE036
     C     CLE036        IFEQ      'Y'
     C     *IN89         ANDEQ     '0'
     C     BASRL         ANDNE     0
     C     CHINL         ANDEQ     'R'
     C                   MOVE      '1'           *IN89
     C                   ENDIF
      *                                                                   156501
     C   89              EXSR      RATECH                                                      CLE00
      *                                                                   CLE004
     C     BGN0ST        IFEQ      'Y'                                                         CLE00
     C     *IN89         IFEQ      '1'                                                         CLE00
     C     NFPC          ORNE      *BLANKS                                                     CLE00
     C                   EXSR      SRFUND                                                      CLE00
     C                   ENDIF                                                                 CLE00
     C                   ENDIF                                                                 CLE00
      **                                                                  CLE004
      **   ZEROISE NEXT ROLL DETAILS                                      CLE004
      **                                                                  CLE004
     C                   Z-ADD     0             NBRA                                          CLE00
     C     CLE036        IFEQ      'Y'
     C                   Z-ADD     0             NBSR
     C                   ENDIF
     C                   Z-ADD     0             NRTS                                          CLE00
     C                   MOVE      ' '           NSIN                                          CLE00
     C                   Z-ADD     0             NCAC                                          CLE00
     C                   MOVE      ' '           NCHI                                          CLE00
      *                                                                   CLE004
     C     BGN0ST        IFEQ      'Y'                                                         CLE00
     C                   Z-ADD     0             NFRS                                          CLE00
     C                   MOVE      *BLANKS       NFSN                                          CLE00
     C                   MOVE      *BLANKS       NFPC                                          CLE00
     C                   ENDIF                                                                 CLE00
      *                                                                   CLE004
      **  Perform the following only if switchable feature is ON          CLE004
      *                                                                   CLE004
     C     *IN25         IFEQ      '1'                                                         CLE00
      *                                                                   CLE004
      **  Update maturity date with the new value from new maturity       CLE004
      **  date field (if not blank)                                       CLE004
      *                                                                   CLE004
     C     NMDT          IFNE      *ZEROS                                                      CLE00
     C                   Z-ADD     NMDT          MDAT                                          CLE00
     C                   END                                                                   CLE00
     C/COPY WNCPYSRC,LE0450C058
     C                   Z-ADD     *ZEROS        NMDT                                          CLE00
      *                                                                   CLE004
      **  New processing for rollover of next interest payment date       CLE004
      *                                                                   CLE004
      **  If new interest payment date is not zero,                       CLE004
      ****and*interest*pay*frequency*is*blank,**********************CLE004159199
      **  update the next interest payment date on the loan.              CLE004
      *                                                                   CLE004
     C     CLE003        IFEQ      'N'                                                         CLE00
     C     CLE003        OREQ      'Y'                                                         CLE00
     C     NIPD          ANDGT     SLID                                                        CLE00
     C     NIPD          IFNE      *ZEROS                                                      CLE00
     C***********IPFR      ANDEQ' '                                 CLE004159199
     C                   Z-ADD     NIPD          NIDT                                          CLE00
     C                   END                                                                   CLE00
     C                   ENDIF                                                                 CLE00
     C                   Z-ADD     *ZEROS        NIPD                                          CLE00
      *                                                                   CLE004
     C                   END                                                                   CLE00
      *                                                                   165977
      ** For discount loans, generate value date account keys             165977
      *                                                                   165977
     C     *IN45         IFEQ      *ON                                                         16597
     C     ECIN          ANDEQ     'N'                                                         16597
      *                                                                   165977
      ** Discount keys                                                    165977
      *                                                                   165977
     C                   MOVE      *ON           *IN81                                         16597
     C                   Z-ADD     ROLLDT        ZIBEG                                         16597
     C                   Z-ADD     CALC          ZICALC                                        16597
     C                   Z-ADD     MDAT          ZIEND                                         16597
     C     ZIEND         IFEQ      0                                                           16597
     C     ROLLDT        ADD       1             ZIEND                                         16597
     C                   ENDIF                                                                 16597
      *                                                                   165977
     C     PTYP          IFEQ      63                                                          16597
     C     ADDI          ANDEQ     'B'                                                         16597
     C                   ADD       1             ZIEND                                         16597
     C                   ENDIF                                                                 16597
      *                                                                   165977
     C                   Z-ADD     INTRL         ZIRATE                                        16597
     C                   Z-ADD     PRAM          ZIAMT                                         16597
     C/COPY WNCPYSRC,LE0450C064
     C                   EXSR      GLINTC                                                      16597
     C/COPY WNCPYSRC,LE0450C066
      *                                                                   165977
     C     RDFC          IFEQ      'Y'                                                         16597
     C                   Z-ADD     ZINTR         WRK13                                         16597
     C                   ELSE                                                                  16597
     C                   Z-ADD(H)  ZINTR         WRK13                                         16597
     C                   ENDIF                                                                 16597
      *                                                                   165977
     C                   Z-ADD     WRK13         ACAMNT                                        16597
     C     ACAMNT        IFLT      0                                                           16597
     C                   MOVE      'P'           AKY(10)                                       16597
     C                   Z-SUB     ACAMNT        ACAMNT                                        16597
     C                   ELSE                                                                  16597
     C                   MOVE      'D'           AKY(10)                                       16597
     C                   ENDIF                                                                 16597
     C     ACAMNT        IFNE      0                                                           16597
     C                   EXSR      AKYOUT                                                      16597
     C                   ENDIF                                                                 16597
      *                                                                   165977
      ** Settlement amount key                                            165977
      *                                                                   165977
     C     PRAM          SUB       WRK13         ACAMNT                                        16597
     C                   MOVE      'B'           AKY(10)                                       16597
     C     ACAMNT        IFNE      0                                                           16597
      *                                                                                       CLE034
      ** If CLE034 is installed                                                               CLE034
      *                                                                                       CLE034
     C     CLE034        IFEQ      'Y'
     C     STAL          ANDEQ     'Y'
     C     WTYPE         IFEQ      'E'
     C                   MOVE      'S'           WTYPE
     C**********           MOVE 'Y'       WCHGD   1                                    CLE034 219141
     C                   ENDIF
     C                   EXSR      SR34A
     C**********           ENDIF                                                       CLE034 219141
     C********** WCHGD     IFEQ 'Y'                                                    CLE034 219141
     C**********           MOVE 'E'       WTYPE                                        CLE034 219141
     C**********           MOVE ' '       WCHGD                                        CLE034 219141
     C**********           ENDIF                                                       CLE034 219141
     C                   ELSE
     C                   MOVE      'Y'           WRKFLD
     C                   MOVE      '*EOF   '     PRTCD
     C                   ENDIF
      *                                                                                       CLE034
     C     WRKFLD        DOWEQ     'Y'
     C     PRTCD         OREQ      *BLANKS
     C     CLE034        IFEQ      'Y'
     C     STAL          ANDEQ     'Y'
     C                   EXSR      SR34B
     C                   EXSR      SETCCY
     C                   ELSE
      *                                                                                       CLE031
      ** If feature CLE031 is on                                                              CLE031
      *                                                                                       CLE031
     C     CLE031        IFEQ      'Y'
      *                                                                                       CLE031
      ** If work type is 'end' set work type to start and goto SR/SETCCY                      CLE031
      ** Else goto SR/SECCY2                                                                  CLE031
      *                                                                                       CLE031
     C     WTYPE         IFEQ      'E'
     C                   MOVE      'S'           WTYPE
     C                   EXSR      SETCCY
     C                   ELSE
     C                   EXSR      SECCY2
     C                   ENDIF
      *                                                                                       CLE031
     C                   ENDIF
     C                   ENDIF
      *                                                                                       CLE031
     C                   EXSR      AKYOUT                                                      16597
      *                                                                                       CLE031
      ** If feature CLE031 is on goto SR/SETRST                                               CLE031
      *                                                                                       CLE031
     C     CLE031        IFEQ      'Y'
     C                   EXSR      SETRST
     C                   ENDIF
      *                                                                                       CLE031
     C     CLE034        IFEQ      'Y'
     C     STAL          ANDEQ     'Y'
     C                   EXSR      SR34C
     C                   ELSE
     C                   MOVE      *BLANKS       WRKFLD
     C                   ENDIF
     C                   ENDDO
      *                                                                                       CLE034
     C     CLE034        IFEQ      'Y'
     C     STAL          ANDEQ     'Y'
     C                   EXSR      SR34E
     C                   ENDIF
      *                                                                                       CLE034
     C                   ENDIF                                                                 16597
      *                                                                                       CAS005
     C     CAS005        IFEQ      'Y'
     C     MARG          IFLT      0
     C                   Z-SUB     MARG          WAVMAR            7 5
     C                   ELSE
     C                   Z-ADD     MARG          WAVMAR
     C                   ENDIF
     C     ZIRATE        IFGT      WAVMAR
     C                   SUB       MARG          ZIRATE
     C                   ELSE
     C                   Z-ADD     0             ZIRATE
     C                   ENDIF
      *                                                                                       CAS005
     C                   EXSR      GLINTC
      *                                                                                       CAS005
     C     RDFC          IFEQ      'Y'
     C                   Z-ADD     ZINTR         WRK13N
     C                   ELSE
     C                   Z-ADD(H)  ZINTR         WRK13N
     C                   ENDIF
     C                   Z-ADD     WRK13N        TOTN
     C                   Z-ADD     0             AIPN
     C                   Z-ADD     0             AIAN
     C                   Z-ADD     0             AITN
     C                   Z-ADD     0             IPRN
     C                   Z-ADD     0             IWON
     C                   ENDIF
      *                                                                   165977
      ** Update file amounts                                              165977
      *                                                                   165977
     C                   Z-ADD     WRK13         TOTI                                          16597
     C                   Z-ADD     ROLLDT        IACD                                          16597
     C                   Z-ADD     ROLLDT        SLID                                          16597
     C                   Z-ADD     0             AIPD                                          16597
     C                   Z-ADD     0             AIAP                                          16597
     C                   Z-ADD     0             AITC                                          16597
     C                   Z-ADD     0             IPRD                                          16597
     C                   Z-ADD     0             IWOD                                          16597
     C                   ENDIF                                                                 16597
      *                                                                   CLE004
      * Set new principal                                                 CLE004
     C                   Z-ADD     PRAM          CPAM                                          CLE00
      *                                                                   CLE004
     C     CAS005        IFEQ      'Y'
     C                   Z-ADD     FSPRAM        FSCPAM
     C                   ENDIF
      *                                                                                       CAS005
      ** Save date of this multicurrency rollover                                             185526
      *                                                                                       185526
     C                   Z-ADD     VDAT          W#MC              5 0
      *                                                                                       185526
      * Update last rollover dates                                        CLE004
     C                   Z-ADD     VDAT          LRLD                                          CLE00
     C                   Z-ADD     VDAT          LMCD                                          CLE00
      *                                                                   CLE011
     C     CLE011        IFEQ      'Y'                                                         CLE01
     C                   MOVE      *BLANKS       RFRI                                          CLE01
     C                   Z-ADD     *ZERO         RFRT                                          CLE01
     C                   ENDIF                                                                 CLE01
      *                                                                   144915
     C     CEU020        IFEQ      'Y'                                                         14491
     C                   MOVE      'Y'           WMCYR                                         14491
     C                   ENDIF                                                                 14491
     C***********          ENDSR                                    CLE004153980
      *                                                                                       CLE034
     C     CLE034        IFEQ      'Y'
     C                   MOVE      *BLANK        WRKROL
     C                   ENDIF
      *                                                                                       CLE034
     C     ENDMC         ENDSR                                                                 15398
      **                                                                  CLE004
      ********************************************************************CLE004
1622 C********************************************************************
1623 C**
1624 C**   SUBROUTINE TO PROCESS PARTS SOLD MOVEMENTS - PARTS
1625 C**
1626 C**   CALLED FROM ACTNS
1627 C**   CALLS NO OTHER SUBROUTINES
1628 C**
1629 C     PARTS         BEGSR                                                  ***  PARTS  ***
      *                                                                                       CLE034
      *                                                                                       CLE134
      ** CLE134 - Past Due Call Loans process                                                 CLE134
      *                                                                                       CLE134
     C                   MOVE      'N'           WPDCLL                                       CLE134
     C                   MOVE      'N'           WPDCLA                                       CLE134
     C                   MOVE      'N'           WPDCLR                                       CLE134
     C                   MOVE      'N'           WORIGL                                       CLE134
     C                   MOVE      'N'           WORIGA                                       CLE134
     C                   MOVE      'N'           WMRAUT                                       263416
      *                                                                   134725
      ** Convert amount to new ccy  before adding or subtracting          134725
      ** to PSAM when loan and Parts sold rolled over to new ccy.         134725
      *                                                                   134725
     C********** RLDT      IFLE RDNB                                                   134725 185526
     C********** NCCY      ANDNE*BLANKS                                                134725 185526
     C********** CCYL      ANDNENCCY                                                   134725 185526
     C     W#MC          IFLE      RDNB
     C     W#MC          ANDNE     0
     C     AMTP          ANDNE     'MC'                                                        13472
      *                                                                                       185526
      ** Obtain new currency details from CLOANCK.                                            185526
      *                                                                                       185526
     C                   MOVEL     'B'           WRCDT             1
     C**********         Z-ADD     LNRF          WLNRF             6 0                 185526 CLE148
     C                   MOVEL     LNRF          WLNRF             6                          CLE148
     C     CLOKEY        CHAIN     CLOANCKF                           77
      *                                                                                       185526
     C     *IN77         IFEQ      '1'
     C                   MOVE      *BLANKS       DBKEY
     C                   MOVEL     LNRF          DBKEY
     C                   MOVE      *BLANKS       DBPGM
     C                   MOVEL     'LE0450  '    DBPGM                          ************
     C                   MOVEL     'CLOANCK'     DBFILE                         * DBASE 21 *
     C                   Z-ADD     21            DBASE                          ************
     C                   MOVE      '1'           *INU7
     C                   MOVE      '1'           *INU8
     C                   MOVE      '1'           *INLR
     C                   GOTO      PARTEN
      *                                                                                       185526
     C                   ELSE
     C     NCCY          IFNE      W#CCY
     C     NCCY          ANDNE     *BLANKS
     C                   MOVE      NCCY          XCCY                                          13472
     C                   EXSR      CCYDSP                                                      13472
     C**********           Z-ADDCDP       WNCDP   10                                   134725 185526
     C**********           MOVE CCYL      XCCY                                         134725 185526
     C                   Z-ADD     XDECP         WNCDP             1 0
     C                   MOVE      W#CCY         XCCY
     C                   EXSR      CCYDSP                                                      13472
     C                   Z-ADD     FCXR          ZRATE1           13 8                         13472
     C                   MOVE      FMDI          ZMDI1             1                           13472
     C                   MOVE      NFMD          ZMDI2             1                           13472
     C                   Z-ADD     NFCE          ZRATE2           13 8                         13472
     C                   EXSR      ZXRATE                                                      13472
     C**********           Z-ADDCDP       ZCDPI                                        134725 185526
     C                   Z-ADD     XDECP         ZCDPI
     C                   Z-ADD     WNCDP         ZCDPO                                         13472
     C                   Z-ADD     AMNT          ZAMTCI                                        13472
     C                   Z-ADD     *ZEROS        ZAMTCO                                        13472
     C                   Z-ADD     ZRATEX        ZEXCH                                         13472
     C                   MOVE      ZMDIX         ZMD                                           13472
     C                   EXSR      ZCONV                                                       13472
     C                   Z-ADD     ZAMTCO        AMNT                                          13472
     C                   ENDIF                                                                 13472
     C                   ENDIF
     C                   ENDIF
      *                                                                   134725
1630 C**
1631 C**   ACCUMULATE NUMBER OF RECORDS READ
1632 C**
1633 C     NORP          ADD       1             NORP
1634 C**
1635 C**   UPDATE PARTS SOLD AMOUNT ON LOAN 'A' RECORD
1636 C**
1637 C     AMTP          COMP      'IN'                                   89
     C  N89AMTP          COMP      'PI'                                   89                   BHF49
1638 C   89PSAM          ADD       AMNT          PSAM
     C**
     C**   ONLY SUBTRACT AMOUNT FOR MA ACTIONS IF PART SOLD AUTO-SETTLE
     C**
     C***********AMTP      COMP 'MA'                     84               091165
     C***84******AUTOP     COMP 'Y'                  8484                 091165
     C**N89N84***PSAM      SUB  AMNT      PSAM                            091165
     C*                                                                   091165
     C***********AMTP      COMP 'MA'                     89        091165 097002
     C***89******AUTOP     COMP 'Y'                  8484          091165 097002
     C***89N84***PSAM      SUB  AMNT      PSAM                     091165 097002
     C     AMTP          COMP      'MA'                                   84                   09700
     C   84AUTOP         COMP      'Y'                                8484                     09700
      *                                                                                       CLE134
     C   84AUTOP         IFEQ      'C'                                                        CLE134
     C     CLE134        IFEQ      'Y'                                                        CLE134
     C                   MOVE      *OFF          *IN84                                        CLE134
     C                   ENDIF                                                                CLE134
     C                   ENDIF                                                                CLE134
      *                                                                   138350
     C                   MOVE      'N'           WRISK             1                           13835
      *                                                                   138350
      ** Check if loan is a risk participant                              138350
      *                                                                   138350
     C     PTYP          IFEQ      70                                                          13835
     C     AMTP          ANDEQ     'MA'                                                        13835
     C     PTYP          OREQ      71                                                          13835
     C     AMTP          ANDEQ     'MA'                                                        13835
     C     WKEY          KLIST                                                                 13835
     C**********           KFLD           BRCA                                         138350 CLE106
     C                   KFLD                    FCUS                                          13835
     C                   KFLD                    FTYP                                          13835
     C                   KFLD                    FSEQ                                          13835
      *                                                                   138350
     C********** WKEY      CHAINLEPARTL1             12                                138350 CLE106
     C     WKEY          CHAIN     LEFCLTLO                           12
     C     *IN12         IFEQ      '0'                                                         13835
     C                   MOVE      'Y'           WRISK                                         13835
     C                   ENDIF                                                                 13835
      *                                                                   138350
     C     WRISK         IFEQ      'N'                                                         13835
     C     PSAM          ANDNE     0                                                           13835
     C                   MOVE      '0'           *IN84                                         13835
     C                   ELSE                                                                  13835
     C                   MOVE      '1'           *IN84                                         13835
     C                   ENDIF                                                                 13835
     C                   ENDIF                                                                 13835
      *                                                                   138350
     C**N89N84***PSAM      SUB  AMNT      PSAM                     097002 135349
      *                                                                   135349
      ** If not a principal transfer transaction, update PSAM             135349
      *                                                                   135349
     C     AMTP          IFNE      'PF'                                                        13534
     C     AMTP          ANDNE     'PT'                                                        13534
     C     AMTP          ANDNE     'MC'                                                        13472
      *                                                                   135349
     C     *IN84         IFEQ      '0'                                                         13534
     C     *IN89         ANDEQ     '0'                                                         13534
     C     PSAM          SUB       AMNT          PSAM                                          13534
     C                   ENDIF                                                                 13534
      *                                                                   135349
     C                   ENDIF                                                                 13534
      *                                                                   134725
     C     AMTP          IFEQ      'MC'                                                        13472
     C                   ADD       AMNT          PSAM                                          13472
     C                   ENDIF                                                                 13472
1640 C**
1641 C**   UPDATE NO. OF PARTS SOLD ON 'A' REC FOR MATURITY OF PARTS SOLD
1642 C**
1643 C     AMTP          COMP      'MA'                                   89
     C   89AUTOP         COMP      'Y'                                    89
      *                                                                                       CLE134
     C  N89AUTOP         IFEQ      'C'                                                        CLE134
     C     CLE134        IFEQ      'Y'                                                        CLE134
     C                   MOVE      *ON           *IN89                                        CLE134
     C                   ENDIF                                                                CLE134
     C                   ENDIF                                                                CLE134
      *                                                                                       201762
      * If the original loan is a risk loan, then it can mature even                          201762
      * though the part sold is non-autosettle.                                               201762
      *                                                                                       201762
     C     PTYP          IFEQ      70                                           If Risk loan
     C     PTYP          OREQ      71
      *                                                                   138350
     C     AMTP          IFEQ      'MA'                                                        13835
     C     WRISK         ANDEQ     'N'                                                         13835
     C     PSAM          ANDNE     0                                                           13835
     C                   MOVE      '1'           *IN89                                         13835
     C                   ELSE                                                                  13835
     C                   MOVE      '0'           *IN89                                         13835
     C                   ENDIF                                                                 13835
      *                                                                                       201762
     C                   ENDIF                                                  End 'If Risk'
      *                                                                   138350
1644 C   89NOPS          SUB       1             NOPS
1645 C**
     C****FOR*MANUAL REPAYMENT, SUBTRACT REPAYMENT AMOUNT FROM PART078889 097002
     C****SOLD*AMOUNT                                              078889 097002
     C***********AMTP      COMP 'MR'                     89        078889 097002
     C***89******PSAM      SUB  AMNT      PSAM                     078889 097002
     C*                                                                   078889
     C     PARTEN        TAG                                                    *** PARTEN ***
1646 C                   ENDSR
1647 C**
1648 C**
1649 C********************************************************************
1650 C********************************************************************
     C**   SUBROUTINE TO PROCESS LOAN SUB-TYPE AMENDMENT                  S01270
     C**                                                                  S01270
     C**   CALLED FROM ACTNS                                              S01270
     C**   CALLS NOTHING                                                  S01270
     C**                                                                  S01270
     C     LOANSR        BEGSR                                                                 S0127
      *                                                                   BH3482
      *                                                                                       CLE134
      ** CLE134 - Past Due Call Loans process                                                 CLE134
      *                                                                                       CLE134
     C                   MOVE      'N'           WPDCLL                                       CLE134
     C                   MOVE      'N'           WPDCLA                                       CLE134
     C                   MOVE      'N'           WPDCLR                                       CLE134
     C                   MOVE      'N'           WORIGL                                       CLE134
     C                   MOVE      'N'           WORIGA                                       CLE134
     C                   MOVE      'N'           WMRAUT                                       CLE134
      *                                                                                       CLE134
      ** Set-on *IN54 to output a RECI of 'S' for Loan sub-type A/C       BH3482
      ** keys. (Used to prevent facility history action record being      BH3482
      ** generated for repayment A/C keys generated for Loan sub-type     BH3482
      ** changes).                                                        BH3482
      *                                                                   BH3482
     C                   SETON                                        54                       BH348
      *                                                                   BH3482
     C**                                                                  S01270
     C**   CALCULATE ACCRUED INTEREST AND NOT YET RECEIVED                S01270
     C**   FOR PROCESSING TYPES 61,62,64 & 66                             S01270
      ** Processing types 68,69 and 72 are call parts purch, call parts   CLE005
      ** sold, and risk part sold, respectively, introduced by CLE005     CLE005
      ** Processing type 80 is flat rate personal loan                                        CLE028
     C**                                                                  S01270
     C     PTYP          IFEQ      61                                                          S0127
     C     PTYP          OREQ      62                                                          S0127
     C     PTYP          OREQ      64                                                          S0127
     C     PTYP          OREQ      66                                                          S0127
     C     PTYP          OREQ      68                                                          CLE00
     C     CLE005        ANDEQ     'Y'                                                         CLE00
     C     PTYP          OREQ      69                                                          CLE00
     C     CLE005        ANDEQ     'Y'                                                         CLE00
     C     PTYP          OREQ      70
     C     PTYP          OREQ      71
     C     CLE005        ANDEQ     'Y'
     C     PTYP          OREQ      72                                                          CLE00
     C     CLE005        ANDEQ     'Y'                                                         CLE00
     C     PTYP          OREQ      80
     C     CLE028        ANDEQ     'Y'
     C**                                                                  S01270
     C     AIPD          SUB       IPRD          ANYR             13 0                         S0127
      *                                                                   113271
      ** also deduct the capitalised interest                             113271
      *                                                                   113271
     C     ANYR          SUB       ICTD          ANYR                                          11327
     C     ANYR          IFNE      0                                                           S0127
     C**                                                                  S01270
     C**   GENERATE OLD LOAN-TYPE/SUB-TYPE ACCOUNT KEYS                   S01270
     C**                                                                  S01270
     C**********         Z-ADD     RUND          ACDATE                              S01270 MD012157
     C                   Z-ADD     VDAT          ACDATE                                     MD012157
     C                   Z-ADD     ANYR          ACAMNT                                        S0127
     C                   MOVEA     LTYP          AKY(1)                                        S0127
      *                                                                                     MD033575
     C     SPLITF        IFne      'Y'                                                      MD033575
     C                   MOVE      'A'           AKY(3)                                        S0127
     C                   Else                                                               MD033575
     C                   Move      'T'           AKY(3)                                     MD033575
     C                   EndIF                                                              MD033575
      *                                                                                     MD033575
     C                   MOVEA     SUTP          AKY(4)                                        S0127
0781 C                   MOVEA     CLAS          AKY(11)
     C                   MOVEA     BKAKY         AKY(6)                                        S0127
     C     CLE028        IFEQ      'Y'
     C     PTYP          ANDEQ     80
     C     ADIF          ANDEQ     'Y'
     C                   MOVE      'D'           AKY(10)
     C                   ELSE
     C                   MOVE      'I'           AKY(10)                                       S0127
     C                   ENDIF
     C/COPY WNCPYSRC,LEH01076
     C                   SETON                                        53                       S0127
     C                   EXSR      AKYOUT                                                      S0127
     C**                                                                  S01270
     C**   GENERATE NEW LOAN-TYPE/SUB-TYPE ACCOUNT KEYS                   S01270
     C**                                                                  S01270
     C                   MOVEA     LTYPA         AKY(1)                                        S0127
     C                   MOVEA     SUTPA         AKY(4)                                        S0127
0781 C                   MOVEA     CLASA         AKY(11)
     C/COPY WNCPYSRC,LEH01077
     C                   SETOFF                                       53                       S0127
     C                   EXSR      AKYOUT                                                      S0127
     C                   END                                                                   S0127
      *                                                                   CAC001
     C     BGN0ST        IFEQ      'Y'                                                         CAC00
     C     FPRCL         ANDNE     *BLANKS                                                     CAC00
      *                                                                   CAC001
      **  Calculate posting amount                                        CAC001
      *                                                                   CAC001
     C     ACPD          SUB       COFD          ACAMNT                   89                   CAC00
      *                                                                   CAC001
      **  Generate old loan type/sub-type account keys                    CAC001
      *                                                                   CAC001
      **  Transaction Profit Centre                                       CAC001
      *                                                                   CAC001
     C**********         Z-ADD     RUND          ACDATE                              CAC001 MD012157
     C                   Z-ADD     VDAT          ACDATE                                     MD012157
     C                   MOVEA     LTYP          AKY(1)                                        CAC00
      *                                                                                     MD033575
     C     SPLITF        IFne      'Y'                                                      MD033575
     C                   MOVE      'A'           AKY(3)                                        CAC00
     C                   Else                                                               MD033575
     C                   Move      'T'           AKY(3)                                     MD033575
     C                   EndIF                                                              MD033575
      *                                                                                     MD033575
     C                   MOVEA     SUTP          AKY(4)                                        CAC00
0781 C                   MOVEA     CLAS          AKY(11)
     C                   MOVEA     'T   '        AKY(6)                                        CAC00
     C     CLE028        IFEQ      'Y'
     C     PTYP          ANDEQ     80
     C     ADIF          ANDEQ     'Y'
     C                   MOVE      'D'           AKY(10)
     C                   ELSE
     C                   MOVE      'I'           AKY(10)                                       CAC00
     C                   ENDIF
     C                   SETON                                        53                       CAC00
     C     *IN89         IFEQ      '0'                                                         CAC00
     C                   EXSR      AKYOUT                                                      CAC00
     C                   ENDIF                                                                 CAC00
      *                                                                   CAC001
      **  Funding Profit Centre                                           CAC001
      *                                                                   CAC001
     C                   MOVEA     'F   '        AKY(6)                                        CAC00
     C                   MOVEL     PRFC          WPRFC                                         CAC00
     C                   MOVEL     FPRCL         PRFC                                          CAC00
     C     *IN89         IFEQ      '0'                                                         CAC00
     C                   EXSR      AKYOUT                                                      CAC00
     C                   ENDIF                                                                 CAC00
     C                   MOVEL     WPRFC         PRFC                                          CAC00
      *                                                                   CAC001
      **  Generate new loan type/sub-type account keys                    CAC001
      *                                                                   CAC001
      **  Transaction Profit Centre                                       CAC001
      *                                                                   CAC001
     C                   MOVEA     LTYPA         AKY(1)                                        CAC00
     C                   MOVEA     SUTPA         AKY(4)                                        CAC00
0781 C                   MOVEA     CLASA         AKY(11)
     C                   MOVEA     'T   '        AKY(6)                                        CAC00
     C                   SETOFF                                       53                       CAC00
     C     *IN89         IFEQ      '0'                                                         CAC00
     C                   EXSR      AKYOUT                                                      CAC00
     C                   ENDIF                                                                 CAC00
      *                                                                   CAC001
      **  Funding Profit Centre                                           CAC001
      *                                                                   CAC001
     C                   MOVEA     'F   '        AKY(6)                                        CAC00
     C                   MOVEL     PRFC          WPRFC                                         CAC00
     C                   MOVEL     FPRCL         PRFC                                          CAC00
     C     *IN89         IFEQ      '0'                                                         CAC00
     C                   EXSR      AKYOUT                                                      CAC00
     C                   ENDIF                                                                 CAC00
     C                   MOVEL     WPRFC         PRFC                                          CAC00
     C                   MOVEA     BKAKY         AKY(6)                                        CAC00
      *                                                                   CAC001
     C                   ENDIF                                                  - BGN0ST       CAC00
      *                                                                   CAC001
     C                   END                                                                   S0127
     C**                                                                  S01270
     C**   CALCULATE ACCRUED TAX POSTED BUT NOT YET PAID                  S01270
     C**   FOR PROCESSING TYPES 61,62,64 & 66                             S01270
      ** Processing types 68,69 and 72 are call parts purch, call parts   CLE005
      ** sold, and risk part sold, respectively, introduced by CLE005     CLE005
      ** Processing type 80 is flat rate personal loan                                        CLE028
     C**                                                                  S01270
     C     PTYP          IFEQ      61                                                          S0127
     C     PTYP          OREQ      62                                                          S0127
     C     PTYP          OREQ      64                                                          S0127
     C     PTYP          OREQ      66                                                          S0127
     C     PTYP          OREQ      68                                                          CLE00
     C     CLE005        ANDEQ     'Y'                                                         CLE00
     C     PTYP          OREQ      69                                                          CLE00
     C     CLE005        ANDEQ     'Y'                                                         CLE00
     C     PTYP          OREQ      70
     C     PTYP          OREQ      71
     C     CLE005        ANDEQ     'Y'
     C     PTYP          OREQ      72                                                          CLE00
     C     CLE005        ANDEQ     'Y'                                                         CLE00
     C     PTYP          OREQ      80
     C     CLE028        ANDEQ     'Y'
     C     AWTP          SUB       WTRD          WNYR             13 0                         S0127
     C     WNYR          IFNE      0                                                           S0127
     C**                                                                  S01270
     C**   GENERATE OLD LOAN-TYPE/SUB-TYPE ACCOUNT KEYS                   S01270
     C**                                                                  S01270
     C**********         Z-ADD     RUND          ACDATE                              S01270 MD012157
     C                   Z-ADD     VDAT          ACDATE                                     MD012157
     C                   Z-ADD     WNYR          ACAMNT                                        S0127
     C                   MOVEA     LTYP          AKY(1)                                        S0127
      *                                                                                     MD033575
     C     SPLITF        IFne      'Y'                                                      MD033575
     C                   MOVE      'A'           AKY(3)                                        S0127
     C                   Else                                                               MD033575
     C                   Move      'T'           AKY(3)                                     MD033575
     C                   EndIF                                                              MD033575
      *                                                                                     MD033575
     C                   MOVEA     SUTP          AKY(4)                                        S0127
0781 C                   MOVEA     CLAS          AKY(11)
     C                   MOVEA     BKAKY         AKY(6)                                        S0127
     C                   MOVE      'W'           AKY(10)                                       S0127
     C                   SETON                                        53                       S0127
     C                   EXSR      AKYOUT                                                      S0127
     C**                                                                  S01270
     C**   GENERATE NEW LOAN-TYPE/SUB-TYPE ACCOUNT KEYS                   S01270
     C**                                                                  S01270
     C                   MOVEA     LTYPA         AKY(1)                                        S0127
     C                   MOVEA     SUTPA         AKY(4)                                        S0127
0781 C                   MOVEA     CLASA         AKY(11)
     C                   SETOFF                                       53                       S0127
     C                   EXSR      AKYOUT                                                      S0127
     C                   END                                                                   S0127
     C                   END                                                                   S0127
     C**                                                                  S01270
     C**   IF PRINCIPAL AMOUNT IS NOT EQUAL TO ZERO                       S01270
     C**   FOR PROCESSING TYPES 61,62,63,64,65,66 & 67                    S01270
      ** Processing types 68,69 and 72 are call parts purch, call parts   CLE005
      ** sold, and risk part sold, respectively, introduced by CLE005     CLE005
      ** Processing type 80 is flat rate personal loan                                        CLE028
     C**                                                                  S01270
     C***********PRAM      IFNE 0                                   S01270BH3409
     C***********PTYP      ANDEQ61                                  S01270BH3409
     C     CPAM          IFNE      0                                                           BH340
     C     PTYP          IFEQ      61                                                          BH340
     C     PTYP          OREQ      62                                                          S0127
     C     PTYP          OREQ      63                                                          S0127
     C     PTYP          OREQ      64                                                          S0127
     C     PTYP          OREQ      65                                                          S0127
     C     PTYP          OREQ      66                                                          S0127
     C     PTYP          OREQ      67                                                          S0127
     C     PTYP          OREQ      68                                                          CLE00
     C     CLE005        ANDEQ     'Y'                                                         CLE00
     C     PTYP          OREQ      69                                                          CLE00
     C     CLE005        ANDEQ     'Y'                                                         CLE00
     C     PTYP          OREQ      70
     C     PTYP          OREQ      71
     C     CLE005        ANDEQ     'Y'
     C     PTYP          OREQ      72                                                          CLE00
     C     CLE005        ANDEQ     'Y'                                                         CLE00
     C     PTYP          OREQ      80
     C     CLE028        ANDEQ     'Y'
     C**                                                                  S01270
     C**   GENERATE OLD LOAN-TYPE/SUB-TYPE ACCOUNT KEYS                   S01270
     C**                                                                  S01270
     C**********           Z-ADDRUND      ACDATE                                       S01270 239569
     C                   Z-ADD     VDAT          ACDATE
     C*********************Z-ADDPRAM      ACAMNT                    S01270BH3409
     C                   Z-ADD     CPAM          ACAMNT                                        BH340
     C                   MOVEA     LTYP          AKY(1)                                        S0127
     C     SPLITF        IFNE      'Y'                                                      MD027475
     C                   MOVE      'R'           AKY(3)                                        S0127
     C                   ELSE                                                               MD027475
     C                   MOVE      'T'           AKY(3)                                     MD027475
     C                   ENDIF                                                              MD027475
     C                   MOVEA     SUTP          AKY(4)                                        S0127
0781 C                   MOVEA     CLAS          AKY(11)
     C                   MOVEA     BKAKY         AKY(6)                                        S0127
     C                   MOVE      'A'           AKY(10)                                       S0127
     C/COPY WNCPYSRC,LEH01078
     C***********          SETON                     53             S01270BH3482
     C                   SETOFF                                       53                       BH348
     C                   EXSR      AKYOUT                                                      S0127
     C**                                                                  S01270
     C**   GENERATE NEW LOAN-TYPE/SUB-TYPE ACCOUNT KEYS                   S01270
      ** Processing types 68,69 and 72 are call parts purch, call parts   CLE005
      ** sold, and risk part sold, respectively, introduced by CLE005     CLE005
     C**                                                                  S01270
     C                   MOVEA     LTYPA         AKY(1)                                        S0127
     C                   MOVEA     SUTPA         AKY(4)                                        S0127
0781 C                   MOVEA     CLASA         AKY(11)
     C/COPY WNCPYSRC,LEH01079
     C***********          SETOF                     53             S01270BH3482
     C                   SETON                                        53                       BH348
     C                   EXSR      AKYOUT                                                      S0127
     C                   SETOFF                                       53                       BH348
     C                   END                                                                   S0127
      *                                                                   CAC001
     C     BGN0ST        IFEQ      'Y'                                                         CAC00
     C     FPRCL         ANDNE     *BLANKS                                                     CAC00
     C     CPAM          ANDNE     0                                                           CAC00
     C     PTYP          IFEQ      61                                                          CAC00
     C     PTYP          OREQ      62                                                          CAC00
     C     PTYP          OREQ      64                                                          CAC00
     C     PTYP          OREQ      66                                                          CAC00
     C     PTYP          OREQ      68                                                          CLE00
     C     CLE005        ANDEQ     'Y'                                                         CLE00
     C     PTYP          OREQ      69                                                          CLE00
     C     CLE005        ANDEQ     'Y'                                                         CLE00
     C     PTYP          OREQ      70
     C     PTYP          OREQ      71
     C     CLE005        ANDEQ     'Y'
     C     PTYP          OREQ      72                                                          CLE00
     C     CLE005        ANDEQ     'Y'                                                         CLE00
     C     PTYP          OREQ      80
     C     CLE028        ANDEQ     'Y'
      *                                                                   CAC001
      **  Generate old loan type/sub-type account keys                    CAC001
      *                                                                   CAC001
      **  Transaction Profit Centre                                       CAC001
      *                                                                   CAC001
     C                   MOVEA     LTYP          AKY(1)                                        CAC00
     C                   MOVEA     SUTP          AKY(4)                                        CAC00
0781 C                   MOVEA     CLAS          AKY(11)
     C                   MOVEA     'T   '        AKY(6)                                        CAC00
     C                   SETOFF                                       53                       CAC00
     C                   EXSR      AKYOUT                                                      CAC00
      *                                                                   CAC001
      **  Funding Profit Centre                                           CAC001
      *                                                                   CAC001
     C                   MOVEA     'F   '        AKY(6)                                        CAC00
     C                   MOVEL     PRFC          WPRFC                                         CAC00
     C                   MOVEL     FPRCL         PRFC                                          CAC00
     C                   EXSR      AKYOUT                                                      CAC00
     C                   MOVEL     WPRFC         PRFC                                          CAC00
      *                                                                   CAC001
      **  Generate new loan type/sub-type account keys                    CAC001
      *                                                                   CAC001
      **  Transaction Profit Centre                                       CAC001
      *                                                                   CAC001
     C                   MOVEA     LTYPA         AKY(1)                                        CAC00
     C                   MOVEA     SUTPA         AKY(4)                                        CAC00
0781 C                   MOVEA     CLASA         AKY(11)
     C                   MOVEA     'T   '        AKY(6)                                        CAC00
     C                   SETON                                        53                       CAC00
     C                   EXSR      AKYOUT                                                      CAC00
      *                                                                   CAC001
      **  Funding Profit Centre                                           CAC001
      *                                                                   CAC001
     C                   MOVEA     'F   '        AKY(6)                                        CAC00
     C                   MOVEL     PRFC          WPRFC                                         CAC00
     C                   MOVEL     FPRCL         PRFC                                          CAC00
     C                   EXSR      AKYOUT                                                      CAC00
     C                   SETOFF                                       53                       CAC00
     C                   MOVEL     WPRFC         PRFC                                          CAC00
     C                   MOVEA     BKAKY         AKY(6)                                        CAC00
      *                                                                   CAC001
     C                   ENDIF                                                  - PTYP         CAC00
     C                   ENDIF                                                  - BGN0ST       CAC00
      *                                                                   CAC001
     C                   END                                                                   BH340
     C***********                                                         BH3409
     C*****IF*PREMIUM/DISCOUNT*AMOUNT*IS*NOT*ZERO                   S01270BH3482
     C*****FOR*PROCESSING*TYPES*63,65*&*67                          S01270BH3482
      *                                                                   BH3482
      ** Process Discount Amount for Processing types 63, 65 & 67.        BH3482
      *                                                                   BH3482
     C**                                                                  S01270
     C     PTYP          IFEQ      63                                                          S0127
     C     PTYP          OREQ      65                                                          S0127
     C     PTYP          OREQ      67                                                          S0127
     C***********OPAM      SUB  CPAM      DPAM   130                S01270BH3409
     C***********DPAM      IFNE 0                                   S01270BH3409
     C***********TOTI      SUB  AIPD      ACAMNT                    BH3409BH3482
     C***********ACAMNT    IFNE 0                                   BH3409BH3482
      *                                                                   BH3482
      ** ... for any discount income posted to date.                      BH3482
      *                                                                   BH3482
     C**                                                                  BH3409
     C**   GENERATE OLD LOAN-TYPE/SUB-TYPE ACCOUNT KEYS                   S01270
     C**                                                                  S01270
      *                                                                                       CAS009
      ** If CAS009 is enabled, generate loan type/subtype a/c keys only if                    CAS009
      ** the amortised discount to date (AMDS) is not zero and the amortisation               CAS009
      ** method is not 'L' (linear).                                                          CAS009
      *                                                                                       CAS009
     C     CAS009        IFEQ      'Y'
      *                                                                                       232348
      ** Only process EIR cost accounting if loan's value date is same                        232348
      ** as or after the non-linear amortisation cut-off date                                 232348
     C     VDAT          ANDGE     FSNLAC
      *                                                                                       232348
     C                   EXSR      SRRTVI
     C                   ENDIF
     C     CAS009        IFEQ      'Y'
     C     AMDS          ANDNE     *ZERO
     C     FSAMRM        ANDNE     'L'
     C     AYACAI        ANDEQ     'Y'
      *                                                                                       232348
      ** Only process EIR cost accounting if loan's value date is same                        232348
      ** as or after the non-linear amortisation cut-off date                                 232348
     C     VDAT          ANDGE     FSNLAC
     C     CAS009        OREQ      'N'
      *                                                                                       CAS009
     C     AIPD          IFNE      0                                                     BH3409BH348
     C**********         Z-ADD     RUND          ACDATE                              S01270 MD012157
     C                   Z-ADD     VDAT          ACDATE                                     MD012157
     C*********************Z-ADDDPAM      ACAMNT                    S01270BH3409
     C                   MOVEA     LTYP          AKY(1)                                        S0127
      *                                                                                     MD033575
     C     SPLITF        IFne      'Y'                                                      MD033575
     C                   MOVE      'A'           AKY(3)                                        S0127
     C                   Else                                                               MD033575
     C                   Move      'T'           AKY(3)                                     MD033575
     C                   EndIF                                                              MD033575
      *                                                                                     MD033575
     C                   MOVEA     SUTP          AKY(4)                                        S0127
0781 C                   MOVEA     CLAS          AKY(11)
     C                   MOVEA     BKAKY         AKY(6)                                        S0127
      *                                                                                       233887
      ** Generate non linear account keys for CAS009 on subtype change                        233887
      *                                                                                       233887
     C     CAS009        IFEQ      'Y'
     C                   MOVE      'N'           AKY(6)
     C                   ENDIF
      *                                                                                       233887
     C***********ACAMNT    IFLT 0                                   BH3409BH3482
     C                   MOVE      'D'           AKY(10)                                       S0127
     C***********          Z-SUBACAMNT    ACAMNT              S01270BH3409BH3482
     C***********          ELSE                                     BH3409BH3482
     C***********          Z-ADDACAMNT    ACAMNT              S01270BH3409BH3482
     C***********          MOVE 'P'       AKY,10                    BH3409BH3482
     C***********          END                                      BH3409BH3482
     C                   Z-ADD     AIPD          ACAMNT                                        BH348
     C                   SETON                                        53                       S0127
     C                   EXSR      AKYOUT                                                      S0127
     C**                                                                  S01270
     C**   GENERATE NEW LOAN-TYPE/SUB-TYPE ACCOUNT KEYS                   S01270
     C**                                                                  S01270
     C                   MOVEA     LTYPA         AKY(1)                                        S0127
     C                   MOVEA     SUTPA         AKY(4)                                        S0127
0781 C                   MOVEA     CLASA         AKY(11)
     C                   SETOFF                                       53                       S0127
     C                   EXSR      AKYOUT                                                      S0127
     C                   END                                                                   S0127
      *                                                                                       233887
      ** Generate Account Key for nonlinear accounting                                        233887
      ** (xxAyybrsbD)                                                                         233887
      *                                                                                       233887
     C     AMDS          IFNE      0
     C                   Z-ADD     VDAT          ACDATE
     C                   MOVEA     LTYP          AKY(1)
      *                                                                                     MD033575
     C     SPLITF        IFne      'Y'                                                      MD033575
     C                   MOVE      'A'           AKY(3)
     C                   Else                                                               MD033575
     C                   Move      'T'           AKY(3)                                     MD033575
     C                   EndIF                                                              MD033575
      *                                                                                     MD033575
     C                   MOVEA     SUTP          AKY(4)
0781 C                   MOVEA     CLAS          AKY(11)
     C                   MOVE      'N'           AKY(6)
      *                                                                                       233887
     C                   MOVE      'D'           AKY(10)
     C                   Z-ADD     AMDS          ACAMNT
     C                   SETON                                        53
     C                   EXSR      AKYOUT
      *                                                                                       233887
      **   Generate new Loan Type/Sub-type account keys                                       233887
      *                                                                                       233887
     C                   MOVEA     LTYPA         AKY(1)
     C                   MOVEA     SUTPA         AKY(4)
0781 C                   MOVEA     CLASA         AKY(11)
     C                   SETOFF                                       53
     C                   EXSR      AKYOUT
     C                   END
      *                                                                                       CAS009
     C                   ENDIF
      *                                                                   BH3482
      ** ... for unearned discount.                                       BH3482
      ** Generate Old Loan sub-type account keys.                         BH3482
      *                                                                   BH3482
     C     TOTI          IFNE      0                                                           BH348
     C**********         Z-ADD     RUND          ACDATE                              BH3482 MD012157
     C                   Z-ADD     VDAT          ACDATE                                     MD012157
     C                   Z-ADD     TOTI          ACAMNT                                        BH348
     C                   MOVEA     LTYP          AKY(1)                                        BH348
     C     SPLITF        IFNE      'Y'                                                      MD027475
     C                   MOVE      'V'           AKY(3)                                        BH348
     C                   ELSE                                                               MD027475
     C                   MOVE      'T'           AKY(3)                                     MD027475
     C                   ENDIF                                                              MD027475
     C                   MOVEA     SUTP          AKY(4)                                        BH348
0781 C                   MOVEA     CLAS          AKY(11)
     C                   MOVEA     BKAKY         AKY(6)                                        BH348
      *                                                                                       233887
      ** Genrate non linear account keys for CAS009 on subtype change                         233887
      *                                                                                       233887
     C     CAS009        IFEQ      'Y'
     C     AMDS          ANDNE     *ZERO
     C     FSAMRM        ANDNE     'L'
     C     AYACAI        ANDEQ     'Y'
     C                   MOVE      'N'           AKY(6)
     C                   ENDIF
      *                                                                                       233887
     C                   MOVE      'D'           AKY(10)                                       BH348
     C                   SETON                                        53                       BH348
     C                   EXSR      AKYOUT                                                      BH348
      *                                                                   BH3482
      ** Generate New Loan sub-type account keys.                         BH3482
      *                                                                   BH3482
     C                   MOVEA     LTYPA         AKY(1)                                        BH348
     C                   MOVEA     SUTPA         AKY(4)                                        BH348
0781 C                   MOVEA     CLASA         AKY(11)
     C                   SETOFF                                       53                       BH348
     C                   EXSR      AKYOUT                                                      BH348
     C                   END                                                                   BH348
      *                                                                   BH3482
     C                   END                                                                   S0127
      *                                                                                       233887
      ** Under CAS009, amortised amounts for the fees should also be reversed                 233887
      ** and reposted when a subtype change is encountered.                                   233887
      ** This is also done for fees amortising/accruing linearly when                         233887
      ** CAS009 is off (WIP)                                                                  233887
      *                                                                                       233887
      ** Get details of new loan type/sub type combination first                              233887
      *                                                                                       233887
     C     CAS009        IFEQ      'Y'
     C                   EXSR      SRRTVI
     C                   ENDIF
      *                                                                                       233887
      ** The loan should also have started amortising (AFDP<>0), is                           233887
      ** not linear, and the loan type/sub type should have its                               233887
      ** Amortised Cost Accounting indicator set to Y                                         233887
      *                                                                                       233887
     C     CAS009        IFEQ      'Y'
     C     AFDP          ANDNE     *ZERO
     C     FSAMRM        ANDNE     'L'
     C     AYACAI        ANDEQ     'Y'
     C     CAS009        OREQ      'N'
      *                                                                                       233887
     C     LNRF          SETLL     LEFEEDLG
     C     LNRF          READE     LEFEEDLG                               78
     C     *IN78         DOWEQ     *OFF
     C     FEAMTD        IFNE      FEFAMT
     C     FEAMTD        ANDNE     0
     C     CAS009        ORNE      'Y'
     C     FERECI        ANDNE     'M'
     C                   MOVE      *ON           *IN79
     C                   Z-ADD     RUND          ACDATE
     C                   Z-ADD     FEFAMT        ACAMNT
     C                   MOVEA     LTYP          AKY(1)
      *                                                                                     MD033575
     C     SPLITF        IFne      'Y'                                                      MD033575
     C                   MOVE      'R'           AKY(3)
     C                   Else                                                               MD033575
     C                   Move      'T'           AKY(3)                                     MD033575
     C                   EndIF                                                              MD033575
      *                                                                                     MD033575
     C                   MOVEA     SUTP          AKY(4)
0781 C                   MOVEA     CLAS          AKY(11)
     C     CLE004        IFEQ      'Y'
     C     PTFI          ANDEQ     'I'
     C     CLE004        OREQ      'Y'
     C     PTFI          ANDEQ     'P'
     C     CLE005        OREQ      'Y'
     C     PTFI          ANDEQ     'I'
     C     CLE005        OREQ      'Y'
     C     PTFI          ANDEQ     'P'
     C                   MOVE      PTFI          AKY(7)
     C                   ELSE
     C                   MOVE      BKAKY         AKY(6)
     C                   ENDIF
     C     CAS009        IFNE      'Y'
     C     FEPYON        IFEQ      'S'
     C                   MOVE      'S'           AKY(6)
     C                   ELSE
     C                   MOVE      ' '           AKY(6)
     C                   ENDIF
     C                   ENDIF
     C                   MOVE      FEFCOD        WFCOD             2
     C                   MOVEA     WFCOD         AKY(8)
     C                   MOVE      'F'           AKY(10)
     C                   SETON                                        53
     C                   EXSR      AKYOUT
      *                                                                                       233887
      ** Generate New Loan sub-type account keys.                                             233887
      *                                                                                       233887
     C                   MOVEA     LTYPA         AKY(1)
     C                   MOVEA     SUTPA         AKY(4)
0781 C                   MOVEA     CLASA         AKY(11)
     C                   SETOFF                                       53
     C                   EXSR      AKYOUT
      *                                                                                       233887
      ** Generate Nonlinear fee income on new account                                         233887
     C                   Z-ADD     FEAMTD        ACAMNT
      *                                                                                     MD033575
     C     SPLITF        IFne      'Y'                                                      MD033575
     C                   MOVE      'A'           AKY(3)
     C                   ELSE                                                               MD033575
     C                   MOVE      'T'           AKY(3)                                     MD033575
     C                   EndIF                                                              MD033575
      *                                                                                     MD033575
     C     CAS009        IFEQ      'Y'
     C                   MOVE      'N'           AKY(6)
     C                   ENDIF
     C                   EXSR      AKYOUT
      *                                                                                       233887
      ** Generate Nonlinear fee income reversal on previous subtype                           233887
     C                   MOVEA     LTYP          AKY(1)
     C                   MOVEA     SUTP          AKY(4)
0781 C                   MOVEA     CLAS          AKY(11)
     C                   SETON                                        53
     C                   EXSR      AKYOUT
     C                   SETOFF                                       53
     C                   MOVEA     LTYPA         AKY(1)
     C                   MOVEA     SUTPA         AKY(4)
0781 C                   MOVEA     CLASA         AKY(11)
     C                   MOVE      ' '           AKY(6)
      *                                                                                       233887
     C                   MOVE      *OFF          *IN79
     C     LNRF          READE     LEFEEDLG                               78
     C                   ENDIF
     C                   ENDDO
      *                                                                                       233887
     C                   ENDIF
      *                                                                                       233887
     C***********                                                   S01270BH3409
     C*****IF*CURRENT PRINCIPAL NE 0 GENERATE ACCOUNT KEYS          S01270BH3409
     C*****FOR*PROCESSING TYPES 63,65 & 67                          S01270BH3409
     C***********                                                   S01270BH3409
     C***********CPAM      IFNE 0                                   S01270BH3409
     C***********                                                   S01270BH3409
     C*****GENERATE OLD LOAN-TYPE/SUB-TYPE ACCOUNT KEYS             S01270BH3409
     C***********                                                   S01270BH3409
     C***********          Z-ADDRUND      ACDATE                    S01270BH3409
     C***********          Z-ADDCPAM      ACAMNT                    S01270BH3409
     C***********          MOVEALTYP      AKY,1                     S01270BH3409
     C***********          MOVE 'A'       AKY,3                     S01270BH3409
     C***********          MOVEASUTP      AKY,4                     S01270BH3409
     C***********          MOVEABKAKY     AKY,6                     S01270BH3409
     C***********          MOVE 'P'       AKY,10                    S01270BH3409
     C***********          SETON                     53             S01270BH3409
     C***********          EXSR AKYOUT                              S01270BH3409
     C***********                                                   S01270BH3409
     C*****GENERATE NEW LOAN-TYPE/SUB-TYPE ACCOUNT KEYS             S01270BH3409
     C***********                                                   S01270BH3409
     C***********          MOVEALTYPA     AKY,1                     S01270BH3409
     C***********          MOVEASUTPA     AKY,4                     S01270BH3409
     C***********          SETOF                     53             S01270BH3409
     C***********          EXSR AKYOUT                              S01270BH3409
     C***********          END                                      S01270BH3409
     C*                                                                   S01270
     C** UPDATE THE LOAN FILE WITH THE APPROPRIATE DATA FROM LOAN         S01270
     C** AMENDMENTS IE NEW LOAN SUB TYPE MATURITY DATE AND PROCESSING     S01270
     C** TYPE                                                             S01270
     C*                                                                   S01270
     C                   EVAL      aCATCOD(1) = *Blank                                        CLE164
     C                   EVAL      aCATCOD(2) = *Blank                                        CLE164
     C                   EVAL      aCATCOD(3) = *Blank                                        CLE164
     C                   EVAL      aCATCOD(4) = *Blank                                        CLE164
     C                   MOVE      LTYPA         LTYP                                          S0127
     C                   MOVE      SUTPA         SUTP                                          S0127
0781 C                   MOVE      CLASA         CLAS
     C                   Z-ADD     LSMD          MDAT                                          S0127
                                                                                              CLE164
     C                   EVAL      KEYLNNO = LNRF                                             CLE164
     C     KEYCLF4       CHAIN     CLOANL4                                                    CLE164
     C                   IF        %FOUND(CLOANL4) and                                        CLE164
     C                             F4_AUTO = 'C' and AMTP = 'LS'                              CLE164
     C                             and CLE134 = 'Y'                                           CLE164
     C                   EXSR      RetGroupID                                                 CLE164
     C                   EVAL      N = 1                                                      CLE164
     C     LNRF          SETLL     CLOANZI0                                                   CLE164
     C     LNRF          READE     CLOANZI0                                                   CLE164
     C                   DOW       %FOUND(CLOANZI0)                                           CLE164
     C                   IF        LXLNRF = LNRF                                              CLE164
     C                   IF        LXLEVL <> 'M'                                              CLE164
     C                   EVAL      aCATCOD(N) = LXCATE                                        CLE164
     C                   DELETE    CLOANZI0                                                   CLE164
     C                   ENDIF                                                                CLE164
     C                   EVAL      N = N + 1                                                  CLE164
     C                   READ      CLOANZI0                                                   CLE164
     C                   ELSE                                                                 CLE164
     C                   LEAVE                                                                CLE164
     C                   ENDIF                                                                CLE164
     C                   ENDDO                                                                CLE164
     C                   EXSR      WriteExtFile                                               CLE164
     C                   ENDIF                                                                CLE164
      *                                                                   BH3482
     C                   SETOFF                                       54                       BH348
     C*                                                                   S01270
     C                   ENDSR                                                                 S0127
1649 C********************************************************************S01270
1650 C********************************************************************S01270
1651 C**
1652 C**   SUBROUTINE TO OUTPUT A/C KEYS TO LKEY1 AND REPORT - AKYOUT
1653 C**
1654 C**   CALLED FROM DLDATE,SRDATE,PRININ,MANREP,INTPAY,REPSCD,
1655 C**   MATRTY,INTRST,LOANB
1656 C**   CALLS GLZADD
1657 C**
1658 C     AKYOUT        BEGSR                                                  ***  AKYOUT ***
     C**                                                                  157669
     C**********         EVAL      WSKEY = ' '                                     MD048557 MD049078
     C     KMANL         CHAIN     LOMNEWF                            24                      CLE164
     C                   MOVE      AUTOL         WAUTO             1                          CLE134
     C                   MOVE      AUTO2         WAUTO2            1                          CLE164
     C********** AUTOX     IFEQ 'C'                                                           CLE134
     C**********           MOVE 'C'       WAUTO   1                                           CLE134
     C**********           END                                                                CLE134
      *                                                                                       CLE134
     C                   MOVE      'N'           WNEWF             1                          CLE134
     C                   MOVE      *OFF          *IN30                                        CLE134
      *                                                                                       CLE134
     C     CLE134        IFEQ      'Y'                                                        CLE134
     C     AKY(3)        ANDEQ     'R'                                                        CLE134
     C*****AKY(10)       ANDEQ     'B'                                             AR402543 AR641069
     C*****WAUTO         ANDEQ     'C'                                               CLE134 MD037915
     C     AUTO          ANDEQ     'C'                                                      MD037915
     C     *IN24         ANDEQ     '1'                                                        CLE164
     C     WPDCLL        ANDNE     'Y'                                                        262967
     C     *IN21         ANDEQ     *OFF                                                       CLE134
     C     *IN46         ANDEQ     *OFF                                                       CLE134
     C     *IN53         ANDEQ     *OFF                                                       CLE134
     C*****ACAMNT        ANDGT     0                                               AR720106 MD027718
     C     ACAMNT        ANDNE     0                                                        MD027718
     C*****CLE134        OREQ      'Y'                                               CLE164 MD037915
     C*****AKY(3)        ANDEQ     'R'                                               CLE164 MD037915
     C*****WAUTO2        ANDEQ     'C'                                               CLE164 MD037915
     C******IN24         ANDEQ     '0'                                               CLE164 MD037915
     C*****WPDCLL        ANDNE     'Y'                                               CLE164 MD037915
     C******IN21         ANDEQ     *OFF                                              CLE164 MD037915
     C******IN46         ANDEQ     *OFF                                              CLE164 MD037915
     C******IN53         ANDEQ     *OFF                                              CLE164 MD037915
     C*****ACAMNT        ANDNE     0                                                 CLE164 MD037915
     C*****ACAMNT        ANDGT     0                                               AR720106 MD027718
      *********************************************************************        AR402543 AR641069
      ***Set*WNEWF*=*'Y'*also*in*the*case*where*account*key*is*not*********        AR402543 AR641069
      ***defined*or*it*exists*but*does*not*have*posting*reference*2********        AR402543 AR641069
      *********************************************************************        AR402543 AR641069
     C**********         MOVE      'Y'           WNEWF                             AR402543 AR641069
     C**********         SETON                                        30           AR402543 AR641069
      *********************************************************************        AR402543 AR641069
     C                   MOVEA     AKY           KACCK                                        CLE134
     C     KACCK         CHAIN     ACKEY                              24                      CLE134
     C     *IN24         IFEQ      *OFF                                                       CLE134
     C     PRF1          IFEQ      2                                                          CLE134
     C     PRF2          OREQ      2                                                          CLE134
     C     PRF3          OREQ      2                                                          CLE134
     C                   MOVE      'Y'           WNEWF                                        CLE134
     C                   SETON                                        30                      CLE134
     C                   Else                                                               MD030334
      *                                                                                     AR641069
      ** If found and a/c key posn 10 is B and posting ref not equal to 2                   AR641069
      ** Set WNEWF = 'Y'                                                                    AR641069
      *                                                                                     AR641069
     C     AKY(10)       IFEQ      'B'                                                      AR641069
     C                   MOVE      'Y'           WNEWF                                      AR641069
     C                   SETON                                        30                    AR641069
     C                   ENDIF                                                              AR641069
     C     AKY(9)        IFEQ      'X'                                                        CLE164
     C     AKY(10)       ANDEQ     'P'                                                        CLE164
     C                   MOVE      'N'           WNEWF                                        CLE164
     C                   SETOFF                                       30                      CLE164
     C                   ENDIF                                                                CLE164
      *                                                                                     AR641069
     C                   ENDIF                                                                CLE134
      *                                                                                     AR641069
      ** not found on ACKEYAL and AKY,10 is B, set WNEWF to Y, else N                       AR641069
      *                                                                                     AR641069
     C                   ELSE                                                               AR641069
     C     AKY(10)       IFEQ      'B'                                                      AR641069
     C                   MOVE      'Y'           WNEWF                                      AR641069
     C                   SETON                                        30                    AR641069
     C                   ENDIF                                                              AR641069
     C     AKY(9)        IFEQ      'X'                                                        CLE164
     C     AKY(10)       ANDEQ     'P'                                                        CLE164
     C                   MOVE      'N'           WNEWF                                        CLE164
     C                   SETOFF                                       30                      CLE164
     C                   ENDIF                                                                CLE164
     C                   ENDIF                                                                CLE134
     C                   ENDIF                                                                CLE134
      *                                                                                       CLE134
      ** If loan has auto = 'C' and loan event has no settlement                            AR700107
      ** details, then output repayment account keys to LKEY1DP                             AR700107
      ** otherwise                                                                          AR700107
      *                                                                                     AR700107
     C     WAUTO         IFEQ      'C'                                                      AR700107
     C     WPDCLL        ANDEQ     'N'                                                      AR700107
     C     SETP          IFEQ      0                                                        AR700107
     C     OSAC          ANDEQ     *BLANKS                                                  AR700107
     C     *IN79         OREQ      *ON                                                      AR700107
     C     FESTTL        ANDEQ     0                                                        AR700107
     C     FEOURS        ANDEQ     *BLANKS                                                  AR700107
     C                   SETOFF                                       30                    AR700107
     C                   MOVE      'N'           WNEWF                                      AR700107
     C                   ENDIF                                                              AR700107
     C                   ENDIF                                                              AR700107
      *                                                                                     AR700107
     C                   MOVE      *IN46         IN46              1                           15766
     C                   Z-ADD     ACAMNT        WACMNT           13 0                         15766
     C********** ACAMNT    IFLT 0                                                      157669 209420
     C**********           Z-SUBACAMNT    ACAMNT                                       157669 209420
     C**********           MOVE '1'       *IN46                                        157669 209420
     C**********           ENDIF                                                       157669 209420
1659 C**********                                                                            AR741212
1660 C*****ACCUMULATE*HASH*TOTALS*FOR*LKEY1****************************                     AR741212
      ** Move after writing to the account keys main file                                   AR741212
1661 C**********                                                                            AR741212
     C/COPY WNCPYSRC,LE0450C055
1662 C*****ACAMNT        DIV       1000          ZZAMT                  80                  AR741212
1663 C***80*****         Z-SUB     ZZAMT         ZZAMT                                      AR741212
      **********                                                                     CLE134 AR741212
      ***If*WNEWF*=*N:*Account*key*is*output*to*LKEY1DP****************              CLE134 AR741212
      **********                                                                     CLE134 AR741212
     C*****WNEWF         IFEQ      'N'                                               CLE134 AR741212
      **********                                                                     CLE134 AR741212
1664 C**********         Z-ADD     TOTIKY        ZZTOTI                                     AR741212
1665 C**********         Z-ADD     TOTDKY        ZZTOTD                                     AR741212
1666 C**********         EXSR      GLZADD                                                   AR741212
1667 C**********         Z-ADD     ZZTOTI        TOTIKY           15 0                      AR741212
1668 C**********         Z-ADD     ZZTOTD        TOTDKY            3 0                      AR741212
     C**********         ELSE                                                        CLE134 AR741212
     C**********         Z-ADD     0             WACAMT           13 0               263740 AR741212
     C**********         Z-ADD     0             ZZAMT                               263740 AR741212
     C*****PRAM*         IFGT      0                                                 263740 AR741212
     C**********         Z-ADD     PRAM          WACAMT                              263740 AR741212
     C**********         ELSE                                                        263740 AR741212
     C**********         Z-SUB     PRAM          WACAMT                              263740 AR741212
     C**********         ENDIF                                                       263740 AR741212
     C*****INTA          IFGT      0                                                 263740 AR741212
     C**********         ADD       INTA          WACAMT                              263740 AR741212
     C**********         ELSE                                                        263740 AR741212
     C**********         SUB       INTA          WACAMT                              263740 AR741212
     C**********         ENDIF                                                       263740 AR741212
     C*****WACAMT        DIV       1000          ZZAMT                  80           263740 AR741212
     C**********         Z-ADD     L1VLRF        ZZTOTI                              CLE134 AR741212
     C**********         Z-ADD     L1VLRL        ZZTOTD                              CLE134 AR741212
     C**********         EXSR      GLZADD                                            CLE134 AR741212
     C**********         Z-ADD     ZZTOTI        L1VLRF                              CLE134 AR741212
     C**********         Z-ADD     ZZTOTD        L1VLRL                              CLE134 AR741212
     C**********         ENDIF                                                       CLE134 AR741212
1669 C**
1670 C**   OUTPUT TO REPORT AND LKEY1
1671 C**
1672 C     AKY(3)        IFEQ      'R'                                                         15658
1672 C     AKY(10)       ANDEQ     'A'                                                         15658
     C                   SETON                                        67                       15658
     C                   ELSE                                                                  15658
     C                   SETOFF                                       67                       15658
1672 C                   ENDIF                                                                 15658
      *                                                                                    MD020134A
      ** Set here value of ZZ002(filler) to be used in LE0470.                             MD020134A
      *                                                                                    MD020134A
     C                   MOVE      *BLANKS       WPOST             2                       MD020134A
     C     AKY(3)        IFEQ      'R'                                                     MD020134A
     C     AMTP          IFEQ      'RE'                                                    MD020134A
     C     LASN          ANDEQ     999                                                     MD020134A
     C     ACDATE        ANDGT     PRUN                                                     MD021302
     C     ACDATE        ANDLT     RUND                                                     MD021302
     C     AMTP          OREQ      'IN'                                                    MD020134A
     C     LASN          ANDEQ     999                                                     MD020134A
     C     ACDATE        ANDGT     PRUN                                                     MD021302
     C     ACDATE        ANDLT     RUND                                                     MD021302
     C     AMTP          OREQ      'MA'                                                    MD020134A
     C     ACDATE        ANDGT     PRUN                                                     MD021302
     C     ACDATE        ANDLT     RUND                                                     MD021302
     C                   MOVE      AMTP          WPOST                                     MD020134A
     C                   ENDIF                                                             MD020134A
     C                   ENDIF                                                             MD020134A
      *                                                                                       CLE134
      ** set LEPK1DP fields                                                                   CLE134
      *                                                                                       CLE134
     C     *IN30         IFEQ      *ON                                                        CLE134
      *                                                                                       CLE134
     C                   MOVE      'G'           KRECI                                        CLE134
     C  N60                                                                                   CLE134
     CANN61              MOVE      'D'           KRECI                                        CLE134
     C   54                                                                                   CLE134
     CANN60                                                                                   CLE134
     CANN61              MOVE      'S'           KRECI                                        CLE134
     C                   MOVE      SHAKY         KQQAKE                                       CLE134
     C                   MOVE      LNRF          KLNNO                                        CLE134
     C                   MOVE      CNUML         KCNUM                                        CLE134
     C                   MOVE      BRCA          KBRCA                                        CLE134
     C   79              MOVE      FEBRCA        KBRCA                                        CLE134
     C                   MOVE      LASQ          KACSQ                                        CLE134
     C                   Z-ADD     ACDATE        KEDAT                                        CLE134
     C                   Z-ADD     ACAMNT        KEAMT                                        CLE134
     C                   MOVE      CCYL          KECCY                                        CLE134
     C   79              MOVE      FEFCCY        KECCY                                        CLE134
     C                   Z-ADD     0             KSETP                                        CLE134
     C  N60                                                                                   CLE134
     CANN61              MOVE      SETP          KSETP                                        CLE134
     C   79              MOVE      FESTTL        KSETP                                        CLE134
     C                   MOVE      *BLANKS       KOSACQ                                       CLE134
     C   79              MOVE      FEOURS        KOSACQ                                       CLE134
     C  N60                                                                                   CLE134
     CANN61              MOVE      OSAC          KOSAC                                        CLE134
     C  N60                                                                                   CLE134
     CANN61              MOVE      OSBR          KOSBR                                        CLE134
     C                   Z-ADD     0             KREVI                                        CLE134
     C   46                                                                                   CLE134
     COR 21                                                                                   CLE134
     COR 53              Z-ADD     1             KREVI                                        CLE134
     C                   Z-ADD     Z13           KOTHA                                        CLE134
     C                   Z-ADD     Z13           KEXRT                                        CLE134
     C                   Z-ADD     VDATL         KSTDT                                        CLE134
     C                   Z-ADD     SLIDL         KSLID                                        CLE134
     C   79              Z-ADD     FEPSTD        KSLID                                        CLE134
     C                   Z-ADD     MDAT          KMDAT                                        CLE134
     C   81              Z-ADD     RLDT          KMDAT                                        CLE134
     C                   Z-ADD     BRTTL         KBRTT                                        CLE134
     C                   Z-ADD     BRTEL         KBRTE                                        CLE134
     C                   Z-ADD     RTSPL         KRTSP                                        CLE134
     C                   Z-ADD     INTRL         KINTR                                        CLE134
     C   66              Z-ADD     OINTR         KINTR                                        CLE134
     C                   Z-ADD     2             KSSEQ                                        CLE134
     C   46              Z-ADD     1             KSSEQ                                        CLE134
     C   60              Z-ADD     4             KSSEQ                                        CLE134
     C   61              Z-ADD     3             KSSEQ                                        CLE134
     C                   Z-ADD     OCPAM         KCPAM                                        CLE134
     C   83                                                                                   CLE134
     CAN 65              Z-ADD     ACRBAL        KCPAM                                        CLE134
     C                   Z-ADD     Z5            KPACD                                        CLE134
     C   65              Z-ADD     IACDL         KPACD                                        CLE134
     C                   Z-ADD     0             KICBS                                        CLE134
     C   65              Z-ADD     ICBS          KICBS                                        CLE134
     C                   MOVE      ACOF          KACOF                                        CLE134
     C                   MOVE      FACOL         KFACO                                        CLE134
     C  N32              MOVE      FACO          KFACO                                        CLE134
     C                   MOVE      PRFC          KPRFC                                        CLE134
     C                   MOVE      BOKC          KBOKC                                        CLE134
     C                   Z-ADD     PELAP         KPELAP                                       CLE134
     C                   Z-ADD     LORED         KORED                                        CLE134
     C                   MOVE      OLNO          KOLNO                                        CLE134
     C                   MOVE      PTFR          KPTFR                                        CLE134
     C                   MOVE      LKSCCY        KSCCY                                        CLE134
     C                   MOVE      ANUM          KANUM                                        CLE134
     C                   MOVE      ROLN          KROLN                                        CLE134
     C                   MOVE      *BLANKS       KGASS                                        CLE134
     C   67              MOVE      GASS          KGASS                                        CLE134
     C                   MOVE      F1FFLG        KF1FFL                                       CLE134
     C                   Z-ADD     F1FVAL        KF1FVA                                       CLE134
     C                   Z-ADD     F1FPCT        KF1FPC                                       CLE134
     C                   MOVE      WRACT         KF1RAC                                       CLE134
     C  N60                                                                                   CLE134
     CANN61              MOVE      F1RACT        KF1RAC                                       CLE134
     C                   MOVE      WRCTY         KF1RCT                                       CLE134
     C  N60                                                                                   CLE134
     CANN61              MOVE      F1RCTY        KF1RCT                                       CLE134
     C                   MOVE      WRBNK         KF1RBN                                       CLE134
     C  N60                                                                                   CLE134
     CANN61              MOVE      F1RBNK        KF1RBN                                       CLE134
     C                   MOVE      WRCDE         KF1RCD                                       CLE134
     C  N60                                                                                   CLE134
     CANN61              MOVE      F1RCDE        KF1RCD                                       CLE134
     C                   MOVE      WPACT         KF1PAC                                       CLE134
     C  N60                                                                                   CLE134
     CANN61              MOVE      F1PACT        KF1PAC                                       CLE134
     C                   MOVE      WPCTY         KF1PCT                                       CLE134
     C  N60                                                                                   CLE134
     CANN61              MOVE      F1PCTY        KF1PCT                                       CLE134
     C                   MOVE      WPBNK         KF1PBN                                       CLE134
     C  N60                                                                                   CLE134
     CANN61              MOVE      F1PBNK        KF1PBN                                       CLE134
     C                   MOVE      WPCDE         KF1PCD                                       CLE134
     C  N60                                                                                   CLE134
     CANN61              MOVE      F1PCDE        KF1PCD                                       CLE134
     C                   MOVE      WDACT         KF1DAC                                       CLE134
     C  N60                                                                                   CLE134
     CANN61              MOVE      F1DACT        KF1DAC                                       CLE134
     C                   MOVE      WDCTY         KF1DCT                                       CLE134
     C  N60                                                                                   CLE134
     CANN61              MOVE      F1DCTY        KF1DCT                                       CLE134
     C                   MOVE      WDBNK         KF1DBN                                       CLE134
     C  N60                                                                                   CLE134
     CANN61              MOVE      F1DBNK        KF1DBN                                       CLE134
     C                   Z-ADD     WSDAT         KF1SDA                                       CLE134
     C  N60                                                                                   CLE134
     CANN61              MOVE      F1SDAT        KF1SDA                                       CLE134
     C                   MOVE      SIND          KSIND                                        CLE134
     C                   MOVE      RIND          KRIND                                        CLE134
     C                   MOVE      OKEY          KOKEY                                        CLE134
     C                   MOVE      *BLANKS       KAKEY                                        CLE134
     C                   MOVEA     AKY           KAKEY                                        CLE134
     C                   Z-ADD     0             KAAMT                                        CLE134
     C                   Z-ADD     PRAM          KPAMT                                        CLE134
     C                   Z-ADD     INTA          KIAMT                                        CLE134
     C                   MOVE      BRCA          KABRCA                                       CLE134
     C                   MOVE      CNUM          KACNUM                                       CLE134
     C                   Z-ADD     VDAT          KAVDAT                                       CLE134
     C                   Z-ADD     PRSQ          KAPRSQ                                       CLE134
     C                   Z-ADD     LASN          KALASN                                       CLE134
     C                   MOVE      *BLANKS       KIPFL                                        CLE134
      *                                                                                       CLE134
      ** retrieve sett account and priority                                                   CLE134
      *                                                                                       CLE134
     C                   CALL      'LE000458'                                                 CLE134
     C                   PARM      *BLANKS       RETCOD            7                          CLE134
     C                   PARM                    AKEY                                         CLE134
     C                   PARM                    CCYL                                         CLE134
     C                   PARM                    KLNNO                                        CLE134
     C                   PARM      *BLANKS       IFCNUM            6                          CLE134
     C**********         PARM      *ZEROS        IFLOAN            6 0               CLE134 MD020210
     C                   PARM      *BLANKS       IFLOAN            6                        MD020210
     C                   PARM      *ZEROS        IFFACL            5 0                        CLE134
     C                   PARM      *ZEROS        IFSEQ             2 0                        CLE134
     C                   PARM      *ZEROS        IFCOD             2 0                        CLE134
     C                   PARM                    KSCCY                                        CLE134
     C                   PARM                    OSAC                                         CLE134
     C                   PARM                    SETP                                         CLE134
     C                   PARM                    OLNO                                         CLE134
     C                   PARM                    OSBR                                         CLE134
      *                                                                                       CLE134
     C                   PARM      *BLANKS       SEBRCA                                       CLE134
     C                   PARM      *BLANKS       SECNUM                                       CLE134
     C                   PARM      *BLANKS       SEACCY                                       CLE134
     C                   PARM      *ZEROS        SEACOD                                       CLE134
     C                   PARM      *ZEROS        SEACSQ                                       CLE134
     C**********         PARM      *ZEROS        SEPCKO                                CLE134 CLE164
     C                   PARM      *BLANKS       OATYP             1                        AR741212
      *                                                                                     AR741212
     C                   IF        RETCOD = '*ERROR'                                          CLE134
     C                   MOVEL     'LE000458'    DBPGM                                        CLE134
     C                   MOVE      *BLANKS       DBKEY                                        CLE134
     C                   Z-ADD     33            DBASE                                        CLE134
     C                   MOVE      *ON           *INU7                                        CLE134
     C                   MOVE      *ON           *INLR                                        CLE134
     C                   EXSR      *PSSR                                                      CLE134
     C                   ENDIF                                                                CLE134
      *                                                                                     AR741212
      ** Proceed in writing to LEPK1DP only if settlement account is                        AR741212
      ** Retail. Or if Settlement account is GL (this one is as per                         AR741212
      ** bank's request). Otherwise, write to LKEY1DP.                                      AR741212
      *                                                                                     AR741212
     C     OATYP         IFNE      'N'                                                      AR741212
     C     SEBRCA        ANDNE     *BLANKS                                                  MD030334
     C     SECNUM        ANDNE     *BLANKS                                                  MD030334
     C     SEACCY        ANDNE     *BLANKS                                                  MD030334
     C     SEACOD        ANDGT     0                                                        MD030334
     C     SEACSQ        ANDGT     0                                                        MD030334
      *                                                                                       CLE134
      ** Set fields                                                                           CLE134
      *                                                                                       CLE134
     C**********         Z-ADD     700           SEPCKM                                CLE134 CLE164
     C**********         Z-ADD     700           SEPCKT                                263074 CLE164
                                                                                              CLE164
     C                   MOVE      *BLANKS       WSEPKY            1                          CLE164
     C                   IF        KIAMT <> 0 and KPAMT <> 0                                  CLE164
     C                   EVAL      WSEPKY = 'Y'                                               CLE164
     C                   ENDIF                                                                CLE164
                                                                                              CLE164
     C                   EVAL      KRECI = 'D'                                                CLE164
     C                   EVAL      SEFILE = 'LEPK1DPD'                                        CLE164
      *****************************************************************               262508  CLE164
      ***If*Interest*set*Priority*650**********************************               262508  CLE164
      *****************************************************************               262508  CLE164
     C     AMTP          IFEQ      'IN'                                                       262508
     C     KIAMT         ORNE      *ZEROS                                                     262508
     C*****KPAMT         ANDEQ     *ZEROS                                              262508 CLE164
     C**********           Z-ADD650       SEPCKM                                       262508 263074
     C**********         Z-ADD     650           SEPCKM                              AR571427 CLE164
     C**********         Z-ADD     650           SEPCKT                                263074 CLE164
                                                                                              CLE164
     C                   IF        AMTP = 'MR'                                                CLE164
     C                   EVAL      SECATC = 'OLINM'                                           CLE164
     C                   ELSE                                                                 CLE164
     C                   EVAL      SECATC = 'OLINT'                                           CLE164
     C                   ENDIF                                                                CLE164
                                                                                              CLE164
     C**********         ENDIF                                                         262508 CLE164
      *                                                                                       262508
     C                   MOVEL     KLNNO         SELNRF                                       CLE134
     C                   Z-ADD     KEDAT         SEVDAT                                       CLE134
     C                   Z-ADD     VDATL         SEVDAT                                     AR571427
     C**********         MOVE      'L1'          SEFILE                                CLE134 CLE164
      *                                                                                       262508
      ** Create separate account key for interest and principal                               263074
      *                                                                                       262508
     C**********         MOVE      *BLANKS       WSEPKY            1                   263074 CLE164
     C*****KIAMT         IFNE      0                                                   263074 CLE164
     C*****KPAMT         ANDNE     0                                                   263074 CLE164
     C**********         MOVE      'Y'           WSEPKY                                263074 CLE164
     C**********         Z-ADD     650           SEPCKM                              AR996719 CLE164
     C**********         Z-ADD     650           SEPCKT                                263074 CLE164
     C**********         Z-ADD     INTA          KEAMT                               263074 MD046080
     C     CLE034        IFNE      'Y'                                                      MD049078
     C                   Z-ADD     INTA          KEAMT                                      MD048557
     C                   ENDIF                                                              MD049078
     C*****CLE031        IFEQ      'Y'                                             MD046080 MD049078
     C*****CLE034        IFEQ      'Y'                                             MD046080 MD049078
     C*****STAL          ANDEQ     'Y'                                             MD046080 MD049078
     C**********         MOVE      *BLANKS       WSET                              MD046080 MD049078
     C**********         MOVE      OSAC          WSET                              MD046080 MD049078
     C*****PTYP          IFNE      66                                              MD046080 MD049078
     C*****PTYP          ANDNE     67                                              MD046080 MD049078
     C*****PTYP          ANDNE     69                                              MD046080 MD049078
     C*****PTYP          ANDNE     72                                              MD046080 MD049078
     C*****KSTAL         CHAIN     LESTALLG                                        MD046080 MD049078
     C**********         MOVE      G_RSCY        XCCY                              MD046080 MD049078
     C**********         MOVE      G_REXI        WCYXIN                            MD046080 MD049078
     C**********         Z-ADD     G_REXR        WCYEXR                            MD046080 MD049078
     C**********         ELSE                                                      MD046080 MD049078
     C*****KSTAL         CHAIN     LESTALLH                                        MD046080 MD049078
     C**********         MOVE      H_PSCY        XCCY                              MD046080 MD049078
     C**********         MOVE      H_PEXI        WCYXIN                            MD046080 MD049078
     C**********         Z-ADD     H_PEXR        WCYEXR                            MD046080 MD049078
     C**********         ENDIF                                                     MD046080 MD049078
     C**********         MOVE      XCCY          WWCCY                             MD046080 MD049078
     C**********         ELSE                                                      MD046080 MD049078
     C**********         MOVE      WFMDIN        WCYXIN                            MD046080 MD049078
     C**********         Z-ADD     WFEXR         WCYEXR                            MD046080 MD049078
     C**********         MOVE      CCYL          XCCY                              MD046080 MD049078
     C**********         MOVE      CCYL          WWCCY                             MD046080 MD049078
     C**********         ENDIF                                                     MD046080 MD049078
     C**********         EXSR      CCYDSP                                          MD046080 MD049078
     C**********         Z-ADD     XDECP         W6NBDP                            MD046080 MD049078
     C**********         MOVE      FCCY          XCCY                              MD046080 MD049078
     C**********         EXSR      CCYDSP                                          MD046080 MD049078
     C**********         Z-ADD     INTA          WKAMT                             MD046080 MD049078
     C**********         EXSR      SETAMT                                          MD046080 MD049078
     C**********         Z-ADD     STAMT         KEAMT                             MD046080 MD049078
     C**********         MOVE      WWCCY         KECCY                             MD046080 MD049078
     C**********         ENDIF                                                     MD046080 MD049078
     C                   Z-ADD     0             KPAMT                                        263074
     C**********         ENDIF                                                         263074 CLE164
      *****************************************************************                263074 CLE164
      ***set*RECI*=*'D'************************************************                263074 CLE164
      *****************************************************************                263074 CLE164
     C**********         MOVE      'D'           KRECI                                 263074 CLE164
      *                                                                                       263074
     C                   EXSR      SRRETRPKY                                                  CLE164
     C                   EXSR      SRRETDAT                                                   CLE164
                                                                                              CLE164
     C                   EVAL      SEPAMT = KEAMT                                             CLE164
     C                   EVAL      SETRID = SETRID + 1                                        CLE164
     C                   EVAL      SEOVRD = 0                                                 CLE164
     C                   WRITE     LKEYF1DF                                                   CLE134
     C     KEAMT         IFGT      0                                                        MD048557
     C                   Z-ADD     KEAMT         WACAMT                                     MD048557
     C                   ELSE                                                               MD048557
     C                   Z-SUB     KEAMT         WACAMT                                     MD048557
     C                   ENDIF                                                              MD048557
                                                                                            MD048557
     C     WACAMT        DIV       1000          ZZAMT                  80                  MD048557
     C                   Z-ADD     L1VLRF        ZZTOTI                                     MD048557
     C                   Z-ADD     L1VLRL        ZZTOTD                                     MD048557
     C                   EXSR      GLZADD                                                   MD048557
     C                   Z-ADD     ZZTOTI        L1VLRF                                     MD048557
     C                   Z-ADD     ZZTOTD        L1VLRL                                     MD048557
                                                                                              CLE164
      * End of Processing for Interest Repayments                                             CLE164
                                                                                              CLE164
     C                   ENDIF                                                                CLE164
      ***If*Original*loan*is*matured*and*has*past*due,*loan*must*be*live        AR1078443 AR1076968A
     C**********         IF        RECIL = 'M'                                  AR1078443 AR1076968A
     C**********         EVAL      RECIL = 'D'                                  AR1078443 AR1076968A
     C**********         ENDIF                                                  AR1078443 AR1076968A
      *                                                                                       CLE134
      ** Create account key for principal                                                     263074
      *                                                                                       263074
     C*****WSEPKY        IFEQ      'Y'                                                 263074 CLE164
                                                                                              CLE164
     C                   IF        PRAM  <> 0                                                 CLE164
     C**********         Z-ADD     700           SEPCKM                                263074 CLE164
     C**********         Z-ADD     700           SEPCKT                              AR217563 CLE164
                                                                                              CLE164
     C                   IF        AMTP = 'MR'                                                CLE164
     C                   EVAL      SECATC = 'OLPRM'                                           CLE164
     C                   ELSE                                                                 CLE164
     C                   EVAL      SECATC = 'OLPRI'                                           CLE164
     C                   ENDIF                                                                CLE164
     C                                                                                        CLE164
                                                                                              CLE164
     C                   EVAL      SELNRF = KLNNO                                             CLE164
     C                   EVAL      SEVDAT = KEDAT                                             CLE164
     C                   EVAL      SEVDAT = VDATL                                             CLE164
                                                                                              CLE164
     C                                                                                        CLE164
     C**********         Z-ADD     PRAM          KEAMT                               263074 MD046080
     C     CLE034        IFNE      'Y'                                                      MD049078
     C                   Z-ADD     PRAM          KEAMT                                      MD048557
     C                   ENDIF                                                              MD049078
     C*****CLE031        IFEQ      'Y'                                             MD046080 MD049078
     C*****CLE034        IFEQ      'Y'                                             MD046080 MD049078
     C*****STAL          ANDEQ     'Y'                                             MD046080 MD049078
     C**********         MOVE      *BLANKS       WSET                              MD046080 MD049078
     C**********         MOVE      OSAC          WSET                              MD046080 MD049078
     C*****PTYP          IFNE      66                                              MD046080 MD049078
     C*****PTYP          ANDNE     67                                              MD046080 MD049078
     C*****PTYP          ANDNE     69                                              MD046080 MD049078
     C*****PTYP          ANDNE     72                                              MD046080 MD049078
     C*****KSTAL         CHAIN     LESTALLG                                        MD046080 MD049078
     C**********         MOVE      G_RSCY        XCCY                              MD046080 MD049078
     C**********         MOVE      G_REXI        WCYXIN                            MD046080 MD049078
     C**********         Z-ADD     G_REXR        WCYEXR                            MD046080 MD049078
     C**********         ELSE                                                      MD046080 MD049078
     C*****KSTAL         CHAIN     LESTALLH                                        MD046080 MD049078
     C**********         MOVE      H_PSCY        XCCY                              MD046080 MD049078
     C**********         MOVE      H_PEXI        WCYXIN                            MD046080 MD049078
     C**********         Z-ADD     H_PEXR        WCYEXR                            MD046080 MD049078
     C**********         ENDIF                                                     MD046080 MD049078
     C**********         MOVE      XCCY          WWCCY                             MD046080 MD049078
     C**********         ELSE                                                      MD046080 MD049078
     C**********         MOVE      WFMDIN        WCYXIN                            MD046080 MD049078
     C**********         Z-ADD     WFEXR         WCYEXR                            MD046080 MD049078
     C**********         MOVE      CCYL          XCCY                              MD046080 MD049078
     C**********         MOVE      CCYL          WWCCY                             MD046080 MD049078
     C**********         ENDIF                                                     MD046080 MD049078
     C**********         EXSR      CCYDSP                                          MD046080 MD049078
     C**********         Z-ADD     XDECP         W6NBDP                            MD046080 MD049078
     C**********         MOVE      FCCY          XCCY                              MD046080 MD049078
     C**********         EXSR      CCYDSP                                          MD046080 MD049078
     C**********         Z-ADD     PRAM          WKAMT                             MD046080 MD049078
     C**********         EXSR      SETAMT                                          MD046080 MD049078
     C**********         Z-ADD     STAMT         KEAMT                             MD046080 MD049078
     C**********         MOVE      WWCCY         KECCY                             MD046080 MD049078
     C**********         ENDIF                                                     MD046080 MD049078
     C                   Z-ADD     PRAM          KPAMT                                        263074
	                                                                                        MD049078
     C     CLE034        IFEQ      'Y'                                                      MD049078
     C     STAL          ANDEQ     'Y'                                                      MD049078
     C                   Z-ADD     KEAMT         KPAMT                                      MD049078
     C                   ENDIF                                                              MD049078
     C                   Z-ADD     0             KIAMT                                        263074
                                                                                              CLE164
     C                   EXSR      SRRETRPKY                                                  CLE164
     C                   EXSR      SRRETDAT                                                   CLE164
                                                                                              CLE164
     C                   EVAL      SEPAMT = KEAMT                                             CLE164
     C                   EVAL      SETRID = SETRID + 1                                        CLE164
     C                   EVAL      SEOVRD = 0                                                 CLE164
     C                   WRITE     LKEYF1DF                                                   263074
     C     KEAMT         IFGT      0                                                        MD048557
     C                   Z-ADD     KEAMT         WACAMT                                     MD048557
     C                   ELSE                                                               MD048557
     C                   Z-SUB     KEAMT         WACAMT                                     MD048557
     C                   ENDIF                                                              MD048557
                                                                                            MD048557
     C     WACAMT        DIV       1000          ZZAMT                  80                  MD048557
     C                   Z-ADD     L1VLRF        ZZTOTI                                     MD048557
     C                   Z-ADD     L1VLRL        ZZTOTD                                     MD048557
     C                   EXSR      GLZADD                                                   MD048557
     C                   Z-ADD     ZZTOTI        L1VLRF                                     MD048557
     C                   Z-ADD     ZZTOTD        L1VLRL                                     MD048557
                                                                                              CLE164
      * End of Processing for Principal Repayments                                            CLE164
                                                                                              CLE164
     C                   ENDIF                                                                CLE164
     C**********         ENDIF                                                         263074 CLE164
      *                                                                                       CLE134
     C                   ELSE                                                               AR741212
     C                   SETOFF                                       30                    AR741212
     C                   MOVE      'N'           WNEWF                                      AR741212
     C                   ENDIF                                                              AR741212
     C                   ENDIF                                                                CLE134
      *                                                                                       CLE134
      *  IF *IN30 is off then output to LKEY1DP else output to LEPK1DP                        CLE134
      *                                                                                       CLE134
     C     *IN30         IFEQ      *OFF                                                       CLE134
1672 C                   SETON                                        50
     C                   ENDIF                                                                CLE134
     C**********         EVAL       WSKEY = ' '                                    MD048557 MD049078
     C*****AKY(3)        IFEQ      'S'                                             MD046080 MD049078
     C*****CLE031        ANDEQ     'Y'                                             MD048557 MD049078
     C*****CLE134        ANDEQ     'Y'                                             MD048557 MD049078
     C**********         SETOFF                                       50           MD046080 MD049078
     C**********         EVAL       WSKEY = 'Y'                                    MD048557 MD049078
     C**********         ENDIF                                                     MD046080 MD049078
      *                                                                                     MD022450
     C                   IF        ACAMNT = *ZEROS                                          MD022450
     C**********                   OR WSKEY = 'Y'                                  MD048557 MD049078
     C                   SETOFF                                       50                    MD022450
      * So if record not output ensure trailer is not increased.                            MD022450
     C     NORK          SUB       1             NORK                                       MD022450
     C     NORKR         SUB       1             NORKR                                      MD022450
     C                   ENDIF                                                              MD022450
      *                                                                                       CLE134
1673 C                   EXCEPT
      *                                                                                     AR741212
      ** Move Hash Total Processing here.                                                   AR741212
      *                                                                                     AR741212
     C     WNEWF         IFEQ      'N'                                                      AR741212
     C*****WSKEY         ANDEQ     ' '                                             MD048557 MD049078
     C     ACAMNT        DIV       1000          ZZAMT                  80                  AR741212
     C   80              Z-SUB     ZZAMT         ZZAMT                                      AR741212
     C                   Z-ADD     TOTIKY        ZZTOTI                                     AR741212
     C                   Z-ADD     TOTDKY        ZZTOTD                                     AR741212
     C                   EXSR      GLZADD                                                   AR741212
     C                   Z-ADD     ZZTOTI        TOTIKY           15 0                      AR741212
     C                   Z-ADD     ZZTOTD        TOTDKY            3 0                      AR741212
     C                   ELSE                                                               AR741212
     C**********         Z-ADD     0             WACAMT           13 0             AR741212 MD048557
     C**********         Z-ADD     0             ZZAMT                             AR741212 MD048557
     C*****WSEPKY        IFEQ      'Y'                                            AR1095440 MD048557
     C*****PRAM*         IFGT      0                                               AR741212 MD048557
     C**********         Z-ADD     PRAM          WACAMT                            AR741212 MD048557
     C**********         ELSE                                                      AR741212 MD048557
     C**********         Z-SUB     PRAM          WACAMT                            AR741212 MD048557
     C**********         ENDIF                                                     AR741212 MD048557
     C*****INTA*         IFGT      0                                               AR741212 MD048557
     C**********         ADD       INTA          WACAMT                            AR741212 MD048557
     C**********         ELSE                                                      AR741212 MD048557
     C**********         SUB       INTA          WACAMT                            AR741212 MD048557
     C**********         ENDIF                                                     AR741212 MD048557
     C**********         ELSE                                                     AR1095440 MD048557
     C*****KEAMT         IFGT      0                                              AR1095440 MD048557
     C**********         Z-ADD     KEAMT         WACAMT                           AR1095440 MD048557
     C**********         ELSE                                                     AR1095440 MD048557
     C**********         Z-SUB     KEAMT         WACAMT                           AR1095440 MD048557
     C**********         ENDIF                                                    AR1095440 MD048557
     C**********         ENDIF                                                    AR1095440 MD048557
     C*****WACAMT        DIV       1000          ZZAMT                  80         AR741212 MD048557
     C**********         Z-ADD     L1VLRF        ZZTOTI                            AR741212 MD048557
     C**********         Z-ADD     L1VLRL        ZZTOTD                            AR741212 MD048557
     C**********         EXSR      GLZADD                                          AR741212 MD048557
     C**********         Z-ADD     ZZTOTI        L1VLRF                            AR741212 MD048557
     C**********         Z-ADD     ZZTOTD        L1VLRL                            AR741212 MD048557
     C                   ENDIF                                                              AR741212
      *                                                                                       CGL020
      ** If Midas Compliance Watch (CGL020) is installed and Repayment,                       CGL020
      ** reset Fee Flag, Fee Value and Fee Percent.                                           CGL020
      *                                                                                       CGL020
     C     CGL020        IFEQ      'Y'
     C                   MOVE      *BLANKS       F1FFLG
     C                   Z-ADD     0             F1FVAL
     C                   Z-ADD     0             F1FPCT
     C                   ENDIF
      *                                                                                       CGL020
      ***********                                                  CEU004 134798
      ***If*feature*CEU004*is*on,*reset*settlement*currency*output CEU004 134798
      ***********                                                  CEU004 134798
     C***********CEU004    IFEQ 'Y'                        If Feat CEU004 134798
     C***********          MOVE *BLANKS   LKSCCY  3         Clr Ou CEU004 134798
     C***********          ENDIF                           End If  CEU004 134798
      ***********                                                  CEU004 134798
1674 C                   SETOFF                                       50
      *                                                                                       CLE134
      ** If WNEWF = Y: Account key is output to LEPK1DP                                       CLE134
      ** instead of LKEY1DP                                                                   CLE134
      *                                                                                       CLE134
     C     WNEWF         IFEQ      'N'                                                        CLE134
      *                                                                                       CLE134
1675 C     NORK          ADD       1             NORK              5 0
1676 C     NORKR         ADD       1             NORKR             5 0
     C                   ELSE                                                                 CLE134
     C     L1NORE        ADD       1             L1NORE                                       CLE134
      *                                                                                       263074
      * Add 1 to NORE for the Principal additional account key                                263074
      *                                                                                       263074
     C     WSEPKY        IFEQ      'Y'                                                        263074
     C     L1NORE        ADD       1             L1NORE                                       263074
     C                   MOVE      *BLANKS       WSEPKY                                       263074
     C                   ENDIF                                                                263074
      *                                                                                       263074
     C                   MOVE      *OFF          *IN30                                        CLE134
     C                   ENDIF                                                                CLE134
      *                                                                                       CLE134
     C                   MOVE      IN46          *IN46                                         15766
     C                   Z-ADD     WACMNT        ACAMNT                                        15766
1677 C**
     C/COPY WNCPYSRC,LE0450C056
1678 C                   ENDSR
1679 C**
1680 C**
1681 C********************************************************************
      *****************************************************************                       CLE134
      *                                                               *                       CLE134
      *  Suboutine to set Take on Account - STAKEA                    *                       CLE134
      *                                                               *                       CLE134
      *****************************************************************                       CLE134
      *                                                                                       CLE134
     C     STAKEA        BEGSR                                                                CLE134
      *                                                                                       CLE134
     C     KPACC         CHAIN     ACCNT                              24                      CLE134
      *                                                                                       CLE134
      ** Set OSAC = Interest take on account                                                  CLE134
      *                                                                                       CLE134
     C     *IN24         IFEQ      *OFF                                                       CLE134
     C                   MOVE      PBRCA         OSBR                                         CLE134
     C     PATYP         IFEQ      'R'                                                        CLE134
     C                   MOVEL     PACNO         OSAC                                         CLE134
     C                   Z-ADD     14            SETP                                         CLE134
     C                   ELSE                                                                 CLE134
     C                   Z-ADD     05            SETP                                         CLE134
     C                   MOVEL     PCNUM         WRKAC1           16                          CLE134
     C                   MOVE      PACOD         WRKAC1                                       CLE134
     C                   MOVEL     WRKAC1        WRKAC2           18                          CLE134
     C                   MOVE      PACSQ         WRKAC2                                       CLE134
     C                   MOVEL     WRKAC2        OSAC                                         CLE134
     C                   ENDIF                                                                CLE134
     C                   ENDIF                                                                CLE134
      *                                                                                       CLE134
     C                   ENDSR                                                                CLE134
      *                                                                                       CLE134
1682 C********************************************************************
1683 C**
1684 C**   SUBROUTINE TO ADJUST FOR PRINCIPAL - CPAMUP
1685 C**
1686 C**   CALLED FROM PRININ,MANREP,REPSCD,MATRTY
1687 C**   CALLS NO OTHER SUBROUTINES
1688 C**
1689 C     CPAMUP        BEGSR                                                  ***  CPAMUP ***
     C*                                                                   060536
     C** Save value of current principal before updating.                 060536
     C*                                                                   060536
     C                   Z-ADD     CPAM          OCPAM                                         06053
1690 C**
1691 C**   ADD AMOUNT TO CURRENT PRINCIPAL
1692 C**
1693 C     CPAM          ADD       AMOUNT        CPAM
1694 C**
1695 C**   CHECK START DATE OF AGG. BAL CALC
1696 C**
1697 C     VDAT          COMP      JAN1                                 89
1698 C   89              Z-ADD     JAN1          DAY1
1699 C  N89              Z-ADD     VDAT          DAY1
1700 C**
1701 C**   CHECK FOR END DATE OF AGG. BAL CALC
1702 C**
1703 C   43DEC31         COMP      EVCD                                 89
1704 C                   Z-ADD     EVCD          DAY2
     C   43
1705 CAN 89              Z-ADD     DEC31         DAY2
1706 C**
1707 C**   CALCUALATE AGG.BAL ADJUSTMENT
1708 C**
1709 C     DAY2          SUB       DAY1          WRK05
1710 C     WRK05         ADD       1             WRK05                  89
1711 C   89              Z-ADD     0             WRK05
1712 C     AMOUNT        MULT      WRK05         WRK13
1713 C     AGBAL         ADD       WRK13         AGBAL
1714 C**
1715 C                   ENDSR
1716 C**
1717 C**
1718 C********************************************************************
1719 C********************************************************************
1720 C**
1721 C**   SUBROUTINE TO PROCESS INTEREST AMOUNTS - INTRST
1722 C**
1723 C**   CALLED FROM MANREP,INTPAY,REPSCD,MATRTY
1724 C*****CALLS AKYOUT(4)                                                                    CLE031
1724 C**   CALLS AKYOUT(4),SETCCY,SETTLE                                                      CLE031
1725 C**
1726 C     INTRST        BEGSR                                                  ***  INTRST ***
1727 C**
1728 C**   ADD W/TAX INTO INTEREST AMOUNT IF TAX IS 'G' OR 'R'
1729 C**
1730 C                   Z-ADD     INTA          WRK13
1731 C   49WRK13         ADD       WTXA          WRK13
     C     CAS005        IFEQ      'Y'
     C                   Z-ADD     INTN          WRK13N
     C     *IN49         IFEQ      *ON
     C     WRK13N        ADD       WTXA          WRK13N           13 0
     C                   ENDIF
     C                   ENDIF
1732 C**
1733 C**   GENERAL A/C KEY FOR INTEREST AMOUNT
1734 C**
1735 C                   Z-ADD     VDAT          ACDATE
1736 C                   Z-ADD     WRK13         ACAMNT                   89
1737 C                   MOVE      'R'           AKY(3)
     C/COPY WNCPYSRC,LEH00472
1738 C                   MOVEA     BKAKY         AKY(6)
     C/COPY WNCPYSRC,LEH00473
1739 C   85              MOVE      'W'           AKY(9)
1740 C                   MOVE      'I'           AKY(10)
     C/COPY WNCPYSRC,LE0450C033
1741 C   51              MOVE      'C'           AKY(10)
      *                                                                                       CLE134
      * WORIGA*= Y: Original*Loan*Repayment*must*generate a/c key DI                   CLE134 262967
      *                                                                                       CLE134
     C**N51***** WORIGA    IFEQ 'Y'                                                    CLE134 262967
     C********** *IN85     ANDEQ*OFF                                                   CLE134 262967
     C**********           MOVEA'XI'      AKY,9                                        CLE134 262967
     C**********           ENDIF                                                       CLE134 262967
      *                                                                                       CLE134
     C*                                                                   S01392
     C**  REPAYMENT OF PAST DUE FOR EARLY MATURITY OF DISCOUNTED          S01392
     C**  LOAN, THE INTEREST AMOUNT IS -VE.  GENERATE REBATE A/C KEY      S01392
     C*                                                                   S01392
     C     PTYP          IFEQ      63                                                          S0139
     C***********INTA      IFLT 0                                  S01392 046648
     C     INTA          ANDLT     0                                                           04664
     C     PTYP          OREQ      65                                                          12209
     C     INTA          ANDLT     0                                                           12209
     C     CLE004        ANDEQ     'Y'                                                         13897
     C     PTYP          OREQ      67                                                          12209
     C     INTA          ANDLT     0                                                           12209
     C     CLE004        ANDEQ     'Y'                                                         13897
     C                   Z-SUB     WRK13         ACAMNT                                        S0139
     C                   MOVE      'E'           AKY(10)                                       S0139
     C                   ADD       INTA          PDIN                                          04664
      *                                                                                       CAS005
     C     CAS005        IFEQ      'Y'
     C                   ADD       INTN          PDNN
     C                   Z-ADD     *ZERO         WRK13N
     C                   ENDIF
     C*                                                                   046648
     C*  Past due interest represents the REBATE for early repayments     046648
     C*                    NOT the INTEREST PAID                          046648
     C                   Z-ADD     *ZERO         WRK13                                         04664
     C*    IF PAST DUE INTEREST FULLY SETTLED ===>                        046648
     C*                               Rebate has been settled             046648
     C*                               Interest Paid is TOTI               046648
     C     PDIN          IFEQ      0                                                           04664
     C                   Z-ADD     TOTI          WRK13                                         04664
     C                   END                                                                   04664
     C     CAS005        IFEQ      'Y'
     C     PDNN          ANDEQ     0
     C                   Z-ADD     TOTN          WRK13N
     C                   ENDIF
     C                   END                                                                   S0139
     C***********          MOVEAAKY       AKYS                      160856182711
      *                                                                                       CLE034
      ** If CLE034 is installed                                                               CLE034
      *                                                                                       CLE034
     C     CLE034        IFEQ      'Y'
     C     STAL          ANDEQ     'Y'
     C     *IN89         ANDEQ     *OFF
     C                   MOVE      'E'           WTYPE
     C                   EXSR      SR34A
     C                   ELSE
     C                   MOVE      'Y'           WRKFLD
     C                   MOVE      '*EOF   '     PRTCD
     C                   ENDIF
      *                                                                                       CLE034
     C     WRKFLD        DOWEQ     'Y'
     C     PRTCD         OREQ      *BLANKS
     C     CLE034        IFEQ      'Y'
     C     STAL          ANDEQ     'Y'
     C                   EXSR      SR34B
     C                   ENDIF
      *                                                                                       CLE031
      ** If feature CLE031 is on and indicator 89 is off then                                 CLE031
      ** set work type to 'end' and call SR/SETCCY                                            CLE031
      *                                                                                       CLE031
     C     CLE031        IFEQ      'Y'
     C     *IN89         ANDEQ     *OFF
     C                   MOVE      'E'           WTYPE
     C                   EXSR      SETCCY
      *                                                                                       CLE031
     C**********           MOVE OSAC      OSACSV 12                                    CLE031 CGL029
     C                   MOVE      OSAC          OSACSV
     C                   MOVE      SETP          SETPSV            2 0
      *                                                                                       CLE031
     C     PTYP          IFNE      66
     C     PTYP          ANDNE     67
     C     PTYP          ANDNE     69
     C     PTYP          ANDNE     72
     C                   MOVE      RONS          OSAC
     C                   MOVE      RSTM          SETP
     C                   ELSE
     C                   MOVE      PONS          OSAC
     C                   MOVE      PSTM          SETP
     C                   ENDIF
      *                                                                                       CLE031
     C                   ENDIF
      *                                                                                       CLE031
1742 C**N89*****           EXSR AKYOUT                                                        CLE028
     C     AMTP          IFEQ      'MA'
     C                   EXSR      AKYOUT
     C                   ELSE
     C  N89
1742 CANN77              EXSR      AKYOUT
     C                   ENDIF
      *                                                                                       262967
      ** WORIGA = Y: Original Loan Repayment must generate                                    262967
      ** an additiona account key XI                                                          262967
      *                                                                                       262967
     C  N51WORIGA        IFEQ      'Y'                                                        262967
     C     *IN85         ANDEQ     *OFF                                                       262967
     C     WMRAUT        ANDEQ     'Y'                                                        263416
     C                   MOVEA     'XI'          AKY(9)                                       262967
     C  N89                                                                                   262967
     CANN77              EXSR      AKYOUT                                                     262967
     C                   ENDIF                                                                262967
      *                                                                                       CLE134
      ** Reset a/c key                                                                        CLE134
      *                                                                                       CLE134
     C  N51WORIGA        IFEQ      'Y'                                                        CLE134
     C     *IN85         ANDEQ     *OFF                                                       CLE134
     C                   MOVEA     ' I'          AKY(9)                                       CLE134
     C                   ENDIF                                                                CLE134
      *                                                                                       CLE031
      ** If feature CLE031 is on and indicator 89 is off then set work                        CLE031
      ** interest to 'I', call SR/SETTLE then set work interest to blanks                     CLE031
      *                                                                                       CLE031
     C     CLE031        IFEQ      'Y'
     C     *IN89         ANDEQ     *OFF
     C                   MOVE      OSACSV        OSAC
     C                   MOVE      SETPSV        SETP
     C                   MOVE      'I'           WINT
     C                   EXSR      SETTLE
     C                   MOVE      *BLANKS       WINT
     C                   ENDIF
      *                                                                                       CLE034
     C     CLE034        IFEQ      'Y'
     C     STAL          ANDEQ     'Y'
     C                   EXSR      SR34C
     C                   ELSE
     C                   MOVE      *BLANKS       WRKFLD
     C                   ENDIF
     C                   ENDDO
      *                                                                                       CLE034
     C     CLE034        IFEQ      'Y'
     C     STAL          ANDEQ     'Y'
     C                   EXSR      SR34E
     C                   ENDIF
      *                                                                                       CAS009
      ** Reset the accrued interest to date from EIR start date if necessary.                 CAS009
      *                                                                                       CAS009
     C     CAS009        IFEQ      'Y'
     C     *IN89         ANDEQ     *OFF
     C     *IN77         ANDEQ     *OFF
      *                                                                                       232348
      ** Only process EIR cost accounting if loan's value date is same                        232348
      ** as or after the non-linear amortisation cut-off date                                 232348
     C     VDAT          ANDGE     FSNLAC
     C                   MOVE      *IN10         WIN10
     C                   MOVE      LNRF          KTRAN
     C     KTRAN         CHAIN     LEEIRDL5                           10
      *                                                                                       CAS009
     C     *IN10         IFEQ      *OFF
     C     WRK13         ANDGE     EIACTD
     C                   Z-ADD     *ZERO         EIACTD
     C                   UPDATE    LEEIRDD0
     C                   ENDIF
      *                                                                                       CAS009
     C                   MOVE      WIN10         *IN10
     C                   ENDIF
      *                                                                   CAC001
      **  Generate Interest Amount Account Key.                           CAC001
      *                                                                   CAC001
     C     BGN0ST        IFEQ      'Y'                                                         CAC00
     C     FPRCL         ANDNE     *BLANKS                                                     CAC00
     C     *IN45         ANDEQ     '0'                                                         CAC00
      *                                                                   CAC001
     C                   Z-ADD     COFA          ACAMNT                   89                   CAC00
     C                   MOVE      'I'           AKY(10)                                       CAC00
     C   51              MOVE      'C'           AKY(10)                                       CAC00
      *                                                                   CAC001
      ** Transaction Profit Centre                                        CAC001
      *                                                                   CAC001
     C                   MOVEA     'T '          AKY(6)                                        CAC00
     C     *IN89         IFEQ      '0'                                                         CAC00
     C                   EXSR      AKYOUT                                                      CAC00
     C                   ENDIF                                                                 CAC00
      *                                                                   CAC001
      ** Funding Profit Centre                                            CAC001
      *                                                                   CAC001
     C                   MOVEA     'F '          AKY(6)                                        CAC00
     C                   MOVEL     PRFC          WPRFC                                         CAC00
     C                   MOVEL     FPRCL         PRFC                                          CAC00
     C     AMTP          IFEQ      'MA'
     C                   EXSR      AKYOUT
     C                   ELSE
     C     *IN89         IFEQ      '0'                                                         CAC00
     C     *IN77         ANDEQ     '0'
     C                   EXSR      AKYOUT                                                      CAC00
     C                   ENDIF                                                                 CAC00
     C                   ENDIF
      *                                                                   CAC001
     C                   MOVEL     WPRFC         PRFC                                          CAC00
     C                   MOVEA     BKAKY         AKY(6)                                        CAC00
     C   85              MOVE      'W'           AKY(9)                                        CAC00
      *                                                                   CAC001
     C                   ENDIF                                                                 CAC00
     C*                                                                   S01408
     C/COPY WNCPYSRC,LE0450CCPG                                           S01408
     C*                                                                   S01408
1743 C**
1744 C**   UPDATE FILE AMOUNTS
1745 C**
1746 C   85IWOD          ADD       WRK13         IWOD
1747 C   51ICTD          ADD       WRK13         ICTD
     C  N85
1748 CANN51IPRD          ADD       WRK13         IPRD
     C  N85
1749 CANN51IPRM          ADD       WRK13         IPRM
      *                                                                   CAC001
     C     BGN0ST        IFEQ      'Y'                                                         CAC00
     C     FPRCL         ANDNE     *BLANKS                                                     CAC00
      *                                                                   CAC001
     C     *IN85         IFEQ      '1'                                                         CAC00
     C                   ADD       COFA          FWOD                                          CAC00
     C                   ENDIF                                                                 CAC00
      *                                                                   CAC001
     C     *IN51         IFEQ      '1'                                                         CAC00
     C                   ADD       COFA          CFCD                                          CAC00
     C                   ENDIF                                                                 CAC00
      *                                                                   CAC001
     C     *IN85         IFEQ      '0'                                                         CAC00
     C     *IN51         ANDEQ     '0'                                                         CAC00
     C                   ADD       COFA          COFD                                          CAC00
     C                   ADD       COFA          COFM                                          CAC00
     C                   ENDIF                                                                 CAC00
      *                                                                   CAC001
     C                   ENDIF                                                                 CAC00
      *                                                                                       CAS005
      ** If CAS005 is installed, update the interest amounts                                  CAS005
      *                                                                                       CAS005
     C     CAS005        IFEQ      'Y'
      *                                                                                       CAS005
     C     *IN85         IFEQ      *ON
     C                   ADD       WRK13N        IWON
     C                   ENDIF
      *                                                                                       CAS005
     C     *IN51         IFEQ      *ON
     C                   ADD       WRK13N        ICTN
     C                   ENDIF
      *                                                                                       CAS005
     C     *IN85         IFEQ      *OFF
     C     *IN51         ANDEQ     *OFF
     C                   ADD       WRK13N        IPRN
     C                   ADD       WRK13N        IPNM
     C                   ENDIF
      *                                                                                       CAS005
     C                   ENDIF
1750 C**
1751 C**   UPDATE YTD AJUSTMENTS
1752 C**
     C  N85
1753 CANN51YTDINP        ADD       WRK13         YTDINP           13 0
1754 C   85YTDINW        ADD       WRK13         YTDINW           13 0
1755 C**
1756 C**   UPDATE CURRENT PRINCIPAL IF INT. CAPITALISED
1757 C**
1758 C   51              Z-ADD     WRK13         AMOUNT
1759 C   51              EXSR      CPAMUP
     C   51ACRBAL        ADD       AMOUNT        ACRBAL
      *                                                                                       CAS005
     C     CAS005        IFEQ      'Y'
     C     *IN51         ANDEQ     *ON
     C     FSCPAM        ADD       WRK13N        FSCPAM
     C                   ENDIF
     C/COPY WNCPYSRC,LE0450C034
1760 C**
1761 C**   ACCRUE INTEREST TO DATE IF REQUIRED
1762 C**
1763 C***48***********     GOTO SLIDUP                     STOP AC. ON    E43688
     C   48
1763 CANN47              GOTO      SLIDUP                                       STOP AC. ON    E4368
     C**                                                                  E47259
     C**   GENERATE ACCRUAL KEY IF VALUE DATE = VALUE DATE OF LAST        E47259
     C**   INTEREST PAYMENT TO BE ACTIONED TODAY                          E47259
     C**                                                                  E47259
     C     VDAT          COMP      LIVD                                   88                   E4725
      *                                                                                    MD022510A
     C     AMTP          IFEQ      'MR'                                                    MD022510A
     C     PRAM          ANDEQ     0                                                       MD022510A
     C     NEWCOB        ANDEQ     'Y'                                                     MD022510A
     C                   SETOFF                                       88                   MD022510A
     C                   ENDIF                                                             MD022510A
      *                                                                                    MD022510A
     C/COPY WNCPYSRC,LE0450C049
     C**N88***********     GOTO SLIDUP                              E47259E43688
     C  N48
     CANN88              GOTO      SLIDUP                                                      E4368
1764 C**
1765 C**   CHECK FOR GREATER OF ACCRUED/PAID AND POST AMOUNT NOT POSTED
1766 C**
     C********** VDAT      IFEQ MDAT                                                   247263 254075
1767 C     IPRD          ADD       ICTD          WRK13
1768 C     WRK13         ADD       IWOD          WRK13
1769 C     AITC          ADD       AIAP          WRK13A           13 0
1770 C     WRK13A        COMP      WRK13                              88
1770 C   88WRK13A        COMP      AIPD                                 88                  AR897086
     C/COPY WNCPYSRC,LE0450C050
1771 C   88              Z-ADD     WRK13A        WRK13
1772 C**
1773 C**   SAVE POSTING AMOUNT FOR W/TAX CALC.
1774 C**
1777 C     WRK13         SUB       AIPD          WRK13
     C*
1775 C                   Z-ADD     WRK13         AMOUNT
1778 C**
1779 C**   GENERATE AN ACCRUAL A/C KEY
1780 C**
     C   88              Z-ADD     IACD          ACDATE
     C     *IN88         IFEQ      '1'                                                         07258
     C                   MOVE      '1'           *IN35                                         07258
     C                   END                                                                   07258
1781 C***********          Z-ADDWRK13     ACAMNT         89               S01392
     C                   Z-ADD     WRK13         ACAMNT                 8889                   S0139
1782 C                   MOVE      'A'           AKY(3)
1783 C                   MOVEA     BKAKY         AKY(6)
1784 C                   MOVE      'I'           AKY(10)
     C   45
     CAN 88              MOVE      'P'           AKY(10)
     C   45
     CAN 88              Z-SUB     ACAMNT        ACAMNT
     C   45
     CANN88              MOVE      'D'           AKY(10)
     C     CLE028        IFEQ      'Y'
     C     PTYP          ANDEQ     80
     C     ADIF          ANDEQ     'Y'
     C                   MOVE      'D'           AKY(10)
     C     CLE028        IFEQ      'Y'
     C     PTYP          ANDEQ     80
     C     ADIF          ANDEQ     'Y'
     C                   MOVE      'D'           AKY(10)
     C                   ENDIF
     C                   ENDIF
1785 C***********          SETON                     65                   E10921
1785 C                   SETON                                        6566                     E1092
1785 C** IF RATE NOT CHANGED FOR THIS LOAN DO NOT OUTPUT OLD RATE         047546
1785 C     LNRF2         IFNE      LNRF                                                        04754
1785 C                   SETOFF                                       66                       04754
1785 C                   END                                                                   04754
     C     CAS009        IFEQ      'Y'
      *                                                                                       232348
      ** Only process EIR cost accounting if loan's value date is same                        232348
      ** as or after the non-linear amortisation cut-off date                                 232348
     C     VDAT          ANDGE     FSNLAC
      *                                                                                       232348
     C                   EXSR      SRRTVI
     C                   ENDIF
     C     CAS009        IFEQ      'Y'
     C     *IN45         ANDEQ     '1'
     C     FSAMRM        ANDEQ     'N'
     C     AYACAI        ANDEQ     'Y'
      *                                                                                       232348
      ** Only process EIR cost accounting if loan's value date is same                        232348
      ** as or after the non-linear amortisation cut-off date                                 232348
     C     VDAT          ANDGE     FSNLAC
      *                                                                                       232315
      ** Suppress Dicount/Premium Amount for Discount Loans when                              232315
      ** the Amortisation Method is 'N'on-Linear.                                             232315
      *                                                                                       232315
     C                   ELSE
     C     AMTP          IFEQ      'MA'
     C                   EXSR      AKYOUT
     C                   ELSE
1786 C  N89              EXSR      AKYOUT
     C                   ENDIF
     C                   ENDIF
      *                                                                                       CLE028
      ** Generate charge amortisation account key for                                         CLE028
      ** add on charges type of loan                                                          CLE028
      *                                                                                       CLE028
     C     CLE028        IFEQ      'Y'
     C     PTYP          ANDEQ     80
     C     ADCF          ANDEQ     'Y'
     C     WCHDU         IFNE      0
     C                   Z-ADD     VDAT          ACDATE
     C                   Z-ADD     WCHDU         ACAMNT
     C                   MOVE      'H'           AKY(10)
     C                   EXSR      AKYOUT
     C                   Z-ADD     *ZERO         WCHDU
     C                   ENDIF
      *                                                                                       CLE028
      ** Putback AICD to ACDATE if *IN88 is on                                                CLE028
      *                                                                                       CLE028
     C     *IN88         IFEQ      *ON
     C                   Z-ADD     IACD          ACDATE
     C                   ENDIF
     C                   ENDIF
      *                                                                   CAC001
      **  Generate Accrual Date Account Keys                              CAC001
      *                                                                   CAC001
     C     BGN0ST        IFEQ      'Y'                                                         CAC00
     C     FPRCL         ANDNE     *BLANKS                                                     CAC00
     C     *IN45         ANDEQ     '0'                                                         CAC00
      *                                                                   CAC001
      **  Calculate Posting Amount                                        CAC001
      *                                                                   CAC001
     C                   EXSR      SRCPAM                                                      CAC00
      *                                                                   CAC001
      **  COF Accrued not yet posted - Transation profit centre           CAC001
      *                                                                   CAC001
     C                   MOVEA     'T   '        AKY(6)                                        CAC00
     C                   MOVE      'I'           AKY(10)                                       CAC00
     C     AMTP          IFEQ      'MA'
     C                   EXSR      AKYOUT
     C                   ELSE
     C     *IN89         IFEQ      '0'                                                         CAC00
     C                   EXSR      AKYOUT                                                      CAC00
     C                   ENDIF                                                                 CAC00
     C                   ENDIF
      *                                                                   CAC001
      **  COF Accrued not yet posted - Funding Profit Centre              CAC001
      *                                                                   CAC001
     C                   MOVEA     'F   '        AKY(6)                                        CAC00
     C                   MOVEL     PRFC          WPRFC                                         CAC00
     C                   MOVEL     FPRCL         PRFC                                          CAC00
     C     AMTP          IFEQ      'MA'
     C                   EXSR      AKYOUT
     C                   ELSE
     C     *IN89         IFEQ      '0'                                                         CAC00
     C                   EXSR      AKYOUT                                                      CAC00
     C                   ENDIF                                                                 CAC00
     C                   ENDIF
     C                   MOVEL     WPRFC         PRFC                                          CAC00
     C                   MOVEA     BKAKY         AKY(6)                                        CAC00
      *                                                                   CAC001
     C                   ENDIF                                                                 CAC00
      *                                                                   CAC001
     C     CAS005        IFEQ      'Y'
     C                   EXSR      SRNETR
     C                   ENDIF
      *                                                                                       CAS005
1787 C***********          SETOF                     65                   E10921
1787 C                   SETOFF                                       6566                     E1092
1788 C**
1789 C**   UPDATE ACCRUED INTEREST POSTED TO DATE FIELD
1790 C**
     C     CAS009        IFEQ      'Y'
      *                                                                                       232348
      ** Only process EIR cost accounting if loan's value date is same                        232348
      ** as or after the non-linear amortisation cut-off date                                 232348
     C     VDAT          ANDGE     FSNLAC
      *                                                                                       232348
     C                   EXSR      SRRTVI
     C                   ENDIF
     C     CAS009        IFEQ      'Y'
     C     *IN45         ANDEQ     '1'
     C     FSAMRM        ANDEQ     'N'
     C     AYACAI        ANDEQ     'Y'
      *                                                                                       232348
      ** Only process EIR cost accounting if loan's value date is same                        232348
      ** as or after the non-linear amortisation cut-off date                                 232348
     C     VDAT          ANDGE     FSNLAC
      *                                                                                       CAS009
      ** Suppress Linear Amortisation for Discount Loans when                                 CAS009
      ** the Amortisation Method is 'N'on-Linear.                                             CAS009
      *                                                                                       CAS009
     C                   ELSE
1791 C     AIPD          ADD       WRK13         AIPD
     C                   ENDIF
     C**********           ENDIF                                                       247263 254075
      *                                                                   CAC001
     C     BGN0ST        IFEQ      'Y'                                                         CAC00
     C     FPRCL         ANDNE     *BLANKS                                                     CAC00
     C                   ADD       WK13N         ACPD                                          CAC00
     C                   ENDIF                                                                 CAC00
      *                                                                                       CAS005
     C     CAS005        IFEQ      'Y'
     C     AIPN          ADD       WK13R         AIPN
     C                   ENDIF
1792 C**
1793 C**   UPDATE START/LAST INTEREST DATE
1794 C**
1795 C     SLIDUP        TAG                                                    ** SLIDUP TAG *
1796 C**
1797 C     VDAT          COMP      SLID                                 89
1798 C  N89              Z-ADD     VDAT          SLID
1799 C**
1800 C**   GENERATE AN A/C KEY FOR W/TAX AMOUNT
1801 C**
     C                   Z-ADD     VDAT          ACDATE
1802 C     WTINL         COMP      ' '                                    89
1803 C   89              GOTO      INTEND
1804 C**
1805 C                   Z-ADD     WTXA          ACAMNT                   89
1806 C                   MOVE      'R'           AKY(3)
1807 C                   MOVEA     BKAKY         AKY(6)
1808 C                   MOVE      WTINL         AKY(6)
1809 C   85              MOVE      'W'           AKY(9)
1810 C                   MOVE      'W'           AKY(10)
     C     AMTP          IFEQ      'MA'
     C                   EXSR      AKYOUT
     C                   ELSE
1811 C  N89              EXSR      AKYOUT
     C                   ENDIF
1812 C**
1813 C**   UPDATE FIELDS ON FILE
1814 C**
1815 C   85WTWD          ADD       WTXA          WTWD
1816 C  N85WTRD          ADD       WTXA          WTRD
1817 C**
1818 C**   UPDATE YTD ADJUSTMENTS
1819 C**
1820 C   85YTDWTW        ADD       WTXA          YTDWTW           13 0
1821 C  N85YTDWTP        ADD       WTXA          YTDWTP           13 0
1822 C**
1823 C**   ACCRUE W/TAX TO DATE IF REQUIRED
1824 C**
1825 C   48              GOTO      INTEND
1826 C**
1827 C     WTWD          ADD       WTRD          WRK13
1828 C**
1829 C     WRK13         SUB       AWTP          WRK13
1830 C**
1831 C**   GENERATE ACCRUAL A/C KEY
1832 C**
1833 C**
1834 C**   USE AMOUNT OF INTEREST ACCRUAL KEY TO CALC. W/TAX AMOUNT
1835 C**
12852C     WRK13         ADD       AMOUNT        AMOUNT
1836 C                   EXSR      WTAX
1837 C                   Z-ADD     AMOUNT        ACAMNT                   89
     C   88              Z-ADD     IACD          ACDATE
1838 C                   MOVE      'A'           AKY(3)
1839 C                   MOVEA     BKAKY         AKY(6)
1840 C                   MOVE      WTINL         AKY(6)
1841 C                   MOVE      'W'           AKY(10)
1842 C                   SETON                                        65
     C     AMTP          IFEQ      'MA'
     C                   EXSR      AKYOUT
     C                   ELSE
1843 C  N89              EXSR      AKYOUT
     C                   ENDIF
1844 C                   SETOFF                                       65
1845 C**
1846 C**   UPDATE ACCRUED W/TAX POSTED FIELD
1847 C**
1848 C     AWTP          ADD       AMOUNT        AWTP
1849 C**
     C**   RESET ACCOUNT KEY DATE
     C**
     C                   Z-ADD     VDAT          ACDATE
     C**
1850 C     INTEND        ENDSR                                                  ***  INTEND ***
1851 C**
1852 C**
1853 C********************************************************************
1854 C********************************************************************
1855 C**
1856 C**   SUBROUTINE TO INCREASE DATE BY FREQUENCY - FREQIN
1857 C**
1858 C**   CALLED FROM ROLLOV,INDTUP,RPDTUP
1859 C*****CALLS*ZFREQB,ZDATE5                                            S01195
1859 C*****CALLS FREQB,ZFWDT                                              S01195
1859 C**   CALLS ZFREQB,ZFWDT                                    S01392   S01392
1860 C**
1861 C     FREQIN        BEGSR                                                  ***  FREQIN ***
1862 C**
1863 C     ZFREQ         COMP      ' '                                    89
1864 C   89              GOTO      BLNKFQ
1865 C**
1866 C***********          EXSR ZFREQB                                    S01195
1867 C***********          EXSR ZDATE5                                    S01195
     C*                                                                   S01195
     C**   IF ROLLOVER, USE LOAN CCY AND BRANCH'S LOCATION                S01195
     C**   ELSE, USE SETTLEMENT TYPE AND NOSTRO TO GET ZCCY AND ZLOC      S01195
     C*                                                                   S01195
     C     AMTP          IFEQ      'RO'                                                        S0119
     C     AMTP          OREQ      'MC'                                                        CLE00
     C**********           MOVE CCYL      ZCCY                                         S01195 205683
     C     MDST          IFEQ      01
     C     MDST          OREQ      07
     C     MDST          OREQ      08
     C                   MOVE      CCY           ZCCY
     C                   ELSE
     C                   MOVE      LCCY          ZCCY
     C                   ENDIF
     C                   MOVE      LOCC          ZLOC                                          S0119
     C*                                                                   S01195
     C                   ELSE                                                                  S0119
     C                   MOVE      SETP          TYPE                                          S0119
     C                   MOVE      OSAC          OURS                                          S0119
      *                                                                   176823
     C     MDST          IFEQ      01                                                          17682
     C     MDST          OREQ      07                                                          17682
     C     MDST          OREQ      08                                                          17682
     C                   MOVE      CCY           ZCCY                                          S0119
     C                   ELSE                                                                  17682
     C                   MOVE      LCCY          ZCCY                                          17682
     C                   ENDIF                                                                 17682
      *                                                                   CEU004
      ** If feature CEU004 is on, set currency field on LKEY1DP           CEU004
      ** If Settlement currency from the LOAN is not blank.               CEU004
      *                                                                   CEU004
     C     CEU004        IFEQ      'Y'                                          If Feature On  CEU00
      *                                                                   CEU004
     C     SCCYA         IFNE      *BLANKS                                       If SetCcy # BlCEU00
     C                   MOVE      SCCYA         LKSCCY                           Set Outpt CcyCEU00
     C                   MOVE      SCCYA         ZCCY                             Set Ccy Parm CEU00
     C                   ELSE                                                    Else
     C                   MOVE      *BLANKS       LKSCCY                          Clr Outpt Ccy
     C                   ENDIF                                                   End If        CEU00
      *                                                                   CEU004
     C                   ENDIF                                                  End If         CEU00
      *                                                                   CEU004
     C                   EXSR      SETLOC                                                      S0119
     C                   MOVE      W@STBL        ZLOC                                          S0119
     C                   END                                                                   S0119
                                                                                              CLE141
      ** Save the Base Date                                                                   CLE141
                                                                                              CLE141
     C                   Z-ADD     ZDAYNO        WBSDT             5 0                        CLE141
     C*                                                                   S01195
     C*****                EXSR FREQB                             S01195  S01392
     C** For CLE005, use ZFRQB3 to allow next interest date to            CLE005
     C** fall on a holiday                                                CLE005
     C** If payment is due on actual day, never mind if next date is a    CLE005
     C** holiday; if payment is due the previous day, find previos        CLE005
     C** working day; otherwise, it is due next working day.  These are   CLE005
     C*                                                                   CLE005
     C     CLE005        IFEQ      'Y'                                                         CLE00
     C     AMTP          ANDEQ     'IN'                                                        CLE00
     C     CLE005        OREQ      'Y'                                                         CLE00
     C     AMTP          ANDEQ     'PD'                                                        CLE00
     C************IN88     ANDEQ'1'                                CLE005 159924
     C     CLE005        OREQ      'Y'                                                         15422
     C     AMTP          ANDEQ     'RE'                                                        15422
     C***********REPT      ANDEQ1                                  154221 159924
     C***********CLE005    OREQ 'Y'                                154221 159924
     C***********AMTP      ANDEQ'RE'                               154221 159924
     C***********REPT      ANDEQ3                                  154221 159924
     C                   EXSR      ZFRQB3                                                      CLE00
                                                                                              CLE141
      ***If*CLE141*is*ON*and*Settlement*Type*01,*07*or*08,*determine***               CLE141 CLE141A
      ***the*next*interest*date*considering*Business*Day*Convention****               CLE141 CLE141A
      *****************************************************************               CLE141 CLE141A
     C**********         IF        CLE141 = 'Y' and (MDST = 01 or                     CLE141 CLE141A
     C**********                   MDST = 07 or MDST = 08)                            CLE141 CLE141A
      *****************************************************************               CLE141 CLE141A
     C**********         IF        WPDDI = 'A'                                        CLE141 CLE141A
     C**********         Z-ADD     ZDAYNO        ZDYNBR                               CLE141 CLE141A
     C**********         ELSE                                                         CLE141 CLE141A
     C**********         CALL      'LEZBDYCD'                                         CLE141 CLE141A
     C**********         PARM                    ZDAYNO                               CLE141 CLE141A
     C**********         PARM      CCYPI         PCURR            30                  CLE141 CLE141A
     C**********         PARM      LOCPI         PLOCN            30                  CLE141 CLE141A
     C**********         PARM      WPDDI         PPAYC             1                  CLE141 CLE141A
     C**********         PARM      BJDFIN        PDFIN             1                  CLE141 CLE141A
     C**********         PARM      *ZEROS        PAJDT             5 0                CLE141 CLE141A
     C**********         Z-ADD     PAJDT         ZDYNBR                               CLE141 CLE141A
      *****************************************************************               CLE141 CLE141A
      ***Do*not*return*adjusted*date*if*it*is*equal*to*or*earlier*than*               CLE141 CLE141A
      ***previous*date*(only*happens*for*'previous'*date*calculations);               CLE141 CLE141A
      ***instead*use*the*base*date*************************************               CLE141 CLE141A
      *****************************************************************               CLE141 CLE141A
     C*****WBSDT         IFGE      ZDYNBR                                             CLE141 CLE141A
     C**********         Z-ADD     ZDAYNO        ZDYNBR                               CLE141 CLE141A
     C**********         ENDIF                                                        CLE141 CLE141A
     C**********         ENDIF                                                        CLE141 CLE141A
      *****************************************************************               CLE141 CLE141A
     C**********         ELSE                                                         CLE141 CLE141A
      *****************************************************************               CLE141 CLE141A
     C                   Z-ADD     *ZERO         ZNRDYS                                        CLE00
     C     ZLOC          IFEQ      *BLANKS                                                  MD023320
     C                   MOVE      SYSL          ZLOC
     C     ZLOC          IFEQ      *BLANKS
     C                   MOVE      '***'         ZLOC
     C                   ENDIF
     C                   ENDIF                                                              MD023320
     C     ZCCY          IFEQ      *BLANKS                                                  MD023320
     C**********         MOVE      CCY           ZCCY                                      MD023320A
     C                   MOVE      LCCY          ZCCY                                      MD023320A
     C                   ENDIF                                                              MD023320
                                                                                             CLE141A
      ** If CLE141 is ON, determine the next date considering                                CLE141A
      ** Business Day Convention                                                             CLE141A
                                                                                             CLE141A
     C                   IF        CLE141 = 'Y'                                              CLE141A
                                                                                             CLE141A
     C                   IF        WPDDI = 'A'                                               CLE141A
     C                   Z-ADD     ZDAYNO        ZDYNBR                                      CLE141A
     C                   ELSE                                                                CLE141A
     C                   CALL      'LEZBDYCD'                                                CLE141A
     C                   PARM                    ZDAYNO                                      CLE141A
     C                   PARM      CCYPI         PCURR            30                         CLE141A
     C                   PARM      LOCPI         PLOCN            30                         CLE141A
     C                   PARM      WPDDI         PPAYC             1                         CLE141A
     C                   PARM      BJDFIN        PDFIN             1                         CLE141A
     C                   PARM      ZCCY          PCCY              3                         CLE141A
     C                   PARM      ZLOC          PLOC              3                         CLE141A
     C                   PARM      *ZEROS        PAJDT             5 0                       CLE141A
     C                   Z-ADD     PAJDT         ZDYNBR                                      CLE141A
                                                                                             CLE141A
      ** Do not return adjusted date if it is equal to or earlier than                       CLE141A
      ** previous date (only happens for 'previous' date calculations);                      CLE141A
      ** instead use the base date                                                           CLE141A
                                                                                             CLE141A
     C     WBSDT         IFGE      ZDYNBR                                                    CLE141A
     C                   Z-ADD     ZDAYNO        ZDYNBR                                      CLE141A
     C                   ENDIF                                                               CLE141A
     C                   ENDIF                                                               CLE141A
                                                                                             CLE141A
     C                   ELSE                                                                CLE141A
     C                   SELECT                                                                CLE00
     C***********PDDI      WHEQ 'A'                                CLE005 133913
     C     WPDDI         WHENEQ    'A'                                                         13391
     C                   Z-ADD     ZDAYNO        ZDYNBR                                        CLE00
     C***********PDDI      WHEQ 'P'                                CLE005 133913
     C     WPDDI         WHENEQ    'P'                                                         13391
     C                   EXSR      ZBKDT                                                       CLE00
     C***********PDDI      WHEQ 'N'                                CLE005 133913
     C***********PDDI      OREQ *BLANK                             CLE005 133913
     C     WPDDI         WHENEQ    'N'                                                         13391
     C     WPDDI         OREQ      *BLANK                                                      13391
     C                   EXSR      ZFWDT                                                       CLE00
     C     WPDDI         WHENEQ    'M'                                                         14408
     C                   EXSR      ZDATE2                                                      14408
     C     *IN98         IFEQ      *OFF                                                        14408
     C                   MOVE(P)   ZDATE         MMYY              4 0                         14408
     C                   MOVEL(P)  MMYY          MMNLCD            2 0                         14408
     C                   ELSE                                                                  14408
     C                   MOVEL(P)  ZDATE         MMNLCD                                        14408
     C                   ENDIF                                                                 14408
     C                   Z-ADD     ZDAYNO        @DAYNO            5 0                         14408
     C                   EXSR      ZFWDT                                                       14408
     C                   Z-ADD     ZDYNBR        ZDAYNO                                        14408
     C                   EXSR      ZDATE2                                                      14408
     C     *IN98         IFEQ      *OFF                                                        14408
     C                   MOVE(P)   ZDATE         MMYY                                          14408
     C                   MOVEL(P)  MMYY          MMNWKD            2 0                         14408
     C                   ELSE                                                                  14408
     C                   MOVEL(P)  ZDATE         MMNWKD                                        14408
     C                   ENDIF                                                                 14408
     C     MMNLCD        IFNE      MMNWKD                                                      14408
     C                   Z-ADD     @DAYNO        ZDAYNO                                        14408
     C                   EXSR      ZBKDT                                                       14408
     C                   ENDIF                                                                 14408
     C                   ENDSL                                                                 CLE00
      *                                                                   CLE005
     C                   ENDIF                                                                CLE141
                                                                                              CLE141
     C                   ELSE                                                                  CLE00
     C/COPY WNCPYSRC,LE0450C001
                                                                                              CLE141
      ** If CLE141 is ON, determine the next date considering                                 CLE141
      ** Business Day Convention                                                              CLE141
                                                                                              CLE141
     C**********         IF        (CLE141 = 'Y' and                                  CLE141 CLE141A
     C**********                   (AMTP ='IN' or AMTP ='PD' or AMTP ='RE') and       CLE141 CLE141A
     C**********                   (MDST = 01 or MDST = 07 or MDST = 08)) or          CLE141 CLE141A
     C**********                   (CLE141 = 'Y' and                                  CLE141 CLE141A
     C**********                   (AMTP = 'RO' or AMTP = 'MC'))                      CLE141 CLE141A
     C                   IF        CLE141 = 'Y'                                              CLE141A
                                                                                              CLE141
     C                   EXSR      ZFRQB3                                                     CLE141
     C                   IF        AMTP = 'IN' or AMTP = 'PD' or                              CLE141
     C                             AMTP = 'RE'                                                CLE141
     C                   MOVEL     CCYPI         PCURR                                        CLE141
     C                   MOVEL     LOCPI         PLOCN                                        CLE141
     C                   MOVEL     ZCCY          PCCY                                        CLE141A
     C                   MOVEL     ZLOC          PLOC                                        CLE141A
     C                   ELSE                                                                 CLE141
     C                   MOVEL     CCYPR         PCURR                                        CLE141
     C                   MOVEL     LOCPR         PLOCN                                        CLE141
     C                   MOVEL     *BLANKS       PCCY                                        CLE141A
     C                   MOVEL     *BLANKS       PLOC                                        CLE141A
     C                   ENDIF                                                                CLE141
     C                   CALL      'LEZBDYCD'                                                 CLE141
     C                   PARM                    ZDAYNO                                       CLE141
     C                   PARM                    PCURR                                        CLE141
     C                   PARM                    PLOCN                                        CLE141
     C                   PARM      *BLANKS       PPAYC                                        CLE141
     C                   PARM      BJDFIN        PDFIN                                        CLE141
     C                   PARM                    PCCY                                        CLE141A
     C                   PARM                    PLOC                                        CLE141A
     C                   PARM      *ZEROS        PAJDT                                        CLE141
     C                   Z-ADD     PAJDT         ZDYNBR                                       CLE141
     C                   IF        AMTP = 'RO' or AMTP = 'MC'                                 CLE141
     C                   Z-ADD     ZDYNBR        ZDAYNO                                       CLE141
     C                   ENDIF                                                                CLE141
                                                                                              CLE141
     C                   ELSE                                                                 CLE141
     C                   EXSR      ZFREQB                                                      S0119
0707 C                   Z-ADD     *ZERO         ZNRDYS                                        S0119
1867 C                   EXSR      ZFWDT                                                       S0119
     C                   ENDIF                                                                CLE141
                                                                                              CLE141
C    C                   ENDIF                                                                 CLE00
      *                                                                   CLE005
     C/COPY WNCPYSRC,LE0450C002
1868 C   20              GOTO      FREEND
     C*                                                                   E19721
     C     AMTP          IFEQ      'RE'                                                        E1972
     C     ZDYNBR        COMP      MDAT                               89                       E1972
     C                   ELSE                                                                  E1972
     C*                                                                   E19721
1869 C     ZDYNBR        COMP      MDAT                               89  89
     C*                                                                   E19721
     C                   END                                                                   E1972
     C*                                                                   E19721
1870 C**
1871 C     BLNKFQ        TAG                                                    ** BLNKFQ TAG *
1872 C**
1873 C   89              Z-ADD     0             ZDYNBR
1874 C   89              Z-ADD     0             ZDAYNO
1875 C   89              Z-ADD     0             AMOUNT           13 0
1876 C   89              Z-ADD     0             ZMDAY
1877 C   89              MOVE      ' '           ZFREQ
1878 C**
1879 C     FREEND        ENDSR                                                  ** FREEND **
1880 C**
     C/COPY WNCPYSRC,LE0450C015
1881 C**
1882 C********************************************************************
1883 C********************************************************************
1884 C**
1885 C**   SUBROUTINE TO UPDATE NEXT INT DATE AND BITS
1886 C**
1887 C**   CALLED FROM INTPAY,PASTDU
1888 C**   CALLS FREQIN
1889 C**
1890 C     INDTUP        BEGSR                                                  ***  INDTUP ***
1891 C**
1892 C**   UPDATE NEXT INT DATE AND BASE DATE
1893 C**
     C/COPY WNCPYSRC,LE0450C003
1894 C                   Z-ADD     IBDT          ZDAYNO
1895 C                   Z-ADD     IFDY          ZMDAY
1896 C                   MOVE      IPFR          ZFREQ
      *                                                                   180161
      ** If CLE005 is on and interest payment frequency is 'R', means     180161
      ** 'at rollover' - actual interest frequency and interest payment   180161
      ** date will be the same as rollover setup.                         180161
      *                                                                   180161
     C     CLE005        IFEQ      'Y'                                                         18016
     C     IPFR          ANDEQ     'R'                                                         18016
     C                   MOVE      RLFQ          ZFREQ                                         18016
     C                   Z-ADD     RLDY          ZMDAY                                         18016
     C                   ENDIF                                                                 18016
     C/COPY WNCPYSRC,LE0450C016
1897 C                   EXSR      FREQIN
      *                                                                   163483
      ** Recompute next interest date if the same with previous           163483
      ** base date                                                        163483
      *                                                                   163483
     C     ZDYNBR        IFEQ      IBDT                                                        16348
     C                   EXSR      FREQIN                                                      16348
     C                   ENDIF                                                                 16348
      *                                                                   163483
     C/COPY WNCPYSRC,LE0450C017
1898 C                   Z-ADD     ZDAYNO        IBDT
     C*                                                                   S01465
     C**  Changes for rollover of next interest payment date only if      S01465
     C**  switchable feature S01465 is switched ON                        S01465
     C*                                                                   S01465
     C**  Update next interest date on loan                               S01465
     C**  (1) If interest is set by a frequency, or                       S01465
     C**  (2) If next interest payment date on loan has been actioned.    S01465
     C**      This prevents overwriting of next interest payment date     S01465
     C**      after it has been updated by the rollover if interest       S01465
     C**      pay date and rollover date fall on same day                 S01465
     C**                                                                  S01465
     C     *IN25         IFEQ      '1'                                                         S0146
     C*                                                                   S01465
     C     IPFR          IFNE      ' '                                                         S0146
     C     IPFR          OREQ      'R'                                                         18016
     C     RLFQ          ANDNE     ' '                                                         18016
     C     CLE005        ANDEQ     'Y'                                                         18016
     C                   Z-ADD     ZDYNBR        NIDT                                          S0146
     C                   ELSE                                                                  S0146
     C*                                                                   085345
     C**  If IPFR is blank, check NIPD is not zero.  If it is not,        085345
     C**  use this to update NIDT.                                        085345
     C*                                                                   085345
     C     NIPD          IFNE      0                                                           08534
     C                   Z-ADD     NIPD          NIDT                                          08534
     C                   Z-ADD     NIPD          IBDT                                          08534
     C                   END                                                                   08534
     C*                                                                   085345
     C     NIDT          IFLE      EVCD                                                        S0146
     C                   Z-ADD     0             NIDT                                          S0146
     C                   Z-ADD     0             IBDT                                          08534
     C                   END                                                                   S0146
     C                   END                                                                   S0146
     C*                                                                   S01465
     C                   ELSE                                                                  S0146
     C*                                                                   S01465
1899 C                   Z-ADD     ZDYNBR        NIDT
     C*                                                                   S01465
     C                   END                                                                   S0146
     C*                                                                   S01465
      *                                                                   180161
      ** Do not update Int. day number if int. freq is 'R', at rollover;  180161
      ** 'W', weekly; or 'F', fortnightly.                                180161
      *                                                                   180161
     C     IPFR          IFNE      'W'                                                         08357
     C     IPFR          ANDNE     'F'                                                         08357
     C     IPFR          ANDNE     'R'                                                         18016
     C/COPY WNCPYSRC,LE0450C069
1900 C                   Z-ADD     ZMDAY         IFDY
     C                   ENDIF                                                                 08357
     C/COPY WNCPYSRC,LE0450C071
      *                                                                                       216832
     C     IPFR          IFNE      'R'
     C     *IN89         OREQ      '1'
1901 C                   MOVE      ZFREQ         IPFR
     C                   ENDIF
1902 C**
1903 C**   RESET BIT SETTINGS
1904 C** - ONLY IF BITS WERE ON FOR THIS PAYMENT I.E. RUND LE VDAT
1905 C     RUND          COMP      VDAT                                 8787
1906 C   87              BITOFF    '2'           TLXI
1907 C   87              BITOFF    '01'          CBLI
1908 C**
1909 C                   ENDSR
1910 C**
1911 C**
1912 C********************************************************************
1913 C********************************************************************
1914 C**
1915 C**   SUBROUTINE TO UPDATE NEXT REPAY DATE AND BASE DATE - RPDTUP
1916 C**
1917 C**   CALLED FROM REPSCD,PASTDU
1918 C**   CALLS FREQIN
1919 C**
1920 C     RPDTUP        BEGSR                                                  ***  RPDTUP ***
1921 C**
1922 C**   UPDATE NEXT REPAY DATE AND BASE DATE
1923 C**
     C/COPY WNCPYSRC,LE0450C004
1924 C                   Z-ADD     RBDT          ZDAYNO
1925 C                   Z-ADD     RDYN          ZMDAY
1926 C                   MOVE      RFRQ          ZFREQ
1927 C                   Z-ADD     RAMT          AMOUNT
1928 C                   EXSR      FREQIN
      **********                                                                       209805 259708
      ***If*next*repayment*date*falls*on*the*same*day*as*maturity,*or                  209805 259708
      ***outstanding*principal*is*zero,*blanked*out*repayment*details                  209805 259708
     C**********                                                                       209805 259708
     C*****ZDYNBR        IFEQ      MDAT                                                       259708
     C*****CPAM*         OREQ      *ZERO                                                      259708
     C**********         Z-ADD     *ZEROS        RBDT                                         259708
     C**********         Z-ADD     *ZEROS        NRPD                                         259708
      *                                                                                     MD045091
      ** If next repayment date falls on the same as maturity and                           MD045091
      ** setting of system value 'RepayDateOnMaturity' is 'O', blank                        MD045091
      ** out the repayment details.                                                         MD045091
      *                                                                                     MD045091
     C     REDATM        IFEQ      'O'                                                      MD045091
     C     ZDYNBR        ANDEQ     MDAT                                                     MD045091
     C                   Z-ADD     *ZEROS        RBDT                                       MD045091
     C                   Z-ADD     *ZEROS        NRPD                                       MD045091
     C     CLE028        IFEQ      'N'
     C     PTYP          ORNE      80
     C**********         Z-ADD     *ZEROS        RDYN                                         259708
     C**********         MOVE      ' '           RFRQ                                         259708
     C                   Z-ADD     *ZEROS        RDYN                                       MD045091
     C                   MOVE      ' '           RFRQ                                       MD045091
     C                   ENDIF
     C**********         Z-ADD     *ZEROS        RAMT                                         259708
     C**********         ELSE                                                                 259708
     C                   Z-ADD     *ZEROS        RAMT                                       MD045091
     C                   ELSE                                                               MD045091
      *                                                                   189035
      ** Prevent Update of Next Repayment date if payment from a          189035
      ** multi-ccy rollover.                                              189035
      *                                                                   189035
     C     NNRPD         IFNE      'Y'                                                         18903
1929 C                   Z-ADD     ZDAYNO        RBDT
1930 C                   Z-ADD     ZDYNBR        NRPD
     C                   END                                                                   18903
      *                                                                   189035
     C     CLE028        IFEQ      'N'
     C     PTYP          ORNE      80
1931 C                   Z-ADD     ZMDAY         RDYN
1932 C                   MOVE      ZFREQ         RFRQ
     C                   ENDIF
1933 C                   Z-ADD     AMOUNT        RAMT
     C**********         ENDIF                                                                259708
      **********                                                                       209805 259708
     C                   ENDIF                                                              MD045091
      *                                                                                     MD045091
     C/COPY WNCPYSRC,LE0450C019
1934 C**
1935 C**   RESET BIT SETTINGS
1936 C**
1937 C     RUND          COMP      VDAT                                 8787
1938 C   87              BITOFF    '3'           TLXI
1939 C   87              BITOFF    '23'          CBLI
1940 C**
1941 C                   ENDSR
1942 C**
1943 C**
1944 C********************************************************************
1945 C********************************************************************
1946 C**
1947 C**   SUBROUTINE TO PROCESS RATE CHANGES - RATECH
1948 C**
1949 C**   CALLED FROM SPCHNG,BRCHNG,BCCHNG,ROLLOV
1950 C**   CALLS NO OTHER SUBROUTINE
1951 C**
1952 C     RATECH        BEGSR                                                  ***  RATECH ***
1953 C**
1954 C**   CALCULATE NEW EFFECTIVE INTEREST RATE
      *                                                                                       247953
     C     SPINL         IFEQ      ' '
     C     RTSPL         ANDNE     0
     C                   MOVE      'A'           SPINL
     C                   ENDIF
      *                                                                                       247953
1955 C**
1956 C     SPINL         COMP      'P'                                898788
1957 C**
     C                   Z-ADD     INTRL         OINTR            11 7                         E1092
1957 C** SAVE THE LOAN NUMBER                                             047546
1957 C**********         Z-ADD     LNRF          LNRF2             6 0                 047546 CLE148
1957 C                   MOVEL     LNRF          LNRF2             6                          CLE148
1958 C   87BRTEL         ADD       RTSPL         INTRL
1959 C   88RTSPL         DIV       100           WRK119           11 9
1960 C   88WRK119        MULT(H)   BRTEL         INTRL
1961 C   89BRTEL         SUB       RTSPL         INTRL
1962 C**
1963 C     VDAT          COMP      DLRC                               89
1964 C   89              Z-ADD     VDAT          DLRC
      *                                                                                     MD031736
      ** Compare value date of rate change recorded on HISTSHQ with DLRC                    MD031736
      *                                                                                     MD031736
     C     *IN89         Ifeq      '0'                                                      MD031736
     C     LNRF          Setgt     LEHISTLK                                                 MD031736
     C     LNRF          ReadPe    LEHISTLK                               69                MD031736
      *                                                                                     MD031736
     C     *IN69         Doweq     *OFF                                                     MD031736
     C     BGN0ST        IFeq      'N'                                                      MD031736
     C                   z-add     VDAT#H        DLRC                                       MD031736
     C                   LEAVE                                                              MD031736
     C                   Else                                                               MD031736
      *                                                                                     MD031736
     C     IRCF#H        IFeq      'Y'                                                      MD031736
     C     AMTP#H        Andeq     'SC'                                                     MD031736
     C     IRCF#H        OReq      'Y'                                                      MD031736
     C     AMTP#H        Andeq     'RO'                                                     MD031736
     C     IRCF#H        OReq      'Y'                                                      MD031736
     C     AMTP#H        Andeq     'MC'                                                     MD031736
     C     AMTP#H        OReq      'BR'                                                     MD031736
     C     AMTP#H        OReq      'BC'                                                     MD031736
     C                   z-add     VDAT#H        DLRC                                       MD031736
     C                   LEAVE                                                              MD031736
     C                   Endif                                                              MD031736
     C                   Endif                                                              MD031736
      *                                                                                     MD031736
     C     LNRF          ReadPe    LEHISTLK                               69                MD031736
     C                   EndDo                                                              MD031736
      *                                                                                     MD031736
     C                   Endif                                                              MD031736
1965 C**
1966 C                   ENDSR
1967 C**
1968 C**
1969 C********************************************************************
     C/EJECT                                                              CAC001
     C*****************************************************************   CAC001
     C*                                                               *   CAC001
     C*  Subroutine  :  SRFUND                                        *   CAC001
     C*  Function    :  Calculate Effective Funding Rate              *   CAC001
     C*                                                               *   CAC001
     C*  Called by   :  SPCHNG - Process Spread Change Actions        *   CAC001
     C*                 BRCHNG - Process Base Rate Change Actions     *   CAC001
     C*                 BCCHNG - Process Base Rate Code Change Actions*   CAC001
     C*                 ROLLOV - Process Rollover Actions             *   CAC001
     C*  Calls       :                                                *   CAC001
     C*                                                               *   CAC001
     C*****************************************************************   CAC001
      *                                                                   CAC001
     C     SRFUND        BEGSR                                                  ** SRFUND **   CAC00
      *                                                                   CAC001
     C                   SELECT                                                                CAC00
     C     FSGNL         WHENEQ    ' '                                                         CAC00
     C                   Z-ADD     FSRPL         WFSRP            11 7                         CAC00
     C     FSGNL         WHENEQ    '+'                                                         CAC00
     C     INTRL         ADD       FSRPL         WFSRP                                         CAC00
     C     FSGNL         WHENEQ    '-'                                                         CAC00
     C     INTRL         SUB       FSRPL         WFSRP                                         CAC00
     C                   ENDSL                                                                 CAC00
      *                                                                   CAC001
     C     SRFUN9        ENDSR                                                  ** SRFUN9 **   CAC00
      *                                                                   CAC001
     C*****************************************************************   CAC001
     C/EJECT                                                              CAC001
1970 C********************************************************************
1971 C**
1972 C**   SUBROUTINE TO PROCESS LOAN 'B' RECORDS - LOANS
1973 C**
1974 C**   CALLED FROM MAIN PROCESSING
1975 C*****CALLS*AKYOUT(21),GLINTC,WTAX,GLZADD*************************   S01486
     C*****CALLS AKYOUT(21),GLINTC,WTAX,GLZADD,UPDTVF                                  S01486 CLE031
     C**   CALLS AKYOUT(21),GLINTC,WTAX,GLZADD,UPDTVF                                         CLE031
     C**         SECCY2,SETRST                                                                CLE031
1976 C**
1977 C     LOANB         BEGSR                                                  ***  LOANB  ***
      *                                                                                       CLE134
     C                   MOVE      'N'           WPDCLL                                       CLE134
     C                   MOVE      'N'           WPDCLA                                       CLE134
     C                   MOVE      'N'           WPDCLR                                       CLE134
     C                   MOVE      'N'           WORIGL                                       CLE134
     C                   MOVE      'N'           WORIGA                                       CLE134
     C                   MOVE      'N'           WMRAUT                                       263416
     C                   MOVE      'N'           WDECRF            1                          CLE134
     C                   MOVE      'N'           WTAKEF            1                          CLE134
     C                   MOVE      OSAC          WOSAC                                        CLE134
     C                   MOVE      SETP          WSETP                                        CLE134
     C                   MOVE      OSBR          WOSBR                                        CLE134
     C*                                                                   060536
     C** Save value of current principal before updating.                 060536
     C*                                                                   060536
     C                   Z-ADD     CPAM          OCPAM                                         06053
      *                                                                                       CLE031
     C                   MOVE      'Y'           WTRANS            1
      *                                                                   166149
     C                   MOVE      '0'           *IN17                                         16614
     C     ECIN          IFEQ      'Y'                                                         16614
     C     AMTP          ANDEQ     'MC'
     C                   MOVE      '1'           *IN17                                         16614
     C                   END                                                                   16614
      *                                                                                       CLE023
      ** If CLE023 is installed and rollover actioned today and                               CLE023
      ** new facility exchange rate details exist on loans file,                              CLE023
      ** switched on *IN22 to output new exchange rate and indicator                          CLE023
      ** to facility exchange rate and indicator.                                             CLE023
      *                                                                                       CLE023
     C     CLE023        IFEQ      'Y'
     C     WROTDY        ANDEQ     'Y'
     C     NFCE          ANDNE     *ZEROS
     C     NFMD          ANDNE     *BLANK
     C     NCCY          ANDEQ     *BLANKS
     C                   MOVE      '1'           *IN22
     C                   ENDIF
      *                                                                                     MD028338
     C     WROTDY        IFEQ      'Y'                                                      MD028338
     C     FRCO          ANDEQ     'Y'                                                      MD028338
     C                   MOVE      *ON           *IN28                                      MD028338
     C                   ENDIF                                                              MD028338
      *                                                                   166149
     C     CLE034        IFEQ      'Y'
     C     WROTDY        ANDEQ     *ON
     C                   MOVE      '1'           *IN23
     C                   ENDIF
1978 C**
1979 C**   ACCUMULATE NO OF RECORDS READ
1980 C**
1981 C     NORL          ADD       1             NORL
     C**                                                                  E86115
     C**  FOR BACKVALUED LOANS INTO PREVIOUS YEARS, SET Y LN FOR INTEREST E86115
     C**  TO END OF PREVIOUS YEAR.                                        E86115
     C**                                                                  E86115
2235 C     *IN41         IFEQ      '0'                                                         E8611
2235 C     *IN82         IFEQ      '1'                                                         E8611
2235 C                   Z-ADD     IAEND         YILN                                          E8611
2235 C                   END                                                                   E8611
2235 C                   END                                                                   E8611
1982 C**
1983 C**   IF REVERSED TODAY GENERATE REVERSAL A/C KEYS
1984 C**
1985 C  N46              GOTO      ACCRL
1986 C**
      *                                                                                       CLE134
      ** If AUTO = 'C', check whether the processed loan is a PDCL or                         CLE134
      ** an original loan by checking the 1st character of the loan                           CLE134
      ** type. If it is X, Y, Z then the loan is a Past Due Call Loan.                        CLE134
      *                                                                                       CLE134
     C     CLE134        IFEQ      'Y'                                                        CLE134
     C     AUTO          ANDEQ     'C'                                                        CLE134
     C     CLE134        OREQ      'Y'                                                        CLE134
     C     AUTOX         ANDEQ     'C'                                                        CLE134
     C                   MOVEL     LTYP          LTYP1A            1                          CLE134
     C                   EVAL      WCLE134 = 'Y'                                            MD049078
     C     LTYP1A        IFEQ      'X'                                                        CLE134
     C     LTYP1A        OREQ      'Y'                                                        CLE134
     C     LTYP1A        OREQ      'Z'                                                        CLE134
     C                   MOVE      'Y'           WPDCLL                                       CLE134
     C                   ELSE                                                                 CLE134
     C                   MOVE      'Y'           WORIGL                                       CLE134
     C                   ENDIF                                                                CLE134
      *                                                                                       CLE134
      ** If Original Loan:                                                                    CLE134
      ** -  Decrease = 'Y' or                                                                 CLE134
      ** -  Decrease = 'N' and PDCL generated by COB                                          CLE134
      **    OL Repayment a/c key used: xxRyy---DI (PD Interest)                               CLE134
      **                               xxRyy---DP (PD Principal)                              CLE134
      ** -  Decrease = 'N' and PDCL generated by I/C function                                 CLE134
      **    Standard Repayment a/c key is generated                                           CLE134
      *                                                                                       CLE134
     C                   Z-ADD     0             WTOTDP           15 0                        CLE134
     C                   Z-ADD     0             WTOTDI           15 0                        CLE134
     C     WORIGL        IFEQ      'Y'                                                        CLE134
     C                   MOVE      *OFF          *IN27                                        CLE134
     C     KPDCL5        SETLL     LEPDUEL5                                                   CLE134
      *                                                                                       CLE134
     C     *IN27         DOWEQ     *OFF                                                       CLE134
      *                                                                                       CLE134
     C     KPDCL5        READE     LEPDUEL5                               27                  CLE134
     C     *IN27         IFEQ      *OFF                                                       CLE134
     C     YPCBIC        IFEQ      'C'                                                        CLE134
     C     YPCBIC        OREQ      'I'                                                        CLE134
     C     YDECRE        ANDEQ     'Y'                                                        CLE134
     C                   MOVE      'Y'           WDECRF                                       CLE134
     C                   ADD       YPDINT        WTOTDI                                       CLE134
     C                   ADD       YPCPAM        WTOTDP                                       CLE134
     C                   ENDIF                                                                CLE134
     C                   ENDIF                                                                CLE134
      *                                                                                       CLE134
     C                   ENDDO                                                                CLE134
      *                                                                                       CLE134
     C                   ENDIF                                                                CLE134
      *                                                                                       CLE134
      ** If PDCL, calculate the total past due principal/interest with                        CLE134
      ** DECREASE = 'Y' and the total with DECREASE = 'N'                                     CLE134
      ** and take on account.                                                                 CLE134
      *                                                                                       CLE134
     C                   Z-ADD     0             WDECRP           15 0                        CLE134
     C                   Z-ADD     0             WDECRI           15 0                        CLE134
     C                   Z-ADD     0             WTAKEP           15 0                        CLE134
     C                   Z-ADD     0             WTAKEI           15 0                        CLE134
     C                   CLEAR                   WTKPAC                                       CLE134
     C                   CLEAR                   WTKPAB                                       CLE134
     C                   CLEAR                   WTKPAA                                       CLE134
     C                   CLEAR                   WTKPAS                                       CLE134
     C                   CLEAR                   WTKPCY                                       CLE134
     C                   CLEAR                   WTKIAC                                       CLE134
     C                   CLEAR                   WTKIAB                                       CLE134
     C                   CLEAR                   WTKIAA                                       CLE134
     C                   CLEAR                   WTKIAS                                       CLE134
     C                   CLEAR                   WTKICY                                       CLE134
      *                                                                                       CLE134
     C     WPDCLL        IFEQ      'Y'                                                        CLE134
     C                   MOVE      *OFF          *IN27                                        CLE134
     C                   MOVE      *OFF          *IN24                                        CLE134
      *                                                                                       CLE134
      ** PDCL generated by a loan                                                             CLE134
      *                                                                                       CLE134
     C     LTYP1A        IFEQ      'X'                                                        CLE134
     C     LTYP1A        OREQ      'Y'                                                        CLE134
     C     KPDCL5        SETLL     LEPDUEL4                                                   CLE134
      *                                                                                       CLE134
     C     *IN27         DOWEQ     *OFF                                                       CLE134
      *                                                                                       CLE134
     C     KPDCL5        READE     LEPDUEL4                               27                  CLE134
     C     *IN27         IFEQ      *OFF                                                       CLE134
      *                                                                                       CLE134
      ** Decrease = 'Y':                                                                      CLE134
      ** - PDCL Value Date a/c key xxVyy---XA                                                 CLE134
      *                                                                                       CLE134
      ** Decrease = 'N' and PDCL generated by COB:                                            CLE134
      ** - PDCL Value Date a/c key xxVyy---XA                                                 CLE134
      *                                                                                       CLE134
      ** Decrease = 'N' and PDCL generated by I/C function                                    CLE134
      ** - PDCL Value Date a/c key xxVyy----A and OSAC = Take on account                      CLE134
      *                                                                                       CLE134
     C     YPCBIC        IFEQ      'C'                                                        CLE134
     C     YPCBIC        OREQ      'I'                                                        CLE134
     C     YDECRE        ANDEQ     'Y'                                                        CLE134
     C                   MOVE      'Y'           WDECRF                                       CLE134
     C                   ADD       YPDINT        WDECRI                                       CLE134
     C                   ADD       YPCPAM        WDECRP                                       CLE134
     C                   ENDIF                                                                CLE134
      *                                                                                       CLE134
      ** Decrease = 'N'. Use A account key and take on account                                CLE134
      *                                                                                       CLE134
     C     YPCBIC        IFEQ      'I'                                                        CLE134
     C     YDECRE        ANDEQ     'N'                                                        CLE134
     C     YTKIAC        IFNE      *BLANKS                                                    CLE134
     C                   MOVE      'Y'           WTAKEF                                       CLE134
     C                   ADD       YPDINT        WTAKEI                                       CLE134
     C                   MOVE      YTKPCY        WTKPCY                                       CLE134
     C                   MOVE      YTKIAC        WTKIAC                                       CLE134
     C                   MOVE      YTKIAB        WTKIAB                                       CLE134
     C                   MOVE      YTKIAA        WTKIAA                                       CLE134
     C                   MOVE      YTKIAS        WTKIAS                                       CLE134
     C                   MOVE      YTKICY        WTKICY                                       CLE134
     C                   ENDIF                                                                CLE134
     C     YTKPAC        IFNE      *BLANKS                                                    CLE134
     C                   MOVE      'Y'           WTAKEF                                       CLE134
     C                   ADD       YPCPAM        WTAKEP                                       CLE134
     C                   MOVE      YTKPAC        WTKPAC                                       CLE134
     C                   MOVE      YTKPAB        WTKPAB                                       CLE134
     C                   MOVE      YTKPAA        WTKPAA                                       CLE134
     C                   MOVE      YTKPAS        WTKPAS                                       CLE134
     C                   MOVE      YTKPCY        WTKPCY                                       CLE134
     C                   ENDIF                                                                CLE134
     C                   ENDIF                                                                CLE134
     C                   ENDIF                                                                CLE134
      *                                                                                       CLE134
     C                   ENDDO                                                                CLE134
     C                   ENDIF                                                                CLE134
      *                                                                                       CLE134
      ** Fee PDCL                                                                             CLE134
      *                                                                                       CLE134
     C     LTYP1A        IFEQ      'Z'                                                        CLE134
     C     KPDCL5        SETLL     LEPDUFL6                                                   CLE134
      *                                                                                       CLE134
     C     *IN27         DOWEQ     *OFF                                                       CLE134
     C     KPDCL5        READE     LEPDUFL6                               27                  CLE134
      *                                                                                       CLE134
     C     *IN27         IFEQ      *OFF                                                       CLE134
      *                                                                                       CLE134
      ** Decrease = 'N' and PDCL generated by COB:                                            CLE134
      ** - PDCL Value Date a/c key xxVyy---XA                                                 CLE134
      *                                                                                       CLE134
      ** Decrease = 'N' and PDCL generated by I/C function                                    CLE134
      ** - PDCL Value Date a/c key xxVyy----A and OSAC = Take on account                      CLE134
      *                                                                                       CLE134
     C     YPCBIC        IFEQ      'C'                                                        CLE134
     C                   MOVE      'Y'           WDECRF                                       CLE134
     C                   ADD       YPDINT        WDECRI                                       CLE134
     C                   ADD       YPCPAM        WDECRP                                       CLE134
     C                   ENDIF                                                                CLE134
      *                                                                                       CLE134
      ** Decrease = 'N'. Use A account key and take on account                                CLE134
      *                                                                                       CLE134
     C     YPCBIC        IFEQ      'I'
     C     YTKPAC        IFNE      *BLANKS                                                    CLE134
     C                   MOVE      'Y'           WTAKEF                                       CLE134
     C                   ADD       YPCPAM        WTAKEP                                       CLE134
     C                   MOVE      YTKPAC        WTKPAC                                       CLE134
     C                   MOVE      YTKPAB        WTKPAB                                       CLE134
     C                   MOVE      YTKPAA        WTKPAA                                       CLE134
     C                   MOVE      YTKPAS        WTKPAS                                       CLE134
     C                   MOVE      YTKPCY        WTKPCY                                       CLE134
     C                   ENDIF                                                                CLE134
     C                   ENDIF                                                                CLE134
     C                   ENDIF                                                                CLE134
      *                                                                                       CLE134
     C                   ENDDO                                                                CLE134
      *                                                                                       CLE134
     C                   ENDIF                                                                CLE134
      *                                                                                       CLE134
     C                   ENDIF                                                                CLE134
      *                                                                                       CLE134
     C                   ENDIF                                                                CLE134
      *                                                                                       CLE134
1987 C                   TESTB     '0'           ACEI                     89
1988 C  N89              GOTO      LONBEN
      *                                                                                       CAS001
      ** If switchable feature CAS001 is present, reverse any outstanding                     CAS001
      ** unrealized profit/loss                                                               CAS001
      *                                                                                       CAS001
     C     CAS001        IFEQ      'Y'
     C                   MOVEA     LTYP          AKY(1)
     C                   MOVE      'A'           AKY(3)
     C                   MOVEA     SUTP          AKY(4)
     C                   MOVEA     CLAS          AKY(11)
     C                   MOVEA     '  '          AKY(6)
      *                                                                                       CAS001
     C     WBOOK         IFEQ      'Y'
     C                   MOVEA     BOKC          AKY(6)
     C                   ENDIF
      *                                                                                       CAS001
     C                   MOVE      ' '           AKY(8)
     C                   Z-ADD     FSPLDT        ACAMNT
      *                                                                                       CAS001
     C     ACAMNT        IFGE      0
     C                   MOVEA     'UP'          AKY(9)
     C***********          Z-SUBACAMNT    ACAMNT                                       CAS004 221413
     C                   ELSE
     C                   Z-SUB     ACAMNT        ACAMNT
     C                   MOVEA     'UL'          AKY(9)
     C                   ENDIF
      *                                                                                       CAS001
     C**********           Z-SUBACAMNT    ACAMNT                                       CAS001 CAS004
     C     ACAMNT        IFNE      0
     C                   EXSR      AKYOUT
     C                   ENDIF
     C                   ENDIF
      *                                                                                       CAS004
      ** If hedge accounting is installed                                                     CAS004
      *                                                                                       CAS004
     C     CAS004        IFEQ      'Y'
     C                   MOVEA     LTYP          AKY(1)
     C                   MOVE      'A'           AKY(3)
     C                   MOVEA     SUTP          AKY(4)
     C                   MOVEA     CLAS          AKY(11)
     C                   MOVEA     '  '          AKY(6)
      *                                                                                       CAS004
     C     WBOOK         IFEQ      'Y'
     C                   MOVEA     BOKC          AKY(6)
     C                   ENDIF
      *                                                                                       CAS004
     C     FSEFUP        IFGT      0
     C                   MOVEA     'FIP'         AKY(8)
     C                   Z-ADD     FSEFUP        ACAMNT
     C                   EXSR      AKYOUT
     C                   ENDIF
      *                                                                                       CAS004
     C     FSEFUP        IFLT      0
     C                   MOVEA     'FIL'         AKY(8)
     C                   Z-SUB     FSEFUP        ACAMNT
     C                   EXSR      AKYOUT
     C                   ENDIF
      *                                                                                       CAS004
     C                   Z-ADD     0             FSEFUP
      *                                                                                       CAS004
     C     FSECUP        IFGT      0
     C                   MOVEA     'CIP'         AKY(8)
     C                   Z-ADD     FSECUP        ACAMNT
     C                   EXSR      AKYOUT
     C                   ENDIF
      *                                                                                       CAS004
     C     FSECUP        IFLT      0
     C                   MOVEA     'CIL'         AKY(8)
     C                   Z-SUB     FSECUP        ACAMNT
     C                   EXSR      AKYOUT
     C                   ENDIF
      *                                                                                       CAS004
     C                   Z-ADD     0             FSECUP
      *                                                                                       CAS004
     C                   ENDIF
      *                                                                                       CAS004
     C/COPY WNCPYSRC,LE0450C060
1989 C**
1990 C**   REVERSE OUT DEAL DATE ENTRIES
1991 C**
     C                   Z-ADD     DDAT          ACDATE
1993 C                   Z-ADD     OPAM          ACAMNT                   89
1994 C                   MOVE      'D'           AKY(3)
1995 C                   MOVEA     BKAKY         AKY(6)
1996 C                   MOVE      'A'           AKY(10)
1997 C  N89              EXSR      AKYOUT
     C*                                                                   S01465
     C**  Account key generated with 'R' in AKY (in position 8) if        S01465
     C**  the receiver of guarantee is different to blanks                S01465
     C*                                                                   S01465
     C     *IN26         IFEQ      '1'                                                         S0146
     C     WORECE        IFNE      *BLANKS                                                     S0146
     C**********           Z-ADDCNUML     WORK2                                        S01465 CSD027
     C                   MOVE      CNUML         WORK2
     C                   MOVE      WORECE        CNUML                                         S0146
     C                   MOVE      'R'           AKY(8)                                        S0146
     C  N89              EXSR      AKYOUT                                                      S0146
     C**********           Z-ADDWORK2     CNUML                                        S01465 CSD027
     C                   MOVE      WORK2         CNUML
     C                   MOVE      ' '           AKY(8)                                        S0146
     C                   END                                                                   S0146
     C                   END                                                                   S0146
     C/COPY WNCPYSRC,LE0450C051
1998 C**
1999 C**   IF DISC LOAN REVERSE OTHER KEYS
2000 C**
2001 C  N45              GOTO      REVSRT
2002 C**
2003 C                   Z-ADD     TOTI          ACAMNT                 8889
2004 C   88              MOVE      'P'           AKY(10)
2005 C   88              Z-SUB     ACAMNT        ACAMNT
2006 C  N88              MOVE      'D'           AKY(10)
2007 C  N89              EXSR      AKYOUT
2008 C**
2009 C     OPAM          SUB       TOTI          ACAMNT                   89
2010 C                   MOVE      'B'           AKY(10)
2011 C  N89              EXSR      AKYOUT
2012 C**
2013 C**   REVERSE OUT START DATE ENTRIES IF REQUIRED
2014 C**
2015 C     REVSRT        TAG                                                    ** REVSRT TAG *
2016 C                   TESTB     '1'           ACEI                     89
2017 C  N89              GOTO      LONBEN
2018 C**
     C                   Z-ADD     VDATL         ACDATE
2019 C                   Z-ADD     OPAM          ACAMNT                   89
2020 C                   MOVE      'V'           AKY(3)
2021 C                   MOVE      'A'           AKY(10)
      *                                                                                       CLE034
      ** If CLE034 is installed                                                               CLE034
      *                                                                                       CLE034
     C     CLE034        IFEQ      'Y'
     C     STALL         ANDEQ     'Y'
     C                   MOVE      'S'           WTYPE
     C                   EXSR      SR34A
     C                   ELSE
     C                   MOVE      'Y'           WRKFLD
     C                   MOVE      '*EOF   '     PRTCD
     C                   ENDIF
      *                                                                                       CLE034
     C     WRKFLD        DOWEQ     'Y'
     C     PRTCD         OREQ      *BLANKS
     C     CLE034        IFEQ      'Y'
     C     STALL         ANDEQ     'Y'
     C                   EXSR      SR34B
     C                   ENDIF
      *                                                                                       CLE031
      ** If CLE031 is on and indicator 89 is off, set work type                               CLE031
      ** to start and call SR/SETCCY                                                          CLE031
      *                                                                                       CLE031
     C     CLE031        IFEQ      'Y'
     C     *IN89         ANDEQ     *OFF
     C                   MOVE      'S'           WTYPE             1
     C                   EXSR      SETCCY
     C                   ENDIF
      *                                                                                       CLE031
      ** IF PDCL and takeon account has been used,then create standard                        CLE134
      ** xxVyy----A a/ck for the difference between OPAM and total PD                         CLE134
      ** (Principal + Interest) posted to take on account and to                              CLE134
      ** xxVyy---XA a/c key                                                                   CLE134
      *                                                                                       CLE134
     C     WPDCLL        IFEQ      'Y'                                                        CLE134
      *                                                                                       CLE134
      ** Decrease ind = 'N' and take on account <> blanks                                     CLE134
      *                                                                                       CLE134
     C     WTAKEF        IFEQ      'Y'                                                        CLE134
     C     WTAKEP        IFGT      0                                                          CLE134
     C     WTAKEI        ORGT      0                                                          CLE134
     C     ACAMNT        SUB       WTAKEP        ACAMNT                                       CLE134
     C     ACAMNT        SUB       WTAKEI        ACAMNT                                       CLE134
     C                   ENDIF                                                                CLE134
     C                   ENDIF                                                                CLE134
      *                                                                                       CLE134
      ** Decrease ind = 'Y'                                                                   CLE134
      *                                                                                       CLE134
     C     WDECRF        IFEQ      'Y'                                                        CLE134
     C     ACAMNT        SUB       WDECRP        ACAMNT                                       CLE134
     C     ACAMNT        SUB       WDECRI        ACAMNT                                       CLE134
     C     ACAMNT        COMP      0                                      89                  CLE134
     C                   ENDIF                                                                CLE134
      *                                                                                       CLE134
     C                   ENDIF                                                                CLE134
      *                                                                                       CLE134
2022 C  N89              EXSR      AKYOUT
      *                                                                                       CLE134
      ** If PDCL and principal take on account is not zero, then                              CLE134
      ** create reversal a/c key xxVyy----A with OSAC =                                       CLE134
      ** Principal/Interest take on account                                                   CLE134
      *                                                                                       CLE134
     C     WPDCLL        IFEQ      'Y'                                                        CLE134
      *                                                                                       CLE134
     C     WTAKEF        IFEQ      'Y'                                                        CLE134
      *                                                                                       CLE134
      ** Take on Principal                                                                    CLE134
      *                                                                                       CLE134
     C     WTAKEP        IFGT      0                                                          CLE134
     C                   MOVE      WTKPAC        YKCNUM                                       CLE134
     C                   MOVE      WTKPAB        YKBRCA                                       CLE134
     C                   MOVE      WTKPAA        YKACOD                                       CLE134
     C                   MOVE      WTKPAS        YKACSQ                                       CLE134
     C                   MOVE      WTKPCY        YKCCY                                        CLE134
     C                   EXSR      STAKEA                                                     CLE134
     C                   Z-ADD     WTAKEP        ACAMNT                   89                  CLE134
     C                   MOVEA     ' A'          AKY(9)                                       CLE134
     C  N89              EXSR      AKYOUT                                                     CLE134
     C                   MOVE      WOSAC         OSAC                                         CLE134
     C                   MOVE      WSETP         SETP                                         CLE134
     C                   MOVE      WOSBR         OSBR                                         CLE134
     C                   ENDIF                                                                CLE134
      *                                                                                       CLE134
      ** Take on Interest                                                                     CLE134
      *                                                                                       CLE134
     C     WTAKEI        IFGT      0                                                          CLE134
     C                   MOVE      WTKIAC        YKCNUM                                       CLE134
     C                   MOVE      WTKIAB        YKBRCA                                       CLE134
     C                   MOVE      WTKIAA        YKACOD                                       CLE134
     C                   MOVE      WTKIAS        YKACSQ                                       CLE134
     C                   MOVE      WTKICY        YKCCY                                        CLE134
     C                   EXSR      STAKEA                                                     CLE134
     C                   Z-ADD     WTAKEI        ACAMNT                   89                  CLE134
     C                   MOVEA     ' A'          AKY(9)                                       CLE134
     C  N89              EXSR      AKYOUT                                                     CLE134
     C                   MOVE      WOSAC         OSAC                                         CLE134
     C                   MOVE      WSETP         SETP                                         CLE134
     C                   MOVE      WOSBR         OSBR                                         CLE134
     C                   ENDIF                                                                CLE134
     C                   ENDIF                                                                CLE134
      *                                                                                       CLE134
      ** PDCL generated with Decrease = 'Y' or by COB.                                        CLE134
      **  Reverse out a/c key xxVyy---XA                                                      CLE134
      *                                                                                       CLE134
     C     WDECRF        IFEQ      'Y'                                                        CLE134
     C                   Z-ADD     0             ACAMNT                                       CLE134
     C     WDECRP        ADD       WDECRI        ACAMNT                                       CLE134
     C     ACAMNT        COMP      0                                      89                  CLE134
     C                   MOVEA     'XA'          AKY(9)                                       CLE134
     C  N89              EXSR      AKYOUT                                                     CLE134
     C                   Z-ADD     OPAM          ACAMNT                   89                  CLE134
     C                   MOVEA     ' A'          AKY(9)                                       CLE134
     C                   ENDIF                                                                CLE134
      *                                                                                       CLE134
     C                   ENDIF
      *                                                                                       CLE031
      ** If CLE031 is on and indicator 89 is off call SR/SETTLE                               CLE031
      *                                                                                       CLE031
     C     CLE031        IFEQ      'Y'
     C     *IN89         ANDEQ     *OFF
     C     WCLE134       ANDEQ     ' '                                                      MD049078
     C                   EXSR      SETTLE
     C                   ENDIF
      *                                                                                       CLE034
     C     CLE034        IFEQ      'Y'
     C     STALL         ANDEQ     'Y'
     C                   EXSR      SR34C
     C                   ELSE
     C                   MOVE      *BLANKS       WRKFLD
     C                   ENDIF
     C                   ENDDO
      *                                                                                       CLE034
     C     CLE034        IFEQ      'Y'
     C     STALL         ANDEQ     'Y'
     C                   EXSR      SR34E
     C                   ENDIF
      *                                                                                       CLE031
     C/COPY WNCPYSRC,LE0450C052
      *                                                                   CAC001
     C     BGN0ST        IFEQ      'Y'                                                         CAC00
     C     FPRCL         ANDNE     *BLANKS                                                     CAC00
      *                                                                   CAC001
      **  Principal - Transaction Profit Centre                           CAC001
      *                                                                   CAC001
     C                   MOVEA     'T   '        AKY(6)                                        CAC00
     C     *IN89         IFEQ      '0'                                                         CAC00
     C                   EXSR      AKYOUT                                                      CAC00
     C                   ENDIF                                                                 CAC00
      *                                                                   CAC001
      **  Principal - Funding Profit Centre                               CAC001
      *                                                                   CAC001
     C                   MOVEA     'F   '        AKY(6)                                        CAC00
     C                   MOVEL     PRFC          WPRFC                                         CAC00
     C                   MOVEL     FPRCL         PRFC                                          CAC00
     C     *IN89         IFEQ      '0'                                                         CAC00
     C                   EXSR      AKYOUT                                                      CAC00
     C                   ENDIF                                                                 CAC00
     C                   MOVEL     WPRFC         PRFC                                          CAC00
     C                   MOVEA     BKAKY         AKY(6)                                        CAC00
      *                                                                   CAC001
     C                   ENDIF                                                                 CAC00
     C*                                                                   S01465
     C**  Account key generated with 'R' in AKY (in position 8) if        S01465
     C**  the receiver of guarantee is different to blanks                S01465
     C*                                                                   S01465
     C     *IN26         IFEQ      '1'                                                         S0146
     C     WORECE        IFNE      *BLANKS                                                     S0146
     C**********           Z-ADDCNUML     WORK2                                        S01465 CSD027
     C                   MOVE      CNUML         WORK2
     C                   MOVE      WORECE        CNUML                                         S0146
     C                   MOVE      'R'           AKY(8)                                        S0146
     C  N89              EXSR      AKYOUT                                                      S0146
     C**********           Z-ADDWORK2     CNUML                                        S01465 CSD027
     C                   MOVE      WORK2         CNUML
     C                   MOVE      ' '           AKY(8)                                        S0146
     C                   END                                                                   S0146
     C                   END                                                                   S0146
2023 C**
2024 C**   IF DISC LOAN REVERSE OUT OTHER A/C KEYS
2025 C**
2026 C  N45              GOTO      INTKEY
2027 C**
2028 C                   Z-ADD     TOTI          ACAMNT                 8889
     C     CAS009        IFEQ      'Y'
      *                                                                                       232348
      ** Only process EIR cost accounting if loan's value date is same                        232348
      ** as or after the non-linear amortisation cut-off date                                 232348
     C     VDAT          ANDGE     FSNLAC
      *                                                                                       232348
     C                   EXSR      SRRTVI
     C                   ENDIF
     C     CAS009        IFEQ      'Y'
     C     *IN45         ANDEQ     '1'
     C     FSAMRM        ANDEQ     'N'
     C     AYACAI        ANDEQ     'Y'
      *                                                                                       232348
      ** Only process EIR cost accounting if loan's value date is same                        232348
      ** as or after the non-linear amortisation cut-off date                                 232348
     C     VDAT          ANDGE     FSNLAC
      *                                                                                       232315
      ** Suppress Dicount/Premium Amount for Discount Loans when                              232315
      ** the Amortisation Method is 'N'on-Linear.                                             232315
      *                                                                                       232315
     C                   ELSE
2029 C   88              MOVE      'P'           AKY(10)
2030 C   88              Z-SUB     ACAMNT        ACAMNT
2031 C  N88              MOVE      'D'           AKY(10)
2032 C  N89              EXSR      AKYOUT
     C                   ENDIF
2033 C**
2034 C     OPAM          SUB       TOTI          ACAMNT                   89
2035 C                   MOVE      'B'           AKY(10)
      *                                                                                       CLE034
      ** If CLE034 is installed                                                               CLE034
      *                                                                                       CLE034
     C     CLE034        IFEQ      'Y'
     C     STALL         ANDEQ     'Y'
     C                   EXSR      SR34A
     C                   ELSE
     C                   MOVE      'Y'           WRKFLD
     C                   MOVE      '*EOF   '     PRTCD
     C                   ENDIF
      *                                                                                       CLE034
     C     WRKFLD        DOWEQ     'Y'
     C     PRTCD         OREQ      *BLANKS
     C     CLE034        IFEQ      'Y'
     C     STALL         ANDEQ     'Y'
     C                   EXSR      SR34B
     C                   EXSR      SETCCY
     C                   ELSE
      *                                                                                       CLE031
      ** If feature CLE031 is on and indicator 89 is off call SR/SECCY2                       CLE031
      *                                                                                       CLE031
     C     CLE031        IFEQ      'Y'
     C     *IN89         ANDEQ     *OFF
     C                   EXSR      SECCY2
     C                   ENDIF
     C                   ENDIF
      *                                                                                       CLE031
2036 C  N89              EXSR      AKYOUT
      *                                                                                       CLE031
      ** If feature CLE031 is on and indicator 89 is off call SR/SETRST                       CLE031
      *                                                                                       CLE031
     C     CLE031        IFEQ      'Y'
     C     *IN89         ANDEQ     *OFF
     C                   EXSR      SETRST
     C                   ENDIF
      *                                                                                       CLE031
     C     CLE034        IFEQ      'Y'
     C     STALL         ANDEQ     'Y'
     C                   EXSR      SR34C
     C                   ELSE
     C                   MOVE      *BLANKS       WRKFLD
     C                   ENDIF
     C                   ENDDO
      *                                                                                       CLE034
     C     CLE034        IFEQ      'Y'
     C     STALL         ANDEQ     'Y'
     C                   EXSR      SR34E
     C                   ENDIF
2037 C**
2038 C**   REVERSE OUT ANY INTEREST AMOUNTS
2039 C**
2040 C     INTKEY        TAG                                                    ** INTKEY TAG *
2041 C**
     C                   Z-ADD     SLID          ACDATE
2042 C                   Z-ADD     IPRD          ACAMNT                   89    PAID/REC TODATE
     C/COPY WNCPYSRC,LE0450C035
2043 C                   MOVE      'R'           AKY(3)
2044 C                   MOVE      'I'           AKY(10)
      *                                                                                       CLE134
     C     WORIGL        IFEQ      'Y'                                                        CLE134
     C     WDECRF        ANDEQ     'Y'                                                        CLE134
     C     ACAMNT        SUB       WTOTDI        ACAMNT                                       CLE134
     C     ACAMNT        COMP      0                                      89                  CLE134
     C                   ENDIF                                                                CLE134
      *                                                                                       CLE134
      *                                                                                       CLE034
      ** If CLE034 is installed                                                               CLE034
      *                                                                                       CLE034
     C     CLE034        IFEQ      'Y'
     C     STALL         ANDEQ     'Y'
     C                   MOVE      'E'           WTYPE
     C                   EXSR      SR34A
     C                   ELSE
     C                   MOVE      'Y'           WRKFLD
     C                   MOVE      '*EOF   '     PRTCD
     C                   ENDIF
      *                                                                                       CLE034
     C     WRKFLD        DOWEQ     'Y'
     C     PRTCD         OREQ      *BLANKS
     C     CLE034        IFEQ      'Y'
     C     STALL         ANDEQ     'Y'
     C                   EXSR      SR34B
     C                   ELSE
      *                                                                                       CLE031
      ** If feature CLE031 is on and indicator 89 is off call SR/SETCCY                       CLE031
      *                                                                                       CLE031
     C     CLE031        IFEQ      'Y'
     C     *IN89         ANDEQ     *OFF
     C                   MOVE      'E'           WTYPE
     C                   EXSR      SETCCY
     C                   ENDIF
      *                                                                                       CLE031
2045 C  N89              EXSR      AKYOUT
     C     WORIGL        IFEQ      'Y'                                                      CLE134
     C     WTOTDI        ANDNE     0                                                        CLE134
     C     WDECRF        ANDEQ     'Y'                                                      CLE134
     C                   Z-ADD     WTOTDI        ACAMNT                   89                CLE134
     C                   MOVEA     'XI'          AKY(9)                                     CLE134
     C  N89              EXSR      AKYOUT                                                   CLE134
     C                   MOVEA     ' I'          AKY(9)                                     CLE134
     C                   Z-ADD     IPRD          ACAMNT                   89                CLE134
     C                   ENDIF                                                              CLE134
      *                                                                                       CLE031
      ** If feature CLE031 is on and indicator 89 is off set work                             CLE031
      ** to 'Interest' then call SR/SETTLE, then set work int. to blanks                      CLE031
      *                                                                                       CLE031
     C     CLE031        IFEQ      'Y'
     C     *IN89         ANDEQ     *OFF
     C     WCLE134       ANDEQ     ' '                                                      MD049078
     C                   MOVE      'I'           WINT              1
     C                   EXSR      SETTLE
     C                   MOVE      *BLANKS       WINT
     C                   ENDIF
     C                   ENDIF
      *                                                                                       CLE034
     C     CLE034        IFEQ      'Y'
     C     STALL         ANDEQ     'Y'
     C                   EXSR      SR34C
     C                   ELSE
     C                   MOVE      *BLANKS       WRKFLD
     C                   ENDIF
     C                   ENDDO
      *                                                                                       CLE034
     C     CLE034        IFEQ      'Y'
     C     STALL         ANDEQ     'Y'
     C                   EXSR      SR34E
     C                   ENDIF
      *                                                                   CAC001
     C     BGN0ST        IFEQ      'Y'                                                         CAC00
     C     FPRCL         ANDNE     *BLANKS                                                     CAC00
      *                                                                   CAC001
      **  COF Paid/Received to Date -  Transaction Profit Centre          CAC001
      *                                                                   CAC001
     C                   Z-ADD     COFD          ACAMNT                   89                   CAC00
     C                   MOVEA     'T   '        AKY(6)                                        CAC00
     C     *IN89         IFEQ      '0'                                                         CAC00
     C                   EXSR      AKYOUT                                                      CAC00
     C                   ENDIF                                                                 CAC00
      *                                                                   CAC001
      **  COF Paid/Received to Date -  Funding Profit Centre              CAC001
      *                                                                   CAC001
     C                   MOVEA     'F   '        AKY(6)                                        CAC00
     C                   MOVEL     PRFC          WPRFC                                         CAC00
     C                   MOVEL     FPRCL         PRFC                                          CAC00
     C     *IN89         IFEQ      '0'                                                         CAC00
     C                   EXSR      AKYOUT                                                      CAC00
     C                   ENDIF                                                                 CAC00
     C                   MOVEL     WPRFC         PRFC                                          CAC00
     C                   MOVEA     BKAKY         AKY(6)                                        CAC00
      *                                                                   CAC001
     C                   ENDIF                                                                 CAC00
2046 C**
2047 C                   Z-ADD     ICTD          ACAMNT                   89    CAPT TO DATE
     C/COPY WNCPYSRC,LE0450C036
2048 C                   MOVE      'C'           AKY(10)
2049 C  N89              EXSR      AKYOUT
      *                                                                   CAC001
     C     BGN0ST        IFEQ      'Y'                                                         CAC00
     C     FPRCL         ANDNE     *BLANKS                                                     CAC00
      *                                                                   CAC001
      **  COF Capitalised to Date -  Transaction Profit Centre            CAC001
      *                                                                   CAC001
     C                   Z-ADD     CFCD          ACAMNT                   89                   CAC00
     C                   MOVEA     'T   '        AKY(6)                                        CAC00
     C     *IN89         IFEQ      '0'                                                         CAC00
     C                   EXSR      AKYOUT                                                      CAC00
     C                   ENDIF                                                                 CAC00
      *                                                                   CAC001
      **  COF Capitalised to Date -  Funding Profit Centre                CAC001
      *                                                                   CAC001
     C                   MOVEA     'F   '        AKY(6)                                        CAC00
     C                   MOVEL     PRFC          WPRFC                                         CAC00
     C                   MOVEL     FPRCL         PRFC                                          CAC00
     C     *IN89         IFEQ      '0'                                                         CAC00
     C                   EXSR      AKYOUT                                                      CAC00
     C                   ENDIF                                                                 CAC00
     C                   MOVEL     WPRFC         PRFC                                          CAC00
     C                   MOVEA     BKAKY         AKY(6)                                        CAC00
      *                                                                   CAC001
     C                   ENDIF                                                                 CAC00
2050 C**
     C                   Z-ADD     RUND          ACDATE
2051 C                   Z-ADD     AIPD          ACAMNT                 8889    POSTED TO DATE
     C/COPY WNCPYSRC,LE0450C037
2052 C                   SETON                                        65
2053 C                   MOVE      'A'           AKY(3)
2054 C  N45              MOVE      'I'           AKY(10)
     C   45
2055 CANN88              MOVE      'D'           AKY(10)
     C   45
2056 CAN 88              MOVE      'P'           AKY(10)
     C     CLE028        IFEQ      'Y'
     C     PTYP          ANDEQ     80
     C     ADIF          ANDEQ     'Y'
     C                   MOVE      'D'           AKY(10)
     C                   ENDIF
     C   45
2057 CAN 88              Z-SUB     ACAMNT        ACAMNT
      *                                                                                       CAS009
      ** If CAS009 is enabled, generate posted to date a/c keys only if                       CAS009
      ** the hedging amortisation method is not 'N' (non-linear).                             CAS009
      *                                                                                       CAS009
     C     CAS009        IFEQ      'Y'
      *                                                                                       232348
      ** Only process EIR cost accounting if loan's value date is same                        232348
      ** as or after the non-linear amortisation cut-off date                                 232348
     C     VDAT          ANDGE     FSNLAC
      *                                                                                       232348
     C                   EXSR      SRRTVI
     C                   ENDIF
     C     CAS009        IFEQ      'Y'
     C     *IN45         ANDEQ     '1'
     C     FSAMRM        ANDEQ     'N'
     C     AYACAI        ANDEQ     'Y'
      *                                                                                       232348
      ** Only process EIR cost accounting if loan's value date is same                        232348
      ** as or after the non-linear amortisation cut-off date                                 232348
     C     VDAT          ANDGE     FSNLAC
      *                                                                                       CAS009
      ** Suppress Linear Amortisation for Discount Loans when                                 CAS009
      ** the Amortisation Method is 'N'on-Linear.                                             CAS009
      *                                                                                       CAS009
     C                   ELSE
2058 C  N89              EXSR      AKYOUT
     C                   ENDIF
      *                                                                                       CAS009
      ** Update the accrued interest to date from EIR start date                              CAS009
      ** if CAS009 is enabled.                                                                CAS009
      *                                                                                       CAS009
     C     CAS009        IFEQ      'Y'
      *                                                                                       232348
      ** Only process EIR cost accounting if loan's value date is same                        232348
      ** as or or after the non-linear amortisation cut-off date                              232348
     C     VDAT          ANDGE     FSNLAC
      *                                                                                       232348
     C                   MOVE      *IN10         WIN10             1
     C                   MOVE      LNRF          KTRAN
     C     KTRAN         CHAIN     LEEIRDL5                           10
      *                                                                                       CAS009
     C     *IN10         IFEQ      *OFF
     C                   ADD       AIPD          EIACTD
     C                   UPDATE    LEEIRDD0
     C                   ENDIF
      *                                                                                       CAS009
     C                   MOVE      WIN10         *IN10
     C                   ENDIF
      *                                                                   CAC001
     C     BGN0ST        IFEQ      'Y'                                                         CAC00
     C     FPRCL         ANDNE     *BLANKS                                                     CAC00
     C     *IN45         ANDEQ     '0'                                                         CAC00
      *                                                                   CAC001
      **  Accrued COF Posted to Date -  Transaction Profit Centre         CAC001
      *                                                                   CAC001
     C                   Z-ADD     ACPD          ACAMNT                   89                   CAC00
     C                   MOVEA     'T   '        AKY(6)                                        CAC00
     C     *IN89         IFEQ      '0'                                                         CAC00
     C                   EXSR      AKYOUT                                                      CAC00
     C                   ENDIF                                                                 CAC00
      *                                                                   CAC001
      **  Accrued COF Posted to Date -  Funding Profit Centre             CAC001
      *                                                                   CAC001
     C                   MOVEA     'F   '        AKY(6)                                        CAC00
     C                   MOVEL     PRFC          WPRFC                                         CAC00
     C                   MOVEL     FPRCL         PRFC                                          CAC00
     C     *IN89         IFEQ      '0'                                                         CAC00
     C                   EXSR      AKYOUT                                                      CAC00
     C                   ENDIF                                                                 CAC00
     C                   MOVEL     WPRFC         PRFC                                          CAC00
     C                   MOVEA     BKAKY         AKY(6)                                        CAC00
      *                                                                   CAC001
     C                   ENDIF                                                                 CAC00
      *                                                                   CAC001
2059 C                   SETOFF                                       65
2060 C**
     C                   Z-ADD     SLID          ACDATE
2061 C                   Z-ADD     WTRD          ACAMNT                   89    W/TAX REC
2062 C                   MOVE      'R'           AKY(3)
2063 C                   MOVE      WTINL         AKY(6)
2064 C                   MOVE      'W'           AKY(10)
2065 C  N89              EXSR      AKYOUT
2066 C**
     C                   Z-ADD     RUND          ACDATE
2067 C                   Z-ADD     AWTP          ACAMNT                   89    W/TAX POSTED
2068 C                   SETON                                        65
2069 C                   MOVE      'A'           AKY(3)
2070 C                   MOVE      'W'           AKY(10)
2071 C  N89              EXSR      AKYOUT
2072 C                   SETOFF                                       65
2073 C**
2074 C                   Z-ADD     TFEP          ACAMNT                   89    FEES PAID
2075 C                   MOVE      'R'           AKY(3)
2076 C                   MOVE      ' '           AKY(6)
2077 C                   MOVEA     '99'          AKY(8)
2078 C                   MOVE      'F'           AKY(10)
      *                                                                                       CGL020
      ** If Midas Compliance Watch (CGL020) is installed, set Fee                             CGL020
      ** Flag = 'F', Fee Value = Total Fees Paid and Fee Percent = 100                        CGL020
      *                                                                                       CGL020
     C     CGL020        IFEQ      'Y'
     C                   MOVE      'F'           F1FFLG
     C                   Z-ADD     TFEP          F1FVAL
     C                   Z-ADD     100           F1FPCT
     C                   ENDIF
      *                                                                                       CGL020
2079 C  N89              EXSR      AKYOUT
2080 C**
2081 C                   Z-ADD     PWOD          ACAMNT                   89    PRIN W/O
2082 C                   MOVEA     ' W'          AKY(8)
2083 C                   MOVE      'A'           AKY(10)
2084 C  N89              EXSR      AKYOUT
      *                                                                   CAC001
     C     BGN0ST        IFEQ      'Y'                                                         CAC00
     C     FPRCL         ANDNE     *BLANKS                                                     CAC00
     C     *IN45         ANDEQ     '0'                                                         CAC00
      *                                                                   CAC001
      **  Generate Principal Written-Off -  Transaction Profit Centre     CAC001
      *                                                                   CAC001
     C                   MOVE      'T'           AKY(6)                                        CAC00
     C     *IN89         IFEQ      '0'                                                         CAC00
     C                   EXSR      AKYOUT                                                      CAC00
     C                   ENDIF                                                                 CAC00
      *                                                                   CAC001
      **  Generate Principal Wrriten-Off -  Funding Profit Centre         CAC001
      *                                                                   CAC001
     C                   MOVE      'F'           AKY(6)                                        CAC00
     C                   MOVEL     PRFC          WPRFC                                         CAC00
     C                   MOVEL     FPRCL         PRFC                                          CAC00
     C     *IN89         IFEQ      '0'                                                         CAC00
     C                   EXSR      AKYOUT                                                      CAC00
     C                   ENDIF                                                                 CAC00
     C                   MOVEL     WPRFC         PRFC                                          CAC00
     C                   MOVE      ' '           AKY(6)                                        CAC00
      *                                                                   CAC001
     C                   ENDIF                                                                 CAC00
     C*                                                                   S01465
     C**  Account key generated with 'R' in AKY (in position 8) if        S01465
     C**  the receiver of guarantee is different to blanks                S01465
     C*                                                                   S01465
     C     *IN26         IFEQ      '1'                                                         S0146
     C     WORECE        IFNE      *BLANKS                                                     S0146
     C**********           Z-ADDCNUML     WORK2                                        S01465 CSD027
     C                   MOVE      CNUML         WORK2
     C                   MOVE      WORECE        CNUML                                         S0146
     C                   MOVE      'R'           AKY(8)                                        S0146
     C  N89              EXSR      AKYOUT                                                      S0146
     C**********           Z-ADDWORK2     CNUML                                        S01465 CSD027
     C                   MOVE      WORK2         CNUML
     C                   MOVE      ' '           AKY(8)                                        S0146
     C                   END                                                                   S0146
     C                   END                                                                   S0146
2085 C**
2086 C                   Z-ADD     IWOD          ACAMNT                   89    INT. W/O
2087 C                   MOVE      'I'           AKY(10)
2088 C  N89              EXSR      AKYOUT
      *                                                                   CAC001
     C     BGN0ST        IFEQ      'Y'                                                         CAC00
     C     FPRCL         ANDNE     *BLANKS                                                     CAC00
     C     *IN45         ANDEQ     '0'                                                         CAC00
      *                                                                   CAC001
     C                   Z-ADD     FWOD          ACAMNT                   89                   CAC00
      *                                                                   CAC001
      **  Generate COF Amount Written-Off -  Transaction Profit Centre    CAC001
      *                                                                   CAC001
     C                   MOVE      'T'           AKY(6)                                        CAC00
     C     *IN89         IFEQ      '0'                                                         CAC00
     C                   EXSR      AKYOUT                                                      CAC00
     C                   ENDIF                                                                 CAC00
      *                                                                   CAC001
      **  Generate COF Amount Written-Off -  Funding Profit Centre        CAC001
      *                                                                   CAC001
     C                   MOVE      'F'           AKY(6)                                        CAC00
     C                   MOVEL     PRFC          WPRFC                                         CAC00
     C                   MOVEL     FPRCL         PRFC                                          CAC00
     C     *IN89         IFEQ      '0'                                                         CAC00
     C                   EXSR      AKYOUT                                                      CAC00
     C                   ENDIF                                                                 CAC00
     C                   MOVEL     WPRFC         PRFC                                          CAC00
     C                   MOVE      ' '           AKY(6)                                        CAC00
      *                                                                   CAC001
     C                   ENDIF                                                                 CAC00
2089 C**
2090 C                   Z-ADD     WTWD          ACAMNT                   89    W/TAX W/O
2091 C                   MOVE      WTINL         AKY(6)
2092 C                   MOVE      'W'           AKY(10)
2093 C  N89              EXSR      AKYOUT
     C/COPY WNCPYSRC,LE0450C038
2094 C**
2095 C**   GENERATE PRINCIPAL REPAID KEY
2096 C**
2097 C     OPAM          ADD       ICTD          WRK13
2098 C     WRK13         SUB       PWOD          WRK13
2099 C     WRK13         SUB       CPAM          WRK13
2100 C**
2101 C                   Z-ADD     WRK13         ACAMNT                   89
2102 C                   MOVEA     BKAKY         AKY(6)
2103 C                   MOVE      'A'           AKY(10)
      *                                                                                       CLE134
     C     WORIGL        IFEQ      'Y'                                                        CLE134
     C     WDECRF        ANDEQ     'Y'                                                        CLE134
     C********** ACAMNT    SUB  WTOTDP    ACAMNT                                       CLE134 262967
     C********** ACAMNT    COMP 0                        89                            CLE134 262967
     C                   ENDIF                                                                CLE134
      *                                                                                       CLE034
      ** If CLE034 is installed                                                               CLE034
      *                                                                                       CLE034
     C     CLE034        IFEQ      'Y'
     C     STALL         ANDEQ     'Y'
     C                   EXSR      SR34A
     C                   ELSE
     C                   MOVE      'Y'           WRKFLD
     C                   MOVE      '*EOF   '     PRTCD
     C                   ENDIF
      *                                                                                       CLE034
     C     WRKFLD        DOWEQ     'Y'
     C     PRTCD         OREQ      *BLANKS
     C     CLE034        IFEQ      'Y'
     C     STALL         ANDEQ     'Y'
     C                   EXSR      SR34B
     C                   EXSR      SETCCY
     C                   ELSE
      *                                                                                       CLE031
      ** If feature CLE031 is on and indicator 89 is off then                                 CLE031
      ** call SR/SECCY2                                                                       CLE031
      *                                                                                       CLE031
     C     CLE031        IFEQ      'Y'
     C     *IN89         ANDEQ     *OFF
     C                   EXSR      SECCY2
     C                   ENDIF
     C                   ENDIF
      *                                                                                       CLE031
2104 C  N89              EXSR      AKYOUT
      *                                                                                       CLE134
     C     WORIGL        IFEQ      'Y'                                                        CLE134
     C     WTOTDP        ANDNE     0                                                          CLE134
     C     WDECRF        ANDEQ     'Y'                                                        CLE134
     C                   Z-ADD     WTOTDP        ACAMNT                   89                  CLE134
     C                   MOVEA     'XP'          AKY(9)                                       CLE134
     C  N89              EXSR      AKYOUT                                                     CLE134
     C                   Z-ADD     WRK13         ACAMNT                   89                  CLE134
     C                   MOVEA     ' A'          AKY(9)                                       CLE134
     C                   ENDIF                                                                CLE134
      *                                                                                       CLE031
      ** If feature CLE031 is on and indicator 89 is off then                                 CLE031
      ** call SR/SETTLE                                                                       CLE031
      *                                                                                       CLE031
     C     CLE031        IFEQ      'Y'
     C     *IN89         ANDEQ     *OFF
     C     WCLE134       ANDEQ     ' '                                                      MD049078
     C                   EXSR      SETTLE
     C                   ENDIF
      *                                                                                       CLE034
     C     CLE034        IFEQ      'Y'
     C     STALL         ANDEQ     'Y'
     C                   EXSR      SR34C
     C                   ELSE
     C                   MOVE      *BLANKS       WRKFLD
     C                   ENDIF
     C                   ENDDO
      *                                                                                       CLE034
     C     CLE034        IFEQ      'Y'
     C     STALL         ANDEQ     'Y'
     C                   EXSR      SR34E
     C                   ENDIF
      *                                                                   CAC001
     C     BGN0ST        IFEQ      'Y'                                                         CAC00
     C     FPRCL         ANDNE     *BLANKS                                                     CAC00
     C     *IN45         ANDEQ     '0'                                                         CAC00
      *                                                                   CAC001
      **  Generate Principal Repaid Key -  Transaction Profit Centre      CAC001
      *                                                                   CAC001
     C     OPAM          ADD       CFCD          ACAMNT                                        CAC00
     C                   SUB       PWOD          ACAMNT                                        CAC00
     C                   SUB       CPAM          ACAMNT                   89                   CAC00
      *                                                                   CAC001
     C                   MOVEA     'T   '        AKY(6)                                        CAC00
     C     *IN89         IFEQ      '0'                                                         CAC00
     C                   EXSR      AKYOUT                                                      CAC00
     C                   ENDIF                                                                 CAC00
      *                                                                   CAC001
      **  Accrued COF Posted to Date -  Funding Profit Centre             CAC001
      *                                                                   CAC001
     C                   MOVEA     'F   '        AKY(6)                                        CAC00
     C                   MOVEL     PRFC          WPRFC                                         CAC00
     C                   MOVEL     FPRCL         PRFC                                          CAC00
     C     *IN89         IFEQ      '0'                                                         CAC00
     C                   EXSR      AKYOUT                                                      CAC00
     C                   ENDIF                                                                 CAC00
     C                   MOVEL     WPRFC         PRFC                                          CAC00
     C                   MOVEA     BKAKY         AKY(6)                                        CAC00
      *                                                                   CAC001
     C                   ENDIF                                                                 CAC00
     C*                                                                   S01465
     C**  Account key generated with 'R' in AKY (in position 8) if        S01465
     C**  the receiver of guarantee is different to blanks                S01465
     C*                                                                   S01465
     C     *IN26         IFEQ      '1'                                                         S0146
     C     WORECE        IFNE      *BLANKS                                                     S0146
     C**********           Z-ADDCNUML     WORK2                                        S01465 CSD027
     C                   MOVE      CNUML         WORK2
     C                   MOVE      WORECE        CNUML                                         S0146
     C                   MOVE      'R'           AKY(8)                                        S0146
     C  N89              EXSR      AKYOUT                                                      S0146
     C**********           Z-ADDWORK2     CNUML                                        S01465 CSD027
     C                   MOVE      WORK2         CNUML
     C                   MOVE      ' '           AKY(8)                                        S0146
     C                   END                                                                   S0146
     C                   END                                                                   S0146
     C/COPY WNCPYSRC,LE0450CP22                                           S01408
2105 C**
2106 C**   GENERATE A TOTAL REPAYMENT KEY IF REQUIRED
2107 C**
2108 C     WRK13         ADD       IPRD          WRK13
2109 C     WRK13         ADD       TFEP          WRK13
2110 C**
2111 C     WTINL         COMP      'G'                                    89
2112 C   89WRK13         SUB       WTRD          WRK13
2113 C**
2114 C                   Z-ADD     WRK13         ACAMNT                   89
2115 C                   MOVE      'B'           AKY(10)
2116 C**
2117 C**   USE MATURITY INSTR'S FOR REVERSAL TOTAL REPAY KEY
2118 C**
2119 C                   MOVE      MDST          SETP
2120 C                   MOVE      OMDA          OSAC
      *                                                                                       CGL020
     C     CGL020        IFEQ      'Y'
     C                   MOVEL     STLNS3        STLNS1
     C                   EXSR      SRAMPR
     C                   ENDIF
      *                                                                                       CGL020
2120 C                   MOVE      OMDB          OSBR                                          S0111
      *                                                                   CEU004
      ** If feature CEU004 is on, set currency field on LKEY1DP           CEU004
      ** If Settlement currency from the LOAN is not blank.               CEU004
      *                                                                   CEU004
     C     CEU004        IFEQ      'Y'                                          If Feature On  CEU00
      *                                                                   CEU004
     C     SCCYL         IFNE      *BLANKS                                       If SetCcy # BlCEU00
     C                   MOVE      SCCYL         LKSCCY                           Set Outpt CcyCEU00
     C                   ELSE                                                    Else
     C                   MOVE      *BLANKS       LKSCCY                          Clr Outpt Ccy
     C                   ENDIF                                                   End If        CEU00
      *                                                                   CEU004
     C                   ENDIF                                                  End If         CEU00
      *                                                                   CEU004
      ** If Midas Compliance Watch (CGL020) is installed, set Fee                             CGL020
      ** Flag = 'F', Fee Value = Total Fees Paid and Fee Percent =                            CGL020
      ** Total Fees Paid over Total Repayment                                                 CGL020
      *                                                                                       CGL020
     C     CGL020        IFEQ      'Y'
     C                   MOVE      'F'           F1FFLG
     C                   Z-ADD     TFEP          F1FVAL
      *                                                                                       CGL020
      ** Calculate Fee Percent                                                                CGL020
      *                                                                                       CGL020
     C     WRK13         IFNE      0
     C     TFEP          DIV(H)    WRK13         WFPCT1           13 4
     C     WFPCT1        MULT      100           F1FPCT
     C                   ENDIF
     C                   ENDIF
      *                                                                   CEU004
      ** If CLE034 is installed                                                               CLE034
      *                                                                                       CLE034
     C     CLE034        IFEQ      'Y'
     C     STALL         ANDEQ     'Y'
     C                   EXSR      SR34A
     C                   ELSE
     C                   MOVE      'Y'           WRKFLD
     C                   MOVE      '*EOF   '     PRTCD
     C                   ENDIF
      *                                                                                       CLE034
     C     WRKFLD        DOWEQ     'Y'
     C     PRTCD         OREQ      *BLANKS
     C     CLE034        IFEQ      'Y'
     C     STALL         ANDEQ     'Y'
     C                   EXSR      SR34B
     C                   EXSR      SETCCY
     C                   ELSE
      *                                                                                       CLE031
      ** If feature CLE031 is on and indicator 89 is off call SR/SECCY2                       CLE031
      *                                                                                       CLE031
     C     CLE031        IFEQ      'Y'
     C     *IN89         ANDEQ     *OFF
     C                   EXSR      SECCY2
     C                   ENDIF
     C                   ENDIF
      *                                                                                       CLE031
2121 C  N89              EXSR      AKYOUT
      *                                                                                       CLE031
      ** If feature CLE031 is on and indicator 89 is off call SR/SETRST                       CLE031
      *                                                                                       CLE031
     C     CLE031        IFEQ      'Y'
     C     *IN89         ANDEQ     *OFF
     C                   EXSR      SETRST
     C                   ENDIF
      *                                                                                       CLE034
     C     CLE034        IFEQ      'Y'
     C     STALL         ANDEQ     'Y'
     C                   EXSR      SR34C
     C                   ELSE
     C                   MOVE      *BLANKS       WRKFLD
     C                   ENDIF
     C                   ENDDO
      *                                                                                       CLE034
     C     CLE034        IFEQ      'Y'
     C     STALL         ANDEQ     'Y'
     C                   EXSR      SR34E
     C                   ENDIF
2122 C**
2123 C                   GOTO      LONBEN
2124 C**
2125 C**   ACCRUAL PROCESS IF REQUIRED
2126 C**
2127 C     ACCRL         TAG                                                    ** ACCRL TAG **
2128 C**
2129 C     RECI          COMP      'D'                                    89
2130 C   89RECIL         COMP      'D'                                    89
2131 C  N44                                                                     NO ACCRUALS
2132 CORN89              GOTO      RESET                                        MAT LOAN
2133 C**
     C/COPY WNCPYSRC,LE0450C039
2134 C                   Z-ADD     IACD          ZIBEG
2135 C                   Z-ADD     EVCD          ZIEND
2136 C**
2137 C**   LOAN MAY HAVE GONE PAST DUE - USE LESSER OF MDAT AND EVCD
2138 C**   FOR ZIEND.
2139 C**
     C                   SETOFF                                       88
      *                                                                   117756
      ** avoid using *in20 since MDAT may be updated with new value       117756
      *                                                                   117756
     C**N20******MDAT      COMP EVCD                   8888               117756
     C     MDAT          IFNE      0                                                           11775
     C     MDAT          ANDLE     EVCD                                                        11775
     C                   SETON                                        88                       11775
     C                   END                                                                   11775
      *                                                                   117756
2141 C   88              Z-ADD     MDAT          ZIEND
2142 C**N40N88***ZIEND     ADD  1         ZIEND                           S01392
     C     *IN88         IFNE      '1'                                                         S0139
     C     ADDI          ANDEQ     'F'                                                         S0139
     C     ZIEND         ADD       1             ZIEND                                         S0139
     C                   END                                                                   S0139
      *                                                                   CAC001
     C     BGN0ST        IFEQ      'Y'                                                         CAC00
     C     FPRCL         ANDNE     *BLANKS                                                     CAC00
     C                   Z-ADD     ZIEND         ZIEND1            5 0                         CAC00
     C                   ENDIF                                                                 CAC00
     C*                                                                   S01392
     C**  IF FIRST & LAST DAY ACCRL, AND ACCRUE FROM START DATE,          S01392
     C**  ADD 1 DAY                                                       S01392
     C*                                                                   S01392
     C     ADDI          IFEQ      'B'                                                         S0139
     C********** ZIBEG     ANDEQVDATL                                                  S01392 245082
     C     ZIEND         ADD       1             ZIEND                                         S0139
     C                   END                                                                   S0139
2143 C     ZIBEG         COMP      ZIEND                              88
0865 C*                                                                   088120
0865 C**   IF CURRENT PRINCIPAL > 0                                       088120
0865 C*                                                                   088120
0865 C     CPAM          IFGT      0                                                           08812
     C/COPY WNCPYSRC,LE0450C053
0865 C*                                                                   088120
2144 C                   Z-ADD     CPAM          ZIAMT
2145 C                   Z-ADD     INTRL         ZIRATE
2146 C                   Z-ADD     ICBS          ZICALC
      *                                                                                       CAS005
     C     CAS005        IFEQ      'Y'
     C                   Z-ADD     ZIBEG         WKBEG             5 0
     C                   Z-ADD     ZIEND         WKEND             5 0
     C                   Z-ADD     ZIAMT         WKAMT            13 0
     C                   Z-ADD     INTRL         WKRAT            11 7
     C                   Z-ADD     ICBS          WKCALC            1 0
     C                   ENDIF
     C*                                                                   S01408
     C/COPY WNCPYSRC,LE0450CCP8                                           S01408
     C*                                                                   S01408
     C     CLE028        IFEQ      'Y'
     C     PTYP          ANDEQ     80
     C                   EXSR      SRPCAL
     C                   ELSE
     C/COPY WNCPYSRC,LEH01316
2147 C                   EXSR      GLINTC
     C                   ENDIF
2148 C***********          Z-ADDZINTR     AMOUNT    H                     S01392
     C*                                                                   S01408
     C/COPY WNCPYSRC,LE0450CCP9                                           S01408
     C*                                                                   S01408
     C*                                                                   S01392
     C**  ROUND DOWN IF REQUIRED                                          S01392
     C*                                                                   S01392
     C     RDFC          IFEQ      'Y'                                                         S0139
     C                   Z-ADD     ZINTR         AMOUNT                                        S0139
     C                   ELSE                                                                  S0139
     C                   Z-ADD(H)  ZINTR         AMOUNT                                        S0139
     C                   END                                                                   S0139
0865 C*                                                                   088120
0865 C                   ELSE                                                                  08812
0865 C*                                                                   088120
0865 C*  IF PRINCIPAL NOT GREATER THAN 0, INTEREST IS 0                   088120
0889 C                   Z-ADD     0             AMOUNT                                        08812
0865 C                   END                                                                   08812
0865 C*                                                                   088120
2149 C   88              Z-ADD     0             AMOUNT
2150 C   48              Z-ADD     0             AMOUNT
     C**
     C**   IF MATURITY DATE IS LESS THAN IACD, ADD PDIN INSTEAD OF AITC.
     C                   SETOFF                                       88
     C   48              GOTO      SKIPAC                                                      E9688
      *                                                                   117756
      ** avoid using *in20 since MDAT may be updated with new value       117756
      *                                                                   117756
     C**N20******MDAT      COMP IACD                   88                 117756
     C     MDAT          IFNE      0                                                           11775
     C     MDAT          ANDLT     IACD                                                        11775
     C                   SETON                                        88                       11775
     C                   END                                                                   11775
      *                                                                   117756
     C   88RECIL         COMP      'D'                                    88
     C   88AMOUNT        ADD       PDIN          WRK13
     C     SKIPAC        TAG                                                                   E9688
2151 C  N88AMOUNT        ADD       AITC          WRK13
2152 C     WRK13         ADD       AIAP          WRK13
2153 C**
2154 C**   NEED TO HAVE POSTED GREATER OF ACCRUED AND PAID
2155 C**
2156 C     IPRD          ADD       ICTD          WRK13A
2157 C     WRK13A        ADD       IWOD          WRK13A
     C***********AMTP      IFNE 'MR'                                160856182711
     C***********VDAT      OREQ EVCD                                160856182711
     C***********AKYS3     OREQ 'R'                                 160856182711
     C***********AKYS10    ANDEQ'I'                                 160856182711
     C***********VDAT      ANDLTEVCD                                160856182711
2158 C     WRK13A        COMP      WRK13                              88
     C   88WRK13A        COMP      AIPD                                 88                  AR897086
     C***********          ELSE                                     160856182711
     C***********WRK13A    COMP WRK13                  88           160856182711
     C************IN88     IFEQ '1'                                 160856182711
     C***********          ADD  AMOUNT    WRK13A                    160856182711
     C***********          ENDIF                                    160856182711
     C***********          MOVE '  '      AMTP                      160856182711
     C***********          END                                      160856182711
     C***********          MOVE *BLANKS   AKYS                      160856182711
2159 C   88              Z-ADD     WRK13A        WRK13
2160 C     WRK13         SUB       AIPD          WRK13
2161 C**
2162 C**   GENERATE ACCRUAL KEY
2163 C**
     C     *IN35         IFEQ      '1'                                                         07258
     C                   Z-ADD     IACD          SLIDL                                         07258
     C                   MOVE      '0'           *IN35                                         07258
     C                   END                                                                   07258
      *****************************************************************             240956 AR1081005
      ***If*stop*accrual*indicator*is*on,*zeroise*amount*as*posting*will            240956 AR1081005
      ***be*done*on*next*interest*payment*date/maturity*date.**********             240956 AR1081005
      *****************************************************************             240956 AR1081005
     C******IN48         IFEQ      '1'                                                     AR1081005
     C**********         Z-ADD     0             WRK13                                     AR1081005
     C**********         ENDIF                                                             AR1081005
      *                                                                                       CLE028
      ** No daily interest accrual for PTYP 80. Interest amortisa                             CLE028
      ** tion is being done during repayment. Only generate interest amor                     CLE028
      ** tisation account key for past due payments                                           CLE028
      ** or early pay offs.                                                                   CLE028
      *                                                                                       CLE028
     C     CLE028        IFEQ      'N'
     C     CLE028        OREQ      'Y'
     C     PTYP          ANDNE     80
     C     CLE028        OREQ      'Y'
     C     PTYP          ANDEQ     80
     C     WPASTD        ANDEQ     'Y'
     C     CLE028        OREQ      'Y'
     C     PTYP          ANDEQ     80
     C     WEARLY        ANDEQ     'Y'
2164 C                   SETON                                            65
2165 C                   Z-ADD     EVCD          ACDATE
2166 C                   Z-ADD     WRK13         ACAMNT                 8889    ACCRUED INT
2167 C                   MOVE      'A'           AKY(3)
2168 C                   MOVEA     BKAKY         AKY(6)
2169 C                   MOVE      'I'           AKY(10)
     C   45
2170 CAN 88              MOVE      'P'           AKY(10)
     C   45
2171 CAN 88              Z-SUB     ACAMNT        ACAMNT
     C   45
2172 CANN88              MOVE      'D'           AKY(10)
     C     CLE028        IFEQ      'Y'
     C     PTYP          ANDEQ     80
     C     ADIF          ANDEQ     'Y'
     C                   MOVE      'D'           AKY(10)
     C                   ENDIF
     C     CAS009        IFEQ      'Y'
      *                                                                                       232348
      ** Only process EIR cost accounting if loan's value date is same                        232348
      ** as or after the non-linear amortisation cut-off date                                 232348
     C     VDAT          ANDGE     FSNLAC
      *                                                                                       232348
     C                   EXSR      SRRTVI
     C                   ENDIF
     C     CAS009        IFEQ      'Y'
     C     *IN45         ANDEQ     '1'
     C     FSAMRM        ANDEQ     'N'
     C     AYACAI        ANDEQ     'Y'
      *                                                                                       232348
      ** Only process EIR cost accounting if loan's value date is same                        232348
      ** as or after the non-linear amortisation cut-off date                                 232348
     C     VDAT          ANDGE     FSNLAC
      *                                                                                       232315
      ** Suppress Linear Amortisation for Discount Loans when                                 232315
      ** the Amortisation Method is 'N'on-Linear.                                             232315
      *                                                                                       232315
     C                   ELSE
2173 C  N89              EXSR      AKYOUT
      *                                                                                       CLE028
      ** Generate charge account key for flat rate loans                                      CLE028
      ** when an interest accrual key has also been generated                                 CLE028
      *                                                                                       CLE028
     C     ADCF          IFEQ      'Y'
     C                   MOVE      *ON           *IN65
     C                   Z-ADD     EVCD          ACDATE
     C     AUTO          IFEQ      'Y'
     C     AUTO          OREQ      'C'                                                        CLE134
     C     CLE134        ANDEQ     'Y'                                                        CLE134
     C                   Z-ADD     WCHDU         ACAMNT
     C                   ELSE
     C                   Z-ADD     WPDCH         ACAMNT
     C                   ENDIF
     C                   MOVE      'A'           AKY(3)
     C                   MOVEA     BKAKY         AKY(6)
     C                   MOVE      'H'           AKY(10)
     C     ACAMNT        IFNE      *ZERO
     C                   EXSR      AKYOUT
     C                   Z-ADD     *ZERO         WPDCH
     C                   Z-ADD     *ZERO         WCHDU
     C                   ENDIF
     C                   ENDIF
2174 C**
2175 C**   UPDATE FILE AMOUNT
2176 C**
     C********** CAS009    IFEQ 'Y'                                                    CAS009 232315
     C**********           EXSR SRRTVI                                                 CAS009 232315
     C**********           ENDIF                                                       CAS009 232315
     C********** CAS009    IFEQ 'Y'                                                    CAS009 232315
     C********** *IN45     ANDEQ'1'                                                    CAS009 232315
     C********** FSAMRM    ANDEQ'N'                                                    CAS009 232315
     C********** AYACAI    ANDEQ'Y'                                                    CAS009 232315
      *****************************************************************                CAS009 232315
      ***Suppress*Linear*Amortisation*for*Discount*Loans*when**********                CAS009 232315
      ***the*Amortisation*Method*is*'N'on-Linear.**********************                CAS009 232315
      *****************************************************************                CAS009 232315
     C**********           ELSE                                                        CAS009 232315
2178 C     AIPD          ADD       WRK13         AIPD
     C                   ENDIF
     C                   ENDIF
2179 C**
2180 C**   CALCULATE W/TAX PORTION OF INTEREST AMOUNT
     C/COPY WNCPYSRC,LE0450C040
2181 C**
     C/COPY WNCPYSRC,LE0450C041
2182 C                   Z-ADD     WRK13         AMOUNT
2183 C                   EXSR      WTAX
2184 C**
2185 C                   Z-ADD     AMOUNT        ACAMNT                   89    ACCRUED W/TAX
2186 C                   MOVE      'W'           AKY(10)
2187 C                   MOVE      WTINL         AKY(6)
     C  N45
2188 CANN89              EXSR      AKYOUT
2189 C                   SETOFF                                           65
2190 C**
2191 C**   UPDATE FILE AMOUNT
2192 C**
2193 C     AWTP          ADD       AMOUNT        AWTP
      *                                                                   CAC001
     C     BGN0ST        IFEQ      'Y'                                                         CAC00
     C     FPRCL         ANDNE     *BLANKS                                                     CAC00
      *                                                                   CAC001
     C                   Z-ADD     FCTD          ZIBEG                                         CAC00
     C                   Z-ADD     ZIEND1        ZIEND                                         CAC00
      *                                                                   CAC001
     C     ADDI          IFEQ      'B'                                                         CAC00
     C     ZIBEG         ANDEQ     VDATL                                                       CAC00
     C     ZIEND         ADD       1             ZIEND                                         CAC00
     C                   END                                                                   CAC00
      *                                                                   CAC001
     C     CPAM          IFGT      0                                                           CAC00
      *                                                                   CAC001
     C                   Z-ADD     CPAM          ZIAMT                                         CAC00
     C                   Z-ADD     WFSRP         ZIRATE                                        CAC00
     C                   Z-ADD     ICBS          ZICALC                                        CAC00
     C/COPY WNCPYSRC,LE0450C065
     C     CLE028        IFEQ      'Y'
     C     PTYP          ANDEQ     80
     C                   EXSR      SRPCAL
     C                   ELSE
     C/COPY WNCPYSRC,LEH01317
     C                   EXSR      GLINTC                                                      CAC00
     C                   ENDIF
     C/COPY WNCPYSRC,LE0450C067
      *                                                                   CAC001
      **  Round Down if required                                          CAC001
      *                                                                   CAC001
     C     RDFC          IFEQ      'Y'                                                         CAC00
     C                   Z-ADD     ZINTR         AMNTCF           13 0                         CAC00
     C                   ELSE                                                                  CAC00
     C                   Z-ADD(H)  ZINTR         AMNTCF                                        CAC00
     C                   END                                                                   CAC00
      *                                                                   CAC001
     C                   ELSE                                                                  CAC00
      *                                                                   CAC001
     C                   Z-ADD     0             AMNTCF                                        CAC00
      *                                                                   CAC001
     C                   ENDIF                                                                 CAC00
      *                                                                   CAC001
     C     ZIBEG         IFGT      ZIEND                                                       CAC00
     C     *IN48         OREQ      '1'                                                         CAC00
     C                   Z-ADD     0             AMNTCF                                        CAC00
     C                   ENDIF                                                                 CAC00
      *                                                                   CAC001
      **  If stop accruals is off, maturity date is not 0,                CAC001
      **  loan is live and maturity is less than FCTD,                    CAC001
      **  add PDCF instead of ACDA.                                       CAC001
      *                                                                   CAC001
     C     *IN48         IFEQ      '0'                                                         CAC00
     C     *IN20         ANDEQ     '0'                                                         CAC00
     C     RECIL         ANDEQ     'D'                                                         CAC00
     C     MDAT          ANDLT     FCTD                                                        CAC00
     C     AMNTCF        ADD       PDCF          WK13N                                         CAC00
     C                   ELSE                                                                  CAC00
     C     AMNTCF        ADD       ACDA          WK13N                                         CAC00
     C                   ENDIF                                                                 CAC00
      *                                                                   CAC001
     C                   ADD       ACAP          WK13N                                         CAC00
      *                                                                   CAC001
      **  Need to have posted greater of accrued and paid                 CAC001
      *                                                                   CAC001
     C     COFD          ADD       CFCD          WK13NA                                        CAC00
     C                   ADD       FWOD          WK13NA                                        CAC00
     C     WK13NA        IFGT      WK13N                                                       CAC00
     C                   Z-ADD     WK13NA        WK13N                                         CAC00
     C                   ENDIF                                                                 CAC00
      *                                                                   CAC001
     C                   SUB       ACPD          WK13N                                         CAC00
      *                                                                   CAC001
      ** Generate Accrual Key                                             CAC001
      *                                                                   CAC001
     C     *IN45         IFEQ      '0'                                                         CAC00
      *                                                                   CAC001
     C                   SETON                                            65                   CAC00
     C                   MOVE      'I'           AKY(10)                                       CAC00
     C                   Z-ADD     WK13N         ACAMNT                   89                   CAC00
      *                                                                   CAC001
      ** Transaction Profit Centre                                        CAC001
      *                                                                   CAC001
     C                   MOVEA     'T   '        AKY(6)                                        CAC00
     C     *IN89         IFEQ      '0'                                                         CAC00
     C                   EXSR      AKYOUT                                                      CAC00
     C                   ENDIF                                                                 CAC00
      *                                                                   CAC001
      ** Funding Profit Centre                                            CAC001
      *                                                                   CAC001
     C                   MOVEA     'F   '        AKY(6)                                        CAC00
     C                   MOVEL     PRFC          WPRFC                                         CAC00
     C                   MOVEL     FPRCL         PRFC                                          CAC00
     C     *IN89         IFEQ      '0'                                                         CAC00
     C                   EXSR      AKYOUT                                                      CAC00
     C                   ENDIF                                                                 CAC00
      *                                                                   CAC001
     C                   MOVEL     WPRFC         PRFC                                          CAC00
     C                   MOVEA     BKAKY         AKY(6)                                        CAC00
      *                                                                   CAC001
     C                   ENDIF                                                                 CAC00
      *                                                                   CAC001
     C                   ADD       WK13N         ACPD                                          CAC00
      *                                                                   CAC001
     C                   ENDIF                                                  - BGN0ST       CAC00
      *                                                                                       CAS005
     C     CAS005        IFEQ      'Y'
      *                                                                                       CAS005
     C     CPAM          IFGT      *ZEROS
     C                   Z-ADD     WKBEG         ZIBEG
     C                   Z-ADD     WKEND         ZIEND
     C                   Z-ADD     WKAMT         ZIAMT
     C                   Z-ADD     WKCALC        ZICALC
     C     MARG          IFLT      0
     C                   Z-SUB     MARG          WAVMAR            7 5
     C                   ELSE
     C                   Z-ADD     MARG          WAVMAR
     C                   ENDIF
     C     WKRAT         IFGT      WAVMAR
     C     WKRAT         SUB       MARG          ZIRATE
     C                   ELSE
     C                   Z-ADD     0             ZIRATE
     C                   ENDIF
      *                                                                                       CAS005
     C/COPY WNCPYSRC,LEH01318
     C                   EXSR      GLINTC
     C/COPY WNCPYSRC,LEH01383
      *                                                                                       CAS005
     C     RDFC          IFEQ      'Y'
     C                   Z-ADD     ZINTR         WKAMNT           13 0
     C                   ELSE
     C                   Z-ADD(H)  ZINTR         WKAMNT
     C                   ENDIF
      *                                                                                       CAS005
     C                   ELSE
     C                   Z-ADD     *ZEROS        WKAMNT
     C                   ENDIF
      *                                                                                       CAS005
     C     ZIBEG         IFGT      ZIEND
     C     *IN48         OREQ      *ON
     C                   Z-ADD     *ZEROS        WKAMNT
     C                   ENDIF
      *                                                                                       CAS005
     C     *IN88         IFEQ      *ON
     C     WKAMNT        ADD       PDNN          WK13R
     C                   ELSE
     C     WKAMNT        ADD       AITN          WK13R
     C                   ENDIF
      *                                                                                       CAS005
     C     WK13R         ADD       AIAN          WK13R
      *                                                                                       CAS005
     C     IPRN          ADD       ICTN          WK13RA
     C     WK13RA        ADD       IWON          WK13RA
      *                                                                                       CAS005
     C     WK13RA        IFGT      WK13R
     C                   Z-ADD     WK13RA        WK13R
     C                   ENDIF
      *                                                                                       CAS005
     C     WK13R         SUB       AIPN          WK13R
      *                                                                                       CAS005
     C     AIPN          ADD       WK13R         AIPN
      *                                                                                       CAS005
     C                   ENDIF
     C*                                                                   CAC001
     C***********                                                         052512
2194 C***********                                                         052512
2195 C*****IF*DAILY ACCRUALS AND ACCRUAL DAY CALCULATE ANY ADJUSTMENT     052512
2196 C*****NEEDED DUE TO BACKVALUATIONS                                   052512
2197 C***********                                                         052512
2198 C***********APFQ      COMP 'D'                      89               052512
2199 C**N89******          GOTO RESET                                     052512
2200 C***********                                                         052512
2201 C***********AIPD      SUB  AIPDT     ACAMNT       8889               052512
2202 C***********          MOVE 'A'       AKY,3                           052512
2203 C***********          MOVEABKAKY     AKY,6                           052512
2204 C***********          MOVE 'I'       AKY,10                          052512
2205 C***45*88***          MOVE 'P'       AKY,10                          052512
2206 C***45*88***          Z-SUBACAMNT    ACAMNT                          052512
2207 C***45N88***          MOVE 'D'       AKY,10                          052512
2208 C***********          SETON                       6560               052512
2209 C**N89******          EXSR AKYOUT                                    052512
2210 C***********          SETOF                         60               052512
2211 C***********                                                         052512
2212 C***********          Z-ADDAIMNS     ACAMNT         89               052512
2213 C***********          SETON                         61               052512
2214 C**N89******          EXSR AKYOUT                                    052512
2215 C***********          SETOF                       6561               052512
     C                   SETOFF                                         6061                   05251
2216 C**
2217 C**   RESET YTD FIGURES IF 1ST RUN OF YEAR
2218 C**
2219 C     RESET         TAG                                                    **  RESET TAG *
2220 C**
2221 C  N41              GOTO      YTDADD
2222 C**
2223 C                   Z-ADD     0             YPLN
2224 C                   Z-ADD     0             YFLN
2225 C                   Z-ADD     0             YWLN
2226 C                   Z-ADD     0             ABLN
2227 C                   Z-ADD     0             YPLC
2228 C                   Z-ADD     0             YFLC
2229 C                   Z-ADD     0             YWLC
2230 C                   Z-ADD     0             ABLC
2231 C                   Z-ADD     0             WWLN
2232 C                   Z-ADD     0             IWLN
2233 C                   Z-ADD     0             PWLN
2234 C**
2235 C                   Z-ADD     IAEND         YILN
2236 C**
2237 C**   UPDATE YTD FIGURES WITH ADJUSTMENTS
2238 C**
2239 C     YTDADD        TAG                                                    ** YTDADD TAG *
2240 C**
2241 C     YPLN          ADD       YTDINP        YPLN
2242 C     YFLN          ADD       YTDFED        YFLN
2243 C     YWLN          ADD       YTDWTP        YWLN
2244 C     WWLN          ADD       YTDWTW        WWLN
2245 C     IWLN          ADD       YTDINW        IWLN
2246 C     PWLN          ADD       YTDPRW        PWLN
2247 C***********ABLN      ADD  AGBAL     ABLN                            131520
2248 C     OPAM          ADD       ORIGPR        OPAM
     C     *IN19         IFEQ      '0'                                                         14491
     C     PTYP          IFEQ      63                                                          S0139
     C     WROLD         ANDEQ     'Y'                                                         S0139
     C     PTYP          OREQ      65                                                          12209
     C     WROLD         ANDEQ     'Y'                                                         12209
     C     CLE004        ANDEQ     'Y'                                                         13897
     C     PTYP          OREQ      67                                                          12209
     C     WROLD         ANDEQ     'Y'                                                         12209
     C     CLE004        ANDEQ     'Y'                                                         13897
     C                   Z-ADD     EXCPAM        OPAM                                          S0139
     C                   Z-ADD     *ZEROS        NPRAM                                         S0139
     C                   Z-ADD     *ZEROS        NDAM                                          S0139
     C                   MOVE      *BLANK        ORVD                                          S0139
     C                   MOVE      *BLANK        THRN                                          S0139
     C**********           MOVE *BLANK    RDST                                       S01392 AR755951
     C                   Z-ADD     *ZEROS        RDST
     C                   MOVE      *BLANK        RLBR                                          S0139
     C                   MOVE      *BLANK        RRST                                          S0151
     C                   MOVE      *BLANK        RRON                                          S0151
     C                   MOVE      *BLANK        RRIB                                          S0151
     C                   MOVE      *BLANK        RRBA                                          S0151
     C                   MOVE      *BLANK        RROB                                          S0151
     C                   MOVE      *BLANK        RROC                                          S0151
     C                   END                                                                   S0139
     C                   ENDIF                                                                 14491
      *                                                                   144915
      ** Clear rollover settlement details for a multi-ccy rollover       144915
      *                                                                   144915
     C     CEU020        IFEQ      'Y'                                                         14491
     C     WMCYR         ANDEQ     'Y'                                                         14491
     C     *IN19         ANDEQ     '1'                                                         14491
     C                   CLEAR                   ROLPAY                                        14491
     C                   MOVE      RPSM          SDST                                          14491
     C                   MOVE      RPOS          OSDA                                          14491
     C                   MOVE      RPTS          TSTN                                          14491
     C                   MOVE      RPSB          OSDB                                          14491
     C                   MOVE      RFAO          FACOL                                         14491
     C                   MOVE      RDST          MDST                                          14491
     C                   MOVE      ORVD          OMDA                                          14491
     C                   MOVE      THRN          TMAN                                          14491
     C                   MOVE      RLBR          OMDB                                          14491
     C                   MOVE      *BLANKS       RLSB                                          14491
     C                   MOVE      *BLANKS       RPSM                                          14491
     C                   MOVE      *BLANKS       RPOS                                          14491
     C                   MOVE      *BLANKS       RPTS                                          14491
     C                   MOVE      *BLANKS       RPSB                                          14491
     C                   MOVE      *BLANKS       RFAO                                          14491
     C                   MOVE      *BLANKS       RRSC                                          14491
     C                   MOVE      *BLANKS       RPSC                                          14491
     C                   MOVE      *BLANKS       RICY                                          14491
     C                   MOVE      *BLANKS       THRN                                          14491
     C**********           MOVE *BLANKS   RDST                                       144915 AR755951
     C                   Z-ADD     *ZEROS        RDST
     C                   MOVE      *BLANKS       RLBR                                          14491
     C                   MOVE      *BLANKS       RRST                                          14491
     C                   MOVE      *BLANKS       RRON                                          14491
     C                   MOVE      *BLANKS       RRIB                                          14491
     C                   MOVE      *BLANKS       RRBA                                          14491
     C                   MOVE      *BLANKS       RROB                                          14491
     C                   MOVE      *BLANKS       RROC                                          14491
     C                   ENDIF                                                                 14491
      *                                                                                       CGL020
     C     CGL020        IFEQ      'Y'
     C                   MOVEL     STLNS4        STLNS3
     C                   ENDIF
2249 C**
2250 C**   CONVERT ADJUSTMENTS TO LOCAL CURRENCY
2251 C**
2252 C     DECLOC        SUB       DECLON        CX                1 0
2253 C     CX            ADD       4             CX
2254 C********** MDILON    COMP 0                        89               S01194
2254 C     MDILON        COMP      'D'                                    89                   S0119
2255 C**
2256 C   89SPTLON        DIV       POWR(CX)      EXRATE           15 9
2257 C   891             DIV(H)    EXRATE        EXRATE
2258 C**
2259 C  N89SPTLON        MULT(H)   POWR(CX)      EXRATE
2260 C**
2261 C     AGBAL         MULT(H)   EXRATE        AGBAL
2262 C     YTDINP        MULT(H)   EXRATE        YTDINP
2263 C     YTDFED        MULT(H)   EXRATE        YTDFED
2264 C     YTDWTP        MULT(H)   EXRATE        YTDWTP
2265 C**
2266 C     YPLC          ADD       YTDINP        YPLC
2267 C     YFLC          ADD       YTDFED        YFLC
2268 C     YWLC          ADD       YTDWTP        YWLC
2269 C*****ABLC*         ADD       AGBAL         ABLC                                       MD024248
     C*                                                                   S01408
     C** Core hook for externalisation.                                   S01408
     C/COPY WNCPYSRC,LE0450CBDU                                           S01408
     C*                                                                   S01408
2270 C**
2271 C**   CHECK IF NEED TO OUTPUT RECORD TO NCLON
2272 C**
2273 C     RECIL         COMP      'D'                                    62
     C/COPY WNCPYSRC,LE0450C008
     C**IF*THE*LOAN*IS*A*RISK*LOAN*(PTYP*=*70)*THE*PRINCIPAL*OF*THE       042529              183896
     C*********LOAN*CAN*BE*GREATER*THAN*ZERO*AT*MATURITY**                042529              183896
      ***Same*condition*for*a*risk*parts*purchased*(ptyp*=*71)**          CLE005              183896
     C********** PTYP      IFEQ 70                                        042529              183896
     C********** PDIN      ANDEQ0                                         042529              183896
     C********** MDAT      ANDLERUND                                      042529              183896
     C********** CLE005    OREQ 'Y'                                       CLE005              183896
     C********** PTYP      ANDEQ71                                        CLE005              183896
     C********** PDIN      ANDEQ0                                         CLE005              183896
     C********** MDAT      ANDLERUND                                      CLE005              183896
     C********** CLE005    OREQ 'Y'                                       138350              183896
     C********** PTYP      ANDEQ72                                        138350              183896
     C********** PDIN      ANDEQ0                                         138350              183896
     C********** MDAT      ANDLERUND                                      138350              183896
     C**********           MOVE 'Y'       AUTOL                           042529              183896
     C**********           END                                            042529              183896
     C**********                                                          042529              183896
     C*                                                                                       191069
     C     AUTOL         IFEQ      'N'
     C     PDIN          ANDEQ     *ZEROS
     C     CPAM          ANDEQ     *ZEROS
     C     MDAT          ANDLE     RUND
     C                   MOVE      'Y'           AUTOL
     C                   ENDIF
      *                                                                                       191069
     C/COPY WNCPYSRC,LE0450C009
2274 C     RECIL         COMP      'M'                                    89
     C   89
     CANN42
2275 CANN43              SETON                                            62    OUTPUT TO NCLON
     C   89
2276 CAN 42
     COR 89
2277 CAN 43              SETON                                            63    OUTPUT TO MATLN
      *                                                                                      264060A
     C     DSPDST        IFEQ      *BLANKS                                                   264060A
     C     *IN63         ANDEQ     *ON                                                       264060A
     C     RECIL         ANDEQ     'M'                                                       264060A
     C     AUTOX         IFEQ      'C'                                                       264060A
     C     AUTOL         OREQ      'C'                                                       264060A
     C                   MOVEL     LTYP          LTYP1A            1                         264060A
     C     LTYP1A        IFNE      'X'                                                       264060A
     C     LTYP1A        ANDNE     'Y'                                                       264060A
     C     LTYP1A        ANDNE     'Z'                                                       264060A
     C                   MOVE      *OFF          *IN27                                       264060A
     C     LNRF          SETLL     LEPDUEL2                                                  264060A
      *                                                                                      264060A
     C     *IN27         DOWEQ     *OFF                                                      264060A
     C     DSPDST        ANDEQ     *BLANKS                                                   264060A
      *                                                                                      264060A
     C     LNRF          READE     LEPDUEL2                               27                 264060A
      *                                                                                      264060A
     C     *IN27         IFEQ      *OFF                                                      264060A
     C     YPLON         CHAIN     LELOANLZ                           24                     264060A
     C     *IN24         IFEQ      *OFF                                                      264060A
     C     XCPAM         IFNE      *ZERO                                                     264060A
     C     XRECI         OREQ      'D'                                                       264060A
     C                   MOVEL     '*LIVE'       DSPDST                                      264060A
     C                   ENDIF                                                               264060A
     C                   ENDIF                                                               264060A
      *                                                                                      264060A
     C                   ENDIF                                                               264060A
      *                                                                                      264060A
     C                   ENDDO                                                               264060A
     C                   ENDIF                                                               264060A
     C                   ENDIF                                                               264060A
     C                   ENDIF                                                               264060A
      *                                                                                      264060A
      *                                                                   CLE005
      ** For CLE005, allow matured records to stay an extra month         CLE005
      ** in the live loans file before dropping them                      CLE005
      *                                                                   CLE005
     C     CLE005        IFEQ      'Y'                                                         CLE00
     C     RECIL         ANDEQ     'M'                                                         CLE00
     C     *IN63         ANDEQ     '1'                                                         CLE00
      ***********                                                   147744169210
     C*COP**WN*PYSRC*LE0450C002************************************ 147744169210
      ***********                                                   147744169210
      *                                                                   169210
     C/COPY WNCPYSRC,LE0450CABK                                           169210
      *                                                                   169210
     C                   Z-ADD     MDAT          ZDAYNO                                        CLE00
     C                   EXSR      ZDATE2                                                      CLE00
     C                   MOVE      ZDATE         WWDATE                                        CLE00
     C     *IN98         IFEQ      '1'                                                         CLE00
     C                   MOVE      WWDAY         WMDAT             2 0                         CLE00
     C                   ELSE                                                                  CLE00
     C                   MOVE      WWMTHN        WMDAT                                         CLE00
     C                   ENDIF                                                                 CLE00
      *                                                                   CLE005
     C                   Z-ADD     ORED          ZDAYNO                                        CLE00
     C                   EXSR      ZDATE2                                                      CLE00
     C                   MOVE      ZDATE         WWDATE                                        CLE00
     C     *IN98         IFEQ      '1'                                                         CLE00
     C                   MOVE      WWDAY         WORED             2 0                         CLE00
     C                   ELSE                                                                  CLE00
     C                   MOVE      WWMTHN        WORED                                         CLE00
     C                   ENDIF                                                                 CLE00
      *                                                                   CLE005
     C     WMDAT         IFEQ      WEVCD                                                       CLE00
     C     WORED         OREQ      WEVCD                                                       CLE00
      ***********                                                   147744169210
     C*COP**WN*PYSRC*LE0450C003************************************ 147744169210
      ***********                                                   147744169210
      *                                                                   169210
     C/COPY WNCPYSRC,LE0450CABL                                           169210
      *                                                                   169210
     C                   MOVEA     '10'          *IN(62)                                       CLE00
     C                   ENDIF                                                                 CLE00
     C                   ENDIF                                                                 CLE00
     C*
     C**   IF THERE ARE PARTS SOLD OUTSTANDING (IE PAST DUE) THEN THE
     C**   ORIGINAL LOAN MUST STAY ON FILE EVEN IF IT HAS MATURED
     C     NOPS          COMP      0                                  89        1
     C   89
     CAN 63              SETON                                        62
     C   89
     CAN 63              SETOFF                                       63
      *                                                                                       263411
      ** If Outstanding Past Due, Retain Original Loan.                                       263411
      *                                                                                       263411
     C     CLE134        IFEQ      'Y'                                                        263411
     C     DSPDST        IFEQ      '*LIVE'                                                    263411
     C     *IN63         ANDEQ     *ON                                                        263411
     C     NEWCOB        OREQ      'Y'                                                      AR760500
     C                   MOVE      *ON           *IN62                                        263411
     C                   MOVE      *OFF          *IN63                                        263411
     C                   MOVE      *BLANKS       DSPDST                                      264060A
     C                   ENDIF                                                               263411
     C                   ENDIF                                                               263411
     C*                                                                   0.
     C**   IF LOAN IS MATURING IN THIS RUN, AND SWIFT CUSTOMER LENDING IS E10007
     C**   INSTALLED, IT CANNOT BE DROPPED AS DETAILS MAY BE NECESSARY TO E10007
     C**   PRODUCE PAY/RECEIVE REPORTING IN SW0320.                       E10007
     C*                                                                   E10007
     C**********           TESTB'3'       SWIM           89SWIFT-LENE10007S01194
     C     BGSWCL        COMP      'Y'                                    89                   S0119
     C   89
     CAN 63
     CANN73              SETON                                        62                       E1000
     C   89
     CAN 63
     CANN73              SETOFF                                       63                       E1000
     C*                                                                   S01408
     C/COPY WNCPYSRC,LE0450CP13                                           S01408
     C*                                                                   S01408
     C*
     C** DO NOT ALLOW LOAN TO MATURE IF THERE ARE FEES OUTSTANDING        085677
     C     *IN63         IFEQ      '1'                                          B*1            08567
     C                   MOVEL     BRCA          @FBRCH                                        08567
     C**********           Z-ADDCNUML     @FCNUM                                       085677 CSD027
     C                   MOVE      CNUML         @FCNUM
     C                   Z-ADD     0             @FFACL                                        08567
     C**********         Z-ADD     LNRF          @FLOAN                                085677 CLE148
     C                   MOVEL     LNRF          @FLOAN                                       CLE148
     C                   Z-ADD     0             @FFSEQ                                        08567
     C     KEYFEE        SETLL     LEFEED                                                      08567
     C                   READ      LEFEED                                 63                   08567
     C     *IN63         IFEQ      '0'                                          B*2            08567
     C     FEBRCA        IFNE      BRCA                                         B*3            08567
     C     FECNUM        ORNE      CNUML                                                       08567
     C     FELOAN        ORNE      LNRF                                                        08567
     C                   MOVE      '1'           *IN63                                         08567
     C                   ELSE                                                                  08945
     C                   MOVE      '1'           *IN62                                         08945
     C                   ENDIF                                                  E*3            08567
     C                   ENDIF                                                  E*2            08567
     C                   ENDIF                                                  E*1            08567
      *                                                                                       CLE134
      ** check if the Loan is linked to a live original loan or live                          CLE134
      ** PDCL, if it is then the loan cannot mature                                           CLE134
      *                                                                                       CLE134
     C     CLE134        IFEQ      'Y'                                                        CLE134
     C     *IN63         ANDEQ     *ON                                                        CLE134
     C                   MOVE      *OFF          *IN27                                        CLE134
     C                   MOVE      *OFF          *IN24                                        CLE134
      *                                                                                       CLE134
      ** origial loan: check that there are no live PDCLs                                     CLE134
      *                                                                                       CLE134
     C     WORIGL        IFEQ      'Y'                                                        CLE134
     C     LNRF          SETLL     LEPDUEL2                                                   CLE134
     C     *IN27         DOWEQ     *OFF                                                       CLE134
      *                                                                                       CLE134
     C     LNRF          READE     LEPDUEL2                               27                  CLE134
     C     *IN27         IFEQ      *OFF                                                       CLE134
     C     YPLON         CHAIN     LELOANLZ                           24                      CLE134
     C     *IN24         IFEQ      *OFF                                                       CLE134
     C     XCPAM         ANDNE     *ZERO                                                      CLE134
     C                   MOVE      *OFF          *IN63                                        CLE134
     C                   MOVE      *ON           *IN62                                        CLE134
     C                   ENDIF                                                                CLE134
     C                   ENDIF                                                                CLE134
      *                                                                                       CLE134
     C                   ENDDO                                                                CLE134
     C                   ENDIF                                                                CLE134
      *                                                                                       CLE134
      ** PDCL loan: check that there is no live original Loan                                 CLE134
      *                                                                                       CLE134
     C     WPDCLL        IFEQ      'Y'                                                        CLE134
      *                                                                                       CLE134
      ** PDCL generated by a loan                                                             CLE134
      *                                                                                       CLE134
     C     LTYP1A        IFEQ      'X'                                                        CLE134
     C     LTYP1A        OREQ      'Y'                                                        CLE134
     C     LNRF          SETLL     LEPDUEL1                                                   CLE134
     C     *IN27         DOWEQ     *OFF                                                       CLE134
      *                                                                                       CLE134
     C     LNRF          READE     LEPDUEL1                               27                  CLE134
     C     *IN27         IFEQ      *OFF                                                       CLE134
     C     YPORG         CHAIN     LELOANLZ                           24                      CLE134
     C     *IN24         IFEQ      *OFF                                                       CLE134
     C     XCPAM         ANDNE     *ZERO                                                      CLE134
     C                   MOVE      *OFF          *IN63                                        CLE134
     C                   MOVE      *ON           *IN62                                        CLE134
     C                   ENDIF                                                                CLE134
     C                   ENDIF                                                                CLE134
     C                   ENDDO                                                                CLE134
      *                                                                                       CLE134
     C                   ENDIF                                                                CLE134
      *                                                                                       CLE134
      ** PDCL generated by a fee                                                              CLE134
      *                                                                                       CLE134
     C     LTYP1A        IFEQ      'Z'                                                        CLE134
     C     LNRF          SETLL     LEPDUFL1                                                   CLE134
     C     *IN27         DOWEQ     *OFF                                                       CLE134
      *                                                                                       CLE134
     C     LNRF          READE     LEPDUFL1                               27                  CLE134
     C     *IN27         IFEQ      *OFF                                                       CLE134
     C                   MOVE      YBRCA         @FBRCH                                       CLE134
     C                   MOVE      YECNUM        @FCNUM                                       CLE134
     C                   MOVE      YEFACL        @FFACL                                       CLE134
     C                   MOVE      YPORG         @FLOAN                                       CLE134
     C                   MOVE      YESEQ         @FFSEQ                                       CLE134
     C     KEYFEE        CHAIN     LEFEED                             24                      CLE134
     C     *IN24         IFEQ      *OFF                                                       CLE134
     C     FERECI        ANDEQ     'D'                                                        CLE134
     C     FEPEND        ANDGT     RDNB                                                       CLE134
     C                   MOVE      *OFF          *IN63                                        CLE134
     C                   MOVE      *ON           *IN62                                        CLE134
     C                   ENDIF                                                                CLE134
     C                   ENDIF                                                                CLE134
     C                   ENDDO                                                                CLE134
      *                                                                                       CLE134
     C                   ENDIF                                                                CLE134
      *                                                                                       CLE134
     C                   ENDIF                                                                CLE134
      **************************************************************                   CLE134 CLE164
      ***IF*Loan*maturing,*delete*record*from*LEACCNPD.*************                   CLE134 CLE164
      **************************************************************                   CLE134 CLE164
     C     *IN63         IFEQ      *ON                                                        CLE134
     C*****LNRF          READE     LEACCNL5                               27           CLE134 CLE164
     C******IN27         IFEQ      *OFF                                                CLE134 CLE164
     C**********         DELETE    LEACCND0                                            CLE134 CLE164
     C**********         ENDIF                                                         CLE134 CLE164
      *                                                                                       CLE134
      ** Delete Records from LEPDUEPD                                                         CLE134
      *                                                                                       CLE134
     C     LNRF          SETLL     LEPDUEL1                                                   CLE134
      *                                                                                       CLE134
     C     *IN27         DOWEQ     *OFF                                                       CLE134
     C     LNRF          READE     LEPDUEL1                               27                  CLE134
     C     *IN27         IFEQ      *OFF                                                       CLE134
     C                   DELETE    LEPDUED1                                                   CLE134
     C                   ENDIF                                                                CLE134
     C                   ENDDO                                                                CLE134
      *                                                                                       CLE134
      * Delete records from LepdufPD                                                          CLE134
     C     LNRF          SETLL     LEPDUFL1                                                   CLE134
      *                                                                                       CLE134
     C     *IN27         DOWEQ     *OFF                                                       CLE134
     C     LNRF          READE     LEPDUFL1                               27                  CLE134
     C     *IN27         IFEQ      *OFF                                                       CLE134
     C                   DELETE    LEPDUFD0                                                   CLE134
     C                   ENDIF                                                                CLE134
     C                   ENDDO                                                                CLE134
     C                   ENDIF                                                                CLE134
      *                                                                                       CLE134
     C                   ENDIF                                                                CLE134
      *                                                                                       CLE134
      *                                                                                       CLE034
      ** If CLE034 is installed                                                               CLE034
      *                                                                                       CLE034
     C     CLE034        IFEQ      'Y'
     C     STAL          ANDEQ     'Y'
     C     *IN62         IFEQ      *OFF
     C                   MOVEA     STAMP(1)      PTMSTP
     C                   MOVE      LNRF          PLNRF
     C     *IN63         IFEQ      *ON
     C                   CALL      'AOSTALU0'
     C                   PARM      *BLANKS       PRTCD
     C                   PARM      'LOAN'        PTYPE             4
     C                   PARM      'M'           PACTN             1
     C                   PARM                    PLNRF             6
     C                   PARM      *BLANKS       PLAVD             5
     C                   PARM      *BLANKS       PLASQ             3
     C                   PARM      *BLANKS       PCFEE             6
     C                   PARM      *BLANKS       PFFEE             5
     C                   PARM      *BLANKS       PFESQ             2
     C                   PARM                    PTMSTP           26
     C                   PARM      *BLANKS       PPCRF            15
      *                                                                                       CLE034
     C                   ELSE
      *                                                                                       CLE034
     C                   CALL      'AOSTALU0'
     C                   PARM      *BLANKS       PRTCD
     C                   PARM      'LOAN'        PTYPE
     C                   PARM      'D'           PACTN
     C                   PARM                    PLNRF
     C                   PARM      *BLANKS       PLAVD
     C                   PARM      *BLANKS       PLASQ
     C                   PARM      *BLANKS       PCFEE
     C                   PARM      *BLANKS       PFFEE
     C                   PARM      *BLANKS       PFESQ
     C                   PARM                    PTMSTP
     C                   PARM      *BLANKS       PPCRF
      *                                                                                       CLE034
     C                   ENDIF
     C                   ENDIF
     C                   ENDIF
     C/COPY WNCPYSRC,LE0450C068
2278 C**
2279 C**   CHECK FOR OUTPUT TO PARTS SOLD EXCEPTION REPORT
2280 C**
2281 C     CPAM          COMP      0                                    89
      *                                                                   180051
      ** If part sold amount is greater than current principal amount,    180051
      ** check whether there are any future-valued part sold or internal  180051
      ** part purchased against the loan.                                 180051
      *                                                                   180051
     C     PSAM          IFGT      CPAM                                                        18005
     C                   Z-ADD     PSAM          WPSAM            13 0                         18005
     C                   MOVE      '0'           *IN13                                         18005
     C                   MOVE      '1'           *IN14                                         18005
     C                   Z-ADD     0             WPPSAM                                        18005
      *                                                                                       244734
     C     *LIKE         DEFINE    SLTP          WKSLTP
     C     *LIKE         DEFINE    SLST          WKSLST
     C     *LIKE         DEFINE    SLCL          WKSLCL
     C                   MOVE      *BLANKS       WKSLTP
     C                   MOVE      *BLANKS       WKSLST
     C                   MOVE      *BLANKS       WKSLCL
     C     SLTP          IFNE      *BLANKS
     C     SLST          ANDNE     *BLANKS
     C     SLCL          ANDNE     *BLANKS
     C                   MOVE      SLTP          WKSLTP
     C                   MOVE      SLST          WKSLST
     C                   MOVE      SLCL          WKSLCL
     C                   ENDIF
     C     1             SETLL     CLOANCLF                                                    18005
     C                   READ      CLOANCLF                               13                   18005
      *                                                                   180051
     C     *IN13         DOWEQ     '0'                                                         18005
      *                                                                   180051
     C**********         MOVE      OLNOX         OLNOA                                 CSD027 CLE148
     C                   MOVE      *BLANKS       WLNRFX            6
     C                   MOVE      *BLANKS       WMLNRX            6
     C                   MOVE      *BLANKS       WOLNOX            6
     C                   MOVE      LNRF          WLNRFX
     C                   MOVE      MLNRX         WMLNRX
     C**********         MOVE      OLNON         WOLNOX                              AR814238 CLE148
     C                   MOVE      OLNOX         WOLNOX                                       CLE148
     C     RECIX         IFEQ      'D'                                                         18005
     C     WMLNRX        ANDEQ     WLNRFX
     C     RECIX         OREQ      'D'
     C     WOLNOX        ANDEQ     WLNRFX
     C********** MLNRX     ANDEQLNRF                                                 180051 AR814238
     C********** RECIX     OREQ 'D'                                                  180051 AR814238
     C********** OLNOX     ANDEQLNRF                                                   180051 CSD027
     C********** OLNON     ANDEQLNRF                                                 CSD027 AR814238
      *                                                                   180051
     C     VDATX         IFLE      RUND                                                        18005
     C                   ADD       CPAMX         WPPSAM           13 0                         18005
     C                   ENDIF                                                                 18005
      *                                                                   180051
     C                   ENDIF                                                                 18005
      *                                                                   180051
     C                   READ      CLOANCLF                               13                   18005
      *                                                                   180051
     C                   ENDDO                                                                 18005
      *                                                                   180051
     C                   MOVE      WKSLTP        SLTP
     C                   MOVE      WKSLST        SLST
     C                   MOVE      WKSLCL        SLCL
      *                                                                                       244734
     C                   Z-ADD     WPPSAM        PSAM                                          18005
      *                                                                   180051
     C                   ENDIF                                                                 18005
      *                                                                   180051
2282 C  N89PSAM          SUB       CPAM          DIFF             13 064
2283 C   89PSAM          SUB       CPAM          DIFF                   64
      *                                                                   180051
      ** restore original value of PSAM                                   180051
      *                                                                   180051
     C     *IN14         IFEQ      '1'                                                         18005
     C                   Z-ADD     WPSAM         PSAM                                          18005
     C                   MOVE      '0'           *IN14                                         18005
     C                   ENDIF                                                                 18005
      *                                                                   180051
      *                                                                   131520
     C     *IN62         IFEQ      '1'                                                         13152
     C                   EXSR      HIST                                                        13152
2250 C**   CONVERT TO LOCAL CURRENCY                                                        MD024248
2264 C     ABLN          MULT(H)   EXRATE        ABLC                                       MD024248
     C                   END                                                                   13152
      *                                                                   131520
2284 C**
2285 C**   CALCULATE HASH TOTALS OF OUTPUT FILES
2286 C**
     C/COPY WNCPYSRC,LE0450C006
2287 C  N62              GOTO      MTHASH
2288 C**
2289 C     NORNC         ADD       2             NORNC             5 0
2290 C     NORNL         ADD       2             NORNL
2291 C                   Z-ADD     VLBFN         ZZTOTI
2292 C                   Z-ADD     VLBLN         ZZTOTD
2293 C     CPAM          DIV       1000          ZZAMT                  89
2294 C   89              Z-SUB     ZZAMT         ZZAMT
2295 C                   EXSR      GLZADD
2296 C                   Z-ADD     ZZTOTI        VLBFN            15 0
2297 C                   Z-ADD     ZZTOTD        VLBLN             3 0
2298 C**
2299 C     MTHASH        TAG                                                    ** MTHASH TAG *
2300 C  N63              GOTO      PRTSRP
     C**
     C**  SAVE THE ORIGINAL LOAN NUMBER AND THE DATE BEING WRITTEN        BH1022
     C**  TO MLOAN                                                        BH1022
     C**********         MOVE      LNRF          OLNRF             6 0                 BH1022 CLE148
     C                   MOVE      LNRF          OLNRF             6                          CLE148
     C                   Z-ADD     RDNB          MLDAT             5 0                         BH102
     C*                                                                   S01408
     C/COPY WNCPYSRC,LE0450CP14                                           S01408
     C*                                                                   S01408
2301 C**
     C** IF LOAN ALREADY EXISTS ON HISTORY FILE, ADD 100000 TO            BCCI22
     C** THE LOAN NUMBER                                                  BCCI22
     C**                                                                  BHF976
     C     *LIKE         DEFINE    LNRF          LNRFO                                         BCCI2
     C**********         Z-ADD     LNRF          LNRFO                                 BCCI22 CLE148
     C                   MOVEL     LNRF          LNRFO                                        CLE148
     C                   MOVE      LNRF          LNRFA             6                           BCCI2
     C                   MOVEL     LNRFA         LNRF1             1                           BCCI2
     C     LNRFO         CHAIN     MLOAN                              18                       BHF97
     C********** *IN18     DOWEQ'0'                                                    BHF976 CLE148
     C********** LNRFO     IFGT 899999                                                 BHF976 CLE148
     C********** LNRFO     SUB  900000    LNRFO                                        BHF976 CLE148
     C**********           ELSE                                                        BCCI22 CLE148
     C********** LNRFO     ADD  100000    LNRFO                                        BHF976 CLE148
     C**********           END                                                         BCCI22 CLE148
     C********** LNRFO     CHAINMLOAN                18                                BHF976 CLE148
     C**********           END                                                         BCCI22 CLE148
     C     LNRFO         IFGT      '000000'                                                   CLE148
     C                   MOVE      LNRFO         WNUM06            6 0                        CLE148
     C     *IN18         DOWEQ     '0'                                                        CLE148
     C     WNUM06        IFGT      899999                                                     CLE148
     C     WNUM06        SUB       900000        WNUM06                                       CLE148
     C                   ELSE                                                                 CLE148
     C     WNUM06        ADD       100000        WNUM06                                       CLE148
     C                   ENDIF                                                                CLE148
     C                   MOVE      WNUM06        LNRFO                                        CLE148
     C     LNRFO         CHAIN     MLOAN                              18                      CLE148
     C                   ENDDO                                                                CLE148
     C                   ENDIF                                                                CLE148
2301 C**
2302 C     NORMT         ADD       1             NORMT
2303 C     AITC          ADD       AIAP          TOTINT           13 0
2304 C**
2305 C     PRTSRP        TAG                                                    ** PRTSRP TAG *
2306 C**
2307 C  N64              GOTO      LONBEN
2308 C**
2309 C     NORPRT        ADD       1             NORPRT            5 0
2310 C**
2311 C***********LONBEN    ENDSR                           ***  LONBEN ***S01486
2311 C     LONBEN        TAG                                                    ***  LONBEN ***S0148
     C*                                                                   S01486
     C     BGPFMG        IFEQ      'Y'                                                         S0148
     C     *IN63         IFEQ      '1'                                                         S0148
     C     PTFR          ANDNE     *BLANK                                                      S0148
     C                   EXSR      UPDTVF                                                      S0148
     C                   END                                                                   S0148
     C     *IN62         IFEQ      '0'                                                         12789
     C     PTFR          ANDNE     *BLANK                                                      12789
     C** IF PORTFOLIO REFERENCE NOT BLANK DELETE ALL HOLDINGS FOR THE     127891
     C** LOAN FROM LF/PMMFHLL1                                            127891
     C                   MOVE      CNUM          QFCNUM                                        12789
     C                   MOVE      'LE'          QFMODI                                        12789
     C                   MOVE      LNRF          QFTRNB                                        12789
     C                   MOVE      *LOVAL        QFTDSS                                        12789
     C                   MOVE      *LOVAL        QFTXT2                                        12789
     C                   MOVE      *LOVAL        QFPTFR                                        12789
     C*                                                                   127891
     C** SET FILE POINTER BEFORE FIRST RECORD FOR LOAN                    127891
     C     MFHLKY        SETLL     PMMFHLL1                                                    12789
     C     MFHLK1        READE     PMMFHLL1                               66                   12789
     C*                                                                   127891
     C     *IN66         DOWEQ     '0'                                                         12789
     C                   DELETE    PMHOLDP0                                                    12789
     C     MFHLK1        READE     PMMFHLL1                               66                   12789
     C                   END                                                                   12789
     C                   END                                                                   12789
      *                                                                   127891
     C                   END                                                                   S0148
     C/COPY WNCPYSRC,LEH00567
      *                                                                   CLE031
      ** CLE031 processing                                                CLE031
      *                                                                   CLE031
     C     CLE031        IFEQ      'Y'                                                         CLE03
      *                                                                   CLE031
     C     *IN22         IFEQ      *ON                                                         CLE03
     C                   Z-ADD     NFCE          WFEXR            13 8                         CLE03
     C                   MOVE      NFMD          WFMDIN            1                           CLE03
     C                   ELSE                                                                  CLE03
     C                   Z-ADD     FCXR          WFEXR                                         CLE03
     C                   MOVE      FMDI          WFMDIN                                        CLE03
     C                   ENDIF                                                                 CLE03
      *                                                                   CLE031
     C********** CPAM      IFNE CPAMSV                                                        CLE031
     C********** WFEXR     ORNE FCXRSV                                                        CLE031
      * If just the facility currency exchange rate has been changed,                         CLE031
     C     CPAM          IFEQ      CPAMSV
     C     WFEXR         ANDNE     FCXRSV
      * or just the principal amount has changed today e.g. RE or PI,                         CLE031
     C     CPAM          ORNE      CPAMSV
     C     SVFPAM        ANDNE     'Y'
      *                                                                   CLE031
     C                   Z-ADD     0             WFPAML           13 0                         CLE03
      *                                                                   CLE031
     C********** WFMDIN    IFEQ 'M'                                                           CLE031
     C********** FPAML     MULT WFEXR     WFPAML                                              CLE031
     C**********           ELSE                                                               CLE031
     C********** FPAML     DIV  WFEXR     WFPAML                                              CLE031
     C**********           ENDIF                                                              CLE031
      *                                                                                       CLE031
     C     WFMDIN        IFEQ      'M'
     C     CPAM          MULT      WFEXR         WFPAML
     C                   ELSE
     C     CPAM          DIV       WFEXR         WFPAML
     C                   ENDIF
      *                                                                   CLE031
     C                   Z-ADD     WFPAML        FPAML
      *                                                                                       CLE031
     C                   ENDIF                                                                 CLE03
      *                                                                   CLE031
     C**********           Z-ADDWFPAML    FPAML                                               CLE031
      *                                                                   CLE031
     C                   ENDIF                                                                 CLE03
      *                                                                   CLE031
     C                   MOVE      *BLANKS       WTRANS                                        CLE03
      *                                                                                       CLE028
      ** Reset early payment, start and maturity indicators                                   CLE028
      *                                                                                       CLE028
     C                   MOVE      *BLANK        WPASTD
     C                   MOVE      *BLANK        WEARLY
      *                                                                                       CLE031
      ** CLE031 processing                                                                    CLE031
      *                                                                                       CLE031
     C     CLE031        IFEQ      'Y'
      *                                                                                       CLE031
     C     *IN22         IFEQ      *ON
     C                   Z-ADD     NFCE          WFEXR            13 8
     C                   MOVE      NFMD          WFMDIN            1
     C                   ELSE
     C                   Z-ADD     FCXR          WFEXR
     C                   MOVE      FMDI          WFMDIN
     C                   ENDIF
      *                                                                                       CLE031
      * If just the facility currency exchange rate has been changed,                         CLE031
     C     CPAM          IFEQ      CPAMSV
     C     WFEXR         ANDNE     FCXRSV
      * or just the principal amount has changed today e.g. RE or PI,                         CLE031
     C     CPAM          ORNE      CPAMSV
     C     SVFPAM        ANDNE     'Y'
      *                                                                                       CLE031
     C                   Z-ADD     0             WFPAML           13 0
      *                                                                                       CLE031
      * Using the SETAMT subroutine as this takes account of the change                       CLE031
      * in decimal places that can occur                                                      CLE031
     C                   MOVE      CCYL          XCCY
     C                   EXSR      CCYDSP
     C                   Z-ADD     XDECP         W6NBDP            1 0
     C                   MOVE      FCCY          XCCY
     C                   EXSR      CCYDSP
     C                   MOVE      WFMDIN        WCYXIN
     C                   Z-ADD     WFEXR         WCYEXR
     C                   Z-ADD     CPAM          WKAMT            13 0
     C                   EXSR      SETAMT
     C                   Z-ADD     STAMT         WFPAML
      *                                                                                       CLE031
     C                   Z-ADD     WFPAML        FPAML
      *                                                                                       CLE031
     C                   ENDIF
      *                                                                                       CLE031
      *                                                                                       CLE031
     C                   ENDIF
      *                                                                                       CLE031
     C                   MOVE      *BLANKS       WTRANS
     C*                                                                   S01486
     C                   ENDSR                                                                 S0148
     C/COPY WNCPYSRC,LEH00568
2312 C**                                                                  S01486
     C********************************************************************S01486
      /EJECT                                                              S01486
     C********************************************************************S01486
     C**                                                                  S01486
     C** SUBROUTINE TO UPDATE PM CHANGES TO HISTORIC TURNOVER FILE -UPDTVFS01486
     C**                                                                  S01486
     C** CALLED FROM LOANB                                                S01486
     C** CALLS ZDATE2                                                     S01486
     C**                                                                  S01486
     C********************************************************************S01486
     C*                                                                   S01486
     C     UPDTVF        BEGSR                                                  **UPDTVF BSR **S0148
     C*                                                                   S01486
     C** CHAIN TO SDLOANPD WITH LOAN TYPE/SUBTYPE                         S01486
     C*                                                                   S01486
     C                   MOVE      LTYP          ATCD                                          S0148
     C                   MOVE      SUTP          AUCD                                          S0148
     C                   MOVE      CLAS          AUCL
     C*                                                                   S01486
     C                   CALL      'AOLOANR0'                                                  S0148
     C                   PARM      '*BLANKS'     @RTCD                                         S0148
     C                   PARM      '*KEY   '     @OPTN                                         S0148
     C                   PARM                    ATCD              2                        A  S0148
     C                   PARM                    AUCD              2                        A  S0148
     C                   PARM                    AUCL              4
     C     SDLOAN        PARM      SDLOAN        DSFDY                                      B  S0148
     C*                                                                   S01486
     C********** @RTCD     IFEQ *BLANK                              S01486082151
     C     @RTCD         IFNE      *BLANK                                                      08215
     C                   MOVEL     'SDLOANL0'    DBFILE                                        S0148
     C                   MOVEL     TAT6DS        DBKEY                                         S0148
     C                   Z-ADD     13            DBASE                                         S0148
     C                   SETON                                        U7U8LR                   S0148
     C                   GOTO      UPTVEN                                                      S0148
     C                   END                                                                   S0148
     C*                                                                   S01486
     C** CONVERT THE DEAL DATE TO DDMMYY OR MMDDYY FORMAT                 S01486
     C*                                                                   S01486
     C                   Z-ADD     DDAT          ZDAYNO                                        S0148
     C                   EXSR      ZDATE2                                                      S0148
     C                   MOVE      ZDATE         WWDATE                                        S0148
     C     *IN98         IFEQ      '1'                                                         S0148
     C                   MOVE      WWDAY         WWMTHN                                        S0148
     C                   END                                                                   S0148
     C*                                                                   S01486
     C** CHAIN TO SDPLINPD WITH INSTRUMENT TYPE TO GET DISPLAY GROUP      S01486
     C*                                                                   S01486
     C                   CALL      'AOPLINR0'                                                  S0148
     C                   PARM      '*MSG   '     @RTCD             7                           S0148
     C                   PARM      '*KEY   '     @OPTN             7                           S0148
     C                   PARM      AYINNR        @INNR             3                           S0148
     C     SDPLIN        PARM      SDPLIN        DSSDY                                         S0148
     C*                                                                   S01486
     C***********@RTCD     IFEQ *BLANK                              S01486082151
     C     @RTCD         IFNE      *BLANK                                                      08215
     C************LOCK     IN   LDA                                 S01486082149
     C                   MOVEL     'SDPLINPD'    DBFILE                                        S0148
     C                   MOVEL     AYINNR        DBKEY                                         S0148
     C                   Z-ADD     14            DBASE                                         S0148
     C                   SETON                                        U7U8LR                   S0148
     C***********          OUT  LDA                                 S01486082149
     C                   GOTO      UPTVEN                                                      S0148
     C                   END                                                                   S0148
     C*                                                                   S01486
     C** CHAIN TO PM CHANGES TO HISTORIC TURNOVER FILE                    S01486
     C** TO KNOW IF RECORD ALREADY EXISTS                                 S01486
     C*                                                                   S01486
     C                   MOVE      CNUM          SCCNUM                                        S0148
     C                   MOVEL     PTFR          SCPTFR                                        S0148
     C                   MOVEL     AYINNR        SCINNR                                        S0148
     C                   MOVEL     PDDSPG        SCDSPG                                        S0148
     C                   MOVEL     CCY           SCICCY                                        S0148
     C**********           Z-ADD0         SCLIND                                       S01486 CER020
     C                   MOVE      *BLANKS       SCLOIC
     C                   Z-ADD     WWYEAR        SCYRNO                                        S0148
     C                   Z-ADD     WWMTHN        SCMTHN                                        S0148
     C     CHTVKY        CHAIN     PMCHTVP0                           75                       S0148
     C*                                                                   S01486
     C** IF ALREADY EXISTS THEN UPDATE ELSE WRITE                         S01486
     C*                                                                   S01486
     C     *IN75         IFEQ      '0'                                                         S0148
     C*                                                                   S01486
     C     SCTNVR        ADD       CPAM          SCTNVR                                        S0148
     C                   UPDATE    PMCHTVP0                                                    S0148
     C*                                                                   S01486
     C                   ELSE                                                                  S0148
     C                   MOVEL     'D'           SCRECI                                        S0148
     C                   Z-ADD     CPAM          SCTNVR                                        S0148
     C                   Z-ADD     0             SCTNVF                                        S0148
     C                   Z-ADD     0             SCNUCO                                        S0148
     C                   WRITE     PMCHTVP0                             76                     S0148
     C     *IN76         IFEQ      '1'                                                         S0148
     C************LOCK     IN   LDA                                 S01486082149
     C                   MOVEL     'PMCHTVPD'    DBFILE                                        S0148
     C                   MOVEL     CHTVDS        DBKEY                                         S0148
     C                   Z-ADD     15            DBASE                                         S0148
     C                   SETON                                        U7U8LR                   S0148
     C***********          OUT  LDA                                 S01486082149
     C                   GOTO      UPTVEN                                                      S0148
     C                   END                                                                   S0148
     C*                                                                   S01486
     C                   END                                                                   S0148
     C*                                                                   S01486
     C     UPTVEN        ENDSR                                                  **UPDTVF ESR **S0148
     C*                                                                   S01486
     C*===================================================================S01486
     C/EJECT                                                              S01486
2312 C**
2313 C**
2314 C********************************************************************
2315 C********************************************************************
2316 C**
2317 C**   SUBROUTINE TO CALCULATE W/TAX PORTION OF AMOUNT - WTAX
2318 C**
2319 C**   CALLED FROM LOANB
2320 C**   CALLS NO OTHER SUBROUTINES
2321 C**
2322 C     WTAX          BEGSR                                                  ***  WTAX   ***
2323 C**
2324 C**   NET OR BLANK TAX
2325 C**
2326 C   49              GOTO      GRECTX
2327 C**
2328 C     100           SUB       WTRTL         WRK117           11 7
2329 C     WTRTL         DIV       WRK117        WRK117
2330 C     AMOUNT        MULT(H)   WRK117        AMOUNT
2331 C                   GOTO      WTAXEN
2332 C**
2333 C**   GROSS OR RECEIVABLE TAX
2334 C**
2335 C     GRECTX        TAG                                                    ** GRECTX TAG *
2336 C**
2337 C     WTRTL         DIV       100           WRK117
2338 C     AMOUNT        MULT(H)   WRK117        AMOUNT
2339 C**
2340 C     WTAXEN        ENDSR                                                  ***  WTAXEN ***
2341 C**
2342 C**
2343 C********************************************************************
2344 C********************************************************************
2345 C**
2346 C**   SR. TO SET UP AN ARRAY OF CURRENCIES AND AN ARRAY OF
2347 C**   DECIMAL PLACES AND SPOT RATES FOR THOSE CURRENCIES.
2348 C**
2349 C**   CALLED FROM FIRST
2350 C**   CALLS NO OTHER SUBROUTINES
2351 C**
2352 C     CCYARS        BEGSR                                                  *** CCYARS  ***
2353 C**
2354 C**   SET OFF ERROR INDICATOR
2355 C                   SETOFF                                       99
2356 C**
2357 C**   SET ARRAY INDEX TO ZERO.
2358 C                   Z-ADD     0             X                 3 0
2359 C**
      * Open SDCURRPD                                                                         CSC042
     C                   OPEN      SDCURRPD
      *                                                                                       CSC042
2360 C*****SET*UP*KEY*FOR*CURRENCY*TABLE.                                 S01194
2361 C**********           MOVEL'20      'XCYKEY 12                       S01194
2362 C**********           MOVE '    '    XCYKEY                          S01194
2363 C**
2364 C*****SET*LOWER*LIMIT*AND*READ*CURRENCY*TABLE*HEADER.                S01194
2365 C********** XCYKEY    SETLLTABLED                                    S01194
2366 C**
2367 C*    LOOP TO READ CURRENCY DETAIL RECORDS.                          S01194
2368 C     XLOOP         TAG                                                    ** XLOOP TAG **
2369 C**********           READ TABLED                   99               S01194
2369 C                   READ      SDCURRPD                               99                   S0119
2370 C**N99***** RECT      COMP 20                   9999                 S01194
2371 C**
2372 C**   END IF ALL CURRENCY RECORDS PROCESSED
2373 C   99              GOTO      XCAEND
2374 C**
2375 C**   IGNORE DELETED RECORDS AND NON-SUB-RECORD ONE.
2376 C********** RECI      COMP 'D'                  9797                 S01194
2377 C***97*****           GOTO XLOOP                                     S01194
2378 C********** SREC      COMP 1                    9797                 S01194
2379 C***97*****           GOTO XLOOP                                     S01194
2380 C**
2381 C**   INCREMENT ARRAY INDEX.
2382 C     X             ADD       1             X
2383 C**
2384 C**   MOVE DATA INTO ARRAYS.
2385 C                   MOVE      CCY           XCYA(X)
2386 C                   MOVE      CDP           XDPA(X)
2387 C                   MOVE      SPOT          XSPA(X)
2388 C                   MOVE      MDIN          XMDA(X)
     C                   MOVE      A6INCY        XINA(X)
2389 C**
2390 C**   CHECK FOR FULL ARRAY.96 ON IF FULL.
2391 C     X             COMP      150                                    96
2392 C**
2393 C**   GO TO READ NEXT RECORD.
2394 C  N96              GOTO      XLOOP
2395 C**
     C     XCAEND        TAG                                                    ** XCAEND **
      * Close SDCURRPD                                                                        CSC042
     C                   CLOSE     SDCURRPD
      *                                                                                       CSC042
2396 C********** XCAEND    ENDSR                           ** XCAEND **                       CSC042
     C                   ENDSR
2397 C**
2398 C********************************************************************
2399 C********************************************************************
2400 C**
2401 C**   SR. TO OBTAIN NO. OF DEC. PLACES AND SPOT RATE FOR A CURRENCY.
2402 C**
2403 C**   CALLED FROM FIRST,LOANA
2404 C**   CALLS NO OTHER SUBROUTINES
2405 C**
2406 C     CCYDSP        BEGSR                                                  *** CCYDSP  ***
2407 C**
2408 C**   BLANK CURRENCY CODE IS INVALID
2409 C     XCCY          COMP      '   '                                  99
2410 C   99              GOTO      XCDEND
2411 C**
2412 C**   SET ARRAY INDEX TO ONE
2413 C                   Z-ADD     1             X
2414 C**
2415 C**   INITIALIZE INPUT-OUTPUT FIELDS.
2416 C                   Z-ADD     0             XDECP             1 0
2417 C                   Z-ADD     0             XSPOT            13 8
2418 C**********           Z-ADD0         XMDIN   10                      S01194
2418 C                   MOVE      *BLANKS       XMDIN             1                           S0119
2419 C                   MOVE      XCCY          XCCY              3
     C                   MOVE      *BLANKS       XINCY             1
2420 C**
2421 C**   LOOK UP NO. OF DEC.PLACES AND SPOT RATE FOR CURRENCY.
2422 C**   99 SETON FOR INVALID CURRENCY.
2423 C     XCCY          LOOKUP    XCYA(X)                                95
2424 C   95              MOVE      XDPA(X)       XDECP
2425 C   95              MOVE      XSPA(X)       XSPOT
2426 C   95              MOVE      XMDA(X)       XMDIN
     C   95              MOVE      XINA(X)       XINCY
2427 C  N95              SETON                                        99
2428 C**
2429 C     XCDEND        ENDSR                                                  ** XCDEND **
2430 C**
2431 C********************************************************************
      ********************************************************************131520
2431 C********************************************************************                    CSC042
      *                                                                                       CSC042
      * ##CHKB - Subroutine to check the Branch in the arrays                                 CSC042
      *                                                                                       CSC042
     C     ##CHKB        BEGSR
      *                                                                                       CSC042
     C     *LIKE         DEFINE    A8BRCD        ##KB
      *                                                                                       CSC042
      * Set off the branch found indicator                                                    CSC042
     C                   MOVEL     *BLANK        ##FIC             1
      *                                                                                       CSC042
      * Save the state of indicator 30 so it can be reset at the end                          CSC042
      * of the SR as it may be used elsewhere in the code                                     CSC042
     C     *IN30         IFEQ      *ON
     C                   MOVEL     'Y'           #IN30             1
     C                   ELSE
     C                   MOVEL     'N'           #IN30
     C                   END
      *                                                                                       CSC042
     C                   SETOFF                                           30
      *                                                                                       CSC042
      * Restore the saved Value of B                                                          CSC042
     C                   Z-ADD     ##BSV         B
      *                                                                                       CSC042
     C* Check whether details for Branch already in array                                     CSC042
      *                                                                                       CSC042
      * Is this the same as the last LOKUP, if so we can bypass                               CSC042
      * the LOKUP                                                                             CSC042
      * Defend against B being 0                                                              CSC042
     C     B             IFEQ      0
     C                   Z-ADD     1             B
     C                   END
      *                                                                                       CSC042
      * If the branch being checked is the same then use these                                CSC042
      * details rather than doing a LOKUP                                                     CSC042
     C     ##KB          IFEQ      ##BR(B)
      * Found so seton 30                                                                     CSC042
     C                   SETON                                            30
     C                   ELSE
     C                   Z-ADD     1             B
     C     ##KB          LOOKUP    ##BR(B)                                30
     C                   END
      *                                                                                       CSC042
      * Save the last update to B                                                             CSC042
     C     *IN30         IFEQ      *ON
     C                   Z-ADD     B             ##BSV
      * Set the indicator to show the data was found                                          CSC042
     C                   MOVEL     'Y'           ##FIC
     C                   END
      *                                                                                       CSC042
      * Reset the state of indicator 30.                                                      CSC042
     C     #IN30         IFEQ      'Y'
     C                   MOVEL     *ON           *IN30
     C                   ELSE
     C                   MOVEL     *OFF          *IN30
     C                   END
      *                                                                                       CSC042
     C                   ENDSR
      ********************************************************************                    CSC042
      /EJECT                                                                                  CSC042
      ********************************************************************                    CSC042
      *                                                                                       CSC042
      * ##SETB - Sets up the SDBRCHPD fields used in the code from the                        CSC042
      * arrays                                                                                CSC042
      *                                                                                       CSC042
     C     ##SETB        BEGSR
      *                                                                                       CSC042
     C                   MOVEL     ##BR(B)       A8BRCD
     C                   MOVEL     ##BN(B)       BRNM
     C                   MOVEL     ##BL(B)       LOCC
     C*****                Z-ADD##BS,B    A8SYCU                                              CSC042
     C                   MOVE      ##BS(B)       A8SYCU
     C                   MOVEL     ##BM(B)       A8MQSM
      *                                                                                       CSC042
     C                   ENDSR
      *                                                                                       CSC042
      ********************************************************************                    CSC042
      /EJECT                                                                                  CSC042
      ********************************************************************                    CSC042
      *                                                                                       CSC042
      * ##ADDB - Adds the SDBRCHPD fields used in the code to the                             CSC042
      * arrays                                                                                CSC042
      *                                                                                       CSC042
     C     ##ADDB        BEGSR
      *                                                                                       CSC042
      * If there is still room in the array then add the details                              CSC042
     C     ##BNDX        IFLT      999
     C                   ADD       1             ##BNDX
     C                   Z-ADD     ##BNDX        B
     C                   MOVEL     A8BRCD        ##BR(B)
     C                   MOVEL     BRNM          ##BN(B)
     C                   MOVEL     LOCC          ##BL(B)
     C*****                Z-ADDA8SYCU    ##BS,B                                              CSC042
     C                   MOVE      A8SYCU        ##BS(B)
     C                   MOVEL     A8MQSM        ##BM(B)
     C                   END
      *                                                                                       CSC042
      * Update ##BSV  so next call to ##CHKB checks this latest adddition                     CSC042
      * to the array firss                                                                    CSC042
     C                   Z-ADD     B             ##BSV
      *                                                                                       CSC042
     C                   ENDSR
      ********************************************************************                    CSC042
      /EJECT                                                                                  CSC042
      ********************************************************************                    CSC042
      *                                                                   131520
      ** HIST Subroutine - Process recs read from HISTS/HISTR             131520
      *                                                                   131520
      ** Called by:  Main Processing                                      131520
      ** Calls:      ADDSUB                                               131520
      *                                                                   131520
      *****************************************************************   131520
      *                                                                   131520
     C     HIST          BEGSR                                                  ** HIST **     13152
      *                                                                   131520
     C                   Z-ADD     0             LAST                                          13152
     C                   Z-ADD     0             TOTAL                                         13152
     C                   Z-ADD     0             SUBTOT                                        13152
     C                   Z-ADD     0             PERIOD                                        13152
     C                   Z-ADD     0             TOTPRD                                        13152
     C                   Z-ADD     0             IN20              1 0                         13152
     C                   Z-ADD     0             IN21              1 0                         13152
      *                                                                   131520
     C     MDAT          IFLT      FIRY                                          B1            13152
     C     CPAM          ANDEQ     0                                                           13152
     C                   Z-ADD     0             ABLN                                          13152
     C                   ELSE                                                    X1            13152
      *                                                                   131520
     C                   Z-ADD     0             VDATH                                         13152
     C                   Z-ADD     0             PRSQ                                          13152
     C                   Z-ADD     0             LCDH                                         260891
     C                   Z-ADD     0             LASN                                          13152
      *                                                                   131520
     C     HKEY          SETLL     HISTSHMF                               37                   13152
     C                   READ      HISTR                                  37                   13152
      *                                                                   131520
     C     LOAN          IFEQ      LOANH                                         B2            13152
     C     *IN37         OREQ      '0'                                                         13152
      *                                                                   131520
     C                   Z-ADD     PRAMH         PRNCPL           13 0                         13152
      *                                                                   131520
      ** Calculate no. of days to aggregate.                              131520
      *                                                                   131520
     C     MDAT          IFLT      DNWD                                          B3            13152
     C     MDAT          ANDNE     0                                                           13152
     C                   Z-ADD     MDAT          CDAT              5 0                         13152
     C                   ELSE                                                    X3            13152
     C                   Z-ADD     DNWD          CDAT                                          13152
     C                   END                                                     E3            13152
      *                                                                   131520
     C     VDATL         IFLE      FIRY                                          B3            13152
     C     CDAT          SUB       FIRY          TOTPRD            5 0                         13152
     C                   ELSE                                                    X3            13152
     C     CDAT          SUB       VDATL         TOTPRD                                        13152
     C                   END                                                     E3            13152
      *                                                                   131520
     C                   READ      HISTR                                  38                   13152
      *                                                                   131520
     C     LOAN          IFEQ      LOANH                                         B3            13152
     C     *IN38         ANDNE     '1'                                                         13152
     C     AMTPH         IFEQ      'RO'                                          B4            13152
     C     HPTYP         ANDEQ     63                                                          13152
     C     PRAMQ         ANDNE     0                                                           13152
     C                   Z-ADD     PRAMQ         PRNCPL                                        13152
     C                   END                                                     E4            13152
     C     VDATH         IFGE      FIRY                                          B4            13152
     C     VDATL         ANDLE     FIRY                                                        13152
     C     VDATH         SUB       FIRY          PERIOD            5 0                         13152
     C     PERIOD        MULT      PRNCPL        TOTAL            13 0                         13152
     C                   Z-ADD     1             IN20                                          13152
     C                   ELSE                                                    X4            13152
     C     VDATH         IFGE      FIRY                                          B5            13152
     C     VDATL         ANDGT     FIRY                                                        13152
     C     VDATH         SUB       VDATL         PERIOD                                        13152
     C     PERIOD        MULT      PRNCPL        TOTAL                                         13152
     C                   Z-ADD     1             IN20                                          13152
     C                   END                                                     E5            13152
     C                   END                                                     E4            13152
     C                   Z-ADD     VDATH         LAST              5 0                         13152
     C                   ELSE                                                    X3            13152
     C     PRNCPL        MULT      TOTPRD        ABLN                                          13152
     C                   END                                                     E3            13152
     C     *IN38         IFEQ      '0'                                           B3            13152
     C                   EXSR      ADDSUB                                                      13152
     C                   END                                                     E3            13152
      *                                                                   131520
     C                   END                                                     E2            13152
     C                   END                                                     E1            13152
     C                   ENDSR                                                                 13152
      *                                                                   131520
      ****************************************************************    131520
      *                                                                   131520
      ** ADDSUB Subroutine - Add Subsequent Aggregates                    131520
      *                                                                   131520
      ** Called by:  HISTS                                                131520
      ** Calls:      *NONE                                                131520
      *                                                                   131520
      *****************************************************************   131520
      *                                                                   131520
     C     ADDSUB        BEGSR                                                  ** ADDSUB **   13152
      *                                                                   131520
     C     LOAN          DOWEQ     LOANH                                          B1           13152
     C     *IN38         ANDNE     '1'                                                         13152
     C     AMTPH         IFEQ      'PI'                                           B2           13152
     C     AMTPH         OREQ      'IN'                                                        13152
     C     INTC          ANDEQ     'Y'                                                         13152
     C     PRNCPL        ADD       PRAMH         PRNCPL                                        13152
     C                   END                                                      E2           13152
     C     AMTPH         IFEQ      'MR'                                           B2           13152
     C     AMTPH         OREQ      'RE'                                                        13152
     C     PRNCPL        SUB       PRAMH         PRNCPL                                        13152
     C                   END                                                      E2           13152
     C     AMTPH         IFEQ      'RO'                                           B2           13152
     C     HPTYP         ANDEQ     63                                                          13152
     C     PRAMQ         ANDNE     0                                                           13152
     C                   Z-ADD     PRAMQ         PRNCPL                                        13152
     C                   END                                                      E2           13152
      *                                                                   131520
     C     AMTPH         DOUEQ     'PI'                                           B2           13152
     C     AMTPH         OREQ      'MR'                                                        13152
     C     AMTPH         OREQ      'RE'                                                        13152
     C     AMTPH         OREQ      'IN'                                                        13152
     C     INTC          ANDEQ     'Y'                                                         13152
     C     AMTPH         OREQ      'RO'                                                        13152
     C     HPTYP         ANDEQ     63                                                          13152
     C     LOAN          ORNE      LOANH                                                       13152
     C     *IN38         OREQ      '1'                                                         13152
     C                   READ      HISTR                                  38                   13152
     C                   END                                                      E2           13152
      *                                                                   131520
     C     LOAN          IFEQ      LOANH                                          B2           13152
     C     *IN38         ANDEQ     '0'                                                         13152
     C     VDATH         IFGE      FIRY                                           B3           13152
     C     LAST          ANDLT     FIRY                                                        13152
     C                   Z-ADD     FIRY          LAST                                          13152
     C                   END                                                      E3           13152
     C     VDATH         SUB       LAST          PERIOD                                        13152
      *                                                                   131520
     C                   ELSE                                                     X2           13152
      *                                                                   131520
     C                   Z-ADD     LAST          VDATH                                         13152
      *                                                                   131520
     C     VDATH         IFLT      FIRY                                           B3           13152
     C                   Z-ADD     FIRY          LAST                                          13152
     C                   END                                                      E3           13152
      *                                                                   131520
     C     CDAT          SUB       LAST          PERIOD                                        13152
      *                                                                   131520
     C                   END                                                      E2           13152
      *                                                                   131520
     C     LAST          IFGE      FIRY                                           B2           13152
     C     VDATH         ORGE      FIRY                                                        13152
     C     LAST          ANDLT     FIRY                                                        13152
     C     LOAN          ORNE      LOANH                                                       13152
     C     *IN38         ORNE      '0'                                                         13152
     C     PERIOD        MULT      PRNCPL        SUBTOT           13 0                         13152
     C     TOTAL         ADD       SUBTOT        TOTAL                                         13152
     C                   Z-ADD     1             IN21                                          13152
     C                   END                                                      E2           13152
      *                                                                   131520
     C                   Z-ADD     VDATH         LAST              5 0                         13152
      *                                                                   131520
     C                   END                                                      E1           13152
      *                                                                   131520
     C     IN21          IFEQ      1                                                           13152
     C                   Z-ADD     TOTAL         ABLN                                          13152
     C                   END                                                                   13152
     C     IN20          IFEQ      1                                                           13152
     C     IN21          ANDEQ     0                                                           13152
     C     LAST          IFLT      FIRY                                                        13152
     C                   Z-ADD     FIRY          LAST                                          13152
     C                   END                                                                   13152
     C     CDAT          SUB       LAST          PERIOD                                        13152
     C     PERIOD        MULT      PRNCPL        SUBTOT           13 0                         13152
     C     TOTAL         ADD       SUBTOT        ABLN                                          13152
     C                   Z-ADD     1             IN21                                          13152
     C                   END                                                                   13152
     C     IN20          IFEQ      0                                                           13152
     C     IN21          ANDEQ     0                                                           13152
     C     PRNCPL        MULT      TOTPRD        ABLN                                          13152
     C                   END                                                                   13152
      *                                                                   131520
     C                   ENDSR                                                                 13152
      *                                                                   131520
     C********************************************************************131520
     C/COPY WNCPYSRC,LE0450C020
     C/SPACE 3                                                            S01195
     C********************************************************************S01195
     C**  SETLOC - A SUB-ROUTINE TO ACCESS THE NOSTRO FILE                S01195
     C*                                                                   S01195
     C*   SETLOC IS CALLED BY - FCLPDT, FEEPAY;                           S01195
     C*                                                                   S01195
     C***********                                                         S01195
     C     SETLOC        BEGSR                                                  ***  SETLOC ***S0119
      *                                                                   S01195
      ** INITIALIZE WORKING VARIABLE - SETTLEMENT BRANCH LOCATION         S01195
      *                                                                   S01195
     C     *LIKE         DEFINE    NRLC          W@STBL                                        S0119
     C                   MOVE      *BLANKS       W@STBL                                        S0119
     C                   Z-ADD     TYPE          TYPE              2 0                         S0119
     C**********           MOVELOURS      OURS   12                                    S01195 CGL029
     C                   MOVEL     OURS          OURS             18
      *                                                                                       CLE031
      ** If CLE031 is on then set up correct currency                                         CLE031
      *                                                                                       CLE031
     C     CLE031        IFEQ      'Y'
     C     PTYP          IFNE      66
     C     PTYP          ANDNE     67
     C     PTYP          ANDNE     69
     C     PTYP          ANDNE     72
     C                   MOVE      SCCYA         ZCCY
     C                   ELSE
     C                   MOVE      PSCYA         ZCCY
     C                   ENDIF
     C                   ENDIF
      *                                                                   S01195
      ** FOR TYPE 01,02,07,08 OR 12, SETTLEMENT LOCATION IS DETERMINED    S01195
      ** BY THE NOSTRO BRANCH.                                            S01195
      *                                                                   S01195
     C     TYPE          IFEQ      01                                           *B1            S0119
     C     TYPE          OREQ      02                                                          S0119
     C     TYPE          OREQ      07                                                          S0119
     C     TYPE          OREQ      08                                                          S0119
     C     TYPE          OREQ      12                                                          S0119
      *                                                                   S01195
     C                   MOVEL     OURS          @KEYE             2
     C                   CALL      'AONOSTR0'                                                  S0119
     C                   PARM      '*MSG   '     @RTCD             7                           S0119
     C                   PARM      '*KEY   '     @OPTN             7                           S0119
     C                   PARM      *BLANKS       @KEYA             6                           S0119
     C                   PARM      ZCCY          @KEYB             3                           S0119
     C**********           PARM *BLANKS   @KEYC   4                                    S01195 CGL029
     C                   PARM      *BLANKS       @KEYC            10
     C                   PARM      *BLANKS       @KEYD             2                           S0119
     C                   PARM                    @KEYE                                         S0119
     C                   PARM      *BLANKS       @KEYF             3                           S0119
     C                   PARM      *BLANKS       @KEYG            10                           S0119
     C                   PARM      *BLANKS       @KEYH             1                           S0119
     C     SDNOST        PARM      SDNOST        DSFDY                                         S0119
     C     @RTCD         IFEQ      *BLANKS                                                     S0119
      **                                                                  S01195
      *    MOVE THE LAST 3 CHARACTERS OF CUSTOMER SHORT CODE (WHICH       S01195
      *    IS THE LOCATION CODE) TO START LOCATION CODE FIELD             S01195
      **                                                                  S01195
     C                   MOVE      CSNM          DSCSNM                                        S0119
     C                   MOVE      NRLC          W@STBL                                        S0119
     C                   END                                                                   S0119
      *                                                                   S01195
     C                   END                                                    *E1            S0119
      *                                                                   S01195
     C     SETRTN        ENDSR                                                  *** SETRTN *** S0119
     C********************************************************************S01195
     C/SPACE 3                                                            S01195
      *****************************************************************                       CGL020
      *                                                               *                       CGL020
      *  SRAMPR - Determine AML Pay/Receive Instructions              *                       CGL020
      *                                                               *                       CGL020
      *****************************************************************                       CGL020
      *                                                                                       CGL020
     C     SRAMPR        BEGSR
      *                                                                                       CGL020
     C     OSAC          IFEQ      *BLANKS
     C                   MOVE      *BLANKS       F1RACT
     C                   MOVE      *BLANKS       F1RCTY
     C                   MOVE      *BLANKS       F1RBNK
     C                   MOVE      *BLANKS       F1RCDE
     C                   MOVE      *BLANKS       F1PACT
     C                   MOVE      *BLANKS       F1PCTY
     C                   MOVE      *BLANKS       F1PBNK
     C                   MOVE      *BLANKS       F1PCDE
     C                   MOVE      *BLANKS       F1DACT
     C                   MOVE      *BLANKS       F1DCTY
     C                   MOVE      *BLANKS       F1DBNK
      *                                                                                       CGL020
     C                   ELSE
      *                                                                                       CGL020
     C                   CALL      AMLPRI
     C                   PARM                    WWROCN
     C                   PARM                    WWROBN
     C                   PARM                    WWPOCN
     C                   PARM                    WWPOBN
     C                   PARM                    WWBENN
     C                   PARM                    WWBENA
     C                   PARM                    WWAWBN
     C                   PARM                    WWAWBA
     C                   PARM                    F1RACT           20
     C                   PARM                    F1RCTY            2
     C                   PARM                    F1RBNK           20
     C                   PARM                    F1RCDE           11
     C                   PARM                    F1PACT           20
     C                   PARM                    F1PCTY            2
     C                   PARM                    F1PBNK           20
     C                   PARM                    F1PCDE           11
     C                   PARM                    F1DACT           35
     C                   PARM                    F1DCTY            2
     C                   PARM                    F1DBNK           20
      *                                                                                       CGL020
     C                   ENDIF
      *                                                                                       CGL020
     C                   Z-ADD     MDAT          F1SDAT            5 0
      *                                                                                       CGL020
     C                   ENDSR
      *                                                                                       CGL020
      ********************************************************************                    CGL020
      /EJECT                                                                                  CGL020
3066 C********************************************************************
3067 C* SUBROUTINE TO ADD AN AMOUNT (ZZAMT) TO THE TOTAL (ZZTOTI,ZZTOTD)
3068 C*   IND '99' IS SET BY AN OVERFLOW ERROR
3069 C*
3070 CSR   GLZADD        BEGSR                                                  *** GLZADD ****
3071 C*
3072 CSR                 Z-ADD     ZZAMT         ZZAMT            15 3    91    -DEFINE ZZAMT
3073 CSR 91              GOTO      ZZAEND                                       AMT = 0.BYPASS
3074 C*
3075 C* SPLIT ZZAMT INTO INTEGER AND DECIMAL FIELDS
3076 CSR                 Z-ADD     ZZAMT         ZZAMTI           15 0          INTEGER FIELD
3077 CSR                 MOVE      ZZAMT         ZZAMTD            3 0          DECIMAL FIELD
3078 C* BOTH ZZAMTI AND ZZAMTD CONTAIN A 'SIGN' ZONE NOW
3079 C*
3080 CSR                 EXSR      GLZSUM
3081 CSR   ZZAEND        ENDSR                                                  ** ZZAEND TAG *
3082 C*
3083 C********************************************************************
3084 C********************************************************************
3085 C* SUBROUTINE TO CARRY OUT THE ADDITION FOR SUBROUTINES -
3086 C*                        GLZADD, GLZSUB, GLZCMP.
3087 C*          PARAMETERS PASSED -
3088 C*                     I/P ZZAMTI ZZAMTD
3089 C*                     O/P ZZTOTI ZZTOTD ZZNEGD IND 96 IND 99.
3090 C*
3091 CSR   GLZSUM        BEGSR                                                  *** GLZSUM ****
3092 C*
3093 CSR                 Z-ADD     ZZTOTI        ZZTOTI           15 0          DEFINE ZZTOTI
3094 CSR                 Z-ADD     ZZTOTD        ZZTOTD            3 0          DEFINE ZZTOTD
3095 CSR                 SETOFF                                       919293
3096 CSR                 SETOFF                                       949599
3097 C*
3098 C*    DETERMINE SIGN OF ZZAMTI & D,   92 IF NEG
3099 CSR   ZZAMTI        COMP      0                                    9293
3100 CSR 93ZZAMTD        COMP      0                                    9293
3101 CSR 93              GOTO      ZZSEND                                       ZERO BYPASS
3102 C*
3103 C*    DETERMINE SIGN OF ZZTOTI & D, 91 IF NEG.
3104 CSR   ZZTOTI        COMP      0                                    9193
3105 CSR 93ZZTOTD        COMP      0                                    9193
3106 C*
3107 C*    IF ZZTOTAL IS ZERO, RETURN ZZAMOUNT.
3108 CSR 93              Z-ADD     ZZAMTI        ZZTOTI
3109 CSR 93              Z-ADD     ZZAMTD        ZZTOTD
3110 CSR 93              GOTO      ZZSEND                                       ZERO BYPASS
3111 C*    IF SIGNS DIFFER BYPASS OVERFLOW CHECKS.
     CSR 91
3112 CANN92
     CORN91
3113 CAN 92              GOTO      ZZOFPS
3114 C*
3115 CSR   ZZAMTD        ADD       ZZTOTD        ZZWK2             4 0
3116 CSR   ZZWK2         COMP      999                                93        '93' = CARRY
3117 CSRN93ZZWK2         COMP      -999                                 93        INTO INTEGER.
3118 C*
     CSR 93
3119 CANN92ZZAMTI        ADD       1             ZZWK3            15 0          ADD 'CARRY' +VE
     CSR 93
3120 CAN 92ZZAMTI        SUB       1             ZZWK3                          SUB 'CARRY' -VE
3121 CSR 93ZZTOTI        ADD       ZZWK3         ZZWK3
3122 CSRN93ZZTOTI        ADD       ZZAMTI        ZZWK3
3123 C*
3124 C* IF THE MODULUS OF ZZWK3 IS LT MOD. ZZTOTI THEN O/F HAS OCCURED
3125 CSRN92ZZWK3         COMP      ZZTOTI                               99      -92 MEANS NOS.
3126 CSR 92ZZWK3         COMP      ZZTOTI                             99         NEGATIVE
3127 CSRN99              Z-ADD     ZZWK2         ZZTOTD
3128 CSRN99              Z-ADD     ZZWK3         ZZTOTI
3129 C*
3130 C* IF O/F ZEROIZE ZZAMT , IND '99' SET AND ZZTOT FIELDS LEFT INTACT.
3131 CSR 99              Z-ADD     0             ZZAMT            15 3
3132 CSR                 GOTO      ZZSEND
3133 C*
3134 C* THE 'SIGNS' ARE DIFFERENT
3135 CSR   ZZOFPS        TAG                                                    ** ZZOFPS TAG**
3136 C* IF ZZAMT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZTOT
3137 C*
3138 CSR 92              Z-SUB     ZZAMTI        ZZAMTI           15 0
3139 CSR 92              Z-SUB     ZZAMTD        ZZAMTD            3 0
3140 C*
3141 C* IF ZZTOT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZAMT.
3142 C*
3143 CSR 91              Z-SUB     ZZTOTI        ZZTOTI
3144 CSR 91              Z-SUB     ZZTOTD        ZZTOTD
3145 C* BOTH ZZAMT AND ZZTOT ARE NOW POSITIVE.
3146 C*
3147 CSR   ZZTOTI        COMP      ZZAMTI                             93  95
3148 CSR 95ZZTOTD        COMP      ZZAMTD                             93  95
3149 C*
3150 C* IF ZZTOT EQ. ZZAMT RETURN ZERO.
3151 CSR 95              Z-ADD     0             ZZTOTI
3152 CSR 95              Z-ADD     0             ZZTOTD
3153 CSR 95              GOTO      ZZSEND
3154 C*
3155 C* IF ZZTOT GT. ZZAMT.
3156 CSR 93ZZAMTD        COMP      ZZTOTD                             94
     CSR 93
3157 CAN 94ZZTOTI        SUB       1             ZZTOTI
     CSR 93
3158 CAN 94ZZTOTD        ADD       1000          ZZWK2
3159 CSR 93ZZTOTI        SUB       ZZAMTI        ZZTOTI
     CSR 93
3160 CAN 94ZZWK2         SUB       ZZAMTD        ZZTOTD
     CSR 93
3161 CANN94ZZTOTD        SUB       ZZAMTD        ZZTOTD
3162 C*
3163 C*
3164 C* IF ZZAMT GT. ZZTOT.
3165 CSRN93ZZTOTD        COMP      ZZAMTD                             94
     CSRN93
3166 CAN 94ZZAMTI        SUB       1             ZZWK3            15 0
     CSRN93
3167 CAN 94ZZAMTD        ADD       1000          ZZWK2
     CSRN93
3168 CAN 94ZZWK3         SUB       ZZTOTI        ZZTOTI
     CSRN93
3169 CANN94ZZAMTI        SUB       ZZTOTI        ZZTOTI
     CSRN93
3170 CAN 94ZZWK2         SUB       ZZTOTD        ZZTOTD
     CSRN93
3171 CANN94ZZAMTD        SUB       ZZTOTD        ZZTOTD
3172 C*
3173 C* REVERSE SIGN OF ZZTOT IF LARGER I/P FIELDS WERE NEGATIVE
3174 CSR                 SETOFF                                       94
     CSR 93
3175 CAN 91
     CORN93
3176 CAN 92              SETON                                        94
3177 CSR 94              Z-SUB     ZZTOTI        ZZTOTI
3178 CSR 94              Z-SUB     ZZTOTD        ZZTOTD
3179 C**
3180 C**   RESTORE SIGN OF ZZAMTI & ZZAMTD IF IT WAS REVERSED.
3181 CSR 92              Z-SUB     ZZAMTI        ZZAMTI
3182 CSR 92              Z-SUB     ZZAMTD        ZZAMTD
3183 CSR   ZZSEND        TAG                                                    ** ZZSEND TAG *
3184 C**
3185 C**   IF ZZTOTD IS ZERO, AND ZZTOTI IS NEG. SET UP ZZNEGD.
3186 CSR                 SETOFF                                       96
3187 CSR   ZZTOTD        COMP      0                                      91
3188 CSR 91ZZTOTI        COMP      0                                    96
3189 CSR 96              MOVE      '.000-'       ZZNEGD            5
3190 CSR                 ENDSR                                                    ** ENDSR **
3191 C********************************************************************
3192 C********************************************************************
3193 C**
3194 C*****ZSYSTM*SR**TO*CHAIN*TO*THE*INSTALLATION CONTROL DATA RECORD.   S01194
3195 C**********                                                          S01194
3196 C********** ZSYSTM    BEGSR                           *** ZSYSTM *** S01194
3197 C**********                                                          S01194
3198 C*****SET*UP*KEY*FOR*INSTALLATION*CONTROL*RECORD.                    S01194
3199 C**********           MOVEL'01      'ZTABKY 12                       S01194
3200 C**********           MOVE '  10'    ZTABKY                          S01194
3201 C**********                                                          S01194
3202 C********** ZTABKY    CHAINTABLE                99    ON NOT THERE   S01194
3203 C**N99***** RECI      COMP 'D'                  9999  ON, IS DELETED S01194
3204 C**********                                                          S01194
3205 C*****CHECK*SYSTEM*DATE*FORMAT,*DDMMYY*OR*MMDDYY.                    S01194
3206 C********** DATF      COMP 'M'                      98MMDDYY, 98 ON  S01194
3207 C**********                                                          S01194
3208 C**********           ENDSR                                          S01194
3209 C**
3210 C**
3211 C********************************************************************
     C/SPACE 3                                                            S01392
     C*****************************************************************   S01392
     C*                                                                   S01392
     C**  ROLDIS SR.  SUBROUTINE FOR ROLLOVER OF DISCOUNTED LOANS         S01392
     C**         UPDATE INTEREST DETAILS ETC. & GENERATE ACCOUNTING       S01392
     C**         ENTRIES.                                                 S01392
     C*                                                                   S01392
     C     ROLDIS        BEGSR                                                                 S0139
     C*                                                                   S01392
     C****COMPUTE*BACK*NEW*PRINCIPAL*AMOUNT*to*roll*over************S01392126030
     C************When*Rollover*action*is*output*(LE0390)***********S01392126030
     C***(DIFFP)**PRAM*****=*CPAM*-*NPRAM*====>*NPRAM*=*CPAM*-*PRAM*S01392126030
     C************INTA*****=*NDAM***********************************S01392126030
     C***(TOTROL)*TAMT*****=*NDAM*+*PRAM****************************S01392126030
     C*                                                                   S01392
     C** New principal amount is input on the Rollover screen = PRAM      126030
     C** New discount amount is input on the Rollover screen = INTA       126030
     C** Principal not rolled over = CPAM - PRAM                          126030
     C** Total settlement = CPAM - PRAM + INTA                            126030
     C*                                                                   126030
     C***********CPAM      SUB  PRAM      NPRAM                           126030
     C*                                                                   S01392
     C**  ALL ROLLOVER OF DISCOUNTED LOANS ARE TREATED AS                 S01392
     C**  AUTO-SETTLE IS SET TO 'Y'                                       S01392
     C*                                                                   S01392
     C**  ACCRUED DISCOUNT/PREMIUM NOT YET POSTED                         S01392
     C*                                                                   S01392
     C                   SETON                                        65                       S0139
     C     TOTI          ADD       AITCL         ACAMNT                                        S0139
     C     CAS009        IFEQ      'Y'
      *                                                                                       232348
      ** Only process EIR cost accounting if loan's value date is same                        232348
      ** as or or after the non-linear amortisation cut-off date                              232348
     C     VDAT          ANDGE     FSNLAC
      *                                                                                       232348
     C                   EXSR      SRRTVI
     C                   ENDIF
     C     CAS009        IFEQ      'Y'
     C     *IN45         ANDEQ     '1'
     C     FSAMRM        ANDEQ     'N'
     C     AYACAI        ANDEQ     'Y'
      *                                                                                       232348
      ** Only process EIR cost accounting if loan's value date is same                        232348
      ** as or after the non-linear amortisation cut-off date                                 232348
     C     VDAT          ANDGE     FSNLAC
      *                                                                                       CAS009
      ** Suppress Linear Amortisation for Discount Loans when                                 CAS009
      ** the Amortisation Method is 'N'on-Linear.                                             CAS009
      *                                                                                       CAS009
     C                   ELSE
     C     ACAMNT        SUB       AIPD          ACAMNT                 8889                   S0139
     C                   ENDIF
     C                   Z-ADD     ACAMNT        XACMT            13 0                         S0139
     C     CAS005        IFEQ      'Y'
     C     TOTN          ADD       AITNL         WACMNT
     C     WACMNT        SUB       AIPN          WACMNT
     C                   Z-ADD     WACMNT        XACMTN
     C                   ENDIF
     C                   Z-ADD     VDAT          ACDATE                                        S0139
     C                   MOVE      'A'           AKY(3)                                        S0139
     C                   MOVEA     BKAKY         AKY(6)                                        S0139
     C  N88              MOVE      'D'           AKY(10)                                       S0139
     C   88              MOVE      'P'           AKY(10)                        PREMIUM        S0139
     C   88              Z-SUB     ACAMNT        ACAMNT                                        S0139
      *                                                                                       CAS009
      ** If CAS009 is enabled, generate accrued discount/premium not yet posted               CAS009
      ** a/c keys only if the amortisation method is not 'N' (non-linear).                    CAS009
      *                                                                                       CAS009
     C     CAS009        IFEQ      'Y'
      *                                                                                       232348
      ** Only process EIR cost accounting if loan's value date is same                        232348
      ** as or after the non-linear amortisation cut-off date                                 232348
     C     VDAT          ANDGE     FSNLAC
      *                                                                                       232348
     C                   EXSR      SRRTVI
     C                   ENDIF
     C     CAS009        IFEQ      'Y'
     C     *IN45         ANDEQ     '1'
     C     FSAMRM        ANDEQ     'N'
     C     AYACAI        ANDEQ     'Y'
      *                                                                                       232348
      ** Only process EIR cost accounting if loan's value date is same                        232348
      ** as or after the non-linear amortisation cut-off date                                 232348
     C     VDAT          ANDGE     FSNLAC
     C                   ELSE
     C  N89              EXSR      AKYOUT                                                      S0139
     C                   ENDIF
      *                                                                                       CAS009
     C                   SETOFF                                       65                       S0139
     C*                                                                   S01392
     C**  SETTLEMENT AMOUNT IE. PRINCIPAL NOT ROLLED OVER &               S01392
     C**  NEW DISCOUNT.                                                   S01392
     C*                                                                   S01392
     C***********          Z-ADDTAMT      ACAMNT         89         S01392126030
     C     CPAM          SUB       PRAM          ACAMNT                                        12603
     C     ACAMNT        ADD       INTA          ACAMNT                   89                   12603
     C                   MOVE      'R'           AKY(3)                                        S0139
     C                   MOVE      'B'           AKY(10)                                       S0139
      *                                                                                       CLE034
      ** If CLE034 is installed                                                               CLE034
      *                                                                                       CLE034
     C     CLE034        IFEQ      'Y'
     C     STAL          ANDEQ     'Y'
     C     *IN89         ANDEQ     *OFF
     C                   MOVE      'E'           WTYPE
     C                   EXSR      SR34A
     C                   ELSE
     C                   MOVE      'Y'           WRKFLD
     C                   MOVE      '*EOF   '     PRTCD
     C                   ENDIF
      *                                                                                       CLE034
     C     WRKFLD        DOWEQ     'Y'
     C     PRTCD         OREQ      *BLANKS
     C     CLE034        IFEQ      'Y'
     C     STAL          ANDEQ     'Y'
     C                   EXSR      SR34B
     C                   EXSR      SETCCY
     C                   ELSE
      *                                                                                       CLE031
      ** If feature CLE031 is on and indicator 89 is off then                                 CLE031
      ** set work type to 'end' and goto SR/SETCCY                                            CLE031
      *                                                                                       CLE031
     C     CLE031        IFEQ      'Y'
     C     *IN89         ANDEQ     *OFF
     C                   MOVE      'E'           WTYPE
     C                   EXSR      SETCCY
     C                   ENDIF
     C                   ENDIF
      *                                                                                       CLE031
     C  N89              EXSR      AKYOUT                                                      S0139
      *                                                                                       CLE031
      ** If feature CLE031 is on and indicator 89 is off goto SR/SETRST                       CLE031
      *                                                                                       CLE031
     C     CLE031        IFEQ      'Y'
     C     *IN89         ANDEQ     *OFF
     C                   EXSR      SETRST
     C                   ENDIF
      *                                                                                       CLE034
     C     CLE034        IFEQ      'Y'
     C     STAL          ANDEQ     'Y'
     C                   EXSR      SR34C
     C                   ELSE
     C                   MOVE      *BLANKS       WRKFLD
     C                   ENDIF
     C                   ENDDO
      *                                                                                       CLE034
     C     CLE034        IFEQ      'Y'
     C     STAL          ANDEQ     'Y'
     C                   EXSR      SR34E
     C                   ENDIF
     C*                                                                   S01392
     C**  NEW DISCOUNT AMOUNT                                             S01392
     C*                                                                   S01392
     C                   Z-ADD     INTA          ACAMNT                   89                   S0139
     C                   MOVE      'N'           AKY(10)                                       S0139
     C  N89              EXSR      AKYOUT                                                      S0139
     C*                                                                   S01392
     C**  PRINCIPAL NOT ROLLED OVER                                       S01392
     C*                                                                   S01392
     C***********          Z-ADDPRAM      ACAMNT         89         S01392126030
     C     CPAM          SUB       PRAM          ACAMNT                   89                   12603
     C                   MOVE      'A'           AKY(10)                                       S0139
     C                   MOVE      MDST          SETP                                          S0139
     C                   MOVE      OMDA          OSAC                                          S0139
      *                                                                                       CGL020
     C     CGL020        IFEQ      'Y'
     C                   MOVEL     STLNS3        STLNS1
     C                   EXSR      SRAMPR
     C                   ENDIF
      *                                                                   CEU004
      ** If feature CEU004 is on, set currency field on LKEY1DP           CEU004
      ** If Settlement currency from the LOAN is not blank.               CEU004
      *                                                                   CEU004
     C     CEU004        IFEQ      'Y'                                          If Feature On  CEU00
      *                                                                   CEU004
     C     SCCYL         IFNE      *BLANKS                                       If SetCcy # BlCEU00
     C                   MOVE      SCCYL         LKSCCY                           Set Outpt CcyCEU00
     C                   ELSE                                                    Else
     C                   MOVE      *BLANKS       LKSCCY                          Clr Outpt Ccy
     C                   ENDIF                                                   End If        CEU00
      *                                                                   CEU004
     C                   ENDIF                                                  End If         CEU00
      *                                                                   CEU004
      ** If CLE034 is installed                                                               CLE034
      *                                                                                       CLE034
     C     CLE034        IFEQ      'Y'
     C     STAL          ANDEQ     'Y'
     C     *IN89         ANDEQ     *OFF
     C                   EXSR      SR34A
     C                   ELSE
     C                   MOVE      'Y'           WRKFLD
     C                   MOVE      '*EOF   '     PRTCD
     C                   ENDIF
      *                                                                                       CLE034
     C     WRKFLD        DOWEQ     'Y'
     C     PRTCD         OREQ      *BLANKS
     C     CLE034        IFEQ      'Y'
     C     STAL          ANDEQ     'Y'
     C                   EXSR      SR34B
     C                   EXSR      SETCCY
     C                   ELSE
      *                                                                   EU 004
      ** If feature CLE031 is on and indicator 89 is off goto SR/SECCY2                       CLE031
      *                                                                                       CLE031
     C     CLE031        IFEQ      'Y'
     C     *IN89         ANDEQ     *OFF
     C                   EXSR      SECCY2
     C                   ENDIF
     C                   ENDIF
      *                                                                                       CLE031
     C  N89              EXSR      AKYOUT                                                      S0139
      *                                                                                       CLE031
      ** If feature CLE031 is on and indicator 89 is off goto SR/SETTLE                       CLE031
      *                                                                                       CLE031
     C     CLE031        IFEQ      'Y'
     C     *IN89         ANDEQ     *OFF
     C                   EXSR      SETTLE
     C                   ENDIF
      *                                                                                       CLE034
     C     CLE034        IFEQ      'Y'
     C     STAL          ANDEQ     'Y'
     C                   EXSR      SR34C
     C                   ELSE
     C                   MOVE      *BLANKS       WRKFLD
     C                   ENDIF
     C                   ENDDO
      *                                                                                       CLE034
     C     CLE034        IFEQ      'Y'
     C     STAL          ANDEQ     'Y'
     C                   EXSR      SR34E
     C                   ENDIF
     C**                                                                  S01392
     C                   Z-ADD     CPAM          EXCPAM           13 0                         S0139
     C                   Z-ADD     RLDT          MDAT                                          S0139
     C***********          Z-ADDNPRAM     CPAM                      S01392126030
     C                   Z-ADD     PRAM          CPAM                                          12603
     C                   ADD       TOTI          IPRD                                          S0139
     C                   ADD       TOTI          AITCL                                         S0139
     C                   Z-ADD     AITCL         AITC                           ACC INT TO IACDS0139
     C     CAS009        IFEQ      'Y'
      *                                                                                       232348
      ** Only process EIR cost accounting if loan's value date is same                        232348
      ** as or after the non-linear amortisation cut-off date                                 232348
     C     VDAT          ANDGE     FSNLAC
      *                                                                                       232348
     C                   EXSR      SRRTVI
     C                   ENDIF
     C     CAS009        IFEQ      'Y'
     C     *IN45         ANDEQ     '1'
     C     FSAMRM        ANDEQ     'N'
     C     AYACAI        ANDEQ     'Y'
      *                                                                                       232348
      ** Only process EIR cost accounting if loan's value date is same                        232348
      ** as or after the non-linear amortisation cut-off date                                 232348
     C     VDAT          ANDGE     FSNLAC
      *                                                                                       CAS009
      ** Suppress Linear Amortisation for Discount Loans when                                 CAS009
      ** the Amortisation Method is 'N'on-Linear.                                             CAS009
      *                                                                                       CAS009
     C                   ELSE
     C                   ADD       XACMT         AIPD                           ACCR INT POSTEDS0139
     C                   ENDIF
     C                   Z-ADD     INTA          TOTI                           NEW DISCOUNT   S0139
     C     CAS005        IFEQ      'Y'
     C                   Z-ADD     FSPRAM        FSCPAM
     C                   ADD       TOTN          IPRN
     C                   ADD       TOTN          AITNL
     C                   Z-ADD     AITNL         AITN
     C                   ADD       XACMTN        AIPN
     C                   Z-ADD     INTN          TOTN
     C                   ENDIF
     C                   Z-ADD     ROLLDT        IACD                           INT ACCR DATE  S0139
     C                   Z-ADD     ROLLDT        SLID                           LAST INT DATE  S0139
     C                   BITOFF    '2'           CNFI                           CONF BIT       S0139
     C                   BITOFF    '4'           TLXI                           TELEX BIT      S0139
     C                   MOVE      'Y'           WROLD             1            ROLLOVER 63    S0139
     C*                                                                   S01392
     C                   ENDSR                                                                 S0139
     C*****************************************************************   S01392
      /EJECT                                                                                  CAS009
      *****************************************************************                       CAS009
     C     SRRTVI        BEGSR
      *                                                                                       CAS009
      ** CHAIN TO SDLOANPD WITH LOAN TYPE/SUBTYPE                                             CAS009
      *                                                                                       CAS009
     C                   MOVE      LTYP          ATCD
     C                   MOVE      SUTP          AUCD
     C                   MOVE      CLAS          AUCL
      *                                                                                       CAS009
     C                   CALL      'AOLOANR0'
     C                   PARM      '*BLANKS'     @RTCD
     C                   PARM      '*KEY   '     @OPTN
     C                   PARM                    ATCD
     C                   PARM                    AUCD
     C                   PARM                    AUCL
     C     SDLOAN        PARM      SDLOAN        DSFDY
      *                                                                                       CAS009
     C     @RTCD         IFNE      *BLANK
     C                   MOVEL     'AOLOANR0'    DBFILE
     C                   MOVEL     TAT6DS        DBKEY
     C*********************MOVELATCD      DBKEY                                        CAS009 CLE042
     C                   Z-ADD     103           DBASE
     C                   MOVE      *ON           *INU7
     C                   MOVE      *ON           *INU8
     C                   MOVE      *ON           *INLR
     C                   END
      *                                                                                       CAS009
     C                   ENDSR
      *****************************************************************                       CAS009
     C/EJECT                                                              CAC001
     C*****************************************************************   CAC001
     C*                                                               *   CAC001
     C*  Subroutine  :  SRCPAM                                        *   CAC001
     C*  Function    :  Calculate Posting Amount                      *   CAC001
     C*                                                               *   CAC001
     C*  Called by   :  INTRST - Process Interest Amounts.            *   CAC001
     C*  Calls       :                                                *   CAC001
     C*                                                               *   CAC001
     C*****************************************************************   CAC001
      *                                                                   CAC001
     C     SRCPAM        BEGSR                                                  ** SRCPAM **   CAC00
      *                                                                   CAC001
     C     COFD          ADD       CFCD          WK13N            13 0                         CAC00
     C                   ADD       FWOD          WK13N                                         CAC00
     C     ACDA          ADD       ACAP          WK13NA           13 0                         CAC00
      *                                                                   CAC001
      ** Subtract Accrued COF Posted to Date from the greater amount      CAC001
      *                                                                   CAC001
     C     WK13NA        IFGT      WK13N                                                       CAC00
     C                   Z-ADD     WK13NA        WK13N                                         CAC00
     C                   Z-ADD     FCTD          ACDATE                                        CAC00
     C                   ENDIF                                                                 CAC00
     C     WK13N         SUB       ACPD          WK13N                                         CAC00
      *                                                                   CAC001
     C                   Z-ADD     WK13N         ACAMNT                   89                   CAC00
      *                                                                   CAC001
     C     SRCPA9        ENDSR                                                  ** SRCPA9 **   CAC00
      *                                                                   CAC001
     C*****************************************************************   CAC001
      /EJECT                                                                                  CAS005
      *****************************************************************                       CAS005
      *                                                               *                       CAS005
      *  SRNETR - Calculate using Net Treasury Rate                   *                       CAS005
      *                                                               *                       CAS005
      *****************************************************************                       CAS005
      *                                                                                       CAS005
     C     SRNETR        BEGSR
      *                                                                                       CAS005
     C     IPRN          ADD       ICTN          WK13R            13 0
     C     WK13R         ADD       IWON          WK13R
     C     AITN          ADD       AIAN          WK13RA           13 0
      *                                                                                       CAS005
     C     WK13RA        IFGT      WK13R
     C                   Z-ADD     WK13RA        WK13R
     C                   ENDIF
      *                                                                                       CAS005
     C     WK13R         SUB       AIPN          WK13R
      *                                                                                       CAS005
     C                   ENDSR
      *****************************************************************                       CAS005
     C/SPACE 3                                                            S01117
     C********************************************************************S01117
     C*                                                                   S01117
     C** PRINT OUT NO DETAIL TO REPORT IN LE0450P1 & LE0450P2             S01117
     C*                                                                   S01117
     C     #ZZ           BEGSR                                                  *** #ZZ    *** S0111
     C**                                                                  S01117
     C                   OPEN      LE0450P1                                                    S0111
     C                   Z-ADD     *ZEROS        PAGE                                          S0111
     C                   Z-ADD     *ZEROS        PAGE1                                         S0111
     C                   Z-ADD     *ZEROS        PAGE2                                         S0111
     C                   MOVE      *BLANKS       BRCA                                          S0111
     C                   MOVE      *BLANKS       BRNM                                          S0111
     C                   MOVE      *BLANKS       WBRNM                                         15775
     C                   SETON                                        0708                     S0111
     C**                                                                  S01117
     C*    ENSURE REPORT SPOOL FILE RECORDED BY RCF                       S01117
     C**                                                                  S01117
     C                   Z-ADD     SFNUM1        ZSNUM1                                        S0111
     C                   OUT       LDA                                                         S0111
     C**                                                                  S01117
     C                   CALL      'ZSFILE'                                                    S0111
     C                   PARM                    SEQ                                           S0111
     C                   PARM      *BLANKS       SENTY                                         S0111
     C                   PARM                    SFILE1                                        S0111
     C                   PARM                    ZSNUM1                                        S0111
     C                   PARM                    ZSERR             1                           S0111
      *                                                                   S01117
      *                                                                   S01117
     C     *LOCK         IN        LDA                                                         S0111
     C     ZSERR         IFEQ      'Y'                                                         S0111
      **  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM       S01117
     C                   SETON                                        U7U8LR                   S0111
     C                   RETURN                                                                S0111
     C                   END                                                                   S0111
     C**                                                                  S01117
     C                   OPEN      LE0450P2                                                    S0111
     C**                                                                  S01117
     C*    ENSURE REPORT SPOOL FILE RECORDED BY RCF                       S01117
     C**                                                                  S01117
     C                   Z-ADD     SFNUM2        ZSNUM2                                        S0111
     C                   OUT       LDA                                                         S0111
     C**                                                                  S01117
     C                   CALL      'ZSFILE'                                                    S0111
     C                   PARM                    SEQ                                           S0111
     C                   PARM      *BLANKS       SENTY                                         S0111
     C                   PARM                    SFILE2                                        S0111
     C                   PARM                    ZSNUM2                                        S0111
     C                   PARM                    ZSERR             1                           S0111
      *                                                                   S01117
     C     *LOCK         IN        LDA                                                         S0111
     C     ZSERR         IFEQ      'Y'                                                         S0111
      **  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM       S01117
     C                   SETON                                        U7U8LR                   S0111
     C                   RETURN                                                                S0111
     C                   END                                                                   S0111
      *                                                                   S01117
     C                   SETON                                        09                       BHF65
     C                   EXCEPT    NODTL                                                       S0111
     C                   ENDSR                                                                 S0111
     C*                                                                   S01117
     C********************************************************************S01117
     C/SPACE 3                                                            S01117
     C********************************************************************S01117
     C*                                                                   S01117
     C*  *PSSR --- SUBROUTINE TO HANDLE ABNORMAL ERROR CONDITIONS         S01117
     C*                                                                   S01117
     C*  CALLED FROM: AFTER ABNORMAL OPERATION OCCURS                     S01117
     C*                                                                   S01117
     C*  CALLS: NOTHING                                                   S01117
     C*                                                                   S01117
     C********************************************************************S01117
     C*                                                                   S01117
     C     *PSSR         BEGSR                                                  ** *PSSR **    S0111
     C*                                                                   S01117
     C     @RUN          IFEQ      *BLANKS                                                     S0111
     C                   MOVE      'Y'           @RUN              1                           S0111
     C                   DUMP                                                                  S0111
     C                   END                                                                   S0111
     C                   ENDSR                                                  ** *PSSR **    S0111
     C*                                                                   S01117
     C********************************************************************S01117
     C/EJECT                                                              CPB001
      *****************************************************************   CPB001
      *                                                               *   CPB001
      *  REPLIC - Subroutine to set up Replication Indicator.         *   CPB001
      *                                                               *   CPB001
      *  Called by : ROLLOV                                           *   CPB001
      *              MATRTY                                           *   CPB001
      *                                                               *   CPB001
      *  Calls     : None                                             *   CPB001
      *                                                               *   CPB001
      *****************************************************************   CPB001
     C     REPLIC        BEGSR                                                  ** REPLIC SR **CPB00
      *                                                                   CPB001
      **  Access Customer Details by using Access Object,                 CPB001
      **  to retrieve Private Banking Customer Indicator.                 CPB001
     C                   MOVE      *BLANKS       @CUST                                         CPB00
     C                   MOVEL     CNUM          @CUST                                         CPB00
     C                   CALL      'AOCUSTR1'                                                  CPB00
     C                   PARM      '*MSG   '     @RTCD             7                           CPB00
     C                   PARM      '*KEY   '     @OPTN             7                           CPB00
     C                   PARM                    @CUST            10                           CPB00
     C                   PARM                    @KYST             7                           CPB00
     C     SDCUST        PARM      SDCUST        DSLDY                                         CPB00
      *                                                                   CPB001
      **  If Customer Details do not exist, handle Database Error.        CPB001
     C     @RTCD         IFEQ      *ON                                          Begin @RTCD    CPB00
     C                   MOVEL     'SDCUSTPD'    DBFILE                         ***************CPB00
     C                   Z-ADD     91            DBASE                          * DB ERROR 91 *CPB00
     C                   MOVEL     @CUST         DBKEY                          ***************CPB00
     C                   SETON                                        U7U8LR                   CPB00
     C                   EXSR      *PSSR                                                       CPB00
     C                   GOTO      ENDREP                                                      CPB00
      *                                                                   CPB001
     C                   ENDIF                                                  End *IN88      CPB00
      *                                                                   CPB001
      **  If Customer is a Private Banking Customer, set up               CPB001
      **  Replication Indicator.                                          CPB001
     C                   MOVE      *BLANK        REPI                                          CPB00
     C     BBPRBA        IFEQ      'Y'                                          Begin @RTCD    CPB00
     C                   MOVE      'Y'           REPI                                          CPB00
      *                                                                   CPB001
     C                   ENDIF                                                  End @RTCD      CPB00
      *                                                                   CPB001
     C     ENDREP        TAG                                                                   CPB00
      *                                                                   CPB001
     C                   ENDSR                                                                 CPB00
      *****************************************************************                       CLE028
      /EJECT                                                                                  CLE028
      *****************************************************************                       CLE028
      *                                                               *                       CLE028
      *  SRPCAL - Calculate interest via RULE78 for PTYP 80           *                       CLE028
      *                                                               *                       CLE028
      *****************************************************************                       CLE028
     C     SRPCAL        BEGSR
      *                                                                                       CLE028
     C**********           Z-ADDVDAT      W78VDT                                       CLE028 214980
     C                   Z-ADD     VDATL         W78VDT
     C                   Z-ADD     MDAT          W78MDT
     C                   Z-ADD     FLTI          W78FLT
     C                   MOVE      RFRQ          W78RPF
     C                   Z-ADD     RDYN          W78RPM
     C                   MOVE      RFRQ          W78RPF
     C                   Z-ADD     RDYN          W78RPM
     C                   Z-ADD     FRPD          W78FRD
     C                   MOVE      CCY           W78CCY
     C                   MOVE      *BLANKS       W78LCN
     C                   MOVE      'A'           W78ROA
     C                   Z-ADD     ZIBEG         W78BEG
     C                   Z-ADD     ZIEND         W78END
      *                                                                                       CLE028
     C                   EXSR      RULE78
      *                                                                                       CLE028
     C                   Z-ADD     W78INT        ZINTR
      *                                                                                       CLE028
     C                   ENDSR
      *****************************************************************                       CLE028
      /EJECT                                                                                  CLE028
      *****************************************************************   CPB001
     C/EJECT                                                                                  CLE031
      *****************************************************************                       CLE031
      *                                                               *                       CLE031
      *  SETCCY - Subroutine to set up settlement ccy and x-rate      *                       CLE031
      *                                                               *                       CLE031
      *  Called by : STDATE, PRININ,MATRTY,MROLL,REPSCD,MANREP,INTRST *                       CLE031
      *                                                               *                       CLE031
      *                                                               *                       CLE031
      *  Calls     : SETAMT                                           *                       CLE031
      *                                                               *                       CLE031
      *****************************************************************                       CLE031
     C     SETCCY        BEGSR                                                  ** SETCCY SR **
      *                                                                                       CLE031
      ** Call subroutine CCYDSP to use the currency arrays to reduce down                     CLE034
      ** processing times                                                                     CLE034
      *                                                                                       CLE034
     C                   IF        SETP = 14                                               AR1083003
     C                   EVAL      XCCY = YKCCY                                            AR1083003
     C                   ELSE                                                              AR1083003
     C                   MOVE      CCYL          XCCY
     C                   ENDIF                                                             AR1083003
      *                                                                                    AR1083003
     C                   EXSR      CCYDSP
      *                                                                                    AR1083003
     C                   IF        SETP = 14                                               AR1083003
     C                   EVAL      W6NBDP = XDECP                                          AR1083003
     C                   ENDIF                                                             AR1083003
      *                                                                                       CLE034
      ***Call*AOCURRR0*to*get*details*for*event*currency***************                CLE031 CLE034
      *****************************************************************                CLE031 CLE034
     C**********           CALL 'AOCURRR0'                                             CLE031 CLE034
     C**********           PARM '*BLANKS' @RTCD                                        CLE031 CLE034
     C**********           PARM '*KEY   ' @OPTN                                        CLE031 CLE034
     C**********           PARM           CCYL                                         CLE031 CLE034
     C********** SDCURR    PARM SDCURR    DSSDY                                        CLE031 CLE034
      *                                                                                       CLE031
     C********** @RTCD     IFNE *BLANKS                                                CLE031 CLE034
     C********** *LOCK     IN   LDA                                                    CLE031 CLE034
     C**********           MOVEL'LE0450  'DBPGM                                        CLE031 CLE034
     C**********           MOVE 'SDCURRPD'DBFILE           ************                CLE031 CLE034
     C**********           MOVE CCYL      DBKEY            * DBERR 30 *                CLE031 CLE034
     C**********           Z-ADD30        DBASE            ************                CLE031 CLE034
     C**********           OUT  LDA                                                    CLE031 CLE034
     C**********           EXSR *PSSR                                                  CLE031 CLE034
     C**********           ENDIF                                                       CLE031 CLE034
      *                                                                                       CLE031
     C                   MOVE      CCYL          WECCY             3
     C**********           MOVE A6INCY    WEINCY  1                                    CLE031 CLE034
     C**********           Z-ADDSPOT      WESPRT 138                                   CLE031 CLE034
     C**********           MOVE MDIN      WEMDIN  1                                    CLE031 CLE034
     C                   MOVE      XINCY         WEINCY            1
     C                   Z-ADD     XSPOT         WESPRT           13 8
     C                   MOVE      XMDIN         WEMDIN            1
     C                   MOVE      'Y'           WPROC             1
     C                   MOVE      *BLANKS       WCCY              3
     C**********           Z-ADDA6NBDP    W6NBDP  10                                   CLE031 CLE034
      *                                                                                       CLE031
      ** If work type is 'Start'                                                              CLE031
      *                                                                                       CLE031
     C     WTYPE         IFEQ      'S'
      *                                                                                       CLE031
      ** If loan or parts purchased(process type is not 66,67,69 or 72)                       CLE031
      *                                                                                       CLE031
     C     PTYP          IFNE      66
     C     PTYP          ANDNE     67
     C     PTYP          ANDNE     69
     C     PTYP          ANDNE     72
      *                                                                                       CLE031
     C     WTRANS        IFEQ      *BLANKS
     C                   MOVE      PSCYA         WCCY
     C                   Z-ADD     PEXRA         WCYEXR           13 8
     C                   MOVE      PEXIA         WCYXIN            1
     C                   ELSE
     C                   MOVE      PSCYL         WCCY
     C                   Z-ADD     PEXRL         WCYEXR
     C                   MOVE      PEXIL         WCYXIN
     C                   ENDIF
      *                                                                                       CLE031
     C                   ELSE
      *                                                                                       CLE031
      ** Else  (parts sold)                                                                   CLE031
      *                                                                                       CLE031
     C     WTRANS        IFEQ      *BLANKS
     C                   MOVE      SCCYA         WCCY
     C                   Z-ADD     REXRA         WCYEXR
     C                   MOVE      REXIA         WCYXIN
     C                   ELSE
     C                   MOVE      SCCYL         WCCY
     C                   Z-ADD     REXRL         WCYEXR
     C                   MOVE      REXIL         WCYXIN
     C                   ENDIF
      *                                                                                       CLE031
     C                   ENDIF
     C                   ENDIF
      *                                                                                       CLE031
      ** If work type is 'end'                                                                CLE031
      *                                                                                       CLE031
     C     WTYPE         IFEQ      'E'
      *                                                                                       CLE031
      ** If loan or parts purchased(process type is not 66,67,69 or 72)                       CLE031
      *                                                                                       CLE031
     C     PTYP          IFNE      66
     C     PTYP          ANDNE     67
     C     PTYP          ANDNE     69
     C     PTYP          ANDNE     72
      *                                                                                       CLE031
     C     WTRANS        IFEQ      *BLANKS
     C                   MOVE      SCCYA         WCCY
     C                   Z-ADD     REXRA         WCYEXR
     C                   MOVE      REXIA         WCYXIN
     C                   ELSE
     C                   MOVE      SCCYL         WCCY
     C                   Z-ADD     REXRL         WCYEXR
     C                   MOVE      REXIL         WCYXIN
     C                   ENDIF
      *                                                                                       CLE031
     C                   ELSE
      *                                                                                       CLE031
      ** Else (parts sold)                                                                    CLE031
      *                                                                                       CLE031
     C     WTRANS        IFEQ      *BLANKS
     C                   MOVE      PSCYA         WCCY
     C                   Z-ADD     PEXRA         WCYEXR
     C                   MOVE      PEXIA         WCYXIN
     C                   ELSE
     C                   MOVE      PSCYL         WCCY
     C                   Z-ADD     PEXRL         WCYEXR
     C                   MOVE      PEXIL         WCYXIN
     C                   ENDIF
      *                                                                                       CLE031
     C                   ENDIF
      *                                                                                       CLE031
     C                   ENDIF
      *                                                                                       CLE031
      ** Work currency is blanks                                                              CLE031
      ** or Settlement Method 09 and System Value = 'T'                                       218782
      *                                                                                       CLE031
     C     WCCY          IFEQ      *BLANKS
     C     CLE033        OREQ      'Y'
     C     SETP          ANDEQ     09
     C     SET09         ANDEQ     'T'
     C                   MOVE      'N'           WPROC
      *                                                                                       CLE031
     C                   ELSE
      *                                                                                       CLE031
      ***Call*AOCURRR0*to*get*details*of*work*currency*****************                CLE031 CLE034
      *                                                                                       CLE031
     C**********           CALL 'AOCURRR0'                                             CLE031 CLE034
     C**********           PARM '*BLANKS' @RTCD                                        CLE031 CLE034
     C**********           PARM '*KEY   ' @OPTN                                        CLE031 CLE034
     C**********           PARM           WCCY                                         CLE031 CLE034
     C********** SDCURR    PARM SDCURR    DSSDY                                        CLE031 CLE034
      *                                                                                       CLE031
     C********** @RTCD     IFNE *BLANKS                                                CLE031 CLE034
     C********** *LOCK     IN   LDA                                                    CLE031 CLE034
     C**********           MOVEL'LE0450  'DBPGM                                        CLE031 CLE034
     C**********           MOVE 'SDCURRPD'DBFILE           ************                CLE031 CLE034
     C**********           MOVE WCCY      DBKEY            * DBERR 31 *                CLE031 CLE034
     C**********           Z-ADD31        DBASE            ************                CLE031 CLE034
     C**********           OUT  LDA                                                    CLE031 CLE034
     C**********           EXSR *PSSR                                                  CLE031 CLE034
     C**********           ENDIF                                                       CLE031 CLE034
     C                   MOVE      XINCY         A6INCY
      *                                                                                       CLE031
      ** If 'In' ccy indicator for work ccy is 'Y' or the work ccy is                         CLE031
      ** equal to the EURO ccy and the 'In' ccy indicator for event ccy                       CLE031
      ** is 'Y' then set work process to 'N'.  Accounting for this will                       CLE031
      ** be done separately in LE0470 wjen posting ref is 2 for                               CLE031
      ** settlement and settlement ccy loan a/c keys file is not blank                        CLE031
      *                                                                                       CLE031
     C     A6INCY        IFEQ      'Y'
     C     WCCY          OREQ      BKEURO
     C     WEINCY        ANDEQ     'Y'
     C                   MOVE      'N'           WPROC
     C                   ENDIF
     C                   ENDIF
      *                                                                                       CLE031
     C     WPROC         IFEQ      'Y'
     C                   MOVE      CCYL          CCYLSV            3
     C                   MOVE      LKSCCY        LKSCSV            3
     C                   MOVE      WCCY          CCYL
     C                   MOVE      *BLANKS       LKSCCY
      *                                                                                       CLE038
      ** Check if Settlement Allocation by Percentage:                                        CLE038
      *                                                                                       CLE038
     C     WPYRCV        IFEQ      'P'
     C     STPYBA        ANDNE     'A'
     C     WPYRCV        OREQ      'R'
     C     STRCBA        ANDNE     'A'
     C     CLE038        OREQ      'N'                                                     AR1031359
     C     STAL          OREQ      'N'                                                      MD019872
     C                   Z-ADD     ACAMNT        WKAMT            13 0
     C                   EXSR      SETAMT
     C                   ELSE
      *                                                                                       CLE038
      ** Else, for Settlement Allocation by Amount, convert amounts                           CLE038
      ** in settlement currency back to transaction currency:                                 CLE038
      *                                                                                       CLE038
     C                   Z-ADD     ACAMNT        WKAMT
     C                   EXSR      SR38A
     C                   ENDIF
     C                   Z-ADD     STAMT         ACAMNT
     C                   MOVE      'S'           SIND
      *                                                                                       218782
     C                   ELSE
      ** If Settlement Method 09 and System Value = 'T'                                       218782
      ** blank out settlement ccy so LE0470 will not process it as EMU                        218782
     C     CLE033        IFEQ      'Y'
     C     SETP          ANDEQ     09
     C     SET09         ANDEQ     'T'
     C                   MOVE      LKSCCY        LKSCSV            3
     C                   MOVE      *BLANKS       LKSCCY
     C                   ENDIF
     C                   ENDIF
      *                                                                                       CLE031
     C                   ENDSR
      *****************************************************************                       CLE031
     C/EJECT                                                                                  CLE031
      *****************************************************************                       CLE031
      *                                                               *                       CLE031
      *  SECCY2 - Subroutine to set up ccy and amount of the a/c key  *                       CLE031
      *           to be the settlement currency and settle amount     *                       CLE031
      *                                                               *                       CLE031
      *  Called by : STDATE,MATRTY,MROLL,MANREP,REPSCD                *                       CLE031
      *                                                               *                       CLE031
      *                                                               *                       CLE031
      *  Calls     : SETAMT                                           *                       CLE031
      *                                                               *                       CLE031
      *****************************************************************                       CLE031
     C     SECCY2        BEGSR                                                  ** SECCY2 SR **
      *                                                                                       CLE031
     C     WPROC         IFEQ      'Y'
     C                   MOVE      CCYL          CCYLSV
     C                   MOVE      LKSCCY        LKSCSV
     C                   MOVE      WCCY          CCYL
     C                   MOVE      *BLANKS       LKSCCY
     C                   Z-ADD     ACAMNT        WKAMT
     C                   EXSR      SETAMT
     C                   Z-ADD     STAMT         ACAMNT
     C                   MOVE      'S'           SIND
      *                                                                                       218782
     C                   ELSE
      ** If Settlement Method 09 and System Value = 'T', blank out                            218782
      ** settlement ccy so LE0470 will not process it as EMU                                  218782
     C     CLE033        IFEQ      'Y'
     C     SETP          ANDEQ     09
     C     SET09         ANDEQ     'T'
     C                   MOVE      LKSCCY        LKSCSV            3
     C                   MOVE      *BLANKS       LKSCCY
     C                   ENDIF
     C                   ENDIF
      *                                                                                       CLE031
     C                   ENDSR
      *****************************************************************                       CLE031
     C/EJECT                                                                                  CLE031
      *****************************************************************                       CLE031
      *                                                               *                       CLE031
      *  SETRST - Subroutine to reset the currency and amount of the  *                       CLE031
      *           the account key.                                    *                       CLE031
      *                                                               *                       CLE031
      *  Called by : STDATE,MATRTY,MANREP,MROLL,REPSCD                *                       CLE031
      *                                                               *                       CLE031
      *                                                               *                       CLE031
      *  Calls     : None                                             *                       CLE031
      *                                                               *                       CLE031
      *****************************************************************                       CLE031
     C     SETRST        BEGSR                                                  ** SETRST SR **
      *                                                                                       CLE031
     C     WPROC         IFEQ      'Y'
     C                   MOVE      CCYLSV        CCYL
     C                   MOVE      LKSCSV        LKSCCY
     C                   Z-ADD     WKAMT         ACAMNT
     C                   MOVE      *BLANKS       SIND              1
     C                   MOVE      *BLANKS       OKEY             10
     C                   ELSE
      *                                                                                       218782
      ** If Settlement Method 09 and System Value = 'T'                                       218782
      ** restore settlement ccy.                                                              218782
     C     CLE033        IFEQ      'Y'
     C     SETP          ANDEQ     09
     C     SET09         ANDEQ     'T'
     C                   MOVE      LKSCSV        LKSCCY
     C                   ENDIF
     C                   ENDIF
      *                                                                                       CLE031
     C                   ENDSR
      *****************************************************************                       CLE031
     C/EJECT                                                                                  CLE031
      *****************************************************************                       CLE031
      *                                                               *                       CLE031
      *  SETAMT - Subroutine to work out the settlement amount in     *                       CLE031
      *           account currency.                                   *                       CLE031
      *                                                               *                       CLE031
      *  Called by : SETCCY,SECCY2                                    *                       CLE031
      *                                                               *                       CLE031
      *                                                               *                       CLE031
      *  Calls     : None                                             *                       CLE031
      *                                                               *                       CLE031
      *****************************************************************                       CLE031
     C     SETAMT        BEGSR                                                  ** SETAMT SR **
      *                                                                                       CLE031
      ** If the number of decimal places in the two currencies are                            CLE031
      ** not the same                                                                         CLE031
      *                                                                                       CLE031
     C********** A6NBDP    IFNE W6NBDP                                                 CLE031 CLE034
     C     XDECP         IFNE      W6NBDP
      *                                                                                       CLE031
      ** Subtract the number of decimal places in the 'from' ccy from                         CLE031
      ** the number of decimal places in the 'to' ccy                                         CLE031
      *                                                                                       CLE031
     C********** A6NBDP    SUB  W6NBDP    WKPWR   10                                   CLE031 CLE034
     C     XDECP         SUB       W6NBDP        WKPWR             1 0
     C     WKPWR         ADD       4             D                 1 0
      *                                                                                       CLE031
      ** If Power element (8,4) less than 1                                                   CLE031
      *                                                                                       CLE031
     C     POWER(D)      IFLT      1
      *                                                                                       CLE031
      ** Multiply Amount in 'from' ccy by element in power array                              CLE031
      *                                                                                       CLE031
     C     POWER(D)      MULT      WKAMT         WKA163           16 3
      *                                                                                       CLE031
      ** Set amount in 'to' ccy equal to amount in work field WKA163                          CLE031
      ** multiplied by the cross rate                                                         CLE031
      *                                                                                       CLE031
     C*****WCYXIN        IFEQ      'M'                                                     AR1031595
     C*****WKA163        MULT(H)   WCYEXR        STAMT            13 0                     AR1031595
     C**********         ELSE                                                              AR1031595
     C*****WKA163        DIV(H)    WCYEXR        STAMT                                     AR1031595
     C**********         ENDIF                                                             AR1031595
     C     WCYXIN        IFEQ      'D'                                                     AR1031595
     C     WKA163        DIV(H)    WCYEXR        STAMT            13 0                     AR1031595
     C                   ELSE                                                              AR1031595
     C     WKA163        MULT(H)   WCYEXR        STAMT                                     AR1031595
     C                   ENDIF                                                             AR1031595
     C                   ENDIF
      *                                                                                       CLE031
      ** If power element (8,4) is greater or equal to 1                                      CLE031
      *                                                                                       CLE031
     C     POWER(D)      IFGE      1
      *                                                                                       CLE031
      ** Multiply amount in 'from' ccy by element in power array                              CLE031
      *                                                                                       CLE031
     C     WKAMT         MULT      POWER(D)      WKAMTW           13 0
      *                                                                                       CLE031
     C     WCYXIN        IFEQ      'D'
     C     WKAMTW        DIV(H)    WCYEXR        STAMT
     C                   ELSE
     C     WKAMTW        MULT(H)   WCYEXR        STAMT
     C                   ENDIF
      *                                                                                       CLE031
     C                   ENDIF
      *                                                                                       CLE031
      ** Else the currencies have the same number of decimal places                           CLE031
      *                                                                                       CLE031
     C                   ELSE
      *                                                                                       CLE031
     C*****WCYXIN        IFEQ      'M'                                                     AR1031595
     C*****WKAMT         MULT(H)   WCYEXR        STAMT                                     AR1031595
     C**********         ELSE                                                              AR1031595
     C*****WKAMT         DIV(H)    WCYEXR        STAMT                                     AR1031595
     C**********         ENDIF                                                             AR1031595
     C     WCYXIN        IFEQ      'D'                                                     AR1031595
     C     WKAMT         DIV(H)    WCYEXR        STAMT                                     AR1031595
     C                   ELSE                                                              AR1031595
     C     WKAMT         MULT(H)   WCYEXR        STAMT                                     AR1031595
     C                   ENDIF                                                             AR1031595
      *                                                                                       CLE031
     C                   ENDIF
      *                                                                                       CLE031
     C                   ENDSR
      *****************************************************************                       CLE031
     C/EJECT                                                                                  CLE031
      *****************************************************************                       CLE031
      *                                                               *                       CLE031
      *  SETTLE - Subroutine to produce four new keys required for    *                       CLE031
      *           settling in a different currency                    *                       CLE031
      *                                                               *                       CLE031
      *  Called by : STDATE,PRININ,MATRTY,MANREP,MROLL,REPSCD,INTRST  *                       CLE031
      *                                                               *                       CLE031
      *                                                               *                       CLE031
      *  Calls     : AKYOUT                                           *                       CLE031
      *                                                               *                       CLE031
      *****************************************************************                       CLE031
     C     SETTLE        BEGSR                                                  ** SETTLE SR **
      *                                                                                       CLE031
     C                   MOVEA     AKY           AKYSV            10
      *                                                                                       CLE031
     C     WPROC         IFEQ      'Y'
      *                                                                                       CLE031
     C                   MOVEA     AKY           OKEY
     C                   MOVE      'S'           AKY(3)
     C                   MOVEA     '    '        AKY(6)
      *                                                                                       CLE031
     C     WTYPE         IFEQ      'S'
     C                   MOVE      WECCY         WPCCY             3
     C                   MOVE      WCCY          WSCCY             3
     C                   ELSE
     C                   MOVE      WCCY          WPCCY
     C                   MOVE      WECCY         WSCCY
     C                   ENDIF
      *                                                                                       CLE031
     C     WPNLTY        IFEQ      'P'
     C                   MOVE      'P'           AKY(8)
     C                   ENDIF
      *                                                                                       CLE031
     C     WINT          IFEQ      'I'
     C                   MOVE      'I'           AKY(8)
     C                   ENDIF
      *                                                                                       CLE031
      ** Format xxSyybbbFB or xxSyybbbBB key for amount in purchase ccy                       CLE031
      *                                                                                       CLE031
     C     WPCCY         IFEQ      BJCYCD
     C                   MOVEA     'BB'          AKY(9)
     C                   ELSE
     C                   MOVEA     'FB'          AKY(9)
      *                                                                                       CLE031
     C**********           MOVE OSAC      OSACSV 12                                    CLE031 CGL029
     C                   MOVE      OSAC          OSACSV
     C                   MOVE      SETP          SETPSV            2 0
     C                   MOVE      'Y'           SVFLD             1
      *                                                                                       CLE031
     C     PTYP          IFNE      66
     C     PTYP          ANDNE     67
     C     PTYP          ANDNE     69
     C     PTYP          ANDNE     72
     C                   MOVE      RONS          OSAC
     C                   MOVE      RSTM          SETP
     C                   ELSE
     C                   MOVE      PONS          OSAC
     C                   MOVE      PSTM          SETP
     C                   ENDIF
      *                                                                                       CLE031
     C                   ENDIF
      *                                                                                       CLE031
     C     WTYPE         IFEQ      'S'
     C                   Z-ADD     WKAMT         ACAMNT
     C                   ELSE
     C                   Z-ADD     STAMT         ACAMNT
     C                   ENDIF
      *                                                                                       CLE031
     C                   MOVE      WPCCY         CCYL
     C                   EXSR      AKYOUT
      *                                                                                       CLE031
     C     SVFLD         IFEQ      'Y'
     C                   MOVE      OSACSV        OSAC
     C                   MOVE      SETPSV        SETP
     C                   ENDIF
      *                                                                                       CLE031
      ** Format xxSyybbbFC or xxSyybbbBC key for amount in purchase ccy                       CLE031
      *                                                                                       CLE031
     C     WSCCY         IFEQ      BJCYCD
     C                   MOVEA     'BC'          AKY(9)
     C                   ELSE
     C                   MOVEA     'FC'          AKY(9)
     C                   ENDIF
      *                                                                                       CLE031
     C     WTYPE         IFEQ      'S'
     C                   Z-ADD     STAMT         ACAMNT
     C                   ELSE
     C                   Z-ADD     WKAMT         ACAMNT
     C                   ENDIF
      *                                                                                       CLE031
     C                   MOVE      WSCCY         CCYL
     C                   EXSR      AKYOUT
      *                                                                                       CLE031
     C     WECCY         IFEQ      BJCYCD
     C                   Z-ADD     WKAMT         BSAMT            13 0
     C                   ELSE
     C     WEMDIN        IFEQ      'M'
     C     WKAMT         MULT      WESPRT        BSAMT
     C                   ELSE
     C     WKAMT         DIV       WESPRT        BSAMT
     C                   ENDIF
     C                   ENDIF
      *                                                                                       CLE031
      ** Format xxSyycccbP key for Base Currency Equivalent of Spot Trade                     CLE031
      ** a/c in purchase currency                                                             CLE031
      *                                                                                       CLE031
     C                   MOVEA     ' P'          AKY(9)
     C                   MOVEA     WPCCY         AKY(6)
     C                   MOVE      BJCYCD        CCYL
     C                   Z-ADD     BSAMT         ACAMNT
     C                   EXSR      AKYOUT
      *                                                                                       CLE031
      ** Format xxsyybcccS key for Base Currency Equivalent of Spot Trade                     CLE031
      ** account in sale currency                                                             CLE031
      *                                                                                       CLE031
     C                   MOVEA     ' S'          AKY(9)
     C                   MOVEA     WSCCY         AKY(6)
     C                   EXSR      AKYOUT
      *                                                                                       CLE031
     C                   MOVEA     AKYSV         AKY
     C                   MOVE      CCYLSV        CCYL
     C                   MOVE      LKSCSV        LKSCCY
     C                   Z-ADD     WKAMT         ACAMNT
     C                   MOVE      *BLANKS       SIND
     C                   MOVE      *BLANKS       OKEY
      *                                                                                       CLE031
     C                   ENDIF
      *                                                                                       218782
      ** If Settlement Method 09 and System Value = 'T'                                       218782
      ** restore settlement ccy.                                                              218782
     C     CLE033        IFEQ      'Y'
     C     SETP          ANDEQ     09
     C     SET09         ANDEQ     'T'
     C     WPROC         ANDNE     'Y'
     C                   MOVE      LKSCSV        LKSCCY
     C                   ENDIF
     C                   ENDSR
      *****************************************************************                       CLE031
     C/EJECT                                                                                  CLE031
      *****************************************************************                       CLE031
      *                                                               *                       CLE031
      *  ROLDIF - Subroutine to work out the settlement amount in     *                       CLE031
      *           account currency.                                   *                       CLE031
      *                                                               *                       CLE031
      *  Called by : ROLLOV                                           *                       CLE031
      *                                                               *                       CLE031
      *                                                               *                       CLE031
      *  Calls     : SETCCY,AKYOUT,SETTLE,SETRST,SECCY2               *                       CLE031
      *                                                               *                       CLE031
      *****************************************************************                       CLE031
     C     ROLDIF        BEGSR                                                  ** ROLDIF SR **
      *                                                                                       CLE031
     C                   MOVEA     AKY           AKYSV
      *                                                                                       CLE031
     C     PRAM          IFNE      CPAM
     C     FPAML         ANDNE     *ZERO
     C     PRAM          ANDNE     0
      *                                                                                       CLE031
      ** If principal amount is greater than current principal then                           CLE031
      ** do accounting for the difference and set up key xxVyybrsIA                           CLE031
      *                                                                                       CLE031
     C     PRAM          IFGT      CPAM
     C     PRAM          SUB       CPAM          WDIFF            13 0
      *                                                                                       CLE031
     C                   Z-ADD     WDIFF         ACAMNT
     C                   Z-ADD     VDAT          ACDATE
     C                   MOVE      'V'           AKY(3)
     C                   MOVEA     BKAKY         AKY(6)
     C                   MOVEA     'IA'          AKY(9)
     C                   MOVE      'R'           RIND
     C                   MOVE      'S'           WTYPE             1
      *                                                                                       CLE031
      ** If CLE034 is installed                                                               CLE034
      *                                                                                       CLE034
     C     CLE034        IFEQ      'Y'
     C     STAL          ANDEQ     'Y'
     C                   MOVE      *BLANK        WRKROL
     C                   MOVE      'Y'           WLONR
     C                   EXSR      SR34A
     C                   ELSE
     C                   MOVE      'Y'           WRKFLD
     C                   MOVE      '*EOF   '     PRTCD
     C                   ENDIF
      *                                                                                       CLE034
     C     WRKFLD        DOWEQ     'Y'
     C     PRTCD         OREQ      *BLANKS
     C     CLE034        IFEQ      'Y'
     C     STAL          ANDEQ     'Y'
     C                   EXSR      SR34B
     C                   ENDIF
      *                                                                                       CLE034
     C                   EXSR      SETCCY
     C                   EXSR      AKYOUT
     C                   EXSR      SETTLE
      *                                                                                       CLE034
     C     CLE034        IFEQ      'Y'
     C     STAL          ANDEQ     'Y'
     C                   EXSR      SR34C
     C                   ELSE
     C                   MOVE      *BLANKS       WRKFLD
     C                   ENDIF
     C                   ENDDO
      *                                                                                       CLE034
     C     CLE034        IFEQ      'Y'
     C     STAL          ANDEQ     'Y'
     C                   EXSR      SR34E
     C                   MOVE      *BLANKS       WLONR
     C                   MOVE      'R'           WRKROL
     C                   ENDIF
      *                                                                                       CLE031
     C     BGN0ST        IFEQ      'Y'
     C     FPRCL         ANDNE     *BLANKS
      *                                                                                       CLE031
      ** Format xxVyyTbbIA key for principal increase amount -                                CLE031
      ** Transaction Profit Centre                                                            CLE031
      *                                                                                       CLE031
     C                   MOVEA     'T  '         AKY(6)
     C                   EXSR      AKYOUT
      *                                                                                       CLE031
      ** Format xxVyyFbbIA key for principal increase amount -                                CLE031
      ** Funding Profit Centre                                                                CLE031
      *                                                                                       CLE031
     C                   MOVE      'F'           AKY(6)
     C                   MOVE      PRFC          WPRFC
     C                   MOVE      FPRCL         PRFC
     C                   EXSR      AKYOUT
     C                   MOVE      WPRFC         PRFC
     C                   MOVEA     BKAKY         AKY(6)
     C                   ENDIF
      *                                                                                       CLE031
      ** If guarantees issued is on,                                                          CLE031
      ** Format xxVyybbRIA key for principal increase amount                                  CLE031
      *                                                                                       CLE031
     C     *IN26         IFEQ      *ON
     C     WORECE        IFNE      *BLANKS
     C                   MOVE      ' '           AKY(7)
     C                   MOVE      'R'           AKY(8)
     C                   MOVE      CNUML         WORK2
     C                   MOVE      WORECE        CNUML
     C                   EXSR      AKYOUT
     C                   MOVE      WORK2         CNUML
     C                   MOVE      ' '           AKY(8)
     C                   ENDIF
     C                   ENDIF
      *                                                                                       CLE031
     C                   MOVE      *BLANKS       RIND              1
      *                                                                                       CLE031
     C                   ENDIF
      *                                                                                       CLE031
      ** If principal amount is less than current principal                                   CLE031
      ** Do repayment accounting for the difference                                           CLE031
      ** Format key for xxRyybdsbA key for principal amount                                   CLE031
      *                                                                                       CLE031
     C     PRAM          IFLT      CPAM
      *                                                                                       CLE031
     C     CPAM          SUB       PRAM          WDIFF
     C                   Z-ADD     WDIFF         ACAMNT
     C                   MOVE      VDAT          ACDATE
     C                   MOVE      'R'           AKY(3)
     C                   MOVEA     BKAKY         AKY(6)
     C                   MOVE      ' '           AKY(9)
     C                   MOVE      'A'           AKY(10)
     C                   MOVE      'R'           RIND
     C                   MOVE      'E'           WTYPE
      *                                                                                       CLE034
      ** If CLE034 is installed                                                               CLE034
      *                                                                                       CLE034
     C     CLE034        IFEQ      'Y'
     C     STAL          ANDEQ     'Y'
     C                   MOVE      *BLANK        WRKROL
     C                   MOVE      'Y'           WLONR
     C                   EXSR      SR34A
     C                   ELSE
     C                   MOVE      'Y'           WRKFLD
     C                   MOVE      '*EOF   '     PRTCD
     C                   ENDIF
      *                                                                                       CLE034
     C     WRKFLD        DOWEQ     'Y'
     C     PRTCD         OREQ      *BLANKS
     C     CLE034        IFEQ      'Y'
     C     STAL          ANDEQ     'Y'
     C                   EXSR      SR34B
     C                   ENDIF
      *                                                                                       CLE034
     C                   EXSR      SETCCY
     C                   EXSR      AKYOUT
     C                   EXSR      SETTLE
      *                                                                                       CLE034
     C     CLE034        IFEQ      'Y'
     C     STAL          ANDEQ     'Y'
     C                   EXSR      SR34C
     C                   ELSE
     C                   MOVE      *BLANKS       WRKFLD
     C                   ENDIF
     C                   ENDDO
      *                                                                                       CLE034
     C     CLE034        IFEQ      'Y'
     C     STAL          ANDEQ     'Y'
     C                   EXSR      SR34E
     C                   ENDIF
      *                                                                                       CLE034
     C                   EXSR      SETRST
      *                                                                                       CLE031
      ** If PCA is on and FPRCL is not equal to blanks                                        CLE031
      *                                                                                       CLE031
     C     BGN0ST        IFEQ      'Y'
     C     FPRCL         ANDNE     *BLANKS
      *                                                                                       CLE031
      ** Format xxRyyTbbbA key for principal repayment amount -                               CLE031
      ** Transaction Profit Centre                                                            CLE031
      *                                                                                       CLE031
     C                   MOVEA     'T  '         AKY(6)
     C                   EXSR      AKYOUT
      *                                                                                       CLE031
      ** Format xxRyyFbbbA key for principal repayment amount -                               CLE031
      ** Funding Profit Centre                                                                CLE031
      *                                                                                       CLE031
     C                   MOVE      'F'           AKY(6)
     C                   MOVE      PRFC          WPRFC
     C                   MOVE      FPRCL         PRFC
     C                   EXSR      AKYOUT
     C                   MOVE      WPRFC         PRFC
     C                   MOVE      BKAKY         AKY(6)
     C                   ENDIF
      *                                                                                       CLE031
      ** If guarantees issued is on                                                           CLE031
      ** Format xxRyybbRbA key for principal amount                                           CLE031
      *                                                                                       CLE031
     C     *IN26         IFEQ      *ON
     C     WORECE        IFNE      *BLANKS
     C                   MOVE      ' '           AKY(7)
     C                   MOVE      'R'           AKY(8)
     C                   MOVE      CNUML         WORK2
     C                   MOVE      WORECE        CNUML
     C                   EXSR      AKYOUT
     C                   MOVE      WORK2         CNUML
     C                   MOVE      ' '           AKY(8)
     C                   ENDIF
     C                   ENDIF
      *                                                                                       CLE031
      ** Format xxRyybrsbB key for settlement account                                         CLE031
      *                                                                                       CLE031
     C                   MOVE      BKAKY         AKY(6)
     C                   MOVE      ' '           AKY(9)
     C                   MOVE      'B'           AKY(10)
      *                                                                                       CLE034
      ** If CLE034 is installed                                                               CLE034
      *                                                                                       CLE034
     C     CLE034        IFEQ      'Y'
     C     STAL          ANDEQ     'Y'
     C                   EXSR      SR34A
     C                   ELSE
     C                   MOVE      'Y'           WRKFLD
     C                   MOVE      '*EOF   '     PRTCD
     C                   ENDIF
      *                                                                                       CLE034
     C     WRKFLD        DOWEQ     'Y'
     C     PRTCD         OREQ      *BLANKS
     C     CLE034        IFEQ      'Y'
     C     STAL          ANDEQ     'Y'
     C                   EXSR      SR34B
     C                   EXSR      SETCCY
     C                   ELSE
      *                                                                                       CLE034
     C                   EXSR      SECCY2
     C                   ENDIF
     C                   EXSR      AKYOUT
     C                   EXSR      SETRST
      *                                                                                       CLE034
     C     CLE034        IFEQ      'Y'
     C     STAL          ANDEQ     'Y'
     C                   EXSR      SR34C
     C                   ELSE
     C                   MOVE      *BLANKS       WRKFLD
     C                   ENDIF
     C                   ENDDO
      *                                                                                       CLE034
     C     CLE034        IFEQ      'Y'
     C     STAL          ANDEQ     'Y'
     C                   EXSR      SR34E
     C                   MOVE      'R'           WRKROL
     C                   MOVE      *BLANK        WLONR
     C                   ENDIF
      *                                                                                       CLE034
     C                   MOVE      *BLANKS       RIND
      *                                                                                       CLE031
     C                   ENDIF
      *                                                                                       CLE031
     C                   ENDIF
      *                                                                                       CLE031
     C                   MOVEA     AKYSV         AKY
      *                                                                                       CLE031
     C     PRAM          IFNE      CPAM
     C     PRAM          ANDNE     0
     C     NFCE          IFNE      0
     C                   MOVE      'Y'           SVFPAM            1            Keep FPAM same
     C                   ENDIF
     C                   Z-ADD     PRAM          CPAM
     C                   ENDIF
      *                                                                                       CLE031
     C                   ENDSR
      *****************************************************************                       CLE031
     C/EJECT                                                                                  CLE034
      *****************************************************************                       CLE034
      *                                                               *                       CLE034
      *  SR34A - Initial set up for CLE034 processing                 *                       CLE034
      *                                                               *                       CLE034
      *****************************************************************                       CLE034
     C     SR34A         BEGSR
     C                   Z-ADD     ACAMNT        WSVAMT           13 0
      *                                                                                       CLE034
     C     WTYPE         IFEQ      'S'
     C     PTYP          IFNE      66
     C     PTYP          ANDNE     67
     C     PTYP          ANDNE     69
     C     PTYP          ANDNE     72
     C                   MOVE      'P'           WPYRCV            1
     C                   ELSE
     C                   MOVE      'R'           WPYRCV
     C                   ENDIF
     C                   ELSE
     C     PTYP          IFNE      66
     C     PTYP          ANDNE     67
     C     PTYP          ANDNE     69
     C     PTYP          ANDNE     72
     C                   MOVE      'R'           WPYRCV
     C                   ELSE
     C                   MOVE      'P'           WPYRCV
     C                   ENDIF
     C                   ENDIF
      *                                                                                       CLE034
      ** Initialise variables                                                                 CLE034
      *                                                                                       CLE034
     C                   Z-ADD     0             WTOTA            13 0
     C                   Z-ADD     0             WRKAMT           13 0
     C                   MOVE      *BLANK        WRKFLD            1
     C                   Z-ADD     SETP          WSSETP            2 0
     C**********           MOVE OSAC      WSOSAC 12                                    CLE034 CGL029
     C                   MOVE      OSAC          WSOSAC           18
     C                   MOVE      OSBR          WSOSBR            3
     C                   Z-ADD     PSTM          WSPSTM            2 0
     C**********           MOVE PONS      WSPONS 12                                    CLE034 CGL029
     C                   MOVE      PONS          WSPONS           18
     C                   Z-ADD     RSTM          WSRSTM            2 0
     C                   MOVE      RONS          WSRONS           12
     C                   MOVE      FACO          WSFACO           10
     C                   MOVE      LKSCCY        WSLSCY            3
     C                   MOVE      SCCY          WSSCCY            3
     C                   MOVE      PSCY          WSPSCY            3
     C                   MOVE      PSCYA         WSPSCA            3
     C                   MOVE      SCCYA         WSCCYA            3
     C                   MOVE      PSCYL         WSPSCL            3
     C                   MOVE      SCCYL         WSCCYL            3
     C                   MOVE      PEXR          WSPEXR           13 8
     C                   MOVE      REXR          WSREXR           13 8
     C                   MOVE      PEXI          WSPEXI            1
     C                   MOVE      REXI          WSREXI            1
      *                                                                                       CLE034
     C     WRKROL        IFEQ      'R'
     C                   MOVE      LNRF          PLNRF
     C                   CALL      'AOSTALR2'
     C                   PARM      *BLANKS       PRTCD
     C                   PARM      '*FIRST '     POPTN
     C                   PARM      'ROLL'        PTYPE
     C                   PARM                    PLNRF
     C                   PARM      *BLANKS       PLAVD
     C                   PARM      *BLANKS       PLASQ
     C                   PARM      *BLANKS       PCFEE
     C                   PARM      *BLANKS       PFFEE
     C                   PARM      *BLANKS       PFESQ
     C                   PARM      WPYRCV        PPYRCV            1
     C***********LESTAL    PARM *BLANKS   DSSDY                                       CLE034 BUG9201
     C     LESTAL        PARM      *BLANKS       DSLDY
      *                                                                                       CLE034
     C                   ELSE
      *                                                                                       CLE034
     C     WLONR         IFEQ      *BLANKS
     C     AMTP          ANDNE     'RE'
     C     WLONR         OREQ      *BLANKS
     C     LASN          ANDNE     0
     C     LASN          ANDNE     999
     C                   MOVE      LNRF          PLNRF
     C                   MOVE      VDAT          PLAVD
     C                   MOVE      LASN          PLASQ
     C                   MOVEL     'LA'          PTYPE             4
     C                   MOVE      AMTP          PTYPE
     C                   CALL      'AOSTALR2'
     C                   PARM      *BLANKS       PRTCD
     C                   PARM      '*FIRST '     POPTN
     C                   PARM                    PTYPE
     C                   PARM                    PLNRF
     C                   PARM                    PLAVD
     C                   PARM                    PLASQ
     C                   PARM      *BLANKS       PCFEE
     C                   PARM      *BLANKS       PFFEE
     C                   PARM      *BLANKS       PFESQ
     C                   PARM      WPYRCV        PPYRCV            1
     C***********LESTAL    PARM *BLANKS   DSSDY                                       CLE034 BUG9201
     C     LESTAL        PARM      *BLANKS       DSLDY
      *                                                                                       CLE034
     C                   ELSE
      *                                                                                       CLE034
     C                   MOVE      LNRF          PLNRF
     C                   CALL      'AOSTALR2'
     C                   PARM      *BLANKS       PRTCD
     C                   PARM      '*FIRST '     POPTN
     C                   PARM      'LOAN'        PTYPE
     C                   PARM                    PLNRF
     C                   PARM      *BLANKS       PLAVD
     C                   PARM      *BLANKS       PLASQ
     C                   PARM      *BLANKS       PCFEE
     C                   PARM      *BLANKS       PFFEE
     C                   PARM      *BLANKS       PFESQ
     C                   PARM      WPYRCV        PPYRCV            1
     C***********LESTAL    PARM *BLANKS   DSSDY                                       CLE034 BUG9201
     C     LESTAL        PARM      *BLANKS       DSLDY
     C                   ENDIF
      *                                                                                       CLE034
     C                   ENDIF
      *                                                                                       CLE034
     C     PRTCD         IFNE      *BLANKS
     C                   MOVEL     'AOSTALR2'    DBPGM
     C                   MOVEL     'LESTALPD'    DBFILE
     C                   MOVE      *BLANKS       DBKEY
     C                   MOVEL     PTYPE         DBKEY
     C                   Z-ADD     32            DBASE
     C                   MOVE      *ON           *INU7
     C                   MOVE      *ON           *INLR
     C                   EXSR      *PSSR
     C                   ENDIF
      *                                                                                       CLE034
     C                   ENDSR
      *****************************************************************                       CLE034
     C/EJECT                                                                                  CLE034
      *****************************************************************                       CLE034
      *                                                               *                       CLE034
      *  SR34B - Processing to calculate amount for settlement        *                       CLE034
      *          allocation                                           *                       CLE034
      *                                                               *                       CLE034
      *****************************************************************                       CLE034
     C     SR34B         BEGSR
      *                                                                                       CLE038
      ** If Payment is allocated by Percentage:                                               CLE038
      *                                                                                       CLE038
     C     WPYRCV        IFEQ      'P'
     C     STPYBA        ANDNE     'A'
      *                                                                                       CLE038
      ** Or Receipt is allocated by Percentage:                                               CLE038
      *                                                                                       CLE038
     C     WPYRCV        OREQ      'R'
     C     STRCBA        ANDNE     'A'
      *                                                                                       CLE038
      *                                                                                       CLE034
     C     WPYRCV        IFEQ      'P'
     C     WSVAMT        MULT      PYPC          WRKAMT
     C                   DIV(H)    100           WRKAMT
     C                   ELSE
     C     WSVAMT        MULT      RCPC          WRKAMT
     C                   DIV(H)    100           WRKAMT
     C                   ENDIF
      *                                                                                       CLE034
     C     WTOTA         ADD       WRKAMT        WTOTA
      *                                                                                       CLE034
     C     WRKFLD        IFEQ      'Y'
     C     WTOTA         ANDNE     WSVAMT
     C     WSVAMT        SUB       WTOTA         WDIFF
     C                   ADD       WDIFF         WRKAMT
     C                   ENDIF
      *                                                                                       CLE034
     C                   Z-ADD     WRKAMT        ACAMNT
     C                   ELSE
      *                                                                                       CLE038
      ** Else, Allocation is by Amount:                                                       CLE038
      *                                                                                       CLE038
     C     WRKFLD        IFNE      'Y'
     C     WPYRCV        IFEQ      'P'
     C                   Z-ADD     STPYAM        WRKAMT
     C                   Z-ADD     STPYAM        ACAMNT
     C                   ELSE
     C                   Z-ADD     STRCAM        WRKAMT
     C                   Z-ADD     STRCAM        ACAMNT
     C                   ENDIF
     C                   ELSE
     C                   Z-ADD     0             WRKAMT
     C                   Z-ADD     0             ACAMNT
     C                   ENDIF
     C                   ENDIF
      *                                                                                       CLE038
     C     WRKAMT        IFEQ      0
     C                   MOVE      *ON           *IN89
     C                   ELSE
     C                   MOVE      *OFF          *IN89
     C                   ENDIF
      *                                                                                       CLE034
     C                   EXSR      SR34D
      *                                                                                       CLE034
     C                   ENDSR
      *****************************************************************                       CLE034
     C/EJECT                                                                                  CLE034
      *****************************************************************                       CLE034
      *                                                               *                       CLE034
      *  SR34C - Processing to get next settlement allocation         *                       CLE034
      *                                                               *                       CLE034
      *****************************************************************                       CLE034
     C     SR34C         BEGSR
      *                                                                                       CLE034
     C     WRKFLD        IFEQ      'Y'
     C                   MOVE      *BLANK        WRKFLD
     C                   ELSE
      *                                                                                       CLE034
     C     WRKROL        IFEQ      'R'
     C                   MOVE      LNRF          PLNRF
     C                   CALL      'AOSTALR2'
     C                   PARM      *BLANKS       PRTCD
     C                   PARM      '*NEXT  '     POPTN
     C                   PARM      'ROLL'        PTYPE
     C                   PARM                    PLNRF
     C                   PARM      *BLANKS       PLAVD
     C                   PARM      *BLANKS       PLASQ
     C                   PARM      *BLANKS       PCFEE
     C                   PARM      *BLANKS       PFFEE
     C                   PARM      *BLANKS       PFESQ
     C                   PARM      WPYRCV        PPYRCV
     C***********LESTAL    PARM *BLANKS   DSSDY                                       CLE034 BUG9201
     C     LESTAL        PARM      *BLANKS       DSLDY
      *                                                                                       CLE034
     C                   ELSE
      *                                                                                       CLE034
     C     WLONR         IFEQ      *BLANKS
     C     AMTP          ANDNE     'RE'
     C     WLONR         OREQ      *BLANKS
     C     LASN          ANDNE     0
     C     LASN          ANDNE     999
     C                   MOVE      LNRF          PLNRF
     C                   MOVE      VDAT          PLAVD
     C                   MOVE      LASN          PLASQ
     C                   MOVEL     'LA'          PTYPE             4
     C                   MOVE      AMTP          PTYPE
     C                   CALL      'AOSTALR2'
     C                   PARM      *BLANKS       PRTCD
     C                   PARM      '*NEXT  '     POPTN
     C                   PARM                    PTYPE
     C                   PARM                    PLNRF
     C                   PARM                    PLAVD
     C                   PARM                    PLASQ
     C                   PARM      *BLANKS       PCFEE
     C                   PARM      *BLANKS       PFFEE
     C                   PARM      *BLANKS       PFESQ
     C                   PARM      WPYRCV        PPYRCV
     C***********LESTAL    PARM *BLANKS   DSSDY                                       CLE034 BUG9201
     C     LESTAL        PARM      *BLANKS       DSLDY
      *                                                                                       CLE034
     C                   ELSE
      *                                                                                       CLE034
     C                   MOVE      LNRF          PLNRF
     C                   CALL      'AOSTALR2'
     C                   PARM      *BLANKS       PRTCD
     C                   PARM      '*NEXT  '     POPTN
     C                   PARM      'LOAN'        PTYPE
     C                   PARM                    PLNRF
     C                   PARM      *BLANKS       PLAVD
     C                   PARM      *BLANKS       PLASQ
     C                   PARM      *BLANKS       PCFEE
     C                   PARM      *BLANKS       PFFEE
     C                   PARM      *BLANKS       PFESQ
     C                   PARM      WPYRCV        PPYRCV
     C***********LESTAL    PARM *BLANKS   DSSDY                                       CLE034 BUG9201
     C     LESTAL        PARM      *BLANKS       DSLDY
     C                   ENDIF
      *                                                                                       CLE034
     C                   ENDIF
      *                                                                                       CLE034
     C     PRTCD         IFEQ      '*EOF   '
     C                   MOVE      'Y'           WRKFLD
     C                   ENDIF
     C                   ENDIF
      *                                                                                       CLE034
     C                   ENDSR
      *****************************************************************                       CLE034
     C/EJECT                                                                                  CLE034
      *****************************************************************                       CLE034
      *                                                               *                       CLE034
      *  SR34D - Set up fields from settlement allocation             *                       CLE034
      *                                                               *                       CLE034
      *****************************************************************                       CLE034
     C     SR34D         BEGSR
      *                                                                                       CLE034
     C     WPYRCV        IFEQ      'P'
     C                   MOVE      STPSTM        SETP
     C                   MOVE      STPONS        OSAC
     C                   MOVE      STPOBR        OSBR
     C                   ELSE
     C                   MOVE      STRSTM        SETP
     C                   MOVE      STRONS        OSAC
     C                   MOVE      STROBR        OSBR
     C                   ENDIF
      *                                                                                       CLE034
     C                   MOVE      STRSTM        RSTM
     C                   MOVE      STRONS        RONS
     C                   MOVE      STPSTM        PSTM
     C                   MOVE      STPONS        PONS
     C                   MOVE      STPSCY        PSCY
     C                   MOVE      STPSCY        PSCYA
     C                   MOVE      STPSCY        PSCYL
     C                   MOVE      RSCY          SCCY
     C                   MOVE      RSCY          SCCYA
     C                   MOVE      RSCY          SCCYL
     C                   MOVE      STBENN        FACO
     C                   MOVE      STPEXR        PEXRA
     C                   MOVE      STREXR        REXRA
     C                   MOVE      STPEXI        PEXIA
     C                   MOVE      STREXI        REXIA
      *                                                                                       CLE034
     C     CEU004        IFEQ      'Y'
     C     SCCY          ANDNE     *BLANKS
     C                   MOVE      SCCY          LKSCCY
     C                   ELSE
     C                   MOVE      *BLANKS       LKSCCY
     C                   ENDIF
      *                                                                                       CLE034
     C                   ENDSR
      *****************************************************************                       CLE034
     C/EJECT                                                                                  CLE034
      *****************************************************************                       CLE034
      *                                                               *                       CLE034
      *  SR34E - Restore original fields                              *                       CLE034
      *                                                               *                       CLE034
      *****************************************************************                       CLE034
     C     SR34E         BEGSR
      *                                                                                       CLE034
     C                   Z-ADD     WSVAMT        ACAMNT
     C                   Z-ADD     WSSETP        SETP
     C                   MOVE      WSOSAC        OSAC
     C                   MOVE      WSOSBR        OSBR
     C                   Z-ADD     WSPSTM        PSTM
     C                   MOVE      WSPONS        PONS
     C                   Z-ADD     WSRSTM        RSTM
     C                   MOVE      WSRONS        RONS
     C                   MOVE      WSFACO        FACO
     C                   MOVE      WSLSCY        LKSCCY
     C                   MOVE      WSSCCY        SCCY
     C                   MOVE      WSPSCY        PSCY
     C                   MOVE      WSPSCA        PSCYA
     C                   MOVE      WSCCYA        SCCYA
     C                   MOVE      WSPEXR        PEXRA
     C                   MOVE      WSREXR        REXRA
     C                   MOVE      WSPEXI        PEXIA
     C                   MOVE      WSREXI        REXIA
     C                   MOVE      WSPSCL        PSCYL
     C                   MOVE      WSCCYL        SCCYL
      *                                                                                       CLE034
     C                   ENDSR
      *****************************************************************                       CLE034
     C/EJECT                                                                                  CLE031
      *****************************************************************                       CLE031
      *****************************************************************                       CLE038
      *                                                               *                       CLE038
      *  CLRSTL - Clear Settlement Allocation fields.                 *                       CLE038
      *                                                               *                       CLE038
      *****************************************************************                       CLE038
     C     CLRSTL        BEGSR
      *                                                                                       CLE038
      ** Clear Receive Settlement Details                                                     CLE038
      *                                                                                       CLE038
     C     WCLEAR        IFEQ      'R'
     C     WCLEAR        OREQ      'B'
     C                   MOVEL     '00'          STRSTM
     C                   MOVEL     *BLANKS       STRONS
     C**********           Z-ADD0         STROBN                                      CLE038 CSD027A
     C**********           Z-ADD0         STROCN                                      CLE038 CSD027A
     C                   MOVE      *BLANKS       STROBN
     C                   MOVE      *BLANKS       STROCN
     C                   MOVEL     *BLANKS       STRIBN
     C                   MOVEL     *BLANKS       STRIBA
     C                   MOVEL     *BLANKS       STROBR
     C                   Z-ADD     0             STREXR
     C                   MOVEL     *BLANKS       STREXI
     C                   MOVEL     *BLANKS       RSCY
     C                   Z-ADD     0             STRCAM
     C                   ENDIF
      *                                                                                       CLE038
      ** Clear Pay Settlement Details                                                         CLE038
      *                                                                                       CLE038
     C     WCLEAR        IFEQ      'P'
     C     WCLEAR        OREQ      'B'
     C                   Z-ADD     0             STPYAM
     C                   MOVEL     '00'          STPSTM
     C                   MOVEL     *BLANKS       STPONS
     C**********           Z-ADD0         POBN                                        CLE038 CSD027A
     C**********           Z-ADD0         POCN                                        CLE038 CSD027A
     C                   MOVE      *BLANKS       POBN
     C                   MOVE      *BLANKS       POCN
     C                   MOVEL     *BLANKS       STPIBN
     C                   MOVEL     *BLANKS       PIBA
     C                   MOVEL     *BLANKS       STRCRN
     C                   MOVEL     *BLANKS       STRCRA
     C                   MOVEL     *BLANKS       STRVNO
     C                   MOVEL     *BLANKS       AWBN
     C                   MOVEL     *BLANKS       AWBA
     C                   MOVEL     *BLANKS       BENN
     C                   MOVEL     *BLANKS       BENA
     C                   MOVEL     *BLANKS       DCHG
     C                   MOVEL     *BLANKS       STCVMR
     C                   MOVEL     *BLANKS       STPOBR
     C                   Z-ADD     0             STPEXR
     C                   MOVEL     *BLANKS       STPEXI
     C                   MOVEL     *BLANKS       STPSCY
     C                   ENDIF
      *                                                                                       CLE038
      ** Clear Common Settlement Details                                                      CLE038
      *                                                                                       CLE038
     C                   MOVEL     *BLANKS       DTP1
     C                   MOVEL     *BLANKS       DTP2
     C                   MOVEL     *BLANKS       DTP3
     C                   MOVEL     *BLANKS       DTP4
     C                   MOVEL     *BLANKS       STBTB1
     C                   MOVEL     *BLANKS       STBTB2
     C                   MOVEL     *BLANKS       STBTB3
     C                   MOVEL     *BLANKS       STBTB4
     C                   MOVEL     *BLANKS       BTB5
     C                   MOVEL     *BLANKS       BTB6
      *                                                                                       CLE038
     C                   ENDSR
     C/EJECT                                                                                  CLE038
      *****************************************************************                       CLE038
      *                                                               *                       CLE038
      *  SR38A - Convert Allocations by Amount back to Loan Currency  *                       CLE038
      *                                                               *                       CLE038
      *****************************************************************                       CLE038
     C     SR38A         BEGSR
      *                                                                                       CLE038
      ** Save amount in Settlement Currency:                                                  CLE038
      *                                                                                       CLE038
     C                   Z-ADD     WKAMT         STAMT
      *                                                                                       CLE038
     C     W6NBDP        IFNE      XDECP
     C     W6NBDP        SUB       XDECP         WKPWR
     C     WKPWR         ADD       4             D
      *                                                                                       CLE038
      ** If power element is less than 1                                                      CLE038
      *                                                                                       CLE038
     C     POWER(D)      IFLT      1
      *                                                                                       CLE038
      ** Multiply Amount in 'From' ccy by element in power array                              CLE038
      *                                                                                       CLE038
     C     POWER(D)      MULT      WKAMT         WKA163
      *                                                                                       CLE038
      ** Convert amount in WKA163 using reciprocal of the cross rate                          CLE038
      ** and place in 'To' (transaction) ccy amount field WKAMT                               CLE038
      *                                                                                       CLE038
     C     WCYXIN        IFEQ      'M'
     C     WKA163        DIV       WCYEXR        WKAMT
     C                   ELSE
     C     WKA163        MULT      WCYEXR        WKAMT
     C                   ENDIF
      *                                                                                       CLE038
     C                   ENDIF
      *                                                                                       CLE038
      ** If power element is greater than or equal to 1                                       CLE038
      *                                                                                       CLE038
     C     POWER(D)      IFGE      1
      *                                                                                       CLE038
      ** Multiply amount in 'from' ccy by element in power array                              CLE038
      *                                                                                       CLE038
     C     WKAMT         MULT      POWER(D)      WKAMTW
      *                                                                                       CLE038
      ** Convert amount in WKAMTW using reciprocal of the cross-rate                          CLE038
      ** and place in 'to' (transaction) ccy amount field WKAMT                               CLE038
      *                                                                                       CLE038
     C     WCYXIN        IFEQ      'M'
     C     WKAMTW        DIV(H)    WCYEXR        WKAMT
     C                   ELSE
     C********** WKAMTW    MULT WCYEXR    STAMT     H                                  CLE038 234555
     C     WKAMTW        MULT(H)   WCYEXR        WKAMT
     C                   ENDIF
      *                                                                                       CLE038
     C                   ENDIF
      *                                                                                       CLE038
      ** Else, the currencies have the same number of decimal places                          CLE038
      *                                                                                       CLE038
     C                   ELSE
      *                                                                                       CLE038
      ** Convert amount in WKAMT using reciprocal of the cross-rate                           CLE038
      ** and place in 'To' (transaction) ccy amount field WKAMT                               CLE038
      *                                                                                       CLE038
     C     WCYXIN        IFEQ      'M'
     C********** WKAMTW    DIV  WCYEXR    WKAMT     H                                  CLE038 234555
     C     WKAMT         DIV(H)    WCYEXR        WKAMT
     C                   ELSE
     C********** WKAMTW    MULT WCYEXR    STAMT     H                                  CLE038 234555
     C     WKAMT         MULT(H)   WCYEXR        WKAMT
     C                   ENDIF
      *                                                                                       CLE038
     C                   ENDIF
      *                                                                                       CLE038
     C                   ENDSR
      *****************************************************************                       CLE038
     C/EJECT                                                                                  CLE038
      *****************************************************************                       CLE038
      *                                                               *                       CLE038
      *  CALRAT - Calculates Settlement Currency Cross Rate using     *                       CLE038
      *           Currencies from Standard Settlement Instructions    *                       CLE038
      *                                                               *                       CLE038
      *****************************************************************                       CLE038
     C     CALRAT        BEGSR
      *                                                                                       CLE038
      ** Get details of Loan Currency:                                                        CLE038
      *                                                                                       CLE038
     C**********           CALL 'AOCURRR0'                                             CLE038 CSC042
     C**********           PARM *BLANKS   PRTCD                                        CLE038 CSC042
     C**********           PARM '*KEY    'POPTN                                        CLE038 CSC042
     C**********           PARM BYCYCD    PCURR   3                                    CLE038 CSC042
     C********** SDCURR    PARM SDCURR    DSSDY                                        CLE038 CSC042
      *                                                                                       CLE038
     C**********           Z-ADDA6SPRT    ZRATE1                                       CLE038 CSC042
     C**********           MOVELA6MDIN    ZMDI1                                        CLE038 CSC042
      *                                                                                       CLE038
      ** Get details of Settlement Currency:                                                  CLE038
     C                   MOVE      BYCYCD        XCCY
     C                   EXSR      CCYDSP
     C                   Z-ADD     XSPOT         ZRATE1
     C                   MOVEL     XMDIN         ZMDI1
      *                                                                                       CLE038
     C**********           CALL 'AOCURRR0'                                                    CLE038
     C**********           PARM *BLANKS   PRTCD                                               CLE038
     C**********           PARM '*KEY    'POPTN                                               CLE038
     C**********           PARM BYSTCY    PCURR                                               CLE038
     C********** SDCURR    PARM SDCURR    DSSDY                                               CLE038
      *                                                                                       CLE038
     C**********           Z-ADDA6SPRT    ZRATE2                                              CLE038
     C**********           MOVELA6MDIN    ZMDI2                                               CLE038
     C                   MOVE      BYSTCY        XCCY
     C                   EXSR      CCYDSP
     C                   Z-ADD     XSPOT         ZRATE2
     C                   MOVEL     XMDIN         ZMDI2
      *                                                                                       CLE038
      ** Calculate cross rate from Loan Ccy to Settlement Ccy                                 CLE038
      *                                                                                       CLE038
     C                   EXSR      ZXRATE
      *                                                                                       CLE038
     C                   ENDSR
      *****************************************************************                       CLE038
     C/EJECT                                                                                  CLE038
      *****************************************************************                       CLE038
      *                                                               *                       CLE038
      *  SR38B - Convert Allocation by Amount into a 100% allocation  *                       CLE038
      *                                                               *                       CLE038
      *****************************************************************                       CLE038
     C     SR38B         BEGSR
      *                                                                                       CLE038
      ** Set up key-fields for accessing Settlement Allocation file:                          CLE038
      *                                                                                       CLE038
     C**********         MOVE      LNRF          KSLNRF            6 0                 CLE038 CLE148
     C                   MOVE      LNRF          KSLNRF            6                          CLE148
     C                   MOVE      'LOAN'        KSTYPE            4
     C                   Z-ADD     *ZEROS        KSVDAT            5 0
     C                   MOVE      'N'           BYAMT2            1
     C     STALKY        SETLL     XESTAL7
     C     STALKY        READE     XESTAL7                                12
     C     *IN12         DOWEQ     *OFF
      *                                                                                       CLE038
     C                   MOVE      'N'           BYAMT             1
     C     WPYRCV        IFEQ      'P'
     C     STPYBA        ANDEQ     'A'
     C                   MOVE      'Y'           BYAMT             1
     C                   MOVE      'Y'           BYAMT2
     C                   ELSE
     C     WPYRCV        IFEQ      'R'
     C     STRCBA        ANDEQ     'A'
     C                   MOVE      'Y'           BYAMT             1
     C                   MOVE      'Y'           BYAMT2
     C                   ENDIF
     C                   ENDIF
      *                                                                                       CLE038
     C     BYAMT         IFEQ      'Y'
      *                                                                                       CLE038
      ** Mature this allocation:                                                              CLE038
      *                                                                                       CLE038
     C                   MOVE      'M'           RECI
     C                   UPDATE    XESTAL7
      *                                                                                       CLE038
      ** Output replacement allocation with just Maturity Details:                            CLE038
      *                                                                                       CLE038
     C     WPYRCV        IFEQ      'P'
     C     STPYBA        ANDEQ     'A'
     C                   MOVE      'P'           WCLEAR            1
     C                   EXSR      CLRSTL
     C                   ELSE
     C     WPYRCV        IFEQ      'R'
     C     STRCBA        ANDEQ     'A'
     C                   MOVE      'R'           WCLEAR            1
     C                   EXSR      CLRSTL
     C                   ENDIF
     C                   ENDIF
      *                                                                                       CLE038
     C                   MOVEL     'D'           RECI
     C                   MOVE      'P'           STRCBA
     C                   MOVE      'P'           STPYBA
     C                   WRITE     XESTAL7
     C                   ENDIF
      *                                                                                       CLE038
      ** Read next allocation for this loan:                                                  CLE038
      *                                                                                       CLE038
     C     STALKY        READE     XESTAL7                                12
     C                   ENDDO
      *                                                                                       CLE038
     C     BYAMT2        IFEQ      'Y'
      *                                                                                       CLE038
      ** Output replacement allocation to Standard Settlement Instructions:                   CLE038
      *                                                                                       CLE038
     C                   MOVEL     'D'           RECI
     C                   MOVEL     'LOAN'        STTYPE
     C************         Z-ADD1         STSEQ                                        CLE038 235060
     C     STSEQ         ADD       1             STSEQ
     C                   Z-ADD     0             STLASQ
     C**********           Z-ADD0         CNUM                                        CLE038 CSD027A
     C                   MOVE      *BLANKS       CNUM
     C                   Z-ADD     0             FACL
     C                   Z-ADD     0             FESQ
      *                                                                                       CLE038
      ** Generate a time stamp for the new allocation:                                        CLE038
      *                                                                                       CLE038
     C                   CALL      'ZAGENTS'
     C                   PARM      ZATMST        ZATMST           26
     C                   MOVE      ZATMST        TMST
      *                                                                                       CLE038
      ** Generate a new PC Reference for this allocation:                                     CLE038
      *                                                                                       CLE038
     C                   MOVE      BRCA          PBRCA
     C                   MOVEL     BRCA          ##KB
     C                   EXSR      ##CHKB
      * If branch is in the array then use the details                                        CSC042
     C     ##FIC         IFEQ      'Y'                                          *** B10
     C                   EXSR      ##SETB
     C                   ELSE                                                   *** X10
     C                   CALL      'AOBRCHR1'
     C                   PARM      *BLANKS       PRTCD
     C                   PARM      '*KEY   '     POPTN
     C                   PARM                    PBRCA             3
     C     SDBRCH        PARM      SDBRCH        DSSDY
     C     PRTCD         IFNE      *BLANKS
     C                   MOVEL     'SDBRCHPD'    DBFILE
     C                   MOVE      *BLANKS       DBKEY
     C                   MOVEL     PBRCA         DBKEY
     C                   Z-ADD     34            DBASE
     C                   MOVE      *ON           *INU7
     C                   MOVE      *ON           *INLR
     C                   EXSR      *PSSR
     C                   ELSE
      * Details found on the DB so add them to the array                                      CSC042
      * if the array still has room                                                           CSC042
     C                   EXSR      ##ADDB
     C     A8MQSM        IFNE      *BLANKS
     C                   MOVEL     A8MQSM        W#1ST3            3
     C                   ELSE
     C                   MOVEL     A8BRCD        W#1ST3
     C                   ENDIF
     C                   ENDIF
     C                   END
      *                                                                                       CLE038
      ** Place the new PC Reference in PCRF of Settlement Allocation:                         CLE038
      *                                                                                       CLE038
     C     CLE106        IFNE      'Y'
     C********** *NAMVAR   DEFN           LEALLO                                       CLE038 CLE148
     C********** *LOCK     IN   LEALLO                                                 CLE038 CLE148
     C********** PCLAST    ADD  1         PCNEXT  80                                   CLE038 CLE148
      *                                                                                       CLE148
     C                   CALL      'LEALLO'                                                   CLE148
     C                   PARM      *BLANKS       PRTCD             7                          CLE148
     C                   PARM      'Y'           PUPDT             1                          CLE148
     C                   PARM      *BLANKS       PCLAST                                       CLE148
     C                   PARM      *BLANKS       PCNEXT            8                          CLE148
      *                                                                                       CLE148
     C                   MOVE      PCNEXT        W1ST11           11
     C                   MOVEL     W#1ST3        W1ST11
     C                   MOVEL     W1ST11        WPCRF            15
     C                   MOVE      '0001'        WPCRF
     C**********           Z-ADDPCNEXT    PCLAST                                       CLE038 CLE148
     C**********           OUT  LEALLO                                                 CLE038 CLE148
     C                   MOVEL     WPCRF         STPCRF
     C                   ENDIF
      *                                                                                       CLE038
      ** Set up Key fields for call to AOEXSTR1:                                              CLE038
      *                                                                                       CLE038
     C                   MOVEL     CCYL          @CYCD             3
      *                                                                                       CLE038
      ** If loan is parts purch, use original borrower                                        CLE038
      *                                                                                       CLE038
     C     PTYP          IFEQ      64
     C     PTYP          OREQ      65
     C     PTYP          OREQ      68
     C     PTYP          OREQ      71
     C                   MOVEL     OLNO          @CNUM             6
     C                   ELSE
     C                   MOVEL     CNUML         @CNUM
     C                   ENDIF
      *                                                                                       CLE038
      ** Retrieve Standard Settlement Instructions from SDEXSTPD.                             CLE038
      ** Call AOEXSTR1 with the following parameters:                                         CLE038
      *                                                                                       CLE038
     C                   CALL      'AOEXSTR1'
     C                   PARM      *BLANKS       @RTCD             7
     C                   PARM      '*KEY  '      @OPTN             7
     C                   PARM                    @CYCD
     C                   PARM                    @CNUM
     C                   PARM      'LE'          @TRTY             2
     C     SDEXST        PARM      SDEXST        DSLDY
      *                                                                                       CLE038
     C     @RTCD         IFNE      *BLANKS
      *                                                                                       CLE038
      ** If nothing found for 'LE', try Transaction type 'AT':                                CLE038
      *                                                                                       CLE038
     C                   CALL      'AOEXSTR1'
     C                   PARM      *BLANKS       @RTCD             7
     C                   PARM      '*KEY  '      @OPTN             7
     C                   PARM                    @CYCD
     C                   PARM                    @CNUM
     C                   PARM      'AT'          @TRTY             2
     C     SDEXST        PARM      SDEXST        DSLDY
     C                   ENDIF
      *                                                                                       CLE038
      ** Clear both sides of settlement fields on LESTALPD:                                   CLE038
      *                                                                                       CLE038
     C                   MOVE      'B'           WCLEAR            1
     C                   EXSR      CLRSTL
      *                                                                                       CLE038
      ** Move retrieved Settlement Instructions to fields on XESTALPD:                        CLE038
      *                                                                                       CLE038
     C     PTYP          IFEQ      66
     C     PTYP          OREQ      67
     C     PTYP          OREQ      69
     C     PTYP          OREQ      72
      *                                                                                       CLE038
      ** Part Sold so use Receive Details for Loan Start                                      CLE038
      *                                                                                       CLE038
     C                   Z-ADD     0             PYPC
     C                   Z-ADD     100           RCPC
     C                   Z-ADD     0             STRCAM
     C                   MOVE      'P'           STRCBA
     C     @RTCD         IFEQ      *BLANKS
     C                   MOVEL     BYRSTY        STRSTM
     C                   MOVEL     BYRONO        STRONS
     C                   MOVEL     BYROBN        STROBN
     C                   MOVEL     BYROCS        STROCN
     C                   MOVEL     BYRIBN        STRIBN
     C                   MOVEL     BYRIBL        STRIBA
     C                   MOVEL     BYORBR        STROBR
     C                   MOVEL     BYSTCY        RSCY
      *                                                                                       CLE038
      ** Calculate Receipt Currency Exchange Rate:                                            CLE038
      *                                                                                       CLE038
     C     RSCY          IFNE      *BLANKS
     C     CLE031        ANDEQ     'Y'
     C                   EXSR      CALRAT
     C                   MOVE      ZRATEX        STREXR
     C                   MOVE      ZMDIX         STREXI
     C                   ENDIF
      *                                                                                       CLE038
     C                   ENDIF
     C                   ELSE
      *                                                                                       CLE038
      ** Else, not a Part Sold so use Pay Details for Loan Start                              CLE038
      *                                                                                       CLE038
     C                   Z-ADD     0             RCPC
     C                   Z-ADD     100           PYPC
     C                   Z-ADD     0             STPYAM
     C                   MOVE      'P'           STPYBA
     C     @RTCD         IFEQ      *BLANKS
     C                   MOVEL     BYPSTY        STPSTM
     C                   MOVEL     BYPONO        STPONS
     C                   MOVEL     BYPOBN        POBN
     C                   MOVEL     BYPOCS        POCN
     C                   MOVEL     BYPIBN        STPIBN
     C                   MOVEL     BYPIBA        PIBA
     C                   MOVEL     BYRCNO        STRCRN
     C                   MOVEL     BYRCAL        STRCRA
     C                   MOVEL     BYRCNB        STRVNO
     C                   MOVEL     BYACBN        AWBN
     C                   MOVEL     BYACBL        AWBA
     C**********           MOVELBYBYNB    BENN                                        CLE038 BUG9253
     C                   MOVEL     BYBYNB        STBENN
     C                   MOVEL     BYBACL        BENA
     C                   MOVEL     BYDECG        DCHG
     C                   MOVEL     BYCVMR        STCVMR
     C                   MOVEL     BYOPBR        STPOBR
     C                   MOVEL     BYSTCY        STPSCY
      *                                                                                       CLE038
      ** Calculate Pay Currency Exchange Rate:                                                CLE038
      *                                                                                       CLE038
     C     STPSCY        IFNE      *BLANKS
     C     CLE031        ANDEQ     'Y'
     C                   EXSR      CALRAT
     C                   MOVE      ZRATEX        STPEXR
     C                   MOVE      ZMDIX         STPEXI
     C                   ENDIF
     C                   ENDIF
     C                   ENDIF
     C     @RTCD         IFEQ      *BLANKS
     C                   MOVEL     BYDPY1        DTP1
     C                   MOVEL     BYDPY2        DTP2
     C                   MOVEL     BYDPY3        DTP3
     C                   MOVEL     BYDPY4        DTP4
     C                   MOVEL     BYBBI1        STBTB1
     C                   MOVEL     BYBBI2        STBTB2
     C                   MOVEL     BYBBI3        STBTB3
     C                   MOVEL     BYBBI4        STBTB4
     C                   MOVEL     BYBBI5        BTB5
     C                   MOVEL     BYBBI6        BTB6
     C                   ENDIF
      *                                                                                       CLE038
     C                   WRITE     XESTAL7
     C                   ENDIF
     C                   ENDSR
      *****************************************************************                       CLE038
     C/EJECT                                                                                  CRE073
      *****************************************************************                       CRE073
      *                                                               *                       CRE073
      *  NEWSRT - Calculates New Spread Rate based on the Interest    *                       CRE073
      *           Rounding rules                                      *                       CRE073
      *                                                               *                       CRE073
      *****************************************************************                       CRE073
     C     NEWSRT        BEGSR
      *                                                                                       CRE073
     C     CRE073        IFEQ      'Y'
      *                                                                                       CRE073
     C     SWLN          IFNE      LNRF
     C                   Z-ADD     *ZEROS        WCNSP            11 7
     C                   MOVEL     *BLANKS       WCNSG             1
     C                   MOVEL     *BLANKS       WRDMT             7
     C                   MOVEL     *BLANKS       WRDFD             4
     C                   ENDIF
      *                                                                                       CRE073
     C     QKEY          KLIST
     C                   KFLD                    LNRF
     C                   KFLD                    VDAT
     C                   KFLD                    LASN
      *                                                                                       CRE073
     C     QKEY          CHAIN     CLOAMQL0                           16
     C     *IN16         IFNE      '1'
     C     AMCNSP        IFNE      0
     C                   Z-ADD     AMCNSP        WCNSP
     C                   MOVEL     AMCNSG        WCNSG
     C                   MOVEL     AMRDMT        WRDMT
     C                   MOVEL     AMRDFD        WRDFD
     C**********         Z-ADD     LNRF          SWLN              6 0                 CRE073 CLE148
     C                   MOVEL     LNRF          SWLN              6                          CLE148
      *                                                                                       CRE073
     C                   Z-ADD     AMCNSP        CNSPO            11 7
     C                   MOVEL     AMCNSG        CNSGO             1
     C                   MOVEL     AMRDMT        RDMTO             7
     C                   MOVEL     AMRDFD        RDFDO             4
     C                   Z-ADD     AMCNSP        CNSP
     C                   MOVEL     AMCNSG        CNSG
     C                   MOVEL     AMRDMT        RDMT
     C                   MOVEL     AMRDFD        RDFD
     C                   MOVEL     AMCNSG        SPINL
      *                                                                                       CRE073
     C                   ENDIF
     C                   ENDIF
      *                                                                                       CRE073
     C     WCNSP         IFEQ      0
     C                   Z-ADD     CNSP          WCNSP
     C                   MOVEL     CNSG          WCNSG
     C                   MOVEL     RDMT          WRDMT
     C                   MOVEL     RDFD          WRDFD
     C**********         Z-ADD     LNRF          SWLN                                  CRE073 CLE148
     C                   MOVEL     LNRF          SWLN                                         CLE148
     C                   ELSE
     C                   Z-ADD     CNSPO         CNSP
     C                   MOVEL     CNSGO         CNSG
     C                   MOVEL     RDMTO         RDMT
     C                   MOVEL     RDFDO         RDFD
     C                   ENDIF
      *                                                                                       CRE073
     C     BRTEL         IFNE      0
     C     RTSPL         ANDNE     0
     C                   MOVEL     'ZACALCSP'    PROG             10
     C                   MOVE      'RT'          PROG
     C                   CALL      PROG
     C                   PARM      *BLANKS       @RTCD
     C                   PARM                    BRTEL
     C                   PARM                    WCNSP
     C                   PARM                    WCNSG
     C                   PARM                    WRDMT
     C                   PARM                    WRDFD
     C                   PARM      *ZERO         NSRTX            11 7
     C                   PARM      *ZERO         FRATE            11 7
      *                                                                                       CRE073
     C                   Z-ADD     NSRTX         RTSPL
     C                   MOVE      WCNSG         SPINL
     C     NSRTX         IFLT      0
     C                   MULT      -1            RTSPL
     C     SPINL         IFEQ      'A'
     C                   MOVE      'S'           SPINL
     C                   ELSE
     C                   MOVE      'A'           SPINL
     C                   ENDIF
     C                   ENDIF
     C                   ENDIF
      *                                                                                       CRE073
     C                   ENDIF
     C                   ENDSR
      *****************************************************************                       CRE073
                                                                                              CLE164
      *****************************************************************                       CLE164
      *    SRRETRPKY - Retrieve LEPK1DPD Repayment Priorities         *                       CLE164
      *****************************************************************                       CLE164
     C     SRRETRPKY     BEGSR                                                                CLE164
                                                                                              CLE164
     C                   CALL      'LE000801'                                                 CLE164
     C                   PARM      *BLANK        PRTCDRP                                      CLE164
     C                   PARM      SECATC        PCATC                                        CLE164
     C                   PARM      'CLOANZTD'    PFILE                                        CLE164
     C                   PARM      KLNNO         PLOAN                                        CLE164
     C                   PARM      *BLANK        PBRCH                                        CLE164
     C                   PARM      KCNUM         PCUST                                        CLE164
     C                   PARM      *ZEROS        PFCLT                                        CLE164
     C                   PARM      *ZEROS        PFESE                                        CLE164
     C                   PARM      *ZEROS        PREPR                                        CLE164
     C                   PARM      *ZEROS        PCAPR                                        CLE164
     C                   PARM      *BLANK        PODFL             1                          CLE164
                                                                                              CLE164
     C                   EVAL      SECAPR = PCAPR                                             CLE164
     C                   EVAL      SEREPR = PREPR                                             CLE164
     C                   EVAL      SEOVFL = PODFL                                             CLE164
                                                                                              CLE164
     C                   EVAL      SETREF = KLNNO + %EDITC(FTYP:'X')                          CLE164
     C                                        + %EDITC(FSEQ:'X')                              CLE164
                                                                                              CLE164
     C                   ENDSR                                                                CLE164
      *****************************************************************                       CLE164
      *    SRRETDAT - Retrieve LEPK1DPD Dates                         *                       CLE164
      *****************************************************************                       CLE164
     C     SRRETDAT      BEGSR                                                                CLE164
                                                                                              CLE164
     C                   MOVE      LTYP          LOANTY            1                          CLE164
     C                   EVAL      KEYLNNO = KLNNO                                            CLE164
                                                                                              CLE164
     C     KEYCLF4       KLIST                                                                CLE164
     C                   KFLD                    RECI                                         CLE164
     C                   KFLD                    KEYLNNO                                      CLE164
      *                                                                                       CLE164
     C     KEYCLF4       CHAIN     CLOANL4                                                    CLE164
     C                   IF        %FOUND(CLOANL4)                                            CLE164
     C                   EVAL      SESDAT = F4_VDAT                                           CLE164
                                                                                              CLE164
     C                   IF        LOANTY = 'X' OR LOANTY = 'Y'                               CLE164
     C                             OR LOANTY = 'Z'                                            CLE164
                                                                                              CLE164
     C                   IF        F4_MDAT = 0                                                CLE164
     C                   EVAL      KEYLNNO = F4_ORLN                                          CLE164
                                                                                              CLE164
     C     KEYCLF4       CHAIN     CLOANL4                                                    CLE164
     C                   IF        F4_MDAT = 0                                                CLE164
     C                   EVAL      SEMDAT = F4_VDAT                                           CLE164
     C                   ELSE                                                                 CLE164
     C                   EVAL      SEMDAT = F4_MDAT                                           CLE164
     C                   ENDIF                                                                CLE164
                                                                                              CLE164
     C                   ELSE                                                                 CLE164
     C                   EVAL      SEMDAT = F4_MDAT                                           CLE164
     C                   ENDIF                                                                CLE164
                                                                                              CLE164
     C                   ELSE                                                                 CLE164
                                                                                              CLE164
     C                   IF        F4_MDAT = 0                                                CLE164
     C                   EVAL      SEMDAT = VDATL                                             CLE164
     C                   ELSE                                                                 CLE164
     C                   EVAL      SEMDAT = F4_MDAT                                           CLE164
     C                   ENDIF                                                                CLE164
                                                                                              CLE164
     C                   ENDIF                                                                CLE164
                                                                                              CLE164
     C                   ENDIF                                                                CLE164
     C                   EVAL      SEVDPD = 0                                                 CLE164
     C                   EVAL      SEVDPY = KEDAT                                             CLE164
                                                                                              CLE164
     C                   MOVE      TMST5         SETMST                                       CLE164
                                                                                              CLE164
     C                   ENDSR                                                                CLE164
      *****************************************************************                       CLE164
      /EJECT                                                                                  CLE164
      *****************************************************************                       CLE164
      *                                                               *                       CLE164
      * WriteExtFile - Write Repayment Priority Details to            *                       CLE164
      *                  CLOANZTD                                     *                       CLE164
      *                                                               *                       CLE164
      * Called by: INSERT                                             *                       CLE164
      *                                                               *                       CLE164
      * Calls: LE000506 - Midas LE Update Repayment Priority          *                       CLE164
      *        Extension Table                                        *                       CLE164
      *                                                               *                       CLE164
      *****************************************************************                       CLE164
     C     WriteExtFile  BEGSR                                                                CLE164
                                                                                              CLE164
     C                   IF        CLE134 = *OFF                                              CLE164
     C                   LEAVESR                                                              CLE164
     C                   ENDIF                                                                CLE164
                                                                                              CLE164
     C                   EVAL      wAction = '*INSERT'                                        CLE164
     C                   EVAL      wFile   = 'CLOANZTD'                                       CLE164
     C                   EVAL      wLoanRef  = LNRF                                           CLE164
     C                   EVAL      wCustomer = CNUM                                           CLE164
     C                   EVAL      wBranch  = *BLANKS                                         CLE164
     C                   EVAL      wFeeFclty = *Zeros                                         CLE164
     C                   EVAL      wFeeLoan = *BLANKS                                         CLE164
     C                   EVAL      wFeeSeqn = *ZEROS                                          CLE164
     C                   EVAL      MAX_CATEGORY = 4                                           CLE164
                                                                                              CLE164
     C                   EVAL      aCAT = %SUBARR(aCATCOD:1)                                  CLE164
     C                   EVAL      wLREF = LNRF                                               CLE164
     C                   EXSR      ProcessMatrix                                              CLE164
                                                                                              CLE164
     C                   ENDSR                                                                CLE164
      *****************************************************************                       CLE164
      /EJECT                                                                                  CLE164
      *****************************************************************                       CLE164
      *                                                               *                       CLE164
      * ProcessMatrix - Process Repayment Matrix  Details from        *                       CLE164
      *                                                               *                       CLE164
      * Called by: INSERT                                             *                       CLE164
      *                                                               *                       CLE164
      * Calls:                                                        *                       CLE164
      *                                                               *                       CLE164
      *                                                               *                       CLE164
      *****************************************************************                       CLE164
     C     ProcessMatrix BEGSR                                                                CLE164
                                                                                              CLE164
     C                   FOR       Index = 1 TO MAX_CATEGORY                                  CLE164
     C                   IF        aCAT(Index) <> ' '                                         CLE164
     C                   CALLP     UPDATE_MATRIX(                                             CLE164
     C                               wRetCode                                                 CLE164
     C                             : wAction                                                  CLE164
     C                             : wFile                                                    CLE164
     C                             : wLREF                                                    CLE164
     C                             : wBranch                                                  CLE164
     C                             : wCustomer                                                CLE164
     C                             : wFeeFclty                                                CLE164
     C                             : wFeeLoan                                                 CLE164
     C                             : wFeeSeqn                                                 CLE164
     C                             : wLSPDPGrpID                                              CLE164
     C                             : wFTPDPGrpID                                              CLE164
     C                             : wFCPDPGrpID                                              CLE164
     C                             : aCAT(Index)                                              CLE164
     C                             )                                                          CLE164
     C                   IF        wRetCode <> *Blanks                                        CLE164
     C     *LOCK         IN        LDA                                                        CLE164
     C                   MOVE      *BLANKS       DBKEY                                        CLE164
     C                   MOVEL     'CLOANZTD'    DBFILE                                       CLE164
     C                   Z-ADD     102           DBASE                                        CLE164
     C                   OUT       LDA                                                        CLE164
     C                   EXSR      *PSSR                                                      CLE164
     C                   ENDIF                                                                CLE164
     C                   ENDIF                                                                CLE164
     C                   ENDFOR                                                               CLE164
                                                                                              CLE164
     C                   ENDSR                                                                CLE164
      *****************************************************************                       CLE164
      /EJECT                                                                                  CLE164
      *****************************************************************                       CLE164
      *                                                               *                       CLE164
      * RetGroupID - Retrieve loan's priority group id                *                       CLE164
      *                                                               *                       CLE164
      * Called by:                                                    *                       CLE164
      *                                                               *                       CLE164
      * Calls:                                                        *                       CLE164
      *                                                               *                       CLE164
      *                                                               *                       CLE164
      *****************************************************************                       CLE164
     C     RetGroupID    BEGSR                                                                CLE164
                                                                                              CLE164
     C                   EVAL      @LNTY = LTYP                                               CLE164
     C                   EVAL      @SUTP = SUTP                                               CLE164
     C                   EVAL      @CLAS = CLAS                                               CLE164
     C                   EVAL      @FTYP = %EDITC(FTYP:'X')                                   CLE164
                                                                                              CLE164
     C                   CALL      'AOLOANR1'                                                 CLE164
     C                   PARM      *BLANK        PRTCD                                        CLE164
     C                   PARM      '*KEY'        POPTN                                        CLE164
     C                   PARM                    @LNTY                                        CLE164
     C                   PARM                    @SUTP                                        CLE164
     C                   PARM                    @CLAS                                        CLE164
     C     SDLOAN1       PARM      SDLOAN        DSSDY                                        CLE164
     C                                                                                        CLE164
     C                   CALL      'AOFACTR0'                                                 CLE164
     C                   PARM      *BLANK        PRTCD                                        CLE164
     C                   PARM      '*KEY'        POPTN                                        CLE164
     C                   PARM                    @FTYP                                        CLE164
     C     SDFACT1       PARM      SDFACT1       DSSDY                                        CLE164
     C                                                                                        CLE164
     C                   EVAL      wLSPDPGrpID = LN_AYPGID                                    CLE164
     C                   EVAL      wFTPDPGrpID = FC_AMPGID                                    CLE164
     C                   EVAL      wFCPDPGrpID = '***'                                        CLE164
                                                                                              CLE164
     C                   ENDSR                                                                CLE164
                                                                                              CLE164
     C***/COPY*ZSRSRC,ZFWDT                                                            S01195 CLE134
     C***/COPY*ZSRSRC,ZACCH                                                            S01195 CLE134
     C***/COPY*ZSRSRC,ZDATE2Z4                                                                CLE134
     C***/COPY*ZSRSRC,ZDATE1Z2                                                                CLE134
     C***/COPY*ZSRSRC,ZCHKH                                                            S01195 CLE134
     C***/COPY*ZSRSRC,ZBKDT                                                            S01195 CLE134
     C***/COPY*ZSRSRC,GLINTCZ1                                                                CLE134
     C***/COPY*ZSRSRC,ZSAVEZ1                                                                 CLE134
     C***/COPY*ZSRSRC,ZRSTORZ1                                                                CLE134
     C***/COPY*ZSRSRC,ZFREQBZ2                                                         S01392 CLE134
     C/COPY ZSRSRC,ZFWDT_ILE                                                                  CLE134
     C/COPY ZSRSRC,ZACCHLE                                                                    CLE134
     C/COPY ZSRSRC,ZDATE2Z4LE                                                                 CLE134
     C/COPY ZSRSRC,ZDATE1Z2LE                                                                 CLE134
     C/COPY ZSRSRC,ZCHKHLE                                                                    CLE134
     C/COPY ZSRSRC,ZBKDT_ILE                                                                  CLE134
     C/COPY ZSRSRC,GLINTCZ1LE                                                                 CLE134
     C/COPY ZSRSRC,ZSAVEZ1LE                                                                  CLE134
     C/COPY ZSRSRC,ZRSTORZ1LE                                                                 CLE134
     C/COPY ZSRSRC,ZFREQBZ2LE                                                                 CLE134
     C/COPY WNCPYSRC,LE0450C005
      /EJECT                                                              066550
     C***/COPY*ZSRSRC,ZINTDYZ2                                                         066550 CLE134
     C/COPY ZSRSRC,ZINTDYZ2LE                                                                 CLE134
      /EJECT                                                              066550
     C***/COPY*ZSRSRC,ZDATE9Z3                                                         066550 CLE134
     C/COPY ZSRSRC,ZDATE9Z3LE                                                                 CLE134
      /EJECT                                                              066550
     C***/COPY*ZSRSRC,ZDAT10Z2                                                         126017 CLE134
     C/COPY ZSRSRC,ZDAT10Z2LE                                                                 CLE134
      /EJECT                                                              126017
     C***/COPY*ZSRSRC,ZFRQB3                                                           CLE005 CLE134
     C/COPY ZSRSRC,ZFRQB3_ILE                                                                 CLE134
      /EJECT                                                              CLE005
     C***/COPY*ZSRSRC,ZXRATEZ1                                                         134725 CLE134
     C/COPY ZSRSRC,ZXRATEZ1LE                                                                 CLE134
      /EJECT                                                              134725
     C***/COPY*ZSRSRC,ZCONVZ1                                                          134725 CLE134
     C/COPY ZSRSRC,ZCONVZ1ILE                                                                 CLE134
      /EJECT                                                              134725
     C***/COPY*ZSRSRC,RULE78Z1                                                         CLE028 CLE134
     C/COPY ZSRSRC,RULE78Z1LE                                                                 CLE134
      /EJECT                                                                                  CLE028
     C/COPY ZSRSRC,ZFEB29Z2LE                                                                 CDL093
     C********************************************************************S01117
     C/EJECT                                                              S01117
3305 O**
3306 O**   FILE CONTROLS REPORT
3307 O**
3308 O*E0450P3T** 03   LR                                          S01124 S01117
     OLE0450AU  T    LR                       03                                S01117
3309 O***********                        22 'REFERENCE LE0450'            S01117
3309 O                                           24 'REFERENCE LE0450AU'        S01117
3310 O                       TITL                89
3311 O                                          104 'DATE'
3312 O                       RUNA               112
3313 O                                          122 'PAGE'
3314 O                                          127 '1'
3315 O          T    LR                       05
3316 O                                           69 'LOANS UPDATE PHASE II - '
3317 O                                           82 'FILE CONTROLS'
3318 O          T    LR                       06
3319 O                                           69 '------------------------'
3320 O                                           82 '-------------'
3321 O          T    LR                       09
3322 O                                           28 'S/LOUPD - RUN CONTROLS'
3323 O                                           59 'NUMBER'
3324 O                                           84 'VALUE'
3325 O          T    LR                       10
3326 O                                           28 '----------------------'
3327 O                                           59 'OF RECORDS'
3328 O                                           84 'OF RECORDS'
3329 O          T    LR                       12
3330 O                                           29 'TOTAL RECORDS ON FILE'
3331 O                       NOREL         Z     59
3332 O                       VLBF          Z     81
3333 O                       VLBL                84
3334 O          T    LR                       14
3335 O                                           29 'TOTAL RECORDS ON FILE'
3336 O                                           42 '- CALCULATED'
3337 O                       NORL          Z     59
3338 O                       VLBFL         Z     81
3339 O                       VLBLL               84
3340 O                  70NU7                   111 '***   DIFFERENCE   ***'
3341 O          T    LR                       17
3342 O                                           28 'S/ACTN6 - RUN CONTROLS'
3343 O          T    LR                       18
3344 O                                           28 '----------------------'
3345 O          T    LR                       20
3346 O                                           29 'TOTAL RECORDS ON FILE'
3347 O                       NOREA         Z     59
3348 O          T    LR                       22
3349 O                                           29 'TOTAL RECORDS ON FILE'
3350 O                                           42 ' - CALCULATED'
3351 O                       NORA          Z     59
3352 O                  71NU7                   111 '***   DIFFERENCE   ***'
3353 O          T    LR                       25
3354 O                                           28 'S/SPTSL - RUN CONTROLS'
3355 O          T    LR                       26
3356 O                                           28 '----------------------'
3357 O          T    LR                       28
3358 O                                           29 'TOTAL RECORDS ON FILE'
3359 O                       NOREP         Z     59
3360 O          T    LR                       30
3361 O                                           29 'TOTAL RECORDS ON FILE'
3362 O                                           42 '- CALCULATED'
3363 O                       NORP          Z     59
3364 O                  72NU7                   111 '***   DIFFERENCE   ***'
3365 O          T    LR                       33
3366 O                                           28 'S/NCLON - RUN CONTROLS'
3367 O          T    LR                       34
3368 O                                           28 '----------------------'
3369 O          T    LR                       36
3370 O                                           29 'TOTAL RECORDS ON FILE'
3371 O                       NORNL         Z     59
3372 O                       VLBFN         Z     81
3373 O                       VLBLN               84
3374 O          T    LR                       39
3375 O                                           28 'S/LKEY1 - RUN CONTROLS'
3376 O          T    LR                       40
3377 O                                           28 '----------------------'
3378 O          T    LR                       42
3379 O                                           29 'TOTAL RECORDS ON FILE'
3380 O                       NORK          Z     59
3381 O                       TOTIKY        Z     81
3382 O                       TOTDKY              84
3383 O          T    LR                       45
3384 O                                           28 'S/MATLN - RUN CONTROLS'
3385 O          T    LR                       46
3386 O                                           28 '----------------------'
3387 O          T    LR                       48
3388 O                                           29 'TOTAL RECORDS ON FILE'
3389 O                       NORMT         Z     59
3374 O          T    LR                       51                                              CLE134
3375 O                                           28 'S/LEPK1 - RUN CONTROLS'                  CLE134
3376 O          T    LR                       52                                              CLE134
3377 O                                           28 '----------------------'                  CLE134
3378 O          T    LR                       54                                              CLE134
3379 O                                           29 'TOTAL RECORDS ON FILE'                   CLE134
3380 O                       L1NORE        Z     59                                           CLE134
3381 O                       L1VLRF        Z     81                                           CLE134
3382 O                       L1VLRL              84                                           CLE134
3296 O**********T    LR U7                    50                                       S01117 CLE134
     O          T    LR U7                    58                                              CLE134
3297 O                                           51 '*** REFERENCE LE0450'      S01117
3298 O                                           71 'DATABASE ERROR AT'         S01117
3299 O                       DBASE               75                             S01117
3300 O**********T    LR U7                    52                                       S01117 CLE134
     O          T    LR U7                    60                                              CLE134
3301 O                                           39 'FILENAME'                  S01117
3302 O                       DBFILE              48                             S01117
3303 O                                           52 'KEY'                       S01117
3304 O                       DBKEY               82                             S01117
3293 O**********T    LRNU7 07                 54                                       S01117 CLE134
     O          T    LRNU7 07                 64                                              CLE134
3293 O         AND   08                                                         S01117
3294 O                                           68 '*** NO DETAILS TO'         S01117
3294 O                                           79 'REPORT ***'                S01117
3390 O********T** 54   LR                                                 S01117
3391 O***********                        78 '***  END OF REPORT  ***'     S01117
3256 O**
3257 O**   PARTS SOLD EXCEPTION REPORT
3258 O**
     O***/COPY*WNCPYSRC,LEH01021***                                                           CFC006
     O/COPY WNCPYSRC,LEH01021                                                               MD020563
     O***LE0450P2  H    OV                       03                                    S01124 CFC006
     O***LE0450P2  H    OV 36                    03                                  CFC006 MD020118
     OLE0450P2  H    OV 39                    03                                            MD020118
3260 O***********                        22 'REFERENCE LE0450'            S01117
3260 O                                           24 'REFERENCE LE0450P2'        S01117
3261 O                       TITL                89
3262 O                                          104 'DATE'
3263 O                       RUNA               112
3264 O                                          122 'PAGE'
3265 O                       PAGE2         Z    127
3266 O**********H    OV                  2  1                                                 CFC006
     O**********H    OV 36               2  1                                               MD020118
     O          H    OV 39               2  1                                               MD020118
3267 O                                           69 'PART SOLD EXCEPTION '
3268 O                                           75 'REPORT'
*    O               33                          85 'BRANCH'                    S01117
*    O               33      BRCA                89                             S01117
*    O               33NU7                       90 '-'                         S01117
*    O***********      33NU7   BRNM     120                        S01117 157750
*    O               33NU7   WBRNM              120                             157750
3269 O**********H    OV                                                                       CFC006
     O**********H    OV 36                                                           CFC006 MD020118
     O          H    OV 39                                                                  MD020118
3270 O                                           69 '--------------------'
3271 O                                           75 '------'
3272 O**********H    OV                  2  2                                                 CFC006
     O**********H    OV 36               2  2                                        CFC006 MD020118
     O          H    OV 39               2  2                                               MD020118
3273 O                                           13 'LOAN NO'
3274 O                                           26 'CUSTOMER'
     O                                           44 'ORIG BORROWER'
3275 O**********                         55 'CURRENT PRINCIPAL'                               201123
     O                                           67 'CURRENT PRINCIPAL'
3276 O**********                         85 'PART SOLD AMOUNT'                                201123
     O                                           90 'PART SOLD AMOUNT'
3277 O                                          115 'DIFFERENCE'
3278 O**********D    64                  0  1                                                 CFC006
     O**********D    64 36               0  1                                        CFC006 MD020118
     O          D    64 39               0  1                                               MD020118
3279 O                       LNRF                13
3280 O                       CNUML               26
     O                       OLNOZ               40
3281 O**********          55   CPAM      56 ' ,   ,   ,   , 0 -'                              201123
     O                  55   CPAM                68 ' ,   ,   ,   , 0 -'
3282 O**********          56   CPAM      56 '   ,   ,   , 0 . -'                              201123
     O                  56   CPAM                68 '   ,   ,   , 0 . -'
3283 O**********          57   CPAM      56 '  ,   ,   , 0 .  -'                              201123
     O                  57   CPAM                68 '  ,   ,   , 0 .  -'
3284 O**********          58   CPAM      56 ' ,   ,   , 0 .   -'                              201123
     O                  58   CPAM                68 ' ,   ,   , 0 .   -'
3285 O**********          55   PSAM      86 ' ,   ,   ,   , 0 -'                              201123
     O                  55   PSAM                91 ' ,   ,   ,   , 0 -'
3286 O**********          56   PSAM      86 '   ,   ,   , 0 . -'                              201123
     O                  56   PSAM                91 '   ,   ,   , 0 . -'
3287 O**********          57   PSAM      86 '  ,   ,   , 0 .  -'                              201123
     O                  57   PSAM                91 '  ,   ,   , 0 .  -'
3288 O**********          58   PSAM      86 ' ,   ,   , 0 .   -'                              201123
     O                  58   PSAM                91 ' ,   ,   , 0 .   -'
3289 O                  55   DIFF               116 ' ,   ,   ,   , 0 -'
3290 O                  56   DIFF               116 '   ,   ,   , 0 . -'
3291 O                  57   DIFF               116 '  ,   ,   , 0 .  -'
3292 O                  58   DIFF               116 ' ,   ,   , 0 .   -'
     O**********E            NODTL            03                                       S01117 CFC006
     O**********E    36      NODTL            03                                     CFC006 MD020118
     O          E    39      NODTL            03                                            MD020118
3260 O                                           24 'REFERENCE LE0450P2'        S01117
3261 O                       TITL                89                             S01117
3262 O                                          104 'DATE'                      S01117
3263 O                       RUNA               112                             S01117
3264 O                                          122 'PAGE'                      S01117
3265 O                       PAGE2         Z    127                             S01117
3266 O**********E            NODTL       2  1                                          S01117 CFC006
     O**********E    36      NODTL       2  1                                        CFC006 MD020118
     O          E    39      NODTL       2  1                                               MD020118
3267 O                                           69 'PART SOLD EXCEPTION '      S01117
3268 O                                           75 'REPORT'                    S01117
3269 O**********E            NODTL                                                     S01117 CFC006
     O**********E    36      NODTL                                                   CFC006 MD020118
     O          E    39      NODTL                                                          MD020118
3270 O                                           69 '--------------------'      S01117
3271 O                                           75 '------'                    S01117
3293 O          T    L1NU7 08            3                                      S01117
     O*********AND   36                                                              CFC006 MD020118
     O         AND   39                                                                     MD020118
3293 O         OR    LRNU7 08                                                   S01117
     O*********AND   36                                                              CFC006 MD020118
     O         AND   39                                                                     MD020118
3294 O                                           68 '*** NO DETAILS TO'         E14936
3294 O                                           79 'REPORT ***'                E14936
3293 O**********T    L1NU7               3                                                    CFC006
     O**********T    L1NU7 36            3                                           CFC006 MD020118
     O          T    L1NU7 39            3                                                  MD020118
3294 O                                           59 'TOTAL OF EXCEPTIONS'
3295 O                       NORPRT        3     69
3296 O**********TF   LR U7               3  3                                                 CFC006
     O**********TF   LR U7 36            3  3                                        CFC006 MD020118
     O          TF   LR U7 39            3  3                                               MD020118
3297 O                                           51 '*** REFERENCE LE0450'
3298 O***********                        71 '- DATABASE ERROR AT'         S01117
3298 O                                           71 'DATABASE ERROR ***'        S01117
3299 O***********              DBASE     74                               S01117
3300 O********T**      LR U7                                              S01117
3301 O***********                        39 'FILENAME'                    S01117
3302 O***********              DBFILE    45                               S01117
3303 O***********                        50 'KEY'                         S01117
3304 O***********              DBKEY     80                               S01117
3252 O**********T    L1    33            3                                             S01117 CFC006
     O**********T    L1 36 33            3                                           CFC006 MD020118
     O          T    L1 39 33            3                                                  MD020118
3252 O*********OR    LR    33                                                          S01117 CFC006
     O*********OR    LR 36 33                                                        CFC006 MD020118
     O         OR    LR 39 33                                                               MD020118
     O                                           66 '*** END OF REPORT FOR'     S01117
     O                                           73 'BRANCH'                    S01117
     O                       BRCA                77                             S01117
     O                                           81 '***'                       S01117
3293 O********T*3      LRNU7                                     E14936   S01117
3293 O          T    LRNU7N33            3                                      S01117
     O*********AND   36                                                              CFC006 MD020118
     O         AND   39                                                                     MD020118
3294 O                                           76 '*** END OF REPORT ***'     E14936
3212 O**
3213 O**   A/C KEYS PRODUCED REPORT
3214 O**
     O/COPY WNCPYSRC,LEH01017
3215 O***LE0450P1  H    OF                       03                                    S01124 CFC006
     OLE0450P1  H    OF 59                    03
     O*******OR*       LR                                           S01117BHF659
     O*********OR    LR 09                                                             BHF659 CFC006
     O         OR    LR 09 59                                                                 CFC006
3216 O***********                        22 'REFERENCE LE0450'            S01117
3216 O                                           24 'REFERENCE LE0450P1'        S01117
3217 O                       TITL                89
3218 O                                          104 'DATE'
3219 O                       RUNA               112
3220 O                                          122 'PAGE'
3221 O                       PAGE1         Z    127
3222 O**********H    OF                  2  1                                                 CFC006
     O          H    OF 59               2  1                                                 CFC006
     O*******OR*       LR                                           S01117BHF659
     O*********OR    LR 09                                                             BHF659 CFC006
     O         OR    LR 09 59                                                                 CFC006
3223 O                                           67 'LOAN ACCOUNT KEYS '
3224 O                                           76 'GENERATED'
     O               33                          85 'BRANCH'                    S01117
     O               33      BRCA                89                             S01117
     O               33NU7                       90 '-'                         S01117
     O***********      33NU7   BRNM     120                        S01117 157750
     O               33NU7   WBRNM              120                             157750
3225 O**********H    OF                                                                       CFC006
     O          H    OF 59                                                                    CFC006
     O*******OR*       LR                                           S01117BHF659
     O*********OR    LR 09                                                             BHF659 CFC006
     O         OR    LR 09 59                                                                 CFC006
3226 O                                           67 '------------------'
3227 O                                           76 '---------'
3228 O**********H    OF                  2  2                                          S01117 CFC006
     O          H    OF 59               2  2                                                 CFC006
     O*******OR*       LR                                           S01117BHF659
     O*********OR    LR 09                                                             BHF659 CFC006
     O         OR    LR 09 59                                                                 CFC006
3229 O                                           14 'CUSTOMER'
     O                                           36 'ORIG BORROWER'
3230 O**********                         30 'LOAN NO'                                         201123
     O                                           52 'LOAN NO'
3230 O***********                        26 'LOAN NO'
3231 O***********                        37 'BRANCH'                      S01117
3232 O***********                        53 'ACCOUNT KEY'
3233 O***********                        71 'AMOUNT'
3234 O***********                        83 'CURRENCY'
3232 O**********                         51 'ACCOUNT KEY'                                     201123
     O                                           73 'ACCOUNT KEY'
3233 O**********                         71 'AMOUNT'                                          201123
     O                                           93 'AMOUNT'
3234 O**********                         81 'CURRENCY'                                        201123
     O                                          103 'CURRENCY'
3235 O**********                         96 'REV IND'                                         201123
     O                                          118 'REV IND'
3236 O**********EF   50                  0  1                                                 CFC006
     O          EF   50 59               0  1                                                 CFC006
3237 O                       CNUML               13
     O**********          34   OLNO      13                               S01260              201123
     O                       OLNOZ               32
3238 O**********               LNRF      30                                                   201123
     O                       LNRF                52
3238 O***********              LNRF      26
3239 O****                     BRCDL     35                               S01117
3240 O***********              AKY       52
3241 O***********         55   ACAMNT    74 ' ,   ,   ,   , 0 -'
3242 O***********         56   ACAMNT    74 '   ,   ,   , 0 . -'
3243 O***********         57   ACAMNT    74 '  ,   ,   , 0 .  -'
3244 O***********         58   ACAMNT    74 ' ,   ,   , 0 .   -'
3245 O***********              CCYL      80
3240 O**********               AKY       50                                                   201123
     O*************************AKY       72                                            201123 CLE042
     O                       AKY                 75
3241 O**********          55   ACAMNT    71 ' ,   ,   ,   , 0 -'                              201123
     O                  55   ACAMNT              93 ' ,   ,   ,   , 0 -'
3242 O**********          56   ACAMNT    71 '   ,   ,   , 0 . -'                              201123
     O                  56   ACAMNT              93 '   ,   ,   , 0 . -'
3243 O**********          57   ACAMNT    71 '  ,   ,   , 0 .  -'                              201123
     O                  57   ACAMNT              93 '  ,   ,   , 0 .  -'
3244 O**********          58   ACAMNT    71 ' ,   ,   , 0 .   -'                              201123
     O                  58   ACAMNT              93 ' ,   ,   , 0 .   -'
3245 O**********               CCYL      78                                                   201123
     O                       CCYL               100
3246 O**********                         93 '0'                                               201123
     O                                          115 '0'
3247 O**********          46             93 '1'                                               201123
     O                  46                      115 '1'
3247 O**********          53             93 '1'                           S01270              201123
     O                  53                      115 '1'
     O**********          21             93 '1'                           CLE005              201123
     O                  21                      115 '1'
3248 O                     60                   125 'FOR ACCRUAL REPORT - BAC'
3249 O                     60                   131 'K VAL.'
3250 O                     61                   125 'FOR ACCRUAL REPORT - MAN'
3251 O                     61                   131 '. ADJ.'
     O**********E            NODTL            03                                       S01117 CFC006
     O          E    59      NODTL            03                                              CFC006
3216 O                                           24 'REFERENCE LE0450P1'        S01117
3217 O                       TITL                89                             S01117
3218 O                                          104 'DATE'                      S01117
3219 O                       RUNA               112                             S01117
3220 O                                          122 'PAGE'                      S01117
3221 O                       PAGE1         Z    127                             S01117
3222 O**********E            NODTL       2  1                                          S01117 CFC006
     O          E    59      NODTL       2  1                                                 CFC006
3223 O                                           67 'LOAN ACCOUNT KEYS '        S01117
3224 O                                           76 'GENERATED'                 S01117
3225 O**********E            NODTL                                                     S01117 CFC006
     O          E    59      NODTL                                                            CFC006
3226 O                                           67 '------------------'        S01117
3227 O                                           76 '---------'                 S01117
     O**********TF   LR U7               3  3                                                 CFC006
     O          TF   LR U7 59            3  3                                                 CFC006
     O                                           51 '*** REFERENCE LE0450'      S01117
     O                                           71 'DATABASE ERROR ***'        S01117
3293 O          T    L1NU7 07            3                                      S01117
     O         AND   59                                                                       CFC006
3293 O         OR    LRNU7 07                                                   S01117
     O         AND   59                                                                       CFC006
3294 O                                           68 '*** NO DETAILS TO'         E14936
3294 O                                           79 'REPORT ***'                E14936
3252 O**********T    L1NU7               3                                             S01117 CFC006
     O          T    L1NU7 59            3                                                    CFC006
3253 O                                           49 'TOTAL ACCOUNT KEYS'
3254 O                                           59 'GENERATED'
3255 O                       NORKR         3     69
3252 O**********T    L1    33            3                                             S01117 CFC006
     O          T    L1 59 33            3                                                    CFC006
3252 O*********OR    LR    33                                                          S01117 CFC006
     O         OR    LR 59 33                                                                 CFC006
     O                                           66 '*** END OF REPORT FOR'     S01117
     O                                           73 'BRANCH'                    S01117
     O                       BRCA                77                             S01117
     O                                           81 '***'                       S01117
3293 O********T*3      LRNU7                                       E14936 S01117
3293 O          T    LRNU7N33            3                                      S01117
     O         AND   59                                                                       CFC006
3294 O                                           76 '*** END OF REPORT ***'     E14936
3392 O**
3393 O**   OUTPUT NEW LOANS FILE
3394 O**
     O***/COPY*WNCPYSRC,LEH01018                                                              CFC006
     O/COPY WNCPYSRC,LEH01018                                                               MD020563
3395 ONCLONHH   D    01
3396 O                                            1 'H'
3397 O**********                                  7 '000000'                                  CLE148
     O                                            7 '      '                                  CLE148
3398 ONCLONCL   D    62
3399 O                       LOTA1              256
3400 O**********               LOTA2    400                               S01220
3400 O*************************LOTA2****436                         S01220S01465
     O                       LOTA2              458                             S01465
     O***********              LOTA3   1284                               CLE004
     O***********              LOTA3   1290                        CEU004 CPL002
     O***********              LOTA3   1187                        CAC001 CLE004
     O***********              LOTA3   1092                        S01486 CAC001
     O***********              LOTA3   1087                        S01518 S01486
     O***********              LOTA3   1299                        CPL002 CPB001
     O**********               LOTA3   1300                        CPB001 CLE011
     O**********               LOTA3   1310                                            CLE011 CAS001
     O**********               LOTA3   1348                                            CAS001 CLE028
     O**********               LOTA3   1375                                            CLE028 CAS004
     O**********               LOTA3   1389                                            CAS004 CAS005
     O**********               LOTA3   1466                                            CAS005 CLE031
     O**********               LOTA3   1492                                            CLE031 CLE034
     O**********               LOTA3   1493                                            CLE034 CAP074
     O**********               LOTA3   1560                                            CAP074 CGL029
     O**********               LOTA3   1632                                            CGL029 CAS009
     O**********               LOTA3   1744                                            CAS009 CLE106
     O*************************LOTA3   1748                                            CLE106 CLE042
     O**********               LOTA3   1773                                          CLE042 BUG22966
     O**********               LOTA3   1782                                          BUG22966 CRE073
     O                       LOTA3             1829
     O                       LOTA4             1905                                           CLE134
     O                       LOTA5             2025                                           CLE141
3401 O                       RECIL                1
     O                       PTYP                11                             S01270
     O                       LTYP                22                             S01270
     O                       SUTP                24                             S01270
     O                       MDAT                33P                            S01270
     O                       CCYL                49                             S01270
3402 O                       CPAM                56P
     O/COPY WNCPYSRC,LE0450O002
3403 O                       INTRL               63P
3404 O                       BRTTL               65
3405 O                       BRTEL               71P
3406 O                       RTSPL               77P
     O*                                                                   S01408
     O** Core hook for externalisation.                                   S01408
     O/COPY WNCPYSRC,LE0450OPG                                            S01408
     O*                                                                   S01408
3407 O                       SPINL               82
     O                       CHINL               83
     O/COPY WNCPYSRC,LE0450O001
     O                       WWREPT              91                                           CLE154
3408 O                       RAMT                98P
     O               17      NLRAX               98P                            166149
3409 O                       NRPD               101P
3410 O                       RFRQ               102
3411 O                       RDYN               104
3412 O                       AUTOL              117
3413 O                       PSAM               124P
     O                       BCXR               131P                            123335
     O                       FCXR               138P                            S01270
     O***********      18      NBCE     131P                       135621 143511
     O               19      NBCE               131P                            143511
     O**********       19      NFCE     138P                                           135621 CLE023
     O               22      NFCE               138P
     O               19      SDST               140                             144915
     O**********       19      OSDA     152                                            144915 CGL029
     O               19      OSDA              1578
     O               19      TSTN               162                             144915
     O               19      MDST               164                             144915
     O**********       19      OMDA     176                                            144915 CGL029
     O               19      OMDA              1596
     O               19      TMAN               186                             144915
     O               19      FACOL              196                             144915
3414 O                       RLDT               199P
3415 O                       NROD               202P
3416 O                       RLFQ               203
3417 O                       RLDY               205
3418 O                       NBRA               208
3419 O                       NRTS               214P
3420 O                       NSIN               215
3421 O                       NCAC               216
3422 O                       AWTP               223P
3423 O                       WTRD               230P
3424 O                       WTWD               237P
3425 O                       IWOD               244P
3426 O                       PWOD               251P
     O                       BMDI               252                             123335
     O                       FMDI               253                             123335
     O***********      18      NBMD     252                        135621 144915
     O               19      NBMD               252                             144915
     O**********       19      NFMD     253                                            135621 CLE023
     O               22      NFMD               253
     O/COPY WNCPYSRC,LE0450O003
3427 O                       PDIN               260P
     O                       OSDB               267                             S01117
     O               19      RPSB               267                             144915
     O                       OMDB               270                             S01117
     O                       ORBR               273                             S01117
     O                       PRFC               277                             S01117
     O                     81MDAT                33P                            S01392
     O                     81Z5                 199P                            S01392
     O                     81TOTI               305P                            S01392
3428 O                       ICBS               297
3429 O                       IPFR               298
3430 O                       NIDT               308P
3431 O                       IBDT               311P
3432 O                       SLID               314P
3433 O                       AIPD               321P
3434 O                       DLRC               324P
3435 O                       IACD               327P
3436 O**********               AITC     334P                                                AR317587
     O               45      AITCL              334P                                              AR
     O              N45      AITC               334P                                              AR
3437 O                       TFEP               341P
3438 O                       AIAP               348P
3439 O                       IPRD               355P
3440 O                       IPRM               362P
3441 O                       ICTD               369P
3442 O                       AIMN               376P
3443 O                       RBDT               379P
3444 O                       NOPS               381P
     O                       NCHI               382
3445 O                       IFDY               385
3446 O                       LONI               386
     O                       CNFI               387                             S01270
3447 O                       ACEI               388
3448 O                       TLXI               389
3449 O                       CBLI               390
     O               25      NIPD               454P                            S01465
     O               25      NMDT               457P                            S01465
     O               19      RSTM               460                             144915
     O**********       19      RONS     472                                            144915 CGL029
     O               19      RONS              1614
     O               19      RIBN               480                             144915
     O               19      RIBA               515                             144915
     O               19      ROBN               521                             144915
     O               19      ROCN               527                             144915
     O               19      PAYSET            1087                             144915
     O                       PTFR              1091                             S01486
     O                       HLEX              1092                             S01486
     O                       FSRPL             1098P                            CAC001
     O                       FSGNL             1099                             CAC001
     O                       FPRCL             1103                             CAC001
     O                       ACPD              1117P                            CAC001
     O                       ACDA              1124P                            CAC001
     O                       ACAJ              1131P                            CAC001
     O                       ACAP              1138P                            CAC001
     O                       COFD              1145P                            CAC001
     O                       COFM              1152P                            CAC001
     O                       CFCD              1159P                            CAC001
     O                       NFRS              1165P                            CAC001
     O                       NFSN              1166                             CAC001
     O                       NFPC              1170                             CAC001
     O                       PDCF              1177P                            CAC001
     O                       FCTD              1180P                            CAC001
     O                       FWOD              1187P                            CAC001
     O                       LRLD              1281P                            CLE004
     O                       LMCD              1284P                            CLE004
     O                       SCCYL             1287                             CEU004
     O                       ICCYL             1290                             CEU004
     O               19      RRSC              1287                             144915
     O               19      RICY              1290                             144915
     O                       OINR              1296P                            187867
     O**********               OIDT    1293P                       142405 187867
     O                       OIDT              1299P                            187867
     O                       REPI              1300                             CPB001
     O                       RFDY              1302                             CLE011
     O                       RFRI              1303                             CLE011
     O                       RFRT              1309P                            CLE011
     O                       RFAR              1310                             CLE011
     O                       FSYLDC            1315
     O                       FSFYLD            1320
     O                       FSURPL            1327P
     O                       FSPLAM            1334P
     O                       FSPLDT            1341P
     O                       FSYUPL            1348P
     O                       ADIF              1349
     O                       ADCF              1350
     O                       CHGA              1357P
     O                       ICIF              1358
     O                       FLTI              1365P
     O                       FRPD              1368P
     O                       WACCH             1375P
     O                       FSEFUP            1382P
     O                       FSECUP            1389P
     O                       AIPN              1396P
     O                       AITN              1403P
     O                       AIAN              1410P
     O                       IPRN              1417P
     O                       AINN              1424P
     O                       TOTN              1431P
     O                       ICTN              1438P
     O                       IWON              1445P
     O                       IPNM              1452P
     O                       PDNN              1459P
     O                       FSCPAM            1466P
     O                       FPAML             1473P
     O                       REXRL             1480P
     O                       REXIL             1481
     O                       PSCYL             1484
     O                       PEXRL             1491P
     O                       PEXIL             1492
     O              N23      STALL             1493
     O               23      RSTA              1493
     O                       FRNT              1513
     O                       AFRT              1533
     O                       REPA              1534
     O                       TMST              1560
     O                       OSDA              1578
     O                       OMDA              1596
     O**********               RONS    1614                                            CAS009 239970
     O**********               PONS    1632                                            CAS009 239970
     O*************************TFDP    1640P                                           CAS009 CLE042
     O*************************TFDPA   1648P                                           CAS009 CLE042
     O*************************TFAM    1656P                                           CAS009 CLE042
     O*************************TFAC    1664P                                           CAS009 CLE042
     O*************************TFOF    1672P                                           CAS009 CLE042
     O*************************AFDP    1680P                                           CAS009 CLE042
     O*************************CFDP    1688P                                           CAS009 CLE042
     O*************************AMDS    1696P                                           CAS009 CLE042
     O*************************AMADJ   1704P                                           CAS009 CLE042
     O*************************ANADJ   1712P                                           CAS009 CLE042
     O*************************DSAM    1720P                                           CAS009 CLE042
     O*************************AMCOST  1728P                                           CAS009 CLE042
     O*************************YMCOST  1736P                                           CAS009 CLE042
     O*************************YAINT   1744P                                           CAS009 CLE042
     O*************************BASRL   1638P                                           CLE036 CLE042
     O*************************NBSR    1644P                                           CLE036 CLE042
     O*************************SLTP    1646                                            CLE106 CLE042
     O*************************SLST    1648                                            CLE106 CLE042
     O                       TFDP              1641P
     O                       TFDPA             1649P
     O                       TFAM              1657P
     O                       TFAC              1665P
     O                       TFOF              1673P
     O                       AFDP              1681P
     O                       CFDP              1689P
     O                       AMDS              1697P
     O                       AMADJ             1705P
     O                       ANADJ             1713P
     O                       DSAM              1721P
     O                       AMCOST            1729P
     O                       YMCOST            1737P
     O                       YAINT             1745P
     O                       BASRL             1751P
     O                       NBSR              1757P
     O                       SLTP              1759
     O                       SLST              1761
     O                       CLAS              1765
     O                       DFCL              1769
     O                       SLCL              1773
     O**********               ISDT    1776                                        BUG22966 BUG23094
     O**********               FMDT    1779                                        BUG22966 BUG23094
     O                       ISDT              1776P                                              BU
     O                       FMDT              1779P                                              BU
     O                       LOIC              1782                                               BU
     O                       OCDT              1785P
     O                       EAIR              1793P
     O**********               CNSPO   1799P                                         CRE073 AR824724
     O**********               CNSGO   1800                                          CRE073 AR824724
     O**********               RDMTO   1807                                          CRE073 AR824724
     O**********               RDFDO   1811                                          CRE073 AR824724
     O                       CNSP              1799P                                              AR
     O                       CNSG              1800                                               AR
     O                       RDMT              1807                                               AR
     O                       RDFD              1811                                               AR
      *                                                                                       CLE134
     O                       FAMU              1830                                           CLE134
     O                       FPNR              1831                                           CLE134
     O                       RIDT              1834P                                          CLE134
     O                       RIDC              1836P                                          CLE134
     O                       RCAT              1837                                           CLE134
     O                       RCAC              1839P                                          CLE134
     O                       RCSD              1842P                                          CLE134
     O                       RCDY              1844P                                          CLE134
     O                       RICC              1846P                                          CLE134
      *                                                                                       CLE134
     O                       BIDT              1849P                                          CLE134
     O                       BIDC              1851P                                          CLE134
     O                       BCAT              1852                                           CLE134
     O                       BCAC              1854P                                          CLE134
      *                                                                                       CLE134
     O                       BCSD              1857P                                          CLE134
     O                       BCDY              1859P                                          CLE134
     O                       BICC              1861P                                          CLE134
      *                                                                                       CLE134
     O                       XRFI              1864                                           CLE134
     O                       XRFN              1874                                           CLE134
      *                                                                   CAC001
      *                                                                   CAC001
3450 ONCLONCK   D    62
3451 O                       LOTB1              256
3452 O**********               LOTB2    400                                                   CGL029
3452 O                       LOTB2              341
     O***********              LOTB3    469                        S01518 CEU004
     O***********              LOTB3   1120                        CEU004 134798
     O**********               LOTB3    469                                            134798 CGL029
     O                       LOTB3              402
     O***********              LOTB4   1103                        CLE004 123335
     O                       LOTB4              545
     O                       LOTB5             1111                             123335
3453 O                       RECIL                1
3454 O                       OPAM               156P
3455 O                       YPLN               168P
3456 O                       YFLN               175P
3457 O                       YWLN               182P
3458 O                       ABLN               189P
3459 O                       YPLC               196P
3460 O                       YFLC               203P
3461 O                       YWLC               210P
3462 O                       ABLC               217P
3463 O                       WWLN               224P
3464 O                       IWLN               231P
3465 O                       PWLN               238P
     O               28      WFRCO              242                                         MD028338
3466 O                       YILN               341P
     O                       RDST               244                             S01392
     O**********               ORVD     354                               S01392              CGL029
     O                       ORVD              1265
     O                       THRN               364                             S01392
     O                       NPRAM              371P                            S01392
     O               22      WNPRAM             371P
     O                       NDAM               378P                            S01392
     O                       RLBR               381                             S01392
     O                       RRST               402                             S01518
     O**********               RRON     414                                            S01518 CGL029
     O                       RRON              1283
     O                       RRIB               422                             S01518
     O                       RRBA               457                             S01518
     O                       RROB               463                             S01518
     O                       RROC               469                             S01518
     O               19      WNCCY              472
     O               19      WNCPA              479P
     O               22      WNFCE              486P
     O               22      WNFMD              487
     O               19      WNLRA              494P
     O                       RLSB               543
     O                       RPST               545
     O                       ROLPAY            1103                             144915
     O                       WBLN12             557                                                B
     O                       RPON              1301                                                B
     O               19      WNBCE             1110P
     O               19      WNBMD             1111
     O                       RRSC              1114                             CEU004
     O                       RPSC              1117                             CEU004
     O                       RICY              1120                             CEU004
     O                       ECIN              1121                             CEU020
     O                       RPSM              1123                             144915
     O**********               RPOS    1135                                            144915 CGL029
     O                       RPOS              1319
     O                       RPTS              1145                             144915
     O                       RPSB              1148                             144915
     O                       RFAO              1158                             144915
     O                       FSFYLB            1163
     O                       RRSR              1170P
     O                       RRSI              1171
     O                       RPSR              1178P
     O                       RPSI              1179
     O              N23      RSTA              1180
     O               23                        1180 ' '
     O                       FRNT              1200
     O                       AFRT              1220
     O                       REPA              1221
     O                       TMST              1247
     O                       RPOB               606
     O                       RPOC               612
     O                       RRCRX              620
     O                       RRCAX              655
     O*                                                                   S01408
     O** Core hook for externalisation.                                   S01408
     O/COPY WNCPYSRC,LE0450OOPG                                           S01408
     O*                                                                   S01408
3467 ONCLONZ1   T    LR
3468 O                       LOTT1              256
3469 O                       LOTT2              400
3470 O                       NORNL               19P
3471 O                       NORNC               25P
3472 O                       NORNC               34P
3473 O                       VLBFN               42P
3474 O                       VLBLN               44P
3475 O                       VLBFN               72P
3476 O                       VLBLN               74P
3477 O**
3478 O**   OUTPUT TO LKEY1
3479 O**
3480 OLKEY1HH   D    01
3481 O                                            1 'H'
3482 OLKEY1DP   E    50
3483 O                                            1 'G'
3484 O                 N60N61                     1 'D'
     O               54N60N61                     1 'S'                         BH3482
3485 O*************************AKY       11                                                   CLE042
     O                       SHAKY               11
3486 O**********             LNRF                17                                           CLE134
3487 O**********             CNUML               23                                           CLE134
3488 O****                     BRCDL     26                               S01117
3488 O**********             BRCA                26                                    S01117 CLE134
     O**********     79      FEBRCA              26                                           CLE134
3489 O**********             LASQ                28                                           CLE134
3490 O**********             ACDATE              31P                                          CLE134
3491 O**********             ACAMNT              38P                                          CLE134
3492 O**********             CCYL                41                                           CLE134
     O**********     79      FEFCCY              41                                           CLE134
3493 O**********                                 43 '00'                                      CLE134
3494 O**********       N60N61SETP                43                                           CLE134
     O**********     79      FESTTL              43                                           CLE134
3495 O**********         N60N61OSAC      55                                                   CGL029
3495 O**********       N60N61OSAC               378                                           CLE134
     O**********     79      FEOURS              55                                           CLE134
     O*******************N60N61OSBR     141                        S01117 LN0169
     O**********       N60N61OSBR               135                                    LN0169 CLE134
3496 O**********                                 56 '0'                                       CLE134
3497 O**********        46                       56 '1'                                       CLE134
     O**********        53                       56 '1'                                S01270 CLE134
     O**********        21                       56 '1'                                CLE005 CLE134
3498 O**********             Z13                 63P                                          CLE134
3499 O**********             Z13                 73P                                          CLE134
3500 O**********             VDATL               76P                                          CLE134
3501 O**********             SLIDL               79P                                          CLE134
     O**********     79      FEPSTD              79P                                          CLE134
3502 O**********             MDAT                82P                                          CLE134
     O**********           81RLDT                82P                                   S01392 CLE134
3503 O**********             BRTTL               84                                           CLE134
3504 O**********             BRTEL               90P                                          CLE134
3505 O**********             RTSPL               96P                                          CLE134
3506 O**********             INTRL              102P                                          CLE134
     O**********        66   OINTR              102P                                   E10921 CLE134
3507 O**********                                103 '2'                                       CLE134
3508 O**********        46                      103 '1'                                       CLE134
3509 O**********        60                      103 '4'                                       CLE134
3510 O**********        61                      103 '3'                                       CLE134
3511 O***********              CPAM     110P                              E16442
3511 O**********             OCPAM              110P                                   E16442 CLE134
3511 O**********     83 65   ACRBAL             110P                                          CLE134
3512 O**********             Z5                 113P                                          CLE134
3513 O**********                                114 '0'                                       CLE134
3514 O**********        65   IACDL              113P                                          CLE134
3515 O**********        65   ICBS               114                                           CLE134
3516 O**********             ACOF               116                                           CLE134
     O**********             FACOL              128                                    S05452 CLE134
     O**********       N32   FACO               128                                    S05452 CLE134
3516 O*************************PELAP    131P                       E47260 LN0169
     O*************************LORED    134P                       E47260 LN0169
     O*************************PRFC     138                        S01117 LN0169
     O**********             PRFC               132                                    LN0169 CLE134
     O**********             BOKC               137                                    111688 CLE134
3516 O**********             PELAP              140P                                   LN0169 CLE134
     O**********             LORED              143P                                   LN0169 CLE134
     O****************         OLNO     147P                        S01260BHF420
     O**********             OLNO               149                                    BHF420 CLE134
     O**********             PTFR               153                                    085807 CLE134
     O**********             LKSCCY             156                                    CEU004 CLE134
     O**********             ANUM               162                                    135145 CLE134
     O**********             ROLN               168                                    157643 CLE134
     O**********        67   GASS               169                                    156585 CLE134
     O**********             F1FFLG             170                                           CLE134
     O**********             F1FVAL             177P                                          CLE134
     O**********             F1FPCT             182                                           CLE134
     O**********             WRACT              202                                           CLE134
     O**********             WRCTY              204                                           CLE134
     O**********             WRBNK              224                                           CLE134
     O**********             WRCDE              235                                           CLE134
     O**********             WPACT              255                                           CLE134
     O**********             WPCTY              257                                           CLE134
     O**********             WPBNK              277                                           CLE134
     O**********             WPCDE              288                                           CLE134
     O**********             WDACT              323                                           CLE134
     O**********             WDCTY              325                                           CLE134
     O**********             WDBNK              345                                           CLE134
     O**********             WSDAT              348P                                          CLE134
     O**********       N60N61F1RACT             202                                           CLE134
     O**********       N60N61F1RCTY             204                                           CLE134
     O**********       N60N61F1RBNK             224                                           CLE134
     O**********       N60N61F1RCDE             235                                           CLE134
     O**********       N60N61F1PACT             255                                           CLE134
     O**********       N60N61F1PCTY             257                                           CLE134
     O**********       N60N61F1PBNK             277                                           CLE134
     O**********       N60N61F1PCDE             288                                           CLE134
     O**********       N60N61F1DACT             323                                           CLE134
     O**********       N60N61F1DCTY             325                                           CLE134
     O**********       N60N61F1DBNK             345                                           CLE134
     O**********       N60N61F1SDAT             348P                                          CLE134
     O**********             SIND               349                                           CLE134
     O**********             RIND               350                                           CLE134
     O**********             OKEY               360                                           CLE134
     O**********             AKY                392                                           CLE134
     O**********             QQLNNO              15P                                CLE134 AR1056323
     O**********             LNRF               396                                 CLE134 AR1056323
     O**********             CNUML               21                                 CLE134 AR1056323
     O**********             BRCA                24                                 CLE134 AR1056323
     O**********     79      FEBRCA              24                                 CLE134 AR1056323
     O**********             LASQ                26                                 CLE134 AR1056323
     O**********             ACDATE              29P                                CLE134 AR1056323
     O**********             ACAMNT              36P                                CLE134 AR1056323
     O**********             CCYL                39                                 CLE134 AR1056323
     O**********     79      FEFCCY              39                                 CLE134 AR1056323
     O**********                                 41 '00'                            CLE134 AR1056323
     O**********       N60N61SETP                41                                 CLE134 AR1056323
     O**********     79      FESTTL              41                                 CLE134 AR1056323
     O**********       N60N61OSAC               376                                 CLE134 AR1056323
     O**********     79      FEOURS              53                                 CLE134 AR1056323
     O**********       N60N61OSBR               133                                 CLE134 AR1056323
     O**********                                 54 '0'                             CLE134 AR1056323
     O**********        46                       54 '1'                             CLE134 AR1056323
     O**********        53                       54 '1'                             CLE134 AR1056323
     O**********        21                       54 '1'                             CLE134 AR1056323
     O**********             Z13                 61P                                CLE134 AR1056323
     O**********             Z13                 71P                                CLE134 AR1056323
     O**********             VDATL               74P                                CLE134 AR1056323
     O**********             SLIDL               77P                                CLE134 AR1056323
     O**********     79      FEPSTD              77P                                CLE134 AR1056323
     O**********             MDAT                80P                                CLE134 AR1056323
     O**********           81RLDT                80P                                CLE134 AR1056323
     O**********             BRTTL               82                                 CLE134 AR1056323
     O**********             BRTEL               88P                                CLE134 AR1056323
     O**********             RTSPL               94P                                CLE134 AR1056323
     O**********             INTRL              100P                                CLE134 AR1056323
     O**********        66   OINTR              100P                                CLE134 AR1056323
     O**********                                101 '2'                             CLE134 AR1056323
     O**********        46                      101 '1'                             CLE134 AR1056323
     O**********        60                      101 '4'                             CLE134 AR1056323
     O**********        61                      101 '3'                             CLE134 AR1056323
     O**********             OCPAM              108P                                CLE134 AR1056323
     O**********     83 65   ACRBAL             108P                                CLE134 AR1056323
     O**********             Z5                 111P                                CLE134 AR1056323
     O**********                                112 '0'                             CLE134 AR1056323
     O**********        65   IACDL              111P                                CLE134 AR1056323
     O**********        65   ICBS               112                                 CLE134 AR1056323
     O**********             ACOF               114                                 CLE134 AR1056323
     O**********             FACOL              126                                 CLE134 AR1056323
     O**********       N32   FACO               126                                 CLE134 AR1056323
     O**********             PRFC               130                                 CLE134 AR1056323
     O**********             BOKC               135                                 CLE134 AR1056323
     O**********             PELAP              138P                                CLE134 AR1056323
     O**********             LORED              141P                                CLE134 AR1056323
     O**********             OLNO               147                                 CLE134 AR1056323
     O**********             PTFR               151                                 CLE134 AR1056323
     O**********             LKSCCY             154                                 CLE134 AR1056323
     O**********             ANUM               166                                 CLE134 AR1056323
     O**********             ROLN               166                                 CLE134 AR1056323
     O**********        67   GASS               167                                 CLE134 AR1056323
     O**********             F1FFLG             168                                 CLE134 AR1056323
     O**********             F1FVAL             175P                                CLE134 AR1056323
     O**********             F1FPCT             180                                 CLE134 AR1056323
     O**********             WRACT              200                                 CLE134 AR1056323
     O**********             WRCTY              202                                 CLE134 AR1056323
     O**********             WRBNK              222                                 CLE134 AR1056323
     O**********             WRCDE              233                                 CLE134 AR1056323
     O**********             WPACT              253                                 CLE134 AR1056323
     O**********             WPCTY              255                                 CLE134 AR1056323
     O**********             WPBNK              275                                 CLE134 AR1056323
     O**********             WPCDE              286                                 CLE134 AR1056323
     O**********             WDACT              321                                 CLE134 AR1056323
     O**********             WDCTY              323                                 CLE134 AR1056323
     O**********             WDBNK              343                                 CLE134 AR1056323
     O**********             WSDAT              346P                                CLE134 AR1056323
     O**********       N60N61F1RACT             200                                 CLE134 AR1056323
     O**********       N60N61F1RCTY             202                                 CLE134 AR1056323
     O**********       N60N61F1RBNK             222                                 CLE134 AR1056323
     O**********       N60N61F1RCDE             233                                 CLE134 AR1056323
     O**********       N60N61F1PACT             253                                 CLE134 AR1056323
     O**********       N60N61F1PCTY             255                                 CLE134 AR1056323
     O**********       N60N61F1PBNK             275                                 CLE134 AR1056323
     O**********       N60N61F1PCDE             286                                 CLE134 AR1056323
     O**********       N60N61F1DACT             321                                 CLE134 AR1056323
     O**********       N60N61F1DCTY             323                                 CLE134 AR1056323
     O**********       N60N61F1DBNK             343                                 CLE134 AR1056323
     O**********       N60N61F1SDAT             346P                                CLE134 AR1056323
     O**********             SIND               347                                 CLE134 AR1056323
     O**********             RIND               348                                 CLE134 AR1056323
     O**********             OKEY               358                                 CLE134 AR1056323
     O**********             AKY                390                                 CLE134 AR1056323
     O                       LNRF                17                                        AR1056323
     O                       CNUML               23                                        AR1056323
     O                       BRCA                26                                        AR1056323
     O               79      FEBRCA              26                                        AR1056323
     O                       LASQ                28                                        AR1056323
     O                       ACDATE              31P                                       AR1056323
     O                       ACAMNT              38P                                       AR1056323
     O                       CCYL                41                                        AR1056323
     O               79      FEFCCY              41                                        AR1056323
     O                                           43 '00'                                   AR1056323
     O                 N60N61SETP                43                                        AR1056323
     O               79      FESTTL              43                                        AR1056323
     O                 N60N61OSAC               378                                        AR1056323
     O**********     79      FEOURS              55                              AR1056323 AR1085229
     O               79      FEOURS             378                                        AR1085229
     O                 N60N61OSBR               135                                        AR1056323
     O                                           56 '0'                                    AR1056323
     O                  46                       56 '1'                                    AR1056323
     O                  53                       56 '1'                                    AR1056323
     O                  21                       56 '1'                                    AR1056323
     O                       Z13                 63P                                       AR1056323
     O                       Z13                 73P                                       AR1056323
     O                       VDATL               76P                                       AR1056323
     O                       SLIDL               79P                                       AR1056323
     O               79      FEPSTD              79P                                       AR1056323
     O                       MDAT                82P                                       AR1056323
     O                     81RLDT                82P                                       AR1056323
     O                       BRTTL               84                                        AR1056323
     O                       BRTEL               90P                                       AR1056323
     O                       RTSPL               96P                                       AR1056323
     O                       INTRL              102P                                       AR1056323
     O                  66   OINTR              102P                                       AR1056323
     O                                          103 '2'                                    AR1056323
     O                  46                      103 '1'                                    AR1056323
     O                  60                      103 '4'                                    AR1056323
     O                  61                      103 '3'                                    AR1056323
     O                       OCPAM              110P                                       AR1056323
     O               83 65   ACRBAL             110P                                       AR1056323
     O                       Z5                 113P                                       AR1056323
     O                                          114 '0'                                    AR1056323
     O                  65   IACDL              113P                                       AR1056323
     O                  65   ICBS               114                                        AR1056323
     O                       ACOF               116                                        AR1056323
     O                       FACOL              128                                        AR1056323
     O                 N32   FACO               128                                        AR1056323
     O                       PRFC               132                                        AR1056323
     O                       BOKC               137                                        AR1056323
     O                       PELAP              140P                                       AR1056323
     O                       LORED              143P                                       AR1056323
     O                       OLNO               149                                        AR1056323
     O                       PTFR               153                                        AR1056323
     O                       LKSCCY             156                                        AR1056323
     O                       ANUM               162                                        AR1056323
     O                       ROLN               168                                        AR1056323
     O                  67   GASS               169                                        AR1056323
     O                       F1FFLG             170                                        AR1056323
     O                       F1FVAL             177P                                       AR1056323
     O                       F1FPCT             182                                        AR1056323
     O                       WRACT              202                                        AR1056323
     O                       WRCTY              204                                        AR1056323
     O                       WRBNK              224                                        AR1056323
     O                       WRCDE              235                                        AR1056323
     O                       WPACT              255                                        AR1056323
     O                       WPCTY              257                                        AR1056323
     O                       WPBNK              277                                        AR1056323
     O                       WPCDE              288                                        AR1056323
     O                       WDACT              323                                        AR1056323
     O                       WDCTY              325                                        AR1056323
     O                       WDBNK              345                                        AR1056323
     O                       WSDAT              348P                                       AR1056323
     O                 N60N61F1RACT             202                                        AR1056323
     O                 N60N61F1RCTY             204                                        AR1056323
     O                 N60N61F1RBNK             224                                        AR1056323
     O                 N60N61F1RCDE             235                                        AR1056323
     O                 N60N61F1PACT             255                                        AR1056323
     O                 N60N61F1PCTY             257                                        AR1056323
     O                 N60N61F1PBNK             277                                        AR1056323
     O                 N60N61F1PCDE             288                                        AR1056323
     O                 N60N61F1DACT             323                                        AR1056323
     O                 N60N61F1DCTY             325                                        AR1056323
     O                 N60N61F1DBNK             345                                        AR1056323
     O                 N60N61F1SDAT             348P                                       AR1056323
     O                       SIND               349                                        AR1056323
     O                       RIND               350                                        AR1056323
     O                       OKEY               360                                        AR1056323
     O                       AKY                392                                        AR1056323
3517 OLKEY1ZZ   T       LR
3518 O                                            1 'T'
3519 O                       NORK                 4P
3520 O                       TOTIKY              12P
3521 O                       TOTDKY              14P
3522 O**
3523 O**   OUTPUT MATURED LOANS AT END OF MONTH
3524 O**
3525 OMATLNHH   D    01
3526 O                                            1 'H'
3527 OMATLNMT   D    63
3528 O                                            1 'D'
3529 O****                     BRCDL      4                               S01117
3529 O                       BRCA                 4                             S01117
3530 O                       CNUML               10
3531 O                       LNRF                16
3532 O                       MDAT                19P
3533 O                       TOTINT              26P
3534 O                       IPRD                33P
3535 O                       ICTD                40P
3536 O                       IWOD                47P
3537 O                       BRTEL               53P
3538 O                       RTSPL               59P
3539 O                       BRTTL               61
3540 O                       SPINL               62
3541 O                       YPLC                69P
3542 O                       YFLC                83P
3543 O                       YWLC                90P
3544 O                       ABLC                97P
3545 O                       CRSK                99
3546 O                       LIND               102
3547 O                       PTYP               104
     O                       FCLB               107                             S01117
     O****************         OLNO     117P                        S01260BHF420
     O                       OLNO               117                             BHF420
     O                       RCSI               118                             S01260
3546 O                       CCYL               121                             E86114
3547 O                       YILN               128P                            E86114
3547 O                       PTFR               132                             S01486
     O                       LOIC               135
3548 OMATLNZX   T    LR
3549 O                                            1 'T'
3550 O                       NORMT                4P
3477 O**                                                                  S10227
3478 O**   OUTPUT TO MCLONCL  AT END OF MONTH                             S10227
3479 O**                                                                  S10227
3398 OMCLONCL   D    63                                                         S10227
3401 O                                            1 'M'                         S01270
3401 O                       LNRF                 7                             S10227
0098 O                                            8 'A'                         S01270
0098 O                       MRIN                 9                             S01270
     O                       PTYP                11                             S01270
     O                       CNUML               17                             S01270
     O                       BRCA                20                             S01270
     O                       LTYP                22                             S01270
     O                       SUTP                24                             S01270
     O                       DDAT                27P                            S01270
     O                       VDATL               30P                            S01270
     O                       MDAT                33P                            S01270
     O                       LASQ                35                             S01270
     O                       FCUS                41                             S01270
     O                       FTYP                44                             S01270
     O                       FSEQ                46                             S01270
     O                       CCYL                49                             S01270
3402 O                       CPAM                56P                            S10227
3402 O                       INTC                57                             S10227
3403 O                       INTRL               63P                            S10227
3404 O                       BRTTL               65                             S10227
3405 O                       BRTEL               71P                            S10227
3406 O                       RTSPL               77P                            S10227
3406 O                       MARG                81P                            S10227
3407 O                       SPINL               82                             S10227
     O                       CHINL               83                             S10227
0122 O                       WTRTL               89P                            S01270
0123 O                       WTINL               90                             S01270
0124 O                       REPTL               91                             S01270
3408 O                       RAMT                98P                            S10227
3409 O                       NRPD               101P                            S10227
3410 O                       RFRQ               102                             S10227
3411 O                       RDYN               104                             S10227
0129 O                       FCCY               107                             S01270
0130 O                       LIND               110                             S01270
0131 O                       CRSK               112                             S01270
0132 O                       ACOF               114                             S01270
0133 O                       NACD               115                             S01270
0134 O                       RELI               116                             S01270
3412 O                       AUTOL              117                             S10227
3413 O                       PSAM               124P                            S10227
0137 O                       BCXR               131P                            S01270
     O                       FCXR               138P                            S01270
0139 O                       SDST               140                             S01270
0140 O**********               OSDA     152                                            S01270 CGL029
0140 O**********             OSDA              1511                                         MD039672
0140 O                       OSDA              1578                                         MD039672
0141 O                       TSTN               162                             S01270
0142 O                       MDST               164                             S01270
0143 O**********               OMDA     176                                            S01270 CGL029
     O**********             OMDA              1529                                         MD039672
     O                       OMDA              1596                                         MD039672
0144 O                       TMAN               186                             S01270
     O                       FACOL              196                             S01270
3414 O                       RLDT               199P                            S10227
3415 O                       NROD               202P                            S10227
3416 O                       RLFQ               203                             S10227
3417 O                       RLDY               205                             S10227
3418 O                       NBRA               208                             S10227
3419 O                       NRTS               214P                            S10227
3420 O                       NSIN               215                             S10227
3421 O                       NCAC               216                             S10227
3422 O                       AWTP               223P                            S10227
3423 O                       WTRD               230P                            S10227
3424 O                       WTWD               237P                            S10227
3425 O                       IWOD               244P                            S10227
3426 O                       PWOD               251P                            S10227
0159 O                       BMDI               252                             S01270
0160 O                       FMDI               253                             S01270
3427 O                       PDIN               260P                            S10227
     O                       LSWCL              262P                                        MD039672
     O                       LSWSL              264P                                        MD039672
3427 O                       OSDB               267                             S10227
3427 O                       OMDB               270                             S10227
3427 O                       ORBR               273                             S10227
3427 O                       PRFC               277                             S10227
3427 O                       FCLB               280                             S10227
3427 O                       BTIN               287                             S10227
     O/COPY WNCPYSRC,LE0450O004
3427 O                       BLDY               289                             S10227
     O/COPY WNCPYSRC,LE0450O005
3427 O                       OLNO               295                             S10227
3427 O                       RCSI               296                             S10227
3428 O                       ICBS               297                             S10227
3429 O                       IPFR               298                             S10227
3429 O                       TOTI               305P                            S10227
3430 O                       NIDT               308P                            S10227
3431 O                       IBDT               311P                            S10227
3432 O                       SLID               314P                            S10227
3433 O                       AIPD               321P                            S10227
3434 O                       DLRC               324P                            S10227
3435 O                       IACD               327P                            S10227
3436 O                       AITC               334P                            S10227
3437 O                       TFEP               341P                            S10227
3438 O                       AIAP               348P                            S10227
3439 O                       IPRD               355P                            S10227
3440 O                       IPRM               362P                            S10227
3441 O                       ICTD               369P                            S10227
3442 O                       AIMN               376P                            S10227
3443 O                       RBDT               379P                            S10227
3444 O                       NOPS               381P                            S10227
     O                       NCHI               382                             S10227
3445 O                       IFDY               385                             S10227
3446 O                       LONI               386                             S10227
     O                       CNFI               387                             S01270
3447 O                       ACEI               388                             S10227
3448 O                       TLXI               389                             S10227
3449 O                       CBLI               390                             S10227
3449 O                       LORED              393P                            S10227
3449 O                       LCD                396P                            S10227
3449 O                       CHTP               397                             S10227
3449 O                       TNLU               400P                            S10227
     O                       BOKC               436                             S01270
3448 O                       OLNRF              406                             BH1022
3449 O                       MLDAT              409P                            BH1022
     O                       ADDI               410                             128054
     O***********      25      NIPD     456P                       S01465 090155
     O***********      25      NMDT     459P                       S01465 090155
     O                       OMDT               451P                                        MD039672
     O               25      NIPD               454P                            090155
     O               25      NMDT               457P                            090155
     O                       APMI               458                             090155
     O***********              LOTA3   1089                         S01518082149
     O***********              LOTA3   1094                         082149090155
     O***********              LOTA3   1092                        090155 CAC001
     O***********              LOTA3   1187                        CAC001 CLE004
     O***********              LOTA3   1284                        CLE004 CEU004
     O***********              LOTA3   1284                        CEU004 134798
     O***********              LOTA3   1290                        134798 CPL002
     O***********              LOTA3   1296                        CPL002 CPB001
     O**********               LOTA3   1300                        CPB001 CLE011
     O**********               LOTA3   1310                                            CLE011 CAS001
     O**********               LOTA3   1348                                            CAS001 CAS004
     O**********               LOTA3   1362                                            CAS004 CAS005
     O**********               LOTA3   1466                                            CAS005 CLE031
     O**********               LOTA3   1492                                            CLE031 CLE034
     O**********               LOTA3   1493                                            CLE034 CAP074
     O**********               LOTA3   1560                                            CAP074 CGL029
     O**********               LOTA3   1565                                           CGL029 BUG5047
     O**********               LOTA3M  1565                                                  BUG5047
     O**********               LOTA3S  1565                                                  BUG5047
     O**********               LOTA3M  1677                                           CAS009 BUG8570
     O*************************LOTA3M  1605                                           BUG8570 CLE042
     O                       LOTA3M            1493
     O**********               LOTA3S  1677                                            CAS009 CLE106
     O*************************LOTA3S  1681                                            CLE106 CLE042
     O**********               LOTA3S  1773                                            CLE042 CER020
     O**********             LOTA3S            1776                                         MD039672
     O                       LOTA3S            1773                                         MD039672
     O                       LOTA4A            1805                                         MD039672
     O                       LOTA4             1881                                           CLE134
     O                       LOTA5             2001                                           CLE141
     O                       FSRPL             1098P                            CAC001
     O                       FSGNL             1099                             CAC001
     O                       FPRCL             1103                             CAC001
     O                       ACPD              1117P                            CAC001
     O                       ACDA              1124P                            CAC001
     O                       ACAJ              1131P                            CAC001
     O                       ACAP              1138P                            CAC001
     O                       COFD              1145P                            CAC001
     O                       COFM              1152P                            CAC001
     O                       CFCD              1159P                            CAC001
     O                       NFRS              1165P                            CAC001
     O                       NFSN              1166                             CAC001
     O                       NFPC              1170                             CAC001
     O                       PDCF              1177P                            CAC001
     O                       FCTD              1180P                            CAC001
     O                       FWOD              1187P                            CAC001
     O                       LRLD              1281P                            CLE004
     O                       LMCD              1284P                            CLE004
     O                       OINR              1296P                            187867
     O********                 OIDT    1290P                       142405 187867
     O                       OIDT              1299P                            187867
     O                       REPI              1300                             187867
     O                       RFDY              1302                             CLE011
     O                       RFRI              1303                             CLE011
     O                       RFRT              1309P                            CLE011
     O                       RFAR              1310                             CLE011
     O**********               ADIF    1311                                            CLE028 218755
     O**********               ADCF    1312                                            CLE028 218755
     O**********               CHGA    1319P                                           CLE028 218755
     O**********               ICIF    1320                                            CLE028 218755
     O**********               FLTI    1327P                                           CLE028 218755
     O**********               FRPD    1330P                                           CLE028 218755
     O**********               WACCH   1337P                                           CLE028 218755
     O                       ADIF              1349
     O                       ADCF              1350
     O                       CHGA              1357P
     O                       ICIF              1358
     O                       FLTI              1365P
     O                       FRPD              1368P
     O                       WACCH             1375P
     O                       FPAML             1473P
     O                       REXRL             1480P
     O                       REXIL             1481
     O                       PSCYL             1484
     O                       PEXRL             1491P
     O                       PEXIL             1492
     O                       STAL              1493
     O**********               FRNT    1513                                           CAP074 BUG5047
     O**********               AFRT    1533                                           CAP074 BUG5047
     O**********               REPA    1534                                           CAP074 BUG5047
     O**********               TMST    1560                                           CAP074 BUG5047
     O                       FRNTL             1513                                         MD039672
     O                       AFRTL             1533                                         MD039672
     O                       TMST              1560                                               BU
     O                       SLTP              1759
     O                       SLST              1761
     O                       CLAS              1765
     O                       DFCL              1769
     O                       SLCL              1773
     O                       LOIC              1776
     O                       OCDT              1779P
     O                       EAIR              1787P
     O**********               CNSPO   1793P                                         CRE073 AR824724
     O**********               CNSGO   1794                                          CRE073 AR824724
     O**********               RDMTO   1801                                          CRE073 AR824724
     O**********               RDFDO   1805                                          CRE073 AR824724
     O                       CNSP              1793P                                              AR
     O                       CNSG              1794                                               AR
     O                       RDMT              1801                                               AR
     O                       RDFD              1805                                               AR
      *                                                                                       CLE134
     O                       FAMU              1806                                           CLE134
     O                       FPNR              1807                                           CLE134
     O                       RIDT              1810P                                          CLE134
     O                       RIDC              1812P                                          CLE134
     O                       RCAT              1813                                           CLE134
     O                       RCAC              1815P                                          CLE134
     O                       RCSD              1818P                                          CLE134
     O                       RCDY              1820P                                          CLE134
     O                       RICC              1822P                                          CLE134
      *                                                                                       CLE134
     O                       BIDT              1825P                                          CLE134
     O                       BIDC              1827P                                          CLE134
     O                       BCAT              1828                                           CLE134
     O                       BCAC              1830P                                          CLE134
      *                                                                                       CLE134
     O                       BCSD              1833P                                          CLE134
     O                       BCDY              1835P                                          CLE134
     O                       BICC              1837P                                          CLE134
      *                                                                                       CLE134
     O                       XRFI              1840                                           CLE134
     O                       XRFN              1850                                           CLE134
      *                                                                                       CLE134
      *                                                                   CAC001
3450 OMCLONCK   D    63                                                         S10227
     O*                                                                   S01270
3451 O                       LOTB1              256
3452 O**********               LOTB2    400                                                   CGL029
3452 O                       LOTB2              341
     O***********              LOTB3    469                        S01518 CEU004
     O***********              LOTB3   1120                        CEU004 134798
     O**********               LOTB3    469                                            134798 CGL029
     O                       LOTB3              402
     O***********              LOTB4   1103                        CLE004 123335
     O**********               LOTB4   1111                                            123335 CGL029
     O                       LOTB4              545
     O                       LOTB5             1111
     O                       RRSC              1114                             134798
     O                       RPSC              1117                             134798
     O                       RICY              1120                             134798
     O                       ECIN              1121                             CEU020
     O                       RPSM              1123                             144915
     O**********               RPOS    1135                                            144915 CGL029
     O                       RPOS              1319
     O                       RPTS              1145                             144915
     O                       RPSB              1148                             144915
     O                       RFAO              1158                             144915
     O                       FSFYLB            1163
     O                       RRSR              1170P
     O                       RRSI              1171
     O                       RPSR              1178P
     O                       RPSI              1179
     O                       RSTA              1180
     O                       FRNT              1200
     O                       AFRT              1220
     O                       REPA              1221
     O                       TMST              1247
     O                       ORVD              1265
     O                       RRON              1283
     O                       RPON              1301
3453 O                                            1 'M'                         S10227
3453 O                       LNRF                 7                             S10227
3453 O                                            8 'B'                         S10227
     O/COPY WNCPYSRC,LE0450O006
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
**  TABDIS **      DISCOUNT PROCESSING TYPES
636567
**  POWR   **      POWERS OF TEN
0000001
0000010
0000100
0001000
0010000
0100000
1000000
**   ZFMD  -  NUMBER OF DAYS IN THE MONTH
312831303130313130313031
** CPY@   **      OBJECT COPYRIGHT
(c) Misys International Banking Systems Ltd. 2001
** STAMP - Dummy timestamp                                                                    CLE034
0001-01-01-00.00.00.000000                                                                    CLE034
**   SVAL  -  SYSTEM VALUES ARRAY                                                             218782
Settlement09Postings                                                                          218782
SplitPrinInterestFlg                                                                        MD027475
** @YD  USED BY SR. ZDATE9 - YEARS, IN DAYS, CUMULATIVE IN 4 YEAR SPAN
00366007310109601461
** @MD  USED BY SR. ZDATE9 - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
00000000310005900090001200015100181002120024300273003040033400365
**  POWER - ARRAY OF POWERS FOR CURRENCY CONVERSION                       134725
0000001                                                                   134725
0000010                                                                   134725
0000100                                                                   134725
0001000                                                                   134725
0010000                                                                   134725
0100000                                                                   134725
1000000                                                                   134725
