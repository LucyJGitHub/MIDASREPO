0001 H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas LE Commitment fee update')                       *
0002 F*****************************************************************
0003 F*                                                               *
     F*  Midas - Customer Lending Module                              *
0005 F*                                                               *
0006 F*  LE0460 - COMMITMENT FEE PROCESSING                           *
0007 F*                                                               *
      *  (c) Finastra International Limited 2001                      *
0009 F*                                                               *
      *  Last Amend No. CSD103             Date 10Aug20               *
      *  Prev Amend No. MD053295           Date 13Apr19               *
      *                 CLE071             Date 18Jul18               *
      *                 MD046248           Date 27Oct17               *
      *                 MD047993           Date 23Sep17               *
      *                 MD035545           Date 11Sep15               *
      *                 AR996895           Date 25Nov12               *
      *                 CLE134             Date 01Aug12               *
      *                 CLE148             Date 23Jul12               *
      *                 AR787620           Date 10Jun11               *
      *                 CLE064             Date 06Dec10               *
      *                 263666             Date 01Feb10               *
      *                 CER059             Date 19Jul10               *
      *                 BUG22954           Date 18Feb09               *
      *                 CER016A            Date 19May08               *
      *                 CER043             Date 19May08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *                 246141             Date 26Mar07               *
      *                 164847             Date 30Nov06               *
      *                 BUG12990           Date 05Jan07               *
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 242286             Date 25Sep06               *
      *                 CSD031             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 CLE042             Date 06Sep05               *
      *                 CIR013             Date 25Apr05               *
      *                 CGL029             Date 01Sep03               *
      *                 CLE029             Date 04Sep02               *
      *                 CAP073             Date 08Aug01               *
      *                 CLE031             Date 07Feb03               *
      * Midas Release 4.01 -------------------------------------------*
      *                 CLE023             Date 19Nov01               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.04 -----------------------------------------------*
      * Midas DBA 3.03 -----------------------------------------------*
      *                 CIR004             Date 20Jan00               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 154799             Date 24Feb99               *
      *                 147261             DATE 17Dec98               *
      *                 CLE008             DATE 27Nov98               *
     F*                 126017             DATE 14NOV97               *
     F*                 121768             DATE 19FEB98               *
     F*                 122839             DATE 09SEP97               *
     F*                 097885             DATE 31JAM97               *
     F*                 095244             DATE 01NOV95               *
     F*                 095238             DATE 31OCT95               *
     F*                 078601             DATE 16AUG95               *
     F*                 S01518             DATE 03OCT94               *
     F*                 066550             DATE 04FEB94               *
     F*                 E48609             DATE 16DEC92               *
     F*                 S01270              DATE  02NOV92                *BHF581
     F*                 E38323              DATE 30JUL92                 *
     F*                 E37211              DATE 19MAR92                 *
     F*                     E26951              DATE 13MAR92             *
     F*                     E26952              DATE 13MAR92             *
     F*                     E26725              DATE 13MAR92             *
     F*                     E30572              DATE 12MAR92             *
     F*                     S01270              DATE 31MAY91             *E80945
     F*                     BHF855              DATE 02MAY91             *E80945
     F*                     BHF921              DATE 01MAY91             *
     F*                     BHF255              DATE 17AUG90             *
     F*                     BHF279              DATE 18JUL90             *
     F*                     LN0169              DATE 15MAY90             *
     F*                     E18905              DATE 27SEP89             *
0010 F*                     S01194              DATE 05JAN90             *
0010 F*                     HK0000              DATE 16/08/89            *
0010 F*                     S01117              DATE 16/08/89            *
     F*                     E47264              DATE 02/03/88            *E47264
     F*                     S01147              DATE 01/03/88            *S01147
     F*                     E80945              DATE 25/06/86            *E80945
     F*                                                               *
0011 F*---------------------------------------------------------------*
     F*                                                               *
      *  CSD103 - LIBOR Deregulation - Common Layer/Standing Data     *
      *  MD053295 - Lending loan with Interest Calculation Basis      *
      *             method 3 (30/360) has wrong interest payment      *
      *             amount for month of March (Recompile)             *
      *  CLE071 - Value Dating of Rate Changes to Fees (Recompile)    *
      *  MD046248 - Finastra Rebranding                               *
      *  MD047993 - Modified MD035545. Removed dependency on Accrue   *
      *             on Last Day indicator.                            *
      *  MD035545 - LE: Interest Calculation in Leap year. Consider   *
      *             Accrue on Last Day Indicator for method 6.        *
      *  AR996895 - Incorrect accrual interest calculation            *
      *             (Child: AR996897) (Recompile)                     *
      *  CLE134 - Past Due Cal Loan Processing                        *
      *  CLE148 - Alpha Loan Reference                                *
      *  AR787620 - Hooks Incorporation                               *
      *             WNCPYSRC,LEH00334                                 *
      *             WNCPYSRC,LEH00335                                 *
      *             WNCPYSRC,LEH00328                                 *
      *             WNCPYSRC,LEH00329                                 *
      *             WNCPYSRC,LEH00330                                 *
      *             WNCPYSRC,LEH00331                                 *
      *             WNCPYSRC,LEH00332                                 *
      *             WNCPYSRC,LEH00333                                 *
      *  CLE064 - Enhancement of Lending Frequencies                  *
      *  263666 - Recompiled due to changes in ZINTDYZ2               *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  BUG22954 - Incorrect update of facilities file after COB     *
      *  CER016A - German Interest Calculation: Upgarde of FGE059     *
      *            to Midas Plus (Recompile)                          *
      *  CER043 - German Features LF041-00 New Fields and Defaulting  *
      *           (Recompile)                                         *
      *  246141 - Recompiled due to changes in ZINTDYZ2               *
      *  164847 - Recompile over changes in /COPY ZINTDYZ2.           *
      *  BUG12990 - Recompiled due to changes in ZINTDYZ2/ZINTDYZ2LE  *
      *  242286 - Recompile over changes in /COPY ZINTDYZ2.           *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CLE042 - Extended Loan Sub Type                              *
      *  CIR013 - Additional Calculation Method for FRA/IRS/CCF       *
      *           Recompile over GLINTC and ZINTDY.                   *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  CLE029 - Addition of Severity code and Limit ID to FCLTYFM   *
      *  CAP073 - Conversion of MN inputs into modular structure to   *
      *           use as APIs. Facility input Transaction Details     *
      *  CLE031 - Lending Enhancements.                               *
      *  CLE023 - Lending Facility History Improvements. (Recompiled) *
      *  CIR004 - Dealing Calculation Method Change.                  *
      *         - Recompiled due to GLINTC and ZINTDY changes         *
      *  154799 - Recompiled due to changes in /COPY,ZACCH            *
     F*  147261 - Add Assignment or Participation indicator           *
     F*  CLE008 - Loan Administration ID Amendment                    *
     F*  126017 - Correction to interest calculation for calculation  *
     F*           basis 6 in SR/GLINTC. Add SR/ZDAT10                 *
     F*  121768 - Recompile over changed GLINTCZ1                     *
     F*  122839 - Record length is wrong                              *
     F*  097885 - Recompiled for wrong calculation of number of day   *
     F*           interest (ZINTDYZ2).                                *
     F*  095244 - Recompiled for Calculation method 3                 *
     F*  095238 - Recompiled for Calculation method 3                 *
     F*  078601 -    Increase size of Base Rate Arrays to 600         *
     F*  S01518 - BLI Lending SWIFT Enhancements.                     *
     F*    066550 - GLINTC has had historical problems and inaccuracies  *
     F*             and is now externaly descibed and changed to use     *
     F*             ZINTDYZ1. See document atached to error no on GEMS   *
     F*     E48609 - THIS PROGRAM IS REDUNDANT ONLY AFTER MONTHEND       *
     F*     S01270 - THIS PROGRAM IS REDUNDANT FROM REL 10.3.22          *
     F*  E38323 - Recompiled due to a change in copy source ZFWDT subr.  *
     F*     E37211 - DEFINE EACH FORMAT OF ACTN7L1 TO ALLOW CORRECT      *
     F*              FACILITY BRANCH FILED TO BE READ BY MATCHING        *
     F*              RECOREDS PROCESSING                                 *
     F*     E26951 - ADD DATABASE ERROR IF EVENT FACILITY NO DOES NOT    *
     F*              REFERENCE FACILITY ON FACILITY DETAILS FILE         *
     F*            - CHECK IF MULT/DIV INDICATOR IS 'M' OR 'D'           *
     F*            - ALWAYS SET ON LR IF DB ERROR                        *
     F*     E26952 - ENSURE THAT CALCULATED NEXT COMM FEE DUE DATE IS    *
     F*              NOT LATER THAN COMM FEE END DATE, ELSE EXCESS COMM  *
     F*              FEES ARE GENERATED FOR THE NO OF DAYS IN BETWEEN.   *
     F*     E26725 - CORRECTION OF I SPEC DEFINITION FOR ACTN7L1         *
     F*              DEFINED BY S01270                                   *
     F*     E30572 - CANCELLED FACILITIES NOT DROPPED AT ALL BECAUSE     *
     F*              PROGRAM ATTEMPTS TO USE INFO. FROM THE LDA          *
     F*              OF LE0450.                                          *
0008 F*     S01270 - INCORPORATION OF LENDING ENHANCEMENTS               *
     F*              REMOVE FIX BHF855                                   *E80945
     F*     BHF855 - PGM SHOULD USE FACILITY BRANCH RATHER THAN TRANS-         *
     F*              ACTION BRANCH WHICH COULD BE DIFFERENT
     F*     BHF921 - RECOMPILE ONLY. CHANGE IN PF/ACTLC KEY SEQUENCE.
     F*     BHF255 - DON'T SET UP WRKA IF DETAIL REC 'B'
     F*     BHF279 - CORRECTION OF I SPEC DEFINITION FOR ACTN7L1
     F*     LN0169 - LKEY1DP FIELDS FOR R2 AND R10 OVERLAP - 129->,      *S01194
     F*              SO PROFIT CENTRE AND SETTLE.BRANCH NEED TO CHANGE   *S01194
     F*     E18905  -  FIELD ADNP DEFINED DIFFERENTLY ON FILE.           *E18905
     F*                A WORK FIELD IS INTRODUCED.                       *E18905
     F*     S01194  -  STANDING DATA CHANGES                             *S01194
     F*     HK0000  -  THE PRIMARY/SECONDARY FILE NOT BY BRANCH          *
     F*     S01117  -  MULTIBRANCHING                                    *
0011 F*     S01147  -  RELEASE 22 (AMENDMENT TO GLINTC)                  *S01147
0011 F*     E47264  -  OUTPUT NEW FIELD TO LKEY2 FOR USE IN LE0660.      *E47264
0011 F*     E80945  -  INDICATOR 98 SETTING IS SAVED AND RESTORED        *
0011 F*                WHEN S.R.GLINTC IS PERFORMED.                     *
0008 F*                                                                  *
0012 F********************************************************************
     F*  C R E A T I O N     P A R A M E T E R S                      *
     F*                                                               *
     F*                                                               *
     F*****************************************************************
0011 F*                                                                  *
0013 F*CLTY***IP*AF***  256 12AI     2 DISK                               HK0000
     F***FCLTYL1 IP AF     256 14AI     2 DISK                     HK0000 122839
     F*FCLTYL1 IP AF    1086 14AI     2 DISK                       122839 CLE008
     F***FCLTYL1 IP AF    1106 14AI     2 DISK                     CLE008 147261
     F***FCLTYL1 IP AF    1107 14AI     2 DISK                     147261 CLE031
     F***FCLTYL1 IP AF    1198 14AI     2 DISK                     CLE031 CLE034
     F***FCLTYL1 IP AF    1211 14AI     2 DISK                     CLE034 CLE029
     F***FCLTYL1 IP AF    1222 14AI     2 DISK                                         CLE029 CGL029
     F***FCLTYL1*IP AF    1258 14AI     2 DISK                                       CGL029 BUG22954
     F***FCLTYL1*IP AF    1269 14AI     2 DISK                                       BUG22954 CLE064
     FFCLTYL1 IP AF    1284 14AI     2 DISK                                                   CLE064
     F**LTYL2 IS AF     259 14AI     2 DISK                        HK0000 S01270
     F***FCLTYL2 IS AF     257 14AI     2 DISK                     S01270 CLE023
     F***FCLTYL2 IS AF     264 14AI     2 DISK                                         CLE023 CGL029
     F/COPY WNCPYSRC,LEH00334
     FFCLTYL2 IS AF     270 14AI     2 DISK                                                   CGL029
     F/COPY WNCPYSRC,LEH00335
0014 F*CTN7***IS*AF***  320 35AI     2 DISK                               HK0000
     F***ACTN7L1*IS AF     320 38AI     2 DISK                     HK0000 S01518
     F***ACTN7L1 IS AF     949 38AI     2 DISK                     S01518 122839
     F***ACTN7L1 IS AF    1057 38AI     2 DISK                     122839 CLE031
     F***ACTN7L1 IS AF    1087 38AI     2 DISK                     CLE031 CLE034
     F***ACTN7L1 IS AF    1109 38AI     2 DISK                     CLE034 CAP075
     F***ACTN7L1 IS AF    1176 38AI     2 DISK                                         CAP075 CGL029
     F*ACTN7L1*IS*AF****1230 38AI     2 DISK                                           CGL029 CLE042
     FACTN7L1 IS AF    1291 38AI     2 DISK                                                   CLE042
     FFCLTYZZ IF  F     256            DISK                               HK0000
0015 F*TABLE***IF**F      96 12AI     2 DISK                              S01194
0016 F*TABLED**IF**F      96 12AI     2 DISK                              S01194
     FSDCURRPDIF  E                    DISK                               S01194
     FSDBSRTPDIF  E                    DISK                               S01194
0017 FFCUPDHH O   F     256            DISK
0017 F***FCUPDFM O   F     256            DISK                            122839
     F*FCUPDFM O   F    1086            DISK                       122839 CLE008
     F*FCUPDFM*O***F    1106            DISK                       CLE008 147261
     F*FCUPDFM O   F    1107            DISK                       147261 CLE031
     F*FCUPDFM O   F    1198            DISK                       CLE031 CLE034
     F*FCUPDFM O   F    1211            DISK                       CLE034 CLE029
     F***FCUPDFM O   F    1222            DISK                                         CLE029 CGL029
     F***FCUPDFM*O   F    1258            DISK                                       CGL029 BUG22954
     F***FCUPDFM O   F    1269            DISK                                       BUG22954 CLE064
     FFCUPDFM O   F    1284            DISK                                                   CLE064
0017 F*FCUPDFN O   F     256            DISK                              CLE023
0017 F*FCUPDFN O   F     263            DISK                       CLE023 CAP068
0017 F***FCUPDFN O   F     330            DISK                                         CAP068 CGL029
     FFCUPDFN O   F     348            DISK                                                   CGL029
0017 FFCUPDZZ O   F     256            DISK
0018 FLKEY2HH O   F     128            DISK
0018 F*KEY2DP*O** F     128            DISK                               S01117
0018 F*KEY2DP O   F     131            DISK                        S01117 E47264
0018 F***LKEY2DP O   F     134            DISK                                         E47264 CGL029
     F*LKEY2DP*O***F*****154            DISK                                           CGL029 CLE042
     FLKEY2DP O   F     168            DISK                                                   CLE042
0018 FLKEY2ZZ O   F     128            DISK
     F/COPY WNCPYSRC,LE0460F001
0019 F*E0460P1O   F     132     OF     PRINTER                            S01117
     FLE0460P1O   F     132     OF     PRINTER      KINFDS SPOOL      UC  S01117
     FLE0460AUO   F     132     OA     PRINTER      KINFDS SPOOLU         S01117
0011 F*                                                                  *
0020 F* ID F  C  H  L    FUNCTION OF INDICATORS
0021 F**01************FACILITY*FILE*-*HEADER*REC.******                   HK0000
0022 F* 02            FACILITY FILE - DETAIL REC. 'A'
0023 F* 03            FACILITY FILE - DETAIL REC. 'B'
0024 F**04************FACILITY*FILE*-*TRAILER*REC.*****                   HK0000
0025 F* 05            FACILITY OR ACTN7 FILE - CATCHALL
0026 F* 06            ACTN7 FILE - HEADER REC.
0027 F* 07            ACTN7 FILE - DETAIL REC.
0028 F* 08            ACTN7 FILE - TRAILER REC.
0029 F**09**********  TABLED FILE - CURRENCY REC. 1                       S01194
0030 F**10**********  TABLED FILE - BASE RATE REC.                        S01194
0031 F*       11      FACILITY IS LIVE
0032 F*       12      FACILITY IS REVERSED
0033 F*       13      FACILITY IS CLOSED
0034 F*       14      FACILITY IS EXPIRED
0035 F*       15      ACCRUALS PROCESSING REQUIRED
0036 F********16****  END OF FILE FOR TABLED                              S01194
0036 F*       16      END OF FILE FOR SDCURRPD OR SDBSRTPD                S01194
0037 F*       17      BASE RATE CHANGES HAVE BEEN INPUT TODAY
0038 F*       18      END OF MONTH PROCESSING
0039 F*       19      C/FEE PAYMENT DUE THIS RUN FOR FCLTY BEING PROCESSED
0040 F*       20      C/FEE PROCESSING IS REQUIRED
0041 F*       21      REVOLVING CREDIT FACILITY
0042 F*       22      FACILITY IS TO BE EXPIRED
0043 F*       23      ACCRUAL DAY PROCESSING IS LAST DAY
     F*       26      1ST WORKING DAY OF YEAR                             E30572
     F*       27      MONTH END                                           E30572
     F*       28      YEAR END                                            E30572
0044 F*       30      FACILITY CURRENCY DECIMAL PLACES IS 0
0045 F*       31      FACILITY CURRENCY DECIMAL PLACES IS 1
0046 F*       32      FACILITY CURRENCY DECIMAL PLACES IS 2
0047 F*       33      FACILITY CURRENCY DECIMAL PLACES IS 3
0048 F*       40      OUTPUT HEADERS TO FILES AND HEADINGS TO PRINTER
0049 F*       41      OUTPUT DETAIL ACCOUNT KEY RECORD AND PRINT
0050 F*       42      OUTPUT DETAIL FACILITY RECORDS
0051 F*       50      FIRST CYCLE INDICATOR
     F*       61      MULTI-BRANCHING INDICATOR = NO                      S01117
     F*       62      SOME DETAILS REPORT ON ANY P1 SPOOL                 S01117
     F*       63      SOME DETAILS REPORT ON CURRENT P1 SPOOL             S01117
     F*       65      SINGLE BRANCH SYSTEM                                S01194
0052 F*       70      WORK INDICATOR
0053 F*       71      REVERSAL ACTION RECORD
0054 F*       72      START DATE ACTION RECORD
0055 F*       73      PRINCIPAL INCREASE ACTION RECORD
0056 F*       74      MANUAL REPAYMENT ACTION RECORD
0057 F*       75      INTEREST PAYMENT ACTION RECORD
0058 F*       76      REPAYMENT ACTION RECORD
0059 F*       77      MATURITY ACTION RECORD
0060 F*       78      WORK INDICATOR
0061 F*       79      WORK INDICATOR
0062 F*       80      ACTN7 FILE OUT OF BALANCE
0063 F*       81      FCLTY FILE OUT OF BALANCE
     F*       86      CHECK IF THERE WILL BE A SECOND RUN                 E30572
0064 F*       90-99   STANDARD SUBROUTINE INDICATORS
     F*          U3   SECOND RUN                                          E30572
0065 F*          U7   DATABASE ERROR
0066 F*          U8   DATABASE ERROR OR FILE CONTROLS OUT OF BALANCE
0067 E                    RUN        10  5 0             FCLTY DRAW DATE
0068 E                    OAM        10 13 0             FCLTY DRAWN AMTS
0069 E                    NRUN       10  5 0             FCUPD DRAW DATES
0070 E                    NOAM       10 13 0             FCUPD DRAWN AMTS
0071 E*******             BRCC      300  5               B.RATE CODE & CCY078601
0072 E*******             BASE      300 11 7             BASE RATE        078601
0071 E                    BRCC      600  5               B.RATE CODE & CCY078601
0072 E                    BASE      600 11 7             BASE RATE        078601
0073 E***********         ZHC        50  3               ZDATE5 SR.ARRAY  S01195
0074 E***********         HCCY       25  3               HOL. CURRENCIES  S01195
0075 E***********         ZFMD   12  12  2               ZFREQB SR.ARRAY  S01195
0075 E                    ZFMD   12  12  2               FREQB SR.ARRAY   S01195
0076 E                    CURR      150  3               CURRENCIES
0077 E                    CDEP      150  1 0             CURRENCY DEC.PL
0078 E                    CSPT      150 13 8             CURRENCY SPOT RT.
0079 E**************      MTDV      150  1 0             CURRENCY M/D IND S01194
0079 E                    MTDV      150  1               CURRENCY M/D IND S01194
0080 E                    POWR    1   7  7 3             POWERS OF TEN
0081 E                    ZYDY    4   4  4 0             ZDATE1/2 SR.ARRAY
0082 E                    ZMDY   13  13  3 0             ZDATE1/2 SR.ARRAY
0083 E                    ZMNM   12  12  3               ZDATE2 SR. ARRAY
     E                    CPY@    1   1 80
     E/COPY ZSRSRC,ZHOLE                                                  S01195
     E/COPY ZSRSRC,ZDATE9Z1                                               066550
     E                    STAMP   1   1 26                                                    CLE064
0084 I*
0085 I***FACILITY*FILE*-*HEADER*RECORD****                                HK0000
0086 I***********                                                         HK0000
0087 I*CLTY***NS**01** 1 CH                                               HK0000
0088 I***********                             1   1 RECI                  HK0000
0089 I*
0090 I** FACILITY FILE - DETAIL RECORD 'A'
0091 I*
0092 I*CLTY***NS**02** 1 CD  13 CA                                        HK0000
     IFCLTYL1 NS  02   1 CD  13 CA                                        HK0000
0093 I       OR        1 CR  13 CA
0094 I       OR        1 CC  13 CA
0095 I       OR        1 CE  13 CA
0096 I                                        1   1 RECI
0097 I**********                              2   70FCUS                                      CSD027
0097 I                                        2   7 FCUS                                      CSD027
0098 I                                        8  100FTYP
0099 I                                       11  120FSEQ
0100 I** DEFINE FCLTY REF.AS ONE FIELD
0101 I**********                              2  120FCLT  L1M1                                CSD027
0101 I                                        2  12 FCLT  L1M1                                CSD027
0102 I                                       13  13 RCTP
0103 I*****                                  14  160BRCD                  S01117
     I                                       14  16 BRCF  L2M2            S01117
0104 I                                       17  17 FCTI
0105 I                                       18  20 FCCY
0106 I                                    P  21  270FAMT
0107 I                                    P  28  303OVPC
0108 I                                    P  31  330DTAP
0109 I                                    P  34  360DTEX
0110 I                                       37  37 RVCR
0111 I                                       38  38 SECI
0112 I                                       39  39 MCCY
0113 I                                       40  40 MCSI
0114 I                                       41  41 NACD
0115 I                                       42  43 CRSK
0116 I                                    P  44  460DLFS
0117 I                                    P  47  527NOMR
0118 I                                    P  53  550RVDT
0119 I                                       56  56 RVFR
0120 I                                       57  580RVDY
0121 I                                       59  93 NAR1
0122 I                                       94 128 NAR2
0123 I                                      129 163 NAR3
0124 I                                      164 198 NAR4
0125 I                                    P 199 2050MTDH
0126 I                                    P 206 2120MTDL
0127 I                                    P 213 2190MTDA
0128 I                                    P 220 2270QTDA
0129 I                                    P 228 2350YTDA
0130 I                                      236 237 ACOF
     I                                      238 240 ORBR                  S01117
     I/COPY WNCPYSRC,LE0460I001
0131 I                                    P 247 2490ORED
0132 I                                    P 250 2520LCD
0133 I                                      253 253 CHTP
0134 I                                    P 254 2560TNLU
0133 I                                     11051106 LAID                  CLE008
     I                                     11821182 COAG                  CLE031
     I                                     11831183 FCAG                  CLE031
     I                                     11841184 PHAG                  CLE031
     I                                     11851185 SCAG                  CLE031
     I                                    P118611928REXR                  CLE031
     I                                     11931193 REXI                  CLE031
     I                                     11941196 PSCY                  CLE031
     I                                    P119712038PEXR                  CLE031
     I                                     12041204 PEXI                  CLE031
     I                                    P120512110OVAM                  CLE034
     I                                     12121212 SVCD                  CLE029
     I                                     12131222 LMTI                  CLE029
0135 I** DEFINE WHOLE RECORD AS ONE FIELD
0136 I*****************                       1 256 LOTA                  122839
     I*************                           11086 LOTA           122839 CLE008
     I*************                           11106 LOTA           CLE008 147261
     I**********                              11107 LOTA           147261 CLE031
     I**********                              11198 LOTA           CLE031 CLE034
     I**********                              11211 LOTA           CLE034 CLE029
     I*************                           11222 LOTA                               CLE029 CGL029
     I**********                              11258 LOTA                             CGL029 BUG22954
     I**********                              11269 LOTA                             BUG22954 CLE064
     I                                        11284 LOTA                                      CLE064
     I*                                                                   HK0000
     I** FACILITY FILE - CATCHALL                                         HK0000
     I*                                                                   HK0000
     IFCLTYL1 NS  05                                                      HK0000
0137 I*
0138 I** FACILITY FILE - DETAIL RECORD 'B'
0139 I*
0140 I*CLTY***NS**03** 1 CD  13 CB                                        HK0000
     IFCLTYL2 NS  03   1 CD  13 CB                                        HK0000
0141 I       OR        1 CR  13 CB
0142 I       OR        1 CC  13 CB
0143 I       OR        1 CE  13 CB
0144 I                                        1   1 RECI
0145 I**********                              2   70FCUS                                      CSD027
0145 I                                        2   7 FCUS                                      CSD027
0146 I                                        8  100FTYP
0147 I                                       11  120FSEQ
0148 I** DEFINE FCLTY REF.AS ONE FIELD
0149 I**********                              2  120FCLT    M1                                CSD027
0149 I                                        2  12 FCLT    M1                                CSD027
0150 I                                       13  13 RCTP
0151 I                                       14  14 CMFT
0152 I                                       15  150CALC
0153 I                                    P  16  217SPRD
0154 I**********                             22  230BCOD                                      CSD103
     I                                       22  23 BCOD                                      CSD103
0155 I                                    P  24  297BRAT
0156 I                                    P  30  320STDT
0157 I                                    P  33  350EDDT
0158 I                                    P  36  380DUDT
0159 I                                       39  39 BLFR
0160 I                                       40  410BLDN
0161 I                                       42  42 BTIN
     I/COPY WNCPYSRC,LE0460I002
0162 I                                       43  440BLDY
     I/COPY WNCPYSRC,LE0460I003
0163 I                                       45  460SETT
0164 I**********                             47  58 OBAC                                      CGL029
0165 I**********                             59  68 TNAC                                      CGL029
0166 I**********                          P  69  710SLCD                                      CGL029
0167 I**********                          P  72  740ACCD                                      CGL029
     I***************                     P  75  812ADNP                  E18905
     I**********                          P  75  810ADNP                               E18905 CGL029
0169 I**********                          P  82  880PDTD                                      CGL029
0170 I**********                          P  89  950AFPD                                      CGL029
0171 I**********                          P  96 1020ADJP                                      CGL029
0172 I**********                          P 103 1090ADJN                                      CGL029
0173 I**********                          P 110 1160TOTD                                      CGL029
0174 I**********                          P 117 1230CAMD                                      CGL029
     I**********                            126 129 PRFC                               S01117 CGL029
0175 I**********                            131 131 BITS                                      CGL029
     I**********                            142 144 CFBR                               S01117 CGL029
0176 I************************************P 147 176 RUN                   S01270
0177 I************************************P 177 246 OAM                   S01270
0178 I************************************* 247 2490ORED                  S01270
0179 I************************************P 250 2520LCD                   S01270
0180 I************************************  253 253 CHTP                  S01270
0181 I************************************P 254 2560TNLU                  S01270
     I************************************  257 259 BRCF    M2      HK0000S01270
0176 I**********                          P 145 174 RUN                                S01270 CGL029
0177 I**********                          P 175 244 OAM                                S01270 CGL029
0178 I**********                          P 245 2470ORED                               S01270 CGL029
0179 I**********                          P 248 2500LCD                                S01270 CGL029
0180 I**********                            251 251 CHTP                               S01270 CGL029
0181 I**********                          P 252 2540TNLU                               S01270 CGL029
     I**********                            255 257 BRCF    M2                         S01270 CGL029
     I**********                          P 258 2640CEXP                               CLE023 CGL029
     I                                       47  64 OBAC                                      CGL029
     I                                       65  74 TNAC                                      CGL029
     I                                    P  75  770SLCD                                      CGL029
     I                                    P  78  800ACCD                                      CGL029
     I                                    P  81  870ADNP                                      CGL029
     I                                    P  88  940PDTD                                      CGL029
     I                                    P  95 1010AFPD                                      CGL029
     I                                    P 102 1080ADJP                                      CGL029
     I                                    P 109 1150ADJN                                      CGL029
     I                                    P 116 1220TOTD                                      CGL029
     I                                    P 123 1290CAMD                                      CGL029
     I                                      132 135 PRFC                                      CGL029
     I                                      137 137 BITS                                      CGL029
     I                                      142 144 CFBR                                      CGL029
     I                                    P 151 180 RUN                                       CGL029
     I                                    P 181 250 OAM                                       CGL029
     I                                    P 251 2530ORED                                      CGL029
     I                                    P 254 2560LCD                                       CGL029
     I                                      257 257 CHTP                                      CGL029
     I                                    P 258 2600TNLU                                      CGL029
     I                                      261 263 BRCF    M2                                CGL029
     I                                    P 264 2700CEXP                                      CGL029
     I/COPY WNCPYSRC,LEH00328
0182 I** DEFINE WHOLE RECORD AS ONE FIELD
0183 I                                        1 256 LOTB
     I/COPY WNCPYSRC,LEH00329
     I*                                                                   HK0000
     I** FACILITY FILE - CATCHALL                                         HK0000
     I*                                                                   HK0000
     IFCLTYL2 NS  05                                                      HK0000
0184 I*
0185 I** FACILITY FILE - TRAILER RECORD
0186 I*
0187 I*CLTY***NS**04** 1 CT                                               HK0000
0187 IFCLTYZZ NS  04   1 CT                                               HK0000
0188 I                                        1   1 RECI
0189 I                                    P  17  190NOREF
0190 I                                    P  23  250NLRB
0191 I                                    P  26  280NINS
0192 I                                    P  29  310NDEL
0193 I                                    P  32  340NLRA
0194 I                                    P  35  420VLBF
0195 I                                    P  43  440VLBL
0196 I                                    P  45  520VRIF
0197 I                                    P  53  540VRIL
0198 I                                    P  55  620VRDF
0199 I                                    P  63  640VRDL
0200 I                                    P  65  720VRAF
0201 I                                    P  73  740VRAL
0202 I                                    P  75  820VLAF
0203 I                                    P  83  840VLAL
0204 I                                    P 250 2520LCD
0205 I                                      253 253 CHTP
0206 I                                    P 254 2560TNLU
0207 I** DEFINE WHOLE RECORD AS ONE FIELD
0208 I                                        1 256 LOTT
0209 I*
0210 I***FACILITY*FILE*-*CATCHALL****                                     HK0000
0211 I****************                                                    HK0000
0212 I*CLTY***NS**05**                                                    HK0000
0213 I*
0214 I** ACTIONS TODAY FILE 7 - HEADER RECORD
0215 I*
0216 I*CTN7***NS**06** 1 CH                                               HK0000
     IACTN7L1 NS  06   1 CH                                               HK0000
0217 I                                        1   1 RECI
0218 I                                    P  16  180EVCD
0219 I                                       19  19 PAQI
     I                                    P  20  220PELAP                 E47264
0220 I                                    P 314 3160LCD
0221 I                                      317 317 CHTP
0222 I                                    P 318 3200TNLU
0223 I*
0224 I** ACTIONS TODAY FILE 7 - DETAIL RECORD
0225 I*
0226 I*CTN7***NS**07** 1 CD                                               HK0000
     I*ACTN7L1 NS  07   1 CD                                        HK0000E37211
     IACTN7L1 NS  07   1 CD 264NC                                         E37211
0227 I                                        1   1 RECI
0228 I**********                              2   70LNRF                                      CLE148
     I                                        2   7 LNRF                                      CLE148
0229 I                                        8  120VDAT
0230 I                                       13  150LASN
0231 I                                       16  160MRIN
0232 I                                       17  18 LTYP
0233 I                                       19  20 SUTP
0234 I                                       21  220PTYP
0235 I                                       23  24 AMTP
0236 I                                       25  260PRSQ
0237 I**********                             27  280BRTT                                      CSD103
0237 I                                       27  28 BRTT                                      CSD103
0238 I                                    P  29  347RTSP
0239 I                                       35  37 CCY
0240 I                                    P  38  440PRAM
0241 I                                    P  45  510INTA
0242 I                                    P  52  580WTXA
0243 I                                    P  59  650FEAM
0244 I                                    P  66  720TAMT
0245 I*****                                  73  750BRCD                  S01117
     I*****                                  73  75 BRCA    M2     S01117 BHF855
     I*****                                  73  75 BRCA           BHF855 S01270
     I***********                            73  75 BRCA    M2     S01270 E26725
     I                                       73  75 BRCA                  E26725
0246 I**********                             76  810CNUM                                      CSD027
0246 I                                       76  81 CNUM                                      CSD027
0247 I                                       82  820REPT
0248 I                                       83  83 AUTO
0249 I                                       84  84 STAI
0250 I                                       85  860SETP
0251 I                                       87  98 OSAC
0252 I                                       99 108 TSEN
0253 I                                      109 118 FACO
0254 I                                      119 148 SPI1
0255 I                                      149 178 SPI2
0256 I                                      179 208 SPI3
0257 I                                      209 209 LAIN
0258 I                                    P 210 2157BRTE
0259 I                                      216 216 SPIN
0260 I                                      217 2170CALC
0261 I                                      218 218 WTIN
0262 I                                      219 219 LLAG
0263 I                                      220 220 LWOI
0264 I                                      221 2250XAVD
0265 I                                      226 2280XASQ
0266 I**********                            229 2340FCUS                                      CSD027
0266 I                                      229 234 FCUS                                      CSD027
0267 I                                      235 2370FTYP
0268 I                                      238 2390FSEQ
0269 I** DEFINE FCLTY REF.AS ONE FIELD
0270 I**********                            229 2390FCLT    M1                                CSD027
0270 I                                      229 239 FCLT    M1                                CSD027
0271 I**********                            240 2450RLON                                      CSD027
     I                                      240 245 RLON                                      CSD027
0272 I                                      246 2470FECD
0273 I                                      248 248 PDNI
0274 I                                      249 249 ACTI
0275 I                                      250 250 CNFY
0276 I                                      251 251 TLXY
0277 I                                      252 252 CBLY
0278 I                                      253 253 INTC
     I***********                           256 258 OSBR                  BHF279
     I                                      261 263 OSBR                  BHF279
     I********                              264 266 FCLB    M2     BHF855 S01270
     I***********                           264 266 FCLB           S01270 E26725
     I                                      264 266 FCLB    M2            E26725
     I                                    P 308 3100LORED
0279 I                                    P 311 3130ORED
0280 I                                    P 314 3160LCD
0281 I                                      317 317 CHTP
0282 I                                    P 318 3200TNLU
     I                                    P109010968REXR                  CLE031
     I                                     10971097 REXI                  CLE031
     I                                     10981100 PSCY                  CLE031
     I                                    P110111078PEXR                  CLE031
     I                                     11081108 PEXI                  CLE031
     I                                     11091109 STAL                  CLE034
     I                                     11101129 FRNT                  CAP075
     I                                     11301149 AFRT                  CAP075
     I                                     11501150 REPA                  CAP075
     I                                     11511176 TMST                  CAP075
     I                                     12801283 CLAS                                      CLE042
0283 I*
     IACTN7L1 NS  07   1 CD 264 C                                         E37211
     I                                        1   1 RECI                  E37211
     I**********                              2   70LNRF                               E37211 CLE148
     I                                        2   7 LNRF                                      CLE148
     I                                        8  120VDAT                  E37211
     I                                       13  150LASN                  E37211
     I                                       16  160MRIN                  E37211
     I                                       17  18 LTYP                  E37211
     I                                       19  20 SUTP                  E37211
     I                                       21  220PTYP                  E37211
     I                                       23  24 AMTP                  E37211
     I                                       25  260PRSQ                  E37211
     I**********                             27  280BRTT                               E37211 CSD103
     I                                       27  28 BRTT                                      CSD103
     I                                    P  29  347RTSP                  E37211
     I                                       35  37 CCY                   E37211
     I                                    P  38  440PRAM                  E37211
     I                                    P  45  510INTA                  E37211
     I                                    P  52  580WTXA                  E37211
     I                                    P  59  650FEAM                  E37211
     I                                    P  66  720TAMT                  E37211
     I                                       73  75 BRCA                  E37211
     I**********                             76  810CNUM                               E37211 CSD027
     I                                       76  81 CNUM                                      CSD027
     I                                       82  820REPT                  E37211
     I                                       83  83 AUTO                  E37211
     I                                       84  84 STAI                  E37211
     I                                       85  860SETP                  E37211
     I                                       87  98 OSAC                  E37211
     I                                       99 108 TSEN                  E37211
     I                                      109 118 FACO                  E37211
     I                                      119 148 SPI1                  E37211
     I                                      149 178 SPI2                  E37211
     I                                      179 208 SPI3                  E37211
     I                                      209 209 LAIN                  E37211
     I                                    P 210 2157BRTE                  E37211
     I                                      216 216 SPIN                  E37211
     I                                      217 2170CALC                  E37211
     I                                      218 218 WTIN                  E37211
     I                                      219 219 LLAG                  E37211
     I                                      220 220 LWOI                  E37211
     I                                      221 2250XAVD                  E37211
     I                                      226 2280XASQ                  E37211
     I**********                            229 2340FCUS                               E37211 CSD027
     I                                      229 234 FCUS                                      CSD027
     I                                      235 2370FTYP                  E37211
     I                                      238 2390FSEQ                  E37211
     I                                      240 242 FCLB    M2            E37211
     I**********                            229 2390FCLT    M1                         E37211 CSD027
     I                                      229 239 FCLT    M1                                CSD027
     I                                      366 369 CLAS                                      CLE042
     I*                                                                   E37211
0284 I** ACTIONS TODAY FILE 7 - TRAILER RECORD
0285 I*
0286 I*CTN7***NS**08** 1 CT                                               HK0000
     IACTN7L1 NS  08   1 CT                                               HK0000
0287 I                                        1   1 RECI
0288 I                                    P  17  190NOREA
0289 I*
0290 I** ACTIONS TODAY FILE 7 - CATCHALL
0291 I*
0292 I*CTN7***NS**05**                                                    HK0000
     IACTN7L1 NS  05                                                      HK0000
0293 I**************                                                      S01194
0294 I***TABLE*FILE*- INSTALLATION CONTROL DATA RECORD 1                  S01194
0295 I**************                                                      S01194
0296 I*TABLE***NS***    1 CD   2 C0   3 C1                                S01194
0297 I*******AND****  12 C1  13 C0                                        S01194
0298 I**************                          1   1 RECI                  S01194
0299 I**************                          2   30RECT                  S01194
0300 I**************                         12  130RCDE                  S01194
0301 I**************                         14  66 TITL                  S01194
0302 I**************                         67  67 DATF                  S01194
0303 I**********                             68  700DFBR                  S01194
0304 I**************                         74  74 MODI1                 S01194
0305 I**************                         75  75 MODI2                 S01194
0306 I**************                         76  76 MODI3                 S01194
0307 I**************                      P  77  790RUND                  S01194
0308 I**************                         80  86 RUNA                  S01194
0309 I**************                         87  870SFLG                  S01194
0310 I**************                      P  90  920LCD                   S01194
0311 I**************                         93  93 CHTP                  S01194
0312 I**************                      P  94  960TNLU                  S01194
0313 I**************                                                      S01194
0314 I***TABLE*FILE*- INSTALLATION CONTROL DATA RECORD 2                  S01194
0315 I**************                                                      S01194
0316 I*TABLE***NS***    1 CD   2 C0   3 C1                                S01194
0317 I*******AND****  12 C1  13 C1                                        S01194
0318 I**************                          1   1 RECI                  S01194
0319 I**************                          2   30RECT                  S01194
0320 I**************                         12  130RCDE                  S01194
0321 I**************                         14  16 BCCY                  S01194
0322 I**************                         17  19 BCYL                  S01194
0323 I**************                         20  22 HOCY                  S01194
0324 I**************                         23  280HEAD                  S01194
0325 I**************                      P  29  310APDA                  S01194
0326 I**************                         35  35 APFQ                  S01194
0327 I**************                      P  36  380LOGS                  S01194
0328 I**************                         39  40 CUZR                  S01194
0329 I**************                      P  41  430DNWD                  S01194
0330 I**************                         44  460BVLP                  S01194
0331 I**************                         47  49 LOCY                  S01194
0332 I**************                         50  510FDAY                  S01194
0333 I**************                         52  52 ACLD                  S01194
0334 I***********                            53  53 MBIN                  S01194
0335 I**************                         86  86 ISAV                  S01194
0336 I**************                      P  87  890LLOG                  S01194
0337 I**************                      P  90  920LCD                   S01194
0338 I**************                         93  93 CHTP                  S01194
0339 I**************                      P  94  960TNLU                  S01194
0340 I**************                                                      S01194
0341 I***TABLE*FILE*- INSTALLATION CONTROL DATA RECORD 6                  S01194
0342 I**************                                                      S01194
0343 I*TABLE***NS***    1 CD   2 C0   3 C1                                S01194
0344 I*******AND****  12 C5  13 C0                                        S01194
0345 I**************                          1   1 RECI                  S01194
0346 I**************                          2   30RECT                  S01194
0347 I**************                         12  130RCDE                  S01194
0348 I**************                         14  14 BTIN                  S01194
0349 I**************                         15  160BDAY                  S01194
0350 I**************                      P  17  180PDUE1                 S01194
0351 I**************                      P  19  200PDUE2                 S01194
0352 I**************                      P  21  220PDUE3                 S01194
0353 I**************                      P  23  240PDUE4                 S01194
0354 I**************                      P  25  260PDUE5                 S01194
0355 I**************                      P  27  280PDUE6                 S01194
0356 I**************                      P  29  300PDUE7                 S01194
0357 I**************                      P  31  320PDUE8                 S01194
0358 I**************                      P  33  380LARG                  S01194
0359 I**************                         39  39 BRLF                  S01194
0360 I**************                      P  90  920LCD                   S01194
0361 I**************                         93  93 CHTP                  S01194
0362 I**************                      P  94  960TNLU                  S01194
0363 I**************                                                      S01194
0364 I***TABLE*FILE*- HOLIDAY RECORDS                                     S01194
0365 I**************                                                      S01194
0366 I*TABLE***NS***    1 CD   2 C2   3 C2                                S01194
0367 I*******AND****  14 CE                                               S01194
0368 I*******OR*****   1 CD   2 C2   3 C2                                 S01194
0369 I*******AND****  14 CI                                               S01194
0370 I**************                          1   1 RECI                  S01194
0371 I**************                          2   30RECT                  S01194
0372 I**************                          8  120HOL                   S01194
0373 I**************                         13  130SREC                  S01194
0374 I**************                         14  14 INEX                  S01194
0375 I**************                         15  89 HCCY                  S01194
0376 I**************                      P  90  920LCD                   S01194
0377 I**************                         93  93 CHTP                  S01194
0378 I**************                      P  94  960TNLU                  S01194
0379 I**************                                                      S01194
0380 I***TABLE*FILE*- CATCHALL                                            S01194
0381 I**************                                                      S01194
0382 I*TABLE***NS***                                                      S01194
0383 I**************                          1   1 RECI                  S01194
0384 I**************                                                      S01194
0385 I***TABLED*FILE - CURRENCY RECORD 1                                  S01194
0386 I**************                                                      S01194
0387 I*TABLED**NS**09   2 C2   3 C0                                       S01194
0388 I**************                          1   1 RECI                  S01194
0389 I**************                          2   30RECT                  S01194
0390 I**************                         10  12 CCY                   S01194
0391 I**************                         13  130SREC                  S01194
0392 I**************                         14  27 CCNM                  S01194
0393 I**************                      P  28  348SPOT                  S01194
0394 I**************                         35  37 CCYS                  S01194
0395 I**************                         38  380CDP                   S01194
0396 I**************                         39  390TNOT                  S01194
0397 I**************                         40  40 DCCY                  S01194
0398 I**************                         41  44 SRC1                  S01194
0399 I**************                         45  48 SRC2                  S01194
0400 I**************                         49  520TACC                  S01194
0401 I**************                         53  560TEQV                  S01194
0402 I**************                         57  600SWQV                  S01194
0403 I**************                         61  640TAC4                  S01194
0404 I**************                         65  680TAC5                  S01194
0405 I**************                         69  69 HIND                  S01194
0406 I**************                      P  70  768PART                  S01194
0407 I**************                         77  780SSNO                  S01194
0408 I**************                      P  79  858ERLC                  S01194
0409 I**************                         86  860MDIN                  S01194
0410 I**************                         87  870MDIA                  S01194
0411 I**************                         88  880MDIB                  S01194
0412 I**************                      P  90  920LCD                   S01194
0413 I**************                         93  93 CHTP                  S01194
0414 I**************                      P  94  960TNLU                  S01194
0415 I**************                                                      S01194
0416 I***TABLED*FILE - BASE RATE RECORD                                   S01194
0417 I**************                                                      S01194
0418 I*TABLED**NS**10   2 C2   3 C1                                       S01194
0419 I**************                          1   1 RECI                  S01194
0420 I**************                          2   30RECT                  S01194
0421 I**************                          9  11 CCY                   S01194
0422 I**************                         12  130BRTT                  S01194
0423 I**************                      P  14  197BRTE                  S01194
0424 I**************                      P  20  220VDRC                  S01194
0425 I**************                         23  23 RCIN                  S01194
0426 I**************                         24  53 BRTN                  S01194
0427 I**************                      P  54  597NBRT                  S01194
0428 I**************                      P  60  620VDNR                  S01194
0429 I**************                      P  90  920LCD                   S01194
0430 I**************                         93  93 CHTP                  S01194
0431 I**************                      P  94  960TNLU                  S01194
0432 I**************                                                      S01194
0433 I***TABLED*FILE - CATCHALL                                           S01194
0434 I**************                                                      S01194
0435 I*TABLED**NS***                                                      S01194
0436 I**************                          1   1 RECI                  S01194
0437 I*
0438 I** LOCAL DATA AREA TO IDENTIFY DATABASE ERRORS AND TO DETERMINE
0439 I** TYPE OF RUN
0440 I*
0441 ILDA        UDS                            256
0442 I***********                           134 138 DBFILE                S01117
0443 I***********                           139 167 DBKEY                 S01117
0444 I***********                           168 175 DBPGM                 S01117
0445 I***********                           176 1770DBASE                 S01117
0446 I***********                           178 185 RUNTYP                S01117
     I                                      134 141 DBFILE                S01117
     I                                      142 170 DBKEY                 S01117
     I                                      171 180 DBPGM                 S01117
     I                                      181 1830DBASE                 S01117
     I                                      184 191 RUNTYP                S01117
     I**   JNSTAT DATA AREA                                               E30572
     IJNSTAT     UDS                            200                       E30572
     I                                    P 103 1050PRUN                  E30572
     I**                                                                  S01117
     I**   FILE INFORMATION DATA STRUCTURE - P1                           S01117
     I**                                                                  S01117
     ISPOOL       DS                                                      S01117
     I                                       83  92 SFILE                 S01117
     I                                    B 123 1240SFNUM                 S01117
     I**                                                                  S01117
     I**   FILE INFORMATION DATA STRUCTURE - AU                           S01117
     I**                                                                  S01117
     ISPOOLU      DS                                                      S01117
     I                                       83  92 SFILEU                S01117
     I                                    B 123 1240SFNUMU                S01117
      **                                                                  S01117
     IRUNDT       DS                                                      S01117
      **  DATA AREA RUNDAT                                                S01117
     I                                        1   7 RUNA                  S01117
     I                                    P   8  100RUND                  S01117
     I                                       11  11 SSF                   S01117
     I                                       12  12 DATF                  S01117
     I                                       13  13 MBIN                  S01117
      **                                                                  S01194
     ISDBANK    E DSSDBANKPD                                              S01194
      **  EXTERNAL DS FOR BANK DETAILS                                    S01194
     I              BJURPT                          TITL                  S01194
     I              BJEYD                           EOYD                  E30572
     I              BJDNWD                          DNWD                  E30572
     I              BJPEYD                          LEYD                  E30572
      **                                                                  S01117
     ISDBRCH    E DSSDBRCHPD                                              S01117
      **  EXTERNAL DS FOR BRANCH CODE DETAILS                             S01117
      **                                                                  S01194
     I              A8BRNM                          BRNM                  S01194
      **                                                                  S01194
     ISDCLND    E DSSDCLNDPD                                              S01194
      **  EXTERNAL DS FOR CUSTOMER LENDING DETAILS                        S01194
     I              BPBRCF                          BRLF                  S01194
      **                                                                  S01194
     ISDGELR    E DSSDGELRPD                                              S01194
      **  EXTERNAL DS FOR GENERAL LEDGER DETAILS                          S01194
     I              BKAPDT                          APDA                  S01194
     I              BKALDI                          ACLD                  S01194
      **                                                                  S01194
     ISDNOST    E DSSDNOSTPD                                              S01194
      **  EXTERNAL DS FOR NOSTRO DETAILS                                  S01194
     I              A7NOSN                          CSNM                  S01194
     I              QQACCD                          QQACCN                                    CGL029
     I*                                                                   S01194
     IDSFDY     E DSDSFDY                                                 S01194
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01194
     I*                                                                   S01194
     IDSSDY     E DSDSSDY                                                 S01194
     I* SECOND DS FOR ACCESS PROGRAMS, LONG DATA STRUCTURE                S01194
     I*                                                                   S01194
      **                                                                  S01195
     IDSCSNM      DS                             10                       S01195
      ** DATA AREA FOR THE LOCATION CODE IN CUSTOMER SHORTNAME FIELD      S01195
     I                                        8  10 NRLC                  S01195
      **                                                                  S01195
     I              'LECalcBasis6LeapYear'C         WPARML                                  MD035545
     I/COPY ZSRSRC,ZHOLI                                                  S01195
      *                                                                   S01195
     I/COPY ZSRSRC,ZINTDYZ1                                               066550
     I/COPY ZSRSRC,ZDATE9Z2                                               066550
     I/COPY ZSRSRC,ZDAT10Z1                                               126017
     C                     MOVEACPY@      BIS@   80
0447 C*
0448 C** MAIN PROCESSING
0449 C*
0450 C** CALLS:     INIT,EXCPT,GLZADD,QFCLTY,ACTN,PREVF
0451 C*
0452 C** FIRST CYCLE CALCS
0453 C*
0454 C  N50                EXSR INIT
0455 C  N50 U7 U8          EXSR EXCPT                      DATABASE ERROR
0456 C  N50 U7 U8          GOTO END                        - PRINT
0457 C*
0458 C** NEW FACILITY - DETERMINE FACILITY RECORD TYPE AND SET OFF INDS
0459 C*
0460 C   L1      RECI      COMP 'D'                      11
0461 C   L1      RECI      COMP 'R'                      12
0462 C   L1      RECI      COMP 'C'                      13
0463 C   L1      RECI      COMP 'E'                      14
0464 C*
0465 C   L1                SETOF                     20
      *                                                                   S01117
      **  DO THE CHANGE OF BRANCH PROCESSING WHEN LEVEL BREAK             S01117
     C           *INL2     IFEQ '1'                                       S01117
      *                                                                   S01117
     C                     CLOSELE0460P1                                  S01117
     C                     SETOF                     63                   S01117
     C                     MOVE 'Y'       P1OP    1                       S01117
     C                     Z-ADD0         NKYGEN  50                      S01117
     C                     OPEN LE0460P1                                  S01117
     C                     Z-ADD0         PAGE                            S01117
      **                                                                  S01117
      **   ENSURE REPORT SPOOL FILE RECORDED BY RCF                       S01117
     C                     Z-ADDSFNUM     ZSNUM                           S01117
     C                     OUT  LDA                                       S01117
      *                                                                   S01117
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           SEQ     5                       S01117
     C                     PARM BRCF      SENTY   3                       S01117
     C                     PARM           SFILE                           S01117
     C                     PARM           ZSNUM   60                      S01117
     C                     PARM           ZSERR   1                       S01117
      *                                                                   S01117
     C           *LOCK     IN   LDA                                       S01117
     C           ZSERR     IFEQ 'Y'                                       S01117
      ** ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM        S01117
     C                     SETON                     U7U8LR               S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
      **                                                                  S01117
      ** GET BRANCH NAME WHEN MBIN = 'Y'                                  S01117
      **                                                                  S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C**********           CALL 'AOBRCHR0'                                S01117              CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       S01117
     C                     PARM '*KEY   ' @OPTN   7                       S01117
     C                     PARM BRCF      @DSNB   3                       S01117
     C********** SDBRCH    PARM SDBRCH    DSFDY                           S01117              CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANKS                                   S01117
     C                     MOVEL@DSNB     DBKEY                           S01117
     C                     MOVEL'SDBRCHPD'DBFILE           ***************S01117
     C                     Z-ADD05        DBASE            * DBERROR 005 *S01117
     C                     SETON                     U7U8LR***************S01117
     C                     EXSR *PSSR                                     S01117
     C                     GOTO END                                       S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C**                                                                  S01117
     C                     END                                            S01117
0466 C*
0467 C** DELETED RECORD FOUND - IGNORE
0468 C*
0469 C   05                GOTO END
0470 C*
0471 C** COUNT RECORDS READ AND PERFORM HASH TOTALLING
0472 C*
0473 C   06
0474 COR 07
0475 COR 08      NACTN7    ADD  1         NACTN7  50       ACTION RECS.
0476 C   06
0477 COR 07
0478 COR 08                GOTO PRCESS
0479 C*
0480 C           NFCLTY    ADD  1         NFCLTY  50       FACILITY RECS
0481 C  N02                GOTO PRCESS
0482 C*
0483 C   12                                                REVERSE OR
0484 COR 13                GOTO PRCESS                     CLOSE
0485 C*
0486 C                     MOVE FAMT      ZZAMT
0487 C                     Z-ADDFFTOTI    ZZTOTI
0488 C                     Z-ADDFFTOTD    ZZTOTD
0489 C                     EXSR GLZADD
0490 C                     Z-ADDZZTOTI    FFTOTI 150
0491 C                     Z-ADDZZTOTD    FFTOTD  30
0492 C*
0493 C           PRCESS    TAG                             ** PRCESS TAG *
0494 C*
0495 C** DETERMINE PROCESSING FOR EACH TYPE OF RECORD
0496 C*
     C*  INTRODUCE A NEW FIELD FOR ADNP                                   E18905
     C**********           Z-ADD*ZEROS    WRKA   132                E18905BHF255
     C********** ADNP      DIV  100       WRKA                      E18905BHF255
     C   03                Z-ADD*ZEROS    WRKA   132                      BHF255
     C   03      ADNP      DIV  100       WRKA                            BHF255
0497 C   03                EXSR QFCLTY                     FACILITY'B' REC
0498 C*
0499 C   06      PAQI      COMP 'Y'                      15ACTION HEADER
0500 C*
0501 C   07                EXSR ACTN                       ACTION DETAIL
     C*                                                                   E26951
     C*  IF AN ACTION RECORD HAS BEEN READ BUT THE MATCHING RECORD        E26951
     C*  INDICATOR IS NOT ON (I.E. FACIL NO OF ACTION IS NOT ON           E26951
     C*  FACILITIES FILE), OUTPUT DB ERROR                                E26951
     C           *IN07     IFEQ '1'                                       E26951
     C           *INMR     ANDEQ'0'                                       E26951
     C                     Z-ADD07        DBASE                           E26951
     C                     MOVE 'FCLTYL1 'DBFILE                          E26951
     C                     MOVE *BLANKS   DBKEY                           E26951
     C                     MOVELFCLT      DBKEY                           E26951
     C                     EXSR EXCPT                                     E26951
     C                     SETON                     U7U8LR               E26951
     C                     END                                            E26951
0502 C*
0503 C   U7 U8             EXSR EXCPT                      DATABASE ERROR
0504 C*
0505 C           END       TAG                             ** END TAG **
0506 C*
0507 C** TOTAL CALCS - END PROCESSING FOR PREVIOUS FACILITY
0508 C*
0509 CL1NU7                EXSR PREVF
      **                                                                  HK0000
     C***READ*IN*THE*FACILITY*TRAILER*RECORD****                    HK0000E26951
     C** READ IN THE FACILITY TRAILER RECORD IF NO DB ERROR               E26951
     CLR         *INU7     IFEQ '0'                                       E26951
     CLR                   READ FCLTYZZ                  70               HK0000
     CLR         *IN70     IFEQ '1'                                       HK0000
     CLR                   MOVEL'*READ'   DBKEY            ***************HK0000
     CLR                   Z-ADD13        DBASE            * DBERROR 013 *HK0000
     CLR                   MOVEL'FCLTYZZ' DBFILE           ***************HK0000
     C*R*********          SETON                     U7U8           HK0000E26951
     CLR                   SETON                     U7U8LR               E26951
     CLR                   END                                            HK0000
     CLR                   END                                            E26951
0510 C*
0511 C** LAST RECORD CALCS - CHECK RECORD COUNTS AND HASH TOTALS
0512 C*
      *                                                                   S01117
0513 CLRNU7      NACTN7    COMP NOREA                8080
     CLRNU7      NFCLTY    ADD  2         NFCLTY                          S01117
0514 CLRNU7      NFCLTY    COMP NOREF                8181
0515 CLRNU7N81   FFTOTI    COMP VLAF                 8181
0516 CLRNU7N81   FFTOTD    COMP VLAL                 8181
0517 CLRNU7 80
0518 CORNU7 81             SETON                     U8
      *                                                                   S01117
      **                                                                  S01117
      **   EXCUTE ERROR ROUTINE IF DATABASE ERROR EXISTS                  S01117
      **                                                                  S01117
     CLR         *INU7     IFEQ '1'                                       S01117
     CLR         *INU8     ANDEQ'1'                                       S01117
     CLR                   EXSR *PSSR                                     S01117
     CLR                   END                                            S01117
0519 C*
0520 C** OUTPUT TRAILER REC. TO FCUPD AND LKEY2
0521 C*
0522 CLRN50NU7             Z-ADD2         NFCUPD           FCLTY UPD.FILE S01117
0522 CLR 50NU7   NFCUPD    ADD  1         NFCUPD           FCLTY UPD.FILE
0523 CLR 50      NLKEY2    ADD  1         NLKEY2           C/FEE ACCT.KEYS
0524 C*R*50******NLKEY2    SUB  2         NKYGEN  50       NO. ACCT KEYS  S01117
0525 C***********                                          GENERATED      S01117
      **                                                                  S01117
      ** ENSURE TOTAL SPOOL FILE RECORDED BY RCF                          S01117
     CLR                   Z-ADDSFNUMU    ZSNUMU                          S01117
     CLR                   OUT  LDA                                       S01117
      *                                                                   S01117
     CLR                   CALL 'ZSFILE'                                  S01117
     CLR                   PARM           SEQ                             S01117
     CLR                   PARM *BLANKS   SENTY   3                       S01117
     CLR                   PARM           SFILEU                          S01117
     CLR                   PARM           ZSNUMU  60                      S01117
     CLR                   PARM           ZSERR   1                       S01117
      *                                                                   S01117
     CLR         *LOCK     IN   LDA                                       S01117
     CLR         ZSERR     IFEQ 'Y'                                       S01117
      ** ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM        S01117
     CLR                   SETON                     U7U8                 S01117
     CLR                   RETRN                                          S01117
     CLR                   END                                            S01117
      **                                                                  S01117
      ** WHEN P1 HAS NOT BEEN OPENED                                      S01117
      **                                                                  S01117
     CLR         P1OP      IFNE 'Y'                                       S01117
     CLR                   EXSR #ZZ                                       S01117
     CLR                   END                                            S01117
0526 C********************************************************************
0527 C*
0528 C** EXCPT SUBROUTINE
0529 C*
0530 C** CALLED BY: MAIN PROCESSING,FEEPAY,PREVF,ACCDAY,INIT
0531 C*
0532 C           EXCPT     BEGSR                           ** EXCPT **
0533 C*
0534 C                     EXCPT
0535 C*
0536 C                     SETOF                     404142
0537 C*
0538 C                     ENDSR                           ** ENDSR **
0539 C*
0540 C********************************************************************
0541 C********************************************************************
0542 C*
0543 C** QFCLTY SUBROUTINE - TO PROCESS FACILITY 'B' RECORD
0544 C*
0545 C** CALLED BY: MAIN PROCESSING
0546 C*
0547 C** CALLS: FCLCDT
0548 C*
0549 C           QFCLTY    BEGSR                           ** FCLTY **
0550 C**
0551 C**   SAVE LAST ACCRUAL DATE FOR OUTPUT TO LKEY2
0552 C**
0553 C                     Z-ADDACCD      SACCD   50
0554 C*
     C                     Z-ADDSLCD      PSLCD   50                      E47264
     C/COPY WNCPYSRC,LE0460C002
     C**                                                                  E47264
0555 C** CHECK REVOLVING CREDIT INDICATOR
0556 C*
0557 C           RVCR      COMP 'Y'                      21
0558 C*
0559 C** FIND FACILITY CURRENCY DECIMAL PLACES
0560 C*
0561 C                     Z-ADD1         X
0562 C*
0563 C           FCCY      LOKUPCURR,X                   70
0564 C*
0565 C   70                GOTO DECPL
0566 C*
0567 C                     SETON                     U7U8LR
0568 C**************       MOVELBLANKS    ZTABKY                          S01194
0569 C**************       MOVEL'20'      ZTABKY                          S01194
0570 C**************       MOVELFCCY      WRK4    4                       S01194
0571 C**************       MOVE '1'       WRK4                            S01194
0572 C**************       MOVE WRK4      ZTABKY                          S01194
0573 C**************       MOVELZTABKY    DBKEY                           S01194
     C                     MOVELFCCY      DBKEY                           S01194
0574 C                     Z-ADD6         DBASE            *** DBASE 6 ***
0575 C**************       MOVE 'TABLE'   DBFILE                          S01194
     C                     MOVE 'SDCURRPD'DBFILE                          S01194
0576 C                     GOTO FCLTEN
0577 C*
0578 C           DECPL     TAG                             ** DECPL TAG **
0579 C*
0580 C           CDEP,X    COMP 1                      3031
0581 C           CDEP,X    COMP 2                    33  32
0582 C*
0583 C** IF FACILITY IS REVERSED, CALCULATE C/FEE RATE HERE FOR ACCT.KEY
0584 C*
0585 C   12      BRAT      ADD  SPRD      ZIRATE
0586 C*
0587 C** SET UP CALC. BASIS FOR FUTURE CALCS.
0588 C*
0589 C                     Z-ADDCALC      ZICALC
0590 C*
0591 C** IF FACILITY IS REVERSED OF EXPIRED, DO NO FURTHER PROCESSING
0592 C*
0593 C   12
0594 COR 14                GOTO FCLTEN
0595 C*
0596 C** CHECK IF FACILITY IS COMMITMENT FEE BEARING
0597 C*
0598 C           CMFT      COMP ' '                  2020
0599 C*
0600 C** IF FEE BEARING, CHECK IF END DATE REACHED
0601 C*
0602 C   20                TESTB'4'       BITS       20
0603 C*                                                    SET UP C/FEE
0604 C   20                EXSR FCLCDT                     CALC, DETAILS
0605 C*
0606 C           FCLTEN    ENDSR                           ** FCLTEN **
0607 C*
0608 C********************************************************************
0609 C********************************************************************
0610 C*
0611 C** FCLCDT SUBROUTINE - TO SET UP COMMITMENT FEE CALC. DETAILS
0612 C*
0613 C** CALLED BY: QFCLTY
0614 C*
0615 C** CALLS: FPYDTR
0616 C*
0617 C           FCLCDT    BEGSR                           ** FCLCDT **
0618 C*
0619 C** CHECK IF ANY BASE RATE CHANGES TODAY
0620 C*
0621 C  N17                GOTO FEERAT
0622 C*
0623 C** CHECK IF FACILITY C/FEE IS LINKED TO A BASE RATE
0624 C*
0625 C********** BCOD      COMP 0                    70                                       CSD103
     C           BCOD      COMP *BLANKS              70                                       CSD103
0626 C*
0627 C  N70                GOTO FEERAT
0628 C*
0629 C** CHECK IF BASE RATE HAS BEEN AMENDED
0630 C*
0631 C                     MOVELFCCY      LOKUPB  5
0632 C                     MOVE BCOD      LOKUPB
0633 C                     Z-ADD1         X              70SETOF 70
0634 C           LOKUPB    LOKUPBRCC,X                   70
0635 C*
0636 C** IF MATCH FOUND, OVERWRITE CURRENT BASE RATE WITH NEW
0637 C*
0638 C   70                Z-ADDBASE,X    BRAT
0639 C*
0640 C           FEERAT    TAG                             ** FEERAT TAG *
0641 C*
0642 C** CALCULATE C/FEE RATE
0643 C*
0644 C           BRAT      ADD  SPRD      ZIRATE
0645 C*
0646 C** CHECK FOR C/FEE PAYMENT DUE THIS RUN
0647 C*
0648 C                     EXSR FPYDTR
0649 C*
0650 C                     ENDSR
0651 C*
0652 C********************************************************************
0653 C********************************************************************
0654 C*
0655 C** FPYDTR SUBROUTINE - TO CHECK FOR C/FEE PAYMENT DUE THIS RUN
0656 C*
0657 C** CALLED BY: FCLCDT
0658 C*
0659 C           FPYDTR    BEGSR                           ** FPYDTR **
0660 C*
0661 C** CHECK COMMITMENT FEE DUE DATE
0662 C*
0663 C           DUDT      COMP 0                        70
0664 C*
0665 C  N70                GOTO DUDTNZ
0666 C*
0667 C** CHECK COMMITMENT FEE END DATE
0668 C*
0669 C           EDDT      COMP 0                        70
0670 C   70                SETOF                     19    NO C/FEE PT.DUE
0671 C   70                GOTO FPYDEN
0672 C*
0673 C** CHECK END DATE AGAINST EVENT CONTROL DATE
0674 C*
0675 C           EDDT      COMP EVCD                 70
0676 C   70                SETOF                     19
0677 C   70                GOTO FPYDEN
0678 C*
0679 C** C/FEE PAYMENT DUE - SET INDICATOR AND PAYMENT DATE
0680 C*
0681 C                     SETON                     19
0682 C                     Z-ADDEDDT      PAYDAT  50
0683 C                     GOTO FPYDEN
0684 C*
0685 C           DUDTNZ    TAG                             ** DUDTNZ TAG *
0686 C*
0687 C** CHECK DUE DATE AGAINST EVENT CONTROL DATE
0688 C*
0689 C           DUDT      COMP EVCD                 70
0690 C   70                SETOF                     19
0691 C  N70                SETON                     19
0692 C  N70                Z-ADDDUDT      PAYDAT
0693 C*
0694 C           FPYDEN    ENDSR                           ** FPYDEN **
0695 C*
0696 C********************************************************************
0697 C********************************************************************
0698 C*
0699 C** ACTN SUBROUTINE - TO PROCESS ACTION RECORDS
0700 C*
0701 C** CALLED BY: MAIN PROCESSING
0702 C*
0703 C** CALLS:     ACCRUE
0704 C*
0705 C           ACTN      BEGSR                           ** ACTN **
0706 C*
0707 C** IF RECORD IS NOT TO BE ACTIONED, IGNORE
0708 C*
0709 C           ACTI      COMP 'Y'                      70
0710 C  N70                GOTO ACTNEN
0711 C*
0712 C** IGNORE PARTICIPATIONS SOLD
0713 C*
0714 C           PTYP      COMP 66                       70
0715 C  N70      PTYP      COMP 67                       70
0716 C   70                GOTO ACTNEN
0717 C*
0718 C** IGNORE RECORDS NOT INVOLVING MOVEMENTS OF PRINCIPAL
0719 C*
0720 C           AMTP      COMP 'RV'                     71
0721 C           AMTP      COMP 'ST'                     72
0722 C           AMTP      COMP 'PI'                     73
0723 C           AMTP      COMP 'MR'                     74
0724 C           AMTP      COMP 'IN'                     75
0725 C           AMTP      COMP 'RE'                     76
0726 C           AMTP      COMP 'MA'                     77
0727 C  N71N72N73
0728 CANN74N75N76
0729 CANN77                GOTO ACTNEN
0730 C*
0731 C** IGNORE RECORD IF PRINCIPAL IS ZERO
0732 C*
0733 C           PRAM      COMP 0                        70
0734 C   70                GOTO ACTNEN
0735 C*
0736 C** IGNORE MATURITY RECORDS IF NOT AUTO-SETTLE
0737 C*
0738 C   77      AUTO      COMP 'N'                      70
0739 C   77 70             GOTO ACTNEN
0740 C*
     C** POSITION OF THIS CHECK MOVED TO ALLOW UPDATE OF TOTD FIELD ON
     C** ALL FACILTIES REGARDLESS OF C/FEE TYPE .TOTD IS NOW ALSO USED IN
     C** THE CALCULATION OF AVAIL. AMOUNTS FOR NON RC FACILITIES (LE0490)
0742 C*
0746 C*
0747 C** IF ACTION CCY IS NOT THE SAME AS FCLTY CCY, CALC.FCLTY CCY EQUIV
0748 C*
0749 C           FCCY      COMP CCY                      70
0750 C   70                GOTO ACCRU
0751 C*
0752 C                     Z-ADD1         X              70SETOF 70
0753 C           FCCY      LOKUPCURR,X                   70
0754 C  N70                MOVE FCCY      CCYERR  3        DATABASE ERROR
0755 C  N70                GOTO ERROR
0756 C*
0757 C                     Z-ADDCDEP,X    FCDP    10
0758 C                     Z-ADDCSPT,X    FSPT   138
0759 C**************       Z-ADDMTDV,X    FMDI    10     7878 ON - DIVIDE S01194
0759 C***********          MOVELMTDV,X    FMDI    1      7878 ON - DS01194E26951
     C                     MOVELMTDV,X    FMDI    1                       E26951
     C                     SETOF                         78               E26951
     C           FMDI      IFEQ 'D'                                       E26951
     C                     SETON                         78               E26951
     C                     END                                            E26951
0760 C*
0761 C                     Z-ADD1         X              70SETOF 70
0762 C           CCY       LOKUPCURR,X                   70
0763 C  N70                MOVE CCY       CCYERR           DATABASE ERROR
0764 C  N70                GOTO ERROR
0765 C*
0766 C                     Z-ADDCDEP,X    ACDP    10
0767 C                     Z-ADDCSPT,X    ASPT   138
0768 C**************       Z-ADDMTDV,X    AMDI    10     7979 ON - DIVIDE S01194
0768 C***********          MOVELMTDV,X    AMDI    1      7979 ON - DS01194E26951
0759 C                     MOVELMTDV,X    AMDI    1                       E26951
     C                     SETOF                         79               E26951
     C           AMDI      IFEQ 'D'                                       E26951
     C                     SETON                         79               E26951
     C                     END                                            E26951
0769 C*
0770 C                     GOTO CONVRT
0771 C*
0772 C           ERROR     TAG                             ** ERROR TAG **
0773 C*
0774 C                     SETON                     U7U8LR
0775 C**************       MOVELBLANKS    ZTABKY                          S01194
0776 C**************       MOVEL'20'      ZTABKY                          S01194
0777 C**************       MOVELCCYERR    WRK4                            S01194
0778 C**************       MOVE '1'       WRK4                            S01194
0779 C**************       MOVE WRK4      ZTABKY                          S01194
0780 C**************       MOVELZTABKY    DBKEY                           S01194
     C                     MOVELCCYERR    DBKEY            ***************S01194
0781 C                     Z-ADD5         DBASE            *** DBASE 5 ***
     C                     MOVE 'SDCURRPD'DBFILE           ***************S01194
0782 C**************       MOVE 'TABLE'   DBFILE                          S01194
0783 C                     GOTO ACTNEN
0784 C*
0785 C           CONVRT    TAG                             ** CONVRT TAG *
0786 C*
0787 C** CALCULATE CROSS RATE TO FACILITY CURRENCY
0788 C*
0789 C***78*********       Z-ADD1         AMDI                            S01194
0790 C**N78*********       Z-ADD0         AMDI                            S01194
0789 C   78                MOVEL'M'       AMDI                            S01194
0790 C  N78                MOVEL'D'       AMDI                            S01194
0791 C   78N79
0792 CORN78 79   FSPT      MULT ASPT      ASPT      H
0793 C   78 79
0794 CORN78N79   FSPT      DIV  ASPT      ASPT      H
0795 C*
0796 C** ADJUST EXCHANGE RATE FOR DECIMAL PLACES
0797 C*
0798 C           FCDP      SUB  ACDP      CX      10
0799 C           CX        ADD  4         CX
0800 C*
0801 C  N78      ASPT      DIV  POWR,CX   EXRATE 159H
0802 C  N78      1         DIV  EXRATE    EXRATE    H
0803 C   78      ASPT      MULT POWR,CX   EXRATE    H
0804 C*
0805 C** CONVERT PRINCIPAL AMOUNT TO FACILITY CCY
0806 C*
0807 C           PRAM      MULT EXRATE    PRAM      H
0808 C*
0809 C           ACCRU     TAG                             ** ACCRU TAG **
     C*
     C** CHECK IF C/FEE PROCESSING FOR THIS RECORD IS REQUIRED
     C*
     C   20      CMFT      COMP 'U'                      70
0810 C*
0811 C** ACCRUE COMMITMENT FEES
0812 C*
     C   20 70             EXSR ACCRUE
0814 C*
0815 C** UPDATE DRAWN AMOUNT
0816 C*
0817 C** FOR 'IN' ACTIONS, CHECK IF INT. CAPITALISED FIRST
0818 C*
0819 C   75      INTC      COMP 'Y'                      70
     C   71      LORED     COMP RUND                     61
     C   71 61             GOTO ACTNEN
0820 C*
0821 C   71 21                                             REVERSAL-REV.CR
0822 COR 74 21                                             MAN.REPAY'T-"
0823 COR 76 21                                             REPAYMENT-  "
0824 COR 77 21   TOTD      SUB  PRAM      TOTD             MATURITY-   "
0825 C*
0826 C   72                                                START DATE
0827 COR 73                                                PRINC.INCR.
0828 COR 75 70   TOTD      ADD  PRAM      TOTD             CAP'D INT PAY'T
0829 C*
0830 C   71N21   TOTD      SUB  TAMT      TOTD             REVERSAL-NOT RC
0831 C*
     C/COPY WNCPYSRC,LE0460C003
0832 C           ACTNEN    ENDSR                           ** ACTNEN **
0833 C*
0834 C********************************************************************
0835 C********************************************************************
0836 C*
0837 C** ACCRUE SUBROUTINE - TO ACCRUE COMMITMENT FEES
0838 C*
0839 C** CALLED BY: ACTN,PREVF
0840 C*
0841 C** CALLS:     FEEPAY,FEECLC
0842 C*
0843 C           ACCRUE    BEGSR                           ** ACCRUE **
0844 C*
0845 C           PAYDUE    TAG                             ** PAYDUE TAG *
0846 C*
0847 C** CHECK IF A PAYMENT IS DUE THIS RUN
0848 C*
0849 C  N19                GOTO CLCFEE
0850 C*
0851 C** CHECK PAYMENT DATE AGAINST VALUE DATE OF ACTION
0852 C*
0853 C           PAYDAT    COMP VDAT                 70
0854 C   70                GOTO CLCFEE
0855 C*
0856 C** PERFORM C/FEE PAY'T PROCESSING AND UPDATE NEXT C/FEE PAY'T DATE
0857 C*
0858 C                     EXSR FEEPAY
0859 C*
0860 C** REPEAT PROCESSING SO FAR FOR NEW C/FEE PAY'T DATE
0861 C*
0862 C                     GOTO PAYDUE
0863 C*
0864 C           CLCFEE    TAG                             ** CLCFEE TAG *
0865 C*
0866 C** IF ACTION IS BACK-VALUED. DO NO FURTHER PROCESSING
0867 C*
0868 C           VDAT      COMP ACCD                   7070
0869 C   70                GOTO ACCREN
0870 C*
0871 C** CALCULATE FEES FROM ACCR.CONT.DATE TO THIS ACTION
0872 C*
0873 C                     Z-ADDACCD      ZIBEG
0874 C                     Z-ADDVDAT      ZIEND
0875 C                     EXSR FEECLC
0876 C*
0877 C** UPDATE C/FEES ACCRUED TO CONTROL DATE
0878 C*
0879 C***********ADNP      ADD  FEE       ADNP                            E18905
0879 C           WRKA      ADD  FEE       WRKA                            E18905
0880 C*
0881 C** RESET C/FEE ACCRUAL CONTROL DATE
0882 C*
0883 C                     Z-ADDVDAT      ACCD
0884 C*
0885 C           ACCREN    ENDSR                           ** ACCREN **
0886 C*
0887 C********************************************************************
0888 C********************************************************************
0889 C*
0890 C** FEEPAY SUBROUTINE - TO PROCESS COMMITMENT FEE PAYMENTS
0891 C*
0892 C** CALLED BY: ACCRUE
0893 C*
0894 C***CALLS:*****FEECLC,EXCPT,GLZADD,ZPREQB,ZDATE5,FPYDTR*********     S01195
     C** CALLS:     FEECLC,EXCPT,GLZADD,FREQB,ZDATE5,ZFWDT                S01195
0895 C*
0896 C           FEEPAY    BEGSR                           ** FEEPAY **
0897 C*
0918 C                     MOVELFTYP      AKEY   10        ACCOUNT KEY
0920 C                     Z-ADDPAYDAT    EDAT    50       EVENT DATE
0921 C                     Z-ADD0         RVIND   10       REVERSAL IND.
     C**
0898 C** CALCULATE FEES FROM ACCR.CONT.DATE TO C/FEE PAY'T DATE
0899 C*
0900 C                     Z-ADDACCD      ZIBEG
0901 C                     Z-ADDPAYDAT    ZIEND
0902 C                     EXSR FEECLC
0903 C*
0904 C** UPDATE C/FEES ACCRUED TO CONTROL DATE
0905 C*
0906 C***********ADNP      ADD  FEE       ADNP                            E18905
0906 C           WRKA      ADD  FEE       WRKA                            E18905
0907 C*
0908 C** CALCULATE FEES NOW DUE
0909 C*
     C***********ADNP      ADD  ADJP      EAMT      H                     E18905
     C           WRKA      ADD  ADJP      EAMT      H                     E18905
0911 C           EAMT      ADD  ADJN      EAMT             TOTAL FEES DUE
0912 C*
0913 C           EAMT      SUB  PDTD      EAMT   130   7078
0914 C   78                GOTO NOPAYX
0915 C*
0916 C** GENERATE PAYMENT ACCOUNT KEY RECORD
0917 C*
0919 C                     MOVE 'R     C' AKEY
0922 C*
0923 C***********          SETON                     41                   S01117
     C                     SETON                     416263               S01117
     C                     ADD  1         NKYGEN                          S01117
0924 C                     EXSR EXCPT
0925 C*
0926 C** UPDATE HASH TOTALS
0927 C*
0928 C           NLKEY2    ADD  1         NLKEY2
0929 C           NOPAYX    TAG                             ** NOPAYX TAG *
0930 C*
0931 C                     MOVE EAMT      ZZAMT
0932 C                     Z-ADDKKTOTI    ZZTOTI
0933 C                     Z-ADDKKTOTD    ZZTOTD
0934 C  N70                EXSR GLZADD
0935 C   70                EXSR GLZSUB
0936 C*
0937 C** ADD FEE DUE TO C/FEES PAID TO DATE
0938 C*
0939 C           PDTD      ADD  EAMT      PDTD
0940 C*
0941 C** UPDATE MANUAL ADJUSTMENTS FIELDS
0942 C*
0943 C           ADJP      ADD  ADJN      ADJP
0944 C                     Z-ADD0         ADJN
0945 C*
0946 C** CALCULATE DIFFERENCE BETWEEN FEES PAID AND FEES POSTED
0947 C*
0948 C           PDTD      SUB  AFPD      EAMT         7078
0949 C   78                GOTO NOPAY
0950 C*
0951 C** GENERATE ACCRUAL ACCOUNT KEY RECORD
0952 C*
     C                     MOVELFTYP      AKEY                            E47264
     C                     Z-ADDPAYDAT    EDAT                            E47264
0953 C                     MOVE 'A     C' AKEY
0954 C*
0955 C***********          SETON                     41                   S01117
     C                     SETON                     416263               S01117
     C                     ADD  1         NKYGEN                          S01117
0956 C                     EXSR EXCPT
0957 C** ADD DIFFERENCE TO ACCR.FEES POSTED TO DATE
0958 C*
0959 C           AFPD      ADD  EAMT      AFPD
0960 C           NLKEY2    ADD  1         NLKEY2
0961 C           NOPAY     TAG                             ** NOPAY TAG **
0962 C*
0963 C** UPDATE HASH TOTALS
0964 C*
0965 C*
0966 C                     MOVE EAMT      ZZAMT
0967 C  N70                EXSR GLZADD
0968 C   70                EXSR GLZSUB
0969 C                     Z-ADDZZTOTI    KKTOTI 150
0970 C                     Z-ADDZZTOTD    KKTOTD  30
0971 C*
0972 C*
0973 C** UPDATE START/LAST ACCR.DATE AND ACCR.CONT.DATE WITH THIS PAY DATE
0974 C*
0975 C                     Z-ADDPAYDAT    SLCD
0976 C                     Z-ADDPAYDAT    ACCD
0977 C*********************Z-ADDPAYDAT    SACCD                           E47264
0977 C                     Z-ADDPAYDAT    PSLCD                           E47264
0978 C*
0979 C** UPDATE PAYMENT DATE
0980 C*
0981 C** CHECK IF END DATE JUST PROCESSED
0982 C*
0983 C           PAYDAT    COMP EDDT                     70
0984 C   70                SETOF                     1920  NO C/FEE PT DUE
0985 C   70                BITON'4'       BITS             END DATE PROC'D
0986 C   70                GOTO FEEPEN
0987 C*
0988 C** SET BITS TO ENSURE TELEXES SENT
0989 C*
0990 C                     BITOF'02'      BITS
0991 C*
0992 C** CALCULATE NEXT C/FEE PAYMENT DATE
0993 C*
0994 C** CHECK PAYMENT FREQUENCY
0995 C*
0996 C           BLFR      COMP ' '                      70
0997 C   70                Z-ADD0         DUDT
0998 C   70                GOTO PYTRUN
0999 C*
1000 C** SET UP FIELDS FOR SUBROUTINE
1001 C*
1002 C                     Z-ADDPAYDAT    ZDAYNO
1003 C                     MOVE BLFR      ZFREQ
1004 C                     MOVE FCCY      ZCCY
     C                     EXSR SETLOC                                    S01195
     C                     MOVE W@STLL    ZLOC                            S01195
1005 C                     Z-ADDBLDN      ZMDAY
1006 C***********          EXSR ZFREQB                                    S01195
1007 C***********          EXSR ZDATE5                                    S01195
     C                     EXSR FREQB                                     S01195
     C                     Z-ADD*ZERO     ZNRDYS                          S01195
     C                     EXSR ZFWDT                                     S01195
1008 C*
1009 C                     Z-ADDZDYNBR    DUDT             NEXT PAY'T DATE
1010 C*
1011 C** CHECK NEXT PAYMENT DATE AGAINST END DATE
1012 C*
1013 C           DUDT      COMP EDDT                   70
1014 C   70                GOTO PYTRUN
1015 C*
1016 C** NEXT PAYMENT DATE IS BEYOND END DATE - SET TO ZERO
1017 C*
1018 C                     Z-ADD0         DUDT
1019 C*
1020 C           PYTRUN    TAG                             ** PYTRUN TAG *
1021 C*
1022 C** CHECK IF PAYMENT DUE THIS RUN
1023 C*
1024 C                     EXSR FPYDTR
1025 C*
1026 C           FEEPEN    ENDSR                           ** FEEPEN **
1027 C*
1028 C********************************************************************
1029 C********************************************************************
1030 C*
1031 C** FEECLC SUBROUTINE - TO CALCULATE C/FEE AMOUNTS
1032 C*
1033 C** CALLED BY: ACCRUE,FEEPAY.ACCDAY
1034 C*
1035 C** CALLS:     GLINTC
1036 C*
1037 C           FEECLC    BEGSR                           ** FEECLC **
1038 C*
1039 C** CALCULATE UNDRAWN AMOUNT
1040 C*
     C**TOTD IS NOW MAINTAINED FOR ALL FACILITIES REGARDLESS OF C/FEE TYPE
     C           CMFT      COMP 'U'                      70
     C   70      FAMT      SUB  TOTD      ZIAMT
     C  N70                Z-ADDFAMT      ZIAMT
     C           ZIAMT     COMP 0                      7070
     C*
1042 C   70                Z-ADD0         FEE              FCLTY OVERDRAWN
1043 C   70                GOTO FEECEN
1044 C*
1045 C** CALCULATE FEE
1046 C*
     C/COPY WNCPYSRC,LE0460C004
1047 C                     EXSR GLINTC
     C                     Z-ADDZINTR     FEE    132
1049 C*
1050 C           FEECEN    ENDSR                           ** FEECEN **
1051 C*
1052 C********************************************************************
1053 C********************************************************************
1054 C*
1055 C** PREVF SUBROUTINE - TO PROCESS FACILITY AT TOTAL TIME
1056 C*
1057 C** CALLED BY: MAIN PROCESSING
1058 C*
1059 C** CALLS:     EXCPT,GLZADD,EXPARR,ACCRUE,ACCDAY
1060 C*
1061 C           PREVF     BEGSR                           ** PREVF **
1062 C*
1063 C** CHECK RECORD TYPE OF FACILITY
1064 C*
1065 C   11                                                LIVE
1066 COR 13                GOTO DORC                       CLOSED
1067 C   14                GOTO EXP                        EXPIRED
1068 C*
1069 C** FACILITY IS REVERSED - GENERATE ACCOUNT KEYS
1070 C*
1071 C                     MOVELFTYP      AKEY             PAYMENT ACCOUNT
1072 C                     MOVE 'R     C' AKEY             KEY
1073 C                     Z-ADDRUND      EDAT
1074 C                     Z-ADD1         RVIND
1075 C                     Z-ADDPDTD      EAMT         7870
1076 C*
1077 C                     Z-ADDKKTOTI    ZZTOTI           SET UP FIELDS
1078 C                     Z-ADDKKTOTD    ZZTOTD           FOR HASHING
1079 C*
1080 C** DO NOT GENERATE KEY IF AMOUNT IS ZERO
1081 C*
1082 C   70                GOTO ACCRKY
1083 C*
1084 C***********          SETON                     41                   S01117
     C                     SETON                     416263               S01117
     C                     ADD  1         NKYGEN                          S01117
1085 C                     EXSR EXCPT
1086 C*
1087 C** UPDATE HASH TOTALS
1088 C*
1089 C           NLKEY2    ADD  1         NLKEY2
1090 C*
1091 C                     MOVE EAMT      ZZAMT
1092 C  N78                EXSR GLZADD
1093 C   78                EXSR GLZSUB
1094 C*
1095 C           ACCRKY    TAG                             ** ACCRKY TAG *
1096 C*
1097 C                     MOVE 'A     C' AKEY             ACCR.ACCT.KEY
1098 C           AFPD      ADD  ADJP      EAMT         7870
1099 C*
1100 C** DO NOT GENERATE IF AMOUNT IS ZERO
1101 C*
1102 C   70                GOTO HSHRST
1103 C*
1104 C***********          SETON                     41                   S01117
     C                     SETON                     416263               S01117
     C                     ADD  1         NKYGEN                          S01117
1105 C                     EXSR EXCPT
1106 C*
1107 C** UPDATE HASH TOTALS
1108 C*
1109 C           NLKEY2    ADD  1         NLKEY2
1110 C*
1111 C                     MOVE EAMT      ZZAMT
1112 C  N78                EXSR GLZADD
1113 C   78                EXSR GLZSUB
1114 C*
1115 C           HSHRST    TAG                             ** HSHRST TAG *
1116 C*
1117 C                     Z-ADDZZTOTI    KKTOTI           RESET FIELDS
1118 C                     Z-ADDZZTOTD    KKTOTD           AFTER HASHING
1119 C*
1120 C                     GOTO PREVEN
1121 C*
1122 C           EXP       TAG                             ** EXP TAG **
1123 C*
1124 C** FACILITY IS EXPIRED - SET AVAILABILITY DATES AND OUTPUT TO NEW
1125 C**                       FACILITY FILE
1126 C*
1127 C                     EXSR EXPARR
1128 C*
1129 C** OUTPUT UPDATED FACILITY RECORDS TO NEW FACILITY FILE
1130 C*
1131 C                     SETON                     42
     C   42                MOVEASTAMP,1   STMP   26                                           CLE064
1132 C                     EXSR EXCPT
1133 C*
1134 C** UPDATE HASH TOTAL
1135 C*
1136 C           NFCUPD    ADD  2         NFCUPD
1137 C*
1138 C                     GOTO PREVEN
1139 C*
1140 C           DORC      TAG                             ** DORC TAG **
1141 C*
1142 C** FACILITY IS LIVE OR CLOSED
1143 C*
1144 C** CHECK IF COMMITMENT FEE PROCESSING IS REQUIRED
1145 C*
1146 C  N20                GOTO OUTPUT                     PROC'G NOT REQD
1147 C*
1148 C** ACCRUE C/FEES - USE EVENT CONTROL DATE AS VALUE DATE
1149 C*
1150 C                     Z-ADDEVCD      VDAT
1151 C*
1152 C                     EXSR ACCRUE
1153 C*
1154 C** CHECK IF ACCRUALS/PROFIT DAY PROCESSING IS REQ'D
1155 C*
1156 C  N15                                                NOT ACCRUAL DAY
1157 CORN20                GOTO OUTPUT                     C/FEE PROC'G
1158 C*                                                      NOT REQ'D
1159 C                     EXSR ACCDAY
1160 C*
1161 C           OUTPUT    TAG                             ** OUTPUT TAG *
1162 C*
1163 C** IF FACILITY IS CLOSED, CHECK IF THIS IS MONTH END-DROP REC. IF SO
1164 C*
1165 C   13 18             GOTO PREVEN
1166 C*
1167 C** IF FACILITY IS LIVE, CHECK EXPIRY DATE AGAINST EVENT CONTROL DATE
1168 C*
     C/COPY WNCPYSRC,LE0460C001
1169 C   11      DTEX      COMP EVCD                   2222
1170 C*
1171 C** SET AVAILABILITY DATES AND OUTPUT TO NEW FACILITY FILE
1172 C*
1173 C                     EXSR EXPARR
1174 C*
1175 C                     SETON                     42
     C   42                MOVEASTAMP,1   STMP                                                CLE064
1176 C                     EXSR EXCPT
1177 C*
1178 C** UPDATE HASH TOTAL
1179 C*
1180 C           NFCUPD    ADD  2         NFCUPD
1181 C*
1182 C           PREVEN    ENDSR                           ** PREVEN **
1183 C*
1184 C********************************************************************
1185 C********************************************************************
1186 C*
1187 C** EXPARR SUBROUTINE - TO UPDATE DATES FOR AVAILABILITY ARRAY
1188 C*
1189 C** CALLED BY: PREVF
1190 C*
1191 C***CALLS:*****ZDATE3****                                            S01195
     C** CALLS:     ZFWDT                                                 S01195
1192 C*
1193 C           EXPARR    BEGSR                           ** EXPARR **
1194 C*
1195 C** IF CCY IS SAME AS PREVIOUS FACILITY CCY, NO NEED TO CALC. AGAIN
1196 C*
1197 C           FCCY      COMP PCCY                     70
1198 C   70                GOTO EXPAEN
1199 C*
1200 C** CALCULATE DATES FOR ARRAY,STARTING WITH RUN DATE,THEN NEXT 9 WDAY
1201 C*
1202 C                     Z-ADDRUND      NRUN,1
1203 C                     Z-ADDRUND      ZDAYNO
1204 C***********          Z-ADD1         ZNRDYS                          S01195
1205 C                     MOVE FCCY      ZCCY
     C                     MOVE *BLANKS   ZLOC                            S01195
1206 C                     Z-ADD1         X
1207 C*
1208 C           LOOP      TAG                             ** LOOP TAG **
1209 C*
1210 C           X         ADD  1         X
1204 C                     Z-ADD1         ZNRDYS                          S01195
1211 C***********          EXSR ZDATE3                                    S01195
     C                     EXSR ZFWDT                                     S01195
1212 C                     Z-ADDZDYNBR    NRUN,X
1213 C                     Z-ADDZDYNBR    ZDAYNO
1214 C*
1215 C           X         COMP 10                       70
1216 C  N70                GOTO LOOP
1217 C*
1218 C** SAVE FACILITY CURRENCY FOR NEXT TIME
1219 C*
1220 C                     MOVE FCCY      PCCY    3
1221 C*
1222 C           EXPAEN    ENDSR                           ** EXPAEN **
1223 C********************************************************************
1224 C********************************************************************
1225 C*
1226 C** ACCDAY SUBROUTINE - TO PERFORM ACCRUAL DAY PROCESSING
1227 C*
1228 C** CALLED BY: PREVF
1229 C*
1230 C** CALLS:     FEECLC,EXCPT,GLZADD
1231 C*
1232 C           ACCDAY    BEGSR                           ** ACCDAY **
1233 C*
1234 C** CHECK ACC.PROFIT DATE AGAINST ACC.CONTROL DATE
1235 C*
1236 C           APDA      COMP ACCD                   82
1237 C   82                GOTO ACCDEN
1238 C*
1239 C** CHECK ACCRUALS OPTION
1240 C*
1241 C   23                Z-ADD0         FEE              LAST DAY PROC'G
1242 C   23                GOTO ACCKEY
1243 C*
1244 C** CALCULATE ONE DAYS C/FEE FOR 1ST DAY PROCESSING
1245 C*
     C**
     C**  PROGRAM AMENDED TO USE DAYNOS 1 AND 2 TO CALCULATE 1 DAY'S
     C**  FEES BECAUSE CALC METH 3 USES ZDATE2 SR.
     C**
     C                     Z-ADD1         ZIBEG
     C                     Z-ADD2         ZIEND
1248 C                     EXSR FEECLC
1249 C*
1250 C           ACCKEY    TAG                             ** ACCKEY TAG *
1251 C*
1252 C** CALCULATE ACCRUAL KEY AMOUNT
1253 C*
     C***********ADNP      ADD  FEE       EAMT      H                     E18905
     C           WRKA      ADD  FEE       EAMT      H                     E18905
1255 C           EAMT      ADD  ADJP      EAMT
1256 C           EAMT      ADD  ADJN      EAMT
1257 C           EAMT      SUB  AFPD      EAMT         7078
1258 C   78                GOTO NOKEY
1259 C*
1260 C** GENERATE ACCRUAL ACCOUNT KEY RECORD
1261 C*
1262 C                     MOVELFTYP      AKEY
1263 C                     MOVE 'A     C' AKEY
1264 C                     Z-ADDEVCD      EDAT
1265 C                     Z-ADD0         RVIND
1266 C*
1267 C***********          SETON                     41                   S01117
     C                     SETON                     416263               S01117
     C                     ADD  1         NKYGEN                          S01117
1268 C                     EXSR EXCPT
1269 C           AFPD      ADD  EAMT      AFPD
1270 C           NLKEY2    ADD  1         NLKEY2
1271 C           NOKEY     TAG                             ** NOKEY TAG **
1272 C*
1273 C** UPDATE HASH TOTALS
1274 C*
1275 C*
1276 C                     MOVE EAMT      ZZAMT
1277 C                     Z-ADDKKTOTI    ZZTOTI
1278 C                     Z-ADDKKTOTD    ZZTOTD
1279 C  N70                EXSR GLZADD
1280 C   70                EXSR GLZSUB
1281 C                     Z-ADDZZTOTI    KKTOTI
1282 C                     Z-ADDZZTOTD    KKTOTD
1283 C*
1284 C** UPDATE MANUAL ADJUSTMENTS FIELDS
1285 C*
1286 C           ADJP      ADD  ADJN      ADJP
1287 C                     Z-ADD0         ADJN
1288 C*
1289 C           ACCDEN    ENDSR                           ** ACCDEN **
1290 C*
1291 C********************************************************************
1292 C********************************************************************
1293 C*
1294 C** INIT SUBROUTINE - FIRST CYCLE CALCS
1295 C*
1296 C** CALLED BY: MAIN PROCESSING
1297 C*
1298 C** CALLS:     ZSYSTM,EXCPT
1299 C*
1300 C           INIT      BEGSR                           ** INIT **
1301 C*
1302 C                     MOVE ' '       BLANKS 29        SET UP FIELDS
1303 C                     MOVE BLANKS    DBKEY            FOR DATABASE
1304 C                     MOVE 'LE0460'  DBPGM            ERRORS
      **                                                                  S01117
     C**   DEFINE JNSTAT                                                  E30572
     C           *NAMVAR   DEFN           JNSTAT                          E30572
      **                                                                  S01117
      **   IN THE DATAAREA RUNDAT                                         S01117
      **                                                                  S01117
     C           *NAMVAR   DEFN RUNDAT    RUNDT                           S01117
     C                     IN   RUNDT                                     S01117
     C*    DEFINE LDA                                                     S01117
     C           *NAMVAR   DEFN           LDA                             S01117
     C           *LOCK     IN   LDA                                       S01117
      *                                                                   S01117
      *    SETON INDICATOR FOR MUTIBRANCHING = NO                         S01117
      *                                                                   S01117
     C           MBIN      IFNE 'Y'                                       S01117
     C                     SETON                     65                   S01117
      *                                                                   S01117
     C                     END                                            S01117
1305 C*
1306 C                     EXSR ZSYSTM                     ACCESS ICDR1
1307 C***99*********       SETON                     U7U8LR               S01194
1308 C***99*********       MOVELZTABKY    DBKEY                           S01194
1309 C***99*********       Z-ADD1         DBASE            *** DBASE 1 ***S01194
1310 C***99*********       MOVE 'TABLE'   DBFILE                          S01194
1311 C   99                GOTO INITEN
1312 C*
1313 C**************       MOVE '1'       ZTABKY           ACCESS ICDR2   S01194
1314 C***********ZTABKY    CHAINTABLE                99                   S01194
     C**                                                                  S01194
     C** ACCESS GENERAL LEDGER DETAILS                                    S01194
     C**                                                                  S01194
     C**********           CALL 'AOGELRR0'                                S01194              CGL029
     C                     CALL 'AOGELRR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C********** SDGELR    PARM SDGELR    DSFDY                           S01194              CGL029
     C           SDGELR    PARM SDGELR    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANKS                                   S01194
     C                     SETON                     99                   S01194
     C                     END                                            S01194
1315 C**N99******RECI      COMP 'D'                  9999                 S01194
1316 C   99                SETON                     U7U8LR
1317 C***99*********       MOVELZTABKY    DBKEY                           S01194
     C   99                MOVEL@OPTN     DBKEY            ***************S01194
1318 C   99                Z-ADD2         DBASE            *** DBASE 2 ***
     C   99                MOVEL'SDGELRPD'DBFILE           ***************S01194
1319 C***99*********       MOVE 'TABLE'   DBFILE                          S01194
1320 C   99                GOTO INITEN
1321 C*
1322 C** CHECK ACCRUAL DAY OPTION
1323 C*
1324 C           ACLD      COMP 'Y'                      23
1325 C*
1326 C**************       MOVE '50'      ZTABKY           ACCESS ICDR6   S01194
1327 C***********ZTABKY    CHAINTABLE                99                   S01194
     C**                                                                  S01194
     C** ACCESS CUSTOMER LENDING DATA                                     S01194
     C**                                                                  S01194
     C                     CALL 'AOCLNDR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C********** SDCLND    PARM SDCLND    DSFDY                                        S01194 CLE134
     C           SDCLND    PARM SDCLND    DSSDY                                               CLE134
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     SETON                     99                   S01194
     C                     END                                            S01194
1328 C**N99******RECI      COMP 'D'                  9999                 S01194
1329 C   99                SETON                     U7U8LR
1330 C***99*********       MOVELZTABKY    DBKEY                           S01194
     C   99                MOVEL@OPTN     DBKEY            ***************S01194
1331 C   99                Z-ADD3         DBASE            *** DBASE 3 ***
     C   99                MOVEL'SDCLNDPD'DBFILE           ***************S01194
1332 C***99*********       MOVE 'TABLE'   DBFILE                          S01194
1333 C   99                GOTO INITEN
      *                                                                                     MD035545
      ** Retrieve system value setting.                                                     MD035545
      *                                                                                     MD035545
     C                     MOVELWPARML    P@OP01                                            MD035545
     C                     CALL 'AOSVALR0'                                                  MD035545
     C                     PARM *BLANKS   @RTCD                                             MD035545
     C                     PARM           P@OP01 20                                         MD035545
     C                     PARM           P@VL01200                                         MD035545
     C                     PARM           P@OP02 20                                         MD035545
     C                     PARM           P@VL02200                                         MD035545
     C                     PARM           P@OP03 20                                         MD035545
     C                     PARM           P@VL03200                                         MD035545
     C                     PARM           P@OP04 20                                         MD035545
     C                     PARM           P@VL04200                                         MD035545
     C                     PARM           P@OP05 20                                         MD035545
     C                     PARM           P@VL05200                                         MD035545
     C                     PARM           P@OP06 20                                         MD035545
     C                     PARM           P@VL06200                                         MD035545
     C                     PARM           P@OP07 20                                         MD035545
     C                     PARM           P@VL07200                                         MD035545
     C                     PARM           P@OP08 20                                         MD035545
     C                     PARM           P@VL08200                                         MD035545
     C                     PARM           P@OP09 20                                         MD035545
     C                     PARM           P@VL09200                                         MD035545
     C                     PARM           P@OP10 20                                         MD035545
     C                     PARM           P@VL10200                                         MD035545
      *                                                                                     MD035545
      ** If system value is not found then default value to 'N'.                            MD035545
      *                                                                                     MD035545
     C           @RTCD     IFNE '       '                                                   MD035545
     C                     MOVE 'N'       WCALC6                                            MD035545
     C                     ELSE                                                             MD035545
     C                     MOVELP@VL01    WCALC6                                            MD035545
     C********** WCALC6    IFEQ 'Y'                                                MD035545 MD047993
     C********** BKALDI    ANDEQ'Y'                                                MD035545 MD047993
     C**********           MOVE 'Y'       WCALC6                                   MD035545 MD047993
     C**********           ELSE                                                    MD035545 MD047993
     C**********           MOVE 'N'       WCALC6                                   MD035545 MD047993
     C**********           ENDIF                                                   MD035545 MD047993
     C                     ENDIF                                                            MD035545
     C/COPY WNCPYSRC,LE0460C005
1334 C*
1335 C** CHECK IF BASE RATE CHANGES ARE SUPPORTED
1336 C*
1337 C           BRLF      COMP 'Y'                      17
1338 C*
1339 C** SET UP CURRENCY ARRAYS
1340 C*
1341 C**************       MOVE '  '      ZTABKY                          S01194
1342 C**************       MOVEL'20'      ZTABKY                          S01194
1343 C***********ZTABKY    SETLLTABLED                                    S01194
1344 C                     Z-ADD0         X       30
1345 C*
1346 C           READC     TAG                             ** READC TAG **
1347 C*
1348 C**************       SETOF                     09                   S01194
1349 C**************       READ TABLED                   16               S01194
     C                     READ SDCURRPD                 16               S01194
1350 C*                                                                   S01194
1351 C***16*********                                                      S01194
1352 C*ORN09********       GOTO ENDRDC                                    S01194
1352 C   16                GOTO ENDRDC                                    S01194
1353 C*                                                                   S01194
1354 C***********RECI      COMP 'D'                      70               S01194
1355 C***70******SREC      COMP 1                        70               S01194
1356 C**N70*********       GOTO READC                                     S01194
1357 C*
1358 C** VALID CURRENCY REC. - STORE DETAILS
1359 C*
1360 C           X         ADD  1         X
1361 C*
1362 C**************       MOVE CCY       CURR,X                          S01194
1363 C**************       Z-ADDCDP       CDEP,X                          S01194
1364 C**************       Z-ADDSPOT      CSPT,X                          S01194
1365 C**************       Z-ADDMDIN      MTDV,X                          S01194
1362 C                     MOVELA6CYCD    CURR,X                          S01194
1363 C                     Z-ADDA6NBDP    CDEP,X                          S01194
1364 C                     Z-ADDA6SPRT    CSPT,X                          S01194
1365 C                     MOVELA6MDIN    MTDV,X                          S01194
1366 C*
1367 C** CHECK IF ARRAY IS FULL
1368 C*
1369 C           X         COMP 150                      70
1370 C  N70                GOTO READC
1371 C*
1372 C           ENDRDC    TAG                             ** ENDRDC TAG *
1373 C*
1374 C** SET UP BASE RATE RATE ARRAYS IF BASE RATE CHANGES SUPPORTED
1375 C*
1376 C  N17                GOTO OUTREC
1377 C*
1378 C**************       MOVE BLANKS    ZTABKY                          S01194
1379 C**************       MOVEL'21'      ZTABKY                          S01194
1380 C***********ZTABKY    SETLLTABLED                                    S01194
1381 C                     Z-ADD0         X
1382 C*
1383 C           READB     TAG                             ** READB TAG **
1384 C*
1385 C**************       SETOF                     1016                 S01194
1386 C**************       READ TABLED                   16               S01194
1385 C                     SETOF                       16                 S01194
     C                     READ SDBSRTPD                 16               S01194
1387 C*                                                                   S01194
1388 C***16*********                                                      S01194
1389 C*ORN10********       GOTO ENDRDB                                    S01194
1389 C   16                GOTO ENDRDB                                    S01194
1390 C*                                                                   S01194
1391 C***********RECI      COMP 'D'                      70               S01194
1392 C**N70*********       GOTO READB                                     S01194
1393 C*
1394 C** VALID BASE RATE REC.- CHECK NEW VALUE DATE
1395 C*
1396 C***********VDNR      COMP 0                        70               S01194
1396 C           BAVDNR    COMP 0                        70               S01194
1397 C   70                GOTO READB
1398 C*
1399 C** STORE DETAILS IF ARRAYS NOT FULL
1400 C*
1401 C           X         ADD  1         X
1402 C*******    X         COMP 301                      99               078601
1402 C           X         COMP 601                      99               078601
1403 C   99                SETON                     U7U8LR
1404 C   99                MOVEL'BASE RAT'MSG16  16
1405 C   99                MOVE 'E ARRAY 'MSG16
1406 C   99                MOVE 'FULL'    MSG20  20
1407 C   99                MOVELMSG16     MSG20
1408 C   99                MOVELMSG20     DBKEY
1409 C   99                Z-ADD4         DBASE            *** DBASE 4 ***
1410 C   99                MOVE 'SDBSRTPD'DBFILE                          S01194
1411 C   99                GOTO INITEN
1412 C*
1413 C***********          MOVELCCY       BRCC,X                          S01194
1414 C***********          MOVE BRTT      BRCC,X                          S01194
1415 C***********          Z-ADDNBRT      BASE,X                          S01194
1413 C                     MOVELBACYCD    BRCC,X                          S01194
1414 C                     MOVE BABSRC    BRCC,X                          S01194
1415 C                     Z-ADDBANBRT    BASE,X                          S01194
1416 C*
1417 C                     GOTO READB
1418 C*
1419 C           ENDRDB    TAG                             ** ENDRDB TAG *
1420 C*
1421 C** CHECK IF ANY BASE RATE CHANGES TODAY
1422 C*
1423 C           BRCC,1    COMP '     '              1717
1424 C*
1425 C           OUTREC    TAG                             ** OUTREC TAG *
1426 C*
1427 C** OUTPUT HEADER RECORDS TO FCUPD AND LKEY2
1428 C*
1429 C                     SETON                     40
1430 C                     EXSR EXCPT
1431 C           NFCUPD    ADD  1         NFCUPD  50
1432 C           NLKEY2    ADD  1         NLKEY2  50
1433 C*
     C           LASTD     TAG                                            E30572
     C**                                                                  E30572
1434 C** CHECK IF TODAY IS LAST WORKING DAY OF MONTH
1435 C*
1436 C***********RUNTYP    COMP 'MONTHEND'               18               E30572
1437 C**N18******RUNTYP    COMP 'YEAREND '               18               E30572
     C*                                                                   E30572
     C                     MOVE DNWD      ZDAYNO                          E30572
     C                     EXSR ZDATE2                                    E30572
     C                     MOVE RUNA      WRK5    5                       E30572
     C                     MOVELWRK5      MONTH   3                       E30572
     C           ZMNM,ZMTH COMP MONTH                2727                 E30572
     C**  IF DNWD > EOYD, THEN IT IS THE LAST WORKING DAY OF THE YEAR     E30572
     C           DNWD      COMP EOYD                 28                   E30572
     C   27                MOVE 'MONTHEND'DAYRUN  8                       E30572
     C   28                MOVE 'YEAREND 'DAYRUN                          E30572
1436 C           DAYRUN    COMP 'MONTHEND'               18               E30572
1437 C  N18      DAYRUN    COMP 'YEAREND '               18               E30572
1438 C*                                                                   E30572
0704 C           DAYCLC    TAG                             ** DAYCLC TAG *E30572
1438 C*                                                                   E30572
1438 C*
1439 C** SET UP ZERO FIELDS
1440 C*
1441 C                     Z-ADD0         Z130   130
1442 C                     Z-ADD0         Z50     50
1443 C*
1444 C***SET*UP*HOLIDAY*OPTION*FOR*ZDATE5******                           S01195
1445 C***********                                                         S01195
1446 C***********          MOVE 'Y'       ZOPT                            S01195
1447 C*
1448 C                     SETON                     50    1ST.CYCLE IND.
1449 C*
1450 C           INITEN    ENDSR                           ** INITEN **
1451 C*
1452 C********************************************************************
     C**                                                                  S01195
     C**   SUBROUTINE TO GET SETTLEMENT NOSTRO LOCATION                   S01195
     C**                                                                  S01195
     C**   CALLED FROM FEEPAY                                             S01195
     C**                                                                  S01195
     C           SETLOC    BEGSR                           ***  SETLOC ***S01195
      *                                                                   S01195
      ** INITIALIZE WORKING VARIABLE - SETTLEMENT BRANCH LOCATION         S01195
     C           *LIKE     DEFN NRLC      W@STLL                          S01195
     C                     MOVE *BLANKS   W@STLL                          S01195
      *                                                                   S01195
      ** FOR TYPE 01,02,07,08 OR 12, SETTLEMENT LOCATION IS DETERMINED    S01195
      ** BY THE NOSTRO BRANCH.                                            S01195
     C           SETT      IFEQ 01                         *B1            S01195
     C           SETT      OREQ 02                                        S01195
     C           SETT      OREQ 07                                        S01195
     C           SETT      OREQ 08                                        S01195
     C           SETT      OREQ 12                                        S01195
      *                                                                   S01195
     C                     MOVELOBAC      SNOS    2                       S01195
      *                                                                   S01195
     C                     CALL 'AONOSTR0'                                S01195
     C                     PARM '*MSG   ' @RTCD   7                       S01195
     C                     PARM '*KEY   ' @OPTN   7                       S01195
     C                     PARM *BLANKS   @KEYA   6                       S01195
     C                     PARM FCCY      @KEYB   3                       S01195
     C                     PARM *BLANKS   @KEYC   4                       S01195
     C                     PARM *BLANKS   @KEYD   2                       S01195
     C                     PARM SNOS      @KEYE   2                       S01195
     C                     PARM *BLANKS   BRCD    3                       S01194
     C                     PARM *BLANKS   CSSN   10                       S01194
     C                     PARM *BLANKS   PNOI    1                       S01194
     C           SDNOST    PARM SDNOST    DSFDY                           S01195
      *                                                                   S01195
     C           @RTCD     IFEQ *BLANKS                                   S01195
      **                                                                  S01195
      **   MOVE THE LAST 3 CHARACTERS OF CUSTOMER SHORT CODE (WHICH       S01195
      **   IS THE LOCATION CODE) TO START LOCATION CODE FIELD             S01195
      **                                                                  S01195
     C                     MOVE CSNM      DSCSNM                          S01195
     C                     MOVE NRLC      W@STLL                          S01195
     C                     END                                            S01195
      *                                                                   S01195
     C                     END                             *E1            S01195
      *                                                                   S01195
     C                     ENDSR                                          S01195
      *                                                                   S01195
1453 C********************************************************************
1454 C* SUBROUTINE TO ADD AN AMOUNT (ZZAMT) TO THE TOTAL (ZZTOTI,ZZTOTD)
1455 C*   IND '99' IS SET BY AN OVERFLOW ERROR
1456 C*
1457 C** CALLED BY: MAIN PROCESSING,FEEPAY,PREVF,ACCDAY
1458 C*
1459 C** CALLS:     GLZSUM
1460 C*
1461 CSR         GLZADD    BEGSR                           *** GLZADD ****
1462 C*
1463 CSR                   Z-ADDZZAMT     ZZAMT  153     91-DEFINE ZZAMT
1464 CSR 91                GOTO ZZAEND                     AMT = 0.BYPASS
1465 C*
1466 C* SPLIT ZZAMT INTO INTEGER AND DECIMAL FIELDS
1467 CSR                   Z-ADDZZAMT     ZZAMTI 150       INTEGER FIELD
1468 CSR                   MOVE ZZAMT     ZZAMTD  30       DECIMAL FIELD
1469 C* BOTH ZZAMTI AND ZZAMTD CONTAIN A 'SIGN' ZONE NOW
1470 C*
1471 CSR                   EXSR GLZSUM
1472 CSR         ZZAEND    ENDSR                           ** ZZAEND TAG *
1473 C*
1474 C********************************************************************
1475 C********************************************************************
1476 C* SUBROUTINE TO SUBTRACT AN AMOUNT (ZZAMT) FROM THE TOTAL
1477 C*                                                   (ZZTOTI,ZZTOTD)
1478 C*  IND '99' IS SET BY AN OVERFLOW ERROR
1479 C*
1480 C** CALLED BY: FEEPAY,PREVF,ACCDAY
1481 C*
1482 C** CALLS:     GLZADD
1483 C*
1484 CSR         GLZSUB    BEGSR                           *** GLZSUB ****
1485 C* PROCESSING. JUST REVERSE THE 'SIGN' AND ADD
1486 CSR                   Z-SUBZZAMT     ZZAMT  153       REVERSE 'SIGN'
1487 CSR                   EXSR GLZADD                       AND 'ADD'
1488 CSR                   Z-SUBZZAMT     ZZAMT            RESTORE 'SIGN'
1489 CSR                   ENDSR
1490 C********************************************************************
1491 C********************************************************************
1492 C* SUBROUTINE TO CARRY OUT THE ADDITION FOR SUBROUTINES -
1493 C*                        GLZADD, GLZSUB, GLZCMP.
1494 C*          PARAMETERS PASSED -
1495 C*                     I/P ZZAMTI ZZAMTD
1496 C*                     O/P ZZTOTI ZZTOTD ZZNEGD IND 96 IND 99.
1497 C*
1498 C** CALLED BY: GLZADD
1499 C*
1500 CSR         GLZSUM    BEGSR                           *** GLZSUM ****
1501 C*
1502 CSR                   Z-ADDZZTOTI    ZZTOTI 150       DEFINE ZZTOTI
1503 CSR                   Z-ADDZZTOTD    ZZTOTD  30       DEFINE ZZTOTD
1504 CSR                   SETOF                     919293
1505 CSR                   SETOF                     949599
1506 C*
1507 C*    DETERMINE SIGN OF ZZAMTI & D,   92 IF NEG
1508 CSR         ZZAMTI    COMP 0                      9293
1509 CSR 93      ZZAMTD    COMP 0                      9293
1510 CSR 93                GOTO ZZSEND                     ZERO BYPASS
1511 C*
1512 C*    DETERMINE SIGN OF ZZTOTI & D, 91 IF NEG.
1513 CSR         ZZTOTI    COMP 0                      9193
1514 CSR 93      ZZTOTD    COMP 0                      9193
1515 C*
1516 C*    IF ZZTOTAL IS ZERO, RETURN ZZAMOUNT.
1517 CSR 93                Z-ADDZZAMTI    ZZTOTI
1518 CSR 93                Z-ADDZZAMTD    ZZTOTD
1519 CSR 93                GOTO ZZSEND                     ZERO BYPASS
1520 C*    IF SIGNS DIFFER BYPASS OVERFLOW CHECKS.
1521 CSR 91N92
1522 CORN91 92             GOTO ZZOFPS
1523 C*
1524 CSR         ZZAMTD    ADD  ZZTOTD    ZZWK2   40
1525 CSR         ZZWK2     COMP 999                  93    '93' = CARRY
1526 CSRN93      ZZWK2     COMP -999                   93    INTO INTEGER.
1527 C*
1528 CSR 93N92   ZZAMTI    ADD  1         ZZWK3  150       ADD 'CARRY' +VE
1529 CSR    93 92ZZAMTI    SUB  1         ZZWK3            SUB 'CARRY' -VE
1530 CSR 93      ZZTOTI    ADD  ZZWK3     ZZWK3
1531 CSRN93      ZZTOTI    ADD  ZZAMTI    ZZWK3
1532 C*
1533 C* IF THE MODULUS OF ZZWK3 IS LT MOD. ZZTOTI THEN O/F HAS OCCURED
1534 CSRN92      ZZWK3     COMP ZZTOTI                 99  -92 MEANS NOS.
1535 CSR 92      ZZWK3     COMP ZZTOTI               99     NEGATIVE
1536 CSRN99                Z-ADDZZWK2     ZZTOTD
1537 CSRN99                Z-ADDZZWK3     ZZTOTI
1538 C*
1539 C* IF O/F ZEROIZE ZZAMT , IND '99' SET AND ZZTOT FIELDS LEFT INTACT.
1540 CSR 99                Z-ADD0         ZZAMT  153
1541 CSR                   GOTO ZZSEND
1542 C*
1543 C* THE 'SIGNS' ARE DIFFERENT
1544 CSR         ZZOFPS    TAG                             ** ZZOFPS TAG**
1545 C* IF ZZAMT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZTOT
1546 C*
1547 CSR 92                Z-SUBZZAMTI    ZZAMTI 150
1548 CSR 92                Z-SUBZZAMTD    ZZAMTD  30
1549 C*
1550 C* IF ZZTOT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZAMT.
1551 C*
1552 CSR 91                Z-SUBZZTOTI    ZZTOTI
1553 CSR 91                Z-SUBZZTOTD    ZZTOTD
1554 C* BOTH ZZAMT AND ZZTOT ARE NOW POSITIVE.
1555 C*
1556 CSR         ZZTOTI    COMP ZZAMTI               93  95
1557 CSR 95      ZZTOTD    COMP ZZAMTD               93  95
1558 C*
1559 C* IF ZZTOT EQ. ZZAMT RETURN ZERO.
1560 CSR 95                Z-ADD0         ZZTOTI
1561 CSR 95                Z-ADD0         ZZTOTD
1562 CSR 95                GOTO ZZSEND
1563 C*
1564 C* IF ZZTOT GT. ZZAMT.
1565 CSR 93      ZZAMTD    COMP ZZTOTD               94
1566 CSR 93 94   ZZTOTI    SUB  1         ZZTOTI
1567 CSR 93 94   ZZTOTD    ADD  1000      ZZWK2
1568 CSR 93      ZZTOTI    SUB  ZZAMTI    ZZTOTI
1569 CSR 93 94   ZZWK2     SUB  ZZAMTD    ZZTOTD
1570 CSR 93N94   ZZTOTD    SUB  ZZAMTD    ZZTOTD
1571 C*
1572 C*
1573 C* IF ZZAMT GT. ZZTOT.
1574 CSRN93      ZZTOTD    COMP ZZAMTD               94
1575 CSRN93 94   ZZAMTI    SUB  1         ZZWK3  150
1576 CSRN93 94   ZZAMTD    ADD  1000      ZZWK2
1577 CSRN93 94   ZZWK3     SUB  ZZTOTI    ZZTOTI
1578 CSRN93N94   ZZAMTI    SUB  ZZTOTI    ZZTOTI
1579 CSRN93 94   ZZWK2     SUB  ZZTOTD    ZZTOTD
1580 CSRN93N94   ZZAMTD    SUB  ZZTOTD    ZZTOTD
1581 C*
1582 C* REVERSE SIGN OF ZZTOT IF LARGER I/P FIELDS WERE NEGATIVE
1583 CSR                   SETOF                     94
1584 CSR 93 91
1585 CORN93 92             SETON                     94
1586 CSR 94                Z-SUBZZTOTI    ZZTOTI
1587 CSR 94                Z-SUBZZTOTD    ZZTOTD
1588 C**
1589 C**   RESTORE SIGN OF ZZAMTI & ZZAMTD IF IT WAS REVERSED.
1590 CSR 92                Z-SUBZZAMTI    ZZAMTI
1591 CSR 92                Z-SUBZZAMTD    ZZAMTD
1592 CSR         ZZSEND    TAG                             ** ZZSEND TAG *
1593 C**
1594 C**   IF ZZTOTD IS ZERO, AND ZZTOTI IS NEG. SET UP ZZNEGD.
1595 CSR                   SETOF                     96
1596 CSR         ZZTOTD    COMP 0                        91
1597 CSR 91      ZZTOTI    COMP 0                      96
1598 CSR 96                MOVE '.000-'   ZZNEGD  5
1599 CSR                   ENDSR                             ** ENDSR **
1600 C********************************************************************
1601 C********************************************************************
1602 C**
1603 C**   ZDATE1 SR. TO VALIDATE DATES SUBMITTED AND
1604 C**              CONVERT TO A NUMBER OF DAYS.
1605 C**
1606 C** CALLED BY: ZFREQB
1607 C*
1608 C**   THE YEAR 2000, BEING DIVISIBLE BY 400, IS A LEAP YEAR.
1609 C**
1610 C           ZDATE1    BEGSR                           *** ZDATE1 ***
1611 C**
1612 C**   CLEAR DAY NUMBER.
1613 C                     Z-ADD0         ZDAYNO  50
1614 C**
1615 C**   CALCULATION TO DEFINE INPUT DATE FIELD.
1616 C                     Z-ADDZDATE     ZDATE   60
1617 C**
1618 C**   GET INDIVIDUAL DAY, MONTH AND YEAR FIELDS.
1619 C                     MOVE ZDATE     ZYEAR   20
1620 C  N98                MOVELZDATE     ZDAY    20
1621 C   98                MOVELZDATE     ZMTH    20
1622 C                     MOVE ZDATE     ZWRK4   40
1623 C  N98                MOVELZWRK4     ZMTH
1624 C   98                MOVELZWRK4     ZDAY
1625 C**
1626 C**   ENSURE MONTH IS VALID.
1627 C           ZMTH      COMP 0                      9999
1628 C  N99      ZMTH      COMP 12                   99
1629 C   99                GOTO ZDEND1                     BYPASS IF ERROR
1630 C**
1631 C**   CHECK FOR 30 DAY MONTHS.
1632 C           ZMTH      COMP 4                        90IF 90 ON, 30
1633 C  N90      ZMTH      COMP 6                        90DAY MONTH.
1634 C  N90      ZMTH      COMP 9                        90
1635 C  N90      ZMTH      COMP 11                       90
1636 C**
1637 C**   ENSURE DAY IS VALID.
1638 C           ZDAY      COMP 0                      9999
1639 C   90N99   ZDAY      COMP 30                   99
1640 C  N90N99   ZDAY      COMP 31                   99
1641 C   99                GOTO ZDEND1                     BYPASS IF ERROR
1642 C**
1643 C**   CHECK FOR LEAP YEAR AND FEBRUARY.
1644 C           ZYEAR     ADD  28        ZYEAR
1645 C           ZYEAR     DIV  4         ZLYR    20
1646 C                     MVR            ZLY     10     91LEAP YR, 91 ON
1647 C           ZMTH      COMP 2                    93  92FEB., 92 ON
1648 C**                                                   PAST FEB, 93 ON
1649 C**   IF FEBUARY FURTHER VALIDATE DAY.
1650 C  N91 92   ZDAY      COMP 28                   99
1651 C   91 92   ZDAY      COMP 29                   99
1652 C   99                GOTO ZDEND1                     BYPASS IF ERROR
1653 C**
1654 C**   DETERMINE NUMBER OF DAYS FROM 31/12/1971.     NO.OF 4 YR. SPANS
1655 C           ZLYR      MULT 1461      ZDAYNO           X DAYS IN SPAN.
1656 C  N91      ZDAYNO    ADD  ZYDY,ZLY  ZDAYNO           SINCE LAST L.YR
1657 C   91 93   ZDAYNO    ADD  1         ZDAYNO           L.YR.,PAST FEB.
1658 C           ZDAYNO    ADD  ZMDY,ZMTH ZDAYNO           DAYS THIS YEAR
1659 C           ZDAYNO    ADD  ZDAY      ZDAYNO           DAYS THIS MONTH
1660 C**
1661 C           ZDEND1    ENDSR                           * ZDEND1 ENDSR*
1662 C**
1663 C**
1664 C********************************************************************
1665 C********************************************************************
1666 C**
1667 C**   ZDATE2 SR. TO CONVERT A DAY NUMBER TO DATE FORMATS.
1668 C**
1669 C** CALLED BY: ZFREQB,GLINTC
1670 C*
1671 C**   THE YEAR 2000, BEING DIVISIBLE BY 400, IS A LEAP YEAR.
1672 C**
1673 C           ZDATE2    BEGSR                           *** ZDATE2 ***
1674 C**
1675 C**   CLEAR DATE FIELDS.
1676 C                     Z-ADD0         ZDATE   60
1677 C                     MOVEL'       ' ZADATE  7
1678 C**
1679 C**   CALCULATION TO DEFINE INPUT DAY NUMBER.
1680 C                     Z-ADDZDAYNO    ZDAYNO  50
1681 C**
1682 C**   DETERMINE YEAR NUMBER.
1683 C**
1684 C**   ADJUST DAY NUMBER IN CASE LAST DAY OF YEAR.
1685 C           ZDAYNO    SUB  1         ZDAYN1  50   99
1686 C   99                GOTO ZDEND2
1687 C**
1688 C**   CALCULATE NUMBER OF 4 YEAR SPANS SINCE 31/12/1971.
1689 C           ZDAYN1    DIV  1461      ZLYR    20
1690 C                     MVR            ZDAYN1           SAVE REMAINING
1691 C**                                                   DAYS
1692 C**   CALCULATE NUMBER OF REMAINING YEARS.
1693 C                     Z-ADD1         ZWRK2   20
1694 C           ZDTAG1    TAG                             ** ZDTAG1 TAG *
1695 C           ZDAYN1    COMP ZYDY,ZWRK2             90
1696 C  N90      ZWRK2     ADD  1         ZWRK2
1697 C  N90                GOTO ZDTAG1
1698 C           ZWRK2     SUB  1         ZWRK2          91LEAP YR, 91 ON
1699 C**
1700 C**   DECREMENT DAY NO. BY DAYS IN REMAINING YEARS.
1701 C  N91      ZDAYN1    SUB  ZYDY,ZWRK2ZDAYN1
1702 C**
1703 C**   CALCULATE ACTUAL YEAR NUMBER.
1704 C           ZLYR      MULT 4         ZWRK3   30
1705 C           ZWRK3     ADD  72        ZWRK3            BASE IS 1972
1706 C                     Z-ADDZWRK3     ZYEAR   20
1707 C           ZYEAR     ADD  ZWRK2     ZYEAR            YEAR
1708 C**
1709 C**   DETERMINE MONTH NUMBER.
1710 C**
1711 C**   ADJUST DAY NO. IN CASE LAST DAY OF LEAP YEAR FEBRUARY.
1712 C                     SETOF                     9293
1713 C   91      ZDAYN1    COMP 59                     9293
1714 C   91N92   ZDAYN1    SUB  1         ZDAYN1
1715 C**
1716 C**   CALCULATE MONTH NUMBER.
1717 C                     Z-ADD2         ZWRK2
1718 C           ZDTAG2    TAG                             ** ZDTAG2 TAG *
1719 C           ZDAYN1    COMP ZMDY,ZWRK2             94
1720 C  N94      ZWRK2     ADD  1         ZWRK2
1721 C  N94                GOTO ZDTAG2
1722 C           ZWRK2     SUB  1         ZWRK2
1723 C**
1724 C                     Z-ADDZWRK2     ZMTH    20       MONTH
1725 C**
1726 C**   DETERMINE DAY OF MONTH.
1727 C**
1728 C**   ADD BACK LAST DAY OF YEAR ADJUSTMENT.
1729 C           ZDAYN1    ADD  1         ZDAYN1
1730 C**
1731 C**   CALCULATE DAY OF MONTH.
1732 C           ZDAYN1    SUB  ZMDY,ZWRK2ZDAY    20       DAY
1733 C**
1734 C**   ADD BACK LEAP YEAR 29TH FEBUARY ADJUSTMENT, IF REQUIRED.
1735 C   93      ZDAY      ADD  1         ZDAY
1736 C**
1737 C**   FORMAT DATE, DDMMYY OR MMDDYY.
1738 C  N98                MOVELZDAY      ZWRK4   40
1739 C   98                MOVE ZDAY      ZWRK4
1740 C  N98                MOVE ZMTH      ZWRK4
1741 C   98                MOVELZMTH      ZWRK4
1742 C                     MOVELZWRK4     ZDATE
1743 C                     MOVE ZYEAR     ZDATE
1744 C**
1745 C**   FORMAT ALPHA DATE, DDMMMYY.
1746 C           ZDAY      COMP 10                     95
1747 C                     MOVELZDAY      ZWRK5   5
1748 C   95                MOVEL' '       ZWRK5
1749 C                     MOVE ZMNM,ZMTH ZWRK5
1750 C                     MOVELZWRK5     ZADATE
1751 C                     MOVE ZYEAR     ZADATE
1752 C**
1753 C           ZDEND2    ENDSR                           * ZDEND2 ENDSR*
1754 C**
1755 C**
1756 C********************************************************************
1757 C********************************************************************
1758 C**
1759 C*****ZDATE3*SR.*TO*CALCULATE*ANY*NUMBER*OF*WORKING******************S01195
1760 C****************DAYS*FORWARD*IN*ANY*CURRENCY.***********************S01195
1761 C***********                                                         S01195
1762 C***CALLED*BY:*EXPARR***                                             S01195
1763 C***********                                                         S01195
1764 C*********THIS*SR.*CAN*BE*USED*WHEN*THE*INPUT*CYCLE*IS*RUNNING*AS****S01195
1765 C*********HOLIDAY*RECORDS*ARE*ACCESSED*BY*CHAIN.*THEREFORE*NEWLY*****S01195
1766 C*********ADDED*RECORDS*IN*THE*OVERFLOW*AREA*CAN*ALSO*BE*ACCESSED.***S01195
1767 C***********                                                         S01195
1768 C***********ZDATE3    BEGSR                           *** ZDATE3 *** S01195
1769 C***********                                                         S01195
1770 C*****CALCULATIONS*TO*DEFINE*INPUT*FIELDS.****                       S01195
1771 C***********          Z-ADDZDAYNO    ZDAYNO  50       STARTING DATE  S01195
1772 C***********          MOVE ZCCY      ZCCY    3        DATE CURRENCY  S01195
1773 C***********          Z-ADDZNRDYS    ZNRDYS  20       NBR OF WORKING S01195
1774 C***********                                          DAYS FORWARD   S01195
1775 C*****CLEAR*COUNT*OF*NBR*OF*DAYS*ADDED,*&*DEFINE*ZDYNBR.****         S01195
1776 C***********          Z-ADD0         ZDCNT   20                      S01195
1777 C***********          Z-ADDZDAYNO    ZDYNBR  50                      S01195
1778 C***********                                                         S01195
1779 C*****LOOP*TO*INCREMENT*DAY*NUMBER*AND*CHECK*FOR*HOLIDAY.****        S01195
1780 C***********ZDLOP1    TAG                             ** ZDLOP1 TAG *S01195
1781 C***********                                                         S01195
1782 C***********          SETOF                     9596                 S01195
1783 C***********ZDYNBR    ADD  1         ZDYNBR                          S01195
1784 C***********                                                         S01195
1785 C*****SET*KEY*FOR*FIRST*HOLIDAY*RECORD.****                          S01195
1786 C***********          MOVEL'22    '  ZDHKEY 12                       S01195
1787 C***********          MOVELZDYNBR    ZWRK6   6                       S01195
1788 C***********          MOVE '1'       ZWRK6                           S01195
1789 C***********          MOVE ZWRK6     ZDHKEY                          S01195
1790 C***********                                                         S01195
1791 C*****CHAIN*FOR*HOLIDAY*RECORD,*RECORD*1*OR*2****                    S01195
1792 C***********ZDHCHN    TAG                             ** ZDHCHN TAG *S01195
1793 C***********                                                         S01195
1794 C***********ZDHKEY    CHAINTABLE                90    ON NOT THERE   S01195
1795 C**N90******RECI      COMP 'D'                  9090  DELETED        S01195
1796 C***********                                                         S01195
1797 C*****NO*RECORD*1*FOUND,*IS*NOT*A*HOLIDAY****                        S01195
1798 C***90N95***          GOTO ZDOAGN                                    S01195
1799 C***********                                                         S01195
1800 C*****NO*RECORD*2*FOUND****                                          S01195
1801 C***90*95*96          GOTO ZDLOP1                     EXC. NOT FOUND S01195
1802 C***90*95N96          GOTO ZDOAGN                     INC. NOT FOUND S01195
1803 C***********                                                         S01195
1804 C*****DETERMINE*TYPE*FOUND,*INCLUDE*OR*EXCLUDE****                   S01195
1805 C***********INEX      COMP 'E'                  92  91               S01195
1806 C***********                                                         S01195
1807 C*****CHECK*IF*DAY*IS*HOLIDAY*FOR*CURRENCY.*******                   S01195
1808 C***********ZCCY      LOKUPHCCY                     93               S01195
1809 C***91*93***          GOTO ZDOAGN                     EXCLUDE FOUND  S01195
1810 C***92*93***          GOTO ZDLOP1                     INCLUDE FOUND  S01195
1811 C***********                                                         S01195
1812 C*****IF*EXCLUDE*OR*INCLUDE*NOT*FOUND*CHECK*******                   S01195
1813 C*****FOR*SECOND*HOLIDAY*RECORD,*IF*REQUIRED.*****                   S01195
1814 C***********'   '     LOKUPHCCY                     94ON IF NO RCD.2 S01195
1815 C***********          MOVE ZDHKEY    ZWRK1   1                       S01195
1816 C***********ZWRK1     COMP '1'                      95               S01195
1817 C***91*95***          SETON                     96                   S01195
1818 C***95N94***          MOVE '2'       ZDHKEY                          S01195
1819 C***95N94***          GOTO ZDHCHN                     GET SECOND REC S01195
1820 C***********                                                         S01195
1821 C***91******          GOTO ZDLOP1                     EXC. NOT FOUND S01195
1822 C***92******          GOTO ZDOAGN                     INC. NOT FOUND S01195
1823 C***********                                                         S01195
1824 C*****INCREMENT*COUNT*AND*CHECK*IF*REQUIRED*NUMBER*OF*DAYS****       S01195
1825 C*****HAVE*BEEN*ADDED.*IF*NOT,*GO*THROUGH*LOOP1*AGAIN.********       S01195
1826 C***********ZDOAGN    TAG                             ** ZDOAGN TAG *S01195
1827 C***********                                                         S01195
1828 C***********ZDCNT     ADD  1         ZDCNT                           S01195
1829 C***********ZDCNT     COMP ZNRDYS                 97                 S01195
1830 C***97******          GOTO ZDLOP1                                    S01195
1831 C***********                                                         S01195
1832 C***********          ENDSR                                          S01195
1833 C***********                                                         S01195
1834 C**
1835 C********************************************************************
1836 C********************************************************************
1837 C**
1838 C*****ZDATE5*SR.*TO*DETERMINE*IF*A*DAY*NUMBER*DATE*IS*A*HOLIDAY******S01195
1839 C****************IN*GIVEN*CURRENCY,*AND,*IF*DAY*IS*A*HOLIDAY*********S01195
1840 C****************AND*IF*REQUIRED,*DETERMINE*NEXT*WORKING*DAY.********S01195
1841 C***********                                                         S01195
1842 C***CALLED*BY:*FEEPAY****                                            S01195
1843 C***********                                                         S01195
1844 C***********ZDATE5    BEGSR                           *** ZDATE5 *** S01195
1845 C***********                                                         S01195
1846 C*****CALCULATIONS*TO*DEFINE*INPUT*FIELDS.******                     S01195
1847 C***********          Z-ADDZDAYNO    ZDAYNO  50                      S01195
1848 C***********          MOVE ZCCY      ZCCY    3                       S01195
1849 C***********          MOVE ZOPT      ZOPT    1                       S01195
1850 C***********                                                         S01195
1851 C*****CALCULATIONS*TO*DEFINE/CLEAR*WORKFIELDS.**                     S01195
1852 C***********          MOVE '   '     ZHC                             S01195
1853 C***********                                                         S01195
1854 C*****RESET*INDICATOR.****                                           S01195
1855 C***********          SETOF                     99                   S01195
1856 C***********                                                         S01195
1857 C*****CALCULATION*TO*DEFINE/SET*OUTPUT*FIELD.****                    S01195
1858 C***********          Z-ADDZDAYNO    ZDYNBR  50                      S01195
1859 C***********                                                         S01195
1860 C*****DETERMINE*IF*HOLIDAY****                                       S01195
1861 C***********ZDHOL     TAG                             ** ZDHOL TAG **S01195
1862 C***********          SETOF                     91                   S01195
1863 C***********                                                         S01195
1864 C*****SET*KEY*FOR*FIRST*HOLIDAY*RECORD.****                          S01195
1865 C***********          MOVEL'22      'ZTABKY 12                       S01195
1866 C***********          MOVELZDYNBR    ZWRK6   6                       S01195
1867 C***********          MOVE '1'       ZWRK6                           S01195
1868 C***********          MOVE ZWRK6     ZTABKY                          S01195
1869 C***********                                                         S01195
1870 C*****CHAIN*FOR*HOLIDAY*RECORD,*RECORD*1*OR*2.****                   S01195
1871 C***********ZDHCH5    TAG                             ** ZDHCH5 TAG *S01195
1872 C***********ZTABKY    CHAINTABLE                90    ON NOT THERE   S01195
1873 C**N90******RECI      COMP 'D'                  9090  DELETED        S01195
1874 C***********                                                         S01195
1875 C*****STORE*CURRENCIES*IF*RECORD*FOUND.****                          S01195
1876 C**N90N91***          MOVEAHCCY      ZHC,1                           S01195
1877 C***91N90***          MOVEAHCCY      ZHC,26                          S01195
1878 C***********                                                         S01195
1879 C*****GET*SECOND*RECORD,*IF*NOT*ALREADY*DONE.****                    S01195
1880 C***********          MOVE ZTABKY    ZWRK1N  10                      S01195
1881 C***********ZWRK1N    COMP 1                        91               S01195
1882 C***********          MOVE '2'       ZTABKY                          S01195
1883 C***91N90***          GOTO ZDHCH5                                    S01195
1884 C***********                                                         S01195
1885 C*****BYPASS*TO*END*IF*NO*FIRST*RECORD*FOUND.****                    S01195
1886 C***90*91***          GOTO ZDEND5                                    S01195
1887 C***********                                                         S01195
1888 C*****DETERMINE*HOLIDAY*RECORD*TYPE.****                             S01195
1889 C***********INEX      COMP 'E'                      92               S01195
1890 C***********INEX      COMP 'I'                      93               S01195
1891 C***********                                                         S01195
1892 C*****CHECK*IF*CURRENCY*ON*HOLIDAY.****                              S01195
1893 C***********ZCCY      LOKUPZHC                      94               S01195
1894 C***********                                                         S01195
1895 C*****BYPASS*TO*END*IF*NOT*HOLIDAY*FOR*CURRENCY.****                 S01195
1896 C***92*94***                                                         S01195
1897 C*R*93N94***          GOTO ZDEND5                                    S01195
1898 C***********                                                         S01195
1899 C*****SET*INDICATOR*FOR*HOLIDAY*FOR*DAY*NUMBER.****                  S01195
1900 C***********          SETON                     99                   S01195
1901 C***********                                                         S01195
1902 C***********                                                         S01195
1903 C*****CHECK*IF*NEXT*WORKING*DAY*REQUIRED.****                        S01195
1904 C***********ZOPT      COMP 'Y'                      95               S01195
1905 C***95******ZDYNBR    ADD  1         ZDYNBR                          S01195
1906 C***95******          GOTO ZDHOL                                     S01195
1907 C***********                                                         S01195
1908 C***********                                                         S01195
1909 C***********ZDEND5    ENDSR                           * ZDEND5 ENDSR*S01195
1910 C***********                                                         S01195
1911 C**
1912 C********************************************************************
1913 C********************************************************************
1914 C**
1915 C*****ZFREQB-SR.*TO*INCREMENT*A*DAY*NUMBER*DATE*BY*A*****************S01195
     C**    FREQB-SR. TO INCREMENT A DAY NUMBER DATE BY A                 S01195
1916 C**             PERIOD VALUE DETERMINED BY A CODE.
1917 C**
1918 C** CALLED BY: FEEPAY
1919 C*
1920 C** CALLS:     ZDATE1,ZDATE2
1921 C*
1922 C***********ZFREQB    BEGSR                           *** ZFREQB *** S01195
     C           FREQB     BEGSR                           ***  FREQB  ***S01195
1923 C**
1924 C**   CALCULATIONS TO DEFINE/CLEAR FIELDS.
1925 C                     MOVE ZFREQ     ZFREQ   1
1926 C                     Z-ADDZDAYNO    ZDAYNO  50
1927 C                     Z-ADDZMDAY     ZMDAY   20
1928 C                     MOVE ZCCY      ZCCY    3
1929 C**
1930 C***********          MOVE '   '     ZHC                             S01195
1931 C***********          MOVE ' '       ZTABKY 12                       S01195
1932 C*
1933 C*            FIELDS USED FOR PERIOD CODES M,T,Q,X,Y
1934 C*
1935 C                     MOVE '  '      ZINDE   2
1936 C***********          Z-ADD0         ZINTO   20                      S01195
1937 C**
1938 C**   CONVERT DAY NUMBER TO DATE.
1939 C                     EXSR ZDATE2
1940 C                     SETOF                     90
1941 C**
1942 C**   CHECK FOR AND INCREMENT FOR CODE D-DAILY-WORKING DAY.
1943 C***********ZFREQ     COMP 'D'                      91               S01195
1944 C***91******ZDAYNO    ADD  1         ZDAYNO                          S01195
1945 C***91******          GOTO ZFHCHK                                    S01195
     C           ZFREQ     IFEQ 'D'                                       S01195
     C                     Z-ADD1         ZNRDYS                          S01195
     C                     EXSR ZFWDT                                     S01195
     C                     Z-ADDZDYNBR    ZDAYNO                          S01195
     C                     GOTO ZFEND                                     S01195
     C                     END                                            S01195
1946 C**
1947 C**   CHECK FOR AND INCREMENT FOR CODE W-WEEKLY.
1948 C           ZFREQ     COMP 'W'                      91
1949 C   91      ZDAYNO    ADD  7         ZDAYNO
1950 C   91                GOTO ZFEND
1951 C**
1952 C**   CHECK FOR AND INCREMENT FOR CODE F-FORTNIGHTLY.
1953 C           ZFREQ     COMP 'F'                      91
1954 C   91      ZDAYNO    ADD  14        ZDAYNO
1955 C   91                GOTO ZFEND
1956 C**
1957 C**   CHECK FOR AND INCREMENT FOR CODE S-SEMI-MONTHLY.
1958 C           ZFREQ     COMP 'S'                      91
1959 C   91      ZDAY      COMP 15                   939292
1960 C   91 92             Z-ADD31        ZDAY
1961 C   91 93             Z-ADD15        ZDAY
1962 C   91 93   ZMTH      ADD  1         ZMTH
1963 C   91                GOTO ZFDATE
1964 C**
1965 C**   CHECK FOR AND INCREMENT FOR CODE M-MONTHLY.
1966 C           ZFREQ     COMP 'M'                      91
1967 C   91                MOVE 'IN'      ZINDE
1968 C   91                Z-ADDZMDAY     ZDAY
1969 C   91      ZMTH      ADD  1         ZMTH
1970 C   91                GOTO ZFDATE
1971 C**
1972 C**   CHECK FOR AND INCREMENT FOR CODE R-SIX DAYS BEFORE END OF MONTH
1973 C           ZFREQ     COMP 'R'                      91
1974 C   91                Z-ADD31        ZDAY
1975 C   91      ZMTH      ADD  1         ZMTH
1976 C   91                GOTO ZFDATE
1977 C**
1978 C**   CHECK FOR AND INCREMENT FOR CODE T-BIMONTHLY.
1979 C           ZFREQ     COMP 'T'                      91
1980 C   91                MOVE 'IN'      ZINDE
1981 C   91                Z-ADDZMDAY     ZDAY
1982 C   91      ZMTH      ADD  2         ZMTH
1983 C   91                GOTO ZFDATE
1984 C**
1985 C**   CHECK FOR AND INCREMENT FOR CODE Q-QUARTERLY.
1986 C           ZFREQ     COMP 'Q'                      91
1987 C   91                MOVE 'IN'      ZINDE
1988 C   91                Z-ADDZMDAY     ZDAY
1989 C   91      ZMTH      ADD  3         ZMTH
1990 C   91                GOTO ZFDATE
1991 C**
1992 C**   CHECK FOR AND INCREMENT FOR CODE X-SIX MONTHLY.
1993 C           ZFREQ     COMP 'X'                      91
1994 C   91                MOVE 'IN'      ZINDE
1995 C   91                Z-ADDZMDAY     ZDAY
1996 C   91      ZMTH      ADD  6         ZMTH
1997 C   91                GOTO ZFDATE
1998 C**
1999 C**   CHECK FOR AND INCREMENT FOR CODE Y-YEARLY.
2000 C           ZFREQ     COMP 'Y'                      91
2001 C   91                MOVE 'IN'      ZINDE
1995 C   91                Z-ADDZMDAY     ZDAY
2002 C   91      ZYEAR     ADD  1         ZYEAR
2003 C   91                GOTO ZFDATE
2004 C**
2005 C**   CHECK FOR AND INCREMENT FOR CODE L-LAST CALENDAR DAY OF MONTH.
2006 C           ZFREQ     COMP 'L'                      91
2007 C   91                Z-ADD31        ZDAY
2008 C   91      ZMTH      ADD  1         ZMTH
2009 C   91                GOTO ZFDATE
2010 C**
2011 C**   CHECK FOR AND INCREMENT FOR CODE B-LAST WORKING DAY OF MONTH.
2012 C           ZFREQ     COMP 'B'                      91
2013 C   91                Z-ADD31        ZDAY
2014 C   91      ZMTH      ADD  1         ZMTH
2015 C   91                GOTO ZFDATE
      *                                                                                       CLE064
      **   CHECK FOR AND INCREMENT FOR CODE 4- 4 MONTHLY                                      CLE064
      *                                                                                       CLE064
     C           ZFREQ     COMP '4'                      91                                   CLE064
     C   91                MOVE 'IN'      ZINDE                                               CLE064
     C   91                Z-ADDZMDAY     ZDAY                                                CLE064
     C   91      ZMTH      ADD  4         ZMTH                                                CLE064
     C   91                GOTO ZFDATE                                                        CLE064
      *                                                                                       CLE064
      **   CHECK FOR AND INCREMENT FOR CODE 5- 5 MONTHLY                                      CLE064
      *                                                                                       CLE064
     C           ZFREQ     COMP '5'                      91                                   CLE064
     C   91                MOVE 'IN'      ZINDE                                               CLE064
     C   91                Z-ADDZMDAY     ZDAY                                                CLE064
     C   91      ZMTH      ADD  5         ZMTH                                                CLE064
     C   91                GOTO ZFDATE                                                        CLE064
      *                                                                                       CLE064
      **   CHECK FOR AND INCREMENT FOR CODE 7- 7 MONTHLY                                      CLE064
      *                                                                                       CLE064
     C           ZFREQ     COMP '7'                      91                                   CLE064
     C   91                MOVE 'IN'      ZINDE                                               CLE064
     C   91                Z-ADDZMDAY     ZDAY                                                CLE064
     C   91      ZMTH      ADD  7         ZMTH                                                CLE064
     C   91                GOTO ZFDATE                                                        CLE064
      *                                                                                       CLE064
      **   CHECK FOR AND INCREMENT FOR CODE 8- 8 MONTHLY                                      CLE064
      *                                                                                       CLE064
     C           ZFREQ     COMP '8'                      91                                   CLE064
     C   91                MOVE 'IN'      ZINDE                                               CLE064
     C   91                Z-ADDZMDAY     ZDAY                                                CLE064
     C   91      ZMTH      ADD  8         ZMTH                                                CLE064
     C   91                GOTO ZFDATE                                                        CLE064
      *                                                                                       CLE064
      **   CHECK FOR AND INCREMENT FOR CODE 9- 9 MONTHLY                                      CLE064
      *                                                                                       CLE064
     C           ZFREQ     COMP '9'                      91                                   CLE064
     C   91                MOVE 'IN'      ZINDE                                               CLE064
     C   91                Z-ADDZMDAY     ZDAY                                                CLE064
     C   91      ZMTH      ADD  9         ZMTH                                                CLE064
     C   91                GOTO ZFDATE                                                        CLE064
      *                                                                                       CLE064
      **   CHECK FOR AND INCREMENT FOR CODE V- 10 MONTHLY                                     CLE064
      *                                                                                       CLE064
     C           ZFREQ     COMP 'V'                      91                                   CLE064
     C   91                MOVE 'IN'      ZINDE                                               CLE064
     C   91                Z-ADDZMDAY     ZDAY                                                CLE064
     C   91      ZMTH      ADD  10        ZMTH                                                CLE064
     C   91                GOTO ZFDATE                                                        CLE064
      *                                                                                       CLE064
      **   CHECK FOR AND INCREMENT FOR CODE E- 11 MONTHLY                                     CLE064
      *                                                                                       CLE064
     C           ZFREQ     COMP 'E'                      91                                   CLE064
     C   91                MOVE 'IN'      ZINDE                                               CLE064
     C   91                Z-ADDZMDAY     ZDAY                                                CLE064
     C   91      ZMTH      ADD  11        ZMTH                                                CLE064
     C   91                GOTO ZFDATE                                                        CLE064
      *                                                                                       CLE064
      **   CHECK FOR AND INCREMENT FOR CODE C- TWO YEARLY                                     CLE064
      *                                                                                       CLE064
     C           ZFREQ     COMP 'C'                      91                                   CLE064
     C   91                MOVE 'IN'      ZINDE                                               CLE064
     C   91                Z-ADDZMDAY     ZDAY                                                CLE064
     C   91      ZYEAR     ADD  2         ZYEAR                                               CLE064
     C   91                GOTO ZFDATE                                                        CLE064
      *                                                                                       CLE064
      **   CHECK FOR AND INCREMENT FOR CODE I- THREE YEARLY                                   CLE064
      *                                                                                       CLE064
     C           ZFREQ     COMP 'I'                      91                                   CLE064
     C   91                MOVE 'IN'      ZINDE                                               CLE064
     C   91                Z-ADDZMDAY     ZDAY                                                CLE064
     C   91      ZYEAR     ADD  3         ZYEAR                                               CLE064
     C   91                GOTO ZFDATE                                                        CLE064
      *                                                                                       CLE064
      **   CHECK FOR AND INCREMENT FOR CODE J- FOUR YEARLY                                    CLE064
      *                                                                                       CLE064
     C           ZFREQ     COMP 'J'                      91                                   CLE064
     C   91                MOVE 'IN'      ZINDE                                               CLE064
     C   91                Z-ADDZMDAY     ZDAY                                                CLE064
     C   91      ZYEAR     ADD  4         ZYEAR                                               CLE064
     C   91                GOTO ZFDATE                                                        CLE064
      *                                                                                       CLE064
      **   CHECK FOR AND INCREMENT FOR CODE N- FIVE YEARLY                                    CLE064
      *                                                                                       CLE064
     C           ZFREQ     COMP 'N'                      91                                   CLE064
     C   91                MOVE 'IN'      ZINDE                                               CLE064
     C   91                Z-ADDZMDAY     ZDAY                                                CLE064
     C   91      ZYEAR     ADD  5         ZYEAR                                               CLE064
     C   91                GOTO ZFDATE                                                        CLE064
      *                                                                                       CLE064
      **   CHECK FOR AND INCREMENT FOR CODE U- TEN YEARLY                                     CLE064
      *                                                                                       CLE064
     C           ZFREQ     COMP 'U'                      91                                   CLE064
     C   91                MOVE 'IN'      ZINDE                                               CLE064
     C   91                Z-ADDZMDAY     ZDAY                                                CLE064
     C   91      ZYEAR     ADD  10        ZYEAR                                               CLE064
     C   91                GOTO ZFDATE                                                        CLE064
2016 C**
2017 C**   CHECK FOR AND INCREMENT FOR CODE A-MONTHLY ACCRUAL/PROFIT DATE.
2018 C           ZFREQ     COMP 'A'                      91
2019 C***91*********       MOVEL'01    '  ZTABKY                          S01194
2020 C***91*********       MOVE '    11'  ZTABKY                          S01194
2021 C***91******ZTABKY    CHAINTABLE                99    ON NOT THERE   S01194
2022 C**N99******RECI      COMP '*'                      99               S01194
     C***91*****           CALL 'AOGELRR0'                                S01194              CGL029
     C   91                CALL 'AOGELRR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD                           S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C********** SDGELR    PARM SDGELR    DSFDY                           S01194              CGL029
     C           SDGELR    PARM SDGELR    DSSDY                                               CGL029
     C*                                                                   S01194
     C   91      @RTCD     IFNE *BLANKS                                   S01194
     C                     SETON                     99                   S01194
     C                     END                                            S01194
     C*                                                                   S01194
2023 C   91N99             Z-ADDAPDA      ZDAYNO
2024 C**
2025 C**   BYPASS IF ZFREQ IS 'A' OR ANY OTHER VALUE
2026 C                     GOTO ZFEND
2027 C**
2028 C**
2029 C**   REFORMAT DATE AND ENSURE VALID.
2030 C           ZFDATE    TAG                             ** ZFDATE TAG*
2031 C**
2032 C**   VALIDATE MONTH.
2033 C           ZMTH      COMP 12                   91
2034 C   91      ZMTH      SUB  12        ZMTH
2035 C   91      ZYEAR     ADD  1         ZYEAR
2036 C**
2037 C**   CHECK FOR LEAP YEAR.
2038 C           ZYEAR     DIV  4         ZLYR    20
2039 C                     MVR            ZLY     10     92LEAP YEAR-92 ON
2040 C**
2041 C**   VALIDATE DAY NUMBER.
2042 C                     MOVE ZFMD,ZMTH ZWRK2   20
2043 C           ZMTH      COMP 2                        93
2044 C   92 93             Z-ADD29        ZWRK2
2045 C**
2046 C           ZDAY      COMP ZWRK2                94
2047 C   94                Z-ADDZWRK2     ZDAY
2048 C**
2049 C**   CHECK IF CODE R, TO SUBTRACT 6 DAYS.
2050 C           ZFREQ     COMP 'R'                      91
2051 C   91      ZDAY      SUB  6         ZDAY
2052 C**
2053 C**   REFORMAT DATE, DDMMYY OR MMDDYY, AND CONVERT TO DAY NUMBER.
     C           *LIKE     DEFN ZMTH      W@ZMTH                          S01195
     C                     MOVE ZMTH      W@ZMTH                          S01195
     C           *LIKE     DEFN ZYEAR     W@ZYR                           S01195
     C                     MOVE ZYEAR     W@ZYR                           S01195
2054 C                     MOVELZDAY      ZWRK4   40
2055 C                     MOVE ZMTH      ZWRK4
2056 C   98                MOVELZMTH      ZWRK4
2057 C   98                MOVE ZDAY      ZWRK4
2058 C                     MOVELZWRK4     ZDATE
2059 C                     MOVE ZYEAR     ZDATE
2060 C                     EXSR ZDATE1
     C           *LIKE     DEFN ZDAYNO    W@ZDAY                          S01195
     C                     Z-ADDZDAYNO    W@ZDAY                          S01195
2061 C**
2062 C**   CHECK IF CODE B, OR M,T,Q,X,Y TO BE CHECKED FOR HOLIDAY.
2063 C           ZFREQ     COMP 'B'                      91
2064 C           ZINDE     COMP 'IN'                     92
2065 C   92N99
2066 COR 91N99             GOTO ZFHCHK
2067 C**
2068 C                     GOTO ZFEND
2069 C**
2070 C**   CHECK IF DAY NUMBER IS A HOLIDAY.
2071 C**
2072 C           ZFHCHK    TAG                             ** ZFHCHK TAG *
      *                                                                   S01195
     C           ZFREQ     IFNE 'B'                        *B1            S01195
     C                     Z-ADD0         ZNRDYS                          S01195
     C                     EXSR ZFWDT                                     S01195
     C                     Z-ADDZDYNBR    ZDAYNO                          S01195
     C                     EXSR ZDATE2                                    S01195
     C                     END                             *E1            S01195
      **                                                                  S01195
      **   IF FREQUENCY CODE IS 'B', OR THE INCREMENATION TAKES THE       S01195
      **   DATE TO THE FOLLOWING MONTH, BACK TO FIND THE NON-HOLIDAY      S01195
      **   BEFORE THE SPECIFIED DAY NO.                                   S01195
      **                                                                  S01195
     C           ZFREQ     IFEQ 'B'                        *B1            S01195
     C           ZMTH      ORNE W@ZMTH                                    S01195
     C           ZYEAR     ORNE W@ZYR                                     S01195
     C                     Z-ADDW@ZDAY    ZDAYNO                          S01195
     C                     Z-ADD0         ZNRDYS                          S01195
     C                     EXSR ZBKDT                                     S01195
     C                     Z-ADDZDYNBR    ZDAYNO                          S01195
     C                     END                             *E1            S01195
      *                                                                   S01195
2073 C***********          SETOF                     94                   S01195
2074 C***********ZFREQ     COMP 'D'                      91               S01195
2075 C***********ZFREQ     COMP 'B'                      92               S01195
2076 C***91******                                                         S01195
2077 C*R*92******          GOTO ZSETK                                     S01195
2078 C***********                                                         S01195
2079 C****FOR*CODES*M,T,Q,X,Y,*CHECK*ZINDE*-*'IN'*TO*INCREMENT,****       S01195
2080 C*************************************-*'DE'*TO*DECREMENT*****       S01195
2081 C***********                                                         S01195
2082 C***********ZINDE     COMP 'IN'                     90               S01195
2083 C***********ZINDE     COMP 'IN'                     91               S01195
2084 C***********ZINDE     COMP 'DE'                     92               S01195
2085 C***********                                                         S01195
2086 C*****SET*KEY*FOR*FIRST*HOLIDAY*RECORD.****                          S01195
2087 C***********ZSETK     TAG                             ** ZSETK TAG **S01195
2088 C***********          MOVEL'22    '  ZTABKY                          S01195
2089 C***********          MOVELZDAYNO    ZWRK6   6                       S01195
2090 C***********          MOVE 1         ZWRK6                           S01195
2091 C***********          MOVE ZWRK6     ZTABKY                          S01195
2092 C***********                                                         S01195
2093 C*****GET*HOLIDAY*RECORD.****                                        S01195
2094 C***********ZFHCHN    TAG                             ** ZFHCHN TAG* S01195
2095 C***********ZTABKY    CHAINTABLE                93    ON NOT THERE   S01195
2096 C**N93******RECI      COMP '*'                      93               S01195
     C**N94******          MOVE '   '     ZHC                             S01195
2097 C***********                                                         S01195
2098 C*****STORE*CURRENCIES*IF*RECORD*FOUND.****                          S01195
2099 C**N94N93***          MOVEAHCCY      ZHC,1                           S01195
2100 C***94N93***          MOVEAHCCY      ZHC,26                          S01195
2101 C***********                                                         S01195
2102 C*****GET*SECOND*RECORD,*IF*NOT*ALREADY*DONE.****                    S01195
2103 C***********          MOVE ZTABKY    ZWRK1N  10                      S01195
2104 C***********ZWRK1N    COMP 1                        94               S01195
2105 C***********          MOVE '2'       ZTABKY                          S01195
2106 C***94N93***          GOTO ZFHCHN                                    S01195
2107 C***********                                                         S01195
2108 C*****BYPASS*TO*END*IF*NO*FIRST*RECORD*FOUND.****                    S01195
2109 C***93*94***          GOTO ZFEND                                     S01195
2110 C***********                                                         S01195
2111 C*****DETERMINE*HOLIDAY*RECORD*TYPE.****                             S01195
2112 C***********INEX      COMP 'E'                      95               S01195
2113 C***********INEX      COMP 'I'                      96               S01195
2114 C***********                                                         S01195
2115 C*****CHECK*IF*CURRENCY*ON*HOLIDAY.****                              S01195
2116 C***********ZCCY      LOKUPZHC                      97               S01195
2117 C***********                                                         S01195
2118 C*****BYPASS*IF*NOT*HOLIDAY*FOR*CURRENCY.****                        S01195
2119 C***95*97***                                          EXCLUDE FOUND  S01195
2120 C*R*96N97***          GOTO ZFEND                      INCL. NOT FOUNDS01195
2121 C***********                                                         S01195
2122 C***********                                                         S01195
2123 C***92******          GOTO ZDECR                                     S01195
2124 C***********                                                         S01195
2125 C*****INCREMENT*OR*DECREMENT*DAY*NUMBER*AS*REQUIRED.****             S01195
2126 C***91******ZDAYNO    ADD  1         ZDAYNO                          S01195
2127 C***********                                                         S01195
2128 C*****ONLY*FOR*PERIOD*CODE*=*M,T,Q,X*OR*Y,*IF*INCREMENTATION******   S01195
2129 C*****TAKES*THE*OUTPUT*DATE*INTO*THE*FOLLOWING*MONTH,*RETURN*TO***   S01195
2130 C*****THE*INPUT*DATE*AND*DECREMENT*-*92*ON.***********************   S01195
2131 C***********                                                         S01195
2132 C***90*91***ZINTO     ADD  1         ZINTO                           S01195
2133 C***90*91***ZINTO     ADD  ZDAY      ZINTOT  20                      S01195
2134 C***90*91***          MOVE ZINTOT    ZINTOA  2                       S01195
     C**TO*ALLOW*29*FEB*ON*LEAP*YEARS*TO*PASS****                         S01195
     C***********          SETOF                     93                   S01195
     C***90*91***ZYEAR     DIV  4         ZLYR                            S01195
     C***90*91***          MVR            ZLY            92               S01195
     C***90*91*92ZMTH      COMP 2                        93               S01195
     C***93******ZINTOA    COMP '29'                 92                   S01195
     C***90*91N93ZINTOA    COMP ZFMD,ZMTH            92                   S01195
2136 C***90*91*92ZDAYNO    SUB  ZINTO     ZDAYNO                          S01195
2137 C***90*91*92          MOVE 'DE'      ZINDE                           S01195
2138 C***********                                                         S01195
2139 C***********ZDECR     TAG                             ** ZDECR TAG **S01195
2140 C***92*95N97                                          EXCL. NOT FOUNDS01195
2141 C*R*92*96*97ZDAYNO    SUB  1         ZDAYNO           INCLUDE FOUND  S01195
2142 C***********          GOTO ZFHCHK                                    S01195
2143 C**
2144 C**
2145 C***********ZFEND     ENDSR                           * ZFEND ENDSR *E26952
     C**                                                                  E26952
     C           ZFEND     TAG                                            E26952
     C**                                                                  E26952
     C**  IF CALCULATED NEXT COMMITMENT FEES DUE DATE IS LATER THAN       E26952
     C**  COMMITMENT FEES END DATE, THEN USE COMM FEES END DATE INSTEAD   E26952
     C**                                                                  E26952
     C           ZDAYNO    IFGT EDDT                                      E26952
     C                     Z-ADDEDDT      ZDAYNO                          E26952
     C                     END                                            E26952
     C**                                                                  E26952
     C                     ENDSR                                          E26952
2146 C**
2147 C********************************************************************
     C/EJECT                                                              S01195
     C********************************************************************S01195
     C*                                                                   S01195
     C* ZACCH  --- SUBROUTINE TO ACCESS A HOLIDAY RECORD FOR A            S01195
     C*            PARTICULAR CURRENCY AND (OPTIONAL) LOCATION.           S01195
     C*                                                                   S01195
     C* CALLED FROM: ZFWDT, ZBKDT                                         S01195
     C*                                                                   S01195
     C* CALLS: NOTHING                                                    S01195
     C*                                                                   S01195
     C********************************************************************S01195
     C/COPY ZSRSRC,ZACCH                                                  S01195
     C/EJECT                                                              S01195
     C********************************************************************S01195
     C*                                                                   S01195
     C* ZFWDT  --- SUBROUTINE TO CALCULATE THE NTH WORKING DAY            S01195
     C*            FORWARD FROM A GIVEN START DATE FOR ANY                S01195
     C*            PARTICULAR CURRENCY AND (OPTIONAL) LOCATION.           S01195
     C*                                                                   S01195
     C* CALLED FROM: MAIN,FREQB,INTRST,REPAY                              S01195
     C*                                                                   S01195
     C* CALLS: ZACCH                                                      S01195
     C*                                                                   S01195
     C********************************************************************S01195
     C/COPY ZSRSRC,ZFWDT                                                  S01195
     C/EJECT                                                              S01195
     C********************************************************************S01195
     C*                                                                   S01195
     C* ZBKDT  --- SUBROUTINE TO CALCULATE THE NTH WORKING DAY            S01195
     C*            BACKWARD FROM A GIVEN START DATE FOR ANY               S01195
     C*            PARTICULAR CURRENCY AND (OPTIONAL) LOCATION.           S01195
     C*                                                                   S01195
     C* CALLED FROM: FREQB                                                S01195
     C*                                                                   S01195
     C* CALLS: ZACCH                                                      S01195
     C*                                                                   S01195
     C********************************************************************S01195
     C/COPY ZSRSRC,ZBKDT                                                  S01195
     C/EJECT                                                              S01195
2148 C********************************************************************066550
2149 C***********                                                         066550
2150 C*****GLINTC SR. TO CALCULATE INTEREST BETWEEN ANY TWO DAY NUMBERS.  066550
2151 C***********                                                         066550
2152 C***CALLED*BY:  FEECLC                                               066550
2153 C***********                                                         066550
2154 C***CALLS:**    ZSAVE,ZDATE2,ZRSTOR                                  066550
2155 C***********                                                         066550
2156 C*****THIS*VERSION REPLACES THE ORIGINAL GLINTC SR. NOW NAMED        066550
2157 C*****GLINTO.                                                        066550
2158 C***********                                                         066550
2159 C*****CALCULATION METHODS ARE -                                      066550
2160 C*****1**ACTUAL/365                                                  066550
2161 C*****2**ACTUAL/360                                                  066550
2162 C*****3**360/360 (SOMETIMES CALLED 30/360)                           066550
2163 C*****4**365/365 (EXCLUDING 29/02)                                   066550
2164 C*****5**365/360 (EXCLUDING 29/02)                                   066550
2165 C*****6**ACTUAL/366                                                  066550
2166 C***********                                                         066550
2167 C*****REQUIRES SUBRS. - ZDATE2, ZSAVE, & ZRSTOR.                     066550
2168 C***********                                                         066550
2169 C***********                                                         066550
2170 C*R*********GLINTC    BEGSR                           ** GLINTC  **  066550
2171 C***********                                                         066550
2172 C*****CALCULATIONS TO DEFINE INPUT FIELDS.                           066550
2173 C*R*********          Z-ADDZIBEG     ZIBEG   50       STARTING DATE  066550
2174 C*R*********          Z-ADDZIEND     ZIEND   50       FINISHING DATE 066550
2175 C*R*********          Z-ADDZICALC    ZICALC  10       CALC. BASIS    066550
2176 C*R*********          Z-ADDZIAMT     ZIAMT  150       PRINCIPAL      066550
2177 C*R*********          Z-ADDZIRATE    ZIRATE 117       RATE OF INTRST 066550
2178 C***********                                                         066550
2179 C****TO*DETERMINE NUMBER OF DAYS INTEREST TO BE CALCULATED           066550
2180 C*R*********ZIEND     SUB  ZIBEG     ZDAYN1  50                      066550
2181 C***********                                                         066550
2182 C****CHECK*FOR INTEREST CALCULATION BASIS                            066550
2183 C*****USE*OF INDICATRS                                               066550
2184 C*****1,92**2,90  3,91  4,97  5,96  6,95                             066550
2185 C***********          SETOF                     959697               066550
2186 C*R*********ZICALC    COMP 2                    919290               066550
2187 C**N91******          GOTO ZICAL                                     066550
2188 C***********ZICALC    COMP 5                    959796               066550
2189 C***97******ZICALC    COMP 3                    97  91               066550
2190 C***95******                                                         066550
2191 C*R*96******          SETOF                     91                   066550
2192 C**N91******          GOTO ZILPCK                                    066550
2193 C***********                                                         066550
2194 C*****THIS*CODING WILL CALCULATE THE NUMBER OF DAYS TO USE WHEN      066550
2195 C*****USING*THE 30/360 BASIS - METHOD 3.                             066550
2196 C***********          EXSR ZSAVE                                     066550
2197 C***********          Z-ADDZIBEG     ZDAYNO                          066550
2198 C***********          EXSR ZDATE2                                    066550
2199 C***********          MOVE ZDAY      ZISD    20                      066550
2200 C***********          MOVE ZMTH      ZISM    20                      066550
2201 C***********          MOVE ZYEAR     ZISY    20                      066550
2202 C***********          Z-ADDZIEND     ZDAYNO                          066550
2203 C***********          EXSR ZDATE2                                    066550
2204 C***********          MOVE ZDAY      ZIFD    20                      066550
2205 C***********          MOVE ZMTH      ZIFM    20                      066550
2206 C***********          MOVE ZYEAR     ZIFY    20                      066550
2207 C***********          EXSR ZRSTOR                                    066550
2208 C***********          SETOF                     93                   066550
     C****IN*ORDER FOR THE FINISH YEAR TO BE LESS THAN THE START YEAR IF  066550
     C****ZIEND*IS GREATER THAN ZIBEG,THEN THE DATE ZIEND MUST BE IN A    066550
     C****DIFFERENT CENTURY TO ZIBEG.IF SO ADD 100 YEARS TO IT.           066550
     C***********ZIEND     COMP ZIBEG                93                   066550
     C***93******ZIFY      COMP ZISY                   93                 066550
     C***********          Z-ADDZISY      ZISY2   30                      066550
     C**N93******          Z-ADDZIFY      ZIFY2   30                      066550
     C***93******ZIFY      ADD  100       ZIFY2                           066550
     C***********                                                         066550
     C*****DETERMINE*WHETHER*START*YEAR*IS*A*LEAP*YEAR*AND*IF*START*******S01147
     C*****MONTH*IS*FEBRUARY.***************************************S01147066550
     C***********                                                   S01147066550
     C**N98******          BITOF'0'       ZGLBIT  1           E80945S01147066550
     C***98******          BITON'0'       ZGLBIT              E80945S01147066550
     C***********ZISY2     ADD  1900      ZLYCHK  40                S01147066550
     C***********ZLYCHK    DIV  4         ZLYCHK                    S01147066550
     C***********          MVR            ZLYREM  20                S01147066550
     C***********ZLYREM    COMP *ZERO                    98*LEAP YEAS01147066550
     C***********ZISM      COMP 2                        99*FEBRUAR S01147066550
2209 C**N99******30        SUB  ZISD      ZID1    50   93           S01147066550
2210 C**N99*93***          Z-ADD0         ZID1                      S01147066550
     C***99N98***28        SUB  ZISD      ZID1                      S01147066550
     C***99*98***29        SUB  ZISD      ZID1                      S01147066550
2209 C***********30        SUB  ZISD      ZID1    50   93           S01147066550
2210 C***93******          Z-ADD0         ZID1                      S01147066550
2211 C***********ZISM      COMP 12                       93               066550
2212 C***93******          Z-ADD0         ZISM                            066550
2213 C***93******ZISY      ADD  1         ZISY                            066550
     C***93******ZISY2     ADD  1         ZISY2                           066550
     C***********                                                         066550
     C*****DETERMINE*WHETHER*END*YEAR*IS*A*LEAP*YEAR*AND*IF*END*MON*S01147066550
     C*****IS*FEBRUARY.*********************************************S01147066550
     C***********                                                   S01147066550
     C***********ZIFY2     ADD  1900      ZLYCHK  40                S01147066550
     C***********ZLYCHK    DIV  4         ZLYCHK                    S01147066550
     C***********          MVR            ZLYREM  20                S01147066550
     C***********ZLYREM    COMP *ZERO                    98*LEAP YE S01147066550
     C***********ZIFM      COMP 2                        99*FEBRUAR S01147066550
2214 C**N99******ZIFD      COMP 31                       93         S01147066550
2214 C***99N98***ZIFD      COMP 28                       93         S01147066550
2214 C***99*98***ZIFD      COMP 29                       93         S01147066550
     C***********          SETOF                     98       E80945S01147066550
     C***********          TESTB'0'       ZGLBIT         98   E80945S01147066550
2214 C***********ZIFD      COMP 31                       93         S01147066550
2215 C***93******ZID1      ADD  30        ZID1                            066550
2216 C**N93******ZID1      ADD  ZIFD      ZID1                            066550
2217 C***********ZIFM      SUB  1         ZIFM                            066550
     C***********ZISY      COMP ZIFY                     93               066550
2219 C***93******ZIFM      SUB  ZISM      ZINOM   30                      066550
2220 C***93******          GOTO ZIOUT                                     066550
2221 C***********12        SUB  ZISM      ZIM1    20                      066550
2222 C***********          Z-ADD1         ZISM                            066550
     C*****USE*ENLARGED FIELDS THAT CAN HANDLE 1999 ONWARDS               066550
     C***********ZISY2     ADD  1         ZISY2                           066550
     C***********ZIFY2     SUB  ZISY2     ZIY1    20                      066550
2225 C***********ZIY1      MULT 12        ZIM2    30                      066550
2226 C***********ZIM2      ADD  ZIFM      ZIM2                            066550
2227 C***********ZIM1      ADD  ZIM2      ZINOM                           066550
2228 C***********ZIOUT     TAG                             * ZIOUT TAG *  066550
2229 C***********ZINOM     MULT 30        ZID2    50                      066550
2230 C***********ZID2      ADD  ZID1      ZDAYN1                          066550
2231 C***********          SETOF                     93                   066550
2232 C***********ZILPCK    TAG                             * ZILPCK TAG * 066550
2233 C**N96N97***          GOTO ZICAL                                     066550
2234 C*****THE*FOLLOWING CODING APPLIES FOR METHODS 4 AND 5 ONLY.         066550
2235 C*****1*DAY*IS SUBTRACTED FROM ZDAYN1 FOR EACH OCCURANCE OF 29 FEB   066550
2236 C*****IN*THE INTEREST CALCULATION PERIOD INCLUSIVE OF ZIBEG, & ZIEND.066550
2237 C***********                                                         066550
2238 C*****FIND*NO OF 4 YEAR PERIODS BETWEEN DATES                        066550
2239 C***********ZDAYN1    DIV  1461      ZIMAN   20                      066550
2240 C***********          MVR            ZIREM   50                      066550
2241 C*****FIND*NEXT 29 FEB DAY NO. ON OR AFTER ZIBEG.                    066550
2242 C***********ZIBEG     SUB  60        ZIBW1   50                      066550
2243 C***********ZIBW1     DIV  1461      ZIDW1   20                      066550
2244 C***********          MVR            ZIDREM  50                      066550
2245 C***********ZIDREM    COMP 0                        94               066550
2246 C***94******          Z-ADDZIBEG     ZIDW2   50                      066550
2247 C***94******          GOTO ZILP1                                     066550
2248 C*****ROUND*UP RESULT                                                066550
2249 C***********ZIDW1     ADD  1         ZIDW2                           066550
2250 C*****CALCULATE NEXT 29 FEB.                                         066550
2251 C***********ZIDW2     MULT 1461      ZIDW2                           066550
2252 C***********ZIDW2     ADD  60        ZIDW2                           066550
2253 C***********ZILP1     TAG                             * ZILP1 TAG *  066550
2254 C*****IF*THIS NEXT 29 FEB. DAYNO - ZIBEG IS GR. TH. OR EQ. TO        066550
2255 C*****ZIREM*THEN ADD 1 TO ZIMAN.                                     066550
2256 C***********ZIDW2     SUB  ZIBEG     ZILPCP  50                      066550
2257 C***********ZIREM     COMP ZILPCP               94  94               066550
2258 C***94******ZIMAN     ADD  1         ZIMAN                           066550
2259 C*****SUBTRACT ZIMAN FROM ZDAYN1 TO GIVE VALUE OF ZDAYN1             066550
2260 C*****REQUIRED FOR THIS INTEREST CALCULATION.                        066550
2261 C***********ZDAYN1    SUB  ZIMAN     ZDAYN1                          066550
2262 C***********          SETOF                     94                   066550
2263 C***********ZICAL     TAG                             * ZICAL TAG *  066550
2264 C***********                                                         066550
2265 C****CALCULATE INTEREST                                              066550
2266 C***90******                                                         066550
2267 C*R*91******                                                         066550
2268 C*R*96******ZIAMT     DIV  36000     ZIWRK1 155H                     066550
2269 C***92******                                                         066550
2270 C*R*97******ZIAMT     DIV  36500     ZIWRK1    H                     066550
2271 C***95******ZIAMT     DIV  36600     ZIWRK1    H                     066550
2272 C*R*********ZIWRK1    MULT ZIRATE    ZIWRK2 155H                     066550
2273 C*R*********ZIWRK2    MULT ZDAYN1    ZINTR  152H      AMT. OF INTRST 066550
2274 C***********                                                         066550
2275 C***********          SETOF                     909192               066550
2276 C***********          SETOF                     959697               066550
2277 C*R*********          ENDSR                                          066550
2278 C***********                                                         066550
2279 C********************************************************************066550
2280 C********************************************************************
2281 C**
2282 C**   ZSAVE SR. TO MEMORISE THE SETTINGS AND TO SET OFF INDICATORS
2283 C**              90 - 97 BEFORE EXECUTION OF A Z-SUBROUTINE.
2284 C**
2285 C**   THIS SR. IS REQUIRED ONLY IF INDICATORS
2286 C**   90 - 97 ARE USED ELSEWHERE IN A PROGRAM.
2287 C**
2288 C** CALLED BY: GLINTC
2289 C*
2290 C           ZSAVE     BEGSR                           *** ZSAVE ***
2291 C**
2292 C                     BITOF'01234567'ZBITS   1
2293 C   90                BITON'0'       ZBITS
2294 C   91                BITON'1'       ZBITS
2295 C   92                BITON'2'       ZBITS
2296 C   93                BITON'3'       ZBITS
2297 C   94                BITON'4'       ZBITS
2298 C   95                BITON'5'       ZBITS
2299 C   96                BITON'6'       ZBITS
2300 C   97                BITON'7'       ZBITS
2301 C**
2302 C                     SETOF                     909192
2303 C                     SETOF                     939495
2304 C                     SETOF                     9697
2305 C**
2306 C                     ENDSR
2307 C**
2308 C**
2309 C********************************************************************
2310 C********************************************************************
2311 C**
2312 C**   ZRSTOR SR. TO RESTORE INDICATORS 90 - 97 TO THE SETTINGS
2313 C**              THEY HAD BEFORE THE EXECUTION OF SR. ZSAVE.
2314 C**
2315 C** CALLED BY: GLINTC
2316 C*
2317 C           ZRSTOR    BEGSR                           *** ZRSTOR ***
2318 C**
2319 C                     TESTB'0'       ZBITS          90
2320 C                     TESTB'1'       ZBITS          91
2321 C                     TESTB'2'       ZBITS          92
2322 C                     TESTB'3'       ZBITS          93
2323 C                     TESTB'4'       ZBITS          94
2324 C                     TESTB'5'       ZBITS          95
2325 C                     TESTB'6'       ZBITS          96
2326 C                     TESTB'7'       ZBITS          97
2327 C**
2328 C                     ENDSR
2329 C**
2330 C**
2331 C********************************************************************
2332 C********************************************************************
2333 C**
2334 C**   ZSYSTM SR. TO CHAIN TO THE INSTALLATION CONTROL DATA RECORD.
2335 C**
2336 C** CALLED BY: INIT
2337 C*
2338 C           ZSYSTM    BEGSR                           *** ZSYSTM ***
2339 C**************                                                      S01194
2340 C*****SET*UP*KEY FOR INSTALLATION CONTROL RECORD.                    S01194
2341 C**************       MOVEL'01      'ZTABKY 12                       S01194
2342 C**************       MOVE '  10'    ZTABKY                          S01194
2343 C**************                                                      S01194
2344 C***********ZTABKY    CHAINTABLE                99    ON NOT THERE   S01194
2345 C**N99******RECI      COMP 'D'                  9999  ON, IS DELETED S01194
     C**                                                                  S01194
     C**   ACCESS BANK DETAILS                                            S01194
     C**                                                                  S01194
     C                     CALL 'AOBANKR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDBANK    PARM SDBANK    DSFDY                           S01194
     C*                                                                   S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     SETON                     U7U8LR               S01194
     C                     SETON                     99                   S01194
     C                     MOVEL'SDBANKPD'DBFILE           ***************S01194
     C                     MOVEL@OPTN     DBKEY            * DBERROR 001 *S01194
     C                     Z-ADD1         DBASE            ***************S01194
     C                     ELSE                                           S01194
2346 C**
2347 C**   CHECK SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.
2348 C           BJDFIN    COMP 'M'                      98MMDDYY, 98 ON
2349 C**
     C                     END                                            S01194
2350 C                     ENDSR
2351 C**
2352 C**
2353 C********************************************************************
     C*                                                                   S01117
     C* SUBROUTINE : #ZZ                                                  S01117
     C*                                                                   S01117
     C* CALLED BY MAIN PROCESSING DURING TOTAL TIME CALCULATIONS IF       S01117
     C* THE P1 FILES HAVE NOT ALREADY BEEN OPENED (IE, IF THERE ARE       S01117
     C* NO RECORDS READ AND THEREFORE FILES OPENING NOT PERFORMED)        S01117
     C*                                                                   S01117
     C           #ZZ       BEGSR                                          S01117
      *                                                                   S01117
      ** OPEN P1 SPOOL FILE                                               S01117
     C                     OPEN LE0460P1                                  S01117
     C                     SETON                     60                   S01117
      *                                                                   S01117
      ** ENSURE REPORT SPOOL FILE RECORDED BY RCF                         S01117
     C                     Z-ADDSFNUM     ZSNUM                           S01117
     C                     OUT  LDA                                       S01117
      *                                                                   S01117
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           SEQ                             S01117
     C                     PARM *BLANKS   SENTY   3                       S01117
     C                     PARM           SFILE                           S01117
     C                     PARM           ZSNUM   60                      S01117
     C                     PARM           ZSERR   1                       S01117
      *                                                                   S01117
     C           *LOCK     IN   LDA                                       S01117
     C           ZSERR     IFEQ 'Y'                                       S01117
      ** ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM        S01117
     C                     SETON                     U7U8                 S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
      *                                                                   S01117
     C           #ZZ9      TAG                                            S01117
      *                                                                   S01117
      ** EXCEPT THE HEADING OF THE P1 SPOOL                               S01117
     C                     EXCPTP1HEAD                                    S01117
      *                                                                   S01117
     C                     ENDSR                                          S01117
      *                                                                   S01117
     C********************************************************************S01117
     C*                                                                   S01117
     C* *PSSR  --- SUBROUTINE TO HANDLE ABNORMAL ERROR CONDITIONS         S01117
     C*                                                                   S01117
     C* CALLED FROM: AFTER ABNORNAL OPERATION OCCURS                      S01117
     C*                                                                   S01117
     C* CALLS: NOTHING                                                    S01117
     C*                                                                   S01117
     C********************************************************************S01117
     C*                                                                   S01117
     C           *PSSR     BEGSR                           ** *PSSR **    S01117
     C*                                                                   S01117
     C           @RUN      IFEQ *BLANKS                                   S01117
     C                     MOVE 'Y'       @RUN    1                       S01117
     C                     DUMP                                           S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C                     ENDSR                           ** *PSSR **    S01117
     C********************************************************************S01117
      /EJECT                                                              066550
     C/COPY ZSRSRC,ZINTDYZ2                                               066550
      /EJECT                                                              066550
     C/COPY ZSRSRC,ZDATE9Z3                                               066550
      /EJECT                                                              066550
     C/COPY ZSRSRC,GLINTCZ1                                               066550
      /EJECT                                                              066550
     C/COPY ZSRSRC,ZDAT10Z2                                               126017
     C/EJECT                                                              126017
2354 O*
2355 O** NEW FACILITY FILE
2356 O*
2357 O** OUTPUT HEADER
2358 O*
2359 O*****FCUPDHH E        40                                            S01117
2359 OFCUPDHH T        LRNU7                                              S01117
2360 O                                    1 'H'
2361 O*
2362 O** OUTPUT DETAIL RECORD 'A'
2363 O*
2364 OFCUPDFM E        42
2365 O************             LOTA     256                               122839
     O************             LOTA    1086                       122839  CLE008
     O************             LOTA    1106                        CLE008 147261
     O**********               LOTA    1107                        147261 CLE031
     O**********               LOTA    1198                        CLE031 CLE034
     O**********               LOTA    1211                        CLE034 CLE029
     O**********               LOTA    1222                                            CLE029 CGL029
     O**********               LOTA    1258                                          CGL029 BUG22954
     O**********               LOTA    1269                                          BUG22954 CLE064
     O                         LOTA    1284                                                   CLE064
2366 O                 11 22              1 'E'
2367 O*
2368 O** OUTPUT DETAIL RECORD 'B'
2369 O*
2370 OFCUPDFN E        42
     O/COPY WNCPYSRC,LEH00330
2371 O                         LOTB     256
     O/COPY WNCPYSRC,LEH00331
2372 O                 11 22              1 'E'
2373 O                         BRAT      29P
2374 O                         DUDT      38P
2375 O                         SLCD      71P
2376 O                         ACCD      74P
2377 O*************************ADNP      81P                              E18905
2377 O                         WRKA      81P                              E18905
2378 O                         PDTD      88P
2379 O                         AFPD      95P
2380 O                         ADJP     102P
2381 O                         ADJN     109P
2382 O                         TOTD     116P
2383 O                         BITS     131
2384 O                         NRUN     176P
2385 O                         NOAM     246P
     O                         STMP     330                                                   CLE064
2386 O*
2387 O** OUTPUT TRAILER
2388 O*
2389 O******FCUPDZZ T        LR 50NU7                                     S01117
2389 OFCUPDZZ T        LR   NU7                                           S01117
2390 O** FCLTY TRAILER NOT OUTPUT IF DB ERROR (LOTT NOT READ YET)
2391 O                         LOTT     256
2392 O                         NFCUPD    19P
2393 O                         Z50      252P
2394 O                                  253 ' '
2395 O                         Z50      256P
     O/COPY WNCPYSRC,LE0460O001
2396 O*
2397 O** ACCOUNT KEYS FILE
2398 O*
2399 O** OUTPUT HEADER
2400 O*
2401 OLKEY2HH E        40
2402 O                                    1 'H'
2403 O*
2404 O** OUTPUT DETAIL RECORD
2405 O*
2406 OLKEY2DP E        41
2407 O                                    1 'F'
2408 O                         AKEY      11
2409 O                                   12 'F'
2410 O                         FTYP      15
2411 O                         FSEQ      17
2412 O                         FCUS      23
2413 O**********               BRCD      26                               S01117
2413 O                         BRCF      26                               S01117
2414 O                                   28 '00'
2415 O                         EDAT      31P
2416 O                         EAMT      38P
2417 O                         FCCY      41
2418 O                         SETT      43
2419 O                         OBAC      55
2420 O                         RVIND     56
2421 O                         Z130      63P
2422 O                         Z130      73P
2423 O                         STDT      76P
2424 O*************************SLCD      79P                              E47264
2424 O                         PSLCD     79P                              E47264
2425 O                         EDDT      82P
2426 O                         BCOD      84
2427 O                         BRAT      90P
2428 O                         SPRD      96P
2429 O                         ZIRATE   102P
2430 O                                  103 '0'
2431 O                         TOTD     110P
2432 O                         SACCD    113P
2433 O                         CMFT     114
2434 O                         FAMT     121P
     O***********              PRFC     125                         S01117LN0169
     O***********              CFBR     128                         S01117LN0169
     O                         PRFC     128                               LN0169
     O                         CFBR     131                               LN0169
     O***********              PELAP    134P                        E47264LN0169
     O                         PELAP    124P                              LN0169
2408 O                         AKEY     164                                                   CLE042
     O/COPY WNCPYSRC,LEH00332
     O                                  168 '    '                                            CLE042
     O/COPY WNCPYSRC,LEH00333
2435 O*
2436 O** OUTPUT TRAILER
2437 O*
2438 OLKEY2ZZ T        LR 50
2439 O                                    1 'T'
2440 O                         NLKEY2     4P
2441 O                         KKTOTI    12P
2442 O                         KKTOTD    14P
2443 O*
2444 O** OUTPUT REPORT
2445 O*
2446 O*E0460P1D*  03   01 50                                              S01117
2447 O*******OR*       OF                                                 S01117
     OLE0460P1H   03   L2                                                 S01117
     O       OR        OFNL2                                              S01117
2448 O***********                        22 'REFERENCE LE0460'            S01117
2448 O                                   24 'REFERENCE LE0460P1'          S01117
2449 O                         TITL      89
2450 O                                  122 'DATE              PAGE'
2451 O                         RUNA     112
2452 O                         PAGE  Z  127
2453 O********D** 05   01 50                                              S01117
2454 O*******OR**      OF                                                 S01117
     O        H   05   L2                                                 S01117
     O       OR        OFNL2                                              S01117
2455 O                                   68 'FACILITY ACCOUNT KEYS'
2456 O                                   78 'GENERATED'
     O                   N65             88 'BRANCH'                      S01117
     O                   N65   BRCF      92                               S01117
     O                   N65             93 '-'                           S01117
     O                   N65   BRNM     123                               S01117
2457 O********D** 06   01 50                                              S01117
2458 O*******OR**      OF                                                 S01117
     O        H   06   L2                                                 S01117
     O       OR        OFNL2                                              S01117
2459 O                                   69 '----------------------'
2460 O                                   78 '---------'
2461 O********D**209   01 50                                              S01117
2462 O*******OR**      OF                                                 S01117
     O        H  209   L2                                                 S01117
     O       OR        OFNL2                                              S01117
2463 O***********                        27 'CUSTOMER     FACILITY'       S01117
2464 O***********                        53 'BRANCH     ACCOUNT KEY'      S01117
     O                                   37 'CUSTOMER     FACILITY'       S01117
     O                                   53 'ACCOUNT KEY'                 S01117
2465 O                                   83 'AMOUNT    CURRENCY'
2466 O                                   96 'REV IND'
2467 O        EF 1     41
2468 O***********              FCUS      13                               S01117
2469 O***********              FTYP      23                               S01117
2470 O***********                        24 '/'                           S01117
2471 O***********              FSEQ      26                               S01117
     O                         FCUS      23                               S01117
     O                         FTYP      33                               S01117
     O                                   34 '/'                           S01117
     O                         FSEQ      36                               S01117
2472 O***********              BRCD      35                               S01117
2473 O                         AKEY      52
2474 O                 30      EAMT      74 ' ,   ,   ,   , 0 -'
2475 O                 31      EAMT      74 '   ,   ,   , 0 . -'
2476 O                 32      EAMT      74 '  ,   ,   , 0 .  -'
2477 O                 33      EAMT      74 ' ,   ,   , 0 .   -'
2478 O                         FCCY      80
2479 O                         RVIND     93
      *                                                                   S01117
     O        E   03           P1HEAD                                     S01117
     O                                   24 'REFERENCE LE0460P1'          S01117
     O                         TITL      89                               S01117
     O                                  122 'DATE              PAGE'      S01117
     O                         RUNA     112                               S01117
     O                         PAGE  Z  127                               S01117
      *                                                                   S01117
     O        E 2              P1HEAD                                     S01117
     O                                   68 'FACILITY ACCOUNT KEYS'       S01117
     O                                   78 'GENERATED'                   S01117
     O                   N65             88 'BRANCH'                      S01117
     O                   N65   BRCF      92                               S01117
     O                   N65             93 '-'                           S01117
     O                   N65   BRNM     123                               S01117
      *                                                                   S01117
     O        E 1              P1HEAD                                     S01117
     O                                   69 '----------------------'      S01117
     O                                   78 '---------'                   S01117
     O        T 31     L2N63NU7                                           S01117
     O                                   72 '* NO DETAILS TO REPORT *'    S01117
2480 O********T*31     LR 50NU7                                           S01117
     O        T 31     L2 63NU7                                           S01117
2481 O                                   49 'TOTAL ACCOUNT KEYS'
2482 O                                   59 'GENERATED'
2483 O                         NKYGEN3   69
2484 O*
2485 O********E** 05  N50 U7 U8                                           S01117
2486 O***********                        68 'FACILITY ACCOUNT KEYS'       S01117
2487 O***********                        78 'GENERATED'                   S01117
2488 O********E** 06  N50 U7 U8                                           S01117
2489 O***********                        69 '----------------------'      S01117
2490 O***********                        78 '---------'                   S01117
2491 O********E*32     U7 U8                                              S01117
     O        T 32     U7 U8                                              S01117
2492 O                                   42 '*** REFERENCE'
2493 O***********              DBPGM     51                               S01117
     O                         DBPGM     52                               S01117
     O                                   74 'DATABASE ERROR'              S01117
2494 O***********                        73 '-  DATABASE ERROR AT'        S01117
2495 O***********              DBASE     76                               S01117
2496 O********E**1     U7 U8                                              S01117
2497 O***********                        37 'FILENAME'                    S01117
2498 O***********              DBFILE    43                               S01117
2499 O***********                        48 'KEY'                         S01117
2500 O***********              DBKEY     78                               S01117
     O        T 3      L2 62N65                                           S01117
     O       AND         NU7                                              S01117
     O                                   66 '*** END OF REPORT FOR'       S01117
     O                                   74 ' BRANCH '                    S01117
     O                         BRCF      77                               S01117
     O                                   81 ' ***'                        S01117
2501 O********T*3**    LR                                                 S01117
     O        T 3      LRNU7 65                                           S01117
2502 O                                   68 '***   END OF REPORT'
2503 O                                   74 '   ***'
2504 O*
2505 O** CONTROL TOTALS REPORT
2506 O*
     OLE0460AUT  203   LR                                                 S01117
2508 O***********                        22 'REFERENCE LE0460'            S01117
2508 O                                   24 'REFERENCE LE0460AU'          S01117
2509 O                         TITL      89
2510 O                                  122 'DATE              PAGE'
2511 O                         RUNA     112
2512 O                         PAGE1 Z  127
2513 O        T  1     LR
2514 O                                   64 'COMMITMENT FEE PROCESSIN'
2515 O                                   81 'G - FILE CONTROLS'
2516 O        T  3     LR
2517 O                                   64 '------------------------'
2518 O                                   81 '-----------------'
2519 O        T 11     LR
2520 O                                   28 'S/FCLTY - RUN CONTROLS'
2521 O                                   59 'NUMBER'
2522 O                                   84 'VALUE'
2523 O        T  2     LR
2524 O                                   28 '----------------------'
2525 O                                   59 'OF RECORDS'
2526 O                                   84 'OF RECORDS'
2527 O        T  2     LR
2528 O                                   29 'TOTAL RECORDS ON FILE'
2529 O                NU7      NOREF Z   59
2530 O                NU7      VLAF  Z   81
2531 O                NU7      VLAL      84
2532 O        T  3     LR
2533 O                                   32 'TOTAL RECORDS ON FILE - '
2534 O                                   42 'CALCULATED'
2535 O                         NFCLTYZ   59
2536 O                         FFTOTIZ   81
2537 O                         FFTOTD    84
2538 O                 81               111 '***   DIFFERENCE   ***'
2539 O        T  1     LR
2540 O                                   28 'S/ACTN7 - RUN CONTROLS'
2541 O        T  2     LR
2542 O                                   28 '----------------------'
2543 O        T  2     LR
2544 O                                   29 'TOTAL RECORDS ON FILE'
2545 O                NU7      NOREA Z   59
2546 O        T  3     LR
2547 O                                   32 'TOTAL RECORDS ON FILE - '
2548 O                                   42 'CALCULATED'
2549 O                         NACTN7Z   59
2550 O                 80               111 '***   DIFFERENCE   ***'
2551 O        T  1     LR
2552 O                                   28 'S/FCUPD - RUN CONTROLS'
2553 O        T  2     LR
2554 O                                   28 '----------------------'
2555 O        T  3     LR
2556 O                                   29 'TOTAL RECORDS ON FILE'
2557 O                         NFCUPDZ   59
2558 O                         VLAF  Z   81
2559 O                         VLAL      84
2560 O        T  1     LR
2561 O                                   28 'S/LKEY2 - RUN CONTROLS'
2562 O        T  2     LR
2563 O                                   28 '----------------------'
2564 O        T  3     LR
2565 O                                   29 'TOTAL RECORDS ON FILE'
2566 O                         NLKEY2Z   59
2567 O                         KKTOTIZ   81
2568 O                         KKTOTD    84
     O        T 31     LRNU7N62                                           S01117
     O                                   72 '* NO DETAILS TO REPORT *'    S01117
     O        T 32     LR U7 U8                                           S01117
     O                                   42 '*** REFERENCE'               S01117
     O                         DBPGM     52                               S01117
     O                                   74 '-  DATABASE ERROR AT'        S01117
     O                         DBASE     78                               S01117
     O        T  1     LR U7 U8                                           S01117
     O                                   37 'FILENAME'                    S01117
     O                         DBFILE    46                               S01117
     O                                   50 'KEY'                         S01117
     O                         DBKEY     80                               S01117
2569 O********T*3      LR                                                 S01117
2570 O***********                        68 '***   END OF REPORT'         S01117
2571 O***********                        74 '   ***'                      S01117
**  ZFMD - NO.OF DAYS IN THE MONTH
312831303130313130313031
**  POWR - POWERS OF TEN
0000001
0000010
0000100
0001000
0010000
0100000
1000000
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
** CPY@   **      OBJECT COPYRIGHT
(c) Finastra International Limited 2001
** @YD  USED BY SR. ZDATE9 - YEARS, IN DAYS, CUMULATIVE IN 4 YEAR SPAN
00366007310109601461
** @MD  USED BY SR. ZDATE9 - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
00000000310005900090001200015100181002120024300273003040033400365
** STAMP - Dummy timestamp                                                                    CLE064
0001-01-01-00.00.00.000000                                                                    CLE064
