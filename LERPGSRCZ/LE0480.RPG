0001 H**************                                                      S01117
0001 H        1                                                           S01117
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas LE Create loan events extract file')             *
      *****************************************************************
      *                                                               *
      *  Midas - Customer Lending Module                              *
      *                                                               *
      *  LE0480 - Create Loan Events Extract File                     *
      *                                                               *
      *  (c) Finastra International Limited 2001                      *
      *                                                               *
      *  Last Amend No. MD051219           Date 12Dec19               *
      *  Prev Amend No. MD055084           Date 17Jan20               *
      *                 MD049545A          Date 14Jan20               *
      *                 MD049545           Date 14Jan20               *
      *                 MD054239           Date 29Nov19               *
      *                 AR375646           Date 17Oct19               *
      *                 CER050             Date 16Jun19               *
      *                 MD053295           Date 13Apr19               *
      *                 MD047693           Date 30Jan18               *
      *                 MD050139           Date 23Mar18               *
      *                 CLE071             Date 18Jul18               *
      *                 MD051160           Date 25Jul18               *
      *                 MD046248           Date 27Oct17               *
      *                 MD047993           Date 23Sep17               *
      *                 MD035545           Date 11Sep15               *
      *                 MD045010           Date 05Apr17               *
      *                 CGL184             Date 07Dec16               *
      *                 CLE154             Date 02Aug12               *
      *                 CLE141A            Date 28Apr16               *
      *                 CLE141             Date 08Feb16               *
      *                 LLN022A            Date 03Jun15               *
      *                 LLN022             Date 03Jun15               *
      *                 AR897086           Date 10Mar15               *
      *                 MD021819           Date 25Feb15               *
      *                 MD031481           Date 11Dec14               *
      *                 MD021605           Date 22Aug13               *
      *                 MD020854           Date 25Jul13               *
      *                 MD021155           Date 03Jul13               *
      *                 AR830785           Date 07May13               *
      *                 AR1092898A         Date 02May13               *
      *                 MD019933           Date 24Apr13               *
      *                 AR1095829          Date 26Mar13               *
      *                 AR1092898          Date 20Mar13               *
      *                 AR1078776          Date 18Feb13               *
      *                 CLE075AF           Date 06Aug12               *
      *                 AR996895           Date 25Nov12               *
      *                 AR727923           Date 25Nov12               *
      *                 CLE134             Date 01Aug12               *
      *                 CLE148             Date 23Jul12               *
      *                 AR679736           Date 30Jul12               *
      *                 AR947093           Date 26Apr12               *
      *                 AR847249           Date 28Jan12               *
      *                 AR909846           Date 09Feb12               *
      *                 CER049             Date 06Dec10               *
      *                 CRE073             Date 06Dec10               *
      *                 CLE139             Date 06Dec10               *
      *                 CLE064             Date 06Dec10               *
      *                 262545             Date 15Dec08               *
      *                 256872             Date 21Jan09               *
      *                 245132             Date 21Oct08               *
      *                 263666             Date 01Feb10               *
      *                 CER059             Date 19Jul10               *
      *                 CER045             Date 20Jul09               *
      *                 BUG23967           Date 15May09               *
      *                 CER016A            Date 19May08               *
      *                 CER020             Date 19May08               *
      *                 CER043             Date 19May08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      *                 CCB016             Date 31May07               *
      *                 CSC042             Date 16Feb09               *
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *                 248869             Date 28Jun07               *
      *                 247981             Date 30May07               *
      *                 245427             Date 02Apr07               *
      *                 246747             Date 29Mar07               *
      *                 246141             Date 26Mar07               *
      *                 245725             Date 15Mar07               *
      *                 249975             Date 11Sep07               *
      *                 248973             Date 12Jul07               *
      *                 BUG13946           Date 15May07               *
      *                 245082             Date 30Jan07               *
      *                 244961             Date 31Jan07               *
      *                 164847             Date 30Nov06               *
      *                 BUG13336           Date 23Feb07               *
      *                 CRE026             Date 19Feb07               *
      *                 BUG12990           Date 05Jan07               *
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 242286             Date 26Sep06               *
      *                 230229             Date 25Sep06               *
      *                 227082             Date 06Jun06               *
      *                 223215             Date 06Jun06               *
      *                 237466             Date 24Mar06               *
      *                 CSD031             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 221708             Date 06Jun06               *
      *                 221054             Date 26May06               *
      *                 BUG11271           Date 21Apr06               *
      *                 CLE042             Date 06Sep05               *
      *                 230371             Date 05Dec05               *
      *                 BUG8552            Date 29Sep05               *
      *                 CER001             Date 25Apr05               *
      *                 BUG9242            Date 15Nov05               *
      *                 BUG9241            Date 15Nov05               *
      *                 BUG9175            Date 28Oct05               *
      *                 BUG8378            Date 01Sep05               *
      *                 CLE106             Date 06May05               *
      *                 CLE038             Date 14May04               *
      *                 227100             Date 14May04               *
      *                 227292             Date 17Jun04               *
      *                 226542             Date 21Apr04               *
      *                 218984R            Date 12Nov03               *
      *                 CLE036             Date 22Sep03               *
      *                 CSW037A            Date 02May05               *
      *                 CIR013             Date 25Apr05               *
      *                 230112             Date 14Oct04               *
      *                 229938             Date 11Oct04               *
      *                 228806             Date 17Aug04               *
      *                 226663             Date 28Apr04               *
      *                 226512             Date 23Apr04               *
      *                 226261             Date 12Apr04               *
      *                 220738             DATE 28AUG03               *
      *                 CAS008             Date 16Jun04               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 BUG3644            Date 12Jul04               *
      *                 CLE025             Date 20Oct03               *
      *                 CGL029             Date 01Sep03               *
      *                 222373             Date 28Oct03               *
      *                 221684             Date 03Oct03               *
      *                 218992             Date 10Jul03               *
      *                 218782             Date 19Jun03               *
      *                 CLE034             Date 21May03               *
      *                 217289             Date 05May03               *
      *                 CLE033             Date 26Mar03               *
      *                 CLE031             Date 10Feb03               *
      *                 224321             Date 14Jan04               *
      *                 223752             Date 12Dec03               *
      *                 222972             Date 23Nov02               *
      *                 CAS005             Date 16Dec02               *
      *                 CLE028             Date 27Jun02               *
      * Midas Release 4.01.02 ----------------------------------------*
      *                 208750             Date 27Aug02               *
      *                 199038             Date 02Jan02               *
      *                 CLE015             Date 18Dec01               *
      * Midas Release 4.01 -------------------------------------------*
      * Midas Release 4 --------------- Base -------------------------*
      *                 192896             Date 29May01               *
      * Midas DBA 3.05 -----------------------------------------------*
      *                 CSD006             Date 15May01               *
      *                 180161             Date 27Jan01               *
      *                 190313             Date 22Feb01               *
      *                 CLE011             Date 07Nov00               *
      * Midas DBA 3.04 -----------------------------------------------*
      *                 171691             Date 24Aug00               *
      * Midas DBA 3.03 -----------------------------------------------*
      *                 CIR004             Date 20Jan00               *
      * Midas DBA 3.02 -----------------------------------------------*
      *                 CPB001             Date 08Sep99               *
      *                 131273             Date 16Apr98               *
      *                 163486             Date 13Oct99               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 150931             Date 10May99               *
      *                 154221             Date 26Apr99               *
      *                 154799             Date 03Mar99               *
      *                 151295             Date 03Mar99               *
      *                 133914             Date 03Mar99               *
      *                 144089             Date 03Mar99               *
      *                 142393             Date 22Sep98               *
      *                 142388             Date 25Sep98               *
      *                 147816             Date 16Nov98               *
      *                 140903             Date 18Aug98               *
      *                 137920             Date 29Jun98               *
      *                 CEU020             Date 13Mar98               *
      *                 134961             Date 11May98               *
      *                 134798             Date 07May98               *
      *                 CEU004             Date 02Feb98               *
      *                 127048             DATE 26FEB98               *
      *                 121768             DATE 19FEB98               *
      *                 126017             DATE 17NOV97               *
      *                 128087             Date 23Dec97               *
      *                 127735             Date 09Dec97               *
      *                 CLE005             Date 22May97               *
      *                 124660             Date 22Oct97               *
      *                 123333             Date 31Sep97               *
      *                 097885             DATE 31JAN97               *
      *                 CLE006             Date 02Dec96               *
      *                 CLE004             Date 02Dec96               *
      *                 105140             DATE 18NOV96               *
      *                 103382             DATE 04JUN96               *
      *                 S01408             DATE 15MAY96               *
      *                 S01408             DATE 26APR96               *
      *                 S01408             DATE 06FEB96               *
      *                 095244             DATE 01NOV95               *
      *                 095238             DATE 31OCT95               *
      *                 088120             DATE 05OCT95               *
      *                 089289             DATE 06SEP95               *
      *                 CCM002             DATE 07NOV95               *
      *                 091370             DATE 06OCT95               *
      *                 S01408             DATE 05SEP95               *
      *                 088291             DATE 20JUN95               *
      *                 088708             DATE 21JUN95               *
      *                 080332             DATE 13DEC94               *
      *                 S01486             DATE 21OCT94               *
      *                 060527             DATE 11MAR94               *
      *                 066550             DATE 04FEB94               *
      *                 046303             DATE 16JAN94               *
      *                 056872             DATE 24NOV93               *
      *                 053699             DATE 19NOV93               *
      *                 S01393             DATE 30OCT92               *
      *                 S01392             DATE 14SEP92               *
      *                 E25263             DATE 31MAR92               *
      *                 S01332             DATE 31MAR92               *
      *                 BHF524             DATE 31MAR92               *
      *                 BHF373             DATE 31MAR92               *
      *                 BHF604             DATE 06SEP90               *
      *                 BHF444             DATE 30AUG90               *
      *                 S01220             DATE 21AUG90               *
      *                 BHF420             DATE 13AUG90               *
      *                 S01270             DATE 17AUG90               *
      *                 LN0383             DATE 18JUN90               *
      *                 BHF090             DATE 24MAY90               *
      *                 S01260             DATE 15MAY90               *
      *                 S01243             DATE 15MAY90               *
      *                 LN0251             DATE 24MAY90               *
      *                 LN0037             DATE 27APR90               *
      *                 E20200             DATE 15FEB90               *
      *                 S01194             DATE 12JAN90               *
      *                 S01195             DATE 16/08/89              *
      *                 S01117             DATE 16/08/89              *
      *                 S01164             DATE 25/05/88              *
      *                 E12000             DATE 13/04/88              *
      *                 S01147             DATE 20/11/87              *
      *                 E11352             DATE 08/08/87              *
      *                 E10836             DATE 16/04/87              *
      *                 E80945             DATE 25/06/86              *
      *                                                               *
      *---------------------------------------------------------------*
      *                                                               *
      *  MD051219 - FOOB in LEC06A due to Blank record in LELWNEZ1    *
      *  MD055084 - Scenario 1.15 Discrepancy on LE3180P1 and         *
      *             OAM fields                                        *
      *  MD049545A - EM Exposure Mgmt Enquiry shows wrong figures.    *
      *  MD049545 - EM Exposure Mgmt Enquiry shows wrong figures.     *
      *  MD054239 - Generate events up to loan maturity when          *
      *             UDC module is ON and Lending ICD End of Book 'N'  *
      *  AR375646 - Loans with -neg principal display as positive.    *
      *             Reversed line that converts -neg amount to pos(+).*
      *             Do not reverse In/Out indicator for -neg amounts. *
      *           - Applied for MD053091                              *
      *  CER050 - Annualised Percentage Rate                          *
      *  MD053295 - Lending loan with Interest Calculation Basis      *
      *             method 3 (30/360) has wrong interest payment      *
      *             amount for month of March (Recompile)             *
      *  MD047693 - Rollover Dates are not 'modified' to be the       *
      *             Previous Working Day, if the Month End falls on a *
      *             holiday                                           *
      *  MD050139- AOSARDR0 called every time causing performance     *
      *            issue. Recompile due to changes in /COPY           *
      *            ZFREQ/ZFRQ*.                                       *
      *  CLE071 - Value Dating of Rate Changes to Fees (Recompile)    *
      *  MD051160 - LEC06A 10015 trailer imbalance                    *
      *  MD046248 - Finastra Rebranding                               *
      *  MD047993 - Modified MD035545. Removed dependency on Accrue   *
      *             on Last Day indicator.                            *
      *  MD035545 - LE: Interest Calculation in Leap year. Consider   *
      *             Accrue on Last Day Indicator for method 6.        *
      *  MD045010 - Component LEC06A 10008 looping during COB caused  *
      *             by CGL184. Recompile due to changes in ZFRQB3.    *
      *  CGL184 - New Frequencies for Account Statements (Recompile)  *
      *  CLE154 - Loan Repayment Schedule Enhancement                 *
      *           (Amendable Payment Type)                            *
      *  CLE141A - CLE141 Change Control 1                            *
      *  CLE141 - Currency and Location Business Day Convention       *
      *           for Lending Transactions                            *
      *  LLN022A - BOE Upgrade to MidasPlus - incorporate code from   *
      *            /COPY members and add switchability.               *
      *  LLN022 - BOE Upgrade to MidasPlus                            *
      *  AR897086 - Amended program to ensure that INTDUE will not be *
      *             zeroised when interest rate (EFFINT) has sign     *
      *             opposite the interest due.                        *
      *           - Applied for MD033488                              *
      *  MD021819 - Missing repayments on LE0865P1 after fix AR679736.*
      *             Fix reinstated old processing and added new codes *
      *             to terminate interest and/or repayment processing *
      *             when computed VINTR/VREPAY is less than NIDT/NRPD.*
      *           - Applied for MD031379                              *
      *  MD031481 - Blank Customer Number on EMXT1D1 due to reused    *
      *             indicator. Replace indicator for writing record   *
      *             on LELWNEPKD.                                     *
      *  MD021605 - Process only non-PDCL on the first run and only   *
      *             PDCL on the second run to make sure that all event*
      *             for PDCL loan is processed.                       *
      *  MD020854 - Erroneous postings shown in both Account          *
      *             Movements and Projected Account Movements Screen  *
      *  MD021155 - COB Restructure Phase 1 remnants                  *
      *           - Only changed one call to ZCONVNZ1 to execute      *
      *             ZCONVN                                            *
      *           - Caching code incorrectly - EMUCCY used as         *
      *             currency for all currencies                       *
      *           - Caching code incorrectly - #YLC(yield codes) used *
      *             to look up yield rates instead of #YLR            *
      *  AR830785 - Recompiled due to changes in core hook RULE78Z1.  *
      *             (Child: AR830786)                                 *
      *  AR1092898A - PMC1410 encountered dbase error in PM1460. Use  *
      *               '*FIRST' opt in calling AOPORTR0 such that field*
      *               FCR997 of SDPORTPD will be populated correctly  *
      *  MD019933 - EMC06 seq 00003 in FOOB error during Day 4 EN     *
      *             and SG COB                                        *
      *  AR1095829 - LEC06A  04002 in FOOB                            *
      *  AR1092898 - PMC1410 encountered dbase error in PM1460.       *
      *              Program is trying to divide a zero spot rate.    *
      *  AR1078776 - Encountered FOOB in EMC06 seq 00002 and 00003    *
      *  CLE075AF - COB Restructure - LE COB Optimisation Phase 1     *
      *  AR996895 - Incorrect acrrual interest calculation            *
      *             (Child: AR996897) (Recompile)                     *
      *  AR727923 - LE Repaymenet Events incorrect. Amended source to *
      *             add past due interest on interest paid for the    *
      *             calculation of interest amount.                   *
      *             Applied for AR996942 (Child:AR996943)             *
      *  CLE134 - Past Due Call Loan Processing                       *
      *  CLE148 - Alpha Loan Reference                                *
      *  AR679736 - COB component LEC06A 90015 loops due to loan with *
      *             maturity date equals to 01DEC2071. Added checking *
      *             to prevent LE0480 from looping when loan's        *
      *             maturity date has been changed to 01DEC2071 and   *
      *             computed next interest payment date is less than  *
      *             original interest payment date. Formalisation     *
      *             of fix done on site by Lucy Japlit (M01698).      *
      *  AR947093 - Base Rate amendment resulted to 0 interest rate   *
      *  AR847249 - Perform exception handling when Final rate is     *
      *             negative or zero.                                 *
      *  AR909846 - LEC06A 10015 failed,CLONCLL1 Key 000012 DBerr 029 *
      *  CER049 - Stamp Tax                                           *
      *  CRE073 - Interest Rate Rounding                              *
      *  CLE139 - Lending Fee Capitalisation                          *
      *  CLE064 - Enhancement of Lending Frequencies (Recompile)      *
      *  262545 - Reduce cob run time when IAS active                 *
      *  256872 - Extend management of payment due/taken indicators   *
      *           to Repayment Type 2.                                *
      *  245132 - LEC06A takes too long. Prevent calling DLZFWR again *
      *           if it has the same parameter as the previous. Call  *
      *           DLZFWR2 instead (from DLZFWR) with additional       *
      *           parameter. GLINTCZ1 and ZINTDYZ2 changed to avoid   *
      *           multiple calls of AOSARDR0.                         *
      *  263666 - Recompiled due to changes in ZINTDYZ2               *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  CER045 - German Features - Reporting Bundesbank (Recompile)  *
      *  BUG23967 - Add Local Industry Code Field.                    *
      *  CER016A - German Interest Calculation: Upgarde of FGE059     *
      *            to Midas Plus (Recompile)                          *
      *  CER020 - Enhanced Rollover Window: Upgrade FGE089 to         *
      *           Midas Plus                                          *
      *  CER043 - German Features LF041-00 New Fields and Defaulting  *
      *           (Recompile)                                         *
      *  CCB016 - CoB Performance Enhancements.                       *
      *           Existing /COPY members used:                        *
      *           LE0480C017                                          *
      *  CSC042 - COB Performance fix. Attempt to reduce the number   *
      *           of times the program calls AOBRCHR0                 *
      *           PGM builds a set of arrays in first cycle for all   *
      *           CCY details and then ignores it and calls AOCURRR*  *
      *           to get spot days. Add spot days into array and      *
      *           remove calls to AOCURRR*. Use CCYDSP to do LOKUP    *
      *  248869 - Misapplication of 214232 caused 72V5 to no longer   *
      *           be a valid Event Code, leading to d/b error 035.    *
      *           TAB1 had 2 72V3 entries; amended the second to 72V5.*
      *  247981 - Apply 214232.                                       *
      *  214232 - The only movement of money for Risk loans should be *
      *           interest amounts. Amended the following values in   *
      *           TAB1/TAB2 table array:-                             *
      *           From           to                                   *
      *           70V7311        70V7310                              *
      *           70R9154        70R9150                              *
      *           70R1154        70R1150                              *
      *           71V7311        71V7310                              *
      *           71R9154        71R9150                              *
      *           71R1154        71R1150                              *
      *           72V1311I       72V1310                              *
      *           72V3113I       72V3110                              *
      *           72V7311I       72V7310                              *
      *           72R1154O       72R1150                              *
      *           72R9154O       72R9150                              *
      *           72M1232O       72M1230                              *
      *  246747 - Yield rate should not be added to spread rate.      *
      *           Reverse fix 228806.  Applied fix 235946.            *
      *  246141 - Recompiled due to changes in ZINTDYZ2               *
      *  245725 - Incorrect rates are used for loans with rollovers.  *
      *           Interpolated rates should be used for future dated  *
      *           cash flows.                                         *
      *  249975 - Payment due A/taken N - not processed correctly.    *
      *         - Applied fix 249389.                                 *
      *  248973 - Applied fix 245427.                                 *
      *  BUG13946 - GLC0802A Program runs too long during COB ;       *
      *             applied fix 245427                                *
      *  245427 - Correct codings of 244961 such that it should be    *
      *           the interest date which will be processed in        *
      *           SR/INTRST.                                          *
      *  245082 - Loans with first and last day accrual should be     *
      *           treated as first day accruals until maturity        *
      *           date.  Then add one day on the maturity date.       *
      *           Applied fix 218511 from Release 4 and changed       *
      *           SR/SRNTR to check on MDAT not VDAT.                 *
      *  244961 - Event dates should be dependent on PTDI if original *
      *           actual date falls on a holiday. Reinstate core      *
      *           fixes 133914 and 192896.                            *
      *  164847 - Recompile over changes in /COPY ZINTDYZ2.           *
      *  BUG13336 - Incorrect forward rate due to EVDATE (non-working *
      *             day) passed to DLZFWR                             *
      *  CRE026 - Consumer Banking                                    *
      *  BUG12990 - Recompiled due to changes in ZINTDYZ2/ZINTDYZ2LE  *
      *  242286 - Recompile over changes in /COPY ZINTDYZ2.           *
      *  230229 - Interest payment events missing from the nostro     *
      *           cashflow report                                     *
      *  227082 - Interest payment is projected to be taken on the    *
      *           next working day eventhough int pay date is not     *
      *           holiday.  Revised fix 223215 to initialise ZLOC and *
      *           ZCCY before calling SR/ZFWDT.                       *
      *  223215 - Principal repayment falling on non-working day is   *
      *           not in PAMV.  Apply fix 223195.                     *
      *  237466 - PTDI = ' ' should be processed the same way as      *
      *           PTDI='M'(not 'N'). Include Settlement Types 02      *
      *           and 12 in the validation for Transaction CCY.       *
      *           Applied fix 236098.                                 *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  221708 - Incorrect projected movement amount for forward     *
      *           valued discounted loan. Consider interest in        *
      *           computing start amount of discounted loan.          *
      *  221054 - Reversed core fixes 133914 and 192896.  These fixes *
      *           changed the interest payment date event due date.   *
      *           In Financial loan's Diary, the due date shown should*
      *           be the actual Interest or Repayment Date.           *
      *           Applied fix 215431. Fix annotated as BUG8552.       *
      *  BUG11271 - R4 and I6 events for CAS005 are not valid for     *
      *             PTYP 70, 71, and 72.                              *
      *  CLE042 - Extended Loan Sub Type                              *
      *  230371 - INTERPOLATED YIELD RATES ARE INCORRECT IN LE4111P1. *
      *  BUG8552 - Reversed core fixes 133914 and 192896. These fixes *
      *            changed the interest payment date event due date.  *
      *            In Financial loan's Diary, the due date shown      *
      *            should be the actual Interest or Repayment Date.   *
      *            (Based on fix 215431)                              *
      *  CER001 - LUX Upgrade to MidasPlus                            *
      *  BUG9242 - Cashflow error on Repayment type 3 where loan gets *
      *            paid prior to maturity (Applied fix 236757)        *
      *  BUG9241 - Looping problrm in LE0480 (Applied fix 235239)     *
      *  BUG9175- No shadow postings generated for future dated loans *
      *  BUG8378- REFERENCE LE0480 - DATABASE ERROR AT 058  FILENAME  *
      *           KEY   65R1                                          *
      *  CLE106 - Syndication Manager                                 *
      *  CLE038 - Lending Enhancement for Nordea: Allocation by Amount*
      *  227100 - Do not switch off *IN10 in check of CLE034.         *
      *  227292 - Principal amount not printed anymore on financial   *
      *           loans diary for rollover event. Change to 218984.   *
      *  226542 - If the event amount is negative, need to swap the   *
      *           pay and receive settlement instructions for loan    *
      *           amendments. This will ensure that the settlement    *
      *           details on LEHOSTPD are on the correct side for     *
      *           the pay/receive indicator.                          *
      *  218984R- (reopen) Need to change the instructions indicator  *
      *           INSIND for the Principal Increase event. It is set  *
      *           to 3 to get the settlement details from the loan    *
      *           amendment. But can now get a Principal Increase     *
      *           event for a non-multicurrency rollover which        *
      *           produces an increase. So need to change INSIND      *
      *           to 4. This will be changed to 3 if a loan amendment *
      *           is being processed. Otherwise it will change to 2.  *
      *           If the event type is V3 for PI, then change to 1.   *
      *           Also ensure loan amendment indicator is set on for  *
      *           Manual Repayments.                                  *
      *           After a rollover that produces a repayment or       *
      *           increase, the current principal amount should be    *
      *           changed to be the new principal amount.             *
      *  CLE036 - LE Enh for Nordea Phase 1 Pty 2 - Specific Base Rate*
      *           Allow repayments in facility currency.              *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  CIR013 - Additional Calculation Method for FRA/IRS/CCF       *
      *           Recompile over GLINTC and ZINTDY.                   *
      *  230112 - No interest rate reported on LE4111P1 and LE4311P1  *
      *           (Repayment of interest).                            *
      *  229938 - To use correct ineterest rate.  Amend fix 226261.   *
      *  228806 - IAS LE4311P1 wrong rate on floating rate deals      *
      *  226663 - CAS005 events have 0 amounts when forward yield     *
      *           curve is blank.  Amend SRNTR so that interest will  *
      *           be computed even when forward yield curve is blank. *
      *  226512 - Suppress legacy events for CAS005 event codes.      *
      *  226261 - Always getting forward yield rate from SDYLDRPD     *
      *           when CAS005 is installed.                           *
      *  220738 - Dump if customer closed                             *
      *  CAS008 - IAS39 Enhancements                                  *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  BUG3644 - Serious Error in Collateralised Lending (Recompile)*
      *  CLE025 - Credit Lines (Recompile)                            *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  222373 - Parameter Mismatch.                                 *
      *  221684 - Only set on indicator 33 in SR34B if system value   *
      *           Settlement09Postings is settlement ccy              *
      *           Ensure extended settlement details are correct for  *
      *           Settlement Allocations                              *
      *  218992 - Output extended settlements onto LVENTEL to ensure  *
      *           details from settlement allocation are used on      *
      *           LEHOSTPD                                            *
      *  218782 - Check system value Settlement 09 Postings to decide *
      *           whether to use Settlement or Transaction Ccy.       *
      *  CLE034 - Lending Enhancements Phase 1 Priority 1A            *
      *  217289 - Settlement method 09 - booking branch fix           *
      *  CLE033 - Settlement method 09                                *
      *  CLE031 - Lending Enhancements.                               *
      *  224321 - Missing quarterly interest in LE4311P1 when CAS005  *
      *           is installed.                                       *
      *  223752 - Interest rate shown in LE4111P1 is incorrect        *
      *  222972 - Define R4 event for a loan with processing type 80  *
      *  CAS005 - Enhancements to CAS001, CAS002 and CAS004           *
      *  CLE028 - Flat Rate Personal Loans (Rule of 78s)              *
      *  208750 - Call loans appeared in the LE0691P1 report with a   *
      *           maturity date equal to rundate + 15 working days.   *
      *           Amend the program to initialise the maturity event  *
      *           date of call loans to zero.
      *  199038 - Shortfall interest column in LE0580 different       *
      *           between DBA1 and DBA3. *IN87 not reset.             *
      *  CLE015 - Functionality moved from Syndicated Lending to      *
      *           Customer Lending                                    *
      *  192896 - Events generated with wrong event date because      *
      *           wrong ccy used to check if date is holiday          *
      *           correction of 133914                                *
      *  CSD006 - Use long DS with SDBSRTPD.                          *
      *  180161 - If interest payment frequency is 'R' and CLE005 is  *
      *           on, next interest payment must be based on rollover *
      *           setup.  Pass rollover setup before executing SR/    *
      *           ZFRQB3, as 'R' in SR/ZFRQB3 means monthly interest  *
      *           6 days before monthend.                             *
      *  190313 - Undefined Multi-ccy Rollover events for Call loans. *
      *  CLE011 - Rate Fixing Days for Lending Rollover Processing    *
      *  171691 - Generate future events eventhough past due exists.  *
      *           This is to project the availability of a facility   *
      *           when future repayments are attached against a loan. *
      *  CIR004 - Dealing Calculation Method Change.                  *
      *         - Recompiled due to GLINTC and ZINTDY changes         *
      *  CPB001 - 'Private Banking' Module                            *
      *  131273 - Correctly set-up Portfolio Reference for non-portf. *
      *           loans.                                              *
      *  163486 - Loans missing from GL0550 & GL0580 reports. Added a *
      *           'Settlement in another currency' field to LVENTEL.  *
      *  150931 - Do not call EU0200 if event and settlement currency *
      *           are the same.                                       *
      *  154221 - Calculations added for payment due/taken indicators *
      *           for repayment types 1 and 3.                        *
      *  154799 - Recompiled due to changes in /COPY,ZACCH            *
      *  151295 - Problems authorising repayment schedules            *
      *           Recompiled due to changes in ZCHKH                  *
      *  133914 - Events are projected on actual dates when payment   *
      *           taken dates are previous or next                    *
      *  144089 - Add processing for payment due day indicator        *
      *  142393 - Rollover on Risk loans not allowed                  *
      *  142388 - Repay Schedule for risk loans not allowed           *
      *  147816 - Fixed EU0200 being called with parameter P@FRCY     *
      *           not being an IN CCY. Database error code for EU0200 *
      *           changed to 47, so that numbers are unique.          *
      *  140903 - Event types for MC always being generated           *
      *  137920 - EMU Additional Fixes for LE Settlement Currency     *
      *           Conversion                                          *
      *  CEU020 - EMU Lending Multi-currency Rollover                 *
      *  134961 - LE0480 generates new event codes for EMU.           *
      *           EMU design doesn't include new events for Dummy,    *
      *           Interest Capitalised and Past Due. The program,     *
      *           however, generates new events for all existing      *
      *           if settlement currency is specified. Processing for *
      *           these events removed.                               *
      *  134798 - Missing EMU codes                                   *
      *  CEU004 - LE Settlement Ccy conversion Upgrade to DBA R2.0    *
      *  127048 - Generate events, even if loan is past due.          *
      *         - On maturity event for discount loan which is rolling*
      *           over with reduced principal, output zero to         *
      *           principal amount.                                   *
      *  121768 - Recompile over changed GLINTCZ1                     *
      *  126017 - Correction to interest calculation for calculation  *
      *           basis 6 in SR/GLINTC. Add SR/ZDAT10                 *
      *  128087 - Apply GEMS # 111706 - Interest due events not       *
      *           generated if call loan and S01465.                  *
      *  127735 - Future dated 'MR' events are not generated as       *
      *           required by Customer Lending Enh (Tranche 3).       *
      *  CLE005 - Customer Lending Enhancements - Tranche 3           *
      *  CLE005 - Customer Lending Enhancements - Tranche 3           *
      *  124660 - Some event codes are missing                        *
      *  123333 - Repayment may be in facility currency and will      *
      *           need to be converted.                               *
      *  097885 - Recompiled for wrong calculation of number of day   *
      *           interest (ZINTDYZ2).                                *
      *  CLE006 - Customer Lending Enhancements - Past Due Accounts   *
      *  CLE004 - Customer Lending Enhancements - Syndications        *
      *  105140 - Recompile over changed LVENTZZ.                     *
      *           Field NORE  attribute changed.                      *
      *  103382 - Do not flag database error if record not found on   *
      *           SDDEALPD - dealing may not be switched on.          *
      *  S01408 - Core hook LE0480FFP2 added                          *
      *           Core hook LE0480CP13 added                          *
      *           Core hook LE0480CP12 added                          *
      *           Core hook LE0480CP11 added                          *
      *           Core hook LE0480CP10 added                          *
      *           Core hook LE0480CCP9 added                          *
      *           Core hook LE0480CCP8 added                          *
      *           Core hook LE0480CCP7 added                          *
      *           Core hook LE0480CCP6 added                          *
      *  S01408 - Core hook LE0480FFP1 added                          *
      *           Core hook LE0480CCP4 added                          *
      *           Core hook LE0480CCP5 added                          *
      *  S01408 - Core hook LE0480CCP2 added                          *
      *           Core hook LE0480CCP3 added                          *
      *  095244 - Recompiled for Calculation method 3                 *
      *  095238 - Recompiled for Calculation method 3                 *
      *  088120 - Amendment to 089289. Repayment type 3 should first  *
      *           be applied to interest before the principal.        *
      *  089289 - System should not project repayments after current  *
      *           loan amount has becomes -VE (Enhancememt to E11352) *
      *  CCM002 - Midas/Citydealer Interface (Phases V and VI)        *
      *           For Citydealer, maturity interest on call loans     *
      *           should be set to Billing/Notice Days forward.       *
      *  091370 - Retail postings are duplicated when Booking branch  *
      *           is not the same as settlement branch - reset SETAC  *
      *           and SETNOS for inter-branch events.                 *
      *  S01408 - Core hook LE0480CCP1 added                          *
      *  088291 - Generate Past Due event as soon as payment is Past  *
      *           Due, instead of after 3 days. The 3 days grace      *
      *           period (for cheque clearing) was specified in the   *
      *           FS but has been removed at R10 but the processing   *
      *           was not changed, which means that the exposure and  *
      *           availability for a facility is incorrect if a       *
      *           payment is overdue for 3 days or less.  Fix is to   *
      *           generate a Past Due event in all cases where a      *
      *           payment is overdue.                                 *
      *  088708 - If S01465 is on, then generation of Maturity        *
      *           event should occur on the New Maturity Date if      *
      *           the Roll-over Date is equal to the current          *
      *           Maturity date.                                      *
      *  080332 - Add events 64X2, 66X2 and 70X2 tp array             *
      *           (Remainder of E25263)                               *
      *  S01486 - Portfolio Management Upgrade to Release 10.         *
      *  060527 - Auto-settlement in Financial Loans Diary is wrong.  *
      *           To fix, retrieve auto-settle indicator from LOAM    *
      *           file for loan amendment repayment schedules, and    *
      *           from CLOAN otherwise.                               *
      *  066550 - GLINTC has had historical problems and inaccuracies *
      *           and is now externaly descibed and changed to use    *
      *           ZINTDYZ1. See document atached to error no on GEMS  *
      *  046303 - /COPY source subr. ZFWDT amended to prevent array   *
      *           error if no holiday record found - fixed by S01434. *
      *           Program recompiled.                                 *
      *  056872 - Increase number of XCOD & XREG array entries from   *
      *           300 to 400, and amend SR/CRYARS accordingly.        *
      *  053699 - Use Facility Customer for Exposure                  *
      *  S01393 - RISK MANAGEMENT R10. BOOK CODE OUTPUT INCORRECTLY   *
      *  S01392 - JAPANESE SUB MODULE ENHANCEMENTS                    *
      *  E25263 - IF INTEREST IS CAPITALISED CHANGE EVENT TYPE        *
      *           FROM I2 TO X2 SO THAT THESE EVENTS DO NOT SHOW      *
      *           UP ON EVENTS REPORTS                                *
      *  S01332 - R10 Exposure Mgmt, add Value Date and Maturity      *
      *           Date fields to tomorrows events file for            *
      *           scaling purposes                                    *
      *  BHF524 - OUTPUT CORRECT OUR SETTLEMENT BRANCH                *
      *  BHF373 - CORRECT M/D INDICATOR                               *
      *  BHF604 - SHOULD SET ON *IN55 IF RETURN CODE IS NOT BLANKS    *
      *  BHF444 - SHOULD MOVE OLNO TO CUST NUMBER IF RECOURSE BLANK   *
      *  S01220 - Amended for Strategic Risk Management Release 10    *
      *           to output 2 additional fields to the Events         *
      *           file. These are 'Book Code' and 'Subsequent to      *
      *           Rollover Flag'.                                     *
      *  BHF420 - SHOULD USE 6 ZONED VERSION OF OLNO                  *
      *  S01270 - CUSTOMER LENDING CHANGES                            *
      *  LN0383 - O-SPEC DOES NOT MATCH LAYOUT OF PF/LVNTXEL          *
      *  BHF090 - PRODUCE 3 DUPLICATE RECORD DUE TO THREE EXCPT'S     *
      *           TURNED OFF INDICATOR AFTER FIRST EXCPT.             *
      *  LN0251 - CUSTOMER NAME, TOWN AND SORT SEQ, NEED TO BE        *
      *            RENAMED FROM NEW STANDING DATA                     *
      *  S01260 - ORIGINAL BORROWER ON PARTICIPATIONS PURCHASED..     *
      *  S01243 - INCLUDE EVENTS FOR PRINCIPAL INCREASES ON           *
      *           TERM LOANS                                          *
      *  LN0037 - SYSTEM CONTINUES TO PROJECT REPAYMENYS AFTER DATE   *
      *           OF BALANCE IS CLEARED                               *
      *  E20200 - AMENDMENT TO S01164 - EVENTS SHOULD BE GENERATED    *
      *           TO ROLLOVER DATE RLDT IF EVENTS TO END BOOK = N.    *
      *           NROD (IF NE 0) HOLDS FOLLOWING ROLLOVER DATE FOR    *
      *           USE WHEN LOAN IS ROLLED OVER.                       *
      *  S01194 - STANDING DATA CHANGES                               *
      *  S01195 - HOLIDAY AMENDMENT                                   *
      *  S01117 - MULTIBRANCHING                                      *
      *  S01164 - COB ENHANCEMENTS - EVENTS ONLY GENERATED UP TO      *
      *           NEXT ROLLOVER DATE UNLESS MATURITY LESS THAN        *
      *           30 DAYS AHEAD (AS REQUESTED ON TABTB50)             *
      *  E12000 - NEW ENTRY ADDED TO ARRAY TO ALLOW A PRINCIPAL       *
      *           INCREASE (LOAN AMEND TYPE 'PI') TO BE MADE ON       *
      *           A RISK LOAN (TYPE 70).                              *
      *  S01147 - RELEASE 22 (AMENDMENT TO GLINTC)                    *
      *  E11352 - MATURITY EVENT REFLECTED AS A NEGATIVE AMOUNT       *
      *           ON THE CASH FLOW.                                   *
      *  E10836 - FOR PARTICIPATIONS PURCHASED WITHOUT RECOURSE       *
      *           OUTPUT EVENTS RECORD FOR ORIGINAL BORROWER          *
      *           RATHER THAN PURCHASE CUSTOMER                       *
      *  E80945 - INDICATOR 98 SETTING IS SAVED AND RESTORED          *
      *           WHEN S.R.GLINTC IS PERFORMED.                       *
      *                                                               *
      *****************************************************************
0013 F*CLOAN***IP**F*****400  7AI     2 DISK                              S01270
0013 F*CLOAN***IP**F*****434  7AI     2 DISK                        S01270S01220
0013 F***CLOAN***IP**F     436  7AI     2 DISK                      S01220S01486
0013 F***CLOAN***IP**F    1092  7AI     2 DISK                     S01486 CLE004
     F***CLOAN***IP  F    1275  7AI     2 DISK                     CLE004 CEU004
     F*CLOAN***IP  F    1290  7AI     2 DISK                       CEU004 CLE011
     F***CLOAN** IP  F    1310  7AI     2 DISK                                         CLE011 CLE028
     F***CLOAN***IP  F    1389  7AI     2 DISK                                         CLE028 CAS005
     F***CLOAN   IP  F    1466  7AI     2 DISK                                         CAS005 CLE031
     F***CLOAN***IP  F    1492  7AI     2 DISK                                         CLE031 CLE034
     F***CLOAN** IP  F    1493  7AI     2 DISK                                         CLE034 CGL029
     F***CLOAN** IP  F    1632  7AI     2 DISK                                         CGL029 CLE036
     F*CLOAN***IP**F****1644  7AI     2 DISK                                           CLE036 CLE042
     F***CLOAN**   IP  F    1773  7AI     2 DISK                                       CLE042 CER020
     F***CLOAN** IP  F    1782  7AI     2 DISK                                         CER020 CRE073
     F***CLOAN** IP  F    1829  7AI     2 DISK                                         CRE073 CLE134
     F***CLOAN** IP  F    1874  7AI     2 DISK                                         CLE134 CLE141
     FCLOAN   IP  F    2025  7AI     2 DISK                                                   CLE141
     F*                                                                   S01408
     F/COPY WNCPYSRC,LE0480FFP2                                           S01408
     F*                                                                   S01408
0014 F***LOAMS***IF**F     320 14AI     2 DISK                            CLE004
     F***LOAMS***IF  F    1051 14AI     2 DISK                     CLE004 CEU004
     F***LOAMS***IF  F    1066 14AI     2 DISK                     CEU004 CEU020
     F***LOAMS** IF  F    1067 14AI     2 DISK                                         CEU020 CLE028
     F***LOAMS   IF  F    1075 14AI     2 DISK                                         CLE028 CLE031
     F***LOAMS***IF  F    1108 14AI     2 DISK                                         CLE031 CLE034
     F***LOAMS** IF  F    1109 14AI     2 DISK                                         CLE034 CGL029
     F***LOAMS** IF  F    1230 14AI     2 DISK                                         CGL029 CLE036
     F*LOAMS***IF**F****1268 14AI     2 DISK                                           CLE036 CLE042
     FLOAMS   IF  F    1291 14AI     2 DISK                                                   CLE042
0015 F*TABLE***IF**F      96 12AI     2 DISK                              S01194
0016 F*TABLED**IF**F      96 12AI     2 DISK                              S01194
0017 F*CLINT***IF**F     256  7AI     2 DISK                              S01194
     F******SDCURRPDIF  E                    DISK                                      S01194 CSC042
     FSDCURRPDIF  E                    DISK                           UC                      CSC042
     FSDCTRYPDIF  E                    DISK                               S01194
     F/COPY WNCPYSRC,LEH01272
0018 FLVNTXHH O   F     400            DISK
     F*LVNTXELO***F*****400************DISK                               S01220
     F*LVNTXELO***F*****403************DISK                        S01220 S01393
     F***LVNTXEL*O***F     400            DISK                      S01393S01486
     F***LVNTXEL*O***F     405            DISK                     S01486 CLE004
     F***LVNTXEL*O***F     406            DISK                     CLE004 CEU004
     F***LVNTXEL*O***F     409            DISK                     CEU004 163486
     F***LVNTXEL*O***F     410            DISK                     163486 218992
     F***LVNTXEL O   F    1070            DISK                                         218992 CGL029
     F*LVNTXEL*O***F****1124            DISK                                           CGL029 CLE042
     F*LVNTXEL*O   F    1128            DISK                                           CLE042 CLE154
     FLVNTXEL O   F    1129            DISK                                                   CLE154
     F***LVNTXZZ O   F     400            DISK                                             AR1078776
     FLVNTXZZ UF  E                    DISK                      A                         AR1078776
     FEMTE1H1 O   F     128            DISK                      A    U1
     FEMXT1H1 O   F     128            DISK                      A    U1
     FEMTE1E1 O   F     128            DISK                      A    U1
     F***EMXT1D1 O   F     128            DISK                      A    U1                   CER020
     F***EMXT1R1 O   F     128            DISK                      A    U1                   CER020
     FEMXT1D1 O   F     131            DISK                      A    U1                      CER020
     FEMXT1R1 O   F     131            DISK                      A    U1                      CER020
     F***EMTE1T1 O   F     128            DISK                      A    U1                AR1078776
     F***EMXT1T1 O   F     128            DISK                      A    U1                AR1078776
     FEMTE1T1 UF  E                    DISK                      A    U1                   AR1078776
     FEMXT1T1 UF  E                    DISK                      A    U1                   AR1078776
0019 F*E0480P1O***F     132            PRINTER                      S01124S01117
0019 FLE0480AUO   F     132            PRINTER                            S01117
     F***SDPORTL1IF**E                    DISK                                       131273 CLE075AF
     F*                                                                   S01408
     FSDYLDRL1IF  E           K        DISK                                                   CAS008
      ** Yield Rates File                                                                     CAS008
      *                                                                                       CAS008
     FCLONCLL1IF  E           K        DISK                                                   CER049
      ** Loans extension file                                                                 CER049
      *                                                                                       CER049
     FLE0480PDIF  E           K        DISK                                                   262545
     FCLOANE  IF  E           K        DISK                                                 MD021605
     F            CLOANHHF                          KIGNORE                                 MD021605
     F            CLOANCLF                          KIGNORE                                 MD021605
     F            CLOANCKF                          KIGNORE                                 MD021605
     F            CLOANZ1F                          KRENAMELELWNECZ                         MD021605
     FCLOANC  IF  E           K        DISK                                                 MD021605
     F            CLOANHHF                          KIGNORE                                 MD021605
     F            CLOANCLF                          KRENAMECLONCLF                          MD021605
     F            CLOANCKF                          KRENAMECLONCKF                          MD021605
     F            CLOANZ1F                          KIGNORE                                 MD021605
     F***LELWNEPDO   F    1905            DISK                                       MD021605 CLE141
     F***LELWNEPDO   F    2025            DISK                                         CLE141 CER050
     FLELWNEPDO   F    2039            DISK                                                   CER050
     FLELWNEPKO   F    1319            DISK                                                 MD021605
     FLELWNEZ1O   F     400            DISK                                                 MD021605
     F/COPY WNCPYSRC,LE0480FFP1                                           S01408
     F*                                                                   S01408
     FBYRPDTPPIF  E                    DISK                           UC                     LLN022A
      *                                                                                      LLN022A
      ** Bank of England Report/Extract Date                                                 LLN022A
      *                                                                                      LLN022A
0020 F* ID F  C  H  L    FUNCTION OF INDICATORS
0021 F* 01            S/CLOAN - HEADER RECORD
0022 F* 02                    - DETAIL RECORD 'A'
0023 F* 03                    - DETAIL RECORD 'B'
0024 F* 04                    - ASTERISKED RECORD
      *       05      Write on LELWNEPD                                                     MD021605
      *       06      Write on LELWNEPK                                                     MD021605
      *       07      Write on LELWNEZ1                                                     MD021605
     F*       10      S01465 IS SWITCHED ON                               088708
     F*       15      CLE004 is switched on                               CLE004
0025 F*       21      MATURITY DATE OF LOAN = 0
0026 F*       24      NEXT REPAYMENT DATE OF LOAN = 0
0027 F*       25      ROLLOVER DATE OF LOAN = 0
0028 F*       26      NEXT INTEREST DATE OF LOAN =0
0029 F*       27      BASE CCY FOR LIMITS BLANK
     F*       33      SETTLEMENT CURRENCY PRESENT (2 EXTRA EVENTS OUTPUT).CEU004
     F*       34      LOKUP OPERATION SUCCESSFUL FOR NEW EVENT TYPE.      CEU004
     F*       35      CHAIN FAIL/YIELD RATE RECORD NOT FOUND                                  CAS008
0030 F*       40      CONDITIONS FIRST CYCLE PROCESSING
0031 F*       41      WORK INDICATOR - MAIN PROCESSING
      *       42      Cache hit for Base Rate array                                         CLE075AF
      *       43      Cache hit for Yield Curves array                                      CLE075AF
      *       44      Cache hit for Yield Rates array                                       CLE075AF
      *       45      Cache hit for Nostro array                                            CLE075AF
0032 F*       50      EVENT DERIVED FROM LOAN AMENDMENT
0033 F*       51      REPAYMENT TYPE = 1
0034 F*       52                     = 2
0035 F*       53                     = 3
0036 F*       54      INTEREST TO BE CAPITALIZED
0037 F*       55      CHAIN FAIL/DETAIL RECORD NOT FOUND
0038 F*       56      NO (FURTHER) AMENDMENTS FOR GIVEN LOAN
0039 F*       57      LOKUP RESULT INDICATOR
0039 F*       58      LOAN HAS STARTED
0039 F*       59      STOP ACCRUALS INDICATOR SET
0039 F*       60      MATURITY GRATER THAN 30 DAYS AWAY                   S01164
0039 F*       61      EVENT TYPE IS M1, R1, V1 OR V3
0039 F*       62      PROCESSING TYPE 66 OR 67, RECOURSE IND NOT Y
0042 F*       63      EVENTS TO END OF BOOK INDICATOR                     S01164
     F*       64      EVENTS WITH A PORTFOLIO REFERENCE                   S01486
     F*       65      NEW MATURITY DATE TO BE USED FOR EVENTS             088708
     F*       66      DISCOUNTED LOANS, NO INTEREST CAL. REQD.            S01392
     F*       67      Part Purchased linked to Syndication                                  MD049545
0040 F*       70      EFFECTIVE INTEREST RATE OF LOAN < 0
0041 F*       71      INCOMING/OUTGOING INDICATOR = I
0042 F*       72      CUSTOMER IS A PARENT
0042 F*       73      AMENDMENT EVENTS NOT TO BE CREATED                  S01164
0042 F*       74      INTEREST EVENTS NOT TO BE CREATED                   S01164
0042 F*       75      REPAYMENT EVENTS NOT TO BE CREATED                  S01164
0042 F*       76      MATURITY EVENTS NOT TO BE CREATED                   S01164
     F*       77      MATURITY LOCATION CODE IS DETERMINED                S01195
0043 F*       80      WORK INDICATOR - LOWER LEVEL S/ROUTINES
0044 F*       81      IN/OUT = I
0045 F*       82      IN/OUT = O
0046 F*       83-85    WORK INDICATORS - LOWER LEVEL S/ROUTINES
0047 F*       87      WORK INDICATOR - EVENTS S/ROUTINES
0039 F*       U1      EXPOSURE MANAGEMENT MODULE PRESENT
0048 F*       U7      STANDARD MIDAS USAGE
0049 F*       U8      STANDARD MIDAS USAGE
0050 E*
0051 E*    KEY TO TABLES -
0052 E*    TAB1 CONTAINS EVENT CODE(PROCESSING TYPE WITH EVENT TYPE)
0053 E*    TAB2 CONTAINS CORRESPONDING VALUES FOR THOSE OUTPUT FIELDS
0054 E*    DEPENDENT UPON PROCESSING TYPE - 'OTHER DATE','OTHER AMOUNT',
0055 E*    'INSTRUCTIONS INDICATOR','INCOMING/OUTGOING INDICATOR'.
0056 E*    DAT -                               AMT -
0057 E*    1  ZERO                             1  ZERO
0058 E*    2  START                            2  PRINCIPAL
0059 E*    3  MATURITY                         3  INTEREST
0060 E*                                        4  PRINCIPAL REPAYMENT
0061 E*                                        5  INTEREST REPAYMENT
0062 E*                                        6  DISCOUNT AMOUNT
0063 E*
0064 E*    INSTRUCTION INDS -            I/O INDS -
0065 E*     0  0                              BLANK
0066 E*     1  1                          I  I
0067 E*     2  2                          O  O
0068 E*     3  3
0069 E*     4  2/3
0070 E*
     E/COPY ZSRSRC,ZDATE2Z1
0071 E                    POWER   1   7  7 3             POWERS OF 10
0072 E*
     E**************      TAB1    1  50  4   TAB2    4   IN/OUTPUT FIELDS E12000
     E**************      TAB1    1  51  4   TAB2  4IN/OUTPUT FIELDSE12000S01243
     E**************      TAB1    1  54  4   TAB2    4   IN/OUTPUT FS01243E25263
     E**************      TAB1    1  56  4   TAB2    4   IN/OUTPUT FIELDS E25263
     E**************      TAB1    1  59  4   TAB2    4   IN/OUTPUT  S01392080332
     E***********         TAB1    1  62  4   TAB2    4   IN/OUTPUT 080332 CLE004
     E***********         TAB1    1  78  4   TAB2    4             CLE004 CLE006
     E***********         TAB1    1  85  4   TAB2    4             CLE006 124660
     E***********         TAB1    1  99  4   TAB2    4             124660 CLE005
     E***********         TAB1    1 154  4   TAB2    4             CLE005 142393
     E***********         TAB1    1 160  4   TAB2    4             142393 142388
     E**********          TAB1    1 164  4   TAB2    4             142388 190313
     E**********          TAB1    1 168  4   TAB2    4                    190313              CLE028
     E**********          TAB1    1 176  4   TAB2    4                                 CLE028 CAS005
     E**********          TAB1    1 221  4   TAB2    4                                 CAS005 CLE139
     E**********          TAB1    1 231  4   TAB2    4                                 CLE139 CLE134
     E                    TAB1    1 259  4   TAB2    4                                        CLE134
     E                    TABTYP  1   5  1   TABCOD  1   EVENT TYPES      CEU004
0074 E**************      DAT         3  5 0             OTHER DATES      S01392
0075 E**************      AMT         6 13 0             OTHER AMOUNTS    S01392
     E                    DAT         4  5 0             OTHER DATES      S01392
     E                    AMT         7 13 0             OTHER AMOUNTS    S01392
0076 E*
0077 E                    XCYA      150  3               CURRENCIES
0078 E                    XDPA      150  1 0             DEC. PLACES
0079 E                    XSPA      150 13 8             SPOT RATES-BASE
0080 E**********          XMDA      150  1 0             MULT/DIV IND     S01194
0080 E                    XMDA      150  1               MULT/DIV IND     S01194
0081 E                    XSSA      150  2 0             SORT SEQUENCE
0082 E                    XSLA      150 13 8             SPOT RATES-LIMITS
     E                    XINC      150  1               IN CURRENCY IND                      CLE031
     E                    XSPD      150  3 0             SPOT DAYS                            CSC042
0083 E**
     E***********         XCOD      300  2               COUNTRY CODES    056872
     E***********         XREG      300  2               REGION CODES     056872
     E                    XCOD      400  2               COUNTRY CODES    056872
     E                    XREG      400  2               REGION CODES     056872
0086 E**
     E/COPY ZSRSRC,ZFREQBZ1                                               S01392
0092 E***********         HCCY       25  3               HOLIDAY CURENCIESS01195
     E                    CPY@    1   1 80
     E/COPY ZSRSRC,ZHOLE                                                  S01195
     E/COPY ZSRSRC,ZDATE9Z1                                               066550
      *                                                                   CLE033
      * System values array                                                                   CLE033
     E**********          SVAL    1   2 20                                             CLE033 218782
     E                    SVAL    1   3 20                                                    218782
      *                                                                                       CLE033
     E                    #BRT      300 13 0             Base Rate Array                    CLE075AF
     E                    #BRS      300 13 0             Base Rate Sorted                   CLE075AF
     E                    #BRK      300  5               Base Rate Cache Key                CLE075AF
     E                    #YLC      100 13 0             Yield Curve Array                  CLE075AF
     E                    #YCS      100 13 0             Yield Curve Sorted                 CLE075AF
     E                    #YCK      100  5               Yield Curve Cache Key              CLE075AF
     E                    #YLR      300 13 0             Yield Rate Array                   CLE075AF
     E                    #YRS      300 13 0             Yield Rate Sorted                  CLE075AF
     E                    #YRK      300  9               Yield Rate Cache Key               CLE075AF
     E                    #NOS      200 13 0             Nostro Array                       CLE075AF
     E                    #NSS      200 13 0             Nostro Sorted                      CLE075AF
     E                    #NSK      200  5               Nostro Cache Key                   CLE075AF
0093 I*
     E                    ##BR      999  3               Branch codes                         CSC042
     E                    ##BC      999  3               Company codes                        CSC042
     E                    ##BI      999  6               BICN                                 CSC042
      *                                                                                     MD021605
      ** Rename fields.                                                                     MD021605
      *                                                                                     MD021605
     ILELWNECZ                                                                              MD021605
     I              NLRA                            PZNLRA                                  MD021605
     ICLONCLF                                                                               MD021605
     I              RSTM                            RSTMX                                   MD021605
     I              PSTM                            PSTMX                                   MD021605
     ICLONCKF                                                                               MD021605
     I              NLRA                            NLRAX                                   MD021605
0093 I*                                                                                       CSC042
0094 I*    CUSTOMER LENDING LOANS FILE - HEADER RECORD
0095 I*
0096 ICLOAN   NS  01   1 CH
0097 I*
0098 I*    CUSTOMER LENDING LOANS FILE - DETAIL RECORD 1
0099 I*
0100 I        NS  02   1 CD   8 CA
0101 I       OR        1 CM   8 CA
0102 I                                        1   1 RECI
0103 I**********                              2   70LNRF                                      CLE148
     I                                        2   7 LNRF                                      CLE148
0104 I                                        8   8 RCDT
0105 I                                        9   90MRIN
0106 I                                       10  110PTYP
0107 I**********                             12  170CNUM                                      CSD027
0107 I                                       12  17 CNUM                                      CSD027
0108 I***********                            18  200BRCD                  S01117
0108 I                                       18  20 BRCA                  S01117
0109 I                                       21  22 LTYP
0110 I                                       23  24 SUTP
0111 I                                    P  25  270DDAT
0112 I                                    P  28  300VDAT
0113 I                                    P  31  330MDAT            21
0114 I                                       34  350LASQ
0115 I**********                             36  410FCUS                                      CSD027
0115 I                                       36  41 FCUS                                      CSD027
0116 I                                       42  440FTYP
0117 I                                       45  460FSEQ
0118 I                                       47  49 CCY
0119 I                                    P  50  560CPAM
0120 I                                       57  57 INTC
0121 I                                    P  58  637INTR
0122 I                                       64  650BRTT
0123 I                                    P  66  717BRTE
0124 I                                    P  72  777RTSP
0125 I                                    P  78  815MARG
0126 I                                       82  82 SPIN
0127 I                                       83  83 CHIN
0128 I                                    P  84  897WTRT
0129 I                                       90  90 WTIN
0130 I                                       91  910REPT
0131 I                                    P  92  980RAMT
0132 I                                    P  99 1010NRPD            24
0133 I                                      102 102 RFRQ
0134 I                                      103 1040RDYN
0135 I                                      105 107 FCCY
0136 I                                      108 1100LIND
0137 I                                      111 112 CRSK
0138 I                                      113 114 ACOF
0139 I                                      115 115 NACD
0140 I                                      116 116 RELI
0141 I                                      117 117 AUTO
0142 I                                    P 118 1240PSAM
0143 I                                    P 125 1318BCXR
0144 I                                    P 132 1388FCXR
0145 I                                      139 1400SDST
0146 I**********                            141 152 OSDA                                      CGL029
     I                                      141 152 OSDAQQ                                    CGL029
0147 I                                      153 162 TSTN
0148 I*    START SETTLEMENT DETAILS
0149 I**********                            139 162 STARTS                                    CGL029
0150 I*
0151 I                                      163 1640MDST
0152 I**********                            165 176 OMDA                                      CGL029
     I                                      165 176 OMDAQQ                                    CGL029
0153 I                                      177 186 TMAN
0154 I*    MATURITY SETTLEMENT DETAILS
0155 I**********                            163 186 MATURS                                    CGL029
0156 I*
0157 I                                      187 196 FACO
0158 I                                    P 197 1990RLDT            25
0159 I                                    P 200 2020NROD
0160 I                                      203 203 RLFQ
0161 I                                      204 2050RLDY
     I                                      206 206 RDFC                  S01392
0162 I                                      207 2080NBRA
0163 I                                    P 209 2147NRTS
0164 I                                      215 215 NSIN
0165 I                                      216 2160NCAC
0166 I                                    P 217 2230AWTP
0167 I                                    P 224 2300WTRD
0168 I                                    P 231 2370WTWD
0169 I                                    P 238 2440IWOD
0170 I                                    P 245 2510PWOD
0171 I                                      252 252 BMDI
0172 I                                      253 253 FMDI
0173 I                                    P 254 2600PDIN
     I                                      265 267 OSDB                  S01117
     I                                      268 270 OMDB                  S01117
      *                                                                   LN0383
      *** originating branch                                              LN0383
      *                                                                   LN0383
     I                                      271 273 ORBR                  LN0383
      *                                                                   LN0383
0174 I                                      287 287 BTIN
     I/COPY WNCPYSRC,LE0480I005
0175 I                                      288 2890BLDY
     I/COPY WNCPYSRC,LE0480I006
0176 I**********                            290 2950OLNO                                      CSD027
0176 I                                      290 295 OLNO                                      CSD027
0177 I                                      296 296 RCSI
0178 I                                      297 2970ICBS
0179 I                                      298 298 IPFR
0180 I                                    P 299 3050TOTI
0181 I                                    P 306 3080NIDT            26
0182 I                                    P 309 3110IBDT
0183 I                                    P 312 3140SLID
0184 I                                    P 315 3210AIPD
0185 I                                    P 322 3240DLRC
0186 I                                    P 325 3270IACD
0187 I                                    P 328 3340AITC
0188 I                                    P 335 3410TFEP
0189 I                                    P 342 3480AIAP
0190 I                                    P 349 3550IPRD
0191 I                                    P 356 3620IPRM
0192 I                                    P 363 3690ICTD
0193 I                                    P 370 3760AIMN
0194 I                                    P 377 3790RBDT
0195 I                                      382 382 NCHI                                      226261
0195 I                                      384 3850IFDY
0196 I                                      386 386 LONI
0197 I                                      387 387 CNFI
0198 I                                      388 388 ACEI
0199 I                                      389 389 TLXI
0200 I                                      390 390 CBLI
0201 I                                    P 391 3930ORED
0202 I                                    P 394 3960LCD
0203 I                                      397 397 CHTP
0204 I                                    P 398 4000TNLU
     I                                      401 401 ADDI                  S01392
     I                                    P 402 4040ORMD                  S01392
     I                                    P 405 4110ORTI                  S01392
     I                                      435 436 BOKC                  S01220
     I**********                            437 4420COCU                               088708 CSD027
     I**********                            443 4480RECE                               088708 CSD027
     I                                      437 442 COCU                                      CSD027
     I                                      443 448 RECE                                      CSD027
     I                                    P 449 4510OMDT                  088708
     I                                    P 452 4540NIPD                  088708
     I                                    P 455 4570NMDT                  088708
     I                                      458 458 APMI                  088708
     I                                      4591087 LOTA                  088708
     I                                      459 527 LOTA1                                     218992
     I                                      528 733 LOTA2                                     218992
     I                                      734 876 LOTA3                                     218992
     I                                      8771086 LOTA4                                     218992
     I                                     10871087 CVMR                                      218992
     I                                     10881091 PTFR                  S01486
     I                                     10921092 HLEX                  S01486
     I/COPY WNCPYSRC,LE0480I003
     I                                     12001200 PDDI                  144089
     I                                     12011201 PTDI                  133914
     I                                     12061206 LNKS                                    MD049545
     I**********                           12091209 GASS                               CLE004 CLE106
     I                                     12081208 GASS                                      CLE106
     I                                     12641264 LPFI                  CLE004
     I                                     12851287 SCCY                  CEU004
     I                                     12881290 ICCY                  CEU004
     I                                     13011302 RFDY                  CLE011
     I                                     13031303 RFRI                  CLE011
     I                                    P130413097RFRT                  CLE011
     I                                     13101310 RFAR                  CLE011
     I                                     13111315 FSYLDC                                    CAS005
     I                                     13161320 FSFYLD                                    CAS005
     I                                    P132113270FSURPL                                    CAS005
     I                                    P132813340FSPLAM                                    CAS005
     I                                    P133513410FSPLDT                                    CAS005
     I                                    P134213480FSYUPL                                    CAS005
     I                                     13491349 ADIF                                      CLE028
     I                                     13501350 ADCF                                      CLE028
     I                                    P135113570CHGA                                      CLE028
     I                                     13581358 ICIF                                      CLE028
     I                                    P135913650FLTI                                      CLE028
     I                                    P136613680FRPD                                      CLE028
     I                                    P136913750ACCH                                      CLE028
     I                                    P137613820FSEFUP                                    CAS005
     I                                    P138313890FSECUP                                    CAS005
     I                                    P139013960AIPN                                      CAS005
     I                                    P139714030AITN                                      CAS005
     I                                    P140414100AIAN                                      CAS005
     I                                    P141114170IPRN                                      CAS005
     I                                    P141814240AINN                                      CAS005
     I                                    P142514310TOTN                                      CAS005
     I                                    P143214380ICTN                                      CAS005
     I                                    P143914450IWON                                      CAS005
     I                                    P144614520IPNM                                      CAS005
     I                                    P145314590PDNN                                      CAS005
     I                                    P146014660FSCPAM                                    CAS005
     I                                    P146714730FPAM                  CLE031
     I                                    P147414808REXR                  CLE031
     I                                     14811481 REXI                  CLE031
     I                                     14821484 PSCY                  CLE031
     I                                    P148514918PEXR                  CLE031
     I                                     14921492 PEXI                  CLE031
     I                                     14931493 STALC                                     CLE034
     I                                     15611578 OSDA                                      CGL029
     I                                     15791596 OMDA                                      CGL029
     I                                     15971632 LOTA5                                     CGL029
     I************************************P163316387BASR                               CLE036 CLE042
     I************************************P163916447NBSR                               CLE036 CLE042
     I                                    P174617517BASR                                      CLE042
     I                                    P175217577NBSR                                      CLE042
     I                                     17621765 CLAS                                      CLE042
     I                                     17801782 LOIC                                      CER020
     I                                    P178317850OCDT                                      CRE073
     I                                    P178617938EAIR                                      CRE073
     I                                    P179417997CNSP                                      CRE073
     I                                     18001800 CNSG                                      CRE073
     I                                     18011807 RDMT                                      CRE073
     I                                     18081811 RDFD                                      CRE073
     I                                    P181218177NNSP                                      CRE073
     I                                     18181818 NNSG                                      CRE073
     I                                     18191825 NDMT                                      CRE073
     I                                     18261829 NDFD                                      CRE073
      *                                                                                       CLE134
     I                                     18301830 FAMU                                      CLE134
     I                                     18311831 FPNR                                      CLE134
     I                                    P183218340RIDT                                      CLE134
     I                                    P183518360RIDC                                      CLE134
     I                                     183718370RCAT                                      CLE134
     I                                    P183818390RCAC                                      CLE134
     I                                    P184018420RCSD                                      CLE134
     I                                    P184318440RCDY                                      CLE134
     I                                    P184518460RCCY                                      CLE134
      *                                                                                       CLE134
     I                                    P184718490BIDT                                      CLE134
     I                                    P185018510BIDC                                      CLE134
     I                                     185218520BCAT                                      CLE134
     I                                    P185318540BCAC                                      CLE134
     I                                    P185518570BCSD                                      CLE134
     I                                    P185818590BCDY                                      CLE134
     I                                    P186018610BICC                                      CLE134
      *                                                                                       CLE134
     I                                     18621864 XRFI                                      CLE134
     I                                     186518740XRFN                                      CLE134
      *                                                                                       CLE134
     I                                     19061935 PRCUR                                     CLE141
     I                                     19361965 PRLOC                                     CLE141
     I                                     19661995 PICUR                                     CLE141
     I                                     19962025 PILOC                                     CLE141
     I**********                              11874 LONL                             MD021605 CLE141
     I                                        12025 LONL                                      CLE141
0205 I*
0206 I*    CUSTOMER LENDING LOANS FILE - DETAIL RECORD 2
0207 I*
0208 I        NS  03   1 CD   8 CB
0209 I                                        1   1 RECI
0210 I**********                              2   70LNRF                                      CLE148
     I                                        2   7 LNRF                                      CLE148
0211 I                                        8   8 RCDT
0212 I                                        9   90MRIN
0213 I                                       10  44 NAR1
0214 I                                       45  79 NAR2
0215 I                                       80 114 NAR3
0216 I                                      115 149 NAR4
0217 I                                    P 150 1560OPAM
0218 I                                      157 1610FRBC
0219 I                                    P 162 1680YPLN
0220 I                                    P 169 1750YFLN
0221 I                                    P 176 1820YWLN
0222 I                                    P 183 1890ABLN
0223 I                                    P 190 1960YPLC
0224 I                                    P 197 2030YFLC
0225 I                                    P 204 2100YWLC
0226 I                                    P 211 2170ABLC
0227 I                                    P 218 2240WWLN
0228 I                                    P 225 2310IWLN
0229 I                                    P 232 2380PWLN
     I                                      243 2440RDST                  S01392
0230 I                                      245 274 SPI1
0231 I                                      275 304 SPI2
0232 I                                      305 334 SPI3
     I**********                            343 354 ORVD                               S01392 CGL029
     I                                      343 354 ORVDQQ                                    CGL029
     I                                      355 364 THRN                  S01392
     I                                    P 365 3710NPRAM                 S01392
     I                                    P 372 3780NDAM                  S01392
     I                                      379 381 RLBR                  S01392
0233 I*    SPECIAL INSTRUCTIONS
0234 I                                      245 334 SPINS
0235 I*
0236 I                                    P 335 3410YILN
0237 I                                    P 391 3930ORED
0238 I                                    P 394 3960LCD
0239 I                                      397 397 CHTP
0240 I                                    P 398 4000TNLU
     I                                      401 4020RRST                  CEU004
     I                                      401 469 LOTB                  088708
     I                                      401 569 LOTB1                                     218992
     I                                      470 472 NCCY                  CLE006
     I                                    P 473 4790NCPA                  CLE006
     I                                      544 5450RPST                  CEU004
     I                                      541 543 RLSB                                      218992
     I                                      544 749 LOTB2                                     218992
     I                                      750 892 LOTB3                                     218992
     I                                      8931102 LOTB4                                     218992
     I                                     11031103 RCVM                                      218992
     I                                     11121114 RRSC                  CEU004
     I                                     11151117 RPSC                  CEU004
     I                                     11181120 RICY                  CEU004
     I                                     11211121 ECIN                  CEU020
     I                                     112211230RPSM                  CLE031
     I**********                           11241135 RPOS                               CLE031 CGL029
     I                                     11241135 RPOSQQ                                    CGL029
     I                                     11361145 RPTS                  CLE031
     I                                     11461148 RPSB                  CLE031
     I                                     11491158 RFAO                  CLE031
     I                                     11591163 FSFYLB                CLE031
     I                                    P116411708RRSR                  CLE031
     I                                     11711171 RRSI                  CLE031
     I                                    P117211788RPSR                  CLE031
     I                                     11791179 RPSI                  CLE031
     I                                     11801180 RSTA                                      CLE034
     I                                     12481265 ORVD                                      CGL029
     I                                     12661301 LOTB5                                     CGL029
     I                                     13021319 RPOS                                      CGL029
     I                                        11319 LONK                                    MD021605
0241 I*
0242 I*    LOANS FILE '*' RECORD
0243 I*
0244 I        NS  04   1 C*
0245 I*
0246 I*    LOANS FILE - TRAILER
0247 I*
0248 I        NS       1 CT
0249 I                                        1   1 RECI
0250 I**********                              2   70LNRF                                      CLE148
     I                                        2   7 LNRF                                      CLE148
0251 I                                        8   8 RCDT
0252 I                                    P  17  190NORE
0253 I                                    P  20  220FLSZ
0254 I                                    P  23  250NLRB
0255 I                                    P  26  280NINS
0256 I                                    P  29  310NDEL
0257 I                                    P  32  340NLRA
0258 I                                    P  35  420VLBF
0259 I                                    P  43  440VLBL
0260 I                                    P  45  520VRIF
0261 I                                    P  53  540VRIL
0262 I                                    P  55  620VRDF
0263 I                                    P  63  640VRDL
0264 I                                    P  65  720VLAF
0265 I                                    P  73  740VLAL
0266 I                                    P  75  770DTMR
0267 I                                    P  78  800ITMR
0268 I                                    P 394 3960LCD
0269 I                                      397 397 CHTP
0270 I                                    P 398 4000TNLU
0271 I*
0272 I*    CATCH ALL
0273 I*
0274 I        NS
0275 I*
0276 I*    CUSTOMER LENDING LOAN AMENDMENTS FILE - DETAIL
0277 I*
0278 ILOAMS   NS       1 CD
0279 I*    CERTAIN FIELDS APPENDED 'LA' TO DISTINGUISH FROM S/CLOAN FIELDS
0280 I                                        1   1 RECI
0281 I**********                              2   70LNRFLA                                    CLE148
     I                                        2   7 LNRFLA                                    CLE148
0282 I                                        8  120VDATLA
0283 I                                       13  150LASN
0284 I                                       16  160MRIN
0285 I                                       17  18 LTYPLA
0286 I                                       19  20 SUTPLA
0287 I                                       21  220PTYPLA
0288 I                                       23  24 AMTP
0289 I                                       25  260PRSQ
0290 I                                       27  280BRTTLA
0291 I                                    P  29  347RTSPLA
0292 I                                       35  37 CCYLA
0293 I                                    P  38  440PRAM
0294 I                                    P  45  510INTA
0295 I                                    P  52  580WTXA
0296 I                                    P  59  650FEAM
0297 I                                    P  66  720TAMT
0298 I                                       73  750BRCDLA
0299 I**********                             76  810CNUMLA                                    CSD027
0299 I                                       76  81 CNUMLA                                    CSD027
0300 I                                       82  820REPTLA
0301 I                                       83  83 AUTOLA
0302 I                                       84  84 STAI
0303 I                                       85  860SETP
0304 I*********                              87  98 OSAC                                      CGL029
     I                                       87  98 OSACQQ                                    CGL029
0305 I                                       99 108 TSEN
0306 I*    SETTLEMENT DETAILS
0307 I**********                             85 108 AMENDS                                    CGL029
0308 I*
0309 I                                      109 118 FACOLA
0310 I                                      119 148 SPI1
0311 I                                      149 178 SPI2
0312 I                                      179 208 SPI3
0313 I*    SPECIAL INSTRUCTIONS
0314 I                                      119 208 SPINSA
0315 I*
0316 I                                      209 209 LAIN
0317 I                                    P 210 2157BRTE
0318 I                                      216 216 SPIN
0319 I                                      217 2170CALC
0320 I                                      218 218 WTINLA
0321 I                                      219 219 LLAG
0322 I                                      220 220 LWOI
0323 I                                      221 2250XAVD
0324 I                                      226 2280XASQ
0325 I**********                            229 2340FCUSLA                                    CSD027
0325 I                                      229 234 FCUSLA                                    CSD027
0326 I                                      235 2370FTYPLA
0327 I                                      238 2390FSEQLA
0328 I**********                            240 2450RLON                                      CSD027
     I                                      240 245 RLON                                      CSD027
0329 I                                      246 2470FECD
0330 I                                      248 248 PDNI
0331 I                                      249 249 ACTI
0332 I                                      250 250 CNFY
0333 I                                      251 251 TLXY
0334 I                                      252 252 CBLY
0335 I                                      253 253 INTC
     I                                      261 263 OSBR                  S01117
     I*                                                                   S01270
     I**   INCLUSION OF MATURITY DATE FOR CHANGE OF SUB-TYPE FIELD        S01270
     I*                                                                   S01270
     I                                    P 267 2690LSMD                  S01270
     I*                                                                   S01270
0336 I                                    P 311 3130ORED
0337 I                                    P 314 3160LCD
0338 I                                      317 317 CHTP
0339 I                                    P 318 3200TNLU
     I                                      321 389 LOTM1                                     218992
     I                                      390 595 LOTM2                                     218992
     I                                      596 738 LOTM3                                     218992
     I                                      739 948 LOTM4                                     218992
     I                                      949 949 CVMRLA                                    218992
     I                                      975 975 GASS                  CLE004
     I                                      976 976 GPRT1                                     CLE139
     I                                     10611063 SCCY                  CEU004
     I                                     10641066 ICCY                  CEU004
     I                                     10671067 ECIN                  CLE031
     I                                     10681068 REPI                  CLE031
     I                                    P106910750CHDU                                      CLE028
     I                                     107610820INTN                                      CAS005
     I                                     108310890FSPRAM                                    CAS005
     I**********                          P147414808REXRLA                             CLE031 CGL029
     I**********                           14811481 REXILA                             CLE031 CGL029
     I**********                           14821484 PSCYLA                             CLE031 CGL029
     I**********                          P148514918PEXRLA                             CLE031 CGL029
     I**********                           14921492 PEXILA                             CLE031 CGL029
     I**********                           14931493 STALL                              CLE034 CGL029
     I                                    P109010968REXRLA                                    CGL029
     I                                     10971097 REXILA                                    CGL029
     I                                     10981100 PSCYLA                                    CGL029
     I                                    P110111078PEXRLA                                    CGL029
     I                                     11081108 PEXILA                                    CGL029
     I                                     11091109 STALL                                     CGL029
     I                                     11771194 OSAC                                      CGL029
     I                                     11951230 LOTM5                                     CGL029
     I                                     12801283 CLASLA                                    CLE042
0340 I        NS
0341 I                                        1   1 RECI
0342 I**************                                                      S01194
0343 I*****TABLE*FILE - INSTALLATION CONTROL DATA RECORD 1.               S01194
0344 I**************                                                      S01194
0345 I*TABLE***NS***    2 C0   3 C1  12 C1                                S01194
0346 I*******AND****  13 C0                                               S01194
0347 I**************                          1   1 RECI                  S01194
0348 I**************                          2   30RECT                  S01194
0349 I**************                         12  130RCDE                  S01194
0350 I**************                         14  66 TITL                  S01194
0351 I**************                         67  67 DATF                  S01194
0352 I***********                            68  700DFBR                  S01194
0353 I**************                         74  74 MODI1                 S01194
0354 I**************                         75  75 MODI2                 S01194
0355 I**************                         76  76 MODI3                 S01194
0356 I**************                      P  77  790RUND                  S01194
0357 I**************                         80  86 RUNA                  S01194
0358 I**************                         87  870SFLG                  S01194
0359 I**************                      P  90  920LCD                   S01194
0360 I**************                         93  93 CHTP                  S01194
0361 I**************                      P  94  960TNLU                  S01194
0362 I**************                                                      S01194
0363 I*****TABLE*FILE - INSTALLATION CONTROL DATA RECORD 2.               S01194
0364 I**************                                                      S01194
0365 I********NS****   1 CD   2 C0   3 C1                                 S01194
0366 I*******AND****  12 C1  13 C1                                        S01194
0367 I**************                          1   1 RECI                  S01194
0368 I**************                          2   30RECT                  S01194
0369 I**************                         12  130RCDE                  S01194
0370 I**************                         14  16 BCCY                  S01194
0371 I**************                         17  19 BCYL            27    S01194
0372 I**************                         20  22 HOCY                  S01194
0373 I**************                         23  280HEAD                  S01194
0374 I**************                      P  29  310APDA                  S01194
0375 I**************                         35  35 APFQ                  S01194
0376 I**************                      P  36  380LOGS                  S01194
0377 I**************                         39  40 CUZR                  S01194
0378 I**************                      P  41  430DNWD                  S01194
0379 I**************                         44  460BVLP                  S01194
0380 I**************                         47  49 LOCY                  S01194
0381 I**************                         50  510FDAY                  S01194
0382 I**************                         52  52 ACLD                  S01194
0383 I**************                         53  53 MBIN                  S01194
0384 I**************                         86  86 ISAV                  S01194
0385 I**************                      P  87  890LLOG                  S01194
0386 I**************                      P  90  920LCD                   S01194
0387 I**************                         93  93 CHTP                  S01194
0388 I**************                      P  94  960TNLU                  S01194
0389 I**************                                                      S01194
0390 I*****TABLE*FILE*-*HOLIDAY*RECORD.*********                          S01195
0391 I********E-EXCLUDE,*I-INCLUDE.*************                          S01195
0392 I***********                                                         S01195
0393 I********NS*      1 CD   2 C2   3 C2                                 S01195
0394 I*******AND*     14 CE                                               S01195
0395 I*******OR**      1 CD   2 C2   3 C2                                 S01195
0396 I*******AND*     14 CI                                               S01195
0397 I***********                             1   1 RECI                  S01195
0398 I***********                             2   30RECT                  S01195
0399 I***********                             8  120HOL                   S01195
0400 I***********                            13  130SREC                  S01195
0401 I***********                            14  14 INEX                  S01195
0402 I***********                            15  89 HCCY                  S01195
0403 I***********                         P  90  920LCD                   S01195
0404 I***********                            93  93 CHTP                  S01195
0405 I***********                         P  94  960TNLU                  S01195
0406 I**************                                                      S01194
0407 I*****TABLE*FILE - BASE RATE RECORD.                                 S01194
0408 I**************                                                      S01194
0409 I********NS****   1 CD   2 C2   3 C1                                 S01194
0410 I**************                          1   1 RECI                  S01194
0411 I**************                          2   30RECT                  S01194
0412 I**************                          9  11 CCY                   S01194
0413 I**************                         12  130BRTT                  S01194
0414 I**************                      P  14  197BRTE                  S01194
0415 I**************                      P  20  220VDRC                  S01194
0416 I**************                         23  23 RCIN                  S01194
0417 I**************                         24  53 BRTN                  S01194
0418 I**************                      P  54  597NBRT                  S01194
0419 I**************                      P  60  620VDNR                  S01194
0420 I**************                      P  90  920LCD                   S01194
0421 I**************                         93  93 CHTP                  S01194
0422 I**************                      P  94  960TNLU                  S01194
0423 I**************                                                      S01194
0424 I*****CATCH*ALL                                                      S01194
0425 I**************                                                      S01194
0426 I********NS****                                                      S01194
0427 I**************                          1   1 RECI                  S01194
0428 I**************                                                      S01194
0429 I*****TABLE*FILE - CURRENCIES RECORD 1.                              S01194
0430 I**************                                                      S01194
0431 I*TABLED**NS***           2 C2   3 C0                                S01194
0432 I**************                          1   1 RECI                  S01194
0433 I**************                          2   30RECT                  S01194
0434 I**************                         10  12 CCY                   S01194
0435 I**************                         13  130SREC                  S01194
0436 I**************                         14  27 CCNM                  S01194
0437 I**************                      P  28  348SPOT                  S01194
0438 I**************                         35  37 CCYS                  S01194
0439 I**************                         38  380CDP                   S01194
0440 I**************                         39  390TNOT                  S01194
0441 I**************                         40  40 DCCY                  S01194
0442 I**************                         41  44 SRC1                  S01194
0443 I**************                         45  48 SRC2                  S01194
0444 I**************                         49  520TACC                  S01194
0445 I**************                         53  560TEQV                  S01194
0446 I**************                         57  600SWQV                  S01194
0447 I**************                         61  640TAC4                  S01194
0448 I**************                         65  680TAC5                  S01194
0449 I**************                         69  69 HIND                  S01194
0450 I**************                      P  70  768PART                  S01194
0451 I**************                         77  780SSNO                  S01194
0452 I**************                      P  79  858ERLC                  S01194
0453 I**************                         86  860MDIN                  S01194
0454 I**************                         87  870MDIA                  S01194
0455 I**************                         88  880MDIB                  S01194
0456 I**************                      P  90  920LCD                   S01194
0457 I**************                         93  93 CHTP                  S01194
0458 I**************                      P  94  960TNLU                  S01194
0459 I**************                                                      S01194
0460 I*****TABLE*FILE - COUNTRIES RECORD                                  S01194
0461 I**************                                                      S01194
0462 I********NS****          2 C5   3 C0                                 S01194
0463 I**************                          1   1 RECI                  S01194
0464 I**************                          2   30RECT                  S01194
0465 I**************                         12  13 CCOD                  S01194
0466 I**************                         14  43 CNM                   S01194
0467 I**************                         44  45 REGC                  S01194
0468 I**************                         46  480DEPT                  S01194
0469 I**************                      P  49  510DEPX                  S01194
0470 I**************                      P  52  560DEPA                  S01194
0471 I**************                         57  57 DEPF                  S01194
0472 I**************                      P  58  600DEPR                  S01194
0473 I**************                         61  620DLRD                  S01194
0474 I**************                         63  650FRXT                  S01194
0475 I**************                      P  66  680FRXX                  S01194
0476 I**************                      P  69  730FRXA                  S01194
0477 I**************                         74  74 FRXF                  S01194
0478 I**************                      P  75  770FRXR                  S01194
0479 I**************                         78  790FLRD                  S01194
0480 I**************                      P  90  920LCD                   S01194
0481 I**************                         93  93 CHTP                  S01194
0482 I**************                      P  94  960TNLU                  S01194
0483 I**************                                                      S01194
0238 I**************                                                S01164S01194
0239 I*****TABLE*FILE - INSTALLATION CONTROL DATA RECORD 6.         S01164S01194
0240 I**************                                                S01164S01194
0241 I********NS**10   1 CD   2 C0   3 C1                           S01164S01194
0242 I*******AND****  12 C5  13 C0                                  S01164S01194
0243 I**************                          1   1 RECI            S01164S01194
0244 I**************                          2   30RECT            S01164S01194
0245 I**************                         12  130RCDE            S01164S01194
     I**************                         14  14 BTIN            S01164S01194
     I**************                         15  160BDAY            S01164S01194
     I**************                      P  17  180PDUE1           S01164S01194
     I**************                      P  19  200PDUE2           S01164S01194
     I**************                      P  21  220PDUE3           S01164S01194
     I**************                      P  23  240PDUE4           S01164S01194
     I**************                      P  25  260PDUE5           S01164S01194
     I**************                      P  27  280PDUE6           S01164S01194
     I**************                      P  29  300PDUE7           S01164S01194
     I**************                      P  31  320PDUE8           S01164S01194
0246 I**************                      P  33  380LARG            S01164S01194
0247 I**************                         39  39 BRLF            S01164S01194
0248 I**************                      P  40  420ELAP            S01164S01194
0247 I**************                         43  43 EEOB            S01164S01194
0249 I**************                      P  90  920LCD             S01164S01194
0250 I**************                         93  93 CHTP            S01164S01194
0251 I**************                      P  94  960TNLU            S01164S01194
0342 I**************                                                S01164S01194
0484 I*****CATCH*ALL                                                      S01194
0485 I**************                                                      S01194
0486 I********NS****                                                      S01194
0487 I**************                          2   30RECT                  S01194
0488 I**************                                                      S01194
0489 I*****CLIENT*FILE - CUSTOMER STANDING DATA RECORD.                   S01194
0490 I**************                                                      S01194
0491 I*CLINT***NS***    1 CD   8 CA                                       S01194
0492 I**************                          1   1 RECI                  S01194
0493 I**************                          2   70CNUM                  S01194
0494 I**************                          8   8 RCDT                  S01194
0495 I**************                          9  28 CRNM                  S01194
0496 I**************                         29  38 CTWN                  S01194
0497 I**************                         39  48 CSNM                  S01194
0498 I**************                         49  56 CASK                  S01194
0499 I**************                         57  68 TELX                  S01194
0500 I**************                         69  80 CSID                  S01194
0501 I**************                         81  82 ACOC                  S01194
0502 I**************                         83  83 CBSI                  S01194
0503 I**************                         84  85 CCTZ                  S01194
0504 I**************                         86  87 CLOC                  S01194
0505 I**************                         88  930CPAR                  S01194
0506 I*****FOLLOWING FIELD RENAMED TO AVOID CONFUSION WITH S/CLOAN        S01194
0507 I**************                         94  960BRCDCL                S01194
0508 I**************                                                      S01194
0509 I**************                         97  980LINS                  S01194
0510 I***RENAMED*FIELD                                                    S01194
0510 I**************                         99 1010LIND                  S01194
0510 I**************                         99 1010LIND1                 S01194
0511 I**************                      P 102 1040DASU                  S01194
0512 I**************                      P 105 1070CDIC                  S01194
0513 I**************                      P 108 1100DADE                  S01194
0514 I**************                        111 111 CMIN                  S01194
0515 I**************                        112 112 CTYP                  S01194
0516 I**************                        113 124 TELF                  S01194
0517 I**************                        125 133 CHID                  S01194
0518 I**************                        134 136 CHAB                  S01194
0519 I**************                      P 250 2520LCD                   S01194
0520 I**************                        253 253 CHTP                  S01194
0521 I**************                      P 254 2560TNLU                  S01194
0522 I**************                                                      S01194
0523 I*****CATCHALL*                                                      S01194
0524 I**************                                                      S01194
0525 I********NS****                                                      S01194
0526 I**************                          1   1 RECI                  S01194
     I*                                                                   S01194
     ISDCURRD0                                                            S01194
     I              A6CYCD                          CCY                   S01194
     I              A6NBDP                          CDP                   S01194
     I              A6ERLC                          ERLC                  S01194
     I              A6MDIN                          MDIN                  S01194
     I              A6SPRT                          SPOT                  S01194
     I              A6SSNB                          SSNO                  S01194
     I              A6INCY                          INCY                  CLE031
     I*                                                                   S01194
     ISDCTRYD0                                                            S01194
     I              A4CNCD                          CCOD                  S01194
     I              A4RGCD                          REGC                  S01194
      *                                                                                    AR1078776
      ** Rename LVNTXZZ fields                                                             AR1078776
      *                                                                                    AR1078776
     ILVENTZZF                                                                             AR1078776
     I              RECI                            LRECI                                  AR1078776
     I              NORE0                           LNORE0                                 AR1078776
     I              HRWN                            LHRWN                                  AR1078776
     I              HRDC                            LHRDC                                  AR1078776
      *                                                                                    AR1078776
      ** Rename EMTE1T1 fields                                                             AR1078776
      *                                                                                    AR1078776
     IEMTE1T1F                                                                             AR1078776
     I              RECI                            TRECI                                  AR1078776
     I              MCUN                            TMCUN                                  AR1078776
     I              RECJ                            TRECJ                                  AR1078776
     I              NONE                            TNONE                                  AR1078776
     I/COPY WNCPYSRC,LE0480I002
0527 I*
0528 I*    DATA STRUCTURE FOR S/LVNTX OUTPUT KEYS
0529 I*
0530 I            DS
0531 I                                        1   4 EVCODE
0532 I                                        1   20PTYP
0533 I                                        3   4 EVTYPE
0534 I                                        5   8 KEYDS
0535 I                                        5   50ED
0536 I                                        6   60EA
0537 I                                        7   70INSIND
0538 I                                        8   8 INOUT
0539 I*
0540 I*    DATA STRUCTURE FOR 'OTHER DATE' ARRAY
0541 I*
0542 I            DS
0543 I************                            1  15 DAT                   S01392
     I                                        1  20 DAT                   S01392
0544 I                                        1   50ZERO05
0545 I                                        6  100VDAT
0546 I                                       11  150MDAT
     I                                       16  200NROD                  S01392
0547 I*
0548 I*     DATA STRUCTURE FOR 'OTHER AMOUNT' ARRAY
0549 I*
0550 I            DS
0551 I************                            1  78 AMT                   S01392
     I                                        1  91 AMT                   S01392
0552 I                                        1  130ZERO13
0553 I                                       14  260CPRINC
0554 I                                       27  390INTDUE
0555 I                                       40  520REAMT
0556 I                                       53  650REINT
0557 I                                       66  780TOTI
     I                                       79  910NPRAM                 S01392
0558 I*
0559 I*    DATA STRUCTURE FOR SETTLEMENT DETAILS
0560 I*
0561 I            DS
0562 I**********                              1  24 SETTLE                                    CGL029
     I                                        1  30 SETTLE                                    CGL029
0563 I                                        1   20SETTYP
0564 I**********                              3  14 SETAC                                     CGL029
0565 I**********                             15  24 SETNOS                                    CGL029
     I                                        3  20 SETAC                                     CGL029
     I                                       21  30 SETNOS                                    CGL029
     I*                                                                                      BUG9175
     I            DS                                                                         BUG9175
     I                                        1  30 EMUSTI                                   BUG9175
     I                                        1   20EMSTYP                                   BUG9175
     I                                        3  20 EMSTAC                                   BUG9175
     I                                       21  30 EMSNOS                                   BUG9175
      *                                                                                       CGL029
      ** Data Structure for Start Settlement Details                                          CGL029
      *                                                                                       CGL029
     I            DS                                                                          CGL029
     I                                        1  30 STARTS                                    CGL029
     I                                        1   20SDST                                      CGL029
     I                                        3  20 OSDA                                      CGL029
     I                                       21  30 TSTN                                      CGL029
      *                                                                                       CGL029
      ** Data Structure for Maturity Settlement Details                                       CGL029
      *                                                                                       CGL029
     I            DS                                                                          CGL029
     I                                        1  30 MATURS                                    CGL029
     I                                        1   20MDST                                      CGL029
     I                                        3  20 OMDA                                      CGL029
     I                                       21  30 TMAN                                      CGL029
      *                                                                                       CGL029
      ** Data Structure for Events Settlement Details                                         CGL029
      *                                                                                       CGL029
     I            DS                                                                          CGL029
     I                                        1  30 AMENDS                                    CGL029
     I                                        1   20SETP                                      CGL029
     I                                        3  20 OSAC                                      CGL029
     I                                       21  30 TSEN                                      CGL029
     I/COPY WNCPYSRC,LE0480I004
0566 I**************                                                      S01194
0567 I*****DATA*STRUCTURE FOR KEY TO S/TABLE - CURRENCIES                 S01194
0568 I**************                                                      S01194
0569 I************DS                                                      S01194
0570 I**************                          1  12 CCYKEY                S01194
0571 I**************                          9  11 XCCY                  S01194
0572 I**************                                                      S01194
0573 I*****DATA*STRUCTURE FOR KEY TO S/TABLE - COUNTRIES                  S01194
0574 I**************                                                      S01194
0575 I************DS                                                      S01194
0576 I**************                          1  12 CRYKEY                S01194
0577 I**************                         11  12 XCRY                  S01194
0578 I**************                                                      S01194
0579 I*****DATA*STRUCTURE FOR KEY TO S/TABLE - BASE RATES                 S01194
0580 I**************                                                      S01194
0581 I************DS                                                      S01194
0582 I**************                          1  12 BRTKEY                S01194
0583 I**************                          8  10 CCY                   S01194
0584 I*
0585 I*    DATA STRUCTURE - CUSTOMER/PARENT DETAILS
0586 I*
0587 I            DS
0588 I                                        1  38 CSTDET
0589 I                                        1  20 CRNM
0590 I                                       21  30 CTWN
0591 I                                       31  38 CASK
0592 I*
0593 I*    DATA STRUCTURE FOR KEY TO S/LOAMS
0594 I*
0595 I            DS
0596 I                                        1  14 LMSSET
0597 I**********                              1   60LNRF                                      CLE148
     I                                        1   6 LNRF                                      CLE148
     I*                                                                   S01392
     I**   DATA STRUCTURE FOR ROLLOVER DETAILS                            S01392
     I*                                                                   S01392
     I            DS                                                      S01392
     I**********                              1  24 ROLLOS                             S01392 CGL029
     I                                        1  30 ROLLOS                                    CGL029
     I                                        1   20RDST                  S01392
     I**********                              3  14 ORVD                               S01392 CGL029
     I**********                             15  24 THRN                               S01392 CGL029
     I                                        3  20 ORVD                                      CGL029
     I                                       21  30 THRN                                      CGL029
0598 I*
0599 I*    LDA - DIAGNOSTIC FOR PROGRAM ABORT
0600 I*
0601 ILDA        UDS                            256
0602 I***********                           134 138 DBFILE                S01117
0603 I***********                           139 167 DBKEY                 S01117
0604 I***********                           168 175 DBPGM                 S01117
0605 I***********                           176 1770DBASE                 S01117
     I                                      134 141 DBFILE                S01117
     I                                      142 170 DBKEY                 S01117
     I                                      171 180 DBPGM                 S01117
     I                                      181 1830DBASE                 S01117
     I*                                                                   S01194
     ISDBANK    E DSSDBANKPD                                              S01194
      **  EXTERNAL DS FOR BANK DETAILS                                    S01194
     I              BJCYCD                          BCCY                  S01194
     I              BJDFIN                          DATF                  S01194
     I              BJDNWD                          DNWD                  S01194
     I              BJMRDT                          RUNA                  S01194
     I              BJRDNB                          RUND                  S01194
     I              BJURPT                          TITL                  S01194
     I**                                                                  S01194
     ISDBRCH    E DSSDBRCHPD                                              S01117
      **  EXTERNAL DS FOR BRANCH CODE DETAILS                             S01117
     I              A8CMCD                          CMPYM                 S01117
     I              A8BICN                          BICN                  S01117
     I*                                                                   S01194
     I***SDBSRT****E DSSDBSRTPD                                                      S01194 CLE075AF
     ISDBSRT    E DSSDBSRTPD                300                                             CLE075AF
      **  EXTERNAL DS FOR BASE RATE DETAILS                               S01194
     I              BANBRT                          NBRT                  S01194
     I              BAVDNR                          VDNR                  S01194
     I**                                                                  S01194
     I*                                                                   S01194
     ISDCLND    E DSSDCLNDPD                                              S01194
      **  EXTERNAL DS FOR CUSTOMER LENDING DETAILS                        S01194
     I              BPGEEB                          EEOB                  S01194
     I**                                                                  S01194
     I**                                                                  S01194
     I**                                                                  S01194
     I*                                                                   S01194
      *                                                                                     CLE075AF
      ** SDPORTPD Data Structure                                                            CLE075AF
      *                                                                                     CLE075AF
     ISDPORT    E DSSDPORTPD                                                                CLE075AF
      *                                                                                     CLE075AF
      ** SDYLDRPD Data Structure for LRU Caching                                            CLE075AF
      *                                                                                     CLE075AF
     ISDYLDR    E DSSDYLDRPD                300                                             CLE075AF
     I              FSRECI                          YRRECI                                  CLE075AF
     I              FSYLDC                          YRYLDC                                  CLE075AF
     I              FSCHTP                          YRCHTP                                  CLE075AF
     I              FSZONE                          YSZONE                                  CLE075AF
     I              FSFRNT                          YSFRNT                                  CLE075AF
     I              FSTMST                          YSTMST                                  CLE075AF
      *                                                                                     CLE075AF
     I/COPY WNCPYSRC,LE0480I001
     ISDCUST    E DSSDCUSTPD                                              S01194
      **  EXTERNAL DS FOR CUSTOMER DETAILS                                S01194
     I              BBCOLC                          CLOC                  S01194
     I              QQDFAC                          DFACBK                                    CGL029
     I**                                                                  S01194
     I*                                                                   S01194
     ISDDEAL    E DSSDDEALPD                                              S01194
      **  EXTERNAL DS FOR DEALING DATA                                    S01194
     I              BNCYCD                          BCYL                  S01194
     I              QQACCD                          ACCDB1                                    CGL029
     I**                                                                  S01194
     I*                                                                   S01194
     ISDGELR    E DSSDGELRPD                                              S01194
      **  EXTERNAL DS FOR GENERAL LEDGER DETAILS                          S01194
     I******        BKAPDT                          APDA         S01194   S01392
     I*                                                                   S01194
     ISDMMOD    E DSSDMMODPD                                              S01194
      **  EXTERNAL DS FOR MIDAS MODULE DETAILS                            S01194
     I**                                                                  S01194
     I***SDNOST****E DSSDNOSTPD                                                      S01195 CLE075AF
     ISDNOST    E DSSDNOSTPD                200                                             CLE075AF
      **  EXTERNAL DS FOR NOSTRO DETAILS                                  S01195
     I              A7NOSN                          CSNM                  S01195
     I              QQACCD                          ACCDB2                                    CGL029
     I*                                                                   088708
     ISCSARD    E DSSCSARDPD                                              088708
     I**  SAR File Details Accessed via Access Program AOSARDR0           088708
     I***********                                                                      CLE033 222373
     I*SDSVAL***E DSSDSVALPD                                                           CLE033 222373
     I****EXTERNAL DS FOR SYSTEM VALUES                                                CLE033 222373
     **                                                                                       CLE034
     ILESTAL    E DSLESTALPD                                                                  CLE034
      **  EXTERNAL DS FOR SETTLEMENT ALLOCATION DETAILS                                       CLE034
     I              LNRF                            STLNRF                                    CLE034
     I              VDAT                            STVDAT                                    CLE034
     I              LASQ                            STLASQ                                    CLE034
     I              PYBA                            STPYBA                                    CLE038
     I              PYAM                            STPYAM                                    CLE038
     I              RCBA                            STRCBA                                    CLE038
     I              RCAM                            STRCAM                                    CLE038
     I              CCY                             STCCY                                     CLE038
     I                                       84 152 LOTS1                                     218992
     I                                      174 379 LOTS2                                     218992
     I                                      380 522 LOTS3                                     218992
     I                                      523 732 LOTS4                                     218992
     I                                      766 801 LOTS5                                     CGL029
     **                                                                                       CLE034
     I*                                                                   S01194
     I***SDYLDC    E DSSDYLDCPD                                                      CAS005 CLE075AF
     ISDYLDC    E DSSDYLDCPD                100                                             CLE075AF
     I              FSYLDCA                         FYLDCA                                    CRE026
      *                                                                                       CAS005
      **  External DS for Midas Yield Curves Master File                                      CAS005
      *                                                                                       CAS005
      * SDCURR no longer needed. This was just used to get the field                          CSC042
      * A6SPDY which is available using CCYDSP SR                                             CSC042
     I********SDCURR****E*DSSDCURRPD                                                   CAS005 CSC042
      *************************                                                        CAS005 CSC042
      **  External DS for Midas SD Currency Codes                                      CAS005 CSC042
      *************************                                                        CAS005 CSC042
     IDSFDY     E DSDSFDY                                                 S01194
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01194
     I*                                                                   S01194
     IDSSDY     E DSDSSDY                                                 S01194
     I* SECOND DS FOR ACCESS PROGRAMS, LONG DATA STRUCTURE                S01194
     I*                                                                   S01194
     IDSLDY     E DSDSLDY                                                                     220738
     I*  THIRD DS FOR ACCESS PROGRAMS, VERY LONG DATA STRUCTURE                               220738
      **                                                                  S01195
     IDSCSNM      DS                             10                       S01195
      ** DATA AREA FOR THE LOCATION CODE IN CUSTOMER SHORTNAME FIELD      S01195
     I                                        8  10 NRLC                  S01195
     ISDSTPD    E DSSDSTPDPD                                                                  CER049
      *                                                                                       CER049
     ISDACCT    E DSACCNTAB                                                                   CER049
     I              RECI                            ACRECI                                    CER049
     I              BRCA                            ACBRCA                                    CER049
     I              CNUM                            ACCNUM                                    CER049
     I              LCD                             ACLCD                                     CER049
     I              TMST                            ACTMST                                    CER049
     I              PTFR                            ACPTFR                                 AR1092898
      ** Account Details                                                                      CER049
     I              'LECalcBasis6LeapYear'C         WPARML                                  MD035545
      **                                                                  S01195
     I/COPY ZSRSRC,ZHOLI                                                  S01195
     I/COPY ZSRSRC,ZINTDYZ1                                               066550
     I/COPY ZSRSRC,ZDATE9Z2                                               066550
     I/COPY ZSRSRC,ZDAT10Z1                                               126017
      *                                                                   S01195
     C**********           MOVEACPY@      BIS@   80                                           CSC042
0606 C********************************************************************
      *                                                                                     MD021605
      ** Entry parameter                                                                    MD021605
      *                                                                                     MD021605
     C           *ENTRY    PLIST                                                            MD021605
     C                     PARM           RERUN   1                                         MD021605
      *                                                                                     MD021605
     C           WKLON     KLIST                                                            MD021605
     C                     KFLD           WALON   6                                         MD021605
     C                     KFLD           WEPAR   1                                         MD021605
      *                                                                                     MD021605
     C           WLOAN     KLIST                                                            MD021605
     C                     KFLD           LNRF                                              MD021605
     C                     KFLD           RCDT                                              MD021605
      *                                                                                     MD021605
0607 C**   FIRST CYCLE PROCESSING
0608 C   40                GOTO DETAIL
      *                                                                                     MD021605
      ** Initialize fields.                                                                 MD021605
      *                                                                                     MD021605
     C                     MOVE '1'       WIN89   1                                         MD021605
     C                     MOVE 'T'       PDRECI  1                                         MD051219
     C                     MOVE '999999'  PDLNRF  6                                         MD051219
     C                     MOVE 'Z'       PDRCDT  1                                         MD051219
     C                     Z-ADD1         PDNORE  50                                        MD051219
     C                     Z-ADD0         PDNINS  50                                        MD051219
     C                     Z-ADD1         PZNLRA                                            MD051219
     C                     Z-ADDRUND      PDLCD   50                                        MD051219
     C                     MOVE 'I'       PDCHTP  1                                         MD051219
     C                     Z-ADD0         PDFLSZ  50                                        MD021605
     C                     Z-ADD0         PDNLRB  50                                        MD021605
     C                     Z-ADD0         PDNDEL  50                                        MD021605
     C                     Z-ADD0         PDVLBF 150                                        MD021605
     C                     Z-ADD0         PDVLBL  30                                        MD021605
     C                     Z-ADD0         PDVRDF 150                                        MD021605
     C                     Z-ADD0         PDVRDL  30                                        MD021605
     C                     Z-ADD0         PDDTMR  50                                        MD021605
     C                     Z-ADD0         PDITMR  50                                        MD021605
0609 C                     SETON                     40
     C                     MOVEACPY@      BIS@   80                                           CSC042
0610 C**
0611 C                     MOVE 'LE0480'  DBPGM
     C                     Z-ADD0         ##BNDX  40                                          CSC042
     C           *LIKE     DEFN ##BNDX    B                                                   CSC042
     C           *LIKE     DEFN ##BNDX    ##BSV                                               CSC042
0612 C**
0613 C                     EXSR ZSYSTM
0614 C***99*********       SETON                     U7U8  **DATABASE 01**S01194
0615 C***99*********       Z-ADD1         DBASE                           S01194
0616 C***99*********       MOVE ZTABKY    DBKEY                           S01194
0617 C***99*********       MOVE 'TABLE'   DBFILE                          S01194
0618 C   99                GOTO END
0619 C**
0620 C**   ACCESS ICD 2
0621 C**************       MOVE '11'      ZTABKY                          S01194
0622 C***********ZTABKY    CHAINTABLE                55                   S01194
     C**                                                                  S01194
     C** ACCESS GENERAL LEDGER DETAILS                                    S01194
     C**                                                                  S01194
     C**********           CALL 'AOGELRR0'                                             S01194 CGL029
     C                     CALL 'AOGELRR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C********** SDGELR    PARM SDGELR    DSFDY                                        S01194 CGL029
     C           SDGELR    PARM SDGELR    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANKS                                   S01194
     C                     SETON                     55                   S01194
     C                     END                                            S01194
0623 C**N55******RECI      COMP 'D'                  5555                 S01194
0624 C   55                SETON                     U7U8  **DATABASE 02**
0625 C   55                Z-ADD2         DBASE
     C   55                MOVEL@OPTN     DBKEY                           S01194
     C   55                MOVEL'SDGELRPD'DBFILE                          S01194
0626 C***55*********       MOVE ZTABKY    DBKEY                           S01194
0627 C***55*********       MOVE 'TABLE'   DBFILE                          S01194
0628 C   55                GOTO END
0619 C**                                                                  S01164
0620 C**   ACCESS ICD 6 TO DETERMINE IF EVENTS GEN. REQD TO END OF BOOK   S01164
0621 C**************       MOVE '50'      ZTABKY                    S01164S01194
0622 C***********ZTABKY    CHAINTABLED               55             S01164S01194
     C**                                                                  S01194
     C** ACCESS CUSTOMER LENDING DATA                                     S01194
     C**                                                                  S01194
     C                     CALL 'AOCLNDR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C********** SDCLND    PARM SDCLND    DSFDY                                        S01194 CLE134
     C           SDCLND    PARM SDCLND    DSSDY                                               CLE134
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     SETON                     55                   S01194
     C                     END                                            S01194
0623 C**N55******RECI      COMP 'D'                  5555  *********S01164S01194
     C   55                MOVEL@OPTN     DBKEY            ***************S01194
0624 C   55                SETON                     U7U8  **DATABASE 26**S01164
0625 C***55*********       Z-ADD4         DBASE            *********S01164S01194
0625 C   55                Z-ADD26        DBASE            ***************S01194
     C   55                MOVEL'SDCLNDPD'DBFILE                          S01194
0626 C***55*********       MOVE ZTABKY    DBKEY                     S01164S01194
0627 C***55*********       MOVE 'TABLE'   DBFILE                    S01164S01194
0628 C   55                GOTO END                                       S01164
     C**                                                                  S01194
     C** ACCESS MIDAS MODULE DETAILS                                      S01194
     C**                                                                  S01194
     C                     CALL 'AOMMODR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDMMOD    PARM SDMMOD    DSFDY                           S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     SETON                     U7U8LR***************S01194
     C                     Z-ADD27        DBASE            * DBERROR 27  *S01194
     C                     MOVEL'SDMMODPD'DBFILE           ***************S01194
     C                     GOTO END                                       S01194
     C                     END                                            S01194
     C**                                                                  S01194
     C** ACCESS DEALING DATA                                              S01194
     C**                                                                  S01194
     C           BGDLFX    IFEQ 'Y'                                       103382
     C           BGDLMM    OREQ 'Y'                                       103382
     C**********           CALL 'AODEALR0'                                S01194              CGL029
     C                     CALL 'AODEALR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C********** SDDEAL    PARM SDDEAL    DSFDY                           S01194              CGL029
     C           SDDEAL    PARM SDDEAL    DSSDY                                               CGL029
     C*                                                                   S01194
     C           @RTCD     IFNE *BLANKS                                   S01194
     C                     MOVEL'SDDEALPD'DBFILE           ***************S01194
     C                     MOVEL@OPTN     DBKEY            *** DB 008 ****S01194
     C                     MOVE '008'     DBASE            ***************S01194
     C                     GOTO END                                       S01194
     C                     ELSE                                           S01194
     C           BCYL      COMP *BLANKS                  27               S01194
     C                     END                                            S01194
     C*                                                                   103382
     C*   If dealing not installed, use base currency instead             103382
     C*                                                                   103382
     C                     ELSE                                           103382
     C                     MOVE '1'       *IN27                           103382
     C                     ENDIF                                          103382
      *                                                                                       CER001
      **  Read switchable features file SCSARDPD using access object                          CER001
      **  to determine if switchable feature (ULX004) is switched ON                          CER001
      *                                                                                       CER001
     C                     CALL 'AOSARDR0'                                                    CER001
     C                     PARM *BLANKS   W0RTCD                                              CER001
     C                     PARM '*VERIFY' W0OPTN                                              CER001
     C                     PARM 'ULX004'  W0SARD                                              CER001
     C           SCSARD    PARM SCSARD    DSFDY                                               CER001
     C                     MOVE 'N'       ULX004  1                                           CER001
      *                                                                                       CER001
      **  If feature is on, set up SAR indicator                                              CER001
      *                                                                                       CER001
     C           W0RTCD    IFEQ *BLANKS                                                       CER001
     C                     MOVE 'Y'       ULX004                                              CER001
     C                     ELSE                                                               CER001
      *                                                                                       CER001
      ** else, database error (return code other than *NRF)                                   CER001
      *                                                                                       CER001
     C           W0RTCD    IFNE '*NRF   '                                                     CER001
     C                     MOVEL'LE0480'  DBPGM                                               CER001
     C                     MOVEL'SCSARDPD'DBFILE                                              CER001
     C                     MOVEL'*VERIFY' DBKEY                                               CER001
     C                     Z-ADD98        DBASE                                               CER001
     C                     SETON                     U7U8LR                                   CER001
     C                     GOTO END                                                           CER001
     C                     ENDIF                                                              CER001
     C                     ENDIF                                                              CER001
     C*                                                                   S01408
     C/COPY WNCPYSRC,LE0480CCP1                                           S01408
     C           ULX004    IFEQ 'Y'                                                           CER001
     C   U2                MOVE 'Y'       EEOB                                                CER001
     C                     ENDIF                                                              CER001
     C*                                                                   S01408
     C*                                                                   088708
     C**  Read switchable features file SCSARDPD using access object      088708
     C**  to determine if switchable feature (S01465) is switched ON      088708
     C*                                                                   088708
     C                     CALL 'AOSARDR0'                                088708
     C                     PARM *BLANKS   W0RTCD  7                       088708
     C                     PARM '*VERIFY' W0OPTN  7                       088708
     C                     PARM 'S01465'  W0SARD  6                       088708
     C           SCSARD    PARM SCSARD    DSFDY                           088708
     C                     MOVE '0'       *IN10                           088708
     C*                                                                   088708
     C**  If feature is on, set up SAR indicator  (*IN10)                 088708
     C*                                                                   088708
     C           W0RTCD    IFEQ *BLANKS                                   088708
     C                     MOVE '1'       *IN10                           088708
     C                     ELSE                                           088708
     C*                                                                   088708
     C** else, database error (return code other than *NRF)               088708
     C*                                                                   088708
     C           W0RTCD    IFNE '*NRF   '                                 088708
     C                     MOVEL'LE0480'  DBPGM                           088708
     C                     MOVEL'SCSARDPD'DBFILE           ************   088708
     C                     MOVEL'*VERIFY' DBKEY            * DBERR 28 *   088708
     C                     Z-ADD28        DBASE            ************   088708
     C                     SETON                     U7U8LR               088708
     C                     GOTO END                                       088708
     C                     END                                            088708
     C/COPY WNCPYSRC,LE0480C021
     C*                                                                   CCM002
     C**  Read switchable features file SCSARDPD to determine whether     CCM002
     C**  Citydealer interface for Non-front Office Cashflows is          CCM002
     C**  installed (CCM002).                                             CCM002
     C*                                                                   CCM002
     C                     CALL 'AOSARDR0'                                CCM002
     C                     PARM *BLANKS   W0RTCD  7                       CCM002
     C                     PARM '*VERIFY' W0OPTN  7                       CCM002
     C                     PARM 'CCM002'  W0SARD  6                       CCM002
     C           SCSARD    PARM SCSARD    DSFDY                           CCM002
     C                     MOVE 'N'       WCITYD  1                       CCM002
     C*                                                                   CCM002
     C**  If feature is on, set up SAR work flag (WCITYD)                 CCM002
     C*                                                                   CCM002
     C           W0RTCD    IFEQ *BLANKS                                   CCM002
     C                     MOVE 'Y'       WCITYD                          CCM002
     C                     ELSE                                           CCM002
     C*                                                                   CCM002
     C** else, database error (return code other than *NRF)               CCM002
     C*                                                                   CCM002
     C           W0RTCD    IFNE '*NRF   '                                 CCM002
     C                     MOVEL'LE0480'  DBPGM                           CCM002
     C                     MOVEL'SCSARDPD'DBFILE           ************   CCM002
     C                     MOVEL'*VERIFY' DBKEY            * DBERR 29 *   CCM002
     C                     Z-ADD29        DBASE            ************   CCM002
     C                     SETON                     U7U8LR               CCM002
     C                     GOTO END                                       CCM002
     C                     END                                            CCM002
     C*                                                                   CCM002
     C                     END                                            CCM002
     C*                                                                   088708
     C                     END                                            088708
      *                                                                   CLE004
      ** Determine if Customer Lending Enhancements - Syndications        CLE004
      ** (CLE004) is installed                                            CLE004
      *                                                                   CLE004
     C                     CALL 'AOSARDR0'                                CLE004
     C                     PARM *BLANKS   W0RTCD  7                       CLE004
     C                     PARM '*VERIFY' W0OPTN  7                       CLE004
     C                     PARM 'CLE004'  W0SARD  6                       CLE004
     C           SCSARD    PARM SCSARD    DSFDY                           CLE004
     C                     MOVE 'N'       CLE004  1                       CLE004
     C                     MOVE '0'       *IN15                           CLE004
      *                                                                   CLE004
      ** If feature is on, set up SAR work flag                           CLE004
      *                                                                   CLE004
     C           W0RTCD    IFEQ *BLANKS                                   CLE004
     C                     MOVE 'Y'       CLE004                          CLE004
     C                     MOVE '1'       *IN15                           CLE004
     C                     ELSE                                           CLE004
      *                                                                   CLE004
      ** else, database error (return code other than *NRF)               CLE004
      *                                                                   CLE004
     C           W0RTCD    IFNE '*NRF   '                                 CLE004
     C                     MOVEL'LE0480'  DBPGM                           CLE004
     C                     MOVEL'SCSARDPD'DBFILE           ************   CLE004
     C                     MOVEL'*VERIFY' DBKEY            * DBERR 30 *   CLE004
     C                     Z-ADD30        DBASE            ************   CLE004
     C                     MOVE '1'       *INU7                           CLE004
     C                     MOVE '1'       *INU8                           CLE004
     C                     MOVE '1'       *INLR                           CLE004
     C                     GOTO END                                       CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE006
      ** Determine if Customer Lending Enhancements - Past Due Accounts   CLE006
      ** (CLE006) is installed                                            CLE006
      *                                                                   CLE006
     C                     CALL 'AOSARDR0'                                CLE006
     C                     PARM *BLANKS   W0RTCD  7                       CLE006
     C                     PARM '*VERIFY' W0OPTN  7                       CLE006
     C                     PARM 'CLE006'  W0SARD  6                       CLE006
     C           SCSARD    PARM SCSARD    DSFDY                           CLE006
     C                     MOVE 'N'       CLE006  1                       CLE006
      *                                                                   CLE006
      ** If feature is on, set up SAR work flag                           CLE006
      *                                                                   CLE006
     C           W0RTCD    IFEQ *BLANKS                                   CLE006
     C                     MOVE 'Y'       CLE006                          CLE006
     C                     ELSE                                           CLE006
      *                                                                   CLE006
      ** else, database error (return code other than *NRF)               CLE006
      *                                                                   CLE006
     C           W0RTCD    IFNE '*NRF   '                                 CLE006
     C                     MOVEL'LE0480'  DBPGM                           CLE006
     C                     MOVEL'SCSARDPD'DBFILE           ************   CLE006
     C                     MOVEL'*VERIFY' DBKEY            * DBERR 31 *   CLE006
     C                     Z-ADD31        DBASE            ************   CLE006
     C                     MOVE '1'       *INU7                           CLE006
     C                     MOVE '1'       *INU8                           CLE006
     C                     MOVE '1'       *INLR                           CLE006
     C                     GOTO END                                       CLE006
     C                     ENDIF                                          CLE006
      *                                                                   CLE006
     C                     ENDIF                                          CLE006
      *                                                                   CLE006
      *                                                                   CLE015
      ** Determine if CLE007 is installed                                 CLE015
      *                                                                   CLE015
     C                     CALL 'AOSARDR0'                                CLE015
     C                     PARM *BLANKS   W0RTCD  7                       CLE015
     C                     PARM '*VERIFY' W0OPTN  7                       CLE015
     C                     PARM 'CLE007'  W0SARD  6                       CLE015
     C           SCSARD    PARM SCSARD    DSFDY                           CLE015
     C                     MOVE 'N'       CLE007  1                       CLE015
      *                                                                   CLE015
      ** If feature is on, set up SAR work flag                           CLE015
      *                                                                   CLE015
     C           W0RTCD    IFEQ *BLANKS                                   CLE015
     C                     MOVE 'Y'       CLE007                          CLE015
     C                     ELSE                                           CLE015
      *                                                                   CLE015
      ** else, database error (return code other than *NRF)               CLE015
      *                                                                   CLE015
     C           W0RTCD    IFNE '*NRF   '                                 CLE015
     C                     MOVEL'LE0480'  DBPGM                           CLE015
     C                     MOVEL'SCSARDPD'DBFILE           ************   CLE015
     C                     MOVEL'*VERIFY' DBKEY            * DBERR 48 *   CLE015
     C                     Z-ADD48        DBASE            ************   CLE015
     C                     MOVE '1'       *INU7                           CLE015
     C                     MOVE '1'       *INU8                           CLE015
     C                     MOVE '1'       *INLR                           CLE015
     C                     GOTO END                                       CLE015
     C                     ENDIF                                          CLE015
      *                                                                   CLE015
     C                     ENDIF                                          CLE015
      *                                                                   CLE015
      ** Determine if Customer Lending Enhancements - Tranche 3           CLE005
      ** (CLE005) is installed                                            CLE005
      *                                                                   CLE005
     C                     CALL 'AOSARDR0'                                CLE005
     C                     PARM *BLANKS   W0RTCD  7                       CLE005
     C                     PARM '*VERIFY' W0OPTN  7                       CLE005
     C                     PARM 'CLE005'  W0SARD  6                       CLE005
     C           SCSARD    PARM SCSARD    DSFDY                           CLE005
     C                     MOVE 'N'       CLE005  1                       CLE005
      *                                                                   CLE005
      ** If feature is on, set up SAR work flag                           CLE005
      *                                                                   CLE005
     C           W0RTCD    IFEQ *BLANKS                                   CLE005
     C                     MOVE 'Y'       CLE005                          CLE005
     C                     ELSE                                           CLE005
      *                                                                   CLE005
      ** else, database error (return code other than *NRF)               CLE005
      *                                                                   CLE005
     C           W0RTCD    IFNE '*NRF   '                                 CLE005
     C                     MOVEL'LE0480'  DBPGM                           CLE005
     C                     MOVEL'SCSARDPD'DBFILE           ************   CLE005
     C                     MOVEL'*VERIFY' DBKEY            * DBERR 42 *   CLE005
     C                     Z-ADD42        DBASE            ************   CLE005
     C                     MOVE '1'       *INU7                           CLE005
     C                     MOVE '1'       *INU8                           CLE005
     C                     MOVE '1'       *INLR                           CLE005
     C                     GOTO END                                       CLE005
     C                     ENDIF                                          CLE005
      *                                                                   CLE005
     C                     ENDIF                                          CLE005
     C/COPY WNCPYSRC,LEH01266
      *                                                                   CEU004
      ** Access SAR details file to see if CEU004 is installed            CEU004
      *                                                                   CEU004
     C                     MOVE 'N'       CEU004  1        Set SAR Flag   CEU004
      *                                                                   CEU004
     C                     CALL 'AOSARDR0'                 Rtv SAR Dtls   CEU004
      *                                                    Input:         CEU004
     C                     PARM '       ' P@RTCD  7        -Return Code   CEU004
     C                     PARM '*VERIFY' P@OPTN  7        -Option        CEU004
     C                     PARM 'CEU004'  P@SARD  6        -SAR No        CEU004
      *                                                    Output:        CEU004
     C           SCSARD    PARM SCSARD    DSFDY            -Format        CEU004
      *                                                                   CEU004
     C           P@RTCD    IFEQ *BLANK                     If Found       CEU004
     C                     MOVE 'Y'       CEU004            Set SAR Flag  CEU004
      *                                                                   CEU004
     C                     ELSE                            Else           CEU004
     C           P@RTCD    IFNE '*NRF   '                   If # NoRecFnd CEU004
     C                     MOVEL'SCSARDPD'DBFILE             Set File     CEU004
     C                     MOVEL'*VERIFY' DBKEY              Set Key      CEU004
     C                     Z-ADD30        DBASE              Set DBase RefCEU004
     C                     SETON                     U7U8LR  Set Inds     CEU004
     C                     GOTO END                          Bypass       CEU004
     C                     ENDIF                            End If        CEU004
     C                     ENDIF                           End If         CEU004
      *                                                                   CEU004
      ** Determine if EMU Multi currency rollover feature                 CEU020
      ** (CEU020) is installed                                            CEU020
      *                                                                   CEU020
     C                     CALL 'AOSARDR0'                                CEU020
     C                     PARM *BLANKS   W0RTCD                          CEU020
     C                     PARM '*VERIFY' W0OPTN                          CEU020
     C                     PARM 'CEU020'  W0SARD                          CEU020
     C           SCSARD    PARM SCSARD    DSFDY                           CEU020
     C                     MOVE 'N'       CEU020  1                       CEU020
      *                                                                   CEU020
      ** If feature is on, set up SAR work flag                           CEU020
      *                                                                   CEU020
     C           W0RTCD    IFEQ *BLANKS                                   CEU020
     C                     MOVE 'Y'       CEU020                          CEU020
     C                     ELSE                                           CEU020
      *                                                                   CEU020
      ** else, database error (return code other than *NRF)               CEU020
      *                                                                   CEU020
     C           W0RTCD    IFNE '*NRF   '                                 CEU020
     C                     MOVEL'LE0480'  DBPGM                           CEU020
     C                     MOVEL'SCSARDPD'DBFILE           ************   CEU020
     C                     MOVEL'CEU020  'DBKEY            * DBERR 46 *   CEU020
     C                     Z-ADD46        DBASE            ************   CEU020
     C                     MOVE '1'       *INU7                           CEU020
     C                     MOVE '1'       *INU8                           CEU020
     C                     MOVE '1'       *INLR                           CEU020
     C                     GOTO END                                       CEU020
     C                     ENDIF                                          CEU020
      *                                                                   CEU020
     C                     ENDIF                                          CEU020
      *                                                                   CLE011
      ** Determine if Rollover Rate Fixing Day Enhancement is installed   CLE011
      *                                                                   CLE011
     C                     CALL 'AOSARDR0'                                CLE011
     C                     PARM *BLANKS   W0RTCD                          CLE011
     C                     PARM '*VERIFY' W0OPTN                          CLE011
     C                     PARM 'CLE011'  W0SARD                          CLE011
     C           SCSARD    PARM SCSARD    DSFDY                           CLE011
     C                     MOVE 'N'       CLE011  1                       CLE011
      *                                                                   CLE011
      ** If feature is on, set up SAR work flag                           CLE011
      *                                                                   CLE011
     C           W0RTCD    IFEQ *BLANKS                                   CLE011
     C                     MOVE 'Y'       CLE011                          CLE011
     C                     ELSE                                           CLE011
      *                                                                   CLE011
      ** else, database error (return code other than *NRF)               CLE011
      *                                                                   CLE011
     C           W0RTCD    IFNE '*NRF   '                                 CLE011
     C                     MOVEL'LE0480'  DBPGM                           CLE011
     C                     MOVEL'SCSARDPD'DBFILE                          CLE011
     C                     MOVEL'CLE011  'DBKEY                           CLE011
     C                     Z-ADD55        DBASE                           CLE011
     C                     MOVE *ON       *INU7                           CLE011
     C                     MOVE *ON       *INU8                           CLE011
     C                     MOVE *ON       *INLR                           CLE011
     C                     GOTO END                                       CLE011
     C                     ENDIF                                          CLE011
      *                                                                   CLE011
     C                     ENDIF                                          CLE011
      *                                                                   CLE011
      *                                                                   CLE031
      ** Determine if Lending Enhancements is                             CLE031
      ** installed                                                        CLE031
     C                     CALL 'AOSARDR0'                                CLE031
     C                     PARM *BLANKS   W0RTCD                          CLE031
     C                     PARM '*VERIFY' W0OPTN                          CLE031
     C                     PARM 'CLE031'  W0SARD                          CLE031
     C           SCSARD    PARM SCSARD    DSFDY                           CLE031
     C                     MOVE 'N'       CLE031  1                       CLE031
      *                                                                   CLE031
      ** If feature is on, set up SAR work flag                           CLE031
      *                                                                   CLE031
     C           W0RTCD    IFEQ *BLANKS                                   CLE031
     C                     MOVE 'Y'       CLE031                          CLE031
     C                     ELSE                                           CLE031
      *                                                                   CLE031
      ** else, database error (return code other than *NRF)               CLE031
      *                                                                   CLE031
     C           W0RTCD    IFNE '*NRF   '                                 CLE031
     C                     MOVEL'LE0480'  DBPGM                           CLE031
     C                     MOVEL'SCSARDPD'DBFILE                          CLE031
     C                     MOVEL'CLE031  'DBKEY                           CLE031
     C                     Z-ADD56        DBASE                           CLE031
     C                     MOVE *ON       *INU7                           CLE031
     C                     MOVE *ON       *INU8                           CLE031
     C                     MOVE *ON       *INLR                           CLE031
     C                     GOTO END                                       CLE031
     C                     ENDIF                                          CLE031
      *                                                                   CLE031
     C                     ENDIF                                          CLE031
      *                                                                   CLE011
      *                                                                   CLE033
      **  Read switchable features file SCSARDPD using access object      CLE033
      **  to determine if switchable feature (CLE033) is switched ON      CLE033
     C                     MOVE 'N'       CLE033  1                       CLE033
      *                                                                   CLE033
     C                     CALL 'AOSARDR0'                                CLE033
     C                     PARM *BLANKS   W0RTCD  7                       CLE033
     C                     PARM '*VERIFY' W0OPTN  7                       CLE033
     C                     PARM 'CLE033'  W0SARD  6                       CLE033
     C           SCSARD    PARM SCSARD    DSFDY                           CLE033
      *                                                                   CLE033
      **  If feature is on, set up CLE033 variable                        CLE033
      *                                                                   CLE033
     C           W0RTCD    IFEQ *BLANKS                                   CLE033
      *                                                                   CLE033
     C                     MOVE 'Y'       CLE033                          CLE033
      *                                                                   CLE033
     C                     CALL 'AOSVALR0'                                CLE033
     C                     PARM *BLANKS   W0RTCD                          CLE033
     C                     PARM SVAL,1    P@OP01 20                       CLE033
     C                     PARM *BLANKS   P@VL01200                       CLE033
     C                     PARM SVAL,2    P@OP02 20                       CLE033
     C                     PARM *BLANKS   P@VL02200                       CLE033
     C**********           PARM *BLANKS   P@OP03 20                                    CLE033 218782
     C                     PARM SVAL,3    P@OP03 20                                           218782
     C                     PARM *BLANKS   P@VL03200                       CLE033
     C                     PARM *BLANKS   P@OP04 20                       CLE033
     C                     PARM *BLANKS   P@VL04200                       CLE033
     C                     PARM *BLANKS   P@OP05 20                       CLE033
     C                     PARM *BLANKS   P@VL05200                       CLE033
     C                     PARM *BLANKS   P@OP06 20                       CLE033
     C                     PARM *BLANKS   P@VL06200                       CLE033
     C                     PARM *BLANKS   P@OP07 20                       CLE033
     C                     PARM *BLANKS   P@VL07200                       CLE033
     C                     PARM *BLANKS   P@OP08 20                       CLE033
     C                     PARM *BLANKS   P@VL08200                       CLE033
     C                     PARM *BLANKS   P@OP09 20                       CLE033
     C                     PARM *BLANKS   P@VL09200                       CLE033
     C                     PARM *BLANKS   P@OP10 20                       CLE033
     C                     PARM *BLANKS   P@VL10200                       CLE033
     C********** SDSVAL    PARM SDSVAL    DSSDY                    CLE033 222373
      *                                                                   CLE033
     C           W0RTCD    IFNE *BLANKS                                   CLE033
     C                     MOVEL'LE0480  'DBPGM                           CLE033
     C                     MOVEL'SDSVALPD'DBFILE           ************   CLE033
     C                     MOVEL'*KEY   ' DBKEY            * DBERR 28 *   CLE033
     C                     Z-ADD28        DBASE            ************   CLE033
     C                     SETON                     U7U8LR               CLE033
     C                     GOTO END                                       CLE033
     C                     ENDIF                                          CLE033
      *                                                                                       218782
      ** Save value of Settlement09Postings in a one character field                          218782
     C                     MOVELP@VL03    SET09   1                                           218782
      *                                                                   CLE033
     C                     ELSE                                           CLE033
      *                                                                   CLE033
      ** else, database error (return code other than *NRF)               CLE033
      *                                                                   CLE033
     C           W0RTCD    IFNE '*NRF   '                                 CLE033
     C                     MOVEL'LE0480'  DBPGM                           CLE033
     C                     MOVEL'SCSARDPD'DBFILE           ************   CLE033
     C                     MOVEL'*VERIFY' DBKEY            * DBERR 27 *   CLE033
     C                     Z-ADD27        DBASE            ************   CLE033
     C                     SETON                     U7U8LR               CLE033
     C                     GOTO END                                       CLE033
     C                     ENDIF                                          CLE033
     C*                                                                   CLE033
     C                     ENDIF                                          CLE033
     C*                                                                   CLE033
     C*                                                                                       CLE034
     C**  Read switchable features file SCSARDPD using access object                          CLE034
     C**  to determine if switchable feature (CLE034) is switched ON                          CLE034
     C*                                                                                       CLE034
     C                     CALL 'AOSARDR0'                                                    CLE034
     C                     PARM *BLANKS   W0RTCD  7                                           CLE034
     C                     PARM '*VERIFY' W0OPTN  7                                           CLE034
     C                     PARM 'CLE034'  W0SARD  6                                           CLE034
     C           SCSARD    PARM SCSARD    DSFDY                                               CLE034
     C**********           MOVE '0'       *IN10                                        CLE034 227100
     C*                                                                                       CLE034
     C**  If feature is on, set up CLE034 indicator                                           CLE034
     C*                                                                                       CLE034
     C           W0RTCD    IFEQ *BLANKS                                                       CLE034
     C                     MOVE 'Y'       CLE034  1                                           CLE034
     C                     ELSE                                                               CLE034
     C                     MOVE 'N'       CLE034                                              CLE034
     C*                                                                                       CLE034
     C** else, database error (if return code other than *NRF)                                CLE034
     C*                                                                                       CLE034
     C           W0RTCD    IFNE '*NRF   '                                                     CLE034
     C                     MOVEL'LE0480'  DBPGM                                               CLE034
     C                     MOVEL'SCSARDPD'DBFILE           ************                       CLE034
     C                     MOVEL'*VERIFY' DBKEY            * DBERR 54 *                       CLE034
     C                     Z-ADD54        DBASE            ************                       CLE034
     C                     SETON                     U7U8LR                                   CLE034
     C                     GOTO END                                                           CLE034
     C                     END                                                                CLE034
     C                     ENDIF                                                              CLE034
      *                                                                                       CLE034
      **  Read switchable features file SCSARDPD using access object                          CLE038
      **  to determine if switchable feature (CLE038) is switched ON                          CLE038
      *                                                                                       CLE038
     C           CLE034    IFEQ 'Y'                                                           CLE038
     C                     CALL 'AOSARDR0'                                                    CLE038
     C                     PARM *BLANKS   W0RTCD  7                                           CLE038
     C                     PARM '*VERIFY' W0OPTN  7                                           CLE038
     C                     PARM 'CLE038'  W0SARD  6                                           CLE038
     C           SCSARD    PARM SCSARD    DSFDY                                               CLE038
      *                                                                                       CLE038
      **  If feature is on, set up CLE038 indicator                                           CLE038
      *                                                                                       CLE038
     C           W0RTCD    IFEQ *BLANKS                                                       CLE038
     C                     MOVE 'Y'       CLE038  1                                           CLE038
     C                     ELSE                                                               CLE038
     C                     MOVE 'N'       CLE038                                              CLE038
      *                                                                                       CLE038
      ** else, database error (if return code other than *NRF)                                CLE038
      *                                                                                       CLE038
     C           W0RTCD    IFNE '*NRF   '                                                     CLE038
     C                     MOVEL'LE0480'  DBPGM                                               CLE038
     C                     MOVEL'SCSARDPD'DBFILE           ************                       CLE038
     C                     MOVEL'CLE038  'DBKEY            * DBERR 60 *                       CLE038
     C                     Z-ADD60        DBASE            ************                       CLE038
     C                     SETON                     U7U8LR                                   CLE038
     C                     GOTO END                                                           CLE038
     C                     ENDIF                                                              CLE038
     C                     ENDIF                                                              CLE038
     C                     ENDIF                                                              CLE038
      *                                                                                       CLE034
      ** Read switchable features file SCSARDPD using access object                           CLE036
      ** to determine if switchable feature (CLE036) is switched ON                           CLE036
      *                                                                                       CLE036
     C                     CALL 'AOSARDR0'                                                    CLE036
     C                     PARM *BLANKS   W0RTCD                                              CLE036
     C                     PARM '*VERIFY' W0OPTN                                              CLE036
     C                     PARM 'CLE036'  W0SARD                                              CLE036
     C           SCSARD    PARM SCSARD    DSFDY                                               CLE036
     C**********           MOVE '0'       *IN10                                        CLE036 227100
      *                                                                                       CLE036
      ** If feature is on, set up CLE036 indicator                                            CLE036
      *                                                                                       CLE036
     C           W0RTCD    IFEQ *BLANKS                                                       CLE036
     C                     MOVE 'Y'       CLE036  1                                           CLE036
     C                     ELSE                                                               CLE036
     C                     MOVE 'N'       CLE036                                              CLE036
      *                                                                                       CLE036
      ** else, database error (if return code other than *NRF)                                CLE036
      *                                                                                       CLE036
     C           W0RTCD    IFNE '*NRF   '                                                     CLE036
     C                     MOVEL'LE0480'  DBPGM                                               CLE036
     C                     MOVEL'SCSARDPD'DBFILE                                              CLE036
     C                     MOVEL'*VERIFY' DBKEY                                               CLE036
     C                     Z-ADD55        DBASE                                               CLE036
     C                     SETON                     U7U8LR                                   CLE036
     C                     GOTO END                                                           CLE036
     C                     ENDIF                                                              CLE036
     C                     ENDIF                                                              CLE036
      *                                                                                       CLE036
     C           *LIKE     DEFN CVMR      CVMRX                                               218992
     C           *LIKE     DEFN RSCY      RSCYX                                               218992
     C           *LIKE     DEFN REXR      REXRX                                               218992
     C           *LIKE     DEFN REXI      REXIX                                               218992
     C           *LIKE     DEFN ROBR      ROBRX                                               218992
     C           *LIKE     DEFN PSCY      PSCYX                                               218992
     C           *LIKE     DEFN PEXR      PEXRX                                               218992
     C           *LIKE     DEFN PEXI      PEXIX                                               218992
     C           *LIKE     DEFN POBR      POBRX                                               218992
     C           *LIKE     DEFN ICCY      ICCYX                                               218992
     C           *LIKE     DEFN OSDB      SVOSDB                                              218992
     C           *LIKE     DEFN OMDB      SVOMDB                                              218992
     C           *LIKE     DEFN OSBR      SVOSBR                                              218992
     C           *LIKE     DEFN RLBR      SVRLBR                                              218992
     C           *LIKE     DEFN RLSB      SVRLSB                                              218992
     C           *LIKE     DEFN LOTA1     SVLTA1                                              218992
     C           *LIKE     DEFN LOTA1     LOTX1                                               218992
     C           *LIKE     DEFN LOTA2     SVLTA2                                              218992
     C           *LIKE     DEFN LOTA2     LOTX2                                               218992
     C           *LIKE     DEFN LOTA3     SVLTA3                                              218992
     C           *LIKE     DEFN LOTA3     LOTX3                                               218992
     C           *LIKE     DEFN LOTA4     SVLTA4                                              218992
     C           *LIKE     DEFN LOTA4     LOTX4                                               218992
     C           *LIKE     DEFN LOTA5     SVLTA5                                              CGL029
     C           *LIKE     DEFN LOTA5     LOTX5                                               CGL029
     C           *LIKE     DEFN LOTB1     SVLTB1                                              218992
     C           *LIKE     DEFN LOTB2     SVLTB2                                              218992
     C           *LIKE     DEFN LOTB3     SVLTB3                                              218992
     C           *LIKE     DEFN LOTB4     SVLTB4                                              218992
     C           *LIKE     DEFN LOTB5     SVLTB5                                              CGL029
     C           *LIKE     DEFN LOTM1     SVLTM1                                              218992
     C           *LIKE     DEFN LOTM2     SVLTM2                                              218992
     C           *LIKE     DEFN LOTM3     SVLTM3                                              218992
     C           *LIKE     DEFN LOTM4     SVLTM4                                              218992
     C           *LIKE     DEFN LOTM5     SVLTM5                                              CGL029
     C           *LIKE     DEFN CVMR      SVCVMR                                              218992
     C           *LIKE     DEFN CVMRLA    SVCVMA                                              218992
     C           *LIKE     DEFN RCVM      SVRCVM                                              218992
     C           *LIKE     DEFN REXR      SWREXR                                              218992
     C           *LIKE     DEFN REXI      SWREXI                                              218992
     C           *LIKE     DEFN PEXR      SWPEXR                                              218992
     C           *LIKE     DEFN PEXI      SWPEXI                                              218992
     C           *LIKE     DEFN REXRLA    SWRXRL                                              218992
     C           *LIKE     DEFN REXILA    SWRXIL                                              218992
     C           *LIKE     DEFN PEXRLA    SWPXRL                                              218992
     C           *LIKE     DEFN PEXILA    SWPXIL                                              218992
     C           *LIKE     DEFN RRSR      SWRRSR                                              218992
     C           *LIKE     DEFN RRSI      SWRRSI                                              218992
     C           *LIKE     DEFN RPSR      SWRPSR                                              218992
     C           *LIKE     DEFN RPSI      SWRPSI                                              218992
     C           *LIKE     DEFN SCCY      SWSCCY                                              218992
     C           *LIKE     DEFN PSCY      SWPSCY                                              218992
     C           *LIKE     DEFN PSCYLA    SWPSYL                                              218992
     C           *LIKE     DEFN RRSC      SWRRSC                                              218992
     C           *LIKE     DEFN RPSC      SWRPSC                                              218992
     C           *LIKE     DEFN LOTX1     SVLTX1                                              221684
     C           *LIKE     DEFN LOTX2     SVLTX2                                              221684
     C           *LIKE     DEFN LOTX3     SVLTX3                                              221684
     C           *LIKE     DEFN LOTX4     SVLTX4                                              221684
     C           *LIKE     DEFN ROBRX     SROBRX                                              221684
     C           *LIKE     DEFN RSCYX     SRSCYX                                              221684
     C           *LIKE     DEFN REXRX     SREXRX                                              221684
     C           *LIKE     DEFN REXIX     SREXIX                                              221684
     C           *LIKE     DEFN POBRX     SPOBRX                                              221684
     C           *LIKE     DEFN CVMRX     SCVMRX                                              221684
     C           *LIKE     DEFN PSCYX     SPSCYX                                              221684
     C           *LIKE     DEFN ICCYX     SIC72X                                              221684
     C           *LIKE     DEFN PEXRX     SPEXRX                                              221684
     C           *LIKE     DEFN PEXIX     SPEXIX                                              221684
     C*                                                                                       218992
      ** Determine if Flat Rate Personal Loans Enhancement is installed                       CLE028
      *                                                                                       CLE028
     C                     MOVE 'N'       CLE028  1                                           CLE028
     C                     CALL 'AOSARDR0'                                                    CLE028
     C                     PARM *BLANKS   W0RTCD                                              CLE028
     C                     PARM '*VERIFY' W0OPTN                                              CLE028
     C                     PARM 'CLE028'  W0SARD                                              CLE028
     C           SCSARD    PARM SCSARD    DSFDY                                               CLE028
      *                                                                                       CLE028
      ** If feature is on, set up SAR work flag                                               CLE028
      *                                                                                       CLE028
     C           W0RTCD    IFEQ *BLANKS                                                       CLE028
     C                     MOVE 'Y'       CLE028                                              CLE028
     C                     ELSE                                                               CLE028
      *                                                                                       CLE028
      ** else, database error (return code other than *NRF)                                   CLE028
      *                                                                                       CLE028
     C           W0RTCD    IFNE '*NRF   '                                                     CLE028
     C                     MOVEL'LE0480'  DBPGM                                               CLE028
     C                     MOVEL'SCSARDPD'DBFILE                                              CLE028
     C                     MOVEL'CLE028  'DBKEY                                               CLE028
     C**********           Z-ADD56        DBASE                                               CLE028
     C                     Z-ADD74        DBASE                                        CLE028 218992
     C                     MOVE *ON       *INU7                                               CLE028
     C                     MOVE *ON       *INU8                                               CLE028
     C                     MOVE *ON       *INLR                                               CLE028
     C                     EXSR *PSSR                                                         CLE028
     C                     ENDIF                                                              CLE028
      *                                                                                       CLE028
     C                     ENDIF                                                              CLE028
      *                                                                                       CLE028
     C                     MOVE 'N'       WCALL   1                                           222972
      *                                                                                       CAS005
      ** Determine if CAS005 enhancement is installed                                         CAS005
      *                                                                                       CAS005
     C                     CALL 'AOSARDR0'                                                    CAS005
     C                     PARM *BLANKS   W0RTCD                                              CAS005
     C                     PARM '*VERIFY' W0OPTN                                              CAS005
     C                     PARM 'CAS005'  W0SARD                                              CAS005
     C           SCSARD    PARM SCSARD    DSFDY                                               CAS005
     C                     MOVE 'N'       CAS005  1                                           CAS005
      *                                                                                       CAS005
      ** If feature is on, set up SAR work flag                                               CAS005
      *                                                                                       CAS005
     C           W0RTCD    IFEQ *BLANKS                                                       CAS005
     C                     MOVE 'Y'       CAS005                                              CAS005
     C                     Z-ADDRUND      WMATD   50                                          CAS005
     C                     ELSE                                                               CAS005
      *                                                                                       CAS005
      ** else, database error (return code other than *NRF)                                   CAS005
      *                                                                                       CAS005
     C           W0RTCD    IFNE '*NRF   '                                                     CAS005
     C                     MOVEL'LE0480'  DBPGM                                               CAS005
     C                     MOVEL'SCSARDPD'DBFILE                                              CAS005
     C                     MOVEL'CAS005  'DBKEY                                               CAS005
     C                     Z-ADD59        DBASE                                               CAS005
     C                     MOVE *ON       *INU7                                               CAS005
     C                     MOVE *ON       *INU8                                               CAS005
     C                     MOVE *ON       *INLR                                               CAS005
     C                     GOTO END                                                           CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
      ** Define Work fields for CAS005 enhancement                                            CAS005
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
      *                                                                                       CAS005
     C           *LIKE     DEFN CCY       WCCY                                                CAS005
     C           *LIKE     DEFN BRTT      WBRTT                                               CAS005
     C           *LIKE     DEFN MDAT      WMDAT                                               CAS005
     C           *LIKE     DEFN IPFR      WIPFR                                               CAS005
     C           *LIKE     DEFN MARG      WMARG                                               CAS005
     C           *LIKE     DEFN MARG      WAVMAR                                              CAS005
     C           *LIKE     DEFN NIDT      WNIDT                                               CAS005
     C           *LIKE     DEFN VDAT      WVDAT                                               CAS005
     C           *LIKE     DEFN SLID      WSLID                                               CAS005
     C           *LIKE     DEFN ICBS      WICBS                                               CAS005
     C           *LIKE     DEFN RTSP      WRTSP                                               CAS005
     C           *LIKE     DEFN SPIN      WSPIN                                               CAS005
     C           *LIKE     DEFN AIPD      WAIPD                                               CAS005
     C           *LIKE     DEFN AIMN      WAIMN                                               CAS005
     C           *LIKE     DEFN IPRD      WIPRD                                               CAS005
     C           *LIKE     DEFN CPAM      WCPAM                                               CAS005
     C           *LIKE     DEFN FSFYLD    WFYLD                                               CAS005
     C           *LIKE     DEFN EVAMNT    WEAMT                                               CAS005
     C           *LIKE     DEFN EVDATE    WEDAT                                               CAS005
     C           *LIKE     DEFN EVDATE    WEDATX                                              CAS005
     C           *LIKE     DEFN EVDATE    WPEDAT                                              CAS005
     C           *LIKE     DEFN EVDATE    W@EDAT                                              CAS005
     C           *LIKE     DEFN INTR      WINTR                                               CAS005
     C           *LIKE     DEFN NIDT      NIDTX                                               CAS005
      *                                                                                       CAS005
      ** Get Event Control Date as the lesser between (Next Working Day - 1)                  CAS005
      ** and Accrual Profit Date                                                              CAS005
      *                                                                                       CAS005
     C           DNWD      SUB  1         WEVCD   50                                          CAS005
      *                                                                                       CAS005
     C           BKAPDT    IFLT WEVCD                                                         CAS005
     C                     Z-ADDBKAPDT    WEVCD                                               CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
      ** Initialise LDA field.                                                                CAS005
      *                                                                                       CAS005
     C           *NAMVAR   DEFN           LDA                                                 CAS005
      *                                                                                       CAS005
      ** Determine if CAS008 enhancement is installed                                         CAS008
      *                                                                                       CAS008
     C                     CALL 'AOSARDR0'                                                    CAS008
     C                     PARM *BLANKS   W0RTCD                                              CAS008
     C                     PARM '*VERIFY' W0OPTN                                              CAS008
     C                     PARM 'CAS008'  W0SARD                                              CAS008
     C           SCSARD    PARM SCSARD    DSFDY                                               CAS008
     C                     MOVE 'N'       CAS008  1                                           CAS008
      *                                                                                       CAS008
      ** If feature is on, set up SAR work flag                                               CAS008
      *                                                                                       CAS008
     C           W0RTCD    IFEQ *BLANKS                                                       CAS008
     C                     MOVE 'Y'       CAS008                                              CAS008
     C                     ELSE                                                               CAS008
      *                                                                                       CAS008
      ** else, database error (return code other than *NRF)                                   CAS008
      *                                                                                       CAS008
     C           W0RTCD    IFNE '*NRF   '                                                     CAS008
     C                     MOVEL'LE0480'  DBPGM                                               CAS008
     C                     MOVEL'SCSARDPD'DBFILE                                              CAS008
     C                     MOVEL'CAS008  'DBKEY                                               CAS008
     C                     Z-ADD57        DBASE                                               CAS008
     C                     MOVE *ON       *INU7                                               CAS008
     C                     MOVE *ON       *INU8                                               CAS008
     C                     MOVE *ON       *INLR                                               CAS008
     C                     GOTO END                                                           CAS008
     C                     ENDIF                                                              CAS008
      *                                                                                       CAS008
     C                     ENDIF                                                              CAS008
      *                                                                                       CRE073
      ** Determine if CRE073 Interest Rate Rounding is installed                              CRE073
      *                                                                                       CRE073
     C                     CALL 'AOSARDR0'                                                    CRE073
     C                     PARM *BLANKS   W0RTCD                                              CRE073
     C                     PARM '*VERIFY' W0OPTN                                              CRE073
     C                     PARM 'CRE073'  W0SARD                                              CRE073
     C           SCSARD    PARM SCSARD    DSFDY                                               CRE073
     C                     MOVE 'N'       CRE073  1                                           CRE073
      *                                                                                       CRE073
      ** If feature is on, set up SAR work flag                                               CRE073
      *                                                                                       CRE073
     C           W0RTCD    IFEQ *BLANKS                                                       CRE073
     C                     MOVE 'Y'       CRE073                                              CRE073
     C                     ELSE                                                               CRE073
      *                                                                                       CRE073
      ** else, database error (return code other than *NRF)                                   CRE073
      *                                                                                       CRE073
     C           W0RTCD    IFNE '*NRF   '                                                     CRE073
     C                     MOVEL'LE0480'  DBPGM                                               CRE073
     C                     MOVEL'SCSARDPD'DBFILE                                              CRE073
     C                     MOVEL'CRE073  'DBKEY                                               CRE073
     C                     Z-ADD80        DBASE                                               CRE073
     C                     MOVE *ON       *INU7                                               CRE073
     C                     MOVE *ON       *INU8                                               CRE073
     C                     MOVE *ON       *INLR                                               CRE073
     C                     GOTO END                                                           CRE073
     C                     ENDIF                                                              CRE073
      *                                                                                       CRE073
     C                     ENDIF                                                              CRE073
      *                                                                                       CER049
      ** Determine if CER049 enhancement is installed                                         CER049
      *                                                                                       CER049
     C                     CALL 'AOSARDR0'                                                    CER049
     C                     PARM *BLANKS   W0RTCD                                              CER049
     C                     PARM '*VERIFY' W0OPTN                                              CER049
     C                     PARM 'CER049'  W0SARD                                              CER049
     C           SCSARD    PARM SCSARD    DSFDY                                               CER049
     C                     MOVE 'N'       CER049  1                                           CER049
      *                                                                                       CER049
      ** If feature is on, set up SAR work flag                                               CER049
      *                                                                                       CER049
     C           W0RTCD    IFEQ *BLANKS                                                       CER049
     C                     MOVE 'Y'       CER049                                              CER049
     C                     ENDIF                                                              CER049
      *                                                                                     CLE075AF
      ** Access SDPORTPD using AOPORTR0 and retrieve its data                               CLE075AF
      *                                                                                     CLE075AF
     C           BGPFMG    IFEQ 'Y'                                                       AR1092898A
     C                     CALL 'AOPORTR0'                                                  CLE075AF
     C**********           PARM *BLANKS   W0RTCD                                 CLE075AF AR1092898A
     C                     PARM '*MSG   ' W0RTCD                                          AR1092898A
     C**********           PARM '*VERIFY' W0OPTN                                 CLE075AF AR1092898A
     C                     PARM '*FIRST ' W0OPTN                                          AR1092898A
     C           SDPORT    PARM SDPORT    DSFDY                                             CLE075AF
      *                                                                                     CLE075AF
     C           W0RTCD    IFNE *BLANKS                                                     CLE075AF
     C                     SETON                     U7U8                                   CLE075AF
     C                     Z-ADD26        DBASE                                             CLE075AF
     C                     MOVE 'SDPORTPD'DBFILE                                            CLE075AF
     C                     MOVEL'NONE'    DBKEY                                             CLE075AF
     C                     GOTO END                                                         CLE075AF
     C                     END                                                              CLE075AF
     C                     ENDIF                                                          AR1092898A
      *                                                                                     CLE075AF
     C/COPY WNCPYSRC,LEH01319
      *                                                                                       CAS008
      ** Determine if CLE134 Past Due Processing is installed                                 CLE134
      *                                                                                       CLE134
     C                     CALL 'AOSARDR0'                                                    CLE134
     C                     PARM *BLANKS   W0RTCD                                              CLE134
     C                     PARM '*VERIFY' W0OPTN                                              CLE134
     C                     PARM 'CLE134'  W0SARD                                              CLE134
     C           SCSARD    PARM SCSARD    DSFDY                                               CLE134
     C                     MOVE 'N'       CLE134  1                                           CLE134
      *                                                                                       CLE134
      ** If feature is on, set up SAR work flag                                               CLE134
      *                                                                                       CLE134
     C           W0RTCD    IFEQ *BLANKS                                                       CLE134
     C                     MOVE 'Y'       CLE134                                              CLE134
     C                     ENDIF                                                              CLE134
      *                                                                                       CLE141
      ** Determine if CLE141 Business Day Convention is installed                             CLE141
      *                                                                                       CLE141
     C                     CALL 'AOSARDR0'                                                    CLE141
     C                     PARM *BLANKS   W0RTCD                                              CLE141
     C                     PARM '*VERIFY' W0OPTN                                              CLE141
     C                     PARM 'CLE141'  W0SARD                                              CLE141
     C           SCSARD    PARM SCSARD    DSFDY                                               CLE141
     C                     MOVE 'N'       CLE141  1                                           CLE141
      *                                                                                       CLE141
      ** If feature is on, set up SAR work flag                                               CLE141
      *                                                                                       CLE141
     C           W0RTCD    IFEQ *BLANKS                                                       CLE141
     C                     MOVE 'Y'       CLE141                                              CLE141
     C                     ENDIF                                                              CLE141
      *                                                                                       CLE134
      ** Retrieve system value setting.                                                     MD035545
      *                                                                                     MD035545
     C                     MOVELWPARML    P@OP01                                            MD035545
     C                     CALL 'AOSVALR0'                                                  MD035545
     C                     PARM *BLANKS   W0RTCD                                            MD035545
     C                     PARM           P@OP01                                            MD035545
     C                     PARM           P@VL01                                            MD035545
     C                     PARM           P@OP02                                            MD035545
     C                     PARM           P@VL02                                            MD035545
     C                     PARM           P@OP03                                            MD035545
     C                     PARM           P@VL03                                            MD035545
     C                     PARM           P@OP04                                            MD035545
     C                     PARM           P@VL04                                            MD035545
     C                     PARM           P@OP05                                            MD035545
     C                     PARM           P@VL05                                            MD035545
     C                     PARM           P@OP06                                            MD035545
     C                     PARM           P@VL06                                            MD035545
     C                     PARM           P@OP07                                            MD035545
     C                     PARM           P@VL07                                            MD035545
     C                     PARM           P@OP08                                            MD035545
     C                     PARM           P@VL08                                            MD035545
     C                     PARM           P@OP09                                            MD035545
     C                     PARM           P@VL09                                            MD035545
     C                     PARM           P@OP10                                            MD035545
     C                     PARM           P@VL10                                            MD035545
      *                                                                                     MD035545
      ** If system value is not found then default value to 'N'.                            MD035545
      *                                                                                     MD035545
     C           W0RTCD    IFNE '       '                                                   MD035545
     C                     MOVE 'N'       WCALC6                                            MD035545
     C                     ELSE                                                             MD035545
     C                     MOVELP@VL01    WCALC6                                            MD035545
     C********** WCALC6    IFEQ 'Y'                                                MD035545 MD047993
     C********** BKALDI    ANDEQ'Y'                                                MD035545 MD047993
     C**********           MOVE 'Y'       WCALC6                                   MD035545 MD047993
     C**********           ELSE                                                    MD035545 MD047993
     C**********           MOVE 'N'       WCALC6                                   MD035545 MD047993
     C**********           ENDIF                                                   MD035545 MD047993
     C                     ENDIF                                                            MD035545
      *                                                                                     MD035545
      *                                                                                       CLE154
      ** Determine if CLE154 enhancement is installed                                         CLE154
      *                                                                                       CLE154
     C                     CALL 'AOSARDR0'                                                    CLE154
     C                     PARM *BLANKS   W0RTCD                                              CLE154
     C                     PARM '*VERIFY' W0OPTN                                              CLE154
     C                     PARM 'CLE154'  W0SARD                                              CLE154
     C           SCSARD    PARM SCSARD    DSFDY                                               CLE154
     C                     MOVE 'N'       CLE154  1                                           CLE154
      *                                                                                       CLE154
      ** If feature is on, set up SAR work flag                                               CLE154
      *                                                                                       CLE154
     C           W0RTCD    IFEQ *BLANKS                                                       CLE154
     C                     MOVE 'Y'       CLE154                                              CLE154
     C                     SETON                     28                                       CLE154
     C                     ELSE                                                               CLE154
      *                                                                                       CLE154
      ** else, database error (return code other than *NRF)                                   CLE154
      *                                                                                       CLE154
     C           W0RTCD    IFNE '*NRF   '                                                     CLE154
     C                     MOVEL'LE0480'  DBPGM                                               CLE154
     C                     MOVEL'SCSARDPD'DBFILE                                              CLE154
     C                     MOVEL'CAS008  'DBKEY                                               CLE154
     C                     Z-ADD76        DBASE                                               CLE154
     C                     MOVE *ON       *INU7                                               CLE154
     C                     MOVE *ON       *INU8                                               CLE154
     C                     MOVE *ON       *INLR                                               CLE154
     C                     GOTO END                                                           CLE154
     C                     ENDIF                                                              CLE154
      *                                                                                       CLE154
     C                     ENDIF                                                              CLE154
     C           KSPOTD    KLIST                                                              CAS008
     C                     KFLD           WFYLD                                               CAS008
     C                     KFLD           WCCY                                                CAS008
     C                     KFLD           WICM                                                CAS008
      *                                                                                       CAS008
     C/COPY WNCPYSRC,LE0480C017
      ** Set End of Book indicator to 'Y' if job switch U2 on (LEC0609RZ)                     CCB016
     C   U2                MOVE 'Y'       EEOB                                                CCB016
0619 C**                                                                  S01164
0620 C**   IF EVENTS TO BE CREATED TO END OF BOOK (EEOB = Y) THEN SET     S01164
0629 C**   ON INDICATOR 63                                                S01164
     C           EEOB      IFEQ 'Y'                                       S01164
     C                     SETON                     63                   S01164
     C                     END                                            S01164
     C**************                                                      S01164
0630 C*****DEFINE*KEY FIELDS                                              S01194
0631 C**************       MOVEL'20'      CCYKEY           CURRENCIES     S01194
0632 C**************       MOVE '1'       CCYKEY                          S01194
0633 C**************                                                      S01194
0634 C**************       MOVEL'50'      CRYKEY           COUNTRIES      S01194
0635 C**************                                                      S01194
0636 C**************       MOVEL'21'      BRTKEY           BASE RATES     S01194
0637 C**************                                                      S01194
0638 C**************       MOVE 'A'       CUSKEY  7        CUSTOMERS      S01194
0639 C**
0640 C**   LOAD CURRENCY ARRAYS & COUNTRY ARRAYS
     C                     SETOF                     96
0641 C                     EXSR CCYARS
     C           *IN96     IFEQ '1'
     C                     SETON                     U7U899**DATABASE 22**
     C                     Z-ADD22        DBASE
     C                     MOVEL'SR.CCYAR'XERROR  9
     C                     MOVE 'S'       XERROR
     C                     MOVELXERROR    DBKEY
     C**************       MOVE 'TABLE'   DBFILE                          S01194
     C                     MOVE 'SDCURRPD'DBFILE                          S01194
     C                     GOTO END
     C                     END
0642 C**
     C                     SETOF                     96
0643 C                     EXSR CRYARS
     C           *IN96     IFEQ '1'
     C                     SETON                     U7U899**DATABASE 23**
     C                     Z-ADD23        DBASE
     C                     MOVEL'SR.CRYAR'XERROR  9
     C                     MOVE 'S'       XERROR
     C                     MOVELXERROR    DBKEY
     C**************       MOVE 'TABLE'   DBFILE                          S01194
     C                     MOVE 'SDCTRYPD'DBFILE                          S01194
     C                     GOTO END
     C                     END
0644 C**
0645 C**   DETERMINE BASE CURRENCY DETAILS
0646 C**************       MOVE BCCY      XCCY                            S01194
0646 C                     MOVE BCCY      XCCY    3                       S01194
0647 C                     EXSR CCYDSP
0648 C   99                SETON                     U7U8  **DATABASE 03**
0649 C   99                Z-ADD3         DBASE
0650 C***99*********       MOVE CCYKEY    DBKEY                           S01194
0651 C***99*********       MOVE 'TABLE'   DBFILE                          S01194
0650 C   99                MOVE XCCY      DBKEY                           S01194
0651 C   99                MOVE 'SDCURRPD'DBFILE                          S01194
0652 C   99                GOTO END
0653 C**
0654 C                     Z-ADDXDECP     BCCYDP  10       DEC.PLACES
0655 C**
0656 C**   DETERMINE LIMITS CURRENCY DETAILS
0657 C     N27             MOVE BCYL      XCCY
0658 C* IF LIMITS CCY BLANK USE BASE CCY
0659 C      27             MOVE BCCY      XCCY
0660 C************
0661 C*  AMENDMENT TO DEFAULT TO BASE CCY WAS MADE DURING SYSTEM TEST,
0662 C* BECAUSE IF DEALING MODULE WASN'T PRESENT,'BYCL' WAS BLANK AND
0663 C* THEREFORE A DATABASE ERROR OCCURED.
0664 C*  THIS WAS NOT THE MOST EFFICIENT WAY OF AMENDING BUT WAS THE
0665 C* SIMPLEST IN A TIME CRITICAL SITUATION.
0666 C*  THIS SECTION OF CODING IS INSTRUMENTAL IN CALCULATING THE OUTPUT
0667 C* FIELD 'SLEAMT', WHICH IS ONLY USED IN DEALING REPORTS.
0668 C*  --- IT IS UNUSUAL FOR DEALING NOT TO BE PRESENT. ---
0669 C************
0670 C                     EXSR CCYDSP
0671 C   99                SETON                     U7U8  **DATABASE 04**
0672 C   99                Z-ADD4         DBASE
0673 C***99*********       MOVE CCYKEY    DBKEY                           S01194
0674 C***99*********       MOVE 'TABLE'   DBFILE                          S01194
0650 C   99                MOVE XCCY      DBKEY                           S01194
0651 C   99                MOVE 'SDCURRPD'DBFILE                          S01194
0675 C   99                GOTO END
0676 C**
0677 C                     Z-ADDXDECP     LCCYDP  10       DEC.PLACES
0678 C**
0679 C**   DEFINE STANDARD FIELDS
0680 C                     Z-ADD0         ZERO05  50
0681 C                     Z-ADD0         ZERO13 130
0682 C                     MOVE ' '       BLK22  22
0683 C                     MOVE ' '       BLK38  38
0684 C**
0685 C**   COMMENCE RECORD COUNT FOR NEW FILE
0686 C**********           Z-ADD1         COUNT2  50                      105140
     C********** 1         SETLLLVENTZZF                                         AR1078776 AR1095829
     C**********           READ LVENTZZF                 68                      AR1078776 AR1095829
     C********** *IN68     IFEQ *ON                                              AR1078776 AR1095829
     C                     Z-ADD1         COUNT2  90                      105140
     C**********           MOVE 'T'       LRECI                                  AR1078776 AR1095829
     C**********           ELSE                                                  AR1078776 AR1095829
     C**********           Z-ADDLNORE0    COUNT2                                 AR1078776 AR1095829
     C**********           SUB  1         COUNT2                                 AR1078776 AR1095829
     C**********           Z-ADDLHRWN     HSHWN2                                 AR1078776 AR1095829
     C**********           Z-ADDLHRDC     HSHDC2                                 AR1078776 AR1095829
     C**********           ENDIF                                                 AR1078776 AR1095829
     C**
     C** START COUNT OF DETAIL RECS WRITTEN TO EMTE1 & EMXT1
     C********** 1         SETLLEMTE1T1F                                         AR1078776 AR1095829
     C**********           READ EMTE1T1F                 78                      AR1078776 AR1095829
     C********** *IN78     IFEQ *ON                                              AR1078776 AR1095829
     C**********           MOVE 'T'       TRECI                                  AR1078776 AR1095829
     C**********           MOVE '999999'  TMCUN                                  AR1078776 AR1095829
     C**********           MOVE 'L'       TRECJ                                  AR1078776 AR1095829
     C   U1                Z-ADD0         TNLER   50
     C**********           ELSE                                                  AR1078776 AR1095829
     C**********           Z-ADDTNONE     TNLER                                  AR1078776 AR1095829
     C**********           ENDIF                                                 AR1078776 AR1095829
     C********** 1         SETLLEMXT1T1F                                         AR1078776 AR1095829
     C**********           READ EMXT1T1F                 88                      AR1078776 AR1095829
     C********** *IN88     IFEQ *ON                                              AR1078776 AR1095829
     C**********           MOVE 'T'       RECI                                   AR1078776 AR1095829
     C**********           MOVE '999999'  MCUN                                   AR1078776 AR1095829
     C**********           MOVE 'L'       RECJ                                   AR1078776 AR1095829
     C   U1                Z-ADD0         XNLER   50
     C   U1                Z-ADD0         XNLER1  50
     C   U1                Z-ADD0         XNLER2  50
     C**********           ELSE                                                  AR1078776 AR1095829
     C**********           Z-ADDNONE      XNLER                                  AR1078776 AR1095829
     C********** 5         SUBSTZZ117:1   CNLER1                                 AR1078776 AR1095829
     C**********           MOVE CNLER1    XNLER1                                 AR1078776 AR1095829
     C********** 5         SUBSTZZ117:6   CNLER2                                 AR1078776 AR1095829
     C**********           MOVE CNLER2    XNLER2                                 AR1078776 AR1095829
     C**********           ENDIF                                                 AR1078776 AR1095829
0825 C**                                                                  S01164
0826 C**   SET UP DATE COMPARISON FOR EVENT CREATION                      S01164
0827 C**                                                                  S01164
     C           RUND      ADD  30        CHKDAT  50                      S01164
     C                     MOVE *BLANKS   ZCCYI   3                                         MD021155
     C                     MOVE *BLANKS   ZCCYO   3                                         MD021155
     C/COPY WNCPYSRC,LE0480C013
      *                                                                                      LLN022A
      ** Determine if Liquidity Reporting is on                                              LLN022A
      *                                                                                      LLN022A
     C                     CALL 'AOSARDR0'                                                   LLN022A
     C                     PARM *BLANKS   W0RTCD                                             LLN022A
     C                     PARM '*VERIFY' W0OPTN                                             LLN022A
     C                     PARM 'LLN012'  W0SARD                                             LLN022A
     C           SCSARD    PARM SCSARD    DSFDY                                              LLN022A
      *                                                                                      LLN022A
      ** Set on Liquidty Reporting flag                                                      LLN022A
      *                                                                                      LLN022A
     C           W0RTCD    IFEQ *BLANKS                                                      LLN022A
     C                     MOVE 'Y'       LLN012  1                                          LLN022A
     C                     ENDIF                                                             LLN022A
      *                                                                                      LLN022A
      ** Check end of book indicator                                                         LLN022A
      *                                                                                      LLN022A
     C           LLN012    IFEQ 'Y'                                                          LLN022A
     C           EEOB      ANDEQ'N'                                                          LLN022A
      *                                                                                      LLN022A
      ** Get the report extract date                                                         LLN022A
      *                                                                                      LLN022A
     C                     OPEN BYRPDTPP                                                     LLN022A
     C           1         SETLLBYRPDTPP                                                     LLN022A
     C                     READ BYRPDTPP                 90                                  LLN022A
     C                     CLOSEBYRPDTPP                                                     LLN022A
      *                                                                                      LLN022A
      ** Get report extract date in DDMMYY format                                            LLN022A
      *                                                                                      LLN022A
     C                     Z-ADDL0RPDT    ULDAYN                                             LLN022A
     C                     CALL 'ZDATE2'                                                     LLN022A
     C                     PARM           ULDAYN  50                                         LLN022A
     C                     PARM           DATF                                               LLN022A
     C                     PARM           ULDATE  60                                         LLN022A
     C                     PARM           ULDATA  7                                          LLN022A
      *                                                                                      LLN022A
      ** Determine date 5 years ahead                                                        LLN022A
      *                                                                                      LLN022A
     C                     MOVE ULDATE    ULYEAR  20                                         LLN022A
     C                     ADD  5         ULYEAR                                             LLN022A
     C                     MOVE ULYEAR    ULDATE                                             LLN022A
      *                                                                                      LLN022A
      ** Get Midas day number for date                                                       LLN022A
      *                                                                                      LLN022A
     C                     CALL 'ZDATE1'                                                     LLN022A
     C                     PARM           ULRTCD  7                                          LLN022A
     C                     PARM           ULDATE                                             LLN022A
     C                     PARM           DATF                                               LLN022A
     C                     PARM           ULDAYN  50                                         LLN022A
      *                                                                                      LLN022A
      ** Set up date comparison event generation field                                       LLN022A
      *                                                                                      LLN022A
     C                     Z-ADDULDAYN    ULCKDT  50                                         LLN022A
      *                                                                                      LLN022A
     C                     ENDIF                                                             LLN022A
0825 C**                                                                  S01164
0688 C**********************************
0689 C           DETAIL    TAG                             **DETAIL TAG**
     C                     MOVELLTYP      WKLTY1  1                                           CLE134
      *                                                                                       CER049
      ** Access Loan extension file                                                           CER049
      *                                                                                       CER049
     C           CER049    IFEQ 'Y'                                                           CER049
     C           *IN02     ANDEQ*ON                                                           CER049
     C           PTYP      IFEQ 61                                                          AR909846
     C           PTYP      OREQ 62                                                          AR909846
     C           PTYP      OREQ 63                                                          AR909846
     C           PTYP      OREQ 70                                                          AR909846
     C           LNRF      CHAINCLONCLL1             89                                       CER049
     C           *IN89     IFEQ *ON                                                           CER049
     C                     MOVELLNRF      DBKEY                                               CER049
     C                     MOVEL'CLONCLL1'DBFILE                                              CER049
     C                     Z-ADD29        DBASE                                               CER049
     C                     SETON                     U7U8LR                                   CER049
     C                     EXSR *PSSR                                                         CER049
     C                     ENDIF                                                            AR909846
     C                     ENDIF                                                              CER049
     C                     ENDIF                                                              CER049
      *                                                                                       262545
      * If generation till end of book is not required on LE ICD                              262545
      * then check if the specific loan needs it for IAS purposes                             262545
      *                                                                                       262545
     C           EEOB      IFNE 'Y'                                                           262545
     C           LNRF      CHAINLE0480PF             63                                       262545
     C           *IN63     IFEQ *OFF                                                          262545
     C                     MOVE *ON       *IN63                                               262545
     C                     ELSE                                                               262545
     C                     MOVE *OFF      *IN63                                               262545
     C                     ENDIF                                                              262545
     C                     ENDIF                                                              262545
     C*
     C********** BGPFMG    IFEQ 'Y'                                                  131273 CLE075AF
     C********** 1         SETLLSDPORTL1                                             131273 CLE075AF
     C**********           READ SDPORTL1                 44                          131273 CLE075AF
     C********** *IN44     IFEQ '1'                                                  131273 CLE075AF
     C**********           SETON                     U7U8                            131273 CLE075AF
     C**********           Z-ADD26        DBASE            ** DBERR  26 *            131273 CLE075AF
     C**********           MOVE 'SDPORT'  DBFILE                                     131273 CLE075AF
     C**********           MOVEL'NONE'    DBKEY                                      131273 CLE075AF
     C**********           GOTO END                                                  131273 CLE075AF
     C**********           END                                                       131273 CLE075AF
     C**********           END                                                       131273 CLE075AF
     C           PTFR      IFNE *BLANKS                    - B1           S01486
     C           BGPFMG    ANDEQ'Y'                                       S01486
     C           PTFR      ORNE *BLANKS                                   CPB001
     C           BGN4ST    ANDEQ'Y'                                       CPB001
     C           BGN1ST    OREQ 'Y'                                                         MD054239
     C           EEOB      ANDEQ'N'                                                         MD054239
     C                     MOVE '1'       *IN64                           S01486
     C                     ELSE                            - X1           S01486
     C                     MOVE '0'       *IN64                           S01486
     C                     END                             - E1           S01486
      *                                                                   CLE004
      ** If CLE004 is installed, check if loan is an internal parts.      CLE004
      ** purchased                                                        CLE004
      *                                                                   CLE004
     C           CLE004    IFEQ 'Y'                                       CLE004
     C           LPFI      IFEQ 'I'                                       CLE004
     C                     MOVE 'Y'       WLIPP   1                       CLE004
     C                     ELSE                                           CLE004
     C                     MOVE *BLANKS   WLIPP                           CLE004
     C                     ENDIF                                          CLE004
     C                     ENDIF                                          CLE004
     C*
     C*
     C/COPY WNCPYSRC,LE0480C001
     C*
      *                                                                   CEU004
      ** If feature CEU004 is on                                          CEU004
      ** or if feature CLE031 is on                                       CLE031
      ** Reset *IN33 and EMU currency field.                              CEU004
      *                                                                   CEU004
     C           CEU004    IFEQ 'Y'                        If Feature On  CEU004
     C           LNRF      ANDNESVLNRF                     And Loan diff  CEU004
     C           CLE031    OREQ 'Y'                        If Feature On  CLE031
     C           LNRF      ANDNESVLNRF                     And Loan diff  CLE031
     C                     MOVE *BLANKS   EMUCCY  3         Clr EMU Ccy   CEU004
     C                     MOVE *BLANKS   IFXC    1         Clr IFXC      163486
     C                     MOVE *BLANKS   SIAC    1         Clr SIAC      163486
     C                     MOVE *OFF      *IN33             Reset *IN33   CEU004
     C**********           MOVE LNRF      SVLNRF  60        Set Loan save              CEU004 CLE148
     C                     MOVE LNRF      SVLNRF  6                                           CLE148
     C                     ENDIF                           End If         CEU004
      *                                                                   CEU004
     C                     SETOF                     66                   S01392
     C                     SETOF                     06                   E10836
     C                     SETOF                     77                   S01195
0690 C**
0691 C**   PERFORM RECORD COUNT & HASH TOTALS
0692 C  N04      COUNT1    ADD  1         COUNT1  50
     C**
     C**
     C** CHECK TO SEE IF PROCESSING TYPE 66 OR 67
     C   U1 03   PTYP      COMP 66                       62
     C   U1 03N62PTYP      COMP 67                       62
      *                                                                   CLE005
      ** If SAR CLE005 is installed, include additional processing        CLE005
      ** types 68, 69, 71 and 72                                          CLE005
      *                                                                   CLE005
     C           CLE005    IFEQ 'Y'                                       CLE005
     C           *IN62     ANDEQ*OFF                                      CLE005
     C           *IN03     ANDEQ*ON                                       CLE005
     C           *INU1     ANDEQ*ON                                       CLE005
     C           PTYP      IFEQ 69                                        CLE005
     C           PTYP      OREQ 72                                        CLE005
     C                     MOVE *ON       *IN62                           CLE005
     C                     ENDIF                                          CLE005
     C                     ENDIF                                          CLE005
      *                                                                   CLE005
     C**                                                                  E10836
     C** CHECK TO SEE IF PROCESSING TYPE 64 OR 65 AND NO RECOURSE         E10836
      *                                                                                     MD049545
     C                     SETOF                     67                                     MD049545
      *                                                                                     MD049545
     C   U1 03   PTYP      IFEQ 64                                        E10836
     C           PTYP      OREQ 65                                        E10836
     C           CLE005    OREQ 'Y'                                       CLE005
     C           PTYP      ANDEQ68                                        CLE005
     C           CLE005    OREQ 'Y'                                       CLE005
     C           PTYP      ANDEQ71                                        CLE005
     C           RCSI      COMP 'Y'                  0606                 E10836
      *                                                                                     MD049545
     C           LNKS      IFEQ 'Y'                                                         MD049545
     C                     SETON                     67                                     MD049545
     C                     ENDIF                                                            MD049545
      *                                                                                     MD049545
     C                     END                                            E10836
     C**
     C** CHECK IF RECOURSE INDICATOR NOT Y
     C   U1 03 62RCSI      COMP 'Y'                  6262
     C*
     C***INCREASE*REC*COUNT*FOR*EMXT1*-*TOTAL*RECORDS******************                     MD051219
     C***U1*03**           ADD  1         XNLER                                             MD051219
     C*****************************************************************                     MD051219
     C***INCREASE*REC*COUNT*FOR*EMXT1*-*'L'*RECS*ONLY******************                     MD051219
     C***U1*03N62          ADD  1         XNLER1                                            MD051219
     C***INCREASE*REC*COUNT*FOR*EMXT1*-*'R'*RECS*ONLY******************                     MD051219
     C***U1*03*62          ADD  1         XNLER2                                            MD051219
0693 C**
0693 C**
0694 C   02                Z-ADDHSHWN1    ZZTOTI
0695 C   02                Z-ADDHSHDC1    ZZTOTD
0696 C**
0697 C**   IF AMOUNT IS NEGATIVE,REVERSE SIGN
0698 C   02      CPAM      DIV  1000      ZZAMT        41
0699 C   02 41             Z-SUBZZAMT     ZZAMT
0700 C   02                EXSR GLZADD
0701 C   02                Z-ADDZZTOTI    HSHWN1 150
0702 C   02                Z-ADDZZTOTD    HSHDC1  30
      *                                                                                     MD021605
      ** Do not process PDCL if not re-run.                                                 MD021605
      *                                                                                     MD021605
     C**********           SETOF                     0506                          MD021605 MD031481
     C                     SETOF                     0514                                   MD031481
     C           RERUN     IFEQ 'N'                                                         MD021605
     C                     SETON                     07                                     MD021605
      *                                                                                     MD021605
      ** Write PDCL record from CLOANCL to LELWNEPD.                                        MD021605
      *                                                                                     MD021605
     C           *IN02     IFEQ '1'                                                         MD021605
     C           RECI      ANDEQ'D'                                                         MD021605
     C           WKLTY1    IFEQ 'X'                                                         MD021605
     C           WKLTY1    OREQ 'Y'                                                         MD021605
     C           WKLTY1    OREQ 'Z'                                                         MD021605
     C                     SETON                     05                                     MD021605
     C                     MOVE LNRF      WLNRF   6                                         MD021605
     C                     GOTO END                                                         MD021605
     C                     ENDIF                                                            MD021605
     C                     ENDIF                                                            MD021605
      *                                                                                     MD021605
      ** Write PDCL record from CLOANCK to LELWNEPK.                                        MD021605
      ** Calculate records for trailer file LELWNEZ1.                                       MD021605
      *                                                                                     MD021605
     C           *IN03     IFEQ '1'                                                         MD021605
     C           WLNRF     ANDEQLNRF                                                        MD021605
     C           RECI      ANDEQ'D'                                                         MD021605
     C**********           SETON                     06                            MD021605 MD031481
     C                     SETON                     14                                     MD031481
     C                     EXSR CTRAIL                                                      MD021605
     C                     MOVE *BLANKS   WLNRF                                             MD021605
     C                     GOTO END                                                         MD021605
     C                     ENDIF                                                            MD021605
     C                     ELSE                                                             MD021605
     C                     SETOF                     07                                     MD021605
     C                     ENDIF                                                            MD021605
      *                                                                                     MD021605
     C           RERUN     IFEQ 'Y'                                                         MD021605
     C           *IN02     IFEQ '1'                                                         MD021605
     C           *IN03     OREQ '1'                                                         MD021605
     C           WLOAN     SETLLCLOANC                                                      MD021605
     C           WLOAN     CHAINCLOANC               08                                     MD021605
     C                     ENDIF                                                            MD021605
     C                     ENDIF                                                            MD021605
      *                                                                                    MD049545A
      **  Parts Purchased loan link to syndication should not                              MD049545A
      **  be included in the trailer file EMXT1T1.                                         MD049545A
      *                                                                                    MD049545A
     C           *IN67     IFEQ '0'                                                        MD049545A
     C** INCREASE REC COUNT FOR EMXT1 - TOTAL RECORDS                                       MD051219
     C   U1 03             ADD  1         XNLER                                             MD051219
     C*                                                                                     MD051219
     C** INCREASE REC COUNT FOR EMXT1 - 'L' RECS ONLY                                       MD051219
     C   U1 03N62          ADD  1         XNLER1                                            MD051219
     C** INCREASE REC COUNT FOR EMXT1 - 'R' RECS ONLY                                       MD051219
     C   U1 03 62          ADD  1         XNLER2                                            MD051219
      *                                                                                    MD049545A
     C                     ENDIF                                                           MD049545A
      *                                                                   LN0383
      **  For each loan detail 1 record                                   LN0383
      **      If the originating branch used indicator is 'Y' access the  LN0383
      **      company of originating branch for the originating branch    LN0383
      **      on the detail record otherwise set the company of           LN0383
      **      originating branch to blank.                                LN0383
      *                                                                   LN0383
     C           *IN02     IFEQ '1'                                       LN0383
      *                                                                   CLE031
      ** If feature CLE031 is on store loan receipt settlement ccy,       CLE031
      ** payment settlment ccy and ex rates for these                     CLE031
      *                                                                   CLE031
     C           CLE031    IFEQ 'Y'                                       CLE031
     C                     MOVE SCCY      WSCCY   3                       CLE031
     C                     MOVE PSCY      WPSCY   3                       CLE031
     C                     Z-ADDREXR      WREXR  138                      CLE031
     C                     Z-ADDPEXR      WPEXR  138                      CLE031
     C                     MOVE REXI      WREXI   1                       CLE031
     C                     MOVE PEXI      WPEXI   1                       CLE031
     C                     ENDIF                                          CLE031
      *                                                                   CEU004
      ** If feature CEU004 is on                                          CEU004
      *                                                                   CEU004
     C           CEU004    IFEQ 'Y'                        If Feature On  CEU004
     C                     MOVE SCCY      EMUCC2  3                       CEU004
     C                     ENDIF                                          CEU004
     C*                                                                   LN0383
     C           BKOBRU    IFEQ 'Y'                                       LN0383
      *                                                                   LN0383
     C**  Access the branch information for the originating branch        LN0383
     C*                                                                   LN0383
     C* Check whether details for Branch already in array                                     CSC042
     C                     MOVELORBR      ##KB                                                CSC042
     C                     EXSR ##CHKB                                                        CSC042
      * If branch is in the array then use the details                                        CSC042
     C           ##FIC     IFEQ 'Y'                        *** B10                            CSC042
     C                     EXSR ##SETB                                                        CSC042
     C                     ELSE                            *** X10                            CSC042
      * If branch is not in the array then get details from DB                                CSC042
     C**********           CALL 'AOBRCHR0'                                             LN0383 CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       LN0383
     C                     PARM '*KEY   ' @OPTN   7                       LN0383
     C                     PARM ORBR      @DSNB   3                       LN0383
     C********** SDBRCH    PARM SDBRCH    DSFDY                                        LN0383 CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
      *                                                                   LN0383
     C           @RTCD     IFNE *BLANKS                                   LN0383
     C                     MOVEL@DSNB     DBKEY            ***************LN0383
     C                     MOVEL'SDBRCHPD'DBFILE           * DBERROR 28  *LN0383
     C                     Z-ADD28        DBASE            ***************LN0383
     C                     SETON                     U7U8LR               LN0383
     C                     EXSR *PSSR                                     LN0383
     C                     GOTO END                                       LN0383
     C                     ELSE                                                               CSC042
      * Details found on the DB so add them to the array                                      CSC042
      * if the array still has room                                                           CSC042
     C                     EXSR ##ADDB                                                        CSC042
     C                     END                                            LN0383
     C                     ENDIF                           *** E10                            CSC042
      *                                                                   LN0383
     C                     MOVE CMPYM     COOB    3                       LN0383
     C*                                                                   LN0383
     C                     ELSE                                           LN0383
     C                     MOVE *BLANK    COOB                            LN0383
     C*                                                                   LN0383
     C                     END                                            LN0383
     C*                                                                   LN0383
     C                     END                                            LN0383
     C*                                                                   LN0383
     C           CAS005    IFEQ 'Y'                                                           226261
     C                     MOVE 'Y'       WFXDR   1                                           226261
     C           BRTT      IFNE 0                                                             226261
     C           CHIN      ANDEQ'D'                                                           226261
     C                     MOVE 'N'       WFXDR                                               226261
     C                     ENDIF                                                              226261
     C                     MOVE *BLANK    WNCCY   3                                           226261
     C                     Z-ADD0         WNCAC   10                                          226261
     C                     MOVE *BLANK    WNFYLB  5                                           226261
     C                     Z-ADD*HIVAL    WNXRO   50                                          229938
     C                     ENDIF                                                              226261
0703 C**
0704 C  N03                GOTO END
0705 C**********************************
0706 C**   REQUIRED 'B' RECORD PROCESSING - SET UP LOAN DETAILS
0707 C**   IF MAT. DATE = 0(CALL LOAN),SET TO RUN DATE + 15 WORKING DAYS
0706 C**   If Citydealer Non-front Office Cashflows interface is          CCM002
0707 C**   installed (CCM002), then forward maturity date should be set   CCM002
0707 C**   to Date of Next Working Day plus number of billing days.       CCM002
      *                                                                   CLE031
      ** If feature CLE031 is on store rollover receipt settlement ccy,   CLE031
      ** rollover payment settlment ccy and rollover ex rates for these   CLE031
      *                                                                   CLE031
     C           CLE031    IFEQ 'Y'                                       CLE031
     C                     MOVE RRSC      WRRSC   3                       CLE031
     C                     MOVE RPSC      WRPSC   3                       CLE031
     C                     Z-ADDRRSR      WRRSR  138                      CLE031
     C                     Z-ADDRPSR      WRPSR  138                      CLE031
     C                     MOVE RRSI      WRRSI   1                       CLE031
     C                     MOVE RPSI      WRPSI   1                       CLE031
     C                     ENDIF                                          CLE031
      *                                                                   CCM002
      ** If feature CEU004 is on                                          CEU004
      ** If Settlement currency for EMU non-blank, set EMU currency field.CEU004
      *                                                                   CEU004
     C           CEU004    IFEQ 'Y'                        If Feature On  CEU004
      *                                                                   CEU004
     C                     MOVE *BLANKS   EMUCC3  3                       CEU004
      *                                                                   CEU004
     C                     SELEC                                          CEU004
     C           RRSC      WHNE *BLANKS                                   CEU004
     C           RPSC      ANDEQ*BLANKS                                   CEU004
     C                     MOVE RRSC      EMUCC3                          CEU004
     C           RPSC      WHNE *BLANKS                                   CEU004
     C           RRSC      ANDEQ*BLANKS                                   CEU004
     C                     MOVE RPSC      EMUCC3                          CEU004
     C           RRSC      WHNE *BLANKS                                   CEU004
     C           RPSC      ANDNE*BLANKS                                   CEU004
     C           PTYP      IFEQ 61                                        CEU004
     C           PTYP      OREQ 62                                        CEU004
     C           PTYP      OREQ 63                                        CEU004
     C           PTYP      OREQ 64                                        CEU004
     C           PTYP      OREQ 65                                        CEU004
     C           CLE005    OREQ 'Y'                                       CEU004
     C           PTYP      ANDEQ68                                        CEU004
     C           CLE005    OREQ 'Y'                                       CEU004
     C           PTYP      ANDEQ71                                        CEU004
     C           CLE028    OREQ 'Y'                                                           CLE028
     C           PTYP      ANDEQ80                                                            CLE028
     C***********          MOVE RRSC      EMUCCY                   CEU004 134798
     C                     MOVE RRSC      EMUCC3                          134798
     C                     ELSE                                           CEU004
     C           PTYP      IFEQ 66                                        CEU004
     C           PTYP      OREQ 67                                        CEU004
     C           CLE005    OREQ 'Y'                                       CEU004
     C           PTYP      ANDEQ69                                        CEU004
     C           CLE005    OREQ 'Y'                                       CEU004
     C           PTYP      ANDEQ72                                        CEU004
     C***********          MOVE RPSC      EMUCCY                   CEU004 134798
     C                     MOVE RPSC      EMUCC3                          134798
     C                     ENDIF                             End If       CEU004
     C                     ENDIF                                          CEU004
     C                     ENDSL                                          CEU004
     C                     ENDIF                           End If         CEU004
      *                                                                   CEU004
     C           WCITYD    IFEQ 'Y'                                       CCM002
      *                                                                   CCM002
     C           BLDY      IFEQ 0                                         CCM002
     C                     Z-ADD1         BLDY                            CCM002
     C                     END                                            CCM002
      *                                                                   CCM002
     C           *IN21     IFEQ '1'                                       CCM002
     C                     Z-ADDBLDY      ZNRDYS                          CCM002
     C                     Z-ADDDNWD      ZDAYNO                          CCM002
     C                     END                                            CCM002
      *                                                                   CCM002
     C                     ELSE                                           CCM002
0708 C   21                Z-ADD15        ZNRDYS
0709 C   21                Z-ADDRUND      ZDAYNO
     C                     END                                            CCM002
      *                                                                   CCM002
0710 C   21                MOVE CCY       ZCCY
     C           MDST      IFNE 01                                                            237466
     C           MDST      ANDNE07                                                            237466
     C           MDST      ANDNE08                                                            237466
     C           MDST      ANDNE02                                                            237466
     C           MDST      ANDNE12                                                            237466
     C           *IN21     ANDEQ'1'                                                           237466
     C                     MOVE BJLCCY    ZCCY                                                237466
     C                     ENDIF                                                              237466
      *                                                                   CEU004
      ** If feature CEU004 is on, as well as *IN21.                       CEU004
      ** If Settlement currency for EMU non-blank, set currency parm.     CEU004
      *                                                                   CEU004
     C           CEU004    IFEQ 'Y'                        If Feature On  CEU004
     C           *IN21     ANDEQ*ON                        And *IN21 *On  CEU004
     C           SCCY      ANDNE*BLANKS                    And *IN21 *On  CEU004
     C                     MOVE SCCY      ZCCY                            CEU004
     C                     ENDIF                                          CEU004
      *                                                                   CLE031
      ** If feature CLE031 is on, as well as *IN21.                       CLE031
      *                                                                   CLE031
     C           CLE031    IFEQ 'Y'                                       CLE031
     C           *IN21     ANDEQ*ON                                       CLE031
      *                                                                   CLE031
      ** If loan or part purchased use loan receipt sett ccy              CLE031
     C           PTYP      IFEQ 61                                        CLE031
     C           WSCCY     ANDNE*BLANKS                                                     MD055084
     C           PTYP      OREQ 68                                        CLE031
     C           WSCCY     ANDNE*BLANKS                                                     MD055084
     C                     MOVE WSCCY     ZCCY                            CLE031
     C                     ENDIF                                          CLE031
      *                                                                   CLE031
      ** If part sold use loan payment sett ccy                           CLE031
     C           PTYP      IFEQ 69                                        CLE031
     C           WPSCY     ANDNE*BLANKS                                                     MD055084
     C                     MOVE WPSCY     ZCCY                            CLE031
     C                     ENDIF                                          CLE031
     C                     ENDIF                                          CLE031
      *                                                                   CEU004
     C   21N77             EXSR MATLOC                                    S01195
     C   21                MOVE W@MDSL    ZLOC                            S01195
0711 C***21******          EXSR ZDATE3                                    S01195
     C   21                EXSR ZFWDT                                     S01195
0712 C**
0713 C**   IF LOAN VALUE DATE DOES NOT LIE WITHIN THIS PERIOD - BYPASS
0714 C   21      VDAT      COMP ZDYNBR               41  41
0715 C   21 41             GOTO END
0716 C**
0717 C**   SAVE THIS NOMINAL MATURITY DATE FOR FUTURE USE
0718 C   21                Z-ADDZDYNBR    MATDAT  50
0719 C**
0720 C**   ACCESS LOAN CURRENCY DETAILS
0721 C                     MOVE CCY       XCCY
0722 C                     EXSR CCYDSP
0723 C   99                SETON                     U7U8  **DATABASE 05**
0724 C   99                Z-ADD5         DBASE
0725 C***99*********       MOVE CCYKEY    DBKEY                           S01194
0726 C***99*********       MOVE 'TABLE'   DBFILE                          S01194
0650 C   99                MOVE XCCY      DBKEY                           S01194
0651 C   99                MOVE 'SDCURRPD'DBFILE                          S01194
0727 C   99                GOTO END
0728 C**
0729 C                     Z-ADDXDECP     ECCYDP  10       DEC.PLACES
0730 C                     Z-ADDXSPOT     ECCYSP 138       SPOT RATE-BASE
0731 C**************       Z-ADDXMDIN     ECCYMD  10       MULT/DIV       S01194
0731 C                     MOVE XMDIN     ECCYMD  1        MULT/DIV       S01194
0732 C                     Z-ADDXSORT     ECCYSS  20       SORT SEQUENCE
0733 C                     Z-ADDXSPLM     ECCYSL 138       SPOT RATE-LIMIT
0734 C**
0735 C**   DETERMINE REGION OF RISK
0736 C**************       MOVE CRSK      XCRY                            S01194
0736 C                     MOVE CRSK      XCRY    2                       S01194
0737 C                     EXSR CRYDET
0738 C   99                SETON                     U7U8  **DATABASE 06**
0739 C   99                Z-ADD6         DBASE
0740 C***99*********       MOVE CRYKEY    DBKEY                           S01194
0741 C***99*********       MOVE 'TABLE'   DBFILE                          S01194
0740 C   99                MOVE XCRY      DBKEY                           S01194
0741 C   99                MOVE 'SDCTRYPD'DBFILE                          S01194
0742 C   99                GOTO END
0743 C**
0744 C                     MOVELCRSK      RSKDET  4        RISK DETAILS
0745 C                     MOVE XREGN     RSKDET
0746 C**
0747 C**   DETERMINE CUSTOMER DETAILS
0748 C**************       MOVELCNUM      CUSKEY                          S01194
0748 C                     MOVELCNUM      CUSKEY 10                       S01194
0749 C                     EXSR CUSCHN
0750 C   55                SETON                     U7U8  **DATABASE 07**
0751 C   55                Z-ADD7         DBASE
0752 C   55                GOTO END
0753 C**
0754 C**********           Z-ADDCNUM      CUSNUM  60                                          CSD027
0754 C                     MOVE CNUM      CUSNUM  6                                           CSD027
     C***********          MOVE BBPCNB    CPAR    60                      S01194              CSD027
     C                     MOVE BBPCNB    CPAR    6                                           CSD027
0755 C***********          Z-ADDCPAR      PARNUM  60                                          CSD027
     C                     MOVE CPAR      PARNUM  6                                           CSD027
0756 C                     MOVE CSTDET    CUSDET 38        CUST. DETAILS
0757 C**
0758 C**   DETERMINE IF CUSTOMER IS A PARENT
0759 C**************       TESTB'2'       CMIN           72               S01194
     C           BBPAIN    COMP 'P'                      72               S01194
     C**                                                                  S01260
     C**   IF PARTICIPATION PURCHASED WITHOUT RECOURSE USE 'ORIGINAL      S01260
     C**   BORROWER' CUSTOMER COUNTRY OF LOCATION AND ASSOCIATED REGION   S01260
     C**                                                                  S01260
     C           *IN06     IFEQ '1'                                       S01260
     C                     MOVELOLNO      CUSKEY 10                       S01260
     C                     EXSR CUSCHN                                    S01260
     C   55                SETON                     U7U8  **DATABASE 99**S01260
     C   55                Z-ADD99        DBASE                           S01260
     C   55                GOTO END                                       S01260
     C**********           Z-ADDOLNO      CUSNUM                                       BHF444 CSD027
     C                     MOVE OLNO      CUSNUM                                              CSD027
     C**********           MOVE BBPCNB    CPAR    60                                          CSD027
     C                     MOVE BBPCNB    CPAR    6                                           CSD027
     C**********           Z-ADDCPAR      PARNUM  60                      BHF444              CSD027
     C                     MOVE CPAR      PARNUM  6                                           CSD027
     C                     MOVE CSTDET    CUSDET 38        CUST. DETAILS  BHF444
     C           BBPAIN    COMP 'P'                      72               BHF444
     C                     END                                            S01260
0760 C**
0761 C**   DETERMINE REGION OF DOMICILE
0762 C                     MOVE CLOC      XCRY
0763 C                     EXSR CRYDET
0764 C   99                SETON                     U7U8  **DATABASE 08**
0765 C   99                Z-ADD8         DBASE
0766 C***99*********       MOVE CRYKEY    DBKEY                           S01194
0767 C***99*********       MOVE 'TABLE'   DBFILE                          S01194
0740 C   99                MOVE XCRY      DBKEY                           S01194
0741 C   99                MOVE 'SDCTRYPD'DBFILE                          S01194
0768 C   99                GOTO END
0769 C**
0770 C                     MOVELCLOC      DOMDET  4        DOM. DETAILS
0771 C                     MOVE XREGN     DOMDET
0772 C**
0773 C**   DETERMINE PARENT DETAILS
0774 C***********CPAR      COMP 0                    41
     C           CPAR      COMP *BLANKS              41
0775 C  N41                MOVE BLK38     PARDET 38
0776 C   41                MOVELCPAR      CUSKEY
0777 C   41                EXSR CUSCHN
0778 C   41 55             SETON                     U7U8  **DATABASE 09**
0779 C   41 55             Z-ADD9         DBASE
0780 C   41 55             GOTO END
0781 C**
0782 C   41                MOVE CSTDET    PARDET           PARENT DETAILS
      **                                                                  S01117
     C*** ACCESS THE BRANCH INFORMATION FOR BOOKING BRANCH                S01117
     C**                                                                  S01117
     C* Check whether details for Branch already in array                                     CSC042
     C                     MOVELBRCA      ##KB                                                CSC042
     C                     EXSR ##CHKB                                                        CSC042
      * If branch is in the array then use the details                                        CSC042
     C           ##FIC     IFEQ 'Y'                        *** B10                            CSC042
     C                     EXSR ##SETB                                                        CSC042
     C                     ELSE                            *** X10                            CSC042
      * If branch is not in the array then get details from DB                                CSC042
     C**********           CALL 'AOBRCHR0'                                             S01117 CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       S01117
     C                     PARM '*KEY   ' @OPTN   7                       S01117
     C                     PARM BRCA      @DSNB   3                       S01117
     C********** SDBRCH    PARM SDBRCH    DSFDY                                        S01117 CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
      *                                                                   S01117
     C           @RTCD     IFNE *BLANKS                                   S01117
     C                     MOVEL@DSNB     DBKEY            ***************S01117
     C                     MOVEL'SDBRCHPD'DBFILE           * DBERROR 24  *S01117
     C                     Z-ADD24        DBASE            ***************S01117
     C                     SETON                     U7U8LR               S01117
     C                     EXSR *PSSR                                     S01117
     C                     GOTO END                                       S01117
     C                     ELSE                                                               CSC042
      * Details found on the DB so add them to the array                                      CSC042
      * if the array still has room                                                           CSC042
     C                     EXSR ##ADDB                                                        CSC042
     C                     END                                            S01117
     C                     ENDIF                           *** E10                            CSC042
      *                                                                   S01117
     C                     MOVE CMPYM     BCMPY   3                       S01117
     C                     MOVE BICN      BBICN   6                       S01117
      *                                                                   LN0383
      **  Store the company of the booking branch for output              LN0383
      **  to the lending event file                                       LN0383
      *                                                                   LN0383
     C                     MOVE CMPYM     COBB    3                       LN0383
     C*                                                                   LN0383
0783 C**
0784 C**   INITIALIZE WORK FIELDS FOR THIS LOAN
0785 C           AITC      ADD  AIAP      TACINT 130       TOT.ACC.INT
0786 C           TACINT    ADD  AIMN      TACINT
0787 C**
0788 C                     Z-ADDCPAM      CPRINC 130       CURRENT PRINC.
     C/COPY WNCPYSRC,LE0480C016
0789 C**
     C           CLE028    IFEQ 'N'                                                           CLE028
     C           CLE028    OREQ 'Y'                                                           CLE028
     C           PTYP      ANDNE80                                                            CLE028
     C           CLE028    OREQ 'Y'                                                           CLE028
     C           PTYP      ANDEQ80                                                            CLE028
     C           ADIF      ANDNE'Y'                                                           CLE028
      *                                                                                       CLE028
0790 C           IPRD      ADD  ICTD      INTPPR 130       INT.PD.PRIOR
     C                     ELSE                                                               CLE028
     C                     Z-ADDICTD      INTPPR 130                                          CLE028
     C                     ENDIF                                                              CLE028
0791 C           INTPPR    ADD  IWOD      INTPPR
0792 C**
0793 C                     Z-ADD0         INTPD  130       INT.PD.THIS RUN
0794 C**
0795 C                     Z-ADDBRTE      BRATE  117       BASE RATE
0796 C**
0797 C                     Z-ADDRTSP      SPRATE 117       SPREAD/RATE
0798 C**
0799 C                     MOVE SPIN      SPRIND  1        SPREAD IND.
0800 C**
0801 C                     Z-ADDICBS      INTBAS  10       CALC. BASIS
0802 C**
0803 C                     Z-ADDINTR      EFFINT 117   70  EFFECTIVE INT.
0804 C**
0805 C                     Z-ADDIBDT      INTBD   50       INT.BASE DATE
0806 C**
0807 C                     Z-ADDRBDT      REPBD   50       REP.BASE DATE
     C                     Z-ADDRBDT      WWREP   50                                         BUG9241
0808 C**
0809 C                     Z-ADDIACD      LSTEVD  50       LAST EVENT DATE
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
      *                                                                                       CAS005
      ** Total accrued interest (Net-Treasury-Rate)                                           CAS005
      *                                                                                       CAS005
     C           AITN      ADD  AIAN      WACNTR 130                                          CAS005
     C           WACNTR    ADD  AINN      WACNTR                                              CAS005
      *                                                                                       CAS005
      ** Interest paid prior (Net-Treasury-Rate)                                              CAS005
      *                                                                                       CAS005
     C           IPRN      ADD  ICTN      WIPNTR 130                                          CAS005
     C           WIPNTR    ADD  IWON      WIPNTR                                              CAS005
      *                                                                                       CAS005
      ** Interest paid this run (Net-Treasury-Rate)                                           CAS005
      *                                                                                       CAS005
     C                     Z-ADD0         WINNTR 130                                          CAS005
      *                                                                                       CAS005
      ** Current principal (Net-Treasury-Rate)                                                CAS005
      *                                                                                       CAS005
     C                     Z-ADDCPAM      WCPNTR 130                                          CAS005
     C                     Z-ADDIACD      W@EDAT                                              CAS005
     C                     Z-ADDIACD      WPEDAT                                              226261
     C                     ENDIF                                                              CAS005
0810 C**
0811 C**   DETERMINE REPAYMENT TYPE
0812 C           REPT      COMP 2                    535152
0813 C**
0814 C**   DETERMINE IF INTEREST TO BE CAPITALIZED
0815 C           INTC      COMP 'Y'                      54
0816 C**
0817 C**   GENERATE DUMMY EVENT RECORD IF LOAN STARTED
0818 C                     TESTB'1'       ACEI           58
     C*
     C/COPY WNCPYSRC,LE0480CCP2
     C*
0819 C      58             EXSR DUMMY
     C**
     C**   DETERMINE IF STOP ACCRUALS ON
     C                     TESTB'3'       LONI           59
0820 C**
0821 C**   SET LOWER LIMITS TO FIND FIRST(IF ANY) LOAN AMENDMENT
0822 C           LMSSET    SETLLLOAMS
0823 C**
0824 C                     EXSR READ
0825 C**
0826 C*
0826 C*****IF*AMENDMENT*IS*GE*3*DAYS*PAST*DUE,*WHOLE*LOAN*IS*CONSIDERED*  088291
0827 C*****TO*BE*PAST*DUE***                                              088291
0827 C*                                                                   088291
0827 C**  PROCESS PAST DUE EVENTS                                         088291
0827 C*                                                                   088291
0828 C  N56      AMTP      COMP 'PD'                     41
0829 C**N56*41***RUND      SUB  VDATLA    DAYS    50                      088291
0830 C**N56*41***DAYS      COMP 3                    41  41               088291
0831 C  N56 41             EXSR PSTDUE
0832 C**N56*41***          GOTO END                                       171691
     C           *IN56     IFEQ '0'                                       171691
     C           *INU7     ANDEQ'1'                                       171691
     C                     GOTO END                                       171691
     C                     ENDIF                                          171691
     C**                                                                  S01164
     C**   IF NEXT ROLLOVER DATE IS ZERO, SET UP A COMPARISON             S01164
     C**   VALUE                                                          S01164
     C***********NROD******IFEQ*0***********************************S01164E20200
     C/COPY WNCPYSRC,LE0480C009
     C           RLDT      IFEQ 0                                         E20200
     C*                                                                   S01408
     C/COPY WNCPYSRC,LE0480CP11                                           S01408
     C*                                                                   S01408
     C           RUND      ADD  30        CKDAT2  50                      S01164
     C*                                                                   S01408
     C/COPY WNCPYSRC,LE0480CP12                                           S01408
     C*                                                                   S01408
     C                     ELSE                                           S01164
     C*********************Z-ADDNROD******CKDAT2********************S01164E20200
     C/COPY WNCPYSRC,LE0480C005
     C                     Z-ADDRLDT      CKDAT2                          E20200
     C/COPY WNCPYSRC,LE0480C006
     C                     END                                            S01164
     C/COPY WNCPYSRC,LE0480C010
     C*                                                                   S01164
     C*                                                                   S01486
     C* RESET INDICATORS                                                  S01486
     C                     MOVE '0'       *IN60                           S01486
     C                     MOVEA'000'     *IN,73                          S01486
     C*                                                                   S01486
0834 C**   EVENTS PROCESSING REQUIRED - INITIALIZE DATES FOR SELECTION
      *                                                                                       CLE134
     C           WKLTY1    IFEQ 'X'                                                           CLE134
     C           WKLTY1    OREQ 'Y'                                                           CLE134
     C           WKLTY1    OREQ 'Z'                                                           CLE134
     C                     Z-ADDDNWD      MDAT                                                CLE134
     C                     Z-ADDDNWD      MATDAT                                              CLE134
     C                     ENDIF                                                              CLE134
      *                                                                                       CLE134
0847 C   21                Z-ADDMATDAT    VMATUR  50                      S01164
0848 C**N21******          Z-ADDMDAT      VMATUR           MATURITYS01164 088708
     C  N21N10             Z-ADDMDAT      VMATUR           MATURITY DATE  088708
     C           *IN10     IFEQ '1'                                       088708
     C           *IN21     ANDEQ'0'                        NOT CALL LOAN  128087
     C           RLDT      IFEQ MDAT                                      088708
     C           NMDT      ANDNE0                                         088708
     C                     Z-ADDNMDT      VMATUR                          088708
     C                     ELSE                                           088708
     C                     Z-ADDMDAT      VMATUR                          088708
     C                     END                                            088708
     C                     END                                            088708
     C**N63******CHKDAT    COMP VMATUR               60            S01164 S01486
     C***60N63***          Z-ADDVMATUR    CKDAT2                   S01164 S01486
     C/COPY WNCPYSRC,LE0480C002
     C  N63N64   CHKDAT    COMP VMATUR               60            S01164 S01486
     C*                                                                   S01408
     C/COPY WNCPYSRC,LE0480CP13                                           S01408
     C*                                                                   S01408
     C   60N63N64          Z-ADDVMATUR    CKDAT2                   S01164 S01486
     C*                                                                   S01408
     C/COPY WNCPYSRC,LE0480CCP6                                           S01408
     C*                                                                   S01408
      ** If BOE installed set event control date to 5 years                                  LLN022A
      *                                                                                      LLN022A
     C           LLN012    IFEQ 'Y'                                                          LLN022A
     C           EEOB      ANDEQ'N'                                                          LLN022A
     C           CKDAT2    ANDLEULCKDT                                                       LLN022A
      *                                                                                      LLN022A
      ** Set up date comparison event generation field                                       LLN022A
      *                                                                                      LLN022A
     C           VMATUR    IFGT ULCKDT                                                       LLN022A
     C                     Z-ADDULCKDT    CKDAT2                                             LLN022A
     C                     ELSE                                                              LLN022A
     C                     MOVE *ON       *IN60                                              LLN022A
     C                     Z-ADDVMATUR    CKDAT2                                             LLN022A
     C                     ENDIF                                                             LLN022A
      *                                                                                      LLN022A
     C                     ENDIF                                                             LLN022A
      *                                                                                      LLN022A
     C                     SETOF                     76                   S01164
     C**N60N63***          SETON                     76            S01164 S01486
     C  N60N63N64          SETON                     76            S01164 S01486
     C/COPY WNCPYSRC,LE0480C007
0846 C**                                                                  S01164
0835 C   56                Z-ADD99999     VAMEND  50       EVENT NOT REQD.
0836 C  N56                Z-ADDVDATLA    VAMEND           AMEND DATE
     C*****N63***VAMEND    COMP CKDAT2               73            S01164 S01486
     C     N63N64VAMEND    COMP CKDAT2               73            S01164 S01486
0837 C**
0838 C   26                Z-ADD99999     VINTR   50       EVENT NOT REQD.
0839 C  N26                Z-ADDNIDT      VINTR            INTEREST DATE
     C                     Z-ADDVINTR     WWINTR  50                                         BUG9241
     C*****N63***VINTR     COMP CKDAT2               74            S01164 S01486
     C     N63N64VINTR     COMP CKDAT2               74            S01164 S01486
0840 C**
0841 C   24                Z-ADD99999     VREPAY  50       EVENT NOT REQD.
0842 C  N24                Z-ADDNRPD      VREPAY           REPAYMENT DATE
     C*****N63***VREPAY    COMP CKDAT2               75            S01164 S01486
     C     N63N64VREPAY    COMP CKDAT2               75            S01164 S01486
      *                                                                                       CLE028
      ** If last repayment date falls on the same day as maturity                             CLE028
      ** do not generate repayment event anymore for flat rate                                CLE028
      ** personal loans                                                                       CLE028
      *                                                                                       CLE028
     C           CLE028    IFEQ 'Y'                                                           CLE028
     C           PTYP      ANDEQ80                                                            CLE028
     C           *IN75     ANDEQ*OFF                                                          CLE028
     C           *IN64     IFEQ *OFF                                                          CLE028
     C           *IN63     ANDEQ*OFF                                                          CLE028
     C           VREPAY    IFEQ CKDAT2                                                        CLE028
     C                     MOVE *ON       *IN75                                               CLE028
     C                     ENDIF                                                              CLE028
     C                     ENDIF                                                              CLE028
     C                     ENDIF                                                              CLE028
      *                                                                                       CLE028
0843 C**
0844 C   25                Z-ADD99999     VROLLR  50       EVENT NOT REQD.
0845 C  N25                Z-ADDRLDT      VROLLR           ROLLOVER DATE
0846 C**
0847 C***21*************** Z-ADDMATDAT    VMATUR  50                      S01164
0848 C**N21*************** Z-ADDMDAT      VMATUR           MATURITY DATE  S01164
     C*                                                                   S01408
     C/COPY WNCPYSRC,LE0480CP10                                           S01408
     C*                                                                   S01408
     C*                                                                   S01392
     C**  DETERMINE DISCOUNTED LOANS AND SET ROLLOVER DATE.               S01392
     C*                                                                   S01392
     C           *IN21     IFNE '1'                                       S01392
     C           PTYP      ANDEQ63                                        S01392
     C           NROD      ANDNE0                                         S01392
     C           *IN21     ORNE '1'                                                          BUG8378
     C           PTYP      ANDEQ65                                                           BUG8378
     C           NROD      ANDNE0                                                            BUG8378
     C                     Z-ADDNROD      VMATUR                          S01392
     C                     SETON                     66                   S01392
     C                     END                                            S01392
0850 C**   GENERATE EVENTS IN CHRONOLOGICAL ORDER.IF TWO OR MORE DATES
0851 C**   MATCH,THEN THE ORDER IS:
0852 C**   START,AMENDMENT,INTEREST,REPAYMENT,ROLLOVER,MATURITY.
0853 C**
0854 C**   START DATE (IF LOAN NOT YET STARTED)
0855 C                     TESTB'1'       ACEI       41
     C*
     C/COPY WNCPYSRC,LE0480CCP3
     C*
0856 C   41                EXSR START
0857 C   41 U7             GOTO END
     C/COPY WNCPYSRC,LE0480C008
0858 C**
0859 C           SELECT    TAG                             **SELECT TAG**
     C/COPY WNCPYSRC,LE0480C003
0860 C**
0861 C**   LOAN AMENDMENT DATE
0862 C***********VAMEND    COMP VINTR                  4141               S01164
0863 C***41******VAMEND    COMP VREPAY                 4141               S01164
0864 C***41******VAMEND    COMP VROLLR                 4141               S01164
0865 C***41******VAMEND    COMP VMATUR                 4141               S01164
0866 C***41******          EXSR AMEND                                     S01164
0867 C***41*U7***          GOTO END                                       S01164
0868 C***41******          GOTO SELECT                                    S01164
0862 C     N73   VAMEND    COMP VINTR                  4141               S01164
0863 C   41N73   VAMEND    COMP VREPAY                 4141               S01164
0864 C   41N73   VAMEND    COMP VROLLR                 4141               S01164
     C***41N73 63VAMEND    COMP VMATUR                 4141        S01164 S01486
     C***41N73N63VAMEND    COMP CKDAT2                 4141        S01164 S01486
     C*                                                                   S01486
     C* IF EVENT WITH A PORTFOLIO REF. FORCE TEST WITH MATURITY DATE      S01486
     C*                                                                   S01486
     C           *IN64     IFEQ '1'                                       S01486
     C   41N73   VAMEND    COMP VMATUR                 4141               S01486
     C                     ELSE                                           S01486
     C   41N73 63VAMEND    COMP VMATUR                 4141               S01486
     C   41N73N63VAMEND    COMP CKDAT2                 4141               S01486
     C                     END                                            S01486
0866 C   41N73             EXSR AMEND                                     S01164
0867 C   41 U7N73          GOTO END                                       S01164
0868 C   41N73             GOTO SELECT                                    S01164
0869 C**
0870 C**   INTEREST DATE
0871 C***********VINTR     COMP VREPAY                 4141               S01164
0872 C***41******VINTR     COMP VROLLR                 4141               S01164
0873 C***41******VINTR     COMP VMATUR                 4141               S01164
0874 C***41******          EXSR INTRST                                    S01164
0875 C***41*U7***          GOTO END                                       S01164
0876 C***41******          GOTO SELECT                                    S01164
      *                                                                                     MD021819
      ** Compare only when valid                                                            MD021819
      *                                                                                     MD021819
     C           VINTR     IFGE NIDT                                                        MD021819
     C     N74   VINTR     COMP VREPAY                 4141               S01164
     C                     ENDIF                                                            MD021819
0872 C   41N74   VINTR     COMP VROLLR                 4141               S01164
     C***41N74 63VINTR     COMP VMATUR                 4141        S01164 S01486
     C***41N74N63VINTR     COMP CKDAT2                 4141        S01164 S01486
     C*                                                                   S01486
     C* IF EVENT WITH A PORTFOLIO REF. FORCE TEST WITH MATURITY DATE      S01486
     C*                                                                   S01486
     C           *IN64     IFEQ '1'                                       S01486
     C   41N74   VINTR     COMP VMATUR                 4141               S01486
     C                     ELSE                                           S01486
     C   41N74 63VINTR     COMP VMATUR                 4141               S01486
     C   41N74N63VINTR     COMP CKDAT2                 4141               S01486
     C                     END                                            S01486
      *                                                                                       CAS005
      ** Include billing days or ICD in determining the                                       CAS005
      ** maturity date of the call loan                                                       CAS005
      *                                                                                       CAS005
     C                     Z-ADD0         WMATD2  50                                          CAS005
     C                     Z-ADDVINTR     WVINTR  50                                          CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C           MDAT      ANDEQ0                                                             CAS005
     C                     SELEC                                                              CAS005
     C           BLDY      WHNE 0                                                             CAS005
     C           WMATD     ADD  BLDY      WMATD2                                              CAS005
     C           BPNODM    WHNE 0                                                             CAS005
     C           WMATD     ADD  BPNODM    WMATD2                                              CAS005
     C                     OTHER                                                              CAS005
     C           WMATD     ADD  15        WMATD2                                              CAS005
     C                     ENDSL                                                              CAS005
     C           WVINTR    IFGT WMATD2                                                        CAS005
     C                     Z-ADDWMATD2    WVINTR                                              CAS005
     C                     ENDIF                                                              CAS005
     C                     ENDIF                                                              CAS005
      *************************************************************************        CAS005 230229
      ***Only*calculate*for*interest*payment*amount*when:**********************        CAS005 230229
      ***a.)*CAS005*enhancement*is*not*installed*******************************        CAS005 230229
      ***b.)*CAS005*enhancement*is*installed*and*maturity*work*field*is*zero.**        CAS005 230229
      ***c.)*CAS005*enhancement*is*installed*and*maturity*work*field*is*not*zero       CAS005 230229
      *******but*interest*payment*date*less*than*the*maturity*work*field*******        CAS005 230229
      *************************************************************************        CAS005 230229
     C********** CAS005    IFNE 'Y'                                                    CAS005 230229
     C********** CAS005    OREQ 'Y'                                                    CAS005 230229
     C********** WMATD2    ANDEQ0                                                      CAS005 230229
     C********** CAS005    OREQ 'Y'                                                    CAS005 230229
     C********** WMATD2    ANDNE0                                                      CAS005 230229
     C********** WVINTR    ANDLTWMATD2                                                 CAS005 230229
      *                                                                                     MD021819
      ** Terminate interest projection after 2071                                           MD021819
     C           VINTR     IFLT NIDT                                                        MD021819
     C           *IN41     ANDEQ'1'                                                         MD021819
     C           *IN74     ANDEQ'0'                                                         MD021819
     C                     MOVE '0'       *IN41                                             MD021819
     C                     ENDIF                                                            MD021819
      *                                                                                     MD021819
0874 C   41N74             EXSR INTRST                                    S01164
0875 C   41 U7N74          GOTO END                                       S01164
      ***********                                                                  AR679736 MD021819
      ***Terminate*interest*projection*after*2071**********************            AR679736 MD021819
      **********                                                                   AR679736 MD021819
     C********** VINTR     IFGE NIDT                                               AR679736 MD021819
     C********** VINTR     ANDLT99999                                              AR679736 MD021819
     C********** *IN41     ANDEQ'1'                                                AR679736 MD021819
     C********** *IN74     ANDEQ'0'                                                AR679736 MD021819
0876 C***41N74**           GOTO SELECT                                               S01164 AR679736
     C**********           GOTO SELECT                                             AR679736 MD021819
     C**********           ENDIF                                                   AR679736 MD021819
     C**********           ENDIF                                                       CAS005 230229
     C   41N74             GOTO SELECT                                                      MD021819
0877 C**
0878 C**   REPAYMENT DATE
0879 C***********VREPAY    COMP VROLLR                 4141               S01164
0880 C***41******VREPAY    COMP VMATUR                 4141               S01164
0881 C***41******          EXSR REPAY                                     S01164
0882 C***41*U7***          GOTO END                                       S01164
0883 C***41******          GOTO SELECT                                    S01164
      *                                                                                     MD021819
      ** Compare only when valid                                                            MD021819
      *                                                                                     MD021819
     C           VREPAY    IFGE NRPD                                                        MD021819
     C     N75   VREPAY    COMP VROLLR                 4141               S01164
     C                     ENDIF                                                            MD021819
     C***41N75 63VREPAY    COMP VMATUR                 4141        S01164 S01486
     C***41N75N63VREPAY    COMP CKDAT2                 4141        S01164 S01486
     C*                                                                   S01486
     C* IF EVENT WITH A PORTFOLIO REF. FORCE TEST WITH MATURITY DATE      S01486
     C*                                                                   S01486
     C           *IN64     IFEQ '1'                                       S01486
     C   41N75   VREPAY    COMP VMATUR                 4141               S01486
     C                     ELSE                                           S01486
     C   41N75 63VREPAY    COMP VMATUR                 4141               S01486
     C   41N75N63VREPAY    COMP CKDAT2                 4141               S01486
     C                     END                                            S01486
      *                                                                                       CLE028
      ** If last repayment date falls on the same day as maturity                             CLE028
      ** do not generate repayment event anymore for flat rate                                CLE028
      ** personal loans                                                                       CLE028
      *                                                                                       CLE028
     C           CLE028    IFEQ 'Y'                                                           CLE028
     C           PTYP      ANDEQ80                                                            CLE028
     C           *IN75     ANDEQ*OFF                                                          CLE028
     C           *IN41     ANDEQ*ON                                                           CLE028
     C           *IN64     IFEQ *OFF                                                          CLE028
     C           *IN63     ANDEQ*OFF                                                          CLE028
     C           VREPAY    IFEQ CKDAT2                                                        CLE028
     C                     MOVE *OFF      *IN41                                               CLE028
     C                     ENDIF                                                              CLE028
     C                     ELSE                                                               CLE028
     C           VREPAY    IFEQ VMATUR                                                        CLE028
     C                     MOVE *OFF      *IN41                                               CLE028
     C                     ENDIF                                                              CLE028
     C                     ENDIF                                                              CLE028
     C                     ENDIF                                                              CLE028
      *                                                                                       CLE028
     C/COPY WNCPYSRC,LE0480C004
     C*                                                                   S01486
     C           VREPAY    IFLT NRPD                                                        MD021819
     C           *IN41     ANDEQ'1'                                                         MD021819
     C           *IN75     ANDEQ'0'                                                         MD021819
     C                     MOVE '0'       *IN41                                             MD021819
     C                     ENDIF                                                            MD021819
      *                                                                                     MD021819
     C   41N75             EXSR REPAY                                     S01164
     C   41 U7N75          GOTO END                                       S01164
      **********                                                                   AR679736 MD021819
      ***Terminate repayment projection after 2071                                 AR679736 MD021819
      **********                                                                   AR679736 MD021819
     C********** VREPAY    IFGE NRPD                                               AR679736 MD021819
     C********** VREPAY    ANDLT99999                                              AR679736 MD021819
     C********** *IN41     ANDEQ'1'                                                AR679736 MD021819
     C********** *IN75     ANDEQ'0'                                                AR679736 MD021819
     C***41N75**           GOTO SELECT                                               S01164 AR679736
     C**********           GOTO SELECT                                             AR679736 MD021819
     C**********           ENDIF                                                   AR679736 MD021819
     C   41N75             GOTO SELECT                                                      MD021819
     C**
     C**   ROLLOVER DATE
0886 C***********VROLLR    COMP VMATUR                 4141               S01164
     C*********63VROLLR    COMP VMATUR                 4141        S01164 S01486
     C********N63VROLLR    COMP CKDAT2                 4141        S01164 S01486
     C      64N63                                                         S01486
     COR       63VROLLR    COMP VMATUR                 4141               S01486
     C     N64N63VROLLR    COMP CKDAT2                 4141               S01486
     C*                                                                   S01486
     C* IF EVENT WITH A PORTFOLIO REF. FORCE TEST WITH MATURITY DATE      S01486
     C*                                                                   S01486
     C           *IN64     IFEQ '1'                                       S01486
     C           VROLLR    COMP VMATUR                 4141               S01486
     C                     ELSE                                           S01486
     C         63VROLLR    COMP VMATUR                 4141               S01486
     C        N63VROLLR    COMP CKDAT2                 4141               S01486
     C                     END                                            S01486
     C*                                                                   S01486
0887 C   41                EXSR ROLLVR
0888 C   41 U7             GOTO END
      **********                                                                   AR679736 MD021819
      ***Terminate*rollover  projection after 2071                                 AR679736 MD021819
      **********                                                                   AR679736 MD021819
     C********** VROLLR    IFGE RLDT                                               AR679736 MD021819
     C********** VROLLR    ANDLT99999                                              AR679736 MD021819
     C********** *IN41     ANDEQ'1'                                                AR679736 MD021819
0889 C***41*****           GOTO SELECT                                                      AR679736
     C**********           GOTO SELECT                                             AR679736 MD021819
     C**********           ENDIF                                                   AR679736 MD021819
     C   41                GOTO SELECT                                                      MD021819
0890 C**
0891 C**   MATURITY DATE
0892 C***********          EXSR MATUR                                     S01164
0892 C  N76                EXSR MATUR                                     S01164
0893 C**
0894 C           END       TAG                             **END TAG**
0895 C**
      *                                                                                    AR1078776
      **  Write or Update LVNTXZZ                                                          AR1078776
      *                                                                                    AR1078776
     C********** 1         SETLLLVENTZZF                                         AR1078776 AR1095829
     C**********           READ LVENTZZF                 68                      AR1078776 AR1095829
      *                                                                                    AR1078776
     C********** *IN68     IFEQ *ON                                              AR1078776 AR1095829
     C**********           WRITELVENTZZF                                         AR1078776 AR1095829
     C**********           ELSE                                                  AR1078776 AR1095829
     C**********           MOVE COUNT2    LNORE0                                 AR1078776 AR1095829
     C**********           MOVE HSHWN2    LHRWN                                  AR1078776 AR1095829
     C**********           MOVE HSHDC2    LHRDC                                  AR1078776 AR1095829
     C**********           UPDATLVENTZZF                                         AR1078776 AR1095829
     C**********           ENDIF                                                 AR1078776 AR1095829
      *                                                                                    AR1078776
      **  Write or Update EMTE1T1                                                          AR1078776
      *                                                                                    AR1078776
     C********** 1         SETLLEMTE1T1F                                         AR1078776 AR1095829
     C**********           READ EMTE1T1F                 78                      AR1078776 AR1095829
      *                                                                                    AR1078776
     C********** *IN78     IFEQ *ON                                              AR1078776 AR1095829
     C********** *IN61     ANDEQ*OFF                                             AR1078776 AR1095829
     C**********           WRITEEMTE1T1F                                         AR1078776 AR1095829
     C**********           ELSE                                                  AR1078776 AR1095829
     C**********           MOVE TNLER     TNONE                                  AR1078776 AR1095829
     C**********           UPDATEMTE1T1F                                         AR1078776 AR1095829
     C**********           ENDIF                                                 AR1078776 AR1095829
      *                                                                                    AR1078776
      ** Write or Update EMXT1T1                                                           AR1078776
      *                                                                                    AR1078776
     C********** 1         SETLLEMXT1T1F                                         AR1078776 AR1095829
     C**********           READ EMXT1T1F                 88                      AR1078776 AR1095829
      *                                                                                    AR1078776
     C********** *IN88     IFEQ *ON                                              AR1078776 AR1095829
     C********** *IN03     ANDEQ*OFF                                             AR1078776 AR1095829
     C**********           WRITEEMXT1T1F                                         AR1078776 AR1095829
     C**********           ELSE                                                  AR1078776 AR1095829
     C**********           MOVE XNLER     NONE                                   AR1078776 AR1095829
     C**********           MOVE XNLER1    CNLER1  5                              AR1078776 AR1095829
     C**********           MOVE XNLER2    CNLER2  5                              AR1078776 AR1095829
     C********** CNLER1    CAT  CNLER2    ZZ117                                  AR1078776 AR1095829
     C**********           UPDATEMXT1T1F                                         AR1078776 AR1095829
     C**********           ENDIF                                                 AR1078776 AR1095829
      *                                                                          AR1078776 AR1095829
0896 C   U7                SETON                     LR
0897 C**
0898 C**   LAST RECORD PROCESSING
0899 CLRNU8      COUNT1    COMP NORE                 U8U8
0900 CLRNU8      HSHWN1    COMP VLAF                 U8U8
0901 CLRNU8      HSHDC1    COMP VLAL                 U8U8
     CLR         1         SETLLLVENTZZF                                                   AR1078776
     CLR                   READ LVENTZZF                 68                                AR1078776
     CLR         *IN68     IFEQ *OFF                                                       AR1078776
0902 C***LR*****    COUNT2    ADD  1         COUNT2                                        AR1095829
     CLR                   SUB  1         COUNT2                                           AR1095829
     CLR                   ADD  LNORE0    COUNT2                                           AR1095829
     CLR                   Z-ADDLHRWN     ZZAMTI                                           AR1095829
     CLR                   Z-ADDLHRDC     ZZAMTD                                           AR1095829
     CLR                   Z-ADDHSHWN2    ZZTOTI                                           AR1095829
     CLR                   Z-ADDHSHDC2    ZZTOTD                                           AR1095829
     CLR                   EXSR GLZSUM                                                     AR1095829
     CLR                   Z-ADDZZTOTI    HSHWN2                                           AR1095829
     CLR                   Z-ADDZZTOTD    HSHDC2                                           AR1095829
     CLR                   ELSE                                                            AR1095829
     CLR                   ADD  1         COUNT2                                           AR1095829
     CLR                   ENDIF                                                           AR1095829
     CLR         *IN40     IFEQ *ON                                                        AR1095829
     CLR                   MOVE COUNT2    LNORE0                                           AR1095829
     CLR                   MOVE HSHWN2    LHRWN                                            AR1095829
     CLR                   MOVE HSHDC2    LHRDC                                            AR1095829
      *                                                                                    AR1095829
     CLR         *IN68     IFEQ *OFF                                                       AR1095829
     C***LR*****              MOVE COUNT2    LNORE0                              AR1078776 AR1095829
     CLR                   UPDATLVENTZZF                                                   AR1078776
     CLR                   ELSE                                                            AR1095829
     CLR                   MOVE 'T'       LRECI                                            AR1095829
     CLR                   WRITELVENTZZF                                                   AR1095829
     CLR                   ENDIF                                                           AR1095829
     CLR                   ENDIF                                                           AR1095829
      *                                                                                    AR1095829
     CLR         1         SETLLEMTE1T1F                                                   AR1095829
     CLR                   READ EMTE1T1F                 78                                AR1095829
     CLR         *IN78     IFEQ *OFF                                                       AR1095829
     CLR                   ADD  TNONE     TNLER                                            AR1095829
     CLR                   ENDIF                                                           AR1095829
     CLR                   MOVE TNLER     TNONE                                            AR1095829
      *                                                                                    AR1095829
     CLR         *IN78     IFEQ *OFF                                                       AR1095829
     CLR                   UPDATEMTE1T1F                                                   AR1095829
     CLR                   ELSE                                                            AR1095829
     CLR         *IN61     IFEQ *OFF                                                       AR1095829
     CLR                   MOVE 'T'       TRECI                                            AR1095829
     CLR                   MOVE '999999'  TMCUN                                            AR1095829
     CLR                   MOVE 'L'       TRECJ                                            AR1095829
     CLR                   WRITEEMTE1T1F                                                   AR1095829
     CLR                   ENDIF                                                           AR1095829
     CLR                   ENDIF                                                           AR1095829
      *                                                                                    AR1095829
     CLR         1         SETLLEMXT1T1F                                                   AR1095829
     CLR                   READ EMXT1T1F                 88                                AR1095829
     CLR         *IN88     IFEQ *OFF                                                       AR1095829
     CLR                   ADD  NONE      XNLER                                            AR1095829
     C***LR*****              MOVE CNLER1    XNLER1                               AR1095829 MD019933
     C***LR*****              MOVE CNLER2    XNLER2                               AR1095829 MD019933
     CLR         5         SUBSTZZ117:1   CNLER1                                            MD019933
     CLR                   MOVE CNLER1    YNLER1  50                                        MD019933
     CLR         5         SUBSTZZ117:6   CNLER2                                            MD019933
     CLR                   MOVE CNLER2    YNLER2  50                                        MD019933
     CLR                   ADD  YNLER1    XNLER1                                            MD019933
     CLR                   ADD  YNLER2    XNLER2                                            MD019933
     CLR                   ENDIF                                                           AR1095829
     CLR                   MOVE XNLER     NONE                                             AR1095829
     CLR                   MOVE XNLER1    CNLER1                                           AR1095829
     CLR                   MOVE XNLER2    CNLER2                                           AR1095829
     CLR         CNLER1    CAT  CNLER2    ZZ117                                             MD019933
      *                                                                                    AR1095829
     CLR         *IN88     IFEQ *OFF                                                       AR1095829
     CLR                   UPDATEMXT1T1F                                                   AR1095829
     CLR                   ELSE                                                            AR1095829
     CLR         *IN03     IFEQ *OFF                                                       AR1095829
     CLR                   MOVE 'T'       RECI                                             AR1095829
     CLR                   MOVE '999999'  MCUN                                             AR1095829
     CLR                   MOVE 'L'       RECJ                                             AR1095829
     CLR                   Z-ADDNONE      XNLER                                            AR1095829
     C***LR*****    5         SUBSTZZ117:1   CNLER1  5                            AR1095829 MD019933
     C***LR*****              MOVE CNLER1    XNLER1                               AR1095829 MD019933
     C***LR*****    5         SUBSTZZ117:6   CNLER2  5                            AR1095829 MD019933
     C***LR*****              MOVE CNLER2    XNLER2                               AR1095829 MD019933
     CLR                   MOVE XNLER1    CNLER1  5                                         MD019933
     CLR                   MOVE XNLER2    CNLER2  5                                         MD019933
     CLR         CNLER1    CAT  CNLER2    ZZ117                                             MD019933
     CLR                   WRITEEMXT1T1F                                                   AR1095829
     CLR                   ENDIF                                                           AR1095829
     CLR                   ENDIF                                                           AR1078776
      *                                                                                    AR1078776
      **                                                                  S01117
      **   EXECUTE ERROR ROUTINE IF DATABASE ERROR EXISTS                 S01117
      **                                                                  S01117
     CLR         *INU7     IFEQ '1'                                       S01117
     CLR         *INU8     ANDEQ'1'                                       S01117
     CLR                   EXSR *PSSR                                     S01117
     CLR                   END                                            S01117
0903 C********************************************************************
0904 C/SPACE 3
0905 C********************************************************************
0906 C**   SUBROUTINE TO FIND NEXT LIVE LOAN AMENDMENT FOR GIVEN LOAN
0907 C**
0908 C**   CALLED BY: MAIN PROCESSING,SR.AMEND
0909 C**   CALLS    :
0910 C**
0911 C           READ      BEGSR                           **READ**
0912 C**
0913 C           FILRD     TAG                             **FILRD TAG**
0914 C**
0915 C                     SETOF                     56
0916 C                     READ LOAMS                    56
      *                                                                   CEU004
      ***If*feature*CEU004*is*on*********************************** CEU004137920
      **If Settlement ccy for EMU non-blank, set *IN33 *ON, set ccy parm. 137920
      *                                                                   CEU004
     C***********CEU004    IFEQ 'Y'                        If FeaturCEU004137920
     C***********          MOVE SCCY      EMUCC4  3                 CEU004137920
     C***********          ENDIF                                    CEU004137920
      *                                                                   CEU004
0917 C  N56      LNRFLA    COMP LNRF                 56
0918 C  N56      RECI      COMP 'D'                      83
0919 C  N56N83             GOTO FILRD
      *                                                                   137920
      *-------------------------------------------------------------------137920
      * If feature CEU004 is on                                           137920
      * If Settlement ccy for EMU non-blank, set *IN33 *ON, set ccy parm. 137920
      *                                                                   137920
     C           CEU004    IFEQ 'Y'                        If Feature On  137920
     C           *IN56     ANDEQ*OFF                       And on LOAMS   137920
      *                                                                   137920
     C                     MOVE SCCY      EMUCC4  3          Set EMU Ccy  147816
     C           SCCY      IFNE *BLANKS                     If SetCcy # Bl137920
     C***********          MOVE SCCY      EMUCC4  3          Set EMU Ccy  137920 147816
     C                     MOVE *ON       *IN33              Set *IN33 *On137920
     C                     ENDIF                            End If        137920
      *                                                                   137920
     C                     ENDIF                           End If         137920
      *                                                                   CLE031
      ** If feature CLE031 is on                                          CLE031
     C           CLE031    IFEQ 'Y'                                       CLE031
     C           *IN56     ANDEQ*OFF                                      CLE031
     C                     MOVE SCCY      WSCCYL  3                       CLE031
     C                     MOVE PSCYLA    WPSCYL  3                       CLE031
     C                     Z-ADDREXRLA    WREXRL 138                      CLE031
     C                     Z-ADDPEXRLA    WPEXRL 138                      CLE031
     C                     MOVE REXILA    WREXIL  1                       CLE031
     C                     MOVE PEXILA    WPEXIL  1                       CLE031
     C                     ENDIF                                          CLE031
      *-------------------------------------------------------------------137920
0920 C**
0921 C                     ENDSR
0923 C********************************************************************
0924 C**   SUBROUTINE TO ACCESS S/CLINT RECORD 'A'
0925 C**
0926 C**   CALLED BY: MAIN PROCESSING
0927 C**   CALLS    :
0928 C**
0929 C           CUSCHN    BEGSR                           **CUSCHN**
0930 C**
0931 C***********CUSKEY    CHAINCLINT                55                   S01194
     C******               CALL 'AOCUSTR0'                                             S01194 220738
     C                     CALL 'AOCUSTR1'                                                    220738
     C                     PARM '*MSG   ' @RTCD                           S01194
     C                     PARM '*KEY   ' @OPTN                           S01194
     C                     PARM           CUSKEY                          S01194
     C                     PARM           KEYSTS  7                       S01194
     C*****      SDCUST    PARM SDCUST    DSSDY                                        S01194 220738
     C           SDCUST    PARM SDCUST    DSLDY                                               220738
0932 C**N55******RECI      COMP 'D'                  5555                 S01194
     C           @RTCD     COMP *BLANKS              5555                 S01194
     C   55      BBCLST    COMP 'Y'                  5555                                     220738
0933 C**
0934 C** SET UP DATABASE DETAILS IF RECORD NOT FOUND
0935 C   55                MOVE CUSKEY    DBKEY
0936 C***55*********       MOVE 'CLINT'   DBFILE                          S01194
     C   55                MOVE 'SDCUSTPD'DBFILE                          S01194
     C           *IN55     IFEQ '0'                                       LN0251
     C                     MOVELBBCRNM    CRNM                            LN0251
     C                     MOVELBBCRTN    CTWN                            LN0251
     C                     MOVELBBCASC    CASK                            LN0251
     C                     END                                            LN0251
0937 C**
0938 C                     ENDSR
0939 C********************************************************************
0940 C********************************************************************
0941 C*****SUBROUTINE*TO*ACCESS*S/TABLE*-*BASE*RATE*DETAILS****           S01194
0941 C**   SUBROUTINE TO ACCESS SDBSRTPD - BASE RATE DETAILS              S01194
0942 C**
0943 C**   CALLED BY: SR.AMEND,ROLLVR
0944 C**   CALLS    :
0945 C**
0946 C           BRTCHN    BEGSR                           **BRTCHN**
0947 C**
     C           BRTKEY    IFNE 0                                                           CLE075AF
     C                     MOVELCCY       KEYBAS                                            CLE075AF
     C                     MOVE BRTKEY    KEYBAS                                            CLE075AF
     C                     ADD  1         BSRSEQ                                            CLE075AF
     C                     EXSR CHKBRT                                                      CLE075AF
      *                                                                                     CLE075AF
      ** Use details from array if KEYBAS is found, otherwise,                              CLE075AF
      ** retrieve details from program call                                                 CLE075AF
      *                                                                                     CLE075AF
     C           BRTIC     IFEQ 'Y'                                                         CLE075AF
      *                                                                                     CLE075AF
      ** Set occurence to index found from #BRK array                                       CLE075AF
      *                                                                                     CLE075AF
     C           C         OCUR SDBSRT                                                      CLE075AF
      *                                                                                     CLE075AF
     C                     ELSE                                                             CLE075AF
      *                                                                                     CLE075AF
     C           BRTIDX    IFNE 0                                                           CLE075AF
     C                     Z-ADDBRTIDX    C                                                 CLE075AF
     C                     ELSE                                                             CLE075AF
     C                     Z-ADD1         C                                                 CLE075AF
     C                     MOVEA#BRT      #BRS                                              CLE075AF
     C                     SORTA#BRS                                                        CLE075AF
     C                     Z-ADD#BRS,1    BSRKEY                                            CLE075AF
     C           BSRKEY    LOKUP#BRT,C                   42                                 CLE075AF
     C                     ENDIF                                                            CLE075AF
      *                                                                                     CLE075AF
     C           C         OCUR SDBSRT                                                      CLE075AF
      *                                                                                     CLE075AF
0948 C***********BRTKEY    CHAINTABLE                55                   S01194
     C                     MOVELBRTKEY    BKEY2                           S01194
     C                     CALL 'AOBSRTR0'                                S01194
     C***********          PARM '*MSG   ' @RTCD   7                 S01194BHF604
     C                     PARM *BLANKS   @RTCD   7                       BHF604
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C                     PARM CCY       BKEY1   3                       S01194
     C                     PARM           BKEY2   2                       S01194
     C********** SDBSRT    PARM SDBSRT    DSFDY                     S01194CSD006
     C           SDBSRT    PARM SDBSRT    DSSDY                           CSD006
0949 C**N55******RECI      COMP 'D'                  5555                 S01194
     C***********@RTCD     COMP *BLANKS                  55         S01194BHF604
     C********** @RTCD     COMP *BLANKS              5555                            BHF604 CLE075AF
     C           @RTCD     IFNE *BLANKS                                                     CLE075AF
0950 C**
0951 C**   SET UP DATABASE DETAILS IF RECORD NOT FOUND
0952 C***55*****           MOVE BKEY2     DBKEY                                             CLE075AF
0952 C***55*****           MOVELCCY       DBKEY                                             CLE075AF
     C                     MOVE BKEY2     DBKEY                                             CLE075AF
     C                     MOVELCCY       DBKEY                                             CLE075AF
0953 C***55*********       MOVE 'TABLE'   DBFILE                          S01194
     C***55*****           MOVEL'SDBSRTPD'DBFILE                                     S01194 CLE075AF
     C                     MOVEL'SDBSRTPD'DBFILE                                            CLE075AF
     C***55******          MOVEL@OPTN     DBKEY                     S01194BHF604
      *                                                                                     CLE075AF
     C                     ELSE                                                             CLE075AF
      *                                                                                     CLE075AF
     C                     EXSR ADDBRT                                                      CLE075AF
     C                     ENDIF                                                            CLE075AF
     C                     ENDIF                                                            CLE075AF
     C                     ENDIF                                                            CLE075AF
0954 C**
0955 C                     ENDSR
0956 C********************************************************************
0957 C********************************************************************
0958 C**   SUBROUTINE TO CONVERT AN AMOUNT IN ONE CURRENCY
0959 C**   TO AN AMOUNT IN ANOTHER CURRENCY
0960 C**
0961 C**   CALLED BY: SR.EQUIV
0962 C**   CALLS    :
0963 C**
0964 C           XCONVT    BEGSR                           **XCONVT**
     C**                                                                  S01117
     C** FIELD Z CHANGED TO W DUE TO THE FIELD Z BEING USED IN THE        S01117
     C** HOLIDAY SUBROUTINE ZACCH                                         S01117
0965 C**
0966 C***********XDP2      SUB  XDP1      Z       10                      S01117
0967 C***********Z         ADD  4         Z                               S01117
0966 C           XDP2      SUB  XDP1      W       10                      S01117
0967 C           W         ADD  4         W                               S01117
0968 C**
0969 C***********XMDIV     COMP '0'                      80ON=DIVIDE      BHF373
0970 C**N80******XMDIV     COMP 'D'                      80               123333
     C           XMDIV     COMP 'D'                      80               123333
0971 C**
0972 C***80******POWER,Z   DIV  XSPOT     XEFFRT 159                      S01117
0973 C**N80******POWER,Z   MULT XSPOT     XEFFRT                          S01117
0972 C   80      POWER,W   DIV  XSPOT     XEFFRT 159                      S01117
0973 C  N80      POWER,W   MULT XSPOT     XEFFRT                          S01117
0974 C**
0975 C           XAMNT1    MULT XEFFRT    XAMNT2 130H
0976 C**
0977 C                     ENDSR
0978 C********************************************************************
0979 C********************************************************************
0980 C**   SUBROUTINE TO DETERMINE EQUIVALENT AMOUNTS OF EVENT AMOUNT
0981 C**
0982 C**   CALLED BY: SR.DUMMY,PSTDUE,START,AMEND,INTRST,REPAY,MATUR
0983 C**   CALLS    : SR.XCONVT
0984 C**
0985 C           EQUIV     BEGSR                           **EQUIV**
0986 C**
0987 C**   CONVERT AMOUNT TO 'DEALT BASE EQUIV.'
0988 C                     Z-ADDEVAMNT    XAMNT1 130
0989 C                     Z-ADDBCXR      XSPOT  138
0990 C                     MOVE BMDI      XMDIV   1
0991 C                     Z-ADDECCYDP    XDP1    10
0992 C                     Z-ADDBCCYDP    XDP2    10
0993 C                     EXSR XCONVT
0994 C                     Z-ADDXAMNT2    DBEAMT 130       DEALT BASE EQV.
0995 C**
0996 C**   CONVERT AMOUNT TO 'SPOT BASE EQUIV.'
0997 C                     Z-ADDECCYSP    XSPOT
0998 C                     MOVE ECCYMD    XMDIV
0999 C                     EXSR XCONVT
1000 C                     Z-ADDXAMNT2    SBEAMT 130       SPOT BASE EQV.
1001 C**
1002 C**   CONVERT AMOUNT TO 'SPOT LIMITS EQUIV.'
1003 C                     Z-ADDECCYSL    XSPOT
1004 C                     Z-ADDLCCYDP    XDP2
1005 C                     EXSR XCONVT
1006 C                     Z-ADDXAMNT2    SLEAMT 130       SPOT LIMS. EQV.
1007 C**
1008 C                     ENDSR
1009 C********************************************************************
1010 C********************************************************************
1011 C**   SUBROUTINE TO OUTPUT EVENT RECORD TO FILE
1012 C**
1013 C**   CALLED BY:SR.DUMMY,PSTDUE,START,AMEND,INTRST,REPAY,ROLLVR,MATUR
1014 C**   CALLS    : SR.GLZADD
1015 C**
1016 C           RECOUT    BEGSR                           **RECOUT**
1017 C**
      *                                                                                       CLE034
     C                     MOVE *BLANK    WRKSET                                              CLE034
     C           CLE034    IFEQ 'Y'                                                           CLE034
     C           INSIND    IFEQ 1                          Start                              CLE034
     C           STALC     ANDEQ'Y'                                                           CLE034
     C           INSIND    OREQ 2                          Mature                             CLE034
     C           STALC     ANDEQ'Y'                                                           CLE034
     C           INSIND    OREQ 3                                                             CLE034
     C           STALL     ANDEQ'Y'                                                           CLE034
     C           INSIND    OREQ 4                                                             CLE034
     C           *IN50     ANDEQ*OFF                                                          CLE034
     C           STALC     ANDEQ'Y'                                                           CLE034
     C           INSIND    OREQ 4                                                             CLE034
     C           *IN50     ANDEQ*ON                                                           CLE034
     C           STALL     ANDEQ'Y'                                                           CLE034
     C           INSIND    OREQ 5                          Rollover                           CLE034
     C           RSTA      ANDEQ'Y'                                                           CLE034
     C                     EXSR SR34A                                                         CLE034
     C                     MOVE 'Y'       WRKSET  1                                           CLE034
     C                     ELSE                                                               CLE034
     C                     MOVE 'Y'       WRKFLD                                              CLE034
     C                     MOVE 'Y'       WRKPRO  1                                           CLE034
     C                     MOVE '*EOF   ' STALCD                                              CLE034
     C                     ENDIF                                                              CLE034
     C                     ELSE                                                               CLE034
     C                     MOVE 'Y'       WRKFLD                                              CLE034
     C                     MOVE 'Y'       WRKPRO                                              CLE034
     C                     MOVE '*EOF   ' STALCD                                              CLE034
     C                     ENDIF                           End CLE034                         CLE034
      *                                                                                       CLE034
     C           WRKFLD    DOWEQ'Y'                                                           CLE034
     C           STALCD    OREQ *BLANKS                    AOSTALR2 - RTCD                    CLE034
      *                                                                                       CLE034
     C           CLE034    IFEQ 'Y'                                                           CLE034
     C           WRKSET    ANDEQ'Y'                                                           CLE034
     C                     EXSR SR34B                                                         CLE034
     C                     ENDIF                                                              CLE034
      *                                                                                       CLE034
     C           WRKPRO    IFEQ 'Y'                                                           CLE034
      *                                                                                       CLE034
1018 C**   PERFORM RECORD COUNT & HASH TOTALS
1019 C           COUNT2    ADD  1         COUNT2
      *                                                                   CEU004
      ** If feature CEU004 is on                                          CEU004
      ** or if feature CLE031 is on                                       CLE031
      ** If Settlement ccy for EMU non-blank, add 2 to record count.      CEU004
      *                                                                   CEU004
     C           CEU004    IFEQ 'Y'                        If Feature On  CEU004
     C           EMUCCY    ANDNE*BLANKS                                   CEU004
     C           CLE031    OREQ 'Y'                                       CLE031
     C           EMUCCY    ANDNE*BLANKS                                   CLE031
     C           CLE033    IFEQ 'Y'                                                           218992
     C           SET09     ANDEQ'T'                                                           218992
     C           SETTYP    ANDEQ09                                                            218992
     C                     MOVE *OFF      *IN33                                               218992
     C                     ELSE                                                               218992
     C           COUNT2    ADD  2         COUNT2           Incrment Cnt   CEU004
     C                     MOVE *ON       *IN33                           CEU004
     C                     ENDIF                                                              218992
     C                     ELSE                                           134798
     C                     MOVE *OFF      *IN33                           134798
     C                     ENDIF                           EndIf          CEU004
      *                                                                   CEU004
1020 C**
1021 C                     Z-ADDHSHWN2    ZZTOTI
1022 C                     Z-ADDHSHDC2    ZZTOTD
1023 C**
1024 C**   IF AMOUNT IS NEGATIVE,REVERSE SIGN
1025 C           EVAMNT    DIV  1000      ZZAMT        83
1026 C   83                Z-SUBZZAMT     ZZAMT
1027 C                     EXSR GLZADD
1028 C                     Z-ADDZZTOTI    HSHWN2 150
1029 C                     Z-ADDZZTOTD    HSHDC2  30
1030 C*
1031 C***REVERSE*VALUE*OF*IN/OUT*IND.*IF*EVENT************************                      AR375646
1032 C***AMOUNT*NEGATIVE.*********************************************                      AR375646
      *                                                                                     AR375646
      ** Do not reverse value of In/Out indicator for negative amounts.                     AR375646
      *                                                                                     AR375646
1033 C     N83             GOTO MISSIT
1034 C********** INOUT     COMP 'I'                      81                                 AR375646
1035 C********** INOUT     COMP 'O'                      83                                 AR375646
1036 C******81**           MOVE 'O'       INOUT                                             AR375646
1037 C******83**           MOVE 'I'       INOUT                                             AR375646
1038 C*
1039 C*
1040 C           MISSIT    TAG                             ** MISSIT TAG**
     C/COPY WNCPYSRC,LE0480C014
      *                                                                   CLE004
      ** If CLE004 is installed, the incoming/outgoing indicator          CLE004
      ** for internal parts. purchased should be blank                    CLE004
      *                                                                   CLE004
     C           CLE004    IFEQ 'Y'                                       CLE004
     C           WLIPP     IFEQ 'Y'                                       CLE004
     C                     MOVE *BLANKS   INOUT                           CLE004
     C                     MOVE '0'       *IN71                           CLE004
     C                     ENDIF                                          CLE004
     C                     ENDIF                                          CLE004
     C**
     C** CONDITION OUTPUT TO EMTE1 -
     C****CHECK*IF*EVENT*TYPE*IS*M1,*R1,*V1,*V3************************                       CLE134
      ** CHECK IF EVENT TYPE IS M1, R1, V1, V3, P1                                            CLE134
     C*
     C   U1      EVTYPE    COMP 'M1'                     61
     C   U1N61   EVTYPE    COMP 'P1'                     61                                   CLE134
     C   U1N61   EVTYPE    COMP 'R1'                     61
     C   U1N61   EVTYPE    COMP 'V1'                     61
     C   U1N61   EVTYPE    COMP 'V3'                     61
     C   U1N61   EVTYPE    COMP 'X3'                     61                                   CLE139
      *                                                                   CLE004
      ** If CLE004 is installed, check if event type is R7, V5            CLE004
      *                                                                   CLE004
     C           CLE004    IFEQ 'Y'                                       CLE004
     C           *INU1     ANDEQ'1'                                       CLE004
      *                                                                   CLE004
     C           *IN61     IFEQ '0'                                       CLE004
     C           EVTYPE    ANDEQ'R7'                                      CLE004
     C           *IN61     OREQ '0'                                       CLE004
     C           EVTYPE    ANDEQ'V5'                                      CLE004
     C                     MOVE '1'       *IN61                           CLE004
     C                     ENDIF                                          CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE006
      ** If CLE006 is installed, check if event type is R9, V7            CLE006
      ** Include an 'OR' check to CEU020 and *INU1                        CEU020
      *                                                                   CLE006
     C           CLE006    IFEQ 'Y'                                       CLE006
     C           *INU1     ANDEQ'1'                                       CLE006
     C           CEU020    OREQ 'Y'                                       CEU020
     C           *INU1     ANDEQ'1'                                       CEU020
     C           CLE007    OREQ 'Y'                                       CLE015
     C           *INU1     ANDEQ'1'                                       CLE015
      *                                                                   CLE006
     C           *IN61     IFEQ '0'                                       CLE006
     C           EVTYPE    ANDEQ'R9'                                      CLE006
     C           *IN61     OREQ '0'                                       CLE006
     C           EVTYPE    ANDEQ'V7'                                      CLE006
     C                     MOVE '1'       *IN61                           CLE006
     C                     ENDIF                                          CLE006
     C                     ENDIF                                          CLE006
     C**
     C** CHECK IF EVENT DATE IS NEXT WORKING DAY
     C   U1 61   DNWD      COMP EVDATE                   61 ON IF IT IS
     C*                                                                   S01220
     C** Setup 'Subsequent to  Rollover Flag' field depending on          S01220
     C*  Rollover Date                                                    S01220
     C*                                                                   S01220
     C           VROLLR    IFEQ 99999                                     S01220
     C           *IN25     ANDEQ'0'                                       S01220
     C                     MOVE 'Y'       SRLR    1                       S01220
     C                     ELSE                                           S01220
     C                     MOVE 'N'       SRLR                            S01220
     C                     END                                            S01220
     C**
     C** INCREASE RECORD COUNT FOR EMTE1
     C   U1 61             ADD  1         TNLER
     C*
     C*
     C*
     C/COPY WNCPYSRC,LE0480C022
     C           PTFR      IFEQ FCR997                                    131273
     C           PTFR      ANDNE'9997'                                    131273
     C                     MOVE '9997'    PTFR                            131273
     C                     END                                            131273
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C           EVTYPE    IFEQ 'I6'                                                          CAS005
     C           EVTYPE    OREQ 'R4'                                                          CAS005
     C           EVTYPE    OREQ 'R6'                                                          CAS005
     C           EVTYPE    OREQ 'V4'                                                          CAS005
     C           EVTYPE    OREQ 'V6'                                                          CAS005
     C           EVTYPE    OREQ 'M6'                                                          CAS005
     C           EVTYPE    OREQ 'P6'                                                          CLE134
     C                     MOVE *BLANKS   PTFR                                                CAS005
     C                     MOVE *BLANKS   SETTLE                                              CGL029
     C                     Z-ADD*ZEROS    SETTYP                                              CAS005
     C**********           MOVE BLK22     SETTLE                                       CAS005 CGL029
     C                     ENDIF                                                              CAS005
     C                     ENDIF                                                              CAS005
     C/COPY WNCPYSRC,LE0480C023
     C*
     C*
1041 C**
1042 C**   OUTPUT RECORD TO FILE
      *                                                                   S01117
     C                     MOVE CUSNUM    EVCNUM  6                       S01117
     C                     MOVE BRCA      EBRC    3                       S01117
     C                     MOVE BCMPY     ECPY    3                       S01117
     C                     MOVE 'N'       IBRE    1                       S01117
     C                     MOVE 'Y'       ICYE    1                       S01117
     C                     MOVE *OFF      *IN31                           CLE031
      *                                                                   CEU004
      ** If feature CEU004 is on                                          CEU004
      ** or if feature CLE031 is on                                       CLE031
      ** If Settlement ccy for EMU non-blank, perform extra event prcssingCEU004
      * (ignore settlement ccy if SETTYP = 09 and System Value = 'T')                         218782
      *                                                                   CEU004
     C                     MOVE ' '       SIAC    1        Setl Ccy Ind                       CLE038
     C           SETTYP    IFEQ 09                                                            218992
     C                     MOVE 'Y'       SETT09  1                                           218992
     C                     ELSE                                                               218992
     C                     MOVE 'N'       SETT09                                              218992
     C                     ENDIF                                                              218992
     C           CEU004    IFEQ 'Y'                        If Feature On  CEU004
     C           EMUCCY    ANDNE*BLANKS                    And SetCcy # BlCEU004
     C           CLE033    ANDNE'Y'                                                           218782
     C           CLE031    OREQ 'Y'                                       CLE031
     C           EMUCCY    ANDNE*BLANKS                                   CLE031
     C           CLE033    ANDNE'Y'                                                           218782
     C           CLE033    OREQ 'Y'                                                           218782
     C           EMUCCY    ANDNE*BLANKS                                                       218782
     C           SETTYP    ANDNE09                                                            218782
     C           CLE033    OREQ 'Y'                                                           218782
     C           EMUCCY    ANDNE*BLANKS                                                       218782
     C           SET09     ANDNE'T'                                                           218782
      *                                                                   CEU004
     C**********           MOVE SETTLE    EMUSTI 24         Set Stl ins.               CEU004 CGL029
     C                     MOVE SETTLE    EMUSTI            Set Stl ins.                     BUG9175
     C           SETTYP    IFEQ 09                                                            CLE034
     C                     MOVE 'Y'       SETT09  1                                           CLE034
     C                     ELSE                                                               CLE034
     C                     MOVE 'N'       SETT09                                              CLE034
     C                     ENDIF                                                              CLE034
     C                     MOVE *BLANKS   SETTLE            Clr Stl ins BlCEU004
     C                     MOVE *ZEROS    SETTYP            Clr Stl ins   CEU004
     C***********          MOVE 'Y'       IFXC    1      Set SetCcyCEU004 163486
     C                     MOVE 'Y'       SIAC    1        Setl Ccy Ind   163486
      *                                                                   CEU004
     C           INOUT     IFEQ 'I'                         If Inout 'I'  CEU004
     C                     MOVE 'O'       INOUT1  1          Set Inout RvsCEU004
     C                     ELSE                             Else If       CEU004
     C                     MOVE 'I'       INOUT1             Set Inout fldCEU004
     C                     ENDIF                            End If        CEU004
      *                                                                   CEU004
     C                     MOVE EVCODE    EMUEVC  4         Set Evtyp Fld CEU004
     C                     MOVE EVCODE    A1EMU   1         Set Evtyp Fld CEU004
     C           A1EMU     LOKUPTABTYP    TABCOD         34 Fnd Code      CEU004
     C           *IN34     IFEQ *ON                         If fnd in arr CEU004
     C                     MOVE TABCOD    EMUEVC             Set New EvcodCEU004
     C                     ENDIF                            End If        CEU004
      *                                                                   CEU004
     C***********          MOVE EVAMNT    P@FRAM           -Set Amnt Parm CEU004
     C                     Z-ADDEVAMNT    P@FRAM           -Set Amnt Parm CEU004
      *                                                                                       CLE038
      ** If Loan Start or Principal Increase with Settlement Allocations by                   CLE038
      *                                                                                       CLE038
     C                     MOVE 'N'       PROC38  1                                           CLE038
     C           CLE038    IFEQ 'Y'                                                           CLE038
     C           INSIND    IFEQ 1                                                             CLE038
     C           STALC     ANDEQ'Y'                                                           CLE038
     C           INSIND    OREQ 3                                                             CLE038
     C           STALL     ANDEQ'Y'                                                           CLE038
     C           W#PYRC    IFEQ 'P'                                                           CLE038
     C           STPYBA    ANDEQ'A'                                                           CLE038
     C           W#PYRC    OREQ 'R'                                                           CLE038
     C           STRCBA    ANDEQ'A'                                                           CLE038
     C                     MOVE 'Y'       PROC38                                              CLE038
     C                     ENDIF                                                              CLE038
     C                     ENDIF                                                              CLE038
     C                     ENDIF                                                              CLE038
      *                                                                                       CLE038
     C           PROC38    IFEQ 'Y'                                                           CLE038
      *                                                                                       CLE038
      ** Settlement Allocations by Amount are already in Settlement Ccy,                      CLE038
      ** so execute SR38A to convert amounts back into loan currency:                         CLE038
      *                                                                                       CLE038
     C                     MOVE EMUCCY    P@FRCY                                              CLE038
     C                     MOVE CCY       P@TOCY                                              CLE038
     C                     MOVE *OFF      *IN32                                               CLE038
     C           EMUCCY    IFNE CCY                                                           CLE038
     C                     MOVE *ON       *IN32                                               CLE038
     C                     EXSR SR38A                                                         CLE038
     C                     ENDIF                                                              CLE038
     C                     ELSE                                                               CLE038
     C                     MOVE CCY       P@FRCY           -Set FrCcy Prm CEU004
     C                     MOVE EMUCCY    P@TOCY           -Set ToCcy Prm CEU004
      *                                                                   CEU004
     C                     MOVE *ON       *IN32                           CLE031
      *                                                                   CLE031
     C           EMUCCY    IFNE CCY                                       150931
     C*                                                                   150931
     C                     EXSR XCAMT                       Cvrt Amount   CEU004
     C           CLE031    IFEQ 'N'                                       CLE031
     C           CLE031    OREQ 'Y'                                       CLE031
     C           EVINCY    ANDEQ'Y'                                       CLE031
     C           CLE031    OREQ 'Y'                                       CLE031
     C           EMINCY    ANDEQ'Y'                                       CLE031
     C                     MOVE P@OUTA    EMUAMT 130        Set Cvrt Amt  CEU004
     C                     ELSE                                           CLE031
     C                     Z-ADDZAMTCO    EMUAMT                          CLE031
     C                     ENDIF                                          CLE031
      *                                                                   CEU004
     C                     ELSE                                           150931
     C*                                                                   150931
     C                     MOVE EVAMNT    EMUAMT                          150931
     C                     END                                            150931
     C                     ENDIF                                                              CLE038
     C/COPY WNCPYSRC,LE0480C011
     C                     MOVE EMUCCY    XCCY             -Set Ccy Prm   CEU004
     C                     EXSR CCYDSP                      Retrve ccy DtlCEU004
     C                     MOVE XSORT     EMUSRT  20        Set Sort Code CEU004
      *                                                                   CEU004
     C                     ENDIF                           End If         CEU004
      *                                                                   CEU004
     C*                                                                   S01117
1043 C                     EXCPT
     C                     EXSR SRSTAX                                                        CER049
     C*
     C                     SETOF                     61                   BHF090
      **                                                                  S01117
      **   RECORDS OUTPUT WHEN BOOKING BRANCH <> SETTLEMENT BRANCH        S01117
      **    INCREASE THE HASH TOTAL ALSO                                  S01117
      **                                                                  S01117
     C           STLBR     IFNE *BLANKS                                   S01117
     C           SETT09    ANDNE'Y'                                                           CLE034
     C           STLBR     ANDNEBRCA                                      S01117
     C           INOUT     ANDNE*BLANKS                                   S01117
      **                                                                  S01117
      **   PERFORM RECORD COUNT & HASH TOTALS FOR EXTRA MULTIBRANCHING    S01117
      **   EVENT ENTRIES                                                  S01117
     C           COUNT2    ADD  2         COUNT2                          S01117
      *                                                                   CEU004
      ** If feature CEU004 is on                                          CEU004
      ** If Settlement ccy for EMU non-blank, add 2 to record count.      CEU004
      *                                                                   CEU004
     C           CEU004    IFEQ 'Y'                        If Feature On  CEU004
     C           EMUCCY    ANDNE*BLANKS                                   CEU004
     C           CLE031    OREQ 'Y'                                     MD051160
     C           EMUCCY    ANDNE*BLANKS                                 MD051160
     C           COUNT2    ADD  4         COUNT2           Incrment Cnt   CEU004
     C                     ENDIF                           EndIf          CEU004
      *                                                                   CEU004
     C                     Z-ADDHSHWN2    ZZTOTI                          S01117
     C                     Z-ADDHSHDC2    ZZTOTD                          S01117
      **   ENTRY #1                                                       S01117
      **   IF AMOUNT IS NEGATIVE,REVERSE SIGN                             S01117
     C           EVAMNT    DIV  1000      ZZAMT        83                 S01117
     C   83                Z-SUBZZAMT     ZZAMT                           S01117
     C                     EXSR GLZADD                                    S01117
      **   ENTRY #2                                                       S01117
      **   IF AMOUNT IS NEGATIVE,REVERSE SIGN                             S01117
     C           EVAMNT    DIV  1000      ZZAMT        83                 S01117
     C   83                Z-SUBZZAMT     ZZAMT                           S01117
     C                     EXSR GLZADD                                    S01117
      *                                                                   S01117
     C                     Z-ADDZZTOTI    HSHWN2 150                      S01117
     C                     Z-ADDZZTOTD    HSHDC2  30                      S01117
      **                                                                  S01117
      **  OUTPUT INTER-BRANCH EVENT #1                                    S01117
     C                     MOVE CUSNUM    EVCNUM                          S01117
     C           CLE033    IFEQ 'Y'                                       217289
     C           SETTYP    ANDEQ09                                        217289
     C                     MOVE BRCA      EBRC                            217289
     C                     ELSE                                           217289
     C                     MOVE STLBR     EBRC                            S01117
     C                     ENDIF                                          217289
     C                     MOVE SBCMPY    ECPY                            S01117
     C                     MOVE 'Y'       IBRE                            S01117
      *                                                                   S01117
     C           BCMPY     IFEQ SBCMPY                                    S01117
     C                     MOVE 'N'       ICYE                            S01117
     C                     ELSE                                           S01117
     C                     MOVE 'Y'       ICYE                            S01117
     C                     END                                            S01117
      *                                                                   S01117
     C                     EXCPT                                          S01117
      **                                                                  S01117
      **  OUTPUT INTER-BRANCH EVENT #2                                    S01117
     C                     MOVE BBICN     EVCNUM                          S01117
     C                     MOVE *BLANKS   SETAC                           091370
     C                     MOVE *BLANKS   SETNOS                          091370
      *                                                                   S01117
     C           INOUT     IFEQ 'I'                                       S01117
     C                     MOVE 'O'       INOUT                           S01117
     C                     ELSE                                           S01117
     C                     MOVE 'I'       INOUT                           S01117
     C                     END                                            S01117
      *                                                                   S01117
     C                     EXCPT                                          S01117
      *                                                                   S01117
     C                     END                                            S01117
     C                     ENDIF                                                              CLE034
      *                                                                                       CLE034
     C           CLE034    IFEQ 'Y'                                                           CLE034
     C           WRKSET    ANDEQ'Y'                                                           CLE034
     C                     EXSR SR34C                                                         CLE034
     C                     ELSE                                                               CLE034
     C                     MOVE ' '       WRKFLD                                              CLE034
     C                     ENDIF                                                              CLE034
      *                                                                                       CLE034
     C                     ENDDO                                                              CLE034
      *                                                                                       CLE034
     C           CLE034    IFEQ 'Y'                                                           CLE034
     C           WRKSET    ANDEQ'Y'                                                           CLE034
     C                     EXSR SR34E                                                         CLE034
     C                     ENDIF                                                              CLE034
     C**
     C** SET OFF OUTPUT TO EMTE1 INDICATOR
     C*******************  SETOF                     61                   BHF090
     C*
     C*
1044 C**
1045 C                     ENDSR
1046 C********************************************************************
1047 C********************************************************************
1048 C**   SUBROUTINE TO DETERMINE S/LVNTX SETTINGS DEPENDENT UPON
1049 C**   PROCESSING TYPE - 'OTHER DATE','OTHER AMOUNT',INSTRUCTIONS &
1050 C**   'INCOMING/OUTGOING INDICATOR'
1051 C**
1052 C**   CALLED BY: SR.PSTDUE,START,AMEND,INTRST,REPAY,ROLLVR,MATUR
1053 C**   CALLS    :
1054 C**
1055 C           LEVENT    BEGSR                           **LEVENT**
1056 C**
1057 C           EVCODE    LOKUPTAB1      TAB2           57
1058 C  N57                GOTO LEVEND
1059 C                     MOVE TAB2      KEYDS
1060 C**
1061 C**   DETERMINE 'OTHER DATE'
1062 C                     MOVE DAT,ED    EVODAT  50
1063 C**
1064 C**   DETERMINE 'OTHER AMOUNT'
1065 C                     MOVE AMT,EA    EVOAMT 130
1066 C**
1067 C**   SET INDICATOR 71 IF INCOMING/OUTGOING INDICATOR = 'I'
1068 C           INOUT     COMP 'I'                      71
1069 C**
1070 C**   DETERMINE FULL INSTRUCTIONS INDICATOR DEPENDING ON SETTING OF
1071 C**   INSTRUCTIONS INDICATOR
1072 C**   NB.IF SETTING = '4',THEN RE-SET TO '3' IF EVENT IS SOURCED FROM
1073 C**   LOAN AMENDMENT,OTHERWISE RE-SET TO '2'
1074 C           INSIND    COMP 4                        83
1075 C   83 50             Z-ADD3         INSIND
1076 C   83N50             Z-ADD2         INSIND
     C           CLE031    IFEQ 'Y'                                                          218984R
     C           *IN83     ANDEQ'1'                                                          218984R
     C           *IN50     ANDEQ'0'                                                          218984R
     C           EVTYPE    ANDEQ'V3'                                                         218984R
     C                     Z-ADD1         INSIND                                             218984R
     C                     ENDIF                                                             218984R
1077 C**
1078 C**   PROCESSING AS PER LEP0480-AA
1079 C           INSIND    COMP 0                        83
1080 C   83                MOVE ' '       FININD  1        FULL INSTRNS.
     C                     MOVE *BLANKS   SETTLE                                              CGL029
1081 C   83                MOVEL'00'      SETTLE
1082 C***83*****           MOVE BLK22     SETTLE 24        SETT. INSTRNS.                     CGL029
1082 C   83                MOVE *BLANKS   STLBR   3        SETT. BRCH  S. S01117
1083 C   83                GOTO LEVEND
1084 C**
1085 C***********INSIND    COMP 2                    858384               S01392
     C           INSIND    COMP 5                        86               S01392
     C  N86      INSIND    COMP 2                    858384               S01392
1086 C**
1087 C   83                MOVE STARTS    SETTLE           START
1088 C   84                MOVE MATURS    SETTLE           MATURITY
1089 C   85                MOVE AMENDS    SETTLE           AMENDMENT
     C   86                MOVE ROLLOS    SETTLE           ROLLOVER       S01392
1090 C**
1087 C   83                MOVE OSDB      STLBR            START          S01117
1088 C   84                MOVE OMDB      STLBR            MATURITY       S01117
1089 C   85                MOVE OSBR      STLBR            AMENDMENT      S01117
     C   86                MOVE RLBR      STLBR            ROLLOVER       S01392
1090 C**                                                                  BHF524
1088 C           STLBR     IFEQ *BLANKS                                   BHF524
1089 C                     MOVE BRCA      STLBR                           BHF524
1089 C                     END                                            BHF524
     C           CLE034    IFEQ 'Y'                                                           218992
     C           CLE033    ANDEQ'Y'                                                           218992
     C                     EXSR SREXST                                                        218992
     C                     ENDIF                                                              218992
1090 C**                                                                  S01117
      **  ACCESS THE BRANCH INFORMATION OF THE SETTLEMENT BRANCH          S01117
      **  IF THE BOOKING BRANCH <> SETTLEMENT BRANCH AND THE              S01117
      **  SETLLMENT BRANCH IS NON-BLANK                                   S01117
      **                                                                  S01117
     C           STLBR     IFNE *BLANKS                                   S01117
     C           STLBR     ANDNEBRCA                                      S01117
     C           SETTYP    ANDNE09                                                            218992
      *                                                                   S01117
     C* Check whether details for Branch already in array                                     CSC042
     C                     MOVELSTLBR     ##KB                                                CSC042
     C                     EXSR ##CHKB                                                        CSC042
      * If branch is in the array then use the details                                        CSC042
     C           ##FIC     IFEQ 'Y'                        *** B10                            CSC042
     C                     EXSR ##SETB                                                        CSC042
     C                     ELSE                            *** X10                            CSC042
      * If branch is not in the array then get details from DB                                CSC042
     C**********           CALL 'AOBRCHR0'                                             S01117 CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       S01117
     C                     PARM '*KEY   ' @OPTN   7                       S01117
     C                     PARM STLBR     @DSNB   3                       S01117
     C********** SDBRCH    PARM SDBRCH    DSFDY                                        S01117 CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
      *                                                                   S01117
     C           @RTCD     IFNE *BLANKS                                   S01117
     C***********SETTYP    ANDNE09                                                     CLE033 218992
     C                     MOVEL@DSNB     DBKEY            ***************S01117
     C                     MOVEL'SDBRCHPD'DBFILE           * DBERROR 25  *S01117
     C                     Z-ADD25        DBASE            ***************S01117
     C                     SETON                     U7U8LR               S01117
     C                     EXSR *PSSR                                     S01117
     C                     GOTO LEVEND                                    S01117
     C                     ELSE                                                               CSC042
      * Details found on the DB so add them to the array                                      CSC042
      * if the array still has room                                                           CSC042
     C                     EXSR ##ADDB                                                        CSC042
     C                     END                                            S01117
     C                     ENDIF                           *** E10                            CSC042
      *                                                                   S01117
     C                     MOVE CMPYM     SBCMPY  3                       S01117
      *                                                                   S01117
     C                     END                                            S01117
      *                                                                   S01117
     C/COPY WNCPYSRC,LE0480C019
     C           CLE033    IFEQ 'Y'                                       CLE033
     C           SETTYP    ANDEQ09                                        CLE033
     C**********           MOVELP@VL02    W0ACOD  4                                    CLE033 CGL029
     C                     MOVELP@VL02    W0ACOD 10                                           CGL029
     C                     MOVELP@VL01    W0CNUM  6                       CLE033
     C           W0CNUM    CAT  W0ACOD    SETAC                           CLE033
     C                     MOVE '01'      SETAC                           CLE033
     C                     ENDIF                                          CLE033
     C*                                                                   CLE033
1091 C           SETTYP    COMP 0                        83
1092 C**
1093 C           SETTYP    COMP 1                        84
1094 C  N84      SETTYP    COMP 7                        84
1095 C  N84      SETTYP    COMP 8                        84
1096 C   84      SETAC     COMP ' '                      83
1097 C   84N83   SETNOS    COMP ' '                      83
1098 C**
1099 C           SETTYP    COMP 5                        84
1100 C  N84      SETTYP    COMP 14                       84
1101 C  N84      SETTYP    COMP 2                        84
1102 C  N84      SETTYP    COMP 12                       84
1103 C   84      SETAC     COMP ' '                      83
1104 C**
     C/COPY WNCPYSRC,LE0480C020
1104 C**                                                                  CLE033
     C           CLE033    IFEQ 'Y'                                       CLE033
     C           SETTYP    ANDEQ09                                        CLE033
     C           SETAC     ANDNE*BLANKS                                   CLE033
     C                     MOVE *OFF      *IN83                           CLE033
     C                     ENDIF                                          CLE033
1104 C**                                                                  CLE033
1105 C   83                MOVE 'N'       FININD
1106 C  N83                MOVE 'Y'       FININD
1107 C**
1108 C           LEVEND    ENDSR                           ***LEVEND**
1109 C********************************************************************
1110 C********************************************************************
1111 C**   SUBROUTINE TO MAINTAIN ACCRUED INTEREST & TO DETERMINE
1112 C**   INTEREST DUE
1113 C**
1114 C**   CALLED BY: SR.PSTDUE,AMEND,INTRST,REPAY,ROLLVR,MATUR
1115 C**   CALLS    : SR.GLINTC
1116 C**
1117 C           INTCAL    BEGSR                           **INTCAL**
1118 C**
1119 C**   CALCULATE INTEREST FROM LAST EVENT DATE TO THIS VALUE DATE
1120 C**   IF PRINCIPAL LE. 0 OR STOP ACCRUALS ON, INTEREST NOT ACCRUED
1121 C                     Z-ADDLSTEVD    ZIBEG
1122 C                     Z-ADDEVDATE    ZIEND
     C           ADDI      IFEQ 'B'                                       S01392
     C********** ZIBEG     ANDEQVDAT                                                   S01392 245082
     C           ZIEND     ANDEQMDAT                                                          245082
     C           ZIEND     ADD  1         ZIEND                           S01392
     C                     END                                            S01392
1124 C                     Z-ADDCPRINC    ZIAMT      83
1123 C                     Z-ADDINTBAS    ZICALC
1125 C                     Z-ADDEFFINT    ZIRATE
     C*                                                                   S01408
     C/COPY WNCPYSRC,LE0480CCP4                                           S01408
     C*                                                                   S01408
     C   83N59             EXSR GLINTC
     C*                                                                   S01408
     C/COPY WNCPYSRC,LE0480CCP5                                           S01408
     C*                                                                   S01408
     C  N83
     COR 59                Z-ADD0         ZINTR
1128 C**
1129 C**   UPDATE TOTAL ACCRUED INTEREST
1130 C***********TACINT    ADD  ZINTR     TACINT    H                     S01392
     C*                                                                   S01392
     C**  CHECK FOR ROUND DOWN FACILITY.                                  S01392
     C*                                                                   S01392
     C           RDFC      IFEQ 'Y'                                       S01392
     C           TACINT    ADD  ZINTR     TACINT                          S01392
     C                     ELSE                                           S01392
     C           TACINT    ADD  ZINTR     TACINT    H                     S01392
     C                     END                                            S01392
1131 C**
1132 C**   DETERMINE INTEREST DUE
1133 C           TACINT    SUB  INTPPR    INTDUE 130
1134 C           INTDUE    SUB  INTPD     INTDUE
1135 C**
1136 C*****IF*INTEREST*DUE*HAS*OPPOSITE*SIGN*TO*INTEREST*RATE,SET*TO*0*                     AR897086
1137 C********** EFFINT    COMP 0                    83                                     AR897086
1138 C***83***** INTDUE    COMP 0                      83                                   AR897086
1139 C***83*****           Z-ADD0         INTDUE                                            AR897086
1140 C**********                                                                            AR897086
1141 C********** EFFINT    COMP 0                      83                                   AR897086
1142 C***83***** INTDUE    COMP 0                    83                                     AR897086
1143 C***83*****           Z-ADD0         INTDUE                                            AR897086
1144 C**********                                                                            AR897086
1145 C**   UPDATE LAST EVENT DATE
1146 C                     Z-ADDEVDATE    LSTEVD
1147 C**
1148 C                     ENDSR
1149 C********************************************************************
1150 C********************************************************************
1151 C**   SUBROUTINE TO UPDATE EFFECTIVE INTEREST RATE
1152 C**
1153 C**   CALLED BY: SR.AMEND,ROLLVR
1154 C**   CALLS    :
1155 C**
1156 C           NEWINT    BEGSR                           **NEWINT**
1157 C**
1158 C           SPRIND    COMP 'A'                      83
1159 C   83      BRATE     ADD  SPRATE    EFFINT       70
1160 C**
1161 C           SPRIND    COMP 'S'                      83
1162 C   83      BRATE     SUB  SPRATE    EFFINT       70
1163 C**
1164 C           SPRIND    COMP 'P'                      83
1165 C   83      SPRATE    DIV  100       WORK   119
1166 C   83      BRATE     MULT WORK      EFFINT    H  70
1167 C**
1168 C                     ENDSR
      ********************************************************************                    CRE073
      *    SUBROUTINE TO CALCULATE NEW SPREAD RATE                                            CRE073
      *                                                                                       CRE073
      *    CALLED BY: AMEND                                                                   CRE073
      *    CALLS    : ZACALCSPRT                                                              CRE073
      ********************************************************************                    CRE073
      *                                                                                       CRE073
     C           NEWSPR    BEGSR                           **NEWSPR**                         CRE073
      *                                                                                       CRE073
     C           CRE073    IFEQ 'Y'                                                           CRE073
     C                     MOVEL'ZACALCSP'PROG   10                                           CRE073
     C                     MOVE 'RT'      PROG                                                CRE073
     C                     CALL PROG                                                          CRE073
     C                     PARM *BLANKS   W0RTCD                                              CRE073
     C                     PARM           BRATE                                               CRE073
     C                     PARM           CNSP                                                CRE073
     C                     PARM           CNSG                                                CRE073
     C                     PARM           RDMT                                                CRE073
     C                     PARM           RDFD                                                CRE073
     C                     PARM *ZERO     NSRTX  117                                          CRE073
     C                     PARM *ZERO     FRATE  117                                        AR847249
      *                                                                                       CRE073
     C********** FRATE     IFLE 0                                                  AR847249 AR947093
     C********** RDMT      ANDNE*BLANKS                                            AR847249 AR947093
     C**********           MOVEL'*ERROR'  W0RTCD                                   AR847249 AR947093
     C**********           ENDIF                                                   AR847249 AR947093
      *                                                                            AR847249 AR947093
     C           W0RTCD    IFEQ *BLANKS                                                       CRE073
     C                     Z-ADDNSRTX     SPRATE                                              CRE073
     C                     ELSE                                                               CRE073
     C                     MOVEL'LE0480'  DBPGM                                               CRE073
     C                     Z-ADD81        DBASE                                               CRE073
     C                     MOVE *ON       *INU7                                               CRE073
     C                     MOVE *ON       *INU8                                               CRE073
     C                     MOVE *ON       *INLR                                               CRE073
     C                     GOTO END                                                           CRE073
     C                     ENDIF                                                              CRE073
     C                     ENDIF                                                              CRE073
     C                     ENDSR                                                              CRE073
1169 C********************************************************************
      /EJECT                                                                                  228806
      *****************************************************************                       228806
      *****************************************************************                228806 246747
      ***SRFNIN*-*Setup*new*interest*for*floating rates****************                228806 246747
      *****************************************************************                228806 246747
      *****************************************************************                       228806
      **********                                                                       228806 246747
     C********** SRFNIN    BEGSR                                                       228806 246747
      **********                                                                       228806 246747
     C**********           SELEC                                                       228806 246747
     C********** SPRIND    WHEQ 'A'                                                    228806 246747
     C********** WINTR     ADD  SPRATE    WINTR                                        228806 246747
      **********                                                                       228806 246747
     C********** SPRIND    WHEQ 'S'                                                    228806 246747
     C********** WINTR     SUB  SPRATE    WINTR                                        228806 246747
      **********                                                                       228806 246747
     C********** SPRIND    WHEQ 'P'                                                    228806 246747
     C********** SPRATE    DIV  100       WORK                                         228806 246747
     C********** WINTR     MULT WORK      WINTR     H                                  228806 246747
      **********                                                                       228806 246747
     C**********           ENDSL                                                       228806 246747
      **********                                                                       228806 246747
     C**********           ENDSR                                                       228806 246747
1170 C********************************************************************
1171 C**   SUBROUTINE TO GENERATE DUMMY EVENT
1172 C**
1173 C**   CALLED BY: MAIN PROCESSING
1174 C**   CALLS    : SR.EQUIV,RECOUT
1175 C**
1176 C           DUMMY     BEGSR                           **DUMMY**
     C*                                                                   134961
     C                     MOVE *BLANKS   EMUCCY                          134961
1177 C**
1178 C                     MOVE 'A1'      EVTYPE  2        EVENT TYPE
1179 C                     Z-ADD0         EVDATE  50       EVENT DATE
1180 C                     Z-ADDCPAM      EVAMNT 130       EVENT AMOUNT
1181 C                     Z-ADD0         EVODAT           OTHER DATE
1182 C                     Z-ADDOPAM      EVOAMT           OTHER AMOUNT
1183 C**
1184 C**   DETERMINE EQUIVALENT AMOUNTS
1185 C                     EXSR EQUIV
1186 C**
1187 C                     MOVE ' '       FININD  1        FULL INSTRNS.
     C                     MOVE *BLANKS   SETTLE                                              CGL029
1188 C                     MOVEL'00'      SETTLE
1189 C**********           MOVE BLK22     SETTLE           SETT. INSTRNS.                     CGL029
1082 C                     MOVE *BLANKS   STLBR            SETT. BRCH  S. S01117
1190 C**
1191 C                     SETOF                     71
1192 C                     MOVE ' '       INOUT   1        INCOMING/OUTGO.
     C                     Z-ADD0         INSIND                                              CLE034
1193 C**
1194 C                     Z-ADD0         LASEQ   30       AMEND SEQUENCE
1195 C                     MOVE ' '       FREQY   1        FREQUENCY CODE
1196 C                     MOVE 'Y'       AUTOS   1        AUTO SETTLEMENT
     C                     MOVEL*BLANKS   LOTX1                                               218992
     C                     MOVEL*BLANKS   LOTX2                                               218992
     C                     MOVEL*BLANKS   LOTX3                                               218992
     C                     MOVEL*BLANKS   LOTX4                                               218992
     C                     MOVEL*BLANKS   LOTX5                                               CGL029
     C                     MOVEL'00'      LOTX1                                               218992
     C                     MOVEL'00'      LOTX2                                               218992
     C                     Z-ADD*ZEROS    REXRX                                               218992
     C                     Z-ADD*ZEROS    PEXRX                                               218992
1197 C**
1198 C**   OUTPUT RECORD TO FILE
1199 C                     EXSR RECOUT
1200 C**
1201 C                     ENDSR
1202 C********************************************************************
1203 C********************************************************************
1204 C**   SUBROUTINE TO GENERATE PAST DUE EVENT
1205 C**
1206 C**   CALLED BY: MAIN PROCESSING
1207 C**   CALLS    : SR.INTCAL,LEVENT,EQUIV,RECOUT
1208 C**
1209 C           PSTDUE    BEGSR                           **PSTDUE**
     C*                                                                   CEU004
     C***********          MOVE EMUCC2    EMUCCY                   CEU004 134961
     C                     MOVE *BLANKS   EMUCCY                          134961
1210 C**
1211 C**   PERFORM INTEREST CALCULATIONS
1212 C                     Z-ADDRUND      EVDATE           EVENT DATE
1213 C                     EXSR INTCAL
1214 C**
1215 C**   FORMAT EVENT AS PER P/LEVENT
1216 C                     MOVE 'D1'      EVTYPE           EVENT TYPE
1217 C                     EXSR LEVENT
1218 C  N57                SETON                     U7U8  **DATABASE 10**
1219 C  N57                Z-ADD10        DBASE
1220 C  N57                MOVE EVCODE    DBKEY
1221 C**N57******          GOTO PSTEND                                    S01117
     C   U7 U8             GOTO PSTEND                                    S01117
1222 C**
1223 C                     Z-ADDCPAM      EVAMNT           EVENT AMOUNT
1224 C**
1225 C**   DETERMINE EQUIVALENT AMOUNTS
1226 C                     EXSR EQUIV
1227 C**
1228 C                     Z-ADD0         LASEQ            AMEND SEQUENCE
1229 C                     MOVE ' '       FREQY            FREQUENCY CODE
1230 C                     MOVE 'Y'       AUTOS            AUTO SETTLEMENT
1231 C**
     C           INTPD     ADD  PDIN      INTPD                                             MD020854
      *                                                                                     MD020854
     C           CAS005    IFEQ 'Y'                                                         MD020854
     C           WINNTR    ADD  PDNN      WINNTR                                            MD020854
     C                     ENDIF                                                            MD020854
      *                                                                                     MD020854
1232 C**   OUTPUT RECORD TO FILE
1233 C                     EXSR RECOUT
      *                                                                                     AR727923
     C********** INTPD     ADD  PDIN      INTPD                                    AR727923 MD020854
      **********                                                                   AR727923 MD020854
     C********** CAS005    IFEQ 'Y'                                                AR727923 MD020854
     C********** WINNTR    ADD  PDNN      WINNTR                                   AR727923 MD020854
     C**********           ENDIF                                                   AR727923 MD020854
1234 C**
1235 C           PSTEND    ENDSR                           **PSTEND**
1236 C********************************************************************
1237 C********************************************************************
1238 C**   SUBROUTINE TO GENERATE START EVENT(S)
1239 C**
1240 C**   CALLED BY: MAIN PROCESSING
1241 C**   CALLS    : SR.LEVENT,EQUIV,RECOUT
1242 C**
1243 C           START     BEGSR                           **START**
     C*                                                                   CEU004
     C                     MOVE EMUCC2    EMUCCY                          CEU004
      *                                                                   CLE031
      ** If feature CLE031 is on, set up loan sett. ccy fields            CLE031
     C           CLE031    IFEQ 'Y'                                       CLE031
     C                     MOVE 'S'       WSETTL  1                       CLE031
     C                     EXSR LONXCY                                    CLE031
     C                     ENDIF                                          CLE031
1244 C**
1245 C**   FORMAT EVENT AS PER P/LEVENT
1246 C                     MOVE 'V1'      EVTYPE           EVENT TYPE
1247 C                     EXSR LEVENT
1248 C  N57                SETON                     U7U8  **DATABASE 11**
1249 C  N57                Z-ADD11        DBASE
1250 C  N57                MOVE EVCODE    DBKEY
1251 C**N57******          GOTO STREND                                    S01117
     C   U7 U8             GOTO STREND                                    S01117
1252 C**
1253 C                     Z-ADDVDAT      EVDATE           EVENT DATE
1254 C                     Z-ADDCPRINC    EVAMNT           EVENT AMOUNT
      *                                                                                       221708
      ** Subtract interest if discounted loan                                                 221708
      *                                                                                       221708
     C           PTYP      IFEQ 63                                                            221708
     C           PTYP      OREQ 65                                                            221708
     C           PTYP      OREQ 67                                                            221708
     C                     Z-ADDVDAT      ZIBEG                                               221708
     C                     Z-ADDMDAT      ZIEND                                               221708
     C           ADDI      IFEQ 'B'                                                           221708
     C           ZIEND     ADD  1         ZIEND                                               221708
     C                     ENDIF                                                              221708
     C                     Z-ADDCPRINC    ZIAMT                                               221708
     C                     Z-ADDINTBAS    ZICALC                                              221708
     C                     Z-ADDEFFINT    ZIRATE                                              221708
     C/COPY WNCPYSRC,LEH01340
     C                     EXSR GLINTC                                                        221708
     C/COPY WNCPYSRC,LEH01400
     C                     Z-ADDZINTR     TACIN2 130                                          221708
     C           EVAMNT    SUB  TACIN2    EVAMNT                                              221708
     C                     ENDIF                                                              221708
1255 C**
1256 C**   DETERMINE EQUIVALENT AMOUNTS
1257 C                     EXSR EQUIV
1258 C**
1259 C                     Z-ADD0         LASEQ            AMEND SEQUENCE
1260 C                     MOVE ' '       FREQY            FREQUENCY CODE
1261 C                     MOVE 'Y'       AUTOS            AUTO SETTLEMENT
1262 C**
1263 C**   OUTPUT RECORD TO FILE
1264 C                     EXSR RECOUT
1265 C**
1266 C**   DETERMINE IF SECOND EVENT REQUIRED
1267 C                     MOVE 'V2'      EVTYPE           EVENT TYPE
1268 C                     EXSR LEVENT
     C   U7 U8             GOTO STREND                                    S01117
1269 C   57                Z-ADDTOTI      EVAMNT           EVENT AMOUNT
1270 C**
1271 C**   DETERMINE EQUIVALENT AMOUNTS
1272 C   57                EXSR EQUIV
1273 C**
1274 C**   OUTPUT RECORD TO FILE
1275 C   57                EXSR RECOUT
      *                                                                                       CLE028
      ** For flat rate personal loans,                                                        CLE028
      ** generate interest start date event, if add on interest flag is 'Y'                   CLE028
      ** generate charge start date event, if add on charges flag is 'Y'                      CLE028
      *                                                                                       CLE028
     C           CLE028    IFEQ 'Y'                                                           CLE028
     C           PTYP      ANDEQ80                                                            CLE028
      *                                                                                       CLE028
     C           ADIF      IFEQ 'Y'                                                           CLE028
1246 C                     MOVE 'X2'      EVTYPE           EVENT TYPE                         CLE028
1247 C                     EXSR LEVENT                                                        CLE028
     C           *IN57     IFEQ '0'                                                           CLE028
     C                     MOVE '1'       *INU7                                               CLE028
     C                     MOVE '1'       *INU8                                               CLE028
     C                     Z-ADD57        DBASE                                               CLE028
     C                     MOVE EVCODE    DBKEY                                               CLE028
     C                     GOTO STREND                                                        CLE028
     C                     ENDIF                                                              CLE028
     C                     Z-ADDFLTI      EVAMNT                                              CLE028
     C                     EXSR EQUIV                                                         CLE028
     C                     EXSR RECOUT                                                        CLE028
     C           CPRINC    ADD  FLTI      CPRINC                                              CLE028
     C                     ENDIF                                                              CLE028
      *                                                                                       CLE028
     C           ADCF      IFEQ 'Y'                                                           CLE028
     C                     MOVE 'H1'      EVTYPE                                              CLE028
     C                     EXSR LEVENT                                                        CLE028
     C           *IN57     IFEQ '0'                                                           CLE028
     C                     MOVE '1'       *INU7                                               CLE028
     C                     MOVE '1'       *INU8                                               CLE028
     C                     Z-ADD58        DBASE                                               CLE028
     C                     MOVE EVCODE    DBKEY                                               CLE028
     C                     GOTO STREND                                                        CLE028
     C                     ENDIF                                                              CLE028
     C                     Z-ADDCHGA      EVAMNT                                              CLE028
     C                     EXSR EQUIV                                                         CLE028
     C                     EXSR RECOUT                                                        CLE028
     C           CPRINC    ADD  CHGA      CPRINC                                              CLE028
     C                     ENDIF                                                              CLE028
     C                     ENDIF                                                              CLE028
      *                                                                                       CLE028
1276 C**
1277 C**   UPDATE LAST EVENT DATE
1278 C                     Z-ADDEVDATE    LSTEVD
1279 C**
1280 C           STREND    ENDSR                           **STREND**
1281 C********************************************************************
1282 C********************************************************************
1283 C**   SUBROUTINE TO GENERATE AMENDMENT EVENT
1284 C**
1285 C**   CALLED BY: MAIN PROCESSING
1286 C**   CALLS    : SR.INTCAL,BRTCHN,NEWINT,LEVENT,EQUIV,RECOUT,READ
1287 C**
1288 C           AMEND     BEGSR                           **AMEND**
1289 C**
1290 C*****NO*EVENT*TO*BE*GENERATED*IF*AMENDMENT*IS*PAST*DUE***           127048
1291 C***********AMTP      COMP 'PD'                     87               127048
1292 C***87******          GOTO FILERD                                    127048
     C*                                                                   CEU004
     C                     MOVE EMUCC4    EMUCCY                          CEU004
      *                                                                   CLE031
      ** If feature CLE031 is on, set up loan amend. sett. ccy fields     CLE031
     C           CLE031    IFEQ 'Y'                                       CLE031
      *                                                                   CLE031
      ** If amendment type is 'PI'                                        CLE031
     C           AMTP      IFEQ 'PI'                                      CLE031
     C                     MOVE 'S'       WSETTL                          CLE031
     C                     EXSR LAMXCY                                    CLE031
     C                     ENDIF                                          CLE031
      *                                                                   CLE031
      ** If amendment type is 'MR' or 'RE'                                CLE031
     C           AMTP      IFEQ 'MR'                                      CLE031
     C           AMTP      OREQ 'RE'                                      CLE031
     C                     MOVE 'R'       WSETTL                          CLE031
     C                     EXSR LAMXCY                                    CLE031
     C                     ENDIF                                          CLE031
      *                                                                   CLE031
     C                     ENDIF                                          CLE031
1293 C**
1294 C**   PERFORM INTEREST CALCULATIONS
1295 C                     Z-ADDVAMEND    EVDATE           EVENT DATE
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C           MDAT      IFEQ 0                                                             CAS005
     C           BPNODM    ANDNE0                                                             CAS005
     C           MDAT      OREQ 0                                                             CAS005
     C           BLDY      ANDNE0                                                             CAS005
     C                     Z-ADDWMATD     WMATD2                                              CAS005
     C                     SELEC                                                              CAS005
     C           BLDY      WHNE 0                                                             CAS005
     C                     ADD  BLDY      WMATD2                                              CAS005
     C           BPNODM    WHNE 0                                                             CAS005
     C                     ADD  BPNODM    WMATD2                                              CAS005
     C                     OTHER                                                              CAS005
     C                     ADD  15        WMATD2                                              CAS005
     C                     ENDSL                                                              CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
      ** Call new subroutine for All-In-Rate calculations                                     CAS005
      *                                                                                       CAS005
     C                     EXSR SRAIR                                                         CAS005
     C                     ENDIF                                                              CAS005
1296 C                     EXSR INTCAL
      *                                                                                       CAS005
      ** Call new subroutine for Net Treasury Rate calculations                               CAS005
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C                     Z-ADD*ZERO     WEAMT                                               CAS005
     C                     Z-ADD*ZERO     WEDATX                                              CAS005
     C                     MOVE 'N'       WCALL                                               222972
     C                     EXSR SRNTR                                                         CAS005
     C                     ENDIF                                                              CAS005
1297 C**
1298 C**   FOR SPREAD/BASE RATE AMENDMENTS NO EVENT IS REQUIRED,BUT
1299 C**   EFFECTIVE INTEREST RATE IS TO BE UPDATED
1300 C           AMTP      COMP 'BC'                     87
1301 C  N87                GOTO SPREAD
1302 C           BRTTLA    COMP 0                    87
1303 C***87*********       MOVE BRTTLA    BRTKEY                          S01194
1303 C   87                MOVE BRTTLA    BRTKEY  20                      S01194
1304 C   87                EXSR BRTCHN
1305 C   87 55             SETON                     U7U8  **DATABASE 12**
1306 C   87 55             Z-ADD12        DBASE
1307 C   87 55             GOTO ENDAM
1308 C**
1309 C   87                Z-ADDBRTE      BRATE            BASE RATE
1310 C  N87                Z-ADD0         BRATE            BASE RATE
      *                                                                                       CLE036
     C           CLE036    IFEQ 'Y'                                                           CLE036
     C           *IN87     ANDEQ'O'                                                           CLE036
     C           RTSPLA    ANDNE0                                                             CLE036
     C                     Z-ADDRTSPLA    BRATE                                               CLE036
     C                     ENDIF                                                              CLE036
      *                                                                                       CRE073
     C                     EXSR NEWSPR                                                        CRE073
      *                                                                                       CLE036
1311 C                     EXSR NEWINT
      *                                                                                       226261
      ** For Base rate change, rate is unknown for next interest calculations.                226261
      *                                                                                       226261
     C           CAS005    IFEQ 'Y'                                                           226261
     C           AMTP      IFEQ 'BC'                                                          226261
     C           BRTTLA    ANDNE0                                                             226261
     C                     MOVE 'N'       WFXDR                                               226261
     C                     ENDIF                                                              226261
     C                     ENDIF                                                              226261
1312 C                     GOTO FILERD
1313 C**
1314 C           SPREAD    TAG                             **SPREAD TAG**
1315 C           AMTP      COMP 'SC'                     87
1316 C   87                Z-ADDRTSPLA    SPRATE           SPREAD RATE
1317 C   87                EXSR NEWINT
1318 C   87                GOTO FILERD
1319 C**
1320 C**   GENERATE EVENT FOR PRINCIPAL INCREASE
1321 C           AMTP      COMP 'PI'                     50
1322 C  N50                GOTO REPAYT
1323 C**
1324 C**   FORMAT EVENT AS PER P/LEVENT
     C           GPRT1     IFEQ 'F'                                                           CLE139
     C                     MOVE 'X3'      EVTYPE           EVENT TYPE                         CLE139
     C                     ELSE                                                               CLE139
1325 C                     MOVE 'V3'      EVTYPE           EVENT TYPE
     C                     ENDIF                                                              CLE139
     C                     Z-ADDPRAM      EVAMNT           EVENT AMOUNT                       226542
1326 C                     EXSR LEVENT
1327 C  N57                SETON                     U7U8  **DATABASE 13**
1328 C  N57                Z-ADD13        DBASE
1329 C  N57                MOVE EVCODE    DBKEY
1330 C**N57******          GOTO ENDAM                                     S01117
     C   U7 U8             GOTO ENDAM                                     S01117
1331 C**
1332 C**********           Z-ADDPRAM      EVAMNT           EVENT AMOUNT                       226542
1333 C**
1334 C**   DETERMINE EQUIVALENT AMOUNTS
1335 C                     EXSR EQUIV
1336 C**
1337 C                     MOVE LASN      LASEQ            AMEND SEQUENCE
1338 C                     MOVE ' '       FREQY            FREQUENCY CODE
1339 C                     MOVE 'Y'       AUTOS            AUTO SETTLEMENT
1340 C**
1341 C**   OUTPUT RECORD TO FILE
1342 C                     EXSR RECOUT
      *                                                                                       CAS005
      ** Generate V4 Events for CAS005 enhancement                                            CAS005
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C           PTYP      ANDNE70                                                            CAS005
     C           PTYP      ANDNE71                                                            CAS005
     C           PTYP      ANDNE72                                                            CAS005
      *                                                                                       CAS005
     C                     Z-ADDEVAMNT    WEAMNT                                              CAS005
     C                     Z-ADDPRAM      EVAMNT                                              CAS005
      *                                                                                       CAS005
     C                     MOVE 'V4'      EVTYPE                                              CAS005
     C                     EXSR LEVENT                                                        CAS005
      *                                                                                       CAS005
      ** IF 'V4' event type not found, issue database error                                   CAS005
      *                                                                                       CAS005
     C           *IN57     IFEQ *OFF                                                          CAS005
     C                     MOVE *ON       *INU7                                               CAS005
     C                     MOVE *ON       *INU8                                               CAS005
     C                     Z-ADD60        DBASE                                               CAS005
     C                     MOVE EVCODE    DBKEY                                               CAS005
     C                     GOTO ENDAM                                                         CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
      ** Determine Equivalent Amounts                                                         CAS005
      *                                                                                       CAS005
     C                     EXSR EQUIV                                                         CAS005
      *                                                                                       CAS005
     C                     Z-ADDLASN      LASEQ                                               CAS005
     C                     MOVE ' '       FREQY                                               CAS005
     C                     MOVE 'Y'       AUTOS                                               CAS005
      *                                                                                       CAS005
      ** Output 'V4' event type to File                                                       CAS005
      *                                                                                       CAS005
     C                     Z-ADDEFFINT    WEFF                                                223752
     C                     Z-ADDWINTR     EFFINT                                              223752
      *                                                                                       223752
      ** Do not generate EMU events for CAS005 event code. Save EMUCCY.                       226512
      *                                                                                       226512
     C                     MOVE EMUCCY    TEMUCY  3                                           226512
     C                     MOVE *BLANKS   EMUCCY                                              226512
      *                                                                                       226512
     C                     EXSR RECOUT                                                        CAS005
      *                                                                                       223752
     C                     Z-ADDWEFF      EFFINT                                              223752
     C                     MOVE TEMUCY    EMUCCY                                              226512
      *                                                                                       CAS005
     C           WCPNTR    ADD  PRAM      WCPNTR                                              CAS005
     C                     Z-ADDWEAMNT    EVAMNT                                              CAS005
     C                     ENDIF                                                              CAS005
1343 C**
1344 C**   UPDATE CURRENT PRINCIPAL
1345 C           CPRINC    ADD  PRAM      CPRINC           CURRENT PRINC.
1346 C                     GOTO FILERD
1347 C**
1348 C**   GENERATE EVENT(S) FOR REPAYMENTS
1349 C           REPAYT    TAG                             **REPAYT TAG**
      *                                                                   CLE004
      ** If CLE004 is installed, check for amendment types 'PT'           CLE004
      ** and 'PF'                                                         CLE004
      *                                                                   CLE004
     C           CLE004    IFEQ 'Y'                                       CLE004
      *                                                                   CLE004
      ** Generate event for 'Transfer of Principal to'                    CLE004
      *                                                                   CLE004
     C           AMTP      IFEQ 'PT'                                      CLE004
     C                     EXSR SRPRTO                                    CLE004
     C                     GOTO FILERD                                    CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
      ** Generate event for 'Transfer of Principal from'                  CLE004
      *                                                                   CLE004
     C           AMTP      IFEQ 'PF'                                      CLE004
     C                     EXSR SRPRFR                                    CLE004
     C                     GOTO FILERD                                    CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
      *                                                                   CLE004
      ** Generate event for Future dated 'Manual Repayment' if            127735
      ** Customer Lending Enhancement Tranche 3 is switched on            127735
      *                                                                   127735
     C           CLE005    IFEQ 'Y'                                       127735
     C           AMTP      ANDEQ'MR'                                      127735
     C                     MOVEL'1'       *IN50                                               218984
     C                     EXSR MANREP                                    127735
     C                     GOTO FILERD                                    127735
     C                     ENDIF                                          127735
      *                                                                   127735
1350 C           AMTP      COMP 'RE'                     50
1351 C   50                EXSR REPAY
1352 C           FILERD    TAG                             **FILERD TAG**
1353 C**
1354 C**   READ NEXT LOAN AMENDMENT RECORD
1355 C                     EXSR READ
1356 C   56                Z-ADD99999     VAMEND           EVENT NOT REQD.
1357 C  N56                Z-ADDVDATLA    VAMEND           AMEND DATE
1358 C**
1359 C**   RESET LOAN AMEND. INDICATOR
1360 C                     SETOF                     50
1361 C**
1362 C           ENDAM     ENDSR                           **ENDAM**
1363 C********************************************************************
1364 C********************************************************************
1365 C**   SUBROUTINE TO GENERATE INTEREST EVENT
1366 C**
1367 C**   CALLED BY: MAIN PROCESSING
1368 C*****CALLS****:*SR.INTCAL,LEVENT,EQUIV,RECOUT,ZFREQB,ZDATE5*********S01195
     C**   CALLS    : SR.INTCAL,LEVENT,EQUIV,RECOUT,FREQB,ZFWDT           S01195
1369 C**
1370 C           INTRST    BEGSR                           **INTRST**
     C*                                                                   CEU004
     C                     MOVE EMUCC2    EMUCCY                          CEU004
      *                                                                   CLE031
      ** If feature CLE031 is on, set up loan sett. ccy fields            CLE031
     C           CLE031    IFEQ 'Y'                                       CLE031
      *                                                                                      218984R
      ** Ensure that the settlement details have been set up, so that                        218984R
      ** the check for settlement method 09 is done correctly.                               218984R
      *                                                                                      218984R
     C           CLE033    IFEQ 'Y'                                                          218984R
     C           SETTLE    IFEQ *BLANKS                                                      218984R
     C           SETTYP    OREQ 0                                                            218984R
     C           *IN54     IFEQ '0'                                                          218984R
     C                     MOVE 'I2'      EVTYPE           EVENT TYPE                        218984R
     C                     ELSE                                                              218984R
     C                     MOVE 'X2'      EVTYPE                                             218984R
     C                     MOVE *BLANKS   EMUCCY                                             218984R
     C                     ENDIF                                                             218984R
     C                     EXSR LEVENT                                                       218984R
     C                     ENDIF                                                             218984R
     C                     ENDIF                                                             218984R
     C                     MOVE 'R'       WSETTL                          CLE031
     C                     EXSR LONXCY                                    CLE031
     C                     ENDIF                                          CLE031
1371 C**
1372 C**   PERFORM INTEREST CALCULATIONS
1373 C                     Z-ADDVINTR     EVDATE           EVENT DATE
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C           MDAT      IFEQ 0                                                             CAS005
     C           BPNODM    ANDNE0                                                             CAS005
     C           MDAT      OREQ 0                                                             CAS005
     C           BLDY      ANDNE0                                                             CAS005
     C                     Z-ADDWMATD     WMATD2                                              CAS005
     C                     SELEC                                                              CAS005
     C           BLDY      WHNE 0                                                             CAS005
     C                     ADD  BLDY      WMATD2                                              CAS005
     C           BPNODM    WHNE 0                                                             CAS005
     C                     ADD  BPNODM    WMATD2                                              CAS005
     C                     OTHER                                                              CAS005
     C                     ADD  15        WMATD2                                              CAS005
     C                     ENDSL                                                              CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
      ** Call new subroutine for All-In-Rate calculations                                     CAS005
      *                                                                                       CAS005
     C                     EXSR SRAIR                                                         CAS005
     C                     ENDIF                                                              CAS005
1374 C                     EXSR INTCAL
     C/COPY WNCPYSRC,LE0480C026
      *****************************************************************               133914 BUG8552
      ***For*CLE005,*if*payment*taken*date*is*'P',*find*previous*******               133914 BUG8552
      ***working*day*if*holiday,*if*'N',*find*next*working*day*if******               133914 BUG8552
      ***holiday,*if*'M',*interest*payment*day*would*be*next*freq******               133914 BUG8552
      ***even*if*a*holiday.********************************************               133914 BUG8552
      *****************************************************************               133914 BUG8552
     C********** CLE005    IFEQ 'Y'                                                   133914 BUG8552
     C**********           Z-ADD*ZERO     ZNRDYS                                      133914 BUG8552
     C**********           Z-ADDVINTR     ZDAYNO                                      133914 BUG8552
     C**********           MOVE CCY       ZCCY                                        192896 BUG8552
      **If*CEU004*on*use*Settlement*ccy*if*not*blank*******************               192896 BUG8552
     C********** CEU004    IFEQ 'Y'                                                   192896 BUG8552
     C********** CLE031    OREQ 'Y'                                                   CLE031 BUG8552
     C********** EMUCCY    IFNE *BLANKS                                               192896 BUG8552
     C**********           MOVE EMUCCY    ZCCY                                        192896 BUG8552
     C**********           ENDIF                                                      192896 BUG8552
     C**********           ENDIF                                                      192896 BUG8552
     C**N77*****           EXSR MATLOC                                                192896 BUG8552
     C**********           MOVE W@MDSL    ZLOC                                        192896 BUG8552
     C**********           SELEC                                                      133914 BUG8552
     C********** PTDI      WHEQ 'P'                                                   133914 BUG8552
     C**********           EXSR ZBKDT                                                 133914 BUG8552
     C********** PTDI      WHEQ 'N'                                                   133914 BUG8552
     C********** PTDI      OREQ *BLANK                                                133914 BUG8552
     C**********           EXSR ZFWDT                                                 133914 BUG8552
     C********** PTDI      WHEQ 'M'                                                   133914 BUG8552
     C**********           EXSR ZDATE2                                                133914 BUG8552
     C********** *IN98     IFEQ *OFF                                                  133914 BUG8552
     C**********           MOVE ZDATE     MMYY    40P                                 133914 BUG8552
     C**********           MOVELMMYY      MMNLCD  20P                                 133914 BUG8552
     C**********           ELSE                                                       133914 BUG8552
     C**********           MOVELZDATE     MMNLCD    P                                 133914 BUG8552
     C**********           ENDIF                                                      133914 BUG8552
     C**********           Z-ADDZDAYNO    @DAYNO  50                                  133914 BUG8552
     C**********           EXSR ZFWDT                                                 133914 BUG8552
     C**********           Z-ADDZDYNBR    ZDAYNO                                      133914 BUG8552
     C**********           EXSR ZDATE2                                                133914 BUG8552
     C********** *IN98     IFEQ *OFF                                                  133914 BUG8552
     C**********           MOVE ZDATE     MMYY      P                                 133914 BUG8552
     C**********           MOVELMMYY      MMNWKD  20P                                 133914 BUG8552
     C**********           ELSE                                                       133914 BUG8552
     C**********           MOVELZDATE     MMNWKD    P                                 133914 BUG8552
     C**********           ENDIF                                                      133914 BUG8552
     C********** MMNLCD    IFNE MMNWKD                                                133914 BUG8552
     C**********           Z-ADD@DAYNO    ZDAYNO                                      133914 BUG8552
     C**********           EXSR ZBKDT                                                 133914 BUG8552
     C**********           ENDIF                                                      133914 BUG8552
     C**********           ENDSL                                                      133914 BUG8552
     C**********           Z-ADDZDYNBR    EVDATE                                      133914 BUG8552
     C**********           ENDIF                                                      133914 BUG8552
      *                                                                                       244961
      ** Include interest pay'ts that are valuing on holiday but with                         244961
      ** INDATE on next working date on the projected account movements.                      244961
      *                                                                                       244961
     C           CLE005    IFEQ 'Y'                                                           244961
     C                     Z-ADD*ZERO     ZNRDYS                                              244961
     C**********           Z-ADDVREPAY    ZDAYNO                                       244961 245427
     C                     Z-ADDVINTR     ZDAYNO                                              245427
     C                     MOVE CCY       ZCCY                                                244961
      * If CEU004 on use Settlement ccy if not blank                                          244961
     C           CEU004    IFEQ 'Y'                                                           244961
     C           EMUCCY    IFNE *BLANKS                                                       244961
     C                     MOVE EMUCCY    ZCCY                                                244961
     C                     ENDIF                                                              244961
     C                     ENDIF                                                              244961
     C           *IN77     IFEQ '0'                                                           244961
     C                     EXSR MATLOC                                                        244961
     C                     ENDIF                                                              244961
     C                     MOVE W@MDSL    ZLOC                                                244961
      *                                                                                       CLE141
      ** Call Business Day Convention for Lending Transaction                                 CLE141
      *                                                                                       CLE141
     C           CLE141    IFEQ 'Y'                                                           CLE141
     C********** MDST      ANDEQ01                                                    CLE141 CLE141A
     C********** CLE141    OREQ 'Y'                                                   CLE141 CLE141A
     C********** MDST      ANDEQ07                                                    CLE141 CLE141A
     C********** CLE141    OREQ 'Y'                                                   CLE141 CLE141A
     C********** MDST      ANDEQ08                                                    CLE141 CLE141A
     C                     CALL 'LEZBDYCD'                                                    CLE141
     C                     PARM           ZDAYNO                                              CLE141
     C                     PARM           PICUR                                               CLE141
     C                     PARM           PILOC                                               CLE141
     C                     PARM PTDI      PPDDI   1                                           CLE141
     C                     PARM           DATF                                                CLE141
     C                     PARM ZCCY      PCCY                                               CLE141A
     C                     PARM ZLOC      PLOC                                               CLE141A
     C                     PARM           ZDYNBR                                              CLE141
     C                     ELSE                                                               CLE141
     C                     SELEC                                                              244961
     C           PTDI      WHEQ 'P'                                                           244961
     C                     EXSR ZBKDT                                                         244961
     C           PTDI      WHEQ 'N'                                                           244961
     C           PTDI      OREQ *BLANK                                                        244961
     C                     EXSR ZFWDT                                                         244961
     C           PTDI      WHEQ 'M'                                                           244961
     C                     EXSR ZDATE2                                                        244961
     C           *IN98     IFEQ *OFF                                                          244961
     C                     MOVE ZDATE     MMYY    40P                                         244961
     C                     MOVELMMYY      MMNLCD  20P                                         244961
     C                     ELSE                                                               244961
     C                     MOVELZDATE     MMNLCD    P                                         244961
     C                     ENDIF                                                              244961
     C                     Z-ADDZDAYNO    @DAYNO  50                                          244961
     C                     EXSR ZFWDT                                                         244961
     C                     Z-ADDZDYNBR    ZDAYNO                                              244961
     C                     EXSR ZDATE2                                                        244961
     C           *IN98     IFEQ *OFF                                                          244961
     C                     MOVE ZDATE     MMYY      P                                         244961
     C                     MOVELMMYY      MMNWKD  20P                                         244961
     C                     ELSE                                                               244961
     C                     MOVELZDATE     MMNWKD    P                                         244961
     C                     ENDIF                                                              244961
     C           MMNLCD    IFNE MMNWKD                                                        244961
     C                     Z-ADD@DAYNO    ZDAYNO                                              244961
     C                     EXSR ZBKDT                                                         244961
     C                     ENDIF                                                              244961
     C                     ENDSL                                                              244961
     C                     ENDIF                                                              CLE141
     C                     Z-ADDZDYNBR    EVDATE                                              244961
     C                     ENDIF                                                              244961
1375 C**
1376 C**   FORMAT EVENT AS PER P/LEVENT
     C**   IF INTEREST IS CAPITALISED USE EVENT TYPE 'X2' INSTEAD         E25263
     C           *IN54     IFEQ '0'                                       E25263
1377 C                     MOVE 'I2'      EVTYPE           EVENT TYPE
     C                     ELSE                                           E25263
     C                     MOVE 'X2'      EVTYPE                          E25263
     C                     MOVE *BLANKS   EMUCCY                          134961
     C                     END                                            E25263
1378 C                     EXSR LEVENT
1379 C  N57                SETON                     U7U8  **DATABASE 14**
1380 C  N57                Z-ADD14        DBASE
1381 C  N57                MOVE EVCODE    DBKEY
1382 C**N57*******         GOTO INTEND                                    S01117
     C   U7 U8             GOTO INTEND                                    S01117
1383 C**
1384 C                     Z-ADDINTDUE    EVAMNT           EVENT AMOUNT
1385 C**
1386 C**   DETERMINE EQUIVALENT AMOUNTS
1387 C                     EXSR EQUIV
1388 C**
1389 C                     Z-ADD0         LASEQ            AMEND SEQUENCE
1390 C                     MOVE IPFR      FREQY            FREQUENCY CODE
1391 C                     MOVE AUTO      AUTOS            AUTO SETTLEMENT
1392 C**
1393 C**   OUTPUT RECORD TO FILE
1394 C                     EXSR RECOUT
      *                                                                                       CAS005
      ** Generate I6 Events for CAS005 enhancement                                            CAS005
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C           PTYP      ANDNE70                                                            CAS005
     C           PTYP      ANDNE71                                                            CAS005
     C           PTYP      ANDNE72                                                            CAS005
     C                     Z-ADDEVAMNT    WEAMNT                                              CAS005
      *                                                                                       CAS005
      ** Call new subroutine for Net Treasury Rate calculations                               CAS005
      *                                                                                       CAS005
     C                     Z-ADD*ZERO     WEAMT                                               CAS005
     C                     Z-ADD*ZERO     WEDATX                                              CAS005
     C                     MOVE 'N'       WCALL                                               222972
     C                     EXSR SRNTR                                                         CAS005
     C                     Z-ADDWNTRIN    EVAMNT                                              CAS005
      *                                                                                       CAS005
     C                     MOVE 'I6'      EVTYPE                                              CAS005
     C                     EXSR LEVENT                                                        CAS005
      *                                                                                       CAS005
      ** IF 'I6' event type not found, issue database error                                   CAS005
      *                                                                                       CAS005
     C           *IN57     IFEQ *OFF                                                          CAS005
     C                     MOVE *ON       *INU7                                               CAS005
     C                     MOVE *ON       *INU8                                               CAS005
     C                     Z-ADD57        DBASE                                               CAS005
     C                     MOVE EVCODE    DBKEY                                               CAS005
     C                     GOTO INTEND                                                        CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
      ** Determine Equivalent Amounts                                                         CAS005
      *                                                                                       CAS005
     C                     EXSR EQUIV                                                         CAS005
      *                                                                                       CAS005
     C                     Z-ADD0         LASEQ                                               CAS005
     C                     MOVE IPFR      FREQY                                               CAS005
     C                     MOVE AUTO      AUTOS                                               CAS005
      *                                                                                       CAS005
      ** Output 'I6' event type to File                                                       CAS005
      *                                                                                       CAS005
     C                     Z-ADDEFFINT    WEFF   117                                          223752
     C                     Z-ADDWINTR     EFFINT                                              223752
      *                                                                                       223752
     C                     MOVE EMUCCY    TEMUCY                                              226512
     C                     MOVE *BLANKS   EMUCCY                                              226512
      *                                                                                       226512
     C                     EXSR RECOUT                                                        CAS005
      *                                                                                       223752
     C                     Z-ADDWEFF      EFFINT                                              223752
     C                     MOVE TEMUCY    EMUCCY                                              226512
      *                                                                                       CAS005
     C           *IN54     IFEQ '1'                                                           CAS005
     C           WCPNTR    ADD  WNTRIN    WCPNTR                                              CAS005
     C                     ENDIF                                                              CAS005
     C           WINNTR    ADD  WNTRIN    WINNTR                                              CAS005
     C                     Z-ADDWEAMNT    EVAMNT                                              CAS005
     C                     ENDIF                                                              CAS005
1395 C**
1396 C**   UPDATE CURRENT PRINCIPAL IF INTEREST TO BE CAPITALIZED
1397 C**   UPDATE INTEREST PAID THIS RUN
1398 C   54      CPRINC    ADD  INTDUE    CPRINC           CURRENT PRINC.
1399 C**
1400 C           INTPD     ADD  INTDUE    INTPD            INT.PD.THIS RUN
1401 C**
1402 C**   UPDATE NEXT INTEREST DATE & BASE DATE
1403 C***********IPFR      COMP ' '                      87               180161
      *  RESET *IN87                                                                          199038
     C                     MOVE '0'       *IN87                                               199038
      *                                                                                       199038
     C           IPFR      IFEQ ' '                                       180161
     C           IPFR      OREQ 'R'                                       180161
     C           RLFQ      ANDEQ' '                                       180161
     C           CLE005    ANDEQ'Y'                                       180161
     C                     MOVE '1'       *IN87                           180161
     C                     ENDIF                                          180161
      *                                                                   180161
1404 C   87                Z-ADD99999     VINTR            INTEREST DATE
1405 C   87                GOTO INTEND
1406 C***********          MOVE 'Y'       ZOPT                            S01195
1407 C                     MOVE IPFR      ZFREQ
1408 C                     Z-ADDINTBD     ZDAYNO
1409 C                     Z-ADDIFDY      ZMDAY
1410 C                     MOVE CCY       ZCCY
      *                                                                   180161
      ** If CLE005 is *ON and interest payment frequency is 'R', means    180161
      ** 'at rollover' - actual interest frequency and interest payment   180161
      ** date will be the same as rollover setup.                         180161
      *                                                                   180161
     C           CLE005    IFEQ 'Y'                                       180161
     C           IPFR      ANDEQ'R'                                       180161
     C                     MOVE RLFQ      ZFREQ                           180161
     C                     Z-ADDRLDY      ZMDAY                           180161
     C                     ENDIF                                          180161
      *                                                                   CEU004
      ** If feature CEU004 is on                                          CEU004
      ** or if feature CLE031 is on                                       CLE031
      ** If Settlement ccy for EMU non-blank, set ccy parm.               CEU004
      *                                                                   CEU004
     C           CEU004    IFEQ 'Y'                        If Feature On  CEU004
     C           CLE031    OREQ 'Y'                                       CLE031
      *                                                                   CEU004
     C           EMUCCY    IFNE *BLANKS                     If SetCcy # BlCEU004
     C                     MOVE EMUCCY    ZCCY               Set EMU Ccy  CEU004
     C                     ENDIF                            End If        CEU004
      *                                                                   CEU004
     C                     ENDIF                           End If         CEU004
      *                                                                   CEU004
     C  N77                EXSR MATLOC                                    S01195
     C                     MOVE W@MDSL    ZLOC                            S01195
1411 C***********          EXSR ZFREQB                                    S01195
     C*****                EXSR FREQB                                     S01195
      ** For CLE005, use ZFRQB3 to allow next interest date to            144089
      ** fall on a holiday                                                144089
     C           CLE005    IFEQ 'N'                                       144089
     C           CLE141    IFEQ 'N'                                                           CLE141
     C********** MDST      ORNE 01                                                    CLE141 CLE141A
     C********** MDST      ANDNE07                                                    CLE141 CLE141A
     C********** MDST      ANDNE08                                                    CLE141 CLE141A
     C                     EXSR ZFREQB                            S01195  S01392
     C                     ENDIF                                                              CLE141
     C                     ELSE                                           144089
     C                     Z-ADDWWINTR    ZDAYNO                                             BUG9241
     C                     EXSR ZFRQB3                                    144089
     C                     ENDIF                                          144089
1412 C   99                SETON                     U7U8  **DATABASE 15**
1413 C   99                Z-ADD15        DBASE
1414 C   99                GOTO INTEND
1415 C**
1416 C***********          EXSR ZDATE5                                    S01195
      ** For CLE005, if payment due is 'P', find previous working         144089
      ** day if holiday, if 'N', find next working day if holiday,        144089
      ** if 'A', interest day would be next freq even if a holiday        144089
      ** Also cater for if payment due is 'M'.                            144089
      *                                                                   144089
     C                     Z-ADD*ZERO     ZNRDYS                          S01195
     C                     Z-ADDZDAYNO    WWINTR                                             BUG9241
     C           CLE005    IFEQ 'Y'                                       144089
     C           CLE141    IFEQ 'Y'                                                           CLE141
     C********** MDST      ANDEQ01                                                    CLE141 CLE141A
     C********** CLE141    OREQ 'Y'                                                   CLE141 CLE141A
     C********** MDST      ANDEQ07                                                    CLE141 CLE141A
     C********** CLE141    OREQ 'Y'                                                   CLE141 CLE141A
     C********** MDST      ANDEQ08                                                    CLE141 CLE141A
     C           PDDI      IFEQ 'A'                                                           CLE141
     C                     Z-ADDZDAYNO    ZDYNBR                                              CLE141
     C                     ELSE                                                               CLE141
     C                     CALL 'LEZBDYCD'                                                    CLE141
     C                     PARM           ZDAYNO                                              CLE141
     C                     PARM           PICUR                                               CLE141
     C                     PARM           PILOC                                               CLE141
     C                     PARM PDDI      PPDDI                                               CLE141
     C                     PARM           DATF                                                CLE141
     C                     PARM ZCCY      PCCY    3                                          CLE141A
     C                     PARM ZLOC      PLOC    3                                          CLE141A
     C                     PARM           ZDYNBR                                              CLE141
     C                     ENDIF                                                              CLE141
     C                     ELSE                                                               CLE141
     C                     SELEC                                          144089
     C           PDDI      WHEQ 'P'                                       144089
     C                     EXSR ZBKDT                                     144089
     C           PDDI      WHEQ 'N'                                       144089
     C********** PDDI      OREQ *BLANK                                                 144089 237466
     C                     EXSR ZFWDT                                     144089
     C           PDDI      WHEQ 'A'                                       144089
     C                     Z-ADDZDAYNO    ZDYNBR                          144089
     C           PDDI      WHEQ 'M'                                       144089
     C           PDDI      OREQ *BLANK                                                        237466
     C                     EXSR ZDATE2                                    144089
     C           *IN98     IFEQ *OFF                                      144089
     C                     MOVE ZDATE     MMYY    40P                     144089
     C                     MOVELMMYY      MMNLCD  20P                     144089
     C                     ELSE                                           144089
     C                     MOVELZDATE     MMNLCD    P                     144089
     C                     ENDIF                                          144089
     C                     Z-ADDZDAYNO    @DAYNO  50                      144089
     C                     EXSR ZFWDT                                     144089
     C                     Z-ADDZDYNBR    ZDAYNO                          144089
     C                     EXSR ZDATE2                                    144089
     C           *IN98     IFEQ *OFF                                      144089
     C                     MOVE ZDATE     MMYY      P                     144089
     C                     MOVELMMYY      MMNWKD  20P                     144089
     C                     ELSE                                           144089
     C                     MOVELZDATE     MMNWKD    P                     144089
     C                     ENDIF                                          144089
     C           MMNLCD    IFNE MMNWKD                                    144089
     C                     Z-ADD@DAYNO    ZDAYNO                          144089
     C                     EXSR ZBKDT                                     144089
     C                     ENDIF                                          144089
     C                     ENDSL                                          144089
     C                     ENDIF                                                              CLE141
     C                     ELSE                                           144089
     C           CLE141    IFEQ 'Y'                                                           CLE141
     C********** MDST      ANDEQ01                                                    CLE141 CLE141A
     C********** CLE141    OREQ 'Y'                                                   CLE141 CLE141A
     C********** MDST      ANDEQ07                                                    CLE141 CLE141A
     C********** CLE141    OREQ 'Y'                                                   CLE141 CLE141A
     C********** MDST      ANDEQ08                                                    CLE141 CLE141A
     C                     EXSR ZFRQB3                                                        CLE141
      *                                                                                       CLE141
     C                     CALL 'LEZBDYCD'                                                    CLE141
     C                     PARM           ZDAYNO                                              CLE141
     C                     PARM           PICUR                                               CLE141
     C                     PARM           PILOC                                               CLE141
     C                     PARM PDDI      PPDDI                                               CLE141
     C                     PARM           DATF                                                CLE141
     C                     PARM ZCCY      PCCY                                               CLE141A
     C                     PARM ZLOC      PLOC                                               CLE141A
     C                     PARM           ZDYNBR                                              CLE141
     C                     ELSE                                                               CLE141
     C                     EXSR ZFWDT                                     S01195
     C                     ENDIF                                                              CLE141
     C                     ENDIF                                          144089
1417 C                     Z-ADDZDAYNO    INTBD            INT.BASE DATE
1418 C                     Z-ADDZDYNBR    VINTR            INTEREST DATE
1419 C**
1420 C           INTEND    ENDSR                           **INTEND**
1421 C********************************************************************
1422 C********************************************************************
1423 C**   SUBROUTINE TO GENERATE REPAYMENT EVENT(S)
1424 C**
1425 C**   CALLED BY: MAIN PROCESSING
1426 C*****CALLS****:*SR.INTCAL,LEVENT,EQUIV,RECOUT,ZFREQB,ZDATE5*********S01195
     C**   CALLS    : SR.INTCAL,LEVENT,EQUIV,RECOUT,FREQB,ZFWDT           S01195
1427 C**
1428 C           REPAY     BEGSR                           **REPAY**
      *                                                                                       CLE154
     C           CLE154    IFEQ 'Y'                                                           CLE154
     C           *IN50     ANDEQ'1'                                                           CLE154
      ** Determine Repayment Type                                                             CLE154
     C           REPTLA    COMP 2                    535152                                   CLE154
     C                     END                                                                CLE154
     C*                                                                   CEU004
     C                     MOVE EMUCC2    EMUCCY                          CEU004
      *                                                                   CLE031
      ** If feature CLE031 is on, set up loan sett. ccy fields            CLE031
     C           CLE031    IFEQ 'Y'                                       CLE031
     C                     MOVE 'R'       WSETTL                          CLE031
     C                     EXSR LONXCY                                    CLE031
     C                     ENDIF                                          CLE031
1429 C**
1430 C**   PERFORM INTEREST CALCULATIONS
1431 C      50             Z-ADDVAMEND    EVDATE           EVENT DATE
1432 C     N50             Z-ADDVREPAY    EVDATE
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C           MDAT      IFEQ 0                                                             CAS005
     C           BPNODM    ANDNE0                                                             CAS005
     C           MDAT      OREQ 0                                                             CAS005
     C           BLDY      ANDNE0                                                             CAS005
     C                     Z-ADDWMATD     WMATD2                                              CAS005
     C                     SELEC                                                              CAS005
     C           BLDY      WHNE 0                                                             CAS005
     C                     ADD  BLDY      WMATD2                                              CAS005
     C           BPNODM    WHNE 0                                                             CAS005
     C                     ADD  BPNODM    WMATD2                                              CAS005
     C                     OTHER                                                              CAS005
     C                     ADD  15        WMATD2                                              CAS005
     C                     ENDSL                                                              CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
      ** Call new subroutine for All-In-Rate calculations                                     CAS005
      *                                                                                       CAS005
     C                     EXSR SRAIR                                                         CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CLE028
      ** Instead of executing SR/GLINTC, process RULE78Z1 if CLE028 is on,                    CLE028
      ** and processing type (PTYP) is 80                                                     CLE028
      *                                                                                       CLE028
     C           CLE028    IFEQ 'Y'                                                           CLE028
     C           PTYP      ANDEQ80                                                            CLE028
     C                     Z-ADDVDAT      W78VDT                                              CLE028
     C                     Z-ADDMDAT      W78MDT                                              CLE028
     C                     Z-ADDFLTI      W78FLT                                              CLE028
     C                     MOVE RFRQ      W78RPF                                              CLE028
     C                     Z-ADDFRPD      W78FRD                                              CLE028
     C                     Z-ADDRDYN      W78RPM                                              CLE028
     C                     MOVE CCY       W78CCY                                              CLE028
     C                     MOVE *BLANKS   W78LCN                                              CLE028
     C                     Z-ADDEVDATE    W78BEG                                              CLE028
     C                     Z-ADDEVDATE    W78END                                              CLE028
     C                     MOVE 'R'       W78ROA                                              CLE028
      *                                                                                       CLE028
     C                     EXSR RULE78                                                        CLE028
     C                     Z-ADDW78INT    INTDUE                                              CLE028
     C                     ELSE                                                               CLE028
      *                                                                                       CLE028
1433 C  N50                EXSR INTCAL
      *                                                                                       223215
      ** Include repayments that are valuing on holiday but with                              223215
      ** INDATE on next working date on the projected account movements.                      223215
      *                                                                                       223215
     C           CLE005    IFEQ 'Y'                                                           223215
     C           *IN50     ANDEQ'0'                                                           223215
     C                     Z-ADD*ZERO     ZNRDYS                                              223215
     C                     Z-ADDVREPAY    ZDAYNO                                              223215
     C                     MOVE CCY       ZCCY                                                227082
      * If CEU004 on use Settlement ccy if not blank                                          227082
     C           CEU004    IFEQ 'Y'                                                           227082
     C           EMUCCY    IFNE *BLANKS                                                       227082
     C                     MOVE EMUCCY    ZCCY                                                227082
     C                     ENDIF                                                              227082
     C                     ENDIF                                                              227082
     C           *IN77     IFEQ '0'                                                           227082
     C                     EXSR MATLOC                                                        227082
     C                     ENDIF                                                              227082
     C                     MOVE W@MDSL    ZLOC                                                227082
      *                                                                                       CLE141
      ** Call Business Day Convention for Lending Transaction                                 CLE141
      *                                                                                       CLE141
     C           CLE141    IFEQ 'Y'                                                           CLE141
     C********** MDST      ANDEQ01                                                    CLE141 CLE141A
     C********** CLE141    OREQ 'Y'                                                   CLE141 CLE141A
     C********** MDST      ANDEQ07                                                    CLE141 CLE141A
     C********** CLE141    OREQ 'Y'                                                   CLE141 CLE141A
     C********** MDST      ANDEQ08                                                    CLE141 CLE141A
     C                     CALL 'LEZBDYCD'                                                    CLE141
     C                     PARM           ZDAYNO                                              CLE141
     C                     PARM           PICUR                                               CLE141
     C                     PARM           PILOC                                               CLE141
     C                     PARM PTDI      PPDDI                                               CLE141
     C                     PARM           DATF                                                CLE141
     C                     PARM ZCCY      PCCY                                               CLE141A
     C                     PARM ZLOC      PLOC                                               CLE141A
     C                     PARM           ZDYNBR                                              CLE141
     C                     ELSE                                                               CLE141
     C                     SELEC                                                              223215
     C           PTDI      WHEQ 'P'                                                           223215
     C                     EXSR ZBKDT                                                         223215
     C           PTDI      WHEQ 'N'                                                           223215
     C           PTDI      OREQ *BLANK                                                        223215
     C                     EXSR ZFWDT                                                         223215
     C           PTDI      WHEQ 'M'                                                           223215
     C                     EXSR ZDATE2                                                        223215
     C           *IN98     IFEQ *OFF                                                          223215
     C                     MOVE ZDATE     MMYY    40P                                         223215
     C                     MOVELMMYY      MMNLCD  20P                                         223215
     C                     ELSE                                                               223215
     C                     MOVELZDATE     MMNLCD    P                                         223215
     C                     ENDIF                                                              223215
     C                     Z-ADDZDAYNO    @DAYNO  50                                          223215
     C                     EXSR ZFWDT                                                         223215
     C                     Z-ADDZDYNBR    ZDAYNO                                              223215
     C                     EXSR ZDATE2                                                        223215
     C           *IN98     IFEQ *OFF                                                          223215
     C                     MOVE ZDATE     MMYY      P                                         223215
     C                     MOVELMMYY      MMNWKD  20P                                         223215
     C                     ELSE                                                               223215
     C                     MOVELZDATE     MMNWKD    P                                         223215
     C                     ENDIF                                                              223215
     C           MMNLCD    IFNE MMNWKD                                                        223215
     C                     Z-ADD@DAYNO    ZDAYNO                                              223215
     C                     EXSR ZBKDT                                                         223215
     C                     ENDIF                                                              223215
     C                     ENDSL                                                              223215
     C                     ENDIF                                                              CLE141
     C                     Z-ADDZDYNBR    EVDATE                                              223215
     C                     ENDIF                                                              223215
      *                                                                                       CLE028
     C                     ENDIF                                                              CLE028
1434 C**
1435 C**   DETERMINE REPAYMENT & INTEREST AMOUNTS
1436 C**   NEED TO DISTINGUISH BETWEEN REPAYMENTS DERIVED FROM AMENDMENT
1437 C**   RECORDS & THOSE FROM LOANS RECORDS - INDICATOR 50
     C/COPY WNCPYSRC,LE0480C018
      *                                                                   123333
      * Amounts may be in facility currency, convert if necessary.        123333
     C           *IN50     IFEQ *ON                                       123333
     C           CCYLA     ANDNECCY                                       123333
      *                                                                   123333
     C                     MOVE CCYLA     XCCY                            123333
     C                     EXSR CCYDSP                                    123333
     C   99                SETON                     U7U8                 123333
     C   99                Z-ADD42        DBASE                           123333
     C   99                MOVE XCCY      DBKEY                           123333
     C   99                MOVE 'SDCURRPD'DBFILE                          123333
     C   U7 U8             GOTO REPEND                                    123333
      *                                                                   123333
     C                     Z-ADDXDECP     XDP1                            123333
     C                     Z-ADDECCYDP    XDP2                            123333
     C                     Z-ADDFCXR      XSPOT                           123333
     C           FMDI      IFEQ 'D'                                       123333
     C                     MOVE 'M'       XMDIV                           123333
     C                     ELSE                                           123333
     C                     MOVE 'D'       XMDIV                           123333
     C                     ENDIF                                          123333
      *                                                                   123333
     C                     Z-ADDPRAM      XAMNT1                          123333
     C                     EXSR XCONVT                                    123333
     C                     Z-ADDXAMNT2    PRAM                            123333
      *                                                                   123333
     C                     Z-ADDTAMT      XAMNT1                          123333
     C                     EXSR XCONVT                                    123333
     C                     Z-ADDXAMNT2    TAMT                            123333
      *                                                                   123333
     C                     ENDIF                                          123333
1438 C**
1439 C**   REPAYMENT TYPE '1'
1440 C   51 50             Z-ADDPRAM      REAMT  130       REPAY AMOUNT
1441 C   51N50             Z-ADDRAMT      REAMT
     C*                                                                   089289
     C* SHOULD NOT GO ON GENERATING EVENTS FOR FULL PRINCIPAL REPAYMENT   089289
     C* AMOUNT WHEN OUTSTANDING CURRENT PRINCIPAL IS LESS THAN IT.        089289
     C   51N50   CPRINC    IFLT 0                                         089289
     C                     Z-ADD0         REAMT                           089289
     C***********          ELSE                                    089289 088120
     C***********CPRINC    IFLT RAMT                               089289 088120
     C***********          Z-ADDCPRINC    TOTAL                    089289 088120
     C***********          END                                     089289 088120
     C                     END                                            089289
     C*                                                                   089289
1442 C   51                Z-ADDINTDUE    REINT  130       INTEREST AMOUNT
1443 C**
1444 C**   REPAYMENT TYPE '2'
1445 C   52 50             Z-ADDTAMT      REAMT
1446 C   52N50             Z-ADDRAMT      REAMT
     C*                                                                   E11352
     C* SHOULD NOT GO ON GENERATING EVENTS FOR FULL PRINCIPAL REPAYMENT   E11352
     C* AMOUNT WHEN OUTSTANDING CURRENT PRINCIPAL IS LESS THAN IT.        E11352
     C   52N50   RAMT      COMP CPRINC               87                   E11352
     C   52N50 87          Z-ADDCPRINC    REAMT                           E11352
     C   52N50   CPRINC    IFLT 0                                         089289
     C                     Z-ADD0         REAMT                           089289
     C                     END                                            089289
     C*                                                                   089289
1447 C   52                Z-ADD0         REINT
     C           CLE154    IFEQ 'Y'                                                           CLE154
     C           *IN52     ANDEQ'1'                                                           CLE154
     C           TAMT      ANDEQ*ZERO                                                         CLE154
      ** Means that it is an Interest payment schedule                                        CLE154
     C                     Z-ADDINTDUE    REINT                                               CLE154
     C                     END                                                                CLE154
1448 C**
1449 C**   REPAYMENT TYPE '3'
1450 C   53 50             Z-ADDTAMT      TOTAL  130
1451 C   53N50             Z-ADDRAMT      TOTAL
     C*                                                                   089289
     C* SHOULD NOT GO ON GENERATING EVENTS FOR FULL PRINCIPAL REPAYMENT   089289
     C* AMOUNT WHEN OUTSTANDING CURRENT PRINCIPAL IS LESS THAN IT.        089289
     C   53N50   CPRINC    IFLT 0                                         089289
     C                     Z-ADD0         TOTAL                           089289
     C                     ELSE                                           089289
     C           CPRINC    IFLT RAMT                                      089289
     C**********           Z-ADDCPRINC    TOTAL                                       089289 BUG9242
     C                     Z-ADDRAMT      TOTAL                                              BUG9242
     C                     END                                            089289
     C                     END                                            089289
      *                                                                                       CLE028
      ** For flat rate personal loans, if current principal is less                           CLE028
      ** than repayment amount, remove first interest due from repayment                      CLE028
      ** amount before comparing current principal and repayment amount                       CLE028
      ** to get the correct total amount                                                      CLE028
      *                                                                                       CLE028
     C           CLE028    IFEQ 'Y'                                                           CLE028
     C           PTYP      ANDEQ80                                                            CLE028
     C           *IN50     ANDEQ*OFF                                                          CLE028
     C           *IN53     ANDEQ'1'                                                           CLE028
     C           ADIF      ANDNE'Y'                                                           CLE028
     C           RAMT      SUB  INTDUE    WRAMT  130                                          CLE028
     C           CPRINC    IFLT WRAMT                                                         CLE028
     C           INTDUE    ADD  CPRINC    TOTAL                                               CLE028
     C                     ELSE                                                               CLE028
     C                     Z-ADDRAMT      TOTAL                                               CLE028
     C                     ENDIF                                                              CLE028
     C                     ENDIF                                                              CLE028
     C*                                                                   089289
1452 C   53      INTDUE    COMP TOTAL                  8787
1453 C   53 87             Z-ADDINTDUE    REINT
1454 C   53 87   TOTAL     SUB  INTDUE    REAMT
     C   53 87   CPRINC    IFLT REAMT                                     088120
     C                     Z-ADDCPRINC    REAMT                           088120
     C                     END                                            088120
1455 C**
1456 C   53N87             Z-ADDTOTAL     REINT
1457 C   53N87             Z-ADD0         REAMT
      *                                                                                       CLE028
      ** Whole repayment amount should be for Principal payment if                            CLE028
      ** CLE028 is installed and add on interest flag is 'Y' for                              CLE028
      ** repayment type 3                                                                     CLE028
      *                                                                                       CLE028
     C           CLE028    IFEQ 'Y'                                                           CLE028
     C           ADIF      ANDEQ'Y'                                                           CLE028
     C           *IN53     ANDEQ'1'                                                           CLE028
     C                     Z-ADDTOTAL     REAMT                                               CLE028
     C                     ENDIF                                                              CLE028
1458 C**
1459 C**   FORMAT EVENT AS PER P/LEVENT
1460 C                     MOVE 'R1'      EVTYPE           EVENT TYPE
     C                     Z-ADDREAMT     EVAMNT           EVENT AMOUNT                       226542
1461 C                     EXSR LEVENT
1462 C  N57                SETON                     U7U8  **DATABASE 16**
1463 C  N57                Z-ADD16        DBASE
1464 C  N57                MOVE EVCODE    DBKEY
1465 C**N57****            GOTO REPEND                                    S01117
     C   U7 U8             GOTO REPEND                                    S01117
1466 C**
1467 C**********           Z-ADDREAMT     EVAMNT           EVENT AMOUNT                       226542
     C*                                                                   LN0037
     C                     MOVEA'000'     *IN,11                          LN0037
     C   51                                                               LN0037
     COR 52      CPRINC    COMP REAMT                111213               LN0037
     C           *IN12     IFEQ '1'                                       LN0037
     C                     Z-ADDCPRINC    EVAMNT                          LN0037
     C                     Z-ADDCPRINC    REAMT                           LN0037
     C                     END                                            LN0037
     C*                                                                   S01408
     C/COPY WNCPYSRC,LE0480CCP7                                           S01408
     C*                                                                   S01408
1468 C**
1469 C**   DETERMINE EQUIVALENT AMOUNTS
1470 C                     EXSR EQUIV
1471 C**
1472 C  N50                Z-ADD0         LASEQ            AMEND SEQUENCE
1473 C   50                Z-ADDLASN      LASEQ
1474 C  N50                MOVE RFRQ      FREQY            FREQUENCY CODE
1475 C   50                MOVE ' '       FREQY
     C           *IN50     IFEQ '1'                                       060527
     C                     MOVE AUTOLA    AUTOS                           060527
     C                     ELSE                                           060527
1476 C                     MOVE AUTO      AUTOS            AUTO SETTLEMENT
     C                     END                                            060527
1477 C**
1478 C**   OUTPUT RECORD TO FILE
1479 C                     EXSR RECOUT
      *                                                                                       CAS005
      ** Generate R4 Events for CAS005 enhancement                                            CAS005
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C           PTYP      ANDNE70                                                            CAS005
     C           PTYP      ANDNE71                                                            CAS005
     C           PTYP      ANDNE72                                                            CAS005
      *                                                                                       CAS005
     C                     Z-ADD0         WREINT 130                                          CAS005
     C                     Z-ADD0         WREAMT 130                                          CAS005
     C                     Z-ADD0         WTOTAL 130                                          CAS005
      *                                                                                       CAS005
      ** Call new subroutine for Net Treasury Rate calculations                               CAS005
      *                                                                                       CAS005
     C           *IN50     IFEQ '0'                                                           CAS005
     C                     Z-ADD*ZERO     WEAMT                                               CAS005
     C                     Z-ADD*ZERO     WEDATX                                              CAS005
     C                     MOVE 'Y'       WCALL                                               222972
     C                     EXSR SRNTR                                                         CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
      ** Repayment type '1'                                                                   CAS005
      *                                                                                       CAS005
     C           *IN51     IFEQ '1'                                                           CAS005
     C           *IN50     ANDEQ'1'                                                           CAS005
     C                     Z-ADDPRAM      WREAMT                                              CAS005
     C                     ENDIF                                                              CAS005
     C           *IN51     IFEQ '1'                                                           CAS005
     C           *IN50     ANDEQ'0'                                                           CAS005
     C           WCPNTR    IFLT 0                                                             CAS005
     C                     Z-ADD0         WREAMT                                              CAS005
     C                     ELSE                                                               CAS005
     C                     Z-ADDRAMT      WREAMT                                              CAS005
     C                     ENDIF                                                              CAS005
     C                     ENDIF                                                              CAS005
     C           *IN51     IFEQ '1'                                                           CAS005
     C                     Z-ADDWNTRIN    WREINT                                              CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
      ** Repayment type '2'                                                                   CAS005
      *                                                                                       CAS005
     C           *IN52     IFEQ '1'                                                           CAS005
     C           *IN50     ANDEQ'1'                                                           CAS005
     C                     Z-ADDTAMT      WREAMT                                              CAS005
     C                     ENDIF                                                              CAS005
     C           *IN52     IFEQ '1'                                                           CAS005
     C           *IN50     ANDEQ'0'                                                           CAS005
     C                     Z-ADDRAMT      WREAMT                                              CAS005
     C           RAMT      IFGT WCPNTR                                                        CAS005
     C                     Z-ADDWCPNTR    WREAMT                                              CAS005
     C                     ENDIF                                                              CAS005
     C           WCPNTR    IFLT 0                                                             CAS005
     C                     Z-ADD0         WREAMT                                              CAS005
     C                     ENDIF                                                              CAS005
     C                     ENDIF                                                              CAS005
     C           *IN52     IFEQ '1'                                                           CAS005
     C                     Z-ADD0         WREINT                                              CAS005
     C                     ENDIF                                                              CAS005
     C           CLE154    IFEQ 'Y'                                                           CLE154
     C           *IN52     ANDEQ'1'                                                           CLE154
     C           TAMT      ANDEQ*ZERO                                                         CLE154
      ** Means that it is an Interest payment schedule                                        CLE154
     C                     Z-ADDWNTRIN    WREINT                                              CLE154
     C                     END                                                                CLE154
      *                                                                                       CAS005
      ** Repayment type '3'                                                                   CAS005
      *                                                                                       CAS005
     C           *IN53     IFEQ '1'                                                           CAS005
     C           *IN50     ANDEQ'0'                                                           CAS005
     C                     Z-ADDRAMT      WTOTAL                                              CAS005
     C           RAMT      IFGT WCPNTR                                                        CAS005
     C                     Z-ADDWCPNTR    WTOTAL                                              CAS005
     C                     ENDIF                                                              CAS005
     C           WCPNTR    IFLT 0                                                             CAS005
     C                     Z-ADD0         WTOTAL                                              CAS005
     C                     ENDIF                                                              CAS005
     C                     ENDIF                                                              CAS005
     C           *IN53     IFEQ '1'                                                           CAS005
     C           WNTRIN    IFLE WTOTAL                                                        CAS005
     C                     Z-ADDWNTRIN    WREINT                                              CAS005
     C           WTOTAL    SUB  WNTRIN    WREAMT                                              CAS005
     C           WCPNTR    IFLT WREAMT                                                        CAS005
     C                     Z-ADDWCPNTR    WREAMT                                              CAS005
     C                     ENDIF                                                              CAS005
     C                     ELSE                                                               CAS005
     C                     Z-ADDWTOTAL    WREINT                                              CAS005
     C                     Z-ADD0         WREAMT                                              CAS005
     C                     ENDIF                                                              CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
     C                     MOVEA'000'     *IN,11                                              CAS005
      *                                                                                       CAS005
     C           *IN51     IFEQ *ON                                                           CAS005
     C           *IN52     OREQ *ON                                                           CAS005
     C           WCPNTR    COMP WREAMT               111213                                   CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
     C           *IN12     IFEQ *ON                                                           CAS005
     C                     Z-ADDWCPNTR    WREAMT                                              CAS005
     C                     ENDIF                                                              CAS005
     C                     ENDIF                                                              CAS005
1480 C**
1481 C**   FOR REPAYMENT TYPES 1 OR 3,GENERATE EVENT FOR INTEREST AMOUNT
     C           CLE154    IFEQ 'N'                                                           CLE154
1482 C  N51N53             GOTO REP01
     C                     ELSE                                                               CLE154
     C           *IN52     IFEQ 'Y'                                                           CLE154
     C           REINT     ANDEQ*ZERO                                                         CLE154
      ** Means that it is an Principal payment schedule                                       CLE154
     C                     GOTO REP01                                                         CLE154
     C                     END                                                                CLE154
     C                     END                                                                CLE154
1483 C**
1484 C**   FORMAT EVENT AS PER P/LEVENT
      *                                                                                       CLE028
      ** For flat rate personal loans,                                                        CLE028
      ** do not generate interest event 'R2' if Add on interest flag is on                    CLE028
      *                                                                                       CLE028
     C           CLE028    IFEQ 'Y'                                                           CLE028
     C           PTYP      ANDEQ80                                                            CLE028
     C           ADIF      ANDEQ'Y'                                                           CLE028
     C                     ELSE                                                               CLE028
1485 C                     MOVE 'R2'      EVTYPE           EVENT TYPE
1492 C                     Z-ADDREINT     EVAMNT           EVENT AMOUNT                       226542
1486 C                     EXSR LEVENT
1487 C  N57                SETON                     U7U8  **DATABASE 17**
1488 C  N57                Z-ADD17        DBASE
1489 C  N57                MOVE EVCODE    DBKEY
1490 C**N57******          GOTO REPEND                                    S01117
     C   U7 U8             GOTO REPEND                                    S01117
1491 C**
1492 C**********           Z-ADDREINT     EVAMNT           EVENT AMOUNT                       226542
1493 C**
1494 C**   DETERMINE EQUIVALENT AMOUNTS
1495 C                     EXSR EQUIV
1496 C**
1497 C**   OUTPUT RECORD TO FILE
1498 C                     EXSR RECOUT
      *                                                                                       CLE028
     C                     ENDIF                                                              CLE028
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C           PTYP      ANDNE70                                                          BUG11271
     C           PTYP      ANDNE71                                                          BUG11271
     C           PTYP      ANDNE72                                                          BUG11271
      *                                                                                       CAS005
      ** Save EVAMNT, REINT, REAMT and TOTAL                                                  CAS005
      *                                                                                       CAS005
     C                     Z-ADDREINT     WREIN2 130                                          CAS005
     C                     Z-ADDREAMT     WREAM2 130                                          CAS005
     C                     Z-ADDEVAMNT    WEAMNT 130                                          CAS005
     C                     Z-ADDWREINT    REINT                                               CAS005
     C                     Z-ADDWREAMT    REAMT                                               CAS005
      *                                                                                       CAS005
     C                     MOVE 'R4'      EVTYPE                                              CAS005
     C                     EXSR LEVENT                                                        CAS005
      *                                                                                       CAS005
      ** IF 'R4' event type not found, issue database error                                   CAS005
      *                                                                                       CAS005
     C           *IN57     IFEQ *OFF                                                          CAS005
     C                     MOVE *ON       *INU7                                               CAS005
     C                     MOVE *ON       *INU8                                               CAS005
     C                     Z-ADD61        DBASE                                               CAS005
     C                     MOVE EVCODE    DBKEY                                               CAS005
     C                     GOTO REPEND                                                        CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
     C                     Z-ADDREINT     EVAMNT                                              CAS005
      *                                                                                       CAS005
      ** Determine Equivalent Amounts                                                         CAS005
      *                                                                                       CAS005
     C                     EXSR EQUIV                                                         CAS005
      *                                                                                       CAS005
     C           *IN50     IFEQ *OFF                                                          CAS005
     C                     Z-ADD0         LASEQ                                               CAS005
     C                     MOVE RFRQ      FREQY                                               CAS005
     C                     MOVE AUTO      AUTOS                                               CAS005
     C                     ELSE                                                               CAS005
     C                     Z-ADDLASN      LASEQ                                               CAS005
     C                     MOVE ' '       FREQY                                               CAS005
     C                     MOVE AUTOLA    AUTOS                                               CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
      ** Output 'R4' event type to File                                                       CAS005
      *                                                                                       CAS005
     C                     Z-ADDEFFINT    WEFF                                                223752
     C                     Z-ADDWINTR     EFFINT                                              223752
      *                                                                                       223752
     C                     MOVE EMUCCY    TEMUCY                                              226512
     C                     MOVE *BLANKS   EMUCCY                                              226512
      *                                                                                       226512
     C                     EXSR RECOUT                                                        CAS005
      *                                                                                       CAS005
     C                     Z-ADDWEFF      EFFINT                                              223752
     C                     MOVE TEMUCY    EMUCCY                                              226512
      *                                                                                       223752
      ** Put the original REINT, REAMT and EVAMNT back                                        CAS005
      *                                                                                       CAS005
     C                     Z-ADDWREIN2    REINT                                               CAS005
     C                     Z-ADDWREAM2    REAMT                                               CAS005
     C                     Z-ADDWEAMNT    EVAMNT                                              CAS005
     C                     ENDIF                                                              CAS005
1499 C           REP01     TAG                             **REP01 TAG**
1500 C**
1501 C**   UPDATE CURRENT PRINCIPAL & INTEREST PAID THIS RUN
1502 C           CPRINC    SUB  REAMT     CPRINC           CURRENT PRINC.
1503 C           INTPD     ADD  REINT     INTPD            INT.PD.THIS RUN
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C           WCPNTR    SUB  WREAMT    WCPNTR                                              CAS005
     C           WINNTR    ADD  WREINT    WINNTR                                              CAS005
     C                     ENDIF                                                              CAS005
1504 C   50                GOTO REPEND
1505 C**
1506 C**   FOR LOAN-DERIVED REPAYMENTS,UPDATE NEXT REPAYMENT DATE
1507 C           RFRQ      COMP ' '                      87
     C**                                                                  089289
     C**   FOR -VE/ZERO PRINCIPAL, SHOULD NO LONGER GENERATE REPAYMENTS   089289
     C**                                                                  089289
     C**N87******CPRINC    COMP 0                        87         E11352089289
     C  N87      CPRINC    COMP 0                      8787               089289
     C  N87      CPRINC    COMP 0                        87               E11352
1508 C      87             Z-ADD99999     VREPAY
1509 C      87             GOTO REPEND
1510 C**
     C           *IN12     IFEQ '1'                                       LN0037
     C           *IN13     OREQ '1'                                       LN0037
     C                     Z-ADD99999     VREPAY                          LN0037
     C                     GOTO REPEND                                    LN0037
     C                     END                                            LN0037
     C*                                                                   LN0037
1510 C**
1511 C***********          MOVE 'Y'       ZOPT                            S01195
1512 C                     MOVE RFRQ      ZFREQ
1513 C**********           Z-ADDREPBD     ZDAYNO                                             BUG9241
     C                     Z-ADDWWREP     ZDAYNO                                             BUG9241
1514 C                     Z-ADDRDYN      ZMDAY
     C           MDST      IFEQ 01                                                            237466
     C           MDST      OREQ 07                                                            237466
     C           MDST      OREQ 08                                                            237466
     C           MDST      OREQ 02                                                            237466
     C           MDST      OREQ 12                                                            237466
1515 C                     MOVE CCY       ZCCY
     C                     ELSE                                                               237466
     C                     MOVE BJLCCY    ZCCY                                                237466
     C                     ENDIF                                                              237466
      *                                                                   CEU004
      ** If feature CEU004 is on                                          CEU004
      ** or if feature CLE031 is on                                       CLE031
      ** If Settlement ccy for EMU non-blank, set ccy parm.               CEU004
      *                                                                   CEU004
     C           CEU004    IFEQ 'Y'                        If Feature On  CEU004
     C           CLE031    OREQ 'Y'                                       CLE031
      *                                                                   CEU004
     C           EMUCCY    IFNE *BLANKS                     If SetCcy # BlCEU004
     C                     MOVE EMUCCY    ZCCY               Set EMU Ccy  CEU004
     C                     ENDIF                            End If        CEU004
      *                                                                   CEU004
     C                     ENDIF                           End If         CEU004
      *                                                                   CEU004
     C  N77                EXSR MATLOC                                    S01195
     C                     MOVE W@MDSL    ZLOC                            S01195
      *                                                                   154221
     C           CLE005    IFEQ 'Y'                                       154221
     C********** REPT      ANDEQ1                                                      154221 256872
     C********** CLE005    OREQ 'Y'                                                    154221 256872
     C********** REPT      ANDEQ3                                                      154221 256872
     C                     Z-ADDWWREP     ZDAYNO                                             BUG9241
     C                     EXSR ZFRQB3                                    154221
     C                     Z-ADD*ZERO     ZNRDYS                          154221
     C                     Z-ADDZDAYNO    WWREP                                              BUG9241
      *                                                                                       CLE141
      ** Call Business Day Convention for Lending Transaction                                 CLE141
      *                                                                                       CLE141
     C           CLE141    IFEQ 'Y'                                                           CLE141
     C********** MDST      ANDEQ01                                                    CLE141 CLE141A
     C********** CLE141    OREQ 'Y'                                                   CLE141 CLE141A
     C********** MDST      ANDEQ07                                                    CLE141 CLE141A
     C********** CLE141    OREQ 'Y'                                                   CLE141 CLE141A
     C********** MDST      ANDEQ08                                                    CLE141 CLE141A
     C           PDDI      IFEQ 'A'                                                           CLE141
     C                     Z-ADDZDAYNO    ZDYNBR                                              CLE141
     C                     ELSE                                                               CLE141
     C                     CALL 'LEZBDYCD'                                                    CLE141
     C                     PARM           ZDAYNO                                              CLE141
     C                     PARM           PICUR                                               CLE141
     C                     PARM           PILOC                                               CLE141
     C                     PARM PDDI      PPDDI                                               CLE141
     C                     PARM           DATF                                                CLE141
     C                     PARM ZCCY      PCCY                                               CLE141A
     C                     PARM ZLOC      PLOC                                               CLE141A
     C                     PARM           ZDYNBR                                              CLE141
     C                     ENDIF                                                              CLE141
     C                     ELSE                                                               CLE141
     C                     SELEC                                          154221
     C           PDDI      WHEQ 'A'                                       154221
     C                     Z-ADDZDAYNO    ZDYNBR                          154221
     C           PDDI      WHEQ 'P'                                       154221
     C                     EXSR ZBKDT                                     154221
     C           PDDI      WHEQ 'N'                                       154221
     C           PDDI      OREQ *BLANK                                    154221
     C                     EXSR ZFWDT                                     154221
     C           PDDI      WHEQ 'M'                                       154221
     C                     EXSR ZDATE2                                    154221
     C           *IN98     IFEQ *OFF                                      154221
     C                     MOVE ZDATE     MMYY    40P                     154221
     C                     MOVELMMYY      MMNLCD  20P                     154221
     C                     ELSE                                           154221
     C                     MOVELZDATE     MMNLCD    P                     154221
     C                     ENDIF                                          154221
     C                     Z-ADDZDAYNO    @DAYNO  50                      154221
     C                     EXSR ZFWDT                                     154221
     C                     Z-ADDZDYNBR    ZDAYNO                          154221
     C                     EXSR ZDATE2                                    154221
     C           *IN98     IFEQ *OFF                                      154221
     C                     MOVE ZDATE     MMYY      P                     154221
     C                     MOVELMMYY      MMNWKD  20P                     154221
     C                     ELSE                                           154221
     C                     MOVELZDATE     MMNWKD    P                     154221
     C                     ENDIF                                          154221
     C           MMNLCD    IFNE MMNWKD                                    154221
     C                     Z-ADD@DAYNO    ZDAYNO                          154221
     C                     EXSR ZBKDT                                     154221
     C                     ENDIF                                          154221
     C                     ENDSL                                          154221
     C                     ENDIF                                                              CLE141
     C                     Z-ADDZDAYNO    REPBD            REPAY BASE DATE154221
     C                     Z-ADDZDYNBR    VREPAY           REPAYMENT DATE 154221
      *                                                                   154221
     C                     ELSE                                           154221
      *                                                                   154221
1516 C***********          EXSR ZFREQB                                    S01195
     C*****                EXSR FREQB                                     S01195
     C/COPY WNCPYSRC,LE0480C024
      *                                                                                       CLE141
      ** Call Business Day Convention for Lending Transaction                                 CLE141
      *                                                                                       CLE141
     C           CLE141    IFEQ 'Y'                                                           CLE141
     C********** MDST      ANDEQ01                                                    CLE141 CLE141A
     C********** CLE141    OREQ 'Y'                                                   CLE141 CLE141A
     C********** MDST      ANDEQ07                                                    CLE141 CLE141A
     C********** CLE141    OREQ 'Y'                                                   CLE141 CLE141A
     C********** MDST      ANDEQ08                                                    CLE141 CLE141A
     C                     Z-ADDWWREP     ZDAYNO                                              CLE141
     C                     EXSR ZFRQB3                                                        CLE141
      *                                                                                       CLE141
     C                     CALL 'LEZBDYCD'                                                    CLE141
     C                     PARM           ZDAYNO                                              CLE141
     C                     PARM           PICUR                                               CLE141
     C                     PARM           PILOC                                               CLE141
     C                     PARM *BLANKS   PPDDI                                               CLE141
     C                     PARM           DATF                                                CLE141
     C                     PARM ZCCY      PCCY                                               CLE141A
     C                     PARM ZLOC      PLOC                                               CLE141A
     C                     PARM           ZDYNBR                                              CLE141
     C                     ELSE                                                               CLE141
     C                     EXSR ZFREQB                            S01195  S01392
     C                     Z-ADDZDAYNO    WWREP                                              BUG9241
1517 C   99                SETON                     U7U8  **DATABASE 18**
1518 C   99                Z-ADD18        DBASE
1519 C   99                GOTO REPEND
1520 C**
1521 C***********          EXSR ZDATE5                                    S01195
     C                     Z-ADD*ZERO     ZNRDYS                          S01195
     C                     EXSR ZFWDT                                     S01195
     C                     ENDIF                                                              CLE141
1522 C                     Z-ADDZDAYNO    REPBD            REPAY BASE DATE
1523 C                     Z-ADDZDYNBR    VREPAY           REPAYMENT DATE
     C                     ENDIF                                          154221
     C/COPY WNCPYSRC,LE0480C025
1524 C**
1525 C           REPEND    ENDSR                           **REPEND**
1526 C********************************************************************
     C********************************************************************127735
     C**   SUBROUTINE TO GENERATE MANUAL REPAYMENT EVENT(S)               127735
     C**                                                                  127735
     C**   CALLED BY: AMEND SUBROUTINE                                    127735
     C********************************************************************127735
     C**                                                                  127735
     C**   CALLS    : SR.LEVENT,EQUIV,RECOUT                              127735
1427 C**                                                                  127735
1428 C           MANREP    BEGSR                           **MANREP**     127735
     C*                                                                   CEU004
     C*********************MOVE EMUCC2    EMUCCY                                       CEU004 CLE031
      *                                                                   127735
      **   Convert amounts if the manual repayment amount is in the       127735
      **   facility currency                                              127735
      *                                                                   127735
     C           *IN50     IFEQ *ON                                       127735
     C           CCYLA     ANDNECCY                                       127735
      *                                                                   127735
     C                     MOVE CCYLA     XCCY                            127735
     C                     EXSR CCYDSP                                    127735
     C   99                SETON                     U7U8                 127735
     C   99                Z-ADD43        DBASE                           127735
     C   99                MOVE XCCY      DBKEY                           127735
     C   99                MOVE 'SDCURRPD'DBFILE                          127735
     C   U7 U8             GOTO MREND                                     127735
      *                                                                   127735
     C                     Z-ADDXDECP     XDP1                            127735
     C                     Z-ADDECCYDP    XDP2                            127735
     C                     Z-ADDFCXR      XSPOT                           127735
     C           FMDI      IFEQ 'D'                                       127735
     C                     MOVE 'M'       XMDIV                           127735
     C                     ELSE                                           127735
     C                     MOVE 'D'       XMDIV                           127735
     C                     ENDIF                                          127735
      *                                                                   127735
     C                     Z-ADDPRAM      XAMNT1                          127735
     C                     EXSR XCONVT                                    127735
     C                     Z-ADDXAMNT2    PRAM                            127735
      *                                                                   127735
     C                     Z-ADDINTA      XAMNT1                          127735
     C                     EXSR XCONVT                                    127735
     C                     Z-ADDXAMNT2    INTA                            127735
      *                                                                   127735
     C                     Z-ADDTAMT      XAMNT1                          127735
     C                     EXSR XCONVT                                    127735
     C                     Z-ADDXAMNT2    TAMT                            127735
      *                                                                   127735
     C                     ENDIF                                          127735
      *                                                                   127735
      **   Update event amounts                                           127735
      *                                                                   127735
     C                     Z-ADDPRAM      REAMT                           127735
     C                     Z-ADDINTA      REINT                           127735
      *                                                                   127735
      **   Format event for Principal repayment                           127735
      *                                                                   127735
     C                     MOVE 'R1'      EVTYPE           Event Type     127735
     C                     Z-ADDREAMT     EVAMNT           Event Amount                       226542
     C                     EXSR LEVENT                                    127735
      *                                                                   127735
      **   Perform DB Error processing if Event generation failed         127735
      *                                                                   127735
     C           *IN57     IFEQ '0'                                       127735
     C                     SETON                     U7U8                 127735
     C                     Z-ADD44        DBASE                           127735
     C                     MOVE EVCODE    DBKEY                           127735
     C                     GOTO MREND                                     127735
     C                     ENDIF                                          127735
      *                                                                   127735
     C**********           Z-ADDREAMT     EVAMNT           Event Amount                127735 226542
      *                                                                   127735
      **   Determine Equivalent Amounts and the output record to file     127735
      *                                                                   127735
     C                     EXSR EQUIV                                     127735
     C                     Z-ADDLASN      LASEQ                           127735
     C                     MOVE ' '       FREQY                           127735
     C                     MOVE 'Y'       AUTOS                           127735
     C                     EXSR RECOUT                                    127735
      *                                                                   127735
      **   Format event for Interest repayment                            127735
      *                                                                   127735
     C                     MOVE 'R2'      EVTYPE           Event Type     127735
     C                     Z-ADDREINT     EVAMNT           Event Amount                       226542
     C                     EXSR LEVENT                                    127735
      *                                                                   127735
      **   Perform DB Error processing if Event generation failed         127735
      *                                                                   127735
     C           *IN57     IFEQ '0'                                       127735
     C                     SETON                     U7U8                 127735
     C                     Z-ADD45        DBASE                           127735
     C                     MOVE EVCODE    DBKEY                           127735
     C                     GOTO MREND                                     127735
     C                     ENDIF                                          127735
      *                                                                   127735
     C**********           Z-ADDREINT     EVAMNT           Event Amount                127735 226542
      *                                                                   127735
      **   Determine Equivalent Amounts and the output record to file     127735
      *                                                                   127735
     C                     EXSR EQUIV                                     127735
     C                     EXSR RECOUT                                    127735
      *                                                                   127735
      **   Update current principal and interest paid this run            127735
      *                                                                   127735
     C           CPRINC    SUB  REAMT     CPRINC           Current Princ  127735
     C           INTPD     ADD  REINT     INTPD            Int.pd.this run127735
      *                                                                                       CAS005
      ** Generate 'R4' Events for CAS005 enhancement                                          CAS005
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C           PTYP      ANDNE70                                                            CAS005
     C           PTYP      ANDNE71                                                            CAS005
     C           PTYP      ANDNE72                                                            CAS005
      *                                                                                       CAS005
     C                     Z-ADDEVAMNT    WEAMNT                                              CAS005
     C                     Z-ADDINTN      EVAMNT                                              CAS005
     C                     MOVE 'R4'      EVTYPE                                              CAS005
     C                     EXSR LEVENT                                                        CAS005
      *                                                                                       CAS005
      ** IF 'R4' event type not found, issue database error                                   CAS005
      *                                                                                       CAS005
     C           *IN57     IFEQ *OFF                                                          CAS005
     C                     MOVE *ON       *INU7                                               CAS005
     C                     MOVE *ON       *INU8                                               CAS005
     C                     Z-ADD62        DBASE                                               CAS005
     C                     MOVE EVCODE    DBKEY                                               CAS005
     C                     GOTO MREND                                                         CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
      ** Determine Equivalent Amounts                                                         CAS005
      *                                                                                       CAS005
     C                     EXSR EQUIV                                                         CAS005
      *                                                                                       CAS005
     C                     Z-ADDLASN      LASEQ                                               CAS005
     C                     MOVE ' '       FREQY                                               CAS005
     C                     MOVE 'Y'       AUTOS                                               CAS005
      *                                                                                       CAS005
      ** Output 'R4' event type to File                                                       CAS005
      *                                                                                       CAS005
     C                     Z-ADDEFFINT    WEFF                                                223752
     C                     Z-ADDWINTR     EFFINT                                              223752
      *                                                                                       223752
     C                     MOVE EMUCCY    TEMUCY                                              226512
     C                     MOVE *BLANKS   EMUCCY                                              226512
      *                                                                                       226512
     C                     EXSR RECOUT                                                        CAS005
      *                                                                                       223752
     C                     Z-ADDWEFF      EFFINT                                              223752
     C                     MOVE TEMUCY    EMUCCY                                              226512
      *                                                                                       CAS005
     C           WCPNTR    SUB  REAMT     WCPNTR                                              CAS005
     C           WINNTR    ADD  INTN      WINNTR                                              CAS005
     C                     Z-ADDWEAMNT    EVAMNT                                              CAS005
     C                     ENDIF                                                              CAS005
      *                                                                   127735
     C           MREND     ENDSR                           **MREND**      127735
     C********************************************************************127735
1527 C********************************************************************
1528 C**   SUBROUTINE TO GENERATE ROLLOVER EVENT
1529 C**
1530 C**   CALLED BY: MAIN PROCESSING
1531 C**   CALLS: SR.INTCAL,LEVENT,RECOUT,BRTCHN,NEWINT
1532 C**
1533 C           ROLLVR    BEGSR                           **ROLLVR**
     C*                                                                   CEU004
     C*********************MOVE EMUCC3    EMUCCY                    CEU004CLE031
     C                     MOVE EMUCC2    EMUCCY                          CLE031
      *                                                                   CLE031
      ** If feature CLE031 is on, set up loan sett. ccy fields            CLE031
     C           CLE031    IFEQ 'Y'                                       CLE031
     C                     MOVE 'R'       WSETTL                          CLE031
     C                     EXSR LONXCY                                    CLE031
     C                     ENDIF                                          CLE031
1534 C**
1535 C**   PERFORM INTEREST CALCULATIONS
1536 C                     Z-ADDVROLLR    EVDATE           EVENT DATE
     C*                                                                   S01392
     C**   ROLLOVER PROCESSING FOR DISCOUNTED LOANS.                      S01392
     C*                                                                   S01392
     C           *IN66     IFEQ '1'                                       S01392
     C                     EXSR ROLDIS                                    S01392
     C                     GOTO ROLEND                                    S01392
     C                     END                                            S01392
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C           MDAT      IFEQ 0                                                             CAS005
     C           BPNODM    ANDNE0                                                             CAS005
     C           MDAT      OREQ 0                                                             CAS005
     C           BLDY      ANDNE0                                                             CAS005
     C                     Z-ADDWMATD     WMATD2                                              CAS005
     C                     SELEC                                                              CAS005
     C           BLDY      WHNE 0                                                             CAS005
     C                     ADD  BLDY      WMATD2                                              CAS005
     C           BPNODM    WHNE 0                                                             CAS005
     C                     ADD  BPNODM    WMATD2                                              CAS005
     C                     OTHER                                                              CAS005
     C                     ADD  15        WMATD2                                              CAS005
     C                     ENDSL                                                              CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
      ** Call new subroutine for All-In-Rate calculations                                     CAS005
      *                                                                                       CAS005
     C                     EXSR SRAIR                                                         CAS005
     C                     ENDIF                                                              CAS005
1537 C                     EXSR INTCAL
     C/COPY WNCPYSRC,LEH01267
      *                                                                   CLE006
      ** If CLE006 is installed, check if new currency is not the same    CLE006
      ** as the currency of the loan at present                           CLE006
      ** Include an 'OR' check to CEU020 and ECIN                         CEU020
      *                                                                   CLE006
     C           CLE006    IFEQ 'Y'                                       CLE006
     C           NCCY      ANDNE*BLANKS                                   CLE006
     C           NCCY      ANDNECCY                                       CLE006
     C           CLE007    OREQ 'Y'                                       CLE015
     C           NCCY      ANDNE*BLANKS                                   CLE015
     C           NCCY      ANDNECCY                                       CLE015
     C           CEU020    OREQ 'Y'                                       CEU020
     C           ECIN      ANDEQ'Y'                                       CEU020
     C           NCCY      ANDNE*BLANKS                                   140903
     C           NCCY      ANDNECCY                                       140903
      *                                                                   CLE006
      ** Format event as per P/LEVENT                                     CLE006
      ** If interest is capitalised use event type 'X2' instead           CLE006
      *                                                                   CLE006
     C           *IN54     IFEQ '0'                                       CLE006
     C                     MOVE 'I2'      EVTYPE                          CLE006
     C                     ELSE                                           CLE006
     C                     MOVE 'X2'      EVTYPE                          CLE006
     C                     MOVE *BLANKS   EMUCCY                          134961
     C                     ENDIF                                          CLE006
     C                     EXSR LEVENT                                    CLE006
      *                                                                   CLE006
      ** Database error processing                                        CLE006
      *                                                                   CLE006
     C           *IN57     IFEQ '0'                                       CLE006
     C                     Z-ADD32        DBASE            ************   CLE006
     C                     MOVE EVCODE    DBKEY            * DBERR 32 *   CLE006
     C                     MOVE '1'       *INU7            ************   CLE006
     C                     MOVE '1'       *INU8                           CLE006
     C                     GOTO ROLEND                                    CLE006
     C                     ENDIF                                          CLE006
      *                                                                   CLE006
      ** Initialise other fields                                          CLE006
      *                                                                   CLE006
     C                     Z-ADD0         LASEQ                           CLE006
     C                     MOVE RLFQ      FREQY                           CLE006
     C                     MOVE 'Y'       AUTOS                           CLE006
      *                                                                   CLE006
     C                     Z-ADDINTDUE    EVAMNT                          CLE006
      *                                                                   CLE006
      ** Determine equivalent amount                                      CLE006
      *                                                                   CLE006
     C                     EXSR EQUIV                                     CLE006
      *                                                                   CLE006
      ** Output record to file                                            CLE006
      *                                                                   CLE006
     C                     EXSR RECOUT                                    CLE006
      *                                                                                       CAS005
      ** Generate I6 Events for CAS005 enhancement                                            CAS005
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C           PTYP      ANDNE70                                                          BUG11271
     C           PTYP      ANDNE71                                                          BUG11271
     C           PTYP      ANDNE72                                                          BUG11271
     C                     Z-ADDEVAMNT    WEAMNT                                              CAS005
      *                                                                                       CAS005
      ** Call new subroutine for Net Treasury Rate calculations                               CAS005
      *                                                                                       CAS005
     C                     Z-ADD*ZERO     WEAMT                                               CAS005
     C                     Z-ADD*ZERO     WEDATX                                              CAS005
      *                                                                                       CAS005
     C                     MOVE 'N'       WCALL                                               222972
     C                     EXSR SRNTR                                                         CAS005
      *                                                                                       CAS005
     C                     Z-ADDWNTRIN    EVAMNT                                              CAS005
      *                                                                                       CAS005
     C                     MOVE 'I6'      EVTYPE                                              CAS005
     C                     EXSR LEVENT                                                        CAS005
      *                                                                                       CAS005
      ** IF 'I6' event type not found, issue database error                                   CAS005
      *                                                                                       CAS005
     C           *IN57     IFEQ *OFF                                                          CAS005
     C                     MOVE *ON       *INU7                                               CAS005
     C                     MOVE *ON       *INU8                                               CAS005
     C                     Z-ADD58        DBASE                                               CAS005
     C                     MOVE EVCODE    DBKEY                                               CAS005
     C                     GOTO ROLEND                                                        CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
      ** Determine Equivalent Amounts                                                         CAS005
      *                                                                                       CAS005
     C                     EXSR EQUIV                                                         CAS005
      *                                                                                       CAS005
     C                     Z-ADD0         LASEQ                                               CAS005
     C                     MOVE IPFR      FREQY                                               CAS005
     C                     MOVE AUTO      AUTOS                                               CAS005
      *                                                                                       CAS005
      ** Update current principal amount                                                      CAS005
      *                                                                                       CAS005
     C           *IN54     IFEQ '1'                                                           CAS005
     C                     ADD  WNTRIN    WCPNTR                                              CAS005
     C                     ELSE                                                               CAS005
     C                     ADD  WNTRIN    WINNTR                                              CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
      ** Output 'I6' event type to File                                                       CAS005
      *                                                                                       CAS005
     C                     Z-ADDEFFINT    WEFF   117                                          223752
     C                     Z-ADDWINTR     EFFINT                                              223752
      *                                                                                       223752
     C                     MOVE EMUCCY    TEMUCY                                              226512
     C                     MOVE *BLANKS   EMUCCY                                              226512
      *                                                                                       226512
     C                     EXSR RECOUT                                                        CAS005
      *                                                                                       223752
     C                     Z-ADDWEFF      EFFINT                                              223752
     C                     MOVE TEMUCY    EMUCCY                                              226512
     C                     Z-ADDWEAMNT    EVAMNT                                              CAS005
      *                                                                                       CAS005
     C                     ENDIF                                                              CAS005
      *                                                                   CLE006
      ** Update current principal if interest to be capitalised           CLE006
      ** otherwise, update interest paid                                  CLE006
      *                                                                   CLE006
     C           *IN54     IFEQ '1'                                       CLE006
     C                     ADD  INTDUE    CPRINC                          CLE006
     C                     ELSE                                           CLE006
     C                     ADD  INTDUE    INTPD                           CLE006
     C                     ENDIF                                          CLE006
      *                                                                   CLE006
      ** Format event as per P/LEVENT                                     CLE006
     C*                                                                   134961
     C*********************MOVE EMUCC3    EMUCCY                   134961 CLE031
     C                     MOVE EMUCC2    EMUCCY                          CLE031
      *                                                                   CLE031
      ** If feature CLE031 is on, set up loan sett. ccy fields            CLE031
     C           CLE031    IFEQ 'Y'                                       CLE031
     C                     MOVE 'R'       WSETTL                          CLE031
     C                     EXSR LONXCY                                    CLE031
     C                     ENDIF                                          CLE031
      *                                                                   CLE006
     C                     MOVE 'R9'      EVTYPE                          CLE006
     C                     EXSR LEVENT                                    CLE006
      *                                                                   CLE006
      ** Database error processing                                        CLE006
      *                                                                   CLE006
     C           *IN57     IFEQ '0'                                       CLE006
     C                     Z-ADD33        DBASE            ************   CLE006
     C                     MOVE EVCODE    DBKEY            * DBERR 33 *   CLE006
     C                     MOVE '1'       *INU7            ************   CLE006
     C                     MOVE '1'       *INU8                           CLE006
     C                     GOTO ROLEND                                    CLE006
     C                     ENDIF                                          CLE006
      *                                                                   CLE006
     C                     Z-ADDCPRINC    EVAMNT                          CLE006
      *                                                                   CLE006
      ** Determine equivalent amount                                      CLE006
      *                                                                   CLE006
     C                     EXSR EQUIV                                     CLE006
      *                                                                   CLE006
      ** Output record to file                                            CLE006
      *                                                                   CLE006
     C                     EXSR RECOUT                                    CLE006
      *                                                                   CLE006
      ** Change loan currency to new currency                             CLE006
      *                                                                   CLE006
     C                     MOVE NCCY      CCY                             CLE006
      *                                                                   CLE006
      ** Update current principal amount                                  CLE006
      *                                                                   CLE006
     C                     Z-ADDNCPA      CPRINC                          CLE006
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C                     Z-ADDNCPA      WCPNTR                                              CAS005
     C                     ENDIF                                                              CAS005
      *                                                                   CLE031
     C                     MOVE EMUCC3    EMUCCY                          CLE031
      *                                                                   CLE031
      ** If feature CLE031 is on, set up loan sett. ccy fields            CLE031
     C           CLE031    IFEQ 'Y'                                       CLE031
     C                     EXSR LONROL                                    CLE031
     C                     MOVE 'S'       WSETTL                          CLE031
     C                     EXSR LONXCY                                    CLE031
     C                     ENDIF                                          CLE031
      *                                                                   CLE006
      ** Format event as per P/LEVENT                                     CLE006
      *                                                                   CLE006
     C                     MOVE 'V7'      EVTYPE                          CLE006
     C                     EXSR LEVENT                                    CLE006
      *                                                                   CLE006
      ** Database error processing                                        CLE006
      *                                                                   CLE006
     C           *IN57     IFEQ '0'                                       CLE006
     C                     Z-ADD34        DBASE            ************   CLE006
     C                     MOVE EVCODE    DBKEY            * DBERR 34 *   CLE006
     C                     MOVE '1'       *INU7            ************   CLE006
     C                     MOVE '1'       *INU8                           CLE006
     C                     GOTO ROLEND                                    CLE006
     C                     ENDIF                                          CLE006
      *                                                                   CLE006
     C                     Z-ADDCPRINC    EVAMNT                          CLE006
      *                                                                   CLE006
      ** Update loan currency exchange rates                              CLE006
      *                                                                   CLE006
     C                     EXSR SRXCCY                                    CLE006
     C           *INU7     IFEQ '1'                                       CLE006
     C           *INU8     ANDEQ'1'                                       CLE006
     C                     GOTO ROLEND                                    CLE006
     C                     ENDIF                                          CLE006
      *                                                                   CLE006
      ** Determine equivalent amount                                      CLE006
      *                                                                   CLE006
     C                     EXSR EQUIV                                     CLE006
      *                                                                   CLE006
     C                     ELSE                                           CLE006
      *                                                                   CLE031
     C           CLE031    IFEQ 'Y'                                       CLE031
     C           NPRAM     ANDGT0                                         CLE031
     C           NPRAM     IFGT CPRINC                                    CLE031
     C           NPRAM     SUB  CPRINC    EVAMNT                          CLE031
     C                     MOVE 'S'       WSETTL                          CLE031
     C                     EXSR LONXCY                                    CLE031
      *                                                                   CLE031
      ** Format event                                                     CLE031
      *                                                                   CLE031
     C           GPRT1     IFEQ 'F'                                                           CLE139
     C                     MOVE 'X3'      EVTYPE                                              CLE139
     C                     ELSE                                                               CLE139
     C                     MOVE 'V3'      EVTYPE                          CLE031
     C                     ENDIF                                                              CLE139
     C                     EXSR LEVENT                                    CLE031
      *                                                                   CLE031
      ** Database error processing                                        CLE031
      *                                                                   CLE031
     C           *IN57     IFEQ '0'                                       CLE031
     C                     Z-ADD57        DBASE            ************   CLE031
     C                     MOVE EVCODE    DBKEY            * DBERR 57 *   CLE031
     C                     MOVE '1'       *INU7            ************   CLE031
     C                     MOVE '1'       *INU8                           CLE031
     C                     GOTO ROLEND                                    CLE031
     C                     ENDIF                                          CLE031
      *                                                                   CLE031
      ** Output record to file                                            CLE031
     C                     EXSR RECOUT                                    CLE031
     C                     ENDIF                                          CLE031
      *                                                                   CLE031
     C           NPRAM     IFLT CPRINC                                    CLE031
     C           CPRINC    SUB  NPRAM     EVAMNT                          CLE031
     C                     MOVE 'R'       WSETTL                          CLE031
     C                     EXSR LONXCY                                    CLE031
      *                                                                   CLE031
      ** Format event                                                     CLE031
      *                                                                   CLE031
     C                     MOVE 'R1'      EVTYPE                          CLE031
     C                     EXSR LEVENT                                    CLE031
      *                                                                   CLE031
      ** Database error processing                                        CLE031
      *                                                                   CLE031
     C           *IN57     IFEQ '0'                                       CLE031
     C                     Z-ADD58        DBASE            ************   CLE031
     C                     MOVE EVCODE    DBKEY            * DBERR 58 *   CLE031
     C                     MOVE '1'       *INU7            ************   CLE031
     C                     MOVE '1'       *INU8                           CLE031
     C                     GOTO ROLEND                                    CLE031
     C                     ENDIF                                          CLE031
      *                                                                   CLE031
      ** Output record to file                                            CLE031
     C                     EXSR RECOUT                                    CLE031
     C                     ENDIF                                          CLE031
     C***********          ENDIF                                                       CLE031 227292
      *                                                                                      218984R
      ** Update current principal amount                                                     218984R
      *                                                                                      218984R
     C                     Z-ADDNPRAM     CPRINC                                             218984R
     C                     ENDIF                                                              227292
      *                                                                   CLE031
     C                     MOVE EMUCC3    EMUCCY                          CLE031
      *                                                                   CLE031
      ** If feature CLE031 is on, set up loan sett. ccy fields            CLE031
     C           CLE031    IFEQ 'Y'                                       CLE031
     C                     EXSR LONROL                                    CLE031
     C                     MOVE 'S'       WSETTL                          CLE031
     C                     EXSR LONXCY                                    CLE031
     C                     ENDIF                                          CLE031
1538 C**
1539 C**   FORMAT EVENT AS PER P/LEVENT
1540 C                     MOVE 'R5'      EVTYPE           EVENT TYPE
1541 C                     EXSR LEVENT
1542 C  N57                SETON                     U7U8  **DATABASE 19**
1543 C  N57                Z-ADD19        DBASE
1544 C  N57                MOVE EVCODE    DBKEY
1545 C**N57******          GOTO ROLEND                                    S01117
     C   U7 U8             GOTO ROLEND                                    S01117
1546 C**
     C**
     C**   CURRENT PRINCIPAL OUTPUT ON ROLLOVER EVENTS FOR
     C**   FINANCIAL LOANS DIARY REPORT ONLY.
     C**
     C                     Z-ADDCPRINC    EVAMNT           EVENT AMOUNT
1548 C                     Z-ADD0         DBEAMT           DEALT BASE EQV.
1549 C                     Z-ADD0         SBEAMT           SPOT BASE EQV.
1550 C                     Z-ADD0         SLEAMT           SPOT LIMS. EQV.
      *                                                                   CLE006
     C                     ENDIF                                          CLE006
1551 C**
1552 C                     Z-ADD0         LASEQ            AMEND SEQUENCE
1553 C                     MOVE RLFQ      FREQY            FREQUENCY CODE
1554 C                     MOVE 'Y'       AUTOS            AUTO SETTLEMENT
1555 C**
1556 C**   CHECK IF NEW BASE RATE APPLICABLE
1557 C********** CHIN      COMP 'R'                      88                                   CLE036
1558 C********** NBRA      COMP 0                    87                                       CLE036
1559 C*********88          MOVE BRTT      BRTKEY                                              CLE036
1560 C*********87          MOVE NBRA      BRTKEY                                              CLE036
1561 C*****N88N87          GOTO TAG1                                                          CLE036
1562 C**********           EXSR BRTCHN                                                        CLE036
1563 C*********55          SETON                     U7U8                                     CLE036
1564 C*********55          Z-ADD20        DBASE                                               CLE036
1565 C*********55          GOTO ROLEND                                                        CLE036
1566 C*********  VDNR      COMP 0                        86                                   CLE036
1567 C**N86****            Z-ADDNBRT      BRATE                                               CLE036
1568 C*********  TAG1      TAG                             **TAG1 TAG**                       CLE036
      *                                                                                       CLE036
     C           CHIN      IFEQ 'R'                                                           CLE036
     C                     MOVE BRTT      BRTKEY                                              CLE036
     C                     ENDIF                                                              CLE036
      *                                                                                       CLE036
     C           NBRA      IFGT 0                                                             CLE036
     C                     MOVE NBRA      BRTKEY                                              CLE036
     C                     ENDIF                                                              CLE036
      *                                                                                       CLE036
     C           CHIN      IFEQ 'R'                                                           CLE036
     C           BRTT      ANDNE0                                                             CLE036
     C           NBRA      ORGT 0                                                             CLE036
     C                     EXSR BRTCHN                                                        CLE036
      *                                                                                       CLE036
      ** Database error handling                                                              CLE036
      *                                                                                       CLE036
     C           *IN55     IFEQ '1'                                                           CLE036
     C                     Z-ADD20        DBASE                                               CLE036
     C                     MOVE '1'       *INU7                                               CLE036
     C                     MOVE '1'       *INU8                                               CLE036
     C                     GOTO ROLEND                                                        CLE036
     C                     ENDIF                                                              CLE036
      *                                                                                       CLE036
     C           VDNR      IFNE 0                                                             CLE036
     C                     Z-ADDNBRT      BRATE                                               CLE036
     C                     ENDIF                                                              CLE036
      *                                                                                       CLE036
      ** If BRTT = 0                                                                          CLE036
      *                                                                                       CLE036
     C                     ELSE                                                               CLE036
      *                                                                                       CLE036
     C           CLE036    IFEQ 'Y'                                                           CLE036
     C           CHIN      ANDEQ'R'                                                           CLE036
     C                     Z-ADDBRTE      BRATE                                               CLE036
     C                     ENDIF                                                              CLE036
     C           CLE036    IFEQ 'Y'                                                           CLE036
     C           NBSR      ANDGT0                                                             CLE036
     C                     Z-ADDNBSR      BRATE                                               CLE036
     C                     ENDIF                                                              CLE036
      *                                                                                       CLE036
     C                     ENDIF                                                              CLE036
1569 C**
1570 C*
1571 C** PICK UP NEW ROLLOVER DETAILS IF PRESENT
1572 C           NCAC      COMP 0                        82
1573 C      82             GOTO TAG2
1574 C                     Z-ADDNRTS      SPRATE           SPREAD/RATE
1575 C                     MOVE NSIN      SPRIND           SPREAD IND.
1576 C                     MOVE NCAC      INTBAS           CALC. BASIS
1577 C**
1578 C           TAG2      TAG                             ** TAG2 TAG **
      *                                                                   CLE011
     C           CLE011    IFEQ 'Y'                                       CLE011
     C           RFRI      ANDEQ'Y'                                       CLE011
      *                                                                   CLE011
     C           SPRIND    IFEQ 'A'                                       CLE011
     C           RFRT      SUB  SPRATE    BRATE                           CLE011
     C                     ENDIF                                          CLE011
      *                                                                   CLE011
     C           SPRIND    IFEQ 'S'                                       CLE011
     C           RFRT      ADD  SPRATE    BRATE                           CLE011
     C                     ENDIF                                          CLE011
      *                                                                   CLE011
     C           SPRIND    IFEQ 'P'                                       CLE011
     C           RFRT      MULT 100       WRFRT  137                      CLE011
     C           WRFRT     DIV  SPRATE    BRATE                           CLE011
     C                     ENDIF                                          CLE011
      *                                                                   CLE011
     C                     ENDIF                                          CLE011
      *                                                                   CLE011
     C           CAS005    IFEQ 'Y'                                                           224321
     C                     Z-ADDEFFINT    WEFINT 117                                          224321
     C                     ENDIF                                                              224321
      *                                                                                       224321
1579 C                     EXSR NEWINT
1580 C**
1581 C**   OUTPUT RECORD TO FILE
1582 C                     EXSR RECOUT
1583 C**
     C           CAS005    IFEQ 'Y'                                                           224321
     C********** EFFINT    ANDEQ0                                                      224321 245725
      *                                                                                       245725
     C           EFFINT    IFEQ 0                                                             245725
     C                     Z-ADDWEFINT    EFFINT                                              224321
     C                     ENDIF                                                              245725
      *                                                                                       226261
     C           CAS005    IFEQ 'Y'                                                           226261
      *                                                                                       226261
      ** Check rollover details if rate is floating or fixed                                  226261
      *                                                                                       226261
     C                     MOVE 'N'       WFXDR                                               229938
      *                                                                                       229938
     C           NBRA      IFEQ 0                                                             229938
     C           NRTS      ANDNE0                                                             229938
     C                     MOVE 'Y'       WFXDR                                               229938
     C                     ENDIF                                                              229938
     C**********           SELEC                                                       226261 229938
     C********** NBRA      WHNE 0                                                      226261 229938
     C********** NCHI      ANDEQ'D'                                                    226261 229938
     C********** NBRA      ORNE 0                                                      226261 229938
     C********** NCHI      ANDEQ'R'                                                    226261 229938
     C**********           MOVE 'N'       WFXDR                                        226261 229938
     C********** NBRA      WHNE 0                                                      226261 229938
     C********** NCHI      ANDEQ'N'                                                    226261 229938
     C**********           MOVE 'Y'       WFXDR                                        226261 229938
     C********** NBRA      WHEQ 0                                                      226261 229938
     C********** NRTS      ANDNE0                                                      226261 229938
     C**********           MOVE 'Y'       WFXDR                                        226261 229938
     C********** NBRA      WHEQ 0                                                      226261 229938
     C********** NRTS      ANDEQ0                                                      226261 229938
     C********** BRTT      ANDNE0                                                      226261 229938
     C********** CHIN      ANDNE'N'                                                    226261 229938
     C**********           MOVE 'N'       WFXDR                                        226261 229938
     C********** NBRA      WHEQ 0                                                      226261 229938
     C********** NRTS      ANDEQ0                                                      226261 229938
     C********** BRTT      ANDEQ0                                                      226261 229938
     C**********           MOVE 'Y'       WFXDR                                        226261 229938
     C**********           ENDSL                                                       226261 229938
      *                                                                                       226261
      ** If new ccy, yield curve or interest basis, use the new values                        226261
      ** when retrieving rate if the rate is considered floating or unknown                   226261
      *                                                                                       226261
     C                     MOVE *BLANK    WNCCY                                               226261
     C                     Z-ADD0         WNCAC                                               226261
     C                     MOVE *BLANK    WNFYLB                                              226261
     C           NCCY      IFNE *BLANK                                                        226261
     C           NCCY      ANDNECCY                                                           226261
     C                     MOVE NCCY      WNCCY                                               226261
     C                     ENDIF                                                              226261
     C           NCAC      IFNE 0                                                             226261
     C           NCAC      ANDNEICBS                                                          226261
     C                     MOVE NCAC      WNCAC                                               226261
     C                     ENDIF                                                              226261
     C           FSFYLB    IFNE *BLANK                                                        226261
     C           FSFYLB    ANDNEFSFYLD                                                        226261
     C                     MOVE FSFYLB    WNFYLB                                              226261
     C                     ENDIF                                                              226261
      *                                                                                       229938
      *                                                                                       229938
      ** Determine next rollover date                                                         229938
      *                                                                                       229938
     C           RLFQ      IFNE ' '                                                           229938
     C                     MOVE RLFQ      ZFREQ                                               229938
     C                     Z-ADDRLDT      ZDAYNO                                              229938
     C                     Z-ADDRLDY      ZMDAY                                               229938
     C           WNCCY     IFNE *BLANK                                                        229938
     C                     MOVE WNCCY     ZCCY                                                229938
     C                     ELSE                                                               229938
     C                     MOVE CCY       ZCCY                                                229938
     C                     ENDIF                                                              229938
     C           CLE005    IFEQ 'N'                                                           229938
      *                                                                                       CLE141
      ** Call Business Day Convention for Lending Transaction                                 CLE141
      *                                                                                       CLE141
     C           CLE141    IFEQ 'Y'                                                           CLE141
     C                     EXSR ZFRQB3                                                        CLE141
      *                                                                                       CLE141
     C                     CALL 'LEZBDYCD'                                                    CLE141
     C                     PARM           ZDAYNO                                              CLE141
     C                     PARM           PRCUR                                               CLE141
     C                     PARM           PRLOC                                               CLE141
     C**********           PARM *BLANKS   PPDDI                                      CLE141 MD047693
     C                     PARM PDDI      PPDDI                                             MD047693
     C                     PARM           DATF                                                CLE141
     C                     PARM *BLANKS   PCCY                                               CLE141A
     C                     PARM *BLANKS   PLOC                                               CLE141A
     C                     PARM           ZDYNBR                                              CLE141
     C                     Z-ADDZDYNBR    ZDAYNO                                              CLE141
     C                     ELSE                                                               CLE141
     C                     EXSR ZFREQB                                                        229938
     C                     ENDIF                                                              CLE141
      *                                                                                       CLE141
     C                     ELSE                                                               229938
     C                     EXSR ZFRQB3                                                        229938
      *                                                                                       CLE141
      ** Call Business Day Convention for Lending Transaction                                 CLE141
      *                                                                                       CLE141
     C           CLE141    IFEQ 'Y'                                                           CLE141
     C                     CALL 'LEZBDYCD'                                                    CLE141
     C                     PARM           ZDAYNO                                              CLE141
     C                     PARM           PRCUR                                               CLE141
     C                     PARM           PRLOC                                               CLE141
     C**********           PARM *BLANKS   PPDDI                                      CLE141 MD047693
     C                     PARM PDDI      PPDDI                                             MD047693
     C                     PARM           DATF                                                CLE141
     C                     PARM *BLANKS   PCCY                                               CLE141A
     C                     PARM *BLANKS   PLOC                                               CLE141A
     C                     PARM           ZDYNBR                                              CLE141
     C                     Z-ADDZDYNBR    ZDAYNO                                              CLE141
     C                     ENDIF                                                              CLE141
     C                     ENDIF                                                              229938
     C                     Z-ADDZDAYNO    WNXRO                                               229938
     C                     ENDIF                                                              229938
     C                     ENDIF                                                              226261
     C                     ENDIF                                                              224321
     C*                                                                   S01408
     C/COPY WNCPYSRC,LE0480CCP9                                           S01408
     C*                                                                   S01408
1584 C                     Z-ADD99999     VROLLR           ROLLOVER DATE
     C*                                                                   S01408
     C/COPY WNCPYSRC,LE0480CCP8                                           S01408
     C*                                                                   S01408
1585 C**
1586 C           ROLEND    ENDSR                           **ROLEND**
1587 C********************************************************************
     C********************************************************************S01392
     C**   SUBROUTINE TO GENERATE ROLLOVER EVENTS FOR DISC. LOAN          S01392
     C**                                                                  S01392
     C**   CALLED BY: ROLLVR                                              S01392
     C**   CALLS    : SR.EQUIV,NEWINT,RECOUT,LEVENT                       S01392
     C           ROLDIS    BEGSR                           **ROLDIS**     S01392
     C*                                                                   CEU004
     C*********************MOVE EMUCC3    EMUCCY                    CEU004CLE031
     C                     MOVE EMUCC2    EMUCCY                          CLE031
      *                                                                   CLE031
      ** If feature CLE031 is on, set up loan sett. ccy fields            CLE031
     C           CLE031    IFEQ 'Y'                                       CLE031
     C                     MOVE 'R'       WSETTL                          CLE031
     C                     EXSR LONXCY                                    CLE031
     C                     ENDIF                                          CLE031
      *                                                                   CLE006
      ** If CLE006 is installed, check if new currency is not the same    CLE006
      ** as the currency of the loan at present                           CLE006
      ** Include an 'OR' check to CEU020 and ECIN                         CEU020
      *                                                                   CLE006
     C           CLE006    IFEQ 'Y'                                       CLE006
     C           NCCY      ANDNE*BLANKS                                   CLE006
     C           NCCY      ANDNECCY                                       CLE006
     C           CLE007    OREQ 'Y'                                       CLE015
     C           NCCY      ANDNE*BLANKS                                   CLE015
     C           NCCY      ANDNECCY                                       CLE015
     C           CEU020    OREQ 'Y'                                       CEU020
     C           ECIN      ANDEQ'Y'                                       CEU020
     C           NCCY      ANDNE*BLANKS                                   140903
     C           NCCY      ANDNECCY                                       140903
      *                                                                   CLE006
      ** Format event as per P/LEVENT                                     CLE006
      *                                                                   CLE006
     C                     MOVE 'R9'      EVTYPE                          CLE006
     C                     EXSR LEVENT                                    CLE006
      *                                                                   CLE006
      ** Database error processing                                        CLE006
      *                                                                   CLE006
     C           *IN57     IFEQ '0'                                       CLE006
     C                     Z-ADD38        DBASE            ************   CLE006
     C                     MOVE EVCODE    DBKEY            * DBERR 38 *   CLE006
     C                     MOVE '1'       *INU7            ************   CLE006
     C                     MOVE '1'       *INU8                           CLE006
     C                     GOTO DISEND                                    CLE006
     C                     ENDIF                                          CLE006
      *                                                                   CLE006
      ** Initialise other fields                                          CLE006
      *                                                                   CLE006
     C                     Z-ADD0         LASEQ                           CLE006
     C                     MOVE RLFQ      FREQY                           CLE006
     C                     MOVE 'Y'       AUTOS                           CLE006
      *                                                                   CLE006
     C                     Z-ADDCPRINC    EVAMNT                          CLE006
      *                                                                   CLE006
      ** Determine equivalent amount                                      CLE006
      *                                                                   CLE006
     C                     EXSR EQUIV                                     CLE006
      *                                                                   CLE006
      ** Output record to file                                            CLE006
      *                                                                   CLE006
     C                     EXSR RECOUT                                    CLE006
      *                                                                   CLE006
      ** Change loan currency to new currency                             CLE006
      *                                                                   CLE006
     C                     MOVELNCCY      CCY                             CLE006
      *                                                                   CLE031
     C                     MOVE EMUCC3    EMUCCY                          CLE031
      *                                                                   CLE031
      ** If feature CLE031 is on, set up loan sett. ccy fields            CLE031
     C           CLE031    IFEQ 'Y'                                       CLE031
     C                     EXSR LONROL                                    CLE031
     C                     MOVE 'R'       WSETTL                          CLE031
     C                     EXSR LONXCY                                    CLE031
     C                     ENDIF                                          CLE031
      *                                                                   CLE006
      ** Format event as per P/LEVENT                                     CLE006
      *                                                                   CLE006
     C                     MOVE 'I3'      EVTYPE                          CLE006
     C                     EXSR LEVENT                                    CLE006
      *                                                                   CLE006
      ** Database error processing                                        CLE006
      *                                                                   CLE006
     C           *IN57     IFEQ '0'                                       CLE006
     C                     Z-ADD39        DBASE            ************   CLE006
     C                     MOVE EVCODE    DBKEY            * DBERR 39 *   CLE006
     C                     MOVE '1'       *INU7            ************   CLE006
     C                     MOVE '1'       *INU8                           CLE006
     C                     GOTO DISEND                                    CLE006
     C                     ENDIF                                          CLE006
      *                                                                   CLE006
     C                     Z-ADDNDAM      EVAMNT                          CLE006
      *                                                                   CLE006
      ** Update loan currency exchange rates                              CLE006
      *                                                                   CLE006
     C                     EXSR SRXCCY                                    CLE006
     C           *INU7     IFEQ '1'                                       CLE006
     C           *INU8     ANDEQ'1'                                       CLE006
     C                     GOTO DISEND                                    CLE006
     C                     ENDIF                                          CLE006
      *                                                                   CLE006
      ** Determine equivalent amount                                      CLE006
      *                                                                   CLE006
     C                     EXSR EQUIV                                     CLE006
      *                                                                   CLE006
      ** Check if new base rate is applicable                             CLE006
      *                                                                   CLE006
     C           CHIN      IFEQ 'R'                                       CLE006
     C                     MOVE BRTT      BRTKEY                          CLE006
     C                     ENDIF                                          CLE006
      *                                                                   CLE006
     C           NBRA      IFGT 0                                         CLE006
     C                     MOVE NBRA      BRTKEY                          CLE006
     C                     ENDIF                                          CLE006
      *                                                                   CLE006
     C           CHIN      IFEQ 'R'                                       CLE006
     C           BRTT      ANDNE0                                                             CLE036
     C           NBRA      ORGT 0                                         CLE006
     C                     EXSR BRTCHN                                    CLE006
      *                                                                   CLE006
      ** Database error handling                                          CLE006
      *                                                                   CLE006
     C           *IN55     IFEQ '1'                                       CLE006
     C                     Z-ADD40        DBASE            ************   CLE006
     C                     MOVE '1'       *INU7            * DBERR 40 *   CLE006
     C                     MOVE '1'       *INU8            ************   CLE006
     C                     GOTO DISEND                                    CLE006
     C                     ENDIF                                          CLE006
      *                                                                                       CLE036
      ** If BRTT = 0                                                                          CLE036
      *                                                                                       CLE036
     C                     ELSE                                                               CLE036
      *                                                                                       CLE036
     C           CLE036    IFEQ 'Y'                                                           CLE036
     C           CHIN      ANDEQ'R'                                                           CLE036
     C                     Z-ADDBRTE      BRATE                                               CLE036
     C                     ENDIF                                                              CLE036
     C           CLE036    IFEQ 'Y'                                                           CLE036
     C           NBSR      ANDGT0                                                             CLE036
     C                     Z-ADDNBSR      BRATE                                               CLE036
     C                     ENDIF                                                              CLE036
      *                                                                                       CLE036
      *                                                                   CLE006
     C           VDNR      IFNE 0                                         CLE006
     C                     Z-ADDNBRT      BRATE                           CLE006
     C                     ENDIF                                          CLE006
     C                     ENDIF                                          CLE006
      *                                                                   CLE006
      ** Pick up new rollover details if present                          CLE006
      *                                                                   CLE006
     C           NCAC      IFNE 0                                         CLE006
     C                     Z-ADDNRTS      SPRATE                          CLE006
     C                     MOVE NSIN      SPRIND                          CLE006
     C                     MOVE NCAC      INTBAS                          CLE006
     C                     ENDIF                                          CLE006
      *                                                                   CLE011
     C           CLE011    IFEQ 'Y'                                       CLE011
     C           RFRI      ANDEQ'Y'                                       CLE011
      *                                                                   CLE011
     C           SPRIND    IFEQ 'A'                                       CLE011
     C           RFRT      SUB  SPRATE    BRATE                           CLE011
     C                     ENDIF                                          CLE011
      *                                                                   CLE011
     C           SPRIND    IFEQ 'S'                                       CLE011
     C           RFRT      ADD  SPRATE    BRATE                           CLE011
     C                     ENDIF                                          CLE011
      *                                                                   CLE011
     C           SPRIND    IFEQ 'P'                                       CLE011
     C           RFRT      MULT 100       WRFRT                           CLE011
     C           WRFRT     DIV  SPRATE    BRATE                           CLE011
     C                     ENDIF                                          CLE011
      *                                                                   CLE011
     C                     ENDIF                                          CLE011
      *                                                                   CLE006
      ** Update effective interest rate                                   CLE006
      *                                                                   CLE006
     C                     EXSR NEWINT                                    CLE006
      *                                                                   CLE006
      ** Output record to file                                            CLE006
      *                                                                   CLE006
     C                     EXSR RECOUT                                    CLE006
      *                                                                   CLE006
      ** Update current principal amount                                  CLE006
      *                                                                   CLE006
     C                     Z-ADDNPRAM     CPRINC                          CLE006
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C                     Z-ADDNPRAM     WCPNTR                                              CAS005
     C                     ENDIF                                                              CAS005
      *                                                                   CLE031
     C                     MOVE EMUCC3    EMUCCY                          CLE031
      *                                                                   CLE031
      ** If feature CLE031 is on, set up loan sett. ccy fields            CLE031
     C           CLE031    IFEQ 'Y'                                       CLE031
     C                     MOVE 'S'       WSETTL                          CLE031
     C                     EXSR LONXCY                                    CLE031
     C                     ENDIF                                          CLE031
      *                                                                   CLE006
      ** Format event as per P/LEVENT                                     CLE006
      *                                                                   CLE006
     C                     MOVE 'V7'      EVTYPE                          CLE006
     C                     EXSR LEVENT                                    CLE006
      *                                                                   CLE006
      ** Database error processing                                        CLE006
      *                                                                   CLE006
     C           *IN57     IFEQ '0'                                       CLE006
     C                     Z-ADD41        DBASE            ************   CLE006
     C                     MOVE EVCODE    DBKEY            * DBERR 41 *   CLE006
     C                     MOVE '1'       *INU7            ************   CLE006
     C                     MOVE '1'       *INU8                           CLE006
     C                     GOTO DISEND                                    CLE006
     C                     ENDIF                                          CLE006
      *                                                                   CLE006
     C                     Z-ADDNPRAM     EVAMNT                          CLE006
      *                                                                   CLE006
     C                     ELSE                                           CLE006
      *                                                                   CLE031
     C                     MOVE EMUCC3    EMUCCY                          CLE031
      *                                                                   CLE031
     C           CLE031    IFEQ 'Y'                                       CLE031
      *                                                                   CLE031
      ** If loan or part purchased                                        CLE031
     C           PTYP      IFEQ 61                                        CLE031
     C           PTYP      OREQ 62                                        CLE031
     C           PTYP      OREQ 63                                        CLE031
     C           PTYP      OREQ 64                                        CLE031
     C           PTYP      OREQ 65                                        CLE031
     C           PTYP      OREQ 68                                        CLE031
     C           PTYP      OREQ 70                                        CLE031
     C           PTYP      OREQ 71                                        CLE031
     C           PTYP      OREQ 80                                        CLE031
     C                     MOVE WRRSC     EMUCCY                          CLE031
     C                     Z-ADDWRRSR     WEXCHR                          CLE031
     C                     MOVE WRRSI     WMDIN                           CLE031
     C                     ENDIF                                          CLE031
      *                                                                   CLE031
      ** If part sold                                                     CLE031
     C           PTYP      IFEQ 66                                        CLE031
     C           PTYP      OREQ 67                                        CLE031
     C           PTYP      OREQ 69                                        CLE031
     C           PTYP      OREQ 72                                        CLE031
     C                     MOVE WRPSC     EMUCCY                          CLE031
     C                     Z-ADDWRPSR     WEXCHR                          CLE031
     C                     MOVE WRPSI     WMDIN                           CLE031
     C                     ENDIF                                          CLE031
     C                     ENDIF                                          CLE031
     C**                                                                  S01392
     C**   FORMAT EVENT AS PER P/LEVENT                                   S01392
     C                     MOVE 'R5'      EVTYPE           EVENT TYPE     S01392
     C                     EXSR LEVENT                                    S01392
     C  N57                SETON                     U7U8  **DATABASE 19**S01392
     C  N57                Z-ADD24        DBASE                           S01392
     C  N57                MOVE EVCODE    DBKEY                           S01392
     C  N57                GOTO DISEND                                    S01392
     C*                                                                   S01392
     C                     Z-ADDNDAM      EVAMNT           NEW PRINCIPAL  S01392
     C**                                                                  S01392
     C**   DETERMINE EQUIVALENT AMOUNTS                                   S01392
     C                     EXSR EQUIV                                     S01392
     C                     Z-ADD0         LASEQ            AMEND SEQ      S01392
     C                     MOVE RLFQ      FREQY            FREQUENCY CODE S01392
     C                     MOVE 'Y'       AUTOS            AUTO SETTLEMENTS01392
     C**                                                                  S01392
     C**   CHECK IF NEW BASE RATE APPLICABLE                              S01392
     C********** CHIN      COMP 'R'                      88                            S01392 CLE036
     C********** NBRA      COMP 0                    87                                S01392 CLE036
     C*********88          MOVE BRTT      BRTKEY                                       S01392 CLE036
     C*********87          MOVE NBRA      BRTKEY                                       S01392 CLE036
     C*****N88N87          GOTO TAGR1                                                  S01392 CLE036
     C**********           EXSR BRTCHN                                                 S01392 CLE036
     C*********55          SETON                     U7U8                              S01392 CLE036
     C*********55          Z-ADD20        DBASE                                        S01392 CLE036
     C*********55          GOTO DISEND                                                 S01392 CLE036
     C********** VDNR      COMP 0                        86                            S01392 CLE036
     C**N86*****           Z-ADDNBRT      BRATE                                        S01392 CLE036
     C********** TAGR1     TAG                             **TAGR1 TAG**               S01392 CLE036
      *                                                                                       CLE036
     C           CHIN      IFEQ 'R'                                                           CLE036
     C                     MOVE BRTT      BRTKEY                                              CLE036
     C                     ENDIF                                                              CLE036
      *                                                                                       CLE036
     C           NBRA      IFGT 0                                                             CLE036
     C                     MOVE NBRA      BRTKEY                                              CLE036
     C                     ENDIF                                                              CLE036
      *                                                                                       CLE036
     C           CHIN      IFEQ 'R'                                                           CLE036
     C           BRTT      ANDNE0                                                             CLE036
     C           NBRA      ORGT 0                                                             CLE036
     C                     EXSR BRTCHN                                                        CLE036
      *                                                                                       CLE036
      ** Database error handling                                                              CLE036
      *                                                                                       CLE036
     C           *IN55     IFEQ '1'                                                           CLE036
     C                     Z-ADD20        DBASE                                               CLE036
     C                     MOVE '1'       *INU7                                               CLE036
     C                     MOVE '1'       *INU8                                               CLE036
     C                     GOTO DISEND                                                        CLE036
     C                     ENDIF                                                              CLE036
      *                                                                                       CLE036
     C           VDNR      IFNE 0                                                             CLE036
     C                     Z-ADDNBRT      BRATE                                               CLE036
     C                     ENDIF                                                              CLE036
      *                                                                                       CLE036
      ** If BRTT = 0                                                                          CLE036
      *                                                                                       CLE036
     C                     ELSE                                                               CLE036
      *                                                                                       CLE036
     C           CLE036    IFEQ 'Y'                                                           CLE036
     C           CHIN      ANDEQ'R'                                                           CLE036
     C                     Z-ADDBRTE      BRATE                                               CLE036
     C                     ENDIF                                                              CLE036
     C           CLE036    IFEQ 'Y'                                                           CLE036
     C           NBSR      ANDGT0                                                             CLE036
     C                     Z-ADDNBSR      BRATE                                               CLE036
     C                     ENDIF                                                              CLE036
      *                                                                                       CLE036
     C                     ENDIF                                                              CLE036
     C**                                                                  S01392
     C**   PICK UP NEW ROLLOVER DETAILS IF PRESENT                        S01392
     C           NCAC      COMP 0                        82               S01392
     C      82             GOTO TAGR2                                     S01392
     C                     Z-ADDNRTS      SPRATE           SPREAD/RATE    S01392
     C                     MOVE NSIN      SPRIND           SPREAD IND.    S01392
     C                     MOVE NCAC      INTBAS           CALC. BASIS    S01392
     C**                                                                  S01392
     C           TAGR2     TAG                             **TAGR2 TAG**  S01392
      *                                                                   CLE011
     C           CLE011    IFEQ 'Y'                                       CLE011
     C           RFRI      ANDEQ'Y'                                       CLE011
      *                                                                   CLE011
     C           SPRIND    IFEQ 'A'                                       CLE011
     C           RFRT      SUB  SPRATE    BRATE                           CLE011
     C                     ENDIF                                          CLE011
      *                                                                   CLE011
     C           SPRIND    IFEQ 'S'                                       CLE011
     C           RFRT      ADD  SPRATE    BRATE                           CLE011
     C                     ENDIF                                          CLE011
      *                                                                   CLE011
     C           SPRIND    IFEQ 'P'                                       CLE011
     C           RFRT      MULT 100       WRFRT                           CLE011
     C           WRFRT     DIV  SPRATE    BRATE                           CLE011
     C                     ENDIF                                          CLE011
      *                                                                   CLE011
     C                     ENDIF                                          CLE011
      *                                                                   CLE011
     C                     EXSR NEWINT                                    S01392
     C**                                                                  S01392
     C**   OUTPUT RECORD TO FILE                                          S01392
     C                     EXSR RECOUT                                    S01392
     C**                                                                  S01392
     C**                                                                  S01392
     C                     Z-ADDEFFINT    SAVINT 117       SAVE EFFINT    S01392
     C                     Z-ADDINTR      EFFINT           CURR INT RATE  S01392
      *                                                                   CLE031
     C                     MOVE EMUCC2    EMUCCY                          CLE031
      *                                                                   CLE031
      ** If feature CLE031 is on, set up loan sett. ccy fields            CLE031
     C           CLE031    IFEQ 'Y'                                       CLE031
     C                     MOVE 'R'       WSETTL                          CLE031
     C                     EXSR LONXCY                                    CLE031
     C                     ENDIF                                          CLE031
     C**                                                                  S01392
     C                     MOVE 'R4'      EVTYPE           EVENT TYPE     S01392
     C                     EXSR LEVENT                                    S01392
     C  N57                SETON                     U7U8  **DATABASE 22**S01392
     C  N57                Z-ADD22        DBASE                           S01392
     C  N57                MOVE EVCODE    DBKEY                           S01392
     C  N57                GOTO DISEND                                    S01392
     C**                                                                  S01392
     C                     Z-ADDCPRINC    EVAMNT           CURRENT PRINC  S01392
     C*                                                                   S01392
     C                     EXSR EQUIV                                     S01392
     C**                                                                  S01392
     C                     EXSR RECOUT                                    S01392
     C**                                                                  S01392
     C                     Z-ADDSAVINT    EFFINT           RESTORE FIELD  S01392
      *                                                                   CLE031
     C                     MOVE EMUCC3    EMUCCY                          CLE031
      *                                                                   CLE031
      ** If feature CLE031 is on, set up loan sett. ccy fields            CLE031
     C           CLE031    IFEQ 'Y'                                       CLE031
     C                     EXSR LONROL                                    CLE031
     C                     MOVE 'S'       WSETTL                          CLE031
     C                     EXSR LONXCY                                    CLE031
     C                     ENDIF                                          CLE031
     C**                                                                  S01392
     C                     MOVE 'R3'      EVTYPE           EVENT TYPE     S01392
     C                     EXSR LEVENT                                    S01392
     C  N57                SETON                     U7U8  **DATABASE 23**S01392
     C  N57                Z-ADD23        DBASE                           S01392
     C  N57                MOVE EVCODE    DBKEY                           S01392
     C  N57                GOTO DISEND                                    S01392
     C                     Z-ADDNPRAM     EVAMNT                          S01392
      *                                                                   CLE006
     C                     ENDIF                                          CLE006
     C**                                                                  S01392
     C                     EXSR EQUIV                                     S01392
     C**                                                                  S01392
     C                     EXSR RECOUT                                    S01392
     C**                                                                  S01392
     C                     Z-ADD99999     VROLLR                          S01392
     C           DISEND    ENDSR                                          S01392
     C********************************************************************S01392
1588 C********************************************************************
1589 C**   SUBROUTINE TO GENERATE MATURITY EVENT(S)
1590 C**
1591 C**   CALLED BY: MAIN PROCESSING
1592 C**   CALLS    : SR.INTCAL,LEVENT,EQUIV,RECOUT
1593 C**
1594 C           MATUR     BEGSR                           **MATUR**
     C*                                                                   CEU004
     C                     MOVE EMUCC2    EMUCCY                          CEU004
      *                                                                   CLE031
      ** If feature CLE031 is on, set up loan sett. ccy fields            CLE031
     C           CLE031    IFEQ 'Y'                                       CLE031
     C                     MOVE 'R'       WSETTL                          CLE031
     C                     EXSR LONXCY                                    CLE031
     C                     ENDIF                                          CLE031
1595 C**
1596 C**   PERFORM INTEREST CALCULATIONS
1597 C                     Z-ADDVMATUR    EVDATE           EVENT DATE
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C           MDAT      IFEQ 0                                                             CAS005
     C           BPNODM    ANDNE0                                                             CAS005
     C           MDAT      OREQ 0                                                             CAS005
     C           BLDY      ANDNE0                                                             CAS005
     C                     Z-ADDWMATD     WMATD2                                              CAS005
     C                     SELEC                                                              CAS005
     C           BLDY      WHNE 0                                                             CAS005
     C                     ADD  BLDY      WMATD2                                              CAS005
     C           BPNODM    WHNE 0                                                             CAS005
     C                     ADD  BPNODM    WMATD2                                              CAS005
     C                     OTHER                                                              CAS005
     C                     ADD  15        WMATD2                                              CAS005
     C                     ENDSL                                                              CAS005
     C                     Z-ADDWMATD2    EVDATE                                              CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
      ** Call new subroutine for All-In-Rate calculations                                     CAS005
      *                                                                                       CAS005
     C                     EXSR SRAIR                                                         CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CLE028
      ** Instead of executing SR/GLINTC, process RULE78Z1 if CLE028 is on,                    CLE028
      ** and processing type (PTYP) is 80                                                     CLE028
      *                                                                                       CLE028
     C           CLE028    IFEQ 'Y'                                                           CLE028
     C           PTYP      ANDEQ80                                                            CLE028
     C                     Z-ADDVDAT      W78VDT                                              CLE028
     C                     Z-ADDMDAT      W78MDT                                              CLE028
     C                     Z-ADDFLTI      W78FLT                                              CLE028
     C                     MOVE RFRQ      W78RPF                                              CLE028
     C                     Z-ADDFRPD      W78FRD                                              CLE028
     C                     Z-ADDRDYN      W78RPM                                              CLE028
     C                     MOVE CCY       W78CCY                                              CLE028
     C                     MOVE *BLANKS   W78LCN                                              CLE028
     C                     Z-ADDEVDATE    W78BEG                                              CLE028
     C                     Z-ADDEVDATE    W78END                                              CLE028
     C                     MOVE 'R'       W78ROA                                              CLE028
      *                                                                                       CLE028
     C                     EXSR RULE78                                                        CLE028
     C                     Z-ADDW78INT    INTDUE                                              CLE028
      *                                                                                       CLE028
     C                     ELSE                                                               CLE028
      *                                                                                       CLE028
1598 C                     EXSR INTCAL
      *                                                                                       CLE028
     C                     ENDIF                                                              CLE028
     C/COPY WNCPYSRC,LE0480C027
1599 C**
1600 C**   FOR CALL LOANS WITH MAT. DATE=0,NOMINAL MAT. DATE(RUN DATE+15)
1601 C**   IS REQUIRED ONLY FOR SELECTION OF EVENTS & CALC. OF INTEREST-
1602 C**   HENCE RESET EVENT DATE HERE TO ACTUAL MAT. DATE
1603 C***********          Z-ADDMDAT      EVDATE                          088708
     C  N10                Z-ADDMDAT      EVDATE                          088708
     C           *IN10     IFEQ '1'                                       088708
     C           RLDT      IFEQ MDAT                                      088708
     C           NMDT      ANDNE0                                         088708
     C                     Z-ADDNMDT      VMATUR                          088708
     C                     ELSE                                           088708
     C                     Z-ADDMDAT      VMATUR                          088708
     C                     END                                            088708
     C                     END                                            088708
     C           *IN66     IFEQ '1'                                       S01392
     C                     Z-ADDVMATUR    EVDATE                          S01392
     C                     END                                            S01392
      *                                                                                       249975
     C           CLE005    IFEQ 'Y'                                                           249975
     C                     Z-ADD*ZERO     ZNRDYS                                              249975
     C                     Z-ADDVMATUR    ZDAYNO                                              249975
     C                     MOVE CCY       ZCCY                                                249975
      *                                                                                       249975
      ** If CEU004 on use Settlement ccy if not blank                                         249975
      *                                                                                       249975
     C           CEU004    IFEQ 'Y'                                                           249975
     C           EMUCCY    IFNE *BLANKS                                                       249975
     C                     MOVE EMUCCY    ZCCY                                                249975
     C                     ENDIF                                                              249975
     C                     ENDIF                                                              249975
     C           *IN77     IFEQ '0'                                                           249975
     C                     EXSR MATLOC                                                        249975
     C                     ENDIF                                                              249975
     C                     MOVE W@MDSL    ZLOC                                                249975
      *                                                                                       CLE141
      ** Call Business Day Convention for Lending Transaction                                 CLE141
      *                                                                                       CLE141
     C           CLE141    IFEQ 'Y'                                                           CLE141
     C********** MDST      ANDEQ01                                                    CLE141 CLE141A
     C********** CLE141    OREQ 'Y'                                                   CLE141 CLE141A
     C********** MDST      ANDEQ07                                                    CLE141 CLE141A
     C********** CLE141    OREQ 'Y'                                                   CLE141 CLE141A
     C********** MDST      ANDEQ08                                                    CLE141 CLE141A
     C                     CALL 'LEZBDYCD'                                                    CLE141
     C                     PARM           ZDAYNO                                              CLE141
     C                     PARM           PICUR                                               CLE141
     C                     PARM           PILOC                                               CLE141
     C                     PARM PTDI      PPDDI                                               CLE141
     C                     PARM           DATF                                                CLE141
     C                     PARM ZCCY      PCCY                                               CLE141A
     C                     PARM ZLOC      PLOC                                               CLE141A
     C                     PARM           ZDYNBR                                              CLE141
     C                     ELSE                                                               CLE141
     C                     SELEC                                                              249975
     C           PTDI      WHEQ 'P'                                                           249975
     C                     EXSR ZBKDT                                                         249975
     C           PTDI      WHEQ 'N'                                                           249975
     C           PTDI      OREQ *BLANK                                                        249975
     C                     EXSR ZFWDT                                                         249975
     C           PTDI      WHEQ 'M'                                                           249975
     C                     EXSR ZDATE2                                                        249975
     C           *IN98     IFEQ *OFF                                                          249975
     C                     MOVE ZDATE     MMYY    40P                                         249975
     C                     MOVELMMYY      MMNLCD  20P                                         249975
     C                     ELSE                                                               249975
     C                     MOVELZDATE     MMNLCD    P                                         249975
     C                     ENDIF                                                              249975
     C                     Z-ADDZDAYNO    @DAYNO  50                                          249975
     C                     EXSR ZFWDT                                                         249975
     C                     Z-ADDZDYNBR    ZDAYNO                                              249975
     C                     EXSR ZDATE2                                                        249975
     C           *IN98     IFEQ *OFF                                                          249975
     C                     MOVE ZDATE     MMYY      P                                         249975
     C                     MOVELMMYY      MMNWKD  20P                                         249975
     C                     ELSE                                                               249975
     C                     MOVELZDATE     MMNWKD    P                                         249975
     C                     ENDIF                                                              249975
     C           MMNLCD    IFNE MMNWKD                                                        249975
     C                     Z-ADD@DAYNO    ZDAYNO                                              249975
     C                     EXSR ZBKDT                                                         249975
     C                     ENDIF                                                              249975
     C                     ENDSL                                                              249975
     C                     ENDIF                                                              CLE141
     C                     Z-ADDZDYNBR    EVDATE                                              249975
     C                     ENDIF                                                              249975
1604 C**
1605 C**   FORMAT EVENT AS PER P/LEVENT
1606 C                     MOVE 'M1'      EVTYPE           EVENT TYPE
      *                                                                                       CLE134
     C           WKLTY1    IFEQ 'X'                                                           CLE134
     C           WKLTY1    OREQ 'Y'                                                           CLE134
     C           WKLTY1    OREQ 'Z'                                                           CLE134
     C                     MOVE 'P1'      EVTYPE                                              CLE134
     C                     ENDIF                                                              CLE134
      *                                                                                       237466
      ** Check PTDI field for maturity processing                                             237466
      *                                                                                       237466
     C                     Z-ADD0         ZNRDYS                                              237466
     C                     Z-ADDEVDATE    ZDAYNO                                              237466
     C           MDST      IFEQ 01                                                            237466
     C           MDST      OREQ 07                                                            237466
     C           MDST      OREQ 08                                                            237466
     C           MDST      OREQ 02                                                            237466
     C           MDST      OREQ 12                                                            237466
     C                     MOVE CCY       ZCCY                                                237466
     C                     ELSE                                                               237466
     C                     MOVE BJLCCY    ZCCY                                                237466
     C                     ENDIF                                                              237466
      *                                                                                       237466
      ** If feature CEU004 is on, set currency field                                          237466
      ** If Settlement currency from the LOAN is not blank.                                   237466
      *                                                                                       237466
     C           CEU004    IFEQ 'Y'                                                           237466
      *                                                                                       237466
     C           SCCY      IFNE *BLANKS                                                       237466
     C                     MOVE SCCY      ZCCY                                                237466
     C                     ENDIF                                                              237466
      *                                                                                       237466
     C                     ENDIF                                                              237466
     C                     MOVE W@MDSL    ZLOC                                                237466
      *                                                                                       CLE141
      ** Call Business Day Convention for Lending Transaction                                 CLE141
      *                                                                                       CLE141
     C           CLE141    IFEQ 'Y'                                                           CLE141
     C********** MDST      ANDEQ01                                                    CLE141 CLE141A
     C********** CLE141    OREQ 'Y'                                                   CLE141 CLE141A
     C********** MDST      ANDEQ07                                                    CLE141 CLE141A
     C********** CLE141    OREQ 'Y'                                                   CLE141 CLE141A
     C********** MDST      ANDEQ08                                                    CLE141 CLE141A
     C                     CALL 'LEZBDYCD'                                                    CLE141
     C                     PARM           ZDAYNO                                              CLE141
     C                     PARM           PICUR                                               CLE141
     C                     PARM           PILOC                                               CLE141
     C                     PARM PTDI      PPDDI                                               CLE141
     C                     PARM           DATF                                                CLE141
     C                     PARM ZCCY      PCCY                                               CLE141A
     C                     PARM ZLOC      PLOC                                               CLE141A
     C                     PARM           ZDYNBR                                              CLE141
     C                     Z-ADDZDYNBR    ZMDAT                                               CLE141
     C                     ELSE                                                               CLE141
     C                     SELEC                                                              237466
     C           PTDI      WHEQ 'P'                                                           237466
     C                     EXSR ZBKDT                                                         237466
     C                     Z-ADDZDYNBR    ZMDAT   50                                          237466
      *                                                                                       237466
     C           PTDI      WHEQ 'N'                                                           237466
     C                     EXSR ZFWDT                                                         237466
     C                     Z-ADDZDYNBR    ZMDAT                                               237466
      *                                                                                       237466
     C           PTDI      WHEQ 'M'                                                           237466
     C           PTDI      OREQ *BLANK                                                        237466
     C                     EXSR ZDATE2                                                        237466
     C           *IN98     IFEQ *OFF                                                          237466
     C                     MOVE ZDATE     MMYY    40P                                         237466
     C                     MOVELMMYY      MMNLCD  20P                                         237466
     C                     ELSE                                                               237466
     C                     MOVELZDATE     MMNLCD    P                                         237466
     C                     ENDIF                                                              237466
     C                     Z-ADDZDAYNO    @DAYNO  50                                          237466
     C                     EXSR ZFWDT                                                         237466
     C                     Z-ADDZDYNBR    ZDAYNO                                              237466
     C                     EXSR ZDATE2                                                        237466
     C           *IN98     IFEQ *OFF                                                          237466
     C                     MOVE ZDATE     MMYY      P                                         237466
     C                     MOVELMMYY      MMNWKD  20P                                         237466
     C                     ELSE                                                               237466
     C                     MOVELZDATE     MMNWKD    P                                         237466
     C                     ENDIF                                                              237466
     C           MMNLCD    IFNE MMNWKD                                                        237466
     C                     Z-ADD@DAYNO    ZDAYNO                                              237466
     C                     EXSR ZBKDT                                                         237466
     C                     ENDIF                                                              237466
     C                     Z-ADDZDYNBR    ZMDAT                                               237466
      *                                                                                       237466
     C                     OTHER                                                              237466
     C                     Z-ADDEVDATE    ZMDAT                                               237466
     C                     ENDSL                                                              237466
     C                     ENDIF                                                              CLE141
     C                     Z-ADDZMDAT     EVDATE                                              237466
      *                                                                   208750
      ** If this is a call loan which does not have a maturity date,      208750
      ** initialise the maturity event date to zero.                      208750
      *                                                                   208750
     C           *IN21     IFEQ '1'                                       208750
     C                     Z-ADDMDAT      EVDATE                          208750
     C                     ENDIF                                          208750
      *                                                                   208750
1607 C                     EXSR LEVENT
1608 C  N57                SETON                     U7U8  **DATABASE 21**
1609 C  N57                Z-ADD21        DBASE
1610 C  N57                MOVE EVCODE    DBKEY
1611 C**N57******          GOTO MATEND                                    S01117
     C   U7 U8             GOTO MATEND                                    S01117
1612 C**
1613 C                     Z-ADDCPRINC    EVAMNT           EVENT AMOUNT
     C           *IN66     IFEQ '1'                                       S01392
     C                     Z-ADDNPRAM     EVAMNT                          S01392
     C                     END                                            S01392
     C*                                                                   S01392
     C**  FOR EARLY MATURITY OF DISCOUNTED LOAN, THE EVENT AMOUNT         S01392
     C**  SHOULD BE PRINCIPAL MINUS REBATE                                S01392
     C*                                                                   S01392
     C           PTYP      IFEQ 63                                        S01392
     C           ORMD      IFNE 0                                         S01392
     C           ORTI      SUB  TOTI      REBATE 130                      S01392
     C           CPRINC    SUB  REBATE    EVAMNT                          S01392
     C                     END                                            S01392
     C                     END                                            S01392
1614 C**
1615 C**   DETERMINE EQUIVALENT AMOUNTS
1616 C                     EXSR EQUIV
1617 C**
1618 C                     Z-ADD0         LASEQ            AMEND SEQUENCE
1619 C                     MOVE ' '       FREQY            FREQUENCY CODE
1620 C                     MOVE AUTO      AUTOS            AUTO SETTLEMENT
1621 C**
1622 C**   OUTPUT RECORD TO FILE
1623 C                     EXSR RECOUT
1624 C**
1625 C**   DETERMINE IF SECOND EVENT REQUIRED
      *                                                                                       CLE028
      ** For flat rate personal loans,                                                        CLE028
      ** do not generate interest event 'M2' if Add on interest                               CLE028
      *                                                                                       CLE028
     C           CLE028    IFEQ 'Y'                                                           CLE028
     C           PTYP      ANDEQ80                                                            CLE028
     C           ADIF      ANDEQ'Y'                                                           CLE028
     C                     ELSE                                                               CLE028
1626 C                     MOVE 'M2'      EVTYPE           EVENT TYPE
      *                                                                                       CLE134
     C           WKLTY1    IFEQ 'X'                                                           CLE134
     C           WKLTY1    OREQ 'Y'                                                           CLE134
     C           WKLTY1    OREQ 'Z'                                                           CLE134
     C                     MOVE 'P2'      EVTYPE                                              CLE134
     C                     ENDIF                                                              CLE134
      *                                                                   208750
      ** If this is a call loan which does not have a maturity date,      208750
      ** initialise the maturity event date to zero.                      208750
      *                                                                   208750
     C           *IN21     IFEQ '1'                                       208750
     C                     Z-ADDMDAT      EVDATE                          208750
     C                     ENDIF                                          208750
      *                                                                   208750
1627 C                     EXSR LEVENT
     C   U7 U8             GOTO MATEND                                    S01117
1628 C**
1629 C   57                Z-ADDINTDUE    EVAMNT           EVENT AMOUNT
1630 C**
1631 C**   DETERMINE EQUIVALENT AMOUNTS
1632 C   57                EXSR EQUIV
1633 C**
1634 C**   OUTPUT RECORD TO FILE
1635 C   57                EXSR RECOUT
      *                                                                                       CAS005
      ** Generate M6 Events for CAS005 enhancement                                            CAS005
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C           PTYP      ANDNE70                                                            CAS005
     C           PTYP      ANDNE71                                                            CAS005
     C           PTYP      ANDNE72                                                            CAS005
      *                                                                                       CAS005
     C           MDAT      IFEQ 0                                                             CAS005
     C           WMATD2    ANDNE0                                                             CAS005
     C                     Z-ADDWMATD2    EVDATE                                              CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
     C                     Z-ADDEVAMNT    WEAMNT                                              CAS005
      *                                                                                       CAS005
      ** Call new subroutine for Net Treasury Rate calculations                               CAS005
      *                                                                                       CAS005
     C                     Z-ADD*ZERO     WEAMT                                               CAS005
     C                     Z-ADD*ZERO     WEDATX                                              CAS005
     C                     MOVE 'Y'       WCALL                                               222972
     C                     EXSR SRNTR                                                         CAS005
     C                     MOVE 'M6'      EVTYPE                                              CAS005
      *                                                                                       CLE134
     C           WKLTY1    IFEQ 'X'                                                           CLE134
     C           WKLTY1    OREQ 'Y'                                                           CLE134
     C           WKLTY1    OREQ 'Z'                                                           CLE134
     C                     MOVE 'P6'      EVTYPE                                              CLE134
     C                     ENDIF                                                              CLE134
      *                                                                                       CAS005
      ** If this is a call loan which does not have a maturity date,                          CAS005
      ** initialise the maturity event date to zero.                                          CAS005
      *                                                                                       CAS005
     C           *IN21     IFEQ '1'                                                           CAS005
     C                     Z-ADDMDAT      EVDATE                                              CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
     C                     EXSR LEVENT                                                        CAS005
      *                                                                                       CAS005
      ** IF 'M6' event type not found, issue database error                                   CAS005
      *                                                                                       CAS005
     C           *INU7     IFEQ *ON                                                           CAS005
     C           *INU8     ANDEQ*ON                                                           CAS005
     C                     GOTO MATEND                                                        CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
     C           *IN57     IFEQ *ON                                                           CAS005
     C                     Z-ADDWNTRIN    EVAMNT                                              CAS005
      *                                                                                       CAS005
      ** Determine Equivalent Amounts                                                         CAS005
      *                                                                                       CAS005
     C                     EXSR EQUIV                                                         CAS005
      *                                                                                       CAS005
      ** Output 'M6' event type to File                                                       CAS005
      *                                                                                       CAS005
     C                     Z-ADDEFFINT    WEFF                                                223752
     C                     Z-ADDWINTR     EFFINT                                              223752
      *                                                                                       223752
     C                     MOVE EMUCCY    TEMUCY                                              226512
     C                     MOVE *BLANKS   EMUCCY                                              226512
      *                                                                                       226512
     C                     EXSR RECOUT                                                        CAS005
      *                                                                                       223752
     C                     Z-ADDWEFF      EFFINT                                              223752
     C                     MOVE TEMUCY    EMUCCY                                              226512
      *                                                                                       223752
     C                     ENDIF                                                              CAS005
     C                     Z-ADDWEAMNT    EVAMNT                                              CAS005
     C                     ENDIF                                                              CAS005
1636 C**
     C                     ENDIF                                                              CLE028
1637 C           MATEND    ENDSR                           **MATEND**
1638 C********************************************************************
      /EJECT                                                              CLE004
      *****************************************************************   CLE004
      * SRPRTO  -  Generate event for 'Transfer of Principal To'      *   CLE004
      * Called by: AMEND  - Generate amendment event                  *   CLE004
      * Calls    : LEVENT - Determine S/LVNTX settings                *   CLE004
      *            EQUIV  - Determine equivalent amount of event      *   CLE004
      *            RECOUT - Output event record to file               *   CLE004
      *****************************************************************   CLE004
     C           SRPRTO    BEGSR                                          CLE004
      *                                                                   CLE004
      ** Format event as per P/LEVENT                                     CLE004
      *                                                                   CLE004
     C                     MOVE 'V5'      EVTYPE                          CLE004
     C                     Z-ADDPRAM      EVAMNT                                              226542
     C                     EXSR LEVENT                                    CLE004
      *                                                                   CLE004
      ** Database error processing                                        CLE004
      *                                                                   CLE004
     C           *IN57     IFEQ '0'                                       CLE004
     C                     Z-ADD35        DBASE            ************   CLE004
     C                     MOVE EVCODE    DBKEY            * DBERR 35 *   CLE004
     C                     MOVE '1'       *INU7            ************   CLE004
     C                     MOVE '1'       *INU8                           CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
      ** If no db error, continue event processing                        CLE004
      *                                                                   CLE004
     C           *INU7     IFNE '1'                                       CLE004
     C           *INU8     ORNE '1'                                       CLE004
      *                                                                   CLE004
     C**********           Z-ADDPRAM      EVAMNT                                       CLE004 226542
      *                                                                   CLE004
      ** Determine equivalent amounts                                     CLE004
      *                                                                   CLE004
     C                     EXSR EQUIV                                     CLE004
      *                                                                   CLE004
      ** Output record to file                                            CLE004
      *                                                                   CLE004
     C                     EXSR RECOUT                                    CLE004
      *                                                                   CLE004
      ** Update current principal                                         CLE004
      *                                                                   CLE004
     C           CPRINC    ADD  PRAM      CPRINC                          CLE004
      *                                                                   CLE004
     C                     ENDIF                                          CLE004
      *                                                                                       CAS005
      ** Generate V6 Events for CAS005 enhancement                                            CAS005
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C           PTYP      ANDNE70                                                            CAS005
     C           PTYP      ANDNE71                                                            CAS005
     C           PTYP      ANDNE72                                                            CAS005
     C                     Z-ADDEVAMNT    WEAMNT                                              CAS005
     C                     MOVE 'V6'      EVTYPE                                              CAS005
     C                     EXSR LEVENT                                                        CAS005
      *                                                                                       CAS005
      ** IF 'V6' event type not found, issue database error                                   CAS005
      *                                                                                       CAS005
     C           *IN57     IFEQ *OFF                                                          CAS005
     C                     MOVE *ON       *INU7                                               CAS005
     C                     MOVE *ON       *INU8                                               CAS005
     C                     Z-ADD64        DBASE                                               CAS005
     C                     MOVE EVCODE    DBKEY                                               CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
     C           *INU7     IFNE *ON                                                           CAS005
     C           *INU8     ANDNE*ON                                                           CAS005
      *                                                                                       CAS005
     C                     Z-ADDPRAM      EVAMNT                                              CAS005
      *                                                                                       CAS005
      ** Determine Equivalent Amounts                                                         CAS005
      *                                                                                       CAS005
     C                     EXSR EQUIV                                                         CAS005
      *                                                                                       CAS005
      ** Output 'V6' event type to File                                                       CAS005
      *                                                                                       CAS005
     C                     Z-ADDEFFINT    WEFF                                                223752
     C                     Z-ADDWINTR     EFFINT                                              223752
      *                                                                                       223752
     C                     MOVE EMUCCY    TEMUCY                                              226512
     C                     MOVE *BLANKS   EMUCCY                                              226512
      *                                                                                       226512
     C                     EXSR RECOUT                                                        CAS005
      *                                                                                       223752
     C                     Z-ADDWEFF      EFFINT                                              223752
     C                     MOVE TEMUCY    EMUCCY                                              226512
      *                                                                                       CAS005
      ** Update current principal                                                             CAS005
      *                                                                                       CAS005
     C           WCPNTR    ADD  PRAM      WCPNTR                                              CAS005
      *                                                                                       CAS005
     C                     ENDIF                                                              CAS005
     C                     Z-ADDWEAMNT    EVAMNT                                              CAS005
     C                     ENDIF                                                              CAS005
      *                                                                   CLE004
     C                     ENDSR                                          CLE004
      /EJECT                                                              CLE004
      *****************************************************************   CLE004
      * SRPRFR  -  Generate event for 'Transfer of Principal From'    *   CLE004
      * Called by: AMEND  - Generate amendment event                  *   CLE004
      * Calls    : LEVENT - Determine S/LVNTX settings                *   CLE004
      *            EQUIV  - Determine equivalent amount of event      *   CLE004
      *            RECOUT - Output event record to file               *   CLE004
      *****************************************************************   CLE004
     C           SRPRFR    BEGSR                                          CLE004
      *                                                                   CLE004
      ** Format event as per P/LEVENT                                     CLE004
      *                                                                   CLE004
     C                     MOVE 'R7'      EVTYPE                          CLE004
     C                     Z-ADDPRAM      EVAMNT                                              226542
     C                     EXSR LEVENT                                    CLE004
      *                                                                   CLE004
      ** Database error processing                                        CLE004
      *                                                                   CLE004
     C           *IN57     IFEQ '0'                                       CLE004
     C                     Z-ADD36        DBASE            ************   CLE004
     C                     MOVE EVCODE    DBKEY            * DBERR 36 *   CLE004
     C                     MOVE '1'       *INU7            ************   CLE004
     C                     MOVE '1'       *INU8                           CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
      ** If no db error, continue event processing                        CLE004
      *                                                                   CLE004
     C           *INU7     IFNE '1'                                       CLE004
     C           *INU8     ORNE '1'                                       CLE004
      *                                                                   CLE004
     C**********           Z-ADDPRAM      EVAMNT                                       CLE004 226542
      *                                                                   CLE004
      ** Determine equivalent amounts                                     CLE004
      *                                                                   CLE004
     C                     EXSR EQUIV                                     CLE004
      *                                                                   CLE004
      ** Output record to file                                            CLE004
      *                                                                   CLE004
     C                     EXSR RECOUT                                    CLE004
      *                                                                   CLE004
      ** Update current principal                                         CLE004
      *                                                                   CLE004
     C           CPRINC    SUB  PRAM      CPRINC                          CLE004
      *                                                                   CLE004
     C                     ENDIF                                          CLE004
      *                                                                                       CAS005
      ** Generate R6 Events for CAS005 enhancement                                            CAS005
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C           PTYP      ANDNE70                                                            CAS005
     C           PTYP      ANDNE71                                                            CAS005
     C           PTYP      ANDNE72                                                            CAS005
     C                     Z-ADDEVAMNT    WEAMNT                                              CAS005
     C                     MOVE 'R6'      EVTYPE                                              CAS005
     C                     EXSR LEVENT                                                        CAS005
      *                                                                                       CAS005
      ** IF 'R6' event type not found, issue database error                                   CAS005
      *                                                                                       CAS005
     C           *IN57     IFEQ *OFF                                                          CAS005
     C                     MOVE *ON       *INU7                                               CAS005
     C                     MOVE *ON       *INU8                                               CAS005
     C                     Z-ADD63        DBASE                                               CAS005
     C                     MOVE EVCODE    DBKEY                                               CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
     C           *INU7     IFNE *ON                                                           CAS005
     C           *INU8     ORNE *ON                                                           CAS005
      *                                                                                       CAS005
     C                     Z-ADDPRAM      EVAMNT                                              CAS005
      *                                                                                       CAS005
      ** Determine Equivalent Amounts                                                         CAS005
      *                                                                                       CAS005
     C                     EXSR EQUIV                                                         CAS005
      *                                                                                       CAS005
      ** Output 'R6' event type to File                                                       CAS005
      *                                                                                       CAS005
     C                     Z-ADDEFFINT    WEFF                                                223752
     C                     Z-ADDWINTR     EFFINT                                              223752
     C                     MOVE EMUCCY    TEMUCY                                              226512
     C                     MOVE *BLANKS   EMUCCY                                              226512
      *                                                                                       223752
     C                     EXSR RECOUT                                                        CAS005
      *                                                                                       223752
     C                     Z-ADDWEFF      EFFINT                                              223752
     C                     MOVE TEMUCY    EMUCCY                                              226512
      *                                                                                       CAS005
      ** Update current principal                                                             CAS005
      *                                                                                       CAS005
     C           WCPNTR    SUB  PRAM      WCPNTR                                              CAS005
      *                                                                                       CAS005
     C                     ENDIF                                                              CAS005
     C                     Z-ADDWEAMNT    EVAMNT                                              CAS005
     C                     ENDIF                                                              CAS005
      *                                                                   CLE004
     C                     ENDSR                                          CLE004
      /EJECT                                                              CLE006
      *****************************************************************   CLE006
      * SRXCCY  -  Setup loan currency exchange rates                 *   CLE006
      * Called by: ROLLVR - Generate rollover event                   *   CLE006
      * Calls    : CCYDSP - Obtain currency details                   *   CLE006
      *****************************************************************   CLE006
     C           SRXCCY    BEGSR                                          CLE006
      *                                                                   CLE006
      ** Access loan currency details                                     CLE006
      *                                                                   CLE006
     C                     MOVE CCY       XCCY                            CLE006
     C                     EXSR CCYDSP                                    CLE006
      *                                                                   CLE006
      ** Database error processing                                        CLE006
      *                                                                   CLE006
     C           *IN99     IFEQ '1'                                       CLE006
     C                     MOVEL'SDCURRPD'DBFILE           ************   CLE006
     C                     Z-ADD37        DBASE            * DBERR 37 *   CLE006
     C                     MOVELXCCY      DBKEY            ************   CLE006
     C                     MOVE '1'       *INU7                           CLE006
     C                     MOVE '1'       *INU8                           CLE006
     C                     ELSE                                           CLE006
      *                                                                   CLE006
      ** If no db error, update loan currency exchange rates              CLE006
      *                                                                   CLE006
     C                     Z-ADDXDECP     ECCYDP                          CLE006
     C                     Z-ADDXSPOT     ECCYSP                          CLE006
     C                     MOVE XMDIN     ECCYMD                          CLE006
     C                     Z-ADDXSORT     ECCYSS                          CLE006
     C                     Z-ADDXSPLM     ECCYSL                          CLE006
     C                     Z-ADDXSPOT     BCXR                            CLE006
     C                     MOVE XMDIN     BMDI                            CLE006
     C                     ENDIF                                          CLE006
      *                                                                   CLE006
     C                     ENDSR                                          CLE006
      /EJECT                                                              CLE006
1639 C********************************************************************
      *                                                               *                       CAS005
      *  SRAIR - Subroutine for All-In-Rate calculations              *                       CAS005
      *                                                               *                       CAS005
      *****************************************************************                       CAS005
      *                                                                                       CAS005
     C           SRAIR     BEGSR                                                              CAS005
      *                                                                                       CAS005
     C                     MOVE MDAT      WMDAT                                               CAS005
     C                     MOVE IPFR      WIPFR                                               CAS005
     C                     MOVE ICBS      WICBS                                               CAS005
     C                     MOVE CCY       WCCY                                                CAS005
     C                     MOVE FSFYLD    WFYLD                                               CAS005
      *                                                                                       CAS005
      ** For call loan, override maturity date by the adjusted                                CAS005
      ** maturity date work field                                                             CAS005
      *                                                                                       CAS005
     C           WMDAT     IFEQ 0                                                             CAS005
     C           WMATD2    ANDNE0                                                             CAS005
     C                     Z-ADDWMATD2    WMDAT                                               CAS005
     C                     ENDIF                                                              CAS005
      **********                                                                       228806 246747
     C********** EFFINT    IFNE 0                                                      228806 246747
     C**********           Z-ADDEFFINT    WINTR                                        228806 246747
     C**********           ENDIF                                                       228806 246747
      *                                                                                       CAS005
     C           RLFQ      IFNE ' '                                                           229938
     C           EVDATE    ANDGTWNXRO                                                         229938
     C           EVDATE    ORGT NROD                                                          229938
     C           NROD      ANDGT0                                                             229938
     C                     MOVE 'N'       WFXDR                                               229938
     C                     ENDIF                                                              229938
      *                                                                                       229938
      ** When ccy, yield curve and interest calculation basis have changed due                226261
      ** to rollover, use the following fields when retrieving forward rates                  226261
      *                                                                                       226261
     C           WNCCY     IFNE *BLANK                                                        226261
     C                     MOVE WNCCY     WCCY                                                226261
     C                     ENDIF                                                              226261
     C           WNCAC     IFNE 0                                                             226261
     C                     Z-ADDWNCAC     WICBS                                               226261
     C                     ENDIF                                                              226261
     C           WNFYLB    IFNE *BLANK                                                        226261
     C                     MOVE WNFYLB    WFYLD                                               226261
     C                     ENDIF                                                              226261
      *                                                                                       226261
     C           WFYLD     IFNE *BLANKS                                                       CAS005
     C           WMDAT     ANDNE*ZERO                                                         CAS005
     C           CPRINC    ANDNE*ZERO                                                         CAS005
     C********** WIPFR     ANDNE*BLANK                                                 CAS005 228806
     C           WIPFR     ANDNE*BLANK                                                        246747
      *                                                                                       226261
      ** If rate is not fixed, retrieve rate using forward yield curve                        226261
      *                                                                                       226261
     C           WFXDR     IFEQ 'N'                                                           226261
      *                                                                                       CAS005
     C           WFYLD     IFNE PNYLDC                                                        245132
     C                     MOVELWFYLD     KEYYLC                                            CLE075AF
     C                     ADD  1         YLCSEQ                                            CLE075AF
     C                     EXSR CHKYLC                                                      CLE075AF
      *                                                                                     CLE075AF
      ** Use details from array if KEYYLC is found, otherwise,                              CLE075AF
      ** retrieve details from program call                                                 CLE075AF
      *                                                                                     CLE075AF
     C           YLCIC     IFEQ 'Y'                                                         CLE075AF
      *                                                                                     CLE075AF
      ** Set occurence to index found from #YCK array                                       CLE075AF
      *                                                                                     CLE075AF
     C           D         OCUR SDYLDC                                                      CLE075AF
      *                                                                                     CLE075AF
     C                     ELSE                                                             CLE075AF
      *                                                                                     CLE075AF
     C           YLCIDX    IFNE 0                                                           CLE075AF
     C                     Z-ADDYLCIDX    D                                                 CLE075AF
     C                     ELSE                                                             CLE075AF
     C                     Z-ADD1         D                                                 CLE075AF
     C                     MOVEA#YLC      #YCS                                              CLE075AF
     C                     SORTA#YCS                                                        CLE075AF
     C                     Z-ADD#YCS,1    YLCKEY                                            CLE075AF
     C           YLCKEY    LOKUP#YLC,D                   43                                 CLE075AF
     C                     ENDIF                                                            CLE075AF
      *                                                                                     CLE075AF
     C           D         OCUR SDYLDC                                                      CLE075AF
      *                                                                                       245132
     C                     CALL 'AOYLDCR0'                                                    CAS005
     C                     PARM '*BLANKS' PNRTCD                                              CAS005
     C                     PARM '*KEY   ' P@OPTN                                              CAS005
     C                     PARM WFYLD     PNYLDC                                              CAS005
     C           SDYLDC    PARM SDYLDC    DSFDY                                               CAS005
      *                                                                                       CAS005
     C           PNRTCD    IFNE *BLANKS                                                       CAS005
     C           PNRTCD    ANDNE'*NRF   '                                                     CAS005
     C           *LOCK     IN   LDA                                                           CAS005
     C                     MOVEL'SDYLDCPD'DBFILE                                              CAS005
     C                     MOVELWFYLD     DBKEY                                               CAS005
     C                     Z-ADD59        DBASE                                               CAS005
     C                     OUT  LDA                                                           CAS005
     C                     SETON                     U7U8LR                                   CAS005
     C                     EXSR *PSSR                                                         CAS005
     C**********           ENDIF                                                     CAS005 CLE075AF
      *                                                                                     CLE075AF
     C                     ELSE                                                             CLE075AF
      *                                                                                     CLE075AF
     C                     EXSR ADDYLC                                                      CLE075AF
     C                     ENDIF                                                            CLE075AF
     C                     ENDIF                                                            CLE075AF
      *                                                                                       245132
     C                     ENDIF                                                              245132
      *                                                                                       CAS005
     C           FSYLDT    IFEQ 'F'                                                           CAS005
     C           PNRTCD    ANDEQ*BLANKS                                                       CAS005
      *                                                                                       CAS005
      ** For Future Use                                                                       CAS005
      *                                                                                       CAS005
     C                     MOVE WICBS     PNICBS                                              CAS005
     C                     MOVE 'YRATE'   PNPRTC                                              CAS005
      *                                                                                       CAS005
      ** Retrieve rate using forward yield curve                                              CAS005
      *                                                                                       CAS005
     C**********           CALL 'ZADSFRTV'                                             CAS005 245132
     C                     CALL 'ZADSFRT2'                                                    245132
     C                     PARM *BLANK    PNRTCD  7                                           CAS005
     C                     PARM           PNPRTC  5                                           CAS005
     C                     PARM WFYLD     PNYLDC  5                                           CAS005
     C                     PARM WCCY      PNCYCD  3                                           CAS005
     C                     PARM           PNICBS  1                                           CAS005
     C                     PARM EVDATE    PNFLDT  50                                          CAS005
     C                     PARM *ZERO     PNRATE 139                                          CAS005
     C                     PARM           CAS008                                              245132
     C                     PARM *ZERO     ZNPSDT  50                                          245132
      *                                                                                       CAS005
     C           PNRTCD    IFEQ '*ERROR '                                                     CAS005
     C           *LOCK     IN   LDA                                                           CAS005
     C                     MOVEL'ZADSFRTV'DBFILE                                              CAS005
     C                     MOVELWFYLD     DBKEY                                               CAS005
     C                     Z-ADD65        DBASE                                               CAS005
     C                     OUT  LDA                                                           CAS005
     C                     EXSR *PSSR                                                         CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
      ** Retrieve rate using forward yield curve                                              CAS005
      *                                                                                       CAS005
     C           PNRTCD    IFEQ '*NRF   '                                                     CAS005
     C                     MOVE 'YRATE'   PNPRTC                                              CAS005
     C                     MOVE *BLANK    PNCYCD                                              CAS005
      *                                                                                       CAS005
     C**********           CALL 'ZADSFRTV'                                             CAS005 245132
     C                     CALL 'ZADSFRT2'                                                    245132
     C                     PARM *BLANK    PNRTCD                                              CAS005
     C                     PARM           PNPRTC                                              CAS005
     C                     PARM WFYLD     PNYLDC                                              CAS005
     C                     PARM           PNCYCD                                              CAS005
     C                     PARM           PNICBS                                              CAS005
     C                     PARM EVDATE    PNFLDT                                              CAS005
     C                     PARM *ZERO     PNRATE                                              CAS005
     C                     PARM           CAS008                                              245132
     C                     PARM *ZERO     ZNPSDT  50                                          245132
      *                                                                                       CAS005
     C           PNRTCD    IFEQ '*ERROR '                                                     CAS005
     C           *LOCK     IN   LDA                                                           CAS005
     C                     MOVEL'ZADSPRTV'DBFILE                                              CAS005
     C                     MOVELWFYLD     DBKEY                                               CAS005
     C                     Z-ADD66        DBASE                                               CAS005
     C                     OUT  LDA                                                           CAS005
     C                     EXSR *PSSR                                                         CAS005
     C                     ENDIF                                                              CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
      ** No rates retrieved for the yield curve specified                                     CAS005
      *                                                                                       CAS005
     C           PNRTCD    IFNE '*NRF   '                                                     CAS005
     C**********           Z-ADDPNRATE    EFFINT                                       CAS005 228806
     C                     Z-ADDPNRATE    EFFINT                                              246747
     C**********           Z-ADDPNRATE    WINTR                                        228806 246747
      **********                                                                       228806 246747
      ***New*effective*interest****************************************                228806 246747
      **********                                                                       228806 246747
     C**********           EXSR SRFNIN                                                 228806 246747
     C**********           Z-ADDWINTR     EFFINT                                       228806 246747
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
     C                     ELSE                                                               CAS005
      *                                                                                       CAS005
      ** Access the currency details and calculate the spot date.                             CAS005
      *                                                                                       CAS005
     C**********           CALL 'AOCURRR0'                                             CAS005 CSC042
     C**********           PARM '*MSG    'PNRTCD                                       CAS005 CSC042
     C**********           PARM '*KEY    'P@OPTN                                       CAS005 CSC042
     C**********           PARM WCCY      PNCYCD                                       CAS005 CSC042
     C********** SDCURR    PARM SDCURR    DSSDY                                        CAS005 CSC042
      *                                                                                       CAS005
     C********** PNRTCD    IFNE *BLANK                                                 CAS005 CSC042
     C                     MOVELWCCY      XCCY                                                CSC042
     C                     EXSR CCYDSP                                                        CSC042
     C           *IN99     IFEQ *OFF                                                          CSC042
     C                     Z-ADDXSPDY     SPDY                                                CSC042
     C                     ELSE                                                               CSC042
     C           *LOCK     IN   LDA                                                           CAS005
     C**********           MOVE 'SDCURRPD'DBFILE                                       CAS005 CSC042
     C                     MOVE 'CCYDSP  'DBFILE                                       CAS005 CSC042
     C                     Z-ADD70        DBASE                                               CAS005
     C                     MOVELWCCY      DBKEY                                               CAS005
     C                     OUT  LDA                                                           CAS005
     C                     SETON                     U7U8LR                                   CAS005
     C                     EXSR *PSSR                                                         CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
      ** Calculate the currency spot date.                                                    CAS005
      *                                                                                       CAS005
     C                     MOVE WCCY      ZCCY                                                CAS005
     C                     MOVE *BLANKS   ZLOC                                                CAS005
     C                     Z-ADDRUND      ZDAYNO                                              CAS005
     C**********           Z-ADDA6SPDY    ZNRDYS                                       CAS005 CSC042
     C                     Z-ADDSPDY      ZNRDYS                                       CAS005 CSC042
     C                     EXSR ZFWDT                                                         CAS005
     C                     Z-ADDZDYNBR    WSPDT   50                                          CAS005
      *                                                                                       CAS008
      ** For CAS008 enhancement, access Yield Rates File to get the spot days                 CAS008
      ** and use it to calculate for the spot date.                                           CAS008
      *                                                                                       CAS008
     C           CAS008    IFEQ 'Y'                                                           CAS008
      *                                                                                       245132
     C           WFYLD     IFNE WFYLD2                                                        245132
     C           WCCY      ORNE WCCY2                                                         245132
     C           WICBS     ORNE WICM2                                                         245132
      *                                                                                       245132
     C                     MOVELWFYLD     KEYYLR                                            CLE075AF
     C                     MOVE WICBS     YLRPRT  4                                         CLE075AF
     C                     MOVELWCCY      YLRPRT                                            CLE075AF
     C                     MOVE YLRPRT    KEYYLR                                            CLE075AF
     C                     ADD  1         YLCSEQ                                            CLE075AF
     C                     EXSR CHKYLR                                                      CLE075AF
      *                                                                                     CLE075AF
      ** Use details from array if KEYYLR is found, otherwise,                              CLE075AF
      ** retrieve details from program call                                                 CLE075AF
      *                                                                                     CLE075AF
     C           YLRIC     IFEQ 'Y'                                                         CLE075AF
      *                                                                                     CLE075AF
      ** Set occurence to index found from #YRK array                                       CLE075AF
      *                                                                                     CLE075AF
     C           E         OCUR SDYLDR                                                      CLE075AF
      *                                                                                     CLE075AF
     C                     ELSE                                                             CLE075AF
      *                                                                                     CLE075AF
     C           YLRIDX    IFNE 0                                                           CLE075AF
     C                     Z-ADDYLRIDX    E                                                 CLE075AF
     C                     ELSE                                                             CLE075AF
     C                     Z-ADD1         E                                                 CLE075AF
     C**********           MOVEA#YLC      #YRS                                     CLE075AF MD021155
     C                     MOVEA#YLR      #YRS                                              MD021155
     C                     SORTA#YRS                                                        CLE075AF
     C                     Z-ADD#YRS,1    YLRKEY                                            CLE075AF
     C           YLRKEY    LOKUP#YLR,E                   44                                 CLE075AF
     C                     ENDIF                                                            CLE075AF
      *                                                                                     CLE075AF
     C           E         OCUR SDYLDR                                                      CLE075AF
     C                     MOVE WCCY      WCCY2   3                                           CAS008
     C                     MOVE WICBS     WICM    1                                           CAS008
     C           KSPOTD    CHAINSDYLDRL1             35                                       CAS008
     C           *IN35     IFEQ '0'                                                           CAS008
     C                     Z-ADDFSSPDY    ZNRDYS                                              CAS008
     C                     ELSE                                                               CAS008
     C                     MOVE *BLANKS   WCCY                                                CAS008
     C           KSPOTD    CHAINSDYLDRL1             35                                       CAS008
     C           *IN35     IFEQ '0'                                                           CAS008
     C                     Z-ADDFSSPDY    ZNRDYS                                              CAS008
     C                     ENDIF                                                              CAS008
     C                     ENDIF                                                              CAS008
     C                     ENDIF                                                            CLE075AF
     C           *IN35     IFEQ '0'                                                           CAS008
     C                     EXSR ZFWDT                                                         CAS008
     C                     Z-ADDZDYNBR    WSPDT                                               CAS008
     C                     EXSR ADDYLR                                                      CLE075AF
     C                     ENDIF                                                              CAS008
     C                     MOVE WCCY2     WCCY                                                CAS008
      *                                                                                       245132
     C                     Z-ADDWSPDT     WSPDT2  50                                          245132
     C                     MOVE WFYLD     WFYLD2  5                                           245132
     C                     MOVE WCCY      WCCY2   3                                           245132
     C                     Z-ADDWICBS     WICM2   10                                          245132
     C                     ELSE                                                               245132
     C                     Z-ADDWSPDT2    WSPDT                                               245132
     C                     ENDIF                                                              245132
      *                                                                                       245132
     C                     ENDIF                                                              CAS008
      *                                                                                       CAS005
     C                     MOVE WICBS     PNICBS                                              CAS005
      *                                                                                       CAS005
     C********** CEU004    IFEQ 'Y'                                                    CAS005 226512
     C********** EMUCCY    ANDNE*BLANKS                                                CAS005 226512
     C**********           MOVELEMUCCY    WCCY                                         CAS005 226512
     C**********           ENDIF                                                       CAS005 226512
      *                                                                                       CAS005
     C           WPEDAT    IFLT WEVCD                                                         CAS005
     C           WEVCD     ADD  1         PFWNDT                                              CAS005
     C                     ELSE                                                               CAS005
     C                     Z-ADDWPEDAT    PFWNDT                                              CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
      ** EVDATE falling on non-working day - get next working day                           BUG13336
      *                                                                                     BUG13336
     C           CLE005    IFEQ 'Y'                                                         BUG13336
     C           *IN50     ANDEQ'0'                                                         BUG13336
     C                     Z-ADD*ZERO     ZNRDYS                                            BUG13336
     C                     Z-ADDEVDATE    ZDAYNO                                            BUG13336
     C                     MOVE CCY       ZCCY                                              BUG13336
     C           CEU004    IFEQ 'Y'                                                         BUG13336
     C           EMUCCY    IFNE *BLANKS                                                     BUG13336
     C                     MOVE EMUCCY    ZCCY                                              BUG13336
     C                     ENDIF                                                            BUG13336
     C                     ENDIF                                                            BUG13336
     C           *IN77     IFEQ '0'                                                         BUG13336
     C                     EXSR MATLOC                                                      BUG13336
     C                     ENDIF                                                            BUG13336
     C                     MOVE W@MDSL    ZLOC                                              BUG13336
     C                     EXSR ZFWDT                                                       BUG13336
     C                     Z-ADDZDYNBR    EVDATE                                            BUG13336
     C                     ENDIF                                                            BUG13336
      *                                                                                     BUG13336
     C           EVDATE    IFNE PFWFDT                                                        245132
     C           WCCY      ORNE PNCYCD                                                        245132
     C           WFYLD     ORNE PNYLDC                                                        245132
     C           WSPDT     ORNE PFWSDT                                                        245132
      *                                                                                       245132
     C**********           CALL 'DLZFWR'                                               CAS005 245132
     C                     CALL 'DLZFWR2'                                                     245132
     C                     PARM *BLANK    PFWRTC  5                                           CAS005
     C                     PARM WCCY      PNCYCD                                              CAS005
     C                     PARM           PNICBS                                              CAS005
     C                     PARM WSPDT     PFWSDT  50                                          CAS005
     C                     PARM           PFWNDT  50                                          CAS005
     C                     PARM EVDATE    PFWFDT  50                                          CAS005
     C                     PARM           PFWOUT 117                                          CAS005
     C                     PARM WFYLD     PNYLDC                                              CAS005
     C                     PARM           AS001C  1                                           245132
     C                     PARM           CAS008                                              245132
     C                     PARM           CIR004                                              245132
     C                     PARM           ZFWCC2  3                                           245132
     C                     PARM           ZFWIN2  1                                           245132
     C                     PARM           ZFYLD2  5                                           245132
     C                     PARM           ZFWSD2  50                                          245132
     C                     PARM           ZFWND2  50                                          245132
     C                     PARM           ZFWNE2 119                                          245132
      *                                                                                       CAS005
     C           PFWRTC    IFEQ '*ERR*'                                                       CAS005
      *                                                                                       CAS005
     C           *LOCK     IN   LDA                                                           CAS005
     C                     MOVEL'DLZFWR  'DBFILE                                              CAS005
     C                     MOVELWFYLD     DBKEY                                               CAS005
     C                     Z-ADD69        DBASE                                               CAS005
     C                     OUT  LDA                                                           CAS005
     C                     SETON                     U7U8LR                                   CAS005
     C                     EXSR *PSSR                                                         CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
      ** No rates retrieved for the yield curve specified                                     CAS005
      ** (PFWRTC will only be '*NRCD' when CAS001 is off otherwise                            CAS005
      ** no rates retrieved could be determine by PFWOUT being zero)                          CAS005
      *                                                                                       CAS005
     C           PFWRTC    IFNE '*NRCD'                                                       CAS005
     C           PFWOUT    ANDNE0                                                             CAS005
     C**********           Z-ADDPFWOUT    EFFINT                                       CAS005 228806
     C                     Z-ADDPFWOUT    EFFINT                                              246747
     C**********           Z-ADDPFWOUT    WINTR                                        228806 246747
      **********                                                                       228806 246747
      ***New*effective*interest****************************************                228806 246747
      **********                                                                       228806 246747
     C**********           EXSR SRFNIN                                                 228806 246747
     C**********           Z-ADDWINTR     EFFINT                                       228806 246747
     C                     ENDIF                                                              CAS005
      *                                                                                       245132
     C                     ENDIF                                                              245132
     C           PFWOUT    IFNE 0                                                             245132
     C                     Z-ADDPFWOUT    EFFINT                                              245132
     C                     ENDIF                                                              245132
      *                                                                                       CAS005
     C                     ENDIF                                                              CAS005
     C                     ENDIF                                                              226261
     C                     ENDIF                                                              CAS005
      *                                                                                       226261
     C                     Z-ADDEVDATE    WPEDAT                                              226261
      *                                                                                       CAS005
     C                     ENDSR                                                              CAS005
      *                                                                                       CAS005
      *****************************************************************                       CAS005
      /EJECT                                                                                  CAS005
      *****************************************************************                       CAS005
      *                                                               *                       CAS005
      *  SRNTR - Subroutine for Net Treasury Rate Calculations        *                       CAS005
      *                                                               *                       CAS005
      *****************************************************************                       CAS005
      *                                                                                       CAS005
     C           SRNTR     BEGSR                                                              CAS005
      *                                                                                       CAS005
     C                     MOVE BRTT      WBRTT                                               CAS005
     C                     MOVE MDAT      WMDAT                                               CAS005
     C                     MOVE IPFR      WIPFR                                               CAS005
     C                     MOVE MARG      WMARG                                               CAS005
     C           WMARG     IFLT 0                                                             CAS005
     C                     Z-SUBWMARG     WAVMAR                                              CAS005
     C                     ELSE                                                               CAS005
     C                     Z-ADDWMARG     WAVMAR                                              CAS005
     C                     ENDIF                                                              CAS005
     C                     MOVE NIDT      WNIDT                                               CAS005
     C                     MOVE VDAT      WVDAT                                               CAS005
     C                     MOVE ICBS      WICBS                                               CAS005
     C                     MOVE RTSP      WRTSP                                               CAS005
     C                     MOVE SPIN      WSPIN                                               CAS005
     C                     MOVE AIPN      WAIPD                                               CAS005
     C                     MOVE AINN      WAIMN                                               CAS005
     C                     MOVE IPRN      WIPRD                                               CAS005
     C                     MOVE WCPNTR    WCPAM                                               CAS005
     C                     MOVE CCY       WCCY                                                CAS005
     C                     MOVE FSFYLD    WFYLD                                               CAS005
     C                     Z-ADDINTR      WINTR                                               CAS005
      *                                                                                       223752
     C           EFFINT    IFNE 0                                                             223752
     C                     Z-ADDEFFINT    WINTR                                               223752
     C                     ENDIF                                                              223752
      *                                                                                       CAS005
      ** For call loan, override maturity date by the adjusted                                CAS005
      ** maturity date work field                                                             CAS005
      *                                                                                       CAS005
     C           WMDAT     IFEQ 0                                                             CAS005
     C           WMATD2    ANDNE0                                                             CAS005
     C                     Z-ADDWMATD2    WMDAT                                               CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
     C           RLFQ      IFNE ' '                                                           229938
     C           EVDATE    ANDGTWNXRO                                                         229938
     C           EVDATE    ORGT NROD                                                          229938
     C           NROD      ANDGT0                                                             229938
     C                     MOVE 'N'       WFXDR                                               229938
     C                     ENDIF                                                              229938
      *                                                                                       229938
      ** When ccy, yield curve and interest calculation basis have changed due                226261
      ** to rollover, use the following fields when retrieving forward rates                  226261
      *                                                                                       226261
     C           WNCCY     IFNE *BLANK                                                        226261
     C                     MOVE WNCCY     WCCY                                                226261
     C                     ENDIF                                                              226261
     C           WNCAC     IFNE 0                                                             226261
     C                     Z-ADDWNCAC     WICBS                                               226261
     C                     ENDIF                                                              226261
     C           WNFYLB    IFNE *BLANK                                                        226261
     C                     MOVE WNFYLB    WFYLD                                               226261
     C                     ENDIF                                                              226261
      *                                                                                       226261
     C           WFYLD     IFNE *BLANKS                                                       CAS005
     C           WMDAT     ANDNE*ZERO                                                         CAS005
     C           WCPAM     ANDNE*ZERO                                                         CAS005
     C********** WIPFR     ANDNE*BLANKS                                                CAS005 228806
     C           WIPFR     ANDNE*BLANKS                                                       246747
     C           WMARG     ORNE *ZERO                                                         CAS005
      *                                                                                       CAS005
     C           WMDAT     IFNE *ZERO                                                         CAS005
     C           WCPAM     ANDNE*ZERO                                                         CAS005
     C********** WIPFR     ANDNE*BLANK                                                 CAS005 228806
     C           WIPFR     ANDNE*BLANK                                                        246747
      *                                                                                       CAS005
     C           WFYLD     IFNE *BLANK                                                        CAS005
     C           WFXDR     IFEQ 'N'                                                           226261
      *                                                                                       245132
     C           WFYLD     IFNE PNYLDC                                                        245132
     C                     MOVELWFYLD     KEYYLC                                            CLE075AF
     C                     ADD  1         YLCSEQ                                            CLE075AF
     C                     EXSR CHKYLC                                                      CLE075AF
      *                                                                                     CLE075AF
      ** Use details from array if KEYYLC is found, otherwise,                              CLE075AF
      ** retrieve details from program call                                                 CLE075AF
      *                                                                                     CLE075AF
     C           YLCIC     IFEQ 'Y'                                                         CLE075AF
      *                                                                                     CLE075AF
      ** Set occurence to index found from #YCK array                                       CLE075AF
      *                                                                                     CLE075AF
     C           D         OCUR SDYLDC                                                      CLE075AF
      *                                                                                     CLE075AF
     C                     ELSE                                                             CLE075AF
      *                                                                                     CLE075AF
     C           YLCIDX    IFNE 0                                                           CLE075AF
     C                     Z-ADDYLCIDX    D                                                 CLE075AF
     C                     ELSE                                                             CLE075AF
     C                     Z-ADD1         D                                                 CLE075AF
     C                     MOVEA#YLC      #YCS                                              CLE075AF
     C                     SORTA#YCS                                                        CLE075AF
     C                     Z-ADD#YCS,1    YLCKEY                                            CLE075AF
     C           YLCKEY    LOKUP#YLC,D                   43                                 CLE075AF
     C                     ENDIF                                                            CLE075AF
      *                                                                                     CLE075AF
     C           D         OCUR SDYLDC                                                      CLE075AF
      *                                                                                       245132
     C                     CALL 'AOYLDCR0'                                                    CAS005
     C                     PARM '*BLANKS' PNRTCD                                              CAS005
     C                     PARM '*KEY   ' P@OPTN                                              CAS005
     C                     PARM WFYLD     PNYLDC                                              CAS005
     C           SDYLDC    PARM SDYLDC    DSFDY                                               CAS005
      *                                                                                       CAS005
     C           PNRTCD    IFNE *BLANKS                                                       CAS005
     C           PNRTCD    ANDNE'*NRF   '                                                     CAS005
     C           *LOCK     IN   LDA                                                           CAS005
     C                     MOVEL'SDYLDCPD'DBFILE                                              CAS005
     C                     MOVELWFYLD     DBKEY                                               CAS005
     C                     Z-ADD73        DBASE                                               CAS005
     C                     OUT  LDA                                                           CAS005
     C                     SETON                     U7U8LR                                   CAS005
     C                     EXSR *PSSR                                                         CAS005
     C**********           ENDIF                                                     CAS005 CLE075AF
      *                                                                                     CLE075AF
     C                     ELSE                                                             CLE075AF
      *                                                                                     CLE075AF
     C                     EXSR ADDYLC                                                      CLE075AF
     C                     ENDIF                                                            CLE075AF
     C                     ENDIF                                                            CLE075AF
     C                     ENDIF                                                              245132
      *                                                                                       CAS005
     C           FSYLDT    IFEQ 'F'                                                           CAS005
     C           PNRTCD    ANDEQ*BLANKS                                                       CAS005
     C           WFYLD     ANDNE*BLANKS                                                       CAS005
      *                                                                                       CAS005
     C                     MOVE WICBS     PNICBS                                              CAS005
     C                     MOVE 'YRATE'   PNPRTC                                              CAS005
      *                                                                                       CAS005
      ** Retrieve rate using forward yield curve                                              CAS005
      *                                                                                       CAS005
     C**********           CALL 'ZADSFRTV'                                             CAS005 245132
     C                     CALL 'ZADSFRT2'                                                    245132
     C                     PARM *BLANK    PNRTCD  7                                           CAS005
     C                     PARM           PNPRTC  5                                           CAS005
     C                     PARM WFYLD     PNYLDC  5                                           CAS005
     C                     PARM WCCY      PNCYCD  3                                           CAS005
     C                     PARM           PNICBS  1                                           CAS005
     C                     PARM EVDATE    PNFLDT  50                                          CAS005
     C                     PARM *ZERO     PNRATE 139                                          CAS005
     C                     PARM           CAS008                                              245132
     C                     PARM *ZERO     ZNPSDT  50                                          245132
      *                                                                                       CAS005
     C           PNRTCD    IFEQ '*ERROR '                                                     CAS005
     C           *LOCK     IN   LDA                                                           CAS005
     C                     MOVEL'ZADSFRTV'DBFILE                                              CAS005
     C                     MOVELWFYLD     DBKEY                                               CAS005
     C                     Z-ADD67        DBASE                                               CAS005
     C                     OUT  LDA                                                           CAS005
     C                     EXSR *PSSR                                                         CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
      ** Retrieve rate using forward yield curve                                              CAS005
      *                                                                                       CAS005
     C           PNRTCD    IFEQ '*NRF   '                                                     CAS005
     C                     MOVE 'YRATE'   PNPRTC                                              CAS005
     C                     MOVE *BLANK    PNCYCD                                              CAS005
      *                                                                                       CAS005
     C**********           CALL 'ZADSFRTV'                                             CAS005 245132
     C                     CALL 'ZADSFRT2'                                                    245132
     C                     PARM *BLANK    PNRTCD                                              CAS005
     C                     PARM           PNPRTC                                              CAS005
     C                     PARM WFYLD     PNYLDC                                              CAS005
     C                     PARM           PNCYCD                                              CAS005
     C                     PARM           PNICBS                                              CAS005
     C                     PARM EVDATE    PNFLDT                                              CAS005
     C                     PARM *ZERO     PNRATE                                              CAS005
     C                     PARM           CAS008                                              245132
     C                     PARM *ZERO     ZNPSDT  50                                          245132
      *                                                                                       CAS005
     C           PNRTCD    IFEQ '*ERROR '                                                     CAS005
     C           *LOCK     IN   LDA                                                           CAS005
     C                     MOVEL'ZADSPRTV'DBFILE                                              CAS005
     C                     MOVELWFYLD     DBKEY                                               CAS005
     C                     Z-ADD68        DBASE                                               CAS005
     C                     OUT  LDA                                                           CAS005
     C                     EXSR *PSSR                                                         CAS005
     C                     ENDIF                                                              CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
      ** No rates retrieved for the yield curve specified                                     CAS005
      *                                                                                       CAS005
     C           PNRTCD    IFNE '*NRF   '                                                     CAS005
     C                     Z-ADDPNRATE    WINTR                                               CAS005
      **********                                                                       228806 246747
      ***New*effective*interest****************************************                228806 246747
      **********                                                                       228806 246747
     C**********           EXSR SRFNIN                                                 228806 246747
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
     C                     ELSE                                                               CAS005
      *                                                                                       CAS005
      ** Access the currency details and calculate the spot date.                             CAS005
      *                                                                                       CAS005
     C**********           CALL 'AOCURRR0'                                             CAS005 CSC042
     C**********           PARM '*MSG    'PNRTCD                                       CAS005 CSC042
     C**********           PARM '*KEY    'P@OPTN                                       CAS005 CSC042
     C**********           PARM WCCY      PNCYCD                                       CAS005 CSC042
     C********** SDCURR    PARM SDCURR    DSSDY                                        CAS005 CSC042
      *                                                                                       CAS005
     C********** PNRTCD    IFNE *BLANK                                                 CAS005 CSC042
     C                     MOVELWCCY      XCCY                                                CSC042
     C                     EXSR CCYDSP                                                        CSC042
     C           *IN99     IFEQ *OFF                                                          CSC042
     C                     Z-ADDXSPDY     SPDY    30                                          CSC042
     C                     ELSE                                                               CSC042
     C           *LOCK     IN   LDA                                                           CAS005
     C**********           MOVE 'SDCURRPD'DBFILE                                       CAS005 CSC042
     C                     MOVE 'CCYDSP  'DBFILE                                              CSC042
     C                     Z-ADD71        DBASE                                               CAS005
     C                     MOVELWCCY      DBKEY                                               CAS005
     C                     OUT  LDA                                                           CAS005
     C                     SETON                     U7U8LR                                   CAS005
     C                     EXSR *PSSR                                                         CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
      ** Calculate the currency spot date.                                                    CAS005
      *                                                                                       CAS005
     C                     MOVE WCCY      ZCCY                                                CAS005
     C                     MOVE *BLANKS   ZLOC                                                CAS005
     C                     Z-ADDRUND      ZDAYNO                                              CAS005
     C**********           Z-ADDA6SPDY    ZNRDYS                                       CAS005 CSC042
     C                     Z-ADDSPDY      ZNRDYS                                              CSC042
     C                     EXSR ZFWDT                                                         CAS005
     C                     Z-ADDZDYNBR    WSPDT   50                                          CAS005
      *                                                                                       CAS008
      ** For CAS008 enhancement, access Yield Rates File to get the spot days                 CAS008
      ** and use it to calculate for the spot date.                                           CAS008
      *                                                                                       CAS008
     C           CAS008    IFEQ 'Y'                                                           CAS008
      *                                                                                       245132
     C           WFYLD     IFNE WFYLD2                                                        245132
     C           WCCY      ORNE WCCY2                                                         245132
     C           WICBS     ORNE WICM2                                                         245132
      *                                                                                       245132
     C                     MOVE WCCY      WCCY2                                               CAS008
     C                     MOVE WICBS     WICM                                                CAS008
     C           KSPOTD    CHAINSDYLDRL1             35                                       CAS008
     C           *IN35     IFEQ '0'                                                           CAS008
     C                     Z-ADDFSSPDY    ZNRDYS                                              CAS008
     C                     ELSE                                                               CAS008
     C                     MOVE *BLANKS   WCCY                                                CAS008
     C           KSPOTD    CHAINSDYLDRL1             35                                       CAS008
     C           *IN35     IFEQ '0'                                                           CAS008
     C                     Z-ADDFSSPDY    ZNRDYS                                              CAS008
     C                     ENDIF                                                              CAS008
     C                     ENDIF                                                              230371
     C           *IN35     IFEQ '0'                                                           CAS008
     C                     EXSR ZFWDT                                                         CAS008
     C                     Z-ADDZDYNBR    WSPDT                                               CAS008
     C                     ENDIF                                                              CAS008
     C                     MOVE WCCY2     WCCY                                                CAS008
      *                                                                                       245132
     C                     Z-ADDWSPDT     WSPDT2                                              245132
     C                     MOVE WFYLD     WFYLD2                                              245132
     C                     MOVE WCCY      WCCY2                                               245132
     C                     MOVE WICM      WICM2                                               245132
     C                     ELSE                                                               245132
     C                     Z-ADDWSPDT2    WSPDT                                               245132
     C                     ENDIF                                                              245132
      *                                                                                       245132
     C**********           ENDIF                                                      CAS008  230371
     C                     ENDIF                                                              CAS008
      *                                                                                       CAS005
     C                     MOVE WICBS     PNICBS                                              CAS005
      *                                                                                       CAS005
     C********** CEU004    IFEQ 'Y'                                                    CAS005 226512
     C********** EMUCCY    ANDNE*BLANKS                                                CAS005 226512
     C**********           MOVELEMUCCY    WCCY                                         CAS005 226512
     C**********           ENDIF                                                       CAS005 226512
      *                                                                                       CAS005
     C           W@EDAT    IFLT WEVCD                                                         CAS005
     C           WEVCD     ADD  1         PFWNDT                                              CAS005
     C                     ELSE                                                               CAS005
     C                     Z-ADDW@EDAT    PFWNDT                                              CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
     C           EVDATE    IFNE PFWFDT                                                        245132
     C           WCCY      ORNE PNCYCD                                                        245132
     C           WFYLD     ORNE PNYLDC                                                        245132
     C           WSPDT     ORNE PFWSDT                                                        245132
      *                                                                                       245132
     C**********           CALL 'DLZFWR'                                               CAS005 245132
     C                     CALL 'DLZFWR2'                                                     245132
     C                     PARM *BLANK    PFWRTC                                              CAS005
     C                     PARM WCCY      PNCYCD                                              CAS005
     C                     PARM           PNICBS                                              CAS005
     C                     PARM WSPDT     PFWSDT                                              CAS005
     C                     PARM           PFWNDT                                              CAS005
     C                     PARM EVDATE    PFWFDT                                              CAS005
     C                     PARM           PFWOUT                                              CAS005
     C                     PARM WFYLD     PNYLDC                                              CAS005
     C                     PARM           AS001C  1                                           245132
     C                     PARM           CAS008                                              245132
     C                     PARM           CIR004                                              245132
     C                     PARM           ZFWCC2  3                                           245132
     C                     PARM           ZFWIN2  1                                           245132
     C                     PARM           ZFYLD2  5                                           245132
     C                     PARM           ZFWSD2  50                                          245132
     C                     PARM           ZFWND2  50                                          245132
     C                     PARM           ZFWNE2 119                                          245132
      *                                                                                       CAS005
     C           PFWRTC    IFEQ '*ERR*'                                                       CAS005
      *                                                                                       CAS005
     C           *LOCK     IN   LDA                                                           CAS005
     C                     MOVEL'DLZFWR  'DBFILE                                              CAS005
     C                     MOVELWFYLD     DBKEY                                               CAS005
     C                     Z-ADD72        DBASE                                               CAS005
     C                     OUT  LDA                                                           CAS005
     C                     SETON                     U7U8LR                                   CAS005
     C                     EXSR *PSSR                                                         CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
      ** No rates retrieved for the yield curve specified                                     CAS005
      ** (PFWRTC will only be '*NRCD' when CAS001 is off otherwise                            CAS005
      ** no rates retrieved could be determine by PFWOUT being zero)                          CAS005
      *                                                                                       CAS005
     C           PFWRTC    IFNE '*NRCD'                                                       CAS005
     C           PFWOUT    ANDNE0                                                             CAS005
     C                     Z-ADDPFWOUT    WINTR                                               CAS005
      **********                                                                      228806 2467476
      ***New*effective*interest****************************************               228806 2467476
      **********                                                                      228806 2467476
     C**********           EXSR SRFNIN                                                228806 2467476
     C                     ENDIF                                                              CAS005
      *                                                                                       245132
     C                     ENDIF                                                              245132
     C           PFWOUT    IFNE 0                                                             245132
     C                     Z-ADDPFWOUT    WINTR                                               245132
     C                     ENDIF                                                              245132
      *                                                                                       CAS005
     C                     ENDIF                                                              CAS005
     C                     ENDIF                                                              226261
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
      ** Calculate the net treasury rate                                                      CAS005
      *                                                                                       CAS005
     C           WINTR     IFNE *ZERO                                                         CAS005
     C           WINTR     IFGT WAVMAR                                                        CAS005
     C                     SUB  WMARG     WINTR                                               CAS005
     C                     ELSE                                                               CAS005
     C                     Z-ADD0         WINTR                                               CAS005
     C                     ENDIF                                                              CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       226663
     C                     ENDIF                                                              226663
      *                                                                                       CAS005
      ** Recalculate interest                                                                 CAS005
      ** even if forward yield curve is blank and/or margin is 0.                             226663
      *                                                                                       CAS005
     C                     Z-ADDW@EDAT    ZIBEG                                               CAS005
     C                     Z-ADDEVDATE    ZIEND                                               CAS005
      *                                                                                       CAS005
     C           ADDI      IFEQ 'B'                                                           CAS005
     C********** W@EDAT    ANDEQVDAT                                                   CAS005 245082
     C           W@EDAT    ANDEQMDAT                                                          245082
     C           ZIEND     ADD  1         ZIEND                                               CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
     C                     Z-ADDWCPAM     ZIAMT                                               CAS005
     C                     Z-ADDWICBS     ZICALC                                              CAS005
     C                     Z-ADDWINTR     ZIRATE                                              CAS005
      *                                                                                       222972
      ** Instead of executing SR/GLINTC, process RULE78Z1 if CLE028 is on,                    222972
      ** and processing type (PTYP) is 80                                                     222972
      *                                                                                       222972
     C           CLE028    IFEQ 'Y'                                                           222972
     C           PTYP      ANDEQ80                                                            222972
     C           WCALL     ANDEQ'Y'                                                           222972
     C                     Z-ADDVDAT      W78VDT                                              222972
     C                     Z-ADDMDAT      W78MDT                                              222972
      * Use TOTN (Flat Rate less margin)                                                      222972
     C                     Z-ADDTOTN      W78FLT                                              222972
     C                     MOVE RFRQ      W78RPF                                              222972
     C                     Z-ADDFRPD      W78FRD                                              222972
     C                     Z-ADDRDYN      W78RPM                                              222972
     C                     MOVE CCY       W78CCY                                              222972
     C                     MOVE *BLANKS   W78LCN                                              222972
     C                     Z-ADDEVDATE    W78BEG                                              222972
     C                     Z-ADDEVDATE    W78END                                              222972
     C                     MOVE 'R'       W78ROA                                              222972
     C                     EXSR RULE78                                                        222972
     C                     Z-ADDW78INT    ZINTR                                               222972
     C                     ELSE                                                               222972
      *                                                                                       222972
     C/COPY WNCPYSRC,LEH01341
     C                     EXSR GLINTC                                                        CAS005
     C/COPY WNCPYSRC,LEH01401
      *                                                                                       222972
     C                     ENDIF                                                              222972
      *                                                                                       CAS005
     C           WCPAM     IFEQ 0                                                             CAS005
     C           *IN59     OREQ '1'                                                           CAS005
     C                     Z-ADD0         ZINTR                                               CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
      ** Check for round down facility                                                        CAS005
      *                                                                                       CAS005
     C           RDFC      IFEQ 'Y'                                                           CAS005
     C           WACNTR    ADD  ZINTR     WACNTR                                              CAS005
     C                     ELSE                                                               CAS005
     C           WACNTR    ADD  ZINTR     WACNTR    H                                         CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
      ** Determine interest due                                                               CAS005
      *                                                                                       CAS005
     C           WACNTR    SUB  WIPNTR    WINTA  150                                          CAS005
     C           WINTA     SUB  WINNTR    WINTA                                               CAS005
     C                     Z-ADDWINTA     WNTRIN 150                                          CAS005
      *                                                                                       CAS005
      ** If interest due has opposite sign to interest rate, set to 0                         CAS005
      ** Or if the computed interest has opposite sign to interest rate, set to 0             226663
      *                                                                                       CAS005
     C           WINTR     IFGT 0                                                             CAS005
     C           EVAMNT    ANDLT0                                                             CAS005
     C           WINTR     ORGT 0                                                             226663
     C           WNTRIN    ANDLT0                                                             226663
     C                     Z-ADD0         WNTRIN                                              CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       245132
     C           EVTYPE    IFEQ 'I2'                                                          245132
     C                     MOVE *BLANKS   LCFTYP                                              245132
     C                     ELSE                                                               245132
      *                                                                                       CAS005
      ** Determine Event types classification                                                 CAS005
      *                                                                                       CAS005
     C                     EXSR SREVNT                                                        CAS005
      *                                                                                       245132
     C                     ENDIF                                                              245132
      *                                                                                       CAS005
     C                     Z-ADDEVDATE    W@EDAT                                              CAS005
      *                                                                                       CAS005
     C**********           ENDIF                                                       CAS005 226663
      *                                                                                       CAS005
     C                     ENDSR                                                              CAS005
      *                                                                                       CAS005
      *****************************************************************                       CAS005
      /EJECT                                                                                  CAS005
      *****************************************************************                       CAS005
      *                                                               *                       CAS005
      *  SREVNT - Determine Non Interest Event Types                  *                       CAS005
      *                                                               *                       CAS005
      *****************************************************************                       CAS005
      *                                                                                       CAS005
     C           SREVNT    BEGSR                                                              CAS005
      *                                                                                       CAS005
     C                     MOVE *BLANKS   LCFTYP  4                                           CAS005
      *                                                                                       CAS005
     C                     SELEC                                                              CAS005
      *                                                                                       CAS005
      ** Principal increase                                                                   CAS005
      *                                                                                       CAS005
     C           EVCODE    WHEQ '61V3'                                                        CAS005
     C           EVCODE    OREQ '62V3'                                                        CAS005
     C           EVCODE    OREQ '64V3'                                                        CAS005
     C           EVCODE    OREQ '68V3'                                                        CAS005
     C           EVCODE    OREQ '61V4'                                                        CAS005
     C           EVCODE    OREQ '62V4'                                                        CAS005
     C           EVCODE    OREQ '64V4'                                                        CAS005
     C           EVCODE    OREQ '68V4'                                                        CAS005
     C           EVCODE    OREQ '61X3'                                                        CLE139
     C           EVCODE    OREQ '62X3'                                                        CLE139
     C           EVCODE    OREQ '64X3'                                                        CLE139
     C           EVCODE    OREQ '68X3'                                                        CLE139
     C                     MOVE 'PINC'    LCFTYP                                              CAS005
      *                                                                                       CAS005
     C           EVCODE    WHEQ '66V3'                                                        CAS005
     C           EVCODE    OREQ '69V3'                                                        CAS005
     C           EVCODE    OREQ '66V4'                                                        CAS005
     C           EVCODE    OREQ '69V4'                                                        CAS005
     C           EVCODE    OREQ '66X3'                                                        CLE139
     C           EVCODE    OREQ '69X3'                                                        CLE139
     C                     MOVE 'SPIN'    LCFTYP                                              CAS005
      *                                                                                       CAS005
      ** Scheduled Repayment                                                                  CAS005
      *                                                                                       CAS005
     C           EVCODE    WHEQ '61R1'                                                        CAS005
     C           EVCODE    OREQ '62R1'                                                        CAS005
     C           EVCODE    OREQ '64R1'                                                        CAS005
      *          EVCODE    OREQ '68R1'                                                        CAS005
     C                     MOVE 'SRPY'    LCFTYP                                              230112
     C********** EVCODE    OREQ '61R4'                                                 CAS005 230112
     C           EVCODE    WHEQ '61R4'                                                        230112
     C           EVCODE    OREQ '62R4'                                                        CAS005
     C           EVCODE    OREQ '64R4'                                                        CAS005
     C           EVCODE    OREQ '68R4'                                                        CAS005
     C**********           MOVE 'SRPY'    LCFTYP                                       CAS005 230112
     C                     MOVE 'SRPI'    LCFTYP                                              230112
      *                                                                                       CAS005
     C           EVCODE    WHEQ '66R1'                                                        CAS005
     C           EVCODE    OREQ '69R1'                                                        CAS005
     C                     MOVE 'SSRP'    LCFTYP                                              230112
     C********** EVCODE    OREQ '66R4'                                                 CAS005 230112
     C           EVCODE    WHEQ '66R4'                                                        230112
     C           EVCODE    OREQ '69R4'                                                        CAS005
     C**********           MOVE 'SSRP'    LCFTYP                                       CAS005 230112
     C                     MOVE 'SSRI'    LCFTYP                                              230112
      *                                                                                       CAS005
      ** Principal transfer from                                                              CAS005
      *                                                                                       CAS005
     C           EVCODE    WHEQ '61R7'                                                        CAS005
     C           EVCODE    OREQ '62R7'                                                        CAS005
     C           EVCODE    OREQ '63R7'                                                        CAS005
     C           EVCODE    OREQ '64R7'                                                        CAS005
     C           EVCODE    OREQ '65R7'                                                        CAS005
     C           EVCODE    OREQ '68R7'                                                        CAS005
     C           EVCODE    OREQ '61R6'                                                        CAS005
     C           EVCODE    OREQ '62R6'                                                        CAS005
     C           EVCODE    OREQ '63R6'                                                        CAS005
     C           EVCODE    OREQ '64R6'                                                        CAS005
     C           EVCODE    OREQ '65R6'                                                        CAS005
     C           EVCODE    OREQ '68R6'                                                        CAS005
     C                     MOVE 'PTFA'    LCFTYP                                              CAS005
      *                                                                                       CAS005
     C           EVCODE    WHEQ '66R7'                                                        CAS005
     C           EVCODE    OREQ '67R7'                                                        CAS005
     C           EVCODE    OREQ '69R7'                                                        CAS005
     C           EVCODE    OREQ '66R6'                                                        CAS005
     C           EVCODE    OREQ '67R6'                                                        CAS005
     C           EVCODE    OREQ '69R6'                                                        CAS005
     C                     MOVE 'SPTF'    LCFTYP                                              CAS005
      *                                                                                       CAS005
      ** Principal transfer to                                                                CAS005
      *                                                                                       CAS005
     C           EVCODE    WHEQ '61V5'                                                        CAS005
     C           EVCODE    OREQ '62V5'                                                        CAS005
     C           EVCODE    OREQ '63V5'                                                        CAS005
     C           EVCODE    OREQ '64V5'                                                        CAS005
     C           EVCODE    OREQ '65V5'                                                        CAS005
     C           EVCODE    OREQ '68V5'                                                        CAS005
     C           EVCODE    OREQ '61V6'                                                        CAS005
     C           EVCODE    OREQ '62V6'                                                        CAS005
     C           EVCODE    OREQ '63V6'                                                        CAS005
     C           EVCODE    OREQ '64V6'                                                        CAS005
     C           EVCODE    OREQ '65V6'                                                        CAS005
     C           EVCODE    OREQ '68V6'                                                        CAS005
     C                     MOVE 'PTTA'    LCFTYP                                              CAS005
      *                                                                                       CAS005
     C           EVCODE    WHEQ '66V5'                                                        CAS005
     C           EVCODE    OREQ '67V5'                                                        CAS005
     C           EVCODE    OREQ '69V5'                                                        CAS005
     C           EVCODE    OREQ '66V6'                                                        CAS005
     C           EVCODE    OREQ '67V6'                                                        CAS005
     C           EVCODE    OREQ '69V6'                                                        CAS005
     C                     MOVE 'SPTT'    LCFTYP                                              CAS005
      *                                                                                       CAS005
     C                     ENDSL                                                              CAS005
      *                                                                                       CAS005
     C                     ENDSR                                                              CAS005
      *                                                                                       CAS005
      *****************************************************************                       CAS005
      /EJECT                                                                                  CAS005
      *****************************************************************                       CAS005
1640 C**
1641 C**   SR. TO SET UP AN ARRAY OF CURRENCIES AND ARRAYS OF
1642 C**   DECIMAL PLACES,SPOT RATES AND SORT SEQ'S  FOR THOSE CURRENCIES.
1643 C**
1644 C**   CALLED BY: MAIN PROCESSING
1645 C**   CALLS    :
1646 C**
1647 C           CCYARS    BEGSR                           *** CCYARS  ***
1648 C**
1649 C**   SET OFF ERROR INDICATOR
1650 C                     SETOF                     99
     C                     OPEN SDCURRPD                                                      CSC042
1651 C**
1652 C**   SET ARRAY INDEX TO ZERO.
1653 C                     Z-ADD0         X       30
1654 C**************                                                      S01194
1655 C*****SET*UP*KEY FOR CURRENCY TABLE.                                 S01194
1656 C**************       MOVEL'20      'XCYKEY 12                       S01194
1657 C**************       MOVE '    '    XCYKEY                          S01194
1658 C**
1659 C*****SET*LOWER*LIMIT*AND*READ*CURRENCY*TABLE*HEADER.*               S01194
1659 C**   SET LOWER LIMIT AND READ SDCURRPD                              S01194
1660 C***********XCYKEY    SETLLTABLED                                    S01194
1661 C**
1662 C**   LOOP TO READ CURRENCY DETAIL RECORDS.
1663 C           XLOOP     TAG                             ** XLOOP TAG **
1664 C**************       READ TABLED                   99               S01194
     C                     READ SDCURRD0                 99               S01194
1665 C**N99******RECT      COMP 20                   9999                 S01194
1666 C**
1667 C**   END IF ALL CURRENCY RECORDS PROCESSED
1668 C   99                GOTO XCAEND
1669 C**************                                                      S01194
1670 C*****IGNORE*DELETED RECORDS AND NON-SUB-RECORD ONE.                 S01194
1671 C***********RECI      COMP 'D'                  9797                 S01194
1672 C***97*********       GOTO XLOOP                                     S01194
1673 C***********SREC      COMP 1                    9797                 S01194
1674 C***97*********       GOTO XLOOP                                     S01194
1675 C**
1676 C**   INCREMENT ARRAY INDEX.
1677 C           X         ADD  1         X
1678 C**
1679 C**   MOVE DATA INTO ARRAYS.
1680 C                     MOVE CCY       XCYA,X
1681 C                     MOVE CDP       XDPA,X
1682 C                     MOVE SPOT      XSPA,X
1683 C                     MOVE MDIN      XMDA,X
1684 C                     MOVE SSNO      XSSA,X
1685 C                     MOVE ERLC      XSLA,X
     C                     MOVE INCY      XINC,X                          CLE031
     C                     Z-ADDSPDY      XSPD,X                                              CSC042
1686 C**   CHECK FOR FULL ARRAY.96 ON IF FULL.
     C           X         COMP 300                      96
1688 C**
1689 C**   GO TO READ NEXT RECORD.
1690 C  N96                GOTO XLOOP
1691 C**
1692 C           XCAEND    TAG                             ** XCAEND **                       CSC042
     C                     CLOSESDCURRPD                                                      CSC042
1692 C********** XCAEND    ENDSR                           ** XCAEND **                       CSC042
1692 C                     ENDSR                                                              CSC042
1693 C**
1694 C********************************************************************
1695 C********************************************************************
1696 C**
1697 C**   SR. TO OBTAIN CURRENCY DETAILS
1698 C**
1699 C**   CALLED BY: MAIN PROCESSING
1700 C**   CALLS    :
1701 C**
1702 C           CCYDSP    BEGSR                           *** CCYDSP  ***
1703 C**
1704 C**   BLANK CURRENCY CODE IS INVALID
1705 C           XCCY      COMP '   '                    99
1706 C   99                GOTO XCDEND
1707 C**
1708 C**   SET ARRAY INDEX TO ONE
1709 C                     Z-ADD1         X
1710 C**
1711 C**   INITIALIZE INPUT-OUTPUT FIELDS.
1712 C                     Z-ADD0         XDECP   10
1713 C                     Z-ADD0         XSPOT  138
1714 C**************       Z-ADD0         XMDIN   10                      S01194
1714 C**************       MOVE 0         XMDIN   1                S01194 BHF373
1714 C                     MOVE 'D'       XMDIN   1                       BHF373
1715 C                     Z-ADD0         XSORT   20
1716 C                     Z-ADD0         XSPLM  138
1717 C                     MOVE XCCY      XCCY    3
1718 C**
1719 C**   LOOK UP CURRENCY DETAILS
1720 C**   99 SETON FOR INVALID CURRENCY.
1721 C           XCCY      LOKUPXCYA,X                   95
1722 C   95                MOVE XDPA,X    XDECP
1723 C   95                MOVE XSPA,X    XSPOT
1724 C   95                MOVE XMDA,X    XMDIN
1725 C   95                MOVE XSSA,X    XSORT
1726 C   95                MOVE XSLA,X    XSPLM
     C   95                MOVE XINC,X    XINCY   1                                           CLE031
     C   95                MOVE XSPD,X    XSPDY   30                                          CSC042
1727 C  N95                SETON                     99
1728 C**
1729 C           XCDEND    ENDSR                           ** XCDEND **
1730 C**
1731 C********************************************************************
1732 C********************************************************************
1733 C**
1734 C**   SR. TO SET UP AN ARRAY OF COUNTRIES AND AN ARRAY OF
1735 C**   REGIONS FOR THOSE COUNTRIES.
1736 C**
1737 C**   CALLED BY: MAIN PROCESSING
1738 C**   CALLS    :
1739 C**
1740 C           CRYARS    BEGSR                           *** CRYARS  ***
1741 C**
1742 C**   SET OFF ERROR INDICATOR
1743 C                     SETOF                     99
1744 C**
1745 C**   SET ARRAY INDEX TO ZERO.
1746 C                     Z-ADD0         X       30
1747 C**************                                                      S01194
1748 C*****SET*UP*KEY FOR COUNTRY TABLE.                                  S01194
1749 C**************       MOVEL'50      'XCYKEY 12                       S01194
1750 C**
1751 C*****SET*LOWER*LIMIT*AND*READ*COUNTRY TABLE HEADER.                 S01194
1751 C**   SET LOWER LIMIT AND READ SDCTRYPD                              S01194
1752 C***********XCYKEY    SETLLTABLED                                    S01194
1753 C**
1754 C**   LOOP TO READ COUNTRY DETAIL RECORDS.
1755 C           XREAD     TAG                             ** XREAD TAG **
1756 C**************       READ TABLED                   99               S01194
     C                     READ SDCTRYD0                 99               S01194
1757 C**N99******RECT      COMP 50                   9999                 S01194
1758 C**
1759 C**   END IF ALL COUNTRY RECORDS PROCESSED
1760 C   99                GOTO XCEND
1761 C**
1762 C**   IGNORE DELETED RECORDS
1763 C***********RECI      COMP 'D'                  9797                 S01194
1764 C***97*********       GOTO XREAD                                     S01194
1765 C**
1766 C**   INCREMENT ARRAY INDEX.
1767 C           X         ADD  1         X
      *                                                                   056872
      ** Error if number of records exceeds 400.                          056872
      *                                                                   056872
     C           X         COMP 400                  96                   056872
     C           *IN96     IFEQ '0'                                       056872
1768 C**
1769 C**   MOVE DATA INTO ARRAYS.
1770 C                     MOVE CCOD      XCOD,X
1771 C                     MOVE REGC      XREG,X
1772 C**
1773 C**   CHECK FOR FULL ARRAY.96 ON IF FULL.
1774 C***********X         COMP 250                      96               056872
1775 C**
1776 C**   GO TO READ NEXT RECORD.
1777 C**N96******          GOTO XREAD                                     056872
1778 C**
     C                     GOTO XREAD                                     056872
     C                     END                                            056872
      *                                                                   056872
1779 C           XCEND     ENDSR                           ** XCEND **
1780 C**
1781 C********************************************************************
1782 C********************************************************************
1783 C**
1784 C**   SR. TO OBTAIN REGION FOR A COUNTRY.
1785 C**
1786 C**   CALLED BY: MAIN PROCESSING
1787 C**   CALLS    :
1788 C**
1789 C           CRYDET    BEGSR                           *** CRYDET  ***
1790 C**
1791 C**   BLANK COUNTRY CODE IS INVALID
1792 C           XCRY      COMP '  '                     99
1793 C   99                GOTO XDEND
1794 C**
1795 C**   SET ARRAY INDEX TO ONE
1796 C                     Z-ADD1         X
1797 C**
1798 C**   INITIALIZE INPUT-OUTPUT FIELDS.
1799 C                     MOVE '  '      XREGN   2
1800 C                     MOVE XCRY      XCRY    2
1801 C**
1802 C**   LOOK UP REGION FOR COUNTRY.
1803 C**   99 SETON FOR INVALID COUNTRY.
1804 C           XCRY      LOKUPXCOD,X                   95
1805 C   95                MOVE XREG,X    XREGN
1806 C  N95                SETON                     99
1807 C**
1808 C           XDEND     ENDSR                           ** XDEND **
1809 C**
1810 C********************************************************************
     C**                                                                  S01195
     C**   SUBROUTINE TO GET MATURITY LOCATION                            S01195
     C**                                                                  S01195
     C**   CALLED FROM MAIN, INTRST, REPAY                                S01195
     C**                                                                  S01195
     C           MATLOC    BEGSR                           ***  MATLOC ***S01195
      *                                                                   S01195
      ** SET ON INDICATOR TO INDICATE THE ROUTINE HAS BEEN CALLED         S01195
      **                                                                  S01195
     C                     SETON                     77                   S01195
      *                                                                   S01195
      ** INITIALIZE WORKING VARIABLE - SETTLEMENT BRANCH LOCATION         S01195
     C           *LIKE     DEFN NRLC      W@MDSL                          S01195
     C                     MOVE *BLANKS   W@MDSL                          S01195
      *                                                                   S01195
      ** FOR TYPE 01,02,07,08 OR 12, SETTLEMENT LOCATION IS DETERMINED    S01195
      ** BY THE NOSTRO BRANCH.                                            S01195
     C           MDST      IFEQ 01                         *B1            S01195
     C           MDST      OREQ 02                                        S01195
     C           MDST      OREQ 07                                        S01195
     C           MDST      OREQ 08                                        S01195
     C           MDST      OREQ 12                                        S01195
      *                                                                   S01195
     C                     MOVELOMDA      SNOS    2                       S01195
      *                                                                   CEU004
      ** If feature CEU004 is on                                          CEU004
      ** or if feature CLE031 is on                                       CLE031
      ** If Settlement currency for EMU non-blank, set the Nostro CurrencyCEU004
      *                                                                   CEU004
     C                     MOVE CCY       @KEYB            Set Deflt Ccy  CEU004
      *                                                                   CEU004
     C           CEU004    IFEQ 'Y'                        If Feature On  CEU004
     C           CLE031    OREQ 'Y'                        If Feature On  CLE031
      *                                                                   CEU004
     C           EMUCCY    IFNE *BLANKS                     If SetCcy # BlCEU004
     C                     MOVE EMUCCY    @KEYB              Set Currency CEU004
     C                     ENDIF                            End If        CEU004
      *                                                                   CEU004
     C                     ENDIF                           End If         CEU004
     C**********           MOVELEMUCCY    KEYNOS                                   CLE075AF MD021155
     C                     MOVEL@KEYB     KEYNOS                                            MD021155
     C                     MOVE SNOS      KEYNOS                                            CLE075AF
     C                     ADD  1         NOSSEQ                                            CLE075AF
     C                     EXSR CHKNOS                                                      CLE075AF
      *                                                                                     CLE075AF
      ** Use details from array if KEYNOS is found, otherwise,                              CLE075AF
      ** retrieve details from program call                                                 CLE075AF
      *                                                                                     CLE075AF
     C           NOSIC     IFEQ 'Y'                                                         CLE075AF
      *                                                                                     CLE075AF
      ** Set occurence to index found from #NSK array                                       CLE075AF
      *                                                                                     CLE075AF
     C           F         OCUR SDNOST                                                      CLE075AF
      *                                                                                     CLE075AF
     C                     ELSE                                                             CLE075AF
      *                                                                                     CLE075AF
     C           NOSIDX    IFNE 0                                                           CLE075AF
     C                     Z-ADDNOSIDX    F                                                 CLE075AF
     C                     ELSE                                                             CLE075AF
     C                     Z-ADD1         F                                                 CLE075AF
     C                     MOVEA#NOS      #NSS                                              CLE075AF
     C                     SORTA#NSS                                                        CLE075AF
     C                     Z-ADD#NSS,1    NOSKEY                                            CLE075AF
     C           NOSKEY    LOKUP#NOS,F                   45                                 CLE075AF
     C                     ENDIF                                                            CLE075AF
      *                                                                                     CLE075AF
     C           F         OCUR SDNOST                                                      CLE075AF
      *                                                                   S01195
     C                     CALL 'AONOSTR0'                                S01195
     C                     PARM '*MSG   ' @RTCD   7                       S01195
     C                     PARM '*KEY   ' @OPTN   7                       S01195
     C                     PARM *BLANKS   @KEYA   6                       S01195
     C***********          PARM CCY       @KEYB   3                S01195 CEU004
     C                     PARM           @KEYB   3        - Ccy Parm     CEU004
     C**********           PARM *BLANKS   @KEYC   4                                    S01195 CGL029
     C                     PARM *BLANKS   @KEYC  10                                           CGL029
     C                     PARM *BLANKS   @KEYD   2                       S01195
     C                     PARM SNOS      @KEYE   2                       S01195
     C                     PARM *BLANKS   @KEYF   3                       S01195
     C                     PARM *BLANKS   @KEYG  10                       S01195
     C                     PARM *BLANKS   @KEYH   1                       S01195
     C           SDNOST    PARM SDNOST    DSFDY                           S01195
      *                                                                   S01195
     C           @RTCD     IFEQ *BLANKS                                   S01195
      **                                                                  S01195
      **   MOVE THE LAST 3 CHARACTERS OF CUSTOMER SHORT CODE (WHICH       S01195
      **   IS THE LOCATION CODE) TO START LOCATION CODE FIELD             S01195
      **                                                                  S01195
     C                     MOVE CSNM      DSCSNM                          S01195
     C                     MOVE NRLC      W@MDSL                          S01195
     C                     EXSR ADDNOS                                                      CLE075AF
     C                     END                                            S01195
      *                                                                   S01195
     C                     END                             *E1            S01195
     C                     ENDIF                                                            CLE075AF
      *                                                                   S01195
     C                     ENDSR                                          S01195
      *                                                                   S01195
     C********************************************************************S01195
1811 C/SPACE 3
1812 C********************************************************************
1813 C**
1814 C**   ZSYSTM SR. TO CHAIN TO THE INSTALLATION CONTROL DATA RECORD.
1815 C**
1816 C           ZSYSTM    BEGSR                           *** ZSYSTM ***
1817 C**************                                                      S01194
1818 C*****SET*UP*KEY FOR INSTALLATION CONTROL RECORD.                    S01194
1819 C**************       MOVEL'01      'ZTABKY 12                       S01194
1820 C**************       MOVE '  10'    ZTABKY                          S01194
1821 C**************                                                      S01194
1822 C***********ZTABKY    CHAINTABLE                99    ON NOT THERE   S01194
1823 C**N99******RECI      COMP 'D'                  9999  ON, IS DELETED S01194
     C**                                                                  S01194
     C**   ACCESS BANK DETAILS                                            S01194
     C**                                                                  S01194
     C                     CALL 'AOBANKR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDBANK    PARM SDBANK    DSFDY                           S01194
     C*                                                                   S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     SETON                     U7U8LR               S01194
     C                     SETON                     99                   S01194
     C                     MOVEL'SDBANKPD'DBFILE           ***************S01194
     C                     MOVEL@OPTN     DBKEY            * DBERROR 01  *S01194
     C                     Z-ADD1         DBASE            ***************S01194
     C                     ELSE                                           S01194
1824 C**
1825 C**   CHECK SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.
1826 C           DATF      COMP 'M'                      98MMDDYY, 98 ON
     C                     END                                            S01194
1827 C**
1828 C                     ENDSR
1829 C**
1830 C**
1831 C********************************************************************
2367 C********************************************************************
2368 C* SUBROUTINE TO ADD AN AMOUNT (ZZAMT) TO THE TOTAL (ZZTOTI,ZZTOTD)
2369 C*   IND '99' IS SET BY AN OVERFLOW ERROR
2370 C*
2371 CSR         GLZADD    BEGSR                           *** GLZADD ****
2372 C*
2373 CSR                   Z-ADDZZAMT     ZZAMT  153     91-DEFINE ZZAMT
2374 CSR 91                GOTO ZZAEND                     AMT = 0.BYPASS
2375 C*
2376 C* SPLIT ZZAMT INTO INTEGER AND DECIMAL FIELDS
2377 CSR                   Z-ADDZZAMT     ZZAMTI 150       INTEGER FIELD
2378 CSR                   MOVE ZZAMT     ZZAMTD  30       DECIMAL FIELD
2379 C* BOTH ZZAMTI AND ZZAMTD CONTAIN A 'SIGN' ZONE NOW
2380 C*
2381 CSR                   EXSR GLZSUM
2382 CSR         ZZAEND    ENDSR                           ** ZZAEND TAG *
2383 C*
2384 C********************************************************************
2385 C* SUBROUTINE TO CARRY OUT THE ADDITION FOR SUBROUTINES -
2386 C*                        GLZADD, GLZSUB, GLZCMP.
2387 C*          PARAMETERS PASSED -
2388 C*                     I/P ZZAMTI ZZAMTD
2389 C*                     O/P ZZTOTI ZZTOTD ZZNEGD IND 96 IND 99.
2390 C*
2391 CSR         GLZSUM    BEGSR                           *** GLZSUM ****
2392 C*
2393 CSR                   Z-ADDZZTOTI    ZZTOTI 150       DEFINE ZZTOTI
2394 CSR                   Z-ADDZZTOTD    ZZTOTD  30       DEFINE ZZTOTD
2395 CSR                   SETOF                     919293
2396 CSR                   SETOF                     949599
2397 C*
2398 C*    DETERMINE SIGN OF ZZAMTI & D,   92 IF NEG
2399 CSR         ZZAMTI    COMP 0                      9293
2400 CSR 93      ZZAMTD    COMP 0                      9293
2401 CSR 93                GOTO ZZSEND                     ZERO BYPASS
2402 C*
2403 C*    DETERMINE SIGN OF ZZTOTI & D, 91 IF NEG.
2404 CSR         ZZTOTI    COMP 0                      9193
2405 CSR 93      ZZTOTD    COMP 0                      9193
2406 C*
2407 C*    IF ZZTOTAL IS ZERO, RETURN ZZAMOUNT.
2408 CSR 93                Z-ADDZZAMTI    ZZTOTI
2409 CSR 93                Z-ADDZZAMTD    ZZTOTD
2410 CSR 93                GOTO ZZSEND                     ZERO BYPASS
2411 C*    IF SIGNS DIFFER BYPASS OVERFLOW CHECKS.
2412 CSR 91N92
2413 CORN91 92             GOTO ZZOFPS
2414 C*
2415 CSR         ZZAMTD    ADD  ZZTOTD    ZZWK2   40
2416 CSR         ZZWK2     COMP 999                  93    '93' = CARRY
2417 CSRN93      ZZWK2     COMP -999                   93    INTO INTEGER.
2418 C*
2419 CSR 93N92   ZZAMTI    ADD  1         ZZWK3  150       ADD 'CARRY' +VE
2420 CSR    93 92ZZAMTI    SUB  1         ZZWK3            SUB 'CARRY' -VE
2421 CSR 93      ZZTOTI    ADD  ZZWK3     ZZWK3
2422 CSRN93      ZZTOTI    ADD  ZZAMTI    ZZWK3
2423 C*
2424 C* IF THE MODULUS OF ZZWK3 IS LT MOD. ZZTOTI THEN O/F HAS OCCURED
2425 CSRN92      ZZWK3     COMP ZZTOTI                 99  -92 MEANS NOS.
2426 CSR 92      ZZWK3     COMP ZZTOTI               99     NEGATIVE
2427 CSRN99                Z-ADDZZWK2     ZZTOTD
2428 CSRN99                Z-ADDZZWK3     ZZTOTI
2429 C*
2430 C* IF O/F ZEROIZE ZZAMT , IND '99' SET AND ZZTOT FIELDS LEFT INTACT.
2431 CSR 99                Z-ADD0         ZZAMT  153
2432 CSR                   GOTO ZZSEND
2433 C*
2434 C* THE 'SIGNS' ARE DIFFERENT
2435 CSR         ZZOFPS    TAG                             ** ZZOFPS TAG**
2436 C* IF ZZAMT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZTOT
2437 C*
2438 CSR 92                Z-SUBZZAMTI    ZZAMTI 150
2439 CSR 92                Z-SUBZZAMTD    ZZAMTD  30
2440 C*
2441 C* IF ZZTOT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZAMT.
2442 C*
2443 CSR 91                Z-SUBZZTOTI    ZZTOTI
2444 CSR 91                Z-SUBZZTOTD    ZZTOTD
2445 C* BOTH ZZAMT AND ZZTOT ARE NOW POSITIVE.
2446 C*
2447 CSR         ZZTOTI    COMP ZZAMTI               93  95
2448 CSR 95      ZZTOTD    COMP ZZAMTD               93  95
2449 C*
2450 C* IF ZZTOT EQ. ZZAMT RETURN ZERO.
2451 CSR 95                Z-ADD0         ZZTOTI
2452 CSR 95                Z-ADD0         ZZTOTD
2453 CSR 95                GOTO ZZSEND
2454 C*
2455 C* IF ZZTOT GT. ZZAMT.
2456 CSR 93      ZZAMTD    COMP ZZTOTD               94
2457 CSR 93 94   ZZTOTI    SUB  1         ZZTOTI
2458 CSR 93 94   ZZTOTD    ADD  1000      ZZWK2
2459 CSR 93      ZZTOTI    SUB  ZZAMTI    ZZTOTI
2460 CSR 93 94   ZZWK2     SUB  ZZAMTD    ZZTOTD
2461 CSR 93N94   ZZTOTD    SUB  ZZAMTD    ZZTOTD
2462 C*
2463 C*
2464 C* IF ZZAMT GT. ZZTOT.
2465 CSRN93      ZZTOTD    COMP ZZAMTD               94
2466 CSRN93 94   ZZAMTI    SUB  1         ZZWK3  150
2467 CSRN93 94   ZZAMTD    ADD  1000      ZZWK2
2468 CSRN93 94   ZZWK3     SUB  ZZTOTI    ZZTOTI
2469 CSRN93N94   ZZAMTI    SUB  ZZTOTI    ZZTOTI
2470 CSRN93 94   ZZWK2     SUB  ZZTOTD    ZZTOTD
2471 CSRN93N94   ZZAMTD    SUB  ZZTOTD    ZZTOTD
2472 C*
2473 C* REVERSE SIGN OF ZZTOT IF LARGER I/P FIELDS WERE NEGATIVE
2474 CSR                   SETOF                     94
2475 CSR 93 91
2476 CORN93 92             SETON                     94
2477 CSR 94                Z-SUBZZTOTI    ZZTOTI
2478 CSR 94                Z-SUBZZTOTD    ZZTOTD
2479 C**
2480 C**   RESTORE SIGN OF ZZAMTI & ZZAMTD IF IT WAS REVERSED.
2481 CSR 92                Z-SUBZZAMTI    ZZAMTI
2482 CSR 92                Z-SUBZZAMTD    ZZAMTD
2483 CSR         ZZSEND    TAG                             ** ZZSEND TAG *
2484 C**
2485 C**   IF ZZTOTD IS ZERO, AND ZZTOTI IS NEG. SET UP ZZNEGD.
2486 CSR                   SETOF                     96
2487 CSR         ZZTOTD    COMP 0                        91
2488 CSR 91      ZZTOTI    COMP 0                      96
2489 CSR 96                MOVE '.000-'   ZZNEGD  5
2490 CSR                   ENDSR                             ** ENDSR **
2491 C********************************************************************
      *                                                                                       218992
      * SREXST --- Subroutine to set up extended settlement fields                            218992
      *                                                                                       218992
      * CALLED FROM: LEVENT                                                                   218992
      *                                                                                       218992
      ********************************************************************                    218992
      *                                                                                       218992
     C           SREXST    BEGSR                           ** SREXST **                       218992
      *                                                                                       218992
     C           *IN83     IFEQ '1'                        Start                              218992
     C           *IN84     OREQ '1'                                                           218992
      *                                                                                       218992
      ** Start/Mature Processing:                                                             218992
      *                                                                                       218992
     C                     MOVELLOTA1     LOTX1                                               218992
     C                     MOVELLOTA2     LOTX2                                               218992
     C                     MOVELLOTA3     LOTX3                                               218992
     C                     MOVELLOTA4     LOTX4                                               218992
     C                     MOVELLOTA5     LOTX5                                               CGL029
     C                     MOVELSCCY      RSCYX                                               218992
     C                     MOVELPSCY      PSCYX                                               218992
     C                     MOVELCVMR      CVMRX                                               218992
     C                     Z-ADDREXR      REXRX                                               218992
     C                     MOVELREXI      REXIX                                               218992
     C                     Z-ADDPEXR      PEXRX                                               218992
     C                     MOVELPEXI      PEXIX                                               218992
      *                                                                                       218992
     C           PTYP      IFEQ 66                                                            218992
     C           PTYP      OREQ 67                                                            218992
     C           PTYP      OREQ 69                                                            218992
     C           PTYP      OREQ 72                                                            218992
     C                     MOVELOSDB      POBRX                                               218992
     C                     MOVELOMDB      ROBRX                                               218992
     C                     ELSE                                                               218992
     C                     MOVELOMDB      POBRX                                               218992
     C                     MOVELOSDB      ROBRX                                               218992
     C                     ENDIF                                                              218992
     C                     ENDIF                                                              218992
      *                                                                                       218992
     C           *IN85     IFEQ '1'                                                           218992
      *                                                                                       218992
      ** Amend Processing:                                                                    218992
      *                                                                                       218992
     C           EVAMNT    IFGE 0                                                             226542
     C                     MOVELLOTM1     LOTX1                                               218992
     C                     MOVELLOTM2     LOTX2                                               218992
     C                     MOVELLOTM3     LOTX3                                               218992
     C                     MOVELLOTM4     LOTX4                                               218992
     C                     MOVELLOTM5     LOTX5                                               CGL029
     C                     MOVELSCCY      RSCYX                                               218992
     C                     MOVELPSCYLA    PSCYX                                               218992
     C                     MOVELCVMRLA    CVMRX                                               218992
     C                     Z-ADDREXRLA    REXRX                                               218992
     C                     MOVELREXILA    REXIX                                               218992
     C                     Z-ADDPEXRLA    PEXRX                                               218992
     C                     MOVELPEXILA    PEXIX                                               218992
      *                                                                                       218992
     C           PTYP      IFEQ 66                                                            218992
     C           PTYP      OREQ 67                                                            218992
     C           PTYP      OREQ 69                                                            218992
     C           PTYP      OREQ 72                                                            218992
     C                     MOVEL*BLANKS   POBRX                                               218992
     C                     MOVELOSBR      ROBRX                                               218992
     C                     ELSE                                                               218992
     C                     MOVELOSBR      POBRX                                               218992
     C                     MOVEL*BLANKS   ROBRX                                               218992
     C                     ENDIF                                                              218992
     C                     ELSE                                                               226542
     C                     MOVELLOTM2     LOTX1                                               226542
     C                     MOVELLOTM2     LOTX2                                               226542
     C                     MOVELLOTM1     LOTX2                                               226542
     C                     MOVELLOTM3     LOTX3                                               226542
     C                     MOVELLOTM4     LOTX4                                               226542
     C                     MOVELSCCY      PSCYX                                               226542
     C                     MOVELPSCYLA    RSCYX                                               226542
     C                     MOVELCVMRLA    CVMRX                                               226542
     C                     Z-ADDREXRLA    PEXRX                                               226542
     C                     MOVELREXILA    PEXIX                                               226542
     C                     Z-ADDPEXRLA    REXRX                                               226542
     C                     MOVELPEXILA    REXIX                                               226542
      *                                                                                       226542
     C           PTYP      IFEQ 66                                                            226542
     C           PTYP      OREQ 67                                                            226542
     C           PTYP      OREQ 69                                                            226542
     C           PTYP      OREQ 72                                                            226542
     C                     MOVEL*BLANKS   ROBRX                                               226542
     C                     MOVELOSBR      POBRX                                               226542
     C                     ELSE                                                               226542
     C                     MOVELOSBR      ROBRX                                               226542
     C                     MOVEL*BLANKS   POBRX                                               226542
     C                     ENDIF                                                              226542
     C                     ENDIF                                                              226542
     C                     ENDIF                                                              218992
      *                                                                                       218992
     C           *IN86     IFEQ '1'                                                           218992
      *                                                                                       218992
      ** Rollover Processing:                                                                 218992
      *                                                                                       218992
     C                     MOVELLOTB1     LOTX1                                               218992
     C                     MOVELLOTB2     LOTX2                                               218992
     C                     MOVELLOTB3     LOTX3                                               218992
     C                     MOVELLOTB4     LOTX4                                               218992
     C                     MOVELLOTB5     LOTX5                                               CGL029
     C                     MOVELRRSC      RSCYX                                               218992
     C                     MOVELRPSC      PSCYX                                               218992
     C                     MOVELRCVM      CVMRX                                               218992
     C                     Z-ADDRRSR      REXRX                                               218992
     C                     MOVELRRSI      REXIX                                               218992
     C                     Z-ADDRPSR      PEXRX                                               218992
     C                     MOVELRPSI      PEXIX                                               218992
     C                     MOVELRLBR      ROBRX                                               218992
     C                     MOVELRLSB      POBRX                                               218992
     C                     ENDIF                                                              218992
     C*                                                                                       221684
     C                     MOVELLOTX1     TEMP2   2                                           221684
     C           TEMP2     IFEQ '  '                                                          221684
     C                     MOVEL'00'      LOTX1                                               221684
     C                     ENDIF                                                              221684
     C                     MOVELLOTX2     TEMP2                                               221684
     C           TEMP2     IFEQ '  '                                                          221684
     C                     MOVEL'00'      LOTX2                                               221684
     C                     ENDIF                                                              221684
     C*                                                                                       221684
     C                     ENDSR                           ** SREXST **                       218992
      *                                                                                       218992
      ********************************************************************                    218992
      *                                                                                       CLE034
      * SR34A  --- Initial set up for CLE034 processing                                       CLE034
      *                                                                                       CLE034
      * CALLED FROM: RECOUT                                                                   CLE034
      *                                                                                       CLE034
      * CALLS: AOSTALR2                                                                       CLE034
      *                                                                                       CLE034
      ********************************************************************                    CLE034
      *                                                                                       CLE034
     C           SR34A     BEGSR                           ** SR34A **                        CLE034
     C                     Z-ADDEVAMNT    SAVAMT 130                                          CLE034
     C           INSIND    IFEQ 1                          Start                              CLE034
     C           INSIND    OREQ 3                                                             CLE034
     C           AMTP      ANDEQ'PI'                       Principal Incr.                    CLE034
     C           INSIND    OREQ 4                                                             CLE034
     C           AMTP      ANDEQ'PI'                       Principal Incr.                    CLE034
     C           *IN50     ANDEQ*ON                                                           CLE034
     C           INSIND    OREQ 5                                                             CLE034
     C           EVTYPE    ANDNE'I3'                                                          CLE034
      *                                                                                       CLE034
      ** Start Processing:                                                                    CLE034
      *                                                                                       CLE034
     C           PTYP      IFEQ 66                                                            CLE034
     C           PTYP      OREQ 67                                                            CLE034
     C           PTYP      OREQ 69                                                            CLE034
     C           PTYP      OREQ 72                                                            CLE034
     C                     MOVE 'R'       W#PYRC  1                                           CLE034
     C                     ELSE                                                               CLE034
     C                     MOVE 'P'       W#PYRC                                              CLE034
     C                     ENDIF                                                              CLE034
      *                                                                                       CLE034
     C                     ELSE                                                               CLE034
      *                                                                                       CLE034
      **  Else, Repayment Processing:                                                         CLE034
     C           PTYP      IFEQ 66                                                            CLE034
     C           PTYP      OREQ 67                                                            CLE034
     C           PTYP      OREQ 69                                                            CLE034
     C           PTYP      OREQ 72                                                            CLE034
     C                     MOVE 'P'       W#PYRC  1                                           CLE034
     C                     ELSE                                                               CLE034
     C                     MOVE 'R'       W#PYRC                                              CLE034
     C                     ENDIF                                                              CLE034
     C                     ENDIF                                                              CLE034
     C*                                                                                       CLE034
      * Save values which might be overwritten by fields on LESTALPD                          CLE034
     C                     Z-ADD0         TOTAMT 130                                          CLE034
     C                     Z-ADD0         WRKAMT 130                                          CLE034
     C                     MOVE ' '       WRKFLD  1                                           CLE034
     C                     MOVE ' '       WRKSET                                              CLE034
     C**********           MOVE SETTLE    SAVSET 24                                    CLE034 CGL029
     C                     MOVE SETTLE    SAVSET 30                                           CGL029
     C                     MOVE PSTM      SVPSTM  2                                           CLE034
     C**********           MOVE PONS      SVPONS 12                                    CLE034 CGL029
     C                     MOVE PONS      SVPONS 18                                           CGL029
     C                     MOVE RSTM      SVRSTM  2                                           CLE034
     C**********           MOVE RONS      SVRONS 12                                    CLE034 CGL029
     C                     MOVE RONS      SVRONS 18                                           CGL029
     C                     MOVE WSCCY     SVSCCY  3                                           CLE034
     C                     MOVE WPSCY     SVPSCY  3                                           CLE034
     C                     Z-ADDWREXR     SVREXR 138                                          CLE034
     C                     MOVE WREXI     SVREXI  1                                           CLE034
     C                     Z-ADDWPEXR     SVPEXR 138                                          CLE034
     C                     MOVE WPEXI     SVPEXI  1                                           CLE034
     C                     MOVE WSCCYL    SVSCYL  3                                           CLE034
     C                     MOVE WPSCYL    SVPCYL  3                                           CLE034
     C                     Z-ADDWREXRL    SVRXRL 138                                          CLE034
     C                     MOVE WREXIL    SVRXIL  1                                           CLE034
     C                     Z-ADDWPEXRL    SVPXRL 138                                          CLE034
     C                     MOVE WPEXIL    SVPXIL  1                                           CLE034
     C                     MOVE WRRSC     SVRRSC  3                                           CLE034
     C                     MOVE WRPSC     SVRPSC  3                                           CLE034
     C                     Z-ADDWRRSR     SVRRSR 138                                          CLE034
     C                     MOVE WRRSI     SVRRSI  1                                           CLE034
     C                     Z-ADDWRRSR     SVRRSR 138                                          CLE034
     C                     MOVE WRPSI     SVRPSI  1                                           CLE034
     C                     Z-ADDWRPSR     SVRPSR 138                                          CLE034
     C                     MOVE WRPSI     SVRPSI  1                                           CLE034
     C                     MOVE SBCMPY    SVCMPY  3                                           CLE034
     C                     MOVE FININD    SVFINI  1                                           CLE034
      *                                                                                       218992
     C                     MOVELOSDB      SVOSDB                                              218992
     C                     MOVELOMDB      SVOMDB                                              218992
     C                     MOVELOSBR      SVOSBR                                              218992
     C                     MOVELRLBR      SVRLBR                                              218992
     C                     MOVELRLSB      SVRLSB                                              218992
     C                     MOVELLOTA1     SVLTA1                                              218992
     C                     MOVELLOTA2     SVLTA2                                              218992
     C                     MOVELLOTA3     SVLTA3                                              218992
     C                     MOVELLOTA4     SVLTA4                                              218992
     C                     MOVELLOTA5     SVLTA5                                              CGL029
     C                     MOVELLOTB1     SVLTB1                                              218992
     C                     MOVELLOTB2     SVLTB2                                              218992
     C                     MOVELLOTB3     SVLTB3                                              218992
     C                     MOVELLOTB4     SVLTB4                                              218992
     C                     MOVELLOTB5     SVLTB5                                              CGL029
     C                     MOVELLOTM1     SVLTM1                                              218992
     C                     MOVELLOTM2     SVLTM2                                              218992
     C                     MOVELLOTM3     SVLTM3                                              218992
     C                     MOVELLOTM4     SVLTM4                                              218992
     C                     MOVELLOTM5     SVLTM5                                              CGL029
     C                     MOVELCVMR      SVCVMR                                              218992
     C                     MOVELCVMRLA    SVCVMA                                              218992
     C                     MOVELRCVM      SVRCVM                                              218992
     C                     Z-ADDREXR      SWREXR                                              218992
     C                     MOVELREXI      SWREXI                                              218992
     C                     Z-ADDPEXR      SWPEXR                                              218992
     C                     MOVELPEXI      SWPEXI                                              218992
     C                     Z-ADDREXRLA    SWRXRL                                              218992
     C                     MOVELREXILA    SWRXIL                                              218992
     C                     Z-ADDPEXRLA    SWPXRL                                              218992
     C                     MOVELPEXILA    SWPXIL                                              218992
     C                     Z-ADDRRSR      SWRRSR                                              218992
     C                     MOVELRRSI      SWRRSI                                              218992
     C                     Z-ADDRPSR      SWRPSR                                              218992
     C                     MOVELRPSI      SWRPSI                                              218992
     C                     MOVELSCCY      SWSCCY                                              218992
     C                     MOVELPSCY      SWPSCY                                              218992
     C                     MOVELPSCYLA    SWPSYL                                              218992
     C                     MOVELRRSC      SWRRSC                                              218992
     C                     MOVELRPSC      SWRPSC                                              218992
     C                     MOVELLOTX1     SVLTX1                                              221684
     C                     MOVELLOTX2     SVLTX2                                              221684
     C                     MOVELLOTX3     SVLTX3                                              221684
     C                     MOVELLOTX4     SVLTX4                                              221684
     C                     MOVELROBRX     SROBRX                                              221684
     C                     MOVELRSCYX     SRSCYX                                              221684
     C                     Z-ADDREXRX     SREXRX                                              221684
     C                     MOVELREXIX     SREXIX                                              221684
     C                     MOVELPOBRX     SPOBRX                                              221684
     C                     MOVELCVMRX     SCVMRX                                              221684
     C                     MOVELPSCYX     SPSCYX                                              221684
     C                     MOVELICCYX     SIC72X                                              221684
     C                     Z-ADDPEXRX     SPEXRX                                              221684
     C                     MOVELPEXIX     SPEXIX                                              221684
      *                                                                                       CLE034
     C           INSIND    IFEQ 1                          Start                              CLE034
     C           INSIND    OREQ 2                          Mature                             CLE034
     C           INSIND    OREQ 4                                                             CLE034
     C           *IN50     ANDEQ*OFF                                                          CLE034
     C                     MOVE LNRF      PLNRF                                               CLE034
     C                     CALL 'AOSTALR2'                                                    CLE034
     C                     PARM *BLANKS   STALCD  7                                           CLE034
     C                     PARM '*FIRST ' POPTN   7                                           CLE034
     C                     PARM 'LOAN'    PTYPE                                               CLE034
     C                     PARM           PLNRF   6                                           CLE034
     C                     PARM *BLANKS   PVDAT   5                                           CLE034
     C                     PARM *BLANKS   PLASN   3                                           CLE034
     C                     PARM *BLANKS   FECUS   6                                           CLE034
     C                     PARM *BLANKS   FEFAC   5                                           CLE034
     C                     PARM *BLANKS   FESEQ   2                                           CLE034
     C                     PARM W#PYRC    PPYRC   1                                           CLE034
     C***********LESTAL    PARM *BLANKS   DSSDY                                       CLE034 BUG9175
     C           LESTAL    PARM *BLANKS   DSLDY                                              BUG9175
     C*                                                                                       CLE034
     C           STALCD    IFNE *BLANKS                                                       CLE034
     C                     MOVEL'LE0480  'DBPGM                                               CLE034
     C                     MOVEL'LESTALPD'DBFILE           ***************                    CLE034
     C                     MOVELLNRF      DBKEY            *** DB 051 ****                    CLE034
     C                     Z-ADD51        DBASE            ***************                    CLE034
     C                     SETON                     U7U8LR                                   CLE034
     C                     GOTO END                                                           CLE034
     C                     END                                                                CLE034
     C                     ENDIF                                                              CLE034
      *                                                                                       CLE034
     C           INSIND    IFEQ 3                                                             CLE034
     C           INSIND    OREQ 4                                                             CLE034
     C           *IN50     ANDEQ*ON                                                           CLE034
     C                     MOVE LNRFLA    PLNRF                                               CLE034
     C                     MOVE VDATLA    PVDAT                                               CLE034
     C                     MOVEL'LA'      PTYPE   4                                           CLE034
     C                     MOVE AMTP      PTYPE                                               CLE034
     C                     MOVE LASN      PLASN                                               CLE034
     C                     CALL 'AOSTALR2'                                                    CLE034
     C                     PARM *BLANKS   STALCD  7                                           CLE034
     C                     PARM '*FIRST ' POPTN   7                                           CLE034
     C                     PARM           PTYPE                                               CLE034
     C                     PARM           PLNRF   6                                           CLE034
     C                     PARM           PVDAT   5                                           CLE034
     C                     PARM           PLASN   3                                           CLE034
     C                     PARM *BLANKS   FECUS   6                                           CLE034
     C                     PARM *BLANKS   FEFAC   5                                           CLE034
     C                     PARM *BLANKS   FESEQ   2                                           CLE034
     C                     PARM W#PYRC    PPYRC   1                                           CLE034
     C***********LESTAL    PARM *BLANKS   DSSDY                                       CLE034 BUG9175
     C           LESTAL    PARM *BLANKS   DSLDY                                              BUG9175
      *                                                                                       CLE034
     C           STALCD    IFNE *BLANKS                                                       CLE034
     C                     MOVEL'LE0480  'DBPGM                                               CLE034
     C                     MOVEL'LESTALPD'DBFILE           ***************                    CLE034
     C                     MOVELLNRFLA    DBKEY            *** DB 052 ****                    CLE034
     C                     Z-ADD52        DBASE            ***************                    CLE034
     C                     SETON                     U7U8LR                                   CLE034
     C                     GOTO END                                                           CLE034
     C                     END                                                                CLE034
     C                     ENDIF                                                              CLE034
      *                                                                                       CLE034
     C           INSIND    IFEQ 5                                                             CLE034
     C                     MOVE LNRF      PLNRF                                               CLE034
     C                     CALL 'AOSTALR2'                                                    CLE034
     C                     PARM *BLANKS   STALCD  7                                           CLE034
     C                     PARM '*FIRST ' POPTN   7                                           CLE034
     C                     PARM 'ROLL'    PTYPE   4                                           CLE034
     C                     PARM           PLNRF   6                                           CLE034
     C                     PARM *BLANKS   PVDAT   5                                           CLE034
     C                     PARM *BLANKS   PLASN   3                                           CLE034
     C                     PARM *BLANKS   FECUS   6                                           CLE034
     C                     PARM *BLANKS   FEFAC   5                                           CLE034
     C                     PARM *BLANKS   FESEQ   2                                           CLE034
     C                     PARM W#PYRC    PPYRC   1                                           CLE034
     C***********LESTAL    PARM *BLANKS   DSSDY                                       CLE034 BUG9175
     C           LESTAL    PARM *BLANKS   DSLDY                                              BUG9175
      *                                                                                       CLE034
     C           STALCD    IFNE *BLANKS                                                       CLE034
     C                     MOVEL'LE0480  'DBPGM                                               CLE034
     C                     MOVEL'LESTALPD'DBFILE           ***************                    CLE034
     C                     MOVELLNRF      DBKEY            *** DB 053 ****                    CLE034
     C                     Z-ADD53        DBASE            ***************                    CLE034
     C                     SETON                     U7U8LR                                   CLE034
     C                     GOTO END                                                           CLE034
     C                     END                                                                CLE034
     C                     ENDIF                                                              CLE034
     C                     ENDSR                           ** SR34A **                        CLE034
      *                                                                                       CLE034
      ********************************************************************                    CLE034
      * SR34B  - Processing to calculate amount for settlement allocation                     CLE034
      *                                                                                       CLE034
      * CALLED FROM: RECOUT                                                                   CLE034
      *                                                                                       CLE034
      * CALLS:                                                                                CLE034
      *                                                                                       CLE034
      ********************************************************************                    CLE034
      *                                                                                       CLE034
     C           SR34B     BEGSR                           ** SR34B **                        CLE034
     C                     EXSR SR34D                                                         CLE034
      *                                                                                       CLE034
     C********** EMUCCY    IFEQ 'Y'                                                    CLE034 CLE034
     C           EMUCCY    IFNE *BLANKS                                                       CLE034
     C                     MOVE 'Y'       WRKPRO                                              CLE034
     C           CLE033    IFEQ 'Y'                                                           221684
     C           SET09     ANDEQ'T'                                                           221684
     C           SETTYP    ANDEQ09                                                            221684
     C                     MOVE *OFF      *IN33                                               221684
     C                     ELSE                                                               221684
     C                     MOVE '1'       *IN33                                               CLE034
     C                     ENDIF                                                              221684
     C                     ENDIF                                                              CLE034
      *                                                                                       CLE038
      ** If Payment is Allocated by Percentage                                                CLE038
      *                                                                                       CLE038
     C           W#PYRC    IFEQ 'P'                                                           CLE038
     C           STPYBA    ANDNE'A'                                                           CLE038
      *                                                                                       CLE038
      ** Or Receive is Allocated by Percentage                                                CLE038
      *                                                                                       CLE038
     C           W#PYRC    OREQ 'R'                                                           CLE038
     C           STRCBA    ANDNE'A'                                                           CLE038
      *                                                                                       CLE034
     C           W#PYRC    IFEQ 'P'                                                           CLE034
     C           PYPC      DIV  100       W#PYPC 139                                          CLE034
     C           SAVAMT    MULT W#PYPC    WRKAMT    H                                         CLE034
     C                     ELSE                                                               CLE034
     C           RCPC      DIV  100       W#RCPC 139                                          CLE034
     C           SAVAMT    MULT W#RCPC    WRKAMT    H                                         CLE034
     C                     ENDIF                                                              CLE034
      *                                                                                       CLE034
     C           TOTAMT    ADD  WRKAMT    TOTAMT                                              CLE034
      *                                                                                       CLE034
     C           WRKFLD    IFEQ 'Y'                                                           CLE034
     C           SAVAMT    ANDNETOTAMT                                                        CLE034
     C           SAVAMT    SUB  TOTAMT    W#DIFF 130                                          CLE034
     C           WRKAMT    ADD  W#DIFF    WRKAMT                                              CLE034
     C***********          Z-ADDWRKAMT    EVAMNT                                        CLE034218992
     C                     ENDIF                                                              CLE034
     C                     Z-ADDWRKAMT    EVAMNT                                              218992
     C                     ELSE                                                               CLE038
      *                                                                                       CLE038
      ** Else, Allocation is by amount                                                        CLE038
      *                                                                                       CLE038
     C           WRKFLD    IFNE 'Y'                                                           CLE038
     C           W#PYRC    IFEQ 'P'                                                           CLE038
     C                     Z-ADDSTPYAM    WRKAMT                                              CLE038
     C                     Z-ADDSTPYAM    EVAMNT                                              CLE038
     C                     ELSE                                                               CLE038
     C                     Z-ADDSTRCAM    WRKAMT                                              CLE038
     C                     Z-ADDSTRCAM    EVAMNT                                              CLE038
     C                     ENDIF                                                              CLE038
     C                     ELSE                                                               CLE038
     C                     Z-ADD0         WRKAMT                                              CLE038
     C                     Z-ADD0         EVAMNT                                              CLE038
     C                     ENDIF                                                              CLE038
     C                     ENDIF                                                              CLE038
     C                     ENDSR                           ** SR34B **                        CLE034
      *                                                                                       CLE034
      ********************************************************************                    CLE034
      * SR34C  - Processing to get next settlement allocation            *                    CLE034
      *                                                                  *                    CLE034
      * CALLED FROM: RECOUT                                              *                    CLE034
      *                                                                  *                    CLE034
      * CALLS: AOSTALR2                                                  *                    CLE034
      *                                                                  *                    CLE034
      ********************************************************************                    CLE034
      *                                                                                       CLE034
     C           SR34C     BEGSR                           ** SR34C **                        CLE034
     C           WRKFLD    IFEQ 'Y'                                                           CLE034
     C                     MOVE ' '       WRKFLD                                              CLE034
     C                     ELSE                                                               CLE034
      *                                                                                       CLE034
     C           INSIND    IFEQ 1                          Start                              CLE034
     C           INSIND    OREQ 2                          Mature                             CLE034
     C           INSIND    OREQ 4                                                             CLE034
     C           *IN50     ANDEQ'0'                                                           CLE034
     C                     MOVE LNRF      PLNRF                                               CLE034
     C                     CALL 'AOSTALR2'                                                    CLE034
     C                     PARM *BLANKS   STALCD  7                                           CLE034
     C                     PARM '*NEXT  ' POPTN   7                                           CLE034
     C                     PARM 'LOAN'    PTYPE   4                                           CLE034
     C                     PARM           PLNRF   6                                           CLE034
     C                     PARM *BLANKS   PVDAT   5                                           CLE034
     C                     PARM *BLANKS   PLASN   3                                           CLE034
     C                     PARM *BLANKS   FECUS   6                                           CLE034
     C                     PARM *BLANKS   FEFAC   5                                           CLE034
     C                     PARM *BLANKS   FESEQ   2                                           CLE034
     C                     PARM W#PYRC    PPYRC   1                                           CLE034
     C***********LESTAL    PARM *BLANKS   DSSDY                                       CLE034 BUG9175
     C           LESTAL    PARM *BLANKS   DSLDY                                              BUG9175
     C                     ENDIF                                                              CLE034
      *                                                                                       CLE034
     C           INSIND    IFEQ 3                                                             CLE034
     C           INSIND    OREQ 4                                                             CLE034
     C           *IN50     ANDEQ'1'                                                           CLE034
     C                     MOVE LNRFLA    PLNRF                                               CLE034
     C                     MOVE VDATLA    PVDAT                                               CLE034
     C                     MOVE LASN      PLASN                                               CLE034
     C                     MOVEL'LA'      PTYPE   4                                           CLE034
     C                     MOVE AMTP      PTYPE                                               CLE034
     C                     CALL 'AOSTALR2'                                                    CLE034
     C                     PARM *BLANKS   STALCD  7                                           CLE034
     C                     PARM '*NEXT  ' POPTN   7                                           CLE034
     C                     PARM           PTYPE                                               CLE034
     C                     PARM           PLNRF   6                                           CLE034
     C                     PARM           PVDAT   5                                           CLE034
     C                     PARM           PLASN   3                                           CLE034
     C                     PARM *BLANKS   FECUS   6                                           CLE034
     C                     PARM *BLANKS   FEFAC   5                                           CLE034
     C                     PARM *BLANKS   FESEQ   2                                           CLE034
     C                     PARM W#PYRC    PPYRC   1                                           CLE034
     C***********LESTAL    PARM *BLANKS   DSSDY                                       CLE034 BUG9175
     C           LESTAL    PARM *BLANKS   DSLDY                                              BUG9175
     C                     ENDIF                                                              CLE034
      *                                                                                       CLE034
     C           INSIND    IFEQ 5                                                             CLE034
     C                     MOVE LNRF      PLNRF                                               CLE034
     C                     CALL 'AOSTALR2'                                                    CLE034
     C                     PARM *BLANKS   STALCD  7                                           CLE034
     C                     PARM '*NEXT  ' POPTN   7                                           CLE034
     C                     PARM 'ROLL'    PTYPE   4                                           CLE034
     C                     PARM           PLNRF   6                                           CLE034
     C                     PARM *BLANKS   PVDAT   5                                           CLE034
     C                     PARM *BLANKS   PLASN   3                                           CLE034
     C                     PARM *BLANKS   FECUS   6                                           CLE034
     C                     PARM *BLANKS   FEFAC   5                                           CLE034
     C                     PARM *BLANKS   FESEQ   2                                           CLE034
     C                     PARM W#PYRC    PPYRC   1                                           CLE034
     C***********LESTAL    PARM *BLANKS   DSSDY                                       CLE034 BUG9175
     C           LESTAL    PARM *BLANKS   DSLDY                                              BUG9175
     C                     ENDIF                                                              CLE034
      *                                                                                       CLE034
     C           STALCD    IFEQ '*EOF'                                                        CLE034
     C                     MOVE 'Y'       WRKFLD                                              CLE034
     C                     ENDIF                                                              CLE034
      *                                                                                       CLE034
     C                     ENDIF                                                              CLE034
     C                     ENDSR                           ** SR34C **                        CLE034
      ********************************************************************                    CLE034
      * SR34D  - Set up fields from settlement allocation                *                    CLE034
      *                                                                  *                    CLE034
      * CALLED FROM: RECOUT                                              *                    CLE034
      *                                                                  *                    CLE034
      * CALLS: AOBRCHR0, LONXCY, LAMXCY                                  *                    CLE034
      *                                                                  *                    CLE034
      ********************************************************************                    CLE034
      *                                                                                       CLE034
     C           SR34D     BEGSR                           ** SR34D **                        CLE034
      *                                                                                       CLE034
     C           W#PYRC    IFEQ 'P'                                                           CLE034
     C                     MOVE PSTM      SETTYP                                              CLE034
     C                     MOVE PONS      SETAC                                               CLE034
     C                     MOVE POBR      STLBR                                               CLE034
     C                     MOVE PIBN      SETNOS                                              CLE034
     C                     ELSE                                                               CLE034
     C                     MOVE RSTM      SETTYP                                              CLE034
     C                     MOVE RONS      SETAC                                               CLE034
     C                     MOVE ROBR      STLBR                                               CLE034
     C                     MOVE RIBN      SETNOS                                              CLE034
     C                     ENDIF                                                              CLE034
      *                                                                                       CLE034
     C                     MOVE SCCY      WSCCY                                               CLE034
     C                     Z-ADDREXR      WREXR                                               CLE034
     C                     MOVE REXI      WREXI                                               CLE034
     C                     MOVE PSCY      WPSCY                                               CLE034
     C                     Z-ADDPEXR      WPEXR                                               CLE034
     C                     MOVE PEXI      WPEXI                                               CLE034
     C                     MOVE SCCY      WSCCYL                                              CLE034
     C                     Z-ADDREXR      WREXRL                                              CLE034
     C                     MOVE REXI      WREXIL                                              CLE034
     C                     MOVE PSCY      WPSCYL                                              CLE034
     C                     Z-ADDPEXR      WPEXRL                                              CLE034
     C                     MOVE PEXI      WPEXIL                                              CLE034
     C                     MOVE SCCY      WRRSC                                               CLE034
     C                     Z-ADDREXR      WRRSR                                               CLE034
     C                     MOVE REXI      WRRSI                                               CLE034
     C                     MOVE PSCY      WRPSC                                               CLE034
     C                     Z-ADDPEXR      WRPSR                                               CLE034
     C                     MOVE PEXI      WRPSI                                               CLE034
      *                                                                                       CLE034
     C           INSIND    IFEQ 1                          Start                              CLE034
     C                     MOVE 'S'       WSETTL                                              CLE034
     C                     EXSR LONXCY                                                        CLE034
     C                     ENDIF                                                              CLE034
      *                                                                                       CLE034
     C           INSIND    IFEQ 2                          Mature                             CLE034
     C           INSIND    OREQ 4                                                             CLE034
     C           *IN50     ANDEQ'0'                                                           CLE034
     C                     MOVE 'R'       WSETTL                                              CLE034
     C                     EXSR LONXCY                                                        CLE034
     C                     ENDIF                                                              CLE034
      *                                                                                       CLE034
     C           INSIND    IFEQ 3                                                             CLE034
     C           INSIND    OREQ 4                                                             CLE034
     C           *IN50     ANDEQ'1'                                                           CLE034
     C           AMTP      IFEQ 'PI'                                                          CLE034
     C                     MOVE 'S'       WSETTL                                              CLE034
     C                     ELSE                                                               CLE034
     C                     MOVE 'R'       WSETTL                                              CLE034
     C                     ENDIF                                                              CLE034
     C                     EXSR LAMXCY                                                        CLE034
     C                     ENDIF                                                              CLE034
      *                                                                                       CLE034
     C           INSIND    IFEQ 5                          Rollover                           CLE034
     C                     EXSR LONROL                                                        CLE034
     C           EVTYPE    IFNE 'I3'                                                          CLE034
     C                     MOVE 'R'       WSETTL                                              CLE034
     C                     ELSE                                                               CLE034
     C                     MOVE 'S'       WSETTL                                              CLE034
     C                     ENDIF                                                              CLE034
     C                     EXSR LONXCY                                                        CLE034
     C                     ENDIF                                                              CLE034
      *                                                                                       CLE034
     C           STLBR     IFEQ *BLANKS                                                       CLE034
     C                     MOVE BRCA      STLBR                                               CLE034
     C                     ENDIF                                                              CLE034
      *                                                                                       CLE034
     C           STLBR     IFNE *BLANKS                                                       CLE034
     C           STLBR     ANDNEBRCA                                                          CLE034
     C           SETTYP    ANDNE09                                                            218992
     C* Check whether details for Branch already in array                                     CSC042
     C                     MOVELSTLBR     ##KB                                                CSC042
     C                     EXSR ##CHKB                                                        CSC042
      * If branch is in the array then use the details                                        CSC042
     C           ##FIC     IFEQ 'Y'                        *** B10                            CSC042
     C                     EXSR ##SETB                                                        CSC042
     C                     ELSE                            *** X10                            CSC042
      * If branch is not in the array then get details from DB                                CSC042
     C**********           CALL 'AOBRCHR0'                                             CLE034 CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                                           CLE034
     C                     PARM '*KEY   ' @OPTN   7                                           CLE034
     C                     PARM STLBR     @DSNB   3                                           CLE034
     C********** SDBRCH    PARM SDBRCH    DSFDY                                        CLE034 CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
      *                                                                                       CLE034
     C           @RTCD     IFNE *BLANKS                                                       CLE034
     C***********SETTYP    ANDNE09                                                      CLE034218992
     C                     MOVEL@DSNB     DBKEY            ***************                    CLE034
     C                     MOVEL'SDBRCHPD'DBFILE           * DBERROR 50  *                    CLE034
     C                     Z-ADD50        DBASE            ***************                    CLE034
     C                     SETON                     U7U8LR                                   CLE034
     C                     EXSR *PSSR                                                         CLE034
     C                     GOTO END                                                           CLE034
     C                     ELSE                                                               CSC042
      * Details found on the DB so add them to the array                                      CSC042
      * if the array still has room                                                           CSC042
     C                     EXSR ##ADDB                                                        CSC042
     C                     END                                                                CLE034
     C                     ENDIF                           *** E10                            CSC042
     C                     MOVE CMPYM     SBCMPY                                              CLE034
     C                     ENDIF                                                              CLE034
      *                                                                                       CLE034
     C           CLE033    IFEQ '1'                                                           CLE034
     C           SETTYP    ANDEQ09                                                            CLE034
     C                     MOVE P@VL01    W0CNUM                                              CLE034
     C                     MOVE P@VL02    W0ACOD                                              CLE034
     C           W0CNUM    CAT  W0ACOD    SETAC                                               CLE034
     C                     MOVE '01'      SETAC                                               CLE034
     C                     ENDIF                                                              CLE034
      *                                                                                       CLE034
     C                     MOVE 'N'       FININD                                              CLE034
      *                                                                                       CLE034
     C           SETTYP    IFEQ 01                                                            CLE034
     C           SETTYP    OREQ 07                                                            CLE034
     C           SETTYP    OREQ 08                                                            CLE034
     C           SETAC     IFNE *BLANKS                                                       CLE034
     C           SETNOS    ANDNE*BLANKS                                                       CLE034
     C                     MOVE 'Y'       FININD                                              CLE034
     C                     ENDIF                                                              CLE034
     C                     ENDIF                                                              CLE034
      *                                                                                       CLE034
     C           SETTYP    IFEQ 05                                                            CLE034
     C           SETTYP    OREQ 14                                                            CLE034
     C           SETTYP    OREQ 02                                                            CLE034
     C           SETTYP    OREQ 12                                                            CLE034
     C           SETAC     IFNE *BLANKS                                                       CLE034
     C                     MOVE 'Y'       FININD                                              CLE034
     C                     ENDIF                                                              CLE034
     C                     ENDIF                                                              CLE034
      *                                                                                       CLE034
     C           CLE033    IFEQ 'Y'                                                           CLE034
     C           SETTYP    ANDEQ09                                                            CLE034
     C           SETAC     ANDNE*BLANKS                                                       CLE034
     C                     MOVE 'Y'       FININD                                              CLE034
     C                     ENDIF                                                              CLE034
      *                                                                                       218992
     C           INSIND    IFEQ 1                                                             218992
     C           INSIND    OREQ 2                                                             218992
     C           INSIND    OREQ 4                                                             218992
     C           *IN50     ANDEQ'0'                                                           218992
     C                     MOVELLOTS1     LOTA1                                               218992
     C                     MOVELLOTS2     LOTA2                                               218992
     C                     MOVELLOTS3     LOTA3                                               218992
     C                     MOVELLOTS4     LOTA4                                               218992
     C                     MOVELLOTS5     LOTA5                                               CGL029
     C                     MOVELRSCY      SCCY                                                218992
      *                                                                                       218992
     C           PTYP      IFEQ 66                                                            218992
     C           PTYP      OREQ 67                                                            218992
     C           PTYP      OREQ 69                                                            218992
     C           PTYP      OREQ 72                                                            218992
     C                     MOVELROBR      OSDB                                                218992
     C                     MOVELPOBR      OMDB                                                218992
     C                     ELSE                                                               218992
     C                     MOVELPOBR      OSDB                                                218992
     C                     MOVELROBR      OMDB                                                218992
     C                     ENDIF                                                              218992
     C                     ENDIF                                                              218992
      *                                                                                       218992
     C           INSIND    IFEQ 3                                                             218992
     C           INSIND    OREQ 4                                                             218992
     C           *IN50     ANDEQ'1'                                                           218992
     C                     MOVELLOTS1     LOTM1                                               218992
     C                     MOVELLOTS2     LOTM2                                               218992
     C                     MOVELLOTS3     LOTM3                                               218992
     C                     MOVELLOTS4     LOTM4                                               218992
     C                     MOVELLOTS5     LOTM5                                               CGL029
     C                     MOVELRSCY      SCCY                                                218992
     C                     MOVELPSCY      PSCYLA                                              218992
     C                     MOVELCVMR      CVMRLA                                              218992
     C                     Z-ADDREXR      REXRLA                                              218992
     C                     MOVELREXI      REXILA                                              218992
     C                     Z-ADDPEXR      PEXRLA                                              218992
     C                     MOVELPEXI      PEXILA                                              218992
      *                                                                                       218992
     C           PTYP      IFEQ 66                                                            218992
     C           PTYP      OREQ 67                                                            218992
     C           PTYP      OREQ 69                                                            218992
     C           PTYP      OREQ 72                                                            218992
     C                     MOVELPOBR      OSBR                                                218992
     C           AMTP      IFEQ 'PI'                                                          218992
     C                     MOVELROBR      OSBR                                                218992
     C                     ENDIF                                                              218992
     C                     ELSE                                                               218992
     C                     MOVELROBR      OSBR                                                218992
     C           AMTP      IFEQ 'PI'                                                          218992
     C                     MOVELPOBR      OSBR                                                218992
     C                     ENDIF                                                              218992
     C                     ENDIF                                                              218992
     C                     ENDIF                                                              218992
      *                                                                                       218992
     C           INSIND    IFEQ 5                                                             218992
     C                     MOVELLOTS1     LOTB1                                               218992
     C                     MOVELLOTS2     LOTB2                                               218992
     C                     MOVELLOTS3     LOTB3                                               218992
     C                     MOVELLOTS4     LOTB4                                               218992
     C                     MOVELLOTS5     LOTB5                                               CGL029
     C                     MOVELRSCY      RRSC                                                218992
     C                     MOVELPSCY      RPSC                                                218992
     C                     MOVELCVMR      RCVM                                                218992
     C                     Z-ADDREXR      RRSR                                                218992
     C                     MOVELREXI      RRSI                                                218992
     C                     Z-ADDPEXR      RPSR                                                218992
     C                     MOVELPEXI      RPSI                                                218992
     C                     MOVELROBR      RLBR                                                218992
     C                     MOVELPOBR      RLSB                                                218992
     C                     ENDIF                                                              218992
     C*                                                                                       221684
     C                     MOVELLOTS1     LOTX1                                               221684
     C                     MOVELLOTS2     LOTX2                                               221684
     C                     MOVELLOTS3     LOTX3                                               221684
     C                     MOVELLOTS4     LOTX4                                               221684
     C                     MOVELROBR      ROBRX                                               221684
     C                     MOVELRSCY      RSCYX                                               221684
     C                     Z-ADDREXR      REXRX                                               221684
     C                     MOVELREXI      REXIX                                               221684
     C                     MOVELPOBR      POBRX                                               221684
     C                     MOVELCVMR      CVMRX                                               221684
     C                     MOVELPSCY      PSCYX                                               221684
     C                     MOVELIC72      ICCYX                                               221684
     C                     Z-ADDPEXR      PEXRX                                               221684
     C                     MOVELPEXI      PEXIX                                               221684
     C*                                                                                       221684
     C                     MOVELLOTX1     TEMP2                                               221684
     C           TEMP2     IFEQ '  '                                                          221684
     C                     MOVEL'00'      LOTX1                                               221684
     C                     ENDIF                                                              221684
     C                     MOVELLOTX2     TEMP2                                               221684
     C           TEMP2     IFEQ '  '                                                          221684
     C                     MOVEL'00'      LOTX2                                               221684
     C                     ENDIF                                                              221684
      *                                                                                       CLE034
     C                     ENDSR                           ** SR34D **                        CLE034
      ********************************************************************                    CLE034
      * SR34E  - Restore original fields                                 *                    CLE034
      *                                                                  *                    CLE034
      * CALLED FROM: RECOUT                                              *                    CLE034
      *                                                                  *                    CLE034
      * CALLS:                                                           *                    CLE034
      *                                                                  *                    CLE034
      ********************************************************************                    CLE034
      *                                                                                       CLE034
     C           SR34E     BEGSR                           ** SR34E **                        CLE034
     C                     Z-ADDSAVAMT    EVAMNT                                              CLE034
     C                     MOVE SAVSET    SETTLE                                              CLE034
     C                     MOVE SVPSTM    PSTM                                                CLE034
     C                     MOVE SVPONS    PONS                                                CLE034
     C                     MOVE SVRSTM    RSTM                                                CLE034
     C                     MOVE SVRONS    RONS                                                CLE034
     C                     MOVE SVSCCY    WSCCY                                               CLE034
     C                     MOVE SVPSCY    WPSCY                                               CLE034
     C                     Z-ADDSVREXR    WREXR                                               CLE034
     C                     MOVE SVREXI    WREXI                                               CLE034
     C                     Z-ADDSVPEXR    WPEXR                                               CLE034
     C                     MOVE SVPEXI    WPEXI                                               CLE034
     C                     MOVE SVSCYL    WSCCYL                                              CLE034
     C                     MOVE SVPCYL    WPSCYL                                              CLE034
     C                     Z-ADDSVRXRL    WREXRL                                              CLE034
     C                     MOVE SVRXIL    WREXIL                                              CLE034
     C                     Z-ADDSVPXRL    WPEXRL                                              CLE034
     C                     MOVE SVPXIL    WPEXIL                                              CLE034
     C                     MOVE SVRRSC    WRRSC                                               CLE034
     C                     MOVE SVRPSC    WRPSC                                               CLE034
     C                     Z-ADDSVRRSR    WRRSR                                               CLE034
     C                     MOVE SVRRSI    WRRSI                                               CLE034
     C                     Z-ADDSVRPSR    WRPSR                                               CLE034
     C                     MOVE SVRPSI    WRPSI                                               CLE034
     C                     MOVE SVCMPY    SBCMPY                                              CLE034
     C                     MOVE SVFINI    FININD                                              CLE034
      *                                                                                       218992
     C                     MOVELSVOSDB    OSDB                                                218992
     C                     MOVELSVOMDB    OMDB                                                218992
     C                     MOVELSVOSBR    OSBR                                                218992
     C                     MOVELSVRLBR    RLBR                                                218992
     C                     MOVELSVRLSB    RLSB                                                218992
     C                     MOVELSVLTA1    LOTA1                                               218992
     C                     MOVELSVLTA2    LOTA2                                               218992
     C                     MOVELSVLTA3    LOTA3                                               218992
     C                     MOVELSVLTA4    LOTA4                                               218992
     C                     MOVELSVLTA5    LOTA5                                               CGL029
     C                     MOVELSVLTB1    LOTB1                                               218992
     C                     MOVELSVLTB2    LOTB2                                               218992
     C                     MOVELSVLTB3    LOTB3                                               218992
     C                     MOVELSVLTB4    LOTB4                                               218992
     C                     MOVELSVLTB5    LOTB5                                               CGL029
     C                     MOVELSVLTM1    LOTM1                                               218992
     C                     MOVELSVLTM2    LOTM2                                               218992
     C                     MOVELSVLTM3    LOTM3                                               218992
     C                     MOVELSVLTM4    LOTM4                                               218992
     C                     MOVELSVLTM5    LOTM5                                               CGL029
     C                     MOVELSVCVMR    CVMR                                                218992
     C                     MOVELSVCVMA    CVMRLA                                              218992
     C                     MOVELSVRCVM    RCVM                                                218992
     C                     Z-ADDSWREXR    REXR                                                218992
     C                     MOVELSWREXI    REXI                                                218992
     C                     Z-ADDSWPEXR    PEXR                                                218992
     C                     MOVELSWPEXI    PEXI                                                218992
     C                     Z-ADDSWRXRL    REXRLA                                              218992
     C                     MOVELSWRXIL    REXILA                                              218992
     C                     Z-ADDSWPXRL    PEXRLA                                              218992
     C                     MOVELSWPXIL    PEXILA                                              218992
     C                     Z-ADDSWRRSR    RRSR                                                218992
     C                     MOVELSWRRSI    RRSI                                                218992
     C                     Z-ADDSWRPSR    RPSR                                                218992
     C                     MOVELSWRPSI    RPSI                                                218992
     C                     MOVELSWSCCY    SCCY                                                218992
     C                     MOVELSWPSCY    PSCY                                                218992
     C                     MOVELSWPSYL    PSCYLA                                              218992
     C                     MOVELSWRRSC    RRSC                                                218992
     C                     MOVELSWRPSC    RPSC                                                218992
     C                     MOVELSVLTX1    LOTX1                                               221684
     C                     MOVELSVLTX2    LOTX2                                               221684
     C                     MOVELSVLTX3    LOTX3                                               221684
     C                     MOVELSVLTX4    LOTX4                                               221684
     C                     MOVELSROBRX    ROBRX                                               221684
     C                     MOVELSRSCYX    RSCYX                                               221684
     C                     Z-ADDSREXRX    REXRX                                               221684
     C                     MOVELSREXIX    REXIX                                               221684
     C                     MOVELSPOBRX    POBRX                                               221684
     C                     MOVELSCVMRX    CVMRX                                               221684
     C                     MOVELSPSCYX    PSCYX                                               221684
     C                     MOVELSIC72X    ICCYX                                               221684
     C                     Z-ADDSPEXRX    PEXRX                                               221684
     C                     MOVELSPEXIX    PEXIX                                               221684
      *                                                                                       CLE034
     C                     ENDSR                           ** SR34E **                        CLE034
     C*                                                                   S01117
     C* *PSSR  --- SUBROUTINE TO HANDLE ABNORMAL ERROR CONDITIONS         S01117
     C*                                                                   S01117
     C* CALLED FROM: AFTER ABNORNAL OPERATION OCCURS                      S01117
     C*                                                                   S01117
     C* CALLS: NOTHING                                                    S01117
     C*                                                                   S01117
     C********************************************************************S01117
     C*                                                                   S01117
     C           *PSSR     BEGSR                           ** *PSSR **    S01117
     C*                                                                   S01117
     C           @RUN      IFEQ *BLANKS                                   S01117
     C                     MOVE 'Y'       @RUN    1                       S01117
     C                     DUMP                                           S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C                     ENDSR                           ** *PSSR **    S01117
     C/EJECT                                                              CEU004
     C           XCAMT     BEGSR                                          CEU004
      *===================================================================CEU004
      * XCAMT: Convert Amount.                                            CEU004
      *                                                                   CEU004
      *-------------------------------------------------------------------CEU004
      *                                                                   CLE031
      ** Check if event ccy and EMU ccy are 'IN' ccys                     CLE031
     C           CLE031    IFEQ 'Y'                                       CLE031
     C                     MOVE CCY       XCCY                            CLE031
     C                     EXSR CCYDSP                                    CLE031
      *                                                                   CLE031
     C           *IN99     IFEQ *ON                                       CLE031
     C                     MOVEL'SDCURRPD'DBFILE                          CLE031
     C                     MOVELXCCY      DBKEY                           CLE031
     C                     Z-ADD58        DBASE                           CLE031
     C                     SETON                     U7U8LR               CLE031
     C                     ENDIF                                          CLE031
      *                                                                   CLE031
     C                     MOVE XINCY     EVINCY  1                       CLE031
     C                     Z-ADDXDECP     EVDP    10                      CLE031
      *                                                                   CLE031
     C                     MOVE EMUCCY    XCCY                            CLE031
     C                     EXSR CCYDSP                                    CLE031
      *                                                                   CLE031
     C           *IN99     IFEQ *ON                                       CLE031
     C                     MOVEL'SDCURRPD'DBFILE                          CLE031
     C                     MOVELXCCY      DBKEY                           CLE031
     C                     Z-ADD59        DBASE                           CLE031
     C                     SETON                     U7U8LR               CLE031
     C                     ENDIF                                          CLE031
      *                                                                   CLE031
     C                     MOVE XINCY     EMINCY  1                       CLE031
     C                     Z-ADDXDECP     EMDP    10                      CLE031
     C                     Z-ADDXDECP     EMUDP   10                      CLE031
     C                     MOVE *ON       *IN31                           CLE031
      *                                                                   CLE031
     C           EMINCY    IFEQ *BLANKS                                   CLE031
     C                     MOVE *OFF      *IN32                           CLE031
     C                     ENDIF                                          CLE031
      *                                                                   CLE031
     C                     ENDIF                                          CLE031
      *  Convert Transaction Amount into Settlement Amount.               CEU004
      *                                                                   CEU004
     C           CLE031    IFEQ 'N'                                       CLE031
     C           CLE031    OREQ 'Y'                                       CLE031
     C           EVINCY    ANDEQ'Y'                                       CLE031
     C           CLE031    OREQ 'Y'                                       CLE031
     C           EMINCY    ANDEQ'Y'                                       CLE031
     C                     CALL 'EU0200'                                  CEU004
      *                                                    Input:         CEU004
     C                     PARM *BLANKS   P@RTCD  7        -Return Code   CEU004
     C                     PARM           P@FRAM 183       -FROM Ccy Amt  CEU004
     C                     PARM           P@FRCY  3        -FROM Currency CEU004
     C                     PARM           P@TOCY  3        -TO Currency   CEU004
      *                                                    Output:        CEU004
     C                     PARM           P@OUTA 150       -Outright Amt  CEU004
     C                     PARM           P@INTA 183       -Interim Amt   CEU004
     C                     PARM           P@EXRT 159       -Exchange Rate CEU004
     C                     PARM           P@MDIN  1        -Mult/Div Ind. CEU004
      *                                                                   CEU004
     C           P@RTCD    IFNE *BLANKS                    If Error       CEU004
      *                                                                   CEU004
     C                     MOVEL'EU0200  'DBFILE            Set File      CEU004
     C                     MOVELP@FRCY    DBKEY             Set Key       CEU004
     C***********          Z-ADD31        DBASE             Set Ref       CEU004 147816
     C                     Z-ADD47        DBASE             Set Ref       147816
     C                     SETON                     U7U8LR Set Inds      CEU004
     C                     ENDIF                           End If         CEU004
     C                     ELSE                                           CLE031
      *                                                                   CLE031
     C                     Z-ADDEVAMNT    ZAMTCI                          CLE031
     C                     Z-ADDWEXCHR    ZEXCH                           CLE031
     C                     MOVE WMDIN     ZMD                             CLE031
     C                     MOVE CCY       ZCCYI                           CLE031
     C                     MOVE EMUCCY    ZCCYO                           CLE031
     C                     Z-ADDEVDP      ZCDPI                           CLE031
     C                     Z-ADDEMDP      ZCDPO                           CLE031
      *                                                                   CLE031
     C**********           CALL 'ZCONVZ1'                                            CLE031 CLE075AF
     C**********           PARM           ZAMTCI 150                                 CLE031 CLE075AF
     C**********           PARM           ZEXCH  138                                 CLE031 CLE075AF
     C**********           PARM           ZMD     1                                  CLE031 CLE075AF
     C**********           PARM           ZCCYI   3                                  CLE031 CLE075AF
     C**********           PARM           ZCCYO   3                                  CLE031 CLE075AF
     C**********           PARM           ZCDPI   10                                 CLE031 CLE075AF
     C**********           PARM           ZCDPO   10                                 CLE031 CLE075AF
     C**********           PARM           ZAMTCO 150                                 CLE031 CLE075AF
     C                     EXSR ZCONVN                                                      CLE075AF
     C                     ENDIF                                          CLE031
      *                                                                   CEU004
      *===================================================================CEU004
     C                     ENDSR                                          CEU004
      *****************************************************************   CLE031
      *                                                               *   CLE031
      * LONXCY - Set up loan settlement currency fields               *   CLE031
      *                                                               *   CLE031
      * Called by: START                                              *   CLE031
      *                                                               *   CLE031
      * Calls:                                                        *   CLE031
      *                                                               *   CLE031
      *****************************************************************   CLE031
     C           LONXCY    BEGSR                                          CLE031
      *                                                                   CLE031
     C           CLE033    IFEQ 'Y'                                                           218782
     C           SET09     ANDEQ'T'                                                           218782
     C           SETTYP    ANDEQ09                                                            218782
     C                     MOVE *BLANKS   EMUCCY                                              218782
     C                     ELSE                                                               218782
      *                                                                                       218782
     C           WSETTL    IFEQ 'S'                                       CLE031
      *                                                                   CLE031
      ** If loan or part purchased                                        CLE031
     C           PTYP      IFEQ 61                                        CLE031
     C           PTYP      OREQ 62                                        CLE031
     C           PTYP      OREQ 63                                        CLE031
     C           PTYP      OREQ 64                                        CLE031
     C           PTYP      OREQ 65                                        CLE031
     C           PTYP      OREQ 68                                        CLE031
     C           PTYP      OREQ 70                                        CLE031
     C           PTYP      OREQ 71                                        CLE031
     C           PTYP      OREQ 80                                        CLE031
     C                     MOVE WPSCY     EMUCCY                          CLE031
     C                     Z-ADDWPEXR     WEXCHR 138                      CLE031
     C                     MOVE WPEXI     WMDIN   1                       CLE031
     C                     ENDIF                                          CLE031
      *                                                                   CLE031
      ** If part sold                                                     CLE031
     C           PTYP      IFEQ 66                                        CLE031
     C           PTYP      OREQ 67                                        CLE031
     C           PTYP      OREQ 69                                        CLE031
     C           PTYP      OREQ 72                                        CLE031
     C                     MOVE WSCCY     EMUCCY                          CLE031
     C                     Z-ADDWREXR     WEXCHR                          CLE031
     C                     MOVE WREXI     WMDIN                           CLE031
     C                     ENDIF                                          CLE031
      *                                                                   CLE031
     C                     ENDIF                                          CLE031
      *                                                                   CLE031
     C           WSETTL    IFEQ 'R'                                       CLE031
      *                                                                   CLE031
      ** If loan or part purchased                                        CLE031
     C           PTYP      IFEQ 61                                        CLE031
     C           PTYP      OREQ 62                                        CLE031
     C           PTYP      OREQ 63                                        CLE031
     C           PTYP      OREQ 64                                        CLE031
     C           PTYP      OREQ 65                                        CLE031
     C           PTYP      OREQ 68                                        CLE031
     C           PTYP      OREQ 70                                        CLE031
     C           PTYP      OREQ 71                                        CLE031
     C           PTYP      OREQ 80                                        CLE031
     C                     MOVE WSCCY     EMUCCY                          CLE031
     C                     Z-ADDWREXR     WEXCHR                          CLE031
     C                     MOVE WREXI     WMDIN                           CLE031
     C                     ENDIF                                          CLE031
      *                                                                   CLE031
      ** If part sold                                                     CLE031
     C           PTYP      IFEQ 66                                        CLE031
     C           PTYP      OREQ 67                                        CLE031
     C           PTYP      OREQ 69                                        CLE031
     C           PTYP      OREQ 72                                        CLE031
     C                     MOVE WPSCY     EMUCCY                          CLE031
     C                     Z-ADDWPEXR     WEXCHR                          CLE031
     C                     MOVE WPEXI     WMDIN                           CLE031
     C                     ENDIF                                          CLE031
      *                                                                   CLE031
     C                     ENDIF                                          CLE031
     C                     ENDIF                                                              218782
      *                                                                                       218782
     C                     ENDSR                                          CLE031
      *****************************************************************   CLE031
      *                                                               *   CLE031
      * LAMXCY - Set up loan amendment settlement currency fields     *   CLE031
      *                                                               *   CLE031
      * Called by: AMEND                                              *   CLE031
      *                                                               *   CLE031
      * Calls:                                                        *   CLE031
      *                                                               *   CLE031
      *****************************************************************   CLE031
     C           LAMXCY    BEGSR                                          CLE031
      *                                                                   CLE031
     C           CLE033    IFEQ 'Y'                                                           218782
     C           SET09     ANDEQ'T'                                                           218782
     C           SETTYP    ANDEQ09                                                            218782
     C                     MOVE *BLANKS   EMUCCY                                              218782
     C                     ELSE                                                               218782
      *                                                                                       218782
     C           WSETTL    IFEQ 'S'                                       CLE031
      *                                                                   CLE031
      ** If loan or part purchased                                        CLE031
     C           PTYP      IFEQ 61                                        CLE031
     C           PTYP      OREQ 62                                        CLE031
     C           PTYP      OREQ 63                                        CLE031
     C           PTYP      OREQ 64                                        CLE031
     C           PTYP      OREQ 65                                        CLE031
     C           PTYP      OREQ 68                                        CLE031
     C           PTYP      OREQ 70                                        CLE031
     C           PTYP      OREQ 71                                        CLE031
     C           PTYP      OREQ 80                                        CLE031
     C                     MOVE WPSCYL    EMUCCY                          CLE031
     C                     Z-ADDWPEXRL    WEXCHR                          CLE031
     C                     MOVE WPEXIL    WMDIN                           CLE031
     C                     ENDIF                                          CLE031
      *                                                                   CLE031
      ** If part sold                                                     CLE031
     C           PTYP      IFEQ 66                                        CLE031
     C           PTYP      OREQ 67                                        CLE031
     C           PTYP      OREQ 69                                        CLE031
     C           PTYP      OREQ 72                                        CLE031
     C                     MOVE WSCCYL    EMUCCY                          CLE031
     C                     Z-ADDWREXRL    WEXCHR                          CLE031
     C                     MOVE WREXIL    WMDIN                           CLE031
     C                     ENDIF                                          CLE031
      *                                                                   CLE031
     C                     ENDIF                                          CLE031
      *                                                                   CLE031
     C           WSETTL    IFEQ 'R'                                       CLE031
      *                                                                   CLE031
      ** If loan or part purchased                                        CLE031
     C           PTYP      IFEQ 61                                        CLE031
     C           PTYP      OREQ 62                                        CLE031
     C           PTYP      OREQ 63                                        CLE031
     C           PTYP      OREQ 64                                        CLE031
     C           PTYP      OREQ 65                                        CLE031
     C           PTYP      OREQ 68                                        CLE031
     C           PTYP      OREQ 70                                        CLE031
     C           PTYP      OREQ 71                                        CLE031
     C           PTYP      OREQ 80                                        CLE031
     C                     MOVE WSCCYL    EMUCCY                          CLE031
     C                     Z-ADDWREXRL    WEXCHR                          CLE031
     C                     MOVE WREXIL    WMDIN                           CLE031
     C                     ENDIF                                          CLE031
      *                                                                   CLE031
      ** If part sold                                                     CLE031
     C           PTYP      IFEQ 66                                        CLE031
     C           PTYP      OREQ 67                                        CLE031
     C           PTYP      OREQ 69                                        CLE031
     C           PTYP      OREQ 72                                        CLE031
     C                     MOVE WPSCYL    EMUCCY                          CLE031
     C                     Z-ADDWPEXRL    WEXCHR                          CLE031
     C                     MOVE WPEXIL    WMDIN                           CLE031
     C                     ENDIF                                          CLE031
      *                                                                   CLE031
     C                     ENDIF                                          CLE031
     C                     ENDIF                                                              218782
      *                                                                                       218782
     C                     ENDSR                                          CLE031
      *****************************************************************   CLE031
      *                                                               *   CLE031
      * LONROL - Update loan settlement currency fields from rollover *   CLE031
      *          settlement currency fields                           *   CLE031
      *                                                               *   CLE031
      * Called by: ROLLVR                                             *   CLE031
      *                                                               *   CLE031
      * Calls:                                                        *   CLE031
      *                                                               *   CLE031
      *****************************************************************   CLE031
     C           LONROL    BEGSR                                          CLE031
      *                                                                   CLE031
     C           RRST      IFNE 0                                         CLE031
     C           RPST      ORNE 0                                         CLE031
     C                     MOVE WRPSC     WPSCY                           CLE031
     C                     MOVE WRPSR     WPEXR                           CLE031
     C                     MOVE WRPSI     WPEXI                           CLE031
     C                     MOVE WRRSC     WSCCY                           CLE031
     C                     MOVE WRRSR     WREXR                           CLE031
     C                     MOVE WRRSI     WREXI                           CLE031
     C                     ENDIF                                          CLE031
      *                                                                   CLE031
     C                     ENDSR                                          CLE031
     C********************************************************************S01117
      *                                                               *                       CLE038
      *  SR38A - Convert Allocations by Amount back to Loan Currency  *                       CLE038
      *                                                               *                       CLE038
      *****************************************************************                       CLE038
     C           SR38A     BEGSR                                                              CLE038
      *                                                                                       CLE038
      ** Put amount in Settlement currency into EMU amount field:                             CLE038
      *                                                                                       CLE038
     C                     Z-ADDEVAMNT    EMUAMT                                              CLE038
      *                                                                                       CLE038
      ** Check if current event ccy (settlement ccy)                                          CLE038
      ** and EMU ccy (really transaction ccy) are 'IN' ccys                                   CLE038
      *                                                                                       CLE038
     C           CLE031    IFEQ 'Y'                                                           CLE038
     C                     MOVE P@FRCY    XCCY                                                CLE038
     C                     EXSR CCYDSP                                                        CLE038
     C           *IN99     IFEQ *ON                                                           CLE038
     C                     MOVEL'SDCURRPD'DBFILE                                              CLE038
     C                     MOVELXCCY      DBKEY                                               CLE038
     C                     Z-ADD60        DBASE                                               CLE038
     C                     SETON                     U7U8LR                                   CLE038
     C                     ENDIF                                                              CLE038
      *                                                                                       CLE038
      ** Save details of From Currency (= PSCY or RSCY)                                       CLE038
      *                                                                                       CLE038
     C                     MOVE XINCY     EMINCY  1                                           CLE038
     C                     Z-ADDXDECP     EMDP    10                                          CLE038
     C                     Z-ADDXDECP     EMUDP   10                                          CLE038
     C           EMINCY    IFEQ *BLANKS                                                       CLE038
     C                     MOVE *OFF      *IN32                                               CLE038
     C                     ENDIF                                                              CLE038
     C                     MOVE P@TOCY    XCCY                                                CLE038
     C                     EXSR CCYDSP                                                        CLE038
     C           *IN99     IFEQ *ON                                                           CLE038
     C                     MOVEL'SDCURRPD'DBFILE                                              CLE038
     C                     MOVELXCCY      DBKEY                                               CLE038
     C                     Z-ADD61        DBASE                                               CLE038
     C                     SETON                     U7U8LR                                   CLE038
     C                     ENDIF                                                              CLE038
      *                                                                                       CLE038
      ** Save details of To Currency (= Loan Currency)                                        CLE038
      *                                                                                       CLE038
     C                     MOVE XINCY     EVINCY  1                                           CLE038
     C                     Z-ADDXDECP     EVDP    10                                          CLE038
     C                     MOVE *ON       *IN31                                               CLE038
     C                     ENDIF                                                              CLE038
      *                                                                                       CLE038
      ** Convert Settlement Amount into Transaction Amount.                                   CLE038
      *                                                                                       CLE038
     C           CLE031    IFEQ 'N'                                                           CLE038
     C           CLE031    OREQ 'Y'                                                           CLE038
     C           EVINCY    ANDEQ'Y'                                                           CLE038
     C           CLE031    OREQ 'Y'                                                           CLE038
     C           EMINCY    ANDEQ'Y'                                                           CLE038
     C                     CALL 'EU0200'                                                      CLE038
      *                                                                                       CLE038
      ** Input Parameters:                                                                    CLE038
      *                                                                                       CLE038
     C                     PARM *BLANKS   P@RTCD  7        -Return Code                       CLE038
     C                     PARM           P@FRAM 183       -From Ccy Amt                      CLE038
     C                     PARM           P@FRCY  3        -From Currency                     CLE038
     C                     PARM           P@TOCY  3        -To Currency                       CLE038
      *                                                                                       CLE038
      ** Output Parameters:                                                                   CLE038
      *                                                                                       CLE038
     C                     PARM           P@OUTA 150       -Outright amt                      CLE038
     C                     PARM           P@INTA 183       -Interuim                          CLE038
     C                     PARM           P@EXRT 159                                          CLE038
     C                     PARM           P@MDIN  1                                           CLE038
     C           P@RTCD    IFNE *BLANKS                                                       CLE038
     C                     MOVEL'EU0200'  DBFILE                                              CLE038
     C                     MOVELP@FRCY    DBKEY                                               CLE038
     C                     Z-ADD62        DBASE                                               CLE038
     C                     SETON                     U7U8LR                                   CLE038
     C                     ENDIF                                                              CLE038
     C                     ELSE                                                               CLE038
     C                     Z-ADDP@FRAM    ZAMTCI                                              CLE038
     C                     Z-ADDWEXCHR    ZEXCH                                               CLE038
     C           WMDIN     IFEQ 'D'                                                           CLE038
     C                     MOVE 'M'       ZMD                                                 CLE038
     C                     ELSE                                                               CLE038
     C                     MOVE 'D'       ZMD                                                 CLE038
     C                     ENDIF                                                              CLE038
     C                     MOVE P@FRCY    ZCCYI                                               CLE038
     C                     MOVE P@TOCY    ZCCYO                                               CLE038
     C                     Z-ADDEMDP      ZCDPI                                               CLE038
     C                     Z-ADDEVDP      ZCDPO                                               CLE038
     C**********           CALL 'ZCONVZ1'                                            CLE038 MD021155
     C**********           PARM           ZAMTCI 150                                 CLE038 MD021155
     C**********           PARM           ZEXCH  138                                 CLE038 MD021155
     C**********           PARM           ZMD     1                                  CLE038 MD021155
     C**********           PARM           ZCCYI   3                                  CLE038 MD021155
     C**********           PARM           ZCCYO   3                                  CLE038 MD021155
     C**********           PARM           ZCDPI   10                                 CLE038 MD021155
     C**********           PARM           ZCDPO   10                                 CLE038 MD021155
     C**********           PARM           ZAMTCO 150                                 CLE038 MD021155
     C                     EXSR ZCONVN                                                      MD021155
     C                     ENDIF                                                              CLE038
      *                                                                                       CLE038
      ** Put the amount which has been converted to                                           CLE038
      ** transaction currency into the Event Amount field:                                    CLE038
      *                                                                                       CLE038
     C           CLE031    IFEQ 'N'                                                           CLE038
     C           CLE031    OREQ 'Y'                                                           CLE038
     C           EVINCY    ANDEQ'Y'                                                           CLE038
     C           CLE031    OREQ 'Y'                                                           CLE038
     C           EMINCY    ANDEQ'Y'                                                           CLE038
     C                     MOVE P@OUTA    EVAMNT                                              CLE038
     C                     ELSE                                                               CLE038
     C                     MOVE ZAMTCO    EVAMNT                                              CLE038
     C                     ENDIF                                                              CLE038
      *                                                                                       CLE038
     C                     ENDSR                                                              CLE038
      /EJECT                                                                                  237466
      *****************************************************************                       237466
      *                                                               *                       237466
      *  SRSCUR - Subroutine to set correct currency depeding on the  *                       237466
      *           settlement type.                                    *                       237466
      *                                                               *                       237466
      *  Called By: INTRST - Process each forward repayment           *                       237466
      *             REPAY  - Write detail line                        *                       237466
      *                                                               *                       237466
      *****************************************************************                       237466
      *                                                                                       237466
     C           SRSCUR    BEGSR                                                              237466
      *                                                                                       237466
     C           MDST      IFEQ 01                                                            237466
     C           MDST      OREQ 07                                                            237466
     C           MDST      OREQ 08                                                            237466
     C           MDST      OREQ 02                                                            237466
     C           MDST      OREQ 12                                                            237466
     C                     MOVE CCY       ZCCY                                                237466
     C                     ELSE                                                               237466
     C                     MOVE BJLCCY    ZCCY                                                237466
     C                     ENDIF                                                              237466
      *                                                                                       237466
      ** If feature CEU004 is on, use settlement currency                                     237466
      ** if Settlement currency from the LOAN is not blank.                                   237466
      *                                                                                       237466
     C           CEU004    IFEQ 'Y'                                                           237466
     C           EMUCCY    ANDNE*BLANKS                                                       237466
     C                     MOVE EMUCCY    ZCCY                                                237466
     C                     ENDIF                                                              237466
      *                                                                                       237466
     C                     ENDSR                                                              237466
      *****************************************************************                       CLE038
      /EJECT                                                                                  CSC042
     C********************************************************************                    CSC042
      *                                                                                       CSC042
      * ##CHKB - Subroutine to check the Branch in the arrays                                 CSC042
      *                                                                                       CSC042
     C           ##CHKB    BEGSR                                                              CSC042
      *                                                                                       CSC042
     C           *LIKE     DEFN A8BRCD    ##KB                                                CSC042
      *                                                                                       CSC042
      * Set off the branch found indicator                                                    CSC042
     C                     MOVEL*BLANK    ##FIC   1                                           CSC042
      *                                                                                       CSC042
      * Save the state of indicator 30 so it can be reset at the end                          CSC042
      * of the SR as it may be used elsewhere in the code                                     CSC042
     C           *IN30     IFEQ *ON                                                           CSC042
     C                     MOVEL'Y'       #IN30   1                                           CSC042
     C                     ELSE                                                               CSC042
     C                     MOVEL'N'       #IN30                                               CSC042
     C                     ENDIF                                                              CSC042
      *                                                                                       CSC042
     C                     SETOF                         30                                   CSC042
      *                                                                                       CSC042
      * Restore the saved Value of B                                                          CSC042
     C                     Z-ADD##BSV     B                                                   CSC042
      *                                                                                       CSC042
     C* Check whether details for Branch already in array                                     CSC042
      *                                                                                       CSC042
      * Is this the same as the last LOKUP, if so we can bypass                               CSC042
      * the LOKUP                                                                             CSC042
      * Defend against B being 0                                                              CSC042
     C           B         IFEQ 0                                                             CSC042
     C                     Z-ADD1         B                                                   CSC042
     C                     ENDIF                                                              CSC042
      *                                                                                       CSC042
      * If the branch being checked is the same then use these                                CSC042
      * details rather than doing a LOKUP                                                     CSC042
     C           ##KB      IFEQ ##BR,B                                                        CSC042
      * Found so seton 30                                                                     CSC042
     C                     SETON                         30                                   CSC042
     C                     ELSE                                                               CSC042
     C                     Z-ADD1         B                                                   CSC042
     C           ##KB      LOKUP##BR,B                   30                                   CSC042
     C                     ENDIF                                                              CSC042
      *                                                                                       CSC042
      * Save the last update to B                                                             CSC042
     C           *IN30     IFEQ *ON                                                           CSC042
     C                     Z-ADDB         ##BSV                                               CSC042
      * Set the indicator to show the data was found                                          CSC042
     C                     MOVEL'Y'       ##FIC                                               CSC042
     C                     ENDIF                                                              CSC042
      *                                                                                       CSC042
      * Reset the state of indicator 30.                                                      CSC042
     C           #IN30     IFEQ 'Y'                                                           CSC042
     C                     MOVEL*ON       *IN30                                               CSC042
     C                     ELSE                                                               CSC042
     C                     MOVEL*OFF      *IN30                                               CSC042
     C                     ENDIF                                                              CSC042
      *                                                                                       CSC042
     C                     ENDSR                                                              CSC042
      ********************************************************************                    CSC042
      /EJECT                                                                                  CSC042
      ********************************************************************                    CSC042
      *                                                                                       CSC042
      * ##SETB - Sets up the SDBRCHPD fields used in the code from the                        CSC042
      * arrays                                                                                CSC042
      *                                                                                       CSC042
     C           ##SETB    BEGSR                                                              CSC042
      *                                                                                       CSC042
     C                     MOVEL##BR,B    A8BRCD                                              CSC042
     C                     MOVEL##BC,B    CMPYM                                               CSC042
     C                     MOVEL##BI,B    BICN                                                CSC042
      *                                                                                       CSC042
     C                     ENDSR                                                              CSC042
      *                                                                                       CSC042
      ********************************************************************                    CSC042
      /EJECT                                                                                  CSC042
      ********************************************************************                    CSC042
      *                                                                                       CSC042
      * ##ADDB - Adds the SDBRCHPD fields used in the code to the                             CSC042
      * arrays                                                                                CSC042
      *                                                                                       CSC042
     C           ##ADDB    BEGSR                                                              CSC042
      *                                                                                       CSC042
      * If there is still room in the array then add the details                              CSC042
     C           ##BNDX    IFLT 999                                                           CSC042
     C                     ADD  1         ##BNDX                                              CSC042
     C                     Z-ADD##BNDX    B                                                   CSC042
     C                     MOVELA8BRCD    ##BR,B                                              CSC042
     C                     MOVELCMPYM     ##BC,B                                              CSC042
     C                     MOVELBICN      ##BI,B                                              CSC042
     C                     ENDIF                                                              CSC042
      *                                                                                       CSC042
      * Update ##BSV  so next call to ##CHKB checks this latest adddition                     CSC042
      * to the array first                                                                    CSC042
     C                     Z-ADDB         ##BSV                                               CSC042
      *                                                                                       CSC042
     C                     ENDSR                                                              CSC042
      ********************************************************************                    CSC042
      /EJECT                                                                                  CSC042
      *****************************************************************                       CER049
      *                                                               *                       CER049
      *  SRSTAX - Generate Stamp tax event type 49ST                  *                       CER049
      *                                                               *                       CER049
      *****************************************************************                       CER049
      *                                                                                       CER049
     C           SRSTAX    BEGSR                                                              CER049
      *                                                                                       CER049
     C           CER049    IFEQ 'Y'                                                           CER049
     C           LQTAX     ANDEQ'Y'                                                           CER049
      *                                                                                       CER049
     C                     MOVE 'N'       STAX    1                                           CER049
     C                     MOVE 'N'       SBAL    1                                           CER049
     C           PTYP      IFEQ 61                                                            CER049
     C           EVCODE    ANDEQ'61I2'                                                        CER049
     C           EVCODE    ANDEQ'61X2'                                                        CER049
     C           EVCODE    ANDEQ'61M2'                                                        CER049
     C                     MOVE 'Y'       STAX                                                CER049
     C                     MOVE 'Y'       SBAL                                                CER049
     C                     ENDIF                                                              CER049
      *                                                                                       CER049
     C           PTYP      IFEQ 62                                                            CER049
     C           EVCODE    IFEQ '62V1'                                                        CER049
     C           EVCODE    OREQ '62V3'                                                        CER049
     C           EVCODE    OREQ '62I2'                                                        CER049
     C           EVCODE    OREQ '62X2'                                                        CER049
     C           EVCODE    OREQ '62M2'                                                        CER049
     C                     MOVE 'Y'       STAX                                                CER049
     C                     ENDIF                                                              CER049
     C                     ENDIF                                                              CER049
      *                                                                                       CER049
     C           PTYP      IFEQ 63                                                            CER049
     C           EVCODE    ANDEQ'63V1'                                                        CER049
     C           EVCODE    ANDEQ'63V2'                                                        CER049
     C                     MOVE 'Y'       STAX                                                CER049
     C                     ENDIF                                                              CER049
      *                                                                                       CER049
     C           PTYP      IFEQ 64                                                            CER049
     C           EVCODE    IFEQ '64V1'                                                        CER049
     C           EVCODE    OREQ '64V2'                                                        CER049
     C           EVCODE    OREQ '64I2'                                                        CER049
     C           EVCODE    OREQ '64X2'                                                        CER049
     C           EVCODE    OREQ '64M2'                                                        CER049
     C                     MOVE 'Y'       STAX                                                CER049
     C                     MOVE 'Y'       SBAL                                                CER049
     C                     ENDIF                                                              CER049
     C                     ENDIF                                                              CER049
      *                                                                                       CER049
     C           PTYP      IFEQ 65                                                            CER049
     C           EVCODE    ANDEQ'65V1'                                                        CER049
     C           EVCODE    ANDEQ'65V2'                                                        CER049
     C                     MOVE 'Y'       STAX                                                CER049
     C                     MOVE 'Y'       SBAL                                                CER049
     C                     ENDIF                                                              CER049
      *                                                                                       CER049
     C           PTYP      IFEQ 68                                                            CER049
     C           EVCODE    IFEQ '68V1'                                                        CER049
     C           EVCODE    OREQ '68V3'                                                        CER049
     C           EVCODE    OREQ '68I2'                                                        CER049
     C           EVCODE    OREQ '68X2'                                                        CER049
     C           EVCODE    OREQ '68M2'                                                        CER049
     C                     MOVE 'Y'       STAX                                                CER049
     C                     MOVE 'Y'       SBAL                                                CER049
     C                     ENDIF                                                              CER049
     C                     ENDIF                                                              CER049
      *                                                                                       CER049
     C           PTYP      IFEQ 70                                                            CER049
     C           EVCODE    IFEQ '70V1'                                                        CER049
     C           EVCODE    OREQ '70V3'                                                        CER049
     C           EVCODE    OREQ '70I2'                                                        CER049
     C           EVCODE    OREQ '70X2'                                                        CER049
     C           EVCODE    OREQ '70M2'                                                        CER049
     C                     MOVE 'Y'       STAX                                                CER049
     C                     ENDIF                                                              CER049
     C                     ENDIF                                                              CER049
      *                                                                                       CER049
     C           PTYP      IFEQ 71                                                            CER049
     C           EVCODE    IFEQ '71V1'                                                        CER049
     C           EVCODE    OREQ '71V3'                                                        CER049
     C           EVCODE    OREQ '71I2'                                                        CER049
     C           EVCODE    OREQ '71X2'                                                        CER049
     C           EVCODE    OREQ '71M2'                                                        CER049
     C                     MOVE 'Y'       STAX                                                CER049
     C                     MOVE 'Y'       SBAL                                                CER049
     C                     ENDIF                                                              CER049
     C                     ENDIF                                                              CER049
      *                                                                                       CER049
     C           PTYP      IFEQ 80                                                            CER049
     C           EVCODE    IFEQ '80V1'                                                        CER049
     C           EVCODE    OREQ '80X2'                                                        CER049
     C           EVCODE    OREQ '80M2'                                                        CER049
     C                     MOVE 'Y'       STAX                                                CER049
     C                     ENDIF                                                              CER049
     C                     ENDIF                                                              CER049
      *                                                                                       CER049
     C                     MOVE '1'       *IN79                                               CER049
     C           STAX      IFEQ 'Y'                                                           CER049
     C           EVTYPE    OREQ 'X3'                                                          CER049
     C                     MOVE 'N'       SIBRE   1                                           CER049
     C                     MOVE 'O'       SINOUT  1                                           CER049
     C                     MOVE *BLANKS   SSIAC   1                                           CER049
     C                     MOVE LQDCST    STDCST  6                                           CER049
     C                     EXSR CASTAX                                                        CER049
     C                     EXCPT                                                              CER049
     C                     EXSR WAUDIT                                                        CER049
      *                                                                                       CER049
      ** Generate inter branch events                                                         CER049
      *                                                                                       CER049
     C           LQDBRC    IFNE BRCA                                                          CER049
     C                     MOVE 'Y'       SIBRE                                               CER049
     C                     MOVE 'Y'       SSIAC                                               CER049
     C                     EXCPT                                                              CER049
     C                     EXSR WAUDIT                                                        CER049
     C                     MOVE BBICN     STDCST                                              CER049
     C                     MOVE *BLANKS   SACNO                                               CER049
     C                     MOVE *BLANKS   SSIAC                                               CER049
     C                     MOVE 'I'       SINOUT                                              CER049
     C                     EXCPT                                                              CER049
     C                     EXSR WAUDIT                                                        CER049
     C                     ENDIF                                                              CER049
     C                     ENDIF                                                              CER049
      *                                                                                       CER049
     C           LQAVBL    IFEQ 'Y'                                                           CER049
     C           SBAL      ANDEQ'Y'                                                           CER049
     C                     MOVE 'N'       SIBRE                                               CER049
     C                     MOVE 'O'       SINOUT                                              CER049
     C                     MOVE *BLANKS   SSIAC                                               CER049
     C                     MOVELLQSTAB    WSSTAX 130                                          CER049
     C                     EXCPT                                                              CER049
     C                     EXSR WAUDIT                                                        CER049
      *                                                                                       CER049
      ** Generate inter branch events                                                         CER049
      *                                                                                       CER049
     C           LQDBRC    IFNE BRCA                                                          CER049
      *                                                                                       CER049
     C                     MOVE 'Y'       SIBRE                                               CER049
     C                     MOVE 'Y'       SSIAC                                               CER049
     C                     EXCPT                                                              CER049
     C                     EXSR WAUDIT                                                        CER049
      *                                                                                       CER049
     C                     MOVE BBICN     LQDCST                                              CER049
     C                     MOVE *BLANKS   SACNO                                               CER049
     C                     MOVE *BLANKS   SSIAC                                               CER049
     C                     MOVE 'I'       SINOUT                                              CER049
     C                     EXCPT                                                              CER049
     C                     EXSR WAUDIT                                                        CER049
      *                                                                                       CER049
     C                     ENDIF                                                              CER049
     C                     ENDIF                                                              CER049
      *                                                                                       CER049
     C                     ENDIF                                                              CER049
     C                     MOVE '0'       *IN79                                               CER049
     C                     ENDSR                                                              CER049
      *                                                                                       CER049
      *****************************************************************                       CER049
      /EJECT                                                                                  CER049
      *****************************************************************                       CER049
      *                                                               *                       CER049
      *  CASTAX - Calculate Stamp tax amount                          *                       CER049
      *                                                               *                       CER049
      *****************************************************************                       CER049
      *                                                                                       CER049
     C           CASTAX    BEGSR                                                              CER049
      *                                                                                       CER049
     C                     CALL 'SD008141'                                                    CER049
     C                     PARM RUND      U#DATE  50                                          CER049
     C                     PARM 'LOAN'    U#ORGN 10                                           CER049
     C                     PARM LTYP      ##TYPE  4                                           CER049
     C                     PARM           U#CTAX 138                                          CER049
     C                     PARM           U#MTAX 138                                          CER049
     C                     PARM           U#CCCY  3                                           CER049
     C                     PARM           U#MCCY  3                                           CER049
     C                     PARM           U#CSCC  2                                           CER049
     C                     PARM           U#MSCC  2                                           CER049
     C                     PARM           U#TXTY  1                                           CER049
     C                     PARM           SDSTPD                                              CER049
      *                                                                                       CER049
      ** If there is a default for the Module use this tax rate and ccy                       CER049
      ** otherwise use the ICD Control defaults.                                              CER049
      *                                                                                       CER049
     C           U#MTAX    IFNE *ZEROS                                                        CER049
     C                     Z-ADDU#MTAX    U#TAXR 138                                          CER049
     C                     ELSE                                                               CER049
     C                     Z-ADDU#CTAX    U#TAXR                                              CER049
     C                     ENDIF                                                              CER049
      *                                                                                       CER049
     C           U#MTAX    IFNE *ZEROS                                                        CER049
     C           PTYP      IFEQ 62                                                            CER049
     C           PTYP      OREQ 63                                                            CER049
     C           PTYP      OREQ 70                                                            CER049
     C                     CALL 'SD008142'                                                    CER049
     C                     PARM *ZEROS    PVALD   60                                          CER049
     C                     PARM *ZEROS    PMATD   60                                          CER049
     C                     PARM           SDSTPD                                              CER049
     C                     PARM           U#TAXR                                              CER049
     C                     PARM *BLANKS   U#PERD  1                                           CER049
     C                     PARM 0         U#TXBR 138                                          CER049
     C                     PARM 0         U#MNTH  70                                          CER049
     C                     PARM           VDAT                                                CER049
     C                     PARM           MDAT                                                CER049
     C                     ENDIF                                                              CER049
     C                     ENDIF                                                              CER049
      *                                                                                       CER049
     C                     MOVE EVAMNT    WSTAX  150                                          CER049
     C           CCY       IFNE LQDCCY                                                        CER049
      *                                                                                       CER049
      ** Access stamp tax currency for decimal places                                         CER049
      *                                                                                       CER049
     C                     MOVE LQDCCY    XCCY                                                CER049
     C                     EXSR CCYDSP                                                        CER049
     C                     MOVE XDECP     NDP     10                                          CER049
     C                     MOVELXSPOT     ZRATE1 138                                          CER049
     C                     MOVELXMDIN     ZMDI1   1                                           CER049
      *                                                                                       CER049
      ** Access event currency for decimal places                                             CER049
      *                                                                                       CER049
     C                     MOVE CCY       XCCY                                                CER049
     C                     EXSR CCYDSP                                                        CER049
     C                     MOVELXSPOT     ZRATE2 138                                          CER049
     C                     MOVELXMDIN     ZMDI2   1                                           CER049
      *                                                                                       CER049
      ** Get exchange rate                                                                    CER049
      *                                                                                       CER049
     C                     EXSR RTZXRT                                                        CER049
      *                                                                                       CER049
     C                     Z-ADDZRATEX    ZEXCH                                               CER049
     C                     MOVE ZMDI1     ZMD                                                 CER049
     C                     Z-ADDWSTAX     ZAMTCI                                              CER049
     C                     Z-ADDXDECP     ZCDPI                                               CER049
     C                     Z-ADDNDP       ZCDPO                                               CER049
     C**********           CALL 'ZCONVZ1'                                            CER049 MD021155
     C**********           PARM           ZAMTCI 150                                 CER049 MD021155
     C**********           PARM           ZEXCH  138                                 CER049 MD021155
     C**********           PARM           ZMD     1                                  CER049 MD021155
     C**********           PARM           ZCCYI   3                                  CER049 MD021155
     C**********           PARM           ZCCYO   3                                  CER049 MD021155
     C**********           PARM           ZCDPI   10                                 CER049 MD021155
     C**********           PARM           ZCDPO   10                                 CER049 MD021155
     C**********           PARM           ZAMTCO 150                                 CER049 MD021155
     C                     EXSR ZCONVN                                                      MD021155
     C                     Z-ADDZAMTCO    WSTAX                                               CER049
     C                     ENDIF                                                              CER049
      *                                                                                       CER049
     C           WSTAX     MULT U#TAXR    WSSTAX                                              CER049
      *                                                                                       CER049
     C** Determine Customer Details                                                           CER049
      *                                                                                       CER049
     C                     MOVELLQDCST    CUSKEY                                              CER049
     C                     EXSR CUSCHN                                                        CER049
     C   55                Z-ADD33        DBASE                                               CER049
     C   55                EXSR *PSSR                                                         CER049
     C                     MOVE CSTDET    SCUSDE 38                                           CER049
     C                     MOVE '0'       WSPARI  1                                           CER049
     C           BBPAIN    IFEQ 'P'                                                           CER049
     C                     MOVE '1'       WSPARI                                              CER049
     C                     ENDIF                                                              CER049
      *                                                                                       CER049
     C** Determine Parent Details                                                             CER049
      *                                                                                       CER049
     C           BBPCNB    IFNE *BLANKS                                                       CER049
     C                     MOVELBBPCNB    CUSKEY                                              CER049
     C                     EXSR CUSCHN                                                        CER049
     C   55                Z-ADD34        DBASE                                               CER049
     C   55                EXSR *PSSR                                                         CER049
     C                     MOVE CSTDET    SPARDE 38                                           CER049
     C                     ENDIF                                                              CER049
      *                                                                                       CER049
      ** Determine Region of Domicile                                                         CER049
      *                                                                                       CER049
     C                     MOVE CLOC      XCRY                                                CER049
     C                     EXSR CRYDET                                                        CER049
     C   99                Z-ADD35        DBASE                                               CER049
     C   99                MOVE XCRY      DBKEY                                               CER049
     C   99                MOVE 'SDCTRYPD'DBFILE                                              CER049
     C   99                EXSR *PSSR                                                         CER049
      *                                                                                       CER049
     C                     MOVELCLOC      SDOMDE  4                                           CER049
     C                     MOVE XREGN     SDOMDE                                              CER049
      *                                                                                       CER049
     C                     MOVE LQDCST    @CNUM                                               CER049
     C                     MOVE LQDCCY    @CUCD                                               CER049
     C                     MOVE LQDACD    @ACCD                                               CER049
     C                     MOVE LQDASC    @ACSQ                                               CER049
     C                     MOVE LQDBRC    @BRCA                                               CER049
     C                     CALL 'AOACCTR0'                                                    CER049
     C                     PARM *BLANKS   @RTCD                                               CER049
     C                     PARM '*KEY   ' @OPTN                                               CER049
     C                     PARM *ZEROS    LQRETL 10                                           CER049
     C                     PARM           @CNUM   6                                           CER049
     C                     PARM           @CUCD   3                                           CER049
     C                     PARM           @ACCD  10                                           CER049
     C                     PARM           @ACSQ   2                                           CER049
     C                     PARM           @BRCA   3                                           CER049
     C           SDACCT    PARM SDACCT    DSSDY                                               CER049
      ** If error occured, terminate the program                                              CER049
     C           @RTCD     IFNE *BLANKS                                                       CER049
     C           @RTCD     ANDNE'*NRF   '                                                     CER049
     C           *LOCK     IN   LDA                                                           CER049
     C                     MOVEL'ACCNTAB 'DBFILE                                              CER049
     C                     MOVEL@OPTN     DBKEY                                               CER049
     C                     Z-ADD36        DBASE                                               CER049
     C                     EXSR *PSSR                                                         CER049
     C                     ENDIF                                                              CER049
     C                     MOVE *ZEROS    SSETYP                                              CER049
     C                     MOVEL*BLANKS   SACNO                                               CER049
     C           ATYP      IFEQ 'R'                                                           CER049
     C                     MOVE 14        SSETYP  20                                          CER049
     C                     MOVELACNO      SACNO  18                                           CER049
     C                     ENDIF                                                              CER049
     C*                                                                                       CER049
     C                     ENDSR                                                              CER049
      *****************************************************************                       CER049
      /EJECT                                                                                  CER049
      *****************************************************************                       CER049
     C           WAUDIT    BEGSR                                                              CER049
     C           COUNT2    ADD  1         COUNT2                                              CER049
     C                     Z-ADDHSHWN2    ZZTOTI                                              CER049
     C                     Z-ADDHSHDC2    ZZTOTD                                              CER049
     C           EVAMNT    DIV  1000      ZZAMT        83                                     CER049
     C   83                Z-SUBZZAMT     ZZAMT                                               CER049
     C                     EXSR GLZADD                                                        CER049
     C                     Z-ADDZZTOTI    HSHWN2                                              CER049
     C                     Z-ADDZZTOTD    HSHDC2                                              CER049
     C                     ENDSR                                                              CER049
      /EJECT                                                                                  CER049
      ********************************************************************                    CSC042
      *                                                               *                     CLE075AF
      *  *INZSR - Initial Subroutine                                  *                     CLE075AF
      *                                                               *                     CLE075AF
      *****************************************************************                     CLE075AF
     C           *INZSR    BEGSR                                                            CLE075AF
      *                                                                                     CLE075AF
      ** LRU element key and record arrival sequence                                        CLE075AF
      *                                                                                     CLE075AF
     C                     Z-ADD0         BSRKEY 130                                        CLE075AF
     C           *LIKE     DEFN BSRKEY    BSRSEQ                                            CLE075AF
     C                     Z-ADD0         YLCKEY 130                                        CLE075AF
     C           *LIKE     DEFN YLCKEY    YLCSEQ                                            CLE075AF
     C                     Z-ADD0         YLRKEY 130                                        CLE075AF
     C           *LIKE     DEFN YLRKEY    YLRSEQ                                            CLE075AF
     C                     Z-ADD0         NOSKEY 130                                        CLE075AF
     C           *LIKE     DEFN NOSKEY    NOSSEQ                                            CLE075AF
      *                                                                                     CLE075AF
      ** Set start index to upper limit of LRU Caching arrays                               CLE075AF
      *                                                                                     CLE075AF
     C                     Z-ADD300       BRTIDX  40                                        CLE075AF
     C           *LIKE     DEFN BRTIDX    BRTPRV                                            CLE075AF
     C           *LIKE     DEFN BRTIDX    C                                                 CLE075AF
     C                     Z-ADD100       YLCIDX  40                                        CLE075AF
     C           *LIKE     DEFN YLCIDX    YLCPRV                                            CLE075AF
     C           *LIKE     DEFN YLCIDX    D                                                 CLE075AF
     C                     Z-ADD300       YLRIDX  40                                        CLE075AF
     C           *LIKE     DEFN YLRIDX    YLRPRV                                            CLE075AF
     C           *LIKE     DEFN YLRIDX    E                                                 CLE075AF
     C                     Z-ADD200       NOSIDX  40                                        CLE075AF
     C           *LIKE     DEFN NOSIDX    NOSPRV                                            CLE075AF
     C           *LIKE     DEFN NOSIDX    F                                                 CLE075AF
      *                                                                                     CLE075AF
      ** Initialize work fields of LRU array routines                                       CLE075AF
      *                                                                                     CLE075AF
     C                     MOVE *BLANK    BRTIC   1                                         CLE075AF
     C                     MOVE *BLANK    YLCIC   1                                         CLE075AF
     C                     MOVE *BLANK    YLRIC   1                                         CLE075AF
     C                     MOVE *BLANK    NOSIC   1                                         CLE075AF
     C                     MOVE *BLANKS   KEYBAS  5                                         CLE075AF
     C                     MOVE *BLANKS   KEYYLC  5                                         CLE075AF
     C                     MOVE *BLANKS   KEYYLR  9                                         CLE075AF
     C                     MOVE *BLANKS   KEYNOS  5                                         CLE075AF
     C                     Z-ADD300       BRTPRV                                            CLE075AF
     C                     Z-ADD100       YLCPRV                                            CLE075AF
     C                     Z-ADD300       YLRPRV                                            CLE075AF
     C                     Z-ADD200       NOSPRV                                            CLE075AF
     C                     Z-ADD300       C                                                 CLE075AF
     C                     Z-ADD100       D                                                 CLE075AF
     C                     Z-ADD300       E                                                 CLE075AF
     C                     Z-ADD200       F                                                 CLE075AF
      *                                                                                     CLE075AF
     C                     ENDSR                                                            CLE075AF
      *****************************************************************                     CLE075AF
      *                                                               *                     CLE075AF
      *  CHKBRT - Check Base Rate details in array                    *                     CLE075AF
      *                                                               *                     CLE075AF
      *****************************************************************                     CLE075AF
     C           CHKBRT    BEGSR                                                            CLE075AF
      *                                                                                     CLE075AF
      ** Reinitialize work fields                                                           CLE075AF
      *                                                                                     CLE075AF
     C                     MOVEL*BLANK    BRTIC                                             CLE075AF
     C                     MOVE *OFF      *IN42                                             CLE075AF
     C           KEYBAS    IFNE *BLANKS                                                     CLE075AF
      *                                                                                     CLE075AF
      ** Check previous base rate details if it's                                           CLE075AF
      ** same with current details                                                          CLE075AF
      *                                                                                     CLE075AF
     C                     Z-ADDBRTPRV    C                                                 CLE075AF
      *                                                                                     CLE075AF
      ** Defend against index being 0                                                       CLE075AF
      ** Set current index to starting index                                                CLE075AF
      *                                                                                     CLE075AF
     C           C         IFEQ 0                                                           CLE075AF
     C                     Z-ADDBRTIDX    C                                                 CLE075AF
     C                     ENDIF                                                            CLE075AF
      *                                                                                     CLE075AF
      ** If the BRTKEY being checked is the same then use the index                         CLE075AF
      ** of the current detail rather than doing a LOKUP                                    CLE075AF
      *                                                                                     CLE075AF
     C           KEYBAS    IFEQ #BRK,C                                                      CLE075AF
     C                     MOVE *ON       *IN42                                             CLE075AF
     C                     ELSE                                                             CLE075AF
      *                                                                                     CLE075AF
     C           BRTIDX    IFEQ 0                                                           CLE075AF
     C                     Z-ADD1         C                                                 CLE075AF
     C                     ELSE                                                             CLE075AF
     C                     Z-ADDBRTIDX    C                                                 CLE075AF
     C                     ENDIF                                                            CLE075AF
      *                                                                                     CLE075AF
     C           KEYBAS    LOKUP#BRK,C                   42                                 CLE075AF
     C                     ENDIF                                                            CLE075AF
      *                                                                                     CLE075AF
      ** Save the last accessed detail to PRVIDX                                            CLE075AF
      ** Set the indicator to show the data was found                                       CLE075AF
      *                                                                                     CLE075AF
     C           *IN42     IFEQ *ON                                                         CLE075AF
     C                     MOVE BSRSEQ    #BRT,C                                            CLE075AF
     C                     Z-ADDC         BRTPRV                                            CLE075AF
     C                     MOVEL'Y'       BRTIC                                             CLE075AF
     C                     ENDIF                                                            CLE075AF
      *                                                                                     CLE075AF
     C                     ENDIF                                                            CLE075AF
     C                     ENDSR                                                            CLE075AF
      *****************************************************************                     CLE075AF
      *                                                               *                     CLE075AF
      *  ADDBRT - Add Base Rate details to array                      *                     CLE075AF
      *                                                               *                     CLE075AF
      *****************************************************************                     CLE075AF
     C           ADDBRT    BEGSR                                                            CLE075AF
      *                                                                                     CLE075AF
      ** If there is still room in the array then add the details                           CLE075AF
      *                                                                                     CLE075AF
     C           BRTIDX    IFNE 0                                                           CLE075AF
     C                     SUB  1         BRTIDX                                            CLE075AF
     C                     ENDIF                                                            CLE075AF
      *                                                                                     CLE075AF
     C                     MOVELKEYBAS    #BRK,C                                            CLE075AF
     C                     ADD  BSRSEQ    #BRT,C                                            CLE075AF
      *                                                                                     CLE075AF
      ** Set last accessed detail to BRTPRV So that CHKBRT checks this                      CLE075AF
      ** latest detail first                                                                CLE075AF
      *                                                                                     CLE075AF
     C                     Z-ADDC         BRTPRV                                            CLE075AF
      *                                                                                     CLE075AF
     C                     ENDSR                                                            CLE075AF
      *****************************************************************                     CLE075AF
      *                                                               *                     CLE075AF
      *  CHKYLC - Check Yield Curve details to array                  *                     CLE075AF
      *                                                               *                     CLE075AF
      *****************************************************************                     CLE075AF
     C           CHKYLC    BEGSR                                                            CLE075AF
      *                                                                                     CLE075AF
      ** Reinitialize work fields                                                           CLE075AF
      *                                                                                     CLE075AF
     C                     MOVEL*BLANK    YLCIC                                             CLE075AF
     C                     MOVE *OFF      *IN43                                             CLE075AF
     C           KEYYLC    IFNE *BLANKS                                                     CLE075AF
      *                                                                                     CLE075AF
      ** Check previous base rate details if it's                                           CLE075AF
      ** same with current details                                                          CLE075AF
      *                                                                                     CLE075AF
     C                     Z-ADDYLCPRV    D                                                 CLE075AF
      *                                                                                     CLE075AF
      ** Defend against index being 0                                                       CLE075AF
      ** Set current index to starting index                                                CLE075AF
      *                                                                                     CLE075AF
     C           D         IFEQ 0                                                           CLE075AF
     C                     Z-ADDYLCIDX    D                                                 CLE075AF
     C                     ENDIF                                                            CLE075AF
      *                                                                                     CLE075AF
      ** If the KEYYLC being checked is the same then use the index                         CLE075AF
      ** of the current detail rather than doing a LOKUP                                    CLE075AF
      *                                                                                     CLE075AF
     C           KEYYLC    IFEQ #YCK,D                                                      CLE075AF
     C                     MOVE *ON       *IN43                                             CLE075AF
     C                     ELSE                                                             CLE075AF
      *                                                                                     CLE075AF
     C           YLCIDX    IFEQ 0                                                           CLE075AF
     C                     Z-ADD1         D                                                 CLE075AF
     C                     ELSE                                                             CLE075AF
     C                     Z-ADDYLCIDX    D                                                 CLE075AF
     C                     ENDIF                                                            CLE075AF
      *                                                                                     CLE075AF
     C           KEYYLC    LOKUP#YCK,D                   43                                 CLE075AF
     C                     ENDIF                                                            CLE075AF
      *                                                                                     CLE075AF
      ** Save the last accessed detail to YLCPRV                                            CLE075AF
      ** Set the indicator to show the data was found                                       CLE075AF
      *                                                                                     CLE075AF
     C           *IN43     IFEQ *ON                                                         CLE075AF
     C                     MOVE YLCSEQ    #YLC,D                                            CLE075AF
     C                     Z-ADDD         YLCPRV                                            CLE075AF
     C                     MOVEL'Y'       YLCIC                                             CLE075AF
     C                     ENDIF                                                            CLE075AF
      *                                                                                     CLE075AF
     C                     ENDIF                                                            CLE075AF
     C                     ENDSR                                                            CLE075AF
      *****************************************************************                     CLE075AF
      *                                                               *                     CLE075AF
      *  ADDYLC - Add Yield Curve details to array                    *                     CLE075AF
      *                                                               *                     CLE075AF
      *****************************************************************                     CLE075AF
     C           ADDYLC    BEGSR                                                            CLE075AF
      *                                                                                     CLE075AF
      ** If there is still room in the array then add the details                           CLE075AF
      *                                                                                     CLE075AF
     C           YLCIDX    IFNE 0                                                           CLE075AF
     C                     SUB  1         YLCIDX                                            CLE075AF
     C                     ENDIF                                                            CLE075AF
      *                                                                                     CLE075AF
     C                     MOVELKEYYLC    #YCK,D                                            CLE075AF
     C                     ADD  YLCSEQ    #YLC,D                                            CLE075AF
      *                                                                                     CLE075AF
      ** Set last accessed detail to YLCPRV So that CHKYLC checks this                      CLE075AF
      ** latest detail first                                                                CLE075AF
      *                                                                                     CLE075AF
     C                     Z-ADDD         YLCPRV                                            CLE075AF
      *                                                                                     CLE075AF
     C                     ENDSR                                                            CLE075AF
      *****************************************************************                     CLE075AF
      *                                                               *                     CLE075AF
      *  CHKYLR - Check Yield Rate details in array                   *                     CLE075AF
      *                                                               *                     CLE075AF
      *****************************************************************                     CLE075AF
     C           CHKYLR    BEGSR                                                            CLE075AF
      *                                                                                     CLE075AF
      ** Reinitialize work fields                                                           CLE075AF
      *                                                                                     CLE075AF
     C                     MOVEL*BLANK    YLRIC                                             CLE075AF
     C                     MOVE *OFF      *IN44                                             CLE075AF
     C           KEYYLR    IFNE *BLANKS                                                     CLE075AF
      *                                                                                     CLE075AF
      ** Check previous base rate details if it's                                           CLE075AF
      ** same with current details                                                          CLE075AF
      *                                                                                     CLE075AF
     C                     Z-ADDYLRPRV    E                                                 CLE075AF
      *                                                                                     CLE075AF
      ** Defend against index being 0                                                       CLE075AF
      ** Set current index to starting index                                                CLE075AF
      *                                                                                     CLE075AF
     C           E         IFEQ 0                                                           CLE075AF
     C                     Z-ADDYLRIDX    E                                                 CLE075AF
     C                     ENDIF                                                            CLE075AF
      *                                                                                     CLE075AF
      ** If the KEYYLR being checked is the same then use the index                         CLE075AF
      ** of the current detail rather than doing a LOKUP                                    CLE075AF
      *                                                                                     CLE075AF
     C           KEYYLR    IFEQ #YRK,E                                                      CLE075AF
     C                     MOVE *ON       *IN44                                             CLE075AF
     C                     ELSE                                                             CLE075AF
      *                                                                                     CLE075AF
     C           YLRIDX    IFEQ 0                                                           CLE075AF
     C                     Z-ADD1         E                                                 CLE075AF
     C                     ELSE                                                             CLE075AF
     C                     Z-ADDYLRIDX    E                                                 CLE075AF
     C                     ENDIF                                                            CLE075AF
      *                                                                                     CLE075AF
     C           KEYYLR    LOKUP#YRK,E                   44                                 CLE075AF
     C                     ENDIF                                                            CLE075AF
      *                                                                                     CLE075AF
      ** Save the last accessed detail to YLRPRV                                            CLE075AF
      ** Set the indicator to show the data was found                                       CLE075AF
      *                                                                                     CLE075AF
     C           *IN44     IFEQ *ON                                                         CLE075AF
     C                     MOVE YLRSEQ    #YLR,E                                            CLE075AF
     C                     Z-ADDE         YLRPRV                                            CLE075AF
     C                     MOVEL'Y'       YLRIC                                             CLE075AF
     C                     ENDIF                                                            CLE075AF
      *                                                                                     CLE075AF
     C                     ENDIF                                                            CLE075AF
     C                     ENDSR                                                            CLE075AF
      *****************************************************************                     CLE075AF
      *                                                               *                     CLE075AF
      *  ADDYLR - Add Yield Rate details to array                     *                     CLE075AF
      *                                                               *                     CLE075AF
      *****************************************************************                     CLE075AF
     C           ADDYLR    BEGSR                                                            CLE075AF
      *                                                                                     CLE075AF
      ** If there is still room in the array then add the details                           CLE075AF
      *                                                                                     CLE075AF
     C           YLRIDX    IFNE 0                                                           CLE075AF
     C                     SUB  1         YLRIDX                                            CLE075AF
     C                     ENDIF                                                            CLE075AF
      *                                                                                     CLE075AF
     C                     MOVELKEYYLR    #YRK,E                                            CLE075AF
     C                     ADD  YLRSEQ    #YLR,E                                            CLE075AF
      *                                                                                     CLE075AF
      ** Set last accessed detail to YLRPRV So that CHKYLR checks this                      CLE075AF
      ** latest detail first                                                                CLE075AF
      *                                                                                     CLE075AF
     C                     Z-ADDE         YLRPRV                                            CLE075AF
      *                                                                                     CLE075AF
     C                     ENDSR                                                            CLE075AF
      *****************************************************************                     CLE075AF
      *                                                               *                     CLE075AF
      *  CHKNOS - Check Nostro details in array                       *                     CLE075AF
      *                                                               *                     CLE075AF
      *****************************************************************                     CLE075AF
     C           CHKNOS    BEGSR                                                            CLE075AF
      *                                                                                     CLE075AF
      ** Reinitialize work fields                                                           CLE075AF
      *                                                                                     CLE075AF
     C                     MOVEL*BLANK    NOSIC                                             CLE075AF
     C                     MOVE *OFF      *IN45                                             CLE075AF
     C           KEYNOS    IFNE *BLANKS                                                     CLE075AF
      *                                                                                     CLE075AF
      ** Check previous base rate details if it's                                           CLE075AF
      ** same with current details                                                          CLE075AF
      *                                                                                     CLE075AF
     C                     Z-ADDNOSPRV    F                                                 CLE075AF
      *                                                                                     CLE075AF
      ** Defend against index being 0                                                       CLE075AF
      ** Set current index to starting index                                                CLE075AF
      *                                                                                     CLE075AF
     C           F         IFEQ 0                                                           CLE075AF
     C                     Z-ADDNOSIDX    F                                                 CLE075AF
     C                     ENDIF                                                            CLE075AF
      *                                                                                     CLE075AF
      ** If the KEYNOS being checked is the same then use the index                         CLE075AF
      ** of the current detail rather than doing a LOKUP                                    CLE075AF
      *                                                                                     CLE075AF
     C           KEYNOS    IFEQ #NSK,F                                                      CLE075AF
     C                     MOVE *ON       *IN45                                             CLE075AF
     C                     ELSE                                                             CLE075AF
      *                                                                                     CLE075AF
     C           NOSIDX    IFEQ 0                                                           CLE075AF
     C                     Z-ADD1         F                                                 CLE075AF
     C                     ELSE                                                             CLE075AF
     C                     Z-ADDNOSIDX    F                                                 CLE075AF
     C                     ENDIF                                                            CLE075AF
      *                                                                                     CLE075AF
     C           KEYNOS    LOKUP#NSK,F                   45                                 CLE075AF
     C                     ENDIF                                                            CLE075AF
      *                                                                                     CLE075AF
      ** Save the last accessed detail to NOSPRV                                            CLE075AF
      ** Set the indicator to show the data was found                                       CLE075AF
      *                                                                                     CLE075AF
     C           *IN45     IFEQ *ON                                                         CLE075AF
     C                     MOVE NOSSEQ    #NOS,F                                            CLE075AF
     C                     Z-ADDF         NOSPRV                                            CLE075AF
     C                     MOVEL'Y'       NOSIC                                             CLE075AF
     C                     ENDIF                                                            CLE075AF
      *                                                                                     CLE075AF
     C                     ENDIF                                                            CLE075AF
     C                     ENDSR                                                            CLE075AF
      *****************************************************************                     CLE075AF
      *                                                               *                     CLE075AF
      *  ADDNOS - Add Nostro details to array                         *                     CLE075AF
      *                                                               *                     CLE075AF
      *****************************************************************                     CLE075AF
     C           ADDNOS    BEGSR                                                            CLE075AF
      *                                                                                     CLE075AF
      ** If there is still room in the array then add the details                           CLE075AF
      *                                                                                     CLE075AF
     C           NOSIDX    IFNE 0                                                           CLE075AF
     C                     SUB  1         NOSIDX                                            CLE075AF
     C                     ENDIF                                                            CLE075AF
      *                                                                                     CLE075AF
     C                     MOVELKEYNOS    #NSK,F                                            CLE075AF
     C                     ADD  NOSSEQ    #NOS,F                                            CLE075AF
      *                                                                                     CLE075AF
      ** Set last accessed detail to NOSPRV So that CHKNOS checks this                      CLE075AF
      ** latest detail first                                                                CLE075AF
      *                                                                                     CLE075AF
     C                     Z-ADDF         NOSPRV                                            CLE075AF
      *                                                                                     CLE075AF
     C                     ENDSR                                                            CLE075AF
      *****************************************************************                     MD021605
     C/EJECT                                                                                MD021605
      *****************************************************************                     MD021605
      *                                                               *                     MD021605
      *    CTRAIL - Calculate record for LELWNEZ1                     *                     MD021605
      *    Called by: Main processing                                 *                     MD021605
      *    Calls: PDZADD                                              *                     MD021605
      *                                                               *                     MD021605
      *****************************************************************                     MD021605
     C           CTRAIL    BEGSR                                                            MD021605
      *                                                                                     MD021605
      ***  Access trailer record                                                            MD021605
      *                                                                                     MD021605
     C                     MOVE 'Z'       WEPAR                                             MD021605
     C                     MOVE '999999'  WALON                                             MD021605
     C                     MOVE '999999Z' WLTRL   7                                         MD021605
     C           WKLON     CHAINCLOANE               89                                     MD021605
      *                                                                                     MD021605
      ** Insert trailer record for LELWNEZ1                                                 MD021605
      *                                                                                     MD021605
     C           *IN89     IFEQ '1'                                                         MD021605
     C           WIN89     ANDEQ'1'                                                         MD021605
     C*                    CLEARLELWNEZF                                                    MD021605
     C                     MOVE '0'       WIN89                                             MD021605
     C                     MOVE 'T'       PDRECI  1                                         MD021605
     C                     MOVE '999999'  PDLNRF  6                                         MD021605
     C                     MOVE 'Z'       PDRCDT  1                                         MD021605
      *                                                                                     MD021605
      ***  Set up amount fields for insert                                                  MD021605
      *                                                                                     MD021605
     C           CPAM      DIV  1000      ZZAMT  153                                        MD021605
     C           ZZAMT     IFLT *ZEROS                                                      MD021605
     C                     Z-SUBZZAMT     ZZAMT                                             MD021605
     C                     ENDIF                                                            MD021605
      *                                                                                     MD021605
     C                     Z-ADDPDVRIF    ZZTOTI                                            MD021605
     C                     Z-ADDPDVRIL    ZZTOTD                                            MD021605
     C                     EXSR PDZADD                                                      MD021605
     C                     Z-ADDZZTOTI    PDVRIF 150                                        MD021605
     C                     Z-ADDZZTOTD    PDVRIL  30                                        MD021605
     C           CPAM      DIV  1000      ZZAMT                                             MD021605
     C           ZZAMT     IFLT *ZEROS                                                      MD021605
     C                     Z-SUBZZAMT     ZZAMT                                             MD021605
     C                     ENDIF                                                            MD021605
      *                                                                                     MD021605
     C                     Z-ADDPDVLAF    ZZTOTI                                            MD021605
     C                     Z-ADDPDVLAL    ZZTOTD                                            MD021605
     C                     EXSR PDZADD                                                      MD021605
     C                     Z-ADDZZTOTI    PDVLAF 150                                        MD021605
     C                     Z-ADDZZTOTD    PDVLAL  30                                        MD021605
      *                                                                                     MD021605
     C                     Z-ADD3         PDNORE  50                                        MD021605
     C                     Z-ADD2         PDNINS  50                                        MD021605
     C                     Z-ADD3         PZNLRA                                            MD021605
     C                     Z-ADDRUND      PDLCD   50                                        MD021605
     C                     MOVE 'I'       PDCHTP  1                                         MD021605
     C                     Z-ADD1         PZTNLU  50                                        MD021605
      *                                                                                     MD021605
     C                     ELSE                                                             MD021605
      *                                                                                     MD021605
      ***  Set up amount fields for insert                                                  MD021605
      *                                                                                     MD021605
     C           CPAM      DIV  1000      ZZAMT  153                                        MD021605
     C           ZZAMT     IFLT *ZEROS                                                      MD021605
     C                     Z-SUBZZAMT     ZZAMT                                             MD021605
     C                     ENDIF                                                            MD021605
      *                                                                                     MD021605
     C                     Z-ADDPDVRIF    ZZTOTI                                            MD021605
     C                     Z-ADDPDVRIL    ZZTOTD                                            MD021605
     C                     EXSR PDZADD                                                      MD021605
     C                     Z-ADDZZTOTI    PDVRIF                                            MD021605
     C                     Z-ADDZZTOTD    PDVRIL                                            MD021605
     C           CPAM      DIV  1000      ZZAMT                                             MD021605
     C           ZZAMT     IFLT *ZEROS                                                      MD021605
     C                     Z-SUBZZAMT     ZZAMT                                             MD021605
     C                     ENDIF                                                            MD021605
      *                                                                                     MD021605
     C                     Z-ADDPDVLAF    ZZTOTI                                            MD021605
     C                     Z-ADDPDVLAL    ZZTOTD                                            MD021605
     C                     EXSR PDZADD                                                      MD021605
     C                     Z-ADDZZTOTI    PDVLAF                                            MD021605
     C                     Z-ADDZZTOTD    PDVLAL                                            MD021605
      *                                                                                     MD021605
      ***  Set up relevant total fields                                                     MD021605
      *                                                                                     MD021605
     C                     ADD  2         PDNORE                                            MD021605
     C                     ADD  2         PDNINS                                            MD021605
     C                     ADD  2         PZNLRA                                            MD021605
     C                     Z-ADDRUND      PDLCD                                             MD021605
     C                     MOVE 'U'       PDCHTP                                            MD021605
     C                     ADD  1         PZTNLU                                            MD021605
     C                     ENDIF                                                            MD021605
      *                                                                                     MD021605
     C                     ENDSR                                                            MD021605
      *****************************************************************                     MD021605
      /EJECT                                                                                MD021605
      *****************************************************************                     MD021605
      *   PDZADD - Adds an amount (ZZAMT) to the total (ZZTOTI,ZZTOTD)*                     MD021605
      *   Called by: CTRAIL                                           *                     MD021605
      *   Calls: PDZSUM                                               *                     MD021605
      *****************************************************************                     MD021605
     C           PDZADD    BEGSR                                                            MD021605
      *                                                                                     MD021605
     C           ZZAMT     IFNE *ZERO                                                       MD021605
      *                                                                                     MD021605
      ***  Split ZZAMT into integer and decimal fields                                      MD021605
      *                                                                                     MD021605
     C                     Z-ADDZZAMT     ZZAMTI 150                                        MD021605
     C                     MOVE ZZAMT     ZZAMTD  30                                        MD021605
      *                                                                                     MD021605
      ***  Both ZZAMTI and ZZAMTD contain a 'sign' zone now                                 MD021605
      *                                                                                     MD021605
     C                     EXSR PDZSUM                                                      MD021605
     C                     ENDIF                                                            MD021605
      *                                                                                     MD021605
     C                     ENDSR                                                            MD021605
      ****************************************************************                      MD021605
      /EJECT                                                                                MD021605
      *****************************************************************                     MD021605
      *   PDZSUM - Carries out the addition of the amounts            *                     MD021605
      *   Called by: PDZSUM                                           *                     MD021605
      *   Calls: None                                                 *                     MD021605
      *****************************************************************                     MD021605
     C           PDZSUM    BEGSR                                                            MD021605
      *                                                                                     MD021605
      ***  Save values of indicators to be used in the program                              MD021605
      *                                                                                     MD021605
     C                     MOVE *IN91     WIN91   1                                         MD021605
     C                     MOVE *IN92     WIN92   1                                         MD021605
     C                     MOVE *IN93     WIN93   1                                         MD021605
     C                     MOVE *IN94     WIN94   1                                         MD021605
     C                     MOVE *IN95     WIN95   1                                         MD021605
     C                     MOVE *IN96     WIN96   1                                         MD021605
     C                     SETOF                     919293                                 MD021605
     C                     SETOF                     949599                                 MD021605
      *                                                                                     MD021605
      ***  Determine sign of ZZAMTI and ZZAMTD, 92 if neg                                   MD021605
      *                                                                                     MD021605
     C           ZZAMTI    COMP 0                      9293                                 MD021605
     C   93      ZZAMTD    COMP 0                      9293                                 MD021605
     C   93                GOTO PDSEND                                                      MD021605
      *                                                                                     MD021605
      ***  Determine sign of ZZTOTI and ZZTOTD, 91 if neg                                   MD021605
      *                                                                                     MD021605
     C           ZZTOTI    COMP 0                      9193                                 MD021605
     C   93      ZZTOTD    COMP 0                      9193                                 MD021605
      *                                                                                     MD021605
      ***  If ZZTOTAL is zero, return ZZAMOUNT                                              MD021605
      *                                                                                     MD021605
     C   93                Z-ADDZZAMTI    ZZTOTI 150                                        MD021605
     C   93                Z-ADDZZAMTD    ZZTOTD  30                                        MD021605
     C   93                GOTO PDSEND                                                      MD021605
      *                                                                                     MD021605
      ***  If signs differ, bypass overflow checks                                          MD021605
      *                                                                                     MD021605
     C   91                                                                                 MD021605
     CANN92                                                                                 MD021605
     CORN91                                                                                 MD021605
     CAN 92                GOTO PDOFPS                                                      MD021605
      *                                                                                     MD021605
     C           ZZAMTD    ADD  ZZTOTD    ZZWK2   40                                        MD021605
     C           ZZWK2     COMP 999                  93                                     MD021605
     C  N93      ZZWK2     COMP -999                   93                                   MD021605
     C*                                                                                     MD021605
     C   93                                                                                 MD021605
     CANN92      ZZAMTI    ADD  1         ZZWK3  150                                        MD021605
     C   93                                                                                 MD021605
     CAN 92      ZZAMTI    SUB  1         ZZWK3                                             MD021605
     C   93      ZZTOTI    ADD  ZZWK3     ZZWK3                                             MD021605
     C  N93      ZZTOTI    ADD  ZZAMTI    ZZWK3                                             MD021605
      *                                                                                     MD021605
      ***  If the modulus of ZZWK3 is lt mod. ZZTOTI then O/F has occured                   MD021605
      *                                                                                     MD021605
     C  N92      ZZWK3     COMP ZZTOTI                 99                                   MD021605
     C   92      ZZWK3     COMP ZZTOTI               99                                     MD021605
     C  N99                Z-ADDZZWK2     ZZTOTD                                            MD021605
     C  N99                Z-ADDZZWK3     ZZTOTI                                            MD021605
      *                                                                                     MD021605
      ***  If O/F zeroise ZZAMT, Ind '99' set and ZZTOT fields left intact                  MD021605
      *                                                                                     MD021605
     C   99                Z-ADD0         ZZAMT  153                                        MD021605
     C                     GOTO PDSEND                                                      MD021605
      *                                                                                     MD021605
      ***  The 'signs' are different                                                        MD021605
      *                                                                                     MD021605
     C           PDOFPS    TAG                                                              MD021605
      *                                                                                     MD021605
      ***  If ZZAMT was negative, make it pos. to como with ZZTOT                           MD021605
      *                                                                                     MD021605
     C   92                Z-SUBZZAMTI    ZZAMTI 150                                        MD021605
     C   92                Z-SUBZZAMTD    ZZAMTD  30                                        MD021605
      *                                                                                     MD021605
      ***  If ZZTOT was negative, make it pos. to comp with ZZAMT.                          MD021605
      *                                                                                     MD021605
     C   91                Z-SUBZZTOTI    ZZTOTI                                            MD021605
     C   91                Z-SUBZZTOTD    ZZTOTD                                            MD021605
      *                                                                                     MD021605
      ***  Both ZZAMT and ZZTOT are now positive                                            MD021605
      *                                                                                     MD021605
     C           ZZTOTI    COMP ZZAMTI               93  95                                 MD021605
     C   95      ZZTOTD    COMP ZZAMTD               93  95                                 MD021605
      *                                                                                     MD021605
      ***  If ZZTOT eq. ZZAMT return ZERO.                                                  MD021605
      *                                                                                     MD021605
     C   95                Z-ADD0         ZZTOTI                                            MD021605
     C   95                Z-ADD0         ZZTOTD                                            MD021605
     C   95                GOTO PDSEND                                                      MD021605
      *                                                                                     MD021605
      ***  If ZZTOT gt. ZZAMT.                                                              MD021605
      *                                                                                     MD021605
     C   93      ZZAMTD    COMP ZZTOTD               94                                     MD021605
     C   93                                                                                 MD021605
     CAN 94      ZZTOTI    SUB  1         ZZTOTI                                            MD021605
     C   93                                                                                 MD021605
     CAN 94      ZZTOTD    ADD  1000      ZZWK2                                             MD021605
     C   93      ZZTOTI    SUB  ZZAMTI    ZZTOTI                                            MD021605
     C   93                                                                                 MD021605
     CAN 94      ZZWK2     SUB  ZZAMTD    ZZTOTD                                            MD021605
     C   93                                                                                 MD021605
     CANN94      ZZTOTD    SUB  ZZAMTD    ZZTOTD                                            MD021605
      *                                                                                     MD021605
      ***  If ZZAMT gt. ZZTOT.                                                              MD021605
      *                                                                                     MD021605
     C  N93      ZZTOTD    COMP ZZAMTD               94                                     MD021605
     C  N93                                                                                 MD021605
     CAN 94      ZZAMTI    SUB  1         ZZWK3  150                                        MD021605
     C  N93                                                                                 MD021605
     CAN 94      ZZAMTD    ADD  1000      ZZWK2                                             MD021605
     C  N93                                                                                 MD021605
     CAN 94      ZZWK3     SUB  ZZTOTI    ZZTOTI                                            MD021605
     C  N93                                                                                 MD021605
     CANN94      ZZAMTI    SUB  ZZTOTI    ZZTOTI                                            MD021605
     C  N93                                                                                 MD021605
     CAN 94      ZZWK2     SUB  ZZTOTD    ZZTOTD                                            MD021605
     C  N93                                                                                 MD021605
     CANN94      ZZAMTD    SUB  ZZTOTD    ZZTOTD                                            MD021605
      *                                                                                     MD021605
      ***  Reverse sign of ZZTOT if larger I/P fields were negative                         MD021605
      *                                                                                     MD021605
     C                     SETOF                     94                                     MD021605
     C   93                                                                                 MD021605
     CAN 91                                                                                 MD021605
     CORN93                                                                                 MD021605
     CAN 92                SETON                     94                                     MD021605
     C   94                Z-SUBZZTOTI    ZZTOTI                                            MD021605
     C   94                Z-SUBZZTOTD    ZZTOTD                                            MD021605
      *                                                                                     MD021605
      ***  Restore sign of ZZAMTI & ZZAMTD if it was reversed                               MD021605
      *                                                                                     MD021605
     C   92                Z-SUBZZAMTI    ZZAMTI                                            MD021605
     C   92                Z-SUBZZAMTD    ZZAMTD                                            MD021605
     C           PDSEND    TAG                                                              MD021605
      *                                                                                     MD021605
      ***  If ZZTOTD is zero, and ZZTOTI is neg. set up ZZNEGD.                             MD021605
      *                                                                                     MD021605
     C                     SETOF                     96                                     MD021605
     C           ZZTOTD    COMP 0                        91                                 MD021605
     C   91      ZZTOTI    COMP 0                      96                                   MD021605
     C   96                MOVE '.000-'   ZZNEGD  5                                         MD021605
      *                                                                                     MD021605
      ***  Restore previous indicator values                                                MD021605
      *                                                                                     MD021605
     C                     MOVE WIN91     *IN91                                             MD021605
     C                     MOVE WIN92     *IN92                                             MD021605
     C                     MOVE WIN93     *IN93                                             MD021605
     C                     MOVE WIN94     *IN94                                             MD021605
     C                     MOVE WIN95     *IN95                                             MD021605
     C                     MOVE WIN96     *IN96                                             MD021605
      *                                                                                     MD021605
     C                     ENDSR                                                            MD021605
      ****************************************************************                      MD021605
     C/COPY WNCPYSRC,LE0480C015
     C/COPY ZSRSRC,ZDATE1Z2
     C/COPY ZSRSRC,ZDATE2Z4
     C/COPY ZSRSRC,ZACCH                                                  S01195
     C/COPY ZSRSRC,ZFWDT                                                  S01195
     C/COPY ZSRSRC,ZCHKH                                                  S01195
     C/COPY ZSRSRC,ZBKDT                                                  S01195
     C/COPY ZSRSRC,GLINTCZ1
     C/COPY ZSRSRC,ZSAVEZ1
     C/COPY ZSRSRC,ZRSTORZ1
     C/COPY ZSRSRC,ZFREQBZ2                                               S01392
      /EJECT                                                              066550
     C/COPY ZSRSRC,ZINTDYZ2                                               066550
      /EJECT                                                              066550
     C/COPY ZSRSRC,ZDATE9Z3                                               066550
     C/COPY ZSRSRC,ZDAT10Z2                                               126017
      /EJECT                                                              066550
     C/COPY ZSRSRC,ZFRQB3                                                 144089
      /EJECT                                                              144089
     C/COPY ZSRSRC,RULE78Z1                                                                   CLE028
      /EJECT                                                                                  CLE028
     C/COPY WNCPYSRC,LE0480C012
      /EJECT                                                                                  CER049
     C/COPY ZSRSRC,RTZXRTC1                                                                   CER049
     C/COPY ZSRSRC,ZCONVNZ1                                                                 CLE075AF
     C********************************************************************S01392
2668 O***LVNTXHH D        01                                                               AR1078776
     OLVNTXHH D        01 68                                                               AR1078776
2669 O                                    1 'H'
2670 OLVNTXEL E
2671 O                                    1 'L'
2672 O                         LNRF       7
2673 O***********              CUSNUM    13                               S01117
     O                         EVCNUM    13                               S01117
     O                 79      STDCST    13                                                   CER049
2674 O                         EVCODE    17
     O                 79                17 '49ST'                                            CER049
2675 O                         EVDATE    20P
2676 O                         EVAMNT    27P
     O                 79      WSSTAX    27P                                                  CER049
2677 O                         CCY       30
     O                 79      LQDCCY    30                                                   CER049
2678 O                         ECCYSS    32
2679 O                         LTYP      34
2680 O                         SUTP      36
2681 O***********              BRCD      39                               S01117
     O                         EBRC      39                               S01117
2682 O                         EFFINT    45P
2683 O                       70          46 'Y'
2684 O                         EVODAT    49P
2685 O                         EVOAMT    56P
2686 O                         FCCY      59
2687 O                         ECCYDP    62
2688 O                         DBEAMT    70P
2689 O                         SBEAMT    77P
2690 O                         BCXR      84P
2691 O                         SLEAMT    91P
2692 O                         FININD   106
2693 O**********               SETTLE   130                                                   CGL029
     O                         SETTYP   108                                                   CGL029
     O                 79      SSETYP   108                                                   CER049
     O                         SETNOS   130                                                   CGL029
2694 O                    71N50FACO     140
2695 O                    71 50FACOLA   140
2696 O                    71N50SPINS    230
2697 O                    71 50SPINSA   230
2698 O                         INOUT    231
     O                 79      SINOUT   231                                                   CER049
2699 O                         PARNUM   237
     O                 79      STDCST   237                                                   CER049
2700 O                      N72         238 '0'
2701 O                       72         238 '1'
     O                 79      WSPARI   238                                                   CER049
2702 O                         CUSDET   276
     O                 79      SCUSDE   276                                                   CER049
2703 O                         PARDET   314
     O                 79      SPARDE   314                                                   CER049
2704 O                         FCUS     320
2705 O                         FTYP     323
2706 O                         FSEQ     325
2707 O                         RSKDET   329
2708 O                         DOMDET   333
     O                 79      SDOMDE   333                                                   CER049
2709 O                         LASEQ    336
2710 O                         FREQY    337
2711 O                         WTIN     338
2712 O                         WTRT     344P
2713 O                         CPAM     351P
2714 O                         AUTOS    352
2715 O                                  353 '2'
2716 O                         ACOF     355
2717 O                         RCSI     356
     O**********               ECPY     359                        S01117 LN0383
     O**********               IBRE     360                        S01117 LN0383
     O**********               ICYE     361                        S01117 LN0383
     O**********                        362 ' '                    S01117 LN0383
     O**********                        363 'B'                    S01117 LN0383
     O**********                        364 'C'                    S01117 LN0383
     O**********                        365 'S'                    S01117 LN0383
     O**********               OSBR     359                        LN0383 BHF524
     O                         STLBR    359                               BHF524
     O                         ECPY     362                               LN0383
     O                         IBRE     363                               LN0383
     O                 79      SIBRE    363                                                   CER049
     O                         ICYE     364                               LN0383
     O                                  365 ' '                           LN0383
     O                                  366 'B'                           LN0383
     O                                  367 'C'                           LN0383
     O                                  368 'S'                           LN0383
     O                         ORBR     371                               LN0383
     O                         COOB     374                               LN0383
     O                         BRCA     377                               LN0383
     O                         COBB     380                               LN0383
     O****************         OLNO     384P                        LN0383BHF420
     O                         OLNO     386                               BHF420
     O/COPY WNCPYSRC,LE0480O001
     O****************         BOKC     402                        S01220 S01393
     O****************         SRLR     403                        S01220 S01393
     O                         BOKC     399                               S01393
     O                         SRLR     400                               S01393
     O                         PTFR     404                               S01486
     O                 15      GASS     406                               CLE004
     O                                  406 ' '                           CEU004
     O                         IFXC     409                               CEU004
     O                         SIAC     410                               163486
     O                 79      SSIAC    410                                                   CER049
     O                         LOTX1    479                                                   218992
     O                         ROBRX    482                                                   218992
     O                         RSCYX    485                                                   218992
     O                         REXRX    492P                                                  218992
     O                         REXIX    493                                                   218992
     O                         LOTX2    699                                                   218992
     O                         LOTX3    842                                                   218992
     O                         LOTX4   1052                                                   218992
     O                         POBRX   1055                                                   218992
     O                 79      LQDBRC  1055                                                   CER049
     O                         CVMRX   1056                                                   218992
     O                         PSCYX   1059                                                   218992
     O                 79      LQDCCY  1059                                                   CER049
     O                         ICCYX   1062                                                   218992
     O                         PEXRX   1069P                                                  218992
     O                 79      ZRATEX  1069P                                                  CER049
     O                         PEXIX   1070                                                   218992
     O                 79      ZMDI1   1070                                                   CER049
     O                         SETAC   1088                                                   CGL029
     O                 79      SACNO   1088                                                   CER049
     O                         LOTX5   1124                                                   CGL029
     O                         CLAS    1128                                                   CLE042
     O                 28 51           1129 '1'                                               CLE154
     O                 28 52           1129 '2'                                               CLE154
     O                 28 53           1129 '3'                                               CLE154
      *                                                                   CEU004
      * CEU004 Change - 1st new event created for non-blank setlement ccy.CEU004
      *                                                                   CEU004
     OLVNTXEL E        33                                                 CEU004
     O                                    1 'L'                           CEU004
     O                         LNRF       7                               CEU004
     O                         EVCNUM    13                               CEU004
     O***********              EVCODE    17                               CEU004
     O                         EMUEVC    17                               CEU004
     O                         EVDATE    20P                              CEU004
     O                         EVAMNT    27P                              CEU004
     O                         CCY       30                               CEU004
     O                         ECCYSS    32                               CEU004
     O                         LTYP      34                               CEU004
     O                         SUTP      36                               CEU004
     O                         EBRC      39                               CEU004
     O                         EFFINT    45P                              CEU004
     O                       70          46 'Y'                           CEU004
     O                         EVODAT    49P                              CEU004
     O                         EVOAMT    56P                              CEU004
     O                         FCCY      59                               CEU004
     O                         ECCYDP    62                               CEU004
     O                         DBEAMT    70P                              CEU004
     O                         SBEAMT    77P                              CEU004
     O                         BCXR      84P                              CEU004
     O                         SLEAMT    91P                              CEU004
     O                         FININD   106                               CEU004
     O**********               SETTLE   130                                            CEU004 CGL029
     O                         SETTYP   108                                                   CGL029
     O                         SETNOS   130                                                   CGL029
     O                    71N50FACO     140                               CEU004
     O                    71 50FACOLA   140                               CEU004
     O                    71N50SPINS    230                               CEU004
     O                    71 50SPINSA   230                               CEU004
     O                         INOUT1   231                               CEU004
     O                         PARNUM   237                               CEU004
     O                      N72         238 '0'                           CEU004
     O                       72         238 '1'                           CEU004
     O                         CUSDET   276                               CEU004
     O                         PARDET   314                               CEU004
     O                         FCUS     320                               CEU004
     O                         FTYP     323                               CEU004
     O                         FSEQ     325                               CEU004
     O                         RSKDET   329                               CEU004
     O                         DOMDET   333                               CEU004
     O                         LASEQ    336                               CEU004
     O                         FREQY    337                               CEU004
     O                         WTIN     338                               CEU004
     O                         WTRT     344P                              CEU004
     O                         CPAM     351P                              CEU004
     O                         AUTOS    352                               CEU004
     O                                  353 '2'                           CEU004
     O                         ACOF     355                               CEU004
     O                         RCSI     356                               CEU004
     O                         STLBR    359                               CEU004
     O                         ECPY     362                               CEU004
     O                         IBRE     363                               CEU004
     O                         ICYE     364                               CEU004
     O                                  365 ' '                           CEU004
     O                                  366 'B'                           CEU004
     O                                  367 'C'                           CEU004
     O                                  368 'S'                           CEU004
     O                         ORBR     371                               CEU004
     O                         COOB     374                               CEU004
     O                         BRCA     377                               CEU004
     O                         COBB     380                               CEU004
     O                         OLNO     386                               CEU004
     O                         BOKC     399                               CEU004
     O                         SRLR     400                               CEU004
     O                         PTFR     404                               CEU004
     O************             IFXC     409                        CEU004 163486
      *      For first New Event, IFXC & SIAC both = 'Y'                  163486
     O****************                  409 'Y'                     163486CLE031
     O                 32               409 'Y'                           CLE031
     O                N32               409 ' '                           CLE031
     O                                  410 'Y'                           163486
     O                         LOTX1    479                                                   218992
     O                         ROBRX    482                                                   218992
     O                         RSCYX    485                                                   218992
     O                         REXRX    492P                                                  218992
     O                         REXIX    493                                                   218992
     O                         LOTX2    699                                                   218992
     O                         LOTX3    842                                                   218992
     O                         LOTX4   1052                                                   218992
     O                         POBRX   1055                                                   218992
     O                         CVMRX   1056                                                   218992
     O                         PSCYX   1059                                                   218992
     O                         ICCYX   1062                                                   218992
     O                         PEXRX   1069P                                                  218992
     O                         PEXIX   1070                                                   218992
     O                         SETAC   1088                                                   CGL029
     O                         LOTX5   1124                                                   CGL029
     O                         CLAS    1128                                                   CLE042
     O                 28 51           1129 '1'                                               CLE154
     O                 28 52           1129 '2'                                               CLE154
     O                 28 53           1129 '3'                                               CLE154
      *                                                                   CEU004
      ** CEU004 Change - 2nd new event created for non-blank setlement ccyCEU004
      *                                                                   CEU004
     OLVNTXEL E        33                                                 CEU004
     O                                    1 'L'                           CEU004
     O                         LNRF       7                               CEU004
     O                         EVCNUM    13                               CEU004
     O                         EMUEVC    17                               CEU004
     O                         EVDATE    20P                              CEU004
     O                         EMUAMT    27P                              CEU004
     O                         EMUCCY    30                               CEU004
     O                         EMUSRT    32                               CEU004
     O                         LTYP      34                               CEU004
     O                         SUTP      36                               CEU004
     O                         EBRC      39                               CEU004
     O                         EFFINT    45P                              CEU004
     O                       70          46 'Y'                           CEU004
     O                         EVODAT    49P                              CEU004
     O                         EMUAMT    56P                              CEU004
     O                         EMUCCY    59                               CEU004
     O*****************        ECCYDP    62                         CEU004CLE031
     O                N31      ECCYDP    62                               CLE031
     O                 31      EMUDP     62                               CLE031
     O                         DBEAMT    70P                              CEU004
     O                         SBEAMT    77P                              CEU004
     O                         BCXR      84P                              CEU004
     O                         SLEAMT    91P                              CEU004
     O                         FININD   106                               CEU004
     O**********               EMUSTI   130                                            CEU004 CGL029
     O***********              SETTYP   108                                           CGL029 BUG9175
     O***********              SETNOS   130                                           CGL029 BUG9175
     O                         EMSTYP   108                                                  BUG9175
     O                         EMSNOS   130                                                  BUG9175
     O                    71N50FACO     140                               CEU004
     O                    71 50FACOLA   140                               CEU004
     O                    71N50SPINS    230                               CEU004
     O                    71 50SPINSA   230                               CEU004
     O                         INOUT    231                               CEU004
     O                         PARNUM   237                               CEU004
     O                      N72         238 '0'                           CEU004
     O                       72         238 '1'                           CEU004
     O                         CUSDET   276                               CEU004
     O                         PARDET   314                               CEU004
     O                         FCUS     320                               CEU004
     O                         FTYP     323                               CEU004
     O                         FSEQ     325                               CEU004
     O                         RSKDET   329                               CEU004
     O                         DOMDET   333                               CEU004
     O                         LASEQ    336                               CEU004
     O                         FREQY    337                               CEU004
     O                         WTIN     338                               CEU004
     O                         WTRT     344P                              CEU004
     O                         CPAM     351P                              CEU004
     O                         AUTOS    352                               CEU004
     O                                  353 '2'                           CEU004
     O                         ACOF     355                               CEU004
     O                         RCSI     356                               CEU004
     O                         STLBR    359                               CEU004
     O                         ECPY     362                               CEU004
     O                         IBRE     363                               CEU004
     O                         ICYE     364                               CEU004
     O                                  365 ' '                           CEU004
     O                                  366 'B'                           CEU004
     O                                  367 'C'                           CEU004
     O                                  368 'S'                           CEU004
     O                         ORBR     371                               CEU004
     O                         COOB     374                               CEU004
     O                         BRCA     377                               CEU004
     O                         COBB     380                               CEU004
     O                         OLNO     386                               CEU004
     O                         BOKC     399                               CEU004
     O                         SRLR     400                               CEU004
     O                         PTFR     404                               CEU004
     O**********               IFXC     406                        CEU004 163486
     O**********                        409 ' '                    CEU004 163486
      * For second new event, IFXC = 'Y' and SIAC is blank.               163486
     O**********                        409 'Y'                     163486CLE031
     O                 32               409 'Y'                           CLE031
     O                N32               409 ' '                           CLE031
     O                                  410 ' '                           163486
     O                         LOTX1    479                                                   218992
     O                         ROBRX    482                                                   218992
     O                         RSCYX    485                                                   218992
     O                         REXRX    492P                                                  218992
     O                         REXIX    493                                                   218992
     O                         LOTX2    699                                                   218992
     O                         LOTX3    842                                                   218992
     O                         LOTX4   1052                                                   218992
     O                         POBRX   1055                                                   218992
     O                         CVMRX   1056                                                   218992
     O                         PSCYX   1059                                                   218992
     O                         ICCYX   1062                                                   218992
     O                         PEXRX   1069P                                                  218992
     O                         PEXIX   1070                                                   218992
     O***********              SETAC   1088                                           CGL029 BUG9175
     O                         EMSTAC  1088                                                  BUG9175
     O                         LOTX5   1124                                                   CGL029
     O                         CLAS    1128                                                   CLE042
     O                 28 51           1129 '1'                                               CLE154
     O                 28 52           1129 '2'                                               CLE154
     O                 28 53           1129 '3'                                               CLE154
      *                                                                   CEU004
      *                                                                   CEU004
2718 O***LVNTXZZ T        LR                                                               AR1078776
2719 O**********                          1 'T'                                            AR1078776
2720 O**********               COUNT2     6                               105140
     O**********               COUNT2     6P                                        105140 AR1078776
2721 O**********               HSHWN2    14P                                               AR1078776
2722 O**********               HSHDC2    16P                                               AR1078776
     OLELWNEPDD        05                                                                   MD021605
     O**********               LONL    1874                                          MD021605 CLE141
     O                         LONL    2025                                                   CLE141
     O***LELWNEPKD        06                                                       MD021605 MD031481
     OLELWNEPKD        14                                                                   MD031481
     O                         LONK    1319                                                 MD021605
2718 OLELWNEZ1T        LR 07                                                                MD021605
     O                         PDRECI     1                                                 MD021605
     O                         PDLNRF     7                                                 MD021605
     O                         PDRCDT     8                                                 MD021605
     O                                   16 '       '                                       MD021605
     O                         PDNORE    19P                                                MD021605
     O                         PDFLSZ    22P                                                MD021605
     O                         PDNLRB    25P                                                MD021605
     O                         PDNINS    28P                                                MD021605
     O                         PDNDEL    31P                                                MD021605
     O                         PZNLRA    34P                                                MD021605
     O                         PDVLBF    42P                                                MD021605
     O                         PDVLBL    44P                                                MD021605
     O                         PDVRIF    52P                                                MD021605
     O                         PDVRIL    54P                                                MD021605
     O                         PDVRDF    62P                                                MD021605
     O                         PDVRDL    64P                                                MD021605
     O                         PDVLAF    72P                                                MD021605
     O                         PDVLAL    74P                                                MD021605
     O                         PDDTMR    77P                                                MD021605
     O                         PDITMR    80P                                                MD021605
     O                                  393 '  '                                            MD021605
     O                         PDLCD    396P                                                MD021605
     O                         PDCHTP   397                                                 MD021605
     O                         PZTNLU   400P                                                MD021605
     O**
     O** L.E. TOMORROWS EVENTS FILE
     O**
     O** OUTPUT HEADER
     O***EMTE1H1 DADD     U1 01                                                            AR1078776
     OEMTE1H1 DADD     U1 01 78                                                            AR1078776
     O                                    1 'H'
     O                                    8 '0'
     O** DETAIL RECORD
     OEMTE1E1 EADD     U1 61
     O                                    1 'L'
     O                       06OLNO       7                               E10836
     O**********************N06CUSNUM*****7                        E10836 053699
     O                      N06FCUS       7                               053699
     O****                     CUSNUM     7                               E10836
     O                         EVCODE    11
     O                         CCY       14
     O                         EVAMNT    21P
     O                         RCSI      22
     O                         SETTYP    24
     O                         LNRF      30
     O                         OLNO      36
     O                         BRCA      39                               S01117
     O                         VDAT      42P                              S01332
     O                         MDAT      45P                              S01332
     O**
     O** OUTPUT TRAILER
     O***EMTE1T1 TADD     U1 LR                                                            AR1078776
     O**********                          1 'T'                                            AR1078776
     O**********                          7 '999999'                                       AR1078776
     O**********                          8 'L'                                            AR1078776
     O**********               TNLER     11P                                               AR1078776
     O*
     O**
     O** L.E. MASTER FILE EXTRACT
     O**
     O** OUTPUT HEADER
     O***EMXT1H1 DADD     U1 01                                                            AR1078776
     OEMXT1H1 DADD     U1 01 88                                                            AR1078776
     O                                    1 'H'
     O                                    8 '0'
     O** DETAIL RECORD
     OEMXT1D1 DADD     U1 03N62
     O       AND      N14                                                                   MD031481
     O       AND      N67                                                                   MD049545
     O                                    1 'L'
     O****                     CUSNUM     7                               E10836
     O                       06OLNO       7                               E10836
     O**********************N06CUSNUM*****7                        E10836 053699
     O                      N06FCUS       7                               053699
     O                         LNRF      13
     O                         PTYP      15
     O                         CPAM      22P
     O                         CCY       25
     O                         LIND      28
     O                         CRSK      30
     O                         ACOF      32
     O                         RCSI      33
     O                         OLNO      39
     O                         VDAT      42P
     O                         MDAT      45P
     O                         XREGN     47
     O**********               LOIC      50                                          CER020 BUG23967
     O**********               BRCA      50                                            S01117 CER020
     O**********               BRCA      53                                          CER020 BUG23967
     O                         BRCA      50                                                 BUG23967
     O                         LOIC     131                                                 BUG23967
     OEMXT1R1 DADD     U1 03 62
     O       AND      N67                                                                   MD049545
     O                                    1 'R'
     O                         CUSNUM     7
     O                         LNRF      13
     O                         PTYP      15
     O                         CPAM      22P
     O                         CCY       25
     O                         LIND      28
     O                         CRSK      30
     O                         ACOF      32
     O                         RCSI      33
     O                         OLNO      39
     O                         VDAT      42P
     O                         MDAT      45P
     O                         XREGN     47
     O**********               LOIC      50                                          CER020 BUG23967
     O**********               BRCA      50                                            S01117 CER020
     O**********               BRCA      53                                          CER020 BUG23967
     O                         BRCA      50                                                 BUG23967
     O                         LOIC     131                                                 BUG23967
     O**
     O** OUTPUT TRAILER
     O***EMXT1T1 TADD     U1 LR                                                            AR1078776
     O**********                          1 'T'                                            AR1078776
     O**********                          7 '999999'                                       AR1078776
     O**********                          8 'L'                                            AR1078776
     O**********               XNLER     11P                                               AR1078776
     O**********               XNLER1    14P                                               AR1078776
     O**********               XNLER2    17P                                               AR1078776
2723 O*
2724 O*    RUN CONTROLS REPORT
2725 O*
2726 O*E0480P1T** 03   LR                                           S01124S01117
2726 OLE0480AUT   03   LR                                                 S01117
2727 O*****                              22 'REFERENCE  LE0480'           S01117
2727 O                                   24 'REFERENCE  LE0480AU'         S01117
2728 O                         TITL      89
2729 O                                  104 'DATE'
2730 O                         RUNA     112
2731 O                                  127 'PAGE    1'
2732 O        T   05   LR
2733 O                                   63 'CREATE LOAN EVENTS EXTRA'
2734 O                                   86 'CT FILE - FILE CONTROLS'
2735 O        T   06   LR
2736 O                                   63 '------------------------'
2737 O                                   86 '-----------------------'
2738 O        T   09   LR
2739 O                                   28 'S/LVNTX - RUN CONTROLS'
2740 O                                   59 'NUMBER'
2741 O                                   84 'VALUE'
2742 O        T   10   LR
2743 O                                   28 '----------------------'
2744 O                                   59 'OF RECORDS'
2745 O                                   84 'OF RECORDS'
2746 O        T   12   LR
2747 O                                   29 'TOTAL RECORDS ON FILE'
2748 O                         COUNT23   59
2749 O                         HSHWN24   81
2750 O                         HSHDC2    84
2751 O        T   15   LR
2752 O                                   28 'S/CLOAN - RUN CONTROLS'
2753 O        T   16   LR
2754 O                                   28 '----------------------'
2755 O        T   18   LR
2756 O                                   29 'TOTAL RECORDS ON FILE'
2757 O                      NU7NORE  3   59
2758 O                      NU7VLAF  4   81
2759 O                      NU7VLAL      84
2760 O        T   20   LR
2761 O                                   29 'TOTAL RECORDS ON FILE'
2762 O                                   42 '- CALCULATED'
2763 O                         COUNT13   59
2764 O                         HSHWN14   81
2765 O                         HSHDC1    84
2766 O                    U8NU7         111 '***   DIFFERENCE   ***'
     O        T   24   LR U1
     O                                   25 'EXPOSURE MANAGEMENT'
     O                                   39 'EXTRACT FILES'
     O        T   25   LR U1
     O                                   25 '-------------------'
     O                                   39 '-------------'
     O        T   27   LR U1
     O                                   30 'S/EMXT1 MASTER FILE EXTR'
     O                                   42 'ACT - CREATE'
     O        T   28   LR U1
     O                                   30 '------------------------'
     O                                   42 '------------'
     O        T   30   LR U1
     O                                   29 'TOTAL DETAIL RECORDS '
     O                                   36 'ON FILE'
     O                         XNLER 3   59
     O*
     O        T   32   LR U1
     O                                   30 'S/EMTE1 TOMORROWS EVENTS'
     O                                   44 'FILE - CREATE'
     O        T   33   LR U1
     O                                   30 '------------------------'
     O                                   44 '-------------'
     O        T   35   LR U1
     O                                   29 'TOTAL DETAIL RECORDS '
     O                                   36 'ON FILE'
     O                         TNLER 3   59
2767 O        T 32     LR U7
2768 O                                   51 '*** REFERENCE LE0480'
2769 O                                   71 '- DATABASE ERROR AT'
2770 O***********              DBASE     74                               S01117
     O                         DBASE     75                               S01117
2771 O        T        LR U7
2772 O***********                        37 'FILENAME'                    S01117
2773 O***********              DBFILE    43                               S01117
2774 O***********                        48 'KEY'                         S01117
2775 O***********              DBKEY     78                               S01117
     O                                   39 'FILENAME'                    S01117
     O                         DBFILE    48                               S01117
     O                                   52 'KEY'                         S01117
     O                         DBKEY     82                               S01117
2776 O********T*3      LR                                                 S01117
2777 O***********                        76 '*** END OF REPORT ***'       S01117
     O*********   TAB1/TAB2  Changed entries for 218984                                      218984R
     O**********61V3113O                                                                     218984R
     O**********62V3113O                                                              S01243 218984R
     O**********64V3113O                                                              S01243 218984R
     O**********66V3113I                                                              S01243 218984R
     O**********68V3113O                                                              CLE005 218984R
     O**********69V3113I                                                              CLE005 218984R
     O**********72V3113I                                                              CLE005 218984R
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
**   POWER - ARRAY OF POWERS OF 10 FOR CURRENCY CONVERSIONS
0000001
0000010
0000100
0001000
0010000
0100000
1000000
**   TAB1/TAB2
61V1311O
61I2112I
61I6112I                                                                                      CAS005
61X2112I                                                                  E25263
61R1154I
61R2144I
61R4154I                                                                                      CAS005
61R6114I                                                                                      CAS005
61R7114I                                                                  CLE004
61R9154                                                                   190313
61V3114O                                                                                     218984R
61V4113O                                                                                      CAS005
61V5113O                                                                  CLE004
61V6113O                                                                                      CAS005
61V7311                                                                   190313
61M1232I
61M2122I
61M6122I                                                                                      CAS005
61R5110
61D1130
61X3114O                                                                                      CLE139
61P1232I                                                                                      CLE134
61P2222I                                                                                      CLE134
61P6122I                                                                                      CLE134
62V1311O
62V3114O                                                                                     218984R
62V4113O                                                                                      CAS005
62V5113O                                                                  CLE004
62V6113O                                                                                      CAS005
62V7311O                                                                  CLE006
62I2112I
62I6112I                                                                                      CAS005
62X2112I                                                                  E25263
62R1154I
62R4154I                                                                                      CAS005
62R2144I
62M1232I
62M2122I
62M6122I                                                                                      CAS005
62R5110
62R6114I                                                                                      CAS005
62R7114I                                                                  CLE004
62R9114I                                                                  CLE006
62D1130
62X3114O                                                                                      CLE139
62P1232I                                                                                      CLE134
62P2222I                                                                                      CLE134
62P6122I                                                                                      CLE134
63V1361O
63R3425O                                                                  S01392
63R4115I                                                                  S01392
63R5475I                                                                  JSM08
63V2321I
63M1262I
63D1260
63P1262I                                                                                      CLE134
63I3475I                                                                  CLE006
63R6114I                                                                                      CAS005
63R7114I                                                                  CLE004
63R9115I                                                                  CLE006
63V5113O                                                                  CLE004
63V6113O                                                                                      CAS005
63V7425O                                                                  CLE006
64V1311O
64V3114O                                                                                     218984R
64V4113O                                                                                      CAS005
64V5113O                                                                  CLE004
64V6113O                                                                                      CAS005
64V7311O                                                                  CLE006
64I2112I
64I6112I                                                                                      CAS005
64X2112I                                                         080332
64R1154I
64R4154I                                                                                      CAS005
64R2144I
64R6114I                                                                                      CAS005
64R7114I                                                                  CLE004
64R9114I                                                                  CLE006
64M1232I
64M2122I
64M6122I                                                                                      CAS005
64R5110
64D1130
64X3114O                                                                                      CLE139
64P1232I                                                                                      CLE134
64P2222I                                                                                      CLE134
64P6122I                                                                                      CLE134
65V1361O
65V2321I
65M1262I
65D1260
65P1262I                                                                                      CLE134
65R6114I                                                                                      CAS005
65R7114I                                                                  CLE004
65V5113O                                                                  CLE004
65V6113O                                                                                      CAS005
65R3425O                                                                  124660
65R4115I                                                                  124660
65R5475I                                                                  124660
65I3475I                                                                  124660
65R9115I                                                                  124660
65V7425O                                                                  124660
66V1311I
66V3114I                                                                                     218984R
66V4113I                                                                                      CAS005
66V5113I                                                                  CLE004
66V6113I                                                                                      CAS005
66V7311I                                                                  CLE005
66I2112O
66I6112O                                                                                      CAS005
66X2112O                                                         080332
66R1154O
66R4154O                                                                                      CAS005
66R6114O                                                                                      CAS005
66R2144O
66R7114O                                                                  CLE004
66R91540                                                                  CLE005
66M1232O
66M2122O
66M6122O                                                                                      CAS005
66R5110
66D1130
66P1232O                                                                                      CLE134
66P2222O                                                                                      CLE134
66P6122O                                                                                      CLE134
66R9115I                                                                  124660
66V7425O                                                                  124660
66X3114I                                                                                      CLE139
67V1361I
67V2321O
67M1262O
67D1260
67P1262O                                                                                      CLE134
67R6114O                                                                                      CAS005
67R7114O                                                                  CLE004
67R9114O                                                                  CLE005
67V5113I                                                                  CLE004
67V6113I                                                                                      CAS005
67R3425O                                                                  124660
67R4115I                                                                  124660
67R5475I                                                                  124660
67I3475I                                                                  124660
67R9115I                                                                  124660
67V7425O                                                                  124660
67V7361I                                                                  CLE005
68V1311O                                                                  CLE005
68I2112I                                                                  CLE005
68I6112I                                                                                      CAS005
68X2112I                                                                  CLE005
68R1154I                                                                  CLE005
68R4154I                                                                                      CAS005
68R2144I                                                                  CLE005
68R6114I                                                                                      CAS005
68R7114I                                                                  CLE005
68R9154                                                                   190313
68V3114O                                                                                     218984R
68V4113O                                                                                      CAS005
68V5113O                                                                  CLE005
68V6113O                                                                                      CAS005
68V7311                                                                   190313
68M1232I                                                                  CLE005
68M2122I                                                                  CLE005
68M6122I                                                                                      CAS005
68R5110                                                                   CLE005
68D1130                                                                   CLE005
68X3114O                                                                                      CLE139
68P1232I                                                                                      CLE134
68P2222I                                                                                      CLE134
68P6122I                                                                                      CLE134
69V1311I                                                                  CLE005
69V3114I                                                                                     218984R
69V4113I                                                                                      CAS005
69V5113I                                                                  CLE005
69V6113I                                                                                      CAS005
69V7311I                                                                  CLE005
69I2112O                                                                  CLE005
69I6112O                                                                                      CAS005
69X2112O                                                                  CLE005
69R1154O                                                                  CLE005
69R4154O                                                                                      CAS005
69R2144O                                                                  CLE005
69R6114O                                                                                      CAS005
69R7114O                                                                  CLE005
69R9154O                                                                  CLE005
69M1232O                                                                  CLE005
69M2122O                                                                  CLE005
69M6122O                                                                                      CAS005
69R5110                                                                   CLE005
69D1130                                                                   CLE005
69X3114I                                                                                      CLE139
69P1232O                                                                                      CLE134
69P2222O                                                                                      CLE134
69P6122O                                                                                      CLE134
70V1310
70I2112I
70X2112I                                                         080332
70M1230
70M2122I
70D1130
70P1230                                                                                       CLE134
70P2222I                                                                                      CLE134
70V3110                                                                   E12000
70R7110                                                                   CLE004
70V3110                                                                   E12000
70X3110                                                                                       CLE139
70V5110                                                                   CLE004
70V7310                                                                              142393   214232
70R5110                                                                   142393
70R9150                                                                              142393   214232
70R1150                                                                              142388   214232
70R2144                                                                   142388
70X3110                                                                                       CLE139
71V1310                                                                   CLE005
71I2112I                                                                  CLE005
71X2112I                                                                  CLE005
71M1230                                                                   CLE005
71M2122I                                                                  CLE005
71D1130                                                                   CLE005
71P1230                                                                                       CLE134
71P2322I                                                                                      CLE134
71R7110                                                                   CLE005
71V3110                                                                   CLE005
71V5110                                                                   CLE005
71V7310                                                                              142393   214232
71R5110                                                                   142393
71R9150                                                                              142393   214232
71R1150                                                                              142388   214232
71R2144                                                                   142388
71X3110                                                                                       CLE139
72V1310                                                                              CLE005   214232
72V3114I                                                                                     218984R
72V5110                                                                  248869 amended from 72V3110
72V7310                                                                              CLE005   214232
72I2112O                                                                  CLE005
72X2112O                                                                  CLE005
72R1150                                                                              CLE005   214232
72R2144O                                                                  CLE005
72R7114O                                                                  CLE005
72R9150                                                                              CLE005   214232
72M1230                                                                              CLE005   214232
72M2122O                                                                  CLE005
72R5110                                                                   CLE005
72D1130                                                                   CLE005
72X3114I                                                                                      CLE139
72P1232O                                                                                      CLE134
72P2222O                                                                                      CLE134
80V1311O                                                                                      CLE028
80X2112I                                                                                      CLE028
80R1154I                                                                                      CLE028
80R2144I                                                                                      CLE028
80R4154I                                                                                      222972
80M1232I                                                                                      CLE028
80M2122I                                                                                      CLE028
80M6122I                                                                                      222972
80D1130                                                                                       CLE028
80P1232I                                                                                      CLE134
80P2222I                                                                                      CLE134
80P6122I                                                                                      CLE134
80H1112I                                                                                      CLE028
**   CEU004 AMENDMENT - TABTYP / TABCOD                                   CEU004
1X                                                                        CEU004
2Y                                                                        CEU004
3Z                                                                        CEU004
4Z                                                                        CEU004
5Z                                                                        CEU004
**   ZFMD  -  NUMBER OF DAYS IN THE MONTH
312831303130313130313031
** CPY@   **      OBJECT COPYRIGHT
(c) Finastra International Limited 2001
** @YD  USED BY SR. ZDATE9 - YEARS, IN DAYS, CUMULATIVE IN 4 YEAR SPAN
00366007310109601461
** @MD  USED BY SR. ZDATE9 - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
00000000310005900090001200015100181002120024300273003040033400365
**   SVAL  -  SYSTEM VALUES ARRAY                                                             CLE033
Settlement09Customer                                                                          CLE033
Settlement09AccCode                                                                           CLE033
Settlement09Postings                                                                          218782
