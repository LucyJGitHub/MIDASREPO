0001 H        1                                                           S01117
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas Print Pay/Recv Telexes (Incomplete)')            *
0001 H***********                                                         S01117
0002 F*****************************************************************
0004 F*                                                               *
0003 F*  Midas - Customer Lending Module                          *
0004 F*                                                               *
0005 F*  LE0510  -  Pay/Receive Telexes - Incomplete Instructions     *
0006 F*                                                               *
      *  (c) Finastra International Limited 2001                      *
0008 F*                                                               *
      *  Last Amend No. MD046248           Date 27Oct17               *
      *  Prev Amend No. CLE148             Date 23Jul12               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CSD031             Date 10Apr06               *
      *                 BUG11461           Date 07Jun06               *
      *                 CSD027             Date 09Dec05               *
      *                 219063             Date 22Oct03               *
      *                 CSW037A            Date 02May05               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 CLE025             Date 20Oct03               *
      *                 CGL029             Date 01Sep03               *
      *                 222373             Date 28Oct03               *
      *                 CLE033             Date 09Apr03               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
     F*                 CEU004             Date 02Feb98               *
     F*                 057347             Date 18Mar94               *
     F*                 059539             Date 03Dec93               *
     F*                 S01429             DATE 14JUL93               *
     F*                 E37385             DATE 02MAR93               *
     F*                 S01392             DATE 01OCT92               *
     F*                 CB0042             DATE 01MAY92               *
     F*                 E25975             DATE 13MAR92               *
     F*                 E32589             DATE 10DEC91               *
     F*                 BHF653             DATE 02OCT90               *
     F*                 BHF550             DATE 30SEP90               *
     F*                 BHF216             DATE 08AUG90               *
     F*                 BHF251             DATE 25JUL90               *
     F*                 S01273             DATE 25JUN90               *
     F*                 S01194             DATE 09JAN90               *
0008 F*                 E16145             DATE 13DEC89               *
     F*                 S01117             DATE 14/09/89              *
0008 F*                 E15645             DATE 01/12/88              *
0008 F*                                                               *
0008 F*---------------------------------------------------------------*
0008 F*                                                               *
      *  MD046248 - Finastra Rebranding                               *
      *  CLE148 - Alpha Loan Reference                                *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  BUG11461 - Set off U7 if no detail records were read.        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  219063 - Allow File Control Amounts to be negative.          *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  CLE025 - Credit Lines (Recompile)                            *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  222373 - Parameter Mismatch                                  *
      *  CLE033 - Settlement method 09                                *
      *  CEU004 - LE Settlement Ccy conversion Upgrade to DBA R2.0    *
      *         - Recompiled                                          *
     F*  057347 - LE0510 Swift Pay Telex shows incorrect settlement   *
     F*           branch. To fix, remove fix E37385 causing the error *
     F*           and  close file SDBRCHPD for every level break of   *
     F*           branch code to prevent DB error 004.                *
     F*  059539 - Call AOMMODR0 before calling AORETLR0 so as to      *
     F*           determine first if the Retail Module is installed.  *
     F*           If not installed, do not call AORETLR0.             *
     F*  S01429 - CHIPS ABA NUMBER MODIFICATION FROM 3A TO 4A         *
     F*           FOR CHIPS II                                        *
     F*  E37385 - DB error at 004 in branch is 'ALL'                  *
     F*  S01392 - JAPANESE SUB MODULE ENHANCEMENTS                    *
     F*  CB0042 - UNDERLINING FOR REPORT LINED UP CORRECTLY           *
     F*  E25975 - THE AMOUNT FIELD ON THE REPORT LE0510P1-02          *
     F*           HAS BEEN MOVED DOWN AND IS NOW TOO LOW.             *
     F*  E32589 - BHF653 INCOMPLETE - NONSTANDARD/INCOMPLETE          *
     F*           PAGE HEADING CORRECTED                              *
0008 F*  BHF653 - IMPROVE LAYOUT WHEN NO DETAILS TO REPORT            *
0008 F*  BHF550 - VARIOUS PARTS OF REPORT PRESENTED AS NOT FOUND      *
0006 F*  BHF216 - REMOVE 'NO DETAILS TO REPORT' FROM AUDIT REPORT     *
     F*  BHF251 - NOSTRO, CURRENCY, COUNTERPARTY & AMOUNT MISSING     *
     F*  S01273 - PRINT FULL CUSTOMER NAME AND ADDRESS                *
     F*  S01194 - STANDING DATA CHANGES                               *
     F*  E16145 - WHEN A RECEIVE TELEX IS PRODUCED FOLLOWING A PAY    *
     F*           TELEX WITH THE "FOR ACCOUNT OF" FIELD BLANK, THE    *
     F*           "BY ORDER OF" LINE IS NOT PRINTED.                  *
     F*  S01117 - MULTIBRANCHING                                      *
0008 F*  E15645 - REPORT NON STANDARD                                 *
0008 F*                                                               *
0010 F*****************************************************************
     F*  C R E A T I O N     P A R A M E T E R S                      *
     F*                                                               *
     F*                                                               *
     F*****************************************************************
0011 F/SPACE 3
0012 F*TX2    IP  F     180 37AI     2 DISK                               S01117
     F***STX2*** IP  F     200 37AI     2 DISK                                         S01117 CGL029
     FSTX2    IP  F     228 37AI     2 DISK                                                   CGL029
0013 F*TABLE***IF**F******96*12AI*****2*DISK***************               S01194
0014 F*CLINT***IF**F*****256**7AI*****2*DISK***************               S01194
     FLEPTXDD O   F     303            DISK                      A    U4
     F*E0510P1O** F     132     OF     PRINTER                  S01117    S01117
     FLE0510P1O   F     132     OF     PRINTER      KINFDS SPOOL      UC  S01117
     FLE0510AUO   F     132     OA     PRINTER      KINFDS SPOOLU         S01117
0016 F/SPACE 3
0017 F* ID F  C  H  L    FUNCTION OF INDICATORS
0018 F* 01            S/STX2 - DETAIL
0019 F* 02                    - TRAILER
0020 F**03************TABLE FILE - ICDR 1                                 S01194
0021 F**04************TABLE FILE - ICDR 3                                 S01194
0022 F**05************TABLE FILE - ICDR 5                                 S01194
0023 F**06************TABLE FILE - CURRENCIES RECORD                      S01194
0024 F**07************TABLE FILE - NOSTROS RECORD                         S01194
0025 F**08************TABLE FILE - COUNTERPARTY NOSTROS RECORD            S01194
     F*    13         MULTIBRANCHING OUTPUT CONDITIONING                  S01117
0026 F*    20         AMOUNT NEGATIVE
     F*    21         OUTPUT TOTAL NO. OF TELEXES ON REPORT
0027 F*       25-27   SPECIAL INSTR. NULL
0028 F*       28      ALL SPECIAL INSTRUCTIONS BLANK
     F*       30      OUTPUT TO TELEX FILE
     F*       31      WORK INDICATOR USED FOR BENIFICIARY BANK DETAILS
     F*       32      BENIFICIARY BANK DETAILS EXIST ON FIRST LINE OF SPI
0029 F*       40      1ST CYCLE
0030 F*       41      1ST DETAIL
0031 F*       45      FOR OUTPUT CONDITIONING
     F*       47      NO DETAILS TO REPORT                                S01117
0032 F*       49      BENEFICIARY NOT A CUSTOMER
0033 F*       51      PAY
0034 F*       52      RECEIVE
0035 F*       54      CHIPS - SETTLEMENT TYPE '07'
0036 F*       55      SWIFT - SETTLEMENT TYPE '08'
0037 F*       57      PRINT TELEX TOTAL ON NEXT HEADER
0038 F*       60      DEC. PLACES 0
0039 F*       61                  1
0040 F*       62                  2
0041 F*       63                  3
0042 F*       64      BENEFICIARY-NAME AND TOWN BLANK
0043 F*       66      WORK IND.
0044 F*       67      CHAIN FAILURE
0045 F*       69      FACILITY TELEX
     F*       70      OUTPUT TO TELEX FILE
     F*       71      FACILITY TELEX
0046 F*       80      I/P CYCLE RUN
     F*       88      MUTLIBRANCHING (MBIN = Y)                           S01117
     F*       U4      TELEX MODULE INTERFACE ACTIVE
0047 E                    SPI         3 30               SPECIAL INSTR.
0048 E                    MESS    1   4 29               ERROR MESSAGES
     E/COPY ZSRSRC,ZDATE2Z1                                               S01392
     E                    ASTAR      55  1               ARRAY OF *
     E                    CPY@    1   1 80
     E*                                                                   CLE033
     E**  System values array                                             CLE033
     E                    SVAL    1   2 20                                CLE033
     E*                                                                   CLE033
0052 I* S/STX2 DETAIL RECORD
0053 ISTX2    NS  01   1 CD
0054 I                                        2   2 PYRC  L5
0055 I                                        3   40SETP  L4
0056 I                                        5   7 CCY   L3
0057 I**********                              8  19 OSAC  L2                                  CGL029
     I                                        8  19 OSACQQ                                    CGL029
0058 I                                    P  20  220VDAT  L1
0059 I                                       23  32 TSEN
0060 I**********                             33  380CNUMPH                                    CSD027
0060 I                                       33  38 CNUMPH                                    CSD027
0061 I                                       39  44 FCLN
0062 I                                    P  45  510EAMT          20
0063 I                                       52  52 RCDT
0064 I                                       53  54 AMTP
0065 I                                       55  570LASN
0066 I                                       58  67 FACO
0067 I                                       68 157 SPI
0068 I                                      158 1580PRI1
0069 I                                      159 1590PRI2
0070 I                                      160 1600PRI3
0071 I                                      161 1610PRI4
0072 I**********                            162 1670BICN                                      CSD027
0072 I                                      162 167 BICN                                      CSD027
0073 I                                      168 169 LTYP
0074 I                                      170 171 SUTP
0075 I                                      172 1730PTYP
0076 I                                      174 1740TIND
0077 I*****                                 175 1770BRCD  L6              S01117
     I                                      175 177 BRCA                  S01117
0078 I                                      178 178 INTC
     I                                      179 181 OSBR  L6              S01117
     I                                      211 228 OSAC  L2                                  CGL029
0079 I*
0080 I* TRAILER
0081 I        NS  02   1 CT
0082 I                                    P   2   40NORE
0083 I                                    P   5  120HRWN
0084 I                                    P  13  140HRDC
0085 I*
0086 I* CATCHALL
0087 I        NS
0088 I************                                                        S01194
0089 I*****TABLE*FILE*-*INSTALLATION*CONTROL*DATA*RECORD*1.******         S01194
0090 I************                                                        S01194
0091 I*TABLE***NS**03** 2 C0   3 C1  12 C1                                S01194
0092 I*******AND***   13 C0                                               S01194
0093 I*************                           1   1 RECI                  S01194
0094 I*************                           2   30RECT                  S01194
0095 I*************                          12  130RCDE                  S01194
0096 I*************                          14  66 TITL                  S01194
0097 I*************                          67  67 DATF                  S01194
0098 I*************                          68  700DFBR                  S01194
0121 I*************                          71  71 TLXM                  S01194
0099 I*************                          74  74 MODI1                 S01194
0100 I*************                          75  75 MODI2                 S01194
0101 I*************                          76  76 MODI3                 S01194
0102 I***********                         P  77  790RUND                  S01194
0103 I***********                            80  86 RUNA                  S01194
0104 I*************                          87  870SFLG                  S01194
0105 I*************                       P  90  920LCD                   S01194
0106 I*************                          93  93 CHTP                  S01194
0107 I*************                       P  94  960TNLU                  S01194
0108 I*************                                                       S01194
0109 I*****TABLE FILE*-*INSTALLATION*CONTROL*DATA*RECORD*3.********       S01194
0110 I*************                                                       S01194
0111 I*TABLE***NS**04***1*CD***2*C0***3*C1***********                     S01194
0112 I*******AND***** 12 C2  13 C0                                        S01194
0113 I*************                           1   1 RECI                  S01194
0114 I*************                           2   30RECT                  S01194
0115 I*************                          12  130RCDE                  S01194
0116 I*************                          14  170COMS                  S01194
0117 I*************                          18  210CADC                  S01194
0118 I*************                       P  22  240MDIC                  S01194
0119 I*************                       P  25  270MCIC                  S01194
0120 I*************                       P  28  300MDIA                  S01194
0121 I*************                       P  31  330MCIA                  S01194
0122 I*************                          34  370SRPL                  S01194
0123 I*************                          38  410SPAC                  S01194
0124 I*************                          42  450SWAC                  S01194
0125 I*************                          46  490FTAC                  S01194
0126 I*************                          50  530TAC4                  S01194
0127 I*************                          54  570TAC5                  S01194
0128 I*************                       P  63  650NOBA                  S01194
0129 I*************                       P  66  680TSIZ                  S01194
0130 I*************                          69  69 RACN                  S01194
0131 I*************                          70  700GLSI                  S01194
0132 I*************                          71  710RTSI                  S01194
0133 I*************                          72  720DLSI                  S01194
0134 I*************                          73  730NOSI                  S01194
0135 I*************                          74  740CTSI                  S01194
0136 I*************                       P  75  770ELAC                  S01194
0137 I*************                       P  78  800ECAC                  S01194
0138 I*************                       P  90  920LCD                   S01194
0139 I*************                          93  93 CHTP                  S01194
0140 I*************                       P  94  960TNLU                  S01194
0141 I*************                                                       S01194
0142 I*****TABLE*FILE*-*INSTALLATION*CONTROL*DATA*RECORD*5.*******        S01194
0143 I*************                                                       S01194
0144 I*TABLE***NS**05***1*CD***2*C0***3*C1**************                  S01194
0145 I*******AND****  12 C4  13 C0                                        S01194
0146 I*************                           1   1 RECI                  S01194
0147 I*************                           2   30RECT                  S01194
0148 I*************                          12  130RCDE                  S01194
0149 I*************                          18  210CSAC                  S01194
0150 I*************                          22  22 TLII                  S01194
0151 I*************                          23  23 MCRI                  S01194
0152 I*************                       P  24  250MCEP                  S01194
0153 I*************                          26  270MCLP                  S01194
0154 I*************                          28  28 FRDI                  S01194
0155 I*************                          29  29 BRCF                  S01194
0156 I*************                          30  350PSCN                  S01194
0157 I*************                          36  380DLBR                  S01194
0158 I*************                          39  420FRPA                  S01194
0159 I*************                          43  460FRPC                  S01194
0160 I*************                          47  49 USCY                  S01194
0161 I*************                          50  52 STCY                  S01194
0162 I*************                       P  53  553MBGE                  S01194
0163 I*************                          56  56 PRID                  S01194
0164 I*************                       P  90  920LCD                   S01194
0165 I*************                          93  93 CHTP                  S01194
0166 I*************                       P  94  960TNLU                  S01194
0167 I*************                                                       S01194
0168 I*****TABLE FILE*-*CURRENCIES*RECORD*1.************                  S01194
0169 I*************                                                       S01194
0170 I*TABLE***NS**06***1*CD***2*C2***3*C0**************                  S01194
0171 I*******AND****  13 C1                                               S01194
0172 I*************                           1   1 RECI                  S01194
0173 I*************                           2   30RECT                  S01194
0174 I*************                          10  12 CCY                   S01194
0175 I*************                          13  130SREC                  S01194
0176 I*************                          14  27 CCNM                  S01194
0177 I*************                       P  28  348SPOT                  S01194
0178 I*************                          35  37 CCYS                  S01194
0179 I*************                          38  380CDP                   S01194
0180 I*************                          39  390TNOT                  S01194
0181 I*************                          40  40 DCCY                  S01194
0182 I*************                          41  44 SRC1                  S01194
0183 I*************                          45  48 SRC2                  S01194
0184 I*************                          49  520TACC                  S01194
0185 I*************                          53  560TEQV                  S01194
0186 I*************                          57  600SWQV                  S01194
0187 I*************                          61  640TAC4                  S01194
0188 I*************                          65  680TAC5                  S01194
0189 I*************                          69  69 HIND                  S01194
0190 I*************                       P  70  768PART                  S01194
0191 I*************                          77  780SSNO                  S01194
0192 I*************                       P  79  858ERLC                  S01194
0193 I*************                       P  90  920LCD                   S01194
0194 I*************                          93  93 CHTP                  S01194
0195 I*************                       P  94  960TNLU                  S01194
0196 I*************                                                       S01194
0197 I*****TABLE FILE - NOSTROS RECORD.******************                 S01194
0198 I*************                                                       S01194
0199 I*TABLE***NS**07***1*CD***2*C7***3*C0*************                   S01194
0200 I*************                           1   1 RECI                  S01194
0201 I*************                           2   30RECT                  S01194
0202 I*************                           9  11 CCY                   S01194
0203 I*************                          12  130NOSN                  S01194
0204 I*************                          16  29 ONAC                  S01194
0205 I*************                          30  350CNUM                  S01194
0206 I*************                          36  370ACSQ                  S01194
0207 I*************                          38  410ACOD                  S01194
0208 I*************                       P  90  920LCD                   S01194
0209 I*************                          93  93 CHTP                  S01194
0210 I*************                       P  94  960TNLU                  S01194
0211 I*************                                                       S01194
0212 I*****TABLE*FILE*-*COUNTERPARTY NOSTROS RECORD.**********            S01194
0213 I*************                                                       S01194
0214 I*TABLE***NS**08***1*CD***2*C7***3*C1*************                   S01194
0215 I*************                           1   1 RECI                  S01194
0216 I*************                           2   30RECT                  S01194
0217 I*************                           6  13 CPSH                  S01194
0218 I*************                          14  48 CPNM                  S01194
0219 I*************                          49  68 CPTN                  S01194
0220 I*************                       P  90  920LCD                   S01194
0221 I*************                          93  93 CHTP                  S01194
0222 I*************                       P  94  960TNLU                  S01194
0223 I*************                                                       S01194
0224 I**CATCHALL*********                                                 S01194
0225 I********NS**67*****                                                 S01194
0226 I*************                                                       S01194
0227 I*****CLIENT*FILE*-*CUSTOMER STANDING DATA RECORD.************       S01194
0228 I*************                                                       S01194
0229 I*CLINT***NS*******1*CD***8*CA**********                             S01194
0230 I*************                           1   1 RECI                  S01194
0231 I*************                           2   70CNUM                  S01194
0232 I*************                           8   8 RCDT                  S01194
0233 I*************                           9  28 CRNM                  S01194
0234 I*************                          29  38 CTWN                  S01194
0235 I*************                          39  48 CSNM                  S01194
0236 I*************                          49  56 CASK                  S01194
0237 I*************                          57  68 TELX                  S01194
0238 I*************                          69  80 CSID                  S01194
0239 I*************                          81  82 ACOC                  S01194
0240 I*************                          83  83 CBSI                  S01194
0241 I*************                          84  85 CCTZ                  S01194
0242 I*************                          86  87 CLOC                  S01194
0243 I*************                          88  930CPAR                  S01194
0244 I*************                          94  960BRCDCB                S01194
0245 I*************                          97  980LINS                  S01194
0246 I*************                          99 1010LIND                  S01194
0247 I*************                       P 102 1040DASU                  S01194
0248 I*************                       P 105 1070CDIC                  S01194
0249 I*************                       P 108 1100DADE                  S01194
0250 I*************                         111 111 CMIN                  S01194
0251 I*************                         112 112 CTYP                  S01194
0252 I*************                         113 124 TELF                  S01194
0253 I*************                         125 133 CHID                  S01194
0254 I*************                         134 136 CHAB                  S01194
0231 I*************                         245 245 TLXR                  S01194
0255 I*************                       P 250 2520LCD                   S01194
0256 I*************                         253 253 CHTP                  S01194
0257 I*************                       P 254 2560TNLU                  S01194
0258 I*************                                                       S01194
0259 I*************                                                       S01194
0260 I*****CLIENT*FILE - CUSTOMER NAME AND ADDRESS RECORD.**********      S01194
0261 I*************                                                       S01194
0262 I********NS*******1*CD***8*CB**********                              S01194
0263 I*************                           1   1 RECI                  S01194
0264 I*************                           2   70CNUM                  S01194
0265 I*************                           8   8 RCDT                  S01194
0266 I*************                           9  43 CNA1                  S01194
0267 I*************                          44  78 CNA2                  S01194
0268 I*************                          79 113 CNA3                  S01194
0269 I*************                         114 148 CNA4                  S01194
0270 I*************                         240 249 CTWN                  S01194
0271 I*************                       P 250 2520LCD                   S01194
0272 I*************                         253 253 CHTP                  S01194
0273 I*************                       P 254 2560TNLU                  S01194
0274 I*************                                                       S01194
0275 I**CATCHALL****************                                          S01194
0052 I*************                                                       S01194
0276 I********NS**67************                                          S01194
0277 I* D A T A - S T R U C T U R E S
0278 I            DS
0279 I                                        1  45 RP21
0280 I                                        1  35 OURAGN
0281 I                                       36  45 OURAGT
0282 I*
0283 I            DS
0284 I**********                              1  24 RP22                  S01429
0285 I**********                              1   3 OCHABA                S01429
0286 I**********                              4  12 OCHID                 S01429
0287 I**********                             13  24 OSWADR                S01429
0284 I                                        1  25 RP22                  S01429
0285 I                                        1   4 OCHABA                S01429
0286 I                                        5  13 OCHID                 S01429
0287 I                                       14  25 OSWADR                S01429
0288 I*
0289 I            DS
0290 I                                        1  55 RP31
0291 I                                        1  35 THEIRN
0292 I                                       36  55 THEIRT
0293 I*
0294 I            DS
0295 I**********                              1  24 RP32                  S01429
0296 I**********                              1   3 TCHABA                S01429
0297 I**********                              4  12 TCHID                 S01429
0298 I**********                             13  24 TSWADR                S01429
0295 I                                        1  25 RP32                  S01429
0296 I                                        1   4 TCHABA                S01429
0297 I                                        5  13 TCHID                 S01429
0298 I                                       14  25 TSWADR                S01429
0299 I*
0300 I            DS
0301 I                                        1  55 RP41
0302 I                                        1  35 BENAME
0303 I                                       36  55 BETOWN
0304 I*
0305 I            DS
0306 I**********                              1  24 RP42                  S01429
0307 I**********                              1   3 BCHABA                S01429
0308 I**********                              4  12 BCHID                 S01429
0309 I**********                             13  24 BSWADR                S01429
0306 I                                        1  25 RP42                  S01429
0307 I                                        1   4 BCHABA                S01429
0308 I                                        5  13 BCHID                 S01429
0309 I                                       14  25 BSWADR                S01429
0310 I*
0311 I            DS
0312 I                                        1  65 RP61
0313 I                                        1  35 CPNAME
0314 I                                       36  45 CPRTWN
0315 I                                       46  65 CPRNAM
0316 I*
0317 I            DS
0318 I**********                              1  24 RP62                  S01429
0319 I**********                              1   3 CCHABA                S01429
0320 I**********                              4  12 CCHID                 S01429
0321 I**********                             13  24 CSWADR                S01429
0318 I                                        1  25 RP62                  S01429
0319 I                                        1   4 CCHABA                S01429
0320 I                                        5  13 CCHID                 S01429
0321 I                                       14  25 CSWADR                S01429
0322 I**TABLES*FILE**KEY**********                                        S01194
0323 I************DS                                                      S01194
0324 I**************                          1  12 ZTABKY                S01194
0325 I**************                          1   2 CODE                  S01194
0326 I**************                          8  10 CURR                  S01194
0327 I**************                         11  12 NOSTNO                S01194
0328 I**************                          9  11 CURX                  S01194
0329 I**************                         12  12 NOX                   S01194
0330 I**TABLES*FILE*KEY*FOR*COUNTERPARTY/NOSTROS**********                S01194
0331 I************DS                                                      S01194
0332 I**************                          1  12 CNOSKY                S01194
0333 I**************                          5  12 COUNTN                S01194
0334 I**CLIENT*FILE*KEY**********                                         S01194
0335 I************DS                                                      S01194
0336 I**************                          1   7 CLIKEY                S01194
0337 I**************                          1   6 CNUMK                 S01194
0338 I* CLIENT DETAILS
0339 I            DS
0340 I                                        1  65 NAMTWN
0341 I                                        1  35 CNA1
0342 I                                       36  45 CTWN
0343 I                                       46  65 CRNM
0344 I            DS
0345 I**********                              1  24 SWCH                  S01429
0346 I**********                              1   3 CHAB                  S01429
0347 I**********                              4  12 CHID                  S01429
0348 I**********                             13  24 CSID                  S01429
0345 I                                        1  25 SWCH                  S01429
0346 I                                        1   4 CHAB                  S01429
0347 I                                        5  13 CHID                  S01429
0348 I                                       14  25 CSID                  S01429
0349 I* COUNTERPARTY/NOSTRO DETAILS
0350 I            DS
0351 I                                        1  55 COUNOS
0352 I                                        1  35 CPNM
0353 I                                       36  55 CPTN
0354 I* OUR SETTLEMENT A/C * AGENT *
0355 I            DS
0356 I**********                              1  12 OSAC                                      CGL029
     I                                        1  18 OSAC                                      CGL029
0357 I                                        1   2 ONOS
0358 I                                        1   6 OCNUM
0359 I**********                              7  10 OACOD                                     CGL029
0360 I**********                             11  12 OACSQ                                     CGL029
0361 I                                        1  10 RETNO
     I                                        7  16 OACOD                                     CGL029
     I                                       17  18 OACSQ                                     CGL029
0362 I* THEIR AGENT
0363 I            DS
0364 I                                        1  10 TSEN
0365 I                                        1   6 CUST
0366 I                                        1   8 TCNOS
0367 I* BLANK FIELDS
0368 I            DS
0369 I                                        1  65 BLNK65
0370 I                                        1  24 BLNK24
0371 I                                        1  45 BLNK45
0372 I                                        1  55 BLNK55
0373 I                                        1   3 BLNK3
0374 I                                        1  10 BLNK10
0375 I                                        1  20 BLNK20
0376 I* FOR A/C OF
0377 I            DS
0378 I                                        1  10 FACO
0379 I                                        1   6 FCNUM
0380 I                                        1   8 CONOST
     I*
     I**   FIELDS USED FOR BENIFICIARY BANK DETAILS
     I            DS
     I                                        1  90 SPI
     I                                        1  30 SPIONE
     I                                        1   3 SPEC3
     I                                        1   5 SPEC5
     I                                        6   8 SPEC8
     I                                        1   8 SPEC9
     I                                        6  12 SPEC12
     I                                        9  14 SPEC14
     I                                        9  17 SPEC17
     I                                       10  18 SPEC18
     I                                        5  29 SPEC29
     I                                        6  30 SPEC30
      **                                                                  S01194
     ISDBANK    E DSSDBANKPD                                              S01194
      ** BANK DETAILS                                                     S01194
     I              BJURPT                          TITL                  S01194
      **                                                                  S01194
     ISDBRCH    E DSSDBRCHPD                                              S01194
      **  EXTERNAL DS FOR BRANCH CODE DETAILS
     I              A8BRNM                          BRNM                  S01194
     **                                                                   S01194
     ISDCNST    E DSSDCNSTPD                                              S01194
      **   COUNTER-PARTY NOSTROS                                          S01194
      **                                                                  S01194
     ISDCURR    E DSSDCURRPD                                              S01194
      **  EXTERNAL DS FOR CURRENCY CODES                                  S01194
     I              A6CYNM                          CCNM                  S01194
     I              A6NBDP                          CDP                   S01194
      **                                                                  S01194
     ISDCUST    E DSSDCUSTPD                                              S01194
      **   CUSTOMER                                                       S01194
     I              BBCNCZ                          CCTZ                  S01194
     I              BBACOC                          ACOC                  S01194
     I              BBCUST                          CNUM                  S01194
     I              QQDFAC                          DFACBK                                    CGL029
     ISDGELR    E DSSDGELRPD                                              S01194
      ** GENERAL LEDGER DETAILS                                           S01194
     I              BKACCD                          COMS                  S01194
     **                                                                   S01194
     ISDMMOD    E DSSDMMODPD                                              S01194
     I**  EXTERNAL DS FOR MIDAS MODULE CODES                              S01194
     **                                                                   S01194
     ISDNOST    E DSSDNOSTPD                                              S01194
      **  EXTERNAL DS FOR NOSTRO DETAILS                                  S01194
     I              A7NOSN                          CSNM                  S01194
     I              A7ACCD                          ACOD                  S01194
     I              A7ACSN                          ACSQ                  S01194
     I              QQACCD                          ACCDB1                                    CGL029
     **                                                                   S01194
     ISDRETL    E DSSDRETLPD                                              S01194
     I*  RETAIL DETAILS                                                   S01194
     I              BMACCD                          CADC                  S01194
     I              QQACCD                          ACCDB2                                    CGL029
     **                                                                   S01194
     ISDTRAD    E DSSDTRADPD                                              S01194
      **  ACCESS TO TRADING DETAILS                                       S01194
     I              BLACCD                          CSAC                  S01194
     I              QQACCD                          ACCDB3                                    CGL029
     I*                                                                   CLE033
     ISCSARD    E DSSCSARDPD                                              CLE033
     I** Switchable Feature details                                       CLE033
     I*                                                                   CLE033
     I*SDSVAL***E*DSSDSVALPD*                                                          CLE033 222373
      ****EXTERNAL*DS*FOR*SYSTEM*VALUES*                                               CLE033 222373
     I*
     IDSFDY     E DSDSFDY                                                 S01194
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01194
     I*                                                                   S01194
     IDSSDY     E DSDSSDY                                                 S01194
     I* SECOND DS FOR ACCESS PROGRAMS, LONG DATA STRUCTURE                S01194
      **                                                                  S01194
     I*
0381 I**      LOCAL DATA AREA FOR DATABASE ERROR REFERENCE
0382 I*
0383 ILDA        UDS                            256
0384 I***********                           134 138 DBFILE                S01117
0385 I***********                           139 167 DBKEY                 S01117
0386 I***********                           168 175 DBPGM                 S01117
0387 I***********                           176 177 DBASE                 S01117
0384 I                                      134 141 DBFILE                S01117
0385 I                                      142 170 DBKEY                 S01117
0386 I                                      171 180 DBPGM                 S01117
0387 I                                      181 1830DBASE                 S01117
     I*                                                                   S01117
     I**   FILE INFORMATION DATA STRUCTURE                                S01117
     I*                                                                   S01117
     ISPOOL       DS                                                      S01117
     I                                       83  92 SFILE                 S01117
     I                                    B 123 1240SFNUM                 S01117
     I**                                                                  S01117
     I**   FILE INFORMATION DATA STRUCTURE                                S01117
     I**                                                                  S01117
     ISPOOLU      DS                                                      S01117
     I                                       83  92 SFILEU                S01117
     I                                    B 123 1240SFNUMU                S01117
     I**                                                                  S01117
     IRUNDT       DS                                                      S01117
      **  DATA AREA RUNDAT                                                S01117
     I                                        1   7 RUNA                  S01117
     I                                    P   8  100RUND                  S01117
     I                                       11  11 SSF                   S01117
     I                                       12  12 DATF                  S01117
     I                                       13  13 MBIN                  S01117
     I/EJECT                                                              S01117
     C                     MOVEACPY@      BIS@   80
     C           *ENTRY    PLIST                                          S01117
     C                     PARM           SEQ     5        SEQUENCE       S01117
     C           PLIST2    PLIST                                          S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C                     PARM           CKEY    3                       S01194
     C           SDCURR    PARM SDCURR    DSSDY                           S01194
     C           PLIST3    PLIST                                          S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C                     PARM           KEYC   10                       S01194
     C                     PARM '*CNUM'   KEYSTS  7                       S01194
     C           SDCUST    PARM SDCUST    DSSDY                           S01194
     C           PLIST6    PLIST                                          S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C                     PARM           ARCD    8                       S01194
     C           SDCNST    PARM SDCNST    DSFDY                           S01194
     C           PLIST8    PLIST                                          S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C                     PARM           @KEYA   6                    A  S01194
     C                     PARM           @KEYB   3                    B  S01194
     C**********           PARM           @KEYC   4                    C               S01194 CGL029
     C                     PARM           @KEYC  10                    C                      CGL029
     C                     PARM           @KEYD   2                    D  S01194
     C                     PARM           @KEYE   2                    E  S01194
     C                     PARM           @KEYF   3                    F  S01194
     C                     PARM *BLANKS   CSSN   10                       S01194
     C                     PARM *BLANKS   PNOI    1                       S01194
     C           SDNOST    PARM SDNOST    DSFDY                           S01194
0388 I*
0389 I*
0390 C* 1 S T   C Y C L E   P R O C E S S I N G
0391 C   41                GOTO MAIN
0392 C   40                GOTO START
     C**                                                                  S01117
     C*     Hard code program to process 'ALL' branches                   S01117
     C**                                                                  S01117
     C                     MOVE 'ALL'     BRNCH   3                       S01117
0393 C                     SETON                     40
0394 C   U7                SETON                     80
0395 C                     SETOF                     U7
     C                     SETOF                     47                   S01117
      **                                                                  S01117
      **   IN THE DATAAREA RUNDAT                                         S01117
      **                                                                  S01117
     C           *NAMVAR   DEFN RUNDAT    RUNDT                           S01117
     C                     IN   RUNDT                                     S01117
     C*    DEFINE LDA                                                     S01117
     C           *NAMVAR   DEFN           LDA                             S01117
     C           *LOCK     IN   LDA                                       S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C                     SETON                     88                   S01117
     C                     END                                            S01117
     C*                                                                   S01117
0396 C**         FOR DATA BASE ERROR REFERENCE
0397 C*
0398 C                     MOVE 'LE0510  'DBPGM
0399 C                     MOVE ' '       BLANKS 29
0400 C                     MOVE BLANKS    DBKEY
0401 C                     EXSR ZSYSTM                                    S01194
0402 C***99********        SETON                     U7LRU8               S01194
0403 C***99********        MOVE '01'      DBASE                           S01194
0404 C***99********        MOVE 'TABLE'   DBFILE                          S01194
0405 C***99********        MOVELZTABKY    DBKEY                           S01194
0406 C   99                GOTO ENDDET                                    S01194
0407 C*************        MOVE '20'      ZTABKY                          S01194
0408 C***********ZTABKY    CHAINTABLE                67                   S01194
     C*                                                                   059539
     C** Access MIDAS Modules File.                                       059539
     C*                                                                   059539
     C                     CALL 'AOMMODR0'                                059539
     C                     PARM '*MSG   ' @RTCD   7                       059539
     C                     PARM '*FIRST ' @OPTN   7                       059539
     C           SDMMOD    PARM SDMMOD    DSFDY                           059539
     C           @RTCD     IFNE *BLANKS                                   059539
     C                     SETON                     U7U8LR               059539
     C                     SETON                     67                   059539
     C                     MOVEL'SDMMODPD'DBFILE             *************059539
     C                     MOVEL'05 '     DBASE              * DBERR 05  *059539
     C                     MOVEL@OPTN     DBOPTN  7          *************059539
     C                     MOVEL@OPTN     DBKEY                           059539
     C                     GOTO ENDDET                                    059539
     C                     END                                            059539
     C*                                                                   059539
     C** Access Retail Data File if Retail module is installed.           059539
     C*                                                                   059539
     C           BGRTBN    IFEQ 'Y'                                       059539
     C                     CALL 'AORETLR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDRETL    PARM SDRETL    DSFDY                           S01194
     C           @RTCD     IFNE *BLANK                                    S01194
0409 C                     SETON                     LRU7U8               S01194
0410 C                     MOVE '02'      DBASE                           S01194
0411 C                     MOVE 'SDRETLPD'DBFILE                          S01194
0413 C                     GOTO ENDDET                                    S01194
     C                     END                                            S01194
     C                     END                                            059539
     C*                                                                   059539
0409 C**N04**********      SETON                     LRU7U8               S01194
0410 C**N04**********      MOVE '02'      DBASE                           S01194
0411 C**N04**********      MOVE 'TABLE'   DBFILE                          S01194
0412 C**N04**********      MOVE ZTABKY    DBKEY                           S01194
0413 C**N04**********      GOTO ENDDET                                    S01194
0414 C***************      MOVE '40'      ZTABKY                          S01194
0415 C***********ZTABKY    CHAINTABLE                67                   S01194
      ** ACCESS TRADING DATA                                              S01194
     C                     CALL 'AOTRADR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDTRAD    PARM SDTRAD    DSFDY                           S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     SETON                     67                   S01194
0416 C                     SETON                     LRU7U8               S01194
0417 C                     MOVE '03'      DBASE                           S01194
0418 C                     MOVE 'SDTRADPD'DBFILE                          S01194
0420 C                     GOTO ENDDET                                    S01194
     C                     END                                            S01194
      ** ACCESS GENERAL LEDGER DETAILS                                    S01194
     C**********           CALL 'AOGELRR0'                                             S01194 CGL029
     C                     CALL 'AOGELRR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C********** SDGELR    PARM SDGELR    DSFDY                                        S01194 CGL029
     C           SDGELR    PARM SDGELR    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANKS                                   S01194
     C                     MOVEL'SDGELRPD'DBFILE             *************S01194
     C                     MOVEL'06'      DBASE              * DBERR 06  *S01194
     C                     MOVEL@OPTN     DBOPTN  7          *************S01194
     C                     MOVEL@OPTN     DBKEY                           S01194
     C                     GOTO ENDDET                                    S01194
     C                     END                                            S01194
     C*
     C**ACCESS*MIDAS*MODULES***************************************S01194 059539
     C***********          CALL 'AOMMODR0'                         S01194 059539
     C***********          PARM '*MSG   ' @RTCD   7                S01194 059539
     C***********          PARM '*FIRST ' @OPTN   7                S01194 059539
     C***********SDMMOD    PARM SDMMOD    DSFDY                    S01194 059539
     C***********@RTCD     IFNE *BLANKS                            S01194 059539
     C***********          SETON                     U7U8LR        S01194 059539
     C***********          SETON                     67            S01194 059539
     C***********          MOVEL'SDMMODPD'DBFILE      *************S01194 059539
     C***********          MOVEL'05 '     DBASE       * DBERR 05  *S01194 059539
     C***********          MOVEL@OPTN     DBOPTN  7   *************S01194 059539
     C***********          MOVEL@OPTN     DBKEY                    S01194 059539
     C***********          GOTO ENDDET                             S01194 059539
     C***********          END                                     S01194 059539
0416 C**N05*********       SETON                     LRU7U8               S01194
0417 C**N05********        MOVE '03'      DBASE                           S01194
0418 C**N05********        MOVE 'TABLE'   DBFILE                          S01194
0419 C**N05********        MOVE ZTABKY    DBKEY                           S01194
0420 C**N05********        GOTO ENDDET                                    S01194
0421 C                     Z-ADD0         TCOUNT  50
0422 C**********           MOVE 'A'       CLIKEY                          S01194
0423 C**********           MOVEL'71'      CNOSKY                          S01194
0424 C                     MOVE ' '       SBLANK 30
     C*
     C*    IF "TELEX TO BE SENT" INDICATOR IS ON, CHECK IF LE/TX
     C*    INTERFACE IS IN SYSTEM
     C*
     C**********           TESTB'3'       TLXM           70               S01194
     C           BGMTMI    COMP 'Y'                      70               S01194
     C   70                SETON                     30
     C*
     C                     Z-ADD0         TOTLX   30
     C*
     C*    BUILD ARRAY OF ASTERISKS FOR OUTPUT TO AN INCOMPLETE TELEX
     C*
     C                     MOVE '*'       ASTAR
      *                                                                   CLE033
      ** Check if CLE033 is ON                                            CLE033
      *                                                                   CLE033
     C                     CALL 'AOSARDR0'                                CLE033
     C                     PARM *BLANKS   @RTCD                           CLE033
     C                     PARM '*KEY   ' @OPTN                           CLE033
     C                     PARM 'CLE033'  PSARD   6                       CLE033
     C           SCSARD    PARM SCSARD    DSFDY                           CLE033
      *                                                                   CLE033
     C           @RTCD     IFEQ *BLANKS                                   CLE033
     C                     MOVE 'Y'       CLE033  1                       CLE033
      *                                                                   CLE033
      ** Retrieve Settlement 09 customer and account code system values   CLE033
      *                                                                   CLE033
     C                     CALL 'AOSVALR0'                                CLE033
     C                     PARM *BLANKS   @RTCD                           CLE033
     C                     PARM SVAL,1    P@OP01 20                       CLE033
     C                     PARM *BLANKS   P@VL01200                       CLE033
     C                     PARM SVAL,2    P@OP02 20                       CLE033
     C                     PARM *BLANKS   P@VL02200                       CLE033
     C                     PARM *BLANKS   P@OP03 20                       CLE033
     C                     PARM *BLANKS   P@VL03200                       CLE033
     C                     PARM *BLANKS   P@OP04 20                       CLE033
     C                     PARM *BLANKS   P@VL04200                       CLE033
     C                     PARM *BLANKS   P@OP05 20                       CLE033
     C                     PARM *BLANKS   P@VL05200                       CLE033
     C                     PARM *BLANKS   P@OP06 20                       CLE033
     C                     PARM *BLANKS   P@VL06200                       CLE033
     C                     PARM *BLANKS   P@OP07 20                       CLE033
     C                     PARM *BLANKS   P@VL07200                       CLE033
     C                     PARM *BLANKS   P@OP08 20                       CLE033
     C                     PARM *BLANKS   P@VL08200                       CLE033
     C                     PARM *BLANKS   P@OP09 20                       CLE033
     C                     PARM *BLANKS   P@VL09200                       CLE033
     C                     PARM *BLANKS   P@OP10 20                       CLE033
     C                     PARM *BLANKS   P@VL10200                       CLE033
     C*****      SDSVAL    PARM SDSVAL    DSSDY                                        CLE033 222373
      *                                                                   CLE033
     C           @RTCD     IFNE *BLANK                                    CLE033
     C                     MOVEL'SDSVALPD'DBFILE           ************   CLE033
     C                     MOVEL'CLE033 ' DBKEY            * DBERR 10 *   CLE033
     C                     MOVEL'010'     DBASE            ************   CLE033
     C                     MOVE *ON       *INU7                           CLE033
     C                     MOVE *ON       *INU8                           CLE033
     C                     MOVE *ON       *INLR                           CLE033
     C                     MOVE *ON       *IN67                           CLE033
     C                     GOTO ENDDET                                    CLE033
     C                     ENDIF                                          CLE033
      *                                                                   CLE033
     C                     ELSE                                           CLE033
     C                     MOVE 'N'       CLE033                          CLE033
      *                                                                   CLE033
     C           @RTCD     IFNE '*NRF    '                                CLE033
     C                     MOVEL'SCSARDPD'DBFILE             *************CLE033
     C                     Z-ADD11        DBASE              * DBERR 011 *CLE033
     C                     MOVEL'CLE033'  DBKEY              *************CLE033
     C                     SETON                     U7U8LR               CLE033
     C                     SETON                     67                   CLE033
     C                     GOTO ENDDET                                    CLE033
     C                     ENDIF                                          CLE033
      *                                                                   CLE033
     C                     ENDIF                                          CLE033
     C*
0425 C* S T A R T
0426 C           START     TAG                             ** START TAG **
0427 C  N01                GOTO ENDDET
0428 C* DETAIL PROCESSING FOR 1ST DETAIL RECORD
0429 C                     SETON                     41
0430 C                     EXSR HEADER
0431 C                     GOTO ENTRY1
0432 C/SPACE 3
0433 C* M A I N   P R O C E S S I N G
0434 C           MAIN      TAG                             ** MAIN TAG **
0435 C                     SETOF                     57                   S01117
     C                     SETOF                     3132
0435 C  N01                GOTO ENDDET
0436 C   L1                Z-ADD0         TCOUNT
0437 C           TCOUNT    COMP 2                    66  66
0438 C   66                SETON                     L1
0439 C   66                Z-ADD0         TCOUNT
0440 C   L1                EXSR HEADER
0441 C           ENTRY1    TAG                             ** ENTRY1 TAG**
     C*                                                                   S01117
     C**   MULTIBRANCH MAIN PROCESSING                                    S01117
     C*                                                                   S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C*                                                                   S01117
     C**   IF OSBR IS LESS THAN THE REQUIRED BRANCH,                      S01117
     C**   SKIP THE CALCULATION                                           S01117
     C*                                                                   S01117
     C           BRNCH     IFGT OSBR                                      S01117
     C           BRNCH     ANDNE'ALL'                                     S01117
     C                     SETOF                     13                   S01117
     C                     GOTO ENDDET                                    S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C**   IF OSBR IS GREATER THAN THE REQUIRED BRANCH,                   S01117
     C**   END THE PROGRAM                                                S01117
     C*                                                                   S01117
     C           BRNCH     IFLT OSBR                                      S01117
     C           BRNCH     ANDNE'ALL'                                     S01117
     C                     SETON                     LR                   S01117
     C                     SETOF                     13                   S01117
     C                     GOTO ENDDET                                    S01117
     C                     END                                            S01117
     C**                                                                  S01117
     C           *INL6     IFEQ '1'                                       S01117
     C                     CLOSELE0510P1                                  S01117
     C**                                                                  S01117
     C*    IF MBIN=YES, AND A REQUIRED BRANCH AND A LEVEL BREAK,          S01117
     C*    OPEN LE0510P1                                                  S01117
     C**                                                                  S01117
     C           BRNCH     IFEQ 'ALL'                                     S01117
     C           BRNCH     OREQ OSBR                                      S01117
     C                     SETON                     13                   S01117
     C                     MOVE 'Y'       P1OP                            S01117
     C                     OPEN LE0510P1                                  S01117
     C*                                                                   057347
     C** Close file SDBRCHL1 (Branch Code) on access object AOBRCHR0      057347
     C*                                                                   057347
     C**********           CALL 'AOBRCHR0'                                             057347 CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       057347
     C                     PARM '*FREE  ' @OPTN   7                       057347
     C                     PARM           @DSNB   3                       057347
     C********** SDBRCH    PARM SDBRCH    DSFDY                                        057347 CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C*                                                                   057347
     C                     Z-ADD0         PAGE                            S01117
     C                     Z-ADD0         PAGE1                           S01117
     C**                                                                  S01117
     C*    ENSURE REPORT SPOOL FILE RECORDED BY RCF                       S01117
     C**                                                                  S01117
     C                     Z-ADDSFNUM     ZSNUM   60                      S01117
     C                     OUT  LDA                                       S01117
     C**                                                                  S01117
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           SEQ                             S01117
     C                     PARM OSBR      SENTY                           S01117
     C                     PARM           SFILE                           S01117
     C                     PARM           ZSNUM                           S01117
     C                     PARM           ZSERR   1                       S01117
      *                                                                   S01117
     C           *LOCK     IN   LDA                                       S01117
     C           ZSERR     IFEQ 'Y'                                       S01117
      **  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM       S01117
     C                     SETON                     U7U8LR               S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C**                                                                  S01117
     C** RETRIEVE BRANCH NAME FROM SDBRCHPD                               S01117
     C**                                                                  S01117
     C***********BRNCH     IFNE 'ALL'                              E37385 057347
     C**********           CALL 'AOBRCHR0'                                             S01117 CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       S01117
     C                     PARM '*KEY   ' @OPTN   7                       S01117
     C                     PARM OSBR      @DSNB   3                       S01117
     C********** SDBRCH    PARM SDBRCH    DSFDY                                        S01117 CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C***********                                                  E37385 057347
     C***********          ELSE                                    E37385 057347
     C***********          CALL 'AOBRCHR0'                         E37385 057347
     C***********          PARM '*MSG   ' @RTCD   7                E37385 057347
     C***********          PARM '*NEXT  ' @OPTN   7                E37385 057347
     C***********          PARM           @DSNB                    E37385 057347
     C***********SDBRCH    PARM SDBRCH    DSFDY                    E37385 057347
     C***********          END                                     E37385 057347
     C           @RTCD     IFNE *BLANK                                    S01117
     C                     SETON                     U7U8LR               S01117
     C                     MOVEL'SDBRCHPD'DBFILE                          S01117
     C                     MOVEL@DSNB     DBKEY            ***************S01117
     C                     MOVEL@OPTN     DBOPTN  7        * DBERROR 004 *S01117
     C                     MOVEL'004'     DBASE            ***************S01117
     C                     END                                            S01117
     C   U7                GOTO ENDDET                                    S01117
     C                     ELSE                                           S01117
     C                     SETOF                     13                   S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C**                                                                  S01117
     C                     ELSE                                           S01117
     C**                                                                  S01117
     C*       IF MBIN='N' AND FIRST CYCLE,                                S01117
     C*       OPEN LE0510P1                                               S01117
     C**                                                                  S01117
     C           P1OP      IFNE 'Y'                                       S01117
     C                     SETON                     13    ALLOW OUTPUTPUTS01117
     C                     MOVE 'Y'       P1OP    1                       S01117
     C                     OPEN LE0510P1                                  S01117
     C                     Z-ADD0         PAGE                            S01117
     C                     Z-ADD0         PAGE1                           S01117
     C**                                                                  S01117
     C*       ENSURE REPORT SPOOL FILE RECORDED BY RCF                    S01117
     C**                                                                  S01117
     C                     Z-ADDSFNUM     ZSNUM                           S01117
     C                     OUT  LDA                                       S01117
     C**                                                                  S01117
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           SEQ                             S01117
     C                     PARM *BLANKS   SENTY   3                       S01117
     C                     PARM           SFILE                           S01117
     C                     PARM           ZSNUM                           S01117
     C                     PARM           ZSERR                           S01117
      *                                                                   S01117
     C           *LOCK     IN   LDA                                       S01117
     C           ZSERR     IFEQ 'Y'                                       S01117
      **  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM       S01117
     C                     SETON                     U7U8LR               S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C*                                                                   S01117
0442 C           TCOUNT    ADD  1         TCOUNT
0443 C           SPI,1     COMP SBLANK                   25
0444 C           SPI,2     COMP SBLANK                   26
0445 C           SPI,3     COMP SBLANK                   27
0446 C                     SETOF                     28
0447 C   25 26 27          SETON                     28
     C*
     C**   CHECK BENIFICIARY BANK DETAILS
     C*
     C**   IGNORE IF FIRST LINE OF SPECIAL INSTRUCTIONS IS BLANK
     C   25                GOTO BENEND
     C*
     C           SPEC5     COMP '/BEN/'              313132
     C   31                GOTO BENEND
     C*
     C**   CHECK FOR CHIPS NUMBER
     C           SPEC8     COMP '/CH'                    31
     C   31                MOVE SPEC14    WORK6   6
     C   31                MOVE *BLANKS   SPIONE
     C   31                MOVE 'CHIPS'   SPEC5
     C   31                MOVE WORK6     SPEC12
     C   31                GOTO BENEND
     C*
     C**   CHECK FOR FED. WIRE NUMBER
     C           SPEC8     COMP '/FW'                    31
     C   31                MOVE SPEC17    WORK9   9
     C   31                MOVE *BLANKS   SPIONE
     C   31                MOVE 'FED.WIRE'SPEC9
     C   31                MOVE WORK9     SPEC18
     C   31                GOTO BENEND
     C*
     C**   MUST NOW BE 'ACCOUNT'
     C                     MOVE SPEC30    WORK25 25
     C                     MOVE *BLANKS   SPIONE
     C                     MOVE 'A/C'     SPEC3
     C                     MOVE WORK25    SPEC29
     C*
     C           BENEND    TAG                             * BENEND TAG *
     C*
0448 C**
0449 C**   DETERMINE IF FACILITY TELEX
0450 C**
0451 C                     MOVELFCLN      FCLN1   1
0452 C********   FCLN1     COMP 'F'                      69                                   CLE148
     C           FCLN1     COMP ' '                      69                                   CLE148
0453 C   51                EXSR PAY
0454 C   52                EXSR RECEIV
0455 C   60                Z-ADDEAMT      WK13
0456 C   61      EAMT      DIV  10        WK13   130
0457 C   62      EAMT      DIV  100       WK13
0458 C   63      EAMT      DIV  1000      WK13
0459 C           TESTOT    ADD  WK13      TESTOT 150
0460 C           EAMT      DIV  1000      ZZAMT
0461 C***20*****           Z-SUBZZAMT     ZZAMT                                               219063
0462 C                     EXSR GLZADD
0463 C*
0464 C           ENDDET    TAG                             ** ENDDET TAG**
0465 C           RECIN     ADD  1         RECIN   50
0466 C   02                SETON                     LR
0467 C/SPACE 3
     C**                                                                  S01117
     C*       ENSURE TOTAL SPOOL FILE RECORDED BY RCF                     S01117
     C**                                                                  S01117
0393 CLR U7N40             SETON                     80                                     BUG11461
0394 CLR U7N40             SETOF                     U7                                     BUG11461
     CLR                   Z-ADDSFNUMU    ZSNUMU  60                      S01117
     CLR                   OUT  LDA                                       S01117
     C**                                                                  S01117
     CLR                   CALL 'ZSFILE'                                  S01117
     CLR                   PARM           SEQ     5                       S01117
     CLR                   PARM *BLANK    SENTY   3                       S01117
     CLR                   PARM           SFILEU                          S01117
     CLR                   PARM           ZSNUMU                          S01117
     CLR                   PARM           ZSERR   1                       S01117
      *                                                                   S01117
     CLR         *LOCK     IN   LDA                                       S01117
     CLR         ZSERR     IFEQ 'Y'                                       S01117
      **  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM       S01117
     CLR                   SETON                     U7U8                 S01117
     CLR                   RETRN                                          S01117
     CLR                   END                                            S01117
     C**                                                                  S01117
     CLR         P1OP      IFNE 'Y'                                       S01117
     CLR                   EXSR #ZZ                                       S01117
     CLR                   END                                            S01117
     C**                                                                  S01117
     CLR         TOTLX     COMP 0                    21
     CLR         MBIN      IFEQ 'N'                                       S01117
     CLR         MBIN      OREQ 'Y'                                       S01117
     CLR         BRNCH     ANDEQ'ALL'                                     S01117
0468 CLR         NORE      COMP RECIN                U8U8
0469 CLRNU8      HRWN      COMP ZZTOTI               U8U8
0470 CLRNU8      HRDC      COMP ZZTOTD               U8U8
     CLR                   END                                            S01117
      **                                                                  S01117
     CLR    U7 U8          EXSR *PSSR                                     S01117
0471 C/EJECT
0472 C* S U B R O U T I N E S
0473 C*
0564 C/SPACE 3
0565 C********************************************************************
0566 C* SUBROUTINE TO ADD AN AMOUNT (ZZAMT) TO THE TOTAL (ZZTOTI,ZZTOTD)
0567 C*   IND '99' IS SET BY AN OVERFLOW ERROR
0568 C*
0569 CSR         GLZADD    BEGSR                           *** GLZADD ****
0570 C*
0571 CSR                   Z-ADDZZAMT     ZZAMT  153     91-DEFINE ZZAMT
0572 CSR 91                GOTO ZZAEND                     AMT = 0.BYPASS
0573 C*
0574 C* SPLIT ZZAMT INTO INTEGER AND DECIMAL FIELDS
0575 CSR                   Z-ADDZZAMT     ZZAMTI 150       INTEGER FIELD
0576 CSR                   MOVE ZZAMT     ZZAMTD  30       DECIMAL FIELD
0577 C* BOTH ZZAMTI AND ZZAMTD CONTAIN A 'SIGN' ZONE NOW
0578 C*
0579 CSR                   EXSR GLZSUM
0580 CSR         ZZAEND    ENDSR                           ** ZZAEND TAG *
0581 C*
0582 C********************************************************************
0583 C* SUBROUTINE TO CARRY OUT THE ADDITION FOR SUBROUTINES -
0584 C*                        GLZADD, GLZSUB, GLZCMP.
0585 C*          PARAMETERS PASSED -
0586 C*                     I/P ZZAMTI ZZAMTD
0587 C*                     O/P ZZTOTI ZZTOTD ZZNEGD IND 96 IND 99.
0588 C*
0589 CSR         GLZSUM    BEGSR                           *** GLZSUM ****
0590 C*
0591 CSR                   Z-ADDZZTOTI    ZZTOTI 150       DEFINE ZZTOTI
0592 CSR                   Z-ADDZZTOTD    ZZTOTD  30       DEFINE ZZTOTD
0593 CSR                   SETOF                     919293
0594 CSR                   SETOF                     949599
0595 C*
0596 C*    DETERMINE SIGN OF ZZAMTI & D,   92 IF NEG
0597 CSR         ZZAMTI    COMP 0                      9293
0598 CSR 93      ZZAMTD    COMP 0                      9293
0599 CSR 93                GOTO ZZSEND                     ZERO BYPASS
0600 C*
0601 C*    DETERMINE SIGN OF ZZTOTI & D, 91 IF NEG.
0602 CSR         ZZTOTI    COMP 0                      9193
0603 CSR 93      ZZTOTD    COMP 0                      9193
0604 C*
0605 C*    IF ZZTOTAL IS ZERO, RETURN ZZAMOUNT.
0606 CSR 93                Z-ADDZZAMTI    ZZTOTI
0607 CSR 93                Z-ADDZZAMTD    ZZTOTD
0608 CSR 93                GOTO ZZSEND                     ZERO BYPASS
0609 C*    IF SIGNS DIFFER BYPASS OVERFLOW CHECKS.
0610 CSR 91N92
0611 CORN91 92             GOTO ZZOFPS
0612 C*
0613 CSR         ZZAMTD    ADD  ZZTOTD    ZZWK2   40
0614 CSR         ZZWK2     COMP 999                  93    '93' = CARRY
0615 CSRN93      ZZWK2     COMP -999                   93    INTO INTEGER.
0616 C*
0617 CSR 93N92   ZZAMTI    ADD  1         ZZWK3  150       ADD 'CARRY' +VE
0618 CSR    93 92ZZAMTI    SUB  1         ZZWK3            SUB 'CARRY' -VE
0619 CSR 93      ZZTOTI    ADD  ZZWK3     ZZWK3
0620 CSRN93      ZZTOTI    ADD  ZZAMTI    ZZWK3
0621 C*
0622 C* IF THE MODULUS OF ZZWK3 IS LT MOD. ZZTOTI THEN O/F HAS OCCURED
0623 CSRN92      ZZWK3     COMP ZZTOTI                 99  -92 MEANS NOS.
0624 CSR 92      ZZWK3     COMP ZZTOTI               99     NEGATIVE
0625 CSRN99                Z-ADDZZWK2     ZZTOTD
0626 CSRN99                Z-ADDZZWK3     ZZTOTI
0627 C*
0628 C* IF O/F ZEROIZE ZZAMT , IND '99' SET AND ZZTOT FIELDS LEFT INTACT.
0629 CSR 99                Z-ADD0         ZZAMT  153
0630 CSR                   GOTO ZZSEND
0631 C*
0632 C* THE 'SIGNS' ARE DIFFERENT
0633 CSR         ZZOFPS    TAG                             ** ZZOFPS TAG**
0634 C* IF ZZAMT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZTOT
0635 C*
0636 CSR 92                Z-SUBZZAMTI    ZZAMTI 150
0637 CSR 92                Z-SUBZZAMTD    ZZAMTD  30
0638 C*
0639 C* IF ZZTOT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZAMT.
0640 C*
0641 CSR 91                Z-SUBZZTOTI    ZZTOTI
0642 CSR 91                Z-SUBZZTOTD    ZZTOTD
0643 C* BOTH ZZAMT AND ZZTOT ARE NOW POSITIVE.
0644 C*
0645 CSR         ZZTOTI    COMP ZZAMTI               93  95
0646 CSR 95      ZZTOTD    COMP ZZAMTD               93  95
0647 C*
0648 C* IF ZZTOT EQ. ZZAMT RETURN ZERO.
0649 CSR 95                Z-ADD0         ZZTOTI
0650 CSR 95                Z-ADD0         ZZTOTD
0651 CSR 95                GOTO ZZSEND
0652 C*
0653 C* IF ZZTOT GT. ZZAMT.
0654 CSR 93      ZZAMTD    COMP ZZTOTD               94
0655 CSR 93 94   ZZTOTI    SUB  1         ZZTOTI
0656 CSR 93 94   ZZTOTD    ADD  1000      ZZWK2
0657 CSR 93      ZZTOTI    SUB  ZZAMTI    ZZTOTI
0658 CSR 93 94   ZZWK2     SUB  ZZAMTD    ZZTOTD
0659 CSR 93N94   ZZTOTD    SUB  ZZAMTD    ZZTOTD
0660 C*
0661 C*
0662 C* IF ZZAMT GT. ZZTOT.
0663 CSRN93      ZZTOTD    COMP ZZAMTD               94
0664 CSRN93 94   ZZAMTI    SUB  1         ZZWK3  150
0665 CSRN93 94   ZZAMTD    ADD  1000      ZZWK2
0666 CSRN93 94   ZZWK3     SUB  ZZTOTI    ZZTOTI
0667 CSRN93N94   ZZAMTI    SUB  ZZTOTI    ZZTOTI
0668 CSRN93 94   ZZWK2     SUB  ZZTOTD    ZZTOTD
0669 CSRN93N94   ZZAMTD    SUB  ZZTOTD    ZZTOTD
0670 C*
0671 C* REVERSE SIGN OF ZZTOT IF LARGER I/P FIELDS WERE NEGATIVE
0672 CSR                   SETOF                     94
0673 CSR 93 91
0674 CORN93 92             SETON                     94
0675 CSR 94                Z-SUBZZTOTI    ZZTOTI
0676 CSR 94                Z-SUBZZTOTD    ZZTOTD
0677 C**
0678 C**   RESTORE SIGN OF ZZAMTI & ZZAMTD IF IT WAS REVERSED.
0679 CSR 92                Z-SUBZZAMTI    ZZAMTI
0680 CSR 92                Z-SUBZZAMTD    ZZAMTD
0681 CSR         ZZSEND    TAG                             ** ZZSEND TAG *
0682 C**
0683 C**   IF ZZTOTD IS ZERO, AND ZZTOTI IS NEG. SET UP ZZNEGD.
0684 CSR                   SETOF                     96
0685 CSR         ZZTOTD    COMP 0                        91
0686 CSR 91      ZZTOTI    COMP 0                      96
0687 CSR 96                MOVE '.000-'   ZZNEGD  5
0688 CSR                   ENDSR                             ** ENDSR **
0689 C********************************************************************
0690 C/EJECT
0691 C********************************************************************
0692 C*
0693 C*          SUBROUTINE TO FIND COMMON INFORMATION FOR TELEXES
0694 C*            CALLED FROM : MAIN PROCESSING
0695 C*            CALLS :       ZDATE2
0696 C*
0697 C           HEADER    BEGSR                           ***  HEADER ***
     C**********           Z-ADD0         NOSTRO                                              CSD027
     C                     MOVE *BLANKS   NOSTRO                                              CSD027
0698 C                     SETOF                     545545
     C                     SETOF                     70
0699 C           PYRC      COMP 'P'                  525251
0700 C                     MOVE BLNK45    RP21
0701 C                     MOVE BLNK24    RP22
0702 C* O U R   A G E N T - 'CASE' ON SETTLEMENT TYPE
0703 C           SETP      COMP 00                       66
0704 C  N66                GOTO CELSE1
0696 C*N U L L
0706 C                     GOTO CEND1
0707 C           CELSE1    TAG                             * CELSE1 TAG *
0708 C                     SETOF                     545545
     C           SETP      COMP 01                   666670
0710 C   66      SETP      COMP 02                   6666
0711 C   66      SETP      COMP 07                   666654
0712 C   66      SETP      COMP 08                   666655
0713 C   66      SETP      COMP 12                   6666
0714 C*    FOR OUTPUT CONDITIONING
0715 C   54
0716 COR 55                SETON                     45
0717 C   66                GOTO CELSE2
0718 C           OSAC      COMP ' '                      66
0719 C************         MOVE CCY       CURR                            S01194
0720 C************         MOVE ONOS      NOSTNO                          S01194
0721 C***66*******         MOVE '00'      NOSTNO                          S01194
0722 C************         MOVE '70'      CODE                            S01194
0723 C***********ZTABKY    CHAINTABLE                67                   S01194
     C                     SETOF                       67                 BHF550
0719 C                     MOVE CCY       @KEYB                           S01194
0720 C                     MOVE ONOS      @KEYE                           S01194
     C                     CALL 'AONOSTR0'PLIST8                          S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     SETON                       67                 S01194
     C                     END                                            S01194
0724 C  N67                GOTO NOER1
0725 C                     MOVELMESS,1    OURAGN
     C*    IF NOSTRO NOT FOUND OR BLANK THEN TELEX CAN'T BE SENT
     C                     SETOF                     70
0726 C                     GOTO CEND1
0727 C           NOER1     TAG                             ** NOER1 TAG **
     C*                                                                   BHF251
     C** Customer number field on SDNOSTPD is A7CUST, not CNUM.           BHF251
     C***********          MOVE CNUM      NOSTRO  60                      BHF251
     C**********           MOVE A7CUST    NOSTRO  60                                   BHF251 CSD027
     C                     MOVE A7CUST    NOSTRO  6                                           CSD027
     C*                                                                   BHF251
0728 C*************        MOVE CNUM      CNUMK                           S01194
0729 C*************        MOVE 'B'       CLIKEY                          S01194
0730 C***********CLIKEY    CHAINCLINT                67                   S01194
0732 C**N67********        MOVE 'A'       CLIKEY                          S01194
0734 C**N67********        MOVE SWCH      RP22                            S01194
0733 C**N67******CLIKEY    CHAINCLINT                67                   S01194
     C*                                                                   BHF251
     C** Customer number field on SDNOSTPD is A7CUST, not CNUM.           BHF251
0728 C***********          MOVE CNUM      KEYC                     S01194 BHF251
0728 C                     MOVE *BLANK    KEYC                            BHF550
0728 C                     MOVE A7CUST    KEYC                            BHF251
     C*                                                                   BHF251
     C                     CALL 'AOCUSTR0'PLIST3                          S01194
     C*                                                                   S01194
     C           @RTCD     IFNE *BLANKS                                   S01194
     C                     SETON                     67                   S01194
     C                     ELSE                                           S01194
0341 C                     MOVE BBCNA1    CNA1                            S01194
0342 C                     MOVE BBCRTN    CTWN                            S01194
0343 C                     MOVE BBCRNM    CRNM                            S01194
0347 C                     MOVE BBCHID    CHID                            S01194
0348 C                     MOVE BBCSID    CSID                            S01194
0346 C**********           MOVE BBCABA    CHABN   30                S01194S01429
0346 C                     MOVE BBCABA    CHABN   40                      S01429
0346 C                     MOVE CHABN     CHAB                            S01194
     C                     END                                            S01194
0734 C  N67                MOVE SWCH      RP22                            S01194
0731 C  N67                MOVELNAMTWN    RP21                            S01194
0696 C*
     C*    IF CUSTOMER NOT FOUND TELEX CAN'T BE SENT
     C*
0735 C   67                SETOF                     70
     C*
     C*    CHECK SWIFT I.D. ON S/CLINT IF BLANK AND SWIFT SEND A TELEX
     C*
     C           CSID      COMP BLNK20                   71
     C   55 71N67          SETON                     70
0735 C   67                MOVELMESS,2    OURAGN
     C*
     C*    IF TELEX TO BE SENT INDICATOR ON CHECK IF LENDING/TELEX
     C*    INTERFACE IS IN SYSTEM
     C*
     C***70*****           TESTB'3'       TLXM           70               S01194
     C   70      BGMTMI    COMP 'Y'                      70               S01194
     C*
     C*    CHECK IF TELEXES TO BE GENERATED FOR THIS CUSTOMER
     C*
     C***70*30**           TESTB'3'       TLXR           70               S01194
     C   70 30   BBCMTI    COMP 'Y'                      70               S01194
     C   70 30             ADD  1         TOTLX
     C*
0736 C                     GOTO CEND1
0737 C           CELSE2    TAG                             * CELSE2 TAG *
0738 C           SETP      COMP 03                       66
0739 C  N66                GOTO CELSE3
0740 C                     MOVE BICN      CUST
0741 C                     MOVE CSAC      ACOD
0742 C                     MOVE '01'      ACSQ
0743 C                     GOTO CEND1
0744 C           CELSE3    TAG                             * CELSE3 TAG *
0745 C           SETP      COMP 06                       66
0746 C  N66                GOTO CELSE4
0747 C                     MOVE BICN      CUST
0748 C                     MOVE COMS      ACOD
0749 C                     MOVE '01'      ACSQ
0750 C                     GOTO CEND1
0751 C           CELSE4    TAG                             * CELSE4 TAG *
0752 C           SETP      COMP 05                       66
0753 C  N66                GOTO CELSE5
0754 C                     MOVE OCNUM     CUST
0755 C                     MOVE OACOD     ACOD
0756 C                     MOVE OACSQ     ACSQ
0757 C                     GOTO CEND1
0758 C           CELSE5    TAG                             * CELSE5 TAG *
0759 C* TYPE '14' WILL NOT OCCUR.
0760 C*          SETP      COMP 14                       66
0761 C* N66                GOTO CELSE6
0762 C*                    GOTO CEND1
0763 C*          CELSE6    TAG                             * CELSE6 TAG *
0764 C           SETP      COMP 04                       66
0765 C  N66                GOTO CELSE7
0766 C                     MOVE CADC      ACOD
0767 C                     MOVE '01'      ACSQ
0768 C                     GOTO CEND1
0769 C           CELSE7    TAG                             * CELSE7 TAG *
     C           SETP      COMP 09                       66               CLE033
     C  N66                GOTO CEND1                                     CLE033
      * Settlement 09 customer                                            CLE033
     C                     MOVELP@VL01    CUST                            CLE033
      * Settlement 09 account code                                        CLE033
     C                     MOVELP@VL02    ACOD                            CLE033
     C                     MOVE '01'      ACSQ                            CLE033
     C                     GOTO CEND1                                     CLE033
0770 C* N U L L
0771 C           CEND1     TAG                             * CEND1 TAG *
0772 C*
0773 C                     Z-ADDVDAT      ZDAYNO           CONVERT
0774 C                     EXSR ZDATE2                       VALUE DATE
0775 C*
0776 C*************        MOVE '20'      CODE             GET CCY NAME   S01194
0777 C*************        MOVE '        'ZTABKY                          S01194
0778 C*************        MOVE CCY       CURX                            S01194
0779 C*************        MOVE '1'       NOX                             S01194
0780 C***********ZTABKY    CHAINTABLE                67                   S01194
0778 C*                                                                   BHF251
0778 C** Currency key field is CKEY, not KEYC (KEYC is for customers).    BHF251
     C                     SETOF                     67                   BHF550
0778 C***********          MOVE CCY       KEYC                     S01194 BHF251
0778 C                     MOVE CCY       CKEY                            BHF251
0778 C*                                                                   BHF251
     C                     CALL 'AOCURRR0'PLIST2                          S01194
     C           @RTCD     IFNE *BLANKS                                   S01194
     C                     SETON                     67                   S01194
     C                     END                                            S01194
0781 C   67                MOVELMESS,3    CCNM                            S01194
0782 C           CDP       COMP 1                    626061
0783 C           CDP       COMP 2                    63  62
0784 C*
0785 C                     ENDSR
0786 C********************************************************************
0787 C***ECT
0788 C/SPACE 3
0789 C********************************************************************
0790 C*
0791 C*          SUBROUTINE FOR PROCESSING PAY TELEXES
0792 C*            CALLED FROM : MAIN PROCESSING
0793 C*            CALLS :       CLIEN1,CLIEN2,CPNOST
0794 C*
0795 C           PAY       BEGSR                           ****  PAY  ****
0796 C                     MOVE BLNK55    RP31
0797 C                     MOVE BLNK24    RP32
0798 C* IF SETTLEMENT TYPES EQ 01 07 OR 08.
0799 C           SETP      COMP 01                       66
0800 C  N66N54N55          GOTO ENDTHR
0801 C*************        MOVE CUST      CNUMK                           S01194
0728 C                     MOVE *BLANK    KEYC                            BHF550
0801 C                     MOVE CUST      KEYC                            S01194
0802 C**************       EXSR CLIEN1                                    S01194
0803 C                     EXSR CLIEN2
0804 C                     MOVE SWCH      RP32
0805 C                     MOVELNAMTWN    RP31
0806 C                     MOVE BLNK10    RP31
0807 C  N67                GOTO ENDTHR                     CLIENT FOUND
0808 C**************       MOVE CONOST    COUNTN                          S01194
0808 C                     MOVE CONOST    COUNTN  8                       S01194
0809 C                     EXSR CPNOST
0810 C                     MOVELCOUNOS    RP31
     C                     MOVELCOUNOS    RP31T  55
     C*    COUNTERPARTY NOSTRO & CUSTOMER NOT FOUND TELEX IS INCOMPLETE
     C   67 70             MOVEAASTAR     RP31T
0811 C           ENDTHR    TAG                             ** ENDTHR TAG**
0812 C* GET BENEFICIARY DETAILS
0813 C                     MOVE BLNK55    RP41
0814 C           FACO      COMP ' '                      49
0815 C   49                GOTO ENDFAC
0816 C* IF SETTLEMENT TYPES EQ 01 07 OR 08.
0817 C*  IND '66' IS STILL SET
0818 C  N66N54N55          GOTO ENDFAC
0819 C**************       MOVE FCNUM     CNUMK                           S01194
0728 C                     MOVE *BLANK    KEYC                            BHF550
0819 C                     MOVE FCNUM     KEYC                            S01194
0820 C                     EXSR CLIEN1
0821 C                     MOVELCRNM      BENAME
0822 C                     MOVELCTWN      BETOWN
0823 C  N67                GOTO ENDFAC
0824 C                     MOVE CONOST    COUNTN
0825 C                     EXSR CPNOST
0826 C                     MOVE COUNOS    RP41
0827 C           ENDFAC    TAG                             ** ENDFAC TAG**
0828 C************         MOVE CNUMPH    CNUMK                           S01194
0728 C                     MOVE *BLANK    KEYC                            BHF550
0828 C                     MOVE CNUMPH    KEYC                            S01194
0829 C                     EXSR CLIEN1
0830 C                     ENDSR                           ** ENDSR **
0831 C********************************************************************
0832 C/SPACE 3
0833 C********************************************************************
0834 C*
0835 C*          SUBROUTINE TO PROCESS RECEIVE TELEXES
0836 C*            CALLED FROM : MAIN PROCESSING
0837 C*            CALLS : CLIEN1,CLIEN2,CPNOST
0838 C*
0839 C           RECEIV    BEGSR                           *** RECEIV ***
     C                     SETOF                     49                   E16145
0840 C* GET THEIR AGENT DETAILS
0841 C                     MOVE BLNK24    RP32
0842 C                     MOVE BLNK55    RP31
0843 C           SETP      COMP 01                       66IF SET.MENT TYP
0844 C  N66N54N55          GOTO CPARTY                       EQ 01 07 08.
0845 C************         MOVE CUST      CNUMK                           S01194
0728 C                     MOVE *BLANK    KEYC                            BHF550
0845 C                     MOVE CUST      KEYC                            S01194
0846 C**************       EXSR CLIEN1                                    S01194
0847 C                     EXSR CLIEN2
0848 C                     MOVELNAMTWN    RP31
0849 C                     MOVE BLNK10    RP31
0850 C                     MOVE SWCH      RP32
0851 C  N67                GOTO CPARTY
0852 C                     MOVE TCNOS     COUNTN
0853 C                     EXSR CPNOST
0854 C                     MOVE COUNOS    RP31
     C                     MOVELCOUNOS    RP31T
     C*    COUNTERPARTY NOSTRO & CUSTOMER NOT FOUND TELEX IS INCOMPLETE
     C   67 70             MOVEAASTAR     RP31T
0855 C*
0856 C* GET COUNTERPARTY DETAILS
0857 C           CPARTY    TAG                             ** CPARTY TAG**
0858 C**********           MOVE CNUMPH    CNUMK                           S01194
0728 C                     MOVE *BLANK    KEYC                            BHF550
0858 C                     MOVE CNUMPH    KEYC                            S01194
0859 C                     EXSR CLIEN1
0860 C                     ENDSR                           ** ENDSR **
0861 C********************************************************************
0862 C/EJECT
0863 C********************************************************************
0864 C* SUBROUTINE TO GET COUNTERPARTY/NOSTRO INFOMATION
0865 C* CALLED BY PAY,RECEIV
0866 C           CPNOST    BEGSR                           *** CPNOST ***
     C                     SETOF                     67                   BHF550
0867 C                     MOVE BLNK55    COUNOS
0868 C***********CNOSKY    CHAINTABLE                67                   S01194
     C                     MOVELCOUNTN    ARCD                            S01194
     C                     CALL 'AOCNSTR0'PLIST6                          S01194
     C           @RTCD     IFNE *BLANKS                                   S01194
     C                     SETON                     67                   S01194
     C                     ELSE                                           S01194
     C                     MOVE AWCPNM    CPNM                            S01194
     C                     MOVE AWCNTN    CPTN                            S01194
     C                     END                                            S01194
0869 C   67                MOVELMESS,4    CPNM                            S01194
0870 C                     ENDSR
0871 C********************************************************************
0872 C/SPACE 3
0873 C********************************************************************
0874 C* SUBROUNTINE TO SETUP CLIENT INFOMATION FROM THE 1ST CLIENT RECORD
0875 C* CALLED BY PAY,RECEIV
0876 C           CLIEN1    BEGSR                           *** CLIEN1 ***
0877 C                     MOVE BLNK65    NAMTWN
0878 C                     MOVE BLNK24    SWCH
0879 C************         MOVE 'A'       CLIKEY                          S01194
0880 C***********CLIKEY    CHAINCLINT                67                   S01194
     C                     CALL 'AOCUSTR0'PLIST3                          S01194
     C*                                                                   S01194
     C           @RTCD     IFNE *BLANKS                                   S01194
     C                     SETON                     67                   S01194
0881 C   67                MOVELMESS,2    CRNM                            S01194
0882 C   67                MOVELMESS,2    CTWN                            S01194
     C                     ELSE                                           S01194
0341 C                     MOVE BBCNA1    CNA1                            S01194
0342 C                     MOVE BBCRTN    CTWN                            S01194
0343 C                     MOVE BBCRNM    CRNM                            S01194
0347 C                     MOVE BBCHID    CHID                            S01194
0348 C                     MOVE BBCSID    CSID                            S01194
0346 C**********           MOVE BBCABA    CHABN   30                S01194S01429
0346 C                     MOVE BBCABA    CHABN   40                      S01429
0346 C                     MOVE CHABN     CHAB                            S01194
     C                     END                                            S01194
0883 C                     ENDSR
0884 C********************************************************************
0885 C/SPACE 3
0886 C********************************************************************
0887 C* SUBROUTINE TO SETUP CLIENT INFOMATION FROM BOTH RECORDS
0888 C* CALLED BY PAY,RECEIV
0889 C           CLIEN2    BEGSR                           *** CLIEN2 ***
0890 C************         MOVE 'A'       CLIKEY                          S01194
0891 C***********CLIKEY    CHAINCLINT                67                   S01194
     C                     CALL 'AOCUSTR0'PLIST3                          S01194
     C************         GOTO CLIERR                                    S01194
     C           @RTCD     IFNE *BLANKS                                   S01194
     C                     SETON                     67                   S01194
0898 C                     MOVE BLNK65    NAMTWN                          S01194
0899 C                     MOVE BLNK24    SWCH                            S01194
0900 C                     MOVELMESS,2    CRNM                            S01194
0901 C                     MOVELMESS,2    CTWN                            S01194
0902 C                     MOVELMESS,2    CNA1                            S01194
     C                     ELSE                                           S01194
0341 C                     MOVE BBCNA1    CNA1                            S01194
0342 C                     MOVE BBCRTN    CTWN                            S01194
0343 C                     MOVE BBCRNM    CRNM                            S01194
0347 C                     MOVE BBCHID    CHID                            S01194
0348 C                     MOVE BBCSID    CSID                            S01194
0346 C**********           MOVE BBCABA    CHABN   30                S01194S01429
0346 C                     MOVE BBCABA    CHABN   40                      S01429
0346 C                     MOVE CHABN     CHAB                            S01194
     C                     END                                            S01194
0893 C************         MOVE 'B'       CLIKEY                          S01194
0894 C***********CLIKEY    CHAINCLINT                67                   S01194
0895 C************         MOVE 'A'       CLIKEY                          S01194
0896 C**N67*******         GOTO CLIEND                                    S01194
0897 C***********CLIERR    TAG                             ** CLIERR TAG**S01194
0898 C*************        MOVE BLNK65    NAMTWN                          S01194
0899 C*************        MOVE BLNK24    SWCH                            S01194
0900 C*************        MOVELMESS,2    CRNM                            S01194
0901 C*************        MOVELMESS,2    CTWN                            S01194
0902 C*************        MOVELMESS,2    CNA1                            S01194
0903 C***********CLIEND    ENDSR                           ** CLIEND TAG**S01194
0903 C                     ENDSR                           ** CLIEND TAG**S01194
0904 C********************************************************************
0905 C/EJECT
0906 C********************************************************************
0907 C**
0908 C**   ZSYSTM SR. TO CHAIN TO THE INSTALLATION CONTROL DATA RECORD.
0909 C**
0910 C           ZSYSTM    BEGSR                           *** ZSYSTM ***
0911 C***********                                                         S01194
0912 C*****SET*UP KEY FOR INSTALLATION CONTROL RECORD.                    S01194
0913 C***********          MOVEL'01      'ZTABKY 12                       S01194
0914 C***********          MOVE '  10'    ZTABKY                          S01194
0915 C***********                                                         S01194
0916 C***********ZTABKY    CHAINTABLE                99    ON NOT THERE   S01194
      ** ACCESS BANK DETAILS                                              S01194
     C                     CALL 'AOBANKR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDBANK    PARM SDBANK    DSFDY                           S01194
     C           @RTCD     IFNE *BLANKS                                   S01194
     C                     SETON                     99                   S01194
     C                     END                                            S01194
0917 C**N99******RECI      COMP 'D'                  9999  ON, IS DELETED S01194
0918 C**
0919 C**   CHECK SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.
0920 C           DATF      COMP 'M'                      98MMDDYY, 98 ON
0921 C**
0922 C                     ENDSR
0923 C**
0924 C**
0925 C********************************************************************
     C*                                                                   S01117
     C** PRINT OUT NO DETAIL TO REPORT IN LE0510P1                        S01117
     C*                                                                   S01117
0454 C           #ZZ       BEGSR                           *** #ZZ    *** S01117
     C**                                                                  S01117
     C                     OPEN LE0510P1                                  S01117
     C                     Z-ADD*ZEROS    PAGE                            S01117
     C                     Z-ADD*ZEROS    PAGE1                           S01117
     C                     MOVE BRNCH     OSBR                            S01117
     C                     MOVE *BLANKS   BRNM                            S01117
     C**                                                                  S01117
     C*    ENSURE REPORT SPOOL FILE RECORDED BY RCF                       S01117
     C**                                                                  S01117
     C                     Z-ADDSFNUM     ZSNUM                           S01117
     C                     OUT  LDA                                       S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C           BRNCH     ANDNE'ALL'                                     S01117
     C                     MOVE BRNCH     SENTY                           S01117
     C                     ELSE                                           S01117
     C                     MOVE *BLANKS   SENTY                           S01117
     C                     END                                            S01117
     C**                                                                  S01117
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           SEQ                             S01117
     C                     PARM           SENTY                           S01117
     C                     PARM           SFILE                           S01117
     C                     PARM           ZSNUM                           S01117
     C                     PARM           ZSERR   1                       S01117
      *                                                                   S01117
     C           *LOCK     IN   LDA                                       S01117
     C           ZSERR     IFEQ 'Y'                                       S01117
      **  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM       S01117
     C                     SETON                     U7U8LR               S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
      *                                                                   S01117
     C** To get Branch Name                                               S01117
      *                                                                   S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C           BRNCH     ANDNE'ALL'                                     S01117
     C**********           CALL 'AOBRCHR0'                                             S01117 CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       S01117
     C                     PARM '*KEY   ' @OPTN   7                       S01117
     C                     PARM BRNCH     @DSNB   3                       S01117
     C********** SDBRCH    PARM SDBRCH    DSFDY                                        S01117 CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANK                                    S01117
     C                     SETON                     U7U8LR               S01117
     C                     MOVEL'SDBRCHPD'DBFILE                          S01117
     C                     MOVEL@DSNB     DBKEY            ***************S01117
     C                     MOVEL@OPTN     DBOPTN  7        * DBERROR 013 *S01117
     C                     MOVEL'013'     DBASE            ***************S01117
     C                     END                                            S01117
     C                     END                                            S01117
      *                                                                   S01117
     C                     SETON                     47                   S01117
     C                     EXCPTNODTL                                     S01117
0466 C                     ENDSR                                          S01117
     C*                                                                   S01117
0497 C********************************************************************S01117
     C*                                                                   S01117
     C* *PSSR  --- SUBROUTINE TO HANDLE ABNORMAL ERROR CONDITIONS         S01117
     C*                                                                   S01117
     C* CALLED FROM: AFTER ABNORNAL OPERATION OCCURS                      S01117
     C*                                                                   S01117
     C* CALLS: NOTHING                                                    S01117
     C*                                                                   S01117
     C********************************************************************S01117
     C*                                                                   S01117
     C           *PSSR     BEGSR                           ** *PSSR **    S01117
     C*                                                                   S01117
     C           @RUN      IFEQ *BLANKS                                   S01117
     C                     MOVE 'Y'       @RUN    1                       S01117
     C                     DUMP                                           S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C                     ENDSR                           ** *PSSR **    S01117
     C********************************************************************S01117
     C/COPY ZSRSRC,ZDATE2Z4                                               S01392
     C********************************************************************S01392
0926 C/EJECT
     O*E0510P1H**203   L1                                       S01117    S01117
     OLE0510P1H  203   L1 13                                              S01117
0928 O*******OR**      U7 LR                                              S01117
0928 O       OR        U7 LR 13                                           S01117
0929 O                         TITL      60
0930 O********H**1     L1                                                 S01117
0930 O        H  1     L1 13                                              S01117
0931 O*******OR**      U7 LR                                              S01117
0931 O       OR        U7 LR 13                                           S01117
0932 O***********                        17 'REFERENCE LE0510-'           S01117
0932 O***********                        19 'REFERENCE LE0510P1-'         S01117
0932 O                                   19 'REFERENCE LE0510P1'          S01117
0933 O***********            51          19 '01'                          S01117
0933 O                       51          21 '01'                          S01117
0934 O***********            52          19 '02'                          S01117
0934 O                       52          21 '02'                          S01117
0935 O                    51             37 'OTHER PAY TELEX'
0936 O                    51 54          27 'CHIPS'
0937 O                    51 55          27 'SWIFT'
0938 O                       52          41 'OTHER RECEIVE TELEX'
0939 O                    52 54          27 'CHIPS'
0940 O                    52 55          27 'SWIFT'
0941 O                                   50 'DATE'
0942 O                         RUNA      58
0943 O                                   64 'PAGE'
0944 O                         PAGE  Z   69
0945 O********H**2     L1                                                 S01117
0945 O        H  2     L1 13                                              S01117
0946 O*******OR**      U7 LR                                              S01117
0946 O       OR        U7 LR 13                                           S01117
0947 O                       51          37 '---------------'
0948 O                       52          41 '-------------------'
0949 O********H**2     L1                                                 S01117
0949 O        H  1     L1 13                                              S01117
0950 O*******OR**      U7 LR                                              S01117
0950 O       OR        U7 LR 13                                           S01117
0951 O*****                               6 'BRANCH'                      S01117
0952 O*****                    BRCD      10                               S01117
     O                 88                20 'BRANCH OF SETTLEMENT'        S01117
     O                 88      OSBR      24                               S01117
     O                 88                25 '-'                           S01117
     O                 88      BRNM      55                               S01117
0949 O******  H 11     L1 13                                              S01117
0949 O        H  1     L1 13                                              S01117
0950 O       OR        U7 LR 13                                           S01117
0953 O*****                              40 '*** INCOMPLETE ***'          S01117
     O                                   43 '*** INCOMPLETE ***'          S01117
0954 O                                   59 'EXCEPTION'
0955 O                      N80          59 'NON-EXCEPTION'
0956 O********H**1     L1NU7                                              S01117
0956 O        H 11     L1NU7 13                                           S01117
0957 O                                   11 'DESTINATION'
0958 O                         OURAGN    48
0959 O********H**2     L1NU7                                              S01117
0959 O        H  2     L1NU7 13                                           S01117
0960 O                         OURAGT    23
0960 O                 70 U4            115 '** TELEX  GENERATED ** '
0961 O********H**2     L1NU7                                              S01117
0961 O        H  2     L1NU7 13                                           S01117
0962 O                                    5 'TEST:'
0963 O********H**3     L1NU7                                              S01117
0963 O        H  3     L1NU7 13                                           S01117
0964 O                                    5 'VALUE'
0965 O                         ZADATE    13
0966 O                       51          22 '   PAY'
0967 O                       52          22 'RECEIVE'
0968 O                         CCNM      37
0969 O* PAY TELEXES
0970 O        D  1     01 51NU7
0970 O       AND       13                                                 S01117
0971 O                       45           6 'PAY TO'
0972 O                       55TSWADR    24
0973 O                       54TCHABA    24
0974 O                       54          31 'CHIPS'
0975 O                       55          31 'SWIFT'
0976 O                                   44 'REF'
0977 O                         FCLN      51
     O                                   52 '/'                           S01117
     O***********              BRCD      55                               S01117
     O                         BRCA      55                               S01117
0978 O                                   64 'AMOUNT'
     O        D  1     01 51NU7                                           E25975
     O       AND       13                                                 E25975
     O                       60EAMT      68 ' ,   ,   ,   , 0 -'          E25975
     O                       61EAMT      68 '   ,   ,   , 0 . -'          E25975
     O                       62EAMT      68 '  ,   ,   , 0 .  -'          E25975
     O                       63EAMT      68 ' ,   ,   , 0 .   -'          E25975
0979 O        D  1     01 51NU7
0980 O*******AND*           N45                                           S01117
0980 O       AND       13   N45                                           S01117
0981 O                                    6 'PAY TO'
0982 O                         THEIRN    47
0983 O        D  2     01 51NU7
0984 O*******AND*           N45                                           S01117
0984 O       AND       13   N45                                           S01117
0985 O                         THEIRT    32
0986 O        D 12     01 51NU7
0987 O*******AND*            54                                           S01117
0987 O       AND       13    54                                           S01117
0988 O                                   10 'ACCOUNT OF'
0989 O                         TCHID     21
0990 O                                   31 'CHIPS'
0991 O        D 11     01 51N54
0992 O*******AND*     NU7                                                 S01117
0992 O       AND      NU7 13                                              S01117
0993 O                                   10 'ACCOUNT OF'
0994 O                      N49BENAME    47
0995 O**********             49CRNM      32                               S01273
0995 O                       49BBCNA1    47                               S01273
0996 O********D* 2     01 51N54                                           S01273
0996 O        D  1     01 51N54                                           S01273
0997 O*******AND*     NU7                                                 S01117
0997 O       AND      NU7 13                                              S01117
0998 O                      N49BETOWN    32
0999 O**********             49CTWN      22                               S01273
0999 O                       49BBCNA2    47                               S01273
0996 O        D  1     01 51N54                                           S01273
0997 O       AND      NU7 13                                              S01273
0999 O                       49BBCNA3    47                               S01273
0996 O        D  1     01 51N54                                           S01273
0997 O       AND      NU7 13                                              S01273
0999 O                       49BBCNA4    47                               S01273
1000 O        D  1     01 51NU7
     O       AND       13                                                 S01117
1001 O                      N49          11 'BY ORDER OF'
1002 O**********            N49CRNM      32                               S01273
1002 O                      N49BBCNA1    47                               S01273
1003 O********D* 2     01 51NU7                                           S01273
1003 O        D  1     01 51NU7                                           S01273
     O       AND       13                                                 S01117
1004 O**********            N49CTWN      22                               S01273
1004 O                      N49BBCNA2    47                               S01273
1003 O        D  1     01 51NU7                                           S01273
     O       AND       13                                                 S01273
1004 O                      N49BBCNA3    47                               S01273
1003 O        D  1     01 51NU7                                           S01273
     O       AND       13                                                 S01273
1004 O                      N49BBCNA4    47                               S01273
1005 O        D  1     01 51NU7
     O       AND       13                                                 S01117
1006 O                      N28          10 'SPEC INSTR'
     O                    32N28          10 'BENIF BANK'
1007 O                      N25SPI,1     42
1008 O***********            60EAMT      68 ' ,   ,   ,   , 0 -'          E25975
1009 O***********            61EAMT      68 '   ,   ,   , 0 . -'          E25975
1010 O***********            62EAMT      68 '  ,   ,   , 0 .  -'          E25975
1011 O***********            63EAMT      68 ' ,   ,   , 0 .   -'          E25975
1012 O        D  1     01 51NU7
1013 O*******AND*           N26                                           S01117
1013 O       AND       13   N26                                           S01117
     O                    32N28          10 'SPEC INSTR'
1014 O                         SPI,2     42
1015 O        D  1     01 51NU7
1016 O*******AND*           N27                                           S01117
1016 O       AND       13   N27                                           S01117
1017 O                         SPI,3     42
1018 O        D 31     01 51NU7
     O       AND       13                                                 S01117
1019 O                                   20 ' '
1020 O*   RECEIVE TELEXES
1021 O        D  1     01 52NU7
     O       AND       13                                                 S01117
1022 O                       45           8 'REC FROM'
1023 O                       55TSWADR    24
1024 O                       54TCHABA    24
1025 O                       55          31 'SWIFT'
1026 O                       54          31 'CHIPS'
1027 O                      N69          44 'REF'
1028 O                       69          37 'REF'
1029 O                       69CNUMPH    44
1030 O                         FCLN      51
     O                                   52 '/'                           S01117
     O***********              BRCD      55                               S01117
     O                         BRCA      55                               S01117
1031 O                                   64 'AMOUNT'
     O        D  1     01 52NU7                                           E25975
     O       AND       13                                                 E25975
     O                       60EAMT      68 ' ,   ,   ,   , 0 -'          E25975
     O                       61EAMT      68 '   ,   ,   , 0 . -'          E25975
     O                       62EAMT      68 '  ,   ,   , 0 .  -'          E25975
     O                       63EAMT      68 ' ,   ,   , 0 .   -'          E25975
1032 O        D  1     01 52N45
1033 O*******AND*     NU7                                                 S01117
1033 O       AND      NU7 13                                              S01117
1034 O                                    8 'REC FROM'
1035 O                         THEIRN    47
1036 O        D  1     01 52N45
1037 O*******AND*     NU7                                                 S01117
1037 O       AND      NU7 13                                              S01117
1038 O                         THEIRT    22
1039 O        D 11     01 52NU7
     O       AND       13                                                 S01117
1040 O                      N49          11 'BY ORDER OF'
1041 O**********            N49CRNM      32                               S01273
1041 O                      N49BBCNA1    47                               S01273
1042 O********D* 2     01 52NU7                                           S01273
1042 O        D  1     01 52NU7                                           S01273
     O       AND       13                                                 S01117
1043 O**********            N49CTWN      22                               S01273
1043 O                      N49BBCNA2    47                               S01273
1042 O        D  1     01 52NU7                                           S01273
     O       AND       13                                                 S01273
1043 O                      N49BBCNA3    47                               S01273
1042 O        D  1     01 52NU7                                           S01273
     O       AND       13                                                 S01273
1043 O                      N49BBCNA4    47                               S01273
1044 O********D**3     01 52NU7                                           E25975
     O*******AND*      13                                          S01117 E25975
1045 O***********            60EAMT      68 ' ,   ,   ,   , 0 -'          E25975
1046 O***********            61EAMT      68 '   ,   ,   , 0 . -'          E25975
1047 O***********            62EAMT      68 '  ,   ,   , 0 .  -'          E25975
1048 O***********            63EAMT      68 ' ,   ,   , 0 .   -'          E25975
1049 O        D  1     01 52N45
1050 O*******AND*     NU7                                                 S01117
1050 O       AND      NU7 13                                              S01117
1051 O                                   20 ' '
1052 O        T 32     U7 U8 LR
     O       AND       13                                                 S01117
1053 O                                   42 '*** REFERENCE'               S01117
1054 O***********              DBPGM     51                               S01117
1054 O                         DBPGM     52                               S01117
1055 O***********                        71 '-DATABASE ERROR AT'          S01117
1055 O                                   71 'DATABASE ERROR ***'          S01117
1056 O***********              DBASE     74                               S01117
1057 O********T**1     U7 U8 LR                                           S01117
1058 O***********                        37 'FILE NAME'                   S01117
1059 O***********              DBFILE    43                               S01117
1060 O***********                        48 'KEY'                         S01117
1061 O***********              DBKEY     78                               S01117
1062 O********T** 58   L2 41                                              S01117
1062 O        T   58   L2 41 13                                           S01117
1063 O                                   10 'TEST TOTAL'
1064 O                         TESTOT1B  31
0409 OLE0510P1E  203           NODTL                                      S01117
     O                                   24 'REFERENCE  LE0510P1'         E32589
0929 O**********               TITL      60                         S01117E32589
     O                         TITL      89                               E32589
0941 O                                  103 'DATE'                        E32589
0942 O                         RUNA     112                               E32589
0943 O                                  122 'PAGE'                        E32589
0944 O                         PAGE  Z  128                               E32589
     O        E  1             NODTL                                      S01117
     O**********                         19 'REFERENCE LE0510P1-'   S01117E32589
     O*                                                                   E32589
     O*                                                                   E32589
     O*                                                                   E32589
     O**********                         57 'INCOMPLETE PAY/RECEIVE'E32589CB0042
     O                                   65 'INCOMPLETE PAY/RECEIVE'      CB0042
     O                                   80 'TELEXES REPORT'              E32589
0933 O**********             51          41 '01'                    S01117E32589
0934 O**********             52          41 '02'                    S01117E32589
0935 O**********          51             57 'OTHER PAY TELEX'       S01117E32589
0936 O**********          51 54          47 'CHIPS'                 S01117E32589
0937 O**********          51 55          47 'SWIFT'                 S01117E32589
0938 O**********             52          51 'OTHER RECEIVE TELEX'   S01117E32589
0939 O**********          52 54          47 'CHIPS'                 S01117E32589
0940 O**********          52 55          47 'SWIFT'                 S01117E32589
0941 O**********                         50 'DATE'                  S01117E32589
0942 O**********               RUNA      58                         S01117E32589
0943 O**********                         64 'PAGE'                  S01117E32589
0944 O**********               PAGE  Z   69                         S01117E32589
0945 O        E  2             NODTL                                      S01117
0947 O**********             51          37 '---------------'       S01117E32589
0948 O**********             52          41 '-------------------'   S01117E32589
     O***********                        56 '---------------'       E32589CB0042
     O***********                        70 '---------------'       E32589CB0042
     O                                   65 '----------------------'      CB0042
     O                                   80 '--------------'              CB0042
0949 O        E  1             NODTL                                      S01117
     O                 88N47             20 'BRANCH OF SETTLEMENT'        S01117
     O                 88N47   OSBR      24                               S01117
     O                 88N47             25 '-'                           S01117
     O                 88N47   BRNM      55                               S01117
0949 O********E**2             NODTL                                      S01117
     O***********                        43 '*** INCOMPLETE ***'    S01117BHF653
0954 O***********                        59 'EXCEPTION'             S01117BHF653
0955 O***********           N80          59 'NON-EXCEPTION'         S01117BHF653
     O        E 3              NODTL                                      S01117
     O***********                        70 '***   NO DETAILS TO REPS01117BHF653
     O***********                        78 'RT   ***'              S01117BHF653
     O***********                        40 '***   NO DETAILS TO REPBHF653E32589
     O***********                        48 'RT   ***'              BHF653E32589
     O                                   68 '***   NO DETAILS TO REPO'    E32589
     O                                   76 'RT   ***'                    E32589
     O        E 3              NODTL                                      S01117
     O**********       88N47             66 '*** END OF REPORT FOR' S01117BHF653
     O**********       88N47             74 ' BRANCH '              S01117BHF653
     O**********       88N47   OSBR      77                         S01117BHF653
     O**********       88N47             81 ' ***'                  S01117BHF653
0518 O**********       88 47             76 '*** END OF REPORT ***' S01117BHF653
     O**********       88N47             36 '*** END OF REPORT FOR' BHF653E32589
     O**********       88N47             44 ' BRANCH '              BHF653E32589
     O**********       88N47   OSBR      47                         BHF653E32589
     O**********       88N47             51 ' ***'                  BHF653E32589
     O                 88N47             66 '*** END OF REPORT FOR'       E32589
     O                 88N47             74 ' BRANCH '                    E32589
     O                 88N47   OSBR      77                               E32589
     O                 88N47             81 ' ***'                        E32589
     O**********       88 47             42 '*** END OF REPORT ***' BHF653E32589
0518 O                 88 47             71 '*** END OF REPORT ***'       E32589
     O        T 2      L6 88 13                                           S01117
     O       OR        LRN88 13                                           S01117
     O                 88N47             66 '*** END OF REPORT FOR'       S01117
     O                 88N47             74 ' BRANCH '                    S01117
     O                 88N47   OSBR      77                               S01117
     O                 88N47             81 ' ***'                        S01117
0518 O                 88 47             76 '*** END OF REPORT ***'       S01117
1065 O*
1066 O* C O N T R O L S
1067 O*****   T  203   LR                                                 S01117
     OLE0510AUT  203   LR                                                 S01117
1068 O***********              TITL      60                               E15645
1069 O********T**2     LR                                                 E15645
1070 O***********                        17 'REFERENCE LE0510'            S01117
1070 O                                   19 'REFERENCE LE0510AU'          S01117
1071 O***********                        50 'DATE'                        E15645
1072 O***********              RUNA      58                               E15645
1073 O***********                        64 'PAGE'                        E15645
1074 O***********              PAGE  Z   69                               E15645
1068 O                         TITL      89                               E15645
1071 O                                  104 'DATE'                        E15645
1072 O                         RUNA     113                               E15645
1073 O                                  122 'PAGE'                        E15645
1074 O***********              PAGE  Z  127                      E15645   S01117
1074 O                         PAGE1 Z  127                               S01117
1075 O        T  1     LR
1076 O***********                        18 'INCOMPLETE'                  E15645
1077 O***********                        43 'PAY/RECEIVE TELEXES - FI'    E15645
1078 O***********                        60 'LE CONTROL REPORT'           E15645
1076 O***********                        33 'INCOMPLETE'            E15645S01117
1076 O                                   32 'INCOMPLETE'                  S01117
1077 O                                   57 'PAY/RECEIVE TELEXES - FI'    E15645
1078 O                                   74 'LE CONTROL REPORT'           E15645
1079 O        T  2     LR
1080 O***********                        19 '-----------'                 E15645
1081 O***********                        43 '------------------------'    E15645
1082 O***********                        60 '-----------------'           E15645
1080 O                                   33 '-----------'                 E15645
1081 O                                   57 '------------------------'    E15645
1082 O                                   74 '-----------------'           E15645
1083 O        T  3     LR
1084 O                                   60 'EXCEPTION'
1085 O                      N80          60 'NON-EXCEPTION'
1086 O        T  1     LR
1087 O                                   22 'S/STX2 - RUN CONTROLS'
1088 O***********                        45 'NUMBER'                      E15645
1088 O                                   50 'NUMBER'                      E15645
1089 O                                   68 'VALUE'
1090 O        T  2     LR
1091 O                                   22 '----------------------'
1092 O***********                        45 'OF RECORDS'                  E15645
1092 O                                   50 'OF RECORDS'                  E15645
1093 O                                   68 'OF RECORDS'
1094 O        T  2     LR
1095 O***********                        24 'TOTAL RECORDS - ON FILE'     E15645
1095 O                                   22 'CONTROL TOTALS - FILE'       E15645
1095 O                                   34 'CONTROL REC'                 E15645
1096 O***********           NU7NORE  3   45                               E15645
1096 O                      NU7NORE  3   50                               E15645
1097 O                      NU7HRWN  Z   65
1098 O**********            NU7HRDC      68                                                   219063
     O                      NU7HRDC  L   69                                                   219063
1099 O        T  2     LR
1100 O***********                        25 'TOTAL RECORDS - CALCULAT'    E15645
1101 O***********                        27 'ED'                          E15645
1100 O                                   17 'CONTROL TOTALS -'            E15645
1101 O                                   28 'CALCULATED'                  E15645
1102 O***********              RECIN 3   45                               E15645
1102 O                         RECIN 3   50                               E15645
1103 O                         ZZTOTIZ   65
1104 O**********               ZZTOTD    68                                                   219063
     O                         ZZTOTDL   69                                                   219063
1105 O        T  3     LR U8NU7
1106 O                                   68 '***   DIFFERENCE   ***'
     O        T  3     LR 21
     O                                   20 'TOTAL TELEX RECORDS'
     O                         TOTLX Z   45
     O********T*32     LR 47                                        S01117BHF216
     O**********                         70 '***   NO DETAILS TO REPS01117BHF216
     O**********                         78 'RT   ***'              S01117BHF216
1052 O        T 32     U7 U8 LR                                           S01117
1053 O                                   42 '*** REFERENCE'               S01117
1054 O                         DBPGM     52                               S01117
1055 O***********                        71 '-DATABASE ERROR AT'          S01117
1055 O                                   71 ' DATABASE ERROR AT'          S01117
1056 O***********              DBASE     74                               S01117
1056 O                         DBASE     75                               S01117
1057 O        T  1     U7 U8 LR                                           S01117
1058 O***********                        37 'FILE NAME'                   S01117
1059 O***********              DBFILE    43                               S01117
1060 O***********                        48 'KEY'                         S01117
1061 O***********              DBKEY     78                               S01117
1058 O                                   37 'FILENAME'                    S01117
1059 O                         DBFILE    48                               S01117
1060 O                                   52 'KEY'                         S01117
1061 O                         DBKEY     82                               S01117
1107 O********T*3   60 LR                                                 S01117
1108 O***********                        50 '*** END OF REPORT ***'       E15645
1108 O***********                        62 '*** END OF REPORT ***' E15645S01117
     O*
     O*    T E L E X   M O D U L E   I N T E R F A C E
     O*
     OLEPTXDD DADD     70 01 30
     O                                    1 'D'
     O***********              BRCD       4                               S01117
     O                         BRCA       4                               S01117
     O                         NOSTRO    10
     O                         PTYP      12
     O                         ZDAY      14
     O                         ZMTH      16
     O                         ZYEAR     18
     O                         CCY       21
     O                         FCLN      27
     O                         PYRC      28
     O                                   29 'I'
     O                                   30 'L'
     O                                   31 'O'
     O                         CCNM      45
     O                         CDP       46
     O                         EAMT      53P
     O                         RUNA      60
     O                         RP31T    115
     O                 51      CRNM     135
     O                 51      CTWN     160
     O                 51N49   RP41     170
     O                         CRNM     190
     O                         CTWN     200
     O                         SPI      290
     O***********              BRCD     303                               S01117
     O                         BRCA     303                               S01117
**  MESS
NOSTRO MISSING
CLIENT MISSING
CUR.NOT FOUND
COUNTERPARTY/NOSTRO MISSING
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
**  CPY@  **  OBJECT COPYRIGHT
(c) Finastra International Limited 2001
**   SVAL  -  SYSTEM VALUES ARRAY                                                             CLE033
Settlement09Customer                                                                          CLE033
Settlement09AccCode                                                                           CLE033
