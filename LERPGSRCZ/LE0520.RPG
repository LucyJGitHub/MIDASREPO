     H        1                                                           S01117
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas Print Pay/Rec Tlxs-Bankers Paymts')              *
      *****************************************************************
      *                                                               *
      *  Midas - Customer Lending Module                              *
      *                                                               *
      *  LE0520  -  BANKERS AUTHORISATION TELEXES                     *
      *                                                               *
      *  (c) Misys International Banking Systems Ltd. 2001            *
      *                                                               *
      *  Last Amend No. CCB020             Date 06Aug12               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      *  Prev Amend No. 245691             Date 19Feb07               *
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CSD031             Date 10Apr06               *
      *                 BUG11461           Date 07Jun06               *
      *                 CSD027             Date 09Dec05               *
      *                 CSW037A            Date 02May05               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 CLE025             Date 20Oct03               *
      *                 CGL029             Date 01Sep03               *
      *                 222373             Date 28Oct03               *
      *                 CLE033             Date 09Apr03               *
      * Midas Release 4.01.03 ----------------------------------------*
      *                 216350             Date 18Mar03               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 155801             Date 03Mar99               *
      *                 152671             Date 03Mar99               *
      *                 CEU004             Date 02Feb98               *
      *                 087322             Date 12May95               *
      *                 E45727             Date 23Nov92               *
      *                 S01392             DATE 07OCT92               *
      *                 BHF216             DATE 08AUG90               *
      *                 BHF096             DATE 04JUN90               *
      *                 BHF070             DATE 18MAY90               *
      *                 S01194             DATE 09JAN90               *
      *                 S01117             DATE 18JUN89               *
      *                                                               *
      *---------------------------------------------------------------*
      *                                                               *
      *  CCB020 - COB Restructure - Secondary COB Infrastructure      *
      *  245691 - Allow File Control Amounts to be negative.          *
      *           (complete 219063).  Applied fix 230531.             *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  BUG11461 - Set off U7 if no detail records were read.        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  CLE025 - Credit Lines (Recompile)                            *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  222373 - Parameter Mismatch                                  *
      *  CLE033 - Settlement method 09                                *
      *  216350 - Replace call to ZSFILE in order to handle RCF       *
      *           correctly.                                          *
      *  155801 - Do not print record if value date is equal to       *
      *           rundate.                                            *
      *  152671 - Suppress output to report if amount is zero.        *
      *  CEU004 - LE Settlement Ccy conversion Upgrade to DBA R2.0    *
      *         - Recompiled                                          *
      *  087322 - Add space between customer no. & customer name.     *
      *  E45727 - Add fee sequence to report.                         *
      *  S01392 - Japanese sub module enhancements                    *
      *  BHF216 - Remove 'NO DETAILS TO REPORT' from audit report     *
      *  BHF096 - Cust. no. moved left into parameter for AOCUSTR0    *
      *           & *IN67 set off before access objs. calls           *
      *  BHF070 - Nothing being put in field NAMTWN from SDCUSTPD     *
      *           and AOCURRR0 being called by '*FIRST' not '*KEY'    *
      *  S01194 - Standing data changes                               *
      *  S01117 - Multibranching                                      *
      *                                                               *
      *****************************************************************
0011 F/SPACE 3
0012 F*TX3    IP  F     180 37AI     2 DISK
     F***STX3*** IP  F     200 37AI     2 DISK                                         S01117 CGL029
     FSTX3    IP  F     228 37AI     2 DISK                                                   CGL029
0013 F*ABLE   IF  F      96 12AI     2 DISK                               S01194
0014 F*LINT   IF  F     256  7AI     2 DISK                               S01194
     F*E0520P1O** F     132     OF     PRINTER                  S01124    S01117
     FLE0520P1O   F     132     OF     PRINTER      KINFDS SPOOL      UC  S01117
     FLE0520AUO   F     132     OA     PRINTER      KINFDS SPOOLU         S01117
0016 F/SPACE 3
0017 F* ID F  C  H  L    FUNCTION OF INDICATORS
0018 F* 01            S/STX3 - DETAIL
0019 F* 02                    - TRAILER
0020 F*    20         AMOUNT NEGATIVE
0021 F*    22         BENEFICIARY BLANK
0022 F*    25-27      SPECIAL INSTR. BLANK.
0023 F*       28       ALL SPECIAL INSTRUCTIONS BLANK
     F*       31      WORK INDICATOR USED FOR BENIFICIARY BANK DETAILS
     F*       32      BENIFICIARY BANK DETAILS EXIST ON FIRST LINE OF SPI
     F*       38      INPUT FILE AT LEAST HAS ONE RECORD                  S01117
0024 F*       40      1ST CYCLE
0025 F*       41      1ST DETAIL
0026 F*       49      BENEFICIARY NOT A CUSTOMER
0027 F*       51      PAY
0028 F*       52      RECEIVE
0029 F*       60      DEC. PLACES 0
0030 F*       61                  1
0031 F*       62                  2
0032 F*       63                  3
0033 F*       66      WORK IND.
0034 F*       67      CHAIN FAILURE
0035 F*       71      SETTLEMENT TYPE - 01
0036 F*       72                      - 02
0037 F*       73                      - 12
0038 F*       80      I/P CYCLE RUN
     F*       88      MBIN = Y                                            S01117
0039 E                    SPI         3 30               SPECIAL INSTR.
0040 E                    MESS    1   4 29               ERROR MESSAGE
     E/COPY ZSRSRC,ZDATE2Z1                                               S01392
     E                    CPY@    1   1 80
     E*                                                                   CLE033
     E**  System values array                                             CLE033
     E                    SVAL    1   2 20                                CLE033
     E*                                                                   CLE033
0044 I* S/STX3 DETAIL RECORD
0045 ISTX3    NS  01   1 CD
0046 I                                        2   2 PYRC  L4
0047 I                                        3   40SETP
0048 I                                        5   7 CCY   L3
0049 I**********                              8  19 OSAC  L2                                  CGL029
0049 I                                        8  19 OSACQQ                                    CGL029
0050 I                                    P  20  220VDAT  L1
0051 I                                       23  32 TSEN
0052 I**********                             33  380CNUMPH                                    CSD027
0052 I                                       33  38 CNUMPH                                    CSD027
0053 I                                       39  44 FCLN
0054 I                                    P  45  510EAMT          20
0055 I                                       52  52 RCDT
0056 I                                       53  54 AMTP
0057 I                                       55  570LASN
0058 I                                       58  67 FACO            22
0059 I                                       68 157 SPI
0060 I                                      158 1580PRI1
0061 I                                      159 1590PRI2
0062 I                                      160 1600PRI3
0063 I                                      161 1610PRI4
0064 I**********                            162 1670BICN                                      CSD027
0064 I                                      162 167 BICN                                      CSD027
0065 I                                      168 169 LTYP
0066 I                                      170 171 SUTP
0067 I                                      172 1730PTYP
0068 I                                      174 1740TIND
0069 I*****                                 175 1770BRCD  L5              S01117
0069 I                                      175 177 BRCA                  S01117
0070 I                                      178 178 INTC
     I                                      179 181 OSBR  L5              S01117
     I                                      182 183 FEESEQ                E45727
     I                                      211 228 OSAC  L2                                  CGL029
0071 I*
0072 I* TRAILER
0073 I        NS  02   1 CT
0074 I                                    P   2   40NORE
0075 I                                    P   5  120HRWN
0076 I                                    P  13  140HRDC
0077 I*
0078 I* CATCHALL
0079 I        NS
0080 I************                                                        S01194
0081 I*****TABLE*FILE*-*INSTALLATION*CONTROL DATA RECORD 1.               S01194
0082 I************                                                        S01194
0083 I*ABLE***NS       2 C0   3 C1  12 C1                                 S01194
0084 I*******AND      13 C0                                               S01194
0085 I**********                              1   1 RECI                  S01194
0086 I**********                              2   30RECT                  S01194
0087 I**********                             12  130RCDE                  S01194
0088 I**********                             14  66 TITL                  S01194
0089 I**********                             67  67 DATF                  S01194
0090 I***********                            68  700DFBR                  S01194
0091 I**********                             74  74 MODI1                 S01194
0092 I**********                             75  75 MODI2                 S01194
0093 I**********                             76  76 MODI3                 S01194
0094 I**********                          P  77  790RUND                  S01194
0095 I**********                             80  86 RUNA                  S01194
0096 I**********                             87  870SFLG                  S01194
0097 I**********                          P  90  920LCD                   S01194
0098 I**********                             93  93 CHTP                  S01194
0099 I**********                          P  94  960TNLU                  S01194
0100 I************                                                        S01194
0101 I*****TABLE*FILE*-*INSTALLATION CONTROL DATA RECORD 3.               S01194
0102 I************                                                        S01194
0103 I*ABLE***NS       1 CD   2 C0   3 C1                                 S01194
0104 I*******AND      12 C2  13 C0                                        S01194
0105 I**********                              1   1 RECI                  S01194
0106 I**********                              2   30RECT                  S01194
0107 I**********                             12  130RCDE                  S01194
0108 I**********                             14  170COMS                  S01194
0109 I**********                             18  210CADC                  S01194
0110 I**********                          P  22  240MDIC                  S01194
0111 I**********                          P  25  270MCIC                  S01194
0112 I**********                          P  28  300MDIA                  S01194
0113 I**********                          P  31  330MCIA                  S01194
0114 I**********                             34  370SRPL                  S01194
0115 I**********                             38  410SPAC                  S01194
0116 I**********                             42  450SWAC                  S01194
0117 I**********                             46  490FTAC                  S01194
0118 I**********                             50  530TAC4                  S01194
0119 I**********                             54  570TAC5                  S01194
0120 I**********                          P  63  650NOBA                  S01194
0121 I**********                          P  66  680TSIZ                  S01194
0122 I**********                             69  69 RACN                  S01194
0123 I**********                             70  700GLSI                  S01194
0124 I**********                             71  710RTSI                  S01194
0125 I**********                             72  720DLSI                  S01194
0126 I**********                             73  730NOSI                  S01194
0127 I**********                             74  740CTSI                  S01194
0128 I**********                          P  75  770ELAC                  S01194
0129 I**********                          P  78  800ECAC                  S01194
0130 I**********                          P  90  920LCD                   S01194
0131 I**********                             93  93 CHTP                  S01194
0132 I**********                          P  94  960TNLU                  S01194
0133 I************                                                        S01194
0134 I*****TABLE*FILE*-*INSTALLATION CONTROL DATA RECORD 5.               S01194
0135 I************                                                        S01194
0136 I*ABLE***NS       1 CD   2 C0   3 C1                                 S01194
0137 I*******AND      12 C4  13 C0                                        S01194
0138 I**********                              1   1 RECI                  S01194
0139 I**********                              2   30RECT                  S01194
0140 I**********                             12  130RCDE                  S01194
0141 I**********                             18  210CSAC                  S01194
0142 I**********                             22  22 TLII                  S01194
0143 I**********                             23  23 MCRI                  S01194
0144 I**********                          P  24  250MCEP                  S01194
0145 I**********                             26  270MCLP                  S01194
0146 I**********                             28  28 FRDI                  S01194
0147 I**********                             29  29 BRCF                  S01194
0148 I**********                             30  350PSCN                  S01194
0149 I***********                            36  380DLBR                  S01194
0150 I**********                             39  420FRPA                  S01194
0151 I**********                             43  460FRPC                  S01194
0152 I**********                             47  49 USCY                  S01194
0153 I**********                             50  52 STCY                  S01194
0154 I**********                          P  53  553MBGE                  S01194
0155 I**********                             56  56 PRID                  S01194
0156 I**********                             57  57 FFNY                  S01194
0157 I**********                             58  58 OURC                  S01194
0158 I**********                             59  59 BRNC                  S01194
0159 I**********                             60  60 LCYN                  S01194
0160 I**********                          P  90  920LCD                   S01194
0161 I**********                             93  93 CHTP                  S01194
0162 I**********                          P  94  960TNLU                  S01194
0163 I************                                                        S01194
0164 I*****TABLE*FILE*-*CURRENCIES RECORD 1.                              S01194
0165 I************                                                        S01194
0166 I*ABLE***NS       1 CD   2 C2   3 C0                                 S01194
0167 I*******AND      13 C1                                               S01194
0168 I**********                              1   1 RECI                  S01194
0169 I**********                              2   30RECT                  S01194
0170 I**********                             10  12 CCY                   S01194
0171 I**********                             13  130SREC                  S01194
0172 I**********                             14  27 CCNM                  S01194
0173 I**********                          P  28  348SPOT                  S01194
0174 I**********                             35  37 CCYS                  S01194
0175 I**********                             38  380CDP                   S01194
0176 I**********                             39  390TNOT                  S01194
0177 I**********                             40  40 DCCY                  S01194
0178 I**********                             41  44 SRC1                  S01194
0179 I**********                             45  48 SRC2                  S01194
0180 I**********                             49  520TACC                  S01194
0181 I**********                             53  560TEQV                  S01194
0182 I**********                             57  600SWQV                  S01194
0183 I**********                             61  640TAC4                  S01194
0184 I**********                             65  680TAC5                  S01194
0185 I**********                             69  69 HIND                  S01194
0186 I**********                          P  70  768PART                  S01194
0187 I**********                             77  780SSNO                  S01194
0188 I**********                          P  79  858ERLC                  S01194
0189 I**********                          P  90  920LCD                   S01194
0190 I**********                             93  93 CHTP                  S01194
0191 I**********                          P  94  960TNLU                  S01194
0192 I**********                                                          S01194
0193 I*****TABLE*FILE*-*NOSTROS RECORD.                                   S01194
0194 I************                                                        S01194
0195 I*ABLE** NS       1 CD   2 C7   3 C0                                 S01194
0196 I**********                              1   1 RECI                  S01194
0197 I**********                              2   30RECT                  S01194
0198 I**********                              9  11 CCY                   S01194
0199 I**********                             12  130NOSN                  S01194
0200 I**********                             16  29 ONAC                  S01194
0201 I**********                             30  350CNUM                  S01194
0202 I**********                             36  370ACSQ                  S01194
0203 I**********                             38  410ACOD                  S01194
0204 I**********                          P  90  920LCD                   S01194
0205 I**********                             93  93 CHTP                  S01194
0206 I**********                          P  94  960TNLU                  S01194
0207 I**********                                                          S01194
0208 I*****TABLE*FILE*-*COUNTERPARTY NOSTROS RECORD.                      S01194
0209 I************                                                        S01194
0210 I*ABLE***NS       1 CD   2 C7   3 C1                                 S01194
0211 I**********                              1   1 RECI                  S01194
0212 I**********                              2   30RECT                  S01194
0213 I**********                              6  13 CPSH                  S01194
0214 I**********                             14  48 CPNM                  S01194
0215 I**********                             49  68 CPTN                  S01194
0216 I**********                          P  90  920LCD                   S01194
0217 I**********                             93  93 CHTP                  S01194
0218 I**********                          P  94  960TNLU                  S01194
     I**********                                                          S01194
0220 I**CATCHALL                                                          S01194
0221 I********NS                                                          S01194
0222 I************                                                        S01194
0223 I*****CLIENT*FILE*-*CUSTOMER*STANDING DATA RECORD.                   S01194
0224 I************                                                        S01194
0225 I*LINT***NS       1 CD   8 CA                                        S01194
0226 I**********                              1   1 RECI                  S01194
0227 I**********                              2   70CNUM                  S01194
0228 I**********                              8   8 RCDT                  S01194
0229 I**********                              9  28 CRNM                  S01194
0230 I**********                             29  38 CTWN                  S01194
0231 I**********                             39  48 CSNM                  S01194
0232 I**********                             49  56 CASK                  S01194
0233 I**********                             57  68 TELX                  S01194
0234 I**********                             69  80 CSID                  S01194
0235 I**********                             81  82 ACOC                  S01194
0236 I**********                             83  83 CBSI                  S01194
0237 I**********                             84  85 CCTZ                  S01194
0238 I**********                             86  87 CLOC                  S01194
0239 I**********                             88  930CPAR                  S01194
0240 I***********                            94  960BRCDCB                S01194
0241 I**********                             97  980LINS                  S01194
0242 I**********                             99 1010LIND                  S01194
0243 I**********                          P 102 1040DASU                  S01194
0244 I**********                          P 105 1070CDIC                  S01194
0245 I**********                          P 108 1100DADE                  S01194
0246 I**********                            111 111 CMIN                  S01194
0247 I**********                            112 112 CTYP                  S01194
0248 I**********                            113 124 TELF                  S01194
0249 I**********                            125 133 CHID                  S01194
0250 I**********                            134 136 CHAB                  S01194
0251 I**********                          P 250 2520LCD                   S01194
0252 I**********                            253 253 CHTP                  S01194
0253 I**********                          P 254 2560TNLU                  S01194
0255 I*
0256 I*    CLIENT FILE - CUSTOMER NAME AND ADDRESS RECORD.
0257 I*
0258 I********NS       1 CD   8 CB                                        S01194
0259 I**********                              1   1 RECI                  S01194
0260 I**********                              2   70CNUM                  S01194
0261 I**********                              8   8 RCDT                  S01194
0262 I**********                              9  43 CNA1                  S01194
0263 I**********                             44  78 CNA2                  S01194
0264 I**********                             79 113 CNA3                  S01194
0265 I**********                            114 148 CNA4                  S01194
0266 I**********                            240 249 CTWN                  S01194
0267 I**********                          P 250 2520LCD                   S01194
0268 I**********                            253 253 CHTP                  S01194
0269 I**********                          P 254 2560TNLU                  S01194
0270 I*
0271 I* CATCHALL
      **                                                                  S01194
     ISDBANK    E DSSDBANKPD                                              S01194
      ** BANK DETAILS                                                     S01194
     I              BJURPT                          TITL                  S01194
     ISDBRCH    E DSSDBRCHPD                                              S01117
      **  EXTERNAL DS FOR BRANCH CODE DETAILS                             S01117
     I              A8BRNM                          BRNM                  S01117
     **                                                                   S01194
     ISDCNST    E DSSDCNSTPD                                              S01194
      **   COUNTER-PARTY NOSTROS                                          S01194
      **                                                                  S01194
     ISDCURR    E DSSDCURRPD                                              S01194
      **  EXTERNAL DS FOR CURRENCY CODES                                  S01194
     I              A6CYNM                          CCNM                  S01194
     I              A6NBDP                          CDP                   S01194
      **                                                                  S01194
     ISDCUST    E DSSDCUSTPD                                              S01194
      **   CUSTOMER                                                       S01194
     I**************BBCNCZ                          CCTZ            S01194BHF070
     I**************BBACOC                          ACOC            S01194BHF070
     I**************BBCUST                          CNUM            S01194BHF070
     I**************BBCNA1                          CNA1            S01194BHF070
     I**************BBCRNM                          CRNM            S01194BHF070
     I**************BBCRTN                          CTWN            S01194BHF070
     I**************BBCMTI                          TLXR            S01194BHF070
     I              QQDFAC                          DFACBK                                    CGL029
     ISDGELR    E DSSDGELRPD                                              S01117
      ** GENERAL LEDGER DETAILS                                           S01117
     I              BKACCD                          COMS                  S01194
     **
     ISDMMOD    E DSSDMMODPD                                              S01194
     I**  EXTERNAL DS FOR MIDAS MODULE CODES                              S01194
     **
     ISDNOST    E DSSDNOSTPD                                              S01194
      **  EXTERNAL DS FOR NOSTRO DETAILS                                  S01194
     I              A7NOSN                          CSNM                  S01194
     I              A7ACCD                          ACOD                  S01194
     I              A7ACSN                          ACSQ                  S01194
     I              QQACCD                          ACCDB1                                    CGL029
     **
     ISDRETL    E DSSDRETLPD                                              S01194
     I*  RETAIL DETAILS                                                   S01194
     I              BMACCD                          CADC                  S01194
     I              QQACCD                          ACCDB2                                    CGL029
     **
     ISDTRAD    E DSSDTRADPD                                              S01194
      **  ACCESS TO TRADING DETAILS                                       S01194
     I              BLACCD                          CSAC                  S01194
     I              QQACCD                          ACCDB3                                    CGL029
     I*
0272 I********NS  67                                                      S01194
0273 I* D A T A - S T R U C T U R E S
0274 I            DS
0275 I                                        1  45 RP21
0276 I                                        1  35 OURAGN
0277 I                                       36  45 OURAGT
0278 I*
0279 I            DS
0280 I                                        1  55 RP31
0281 I                                        1  35 THEIRN
0282 I                                       36  55 THEIRT
0283 I*
0284 I            DS
0285 I                                        1  55 RP41
0286 I                                        1  35 BENAME
0287 I                                       36  55 BETOWN
0322 I**TABLES*FILE KEY                                                   S01194
0323 I**********  DS                                                      S01194
0324 I**********                              1  12 ZTABKY                S01194
0325 I**********                              1   2 CODE                  S01194
0326 I**********                              8  10 CURR                  S01194
0327 I**********                             11  12 NOSTNO                S01194
0328 I**********                              9  11 CURX                  S01194
0329 I**********                             12  12 NOX                   S01194
0330 I**TABLES*FILE KEY FOR COUNTERPARTY/NOSTROS                          S01194
0331 I**********  DS                                                      S01194
0332 I**********                              1  12 CNOSKY                S01194
0333 I                                        5  12 COUNTN                S01194
0334 I**CLIENT*FILE KEY                                                   S01194
0335 I**********  DS                                                      S01194
0336 I**********                              1   7 CLIKEY                S01194
0337 I**********                              1   6 CNUMK                 S01194
0304 I* CLIENT DETAILS                                                    S01194
0305 I            DS                                                      S01194
0306 I                                        1  45 NAMTWN
0307 I**********                              1  35 CNA1                  S01194
     I**********                             36  45 CTWN                  S01194
0343 I**********                             46  65 CRNM                  S01194
0307 I                                        1  35 CNA1                  BHF070
     I                                       36  45 CTWN                  BHF070
0343 I                                       46  65 CRNM                  BHF070
0309 I**CUSTOMER DETAILS                                                  S01194
0310 I            DS                                                      S01194
0311 I                                        1  45 CUSDET                S01194
0312 I                                        1  35 CUSNAM
0313 I                                       36  45 CUSTWN
0314 I* COUNTERPARTY/NOSTRO DETAILS
0315 I            DS
0316 I                                        1  55 COUNOS
0317 I                                        1  35 CPNM
0318 I                                       36  55 CPTN
0319 I* OUR SETTLEMENT A/C * AGENT *
0320 I            DS
0321 I**********                              1  12 OSAC                                      CGL029
     I                                        1  18 OSAC                                      CGL029
0322 I                                        1   2 ONOS
0323 I                                        1   6 OCNUM
0324 I**********                              7  10 OACOD                                     CGL029
0325 I**********                             11  12 OACSQ                                     CGL029
0326 I                                        1  10 RETNO
     I                                        7  16 OACOD                                     CGL029
     I                                       17  18 OACSQ                                     CGL029
0327 I* THEIR AGENT
0328 I            DS
0329 I                                        1  10 TSEN
0330 I                                        1   6 CUST
0331 I                                        1   8 TCNOS
0332 I* BLANK FIELDS
0333 I            DS
0334 I                                        1  55 BLNK55
0335 I                                        1  24 BLNK24
0336 I                                        1  45 BLNK45
0337 I                                        1   3 BLNK3
0338 I                                        1  10 BLNK10
0339 I                                        1  20 BLNK20
0340 I* FOR A/C OF
0341 I            DS
0342 I                                        1  10 FACO
0343 I                                        1   6 FCNUM
0344 I                                        1   8 CONOST
     I*
     I**   FIELDS USED FOR BENIFICIARY BANK DETAILS
     I            DS
     I                                        1  90 SPI
     I                                        1  30 SPIONE
     I                                        1   3 SPEC3
     I                                        1   5 SPEC5
     I                                        6   8 SPEC8
     I                                        1   8 SPEC9
     I                                        6  12 SPEC12
     I                                        9  14 SPEC14
     I                                        9  17 SPEC17
     I                                       10  18 SPEC18
     I                                        5  29 SPEC29
     I                                        6  30 SPEC30
0345 I*
0346 I**      LOCAL DATA AREA FOR DATABASE ERROR REFERENCE
0347 I*
0348 ILDA        UDS                            256
0139 I***********                           134 138 DBFILE                S01117
0140 I***********                           139 167 DBKEY                 S01117
0141 I***********                           168 175 DBPGM                 S01117
0142 I***********                           176 177 DBASE                 S01117
0232 I                                      134 141 DBFILE                S01117
0233 I                                      142 170 DBKEY                 S01117
0234 I                                      171 180 DBPGM                 S01117
0235 I                                      181 1830DBASE                 S01117
0925 I**                                                                  S01117
0925 I**   FILE INFORMATION DATA STRUCTURE                                S01117
0925 I**                                                                  S01117
     ISPOOL       DS                                                      S01117
     I                                       83  92 SFILE                 S01117
     I                                    B 123 1240SFNUM                 S01117
     ISPOOLU      DS                                                      S01117
     I                                       83  92 SFILEU                S01117
     I                                    B 123 1240SFNUMU                S01117
     I**                                                                  S01117
     I** DATA AREA RUNDAT                                                 S01117
     I**                                                                  S01117
     IRUNDT       DS                                                      S01117
     I                                        1   7 RUNA                  S01117
     I                                    P   8  100RUND                  S01117
     I                                       11  11 SSF                   S01117
     I                                       12  12 DATF                  S01117
     I                                       13  13 MBIN                  S01117
     I**  EXTERNAL DS FOR BRANCH CODES                                    S01117
      *                                                                   155801
     I***MPHAS       DS                                                                155801 CCB020
      ***Data*structure*to*check*MPHAS*for*Close*of*Business**********                 155801 CCB020
     I**********                              1   1 STAT                               155801 CCB020
     I*                                                                   S01194
     IDSFDY     E DSDSFDY                                                 S01194
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01194
     I*                                                                   S01194
     IDSSDY     E DSDSSDY                                                 S01194
     I* SECOND DS FOR ACCESS PROGRAMS, LONG DATA STRUCTURE                S01194
     I*                                                                   CLE033
     ISCSARD    E DSSCSARDPD                                              CLE033
     I** Switchable Feature details                                       CLE033
     I*                                                                   CLE033
     I*SDSVAL***E*DSSDSVALPD*                                                          CLE033 222373
      ****EXTERNAL*DS*FOR*SYSTEM*VALUES*                                               CLE033 222373
     I*                                                                   S01194
      ********************************************************************S01117
     C                     MOVEACPY@      BIS@   80
     C           *ENTRY    PLIST                                          S01117
     C                     PARM           SEQ     5         SEQUENCE NUM. S01117
      *                                                                                       216350
      * Set up parameter for call to ZSFILE2                                                  216350
     C                     MOVEL'LE0520'  RNAM   10                                           216350
      *                                                                                       216350
0354 C* 1 S T   C Y C L E   P R O C E S S I N G
0355 C   41                GOTO MAIN
0356 C   40                GOTO START
     C           *NAMVAR   DEFN RUNDAT    RUNDT                           S01117
     C                     IN   RUNDT                                     S01117
      *                                                                   155801
      ***Set*up*MPHAS*data*area***************************************                 155801 CCB020
      ** Check if the system is in COB Phase                                                  CCB020
      *                                                                   155801
     C********** *NAMVAR   DEFN           MPHAS                                        155801 CCB020
     C**********           IN   MPHAS                                                  155801 CCB020
     C                     MOVEL'CBC00100'@RTPRM  9                                           CCB020
     C                     MOVE '1'       @RTPRM                                              CCB020
     C                     CALL @RTPRM                                                        CCB020
     C                     PARM *BLANKS   COBST   4                                           CCB020
      *                                                                                       CCB020
     C**                                                                  S01117
     C*    DEFINE LDA                                                     S01117
     C           *NAMVAR   DEFN           LDA                             S01117
     C           *LOCK     IN   LDA                                       S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C                     SETON                     88                   S01117
     C                     END                                            S01117
0357 C                     SETON                     40
0358 C   U7                SETON                     80
0359 C                     SETOF                     U7
0360 C**         FOR DATA BASE ERROR REFERENCE
0361 C*
0362 C                     MOVE 'LE0520  'DBPGM
0363 C                     MOVE ' '       BLANKS 29
0364 C                     MOVE BLANKS    DBKEY
0365 C                     EXSR ZSYSTM
0366 C   99                SETON                     U7U8LR
0367 C   99                MOVE '01'      DBASE
0368 C***99*****           MOVE 'TABLE'   DBFILE                          S01194
0368 C   99                MOVE 'SDBANKPD'DBFILE                          S01194
0369 C***99*****           MOVELZTABKY    DBKEY                           S01194
0370 C   99                GOTO ENDDET
0371 C**********           MOVE '20'      ZTABKY                          S01194
0372 C********** ZTABKY    CHAINTABLE                67                   S01194
     C                     CALL 'AOMMODR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDMMOD    PARM SDMMOD    DSFDY                           S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     SETON                     LRU7                 S01194
     C                     MOVEL'SDMMODPD'DBFILE           ***************S01194
     C                     MOVEL@OPTN     DBKEY            * DBERROR 002 *S01194
     C                     Z-ADD2         DBASE            ***************S01194
     C                     GOTO ENDDET                                    S01194
     C                     END                                            S01194
     C           BGRTBN    IFEQ 'Y'                                       S01194
     C                     CALL 'AORETLR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDRETL    PARM SDRETL    DSFDY                           S01194
0373 C***67*****           SETON                     LRU7                 S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     SETON                     LRU7                 S01194
     C                     SETON                     67                   S01194
     C                     END                                            S01194
0374 C***67*****           MOVE '02'      DBASE                           S01194
0375 C***67*****           MOVE 'TABLE'   DBFILE                          S01194
0376 C***67*****           MOVE ZTABKY    DBKEY                           S01194
0377 C***67*****           GOTO ENDDET                                    S01194
     C   67                MOVEL'SDRETLPD'DBFILE           ***************S01194
     C   67                MOVEL@OPTN     DBKEY            * DBERROR 003 *S01194
     C   67                Z-ADD3         DBASE            ***************S01194
0377 C   67                GOTO ENDDET
     C                     END                                            S01194
0378 C**********           MOVE '40'      ZTABKY                          S01194
0379 C********** ZTABKY    CHAINTABLE                67                   S01194
0380 C***67*****           SETON                     LRU7                 S01194
0381 C***67*****                                                          S01194
0382 C***67*****           MOVE 'TABLE'   DBFILE                          S01194
0383 C***67*****           MOVE ZTABKY    DBKEY                           S01194
     C                     CALL 'AOTRADR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDTRAD    PARM SDTRAD    DSFDY                           S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     SETON                     U7LR                 S01194
     C                     SETON                     67                   S01194
     C                     END                                            S01194
     C   67                MOVEL'SDTRADPD'DBFILE           ***************S01194
     C   67                MOVEL@OPTN     DBKEY            * DBERROR 005 *S01194
     C   67                Z-ADD5         DBASE            ***************S01194
0384 C   67                GOTO ENDDET
0385 C**********           Z-ADD0         TCOUNT  50                      S01194
0386 C*********            MOVE 'A'       CLIKEY                          S01194
0387 C**********           MOVEL'71'      CNOSKY                          S01194
0388 C                     MOVE ' '       SBLANK 30
      *                                                                   CLE033
      ** Check if CLE033 is ON                                            CLE033
      *                                                                   CLE033
     C                     CALL 'AOSARDR0'                                CLE033
     C                     PARM *BLANKS   @RTCD                           CLE033
     C                     PARM '*KEY   ' @OPTN                           CLE033
     C                     PARM 'CLE033'  PSARD   6                       CLE033
     C           SCSARD    PARM SCSARD    DSFDY                           CLE033
      *                                                                   CLE033
     C           @RTCD     IFEQ *BLANKS                                   CLE033
     C                     MOVE 'Y'       CLE033  1                       CLE033
      *                                                                   CLE033
      ** Retrieve Settlement 09 customer and account code system values   CLE033
      *                                                                   CLE033
     C                     CALL 'AOSVALR0'                                CLE033
     C                     PARM *BLANKS   @RTCD                           CLE033
     C                     PARM SVAL,1    P@OP01 20                       CLE033
     C                     PARM *BLANKS   P@VL01200                       CLE033
     C                     PARM SVAL,2    P@OP02 20                       CLE033
     C                     PARM *BLANKS   P@VL02200                       CLE033
     C                     PARM *BLANKS   P@OP03 20                       CLE033
     C                     PARM *BLANKS   P@VL03200                       CLE033
     C                     PARM *BLANKS   P@OP04 20                       CLE033
     C                     PARM *BLANKS   P@VL04200                       CLE033
     C                     PARM *BLANKS   P@OP05 20                       CLE033
     C                     PARM *BLANKS   P@VL05200                       CLE033
     C                     PARM *BLANKS   P@OP06 20                       CLE033
     C                     PARM *BLANKS   P@VL06200                       CLE033
     C                     PARM *BLANKS   P@OP07 20                       CLE033
     C                     PARM *BLANKS   P@VL07200                       CLE033
     C                     PARM *BLANKS   P@OP08 20                       CLE033
     C                     PARM *BLANKS   P@VL08200                       CLE033
     C                     PARM *BLANKS   P@OP09 20                       CLE033
     C                     PARM *BLANKS   P@VL09200                       CLE033
     C                     PARM *BLANKS   P@OP10 20                       CLE033
     C                     PARM *BLANKS   P@VL10200                       CLE033
     C********** SDSVAL    PARM SDSVAL    DSSDY                    CLE033 222373
      *                                                                   CLE033
     C           @RTCD     IFNE *BLANK                                    CLE033
     C                     MOVEL'SDSVALPD'DBFILE           ************   CLE033
     C                     MOVEL'CLE033 ' DBKEY            * DBERR 10 *   CLE033
     C                     MOVEL'010'     DBASE            ************   CLE033
     C                     MOVE *ON       *INU7                           CLE033
     C                     MOVE *ON       *INU8                           CLE033
     C                     MOVE *ON       *INLR                           CLE033
     C                     MOVE *ON       *IN67                           CLE033
     C                     GOTO ENDDET                                    CLE033
     C                     ENDIF                                          CLE033
      *                                                                   CLE033
     C                     ELSE                                           CLE033
     C                     MOVE 'N'       CLE033                          CLE033
      *                                                                   CLE033
     C           @RTCD     IFNE '*NRF    '                                CLE033
     C                     MOVEL'SCSARDPD'DBFILE             *************CLE033
     C                     Z-ADD11        DBASE              * DBERR 011 *CLE033
     C                     MOVEL'CLE033'  DBKEY              *************CLE033
     C                     SETON                     U7U8LR               CLE033
     C                     SETON                     67                   CLE033
     C                     GOTO ENDDET                                    CLE033
     C                     ENDIF                                          CLE033
      *                                                                   CLE033
     C                     ENDIF                                          CLE033
0389 C* S T A R T
0390 C           START     TAG                             ** START TAG **
0391 C  N01                GOTO ENDDET
0392 C* DETAIL PROCESSING FOR 1ST DETAIL RECORD
0393 C                     SETON                     41
0394 C                     EXSR HEADER
0395 C***********          GOTO ENTRY1                                    S01117
     C   U7 LR             GOTO ENDDET                                    S01194
0396 C/SPACE 3
0397 C* M A I N   P R O C E S S I N G
0398 C           MAIN      TAG
     C                     SETOF                     3132
0399 C  N01                GOTO ENDDET
     C*                                                                   S01117
     C           MBIN      IFNE 'Y'                                       S01117
     C                     SETON                     38                   S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C*                                                                   S01117
     C           *INL5     IFEQ '1'                                       S01117
     C                     CLOSELE0520P1                                  S01117
     C*                                                                   S01117
     C**                                                                  S01117
     C*       IF MBIN=YES, AND A LEVEL BREAK,                             S01117
     C*       OPEN LE0520P1                                               S01117
     C**                                                                  S01117
     C                     SETON                       38                 S01117
     C                     OPEN LE0520P1                                  S01117
     C                     Z-ADD0         PAGE                            S01117
     C                     Z-ADD0         PAGE1                           S01117
     C**                                                                  S01117
     C**  ENSURE TOTALS SPOOL FILE RECORDED BY RCF                        S01117
     C**                                                                  S01117
     C                     Z-ADDSFNUM     ZSNUM   60                      S01117
     C                     OUT  LDA                                       S01117
      *                                                                   S01117
     C**********           CALL 'ZSFILE'                                               S01117 216350
     C                     CALL 'ZSFILE2'                                                     216350
     C                     PARM           SEQ                             S01117
     C                     PARM           RNAM                                                216350
     C                     PARM OSBR      SENTY                           S01117
     C                     PARM           SFILE                           S01117
     C                     PARM           ZSNUM                           S01117
     C                     PARM           ZSERR   1                       S01117
      *                                                                   S01117
     C           *LOCK     IN   LDA                                       S01117
     C           ZSERR     IFEQ 'Y'                                       S01117
      ** ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM        S01117
     C                     SETON                     U7U8LR               S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C**                                                                  S01117
     C** RETRIEVE SETTLEMENT BRANCH NAME                                  S01117
     C**********           CALL 'AOBRCHR0'                                             S01117 CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       S01117
     C                     PARM '*KEY   ' @OPTN   7                       S01117
     C                     PARM OSBR      @DSNB   3                       S01117
     C********** SDBRCH    PARM SDBRCH    DSFDY                                        S01117 CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANK                                    S01117
     C                     SETON                     U7U8LR               S01117
     C                     MOVEL'SDBRCHPD'DBFILE           ***************S01117
     C                     MOVEL@DSNB     DBKEY            * DBERROR 004 *S01117
     C                     MOVEL'004'     DBASE            ***************S01117
     C                     MOVE *BLANKS   BRNM                            S01117
     C                     EXSR *PSSR                                     S01117
     C                     END                                            S01117
     C   U7                GOTO ENDDET                                    S01117
     C**                                                                  S01117
     C                     END                                            S01117
     C**                                                                  S01117
     C                     ELSE                                           S01117
     C**                                                                  S01117
     C*       IF MBIN='N' AND FIRST CYCLE,                                S01117
     C*       OPEN LE0520P1                                               S01117
     C**                                                                  S01117
     C           P1OP      IFNE 'Y'                                       S01117
     C                     MOVE 'Y'       P1OP    1                       S01117
     C                     OPEN LE0520P1                                  S01117
     C                     Z-ADD0         PAGE                            S01117
     C                     Z-ADD0         PAGE1                           S01117
     C**                                                                  S01117
     C*       ENSURE REPORT SPOOL FILE RECORDED BY RCF                    S01117
     C**                                                                  S01117
     C                     Z-ADDSFNUM     ZSNUM                           S01117
     C                     OUT  LDA                                       S01117
      *                                                                   S01117
     C**********           CALL 'ZSFILE'                                               S01117 216350
     C                     CALL 'ZSFILE2'                                                     216350
     C                     PARM           SEQ                             S01117
     C                     PARM           RNAM                                                216350
     C                     PARM OSBR      SENTY   3                       S01117
     C                     PARM           SFILE                           S01117
     C                     PARM           ZSNUM                           S01117
     C                     PARM           ZSERR   1                       S01117
      *                                                                   S01117
     C           *LOCK     IN   LDA                                       S01117
     C           ZSERR     IFEQ 'Y'                                       S01117
      ** ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM        S01117
     C                     SETON                     U7U8LR               S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C**                                                                  S01117
0400 C   L1                EXSR HEADER
0401 C   U7 LR             GOTO ENDDET
0402 C***********ENTRY1    TAG                             ** ENTRY1 TAG**S01117
0403 C**********           MOVE CNUMPH    CNUMK                           S01194
0403 C***********          MOVE CNUMPH    KEYC                      S01194BHF096
0403 C                     MOVELCNUMPH    KEYC                            BHF096
0404 C                     EXSR CLIEN2
0405 C                     MOVE NAMTWN    CUSDET
0406 C           SETP      COMP 01                       71
0407 C           SETP      COMP 02                       72
0408 C           SETP      COMP 12                       73
0409 C           SPI,1     COMP SBLANK                   25
0410 C           SPI,2     COMP SBLANK                   26
0411 C           SPI,3     COMP SBLANK                   27
0412 C                     SETOF                     28
0413 C   25 26 27          SETON                     28
     C*
     C**   CHECK BENIFICIARY BANK DETAILS
     C*
     C**   IGNORE IF FIRST LINE OF SPECIAL INSTRUCTIONS IS BLANK
     C   25                GOTO BENEND
     C*
     C           SPEC5     COMP '/BEN/'              313132
     C   31                GOTO BENEND
     C*
     C**   CHECK FOR CHIPS NUMBER
     C           SPEC8     COMP '/CH'                    31
     C   31                MOVE SPEC14    WORK6   6
     C   31                MOVE *BLANKS   SPIONE
     C   31                MOVE 'CHIPS'   SPEC5
     C   31                MOVE WORK6     SPEC12
     C   31                GOTO BENEND
     C*
     C**   CHECK FOR FED. WIRE NUMBER
     C           SPEC8     COMP '/FW'                    31
     C   31                MOVE SPEC17    WORK9   9
     C   31                MOVE *BLANKS   SPIONE
     C   31                MOVE 'FED.WIRE'SPEC9
     C   31                MOVE WORK9     SPEC18
     C   31                GOTO BENEND
     C*
     C**   MUST NOW BE 'ACCOUNT'
     C                     MOVE SPEC30    WORK25 25
     C                     MOVE *BLANKS   SPIONE
     C                     MOVE 'A/C'     SPEC3
     C                     MOVE WORK25    SPEC29
     C*
     C           BENEND    TAG                             * BENEND TAG *
     C*
     C**  Get fee sequence for report.                                    E45727
     C*                                                                   E45727
     C                     MOVE FEESEQ    WOSEQ   2                       E45727
     C*                                                                   E45727
0414 C   51                EXSR PAY
0415 C   52                EXSR RECEIV
0416 C           EAMT      DIV  1000      ZZAMT
     C           *IN51     IFEQ *ON                                       155801
     C           *IN52     OREQ *ON                                       155801
0417 C           TESTOT    ADD  ZZAMT     TESTOT 153
     C                     ENDIF                                          155801
0418 C***20*****           Z-SUBZZAMT     ZZAMT                                               245691
0419 C                     EXSR GLZADD
     C           *IN51     IFEQ *ON                                       155801
     C           *IN52     OREQ *ON                                       155801
0420 C           CURIN     ADD  1         CURIN   30
     C                     ENDIF                                          155801
0421 C*
0422 C           ENDDET    TAG                             ** ENDDET TAG**
0423 C           RECIN     ADD  1         RECIN   50
0424 C   02                SETON                     LR
0425 C/SPACE 3
      *                                                                   S01117
      **  ENSURE TOTALS SPOOL FILE RECORDED BY RCF                        S01117
      *                                                                   S01117
     CLR U7N40             SETON                     80                                     BUG11461
     CLR U7N40             SETOF                     U7                                     BUG11461
     CLR                   Z-ADDSFNUMU    ZSNUMU  60                      S01117
     CLR                   OUT  LDA                                       S01117
      *                                                                   S01117
     C*LR*********         CALL 'ZSFILE'                                               S01117 216350
     CLR                   CALL 'ZSFILE2'                                                     216350
     CLR                   PARM           SEQ                             S01117
     CLR                   PARM           RNAM                                                216350
     CLR                   PARM *BLANK    SENTY   3                       S01117
     CLR                   PARM           SFILEU                          S01117
     CLR                   PARM           ZSNUMU                          S01117
     CLR                   PARM           ZSERR   1                       S01117
      *                                                                   S01117
     CLR         *LOCK     IN   LDA                                       S01117
     CLR         ZSERR     IFEQ 'Y'                                       S01117
      ** ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM        S01117
     CLR                   SETON                     U7U8                 S01117
     CLR                   RETRN                                          S01117
     CLR                   END                                            S01117
     C**                                                                  S01117
     CLR         *IN38     IFEQ '0'                                       S01117
     CLR                   EXSR #ZZ                                       S01117
     CLR                   END                                            S01117
0426 CLR         NORE      COMP RECIN                U8U8
0427 CLRNU8      HRWN      COMP ZZTOTI               U8U8
0428 CLRNU8      HRDC      COMP ZZTOTD               U8U8
     CLR    U7 U8          EXSR *PSSR                                     S01117
0429 C/EJECT
0430 C* S U B R O U T I N E S
0431 C*
0522 C/SPACE 3
0523 C********************************************************************
0524 C* SUBROUTINE TO ADD AN AMOUNT (ZZAMT) TO THE TOTAL (ZZTOTI,ZZTOTD)
0525 C*   IND '99' IS SET BY AN OVERFLOW ERROR
0526 C*
0527 CSR         GLZADD    BEGSR                           *** GLZADD ****
0528 C*
0529 CSR                   Z-ADDZZAMT     ZZAMT  153     91-DEFINE ZZAMT
0530 CSR 91                GOTO ZZAEND                     AMT = 0.BYPASS
0531 C*
0532 C* SPLIT ZZAMT INTO INTEGER AND DECIMAL FIELDS
0533 CSR                   Z-ADDZZAMT     ZZAMTI 150       INTEGER FIELD
0534 CSR                   MOVE ZZAMT     ZZAMTD  30       DECIMAL FIELD
0535 C* BOTH ZZAMTI AND ZZAMTD CONTAIN A 'SIGN' ZONE NOW
0536 C*
0537 CSR                   EXSR GLZSUM
0538 CSR         ZZAEND    ENDSR                           ** ZZAEND TAG *
0539 C*
0540 C********************************************************************
0541 C* SUBROUTINE TO CARRY OUT THE ADDITION FOR SUBROUTINES -
0542 C*                        GLZADD, GLZSUB, GLZCMP.
0543 C*          PARAMETERS PASSED -
0544 C*                     I/P ZZAMTI ZZAMTD
0545 C*                     O/P ZZTOTI ZZTOTD ZZNEGD IND 96 IND 99.
0546 C*
0547 CSR         GLZSUM    BEGSR                           *** GLZSUM ****
0548 C*
0549 CSR                   Z-ADDZZTOTI    ZZTOTI 150       DEFINE ZZTOTI
0550 CSR                   Z-ADDZZTOTD    ZZTOTD  30       DEFINE ZZTOTD
0551 CSR                   SETOF                     919293
0552 CSR                   SETOF                     949599
0553 C*
0554 C*    DETERMINE SIGN OF ZZAMTI & D,   92 IF NEG
0555 CSR         ZZAMTI    COMP 0                      9293
0556 CSR 93      ZZAMTD    COMP 0                      9293
0557 CSR 93                GOTO ZZSEND                     ZERO BYPASS
0558 C*
0559 C*    DETERMINE SIGN OF ZZTOTI & D, 91 IF NEG.
0560 CSR         ZZTOTI    COMP 0                      9193
0561 CSR 93      ZZTOTD    COMP 0                      9193
0562 C*
0563 C*    IF ZZTOTAL IS ZERO, RETURN ZZAMOUNT.
0564 CSR 93                Z-ADDZZAMTI    ZZTOTI
0565 CSR 93                Z-ADDZZAMTD    ZZTOTD
0566 CSR 93                GOTO ZZSEND                     ZERO BYPASS
0567 C*    IF SIGNS DIFFER BYPASS OVERFLOW CHECKS.
0568 CSR 91N92
0569 CORN91 92             GOTO ZZOFPS
0570 C*
0571 CSR         ZZAMTD    ADD  ZZTOTD    ZZWK2   40
0572 CSR         ZZWK2     COMP 999                  93    '93' = CARRY
0573 CSRN93      ZZWK2     COMP -999                   93    INTO INTEGER.
0574 C*
0575 CSR 93N92   ZZAMTI    ADD  1         ZZWK3  150       ADD 'CARRY' +VE
0576 CSR    93 92ZZAMTI    SUB  1         ZZWK3            SUB 'CARRY' -VE
0577 CSR 93      ZZTOTI    ADD  ZZWK3     ZZWK3
0578 CSRN93      ZZTOTI    ADD  ZZAMTI    ZZWK3
0579 C*
0580 C* IF THE MODULUS OF ZZWK3 IS LT MOD. ZZTOTI THEN O/F HAS OCCURED
0581 CSRN92      ZZWK3     COMP ZZTOTI                 99  -92 MEANS NOS.
0582 CSR 92      ZZWK3     COMP ZZTOTI               99     NEGATIVE
0583 CSRN99                Z-ADDZZWK2     ZZTOTD
0584 CSRN99                Z-ADDZZWK3     ZZTOTI
0585 C*
0586 C* IF O/F ZEROIZE ZZAMT , IND '99' SET AND ZZTOT FIELDS LEFT INTACT.
0587 CSR 99                Z-ADD0         ZZAMT  153
0588 CSR                   GOTO ZZSEND
0589 C*
0590 C* THE 'SIGNS' ARE DIFFERENT
0591 CSR         ZZOFPS    TAG                             ** ZZOFPS TAG**
0592 C* IF ZZAMT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZTOT
0593 C*
0594 CSR 92                Z-SUBZZAMTI    ZZAMTI 150
0595 CSR 92                Z-SUBZZAMTD    ZZAMTD  30
0596 C*
0597 C* IF ZZTOT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZAMT.
0598 C*
0599 CSR 91                Z-SUBZZTOTI    ZZTOTI
0600 CSR 91                Z-SUBZZTOTD    ZZTOTD
0601 C* BOTH ZZAMT AND ZZTOT ARE NOW POSITIVE.
0602 C*
0603 CSR         ZZTOTI    COMP ZZAMTI               93  95
0604 CSR 95      ZZTOTD    COMP ZZAMTD               93  95
0605 C*
0606 C* IF ZZTOT EQ. ZZAMT RETURN ZERO.
0607 CSR 95                Z-ADD0         ZZTOTI
0608 CSR 95                Z-ADD0         ZZTOTD
0609 CSR 95                GOTO ZZSEND
0610 C*
0611 C* IF ZZTOT GT. ZZAMT.
0612 CSR 93      ZZAMTD    COMP ZZTOTD               94
0613 CSR 93 94   ZZTOTI    SUB  1         ZZTOTI
0614 CSR 93 94   ZZTOTD    ADD  1000      ZZWK2
0615 CSR 93      ZZTOTI    SUB  ZZAMTI    ZZTOTI
0616 CSR 93 94   ZZWK2     SUB  ZZAMTD    ZZTOTD
0617 CSR 93N94   ZZTOTD    SUB  ZZAMTD    ZZTOTD
0618 C*
0619 C*
0620 C* IF ZZAMT GT. ZZTOT.
0621 CSRN93      ZZTOTD    COMP ZZAMTD               94
0622 CSRN93 94   ZZAMTI    SUB  1         ZZWK3  150
0623 CSRN93 94   ZZAMTD    ADD  1000      ZZWK2
0624 CSRN93 94   ZZWK3     SUB  ZZTOTI    ZZTOTI
0625 CSRN93N94   ZZAMTI    SUB  ZZTOTI    ZZTOTI
0626 CSRN93 94   ZZWK2     SUB  ZZTOTD    ZZTOTD
0627 CSRN93N94   ZZAMTD    SUB  ZZTOTD    ZZTOTD
0628 C*
0629 C* REVERSE SIGN OF ZZTOT IF LARGER I/P FIELDS WERE NEGATIVE
0630 CSR                   SETOF                     94
0631 CSR 93 91
0632 CORN93 92             SETON                     94
0633 CSR 94                Z-SUBZZTOTI    ZZTOTI
0634 CSR 94                Z-SUBZZTOTD    ZZTOTD
0635 C**
0636 C**   RESTORE SIGN OF ZZAMTI & ZZAMTD IF IT WAS REVERSED.
0637 CSR 92                Z-SUBZZAMTI    ZZAMTI
0638 CSR 92                Z-SUBZZAMTD    ZZAMTD
0639 CSR         ZZSEND    TAG                             ** ZZSEND TAG *
0640 C**
0641 C**   IF ZZTOTD IS ZERO, AND ZZTOTI IS NEG. SET UP ZZNEGD.
0642 CSR                   SETOF                     96
0643 CSR         ZZTOTD    COMP 0                        91
0644 CSR 91      ZZTOTI    COMP 0                      96
0645 CSR 96                MOVE '.000-'   ZZNEGD  5
0646 CSR                   ENDSR                             ** ENDSR **
0647 C********************************************************************
0648 C/EJECT
0649 C********************************************************************
0650 C*
0651 C*      HEADER SUBROUTINE TO FIND INFORMATION FOR TELEX
0652 C*         SUBROUTINE CALLS ZDATE2
0653 C*       CALLED FROM: MAIN PROCESSING
0654 C           HEADER    BEGSR                           ***  HEADER ***
0655 C           PYRC      COMP 'P'                  525251
     C***********EAMT      IFEQ *ZERO                              152671 155801
     C********** STAT      IFEQ 'C'                                                    155801 CCB020
     C           COBST     IFEQ '*YES'                                                        CCB020
     C           VDAT      ANDEQBJRDNB                                    155801
     C                     MOVE *OFF      *INL1                           155801
     C                     MOVE *OFF      *IN51                           152671
     C                     MOVE *OFF      *IN52                           152671
     C                     ENDIF                                          152671
0658 C                     MOVE BLNK45    RP21
0659 C* O U R   A G E N T - 'CASE' ON SETTLEMENT TYPE
0660 C           SETP      COMP 00                       66
0661 C  N66                GOTO CELSE1
0662 C* N U L L
0663 C                     GOTO CEND1
0664 C           CELSE1    TAG                             * CELSE1 TAG *
0665 C           SETP      COMP 01                   6666
0666 C   66      SETP      COMP 02                   6666
0667 C   66      SETP      COMP 07                   6666
0668 C   66      SETP      COMP 08                   6666
0669 C   66      SETP      COMP 12                   6666
0670 C   66                GOTO CELSE2
0671 C***********OSAC      COMP ' '                      66               S01194
0672 C***********          MOVE CCY       CURR                            S01194
0673 C**********           MOVE ONOS      NOSTNO                          S01194
0674 C***66*****           MOVE '00'      NOSTNO                          S01194
0675 C**********           MOVE '70'      CODE                            S01194
0676 C********** ZTABKY    CHAINTABLE                67                   S01194
     C                     SETOF                     67                   BHF096
     C                     CALL 'AONOSTR0'                                S01194
     C                     PARM '*BLANKS' @RTCD                           S01194
     C                     PARM '*KEY   ' @OPTN                           S01194
     C                     PARM *BLANKS   @KEYA   6                       S01194
     C                     PARM CCY       @KEYB   3                       S01194
     C**********           PARM *BLANKS   @KEYC   4                                    S01194 CGL029
     C                     PARM *BLANKS   @KEYC  10                                           CGL029
     C                     PARM *BLANKS   @KEYD   2                       S01194
     C                     PARM ONOS      @KEYE   2                       S01194
     C                     PARM *BLANKS   @KEYF   3                       S01194
     C                     PARM *BLANKS   CSSN   10                       S01194
     C                     PARM *BLANKS   PNOI    1                       S01194
     C           SDNOST    PARM SDNOST    DSFDY                           S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     SETON                     67                   S01194
     C                     END                                            S01194
0677 C  N67                GOTO NOER1                                     S01194
0678 C                     MOVELMESS,1    OURAGN
0679 C                     GOTO CEND1
0680 C           NOER1     TAG                             * NOER1 TAG *
0681 C**********           MOVE CNUM      CNUMK                           S01194
0682 C**********           MOVE 'B'       CLIKEY                          S01194
0683 C*********  CLIKEY    CHAINCLINT                67                   S01194
     C***********          MOVELCNUM      KEYC                      S01194BHF070
     C                     SETOF                     67                   BHF096
     C                     MOVELA7CUST    KEYC                            BHF070
     C                     CALL 'AOCUSTR0'                                S01194
     C                     PARM '*BLANKS' @RTCD                           S01194
     C                     PARM '*KEY   ' @OPTN                           S01194
     C                     PARM           KEYC   10                       S01194
     C                     PARM '*CNUM  ' KEYSTS  7                       S01194
     C           SDCUST    PARM SDCUST    DSSDY                           S01194
     C*                                                                   S01194
     C           @RTCD     IFNE *BLANKS                                   S01194
     C                     SETON                     67                   S01194
     C                     ELSE                                           BHF070
     C                     MOVELBBCNA1    CNA1                            BHF070
     C                     MOVELBBCRNM    CRNM                            BHF070
     C                     MOVELBBCRTN    CTWN                            BHF070
     C                     END                                            S01194
0684 C  N67                MOVELNAMTWN    RP21
0685 C   67                MOVELMESS,2    OURAGN
0686 C                     GOTO CEND1
0687 C           CELSE2    TAG                             * CELSE2 TAG *
0688 C           SETP      COMP 03                       66
0689 C  N66                GOTO CELSE3
0690 C                     MOVE BICN      CUST
0691 C                     MOVE CSAC      ACOD
0692 C                     MOVE '01'      ACSQ
0693 C                     GOTO CEND1
0694 C           CELSE3    TAG                             * CELSE3 TAG *
0695 C           SETP      COMP 06                       66
0696 C  N66                GOTO CELSE4
0697 C                     MOVE BICN      CUST
0698 C                     MOVE COMS      ACOD
0699 C                     MOVE '01'      ACSQ
0700 C                     GOTO CEND1
0701 C           CELSE4    TAG                             * CELSE4 TAG *
0702 C           SETP      COMP 05                       66
0703 C  N66                GOTO CELSE5
0704 C                     MOVE OCNUM     CUST
0705 C                     MOVE OACOD     ACOD
0706 C                     MOVE OACSQ     ACSQ
0707 C                     GOTO CEND1
0708 C           CELSE5    TAG                             * CELSE5 TAG *
0709 C* TYPE '14' WILL NOT OCCUR HERE.
0710 C*          SETP      COMP 14                       66
0711 C* N66                GOTO CELSE6
0712 C*                    GOTO CEND1
0713 C*          CELSE6    TAG                             * CELSE6 TAG *
0714 C           SETP      COMP 04                       66
0715 C**N66*****           GOTO CEND1                                     CLE033
     C  N66                GOTO CEND6                                     CLE033
0716 C                     MOVE CADC      ACOD
0717 C                     MOVE '01'      ACSQ
0718 C                     GOTO CEND1
     C           CEND6     TAG                                            CLE033
     C           SETP      COMP 09                       66               CLE033
     C  N66                GOTO CEND1                                     CLE033
      * Settlement 09 customer                                            CLE033
     C                     MOVELP@VL01    CUST                            CLE033
      * Settlement 09 account code                                        CLE033
     C                     MOVELP@VL02    ACOD                            CLE033
     C                     MOVE '01'      ACSQ                            CLE033
     C                     GOTO CEND1                                     CLE033
0719 C* N U L L
0720 C           CEND1     TAG                             ** CEND1 TAG **
0721 C*
0722 C                     Z-ADDVDAT      ZDAYNO           CONVERT
0723 C                     EXSR ZDATE2                       VALUE DATE
0724 C*
0725 C**********           MOVE '20'      CODE             GET CCY NA     S01194
0726 C**********           MOVE '        'ZTABKY                          S01194
0727 C**********           MOVE CCY       CURX                            S01194
0728 C**********           MOVE '1'       NOX                             S01194
0729 C*********  ZTABKY    CHAINTABLE                67                   S01194
     C                     SETOF                     67                   BHF096
     C                     CALL 'AOCURRR0'                                S01194
     C                     PARM '*BLANKS' @RTCD   7                       S01194
     C***********          PARM '*FIRST ' @OPTN   7                 S01194BHF070
     C                     PARM '*KEY   ' @OPTN   7                       BHF070
     C                     PARM CCY       CKEY    3                       S01194
     C           SDCURR    PARM SDCURR    DSSDY                           S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     SETON                     67                   S01194
0730 C      67             MOVELMESS,3    CCNM                            S01194
     C                     END                                            S01194
0731 C           CDP       COMP 1                    626061
0732 C           CDP       COMP 2                    63  62
0733 C*
0734 C                     ENDSR
0735 C********************************************************************
0736 C/EJECT
0737 C********************************************************************
0738 C*
0739 C*          SUBROUTINE FOR PAY TELEX PROCESSING
0740 C*            SUBROUTINE CALLS CLIEN2,CPNOST,CLIEN1
0741 C*          CALLED FROM:  MAIN PROCESSING
0742 C           PAY       BEGSR                           ****  PAY  ****
0743 C* IF SETTLEMENT TYPE '01'
0744 C                     MOVE BLNK55    RP31
0745 C  N71                GOTO ENDPAY
0746 C***********          MOVE CUST      CNUMK                           S01194
0746 C***********          MOVE CUST      KEYC                      S01194BHF096
0746 C                     MOVELCUST      KEYC                            BHF096
0747 C                     EXSR CLIEN2
0748 C                     MOVELNAMTWN    RP31
0749 C                     MOVE BLNK10    RP31
0750 C  N67                GOTO ENDTHR                     CLIENT FOUND
0751 C                     MOVE TCNOS     COUNTN
0752 C                     EXSR CPNOST
0753 C                     MOVELCOUNOS    RP31
0754 C           ENDTHR    TAG                             ** ENDTHR TAG**
0755 C* GET BENEFICIARY DETAILS IF PRESENT
0756 C                     MOVE BLNK55    RP41
0757 C   22                GOTO ENDPAY
0758 C**********           MOVE FCNUM     CNUMK                           S01194
0758 C***********          MOVE FCNUM     KEYC                      S01194BHF096
0758 C                     MOVELFCNUM     KEYC                            BHF096
0759 C                     EXSR CLIEN1
0760 C                     MOVELCRNM      BENAME
0761 C                     MOVELCTWN      BETOWN
0762 C  N67                GOTO ENDPAY
0763 C                     MOVE CONOST    COUNTN
0764 C                     EXSR CPNOST
0765 C                     MOVE COUNOS    RP41
0766 C           ENDPAY    ENDSR                           ** ENDPAY TAG**
0767 C********************************************************************
0768 C/SPACE 3
0769 C********************************************************************
0770 C*           SUBROUTINE FOR RECIEVE TELEX PROCESSING
0771 C*                 CALLS CLIEN2,CPNOST
0772 C*        CALLED BY: MAIN PROCESSING
0773 C           RECEIV    BEGSR                           *** RECEIV ***
0774 C* GET THEIR AGENT DETAILS IF SETTLEMENT TYPE '01'
0775 C                     MOVE BLNK55    RP31
0776 C  N71                GOTO ENDREC
0777 C**********           MOVE CUST      CNUMK                           S01194
0777 C***********          MOVE CUST      KEYC                      S01194BHF096
0777 C                     MOVELCUST      KEYC                            BHF096
0778 C                     EXSR CLIEN2
0779 C                     MOVELNAMTWN    RP31
0780 C                     MOVE BLNK10    RP31
0781 C  N67                GOTO ENDREC
0782 C                     MOVE TCNOS     COUNTN
0783 C                     EXSR CPNOST
0784 C                     MOVE COUNOS    RP31
0785 C*
0786 C           ENDREC    ENDSR                           ** ENDREC TAG**
0787 C********************************************************************
0788 C/EJECT
0789 C********************************************************************
0790 C* SUBROUTINE TO GET COUNTERPARTY/NOSTRO INFOMATION
0791 C*     CALLED BY: PAY
0792 C           CPNOST    BEGSR                           *** CPNOST ***
0793 C**********           MOVE BLNK55    COUNOS                          S01194
0794 C********** CNOSKY    CHAINTABLE                67                   S01194
     C                     SETOF                     67                   BHF096
     C                     CALL 'AONOSTR0'                                S01194
     C                     PARM '*BLANKS' @RTCD                           S01194
     C                     PARM '*KEY   ' @OPTN                           S01194
     C                     PARM *BLANKS   @KEYA   6                       S01194
     C                     PARM CCY       @KEYB   3                       S01194
     C**********           PARM *BLANKS   @KEYC   4                                    S01194 CGL029
     C                     PARM *BLANKS   @KEYC  10                                           CGL029
     C                     PARM *BLANKS   @KEYD   2                       S01194
     C                     PARM ONOS      @KEYE   2                       S01194
     C                     PARM *BLANKS   @KEYF   3                       S01194
     C                     PARM *BLANKS   @KEYG  10                       S01194
     C                     PARM *BLANKS   @KEYH   1                       S01194
     C           SDNOST    PARM SDNOST    DSFDY                           S01194
     C           @RTCD     IFEQ *BLANK                                    S01194
     C                     SETON                     67                   S01194
     C                     END                                            S01194
0795 C   67                MOVELMESS,4    CPNM
0796 C                     ENDSR
0797 C********************************************************************
0798 C/SPACE 3
0799 C********************************************************************
0800 C* SUBROUNTINE TO SETUP CLIENT INFOMATION FROM THE 1ST CLIENT RECORD
0801 C*    CALLED BY: PAY,RECEIV
0802 C           CLIEN1    BEGSR                           *** CLIEN1 ***
0803 C**********           MOVE BLNK45    NAMTWN                          S01194
0804 C**********           MOVE 'A'       CLIKEY                          S01194
0805 C********** CLIKEY    CHAINCLINT                67                   S01194
     C                     SETOF                     67                   BHF096
     C                     CALL 'AOCUSTR0'                                S01194
     C                     PARM '*BLANKS' @RTCD                           S01194
     C                     PARM '*KEY   ' @OPTN                           S01194
     C                     PARM           KEYC   10                       S01194
     C                     PARM '*CNUM  ' KEYSTS  7                       S01194
     C           SDCUST    PARM SDCUST    DSSDY                           S01194
     C*                                                                   S01194
     C           @RTCD     IFNE *BLANKS                                   S01194
     C                     SETON                     67                   S01194
     C                     ELSE                                           BHF070
     C                     MOVELBBCNA1    CNA1                            BHF070
     C                     MOVELBBCRNM    CRNM                            BHF070
     C                     MOVELBBCRTN    CTWN                            BHF070
     C                     END
0806 C   67                MOVELMESS,2    CRNM
0807 C   67                MOVELMESS,2    CTWN
0808 C                     ENDSR
0809 C********************************************************************
0810 C/SPACE 3
0811 C********************************************************************
0812 C* SUBROUTINE TO SETUP CLIENT INFOMATION FROM BOTH RECORDS
0813 C*    CALLED BY: PAY,RECEIV
0814 C           CLIEN2    BEGSR                           *** CLIEN2 ***
0815 C**********           MOVE 'A'       CLIKEY                          S01194
0816 C*******    CLIKEY    CHAINCLINT                67                   S01194
     C                     SETOF                     67                   BHF096
     C                     CALL 'AOCUSTR0'                                S01194
     C                     PARM '*BLANKS' @RTCD                           S01194
     C                     PARM '*KEY   ' @OPTN                           S01194
     C                     PARM           KEYC   10                       S01194
     C                     PARM           KEYSTS  7                       S01194
     C           SDCUST    PARM SDCUST    DSSDY                           S01194
     C*                                                                   S01194
     C           @RTCD     IFNE *BLANKS                                   S01194
     C                     SETON                     67                   S01194
     C                     ELSE                                           BHF070
     C                     MOVELBBCNA1    CNA1                            BHF070
     C                     MOVELBBCRNM    CRNM                            BHF070
     C                     MOVELBBCRTN    CTWN                            BHF070
     C                     END
0817 C***67*****           GOTO CLIERR                                    S01194
0818 C**********           MOVE 'B'       CLIKEY                          S01194
0819 C*********  CLIKEY    CHAINCLINT                67                   S01194
0820 C**********           MOVE 'A'       CLIKEY                          S01194
0821 C  N67                GOTO CLIEND
0822 C           CLIERR    TAG                             ** CLIERR TAG**
0823 C                     MOVE BLNK45    NAMTWN
0824 C                     MOVELMESS,2    CRNM
0825 C                     MOVELMESS,2    CTWN
0826 C                     MOVELMESS,2    CNA1
0827 C           CLIEND    ENDSR                           ** CLIEND TAG**
0828 C********************************************************************
0829 C/EJECT
0830 C********************************************************************
0831 C**
0832 C**   ZSYSTM SR. TO CHAIN TO THE INSTALLATION CONTROL DATA RECORD.
0833 C**
0834 C           ZSYSTM    BEGSR                           *** ZSYSTM ***
0835 C**
0836 C**   SET UP KEY FOR INSTALLATION CONTROL RECORD.
0837 C**********           MOVEL'01      'ZTABKY 12                       S01194
0838 C**********           MOVE '  10'    ZTABKY                          S01194
0839 C**********                                                          S01194
0840 C********** ZTABKY    CHAINTABLE                99    ON NOT THERE   S01194
0841 C**N99***** RECI      COMP 'D'                  9999  ON, IS DELETED S01194
0842 C**                                                                  S01194
     C**                                                                  S01194
     C**   ACCESS BANK DETAILS                                            S01194
     C**                                                                  S01194
     C                     CALL 'AOBANKR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDBANK    PARM SDBANK    DSFDY                           S01194
     C*                                                                   S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     SETON                     99                   S01194
     C                     ELSE                                           S01194
0843 C**   CHECK SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.
0844 C********** DATF      COMP 'M'                      98MMDDYY, 98 ON  S01194
0844 C           BJDFIN    COMP 'M'                      98MMDDYY, 98 ON  S01194
     C                     END                                            S01194
0845 C**
0846 C                     ENDSR
0847 C**
0848 C**
0849 C********************************************************************
     C*                                                                   S01117
     C*                                                                   S01117
     C* SUBROUTINE : #ZZ                                                  S01117
     C*                                                                   S01117
     C* CALLED BY MAIN PROCESSING DURING TOTAL TIME CALCULATIONS IF       S01117
     C* THE P1 FILES HAVE NOT ALREADY BEEN OPENED (IE, IF THERE ARE       S01117
     C* NO RECORDS READ AND THEREFORE FILES OPENING NOT PERFORMED)        S01117
     C**                                                                  S01117
0454 C           #ZZ       BEGSR                           *** NODETL *** S01117
     C**                                                                  S01117
     C                     MOVE 'Y'       P1OP                            S01117
     C                     OPEN LE0520P1                                  S01117
     C                     Z-ADD*ZEROS    PAGE                            S01117
     C                     Z-ADD*ZEROS    PAGE1                           S01117
     C*                                                                   S01117
     C** ENSURE REPORT SPOOL FILE RECORDED BY RCF                         S01117
     C**                                                                  S01117
     C                     Z-ADDSFNUM     ZSNUM   60                      S01117
     C                     OUT  LDA                                       S01117
     C**                                                                  S01117
     C**********           CALL 'ZSFILE'                                               S01117 216350
     C                     CALL 'ZSFILE2'                                                     216350
     C                     PARM           SEQ                             S01117
     C                     PARM           RNAM                                                216350
     C                     PARM *BLANKS   SENTY   3                       S01117
     C                     PARM           SFILE                           S01117
     C                     PARM           ZSNUM                           S01117
     C                     PARM           ZSERR   1                       S01117
      *                                                                   S01117
     C           *LOCK     IN   LDA                                       S01117
     C           ZSERR     IFEQ 'Y'                                       S01117
      **  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM       S01117
     C                     SETON                     U7U8LR               S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C**                                                                  S01117
      ** OUTPUT 'NO DETAILS TO REPORT' IN P1                              S01117
     C                     EXCPT                                          S01117
     C**                                                                  S01117
     C*                                                                   S01117
0466 C                     ENDSR                                          S01117
     C*                                                                   S01117
0497 C********************************************************************S01117
     C*                                                                   S01117
     C* *PSSR  --- SUBROUTINE TO HANDLE ABNORMAL ERROR CONDITIONS         S01117
     C*                                                                   S01117
     C* CALLED FROM: AFTER ABNORNAL OPERATION OCCURS                      S01117
     C*                                                                   S01117
     C* CALLS: NOTHING                                                    S01117
     C*                                                                   S01117
     C********************************************************************S01117
     C*                                                                   S01117
     C           *PSSR     BEGSR                           ** *PSSR **    S01117
     C*                                                                   S01117
     C           @RUN      IFEQ *BLANKS                                   S01117
     C                     MOVE 'Y'       @RUN    1                       S01117
     C                     DUMP                                           S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C                     ENDSR                           ** *PSSR **    S01117
     C********************************************************************S01117
     C/COPY ZSRSRC,ZDATE2Z4                                               S01392
     C********************************************************************S01392
0850 C/EJECT
0851 O* S T A N D A R D   H E A D E R   L I N E
0852 OLE0520P1H  203   L1                                                 S01124
0853 O       OR        OFNL1
0854 O       OR        U7 LR
0855 O***********                        23 'REFERENCE LE0520-'           S01117
0856 O***********            51          25 '01'                          S01117
0857 O***********            52          25 '02'                          S01117
     O                                   25 'REFERENCE LE0520P1-'         S01117
     O                       51          27 '01'                          S01117
     O                       52          27 '02'                          S01117
0858 O                         TITL      89
0859 O                                  122 'DATE              PAGE'
0860 O                         RUNA     112
0861 O                         PAGE  Z  127
0862 O/SPACE 3
0863 O* C O M M O N   H E A D I N G S
0864 O        H  1     L1
0865 O       OR        OFNL1
0866 O       OR        U7 LR
0867 O*****                               6 'BRANCH'                      S01117
0868 O*****                    BRCD      10                               S01117
0869 O***********                        64 'BANKERS AUTHORISATIONS -'    S01117
0870 O***********                        73 'PAYMENTS'                    S01117
0871 O***********            52          73 'RECEIPTS'                    S01117
0872 O***********                       113 'EXCEPTION'                   S01117
0873 O***********           N80         113 'NON-EXCEPTION'               S01117
0869 O                                   67 'BANKERS AUTHORISATIONS -'    S01117
0870 O                                   76 'PAYMENTS'                    S01117
0871 O                       52          76 'RECEIPTS'                    S01117
0873 O                 88                85 'BRANCH'                      S01117
0869 O                 88      OSBR      89                               S01117
0870 O                 88                91 '-'                           S01117
0871 O                 88      BRNM     122                               S01117
     O        H  1     L1                                                 S01117
     O       OR        OFNL1                                              S01117
     O       OR        U7 LR                                              S01117
0877 O***********                        64 '------------------------'    S01117
0878 O***********                        73 '---------'                   S01117
0877 O                                   67 '------------------------'    S01117
0878 O                                   76 '---------'                   S01117
0874 O********H**2     L1                                                 S01117
0875 O*******OR**      OFNL1                                              S01117
0876 O*******OR**      U7 LR                                              S01117
     O        H 11     L1                                                 S01117
     O       OR        OFNL1                                              S01117
     O       OR        U7 LR                                              S01117
     O                 88                20 'BY SETTLEMENT BRANCH'        S01117
0877 O***********                        64 '------------------------'    S01117
0878 O***********                        73 '---------'                   S01117
0872 O                                  116 'EXCEPTION'                   S01117
0873 O                      N80         116 'NON-EXCEPTION'               S01117
0879 O********H**1     L1NU7                                              S01117
     O        H 11     L1NU7                                              S01117
0880 O       OR        OFNL1NU7
0881 O                 51                 9 'OUR AGENT'
     O                 52                11 'DESTINATION'
0882 O                         OURAGN    48
0883 O        H  2     L1NU7
0884 O       OR        OFNL1NU7
0885 O                         OURAGT    23
0886 O        H  3     L1NU7
0887 O       OR        OFNL1NU7
0888 O                                    5 'VALUE'
0889 O                         ZADATE    13
0890 O                                   22 'PAY'
0891 O                    52             22 'RECEIVE'
0892 O                         CCNM      37
0893 O        H  1     L1NU7
0894 O       OR        OFNU7NL1
0895 O                                    8 'CUSTOMER'
0896 O*****                              58 'LOAN    LOAN'                S01117
     O***********                        59 'LOAN  BK. LOAN'              S01117
     O***********                        51 'LOAN  '               S01117 E45727
     O***********      88                54 'BK.'                  S01117 E45727
     O***********                        59 'LOAN'                 S01117 E45727
     O***********                        47 'LOAN'                 E45727 087322
     O                                   48 'LOAN'                        087322
     O***********                        52 'FEE'                  E45727 087322
     O                                   53 'FEE'                         087322
     O***********      88                56 'BK.'                  E45727 087322
     O                 88                57 'BK.'                         087322
     O***********                        61 'LOAN'                 E45727 087322
     O                                   62 'LOAN'                        087322
0897 O        H  2     L1NU7
0898 O       OR        OFNL1NU7
0899 O                                    6 'NUMBER'
0900 O                                   24 'NAME & TOWN'
0901 O*****                              58 'NUMBER  TYPE'                S01117
     O*************                      59 'NUMBER BR. TYPE'             S01117
     O***********                        51 'NUMBER '              S01117 E45727
     O***********      88                54 'BR.'                  S01117 E45727
     O***********                        59 'TYPE'                 S01117 E45727
0902 O***********                        76 'AMOUNT'                      E45727
     O***********                        48 'NUMBER'               E45727 087322
     O                                   49 'NUMBER'                      087322
     O***********                        52 'SEQ'                  E45727 087322
     O                                   53 'SEQ'                         087322
     O***********      88                56 'BR.'                  E45727 087322
     O                 88                57 'BR.'                         087322
     O***********                        61 'TYPE'                 E45727 087322
     O                                   62 'TYPE'                        087322
     O***********                        78 'AMOUNT'               E45727 087322
     O                                   79 'AMOUNT'                      087322
0903 O                                  122 'SETTLEMENT INSTRUCTIONS'
0904 O* P A Y   T E L E X E S
0905 O        D  1     01 51NU7
0906 O                         CNUMPH     6
0907 O*****                    CUSNAM    44                               S01117
0907 O***********              CUSNAM    43                        S01117 E45727
     O***********              CUSNAM    41                        E45727 087322
     O                         CUSNAM    42                               087322
0908 O*****                    FCLN      52                               S01117
     O***********              FCLN      50                        S01117 E45727
     O***********              FCLN      48                        E45727 087322
     O                         FCLN      49                               087322
     O***********              WOSEQ     51                        E45727 087322
     O                         WOSEQ     52                               087322
     O***********      88      BRCA      54                        S01117 E45727
     O***********      88      BRCA      56                        E45727 087322
     O                 88      BRCA      57                               087322
0909 O*****                    LTYP      56                               S01117
0910 O*****                              57 '-'                           S01117
0911 O*****                    SUTP      59                               S01117
0909 O***********              LTYP      57                        S01117 E45727
0910 O***********                        58 '-'                    S01117 E45727
0911 O***********              SUTP      60                        S01117 E45727
0912 O***********            60EAMT      78 ' ,   ,   ,   , 0 -'          E45727
0913 O***********            61EAMT      80 '   ,   ,   , 0 . -'          E45727
0914 O***********            62EAMT      81 '  ,   ,   , 0 .  -'          E45727
0915 O***********            63EAMT      82 ' ,   ,   , 0 .   -'          E45727
0916 O***********            71          94 'PAY TO'                      E45727
0917 O***********            71THEIRN   131                               E45727
0918 O***********            72         113 'PAYMENT TO BE SENT'          E45727
0919 O***********            73         120 'PAYMENT WILL BE COLLECTE'    E45727
0920 O***********            73         121 'D'                           E45727
     O***********              LTYP      59                        E45727 087322
     O                         LTYP      60                               087322
     O***********                        60 '-'                    E45727 087322
     O                                   61 '-'                           087322
     O***********              SUTP      62                        E45727 087322
     O                         SUTP      63                               087322
     O                       60EAMT      80 ' ,   ,   ,   , 0 -'          E45727
     O                       61EAMT      82 '   ,   ,   , 0 . -'          E45727
     O                       62EAMT      83 '  ,   ,   , 0 .  -'          E45727
     O                       63EAMT      84 ' ,   ,   , 0 .   -'          E45727
     O                       71          96 'PAY TO'                      E45727
     O                       71THEIRN   132                               E45727
     O                       72         114 'PAYMENT TO BE SENT'          E45727
     O                       73         121 'PAYMENT WILL BE COLLECTE'    E45727
     O                       73         122 'D'                           E45727
0921 O        D  3     01 51NU7
0922 O*****                    CUSTWN    19                               S01117
0922 O***********              CUSTWN    18                        S01117 E45727
0923 O***********            71THEIRT   116                               E45727
     O                         CUSTWN    17                               E45727
     O                       71THEIRT   117                               E45727
0924 O        DF 1     01 51N22
0925 O       AND      NU7 71
0926 O                                   94 'FOR A/C OF'
0927 O                         BENAME   131
0928 O        D  2     01 51N22
0929 O       AND      NU7 71
0930 O***********              BETOWN   116                               E45727
     O                         BETOWN   117                               E45727
0931 O        D  1     01 51N28
0932 O       AND      NU7
0933 O                                   94 'SPEC. INST.'
     O                       32          94 'BENIF BANK '
0934 O                         SPI,1    126
0935 O        D  1     01 51N26
0936 O       AND      NU7
     O                       32          94 'SPEC. INST.'
0937 O                         SPI,2    126
0938 O        D  2     01 51N27
0939 O       AND      NU7
0940 O                         SPI,3    126
0941 O* R E C E I V E   T E L E X E S
0942 O        D  1     01 52NU7
0943 O                         CNUMPH     6
0944 O*****                    CUSNAM    44                               S01117
0944 O***********              CUSNAM    43                        S01117 E45727
     O***********              CUSNAM    41                        E45727 087322
     O                         CUSNAM    42                               087322
0945 O*****                    FCLN      52                               S01117
0946 O*****                    LTYP      56                               S01117
0947 O*****                              57 '-'                           S01117
0948 O*****                    SUTP      59                               S01117
     O***********              FCLN      50                        S01117 E45727
     O***********              BRCA      54                        S01117 E45727
0909 O***********              LTYP      57                        S01117 E45727
0910 O***********                        58 '-'                    S01117 E45727
0911 O***********              SUTP      60                        S01117 E45727
0949 O***********            60EAMT      78 ' ,   ,   ,   , 0 -'          E45727
0950 O***********            61EAMT      80 '   ,   ,   , 0 . -'          E45727
0951 O***********            62EAMT      81 '  ,   ,   , 0 .  -'          E45727
0952 O***********            63EAMT      82 ' ,   ,   , 0 .   -'          E45727
0953 O***********            71          94 'RECEIVE FROM'                E45727
0954 O***********            71THEIRN   131                               E45727
0955 O***********            72         113 'PAYMENT WILL BE SENT'        E45727
0956 O***********            73         121 'PAYMENT TO BE COLLECTED'     E45727
     O***********              FCLN      48                        E45727 087322
     O                         FCLN      49                               087322
     O***********              WOSEQ     51                        E45727 087322
     O                         WOSEQ     52                               087322
     O***********              BRCA      56                        E45727 087322
     O                         BRCA      57                               087322
     O***********              LTYP      59                        E45727 087322
     O                         LTYP      60                               087322
     O***********                        60 '-'                    E45727 087322
     O                                   61 '-'                           087322
     O***********              SUTP      62                        E45727 087322
     O                         SUTP      63                               087322
     O                       60EAMT      80 ' ,   ,   ,   , 0 -'          E45727
     O                       61EAMT      82 '   ,   ,   , 0 . -'          E45727
     O                       62EAMT      83 '  ,   ,   , 0 .  -'          E45727
     O                       63EAMT      84 ' ,   ,   , 0 .   -'          E45727
     O                       71          96 'RECEIVE FROM'                E45727
     O                       71THEIRN   132                               E45727
     O                       72         114 'PAYMENT WILL BE SENT'        E45727
     O                       73         122 'PAYMENT TO BE COLLECTED'     E45727
0957 O        D  2     01 52NU7
0958 O*****                    CUSTWN    19                               S01117
0958 O***********              CUSTWN    18                        S01117 E45727
0959 O***********            71THEIRT   116                               E45727
     O                         CUSTWN    17                               E45727
     O                       71THEIRT   117                               E45727
0960 O*
0961 O        T 3      L3 41NU7
     O       AND       51                                                 155801
     O       OR        L3 41NU7                                           155801
     O       AND       52                                                 155801
0962 O                                   32 'CURRENCY TOTAL    NO. OF'
0963 O                                   40 'ITEMS -'
0964 O                         CURIN 3B  44
0965 O                                   54 'VALUE -'
0966 O                 60      TESTOT B  81 '   ,   ,   ,   , 0 -'
0967 O                 61      TESTOT B  81 '  ,   ,   ,   , 0 . -'
0968 O                 62      TESTOT B  81 ' ,   ,   ,   , 0 .  -'
0969 O                 63      TESTOT B  81 '   ,   ,   , 0 .   -'
0970 O        T 32     U7 U8 LR
0971 O                                   22 '*** REFERENCE'
0972 O***********              DBPGM     31                               S01117
     O                                   51 '-DATABASE ERROR   '          S01117
0973 O***********                        51 '-DATABASE ERROR AT'          S01117
0974 O***********              DBASE     54                               S01117
0975 O********T**1     U7 U8 LR                                           S01117
0976 O***********                        17 'FILE NAME'                   S01117
0977 O***********              DBFILE    23                               S01117
0978 O***********                        28 'KEY'                         S01117
0979 O***********              DBKEY     58                               S01117
     O        T 3      L5 88 38                                           S01117
     O                                   66 '*** END OF REPORT FOR'       S01117
     O                                   74 ' BRANCH '                    S01117
     O***********              BRCA      77                               S01117
     O                         OSBR      77                               S01117
     O                                   81 ' ***'                        S01117
     O        T 3      LRN88 38                                           S01117
     O                                   76 '*** END OF REPORT ***'       S01117
0409 OLE0520P1E  203                                                      S01117
0412 O                                   24 'REFERENCE  LE0520P1'         S01117
0413 O                         TITL      89                               S01117
0414 O                                  103 'DATE'                        S01117
0415 O                         RUNA     112                               S01117
0416 O                                  122 'PAGE'                        S01117
0417 O                         PAGE  3  128                               S01117
0632 O        E 11                                                        S01117
0869 O                                   67 'BANKERS AUTHORISATIONS -'    S01117
0870 O                                   76 'PAYMENTS'                    S01117
0871 O                       52          76 'RECEIPTS'                    S01117
0632 O        E  1                                                        S01117
0877 O                                   67 '------------------------'    S01117
0878 O                                   76 '---------'                   S01117
0632 O        E 11                                                        S01117
     O                 88                20 'BY SETTLEMENT BRANCH'        S01117
0872 O                                  116 'EXCEPTION'                   S01117
0873 O                      N80         116 'NON-EXCEPTION'               S01117
     O        E 3     NU7                                                 S01117
     O                                   70 '***   NO DETAILS TO REPO'    S01117
     O                                   78 'RT   ***'                    S01117
     O        E 3                                                         S01117
0518 O                                   76 '*** END OF REPORT ***'       S01117
     O******************************************************************* S01117
0980 O* C O N T R O L S
     OLE0520AUT  203   LR                                                 S01117
0981 O*****   T  203   LR                                                 S01117
0982 O***********                        22 'REFERENCE LE0520'            S01117
0982 O                                   24 'REFERENCE LE0520AU'          S01117
0983 O                         TITL      89
0984 O                                  122 'DATE              PAGE'
0985 O                         RUNA     112
0986 O*****                    PAGE  Z  127                               S01117
0986 O                         PAGE1 Z  127                               S01117
0987 O        T  1     LR
0988 O                                   63 'BANKERS AUTHORISATIONS -'
0989 O                                   83 'FILE CONTROL REPORT'
0990 O                                  113 'EXCEPTION'
0991 O                      N80         113 'NON-EXCEPTION'
0992 O        T  3     LR
0993 O                                   63 '------------------------'
0994 O                                   83 '--------------------'
0995 O        T  1     LR
0996 O                                   29 'S/STX3 - RUN CONTROLS'
0997 O                                   59 'NUMBER'
0998 O                                   84 'VALUE'
0999 O        T  2     LR
1000 O                                   29 '----------------------'
1001 O                                   59 'OF RECORDS'
1002 O                                   84 'OF RECORDS'
1003 O        T  2     LR
1004 O                                   31 'TOTAL RECORDS - ON FILE'
1005 O                      NU7NORE  3   59
1006 O                      NU7HRWN  Z   81
1007 O**********            NU7HRDC      84                                                   245691
1007 O                      NU7HRDC  L   85                                                   245691
1008 O        T  3     LR
1009 O                                   32 'TOTAL RECORDS - CALCULAT'
1010 O                                   34 'ED'
1011 O                         RECIN 3   59
1012 O                         ZZTOTIZ   81
1013 O**********               ZZTOTD    84                                                   245691
1013 O                         ZZTOTDL   85                                                   245691
1014 O                 U8NU7            118 '***   DIFFERENCE   ***'
     O        T  2     U7 U8 LR                                           S01117
     O                                   22 '*** REFERENCE'               S01117
     O                         DBPGM     33                               S01117
     O                                   53 '-DATABASE ERROR AT'          S01117
     O                         DBASE     58                               S01117
     O        T  1     U7 U8 LR                                           S01117
     O                                   17 'FILE NAME'                   S01117
     O                         DBFILE    26                               S01117
     O                                   31 'KEY'                         S01117
     O                         DBKEY     61                               S01117
     O********T*3*     LRN38                                        S01117BHF216
     O************                       70 '***   NO DETAILS TO REPS01117BHF216
     O************                       78 'RT   ***'              S01117BHF216
1015 O********T*3      LR                                                 S01117
1016 O***********                        71 '*** END OF REPORT ***'       S01117
**  MESS
NOSTRO MISSING
CLIENT MISSING
CUR.NOT FOUND
COUNTERPARTY/NOSTRO MISSING
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
** CPY@   **      OBJECT COPYRIGHT
(c) Misys International Banking Systems Ltd. 2001
**   SVAL  -  SYSTEM VALUES ARRAY                                                             CLE033
Settlement09Customer                                                                          CLE033
Settlement09AccCode                                                                           CLE033
