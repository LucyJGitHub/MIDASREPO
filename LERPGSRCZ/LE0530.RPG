0001 H        1                                                           S01117
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas Prt Pay/Rec Tlxs - Intrnl Settlmnts')
0001 H***********                                                         S01117
0002 F*****************************************************************
0004 F*                                                               *
     F*  Midas - Customer Lending Module
0004 F*                                                               *
0005 F*  LE0530  -  INTERNAL SETTLEMENTS REPORT                       *
0006 F*                                                               *
      *  (c) Finastra International Limited 2001                      *
     F*                                                               *
      *  Last Amend No. MD046248           Date 27Oct17               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      *  Prev Amend No. 245691             Date 19Feb07               *
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CSD031             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 CGL029             Date 01Sep03               *
      *                 222373             Date 28Oct03               *
      *                 CLE033             Date 09Apr03               *
      * Midas Release 4.01.03 ----------------------------------------*
      *                 200797             Date 08Jan03               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 CSD005             Date 01MAR99               *
      *                 CTI002 EM / TI Interface 23/09/98             *
     F*                 CEU004             Date 02Feb98               *
     F*                 103435             Date 04Jun96               *
     F*                 057590             Date 23Sep93               *
     F*                 057194             DATE 05SEP93               *
     F*                 S01392             DATE 07OCT92               *S01392
     F*                 E39483             DATE 04MAY92               *
     F*                 BHF071             DATE 18MAY90               *BHF071
     F*                 LN0036             DATE 30APR89               *E20219
     F*                 S01194             DATE 17JAN90               *S01117
     F*                 S01117             DATE 17/06/89              *S01117
     F*                                                               *
     F*****************************************************************
     F*                                                               *
      *  MD046248 - Finastra Rebranding                               *
      *  245691 - Allow File Control Amounts to be negative.          *
      *           (complete 219063).  Applied fix 230531.             *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  222373 - Parameter Mismatch                                  *
      *  CLE033 - Settlement method 09                                *
      *  200797 - If account not found in ACNUM, print 'ACCOUNT HAS   *
      *           BEEN CLOSED' instead of dberror.                    *
      *  CSD005 - Standing Data Account Narrative.  Add new field     *
      *           to SDACODPD.  Recompilation of programs.            *
      *  CTI002 - Recompiled : File SDACODPD changed                  *
      *  CEU004 - LE Settlement Ccy conversion Upgrade to DBA R2.0    *
      *         - Recompiled                                          *
     F*  103435 - Remove access of SDDEALPD as it is no longer        *
     F*           required.                                           *
     F*  057590 - For transaction with settlement method '05',        *
     F*           should output the customer number of the            *
     F*           settlement account.  Same principle holds for       *
     F*           transaction with settlement method '14'.            *
     F*  057194 - If settlement type is 06 (computer suspense         *
     F*           account), program should output the suspense        *
     F*           account code and account sequence 01.               *
     F*           Same principle holds for settlement type 03         *
     F*           (compensation account).                             *
     F*  S01392 - JAPANESE SUB MODULE ENHANCEMENTS                    *S01392
     F*  E39483 - END OF REPORT PRINTED TWICE                         *
     F*  BHF071 - ACCOUNT SEQUENCE NUMBER NOT PRINTING                *BHF071
     F*  LN0036 - SETTLEMENT THROUGH A CLOSED RETAIL ACCOUNT,         *LN0036
     F*           LE0530 REPORT GAVE A DATABASE ERROR.                *LN0036
     F*  S01194 - STANDING DATA CHANGES                               *
     F*  S01117 - MULTIBRANCHING                                      *
     F*                                                               *
0010 F*****************************************************************
     F*  C R E A T I O N     P A R A M E T E R S                      *
     F*                                                               *
     F*                                                               *
     F*****************************************************************
0011 F/SPACE 3
0012 F*TX4    IP  F     180 18AI     2 DISK                               S01117
     F***STX4*** IP  F     200 37AI     2 DISK                                         S01117 CGL029
     FSTX4    IP  F     228 37AI     2 DISK                                                   CGL029
0013 F*TABLE***IF  F      96 12AI     2 DISK                              S01194
0014 F***ACNUM** IF  F      40 10AI     2 DISK                           U1                   CGL029
     FACNUM   IF  F     117 10AI     2 DISK                           U1                      CGL029
     F*E0530P1O   F     132     OF     PRINTER                            S01117
     FLE0530P1O   F     132     OF     PRINTER      KINFDS SPOOL      UC  S01117
     FLE0530AUO   F     132     OA     PRINTER      KINFDS SPOOLU         S01117
0016 F/SPACE 3
0017 F* ID F  C  H  L    FUNCTION OF INDICATORS
0018 F* 01            S/STX1 - DETAIL
0019 F* 02                    - TRAILER
0020 F**41************CATCHALL*FOR*S/TABLE*AND*S/ACNUM**NB.CHAIN FAILURE  S01194
0021 F*    20         SETTLEMENT TYPE NULL
0022 F*    21         AMOUNT NEGATIVE
     F*       38      INPUT FILE HAS AT LEAST ONE RECORD FOR OUTPUT       S01117
0023 F*       40      1ST CYCLE IND.
0024 F********41******CHAIN*FAILURE*******                                S01194
0024 F*       41      NON BLANK RETURN CODE AFTER CALL TO ACCESS OBJECT   S01194
     F*               OR CHAIN FAILURE.                                   S01194
0025 F*       50      PRODUCT BREAKDOWN
0026 F*       51      SETTLEMENT TYPE - 01 02 07 08 OR 12
0027 F*       52                      - 03
0028 F*       53                      - 06
0029 F*       54                      - 05
0030 F*       55                      - 14
0031 F*       56                      - 04
0032 F*       57-59   SPECIAL INSTRUCTIONS 1-3 RESPECTIVELY NOT BLANK
0033 F*       60      DEC. PLACES - 0
0034 F*       61                    1
0035 F*       62                    2
0036 F*       63                    3
0036 F*       64      SETTLEMENT THROUGH A CLOSED RETAIL ACCOUNT          LN0036
     F*       65      SETTLEMENT ACCOUNT HAS BEEN CLOSED & DROPPED.                           200797
     F*       66      SETTLEMENT TYPE 09                                  CLE033
0037 F*       69      NO DETAIL RECORDS
0038 F*       73      CREDIT
0039 F*       74      DEBIT
0040 F*       80      INTEREST CAPITALISATION IND - Y
0041 F*       81      INTEREST PAY/RECIEVE TELEX INDICATOR - 1
0042 F*       82      BOTH ABOVE INDICATORS ON
     F*       88      MBIN = Y                                            S01117
0043 E                    SPI         3 30               SPECIAL INSTR.
0044 E                    MESS    1   1 14               CURRENCY NOT FOUN
0045 E                    TABTYP  5   5  2 0A            5 SETTLEMENT TYPE
     E/COPY ZSRSRC,ZDATE2Z1                                               S01392
     E                    CPY@    1   1 80
     E*                                                                   CLE033
     E**  System values array                                             CLE033
     E                    SVAL    1   2 20                                CLE033
     E*                                                                   CLE033
0049 E/EJECT
0050 I* S/STX4 DETAIL RECORD
0051 ISTX4    NS  01   1 CD
0052 I                                        2   2 PYRC  L3
0053 I                                        3   40SETP            20
0054 I                                        5   7 CCY   L2
0055 I**********                              8  19 OSAC                                      CGL029
     I                                        8  19 OSACQQ                                    CGL029
0056 I                                    P  20  220VDAT  L1
0057 I                                       23  32 TSEN
0058 I**********                             33  380CNUMPH                                    CSD027
0058 I                                       33  38 CNUMPH                                    CSD027
0059 I                                       39  44 FCLN
0060 I                                    P  45  510EAMT          21
0061 I                                       52  52 RCDT
0062 I                                       53  54 AMTP
0063 I                                       55  570LASN
0064 I                                       58  67 FACO
0065 I                                       68 157 SPI
0066 I                                      158 1580PRI1
0067 I                                      159 1590PRI2
0068 I                                      160 1600PRI3
0069 I                                      161 1610PRI4
0070 I**********                            162 1670BICN                                      CSD027
0070 I                                      162 167 BICN                                      CSD027
0071 I                                      168 169 LTYP
0072 I                                      170 171 SUTP
0073 I                                      172 1730PTYP
0074 I                                      174 1740TIND
0075 I*****                                 175 1770BRCD  L4              S01117
     I                                      175 177 BRCA                  S01117
0076 I                                      178 178 INTC
     I                                      179 181 OSBR  L4              S01117
     I                                      211 228 OSAC                                      CGL029
0077 I*
0078 I* TRAILER
0079 I        NS  02   1 CT
0080 I                                    P   2   40NORE
0081 I                                    P   5  120HRWN
0082 I                                    P  13  140HRDC
     I*
0084 I* CATCHALL
0085 I        NS
0086 I*
0087 I*****TABLE*FILE***INSTALLATION*CONTROL*DATA*RECORD*1.               S01194
0    I**********                                                          S01194
0089 I*TABLE***NS       2 C0   3 C1  12 C1                                S01194
0090 I*******AND      13 C0                                               S01194
0091 I**********                              1   1 RECI                  S01194
0092 I**********                              2   30RECT                  S01194
0093 I**********                             12  130RCDE                  S01194
0094 I**********                             14  66 TITL                  S01194
0095 I**********                             67  67 DATF                  S01194
0096 I***********                            68  700DFBR                  S01194
0097 I**********                             74  74 MODI1                 S01194
0098 I**********                             75  75 MODI2                 S01194
0099 I**********                             76  76 MODI3                 S01194
0100 I**********                          P  77  790RUND                  S01194
0101 I**********                             80  86 RUNA                  S01194
0102 I**********                             87  870SFLG                  S01194
0103 I**********                          P  90  920LCD                   S01194
0104 I**********                             93  93 CHTP                  S01194
0105 I**********                          P  94  960TNLU                  S01194
0106 I**********                                                          S01194
0107 I*****TABLE*FILE***INSTALLATION*CONTROL*DATA*RECORD*3.               S01194
0108 I**********                                                          S01194
0109 I*TABLE***NS       1 CD   2 C0   3 C1                                S01194
0110 I*******AND      12 C2  13 C0                                        S01194
0111 I**********                              1   1 RECI                  S01194
0112 I**********                              2   30RECT                  S01194
0113 I**********                             12  130RCDE                  S01194
0114 I**********                             14  170COMS                  S01194
0115 I**********                             18  210CADC                  S01194
0116 I**********                          P  22  240MDIC                  S01194
0117 I**********                          P  25  270MCIC                  S01194
0118 I**********                          P  28  300MDIA                  S01194
0119 I**********                          P  31  330MCIA                  S01194
0120 I**********                             34  370SRPL                  S01194
0121 I**********                             38  410SPAC                  S01194
0122 I**********                             42  450SWAC                  S01194
0123 I**********                             46  490FTAC                  S01194
0124 I**********                             50  530TAC4                  S01194
0125 I**********                             54  570TAC5                  S01194
0126 I**********                          P  63  650NOBA                  S01194
0127 I**********                          P  66  680TSIZ                  S01194
0128 I**********                             69  69 RACN                  S01194
0129 I**********                             70  700GLSI                  S01194
0130 I**********                             71  710RTSI                  S01194
0131 I**********                             72  720DLSI                  S01194
0132 I**********                             73  730NOSI                  S01194
0133 I**********                             74  740CTSI                  S01194
0134 I**********                          P  75  770ELAC                  S01194
0135 I**********                          P  78  800ECAC                  S01194
0136 I**********                          P  90  920LCD                   S01194
0137 I**********                             93  93 CHTP                  S01194
0138 I**********                          P  94  960TNLU                  S01194
0139 I**********                                                          S01194
0140 I*****TABLE*FILE***INSTALLATION*CONTROL*DATA*RECORD*5.               S01194
0141 I**********                                                          S01194
0142 I*TABLE***NS       1 CD   2 C0   3 C1                                S01194
0143 I*******AND      12 C4  13 C0                                        S01194
0144 I**********                              1   1 RECI                  S01194
0145 I**********                              2   30RECT                  S01194
0146 I**********                             12  130RCDE                  S01194
0147 I**********                             18  210CSAC                  S01194
0148 I**********                             22  22 TLII                  S01194
0149 I**********                             23  23 MCRI                  S01194
0150 I**********                          P  24  250MCEP                  S01194
0151 I**********                             26  270MCLP                  S01194
0152 I**********                             28  28 FRDI                  S01194
0153 I**********                             29  29 BRCF                  S01194
0154 I**********                             30  350PSCN                  S01194
0155 I*****                                  36  380DLBR                  S01194
0156 I**********                             39  420FRPA                  S01194
0157 I**********                             43  460FRPC                  S01194
0158 I**********                             47  49 USCY                  S01194
0159 I**********                             50  52 STCY                  S01194
0160 I**********                          P  53  553MBGE                  S01194
0161 I**********                             56  56 PRID                  S01194
0162 I**********                             57  57 FFNY                  S01194
0163 I**********                             58  58 OURC                  S01194
0164 I**********                             59  59 BRNC                  S01194
0165 I**********                             60  60 LCYN                  S01194
0166 I**********                          P  90  920LCD                   S01194
0167 I**********                             93  93 CHTP                  S01194
0168 I**********                          P  94  960TNLU                  S01194
0169 I**********                                                          S01194
0170 I*****TABLE*FILE***ACCOUNT*CODES*RECORD*1.                           S01194
0171 I**********                                                          S01194
0172 I*TABLE***NS       1 CD   2 C3   3 C0                                S01194
0173 I*******AND      13 C1                                               S01194
0174 I**********                              1   1 RECI                  S01194
0175 I**********                              2   30RECT                  S01194
0176 I**********                              9  120ACOD                  S01194
0177 I**********                             13  130SREC                  S01194
0178 I**********                             14  38 ACKN                  S01194
0179 I**********                             39  39 ATYP                  S01194
0180 I**********                          P  40  420SHLC                  S01194
0181 I**********                          P  43  450SHFC                  S01194
0182 I**********                             48  48 TITO                  S01194
0183 I**********                             49  520BSDR                  S01194
0184 I**********                             53  560BSCR                  S01194
0185 I**********                             57  600PLDR                  S01194
0186 I**********                             61  640PLCR                  S01194
0187 I**********                             65  740RPCD                  S01194
0188 I**********                             75  76 ACCS                  S01194
0189 I**********                             77  77 STYP                  S01194
0190 I**********                          P  90  920LCD                   S01194
0191 I**********                             93  93 CHTP                  S01194
0192 I**********                          P  94  960TNLU                  S01194
0193 I**********                                                          S01194
0194 I*****TABLE*FILE***CURRENCIES*RECORD*1.                              S01194
0195 I**********                                                          S01194
0196 I*TABLE***NS       1 CD   2 C2   3 C0                                S01194
0197 I*******AND      13 C1                                               S01194
0198 I**********                              1   1 RECI                  S01194
0199 I**********                              2   30RECT                  S01194
0200 I**********                             10  12 CCY                   S01194
0201 I**********                             13  130SREC                  S01194
0202 I**********                             14  27 CCNM                  S01194
0203 I**********                          P  28  348SPOT                  S01194
0204 I**********                             35  37 CCYS                  S01194
0205 I**********                             38  380CDP                   S01194
0206 I**********                             39  390TNOT                  S01194
0207 I**********                             40  40 DCCY                  S01194
0208 I**********                             41  44 SRC1                  S01194
0209 I**********                             45  48 SRC2                  S01194
0210 I**********                             49  520TACC                  S01194
0211 I**********                             53  560TEQV                  S01194
0212 I**********                             57  600SWQV                  S01194
0213 I**********                             61  640TAC4                  S01194
0214 I**********                             65  680TAC5                  S01194
0215 I**********                             69  69 HIND                  S01194
0216 I**********                          P  70  768PART                  S01194
0217 I**********                             77  780SSNO                  S01194
0218 I**********                          P  79  858ERLC                  S01194
0219 I**********                          P  90  920LCD                   S01194
0220 I**********                             93  93 CHTP                  S01194
0221 I**********                          P  94  960TNLU                  S01194
0222 I**********                                                          S01194
0223 I**CATCHALL                                                          S01194
0224 I********NS  41                                                      S01194
0225 I**********                                                          S01194
0226 I* RETAIL ACCOUNT NUMBERS DETAIL RECORD
0227 I*
0228 IACNUM   NS       1 CD
     I       OR        1 CC                                               LN0036
0229 I                                        1   1 RECI
0230 I                                        2  110ACNO
0231 I**********                             12  170CNUM                                      CSD027
0231 I                                       12  17 CNUM                                      CSD027
0232 I                                       18  20 CCY
0233 I**********                             21  240ACOD                                      CGL029
0234 I**********                             25  26 ACSQ                                      CGL029
0235 I**********                             27  27 ACST                                      CGL029
0236 I**********                          P  35  370LCD                                       CGL029
0237 I**********                          P  38  400TNLU                                      CGL029
     I                                       21  300ACOD                                      CGL029
     I                                       31  32 ACSQ                                      CGL029
     I                                       33  33 ACST                                      CGL029
     I                                    P  40  420LCD                                       CGL029
     I                                    P  44  460TNLU                                      CGL029
0238 I*
0239 I* CATCHALL
0240 I        NS  41
0241 I/EJECT
0242 I* D A T A   S T R U C T U R E S
0243 I*
0244 IOSAC        DS
0245 I**********                              7  100ACOD                                      CGL029
0246 I**********                             11  12 ACSQ                                      CGL029
0247 I                                        1  10 RETNO
     I                                        7  160ACOD                                      CGL029
     I                                       17  18 ACSQ                                      CGL029
0248 I**KEY*TO*TABLES*FILE*FOR*ACCOUNT*CODES*                             S01194
0249 I**********  DS                                                      S01194
0250 I**********                              1  12 ZTABKY                S01194
0251 I**********                              1   2 CODE                  S01194
0252 I**********                              8  11 ACODE                 S01194
0253 I**********                             12  12 SUBTYP                S01194
0254 I**KEY*TO*TABLES*FILE*FOR*CURRENCIES*                                S01194
0255 I**********  DS                                                      S01194
0256 I**********                              1  12 CURKEY                S01194
0257 I**********                              1   2 TYPE                  S01194
0258 I**********                              9  11 CCY                   S01194
0259 I**********                             12  12 SRECT                 S01194
0260 I*
0261 I**      LOCAL DATA AREA FOR DATABASE ERROR REFERENCE
0262 I*
0263 ILDA        UDS                            256
0139 I***********                           134 138 DBFILE                S01117
0140 I***********                           139 167 DBKEY                 S01117
0141 I***********                           168 175 DBPGM                 S01117
0142 I***********                           176 177 DBASE                 S01117
0232 I                                      134 141 DBFILE                S01117
0233 I                                      142 170 DBKEY                 S01117
0234 I                                      171 180 DBPGM                 S01117
0235 I                                      181 1830DBASE                 S01117
0268 I*
0925 I**                                                                  S01117
0925 I**   FILE INFORMATION DATA STRUCTURE                                S01117
0925 I**                                                                  S01117
     ISPOOL       DS                                                      S01117
     I                                       83  92 SFILE                 S01117
     I                                    B 123 1240SFNUM                 S01117
     ISPOOLU      DS                                                      S01117
     I                                       83  92 SFILEU                S01117
     I                                    B 123 1240SFNUMU                S01117
     I**                                                                  S01117
     I** DATA AREA RUNDAT                                                 S01117
     I**                                                                  S01117
     IRUNDT       DS                                                      S01117
     I                                        1   7 RUNA                  S01117
     I                                    P   8  100RUND                  S01117
     I                                       11  11 SSF                   S01117
     I                                       12  12 DATF                  S01117
     I                                       13  13 MBIN                  S01117
     I**                                                                  S01117
     ISDBRCH    E DSSDBRCHPD                                              S01117
     I              A8BRNM                          BRNM                  S01194
     I**  EXTERNAL DS FOR BRANCH CODES                                    S01117
     ISDCURR    E DSSDCURRPD                                              S01194
     I**  EXTERNAL DS FOR CURRENCY CODES                                  S01194
     I              A6NBDP                          CDP                   S01194
     I              A6CYNM                          CCNM                  S01194
     I*                                                                   S01194
     ISDACOD    E DSSDACODPD                                              S01194
      **   ACCOUNT CODE                                                   S01194
     I              A5ACCN                          ACKN                  S01194
      *                                                                   S01194
     ISDBANK    E DSSDBANKPD                                              S01194
      **  EXTERNAL DS FOR BANK DETAILS                                    S01194
     I              BJURPT                          TITL                  S01194
     ISDTRAD    E DSSDTRADPD                                              S01194
      **  EXTERNAL DS FOR TRADING DETAILS                                 S01194
     I              QQACCD                          ACCDB1                                    CGL029
     I*******SDDEAL    E DSSDDEALPD                                S01194 103435
      **  EXTERNAL DS FOR DEALING DETAILS                                 S01194
     ISDGELR    E DSSDGELRPD                                              057194
      **  EXTERNAL DS FOR GENERAL LEDGER DETAILS                          057194
     I              QQACCD                          ACCDB2                                    CGL029
     IDSFDY     E DSDSFDY                                                 S01194
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01194
     I*                                                                   S01194
     IDSSDY     E DSDSSDY                                                 S01194
     I* SECOND DS FOR ACCESS PROGRAMS, LONG DATA STRUCTURE                S01194
     I*                                                                   CLE033
     ISCSARD    E DSSCSARDPD                                              CLE033
     I** Switchable Feature details                                       CLE033
     I*                                                                   CLE033
     ISDSVAL    E DSSDSVALPD                                              CLE033
      **  EXTERNAL DS FOR SYSTEM VALUES                                   CLE033
     I*                                                                   S01194
0269 I/EJECT
     C                     MOVEACPY@      BIS@   80
     C********************************************************************S01117
     C           *ENTRY    PLIST                                          S01117
     C                     PARM           SEQ     5                       S01117
0270 C* 1 S T   C Y C L E   P R O C E S S I N G  - H E A D E R  R E A D
0271 C   40                GOTO START
0272 C                     SETON                     40
     C**                                                                  S01117
     C           *NAMVAR   DEFN RUNDAT    RUNDT                           S01117
     C                     IN   RUNDT                                     S01117
     C*    DEFINE LDA                                                     S01117
     C           *NAMVAR   DEFN           LDA                             S01117
     C           *LOCK     IN   LDA                                       S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C                     SETON                     88                   S01117
     C                     END                                            S01117
0273 C*
0274 C**         FOR DATA BASE ERROR REFERENCE
0275 C*
0276 C                     MOVE 'LE0530  'DBPGM
0277 C***********          MOVE ' '       BLANKS 29                       S01194
0278 C**********           MOVE BLANKS    DBKEY                           S01194
0279 C                     Z-ADD2         RECIN   50
     C                     CALL 'AOBANKR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDBANK    PARM SDBANK    DSFDY                           S01194
     C           @RTCD     IFNE *BLANKS                                   S01194
0202 C                     MOVE 'SDBANKPD'DBFILE                          S01194
0207 C                     SETON                     U7U8LR               S01194
     C                     MOVE '01'      DBASE                           S01194
0285 C                     GOTO END                                       S01194
     C                     END                                            S01194
0637 C**   CHECK SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.                    S01194
0638 C           DATF      COMP 'M'                      98MMDDYY, 98 ON  S01194
0280 C**********           EXSR ZSYSTM                                    S01194
0281 C***99*****           SETON                     U7U8LR               S01194
0282 C***99*****           MOVE '01'      DBASE                           S01194
0283 C***99*****           MOVE 'TABLE'   DBFILE                          S01194
0284 C***99*****           MOVELZTABKY    DBKEY                           S01194
0285 C***99*****           GOTO END                                       S01194
0286 C**********           MOVE '20'      ZTABKY                          S01194
0287 C**********           EXSR TABCH1                                    S01194
     C                     CALL 'AOTRADR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDTRAD    PARM SDTRAD    DSFDY                           S01194
     C           @RTCD     IFNE *BLANKS                                   S01194
0288 C                     SETON                     LRU7U8               S01194
0289 C                     MOVE '02'      DBASE                           S01194
0290 C                     MOVE 'SDTRADPD'DBFILE                          S01194
0292 C                     GOTO END                                       S01194
     C                     END                                            S01194
0288 C***41*****           SETON                     LRU7U8               S01194
0289 C***41*****           MOVE '02'      DBASE                           S01194
0290 C***41*****           MOVE 'TABLE'   DBFILE                          S01194
0291 C***41*****           MOVE ZTABKY    DBKEY                           S01194
0292 C***41*****           GOTO END                                       S01194
0293 C**********           MOVE '40'      ZTABKY                          S01194
0294 C**********           EXSR TABCH1                                    S01194
     C**********           CALL 'AODEALR0'                         S01194 103435
     C**********           PARM '*MSG   ' @RTCD   7                S01194 103435
     C**********           PARM '*FIRST ' @OPTN   7                S01194 103435
     C********** SDDEAL    PARM SDDEAL    DSFDY                    S01194 103435
     C********** @RTCD     IFNE *BLANKS                            S01194 103435
0295 C**********           SETON                     41            S01194 103435
     C**********           END                                     S01194 103435
0295 C***41*****           SETON                     LRU7U8               103435
0296 C***41*****           MOVE '03'      DBASE                           103435
0297 C***41******          MOVE 'TABLE'   DBFILE                          S01194
0297 C***41******          MOVE 'SDDEALPD'DBFILE                   S01194 103435
0298 C***41******          MOVE ZTABKY    DBKEY                           S01194
0299 C***41******          GOTO END                                       103435
0300 C**********           MOVE '20'      TYPE                            S01194
0301 C**********           MOVE '1'       SRECT                           S01194
0302 C**********           MOVE '1'       SUBTYP                          S01194
0303 C**********           MOVE '30'      CODE                            S01194
0304 C                     MOVE ' '       BLANKK 30
     C**                                                                  057194
     C**********           CALL 'AOGELRR0'                                             057194 CGL029
     C                     CALL 'AOGELRR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       057194
     C                     PARM '*FIRST ' @OPTN   7                       057194
     C********** SDGELR    PARM SDGELR    DSFDY                                        057194 CGL029
     C           SDGELR    PARM SDGELR    DSSDY                                               CGL029
     C*                                                                   057194
     C           @RTCD     IFNE *BLANK                                    057194
     C                     MOVEL'SDGELRPD'DBFILE           ***************057194
     C                     MOVEL@OPTN     DBKEY            * DBERROR 006 *057194
     C                     Z-ADD06        DBASE            ***************057194
0295 C                     SETON                     LRU7U8               057194
0292 C                     GOTO END                                       057194
     C                     END                                            057194
      *                                                                   CLE033
      ** Check if CLE033 is ON                                            CLE033
      *                                                                   CLE033
     C                     CALL 'AOSARDR0'                                CLE033
     C                     PARM *BLANKS   @RTCD                           CLE033
     C                     PARM '*KEY   ' @OPTN                           CLE033
     C                     PARM 'CLE033'  PSARD   6                       CLE033
     C           SCSARD    PARM SCSARD    DSFDY                           CLE033
      *                                                                   CLE033
     C           @RTCD     IFEQ *BLANKS                                   CLE033
     C                     MOVE 'Y'       CLE033  1                       CLE033
      *                                                                   CLE033
      ** Retrieve Settlement 09 customer and account code system values   CLE033
      *                                                                   CLE033
     C                     CALL 'AOSVALR0'                                CLE033
     C                     PARM *BLANKS   @RTCD                           CLE033
     C                     PARM SVAL,1    P@OP01 20                       CLE033
     C                     PARM *BLANKS   P@VL01200                       CLE033
     C                     PARM SVAL,2    P@OP02 20                       CLE033
     C                     PARM *BLANKS   P@VL02200                       CLE033
     C                     PARM *BLANKS   P@OP03 20                       CLE033
     C                     PARM *BLANKS   P@VL03200                       CLE033
     C                     PARM *BLANKS   P@OP04 20                       CLE033
     C                     PARM *BLANKS   P@VL04200                       CLE033
     C                     PARM *BLANKS   P@OP05 20                       CLE033
     C                     PARM *BLANKS   P@VL05200                       CLE033
     C                     PARM *BLANKS   P@OP06 20                       CLE033
     C                     PARM *BLANKS   P@VL06200                       CLE033
     C                     PARM *BLANKS   P@OP07 20                       CLE033
     C                     PARM *BLANKS   P@VL07200                       CLE033
     C                     PARM *BLANKS   P@OP08 20                       CLE033
     C                     PARM *BLANKS   P@VL08200                       CLE033
     C                     PARM *BLANKS   P@OP09 20                       CLE033
     C                     PARM *BLANKS   P@VL09200                       CLE033
     C                     PARM *BLANKS   P@OP10 20                       CLE033
     C                     PARM *BLANKS   P@VL10200                       CLE033
     C********** SDSVAL    PARM SDSVAL    DSSDY                    CLE033 222373
      *                                                                   CLE033
     C           @RTCD     IFNE *BLANK                                    CLE033
     C                     MOVEL'SDSVALPD'DBFILE           ************   CLE033
     C                     MOVEL'CLE033 ' DBKEY            * DBERR 10 *   CLE033
     C                     MOVEL'010'     DBASE            ************   CLE033
     C                     MOVE *ON       *INU7                           CLE033
     C                     MOVE *ON       *INU8                           CLE033
     C                     MOVE *ON       *INLR                           CLE033
     C                     GOTO END                                       CLE033
     C                     ENDIF                                          CLE033
      *                                                                   CLE033
      * Settlement 09 customer                                            CLE033
     C                     MOVELP@VL01    S9CUST  6                       CLE033
      * Settlement 09 account code                                        CLE033
     C**********           MOVELP@VL02    S9ACOD  4                                    CLE033 CGL029
     C                     MOVELP@VL02    S9ACOD 10                                           CGL029
      *                                                                   CLE033
     C                     ELSE                                           CLE033
     C                     MOVE 'N'       CLE033                          CLE033
      *                                                                   CLE033
     C           @RTCD     IFNE '*NRF    '                                CLE033
     C                     MOVEL'SCSARDPD'DBFILE             *************CLE033
     C                     Z-ADD11        DBASE              * DBERR 011 *CLE033
     C                     MOVEL'CLE033'  DBKEY              *************CLE033
     C                     SETON                     U7U8LR               CLE033
     C                     GOTO END                                       CLE033
     C                     ENDIF                                          CLE033
      *                                                                   CLE033
     C                     ENDIF                                          CLE033
     C**                                                                  057194
0305 C                     GOTO END
0306 C/SPACE 3
0307 C* M A I N   P R O C E S S I N G
0308 C           START     TAG                             ** START TAG **
0309 C           SPI,1     COMP BLANKK               5757
0310 C           SPI,2     COMP BLANKK               5858
0311 C           SPI,3     COMP BLANKK               5959
0312 C* VALUE DATE CHANGE
0313 C  NL1                GOTO ENDLEV
0314 C                     Z-ADDVDAT      ZDAYNO
0315 C                     EXSR ZDATE2
0316 C* IF CHANGE OF CURRENCY
0317 C  NL2                GOTO ENDLEV
0318 C                     EXSR TABCH2
0319 C   41                MOVE MESS,1    CCNM
0320 C   41                MOVELCCY       CCNM
0321 C   41                Z-ADD0         CDP
0322 C           CDP       COMP 1                    626061
0323 C           CDP       COMP 2                    63  62
0324 C*
0325 C* IF CHANGE OF PAY/RECEIVE IND
0326 C  NL3                GOTO ENDLEV
0327 C           PYRC      COMP 'P'                  74  73
0328 C           ENDLEV    TAG                             ** ENDLEV TAG**
0329 C* IF DETAIL
0330 C  N01                GOTO END
0324 C*                                                                   S01117
     C           MBIN      IFNE 'Y'                                       S01117
     C                     SETON                     38                   S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C*                                                                   S01117
     C**                                                                  S01117
     C           *INL4     IFEQ '1'                                       S01117
     C                     CLOSELE0530P1                                  S01117
     C*                                                                   S01117
     C                     SETON                       38                 S01117
     C                     OPEN LE0530P1                                  S01117
     C                     Z-ADD0         PAGE                            S01117
     C                     Z-ADD0         PAGE1                           S01117
     C                     Z-ADDSFNUM     ZSNUM   60                      S01117
     C                     OUT  LDA                                       S01117
     C**                                                                  S01117
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           SEQ                             S01117
     C                     PARM OSBR      SENTY                           S01117
     C                     PARM           SFILE                           S01117
     C                     PARM           ZSNUM                           S01117
     C                     PARM           ZSERR   1                       S01117
     C*                                                                   S01117
     C           *LOCK     IN   LDA                                       S01117
     C           ZSERR     IFEQ 'Y'                                       S01117
     C                     SETON                     U7U8LR               S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C                     Z-ADD0         PAGE                            S01117
     C**                                                                  S01117
     C** RETRIEVE BRANCH NAME FROM SDBRCHPD                               S01117
     C**********           CALL 'AOBRCHR0'                                             S01117 CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       S01117
     C                     PARM '*KEY   ' @OPTN   7                       S01117
     C                     PARM OSBR      @DSNB   3                       S01117
     C********** SDBRCH    PARM SDBRCH    DSFDY                                        S01117 CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANK                                    S01117
     C                     SETON                     U7U8LR               S01117
     C                     MOVEL'SDBRCHPD'DBFILE           ***************S01117
     C                     MOVEL@DSNB     DBKEY            ** DB ERROR 7**S01117
     C                     MOVEL'007'     DBASE            ***************S01117
     C                     MOVE *BLANKS   BRNM                            S01117
     C                     END                                            S01117
     C   U8                GOTO END                                       S01117
     C                     END                                            S01117
     C**                                                                  S01117
     C                     ELSE                                           S01117
     C**                                                                  S01117
     C*       IF MBIN='N' AND FIRST CYCLE,                                S01117
     C*       OPEN LE0530P1                                               S01117
     C**                                                                  S01117
     C           P1OP      IFNE 'Y'                                       S01117
     C                     MOVE 'Y'       P1OP    1                       S01117
     C                     OPEN LE0530P1                                  S01117
     C                     Z-ADD0         PAGE                            S01117
     C                     Z-ADD0         PAGE1                           S01117
     C**                                                                  S01117
     C*       ENSURE REPORT SPOOL FILE RECORDED BY RCF                    S01117
     C**                                                                  S01117
     C                     Z-ADDSFNUM     ZSNUM                           S01117
     C                     OUT  LDA                                       S01117
      *                                                                   S01117
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           SEQ                             S01117
     C                     PARM OSBR      SENTY   3                       S01117
     C                     PARM           SFILE                           S01117
     C                     PARM           ZSNUM                           S01117
     C                     PARM           ZSERR   1                       S01117
      *                                                                   S01117
     C           *LOCK     IN   LDA                                       S01117
     C           ZSERR     IFEQ 'Y'                                       S01117
      ** ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM        S01117
     C                     SETON                     U7U8LR               S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C**                                                                  S01117
0331 C* IF SETTLEMENT TYPE NULL THEN USE '06'
0332 C   20                Z-ADD6         SETP
0333 C* CAPITALISATION IND.AND INTEREST PAY/RECEIVE TELEX IND.TEST
0334 C                     SETOF                     82
0335 C           INTC      COMP 'Y'                      80
0336 C           PRI3      COMP 1                        81
0337 C   80 81             SETON                     82
0338 C* IF INTC = 'Y' AND PRI3 = 1  SKIP TO ENDACI         ****
0339 C   82                GOTO ENDACI                        *
0340 C*                                                       *
0341 C* SET.SETTLEMENT TYPE INDS.                             *
0342 C                     SETOF                     525354
0343 C                     SETOF                     5556
0344 C           SETP      LOKUPTABTYP                   51-01*02,07,08,12
0345 C   51                GOTO ENDSET                        *
0346 C           SETP      COMP 03                       52   *
0347 C  N52      SETP      COMP 06                       53   *
0348 C   52                                                   *
0349 COR 53                GOTO ENDSET                        *
0350 C           SETP      COMP 05                       54   *
0351 C  N54      SETP      COMP 14                       55   *
0352 C  N54N55   SETP      COMP 04                       56   *
      *                                                                   CLE033
     C           CLE033    IFEQ 'Y'                                       CLE033
     C           SETP      COMP 09                       66               CLE033
     C                     ENDIF                                          CLE033
      *                                                                   CLE033
0353 C           ENDSET    TAG                             ** ENDSET TAG**
     C*                                                                   057590
     C** If settlement type is '05', save the customer                    057590
     C** number of the settlement account for output.                     057590
     C*                                                                   057590
     C   54                MOVELOSAC      CNUM05  6                       057590
0354 C*                                                       *
0355 C* IF SETTLE. TYPE '14'OR '05'                           *
0356 C  N54N55             GOTO ENDACI                        *
0357 C* IF SETTLE. TYPE '14' ONLY                             *
0358 C  N55                GOTO TBCHN1
     C                     MOVE '0'       *IN65                                               200797
0359 C           RETNO     CHAINACNUM                41       *
     C**                                                                  LN0036
     C**  IF SETTLEMENTS IS THROUGH A CLOSED RETAIL ACCOUNT,              LN0036
     C**  THEN SETON IND 64 TO PRINT OUT MESSAGE.                         LN0036
     C**                                                                  LN0036
     C*                                                                   057590
     C** Save customer number of the retail account for output.           057590
     C*                                                                   057590
     C**N41*55**           Z-ADDCNUM      CNUM14  60                      057590              CSD027
     C  N41 55             MOVE CNUM      CNUM14  6                       057590              CSD027
     C**                                                                  LN0036
     C                     MOVE '0'       *IN64                           LN0036
     C           *IN41     IFEQ '0'                                       LN0036
     C           *IN55     ANDEQ'1'                                       LN0036
     C           RECI      ANDEQ'C'                                       LN0036
     C                     MOVE '1'       *IN64                           LN0036
     C                     END                                            LN0036
     C*                                                                   LN0036
0360 C***41*****           SETON                     LRU7U8   *                               200797
0361 C***41*****           MOVE '04'      DBASE                                               200797
0362 C***41*****           MOVE 'ACNUM'   DBFILE                                              200797
0363 C***41*****           MOVE RETNO     DBKEY                                               200797
0364 C***41*****           GOTO END                           *                               200797
     C   41                SETON                     65                                       200797
     C   65                SETOF                     41                                       200797
     C   65                GOTO ENDACI                                                        200797
      *                                                                                       200797
0365 C           TBCHN1    TAG                             ** TBCHN1 TAG**
     C   65                GOTO ENDACI                                                        200797
      *                                                                                       200797
0366 C**********           MOVE ACOD      ACODE                           S01194
0366 C                     MOVE ACOD      ACCD                            S01194
0367 C**********           EXSR TABCH1                                    S01194
     C                     CALL 'AOACODR0'                                S01194
     C                     PARM '*MSG   ' @RTCD                           S01194
     C                     PARM '*KEY   ' @OPTN                           S01194
     C**********           PARM           ACCD    4                                    S01194 CGL029
     C********** SDACOD    PARM SDACOD    DSFDY                                        S01194 CGL029
     C                     PARM           ACCD   10                                           CGL029
     C           SDACOD    PARM SDACOD    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANKS                                   S01194
     C                     SETON                     41                   S01194
     C                     END                                            S01194
0368 C   41                SETON                     LRU7U8   *
0369 C   41                MOVE '05'      DBASE
0370 C***41*****           MOVE 'TABLE'   DBFILE                          S01194
0370 C   41                MOVE 'SDACODPD'DBFILE                          S01194
0371 C***41*****           MOVE ZTABKY    DBKEY                           S01194
0372 C   41                GOTO END
0373 C           ENDACI    TAG                                ENDACI TAG**
0374 C*                                                    ****
0375 C* SECTION TOTALS
0376 C           TOTAL     ADD  EAMT      TOTAL  150
0377 C           RECS      ADD  1         RECS    40
0378 C           RECIN     ADD  1         RECIN
0379 C           EAMT      DIV  1000      ZZAMT
0380 C***21*****           Z-SUBZZAMT     ZZAMT                                               245691
0381 C                     EXSR GLZADD
0382 C*
0383 C           END       TAG                             **  END TAG  **
0384 C/SPACE 3
     CLR                   Z-ADDSFNUMU    ZSNUMU  60                      S01117
     CLR                   OUT  LDA                                       S01117
     C*                                                                   S01117
     CLR                   CALL 'ZSFILE'                                  S01117
     CLR                   PARM           SEQ     5                       S01117
     CLR                   PARM *BLANKS   SENTY   3                       S01117
     CLR                   PARM           SFILEU                          S01117
     CLR                   PARM           ZSNUMU                          S01117
     CLR                   PARM           ZSERR                           S01117
     C*                                                                   S01117
     CLR         *LOCK     IN   LDA                                       S01117
     CLR         ZSERR     IFEQ 'Y'                                       S01117
     CLR                   SETON                     U7U8                 S01117
     CLR                   RETRN                                          S01117
     CLR                   END                                            S01117
     C**                                                                  S01117
     CLR         *IN38     IFEQ '0'                                       S01117
     CLR                   EXSR #ZZ                                       S01117
     CLR                   END                                            S01117
0385 CLR         NORE      COMP RECIN                U8U8
0386 CLRNU8      HRWN      COMP ZZTOTI               U8U8
0387 CLRNU8      HRDC      COMP ZZTOTD               U8U8
0388 C* SETON '69' IF NO DETAIL RECORDS
0389 CLR         NORE      COMP 2                        69
     CLR    U7 U8          EXSR *PSSR                                     S01117
0390 C/EJECT
0391 C* S U B R O U T I N E S
0392 C*
0393 C********************************************************************
0394 C********** TABCH1    BEGSR                           *** TABCH1 *** S01194
0395 C********** ZTABKY    CHAINTABLE                41                   S01194
0396 C**N41***** RECI      COMP 'D'                  4141                 S01194
0397 C**********           ENDSR                                          S01194
0398 C********************************************************************
0399 C/SPACE 3
0400 C********************************************************************
0401 C           TABCH2    BEGSR                           *** TABCH2 ***
0402 C********** CURKEY    CHAINTABLE                41                   S01194
     C                     CALL 'AOCURRR0'                                S01194
     C                     PARM '*BLANKS' @RTCD                           S01194
     C                     PARM '*KEY   ' @OPTN                           S01194
     C                     PARM CCY       CKEY    3                       S01194
     C           SDCURR    PARM SDCURR    DSSDY                           S01194
0403 C**N41****  RECI      COMP 'D'                  4141                 S01194
     C           @RTCD     IFNE *BLANKS                                   S01194
0234 C                     SETON                     41                   S01194
     C                     END                                            S01194
0404 C                     ENDSR
0405 C********************************************************************
0497 C/SPACE 3
0498 C********************************************************************
0499 C* SUBROUTINE TO ADD AN AMOUNT (ZZAMT) TO THE TOTAL (ZZTOTI,ZZTOTD)
0500 C*   IND '99' IS SET BY AN OVERFLOW ERROR
0501 C*
0502 CSR         GLZADD    BEGSR                           *** GLZADD ****
0503 C*
0504 CSR                   Z-ADDZZAMT     ZZAMT  153     91-DEFINE ZZAMT
0505 CSR 91                GOTO ZZAEND                     AMT = 0.BYPASS
0506 C*
0507 C* SPLIT ZZAMT INTO INTEGER AND DECIMAL FIELDS
0508 CSR                   Z-ADDZZAMT     ZZAMTI 150       INTEGER FIELD
0509 CSR                   MOVE ZZAMT     ZZAMTD  30       DECIMAL FIELD
0510 C* BOTH ZZAMTI AND ZZAMTD CONTAIN A 'SIGN' ZONE NOW
0511 C*
0512 CSR                   EXSR GLZSUM
0513 CSR         ZZAEND    ENDSR                           ** ZZAEND TAG *
0514 C*
0515 C********************************************************************
0516 C* SUBROUTINE TO CARRY OUT THE ADDITION FOR SUBROUTINES -
0517 C*                        GLZADD, GLZSUB, GLZCMP.
0518 C*          PARAMETERS PASSED -
0519 C*                     I/P ZZAMTI ZZAMTD
0520 C*                     O/P ZZTOTI ZZTOTD ZZNEGD IND 96 IND 99.
0521 C*
0522 CSR         GLZSUM    BEGSR                           *** GLZSUM ****
0523 C*
0524 CSR                   Z-ADDZZTOTI    ZZTOTI 150       DEFINE ZZTOTI
0525 CSR                   Z-ADDZZTOTD    ZZTOTD  30       DEFINE ZZTOTD
0526 CSR                   SETOF                     919293
0527 CSR                   SETOF                     949599
0528 C*
0529 C*    DETERMINE SIGN OF ZZAMTI & D,   92 IF NEG
0530 CSR         ZZAMTI    COMP 0                      9293
0531 CSR 93      ZZAMTD    COMP 0                      9293
0532 CSR 93                GOTO ZZSEND                     ZERO BYPASS
0533 C*
0534 C*    DETERMINE SIGN OF ZZTOTI & D, 91 IF NEG.
0535 CSR         ZZTOTI    COMP 0                      9193
0536 CSR 93      ZZTOTD    COMP 0                      9193
0537 C*
0538 C*    IF ZZTOTAL IS ZERO, RETURN ZZAMOUNT.
0539 CSR 93                Z-ADDZZAMTI    ZZTOTI
0540 CSR 93                Z-ADDZZAMTD    ZZTOTD
0541 CSR 93                GOTO ZZSEND                     ZERO BYPASS
0542 C*    IF SIGNS DIFFER BYPASS OVERFLOW CHECKS.
0543 CSR 91N92
0544 CORN91 92             GOTO ZZOFPS
0545 C*
0546 CSR         ZZAMTD    ADD  ZZTOTD    ZZWK2   40
0547 CSR         ZZWK2     COMP 999                  93    '93' = CARRY
0548 CSRN93      ZZWK2     COMP -999                   93    INTO INTEGER.
0549 C*
0550 CSR 93N92   ZZAMTI    ADD  1         ZZWK3  150       ADD 'CARRY' +VE
0551 CSR    93 92ZZAMTI    SUB  1         ZZWK3            SUB 'CARRY' -VE
0552 CSR 93      ZZTOTI    ADD  ZZWK3     ZZWK3
0553 CSRN93      ZZTOTI    ADD  ZZAMTI    ZZWK3
0554 C*
0555 C* IF THE MODULUS OF ZZWK3 IS LT MOD. ZZTOTI THEN O/F HAS OCCURED
0556 CSRN92      ZZWK3     COMP ZZTOTI                 99  -92 MEANS NOS.
0557 CSR 92      ZZWK3     COMP ZZTOTI               99     NEGATIVE
0558 CSRN99                Z-ADDZZWK2     ZZTOTD
0559 CSRN99                Z-ADDZZWK3     ZZTOTI
0560 C*
0561 C* IF O/F ZEROIZE ZZAMT , IND '99' SET AND ZZTOT FIELDS LEFT INTACT.
0562 CSR 99                Z-ADD0         ZZAMT  153
0563 CSR                   GOTO ZZSEND
0564 C*
0565 C* THE 'SIGNS' ARE DIFFERENT
0566 CSR         ZZOFPS    TAG                             ** ZZOFPS TAG**
0567 C* IF ZZAMT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZTOT
0568 C*
0569 CSR 92                Z-SUBZZAMTI    ZZAMTI 150
0570 CSR 92                Z-SUBZZAMTD    ZZAMTD  30
0571 C*
0572 C* IF ZZTOT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZAMT.
0573 C*
0574 CSR 91                Z-SUBZZTOTI    ZZTOTI
0575 CSR 91                Z-SUBZZTOTD    ZZTOTD
0576 C* BOTH ZZAMT AND ZZTOT ARE NOW POSITIVE.
0577 C*
0578 CSR         ZZTOTI    COMP ZZAMTI               93  95
0579 CSR 95      ZZTOTD    COMP ZZAMTD               93  95
0580 C*
0581 C* IF ZZTOT EQ. ZZAMT RETURN ZERO.
0582 CSR 95                Z-ADD0         ZZTOTI
0583 CSR 95                Z-ADD0         ZZTOTD
0584 CSR 95                GOTO ZZSEND
0585 C*
0586 C* IF ZZTOT GT. ZZAMT.
0587 CSR 93      ZZAMTD    COMP ZZTOTD               94
0588 CSR 93 94   ZZTOTI    SUB  1         ZZTOTI
0589 CSR 93 94   ZZTOTD    ADD  1000      ZZWK2
0590 CSR 93      ZZTOTI    SUB  ZZAMTI    ZZTOTI
0591 CSR 93 94   ZZWK2     SUB  ZZAMTD    ZZTOTD
0592 CSR 93N94   ZZTOTD    SUB  ZZAMTD    ZZTOTD
0593 C*
0594 C*
0595 C* IF ZZAMT GT. ZZTOT.
0596 CSRN93      ZZTOTD    COMP ZZAMTD               94
0597 CSRN93 94   ZZAMTI    SUB  1         ZZWK3  150
0598 CSRN93 94   ZZAMTD    ADD  1000      ZZWK2
0599 CSRN93 94   ZZWK3     SUB  ZZTOTI    ZZTOTI
0600 CSRN93N94   ZZAMTI    SUB  ZZTOTI    ZZTOTI
0601 CSRN93 94   ZZWK2     SUB  ZZTOTD    ZZTOTD
0602 CSRN93N94   ZZAMTD    SUB  ZZTOTD    ZZTOTD
0603 C*
0604 C* REVERSE SIGN OF ZZTOT IF LARGER I/P FIELDS WERE NEGATIVE
0605 CSR                   SETOF                     94
0606 CSR 93 91
0607 CORN93 92             SETON                     94
0608 CSR 94                Z-SUBZZTOTI    ZZTOTI
0609 CSR 94                Z-SUBZZTOTD    ZZTOTD
0610 C**
0611 C**   RESTORE SIGN OF ZZAMTI & ZZAMTD IF IT WAS REVERSED.
0612 CSR 92                Z-SUBZZAMTI    ZZAMTI
0613 CSR 92                Z-SUBZZAMTD    ZZAMTD
0614 CSR         ZZSEND    TAG                             ** ZZSEND TAG *
0615 C**
0616 C**   IF ZZTOTD IS ZERO, AND ZZTOTI IS NEG. SET UP ZZNEGD.
0617 CSR                   SETOF                     96
0618 CSR         ZZTOTD    COMP 0                        91
0619 CSR 91      ZZTOTI    COMP 0                      96
0620 CSR 96                MOVE '.000-'   ZZNEGD  5
0621 CSR                   ENDSR                             ** ENDSR **
0622 C********************************************************************
0623 C/EJECT
0624 C********************************************************************
0625 C**********                                                          S01194
0626 C*****ZSYSTM SR. TO CHAIN TO THE INSTALLATION CONTROL DATA RECORD.   S01194
0627 C**********                                                          S01194
0628 C********** ZSYSTM    BEGSR                           *** ZSYSTM *** S01194
0629 C**********                                                          S01194
0630 C*****SET UP KEY FOR INSTALLATION CONTROL RECORD.                    S01194
0631 C**********           MOVEL'01      'ZTABKY 12                       S01194
0632 C**********           MOVE '  10'    ZTABKY                          S01194
0633 C**********                                                          S01194
0634 C********** ZTABKY    CHAINTABLE                99    ON NOT THERE   S01194
0635 C**N99***** RECI      COMP 'D'                  9999  ON, IS DELETED S01194
     C**********                                                          S01194
0637 C*****CHECK SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.                    S01194
0638 C********** DATF      COMP 'M'                      98MMDDYY, 98 ON  S01194
0639 C**********                                                          S01194
0640 C**********           ENDSR                                          S01194
0641 C**********                                                          S01194
     C**********                                                          S01117
0581 C********************************************************************S01117
     C*                                                                   S01117
     C*                                                                   S01117
     C* SUBROUTINE : #ZZ                                                  S01117
     C*                                                                   S01117
     C* CALLED BY MAIN PROCESSING DURING TOTAL TIME CALCULATIONS IF       S01117
     C* THE P1 FILES HAVE NOT ALREADY BEEN OPENED (IE, IF THERE ARE       S01117
     C* NO RECORDS READ AND THEREFORE FILES OPENING NOT PERFORMED)        S01117
     C**                                                                  S01117
0454 C           #ZZ       BEGSR                           *** NODETL *** S01117
     C**                                                                  S01117
     C                     MOVE 'Y'       P1OP                            S01117
     C                     OPEN LE0530P1                                  S01117
     C                     Z-ADD*ZEROS    PAGE                            S01117
     C                     Z-ADD*ZEROS    PAGE1                           S01117
     C*                                                                   S01117
     C** ENSURE REPORT SPOOL FILE RECORDED BY RCF                         S01117
     C**                                                                  S01117
     C                     Z-ADDSFNUM     ZSNUM   60                      S01117
     C                     OUT  LDA                                       S01117
     C**                                                                  S01117
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           SEQ                             S01117
     C                     PARM *BLANKS   SENTY   3                       S01117
     C                     PARM           SFILE                           S01117
     C                     PARM           ZSNUM                           S01117
     C                     PARM           ZSERR   1                       S01117
      *                                                                   S01117
     C           *LOCK     IN   LDA                                       S01117
     C           ZSERR     IFEQ 'Y'                                       S01117
      **  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM       S01117
     C                     SETON                     U7U8LR               S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C**                                                                  S01117
     C**                                                                  S01117
      ** OUTPUT 'NO DETAILS TO REPORT' IN P1                              S01117
     C                     EXCPT                                          S01117
     C**                                                                  S01117
     C*                                                                   S01117
0466 C                     ENDSR                                          S01117
     C*                                                                   S01117
0497 C********************************************************************S01117
     C*                                                                   S01117
     C* *PSSR  --- SUBROUTINE TO HANDLE ABNORMAL ERROR CONDITIONS         S01117
     C*                                                                   S01117
     C* CALLED FROM: AFTER ABNORNAL OPERATION OCCURS                      S01117
     C*                                                                   S01117
     C* CALLS: NOTHING                                                    S01117
     C*                                                                   S01117
     C********************************************************************S01117
     C*                                                                   S01117
     C           *PSSR     BEGSR                           ** *PSSR **    S01117
     C*                                                                   S01117
     C           @RUN      IFEQ *BLANKS                                   S01117
     C                     MOVE 'Y'       @RUN    1                       S01117
     C                     DUMP                                           S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C                     ENDSR                           ** *PSSR **    S01117
     C********************************************************************S01117
     C/COPY ZSRSRC,ZDATE2Z4                                               S01392
     C********************************************************************S01392
0644 C/EJECT
     OLE0530P1H  203   OFNL2
0646 O       OR        L2
0647 O       OR        U7 LR
0648 O*****                              22 'REFERENCE LE0530'            S01117
0648 O                                   24 'REFERENCE LE0530P1'          S01117
0649 O                         TITL      89
0650 O                                  122 'DATE              PAGE'
0651 O                         RUNA     112
0652 O                         PAGE  Z  127
0653 O        H  1     OFNL2
0654 O       OR        L2
0655 O       OR        U7 LR
0656 O*****                               6 'BRANCH'                      S01117
0657 O*****                 N69BRCD      10                               S01117
0658 O***********                        59 'INTERNAL SETTLEMENTS'        S01117
0659 O***********                        70 '-  DEBITS'                   S01117
0660 O***********      73                71 '-  CREDITS'                  S01117
0658 O                                   64 'INTERNAL SETTLEMENTS'        S01117
0659 O                                   75 '-  DEBITS'                   S01117
0660 O                 73                76 '-  CREDITS'                  S01117
0658 O                 88                86 'BRANCH'                      S01117
0659 O                 88      OSBR      90                               S01117
0660 O                 88                92 '-'                           S01117
0660 O                 88      BRNM     123                               S01117
0661 O        H  2     OFNL2
0662 O       OR        L2
0663 O       OR        U7 LR
     O                       88          25 'BY SETTLEMENT BRANCH'        S01117
0664 O***********                        63 '------------------------'    S01117
0665 O***********                        70 '-------'                     S01117
0666 O***********            73          71 '-'                           S01117
0664 O                                   68 '------------------------'    S01117
0665 O                                   75 '-------'                     S01117
0666 O                       73          76 '-'                           S01117
0667 O        H  2     OFNU7NL2
0668 O       AND      N69
0669 O       OR        L2NU7N69
0670 O                                    8 'CURRENCY'
0671 O                         CCNM      23
0672 O        H  1     OFNU7NL2
0673 O       AND      N69
0674 O       OR        L2NU7N69
0675 O                                    6 'VALUE'
0676 O                                   15 'REF'
0677 O*****                              25 'CUSTOMER'                    S01117
0678 O*****                              35 'ACCOUNT'                     S01117
0677 O************                       30 ' BK. CUSTOMER'               S01117
0677 O                 88                21 ' BK.'                        S01117
0677 O                                   30 ' CUSTOMER'                   S01117
0678 O**********                         39 'ACCOUNT'                                  S01117 CGL029
     O                                   45 'ACCOUNT'                                         CGL029
0679 O        H  1     OFNU7NL2
C680 O       AND      N69
0681 O       OR        L2NU7N69
0682 O                                    5 'DATE'
     O*****                              15 'NO.'                         S01117
     O*****                              36 'NUMBER    DEBITED '          S01117
0684 O*****            73                36 'CREDITED'                    S01117
     O************                       21 'NO.         BR.'             S01117
     O                                   18 'NO.         '                S01117
     O                 88                21 'BR.'                         S01117
     O**********                         40 'NUMBER   DEBITED '                        S01117 CGL029
0684 O**********       73                40 'CREDITED'                                 S01117 CGL029
0685 O**********                         62 'ACCOUNT IDENTITY'                                CGL029
0686 O**********            N73          80 'COMMENTS'                                        CGL029
0687 O**********             73          92 'SPECIAL INSTRUCTIONS'                            CGL029
0688 O**********                        118 'AMOUNT'                                          CGL029
     O                                   46 'NUMBER         DEBITED '                         CGL029
     O                 73                46 'CREDITED'                                        CGL029
     O                                   68 'ACCOUNT IDENTITY'                                CGL029
     O                      N73          86 'COMMENTS'                                        CGL029
     O                       73          98 'SPECIAL INSTRUCTIONS'                            CGL029
     O                                  126 'AMOUNT'                                          CGL029
0689 O*
0690 O        DF11     01N82NU7
0691 O                 L1      ZADATE     7
0692 O                         FCLN      16
0693 O*****                    CNUMPH    24                               S01117
0694 O*****                    ACOD      31                               S01117
0695 O*****               52   CSAC      31                               S01117
0696 O*****               53   COMS      31                               S01117
0697 O*****               56   CADC      31                               S01117
0698 O*****               51             31 '0000'                        S01117
0699 O*****                              36 '- 01'                        S01117
0700 O*****               54   ACSQ      36                               S01117
0701 O*****               55   ACSQ      36                               S01117
0702 O*****               82             36 '         '                   S01117
     O***********              BRCD      21                               S01117
     O                 88      BRCA      21                               S01117
0693 O                         CNUMPH    29                               S01117
0693 O                    54   CNUM05    29                               057590
0693 O                    55   CNUM14    29                               057590
     O                    66   S9CUST    29                               CLE033
0694 O**********               ACOD      35                                            S01117 CGL029
0694 O**********          52   BLACCD    35                                            057194 CGL029
0694 O**********          53   BKACCD    35                                            057194 CGL029
0694 O**********          66   S9ACOD    35                                            CLE033 CGL029
0694 O**********          52             40 '01'                                       057194 CGL029
0694 O**********          53             40 '01'                                       057194 CGL029
0700 O**********          54   ACSQ      40                                            BHF071 CGL029
0701 O**********          55   ACSQ      40                                            BHF071 CGL029
0694 O**********          66             40 '01'                                       CLE033 CGL029
0703 O**********          53             58 'COMPUTER SUSPENSE'                               CGL029
0704 O**********          52             62 'COMPENSATION SUSPENSE'                           CGL029
0705 O**********          56             58 'PRIME CURRENT A/C'                               CGL029
0706 O**********          54   ACKN      66                                                   CGL029
0706 O**********          55   ACKN      66                               LN0036
0707 O**********          55N64ACKN      66                                            LN0036 CGL029
     O**********          55N65ACKN      66                                            200797 CGL029
0707 O**********          55 64          66 'ACCOUNT HAS BEEN CLOSED'     LN0036       LN0036 CGL029
     O**********          55 65          66 'ACCOUNT HAS BEEN CLOSED'                  200797 CGL029
0708 O**********          73 57SPI,1     99                                                   CGL029
     O                         ACOD      41                                                   CGL029
     O                    52   BLACCD    41                                                   CGL029
     O                    53   BKACCD    41                                                   CGL029
     O                    66   S9ACOD    41                                                   CGL029
     O                    52             46 '01'                                              CGL029
     O                    53             46 '01'                                              CGL029
     O                    54   ACSQ      46                                                   CGL029
     O                    55   ACSQ      46                                                   CGL029
     O                    66             45 '01'                                              CGL029
     O                    53             64 'COMPUTER SUSPENSE'                               CGL029
     O                    52             68 'COMPENSATION SUSPENSE'                           CGL029
     O                    56             64 'PRIME CURRENT A/C'                               CGL029
     O                    54   ACKN      72                                                   CGL029
     O                    55N64ACKN      72                                                   CGL029
     O                    55N65ACKN      72                                                   CGL029
     O                    55 64          72 'ACCOUNT HAD BEEN CLOSED'                         CGL029
     O                    55 65          72 'ACCOUNT HAD BEEN CLOSED'                         CGL029
     O                    73 57SPI,1    105                                                   CGL029
0709 O                    60   EAMT     125 ' ,   ,   ,   , 0 -'
0710 O                    61   EAMT     125 '   ,   ,   , 0 . -'
0711 O                    62   EAMT     125 '  ,   ,   , 0 .  -'
0712 O                    63   EAMT     125 ' ,   ,   , 0 .   -'
0713 O        DF 1     01N82NU7
0714 O       AND          73 58                                           S01117
0715 O**********               SPI,2     99                                                   CGL029
     O                         SPI,2    105                                                   CGL029
0716 O        DF 1     01N82NU7
0717 O       AND          73 59                                           S01117
0718 O**********               SPI,3     99                                                   CGL029
     O                         SPI,3    105                                                   CGL029
0719 O*
0720 O        DF11     01 82NU7
0721 O                 L1      ZADATE     7
0722 O                         FCLN      16
     O                         BRCA      21                               S01117
0723 O                         CNUMPH    24
0724 O                                   88 'INT. CAPITALISATION'
0725 O                 60      EAMT     125 ' ,   ,   ,   , 0 -'
0726 O                 61      EAMT     125 '   ,   ,   , 0 . -'
0727 O                 62      EAMT     125 '  ,   ,   , 0 .  -'
0728 O                 63      EAMT     125 ' ,   ,   , 0 .   -'
0729 O*
0730 O        TF11     L2N69NU7
0731 O                                   20 ' '
0732 O        TF13     L2N69NU7
0733 O                                   74 'CURRENCY TOTAL  -  NO. O'
0734 O                                   81 'F ITEMS'
0735 O                         RECS  3B  86
0736 O                                  102 'VALUE'
0737 O                 60      TOTAL  B 125 '   ,   ,   ,   , 0 -'
0738 O                 61      TOTAL  B 125 '  ,   ,   ,   , 0 . -'
0739 O                 62      TOTAL  B 125 ' ,   ,   ,   , 0 .  -'
0740 O                 63      TOTAL  B 125 '   ,   ,   , 0 .   -'
0741 O        T 32     U7 U8 LR
0742 O                                   22 '*** REFERENCE'
0743 O***********              DBPGM     31                               S01117
0743 O                         DBPGM     33                               S01117
     O                                   51 '-DATABASE ERROR   '          S01117
0744 O***********                        51 '-DATABASE ERROR AT'          S01117
0745 O***********              DBASE     54                               S01117
0746 O********T**1     U7 U8 LR                                           S01117
0747 O***********                        17 'FILE NAME'                   S01117
0748 O***********              DBFILE    23                               S01117
0749 O***********                        28 'KEY'                         S01117
0750 O***********              DBKEY     58                               S01117
     O        T 3      L4    88                                           S01117
     O                                   66 '*** END OF REPORT FOR'       S01117
     O                                   74 ' BRANCH '                    S01117
     O                         OSBR      77                               S01117
     O                                   81 ' ***'                        S01117
     O********T*3******LR***N88                                     S01117E39483
     O        T 3      LR 38N88                                           E39483
0518 O                                   76 '*** END OF REPORT ***'       S01117
0409 OLE0530P1E  2                                                        S01117
0412 O                                   24 'REFERENCE  LE0530P1'         S01117
0413 O                         TITL      89                               S01117
0414 O                                  103 'DATE'                        S01117
0415 O                         RUNA     112                               S01117
0416 O                                  122 'PAGE'                        S01117
0417 O                         PAGE  3  128                               S01117
0632 O        E 1                                                         S01117
0658 O                                   64 'INTERNAL SETTLEMENTS'        S01117
0659 O                                   75 '-  DEBITS'                   S01117
0660 O                 73                76 '-  CREDITS'                  S01117
0637 O        E 1                                                         S01117
0664 O                                   68 '------------------------'    S01117
0665 O                                   75 '-------'                     S01117
0666 O                       73          76 '-'                           S01117
     O        E 3                                                         S01117
     O                                   63 '***   NO DETAILS TO REPO'    S01117
     O                                   71 'RT   ***'                    S01117
     O        E 3      U8 U7                                              S01117
     O                                   74 '** DATABASE IN ERROR **'     S01117
     O        E 3                                                         S01117
0518 O                                   76 '*** END OF REPORT ***'       S01117
0751 O*
0752 O* C O N T R O L S
     OLE0530AUT  203   LR                                                 S01117
0753 O*****   T  203   LR                                                 S01117
0754 O*****                              22 'REFERENCE LE0530'            S01117
0754 O                                   24 'REFERENCE LE0530AU'          S01117
0755 O                         TITL      89
0756 O                                  122 'DATE              PAGE'
0757 O                         RUNA     112
0758 O*****                    PAGE  Z  127                               S01117
0758 O                         PAGE1 Z  127                               S01117
0759 O        T  1     LR
0760 O                                   67 'INTERNAL SETTLEMENTS - F'
0761 O                                   85 'ILE CONTROL REPORT'
0762 O        T  3     LR
0763 O                                   67 '------------------------'
0764 O                                   85 '------------------'
0765 O        T  1     LR
0766 O                                   29 'S/STX4 - RUN CONTROLS'
0767 O                                   59 'NUMBER'
0768 O                                   84 'VALUE'
0769 O        T  2     LR
0770 O                                   29 '----------------------'
0771 O                                   59 'OF RECORDS'
0772 O                                   84 'OF RECORDS'
0773 O        T  2     LR
0774 O                                   31 'TOTAL RECORDS - ON FILE'
0775 O                      NU7NORE  3   59
0776 O                      NU7HRWN  Z   81
0777 O**********            NU7HRDC      84                                                   245691
0777 O                      NU7HRDC  L   85                                                   245691
0778 O        T  3     LR
0779 O                                   32 'TOTAL RECORDS - CALCULAT'
0780 O                                   34 'ED'
0781 O                         RECIN 3   59
0782 O                         ZZTOTIZ   81                               S01117
0783 O**********               ZZTOTD    84                                            S01117 245691
0783 O                         ZZTOTDL   85                                                   245691
0784 O                 U8NU7            118 '***   DIFFERENCE   ***'
0732 O********T*33     LRN69NU7                                           S01117
     O        T 32     U7 U8 LR                                           S01117
     O                                   22 '*** REFERENCE'               S01117
     O                         DBPGM     33                               S01117
     O                                   53 '-DATABASE ERROR AT'          S01117
     O                         DBASE     58                               S01117
     O        T  1     U7 U8 LR                                           S01117
     O                                   17 'FILE NAME'                   S01117
     O                         DBFILE    26                               S01117
     O                                   30 'KEY'                         S01117
     O                         DBKEY     61                               S01117
0732 O        T 33     LRN38NU7                                           S01117
     O                                   63 '***   NO DETAILS TO REPO'    S01117
     O                                   71 'RT   ***'                    S01117
0785 O********T*3      LR                                                 S01117
0786 O***********                        71 '*** END OF REPORT ***'       S01117
**  MESS - CURRENCY NOT FOUND MESSAGE
XXX  NOT FOUND
**  TABTYP
0102070812
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
** CPY@   **      OBJECT COPYRIGHT
(c) Finastra International Limited 2001
**   SVAL  -  SYSTEM VALUES ARRAY                                                             CLE033
Settlement09Customer                                                                          CLE033
Settlement09AccCode                                                                           CLE033
