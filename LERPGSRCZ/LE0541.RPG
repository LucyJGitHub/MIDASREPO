     H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas LE Print customer bills and telexes')            *
      *****************************************************************
      *                                                               *
      *  Midas - Customer Lending Module                              *
      *                                                               *
      *  LE0541 -  PRINT CUSTOMER BILLS AND TELEXES                   *
      *                                                               *
      *  (c) Finastra International Limited 2001                      *
      *                                                               *
      *  Last Amend No. CSD103             Date 10Aug20               *
      *  Prev Amend No. MD051970           Date 08Oct18               *
      *                 MD040908           Date 19Feb18               *
      *                 MD046248           Date 27Oct17               *
      *                 222236             Date 30Oct03               *
      *                 CLE154             Date 07Aug12               *
      *                 CLE148             Date 23Jul12               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *                 239714A            Date 12Dec06               *
      *                 239714             Date 04Aug06               *
      *                 GOC003             Date 31Aug06               *
      *                 CRE026             Date 24May06               *
      *                 BUG13341           Date 22Feb07               *
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CSD031             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 CLE042             Date 06Sep05               *
      *                 235743             Date 26Aug05               *
      *                 CSW037A            Date 02May05               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 CLE025             Date 20Oct03               *
      *                 CGL029             Date 01Sep03               *
      *                 CLE031             Date 10Feb03               *
      *                 CLE028             Date 27Jun02               *
      * Midas Release 4.01.03 ----------------------------------------*
      *                 209690             Date 10Jan03               *
      * Midas Release 4.01 -------------------------------------------*
      *                 197682             Date 03May02               *
      *                 CLE015             Date 18Dec01               *
      *                 195992             Date 02Aug01               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 160659             Date 12May99               *
      *                 132738             Date 16JUN98               *
      *                 CEU020             Date 13Mar98               *
     F*                 CEU004             Date 02Feb98               *
     F*                 103889             Date 25Mar98               *
     F*                 122263             Date 27Aug97               *
      *                 CLE004 *CREATE     Date 02Dec96               *
      *                                                               *
      *---------------------------------------------------------------*
      *                                                               *
      *  CSD103 - Libor Deregulation - Common Layer/Standing Data     *
      *  MD051970 - Missing settlement amount on Customer Bills       *
      *             and Customer Confirmation                         *
      *  MD040908 - Loan Advice showing incorrect loan reference      *
      *             number due to incorrect location of the           *
      *             initialization of LNFRP field when VDAT and LIPD  *
      *             is compared.                                      *
      *  MD046248 - Finastra Rebranding                               *
      *  222236 - Do not convert if currencies same.                  *
      *  CLE154 - Loan Repayment Schedule Enhancement (Recompile)     *
      *  CLE148 - Alpha Loan Reference                                *
      *  239714A - Put one space in between TOTAL DUE and             *
      *            'THIS IS AN AMENDMENT...'.                         *
      *  239714 - Prevent printing of 'THIS IS AN AMENDMENT...' twice.*
      *  GOC003 - Reports on Pre-printed Form. Added                  *
      *           core hooks LE0541C001, LE0541F001, LE0541F002,      *
      *           LE0541O011, LE0541O012.                             *
      *  CRE026 - Consumer Banking                                    *
      *  BUG13341 - Missing details when no movements/payments.       *
      *             Suppressed printing of such data.                 *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CLE042 - Extended Loan Sub Type (Recompile)                  *
      *  235743 - LE UDC multiple print of the same statement.        *
      *           Patterned after fix 225103.                         *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  CLE025 - Credit Lines (Recompile)                            *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  CLE031 - Lending Enhancements.                               *
      *  CLE028 - Flat Rate Personal Loans (Rule of 78s)              *
      *  209690 - LE0541P1 was split into several pages without any   *
      *           page headings.  Reverse 132738.                     *
      *  197682 - MSGW on LEC07 LEC0703 "Cursor not set to address    *
      *           data space entry" because no records in SCUTXL1. If *
      *           *IN89 is set on during SETLL, do not perform READE. *
      *  CLE015 - Functionality moved from Syndicated Lending to      *
      *           Customer Lending                                    *
      *  195992 - MSGW on LEC07 LEC0703 due to cursor not set.        *
      *           Initialised field WLNRF to correct value.           *
      *  160659 - Output settlement currency details for loans and    *
      *           facility fee advices.                               *
     F*  132738 - Customer name, address & principal/interest total   *
     F*           due not being printed on LE0540P2 confo.            *
     F*           Cause of error is in LE0400.  Applied fix 132050    *
     F*           here as a preventative fix.                         *
      *  CEU020 - EMU Lending Multi-currency Rollover                 *
      *  CEU004 - LE Settlement Ccy conversion Upgrade to DBA R2.0    *
      *  103889 - Spoolfile number for ZSFILE not updated after the   *
      *           reopening of the P8 printer file. This resulted in  *
      *           a duplicate record being written to FCSFNOPD.       *
      *  122263 - File controls not possible because of select/omit   *
      *           in input primary lf.                                *
      *  CLE004 - Customer Lending Enhancements - Syndications.       *
      *                                                               *
      *****************************************************************
     F***SCUTXL0*IP  F     138 28AI     3 DISK                                                CLE031
     F***SCUTXL0 IP  F     146 28AI     3 DISK                                       CLE031 MD051970
     FSCUTXL0 IP  F     153 28AI     3 DISK                                                 MD051970
     FSCUTXL1 IF  E           K        DISK
     FLEHISTHPIF  E           K        DISK                                                   235743
      *
     FLE0541P8O   F     132            PRINTER      KINFDS SPOOL8     UC
     FLE0541P7O   F      70            PRINTER      KINFDS SPOOL7     UC
     FLE0541P6O   F      70            PRINTER      KINFDS SPOOL6     UC
     FLE0541P5O   F      70            PRINTER      KINFDS SPOOL5     UC
     FLE0541P4O   F      90            PRINTER      KINFDS SPOOL4     UC
     FLE0541P3O   F      90            PRINTER      KINFDS SPOOL3     UC
     F/COPY WNCPYSRC,LE0541F001                                                               GOC003
     FLE0541P2O   F      90            PRINTER      KINFDS SPOOL2     UC
     F/COPY WNCPYSRC,LE0541F002                                                               GOC003
     FLE0541P1O   F      90            PRINTER      KINFDS SPOOL1     UC
      *
     FLEBTX1  O   F      73            DISK                      A    U2
     FLEBTX2  O   F      73            DISK                      A    U2
     FLEBTX3  O   F      73            DISK                      A    U2
     FLEBTX4  O   F      73            DISK                      A    U2
      *                                                                  *
      /SPACE 3
      *****************************************************************
      *                                                               *
      *    F U N C T I O N   O F   I N D I C A T O R S                *
      *                                                               *
      *    01         SCUTX - COMMITMENT FEE RECORD                   *
      *    02               - INTEREST HEADER                         *
      *    03               - RATE CHANGE                             *
      *    04               - PAYMENT                                 *
      *    05               - AMENDMENT RECORD                        *
      *    06               - TRAILER                                 *
      *    20         WITHHOLDING TAX AMOUNT ZERO                     *
      *    25         REPAYMENT TYPE 2                                *
      *    26         25 ON AND PRINCIPAL REPAYMENT AMT.= 0           *
      *    27         Converted PRAM amount.                          *   CEU004
      *    28         Converted MAMT amount.                          *   CEU004
      *    30         PRINT BRANCH NAME                               *
      *    31         RATE CHANGE MOVEMENT                            *
      *    32         NO COMMITMENT FEE BILL REQUIRED                 *
      *    34         USED IN CHECK SR.                               *
      *    35         MULTIPLE USE                                    *
      *    36         VALUE DATE LESS THAN LAST INTEREST PAYMENT DATE *
      *    37         VALUE DATE EQUAL TO LAST INTEREST PAYMENT DATE  *
      *    38         HEADINGS ALREADY PRODUCED FOR B/T.              *
      *    39         REPAYMENT TYPE 2 (EXCEPT 'IN' PAYMENT)          *
      *    40         FIRST CYCLE                                     *
      *    41         EXCEPTION OUTPUT - C/FEE BILL                   *
      *    42                          - C/FEE TELEX                  *
      *    43                          - INT. PAYMENT HEADINGS BILL   *
      *    44                          - INT. PAYMENT HEADINGS TELEX  *
      *    45         INTEREST IS CAPITALISED                         *
      *    46         EXCEPTION OUTPUT - MOVEMENT DETAILS BILL        *
      *    47                          - MOVEMENT DETAILS TELEX       *
      *    48                          - PRINCIPAL ONLY BILL          *
      *    49                          - PRINCIPAL ONLY TELEX         *
      *    50                          - PAYMENT DETAILS BILL         *
      *    51                          - PAYMENT DETAILS TELEX        *
      *    53         NEW PAGE ON REPORTS LE0541,LE0543               *
      *    54         EXCEPTION OUTPUT - CARRIED FORWARD BILL         *
      *    55                          - CARRIED FORWARD LINE TELEX   *
      *    56         WITHHOLDING TAX NET                             *
      *    57                         GROSS                           *
      *    58                         RECEIVABLE                      *
      *    59         RATE CHANGE NEGATIVE                            *
      *    60-63      CURRENCY DPS 0-3                                *
      *    64         EDIT RATES                                      *
      *    65         SUPPRESS AMOUNTS FOR STOP/START ACCRUALS        *
      *    66         EXCEPTION OUTPUT - AMENDMENT TELEX              *
      *    67                          - AMENDMENT BILL               *
      *    70         NEW PAGE ON REPORT LE0542                       *
      *    73         OUTPUT BROUGHT FORWARD NARRATIVE                *
      *    74-76      OUTPUT NARRATIVE                                *
      *    77         RECORD IS A SECOND PAYMENT                      *
      *    78         Converted INTA amount.                          *   160659
      *    80         SOME DETAILS PRINTED                            *
      *    81         EXCEPTION O/P LOAN FEE BILL                     *
      *    82         EXCEPTION O/P LOAN FEE TELEX                    *
      *    83-86      Currency dps 0-3 for SCCY                       *   160659
      *    88         MBIN = Y                                        *
      *    90-99      STANDARD SUBROUTINES                            *
      *    U7,U8      STANDARD MIDAS USAGE                            *
      *    L1         CHANGE OF BRANCH                                *
      *****************************************************************
      /COPY ZSRSRC,ZDATE2Z1
     E                    NAR     1  16 63               NARRATIVE LINES
     E                    CPY@    1   1 80
     E                    POWER   1   7  7 3             POWER ARRAY                          CLE031
     E/COPY WNCPYSRC,LEH00870
      *
      *    CUSTOMER BILLS AND TELEXES FILE - COMMITMENT FEE DETAILS
      *
     ICUTX1HQF
      ** Rename fields for CUTX1HQ
     I              ACUP                            ACUPX
      *
     ISCUTXL0 NS  01   1 CD   2 CF
     I                                        1   1 RECI
     I                                        2   2 RCDT
     I                                        3   5 BRCA  L1
     I**********                              6  110CNUM                                      CSD027
     I                                        6  11 CNUM                                      CSD027
     I**********                             12  170LNRF                                      CLE148
     I                                       12  17 LNRF                                      CLE148
     I                                       18  220VDAT
     I                                       23  240PRSQ
     I                                       25  270LASN
     I**********                             28  330FCUS                                      CSD027
     I                                       28  33 FCUS                                      CSD027
     I                                       34  360FTYP
     I                                       37  380FSEQ
     I                                       39  400PTYP
     I                                       41  43 CCY
     I                                       44  45 AMTP
     I                                    P  46  520PRAM
     I                                    P  53  590INTA
     I                                    P  60  660WTXA
     I                                    P  67  730FEAM
     I                                       74  750FECD
     I                                       76  76 WOIN
     I                                    P  77  790EXVD
     I                                    P  80  820DAYS
     I                                    P  83  892ACUP
     I                                       97  97 NACD
     I                                      100 100 BTIN
      ** Settlement Currency field                                        160659
      *                                                                   160659
     I                                      101 103 SCCY                  160659
     I                                    P 104 1108SEXR                                      CLE031
     I                                      111 111 SEXI                                      CLE031
      *
      *    CUSTOMER BILLS AND TELEXES FILE - INTEREST HEADER
      *
     I        NS  02   1 CD   2 CH
     I                                        1   1 RECI
     I                                        2   2 RCDT
     I                                        3   5 BRCA  L1
     I**********                              6  110CNUM                                      CSD027
     I                                        6  11 CNUM                                      CSD027
     I**********                             12  170LNRF                                      CLE148
     I                                       12  17 LNRF                                      CLE148
     I                                       18  220VDAT
     I                                       23  240PRSQ
     I                                       25  270LASN
     I**********                             28  330FCUS                                      CSD027
     I                                       28  33 FCUS                                      CSD027
     I                                       34  360FTYP
     I                                       37  380FSEQ
     I                                       39  400PTYP
     I                                       41  43 CCY
     I                                       44  45 AMTP
     I                                    P  46  520PRAM
     I                                    P  53  587BRTEL
     I                                    P  59  647RTSPL
     I                                       65  650CALC
     I                                       66  66 SPINL
     I                                    P  67  730INTA
     I                                    P  74  760STPG
     I                                       77  77 NACD
     I                                       78  78 INTC
     I                                    P  79  850TIPD
     I                                    P  86  910WTRT
     I                                    P  92  940LIPD
     I                                       95  95 WTIN
     I                                      100 100 BTIN
     I                                    P 101 1070CPAM
     I                                    P 108 1140AITC
     I                                    P 115 1207INTR
     I                                    P 121 1270AIAP
     I                                    P 128 1340IPRD
     I                                      135 135 ADIF                                      CLE028
      *
      **   CUSTOMER BILLS AND TELEXES FILE -  DETAIL RATES
      *
     I        NS  03   1 CD   2 CE
     I                                        1   1 RECI
     I                                        2   2 RCDT
     I                                        3   5 BRCA  L1
     I**********                              6  110CNUM                                      CSD027
     I                                        6  11 CNUM                                      CSD027
     I**********                             12  170LNRF                                      CLE148
     I                                       12  17 LNRF                                      CLE148
     I                                       18  220VDAT
     I                                       23  240PRSQ
     I                                       25  270LASN
     I**********                             28  330FCUS                                      CSD027
     I                                       28  33 FCUS                                      CSD027
     I                                       34  360FTYP
     I                                       37  380FSEQ
     I                                       39  400PTYP
     I                                       41  43 CCY
     I                                       44  45 AMTP
     I**********                             46  470BRTT                                      CSD103
     I                                       46  47 BRTT                                      CSD103
     I                                    P  48  537BRTE
     I                                    P  54  597RTSP
     I                                       60  60 SPIN
     I                                       61  610CALC
     I                                       62  62 STAI
     I                                    P  80  820DAYS
     I                                    P  83  892ACUP
     I                                      100 100 BTIN
     I                                    P 101 1070CPAM
     I                                    P 108 1140AITC
     I                                    P 115 1207INTR
     I                                    P 121 1270AIAP
     I                                    P 128 1340IPRD
     I                                      135 135 BVMV
     I                                      136 138 RLCY
      *
      **   CUSTOMER BILLS AND TELEXES FILE - AMOUNT DETAIL
      *
     I        NS  04   1 CD   2 CD  90NCA
     I       OR   05   1 CD   2 CD  90 CA
     I                                        1   1 RECI
     I                                        2   2 RCDT
     I                                        3   5 BRCA  L1
     I**********                              6  110CNUM                                      CSD027
     I                                        6  11 CNUM                                      CSD027
     I**********                             12  170LNRF                                      CLE148
     I                                       12  17 LNRF                                      CLE148
     I                                       18  220VDAT
     I                                       23  240PRSQ
     I                                       25  270LASN
     I**********                             28  330FCUS                                      CSD027
     I                                       28  33 FCUS                                      CSD027
     I                                       34  360FTYP
     I                                       37  380FSEQ
     I                                       39  400PTYP
     I                                       41  43 CCY
     I                                       44  45 AMTP
     I                                    P  46  520PRAM
     I                                    P  53  590INTA
     I                                    P  60  660WTXA            20
     I                                    P  67  730FEAM
     I                                       74  750FECD
     I                                       76  76 WOIN
     I                                    P  77  790EXVD
     I                                    P  80  820DAYS
     I                                    P  83  892ACUP
     I                                       90  90 ACBI
     I                                       91  91 ##UDC
     I                                       91  96 ZZ006
     I                                       98  980REPT
     I                                       99  99 BTRQ
     I                                      100 100 BTIN
     I                                    P 101 1070CPAM
     I                                    P 108 1140AITC
     I                                    P 115 1207INTR
     I                                    P 121 1270AIAP
     I                                    P 128 1340IPRD
     I                                      135 135 BVMV
     I                                      136 138 SCCY                  CEU004
     I**********                          P 139 1458SEXR                             CLE031 MD051970
     I**********                            146 146 SEXI                             CLE031 MD051970
     I                                    P 139 1450CHDU                                    MD051970
     I                                    P 146 1528SEXR                                    MD051970
     I                                      153 153 SEXI                                    MD051970
      *
      **   CUSTOMER BILLS AND TELEXES FILE -  LOAN FEE DETAILS
      *
     I        NS  07   1 CD   2 CB
     I                                        1   1 RECI
     I                                        2   2 RCDT
     I                                        3   5 BRCA  L1
     I**********                              6  110CNUM                                      CSD027
     I                                        6  11 CNUM                                      CSD027
     I**********                             12  170LNRF                                      CLE148
     I                                       12  17 LNRF                                      CLE148
     I                                       18  220VDAT
     I                                       23  240PRSQ
     I                                       25  270LASN
     I**********                             28  330FCUS                                      CSD027
     I                                       28  33 FCUS                                      CSD027
     I                                       34  360FTYP
     I                                       37  380FSEQ
     I                                       39  400PTYP
     I                                       41  43 CCY
     I                                       44  45 AMTP
     I                                    P  46  520PRAM
     I                                    P  53  590INTA
     I                                    P  60  660WTXA
     I                                    P  67  730FEAM
     I                                       74  750FECD
     I                                       76  76 WOIN
     I                                    P  77  790EXVD
     I                                    P  80  820DAYS
     I                                    P  83  892ACUP
     I                                       97  97 NACD
     I                                      100 100 BTIN
     I                                    P 101 1070CPAM
     I                                    P 108 1140AITC
     I                                    P 115 1207INTR
     I                                    P 121 1270AIAP
     I                                    P 128 1340IPRD
     I                                      135 135 BVMV
      ** Settlement Currency field                                        160659
      *                                                                   160659
     I                                      136 138 SCCY                  160659
      *
      **   CUSTOMER BILLS AND TELEXES FILE - TRAILER
      *
     I        NS  06   1 CT
     I                                        1   1 RECI
     I                                    P   2   40NORE
     I        NS
     I************                                                                     132738 209690
     I***Look*ahead*field*for*loan*no.*                                                132738 209690
     I************                                                                     132738 209690
     I********NS  **                                                                   132738 209690
     I***********                            12  170NLNRF                              132738 209690
      *
      **   LOCAL DATA AREA FOR DATABASE ERROR IDENTIFICATION
     ILDA        UDS                            256
     I                                      134 141 DBFILE
     I                                      142 170 DBKEY
     I                                      171 180 DBPGM
     I                                      181 1830DBASE
      *
      **   SPOOL FILE INFORMATION DATA STRUCTURE
      *
     I            DS
     I                                        1  42 SPLFA
     I                                        1   8 SFILP
     I                                        9  18 JBNMP
     I                                       19  28 USERP
     I                                       29  340JBNOP
     I                                       35  390SPLNO
     I                                       40  42 BRCHP
      *
      **   FILE INFORMATION DATA STRUCTURE
      *
     ISPOOL1      DS
     I                                       83  92 SFILE1
     I                                    B 123 1240SFNUM1
     ISPOOL2      DS
     I                                       83  92 SFILE2
     I                                    B 123 1240SFNUM2
     ISPOOL3      DS
     I                                       83  92 SFILE3
     I                                    B 123 1240SFNUM3
     ISPOOL4      DS
     I                                       83  92 SFILE4
     I                                    B 123 1240SFNUM4
     ISPOOL5      DS
     I                                       83  92 SFILE5
     I                                    B 123 1240SFNUM5
     ISPOOL6      DS
     I                                       83  92 SFILE6
     I                                    B 123 1240SFNUM6
     ISPOOL7      DS
     I                                       83  92 SFILE7
     I                                    B 123 1240SFNUM7
     ISPOOL8      DS
     I                                       83  92 SFILE8
     I                                    B 123 1240SFNUM8
      *
      ** DATA AREA RUNDAT
      *
     IRUNDT       DS
     I                                        1   7 RUNA
     I                                    P   8  100RUND
     I                                       11  11 SSF
     I                                       12  12 DATF
     I                                       13  13 MBIN
      *
     ISDALTN    E DSSDALTNPD
      **  EXTERNAL DS FOR ALTERNATIVE NAMES AND ADDRESSES
     I              BCCNA1                          CNA1
     I              BCCNA2                          CNA2
     I              BCCNA3                          CNA3
     I              BCCNA4                          CNA4
      *
     ISDBANK    E DSSDBANKPD
      **  EXTERNAL DS FOR BANK DETAILS
     I              BJURPT                          TITL
      *
     ISDBRCH    E DSSDBRCHPD
     I              A8BRNM                          BRNM
      **  EXTERNAL DS FOR BRANCH CODES
      *
     ISDCURR    E DSSDCURRPD
      **  EXTERNAL DS FOR CURRENCY DETAILS
     I              A6NBDP                          CDP
     I              A6CYNM                          CCNM
      *
     ISDCUST    E DSSDCUSTPD
      **  EXTERNAL DS FOR CUSTOMER DETAILS
     I              BBCRNM                          CRNM
     I              BBCRTN                          CTWN
     I              BBTXA1                          TELX
     I              QQDFAC                          #DFAC1                                    CGL029
      *
     ISDTRAD    E DSSDTRADPD
      **  EXTERNAL DS FOR TRADING DETAILS
     I              BLBNOC                          BRNC
      *
     ISCSARD    E DSSCSARDPD
      ** SAR details
      *
     ISDGELR    E DSSDGELRPD                                                                  CLE031
      ** External data structures for General Ledger Details                                  CLE031
     I              QQACCD                          QQACDG                                    CGL029
      *                                                                                       CLE031
     IDSFDY     E DSDSFDY
      * FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE
      *
     IDSSDY     E DSDSSDY
      * SECOND DS FOR ACCESS PROGRAMS, LONG DATA STRUCTURE
      *
      /EJECT
     C                     MOVEACPY@      BIS@   80
     C/COPY WNCPYSRC,LEH00871
      *
      **   FIRST CYCLE
      *
     C   40                GOTO ENDFC
     C                     SETON                     40
      *
     C           *NAMVAR   DEFN RUNDAT    RUNDT
     C                     IN   RUNDT
      *    DEFINE LDA
     C           *NAMVAR   DEFN           LDA
     C           *LOCK     IN   LDA
     C           MBIN      IFEQ 'Y'
     C                     SETON                     88
     C                     END
      *
     C                     EXSR ZSYSTM
     C   99                GOTO END
      *
      **   ACCESS ICD-5 FOR BRANCH NAME IND.
      *
      ** ACCESS TRADING DATA
      *
     C                     CALL 'AOTRADR0'
     C                     PARM '*MSG   ' @RTCD   7
     C                     PARM '*FIRST ' @OPTN   7
     C           SDTRAD    PARM SDTRAD    DSFDY
     C           @RTCD     IFNE *BLANK
     C                     SETON                     99
     C                     MOVEL'SDTRADPD'DBFILE
     C                     MOVEL@OPTN     DBKEY
     C                     END
     C   99                SETON                     U7U8LR
     C   99                Z-ADD7         DBASE            DBASE 7
     C   99                GOTO END
      *
     C           BRNC      COMP 'Y'                      30
      *
     C                     Z-ADD1         COUNT   50
     C                     MOVE ' '       CLIKEY  6
     C                     MOVE ' '       BLNK10 10
     C                     MOVE ' '       BLANKS 30
     C                     Z-ADD0         NOBL1   50
     C                     Z-ADD0         NOBL2   50
     C                     Z-ADD0         NOBL3   50
     C                     Z-ADD0         NOBL4   50
     C                     Z-ADD0         NOTL1   50
     C                     Z-ADD0         NOTL2   50
     C                     Z-ADD0         NOTL3   50
     C                     Z-ADD0         NOTL4   50
     C                     GOTO END
     C           ENDFC     TAG                             ** ENDFC TAG **
      *
      **   MAIN PROCESSING
      *
      **   ACCESS BRANCH CODES RECORD FOR NAME
      *
     C  NL1
     CORN30                GOTO NOBR
      *
     C**********           CALL 'AOBRCHR0'                                                    CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7
     C                     PARM '*KEY   ' @OPTN   7
     C                     PARM BRCA      @DSNB   3
     C********** SDBRCH    PARM SDBRCH    DSFDY                                               CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANK
     C                     SETON                     U7U8LR
     C                     MOVEL'SDBRCHPD'DBFILE           ***************
     C                     MOVEL@DSNB     DBKEY            * DBERROR 008 *
     C                     MOVEL'008'     DBASE            ***************
     C                     GOTO END
     C                     END
      *
     C           NOBR      TAG                             ** NOBR TAG ***
      *
     C           *INL1     IFEQ '1'
      *
     C                     CLOSELE0541P1
     C                     CLOSELE0541P2
     C                     CLOSELE0541P3
     C                     CLOSELE0541P4
     C                     CLOSELE0541P5
     C                     CLOSELE0541P6
     C                     CLOSELE0541P7
     C                     CLOSELE0541P8
      *
     C                     Z-ADD0         NOTL4
     C                     Z-ADD0         NOTL3
     C                     Z-ADD0         NOTL2
     C                     Z-ADD0         NOTL1
     C                     Z-ADD0         NOBL4
     C                     Z-ADD0         NOBL3
     C                     Z-ADD0         NOBL2
     C                     Z-ADD0         NOBL1
      *
     C                     SETON                     80
      *
      **   SPOOL P1 RECORDED BY RCF
     C                     OPEN LE0541P1
     C                     Z-ADDSFNUM1    ZSNUM1
     C                     OUT  LDA
     C                     CALL 'ZSFILE'
     C                     PARM           SEQ
     C                     PARM BRCA      SENTY
     C                     PARM           SFILE1
     C                     PARM           ZSNUM1  60
     C                     PARM           ZSERR   1
      *
     C           *LOCK     IN   LDA
     C           ZSERR     IFEQ 'Y'
      ** ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM
     C                     SETON                     U7U8LR
     C                     RETRN
     C                     END
      **
      **   SPOOL P2 RECORDED BY RCF
     C                     OPEN LE0541P2
     C                     Z-ADDSFNUM2    ZSNUM2
     C                     OUT  LDA
     C                     CALL 'ZSFILE'
     C                     PARM           SEQ
     C                     PARM BRCA      SENTY
     C                     PARM           SFILE2
     C                     PARM           ZSNUM2  60
     C                     PARM           ZSERR   1
      *
     C           *LOCK     IN   LDA
     C           ZSERR     IFEQ 'Y'
      ** ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM
     C                     SETON                     U7U8LR
     C                     RETRN
     C                     END
      **
      **   SPOOL P3 RECORDED BY RCF
     C                     OPEN LE0541P3
     C                     Z-ADDSFNUM3    ZSNUM3
     C                     OUT  LDA
     C                     CALL 'ZSFILE'
     C                     PARM           SEQ
     C                     PARM BRCA      SENTY
     C                     PARM           SFILE3
     C                     PARM           ZSNUM3  60
     C                     PARM           ZSERR   1
      *
     C           *LOCK     IN   LDA
     C           ZSERR     IFEQ 'Y'
      ** ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM
     C                     SETON                     U7U8LR
     C                     RETRN
     C                     END
      **
      **   SPOOL P4 RECORDED BY RCF
     C                     OPEN LE0541P4
     C                     Z-ADDSFNUM4    ZSNUM4
     C                     OUT  LDA
     C                     CALL 'ZSFILE'
     C                     PARM           SEQ
     C                     PARM BRCA      SENTY
     C                     PARM           SFILE4
     C                     PARM           ZSNUM4  60
     C                     PARM           ZSERR   1
      *
     C           *LOCK     IN   LDA
     C           ZSERR     IFEQ 'Y'
      ** ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM
     C                     SETON                     U7U8LR
     C                     RETRN
     C                     END
      **
      **   SPOOL P5 RECORDED BY RCF
     C                     OPEN LE0541P5
     C                     Z-ADDSFNUM5    ZSNUM5
     C                     OUT  LDA
     C                     CALL 'ZSFILE'
     C                     PARM           SEQ
     C                     PARM BRCA      SENTY
     C                     PARM           SFILE5
     C                     PARM           ZSNUM5  60
     C                     PARM           ZSERR   1
      *
     C           *LOCK     IN   LDA
     C           ZSERR     IFEQ 'Y'
      ** ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM
     C                     SETON                     U7U8LR
     C                     RETRN
     C                     END
      **
      **   SPOOL P6 RECORDED BY RCF
     C                     OPEN LE0541P6
     C                     Z-ADDSFNUM6    ZSNUM6
     C                     OUT  LDA
     C                     CALL 'ZSFILE'
     C                     PARM           SEQ
     C                     PARM BRCA      SENTY
     C                     PARM           SFILE6
     C                     PARM           ZSNUM6  60
     C                     PARM           ZSERR   1
      *
     C           *LOCK     IN   LDA
     C           ZSERR     IFEQ 'Y'
      ** ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM
     C                     SETON                     U7U8LR
     C                     RETRN
     C                     END
      **
      **   SPOOL P7 RECORDED BY RCF
     C                     OPEN LE0541P7
     C                     Z-ADDSFNUM7    ZSNUM7
     C                     OUT  LDA
     C                     CALL 'ZSFILE'
     C                     PARM           SEQ
     C                     PARM BRCA      SENTY
     C                     PARM           SFILE7
     C                     PARM           ZSNUM7  60
     C                     PARM           ZSERR   1
      *
     C           *LOCK     IN   LDA
     C           ZSERR     IFEQ 'Y'
      ** ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM
     C                     SETON                     U7U8LR
     C                     RETRN
     C                     END
      **
      **   SPOOL P8 RECORDED BY RCF
     C                     OPEN LE0541P8
     C                     Z-ADDSFNUM8    ZSNUM8
     C                     OUT  LDA
     C                     CALL 'ZSFILE'
     C                     PARM           SEQ
     C                     PARM BRCA      SENTY
     C                     PARM           SFILE8
     C                     PARM           ZSNUM8  60
     C                     PARM           ZSERR   1
      *
     C           *LOCK     IN   LDA
     C           ZSERR     IFEQ 'Y'
      ** ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM
     C                     SETON                     U7U8LR
     C                     RETRN
     C                     END
      *
     C                     Z-ADD0         PAGE1
     C                     Z-ADD0         PAGE2
     C                     Z-ADD0         PAGE3
     C                     Z-ADD0         PAGE7
      *
      *
     C                     END
      *
     C   L1                Z-ADD3         TELX1   10
     C   L1                Z-ADD3         TELX3   10
     C   L1                Z-ADD3         TELX4   10
     C           COUNT     ADD  1         COUNT
      *
      ** Ignore records with Bill/Telex Ind equal to 'N' or blank,
      ** or ZZ006 is 'Y'.
     C           BTIN      COMP 'N'                      35
     C           BTIN      IFEQ *BLANK
     C           *IN04     OREQ *ON
     C           ##UDC     ANDEQ'Y'
     C                     MOVE *ON       *IN35
     C                     ENDIF
     C   35                GOTO END
      *
      ** Chain to the Customers File for Customer Name/Address if
      ** SCUTX record is Commitment Fee details, Interest Header,
      ** Details Rates, Amount Details, or Loan Fee details.
      *
     C           *IN03     IFEQ '1'
     C           *IN01     OREQ '1'
     C           *IN02     OREQ '1'
     C           *IN04     OREQ '1'
     C           *IN05     OREQ '1'
     C           *IN07     OREQ '1'
     C                     MOVELCNUM      CLIKEY
     C                     EXSR CLICHN
      *
     C   99                MOVELCLIKEY    DBKEY
     C   99                MOVEL'SDCUSTPD'DBFILE
     C   99                Z-ADD9         DBASE            DBASE 9
     C   99                SETON                     U7U8LR
     C   99                GOTO END
     C                     END
      *
      *    CALCULATE VALUE DATE FOR OUTPUT TO TELEX FILE
     C                     Z-ADDVDAT      ZDAYNO
     C                     EXSR ZDATE2
      *    FORMAT DATES INTO YYMMDD FORMAT FOR OUTPUT TO TELEX FILE
     C                     MOVE ZYEAR     ZWRK4
     C                     MOVELZMTH      ZWRK4
     C                     MOVE ZWRK4     TXDATE  60
     C                     MOVELZDAY      TXDATE
      **   CALL SUBROUTINE ACCORDING TO INPUT
      *
     C   01                EXSR COMFEE
     C   02                EXSR INTHED
     C   03                EXSR MOVE
     C   04                EXSR QCHECK
     C   05                EXSR AMEND
     C   07                EXSR LNFEE
      *
     C           END       TAG                             ** END TAG ****
      *
      **   TRAILER PROCESSING
      *
     C   06      TOTREC    ADD  NORE      TOTREC  50
      *
      **   LAST RECORD PROCESSING
     C/COPY WNCPYSRC,LEH00872
      *
      **   IF RECORDS HAVE BEEN PROCESSED OR AN ERROR HAS OCCURRED
      **   OUTPUT FILE CONTROLS/DB ERROR REPORT
      *
     CLR         BRCA      IFNE *BLANKS
     CLR         *INU7     OREQ *ON
     CLR         *INU8     OREQ *ON
     CLR                   SETON                     59
     CLR                   Z-ADDSFNUM8    ZSNUM8
     CLR                   OUT  LDA
     CLR                   CLOSELE0541P8
     CLR                   OPEN LE0541P8
     CLR                   Z-ADDSFNUM8    ZSNUM8                          103889
     CLR                   CALL 'ZSFILE'
     CLR                   PARM           SEQ     5
     CLR                   PARM BRCA      SENTY   3
     CLR                   PARM           SFILE8
     CLR                   PARM           ZSNUM8  60
     CLR                   PARM           ZSERR   1
      *
     CLR         *LOCK     IN   LDA
     CLR         ZSERR     IFEQ 'Y'
      ** ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM
     CLR                   SETON                     U7U8
     CLR                   END
     CLR                   ELSE
     CLR                   SETOF                     59
     CLR                   END
      *
     C**LRNU8****TOTREC    COMP COUNT                U8U8                 122263
     CLR U7                MOVE 'LE0541'  DBPGM
     CLR U7 U8             EXSR *PSSR
      /EJECT
      *****************************************************************
      *    COMFEE  -  TO PROCESS COMMITMENT FEE RECORDS               *
      *                                                               *
      *    CALLED BY:  MAIN PROCESSING                                *
      *    CALLS    :  ZDATE2,CCYCHN,CLICHN                           *
      *****************************************************************
      *
     C           COMFEE    BEGSR                           ** COMFEE BEGSR
      *
     C                     MOVE *OFF      *IN43                                             BUG13341
     C                     MOVE *OFF      *IN44                                             BUG13341
      *
     C           BTIN      COMP 'B'                  42  41
      *
      **   IF COMMITMENT FEE IS ZERO, DO NOT PRINT BILL
      *
     C           INTA      COMP 0                        32     3
     C   32                GOTO CFEND
      *                                                                   160659
      ** output converted INTA in settlement currency (SCCY) if not blank 160659
      *                                                                   160659
     C                     MOVE '0'       *IN78                           160659
     C           SCCY      IFNE *BLANKS                    And Settl Ccy  160659
     C           CCY       ANDNESCCY                                      160659
     C                     Z-ADDINTA      P@FRAM            Set From Amt  160659
     C                     MOVE CCY       P@FRCY            Set From Ccy  160659
     C                     MOVE SCCY      P@TOCY            Set To Ccy    160659
     C                     EXSR XCAMT                       Cvrt Amount   160659
     C                     MOVE P@OUTA    WKINTA 130        Set Conv Amt  160659
     C                     MOVE '1'       *IN78             Set O/P Ind   160659
     C                     EXSR SCCYCH                                    160659
     C                     ENDIF                           End If         160659
      *
      **   CONVERT VALUE DATE
      *
     C                     Z-ADDVDAT      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    VDATA   7
      *
      **   ACCESS CURRENCY FOR NAME AND DPS.
      *
     C                     EXSR CCYCHN
     C   99                GOTO CFEND
      *
      * CHECK VALUE OF ALTERNATE NAME & ADDRESS CODE IS NOT EQUAL TO 'B'
      * IFEQ 'B' BYPASS ALTERNATE NAME & ADDRESS VALIDATION
     C           NACD      IFNE 'B'
      *
      **   ACCESS RELEVANT CLIENT RECORD
      *
     C                     MOVELFCUS      CLIKEY
     C                     MOVELFCUS      AENB    6
     C                     CALL 'AOALTNR0'
     C                     PARM '*BLANKS' @RTCD
     C                     PARM '*KEY   ' @OPTN
     C                     PARM           AENB
     C                     PARM NACD      AZCD    1
     C           SDALTN    PARM SDALTN    DSFDY
     C                     END
     C           @RTCD     IFNE *BLANKS
     C           NACD      OREQ 'B'
     C                     MOVE BBCNA1    CNA1
     C                     MOVE BBCNA2    CNA2
     C                     MOVE BBCNA3    CNA3
     C                     MOVE BBCNA4    CNA4
     C                     END
      *
      **   IF ALTERNATIVE NAME AND ADDRESS RECORD NOT FOUND NOT
      **   A DATABASE ERROR - DEFAULT TO B. ERROR IF B RECORD NOT FOUND
      *
      **   OUTPUT BILL/TELEX
      *
     C   41      NOBL3     ADD  1         NOBL3
     C   42      NOTL3     ADD  1         NOTL3
     C   42      TELX3     ADD  1         TELX3
     C   42      TELX3     COMP 4                        53
     C   42 53             Z-ADD1         TELX3
      *
     C                     EXCPT
     C           CFEND     TAG                             ** CFEND TAG **
     C                     SETOF                     414253
      *
     C                     ENDSR                           ** CFEND ENDSR
      *                                                                  *
      /EJECT
      *****************************************************************
      *    LNFEE - SR. TO PROCESS LOAN FEE RECORDS                    *
      *                                                               *
      *    CALLED BY: MAIN PROCESSING                                 *
      *    CALLS    : ZDATE2,CCYCHN,CLICHN                            *
      *****************************************************************
      *
     C           LNFEE     BEGSR
      *
      **   DO NOT OUTPUT BILL/TELEX IF THE FEE AMOUNT IS BLANK.
      *
     C           INTA      IFNE *ZEROS
      *                                                                   160659
      ** output converted INTA in settlement currency (SCCY) if not blank 160659
      *                                                                   160659
     C                     MOVE '0'       *IN78                           160659
     C           SCCY      IFNE *BLANKS                    And Settl Ccy  160659
     C           CCY       ANDNESCCY                                      160659
     C                     Z-ADDINTA      P@FRAM            Set From Amt  160659
     C                     MOVE CCY       P@FRCY            Set From Ccy  160659
     C                     MOVE SCCY      P@TOCY            Set To Ccy    160659
     C                     EXSR XCAMT                       Cvrt Amount   160659
     C                     MOVE P@OUTA    WKINTA 130        Set Conv Amt  160659
     C                     MOVE '1'       *IN78             Set O/P Ind   160659
     C                     EXSR SCCYCH                                    160659
     C                     ENDIF                           End If         160659
      *
      **   CONVERT VALUE DATE
      *
     C                     Z-ADDVDAT      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    VDATA   7
      *
      **   ACCESS CURRENCY FOR NAME AND DECIMAL PLACES
      *
     C                     EXSR CCYCHN
      *
     C           *IN99     IFEQ '0'
      *
      **  OBTAIN ALTERNATE NAME & ADDRESS DETAILS IF NAME & ADDRESS
      **  CODE IS NOT EQUAL TO 'B'
      *
     C           NACD      IFNE 'B'
     C                     MOVELFCUS      CLIKEY
     C                     MOVELFCUS      AENB    6
     C                     CALL 'AOALTNR0'
     C                     PARM '*BLANKS' @RTCD
     C                     PARM '*KEY   ' @OPTN
     C                     PARM           AENB
     C                     PARM NACD      AZCD    1
     C           SDALTN    PARM SDALTN    DSFDY
     C                     END
     C           @RTCD     IFNE *BLANKS
     C           NACD      OREQ 'B'
     C                     MOVE BBCNA1    CNA1
     C                     MOVE BBCNA2    CNA2
     C                     MOVE BBCNA3    CNA3
     C                     MOVE BBCNA4    CNA4
     C                     END
      *
      **   OUTPUT BILL
      *
     C           BTIN      IFEQ 'B'
     C           NOBL3     ADD  1         NOBL3
     C                     MOVE '1'       *IN81
     C                     END
      *
      **   OUTPUT TELEXES
      *
     C           BTIN      IFEQ 'T'
      *
     C           NOTL3     ADD  1         NOTL3
     C                     MOVE '1'       *IN82
      *
      **   OUTPUT DETAILS TO PF/LEBTX3 FEE TELEX EXTRACT FILE IF U2 ON.
      *
     C           *INU2     IFEQ '1'
     C           TELX3     ADD  1         TELX3
     C                     END
      *
     C           TELX3     IFEQ 4
     C                     MOVE '1'       *IN53
     C                     Z-ADD1         TELX3
     C                     END
      *
     C                     END
      *
     C                     EXCPT
      *
     C                     END
      *
     C                     END
      *
     C                     SETOF                     818253
     C                     MOVE *OFF      *IN43                                             BUG13341
     C                     MOVE *OFF      *IN44                                             BUG13341
      *
     C                     ENDSR
      *
      /EJECT
      *****************************************************************
      *    INTHED  -  TO PROCESS INTEREST HEADERS                     *
      *                                                               *
      *    CALLED BY:  MAIN PROCESSING                                *
      *    CALLS    :  ZDATE2,CCYCHN,CLICHN                           *
      *****************************************************************
     C           INTHED    BEGSR                           ** INTHED BEGSR
      *                                                                                       235743
     C                     Z-ADDTIPD      OINTO1 130                                          235743
     C           INTA      SUB  TIPD      INTO1  130     08                                   235743
     C                     Z-ADDINTA      OINTO1                                              235743
     C                     Z-ADD*ZEROS    CFWD1  130                                          235743
     C                     Z-ADD*ZEROS    TADJ                                                235743
      *
      **   CONVERT DATE
      *
     C                     Z-ADDVDAT      WHVDAT  50
     C                     Z-ADDCPAM      WHCPAM 130
     C                     Z-ADDINTR      WHINTR 117
     C                     Z-ADD0         WPINTO
     C                     Z-ADD0         WPINT2                                              235743
     C                     Z-ADD0         @IPRD                                               235743
     C                     Z-ADDVDAT      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    VDATA   7
     C                     MOVE ZADATE    WHVADA  7
     C                     SETOF                     77                                       239714
      *
      **   CALCULATE AMOUNTS
      *
     C                     Z-ADDPRAM      PRAMO  130       BALANCE
     C********** INTA      SUB  TIPD      INTO   130       INTEREST O/S.                      235743
     C           INTA      SUB  TIPD      INTO   130     08                                   235743
     C           SPINL     COMP 'A'                      35
     C   35      BRTEL     ADD  RTSPL     ERATE  117
      *
     C           SPINL     COMP 'S'                      35
     C   35      BRTEL     SUB  RTSPL     ERATE
      *
     C           SPINL     COMP 'P'                      35
     C   35      RTSPL     DIV  100       PERC   117H
     C   35      BRTEL     MULT PERC      ERATE     H
     C                     Z-ADDERATE     ORATE  117
      *
      **   OBTAIN CURRENCY NAME AND DECIMAL PLACES
      *
     C                     EXSR CCYCHN
     C   99                GOTO IEND
     C           BTIN      COMP 'B'                  44  43
      *
      **   ACCESS RELEVANT CLIENT RECORD
      *
     C                     MOVELCNUM      CLIKEY
     C                     MOVELCNUM      AENB
     C           CUST2     TAG                             ** CUST2 TAG **
     C                     CALL 'AOALTNR0'
     C                     PARM '*BLANKS' @RTCD
     C                     PARM '*KEY   ' @OPTN
     C                     PARM           AENB
     C                     PARM NACD      AZCD
     C           SDALTN    PARM SDALTN    DSFDY
     C           @RTCD     IFNE *BLANK
     C                     MOVE BBCNA1    CNA1
     C                     MOVE BBCNA2    CNA2
     C                     MOVE BBCNA3    CNA3
     C                     MOVE BBCNA4    CNA4
     C                     END
      *
      **   IF ALTERNATIVE NAME AND ADDRESSRECORD NOT FOUND NOT
      **   DATABASE ERROR - DEFAULT B. ERROR IF B NOT FOUND.
      **
      **   CHECK DATE
      *
     C           VDAT      COMP LIPD                 3538
      *                                                                                       235743
      ** Skip processing if following condition occurs, past event                            235743
      *                                                                                       235743
     C                     MOVELLNRF      LNRFP   6                                         MD040908
     C           VDAT      IFEQ LIPD                                                          235743
     C                     MOVE '1'       *IN35                                               235743
     C                     GOTO IEND                                                          235743
     C                     ENDIF                                                              235743
      *                                                                                       235743
     C   35                GOTO IEND
      *                                                                                       CLE028
     C           CLE028    IFEQ 'Y'                                                           CLE028
     C           PTYP      ANDEQ80                                                            CLE028
     C           ADIF      ANDEQ'Y'                                                           CLE028
     C                     GOTO IEND                                                          CLE028
     C                     ENDIF                                                              CLE028
      *                                                                                       CLE028
      *
     C   43      STPG      ADD  1         PGNO    30
     C   43                Z-ADD0         BLINES
     C   44                Z-ADD20        TLINES  20
     C   44                SETON                     70
     C           INTC      COMP 'Y'                      45
      *
     C**********           EXCPT                                                            BUG13341
     C**********           SETOF                     4344                                   BUG13341
     C**********           Z-ADDLNRF      LNRFP   60                                 BUG13341 CLE148
     C**********           MOVELLNRF      LNRFP   6                                  CLE148 MD040908
      *                                                                                       235743
      ** Retrieve the last Principal (RE) or Interest Payment (IN) date                       235743
      *                                                                                       235743
     C                     EXSR SRHIHP                                                        235743
      *
      ** Check if Back-value movements exist
      *
     C           W#HIST    IFEQ 'Y'                                                           235743
     C                     EXSR SRBVMV
     C                     Z-ADDTADJ      CFWD1                                               235743
     C                     ENDIF                                                              235743
      *                                                                                       235743
     C***********BTIN      IFEQ 'B'                                                    132738 209690
     C***********LNRF      ANDNENLNRF                                                  132738 209690
     C***********          EXCPTDETAIL                                                 132738 209690
     C***********          END                                                         132738 209690
      *
     C           IEND      TAG                             ** IEND TAG ***
     C**********           SETOF                     4344                                   BUG13341
      *
     C                     ENDSR
      *
      /EJECT
      *****************************************************************
      *    QCHECK  -  TO DETERMINE WHETHER A RECORD IS A              *
      *               MOVEMENT OR A PAYMENT                           *
      *                                                               *
      *    CALLED BY: MAIN PROCESSING                                 *
      *    CALLS    : PAYMNT,MOVE                                     *
      *****************************************************************
      *
     C           QCHECK    BEGSR                           * QCHECK BEGSR
      *
     C           AMTP      COMP 'IN'                     34
     C  N34      AMTP      COMP 'RE'                     34
     C  N34      AMTP      COMP 'MA'                     34
     C   34      BTRQ      COMP 'Y'                      34
     C   34                EXSR PAYMNT
     C  N34                EXSR MOVE
      *
     C                     ENDSR
      *
      /EJECT
      *****************************************************************
      *                                                               *
      *    AMEND  -  TO PROCESS AMENDMENT NOTIFICATION RECORDS        *
      *                                                               *
      *    CALLED BY:  MAIN PROCESSING                                *
      *                                                               *
      *****************************************************************
     C           AMEND     BEGSR                           ** AMEND BEGSR
      *
      **   CHECK AMENDMENT TYPE FOR NARRATIVE
      *
     C           AMTP      COMP 'IN'                     74
     C           AMTP      COMP 'RE'                     75
     C  N75      AMTP      COMP 'MR'                     75
     C           AMTP      COMP 'MA'                     76
      *
      **   OUTPUT BILL OR TELEX
      *
     C           BTIN      COMP 'B'                  66  67
     C   66      NOTL4     ADD  1         NOTL4
     C   67      NOBL4     ADD  1         NOBL4
     C   66      TELX4     ADD  1         TELX4
     C   66      TELX4     COMP 4                        53
     C   66 53             Z-ADD1         TELX4
      *
     C                     EXCPT
     C                     MOVE *OFF      *IN43                                             BUG13341
     C                     MOVE *OFF      *IN44                                             BUG13341
     C                     SETOF                     666753
      *
     C                     ENDSR
      ******************************************************************* 160659
      *                                                                 * 160659
      *    SCCYCH SR. TO CHAIN FOR SETTLEMENT CCY NO. OF DEC PLACES     * 160659
      *                                                                 * 160659
      *    ROUTINE CALLED FROM COMFEE,LNFEE                             * 160659
      *                                                                 * 160659
      ******************************************************************* 160659
     C           SCCYCH    BEGSR                                          160659
      *                                                                   160659
     C                     SETOF                     99                   160659
     C                     CALL 'AOCURRR0'                                160659
     C                     PARM '*MSG   ' @RTCD   7                       160659
     C                     PARM '*KEY   ' @OPTN   7                       160659
     C                     PARM SCCY      TKEY    3                       160659
     C           SDCURR    PARM SDCURR    DSSDY                           160659
     C           @RTCD     IFNE *BLANK                                    160659
     C                     SETON                     99                   160659
     C                     MOVE 'SDCURRPD'DBFILE                          160659
     C                     MOVELSCCY      DBKEY                           160659
     C                     ENDIF                           ***********    160659
      *                                                    *         *    160659
     C   99                Z-ADD5         DBASE            * DBASE 5 *    160659
     C   99                SETON                     U7U8LR*         *    160659
      *                                                    ***********    160659
     C  N99      CDP       COMP 1                      8384               160659
     C  N99      CDP       COMP 2                    86  85               160659
      *                                                                   160659
     C                     ENDSR                                          160659
      *
      /EJECT
      *****************************************************************
      *    CCYCHN  -  TO CHAIN FOR CURRENCY NAME AND DPS.             *
      *                                                               *
      *    CALLED BY:  COMFEE,INTHED                                  *
      *****************************************************************
      *
     C           CCYCHN    BEGSR                           ** CCYCHN BEGSR
      *
     C                     SETOF                     99
     C                     CALL 'AOCURRR0'
     C                     PARM '*MSG   ' @RTCD   7
     C                     PARM '*KEY   ' @OPTN   7
     C                     PARM CCY       TKEY    3                    A
     C           SDCURR    PARM SDCURR    DSSDY                        B
     C           @RTCD     IFNE *BLANK
     C                     SETON                     99
     C                     MOVE 'SDCURRPD'DBFILE
     C                     MOVELCCY       DBKEY
     C                     END
     C   99                Z-ADD2         DBASE            DBASE 2
     C   99                SETON                     U7U8LR
      *
     C  N99      CDP       COMP 1                      6061
     C  N99      CDP       COMP 2                    63  62
      *
     C                     ENDSR
      *                                                                  *
      /EJECT
      *****************************************************************
      *    CLICHN  -  TO CHAIN TO CLIENT FILE                         *
      *                                                               *
      *    CALLED BY:  COMFEE,INTHED                                  *
      *****************************************************************
      *
     C           CLICHN    BEGSR                           ** CLICHN BEGSR
      *
     C                     SETOF                     99
     C                     CALL 'AOCUSTR0'
     C                     PARM '*MSG   ' @RTCD
     C                     PARM '*KEY   ' @OPTN
     C                     PARM           CLIKEY
     C                     PARM '*CNUM  ' KEYSTS  7
     C           SDCUST    PARM SDCUST    DSSDY
     C           @RTCD     IFNE *BLANKS
     C                     SETON                     99
     C                     END
      *
     C                     ENDSR
      *
      /EJECT
      *****************************************************************
      *    MOVE SR. TO PROCESS MOVEMENT RECORDS                       *
      *                                                               *
      *    CALLED BY:  MAIN PROCESSING,QCHECK                         *
      *    CALLS:      ZDATE2                                         *
      *****************************************************************
      *
     C           MOVE      BEGSR                           ** MOVE BEGSR *
      *
     C                     EXSR SETUP
     C                     Z-ADD0         MAMT   130
     C                     Z-ADD0         MAMTR  117
     C                     SETOF                     31
     C                     MOVE '0'       *IN72
      *
      **   CHECK DATE FOR OUTPUT
      *
     C           VDAT      COMP LIPD                 353637
     C   35
     C***OR 37N38             GOTO MEND                                   132738
     C*OR*37N38****        GOTO PRTIN                                                  132738 209690
     COR 37N38             GOTO MEND                                                          209690
      *
      **   CONVERT DATE
      *
     C                     Z-ADDVDAT      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    VDATA
      *
      **   UPDATE PRINCIPAL, INTEREST, AND RATE AND CALCULATE MOVE AMT.
      *
     C           AMTP      COMP 'PI'                     35
     C  N35      AMTP      COMP 'PT'                     35
     C   35      PRAMO     ADD  PRAM      PRAMO
     C   35                Z-ADDPRAM      MAMT
      *
     C           AMTP      COMP 'IN'                     35
     C   35 45   PRAMO     ADD  PRAM      PRAMO            BALANCE
     C   35      TIPD      ADD  INTA      TIPD             INTEREST PAID
     C   35                Z-ADDINTA      MAMT             MOVEMENT AMT
      *
     C           AMTP      COMP 'MA'                     35
     C  N35      AMTP      COMP 'RE'                     35
     C  N35      AMTP      COMP 'MR'                     35
     C  N35      AMTP      COMP 'PF'                     35
     C   35      PRAMO     SUB  PRAM      PRAMO
     C   35      TIPD      ADD  INTA      TIPD
     C   35      PRAM      ADD  INTA      MAMT
      *
     C           AMTP      COMP 'MI'                     35
     C   35                Z-ADDINTA      MAMT
      *
     C           AMTP      COMP 'SA'                     65
      *
     C           AMTP      COMP 'SC'                     35
     C   35                SETON                         31
     C   35                Z-ADDRTSP      RTSPL
      *
     C           AMTP      COMP 'BC'                     35
     C  N35      AMTP      COMP 'BR'                     35
     C   35                SETON                         31
     C   35                Z-ADDBRTE      BRTEL
      *
     C           AMTP      COMP 'RO'                     35
     C   35                SETON                         31
     C   35                Z-ADDRTSP      RTSPL
     C   35                Z-ADDBRTE      BRTEL
     C   35                MOVE SPIN      SPINL
      *
      **  CALCULATE NEW INTEREST RATE
      *
     C           SPINL     COMP 'A'                      35
     C   35      BRTEL     ADD  RTSPL     ERATE
      *
     C           SPINL     COMP 'S'                      35
     C   35      BRTEL     SUB  RTSPL     ERATE        52
      *
     C           SPINL     COMP 'P'                      35
     C   35      RTSPL     DIV  100       PERC   117H
     C   35      BRTEL     MULT PERC      ERATE     H
      *
      **   CHECK FOR RATE CHANGE
      *
     C   31                Z-ADDERATE     MAMTR
      *
      ** Check for Calculation Basis and Days
      *
     C                     Z-ADDWPCALC    BASIS   10
     C           CALC      IFNE WPCALC
     C           AMTP      ANDEQ'RO'                                                          235743
     C           CALC      ORNE WPCALC                                                        235743
     C           AMTP      ANDEQ'MC'                                                          235743
     C                     Z-ADDCALC      WPCALC
     C                     ENDIF
      *
      **   CALCULATE AMOUNTS
      *
     C                     Z-ADDDAYS      SDAY    30
      *
     C           MAMTR     COMP 0                    6464
     C   65                SETON                     64
      *
     C           BTIN      COMP 'B'                  47  46
      *
     C           *LIKE     DEFN IPRD      @IPRD                                               235743
     C           IPRD      IFNE @IPRD                                                         235743
     C                     Z-ADD0         WPINT2 130H                                         235743
     C                     Z-ADDIPRD      @IPRD                                               235743
     C                     ENDIF                                                              235743
     C                     Z-ADD0         INTO                                                235743
      *                                                                                       235743
     C           WBVME     IFEQ 'Y'
     C                     Z-ADDCPAM      PRAMO
     C                     Z-ADDINTR      ORATE
     C                     Z-ADDAITC      INTO
     C                     SUB  IPRD      INTO
     C                     SUB  AIAP      INTO
     C                     SUB  WPINTO    INTO
     C                     ELSE
      *                                                                                       235743
     C           WPINT2    IFEQ 0                                                             235743
     C           ACUP      ANDNE0                                                             235743
     C                     Z-ADDACUP      INTO                                                235743
     C                     SUB  IPRD      INTO                                                235743
     C                     SUB  AIAP      INTO                                                235743
     C           AMTP      IFEQ 'IN'                                                          235743
     C                     ADD  INTA      INTRPV 130                                          235743
     C                     MOVE 'Y'       INCLU   1                                           235743
     C                     END                                                                235743
     C                     ELSE                                                               235743
      *                                                                                       235743
     C********** ACUP      SUB  WPINTO    INTO   130H                                         235743
     C           ACUP      SUB  WPINT2    INTO   130H                                         235743
     C                     SUB  IPRD      INTO                                                235743
     C                     SUB  AIAP      INTO                                                235743
     C                     ENDIF                                                              235743
     C                     ENDIF
     C                     Z-ADDINTO      WPINTO 130H
     C                     ADD  INTO      WPINT2 130H                                         235743
     C           ACUP      SUB  OINTO1    INTO1                                               235743
     C                     Z-ADDACUP      OINTO1                                              235743
     C                     ADD  INTO1     CFWD1                                               235743
      *
     C           AMTP      IFEQ 'MC'
     C           CLE006    ANDEQ'Y'
     C           AMTP      OREQ 'MC'                                      CEU020
     C           CEU020    ANDEQ'Y'                                       CEU020
     C           AMTP      OREQ 'MC'                                      CLE015
     C           CLE007    ANDEQ'Y'                                       CLE015
     C                     MOVE RLCY      NCCY    3
     C                     MOVE '0'       *IN46
     C                     MOVE '1'       *IN72
     C                     ENDIF
      *
      **   OUTPUT DETAILS
      **
      *
     C                     EXCPT
     C                     MOVE *OFF      *IN43                                             BUG13341
     C                     MOVE *OFF      *IN44                                             BUG13341
     C   72
     COR 46      BLINES    ADD  1         BLINES
     C   72
     COR 46      BLINES    COMP 15                       54
      *
     C   47      TLINES    ADD  3         TLINES
     C   47      TLINES    COMP 55                   55  55
      *
     C                     SETOF                     4647
     C                     SETOF                     6465
     C                     MOVE '0'       *IN72
      *
     C                     EXCPT
     C   54                Z-ADD0         BLINES  20
     C   55                Z-ADD20        TLINES
      *
     C                     Z-ADDERATE     ORATE
      *
     C   54                SETON                     4373
     C   55                SETON                     447073
     C   43      PGNO      ADD  1         PGNO
     C                     SETOF                     5455
      *
     C                     EXCPT
     C                     SETOF                     434473
     C                     SETOF                     70
     C***********PRTIN     TAG                                                         132738 209690
     C***********BTIN      IFEQ 'B'                                                    132738 209690
     C************IN38     ANDEQ'1'                                                    132738 209690
     C***********LNRF      ANDNENLNRF                                                  132738 209690
     C***********          EXCPTDETAIL                                                 132738 209690
     C***********          END                                                         132738 209690
      *
     C           MEND      ENDSR                           ** MEND ENDSR *
      *
      /EJECT
      *****************************************************************
      *    PAYMENT SR. TO PROCESS PAYMENT RECORDS                     *
      *                                                               *
      *    CALLED BY:  QCHECK                                         *
      *    CALLS    :  ZDATE2,LESS,EQUAL                              *
      *****************************************************************
      *
     C           PAYMNT    BEGSR                           ** PAYMNT BEGSR
      *
      **   CONVERT AND CHECK DATE AND CHECK REPAYMENT TYPE AND
      **   AMENDMENT INDICATOR
      *
     C                     EXSR SETUP
     C                     Z-ADDVDAT      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    VDATA
     C           VDAT      COMP LIPD                 353637
     C           REPT      COMP 2                        39
     C                     SETOF                     25
     C   39                SETON                     25
      *
      **   IF 'IN' PAYMENT IGNORE REPAY TYPE
      **
     C   39      AMTP      COMP 'IN'                 3939
      **  IGNORE REPAY TYPE IF'MA'
     C   39      AMTP      COMP 'MA'                 3939
     C           ACBI      COMP 'S'                      77
      *-------------------------------------------------------------------CEU004
      ** If reading the *IN04 record and the settlement currency for EMU  CEU004
      ** is not blank, the principle amount must be converted.            CEU004
      *                                                                   CEU004
     C           *IN04     IFEQ '1'                        If *IN04 On    CEU004
     C           SCCY      ANDNE*BLANKS                    And Settl Ccy  CEU004
     C           CCY       ANDNESCCY                                                          222236
     C                     MOVE PRAM      P@FRAM            Set From Amt  CEU004
     C                     MOVE CCY       P@FRCY            Set From Ccy  CEU004
     C                     MOVE SCCY      P@TOCY            Set To Ccy    CEU004
     C                     EXSR XCAMT                       Cvrt Amount   CEU004
     C                     MOVE P@OUTA    WKPRAM 130        Set Conv Amt  CEU004
     C                     MOVE '1'       *IN27             Set O/P Ind   CEU004
     C                     ENDIF                           End If         CEU004
      *-------------------------------------------------------------------CEU004
      *
      **   OUTPUT PRINCIPAL ONLY B/T IF NECESSARY
      *
     C   35
     COR 39      BTIN      COMP 'B'                  49  48
      *                                                                                       CLE028
      ** Output principal only if Add on interest is 'Y' for flat rate                        CLE028
      ** personal loans                                                                       CLE028
      *                                                                                       CLE028
     C           CLE028    IFEQ 'Y'                                                           CLE028
     C           PTYP      ANDEQ80                                                            CLE028
     C           ADIF      ANDEQ'Y'                                                           CLE028
     C           BTIN      IFEQ 'B'                                                           CLE028
     C                     MOVE *ON       *IN48                                               CLE028
     C                     ELSE                                                               CLE028
     C                     MOVE *ON       *IN49                                               CLE028
     C                     ENDIF                                                              CLE028
     C                     ENDIF                                                              CLE028
      *                                                                                       CLE028
     C   48      NOBL1     ADD  1         NOBL1
     C   49      NOTL1     ADD  1         NOTL1
     C   49      TELX1     ADD  1         TELX1
     C   49      TELX1     COMP 4                        53
     C   49 53             Z-ADD1         TELX1
      *
     C                     EXCPT
     C                     MOVE *OFF      *IN43                                             BUG13341
     C                     MOVE *OFF      *IN44                                             BUG13341
      *-------------------------------------------------------------------CEU004
      ** If processing for EMU has been performed, set the output         CEU004
      ** indicator off.                                                   CEU004
      *                                                                   CEU004
     C           *IN04     IFEQ '1'                        If *IN04 On    CEU004
     C           SCCY      ANDNE*BLANKS                    And Settl Ccy  CEU004
     C                     MOVE '0'       *IN27             Reset O/P Ind CEU004
     C                     ENDIF                           End If         CEU004
      *-------------------------------------------------------------------CEU004
     C                     SETOF                     484953
     C   35                GOTO PEND
      *
      **   OUTPUT HEADINGS IF REPT 1/3 AND NO HEADINGS THERE
      *
     C   38
     COR 39                GOTO PATAG
      *                                                                                       CLE028
     C           CLE028    IFEQ 'Y'                                                           CLE028
     C           PTYP      ANDEQ80                                                            CLE028
     C           ADIF      ANDEQ'Y'                                                           CLE028
     C                     GOTO PATAG                                                         CLE028
     C                     ENDIF                                                              CLE028
      *                                                                                       CLE028
     C           BTIN      COMP 'B'                  44  43
     C   44      TLINES    COMP 40                   70  70
     C   44 70             Z-ADD20        TLINES
     C   44N70   TLINES    ADD  13        TLINES
     C   43      PGNO      ADD  1         PGNO
     C   43                Z-ADD0         BLINES
      *
     C                     EXCPT
     C                     SETOF                     434470
     C           PATAG     TAG                             ** PATAG TAG **
      *
      **   UPDATE AMOUNTS
      *
     C           AMTP      COMP 'IN'                     35
     C   35      TIPD      ADD  INTA      TIPD
     C   35 45   PRAMO     ADD  PRAM      PRAMO
     C   35                Z-ADDINTA      MAMT
      *
     C           AMTP      COMP 'RE'                     35
     C  N35      AMTP      COMP 'MA'                     35
     C  N35      AMTP      COMP 'MR'                     35
     C           *IN35     IFEQ '1'                                                           235743
     C           *IN45     ANDEQ'1'                                                           235743
     C           PRAM      SUB  INTA      PRAM                                                235743
     C                     END                                                                235743
     C   35      PRAMO     SUB  PRAM      PRAMO
     C   35      TIPD      ADD  INTA      TIPD
     C   35      PRAM      ADD  INTA      MAMT
      *
     C           ACUP      SUB  TIPD      INTO      H
     C           ACUP      SUB  OINTO1    INTO1                                               235743
     C                     Z-ADDACUP      OINTO1                                              235743
     C                     ADD  INTO1     CFWD1                                               235743
     C                     Z-ADDDAYS      SDAY    30
      *-------------------------------------------------------------------CEU004
      ** If reading the *IN04 record and the settlement currency for EMU  CEU004
      ** is not blank, the maturity amount must be converted.             CEU004
      *                                                                   CEU004
     C           *IN04     IFEQ '1'                        If *IN04 On    CEU004
     C           SCCY      ANDNE*BLANKS                    And Settl Ccy  CEU004
     C           CCY       ANDNESCCY                                                          222236
     C                     MOVE MAMT      P@FRAM            Set From Amt  CEU004
     C                     MOVE CCY       P@FRCY            Set From Ccy  CEU004
     C                     MOVE SCCY      P@TOCY            Set To Ccy    CEU004
     C                     EXSR XCAMT                       Cvrt Amount   CEU004
     C                     MOVE P@OUTA    WKMAMT 130        Set Conv Amt  CEU004
     C                     ENDIF                           End If         CEU004
      *-------------------------------------------------------------------CEU004
      *
      **   CALL SUBROUTINE FOR FURTHER PROCESSING
      *
     C   36
     COR 37 39 38          EXSR LESS
     C   37N39             EXSR EQUAL
      *
     C           PEND      ENDSR                           ** PEND ENDSR *
      *
      /EJECT
      *****************************************************************
      *    LESS  -  TO PROCESS PAYMENTS WITH VDAT LT LIPD             *
      *             AND REPT 1/3, OR REPT 2.                          *
      *                                                               *
      *    CALLED BY:  PAYMNT                                         *
      *    CALLS    :  WTXTYP                                         *
      *****************************************************************
      *
     C           LESS      BEGSR                           ** LESS BEGSR *
      *
      **   OUTPUT MOVEMENT DETAILS AND C/F IF NEEDED
      *
     C           BTIN      COMP 'B'                  47  46
      *
      *-------------------------------------------------------------------CEU004
      ** If processing for EMU is required, set the output indicator on   CEU004
      ** and adjust the count.                                            CEU004
     C           *IN04     IFEQ '1'                        If *IN04 On    CEU004
     C           SCCY      ANDNE*BLANKS                    And Settl Ccy  CEU004
     C                     MOVE '1'       *IN28             Set O/P Ind   CEU004
     C                     ADD  1         BLINES            Adj Count     CEU004
     C                     ADD  1         TLINES            Adj Count     CEU004
     C                     ENDIF                           End If         CEU004
      *-------------------------------------------------------------------CEU004
     C                     EXCPT
     C                     MOVE *OFF      *IN43                                             BUG13341
     C                     MOVE *OFF      *IN44                                             BUG13341
      *-------------------------------------------------------------------CEU004
      ** If processing for EMU has been performed, set the output         CEU004
      ** indicator off.                                                   CEU004
      *                                                                   CEU004
     C           *IN04     IFEQ '1'                        If *IN04 On    CEU004
     C           SCCY      ANDNE*BLANKS                    And Settl Ccy  CEU004
     C                     MOVE '0'       *IN28             Reset O/P Ind CEU004
     C                     ENDIF                           End If         CEU004
      *-------------------------------------------------------------------CEU004
     C   46      BLINES    ADD  1         BLINES
     C   46N39   BLINES    COMP 5                    54
     C   46 39   BLINES    COMP 15                   54  54
     C   47      TLINES    ADD  3         TLINES
     C   47      TLINES    COMP 55                   55  55
     C                     SETOF                     4647
      *
     C                     EXCPT
      *
     C   54                Z-ADD0         BLINES
     C   55                Z-ADD20        TLINES
     C   54                SETON                     4373
     C   55                SETON                     447073
     C   43      PGNO      ADD  1         PGNO
     C                     SETOF                     5455
      *
     C                     EXCPT
     C                     SETOF                     434470
     C                     SETOF                     73
     C***********BTIN      IFEQ 'B'                                                    132738 209690
     C***********LNRF      ANDNENLNRF                                                  132738 209690
     C***********          EXCPTDETAIL                                                 132738 209690
     C***********          END                                                         132738 209690
      *
      **   OUTPUT PAYMENT DETAILS AND CHECK OVERFLOW FOR TELEXES
      *
     C***39*****           GOTO LEND                                                          235743
     C           BTIN      COMP 'B'                  51  50
     C           *IN39     IFEQ '1'                                                           235743
     C                     MOVE *BLANKS   WTTYP                                               235743
     C                     Z-ADDPRAM      TAMT                                                235743
     C                     ELSE                                                               235743
     C                     EXSR WTXTYP
     C                     ENDIF                                                              235743
     C   50      NOBL2     ADD  1         NOBL2
     C   51      NOTL2     ADD  1         NOTL2
     C   51 25
     COR 50 25   PRAM      COMP 0                        26
      *
     C                     EXCPT
     C   51      TLINES    ADD  9         TLINES
     C   51      TLINES    COMP 50                   70  70
     C                     SETOF                     5051
     C                     SETOF                     26
      *
      **   OUTPUT HEADINGS FOR NEXT B/T
      *
     C           BTIN      COMP 'B'                  44  43
     C   43      PGNO      ADD  1         PGNO
     C   43                Z-ADD0         BLINES
      *
     C                     EXCPT
     C   44 70             Z-ADD20        TLINES
     C   44N70   TLINES    ADD  13        TLINES
     C                     SETOF                     434470
     C***********BTIN      IFEQ 'B'                                                    132738 209690
     C***********LNRF      ANDNENLNRF                                                  132738 209690
     C***********          EXCPTDETAIL                                                 132738 209690
     C***********          END                                                         132738 209690
      *
     C           LEND      ENDSR                           ** LEND ENDSR *
      *
      /EJECT
      *****************************************************************
      *    EQUAL  -  TO PROCESS PAYMENTS WITH VDAT = LIPD             *
      *              AND REPAYMENT TYPE 1/3.                          *
      *                                                               *
      *    CALLED BY:  PAYMNT                                         *
      *    CALLS    :  WTXTYP                                         *
      *****************************************************************
      *
     C           EQUAL     BEGSR                           ** EQUAL BEGSR
      *
      **   OUTPUT MOVEMENT DETAILS AND C/F IF NEEDED
      *
     C           BTIN      COMP 'B'                  47  46
      *
      *-------------------------------------------------------------------CEU004
      ** If processing for EMU is required, set the output indicator on   CEU004
      ** and adjust the count.                                            CEU004
      *                                                                   CEU004
     C           *IN04     IFEQ '1'                        If *IN04 On    CEU004
     C           SCCY      ANDNE*BLANKS                    And Settl Ccy  CEU004
     C                     MOVE '1'       *IN28             Set O/P Ind   CEU004
     C                     ADD  1         BLINES            Adj Count     CEU004
     C                     ADD  1         TLINES            Adj Count     CEU004
     C                     ENDIF                           End If         CEU004
      *-------------------------------------------------------------------CEU004
     C                     EXCPT
     C                     MOVE *OFF      *IN43                                             BUG13341
     C                     MOVE *OFF      *IN44                                             BUG13341
      *-------------------------------------------------------------------CEU004
      ** If processing for EMU has been performed, set the output         CEU004
      ** indicator off.                                                   CEU004
      *                                                                   CEU004
     C           *IN04     IFEQ '1'                        If *IN04 On    CEU004
     C           SCCY      ANDNE*BLANKS                    And Settl Ccy  CEU004
     C                     MOVE '0'       *IN28             Reset O/P Ind CEU004
     C                     ENDIF                           End If         CEU004
      *-------------------------------------------------------------------CEU004
     C   46      BLINES    ADD  1         BLINES
     C   46      BLINES    COMP 5                    54
     C   47      TLINES    ADD  3         TLINES
     C   47      TLINES    COMP 55                   55  55
     C                     SETOF                     4647
      *
     C                     EXCPT
      *
     C   54                Z-ADD0         BLINES
     C   55                Z-ADD20        TLINES
     C   54                SETON                     4373
     C   55                SETON                     447073
     C   43      PGNO      ADD  1         PGNO
     C                     SETOF                     5455
      *
     C                     EXCPT
     C                     SETOF                     434470
     C                     SETOF                     73
      *
      **   OUTPUT PAYMENT DETAILS
      *
     C           BTIN      COMP 'B'                  51  50
     C           *IN39     IFEQ '1'                                                           235743
     C                     MOVE *BLANKS   WTTYP                                               235743
     C                     Z-ADDPRAM      TAMT                                                235743
     C                     ELSE                                                               235743
     C                     EXSR WTXTYP
     C                     ENDIF                                                              235743
     C   50      NOBL2     ADD  1         NOBL2
     C   51      NOTL2     ADD  1         NOTL2
     C   51 25
     COR 50 25   PRAM      COMP 0                        26
      *
     C                     EXCPT
     C                     SETOF                     505138
     C                     SETOF                     26
      *
     C                     ENDSR
      *
      /EJECT
      *****************************************************************
      *    WTXTYP  -  TO CHECK W/H TYPE AND CALCULATE TOTAL AMOUNT.   *
      *                                                               *
      *    CALLED BY:  LESS,EQUAL                                     *
      *****************************************************************
      *
     C           WTXTYP    BEGSR                           ** WTXTYP BEGSR
      *
     C                     MOVE BLNK10    WTTYP  10
     C           WTIN      COMP 'N'                      56
     C   56                MOVE 'NET'     WTTYP
      *
     C           WTIN      COMP 'G'                      57
     C   57                MOVE 'GROSS'   WTTYP
      *
     C           WTIN      COMP 'R'                      58
     C   58                MOVEL'RECEIVAB'WTTYP
     C   58                MOVE 'LE'      WTTYP
      *
     C           PRAM      ADD  INTA      TAMT   130
     C   58      TAMT      ADD  WTXA      TAMT
      *
      ** IF BACK-VALUE MOVEMENT EXIST
      *
     C           WBVME     IFEQ 'Y'
     C           WTIN      ANDNE' '                                                           235743
     C                     Z-ADDCPAM      PRAM
     C                     Z-ADDAITC      INTA
     C                     SUB  IPRD      INTA
     C                     SUB  AIAP      INTA
     C                     Z-ADDCPAM      TAMT
     C                     ADD  INTA      TAMT
     C                     ENDIF
      *                                                                                       235743
     C           INCLU     IFEQ 'Y'                                                           235743
     C                     MOVE ' '       INCLU                                               235743
     C                     ADD  INTRPV    INTA                                                235743
     C                     ADD  INTRPV    TAMT                                                235743
     C                     END                                                                235743
      *
      *
      **   IF INTEREST IS CAPITALIZED ZEROIZE AMOUNTS
      *
     C   45                Z-ADD0         PRAM
     C   45                Z-ADD0         INTA
     C   45                Z-ADD0         TAMT
      *
     C                     ENDSR
      *
      /EJECT
      *****************************************************************
      *    SETUP  -  TO SET UP NARTP FIELD                            *
      *                                                               *
      *    CALLED BY:  MOVE,PAYMNT,SRBVMV                             *
      *****************************************************************
     C           SETUP     BEGSR                           ** SETUP BEGSR
      *
     C                     MOVE BLANKS    NARTP  11
     C           AMTP      COMP 'BC'                     35
     C   35                MOVEL'BASE CHA'NARTP
     C   35                MOVE 'NGE'     NARTP
      *
     C           AMTP      COMP 'BR'                     35
     C   35                MOVEL'RATE CHA'NARTP
     C   35                MOVE 'NGE'     NARTP
      *
     C           AMTP      COMP 'IN'                     35
     C   35                MOVEL'INT PAYM'NARTP
     C   35                MOVE 'ENT'     NARTP
      *
     C           AMTP      COMP 'MA'                     35
     C   35                MOVEL'MATURITY'NARTP
      *
     C           AMTP      COMP 'MR'                     35
     C   35                MOVEL'REPAYMEN'NARTP
     C   35                MOVE 'T  '     NARTP
      *
     C           AMTP      COMP 'PI'                     35
     C   35                MOVEL'PRIN INC'NARTP
     C   35                MOVE 'R  '     NARTP
      *
     C           AMTP      COMP 'RE'                     35
     C   35                MOVEL'REPAYMEN'NARTP
     C   35                MOVE 'T  '     NARTP
      *
     C           AMTP      COMP 'RO'                     35
     C   35                MOVEL'ROLLOVER'NARTP
      *
     C           AMTP      COMP 'SA'                     35
     C   35                MOVEL'STOP/STA'NARTP
     C   35                MOVE 'RT '     NARTP
      *
     C           AMTP      COMP 'SC'                     35
     C   35                MOVEL'SPREAD C'NARTP
     C   35                MOVE 'HG '     NARTP
      *
     C           AMTP      COMP 'ST'                     35
     C   35                MOVEL'LOAN STA'NARTP
     C   35                MOVE 'RT '     NARTP
      *
     C           AMTP      COMP 'MI'                     35
     C   35                MOVEL'INT ADJU'NARTP
     C   35                MOVE 'ST '     NARTP
      *
     C           AMTP      COMP 'PF'                     35
     C   35                MOVEL'TRANS. F'NARTP
     C   35                MOVE 'ROM'     NARTP
      *
     C           AMTP      COMP 'PT'                     35
     C   35                MOVEL'TRANS. T'NARTP
     C   35                MOVE 'O  '     NARTP
      *
     C           AMTP      COMP 'MC'                     35
     C   35                MOVEL'MC ROLLO'NARTP
     C   35                MOVE 'VER'     NARTP
      *
     C                     ENDSR
      *                                                                  *
      /EJECT                                                                                  235743
      *****************************************************************                       235743
      *                                                               *                       235743
      * SRHIHP -  Retrieve the last payment date (RE or IN)           *                       235743
      *                                                               *                       235743
      * Called by: INTHED                                             *                       235743
      *                                                               *                       235743
      * Calls    :                                                    *                       235743
      *                                                               *                       235743
      *****************************************************************                       235743
     C           SRHIHP    BEGSR                                                              235743
      *                                                                                       235743
      ** KLIST for LEHISTHP                                                                   235743
      *                                                                                       235743
     C           KHISHP    KLIST                                                              235743
     C                     KFLD           WBRCA   3                                           235743
     C**********           KFLD           WCNUM   60                                          CSD027
     C                     KFLD           WCNUM   6                                           CSD027
     C**********           KFLD           WLNRF   60                                   235743 CLE148
     C                     KFLD           WLNRF   6                                           CLE148
      *                                                                                       235743
     C                     MOVE 'N'       W#HIST  1                                           235743
     C                     MOVE 'N'       W#FIN   1                                           235743
     C                     Z-ADD1         W#LOOP  20                                          235743
     C                     MOVE BRCA      WBRCA                                               235743
     C                     MOVE BTIN      WBTIN                                               235743
     C**********           Z-ADDCNUM      WCNUM                                               CSD027
     C                     MOVE CNUM      WCNUM                                               CSD027
     C                     Z-ADDFTYP      WFTYP                                               235743
     C                     Z-ADDFSEQ      WFSEQ                                               235743
     C**********           Z-ADDLNRF      WLNRF                                        235743 CLE148
     C                     MOVELLNRF      WLNRF                                               CLE148
     C                     Z-ADD*ZEROS    W1VDAT  50                                          235743
     C                     MOVE *BLANKS   W1AMTP  2                                           235743
     C                     Z-ADD*ZEROS    W2VDAT  50                                          235743
     C                     MOVE *BLANKS   W2AMTP  2                                           235743
      *                                                                                       235743
      ** Check first if there are backvalued movements (field BVMV)                           235743
      ** in PF/CUTX1HP or PF/CUTX1HQ                                                          235743
      *                                                                                       235743
     C           KSCUTX    SETLLSCUTXL1              89                                       235743
      *                                                                                       235743
     C           *IN89     IFEQ '0'                                                           235743
     C           KSCUTX    READESCUTXL1                  79                                   235743
      *                                                                                       235743
     C           *IN79     DOWEQ'0'                                                           235743
     C           W#HIST    ANDEQ'N'                                                           235743
      *                                                                                       235743
     C           BVMV      IFEQ 'Y'                                                           235743
     C                     MOVE 'Y'       W#HIST                                              235743
     C                     ENDIF                                                              235743
      *                                                                                       235743
     C           KSCUTX    READESCUTXL1                  79                                   235743
     C                     ENDDO                                                              235743
      *                                                                                       235743
     C                     ENDIF                                                              235743
      *                                                                                       235743
      ** Check if there are Loan History Records                                              235743
      ** If LEHISTHP is in EOF (if loan is the last record in LF)                             235743
      ** Otherwise, there are no history records in PF/HISTSHP                                235743
      *                                                                                       235743
     C           W#HIST    IFEQ 'Y'                                                           235743
      *                                                                                       235743
     C           KHISHP    SETGTLEHISTHP             89                                       235743
      *                                                                                       235743
     C           *IN89     IFEQ '1'                                                           235743
     C                     MOVE 'N'       W#HIST                                              235743
     C                     READPLEHISTHP                 79                                   235743
      *                                                                                       235743
     C           *IN79     IFEQ '0'                                                           235743
     C           WLNRF     ANDEQLNRF                                                          235743
     C                     MOVE 'Y'       W#HIST                                              235743
     C                     ENDIF                                                              235743
      *                                                                                       235743
     C                     ENDIF                                                              235743
      *                                                                                       235743
     C                     ENDIF                                                              235743
      *                                                                                       235743
      ** Proceed with the RE/IN retrieve if there are history records                         235743
      *                                                                                       235743
     C           W#HIST    IFEQ 'Y'                                                           235743
      *                                                                                       235743
     C           KHISHP    SETGTLEHISTHP             89                                       235743
     C                     READPLEHISTHP                 79                                   235743
      *                                                                                       235743
     C           *IN79     DOWEQ'0'                                                           235743
     C           W#FIN     ANDEQ'N'                                                           235743
     C           WLNRF     ANDEQLNRF                                                          235743
      *                                                                                       235743
     C           AMTP      IFEQ 'RE'                                                          235743
     C           AMTP      OREQ 'IN'                                                          235743
      *                                                                                       235743
     C                     SELEC                                                              235743
     C           W#LOOP    WHEQ 1                                                             235743
     C                     Z-ADDVDAT      W1VDAT                                              235743
     C                     MOVE AMTP      W1AMTP                                              235743
      *                                                                                       235743
     C           W#LOOP    WHEQ 2                                                             235743
     C                     Z-ADDVDAT      W2VDAT                                              235743
     C                     MOVE AMTP      W2AMTP                                              235743
     C                     MOVE 'Y'       W#FIN                                               235743
      *                                                                                       235743
     C                     ENDSL                                                              235743
     C                     ADD  1         W#LOOP                                              235743
      *                                                                                       235743
     C                     ENDIF                                                              235743
      *                                                                                       235743
     C                     READPLEHISTHP                 79                                   235743
     C                     ENDDO                                                              235743
      *                                                                                       235743
     C                     ENDIF                                                              235743
      *                                                                                       235743
     C                     ENDSR                                                              235743
      /EJECT
      *****************************************************************
      * SRBVMV -  Back-value Processing                               *
      * Called by: INTHED                                             *
      * Calls    : SETUP                                              *
      *****************************************************************
     C           SRBVMV    BEGSR
      *
     C           KSCUTX    KLIST
     C                     KFLD           WBRCA   3
     C                     KFLD           WBTIN   1
     C**********           KFLD           WCNUM   60                                          CSD027
     C                     KFLD           WCNUM   6                                           CSD027
     C                     KFLD           WFTYP   30
     C                     KFLD           WFSEQ   20
     C**********           KFLD           WLNRF   60                                          CLE148
     C                     KFLD           WLNRF   6                                           CLE148
      *
     C                     MOVE *BLANK    WBVME   1
     C                     MOVE '0'       *IN72
     C                     Z-ADD0         WPRVIN 130
     C                     Z-ADDCALC      WPCALC  10
     C                     MOVE BRCA      WBRCA
     C                     MOVE BTIN      WBTIN
     C**********           Z-ADDCNUM      WCNUM                                               CSD027
     C                     MOVE CNUM      WCNUM                                               CSD027
     C                     Z-ADDFTYP      WFTYP
     C                     Z-ADDFSEQ      WFSEQ
     C**********           Z-ADDFSEQ      WLNRF                                               195992
     C**********           Z-ADDLNRF      WLNRF                                        195992 CLE148
     C                     MOVELLNRF      WLNRF                                               CLE148
      *                                                                                       235743
      ** For loans with backvalued movement earlier than the last IN/RE date,                 235743
      ** the date and amounts in IH record (CUTX1HN) is the same as the first                 235743
      ** record written in CUTX1HP or CUTX1HQ when LE0400 has not yet read the                235743
      ** IH record from HISTSHN.                                                              235743
      *                                                                                       235743
     C                     MOVE 'N'       W#FIRS  1                                           235743
      *
     C********** KSCUTX    SETLLSCUTXL1                                                       197682
     C           KSCUTX    SETLLSCUTXL1              89                                       197682
      *
     C           *IN89     IFNE '1'                                                           197682
     C                     READESCUTXL1                  79
      *
     C           *IN79     DOWEQ'0'
     C********** VDAT      IFLT WHVDAT                                                        235743
     C           VDAT      IFLE W1VDAT                                                        235743
      *
      ** Print value date of record
      *
     C                     Z-ADDVDAT      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    VDATA   7
      *                                                                                       235743
     C                     Z-ADDAITC      W#AITC 130                                          235743
     C                     Z-ADDIPRD      W#IPRD 130                                          235743
     C                     Z-ADDAIAP      W#AIAP 130                                          235743
     C                     MOVE ACUP0     W#ACUP 132                                          235743
      *
     C                     EXSR SETUP
      *
     C                     Z-ADD0         MAMT   130
     C                     Z-ADD0         MAMTR  117
     C                     MOVE '0'       *IN31
      *
      ** Update Principal, Interest, and rate and calculate mvmt amt.
      *
     C           AMTP      IFEQ 'PI'
     C           AMTP      OREQ 'PT'
     C                     Z-ADDPRAM      MAMT
     C           W#FIRS    IFEQ 'Y'                                                           235743
     C           PRAMO     ADD  PRAM      PRAMO
     C                     ENDIF                                                              235743
     C                     MOVE ACUP0     W#ACUP                                              235743
     C                     ENDIF
      *
     C           AMTP      IFEQ 'IN'
     C           AMTP      OREQ 'MI'
     C                     Z-ADDINTA      MAMT
     C                     MOVE ACUP0     W#ACUP                                              235743
     C                     ENDIF
      *
     C           AMTP      IFEQ 'MA'
     C           AMTP      OREQ 'MR'
     C           AMTP      OREQ 'RE'
     C           AMTP      OREQ 'PF'
     C           PRAM      ADD  INTA      MAMT
     C           W#FIRS    IFEQ 'Y'                                                           235743
     C           PRAMO     SUB  PRAM      PRAMO
     C                     ENDIF                                                              235743
     C                     MOVE ACUP0     W#ACUP                                              235743
     C                     ENDIF
      *
     C           AMTP      IFEQ 'SC'
     C                     MOVE '1'       *IN31
     C                     Z-ADDRTSP      RTSPL
     C                     MOVE ACUPX     W#ACUP                                              235743
     C                     ENDIF
      *
     C           AMTP      IFEQ 'BC'
     C           AMTP      OREQ 'BR'
     C                     MOVE '1'       *IN31
     C                     Z-ADDBRTE      BRTEL
     C                     MOVE ACUPX     W#ACUP                                              235743
     C                     ENDIF
      *
     C           AMTP      IFEQ 'RO'
     C                     MOVE '1'       *IN31
     C                     Z-ADDRTSP      RTSPL
     C                     Z-ADDBRTE      BRTEL
     C                     MOVE SPIN      SPINL
     C                     MOVE ACUPX     W#ACUP                                              235743
     C                     ENDIF
      *
     C           AMTP      IFEQ 'SA'
     C                     MOVE '1'       *IN65
     C                     MOVE ACUPX     W#ACUP                                              235743
     C                     ENDIF
      *
      **  CALCULATE NEW INTEREST RATE
      *
     C           SPINL     IFEQ 'A'
     C           BRTEL     ADD  RTSPL     ERATE
     C                     ENDIF
      *
     C           SPINL     IFEQ 'S'
     C           BRTEL     SUB  RTSPL     ERATE        52
     C                     ENDIF
      *
     C           SPINL     IFEQ 'P'
     C           RTSPL     DIV  100       PERC   117H
     C           BRTEL     MULT PERC      ERATE     H
     C                     ENDIF
      *
      **  CHECK FOR RATE CHANGE
      *
     C           *IN31     IFEQ '1'
     C                     Z-ADDERATE     MAMTR
     C                     ENDIF
     C                     Z-ADDERATE     ORATE
      *
      ** Check for Calculation Basis and Days
      *
     C                     Z-ADDWPCALC    BASIS   10
     C           CALC      IFNE WPCALC
     C                     Z-ADDCALC      WPCALC
     C                     ENDIF
      *
     C                     Z-ADDDAYS      SDAY    30
     C                     MOVE 'Y'       W#FIRS  1                                           235743
      *
      ** Calculate amount
      *
     C                     Z-ADD0         ACCI   130
     C           AITC      SUB  IPRD      ACCI
     C                     SUB  AIAP      ACCI
     C**********           SUB  WPRVIN    ACCI                                                235743
      *
     C**********           Z-ADDACCI      WPRVIN                                              235743
     C                     MOVE 'Y'       WBVME
      *
     C           MAMTR     COMP 0                    6464
     C   65                SETON                     64
      *
     C           BTIN      COMP 'B'                  47  68
      *
     C           AMTP      IFEQ 'MC'
     C           CLE006    ANDEQ'Y'
     C           AMTP      OREQ 'MC'                                      CEU020
     C           CEU020    ANDEQ'Y'                                       CEU020
     C           AMTP      OREQ 'MC'                                      CLE015
     C           CLE007    ANDEQ'Y'                                       CLE015
     C                     MOVE RLCY      NCCY
     C                     MOVE '0'       *IN46
     C                     MOVE '1'       *IN72
     C                     ENDIF
      *
     C                     EXCPT
      *
     C   72
     COR 68      BLINES    ADD  1         BLINES
     C   72
     COR 68      BLINES    COMP 15                       54
      *
     C   47      TLINES    ADD  3         TLINES
     C   47      TLINES    COMP 55                   55  55
      *
     C                     SETOF                     6847
     C                     SETOF                     6465
     C                     MOVE '0'       *IN72
      *
     C                     EXCPT
     C   54                Z-ADD0         BLINES  20
     C   55                Z-ADD20        TLINES
      *
     C                     Z-ADDERATE     ORATE
      *
     C   54                SETON                     4373
     C   55                SETON                     447073
     C   43      PGNO      ADD  1         PGNO
     C                     SETOF                     5455
      *
     C                     EXCPT
     C                     SETOF                     434473
     C                     SETOF                     70
     C                     MOVE 'Y'       W#FIRS                                              235743
      *
     C                     ENDIF
      *
     C                     READESCUTXL1                  79
      *
     C                     ENDDO
      *                                                                                       197682
     C                     ENDIF                                                              197682
      *
      ** Print total adjustment and print opening balance if
      ** Back-value movement exist
      *
     C           WBVME     IFEQ 'Y'
      *
     C                     Z-ADDW#ACUP    OINTO1                                              235743
      *                                                                                       235743
     C**********           Z-ADDAITC      TADJ   130                                          235743
     C**********           SUB  IPRD      TADJ                                                235743
     C**********           SUB  AIAP      TADJ                                                235743
      *                                                                                       235743
      ** Total Adjustments should be processed only for Bills                                 235743
      *                                                                                       235743
     C           BTIN      IFEQ 'B'                                                           235743
     C                     Z-ADDW#AITC    TADJ   130                                          235743
     C                     SUB  W#IPRD    TADJ                                                235743
     C                     SUB  W#AIAP    TADJ                                                235743
      *
     C                     MOVE '1'       *IN69
     C                     EXCPT
     C                     MOVE '0'       *IN69
      *
     C                     ADD  1         BLINES
     C**********           MOVE WHVADA    VDATA                                               235743
     C**********           Z-ADDWHCPAM    PRAMO                                               235743
     C**********           Z-ADDWHINTR    ORATE                                               235743
     C                     MOVE '1'       *IN71
     C                     ENDIF                                                              235743
      *
     C           BLINES    IFLT 13
     C                     EXCPT
     C                     ADD  2         BLINES
     C                     ELSE
     C                     Z-ADD0         BLINES
     C                     SETON                     437173
     C           PGNO      ADD  1         PGNO
     C                     EXCPT
     C                     ENDIF
     C                     MOVE '0'       *IN71
     C                     SETOF                     437173
      *
     C                     ENDIF
      *
     C                     ENDSR
     C/EJECT                                                              CEU004
      *****************************************************************   CEU004
      *                 XCAMT  - Convert Amount.                      *   CEU004
      *                                                               *   CEU004
      * CALLS           EU0200 -                                      *   CEU004
      *                                                               *   CEU004
      * CALLED BY       PAYMNT - Process Payment Records              *   CEU004
      *                                                               *   CEU004
      *****************************************************************   CEU004
     C           XCAMT     BEGSR                                          CEU004
      *                                                                                       CLE031
     C                     MOVE P@FRCY    WKCCY   3                                           CLE031
     C                     EXSR SRCURR                                                        CLE031
     C                     MOVE WKNBDP    FNBDP   10                                          CLE031
     C                     MOVE WKINCY    FINCY   1                                           CLE031
      *                                                                                       CLE031
     C                     MOVE P@TOCY    WKCCY                                               CLE031
     C                     EXSR SRCURR                                                        CLE031
     C                     MOVE WKNBDP    TNBDP   10                                          CLE031
     C                     MOVE WKINCY    TINCY   1                                           CLE031
      *                                                                                       CLE031
     C           FINCY     IFEQ 'Y'                                                           CLE031
     C           P@TOCY    ANDEQBKEURO                                                        CLE031
     C           TINCY     OREQ 'Y'                                                           CLE031
     C           P@FRCY    ANDEQBKEURO                                                        CLE031
      *                                                                   CEU004
      ** Convert Transaction Amount into Settlement Amount.               CEU004
      *                                                                   CEU004
     C                     CALL 'EU0200'                                  CEU004
      *                                                    Input:         CEU004
     C                     PARM '       ' P@RTCD  7        -Return Code   CEU004
     C                     PARM           P@FRAM 183       -From Ccy Amt  CEU004
     C                     PARM           P@FRCY  3        -From Currency CEU004
     C                     PARM           P@TOCY  3        -To Currency   CEU004
      *                                                    Output:        CEU004
     C                     PARM           P@OUTA 150       -Outright Amt  CEU004
     C                     PARM           P@INTA 183       -Interim Amt   CEU004
     C                     PARM           P@EXRT 159       -Exchange Rate CEU004
     C                     PARM           P@MDIN  1        -Mult/Div Ind. CEU004
      *                                                                   CEU004
     C           P@RTCD    IFNE *BLANKS                    If Error       CEU004
     C                     MOVEL'EU0200  'DBFILE            Set File      CEU004
     C                     MOVELCCY       DBKEY             Set Key       CEU004
     C                     Z-ADD10        DBASE             Set Ref       CEU004
     C                     SETON                     U7U8LR Set Inds      CEU004
     C                     ENDIF                           End If         CEU004
      *                                                                   CEU004
     C                     ELSE                                                               CLE031
      *                                                                                       CLE031
      ** Set up input fields for conversion subroutine.                                       CLE031
      *                                                                                       CLE031
     C           CLE031    IFEQ 'Y'                                                           CLE031
      *                                                                                       CLE031
     C                     Z-ADDSEXR      ZEXCH  138                                          CLE031
     C                     MOVE SEXI      ZMD     1                                           CLE031
     C                     MOVE P@FRAM    ZAMTCI 150                                          CLE031
     C                     MOVE P@FRCY    ZCCYI   3                                           CLE031
     C                     MOVE P@TOCY    ZCCYO   3                                           CLE031
     C                     Z-ADDFNBDP     ZCDPI   10                                          CLE031
     C                     Z-ADDTNBDP     ZCDPO   10                                          CLE031
      *                                                                                       CLE031
     C                     EXSR ZCONV                                                         CLE031
      *                                                                                       CLE031
     C                     Z-ADDZAMTCO    P@OUTA                                              CLE031
     C                     Z-ADDZAMTCO    P@INTA                                              CLE031
      *                                                                                       CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
     C                     ENDSR                                          CEU004
      ********************************************************************CEU004
     C/EJECT                                                              CEU004
      *****************************************************************                       CLE031
      *    SRCURR  -  Call AOCURRR0 to get know if currency is an in  *                       CLE031
      *               currency and to get decimal places.             *                       CLE031
      *                                                               *                       CLE031
      *    CALLED BY:  XCAMT                                          *                       CLE031
      *                                                               *                       CLE031
      *****************************************************************                       CLE031
      *                                                                                       CLE031
     C           SRCURR    BEGSR                           ** SRCURR BEGSR                    CLE031
      *                                                                                       CLE031
     C                     SETOF                     99                                       CLE031
     C                     CALL 'AOCURRR0'                                                    CLE031
     C                     PARM '*MSG   ' @RTCD                                               CLE031
     C                     PARM '*KEY   ' @OPTN                                               CLE031
     C                     PARM WKCCY     TKEY                                                CLE031
     C           SDCURR    PARM SDCURR    DSSDY                                               CLE031
     C           @RTCD     IFNE *BLANK                                                        CLE031
     C                     SETON                     99                                       CLE031
     C                     MOVE 'SDCURRPD'DBFILE                                              CLE031
     C                     MOVELWKCCY     DBKEY                                               CLE031
     C                     END                                                                CLE031
      *                                                                                       CLE031
     C           *IN99     IFEQ *ON                                                           CLE031
     C                     Z-ADD13        DBASE                                               CLE031
     C                     SETON                     U7U8LR                                   CLE031
     C                     ELSE                                                               CLE031
     C           CDP       COMP 1                      8384                                   CLE031
     C           CDP       COMP 2                    86  85                                   CLE031
     C                     MOVE CDP       WKNBDP  10                                          CLE031
     C                     MOVE A6INCY    WKINCY  1                                           CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
     C                     ENDSR                                                              CLE031
      ********************************************************************                    CLE031
      /EJECT                                                                                  CLE031
      ********************************************************************
      /COPY ZSRSRC,ZDATE2Z4
      /EJECT
      *****************************************************************
      *  ZSYSTM  -  TO CHAIN TO THE INSTALLATION CONTROL DATA RECORD. *
      *                                                               *
      *  Called by: MAIN PROCESSING                                   *
      *  Calls    :                                                   *
      *****************************************************************
     C           ZSYSTM    BEGSR                           *** ZSYSTM ***
      *
      **   ACCESS BANK DETAILS
      *
     C                     CALL 'AOBANKR0'
     C                     PARM '*MSG   ' @RTCD   7
     C                     PARM '*FIRST ' @OPTN   7
     C           SDBANK    PARM SDBANK    DSFDY
      *
     C           @RTCD     IFNE *BLANK
     C                     SETON                     U7U8LR
     C                     SETON                     99
     C                     MOVEL'SDBANKPD'DBFILE           ***************
     C                     MOVEL@OPTN     DBKEY            * DBERROR 001 *
     C                     Z-ADD1         DBASE            ***************
     C                     ELSE
      *
      **   CHECK SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.
     C           BJDFIN    COMP 'M'                      98MMDDYY, 98 ON
     C                     END
      *                                                                                       CLE031
      ** Access General Ledger File                                                           CLE031
      *                                                                                       CLE031
     C**********           CALL 'AOGELRR0'                                             CLE031 CGL029
     C                     CALL 'AOGELRR1'                                                    CGL029
     C                     PARM *BLANKS   PRTCD   7                                           CLE031
     C                     PARM '*FIRST  'POPTN   7                                           CLE031
     C********** SDGELR    PARM SDGELR    DSFDY                                        CLE031 CGL029
     C           SDGELR    PARM SDGELR    DSSDY                                               CGL029
      *                                                                                       CLE031
      ** Handle Database Error.                                                               CLE031
      *                                                                                       CLE031
     C           PRTCD     IFNE *BLANKS                                                       CLE031
     C           *LOCK     IN   LDA                                                           CLE031
     C                     MOVEL'SDGELRPD'DBFILE                                              CLE031
     C                     MOVEL'*FIRST  'DBKEY                                               CLE031
     C                     Z-ADD13        DBASE                                               CLE031
     C                     OUT  LDA                                                           CLE031
     C                     EXSR *PSSR                                                         CLE031
     C                     ENDIF                                                              CLE031
      *
      ** Check if CLE006 is switched on
      *
     C                     CALL 'AOSARDR0'
     C                     PARM *BLANKS   @RTCD
     C                     PARM '*KEY   ' @OPTN
     C                     PARM 'CLE006'  PSARD   6
     C           SCSARD    PARM SCSARD    DSFDY
     C           @RTCD     IFEQ *BLANKS
     C                     MOVE 'Y'       CLE006  1
     C                     ELSE
     C                     MOVE 'N'       CLE006
     C           @RTCD     IFNE '*NRF    '
     C                     MOVEL'SCSARDPD'DBFILE           ************
     C                     Z-ADD3         DBASE            * DBERR 03 *
     C                     MOVEL'CLE006'  DBKEY            ************
     C                     SETON                     U7U8LR
     C                     SETON                     99
     C                     ENDIF
     C                     ENDIF
      *                                                                   CLE015
      ** Check if CLE007 is switched on                                   CLE015
      *                                                                   CLE015
     C                     CALL 'AOSARDR0'                                CLE015
     C                     PARM *BLANKS   @RTCD                           CLE015
     C                     PARM '*KEY   ' @OPTN                           CLE015
     C                     PARM 'CLE007'  PSARD   6                       CLE015
     C           SCSARD    PARM SCSARD    DSFDY                           CLE015
     C           @RTCD     IFEQ *BLANKS                                   CLE015
     C                     MOVE 'Y'       CLE007  1                       CLE015
     C                     ELSE                                           CLE015
     C                     MOVE 'N'       CLE007                          CLE015
     C           @RTCD     IFNE '*NRF    '                                CLE015
     C                     MOVEL'SCSARDPD'DBFILE           ************   CLE015
     C                     Z-ADD11        DBASE            * DBERR 11 *   CLE015
     C                     MOVEL'CLE007'  DBKEY            ************   CLE015
     C                     SETON                     U7U8LR               CLE015
     C                     SETON                     99                   CLE015
     C                     ENDIF                                          CLE015
     C                     ENDIF                                          CLE015
     C*                                                                   CLE015
      *                                                                   CEU020
      ** Check if CEU020 is switched on                                   CEU020
      *                                                                   CEU020
     C                     CALL 'AOSARDR0'                                CEU020
     C                     PARM *BLANKS   @RTCD                           CEU020
     C                     PARM '*KEY   ' @OPTN                           CEU020
     C                     PARM 'CEU020'  PSARD   6                       CEU020
     C           SCSARD    PARM SCSARD    DSFDY                           CEU020
     C           @RTCD     IFEQ *BLANKS                                   CEU020
     C                     MOVE 'Y'       CEU020  1                       CEU020
     C                     ELSE                                           CEU020
     C                     MOVE 'N'       CEU020                          CEU020
     C           @RTCD     IFNE '*NRF    '                                CEU020
     C                     MOVEL'SCSARDPD'DBFILE           ************   CEU020
     C                     Z-ADD4         DBASE            * DBERR 04 *   CEU020
     C                     MOVEL'CEU020'  DBKEY            ************   CEU020
     C                     SETON                     U7U8LR               CEU020
     C                     SETON                     99                   CEU020
     C                     ENDIF                                          CEU020
     C                     ENDIF                                          CEU020
      *                                                                                       CLE031
      ** Check if CLE031 is on                                                                CLE031
      *                                                                                       CLE031
     C                     MOVE 'N'       CLE031  1                                           CLE031
     C                     CALL 'AOSARDR0'                                                    CLE031
     C                     PARM *BLANKS   @RTCD                                               CLE031
     C                     PARM '*KEY   ' @OPTN                                               CLE031
     C                     PARM 'CLE031'  PSARD                                               CLE031
     C           SCSARD    PARM SCSARD    DSFDY                                               CLE031
     C           @RTCD     IFEQ *BLANKS                                                       CLE031
     C                     MOVE 'Y'       CLE031                                              CLE031
     C                     ELSE                                                               CLE031
     C           @RTCD     IFNE '*NRF    '                                                    CLE031
     C                     MOVEL'SCSARDPD'DBFILE                                              CLE031
     C                     Z-ADD12        DBASE                                               CLE031
     C                     MOVEL'CEU020'  DBKEY                                               CLE031
     C                     SETON                     U7U8LR                                   CLE031
     C                     SETON                     99                                       CLE031
     C                     GOTO END                                                           CLE031
     C                     ENDIF                                                              CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE028
      ** Check if CLE028 is switched on                                                       CLE028
      *                                                                                       CLE028
     C                     CALL 'AOSARDR0'                                                    CLE028
     C                     PARM *BLANKS   @RTCD                                               CLE028
     C                     PARM '*KEY   ' @OPTN                                               CLE028
     C                     PARM 'CLE028'  PSARD                                               CLE028
     C           SCSARD    PARM SCSARD    DSFDY                                               CLE028
     C           @RTCD     IFEQ *BLANKS                                                       CLE028
     C                     MOVE 'Y'       CLE028  1                                           CLE028
     C                     MOVE *ON       *IN21                                               CLE028
     C                     ELSE                                                               CLE028
     C                     MOVE 'N'       CLE028                                              CLE028
     C                     MOVE *OFF      *IN21                                               CLE028
     C           @RTCD     IFNE '*NRF    '                                                    CLE028
     C                     MOVEL'SCSARDPD'DBFILE                                              CLE028
     C                     Z-ADD5         DBASE                                               CLE028
     C                     MOVEL'CLE028'  DBKEY                                               CLE028
     C                     MOVE *ON       *INU7                                               CLE028
     C                     MOVE *ON       *INU8                                               CLE028
     C                     MOVE *ON       *INLR                                               CLE028
     C                     MOVE *ON       *IN99                                               CLE028
     C                     ENDIF                                                              CLE028
     C                     ENDIF                                                              CLE028
     C/COPY WNCPYSRC,LE0541C001                                                               GOC003
      *
     C                     ENDSR
      *
      /EJECT
      *****************************************************************
      * *PSSR  --- SUBROUTINE TO HANDLE ABNORMAL ERROR CONDITIONS     *
      *                                                               *
      * CALLED FROM: AFTER ABNORNAL OPERATION OCCURS                  *
      * CALLS: NOTHING                                                *
      *****************************************************************
      *
     C           *PSSR     BEGSR                           ** *PSSR **
      *
     C           @RUN      IFEQ *BLANKS
     C                     MOVE 'Y'       @RUN    1
     C                     DUMP
     C                     END
      *
     C                     ENDSR                           ** *PSSR **
      *
      ********************************************************************
      /EJECT
     C/TITLE SR/ZCONV                                                                         CLE031
     C/COPY ZSRSRC,ZCONVZ1                                                                    CLE031
      /EJECT                                                                                  CLE031
      *
      **   AMENDMENT NOTIFICATION TELEX
      *
     OLE0541P8E   03   66 53
     O                         TITL      61
     O        E   05   66 53
     O                                   19 'REFERENCE LE0541-7'
     O                                   51 'DATE'
     O                         RUNA      59
     O                                   65 'PAGE'
     O                         PAGE7 3   70
     O        E   07   66 53
     O                       88           7 'BRANCH'
     O                       88BRCA      11
     O                                   43 'LOAN PAYMENT TELEX'
     O                 U2                70 '**  TELEX GENERATED  **'
     O        E   08   66 53
     O                                   43 '------------------'
     O        E 21     66
     O                                   10 'CUSTOMER'
     O                         BBCNA1    46
     O                                   47 'TELEX NO'
     O                         TELX      60
     O        E  1     66
     O                         BBCNA2    46
     O        E  1     66
     O                         BBCNA3    46
     O        E  1     66
     O                         BBCNA4    46
     O        E  1     66
     O                         CNUM      17
     O**********                         47 'OUR REF:'                                        235743
     O                                   47 'LOAN NUMBER:'                                    235743
     O                         LNRF      54
     O        E 11     66
     O                       74NAR,7     65
     O                       75NAR,8     65
     O                       76NAR,9     65
     O        E  1     66
     O                         NAR,14    65
     O        E  1     66
     O                         NAR,15    65
     O        E  2     66
     O                         NAR,12    65
      *
     O        T   03   L1 59
     O                         TITL      61
     O        T   05   L1 59
     O                                   19 'REFERENCE LE0541-7'
     O                                   51 'DATE'
     O                         RUNA      59
     O                                   65 'PAGE'
     O                         PAGE7 3   70
     O        T   07   L1 59
     O                                   44 'LOAN PAYMENT TELEXES'
     O        T   08   L1 59
     O                                   44 '--------------------'
     O        T   09   L1 59
     O                 88                12 'BRANCH'
     O                 88      BRCA      16
     O                 88      BRNM      48
     O        T   11   L1 59
     O                                   28 'NUMBER OF TELEXES ON THI'
     O                                   36 'S REPORT'
     O                         NOTL4 3   42
     O        T 3      L1 59
     O                 88                36 '*** END OF REPORT FOR'
     O                 88                44 ' BRANCH '
     O                 88      BRCA      47
     O                 88                51 ' ***'
     O                N88                46 '*** END OF REPORT ***'
      *
      **   OUTPUT TO TELEX FILE - AMENDMENT NOTIFICATION
     OLEBTX4  EADD     66
     O                                    1 'D'
     O                         BRCA       4
     O                         CNUM      10
     O                         PTYP      12
     O                         TXDATE    18
     O                         CCY       21
     O                         LNRF      27
     O                                   28 'A'
     O                                   29 'C'
     O                                   70 'I'
     O                         BRCA      73
     O        EADD     66
     O                                    2 'TO'
     O                         CRNM      23
     O                         CTWN      34
     O                         CNUM      41
     O                         BRCA      73
     O        EADD     66
     O                                   20 'LOAN PAYMENT TELEX'
     O**********                         47 'OUR REF'                                         235743
     O                                   47 'LOAN REF:'                                       235743
     O                         LNRF      54
     O                                   59 'DATE'
     O                         RUNA      67
     O                         BRCA      73
     O        EADD     66
     O                       74NAR,7     65
     O                       75NAR,8     65
     O                       76NAR,9     65
     O                         BRCA      73
     O        EADD     66
     O                         NAR,14    65
     O                         BRCA      73
     O        EADD     66
     O        EADD     66
     O                         NAR,15    65
     O                         BRCA      73
     O        EADD     66
     O                         NAR,12    65
     O                                   70 '*'
     O                         BRCA      73
      *
      **  FACILITY FEE TELEXES
      *
     OLE0541P7E   03   42 53
     O                         TITL      61
     O        E   05   42 53
     O                                   19 'REFERENCE LE0541-3'
     O                                   51 'DATE'
     O                         RUNA      59
     O                                   66 'PAGE'
     O                         PAGE3 3   70
     O        E   07   42 53
     O                       88           7 'BRANCH'
     O                       88BRCA      11
     O                                   40 'FACILITY FEE PAYMENT '
     O                                   46 'TELEX'
     O                 U2                70 '**  TELEX GENERATED  **'
     O        E   08   42 53
     O                                   40 '--------------------'
     O                                   46 '------'
     O        E 21     42
     O                                   10 'CUSTOMER'
     O                         BBCNA1    46
     O                                   47 'TELEX NO'
     O                         TELX      60
     O        E  1     42
     O                         BBCNA2    46
     O        E  1     42
     O                         BBCNA3    46
     O        E  1     42
     O                         BBCNA4    46
     O        E  1     42
     O                         CNUM      17
     O**********                         49 'OUR REF: F'                                      235743
     O                                   49 'FACILITY: '                                      235743
     O                         FTYP      52
     O                         FSEQ      54
     O        E 11     42
     O                         NAR,1     65
     O                                   54 'CCY'
     O                         CCNM      69
     O        E 11     42
     O                                   10 'DUE DATE'
     O                         VDATA     19
     O                                   38 'FEES DUE'
     O                       60INTA      57 ' ,   ,   ,   , 0 '
     O                       61INTA      57 '   ,   ,   , 0 . '
     O                       62INTA      57 '  ,   ,   , 0 .  '
     O                       63INTA      57 ' ,   ,   , 0 .   '
      *                                                                   160659
      ** Output the settlement currency and converted INTA amount.        160659
      *                                                                   160659
     O        E 11     42 78                                              160659
     O                                   15 'SETT CURRENCY'               160659
     O                         SCCY      19                               160659
     O                                   38 'CONVERTED AMT'               160659
     O                       83WKINTA    57 ' ,   ,   ,   , 0 '           160659
     O                       84WKINTA    57 '   ,   ,   , 0 . '           160659
     O                       85WKINTA    57 '  ,   ,   , 0 .  '           160659
     O                       86WKINTA    57 ' ,   ,   , 0 .   '           160659
      *                                                                   160659
     O        E 11     42
     O                         NAR,3     65
     O        E  1     42
     O                         NAR,4     65
     O        E  2     42
     O                         NAR,5     65
      *
      **  LOAN FEE TELEXES
      *
     OLE0541P7E   03   82 53
     O                         TITL      61
     O        E   05   82 53
     O                                   19 'REFERENCE LE0541-3'
     O                                   51 'DATE'
     O                         RUNA      59
     O                                   66 'PAGE'
     O                         PAGE3 3   70
     O        E   07   82 53
     O                       88           7 'BRANCH'
     O                       88BRCA      11
     O                                   40 'LOAN FEE PAYMENT TELEX'
     O                 U2                70 '**  TELEX GENERATED  **'
     O        E   08   82 53
     O                                   40 '----------------------'
     O        E 21     82
     O                                   10 'CUSTOMER'
     O                         BBCNA1    46
     O                                   47 'TELEX NO'
     O                         TELX      60
     O        E  1     82
     O                         BBCNA2    46
     O        E  1     82
     O                         BBCNA3    46
     O        E  1     82
     O                         BBCNA4    46
     O        E  1     82
     O                         CNUM      17
     O**********                         49 'OUR REF: '                                       235743
     O                                   49 'LOAN NUMBER: '                                   235743
     O                         LNRF      56
     O        E 11     82
     O                         NAR,1     65
     O                                   54 'CCY'
     O                         CCNM      69
     O        E 11     82
     O                                   10 'DUE DATE'
     O                         VDATA     19
     O                                   38 'FEES DUE'
     O                       60INTA      57 ' ,   ,   ,   , 0 '
     O                       61INTA      57 '   ,   ,   , 0 . '
     O                       62INTA      57 '  ,   ,   , 0 .  '
     O                       63INTA      57 ' ,   ,   , 0 .   '
      *                                                                   160659
      ** Output the settlement currency and converted INTA amount.        160659
      *                                                                   160659
     O        E 11     82 78                                              160659
     O                                   15 'SETT CURRENCY'               160659
     O                         SCCY      19                               160659
     O                                   38 'CONVERTED AMT'               160659
     O                       83WKINTA    57 ' ,   ,   ,   , 0 '           160659
     O                       84WKINTA    57 '   ,   ,   , 0 . '           160659
     O                       85WKINTA    57 '  ,   ,   , 0 .  '           160659
     O                       86WKINTA    57 ' ,   ,   , 0 .   '           160659
      *                                                                   160659
     O        E 11     82
     O                         NAR,3     65
     O        E  1     82
     O                         NAR,4     65
     O        E  2     82
     O                         NAR,5     65
      *
     O        T   03   L1 80
     O                         TITL      61
     O        T   05   L1 80
     O                                   19 'REFERENCE LE0541-3'
     O                                   51 'DATE'
     O                         RUNA      59
     O                                   65 'PAGE'
     O                         PAGE3 3   70
     O        T   07   L1 80
     O                                   39 'FACILITY & LOAN FEE'
     O                                   55 'PAYMENT TELEXES'
     O        T   08   L1 80
     O                                   39 '-------------------'
     O                                   55 '---------------'
     O        T   09   L1 88 80
     O                                   12 'BRANCH'
     O                         BRCA      16
     O                         BRNM      48
     O        T   11   L1 80
     O                                   28 'NUMBER OF TELEXES ON THI'
     O                                   36 'S REPORT'
     O                         NOTL3 3   42
     O        T 3      L1 80
     O                 88                36 '*** END OF REPORT FOR'
     O                 88                44 ' BRANCH '
     O                 88      BRCA      47
     O                 88                51 ' ***'
     O                N88                46 '*** END OF REPORT ***'
     O        T   10   LR U7 80
     O                                   31 '*** REFERENCE LE0541'
     O                                   51 '- DATABASE ERROR -'
      *
      **   OUTPUT TO TELEX FILE - FACILITY FEE
     OLEBTX3  EADD     42 U2
     O                                    1 'D'
     O                         BRCA       4
     O                         CNUM      10
     O                                   12 'CF'
     O                         TXDATE    18
     O                         CCY       21
     O                         FTYP      24
     O                                   25 '/'
     O                         FSEQ      27
     O                                   28 'T'
     O                                   29 'C'
     O                                   70 'I'
     O                         BRCA      73
     O        EADD     42 U2
     O                                    2 'TO'
     O                         CRNM      23
     O                         CTWN      34
     O                         CNUM      41
     O                         BRCA      73
     O        EADD     42 U2
     O                                   22 'FACILITY FEE PAYMENT'
     O                                   28 'TELEX'
     O                                   47 'OUR REF'
     O                         FTYP      51
     O                                   52 '/'
     O                         FSEQ      54
     O                                   59 'DATE'
     O                         RUNA      67
     O                         BRCA      73
     O        EADD     42 U2
     O                         NAR,1     65
     O                                   54 'CCY'
     O                         CCNM      69
     O                         BRCA      73
     O        EADD     42 U2
     O                                   10 'DUE DATE'
     O                         VDATA     19
     O                                   38 'FEES DUE'
     O                       60INTA      57 ' ,   ,   ,   , 0 '
     O                       61INTA      57 '   ,   ,   , 0 . '
     O                       62INTA      57 '  ,   ,   , 0 .  '
     O                       63INTA      57 ' ,   ,   , 0 .   '
     O                         BRCA      73
     O        EADD     42 U2
     O                         NAR,3     65
     O                         BRCA      73
     O        EADD     42 U2
     O                         NAR,4     65
     O                         BRCA      73
     O        EADD     42 U2
     O                         NAR,5     65
     O                                   70 '*'
     O                         BRCA      73
      *
      **   OUTPUT TO TELEX FILE - LOAN FEE
     OLEBTX3  EADD     82 U2
     O                                    1 'D'
     O                         BRCA       4
     O                         CNUM      10
     O                                   12 'CB'
     O                         TXDATE    18
     O                         CCY       21
     O                         LNRF      27
     O                                   28 'T'
     O                                   29 'C'
     O                                   70 'I'
     O                         BRCA      73
     O        EADD     82 U2
     O                                    2 'TO'
     O                         CRNM      23
     O                         CTWN      34
     O                         CNUM      41
     O                         BRCA      73
     O        EADD     42 U2
     O                                   22 'LOAN FEE PAYMENT TELEX'
     O                                   47 'OUR REF'
     O                         LNRF      54
     O                                   59 'DATE'
     O                         RUNA      67
     O                         BRCA      73
     O        EADD     42 U2
     O                         NAR,1     65
     O                                   54 'CCY'
     O                         CCNM      69
     O                         BRCA      73
     O        EADD     42 U2
     O                                   10 'DUE DATE'
     O                         VDATA     19
     O                                   38 'FEES DUE'
     O                       60INTA      57 ' ,   ,   ,   , 0 '
     O                       61INTA      57 '   ,   ,   , 0 . '
     O                       62INTA      57 '  ,   ,   , 0 .  '
     O                       63INTA      57 ' ,   ,   , 0 .   '
     O                         BRCA      73
     O        EADD     42 U2
     O                         NAR,3     65
     O                         BRCA      73
     O        EADD     42 U2
     O                         NAR,4     65
     O                         BRCA      73
     O        EADD     42 U2
     O                         NAR,5     65
     O                                   70 '*'
     O                         BRCA      73
      *
      **   INTEREST PAYMENT TELEX
      *
     OLE0541P6E   03   44 70
     O                         TITL      61
     O        E   05   44 70
     O                                   19 'REFERENCE LE0541-2'
     O                                   51 'DATE'
     O                         RUNA      59
     O                                   65 'PAGE'
     O                         PAGE2 3   70
     O        E   07   44 70
     O                       88           7 'BRANCH'
     O                       88BRCA      11
     O                                   43 'LOAN PAYMENT TELEX'
     O                 U2                70 '**  TELEX GENERATED  **'
     O        E   08   44 70
     O                                   43 '------------------'
     O        E 21     44
     O                                   10 'CUSTOMER'
     O                         BBCNA1    46
     O                                   47 'TELEX NO'
     O                         TELX      60
     O        E  1     44
     O                         BBCNA2    46
     O        E  1     44
     O                         BBCNA3    46
     O        E  1     44
     O                         BBCNA4    46
     O        E  1     44
     O                         CNUM      17
     O**********                         47 'OUR REF:'                                        235743
     O                                   47 'LOAN NUMBER:'                                    235743
     O                         LNRF      54
     O        E 11     44
     O                         NAR,2     65
     O                                   54 'CCY'
     O                         CCNM      69
     O        E 11     44
     O                         NAR,6     65
     O        E 11     44
     O                      N73          12 'BALANCE AT'
     O                       73          12 'B/FWD AT'
     O                         VDATA     20
     O                       60PRAMO     37 '           0 CR'
     O                       61PRAMO     37 '          0 . CR'
     O                       62PRAMO     37 '         0 .  CR'
     O                       63PRAMO     37 '        0 .   CR'
     O                                   51 'INTEREST DUE'
     O                       60INTO      69 '           0 CR'
     O                       61INTO      69 '          0 . CR'
     O                       62INTO      69 '         0 .  CR'
     O                       63INTO      69 '        0 .   CR'
     O        E 11     44
     O                                   16 'LOAN MOVEMENTS:'
     O        E 11     47
     O                         NARTP     12
     O                         VDATA     20
     O                   N64 60MAMT      37 '           0 CR'
     O                   N64 61MAMT      37 '          0 . CR'
     O                   N64 62MAMT      37 '         0 .  CR'
     O                   N64 63MAMT      37 '        0 .   CR'
     O                   N65 64MAMTR     35 '  0 .       '
     O                N65 64 52          36 '-'
     O                                   43 'RATE'                                            235743
     O                         ORATE     56 '  0 .       -'                                   235743
     O                                   63 'DAYS'                                            235743
     O                         SDAY  3   67                                                   235743
      *-------------------------------------------------------------------CEU004
      ** Output the settlement currency and converted MAMT amount.        CEU004
      *                                                                   CEU004
     O        E  1     47 28                                                                  235743
     O                                   13 'SETT CURRENCY'               CEU004
     O                         SCCY      17                               CEU004
     O                 28N64 60WKMAMT    37 '           0 CR'             CEU004
     O                 28N64 61WKMAMT    37 '          0 . CR'            CEU004
     O                 28N64 62WKMAMT    37 '         0 .  CR'            CEU004
     O                 28N64 63WKMAMT    37 '        0 .   CR'            CEU004
     O                 28 64 52          36 '-'                           CEU004
      *-------------------------------------------------------------------CEU004
     O**********                         43 'RATE'                                            235743
     O**********               ORATE     56 '  0 .       -'                                   235743
     O**********                         63 'DAYS'                                            235743
     O**********               SDAY  3   67                                                   235743
     O        E  1     47
     O                                   20 'BALANCE'
     O                       60PRAMO     37 '           0 CR'
     O                       61PRAMO     37 '          0 . CR'
     O                       62PRAMO     37 '         0 .  CR'
     O                       63PRAMO     37 '        0 .   CR'
     O                                   51 'INTEREST DUE'
     O                       60INTO      69 '           0 CR'
     O                       61INTO      69 '          0 . CR'
     O                       62INTO      69 '         0 .  CR'
     O                       63INTO      69 '        0 .   CR'
     O        E 1      55
     O                                   12 'C/FWD AT'
     O                         VDATA     20
     O                       60PRAMO     37 '           0 CR'
     O                       61PRAMO     37 '          0 . CR'
     O                       62PRAMO     37 '         0 .  CR'
     O                       63PRAMO     37 '        0 .   CR'
     O                                   51 'INTEREST DUE'
     O                       60INTO      69 '           0 CR'
     O                       61INTO      69 '          0 . CR'
     O                       62INTO      69 '         0 .  CR'
     O                       63INTO      69 '        0 .   CR'
     O        E 11     51
     O                                   11 'REPAY. DUE'
     O                         VDATA     19
     O        E 11     51
     O                N26                16 'PRINCIPAL'
     O**********      N26    60PRAM      35 '           0 '                                   235743
     O**********      N26    61PRAM      35 '          0 . '                                  235743
     O**********      N26    62PRAM      35 '         0 .  '                                  235743
     O**********      N26    63PRAM      35 '        0 .   '                                  235743
     O                N26    60PRAM      35 ' ,   ,   ,   , 0 '                               235743
     O                N26    61PRAM      35 '   ,   ,   , 0 . '                               235743
     O                N26    62PRAM      35 '  ,   ,   , 0 .  '                               235743
     O                N26    63PRAM      35 ' ,   ,   , 0 .   '                               235743
     O        E  1     51
     O                                   15 'INTEREST'
     O**********             60INTA      37 '           0 CR'                                 235743
     O**********             61INTA      37 '          0 . CR'                                235743
     O**********             62INTA      37 '         0 .  CR'                                235743
     O**********             63INTA      37 '        0 .   CR'                                235743
     O                       60INTA      37 ' ,   ,   ,   , 0 CR'                             235743
     O                       61INTA      37 '   ,   ,   , 0 . CR'                             235743
     O                       62INTA      37 '  ,   ,   , 0 .  CR'                             235743
     O                       63INTA      37 ' ,   ,   , 0 .   CR'                             235743
     O        E  1     51N20
     O                                   20 'W/HOLDING TAX'
     O**********             60WTXA      35 '           0 '                                   235743
     O**********             61WTXA      35 '          0 . '                                  235743
     O**********             62WTXA      35 '         0 .  '                                  235743
     O**********             63WTXA      35 '        0 .   '                                  235743
     O                       60WTXA      35 ' ,   ,   ,   , 0 '                               235743
     O                       61WTXA      35 '   ,   ,   , 0 . '                               235743
     O                       62WTXA      35 '  ,   ,   , 0 .  '                               235743
     O                       63WTXA      35 ' ,   ,   , 0 .   '                               235743
     O                                   43 'RATE'
     O                         WTRT      56 '  0 .       '
     O                         WTTYP     69
     O        E 1      51
     O                                   16 'TOTAL DUE'
     O**********             60TAMT      37 '           0 CR'                                 235743
     O**********             61TAMT      37 '          0 . CR'                                235743
     O**********             62TAMT      37 '         0 .  CR'                                235743
     O**********             63TAMT      37 '        0 .   CR'                                235743
     O                       60TAMT      37 ' ,   ,   ,   , 0 CR'                             235743
     O                       61TAMT      37 '   ,   ,   , 0 . CR'                             235743
     O                       62TAMT      37 '  ,   ,   , 0 .  CR'                             235743
     O                       63TAMT      37 ' ,   ,   , 0 .   CR'                             235743
     O        E 11     51
     O                       77NAR,16    65
     O        T   03   L1 80
     O                         TITL      61
     O        T   05   L1 80
     O                                   19 'REFERENCE LE0541-2'
     O                                   51 'DATE'
     O                         RUNA      59
     O                                   65 'PAGE'
     O                         PAGE2 3   70
     O        T   07   L1 80
     O                                   44 'LOAN PAYMENT TELEXES'
     O        T   08   L1 80
     O                                   44 '--------------------'
     O        T   09   L1 88 80
     O                                   12 'BRANCH'
     O                         BRCA      16
     O                         BRNM      48
     O        T   11   L1 80
     O                                   28 'NUMBER OF TELEXES ON THI'
     O                                   36 'S REPORT'
     O                         NOTL2 3   42
     O        T 3      L1 80
     O                 88                36 '*** END OF REPORT FOR'
     O                 88                44 ' BRANCH '
     O                 88      BRCA      47
     O                 88                51 ' ***'
     O                N88                46 '*** END OF REPORT ***'
     O        T   10   LR U7 80
     O                                   31 '*** REFERENCE LE0541'
     O                                   51 '- DATABASE ERROR -'
      *
      **   OUTPUT TO TELEX FILE - INTEREST PAYMENT
     OLEBTX2  EADD     44 U2
     O                                    1 'D'
     O                         BRCA       4
     O                         CNUM      10
     O                         PTYP      12
     O                         TXDATE    18
     O                         CCY       21
     O                         LNRF      27
     O                                   28 'I'
     O                                   29 'C'
     O                                   70 'I'
     O                         BRCA      73
     O        EADD     44 U2
     O                                    2 'TO'
     O                         CRNM      23
     O                         CTWN      34
     O                         CNUM      41
     O                         BRCA      73
     O        EADD     44 U2
     O                                   20 'LOAN PAYMENT TELEX'
     O                                   47 'OUR REF'
     O                         LNRF      54
     O                                   59 'DATE'
     O                         RUNA      67
     O                         BRCA      73
     O        EADD     44 U2
     O                         NAR,2     65
     O                                   54 'CCY'
     O                         CCNM      69
     O                         BRCA      73
     O        EADD     44 U2
     O                         NAR,6     65
     O                         BRCA      73
     O        EADD     44 U2
     O                      N73          11 'BALANCE AT'
     O                       73          11 'B/FWD AT'
     O                         VDATA     19
     O                       60PRAMO     37 '           0 CR'
     O                       61PRAMO     37 '          0 . CR'
     O                       62PRAMO     37 '         0 .  CR'
     O                       63PRAMO     37 '        0 .   CR'
     O                                   51 'INTEREST DUE'
     O                       60INTO      69 '           0 CR'
     O                       61INTO      69 '          0 . CR'
     O                       62INTO      69 '         0 .  CR'
     O                       63INTO      69 '        0 .   CR'
     O                         BRCA      73
     O        EADD     44 U2
     O                                   16 'LOAN MOVEMENTS:'
     O                         BRCA      73
     O        EADD     47 U2
     O                         AMTP      10
     O                         VDATA     19
     O                   N64 60MAMT      37 '           0 CR'
     O                   N64 61MAMT      37 '          0 . CR'
     O                   N64 62MAMT      37 '         0 .  CR'
     O                   N64 63MAMT      37 '        0 .   CR'
     O                   N65 64MAMTR     35 '  0 .       '
     O                N65 64 52          36 '-'
     O                                   43 'RATE'
     O                         ORATE     56 '  0 .       -'
     O                                   63 'DAYS'
     O                         SDAY  3   67
     O                         BRCA      73
     O        EADD     47 U2
     O                                   19 'BALANCE'
     O                       60PRAMO     37 '           0 CR'
     O                       61PRAMO     37 '          0 . CR'
     O                       62PRAMO     37 '         0 .  CR'
     O                       63PRAMO     37 '        0 .   CR'
     O                                   51 'INTEREST DUE'
     O                       60INTO      69 '           0 CR'
     O                       61INTO      69 '          0 . CR'
     O                       62INTO      69 '         0 .  CR'
     O                       63INTO      69 '        0 .   CR'
     O                         BRCA      73
     O        EADD     55 U2
     O                                   11 'C/FWD AT'
     O                         VDATA     19
     O                       60PRAMO     37 '           0 CR'
     O                       61PRAMO     37 '          0 . CR'
     O                       62PRAMO     37 '         0 .  CR'
     O                       63PRAMO     37 '        0 .   CR'
     O                                   51 'INTEREST DUE'
     O                       60INTO      69 '           0 CR'
     O                       61INTO      69 '          0 . CR'
     O                       62INTO      69 '         0 .  CR'
     O                       63INTO      69 '        0 .   CR'
     O                         BRCA      73
     O        EADD     51 U2
     O                                   11 'REPAY. DUE'
     O                         VDATA     19
     O                         BRCA      73
     O        EADD     51 U2
     O                                   16 'PRINCIPAL'
     O                       60PRAM      35 '           0 '
     O                       61PRAM      35 '          0 . '
     O                       62PRAM      35 '         0 .  '
     O                       63PRAM      35 '        0 .   '
     O                         BRCA      73
     O        EADD     51 U2
     O                                   15 'INTEREST'
     O                       60INTA      37 '           0 CR'
     O                       61INTA      37 '          0 . CR'
     O                       62INTA      37 '         0 .  CR'
     O                       63INTA      37 '        0 .   CR'
     O                         BRCA      73
     O        EADD     51N20 U2
     O                                   20 'W/HOLDING TAX'
     O                       60WTXA      35 '           0 '
     O                       61WTXA      35 '          0 . '
     O                       62WTXA      35 '         0 .  '
     O                       63WTXA      35 '        0 .   '
     O                                   43 'RATE'
     O                         WTRT      56 '  0 .       '
     O                         WTTYP     69
     O                         BRCA      73
     O        EADD     51 U2
     O                                   16 'TOTAL DUE'
     O                       60TAMT      37 '           0 CR'
     O                       61TAMT      37 '          0 . CR'
     O                       62TAMT      37 '         0 .  CR'
     O                       63TAMT      37 '        0 .   CR'
     O                         BRCA      73
     O        EADD     51 U2
     O                       77NAR,16    65
     O                                   70 '*'
     O                         BRCA      73
      *
      **   PAYMENT TELEXES
      *
     OLE0541P5E   03   49 53
     O                         TITL      61
     O        E   05   49 53
     O                                   19 'REFERENCE LE0541-1'
     O                                   51 'DATE'
     O                         RUNA      59
     O                                   65 'PAGE'
     O                         PAGE1 3   70
     O        E   07   49 53
     O                       88           7 'BRANCH'
     O                       88BRCA      11
     O                                   43 'LOAN PAYMENT TELEX'
     O                 U2                70 '**  TELEX GENERATED  **'
     O        E   08   49 53
     O                                   43 '------------------'
     O        E 21     49
     O                                   10 'CUSTOMER'
     O                         BBCNA1    46
     O                                   47 'TELEX NO'
     O                         TELX      60
     O        E  1     49
     O                         BBCNA2    46
     O        E  1     49
     O                         BBCNA3    46
     O        E  1     49
     O                         BBCNA4    46
     O        E  1     49
     O                         CNUM      17
     O**********                         47 'OUR REF:'                                        235743
     O                                   47 'LOAN NUMBER:'                                    235743
     O                         LNRF      54
     O        E 11     49
     O                         NAR,2     65
     O                                   54 'CCY'
     O                         CCNM      69
     O        E  1     49
     O                       77NAR,16    65
     O        E  1     49
     O                                   10 'DUE DATE'
     O                         VDATA     19
     O                                   38 'PRINCIPAL DUE'
     O                       60PRAM      57 ' ,   ,   ,   , 0 '
     O                       61PRAM      57 '   ,   ,   , 0 . '
     O                       62PRAM      57 '  ,   ,   , 0 .  '
     O                       63PRAM      57 ' ,   ,   , 0 .   '
      *-------------------------------------------------------------------CEU004
      ** Output the settlement currency and converted PRAM amount.        CEU004
      *                                                                   CEU004
     O********E* 1     27                                                              CEU004 235743
     O        E  1     27 49                                                                  235743
     O                                   21 'SETTLEMENT CURRENCY'         CEU004
     O                         SCCY      25                               CEU004
     O                                   39 'CONVERTED AMT'               CEU004
     O                       60WKPRAM    57 ' ,   ,   ,   , 0 '           CEU004
     O                       61WKPRAM    57 '   ,   ,   , 0 . '           CEU004
     O                       62WKPRAM    57 '  ,   ,   , 0 .  '           CEU004
     O                       63WKPRAM    57 ' ,   ,   , 0 .   '           CEU004
      *-------------------------------------------------------------------CEU004
     O        E 11     49
     O                         NAR,3     65
     O        E  1     49
     O                         NAR,4     65
     O        E  2     49
     O                         NAR,5     65
     O        T   03   L1 80
     O                         TITL      61
     O        T   05   L1 80
     O                                   19 'REFERENCE LE0541-1'
     O                                   51 'DATE'
     O                         RUNA      59
     O                                   65 'PAGE'
     O                         PAGE1 3   70
     O        T   07   L1 80
     O                                   44 'LOAN PAYMENT TELEXES'
     O        T   08   L1 80
     O                                   44 '--------------------'
     O        T   09   L1 88 80
     O                                   12 'BRANCH'
     O                         BRCA      16
     O                         BRNM      48
     O        T   11   L1 80
     O                                   28 'NUMBER OF TELEXES ON THI'
     O                                   36 'S REPORT'
     O                         NOTL1 3   42
     O        T 3      L1 80
     O                 88                36 '*** END OF REPORT FOR'
     O                 88                44 ' BRANCH '
     O                 88      BRCA      47
     O                 88                51 ' ***'
     O                N88                46 '*** END OF REPORT ***'
     O        T   10   LR U7 80
     O                                   31 '*** REFERENCE LE0541'
     O                                   51 '- DATABASE ERROR -'
      *
      **   OUTPUT TO TELEX FILE - LOAN PAYMENT
     OLEBTX1  EADD     49 U2
     O                                    1 'D'
     O                         BRCA       4
     O                         CNUM      10
     O                         PTYP      12
     O                         TXDATE    18
     O                         CCY       21
     O                         LNRF      27
     O                       49          28 'M'
     O                                   29 'C'
     O                                   70 'I'
     O                         BRCA      73
     O        EADD     49 U2
     O                                    2 'TO'
     O                         CRNM      23
     O                         CTWN      34
     O                         CNUM      41
     O                         BRCA      73
     O        EADD     49 U2
     O                                   20 'LOAN PAYMENT TELEX'
     O                                   47 'OUR REF'
     O                         LNRF      54
     O                                   59 'DATE'
     O                         RUNA      67
     O                         BRCA      73
     O        EADD     49 U2
     O                         NAR,2     65
     O                                   54 'CCY'
     O                         CCNM      69
     O                         BRCA      73
     O        EADD     49 U2
     O                       77NAR,16    65
     O                         BRCA      73
     O        EADD     49 U2
     O                                   10 'DUE DATE'
     O                         VDATA     19
     O                                   38 'PRINCIPAL DUE'
     O                       60PRAM      57 ' ,   ,   ,   , 0 '
     O                       61PRAM      57 '   ,   ,   , 0 . '
     O                       62PRAM      57 '  ,   ,   , 0 .  '
     O                       63PRAM      57 ' ,   ,   , 0 .   '
     O                         BRCA      73
     O        EADD     49 U2
     O                         NAR,3     65
     O                         BRCA      73
     O        EADD     49 U2
     O                         NAR,4     65
     O                         BRCA      73
     O        EADD     49 U2
     O                         NAR,5     65
     O                                   70 '*'
     O                         BRCA      73
      *
      **   AMENDMENT NOTIFICATION BILL
      *
     OLE0541P4E   10   67 30
     O       AND       88
     O                         BRNM      60
     O        E   12   67
     O                                    9 'DATE'
     O                         RUNA      18
     O        E   18   67
     O                       74NAR,7     68
     O                       75NAR,8     68
     O                       76NAR,9     68
     O                       74          76 ' NUMBER -'
     O                       75          69 ' NUMBER -'
     O                       76          63 ' NUMBER -'
     O                       74LNRF      83
     O                       75LNRF      76
     O                       76LNRF      70
     O        E   19   67
     O                         NAR,10    68
     O        E   21   67
     O                         NAR,11    68
     O        E   22   67
     O                         NAR,12    68
     O/COPY WNCPYSRC,LE0541O001
     O        E   36   67
     O                         CNA1      45
     O        E   37   67
     O                         CNA2      45
     O        E   38   67
     O                         CNA3      45
     O        E   39   67
     O                         CNA4      45
     O                                   78 '--------------------'
     O        E   40   67
     O                                   78 'AUTHORIZED SIGNATURE'
     O/COPY WNCPYSRC,LE0541O002
     O        T   10   LR U7 80
     O                                   41 '*** REFERENCE LE0541'
     O                                   61 '- DATABASE ERROR -'
      *
     OLE0541P8T   10   L1 80
     O                                    9 'LE0541-8'
     O                         TITL      68
     O                         RUNA      79
     O        T   12   L1 80
     O                                   54 'LOAN PAYMENT BILLS'
     O        T   13   L1 80
     O                                   54 '------------------'
     O        T   14   L1 88 80
     O                                   12 'BRANCH'
     O                         BRCA      16
     O                         BRNM      48
     O        T   16   L1 80
     O                                   32 'NUMBER OF BILLS ON THIS'
     O                                   39 'REPORT'
     O                         NOBL4 3   45
      *
      **   FACILITY FEE BILLS
      *
     OLE0541P3E   10   41 30
     O       AND       88
     O                         BRNM      60
     O        E   12   41
     O                                    9 'DATE'
     O                         RUNA      18
     O                                   62 'CURRENCY'
     O                         CCNM      83
     O        E   18   41
     O                         NAR,1     68
     O                                   61 ' NUMBER -'
     O                         FTYP      65
     O                                   66 '/'
     O                         FSEQ      68
     O        E   23   41
     O                                   30 'DUE DATE'
     O                         VDATA     39
     O                                   62 'FEES DUE'
     O                       60INTA      79 '           0 '
     O                       61INTA      79 '          0 . '
     O                       62INTA      79 '         0 .  '
     O                       63INTA      79 '        0 .   '
      *                                                                   160659
      ** Output the settlement currency and converted INTA amount.        160659
      *                                                                   160659
     O        E   25   41 78                                              160659
     O                                   35 'SETT CURRENCY'               160659
     O                         SCCY      39                               160659
     O                                   61 'CONVERTED AMT'               160659
     O                       83WKINTA    79 ' ,   ,   ,   , 0 '           160659
     O                       84WKINTA    79 '   ,   ,   , 0 . '           160659
     O                       85WKINTA    79 '  ,   ,   , 0 .  '           160659
     O                       86WKINTA    79 ' ,   ,   , 0 .   '           160659
      *                                                                   160659
     O/COPY WNCPYSRC,LE0541O003
     O        E   36   41
     O                         CNA1      45
     O        E   37   41
     O                         CNA2      45
     O        E   38   41
     O                         CNA3      45
     O        E   39   41
     O                         CNA4      45
     O                                   78 '--------------------'
     O        E   40   41
     O                                   78 'AUTHORIZED SIGNATURE'
     O/COPY WNCPYSRC,LE0541O004
      *
      **   LOAN FEE BILLS
      *
     OLE0541P3E   10   81 30
     O       AND       88
     O                         BRNM      60
     O        E   12   81
     O                                    9 'DATE'
     O                         RUNA      18
     O                                   62 'CURRENCY'
     O                         CCNM      83
     O        E   18   81
     O                         NAR,1     68
     O                                   61 ' NUMBER -'
     O                         LNRF      68
     O        E   23   81
     O                                   30 'DUE DATE'
     O                         VDATA     39
     O                                   62 'FEES DUE'
     O                       60INTA      79 '           0 '
     O                       61INTA      79 '          0 . '
     O                       62INTA      79 '         0 .  '
     O                       63INTA      79 '        0 .   '
      *                                                                   160659
      ** Output the settlement currency and converted INTA amount.        160659
      *                                                                   160659
     O        E   25   81 78                                              160659
     O                                   35 'SETTLEMENT CURR'             160659
     O                         SCCY      39                               160659
     O                                   61 'CONVERTED AMT'               160659
     O                       83WKINTA    79 ' ,   ,   ,   , 0 '           160659
     O                       84WKINTA    79 '   ,   ,   , 0 . '           160659
     O                       85WKINTA    79 '  ,   ,   , 0 .  '           160659
     O                       86WKINTA    79 ' ,   ,   , 0 .   '           160659
     O/COPY WNCPYSRC,LE0541O005
     O        E   36   81
     O                         CNA1      45
     O        E   37   81
     O                         CNA2      45
     O        E   38   81
     O                         CNA3      45
     O        E   39   81
     O                         CNA4      45
     O                                   78 '--------------------'
     O        E   40   81
     O                                   78 'AUTHORIZED SIGNATURE'
     O/COPY WNCPYSRC,LE0541O006
     O        T   10   LR U7 80
     O                                   41 '*** REFERENCE LE0541'
     O                                   61 '- DATABASE ERROR -'
      *
     OLE0541P8T   10   L1 80
     O                                    9 'LE0541-6'
     O                         TITL      68
     O                         RUNA      79
     O        T   12   L1 80
     O                                   50 'FACILITY & LOAN FEE'
     O                                   64 'PAYMENT BILLS'
     O        T   13   L1 80
     O                                   50 '-------------------'
     O                                   64 '-------------'
     O        T   14   L1 88 80
     O                                   12 'BRANCH'
     O                         BRCA      16
     O                         BRNM      48
     O        T   16   L1 80
     O                                   32 'NUMBER OF BILLS ON THIS'
     O                                   39 'REPORT'
     O                         NOBL3 3   45
      *
      **   INTEREST PAYMENT DETAILS
      *
      /COPY WNCPYSRC,LE0541O011                                                               GOC003
     OLE0541P2E   10   43
     O                                    6 'PAGE'
     O                         PGNO  3   10
     O                    88 30BRNM      60
     O        E   12   43
     O                                    6 'DATE'
     O                         RUNA      15
     O                                   62 'CURRENCY'
     O                         CCNM      80
     O        E   14   43
     O                         NAR,2     68
     O                                   55 ' NUMBER -'
     O*********                LNRF      62                                                 BUG13341
     O                         LNRFP     62                                                 BUG13341
     O                       73          74 'CONTINUED'
     O**********E   15   43 77                                                                239714
     O**********               NAR,13    68                                                   239714
     O        E   16   43
     O                         NAR,6     68
     O        E   18   43
     O                                   25 'VALUE  ------M O V E M E'
     O                                   35 'N T------'
     O                                   47 'LOAN'
     O                                   76 '----------I N T E R E S'
     O                                   88 ' T----------'
     O        E   19   43
     O                                   19 'DATE  DESCRIPTION'
     O                                   35 'RATE/AMOUNT'
     O                                   49 'BALANCE'
     O                                   74 'RATE       BASIS DAYS'
     O                                   88 'ACCRUAL'
     O        E   21   43
     O                         VDATA      7
     O                      N71          19 'B/F BALANCE'
     O                       71          23 'OPENING BALANCE'
     O                       60PRAMO     52 '           0 -'
     O                       61PRAMO     52 '          0 . -'
     O                       62PRAMO     52 '         0 .  -'
     O                       63PRAMO     52 '        0 .   -'
     O                         ORATE     66 '  0 .       -'
     O        E 1      68
     O                         VDATA      7
     O                         NARTP     19
     O                   N64 60MAMT      36 '           0 -'
     O                   N64 61MAMT      36 '          0 . -'
     O                   N64 62MAMT      36 '         0 .  -'
     O                   N64 63MAMT      36 '        0 .   -'
     O                   N65 64MAMTR     36 '  0 .       -'
     O                       60PRAMO     52 '           0 -'
     O                       61PRAMO     52 '          0 . -'
     O                       62PRAMO     52 '         0 .  -'
     O                       63PRAMO     52 '        0 .   -'
     O                         ORATE     66 '  0 .       -'
     O**********               BASIS     68                                                   CLE028
     O**********               SDAY  3   73                                                   CLE028
     O                N21      BASIS     68                                                   CLE028
     O                N21      SDAY  3   73                                                   CLE028
     O**********             60ACCI      89 '           0 -'                                  235743
     O**********             61ACCI      89 '          0 . -'                                 235743
     O**********             62ACCI      89 '         0 .  -'                                 235743
     O**********             63ACCI      89 '        0 .   -'                                 235743
     O        E 1      69
     O                                   71 'TOTAL ADJUSTMENT'
     O                       60TADJ      89 '           0 -'
     O                       61TADJ      89 '          0 . -'
     O                       62TADJ      89 '         0 .  -'
     O                       63TADJ      89 '        0 .   -'
     O********E*2     N43 71                                                                  235743
     O        E 2     N43 71N44                                                               235743
     O                         VDATA      7
     O                                   23 'OPENING BALANCE'
     O                       60PRAMO     52 '           0 -'
     O                       61PRAMO     52 '          0 . -'
     O                       62PRAMO     52 '         0 .  -'
     O                       63PRAMO     52 '        0 .   -'
     O                         ORATE     66 '  0 .       -'
      *
     O        E 1      46
     O                         VDATA      7
     O                         NARTP     19
     O                   N64 60MAMT      36 '           0 -'
     O                   N64 61MAMT      36 '          0 . -'
     O                   N64 62MAMT      36 '         0 .  -'
     O                   N64 63MAMT      36 '        0 .   -'
     O                   N65 64MAMTR     36 '  0 .       -'
     O                       60PRAMO     52 '           0 -'
     O                       61PRAMO     52 '          0 . -'
     O                       62PRAMO     52 '         0 .  -'
     O                       63PRAMO     52 '        0 .   -'
     O                         ORATE     66 '  0 .       -'
     O**********               BASIS     68                                                   CLE028
     O**********               SDAY  3   73                                                   CLE028
     O                N21      BASIS     68                                                   CLE028
     O                N21      SDAY  3   73                                                   CLE028
     O**********             60INTO      89 '           0 -'                                  235743
     O**********             61INTO      89 '          0 . -'                                 235743
     O**********             62INTO      89 '         0 .  -'                                 235743
     O**********             63INTO      89 '        0 .   -'                                 235743
     O                       60INTO1     89 '           0 -'                                  235743
     O                       61INTO1     89 '          0 . -'                                 235743
     O                       62INTO1     89 '         0 .  -'                                 235743
     O                       63INTO1     89 '        0 .   -'                                 235743
     O        E 1      72
     O                         VDATA      7
     O                         NARTP     19
     O                                   36 'NEW CURRENCY'
     O                         NCCY      41
      *-------------------------------------------------------------------CEU004
      ** Output the settlement currency and converted MAMT amount.        CEU004
      *                                                                   CEU004
     O********E*1      47                                                              CEU004 235743
     O        E 1      46 28                                                                  235743
     O                                   15 'SETT CURRENCY'               CEU004
     O                         SCCY      20                               CEU004
     O                 28N64 60WKMAMT    37 '           0 -'              CEU004
     O                 28N64 61WKMAMT    37 '          0 . -'             CEU004
     O                 28N64 62WKMAMT    37 '         0 .  -'             CEU004
     O                 28N64 63WKMAMT    37 '        0 .   -'             CEU004
      *-------------------------------------------------------------------CEU004
     O        E 1      54
     O                                   20 'CARRIED FWD'
     O                       60PRAMO     52 '           0 -'
     O                       61PRAMO     52 '          0 . -'
     O                       62PRAMO     52 '         0 .  -'
     O                       63PRAMO     52 '        0 .   -'
     O**********             60INTO      89 '           0 -'                                  235743
     O**********             61INTO      89 '          0 . -'                                 235743
     O**********             62INTO      89 '         0 .  -'                                 235743
     O**********             63INTO      89 '        0 .   -'                                 235743
     O                       60CFWD1     89 '           0 -'                                  235743
     O                       61CFWD1     89 '          0 . -'                                 235743
     O                       62CFWD1     89 '         0 .  -'                                 235743
     O                       63CFWD1     89 '        0 .   -'                                 235743
     O        E   29   50N26
     O                                   29 'PRINCIPAL'
     O                       60PRAM      51 '           0 '
     O                       61PRAM      51 '          0 . '
     O                       62PRAM      51 '         0 .  '
     O                       63PRAM      51 '        0 .   '
     O********E*  30   50                                                                     235743
     O        E   30   50N39                                                                  235743
     O                                   28 'INTEREST'
     O                       60INTA      53 '           0 CR'
     O                       61INTA      53 '          0 . CR'
     O                       62INTA      53 '         0 .  CR'
     O                       63INTA      53 '        0 .   CR'
     O********E*  31   50N20                                                                  235743
     O        E   31   50N20N39                                                               235743
     O                                   35 'WITHHOLDING TAX'
     O                       60WTXA      53 '           0 CR'
     O                       61WTXA      53 '          0 . CR'
     O                       62WTXA      53 '         0 .  CR'
     O                       63WTXA      53 '        0 .   CR'
     O                                   60 'RATE'
     O                         WTRT      73 '  0 .       '
     O                         WTTYP     84
     O        E   32   50
     O                                   29 'TOTAL DUE'
     O                       60TAMT      53 '           0 CR'
     O                       61TAMT      53 '          0 . CR'
     O                       62TAMT      53 '         0 .  CR'
     O                       63TAMT      53 '        0 .   CR'
     O********E*  33   50 77                                                                 239714A
     O        E   34   50 77                                                                 239714A
     O                         NAR,13    68
     O/COPY WNCPYSRC,LE0541O007
     O        E   36   50
     O                         CNA1      45
     O        E   37   50
     O                         CNA2      45
     O        E   38   50
     O                         CNA3      45
     O        E   39   50
     O                         CNA4      45
     O********E***36           DETAIL                                                  132738 209690
     O************             CNA1      45                                            132738 209690
     O********E***37           DETAIL                                                  132738 209690
     O************             CNA2      45                                            132738 209690
     O********E***38           DETAIL                                                  132738 209690
     O************             CNA3      45                                            132738 209690
     O********E***39           DETAIL                                                  132738 209690
     O************             CNA4      45                                            132738 209690
     O********E***39   50                                                              132738 209690
     O                                   78 '--------------------'
     O        E   40   50
     O                                   78 'AUTHORIZED SIGNATURE'
     O/COPY WNCPYSRC,LE0541O008
     O        T   10   LR U7 80
     O                                   41 '*** REFERENCE LE0541'
     O                                   61 '- DATABASE ERROR -'
      *
      /COPY WNCPYSRC,LE0541O012                                                               GOC003
     OLE0541P8T   10   L1 80
     O                                    9 'LE0541-5'
     O                         TITL      68
     O                         RUNA      79
     O        T   12   L1 80
     O                                   54 'LOAN PAYMENT BILLS'
     O        T   13   L1 80
     O                                   54 '------------------'
     O        T   14   L1 88 80
     O                                   12 'BRANCH'
     O                         BRCA      16
     O                         BRNM      48
     O        T   16   L1 80
     O                                   32 'NUMBER OF BILLS ON THIS'
     O                                   39 'REPORT'
     O                         NOBL2 3   45
      *
      **   PRINCIPAL PAYMENT BILLS
     O/COPY WNCPYSRC,LEH00873
      *
     OLE0541P1E   10   48 30
     O       AND       88
     O                         BRNM      60
     O        E   12   48
     O                                    9 'DATE'
     O                         RUNA      18
     O                                   62 'CURRENCY'
     O                         CCNM      83
     O        E   18   48
     O                         NAR,2     68
     O                                   55 ' NUMBER -'
     O                         LNRF      62
     O        E   19   48 77
     O                         NAR,13    68
     O        E   23   48
     O                                   38 'DUE DATE'
     O                         VDATA     47
     O                                   65 'PRINCIPAL DUE'
     O                       60PRAM      83 ' ,   ,   ,   , 0 '
     O                       61PRAM      83 '   ,   ,   , 0 . '
     O                       62PRAM      83 '  ,   ,   , 0 .  '
     O                       63PRAM      83 ' ,   ,   , 0 .   '
      *-------------------------------------------------------------------CEU004
      ** Output the settlement currency and converted PRAM amount.        CEU004
      *                                                                   CEU004
     O        E   24   48                                                 CEU004
     O                                   43 'SETTLEMENT CURR'             CEU004
     O                         SCCY      47                               CEU004
     O                                   65 'CONVERTED AMT'               CEU004
     O                       60WKPRAM    83 ' ,   ,   ,   , 0 '           CEU004
     O                       61WKPRAM    83 '   ,   ,   , 0 . '           CEU004
     O                       62WKPRAM    83 '  ,   ,   , 0 .  '           CEU004
     O                       63WKPRAM    83 ' ,   ,   , 0 .   '           CEU004
      *-------------------------------------------------------------------CEU004
     O/COPY WNCPYSRC,LE0541O009
     O        E   36   48
     O                         CNA1      45
     O        E   37   48
     O                         CNA2      45
     O        E   38   48
     O                         CNA3      45
     O        E   39   48
     O                         CNA4      45
     O                                   78 '--------------------'
     O        E   40   48
     O                                   78 'AUTHORIZED SIGNATURE'
     O/COPY WNCPYSRC,LE0541O010
     O        T   10   LR U7 80
     O                                   41 '*** REFERENCE LE0541'
     O                                   61 '- DATABASE ERROR -'
      *
     OLE0541P8T   10   L1 80
     O                                    9 'LE0541-4'
     O                         TITL      68
     O                         RUNA      79
     O        T   12   L1 80
     O                                   54 'LOAN PAYMENT BILLS'
     O        T   13   L1 80
     O                                   54 '------------------'
     O        T   14   L1 88 80
     O                                   12 'BRANCH'
     O                         BRCA      16
     O                         BRNM      48
     O        T   16   L1 80
     O                                   32 'NUMBER OF BILLS ON THIS'
     O                                   39 'REPORT'
     O                         NOBL1 3   45
      *
      **   CONTROL REPORT
      *
     OLE0541P8T   03   LR 59
     O                         TITL      61
     O        T 2      LR 59
     O                                   19 'REFERENCE LE0541AU'
     O                                   51 'DATE'
     O                         RUNA      59
     O                                   70 'PAGE    1'
     O        T 2      LR 59
     O                                   38 'CUSTOMER BILLS AND TELEX'
     O                                   56 'ES - FILE CONTROLS'
     O        T 1      LR 59
     O                                   38 '------------------------'
     O                                   56 '------------------'
     O        T 32     LR 59
     O                 U7                41 '*** REFERENCE LE0541'
     O                 U7                61 '- DATABASE ERROR AT'
     O                 U7      DBASE     65
     O        T        LR 59
     O                 U7                37 'FILENAME'
     O                 U7      DBFILE    46
     O                 U7                51 'KEY'
     O                 U7      DBKEY     81
     O        T 3      LR 59
     O                                   24 'S/SCUTX - RUN CONTROLS'
     O                                   50 'NUMBER'
     O        T 1      LR 59
     O                                   24 '----------------------'
     O                                   50 'OF RECORDS'
     O        T 2      LR 59
     O                                   25 'TOTAL RECORDS ON FILE'
     O                      NU7TOTREC3   50
     O        T 2      LR 59
     O                                   25 'TOTAL RECORDS ON FILE'
     O                                   38 '- CALCULATED'
     O                         COUNT 3   50
     O        T 1      LR 59
     O                   NU7 U8          68 '***   DIFFERENCE   ***'
     O        T 3      LR 59
     O                NU7N80             63 '***   NO DETAILS TO REPO'
     O                NU7N80             71 'RT   ***'
      *
      /EJECT
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
**    NARR - ARRAY OF NARRATIVES
THE FOLLOWING PAYMENT IS DUE ON YOUR COMMITMENT.                1
THE FOLLOWING PAYMENT IS DUE ON YOUR LOAN.                      2
PLEASE BRING PAYMENT TO THE ATTENTION OF INTERNATIONAL          3
BANKING DIVISION, LOAN ACCOUNTING SECTION, QUOTING              4
OUR REFERENCE.                                                  5
INTEREST CALCULATIONS ARE AS FOLLOWS -                          6
DUE TO A CHANGE IN THE NEXT INTEREST PAYMENT DATE ON YOUR LOAN, 7
DUE TO A CHANGE IN THE NEXT REPAYMENT DATE ON YOUR LOAN,        8
DUE TO A CHANGE IN THE MATURITY DATE ON YOUR LOAN,              9
THE PREVIOUS PAYMENT BILL SENT TO YOU IS NO LONGER VALID.      10
A PAYMENT BILL REFLECTING THE NEW DETAILS WILL BE SENT TO YOU  11
BEFORE THE DUE DATE.                                           12
THIS IS AN AMENDMENT TO YOUR PREVIOUS BILL.                    13
THE PREVIOUS PAYMENT TELEX SENT TO YOU IS NO LONGER VALID.     14
A PAYMENT TELEX REFLECTING THE NEW DETAILS WILL BE SENT TO YOU 15
THIS IS AN AMENDMENT TO YOUR PREVIOUS PAYMENT TELEX.           16
** CPY@   **      OBJECT COPYRIGHT
(c) Finastra International Limited 2001
**  POWER - ARRAY OF POWERS FOR CURRENCY CONVERSION                                           CLE031
0000001                                                                                       CLE031
0000010                                                                                       CLE031
0000100                                                                                       CLE031
0001000                                                                                       CLE031
0010000                                                                                       CLE031
0100000                                                                                       CLE031
1000000                                                                                       CLE031
