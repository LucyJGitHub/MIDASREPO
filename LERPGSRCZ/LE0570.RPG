0001 H        1                                                           S01117
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas LE Maturity records extract')                    *
0001 H***********                                                         S01117
0002 F********************************************************************LE0570
     F*  Midas - Customer Lending Module
0004 F*                                                                  *LE0570
0005 F*    LE0570 - MATURITIES RECORD EXTRACT                            *LE0570
0006 F*                                                                  *LE0570
      *  (c) Finastra International Limited 2001                      *
     F*
      *  Last Amend No. CLE172             Date 01Oct20               *
      *  Prev Amend No. MD046248           Date 27Oct17               *
      *                 CLE154             Date 06Aug12               *
      *                 CLE148             Date 23Jul12               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CSD027             Date 09Dec05               *
      *                 CLE042             Date 06Sep05               *
      *                 CGL029             Date 01Sep03               *
      *                 218992             Date 10Jul03               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.02 -----------------------------------------------*
     F*                 163486             Date 14Oct99               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
     F*                 105140             Date 18Nov96               *
     F*                    BHF714        DATE 17OCT90
     F*                    S01194        DATE 10JAN90
     F*                    S01117        DATE 20SEP89
     F*
     F********************************************************************
      *  CLE172 - LIBOR Deregulation - Lending (Recompile)            *
      *  MD046248 - Finastra Rebranding                               *
      *  CLE154 - Loan Repayment Schedule Enhancement (Recompile)     *
      *  CLE148 - Alpha Loan Reference                                *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CLE042 - Extended Loan Sub Type                              *
      *  CGL029 - Increase Account Code to 10 digits                  *
     F*     218992  -  Output extended settlements onto LVENTEL          *
     F*                to ensure details from settlement allocation are  *
     F*                used on LEHOSTPD                                  *
     F*     163486  -  Recompile due to changes in LVENTEL.              *
     F*     105140  -  Recompile over changed LVENTZZ.                   *
     F*                Field NORE attribute changed.                     *
     F*     BHF714  -  EXCLUDE INTER-BRANCH ENTERIES
     F*     S01194  -  STANDING DATA CHANGES.
0010 F*     S01117  -  MULTIBRANCHING                                    *LE0570
0010 F*                                                                  *LE0570
0011 F********************************************************************LE0570
0012 F*                                                                   LE0570
0013 F*                                                                   LE0570
     F*  C R E A T I O N     P A R A M E T E R S                      *
     F*                                                               *
     F*                                                               *
     F*****************************************************************
0012 F*                                                                   LE0570
0013 F*                                                                   LE0570
0014 F***LVENT***IP**F     400 12AI     2 DISK                            LE0570              218992
0014 F***LVENT** IP  F    1070 12AI     2 DISK                                         218992 CGL029
     F*LVENT***IP**F****1124 12AI     2 DISK                                           CGL029 CLE042
     FLVENT   IP  F    1128 12AI     2 DISK                                                   CLE042
0015 F*TABLE***IF  F      96 12AI     2 DISK                              S01194
0016 FMATEXHH O   F     400            DISK                               LE0570
     F***MATEXEL*O***F     400            DISK                                                218992
     F***MATEXEL O   F    1070            DISK                                         218992 CGL029
     F*MATEXEL*O***F****1124            DISK                                           CGL029 CLE042
     FMATEXEL O   F    1128            DISK                                                   CLE042
     FMATEXZZ O   F     400            DISK
0017 F*E0570P1O** F     132            PRINTER                  S01124    S01117
     FLE0570AUO   F     132            PRINTER                            S01117
0018 F* ID F  C  H  L    FUNCTION OF INDICATORS                           LE0570
0019 F* 01            LVENT - HEADER                                      LE0570
0020 F* 02                  - DETAIL                                      LE0570
0021 F* 03                  - TRAILER                                     LE0570
0022 F* 04                  - CATCHALL                                    LE0570
0023 F**05******      TABLE - 1CD1                                        S01194
0024 F**06******            - CATCHALL                                    S01194
0025 F**                                                                  S01194
0026 F*   09          FIRST PART EVENT TYPE BLANK                         LE0570
0027 F*   10          SECOND PART EVENT TYPE BLANK                        LE0570
0028 F*   13          EVENT AMOUNT NEGATIVE                               LE0570
0029 F**                                                                  LE0570
0030 F*      15       FIRST CYCLE IND                                     LE0570
0031 F**                                                                  LE0570
0032 F*      20       RECORD TO BE EXTRACTED                              LE0570
0033 F**                                                                  LE0570
0034 F*       24      EVENT AMOUNT & OTHER AMOUNT BOTH = 0                LE0570
0035 F**                                                                  LE0570
0036 F*         U7+U8 DATABASE ERROR                                      LE0570
     E                    CPY@    1   1 80
0037 F*         U8    FILE CONTROLS OUT OF BALANCE                        LE0570
0038 I*                                                                   LE0570
0039 I** CUSTOMER LENDING EVENTS FILE - HEADER RECORD                     LE0570
0040 I*                                                                   LE0570
0041 ILVENT   NS  01   1 CH                                               LE0570
0042 I                                        1   1 RECI                  LE0570
0043 I*                                                                   LE0570
0044 I** CUSTOMER LENDING EVENTS FILE - DETAIL RECORD                     LE0570
0045 I*                                                                   LE0570
0046 I        NS  02   1 CL                                               LE0570
0047 I                                        1   1 RECI                  LE0570
0048 I**********                              2   70LNRF                               LE0570 CLE148
     I                                        2   7 LNRF                                      CLE148
0049 I**********                              8  130CNUM                               LE0570 CSD027
0049 I                                        8  13 CNUM                                      CSD027
0050 I                                       14  17 ETYP                  LE0570
0051 I* EVENT TYPE - PARTS 1 & 2 FOR EXTRACT SELECTION                    LE0570
0052 I                                       14  150PTP             09    LE0570
0053 I                                       16  17 ETP             10    LE0570
0054 I*                                                                   LE0570
0055 I                                    P  18  200EDAT                  LE0570
0056 I                                    P  21  270EAMT          13      LE0570
0057 I                                       28  30 ECCY                  LE0570
0058 I                                       31  320ECSS                  LE0570
0059 I                                       33  34 LTYP                  LE0570
0060 I                                       35  36 SUTP                  LE0570
0061 I***********                            37  390BRCD                  S01117
0061 I                                       37  39 BRCA                  S01117
0062 I                                    P  40  457INTR                  LE0570
0063 I                                       46  46 NGII                  LE0570
0064 I                                    P  47  490OTHD                  LE0570
0065 I                                    P  50  560OTHA                  LE0570
0066 I                                       57  59 FCCY                  LE0570
0067 I                                       60  610FCSS                  LE0570
0068 I                                       62  620ECDP                  LE0570
0069 I                                       63  630FCDP                  LE0570
0070 I                                    P  64  700DBCE                  LE0570
0071 I                                    P  71  770BCEQ                  LE0570
0072 I                                    P  78  848DBCR                  LE0570
0073 I                                    P  85  910DFCE                  LE0570
0074 I                                    P  92  980FCEQ                  LE0570
0075 I                                    P  99 1050DFCR                  LE0570
0076 I                                      106 106 FIRI                  LE0570
0077 I                                      107 1080SETP                  LE0570
0078 I**********                            109 120 OSAC                               LE0570 CGL029
     I                                      109 120 OSACQQ                                    CGL029
0079 I                                      121 130 TSEN                  LE0570
0080 I                                      131 140 FACO                  LE0570
0081 I                                      141 170 SPI1                  LE0570
0082 I                                      171 200 SPI2                  LE0570
0083 I                                      201 230 SPI3                  LE0570
0084 I                                      231 231 INOI                  LE0570
0085 I**********                            232 2370CPAR                               LE0570 CSD027
0085 I                                      232 237 CPAR                                      CSD027
0086 I                                      238 2380PARI                  LE0570
0087 I                                      239 258 CRNM                  LE0570
0088 I                                      259 268 CTWN                  LE0570
0089 I                                      269 276 CASK                  LE0570
0090 I                                      277 296 PRNM                  LE0570
0091 I                                      297 306 PTWN                  LE0570
0092 I                                      307 314 PASK                  LE0570
0093 I**********                            315 3200FCUS                               LE0570 CSD027
0093 I                                      315 320 FCUS                                      CSD027
0094 I                                      321 3230FTYP                  LE0570
0095 I                                      324 3250FSEQ                  LE0570
0096 I                                      326 327 CRSK                  LE0570
0097 I                                      328 329 REGC                  LE0570
0098 I                                      330 331 CDOM                  LE0570
0099 I                                      332 333 RDOM                  LE0570
0100 I                                      334 3360LASN                  LE0570
0101 I                                      337 337 FREO                  LE0570
0102 I                                      338 338 WTIN                  LE0570
0103 I                                    P 339 3447WTRT                  LE0570
0104 I                                    P 345 3510CPAM                  LE0570
0105 I                                      352 352 AUTO                  LE0570
0106 I                                      353 3530MRIN                  LE0570
0107 I                                      354 355 ACOF                  LE0570
0108 I                                      356 356 RCSI                  LE0570
     I                                      363 363 IBRE                  BHF714
     I                                     10711088 OSAC                                      CGL029
     I                                     11251128 CLAS                                      CLE042
0109 I* ALL DATA, PARTS 1 & 2, FOR OUTPUT                                 LE0570
0110 I                                        1 200 LOT1                  LE0570
0111 I                                      201 400 LOT2                  LE0570
0111 I**********                            4011070 LOT3                               218992 CGL029
     I**************************************4011124 LOT3                               CGL029 CLE042
     I                                      4011128 LOT3                                      CLE042
0112 I*                                                                   LE0570
0113 I** TRAILER RECORD                                                   LE0570
0114 I        NS  03   1 CT                                               LE0570
0115 I                                        1   1 RECI                  LE0570
0116 I*********                               2   60NORE            LE0570105140
     I                                    P   2   60NORE                  105140
0117 I                                    P   7  140HRWN                  LE0570
0118 I                                    P  15  160HRDC                  LE0570
0119 I*                                                                   LE0570
0120 I* CATCHALL                                                          LE0570
0121 I        NS  04                                                      LE0570
0122 I                                        1   1 RECI                  LE0570
0123 I*                                                                   LE0570
0124 I*****TABLE*FILE*-*INSTALLATION*CONTROL*DATA*RECORD*1.               S01194
0125 I*                                                                   S01194
0126 I*TABLE***NS  05   2 C0   3 C1  12 C1                                S01194
0127 I*******AND      13 C0                                               S01194
0128 I**********                              1   1 RECI                  S01194
0129 I**********                              2   30RECT                  S01194
0130 I**********                             12  130RCDE                  S01194
0131 I**********                             14  66 TITL                  S01194
0132 I**********                             67  67 DATF                  S01194
0133 I***********                            68  700DFBR                  S01194
0134 I**********                             74  74 MODI1                 S01194
0135 I**********                             75  75 MODI2                 S01194
0136 I**********                             76  76 MODI3                 S01194
0137 I**********                          P  77  790RUND                  S01194
0138 I**********                             80  86 RUNA                  S01194
0139 I**********                             87  870SFLG                  S01194
0140 I**********                          P  90  920LCD                   S01194
0141 I**********                             93  93 CHTP                  S01194
0142 I**********                          P  94  960TNLU                  S01194
0143 I*                                                                   S01194
0144 I**CATCHALL                                                          S01194
0145 I*                                                                   S01194
0146 I********NS  06                                                      S01194
0147 I**********                              1   1 RECI                  S01194
0148 I*                                                                   S01194
0149 I*    LOCAL DATA AREA FOR DATABASE ERROR REFERENCES                  LE0570
0150 I*                                                                   LE0570
0151 ILDA        UDS                            256                       LE0570
0214 I***********                           134 138 DBFILE                S01117
0215 I***********                           139 167 DBKEY                 S01117
0216 I***********                           168 175 DBPGM                 S01117
0217 I***********                           176 177 DBASE                 S01117
0214 I                                      134 141 DBFILE                S01117
0215 I                                      142 170 DBKEY                 S01117
0216 I                                      171 180 DBPGM                 S01117
0217 I                                      181 1830DBASE                 S01117
0156 I*                                                                   LE0570
     ISDBANK    E DSSDBANKPD                                              S01194
      **  EXTERNAL DS FOR BANK DETAILS                                    S01194
     I              BJMRDT                          RUNA                  S01194
     I              BJRDNB                          RUND                  S01194
     I              BJURPT                          TITL                  S01194
     I              BJDFIN                          DATF                  S01194
      *
     IDSFDY     E DSDSFDY                                                 S01194
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01194
     I*                                                                   S01194
0157 I*                                                                   LE0570
0158 I/SPACE 3                                                            LE0570
     C                     MOVEACPY@      BIS@   80
0159 C********************************************************************LE0570
     C** PARAMETER LIST FOR PROGRAM 'AOBANKR0'                            S01194
     C           PLISTA    PLIST                                          S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDBANK    PARM SDBANK    DSFDY                           S01194
     C**                                                                  S01117
0160 C******     FIRST CYCLE/HEADER PROCESSING       *********************LE0570
0161 C*                                                                   LE0570
0162 C   15                GOTO ENDFC                                     LE0570
0163 C                     SETON                     15                   LE0570
     C*    DEFINE LDA                                                     S01117
     C           *NAMVAR   DEFN           LDA                             S01117
     C           *LOCK     IN   LDA                                       S01117
0164 C*                                                                   LE0570
0165 C* COUNT HEADER RECORD READ                                          LE0570
0166 C*                                                                   LE0570
0167 C***01*****           Z-ADD1         NRIN    50                LE0570105140
     C   01                Z-ADD1         NRIN    90                      105140
0168 C*                                                                   LE0570
0169 C*    SET UP DATABASE ERROR REFERENCE                                LE0570
0170 C*                                                                   LE0570
0171 C                     MOVE 'LE0570  'DBPGM                           LE0570
0172 C                     MOVE ' '       BLANKS 29                       LE0570
0173 C                     MOVE BLANKS    DBKEY                           LE0570
     C                     MOVE *BLANKS   DBFILE                          S01117
0174 C*                                                                   LE0570
0175 C*    ACCESS ICD-1 FOR DATE FORMAT, DATABASE ERROR IF NOT FOUND      LE0570
0176 C*                                                                   LE0570
     C                     CALL 'AOBANKR0'PLISTA                          S01194
     C           @RTCD     IFNE *BLANKS                                   S01194
     C                     SETON                     U7U8LR               S01194
     C                     MOVE '01'      DBASE                           S01194
     C                     MOVE 'SDBANKPD'DBFILE                          S01194
     C                     GOTO ENDD                                      S01194
     C                     END                                            S01194
     C*                                                                   S01194
0651 C*    CHECK SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.                    S01194
0652 C           DATF      COMP 'M'                      98MMDDYY, 98 ON  S01194
     C*                                                                   S01194
0177 C**********           EXSR ZSYSTM                     98ON-MMDDYY    S01194
0178 C***99*****           SETON                     U7U8LR               S01194
0179 C***99*****           Z-ADD01        DBASE                           S01194
0180 C***99*****           MOVE 'TABLE'   DBFILE                          S01194
0181 C***99*****           MOVELZTABKY    DBKEY                           S01194
0182 C***99*****           GOTO ENDD                                      S01194
0183 C*                                                                   LE0570
0184 C* COUNT HEADER OUTPUT                                               LE0570
0185 C*                                                                   LE0570
0186 C**********           Z-ADD1         NROU    50                LE0570105140
     C                     Z-ADD1         NROU    90                      105140
0187 C   01                GOTO ENDD                                      LE0570
0188 C*                                                                   LE0570
0189 C/SPACE 3                                                            LE0570
0190 C********************************************************************LE0570
0191 C******     MAIN PROCESSING                     *********************LE0570
0192 C*                                                                   LE0570
0193 C           ENDFC     TAG                             ** ENDFC TAG **LE0570
0194 C                     SETOF                     20                   LE0570
0195 C*                                                                   LE0570
0196 C* COUNT DETAIL & TRAILER RECORDS                                    LE0570
0197 C*                                                                   LE0570
0198 C   02                                                               LE0570
0199 COR 03      NRIN      ADD  1         NRIN                            LE0570
0200 C*                                                                   LE0570
0201 C* IF NOT DETAIL RECORD, SKIP MAIN PROCESSING                        LE0570
0202 C*                                                                   LE0570
0203 C   03                                                               LE0570
0204 COR 04                GOTO ENDD                                      LE0570
0205 C*                                                                   LE0570
0206 C* HASH TOTAL EVENT AMT. EACH DETAIL RECORD READ                     LE0570
0207 C* IF NEGATIVE, CHANGE SIGN & ADD                                    LE0570
0208 C*                                                                   LE0570
0209 C   13                Z-SUBEAMT      EAMT                            LE0570
0210 C*                                                                   LE0570
0211 C                     Z-ADD0         ZZAMT                           LE0570
0212 C                     MOVE EAMT      ZZAMT                           LE0570
0213 C                     Z-ADDINTOTI    ZZTOTI                          LE0570
0214 C                     Z-ADDINTOTD    ZZTOTD                          LE0570
0215 C                     EXSR GLZADD                                    LE0570
0216 C                     Z-ADDZZTOTI    INTOTI 150                      LE0570
0217 C                     Z-ADDZZTOTD    INTOTD  30                      LE0570
0218 C*                                                                   LE0570
0219 C* IF EAMT WAS NEGATIVE, RESTORE SIGN                                LE0570
0220 C*                                                                   LE0570
0221 C   13                Z-SUBEAMT      EAMT                            LE0570
0200 C*                                                                   BHF714
0201 C* IF INTER-BRANCH ENTRY SKIP MAIN PROCESSING                        BHF714
0202 C*                                                                   BHF714
0203 C           IBRE      IFEQ 'Y'                                       BHF714
0204 C                     GOTO ENDD                                      BHF714
     C                     END                                            BHF714
0222 C********************************************************************LE0570
0223 C**                                                                  LE0570
0224 C******     SELECT RECORDS TO EXTRACT           *********************LE0570
0225 C*                                                                   LE0570
0226 C**FIRST*TWO*CHARS*OF*EVENT TYPE*-*EXTRACT*IF*62-67******************LE0570
0227 C* FIRST TWO CHARS OF EVENT TYPE - EXTRACT IF 62,64 OR 66            LE0570
0228 C* (IF BLANK, DATABASE ERROR)                                        LE0570
0229 C*                                                                   LE0570
0230 C   09                GOTO QDBASE                                    LE0570
0231 C*                                                                   LE0570
0232 C           PTP       COMP 62                       20               LE0570
0233 C  N20      PTP       COMP 64                       20               LE0570
0234 C  N20      PTP       COMP 66                       20               LE0570
0235 C  N20                GOTO ENDD                                      LE0570
0236 C*                                                                   LE0570
0237 C* LAST TWO CHARS OF EVENT TYPE - EXTRACT IF = M1                    LE0570
0238 C* (IF BLANK, DATABASE ERROR)                                        LE0570
0239 C*                                                                   LE0570
0240 C   10                GOTO QDBASE                                    LE0570
0241 C*                                                                   LE0570
0242 C           ETP       COMP 'M1'                     20               LE0570
0243 C  N20                GOTO ENDD                                      LE0570
0244 C*                                                                   LE0570
0245 C           QDBASE    TAG                             **QDBASE TAG **LE0570
0246 C*                                                                   LE0570
0247 C   09                                                               LE0570
0248 COR 10                SETON                     U7U8LR               LE0570
0249 C   U7 U8             Z-ADD02        DBASE              (**DBASE 02) LE0570
0250 C   U7 U8             MOVE 'LVENT'   DBFILE                          LE0570
0251 C   U7 U8             MOVEL'EVENT'   DKEY1  10                       LE0570
0252 C   U7 U8             MOVE 'TYPE'    DKEY1                           LE0570
0253 C   U7 U8             MOVELDKEY1     DKEY2  15                       LE0570
0254 C   U7 U8             MOVE ETYP      DKEY2                           LE0570
0255 C   U7 U8             MOVELDKEY2     DBKEY                           LE0570
0256 C   U7 U8             GOTO ENDD                                      LE0570
0257 C*                                                                   LE0570
0258 C* GET RUN DATE PLUS 5 YEARS (ALLOW ONE LEAP YEAR)                   LE0570
0259 C           RUND      ADD  1826      RUNZ    50                      LE0570
0260 C*                                                                   LE0570
0261 C* EXTRACT ONLY RECORDS MATURING WITHIN FIVE YEARS                   LE0570
0262 C           EDAT      COMP RUNZ                   2020               LE0570
0263 C  N20                GOTO ENDD                                      LE0570
0264 C* DO NOT  EXTRACT IF BOTH EVENT & OTHER                             LE0570
0265 C*  AMOUNT ARE = 0                                                   LE0570
0266 C           EAMT      COMP 0                        24               LE0570
0267 C      24   OTHA      COMP 0                        24               LE0570
0268 C      24             SETOF                     20                   LE0570
0269 C     N20             GOTO ENDD                                      LE0570
0270 C*                                                                   LE0570
0271 C* COUNT DETAIL RECORD OUTPUT                                        LE0570
0272 C           NROU      ADD  1         NROU                            LE0570
0273 C*                                                                   LE0570
0274 C* HASH TOTAL RECORDS OUTPUT                                         LE0570
0275 C* IF EAMT NEGATIVE, CHANGE SIGN                                     LE0570
0276 C   13                Z-SUBEAMT      EAMT                            LE0570
0277 C*                                                                   LE0570
0278 C                     MOVE BLANKS    ZZAMT                           LE0570
0279 C                     MOVE EAMT      ZZAMT                           LE0570
0280 C                     Z-ADDOUTOTI    ZZTOTI                          LE0570
0281 C                     Z-ADDOUTOTD    ZZTOTD                          LE0570
0282 C                     EXSR GLZADD                                    LE0570
0283 C                     Z-ADDZZTOTI    OUTOTI 150                      LE0570
0284 C                     Z-ADDZZTOTD    OUTOTD  30                      LE0570
0285 C*                                                                   LE0570
0286 C* IF EAMT NEGATIVE, RESTORE SIGN                                    LE0570
0287 C   13                Z-SUBEAMT      EAMT                            LE0570
0288 C*                                                                   LE0570
0289 C*                                                                   LE0570
0290 C*                                                                   LE0570
0291 C*                                                                   LE0570
0292 C           ENDD      TAG                             ** ENDD TAG ** LE0570
0293 C/SPACE 3                                                            LE0570
0294 C*                                                                   LE0570
0295 C*                                                                   LE0570
0296 C********************************************************************LE0570
0297 C******     TRAILER PROCESSING                  *********************LE0570
0298 C*                                                                   LE0570
0299 C* COMPARE RECORDS COUNTED WITH TRAILER VALUE                        LE0570
0300 C* IF NOT EQUAL, SETON U8                                            LE0570
0301 C*                                                                   LE0570
0302 C   03      NRIN      COMP NORE                 U8U8                 LE0570
0303 C*                                                                   LE0570
0304 C* COMPARE HASH TOTALS.  IF NOT EQUAL, SETON U8                      LE0570
0305 C*                                                                   LE0570
0306 C   03NU8   INTOTI    COMP HRWN                 U8U8                 LE0570
0307 C   03NU8   INTOTD    COMP HRDC                 U8U8                 LE0570
0308 C*                                                                   LE0570
0309 C* COUNT TRAILER OUTPUT                                              LE0570
0310 C*                                                                   LE0570
0311 C   03      NROU      ADD  1         NROU                            LE0570
0183 C*                                                                   LE0570
0313 C*                                                                   LE0570
     C           *IN15     IFNE '1'                                       S01194
     C                     CALL 'AOBANKR0'PLISTA                          S01194
     C           @RTCD     IFNE *BLANKS                                   S01194
     C                     SETON                     U7U8LR               S01194
     C                     MOVE '01'      DBASE                           S01194
     C                     MOVE 'SDBANKPD'DBFILE                          S01194
     C                     END                                            S01194
     C*                                                                   S01194
0651 C*    CHECK SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.                    S01194
0652 C           DATF      COMP 'M'                      98MMDDYY, 98 ON  S01194
     C                     END                                            S01194
     C*                                                                   S01194
0177 C*LRN15****            EXSR ZSYSTM                     98ON-MMDDYY   S01117
0178 C*LRN15*99*            SETON                     U7U8LR              S01117
0179 C*LRN15*99*            Z-ADD01        DBASE                          S01117
0180 C*LRN15*99*            MOVE 'TABLE'   DBFILE                         S01117
0181 C*LRN15*99*            MOVELZTABKY    DBKEY                          S01117
     C**                                                                  S01117
     C*     EXCUTE ERROR ROUTINE IF DATABASE ERROR EXISTS                 S01117
     C**                                                                  S01117
     CLR U7 U8             EXSR *PSSR                                     S01117
     C**                                                                  S01117
0312 C*                                                                   LE0570
0314 C/SPACE 3                                                            LE0570
0315 C********************************************************************LE0570
0316 C********************************************************************LE0570
0317 C* SUBROUTINE TO ADD AN AMOUNT (ZZAMT) TO THE TOTAL (ZZTOTI,ZZTOTD)  LE0570
0318 C*   IND '99' IS SET BY AN OVERFLOW ERROR                            LE0570
0319 C*                                                                   LE0570
0320 CSR         GLZADD    BEGSR                           *** GLZADD ****LE0570
0321 C*                                                                   LE0570
0322 CSR                   Z-ADDZZAMT     ZZAMT  153     91-DEFINE ZZAMT  LE0570
0323 CSR 91                GOTO ZZAEND                     AMT = 0.BYPASS LE0570
0324 C*                                                                   LE0570
0325 C* SPLIT ZZAMT INTO INTEGER AND DECIMAL FIELDS                       LE0570
0326 CSR                   Z-ADDZZAMT     ZZAMTI 150       INTEGER FIELD  LE0570
0327 CSR                   MOVE ZZAMT     ZZAMTD  30       DECIMAL FIELD  LE0570
0328 C* BOTH ZZAMTI AND ZZAMTD CONTAIN A 'SIGN' ZONE NOW                  LE0570
0329 C*                                                                   LE0570
0330 CSR                   EXSR GLZSUM                                    LE0570
0331 CSR         ZZAEND    ENDSR                           ** ZZAEND TAG *LE0570
0332 C*                                                                   LE0570
0333 C********************************************************************LE0570
0334 C********************************************************************LE0570
0335 C* SUBROUTINE TO CARRY OUT THE ADDITION FOR SUBROUTINES -            LE0570
0336 C*                        GLZADD, GLZSUB, GLZCMP.                    LE0570
0337 C*          PARAMETERS PASSED -                                      LE0570
0338 C*                     I/P ZZAMTI ZZAMTD                             LE0570
0339 C*                     O/P ZZTOTI ZZTOTD ZZNEGD IND 96 IND 99.       LE0570
0340 C*                                                                   LE0570
0341 CSR         GLZSUM    BEGSR                           *** GLZSUM ****LE0570
0342 C*                                                                   LE0570
0343 CSR                   Z-ADDZZTOTI    ZZTOTI 150       DEFINE ZZTOTI  LE0570
0344 CSR                   Z-ADDZZTOTD    ZZTOTD  30       DEFINE ZZTOTD  LE0570
0345 CSR                   SETOF                     919293               LE0570
0346 CSR                   SETOF                     949599               LE0570
0347 C*                                                                   LE0570
0348 C*    DETERMINE SIGN OF ZZAMTI & D,   92 IF NEG                      LE0570
0349 CSR         ZZAMTI    COMP 0                      9293               LE0570
0350 CSR 93      ZZAMTD    COMP 0                      9293               LE0570
0351 CSR 93                GOTO ZZSEND                     ZERO BYPASS    LE0570
0352 C*                                                                   LE0570
0353 C*    DETERMINE SIGN OF ZZTOTI & D, 91 IF NEG.                       LE0570
0354 CSR         ZZTOTI    COMP 0                      9193               LE0570
0355 CSR 93      ZZTOTD    COMP 0                      9193               LE0570
0356 C*                                                                   LE0570
0357 C*    IF ZZTOTAL IS ZERO, RETURN ZZAMOUNT.                           LE0570
0358 CSR 93                Z-ADDZZAMTI    ZZTOTI                          LE0570
0359 CSR 93                Z-ADDZZAMTD    ZZTOTD                          LE0570
0360 CSR 93                GOTO ZZSEND                     ZERO BYPASS    LE0570
0361 C*    IF SIGNS DIFFER BYPASS OVERFLOW CHECKS.                        LE0570
0362 CSR 91N92                                                            LE0570
0363 CORN91 92             GOTO ZZOFPS                                    LE0570
0364 C*                                                                   LE0570
0365 CSR         ZZAMTD    ADD  ZZTOTD    ZZWK2   40                      LE0570
0366 CSR         ZZWK2     COMP 999                  93    '93' = CARRY   LE0570
0367 CSRN93      ZZWK2     COMP -999                   93    INTO INTEGER.LE0570
0368 C*                                                                   LE0570
0369 CSR 93N92   ZZAMTI    ADD  1         ZZWK3  150       ADD 'CARRY' +VELE0570
0370 CSR    93 92ZZAMTI    SUB  1         ZZWK3            SUB 'CARRY' -VELE0570
0371 CSR 93      ZZTOTI    ADD  ZZWK3     ZZWK3                           LE0570
0372 CSRN93      ZZTOTI    ADD  ZZAMTI    ZZWK3                           LE0570
0373 C*                                                                   LE0570
0374 C* IF THE MODULUS OF ZZWK3 IS LT MOD. ZZTOTI THEN O/F HAS OCCURED    LE0570
0375 CSRN92      ZZWK3     COMP ZZTOTI                 99  -92 MEANS NOS. LE0570
0376 CSR 92      ZZWK3     COMP ZZTOTI               99     NEGATIVE      LE0570
0377 CSRN99                Z-ADDZZWK2     ZZTOTD                          LE0570
0378 CSRN99                Z-ADDZZWK3     ZZTOTI                          LE0570
0379 C*                                                                   LE0570
0380 C* IF O/F ZEROIZE ZZAMT , IND '99' SET AND ZZTOT FIELDS LEFT INTACT. LE0570
0381 CSR 99                Z-ADD0         ZZAMT  153                      LE0570
0382 CSR                   GOTO ZZSEND                                    LE0570
0383 C*                                                                   LE0570
0384 C* THE 'SIGNS' ARE DIFFERENT                                         LE0570
0385 CSR         ZZOFPS    TAG                             ** ZZOFPS TAG**LE0570
0386 C* IF ZZAMT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZTOT            LE0570
0387 C*                                                                   LE0570
0388 CSR 92                Z-SUBZZAMTI    ZZAMTI 150                      LE0570
0389 CSR 92                Z-SUBZZAMTD    ZZAMTD  30                      LE0570
0390 C*                                                                   LE0570
0391 C* IF ZZTOT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZAMT.           LE0570
0392 C*                                                                   LE0570
0393 CSR 91                Z-SUBZZTOTI    ZZTOTI                          LE0570
0394 CSR 91                Z-SUBZZTOTD    ZZTOTD                          LE0570
0395 C* BOTH ZZAMT AND ZZTOT ARE NOW POSITIVE.                            LE0570
0396 C*                                                                   LE0570
0397 CSR         ZZTOTI    COMP ZZAMTI               93  95               LE0570
0398 CSR 95      ZZTOTD    COMP ZZAMTD               93  95               LE0570
0399 C*                                                                   LE0570
0400 C* IF ZZTOT EQ. ZZAMT RETURN ZERO.                                   LE0570
0401 CSR 95                Z-ADD0         ZZTOTI                          LE0570
0402 CSR 95                Z-ADD0         ZZTOTD                          LE0570
0403 CSR 95                GOTO ZZSEND                                    LE0570
0404 C*                                                                   LE0570
0405 C* IF ZZTOT GT. ZZAMT.                                               LE0570
0406 CSR 93      ZZAMTD    COMP ZZTOTD               94                   LE0570
0407 CSR 93 94   ZZTOTI    SUB  1         ZZTOTI                          LE0570
0408 CSR 93 94   ZZTOTD    ADD  1000      ZZWK2                           LE0570
0409 CSR 93      ZZTOTI    SUB  ZZAMTI    ZZTOTI                          LE0570
0410 CSR 93 94   ZZWK2     SUB  ZZAMTD    ZZTOTD                          LE0570
0411 CSR 93N94   ZZTOTD    SUB  ZZAMTD    ZZTOTD                          LE0570
0412 C*                                                                   LE0570
0413 C*                                                                   LE0570
0414 C* IF ZZAMT GT. ZZTOT.                                               LE0570
0415 CSRN93      ZZTOTD    COMP ZZAMTD               94                   LE0570
0416 CSRN93 94   ZZAMTI    SUB  1         ZZWK3  150                      LE0570
0417 CSRN93 94   ZZAMTD    ADD  1000      ZZWK2                           LE0570
0418 CSRN93 94   ZZWK3     SUB  ZZTOTI    ZZTOTI                          LE0570
0419 CSRN93N94   ZZAMTI    SUB  ZZTOTI    ZZTOTI                          LE0570
0420 CSRN93 94   ZZWK2     SUB  ZZTOTD    ZZTOTD                          LE0570
0421 CSRN93N94   ZZAMTD    SUB  ZZTOTD    ZZTOTD                          LE0570
0422 C*                                                                   LE0570
0423 C* REVERSE SIGN OF ZZTOT IF LARGER I/P FIELDS WERE NEGATIVE          LE0570
0424 CSR                   SETOF                     94                   LE0570
0425 CSR 93 91                                                            LE0570
0426 CORN93 92             SETON                     94                   LE0570
0427 CSR 94                Z-SUBZZTOTI    ZZTOTI                          LE0570
0428 CSR 94                Z-SUBZZTOTD    ZZTOTD                          LE0570
0429 C**                                                                  LE0570
0430 C**   RESTORE SIGN OF ZZAMTI & ZZAMTD IF IT WAS REVERSED.            LE0570
0431 CSR 92                Z-SUBZZAMTI    ZZAMTI                          LE0570
0432 CSR 92                Z-SUBZZAMTD    ZZAMTD                          LE0570
0433 CSR         ZZSEND    TAG                             ** ZZSEND TAG *LE0570
0434 C**                                                                  LE0570
0435 C**   IF ZZTOTD IS ZERO, AND ZZTOTI IS NEG. SET UP ZZNEGD.           LE0570
0436 CSR                   SETOF                     96                   LE0570
0437 CSR         ZZTOTD    COMP 0                        91               LE0570
0438 CSR 91      ZZTOTI    COMP 0                      96                 LE0570
0439 CSR 96                MOVE '.000-'   ZZNEGD  5                       LE0570
0440 CSR                   ENDSR                             ** ENDSR **  LE0570
0441 C********************************************************************LE0570
0442 C********************************************************************LE0570
0443 C**                                                                  LE0570
0444 C**   ZSYSTM SR. TO CHAIN TO THE INSTALLATION CONTROL DATA RECORD.   LE0570
0445 C**                                                                  LE0570
0446 C********** ZSYSTM    BEGSR                           *** ZSYSTM *** S01194
0447 C**                                                                  S01194
0448 C*****SET*UP*KEY*FOR*INSTALLATION*CONTROL*RECORD.*                   S01194
0449 C**********           MOVEL'01      'ZTABKY 12                       S01194
0450 C**********           MOVE '  10'    ZTABKY                          S01194
0451 C**********                                                          S01194
0452 C********** ZTABKY    CHAINTABLE                99    ON NOT THERE   S01194
0453 C**N99***** RECI      COMP 'D'                  9999  ON, IS DELETED S01194
0454 C**********                                                          S01194
0455 C*****CHECK*SYSTEM*DATE*FORMAT,*DDMMYY*OR*MMDDYY.                    S01194
0456 C********** DATF      COMP 'M'                      98MMDDYY, 98 ON  S01194
0457 C**********                                                          S01194
0458 C**********           ENDSR                                          S01194
0459 C**                                                                  LE0570
0460 C**                                                                  LE0570
     C********************************************************************S01117
     C*                                                                   S01117
     C* *PSSR  --- SUBROUTINE TO HANDLE ABNORMAL ERROR CONDITIONS         S01117
     C*                                                                   S01117
     C* CALLED FROM: AFTER ABNORNAL OPERATION OCCURS                      S01117
     C*                                                                   S01117
     C* CALLS: NOTHING                                                    S01117
     C*                                                                   S01117
     C********************************************************************S01117
     C*                                                                   S01117
     C           *PSSR     BEGSR                           ** *PSSR **    S01117
     C*                                                                   S01117
     C           @RUN      IFEQ *BLANKS                                   S01117
     C                     MOVE 'Y'       @RUN    1                       S01117
     C                     DUMP                                           S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C                     ENDSR                           ** *PSSR **    S01117
0461 C********************************************************************LE0570
0462 OMATEXHH H        01NU7NU8                                           LE0570
0463 O                                    1 'H'                           LE0570
0464 OMATEXEL D        02 20                                              LE0570
0465 O                         LOT1     200                               LE0570
0466 O                         LOT2     400                               LE0570
0466 O**********               LOT3    1070                                            218992 CGL029
     O*************************LOT3    1124                                            CGL029 CLE042
     O                         LOT3    1128                                                   CLE042
0467 O*                                                                   LE0570
0468 O* TRAILER FIELDS: NROU FOR NORE, OUTOTI/D FOR VLRF/L                LE0570
0469 O*                                                                   LE0570
0470 OMATEXZZ D        03                                                 LE0570
0471 O                                    1 'T'                           LE0570
0472 O**********               NROU       6                         LE0570105140
     O                         NROU       6P                              105140
0473 O                         OUTOTI    14P                              LE0570
0474 O                         OUTOTD    16P                              LE0570
0475 O*                                                                   LE0570
0476 O*                                                                   LE0570
0477 O*E0570P1T**203   LR U7 U8                                 S01124    S01117
0477 OLE0570AUT  203   LR U7 U8                                           S01117
0478 O***********                        22 'REFERENCE LE0570'            S01117
0478 O                                   24 'REFERENCE LE0570AU'          S01117
0479 O                         TITL      89                               LE0570
0480 O                                  104 'DATE'                        LE0570
0481 O                         RUNA     112                               LE0570
0482 O                                  122 'PAGE'                        LE0570
0483 O                         PAGE     127                               LE0570
0484 O        T     15 LR U7 U8                                           LE0570
0485 O                                   49 '-------------'               LE0570
0486 O                                   67 'MATURITIES RECORD'           LE0570
0487 O                                   75 'EXTRACT'                     LE0570
0488 O                                   89 '-------------'               LE0570
0489 O        T  2     LR U7 U8                                           LE0570
0490 O                                   61 '*** REFERENCE LE0570'        LE0570
0491 O                                   81 'DATABASE ERROR AT'           LE0570
0492 O***********              DBASE     84                               S01117
     O                         DBASE     85                               S01117
0493 O        T        LR U7 U8                                           LE0570
0494 O                                   55 'FILENAME'                    LE0570
0495 O***********              DBFILE    61                               S01117
     O                         DBFILE    65                               S01117
0496 O***********                        67 'KEY'                         S01117
0496 O                                   70 'KEY'                         S01117
0497 O***********              DBKEY     97                               S01117
0497 O                         DBKEY    101                               S01117
0498 O*                                                                   LE0570
0499 O*                                                                   LE0570
0500 O        T  203   LR                                                 LE0570
0501 O***********                        22 'REFERENCE LE0570'            S01117
0501 O                                   24 'REFERENCE LE0570AU'          S01117
0502 O                         TITL      89                               LE0570
0503 O                                  104 'DATE'                        LE0570
0504 O                         RUNA     112                               LE0570
0505 O                                  122 'PAGE'                        LE0570
0506 O                         PAGE     127                               LE0570
0507 O        T  1     LR                                                 LE0570
0508 O                                   65 'MATURITIES RECORD EXTRAC'    LE0570
0509 O                                   84 'T  -  FILE CONTROLS'         LE0570
0510 O        T  3     LR                                                 LE0570
0511 O                                   65 '------------------------'    LE0570
0512 O                                   84 '-------------------'         LE0570
0513 O        T  1     LR                                                 LE0570
0514 O                                   28 'S/LVENT - RUN CONTROLS'      LE0570
0515 O                                   59 'NUMBER'                      LE0570
0516 O                                   84 'VALUE'                       LE0570
0517 O        T  2     LR                                                 LE0570
0518 O                                   28 '----------------------'      LE0570
0519 O                                   59 'OF RECORDS'                  LE0570
0520 O                                   84 'OF RECORDS'                  LE0570
0521 O        T  2     LR                                                 LE0570
0522 O                                   29 'TOTAL RECORDS ON FILE'       LE0570
0523 O                   NU7   NORE  3   59                               LE0570
0524 O                   NU7   HRWN  4   81                               LE0570
0525 O                   NU7   HRDC      84                               LE0570
0526 O        T  3     LR                                                 LE0570
0527 O                                   29 'TOTAL RECORDS ON FILE'       LE0570
0528 O                                   42 '- CALCULATED'                LE0570
0529 O                         NRIN  3   59                               LE0570
0530 O                         INTOTI4   81                               LE0570
0531 O                         INTOTD    84                               LE0570
0532 O                    U8NU7         111 '***   DIFFERENCE   ***'      LE0570
0533 O        T  1     LR                                                 LE0570
0534 O                                   28 'S/MATEX - RUN CONTROLS'      LE0570
0535 O        T  2     LR                                                 LE0570
0536 O                                   28 '----------------------'      LE0570
0537 O        T  3     LR                                                 LE0570
0538 O                                   29 'TOTAL RECORDS ON FILE'       LE0570
0539 O                         NROU  3   59                               LE0570
0540 O                         OUTOTI4   81                               LE0570
0541 O                         OUTOTD    84                               LE0570
0542 O********T*3      LR                                                 S01117
0543 O***********                        76 '*** END OF REPORT ***'       S01117
** CPY@   **      OBJECT COPYRIGHT
(c) Finastra International Limited 2001
