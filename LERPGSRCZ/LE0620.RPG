0001 H        1                                                           S01117
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas LE Outstanding Delivery Instructions')           *
0001 H***********                                                         S01117
0002 F********************************************************************
     F*              Midas Customer Lending Module                    *
0004 F*                                                               *
0005 F*       LE0620 - OUTSTANDING DELIVERY INSTRUCTIONS REPORT       *
0006 F*                                                               *
      *  (c) Misys International Banking Systems Ltd. 2001            *
0008 F*                                                               *
      *  Last Amend No. CLE154             Date 06Aug12               * 
      *  Prev Amend No. CLE148             Date 23Jul12               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CSD031             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 CLE042             Date 06Sep05               *
      *                 CGL029             Date 01Sep03               *
      *                 218992             Date 10Jul03               *
      *                 CLE028             Date 27Jun02               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.04 -----------------------------------------------*
      *                 184053             Date 06Oct00               *
      * Midas DBA 3.02 -----------------------------------------------*
      *                 163486             Date 14Oct99               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 CEU004             Date 02Feb98               *
     F*                 CLE005             Date 22May97               *
     F*                 105140             Date 18Nov96               *
     F*                 SO1392             Date 14Sep92               *
     F*                      E18654                 DATE 15FEB90         *
     F*                      S01194                 DATE 09JAN90         *
0008 F*                      E17576                 DATE 13DEC89         *
0008 F*                      S01117                 DATE - 24/07/87      *
0008 F*                      E15806                 DATE - 03/11/88      *
0008 F*                                                                  *
0008 F*----------------------------------------------------------------  *
0008 F*                                                                  *
      *  CLE154 - Loan Repayment Schedule Enhancement (Recompile)     *
      *  CLE148 - Alpha Loan Reference                                *
      *  243887 - Report only those records with settlement type '00' *
      *           Also prevent reporting of Principal Transfers.      *
      *           Apply/upgrade existing CIC-LDN DBA3.05 fix 204598   *
      *           and 211899                                          *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CLE042 - Extended Loan Sub Type                              *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  218992 - Output extended settlements onto LVENTEL to ensure  *
      *           details from settlement allocation are used on      *
      *           LEHOSTPD                                            *
      *  CLE028 - Flat Rate Personal Loans (Rule of 78s)              *
      *  184053 - LEC07 10001 running to long due to mutiple calls on *
      *           AOSARDR0. Fix is call AOSARDR0 on first cycle only  *
      *           as it should be.                                    *
     F*  163486 - Recompile due to changes in LVENTEL.                *
      *  CEU004 - LE Settlement Ccy Conversion Upgrade to DBA R2.0    *
     F*  CLE005 - Customer lending enhancement - Others (T3)          *
     F*       105140 - Recompile over changed LVENTZZ.                   *
     F*                Field NORE attribute changed!                     *
     F*       S01392 - JAPANESE SUB MODULE ENHANCEMENTS                  *S01392
     F*       E18654 - COSMETIC ERROR WHEN NO DETAILS TO REPORT          *E18654
     F*       S01194 - STANDING DATA CHANGES                             *
0008 F*       E17576 - FOR LOANS WITH PROCESSING TYPE 70, THE            *
0008 F*             SETTLEMENT OF THE PRINCIPAL AMOUNT ON VALUE          *
0008 F*             DATE AND MATURITY DATE SHOULD NOT BE SHOWN           *
0011 F*       S01117  -  MULTIBRANCHING                                  *S01117
0008 F*       E15806  -  INCORRECT OUTPUT OF 'END OF REPORT' LINE        *
0008 F*                                                                  *
0011 F********************************************************************
0012 F*                                                                  *
     F*  C R E A T I O N     P A R A M E T E R S                      *
     F*                                                               *
     F*                                                               *
     F*****************************************************************
0012 F*                                                                  *
0013 F***LVEDE***IP  F     400 21AI     2 DISK                            CEU004
     F***LVEDE***IP**F     409 21AI     2 DISK                            CEU004              218992
     F***LVEDE** IP  F    1070 21AI     2 DISK                                         218992 CGL029
     F*LVEDE***IP**F****1124 21AI     2 DISK                                           CGL029 CLE042
     FLVEDE   IP  F    1128 21AI     2 DISK                                                   CLE042
0014 F*TABLE***IF**F******96*12AI*****2*DISK********                      S01194
     FLE0620P1O   F     132     OF     PRINTER      KINFDS SPOOL      UC  S01117
0015 F*E0620P1O   F     132     OF     PRINTER                  S01124    S01117
0017 FLE0620AUO   F     132     OA     PRINTER      KINFDS SPOOLU         S01117
0016 F*                                                                  *
0017 F* ID F  C  H  L    FUNCTION OF INDICATORS
0018 F* 01            SORTED EVENTS FILE - HEADER
0019 F* 02            SORTED EVENTS - DETAILS
0020 F* 03            SORTED EVENTS - TRAILER
     F*    23         EVENT TYPE LOKUP SUCCESSFUL
     F*    27         WORK INDICATOR FOR BENIFICIARY BANK DETAILS
     F*    29         BENIFICIARY BANK DETAILS EXIST ON FIRST LINE OF SPI
0021 F*    30         HASH AMOUNT IS NEGATIVE
     F*    33         MULTIBRANCHING INDICATOR (MBIN) = 'Y'               S01117
     F*    35         OUTPUT HEADING IF MBIN = 'N'                        S01117
     F*    37         OUTPUT INDICATOR                                    S01117
     F*    39         EMPTY PRIMARY FILE
0022 F*    40         FIRST CYCLE
0023 F*    41         LESS THAN 10 DAYS FROM EVENT DATE TO RUN DATE
0024 F*    42         FILE CONTROLS OUT OF BALANCE
0025 F*    43         NO DETAILS TO PRINT
0026 F*    44         EVENT IS COMMITMENT FEE TYPE
0027 F*    51         SPECIAL INSTRUCTIONS BLANK
0028 F*    52         SPECIAL INSTRUCTIONS BLANK
0029 F*    53         SPECIAL INSTRUCTIONS BLANK
0030 F*    54         FOR OUTPUT CONDITIONING
0031 F*        L1     CHANGE OF BRANCH CODE
0032 F*        U7+U8  DATABASE ERROR
0033 F*        U8     FILE CONTROLS OUT OF BALANCE
0034 F*
0073 E/COPY ZSRSRC,ZDATE2Z1
     E                    CPY@    1   1 80
     E*****               TABETY  1  12  2   TABENA 10   EVENT TYPES      S01392
     E***********         TABETY  1  14  2   TABENA 10   EVENT TYPES01392 CEU004
     E**********          TABETY  1  23  2   TABENA 10   EVENT TYPES                   CEU004 CLE028
     E                    TABETY  1  24  2   TABENA 10   EVENT TYPES                          CLE028
0038 I*
0039 I**      SORTED EVENTS FILE - HEADER
0040 I*
0041 ILVEDE   NS  01   1 CH
0042 I                                        1   1 RECI
0043 I*
0044 I**      DETAIL
0045 I*
0046 I        NS  02   1 CL
0047 I                                        1   1 RECI
0048 I**********                              2   70LNRF                                      CLE148
     I                                        2   7 LNRF                                      CLE148
0049 I***********                             8  130CNUM                                      CSD027
     I                                        8  13 CNUM                                      CSD027
0050 I                                       14  17 ETYP
     I                                       16  17 TYPE
0051 I                                    P  18  200EDAT
0052 I                                    P  21  270EAMT          30
0053 I                                       28  30 ECCY
0054 I                                       31  320ECSS
0055 I                                       33  34 LTYP
0056 I                                       35  36 SUTP
     I                                       37  39 BRCA  L1              S01117
0057 I***********                            37  390BRCD  L1              S01117
0058 I                                    P  40  457INTR
0059 I                                       46  46 NGII
0060 I                                    P  47  490OTHD
0061 I                                    P  50  560OTHA
0062 I                                       57  59 FCCY
0063 I                                       60  610FCSS
0064 I                                       62  620ECDP
0065 I                                       63  630FCDP
0066 I                                    P  64  700DBCE
0067 I                                    P  71  770BCEQ
0068 I                                    P  78  848DBCR
0069 I                                    P  85  910DFCE
0070 I                                    P  92  980FCEQ
0071 I                                    P  99 1058DFCR
0072 I                                      106 106 FIPI
0073 I                                      107 1080SETP
0074 I**********                            109 120 OSAC                                      CGL029
     I                                      109 120 OSACQQ                                    CGL029
0075 I                                      121 130 TSEN
0076 I                                      131 140 FACO
0077 I                                      141 170 SPI1            51
0078 I                                      171 200 SPI2            52
0079 I                                      201 230 SPI3            53
0080 I                                      231 231 INOI
0081 I***********                           232 2370CPAR                                      CSD027
     I                                      232 237 CPAR                                      CSD027
0082 I                                      238 2380PARI
0083 I                                      239 258 CRNM
0084 I                                      259 268 CTWN
0085 I                                      269 276 CASK
0086 I                                      277 296 PRNM
0087 I                                      297 306 PTWN
0088 I                                      307 314 PASK
0089 I***********                           315 3200FCUS                                      CSD027
     I                                      315 320 FCUS                                      CSD027
0090 I                                      321 3230FACT
0091 I                                      324 3250FCNO
0092 I                                      326 327 CTYR
0093 I                                      338 338 WITT
0094 I                                    P 339 3447WITR
0095 I                                      353 3530MRIN
     I                                      407 409 IFXC                  CEU004
     I                                     10711088 OSAC                                      CGL029
     I                                     11251128 CLAS                                      CLE042
0096 I*
0097 I**   TRAILER
0098 I*
0099 I        NS  03   1 CT
0100 I                                        1   1 RECI
0101 I**********                              2   60NORE                  105140
     I                                    P   2   60NORE                  105140
0102 I                                    P   7  140HRWN
0103 I                                    P  15  160HRDC
0104 I*
0105 I**      CATCHALL
0106 I*
0107 I        NS
0108 I************                                                        S01194
0109 I*****TABLE FILE - INSTALLATION CONTROL DATA RECORD 1.               S01194
0110 I************                                                        S01194
0111 I*TABLE***NS*******2*C0   3 C1  12 C1                                S01194
0112 I*******AND      13 C0                                               S01194
0113 I**********                              1   1 RECI                  S01194
0114 I**********                              2   30RECT                  S01194
0115 I**********                             12  130RCDE                  S01194
0116 I**********                             14  66 TITL                  S01194
0117 I***********                            67  67 DATF                  S01194
0118 I***********                            68  700DFBR                  S01194
0119 I**********                             74  74 MODI1                 S01194
0120 I**********                             75  75 MODI2                 S01194
0121 I**********                             76  76 MODI3                 S01194
0122 I***********                         P  77  790RUND                  S01194
0123 I***********                            80  86 RUNA                  S01194
0124 I**********                             87  870SFLG                  S01194
0125 I**********                          P  90  920LCD                   S01194
0126 I**********                             93  93 CHTP                  S01194
0127 I**********                          P  94  960TNLU                  S04494
0128 I**********                                                          S01194
0129 I****** CATCHALL FOR TABLE FILE                                      S01194
0130 I**********                                                          S01194
0131 I******  NS                                                          S01194
0132 I*********                               1   1 RECI                  S01194
0133 I**                                                                  S01194
     I**   FIELDS USED FOR BENIFICIARY BANK DETAILS
     I            DS
     I                                        1  30 SPI1
     I                                        1   3 SPEC3
     I                                        1   5 SPEC5
     I                                        6   8 SPEC8
     I                                        1   8 SPEC9
     I                                        6  12 SPEC12
     I                                        9  14 SPEC14
     I                                        9  17 SPEC17
     I                                       10  18 SPEC18
     I                                        5  29 SPEC29
     I                                        6  30 SPEC30
      *                                                                   CLE005
     ISCSARD    E DSSCSARDPD                                              CLE005
      ** SAR Details                                                      CLE005
      *                                                                   CLE005
0141 I*                                                                   S01194
      *                                                                   S01194
     ISDBANK    E DSSDBANKPD                                              S01194
      ** BANK DETAILS                                                     S01194
     I              BJBVPD                          BVLP                  S01194
     I              BJURPT                          TITL                  S01194
     ISDBRCH    E DSSDBRCHPD                                              S01117
     I**  EXTERNAL DS FOR BRANCH CODE DETAILS                             S01117
     I              A8BRNM                          BRNM                  S01194
     I*
     IDSFDY     E DSDSFDY                                                 S01194
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01194
     I*                                                                   S01194
     IDSSDY     E DSDSSDY                                                 S01194
     I* SECOND DS FOR ACCESS PROGRAMS, LONG DATA STRUCTURE                S01194
     I*                                                                   S01194
0141 I*
0134 I**     LOCAL DATA AREA FOR DATABASE ERROR REFERENCE
     I*
0136 ILDA        UDS                            256                       S01117
0137 I***********                           134 138 DBFILE                S01117
0138 I***********                           139 167 DBKEY                 S01117
0139 I***********                           168 175 DBPGM                 S01117
0140 I***********                           176 177 DBASE                 S01117
0353 I                                      134 141 DBFILE                S01117
0354 I                                      142 170 DBKEY                 S01117
0355 I                                      171 180 DBPGM                 S01117
0356 I                                      181 1830DBASE                 S01117
0925 I**                                                                  S01117
0925 I**   FILE INFORMATION DATA STRUCTURE                                S01117
0925 I**                                                                  S01117
     ISPOOL       DS                                                      S01117
     I                                       83  90 SFILE                 S01117
     I                                    B 123 1240SFNUM                 S01117
0925 I**                                                                  S01117
     I**   FILE INFORMATION DATA STRUCTURE                                S01117
     I**                                                                  S01117
     ISPOOLU      DS                                                      S01117
     I                                       83  90 SFILEU                S01117
     I                                    B 123 1240SFNUMU                S01117
     I**                                                                  S01117
     IRUNDT       DS                                                      S01117
     I**  DATA AREA RUNDAT                                                S01117
     I                                        1   7 RUNA                  S01117
     I                                    P   8  100RUND                  S01117
     I                                       11  11 SSF                   S01117
     I                                       12  12 DATF                  S01117
     I                                       13  13 MBIN                  S01117
     I**                                                                  S01117
     I**                                                                  S01117
     I/EJECT                                                              S01117
0142 I********************************************************************
     C                     MOVEACPY@      BIS@   80
     C           *ENTRY    PLIST                                          S01117
     C                     PARM           SEQ     5        SEQUENCE       S01117
     C                     PARM           BRNCH   3        BRANCH OR ALL  S01117
     C********************************************************************S01117
0143 C*
0144 C*
0145 C**       FIRST CYCLE CALCULATIONS
0146 C*
0147 C   40                GOTO DETAIL
0148 C                     SETON                     40
0270 C**********           SETON                     43                   S01117
0270 C                     SETOF                     39                   S01117
0223 C*                                                                   S01117
      **                                                                  S01117
      **   IN THE DATAAREA RUNDAT                                         S01117
      **                                                                  S01117
     C           *NAMVAR   DEFN RUNDAT    RUNDT                           S01117
     C                     IN   RUNDT                                     S01117
     C*    DEFINE LDA                                                     S01117
     C           *NAMVAR   DEFN           LDA                             S01117
     C           *LOCK     IN   LDA                                       S01117
     C**                                                                  S01117
     C*     IF MBIN=Y, SET ON *IN33                                       S01117
     C**                                                                  S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C                     SETON                     33                   S01117
     C                     END                                            S01117
0149 C*
0150 C**         FOR DATABASE ERROR REFERENCE
0151 C*
0152 C                     MOVE 'LE0620'  DBPGM
0153 C                     MOVE ' '       BLANKS 29
0154 C                     MOVE BLANKS    DBKEY
0155 C                     EXSR ZSYSTM
0156 C   99                SETON                     U7U8LR
0157 C   99                MOVE '01'      DBASE
0158 C***99********        MOVE 'TABLE'   DBFILE                          S01194
0158 C   99                MOVE 'SDBANKPD'DBFILE                          S01194
0159 C***99*******         MOVELZTABKY    DBKEY                           S01194
0160 C   99                GOTO ENDDET
     C                     MOVE ' '       BLNK10 10
      *                                                                   CLE005
      ** Determine if Customer Lending Enhancements - Others (T3)         CLE005
      ** feature is installed                                             CLE005
      *                                                                   CLE005
     C                     CALL 'AOSARDR0'                                CLE005
     C                     PARM *BLANKS   @RTCD                           CLE005
     C                     PARM '*KEY    '@OPTN                           CLE005
     C                     PARM 'CLE005  '@SARD   6                       CLE005
     C           SCSARD    PARM SCSARD    DSFDY                           CLE005
     C           @RTCD     IFEQ *BLANKS                                   CLE005
     C                     MOVE 'Y'       CLE005  1                       CLE005
     C                     ELSE                                           CLE005
     C                     MOVE 'N'       CLE005                          CLE005
     C           @RTCD     IFNE '*NRF    '                                CLE005
     C                     MOVEL'SCSARDPD'DBFILE           ************   CLE005
     C                     Z-ADD8         DBASE            * DBERR 08 *   CLE005
     C                     MOVEL'CLE005'  DBKEY            ************   CLE005
     C                     SETON                     U7U8LR               CLE005
     C                     GOTO ENDDET                                    CLE005
     C                     ENDIF                                          CLE005
     C                     ENDIF                                          CLE005
      *                                                                   184053
      ** Access SAR details file to see if CEU004 is installed            184053
      *                                                                   184053
     C                     MOVE 'N'       CEU004  1        Set SAR Flag   184053
      *                                                                   184053
     C                     CALL 'AOSARDR0'                 Rtv SAR Dtls   184053
      *                                                    Input:         184053
     C                     PARM *BLANKS   P@RTCD  7        -Return Code   184053
     C                     PARM '*VERIFY' P@OPTN  7        -Option        184053
     C                     PARM 'CEU004'  P@SARD  6        -SAR No        184053
      *                                                    Output:        184053
     C           SCSARD    PARM SCSARD    DSFDY            -Format        184053
      *                                                                   184053
     C           P@RTCD    IFEQ *BLANK                     If Found       184053
     C                     MOVE 'Y'       CEU004            Set SAR Flag  184053
      *                                                                   184053
     C                     ELSE                            Else           184053
     C           P@RTCD    IFNE '*NRF   '                   If # NoRecFnd 184053
     C                     MOVEL'SCSARDPD'DBFILE             Set File     184053
     C                     MOVEL'*VERIFY' DBKEY              Set Key      184053
     C                     Z-ADD6         DBASE              Set DBase Re 184053
     C                     SETON                     U7U8LR  Set Ind      184053
     C                     GOTO ENDLR                        Bypass       184053
     C                     ENDIF                            End If        184053
     C                     ENDIF                           End If         184053
      *                                                                   184053
     C*
0161 C*
0162 C**      KEEP A COUNT OF RECORDS INPUT
0163 C*
0164 C**********           Z-ADD1         NUMREC  50 43                   105140
     C                     Z-ADD1         NUMREC  90 43                   105140
0165 C*
0166 C********************************************************************
0167 C*
0168 C**      DETAIL PROCESSING
0169 C*
0170 C           DETAIL    TAG                             ** DETAIL TAG**
0171 C*
0172 C                     SETOF                     54
     C                     SETOF                     2729
0173 C   03                GOTO TRAPRO
0174 C  N02                GOTO ENDDET
     C*                                                                   S01117
     C**   MULTIBRANCH MAIN PROCESSING                                    S01117
     C*                                                                   S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C*                                                                   S01117
     C**      IF BRCA IS LESS THAN THE REQUIRED BRANCH,                   S01117
     C**      SKIP THE CALCULATION                                        S01117
     C*                                                                   S01117
     C           BRNCH     IFGT BRCA                                      S01117
     C           BRNCH     ANDNE'ALL'                                     S01117
     C                     SETOF                     37                   S01117
     C                     GOTO ENDDET                                    S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C**      IF BRCA IS GREATER THAN THE REQUIRED BRANCH,                S01117
     C**      END THE PROGRAM                                             S01117
     C*                                                                   S01117
     C           BRNCH     IFLT BRCA                                      S01117
     C           BRNCH     ANDNE'ALL'                                     S01117
     C                     SETON                     LR                   S01117
     C                     SETOF                     37                   S01117
     C                     GOTO ENDDET                                    S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C           *INL1     IFEQ '1'                                       S01117
     C                     CLOSELE0620P1                                  S01117
     C**                                                                  S01117
     C*       IF MBIN=YES, AND A REQUIRED BRANCH AND A LEVEL BREAK,       S01117
     C*       OPEN LE0620P1                                               S01117
     C**                                                                  S01117
     C           BRNCH     IFEQ 'ALL'                                     S01117
     C           BRNCH     OREQ BRCA                                      S01117
     C                     SETON                     37    ALLOW OUTPUT   S01117
0310 C                     SETON                     43                   S01117
     C                     MOVE 'Y'       P1OP    1                       S01117
     C                     OPEN LE0620P1                                  S01117
     C                     Z-ADD0         PAGE                            S01117
     C                     Z-ADD0         PAGE1                           S01117
     C**                                                                  S01117
     C*       ENSURE REPORT SPOOL FILE RECORDED BY RCF                    S01117
     C**                                                                  S01117
     C                     Z-ADDSFNUM     ZSNUM   60                      S01117
     C                     OUT  LDA                                       S01117
     C**                                                                  S01117
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           SEQ                             S01117
     C                     PARM BRCA      SENTY   3                       S01117
     C                     PARM           SFILE                           S01117
     C                     PARM           ZSNUM                           S01117
     C                     PARM           ZSERR   1                       S01117
     C**                                                                  S01117
     C           *LOCK     IN   LDA                                       S01117
     C           ZSERR     IFEQ 'Y'                                       S01117
      **  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM       S01117
     C                     SETON                     U7U8LR               S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C**                                                                  S01117
     C*  To get Branch Name(in BRNM) :                                    S01117
     C**                                                                  S01117
     C**********           CALL 'AOBRCHR0'                                             S01117 CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       S01117
     C                     PARM '*KEY   ' @OPTN   7                       S01117
     C                     PARM BRCA      @DSNB   3                       S01117
     C********** SDBRCH    PARM SDBRCH    DSFDY                                        S01117 CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANKS                                   S01117
     C                     MOVEL@DSNB     DBKEY                           S01117
     C                     MOVEL'SDBRCHPD'DBFILE           ************   S01117
     C                     Z-ADD5         DBASE            * DBASE 05 *   S01117
     C                     MOVEL@OPTN     DBOPTN  7        ************   S01117
     C                     SETON                     U7U8LR               S01117
     C   U8                GOTO ENDLR                                     S01117
     C                     END                                            S01117
     C**                                                                  S01117
     C                     ELSE                                           S01117
     C                     SETOF                     37                   S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C**                                                                  S01117
     C                     ELSE                                           S01117
     C**                                                                  S01117
     C*       IF MBIN='N' AND FIRST CYCLE,                                S01117
     C*       OPEN LE0620P1                                               S01117
     C**                                                                  S01117
     C           P1OP      IFNE 'Y'                                       S01117
     C                     SETON                     37    ALLOW OUTPUTPUTS01117
0310 C                     SETON                     43                   S01117
     C                     MOVE 'Y'       P1OP    1                       S01117
     C                     OPEN LE0620P1                                  S01117
     C                     Z-ADD0         PAGE                            S01117
     C                     Z-ADD0         PAGE1                           S01117
     C**                                                                  S01117
     C*       ENSURE REPORT SPOOL FILE RECORDED BY RCF                    S01117
     C**                                                                  S01117
     C                     Z-ADDSFNUM     ZSNUM   60                      S01117
     C                     OUT  LDA                                       S01117
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           SEQ                             S01117
     C                     PARM BRCA      SENTY   3                       S01117
     C                     PARM           SFILE                           S01117
     C                     PARM           ZSNUM                           S01117
     C                     PARM           ZSERR   1                       S01117
      *                                                                   S01117
     C           *LOCK     IN   LDA                                       S01117
     C           ZSERR     IFEQ 'Y'                                       S01117
      **  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM       S01117
     C                     SETON                     U7U8LR               S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C**
     C                     END                                            S01117
     C                     END                                            S01117
      ***********                                                  CEU004 184053
      ***Access*SAR*details*file*to*see*if*CEU004*is*installed     CEU004 184053
      ***********                                                  CEU004 184053
     C***********          MOVE 'N'       CEU004  1        Set SAR CEU004 184053
      ***********                                                  CEU004 184053
     C***********          CALL 'AOSARDR0'                 Rtv SAR CEU004 184053
      ***********                                          Input:  CEU004 184053
     C***********          PARM *BLANKS   P@RTCD  7        -Return CEU004 184053
     C***********          PARM '*VERIFY' P@OPTN  7        -Option CEU004 184053
     C***********          PARM 'CEU004'  P@SARD  6        -SAR No CEU004 184053
      ***********                                          Output: CEU004 184053
     C***********SCSARD    PARM SCSARD    DSFDY            -Format CEU004 184053
      ***********                                                  CEU004 184053
     C***********P@RTCD    IFEQ *BLANK                     If Foun CEU004 184053
     C***********          MOVE 'Y'       CEU004            Set SA CEU004 184053
      ***********                                                  CEU004 184053
     C***********          ELSE                            Else    CEU004 184053
     C***********P@RTCD    IFNE '*NRF   '                   If # N CEU004 184053
     C***********          MOVEL'SCSARDPD'DBFILE             Set F CEU004 184053
     C***********          MOVEL'*VERIFY' DBKEY              Set K CEU004 184053
     C***********          Z-ADD6         DBASE              Set D CEU004 184053
     C***********          SETON                     U7U8LR  Set I CEU004 184053
     C***********          GOTO ENDLR                        Bypas CEU004 184053
     C***********          ENDIF                            End If CEU004 184053
     C***********          ENDIF                           End If  CEU004 184053
      ***********                                                  CEU004 184053
0175 C*
0176 C**      KEEP HASH TOTAL OF RECORDS INPUT
0177 C*
0178 C                     MOVE EAMT      ZZAMT
0179 C   30                Z-SUBZZAMT     ZZAMT
0180 C                     Z-ADDEAMTI     ZZTOTI
0181 C                     Z-ADDEAMTD     ZZTOTD
0182 C                     EXSR GLZADD
0183 C                     Z-ADDZZTOTI    EAMTI  150
0184 C                     Z-ADDZZTOTD    EAMTD   30
0185 C           NUMREC    ADD  1         NUMREC
      *                                                                   CEU004
      ** If feature CEU004 is on, ignore records whose 'settlement        CEU004
      ** in another currency' indicator is not 'Y'.                       CEU004
      *                                                                   CEU004
     C           CEU004    IFEQ 'Y'                        If Feature On  CEU004
      *                                                                   CEU004
     C           IFXC      IFNE 'Y'                         If SetInd # Y CEU004
     C                     SETOF                     41      Reset Ind    CEU004
     C                     ENDIF                            End If        CEU004
      *                                                                   CEU004
     C                     ENDIF                           End If         CEU004
      *                                                                   CEU004
     C**
     C**   IGNORE THE SETTLEMENT OF PRINCIPAL AMOUNT ON VALUE             E17576
     C**   DATE AND MATURITY DATE FOR PROCESSING TYPE 70                  E17576
     C*                                                                   E17576
     C           ETYP      IFEQ '70M1'                                    E17576
     C           ETYP      OREQ '70V1'                                    E17576
     C                     SETOF                     41                   E17576
     C                     GOTO ENDDET                                    E17576
     C                     END                                            E17576
      *                                                                   CLE005
      ** Ignore the settlement of principal amount on value date          CLE005
      ** and maturity date for processing type 71.                        CLE005
      *                                                                   CLE005
     C           CLE005    IFEQ 'Y'                                       CLE005
     C           ETYP      IFEQ '71M1'                                    CLE005
     C           ETYP      OREQ '71V1'                                    CLE005
     C                     MOVE '0'       *IN41                           CLE005
     C                     GOTO ENDDET                                    CLE005
     C                     ENDIF                                          CLE005
     C                     ENDIF                                          CLE005
0186 C*
0187 C**      CONVERT DATE TO CORRECT FORMAT
0188 C*
0189 C                     Z-ADDEDAT      ZDAYNO
0190 C                     EXSR ZDATE2
0191 C*
0192 C**      CALCULATE IF LESS THAN 10 DAYS FROM EDAT TO RUND
0193 C*
0194 C           EDAT      SUB  RUND      NODAYS  50
0195 C           NODAYS    COMP 10                     4141
0196 C   41      FIPI      COMP 'Y'                  4141
     C   41      FIPI      COMP ' '                  4141
0197 C  N41                GOTO ENDDET
     C**********           SETOF                     43                   S01117
      *                                                                                       243887
      ** Write only those records with settlement type 00.                                    243887
      *                                                                                       243887
     C           SETP      IFNE 00                                                            243887
     C                     MOVE '0'       *IN41                                               243887
     C                     ENDIF                                                              243887
      *                                                                                       243887
      ** Do not report principal transfers.                                                   243887
      *                                                                                       243887
     C           TYPE      IFEQ 'V5'                                                          243887
     C           TYPE      OREQ 'R7'                                                          243887
     C                     MOVE '0'       *IN41                                               243887
     C                     ENDIF                                                              243887
      *                                                                                       243887
0198 C*
0199 C**      CALCULATE IF EVENT IS COMMITMENT FEE TYPE
0200 C*
0201 C           ETYP      COMP '71F2'                   44
0202 C   51 52 53
0203 COR 44                SETON                     54
     C*
     C**   CONVERT EVENT TYPE TO LITERAL FOR REPORT OUTPUT
     C           TYPE      LOKUPTABETY    TABENA         23
     C   23                MOVE TABENA    EVNAR  10
     C  N23                MOVE BLNK10    EVNAR
     C*
     C**   CHECK BENIFICIARY BANK DETAILS
     C*
     C**   IGNORE IF FIRST LINE OF SPECIAL INSTRUCTIONS IS BLANK
     C   51                GOTO BENEND
     C*
     C           SPEC5     COMP '/BEN/'              272729
     C   27                GOTO BENEND
     C*
     C**   CHECK FOR CHIPS NUMBER
     C           SPEC8     COMP '/CH'                    27
     C   27                MOVE SPEC14    WORK6   6
     C   27                MOVE *BLANKS   SPI1
     C   27                MOVE 'CHIPS'   SPEC5
     C   27                MOVE WORK6     SPEC12
     C   27                GOTO BENEND
     C*
     C**   CHECK FOR FED. WIRE NUMBER
     C           SPEC8     COMP '/FW'                    27
     C   27                MOVE SPEC17    WORK9   9
     C   27                MOVE *BLANKS   SPI1
     C   27                MOVE 'FED.WIRE'SPEC9
     C   27                MOVE WORK9     SPEC18
     C   27                GOTO BENEND
     C*
     C**   MUST NOW BE 'ACCOUNT'
     C                     MOVE SPEC30    WORK25 25
     C                     MOVE *BLANKS   SPI1
     C                     MOVE 'A/C'     SPEC3
     C                     MOVE WORK25    SPEC29
     C*
     C           BENEND    TAG                             * BENEND TAG *
     C*
0204 C**           AT LEAST ONE RECORD TO PRINT
0205 C                     SETOF                     43
0206 C                     GOTO ENDDET
0207 C*
0208 C********************************************************************
0209 C*
0210 C           TRAPRO    TAG
0211 C*
0212 C**      TRAILER PROCESSING
0213 C*
0214 C*   FILE CONTROLS
     C**                                                                  S01117
     C*       IF MBIN='Y' AND BRNCH=A PARTICULAR BRANCH NAME              S01117
     C*       NO CHECKING ON THE CONTROL TOTAL                            S01117
     C**                                                                  S01117
     C           MBIN      IFEQ 'N'                                       S01117
     C           MBIN      OREQ 'Y'                                       S01117
     C           BRNCH     ANDEQ'ALL'                                     S01117
0215 C           NUMREC    ADD  1         NUMREC
0216 C           NUMREC    COMP NORE                     42
0217 C   42      HRWN      COMP EAMTI                    42
0218 C   42      HRDC      COMP EAMTD                    42
0219 C  N42                SETON                     U8
     C                     END                                            S01117
0220 C*
0221 C*
0222 C           ENDDET    TAG                             * ENDDET TAG *
0149 C*
0152 CLRN40                MOVE 'LE0620'  DBPGM
0155 CLRN40                EXSR ZSYSTM
0156 CLRN40 99             SETON                     U7U8LR
0157 CLRN40 99             MOVE '01'      DBASE
0158 C*LRN40*99*******     MOVE 'TABLE'   DBFILE                          S01194
0158 CLRN40 99             MOVE 'SDBANKPD'DBFILE                          S01194
0159 C*LRN40*99*******     MOVELZTABKY    DBKEY                           S01194
0223 C*                                                                   S01194
     C**                                                                  S01117
     C**    WHEN LR INDICATOR SET ON WITHOUT EXECUTING THE FIRST          S01117
     C**    CYCLE                                                         S01117
     C**                                                                  S01117
     CLR         ENDLR     TAG                                            S01117
     CLR         P1OP      IFNE 'Y'                                       S01117
     CLR                   EXSR #ZZ                                       S01117
     CLR                   SETON                     3739                 S01117
     CLR                   END                                            S01117
     CLR U7 U8             EXSR *PSSR                                     S01117
0400 C**                                                                  S01117
0224 C********************************************************************
0402 C/SPACE 3                                                            S01117
0073 C/COPY ZSRSRC,ZDATE2Z4
0314 C********************************************************************
0315 C**
0316 C**   ZSYSTM SR. TO CHAIN TO THE INSTALLATION CONTROL DATA RECORD.
0317 C**
0318 C           ZSYSTM    BEGSR                           *** ZSYSTM ***
0319 C**
0320 C*****SET*UP*KEY*FOR*INSTALLATION CONTROL RECORD.                    S01194
0321 C**************       MOVEL'01      'ZTABKY 12                       S01194
0322 C**************       MOVE '  10'    ZTABKY                          S01194
0323 C**                                                                  S01194
0324 C********   ZTABKY    CHAINTABLE                99    ON NOT THERE   S01194
0325 C**N99**    RECI      COMP 'D'                  9999  ON, IS DELETED S01194
      *                                                                   S01194
      ** ACCESS BANK DETAILS                                              S01194
     C                     CALL 'AOBANKR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDBANK    PARM SDBANK    DSFDY                           S01194
     C           @RTCD     IFNE *BLANKS                                   S01194
     C                     SETON                     99                   S01194
     C                     END                                            S01194
0326 C**
0327 C**   CHECK SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.
0328 C***********DATF      COMP 'M'                      98MMDDYY, 98 ON  S01194
0328 C           BJDFIN    COMP 'M'                      98MMDDYY, 98 ON  S01194
0329 C**
0330 C                     ENDSR
0331 C**
0332 C**
0333 C********************************************************************
0334 C********************************************************************
0335 C* SUBROUTINE TO ADD AN AMOUNT (ZZAMT) TO THE TOTAL (ZZTOTI,ZZTOTD)
0336 C*   IND '99' IS SET BY AN OVERFLOW ERROR
0337 C*
0338 CSR         GLZADD    BEGSR                           *** GLZADD ****
0339 C*
0340 CSR                   Z-ADDZZAMT     ZZAMT  153     91-DEFINE ZZAMT
0341 CSR 91                GOTO ZZAEND                     AMT = 0.BYPASS
0342 C*
0343 C* SPLIT ZZAMT INTO INTEGER AND DECIMAL FIELDS
0344 CSR                   Z-ADDZZAMT     ZZAMTI 150       INTEGER FIELD
0345 CSR                   MOVE ZZAMT     ZZAMTD  30       DECIMAL FIELD
0346 C* BOTH ZZAMTI AND ZZAMTD CONTAIN A 'SIGN' ZONE NOW
0347 C*
0348 CSR                   EXSR GLZSUM
0349 CSR         ZZAEND    ENDSR                           ** ZZAEND TAG *
0350 C*
0351 C********************************************************************
0352 C* SUBROUTINE TO CARRY OUT THE ADDITION FOR SUBROUTINES -
0353 C*                        GLZADD, GLZSUB, GLZCMP.
0354 C*          PARAMETERS PASSED -
0355 C*                     I/P ZZAMTI ZZAMTD
0356 C*                     O/P ZZTOTI ZZTOTD ZZNEGD IND 96 IND 99.
0357 C*
0358 CSR         GLZSUM    BEGSR                           *** GLZSUM ****
0359 C*
0360 CSR                   Z-ADDZZTOTI    ZZTOTI 150       DEFINE ZZTOTI
0361 CSR                   Z-ADDZZTOTD    ZZTOTD  30       DEFINE ZZTOTD
0362 CSR                   SETOF                     919293
0363 CSR                   SETOF                     949599
0364 C*
0365 C*    DETERMINE SIGN OF ZZAMTI & D,   92 IF NEG
0366 CSR         ZZAMTI    COMP 0                      9293
0367 CSR 93      ZZAMTD    COMP 0                      9293
0368 CSR 93                GOTO ZZSEND                     ZERO BYPASS
0369 C*
0370 C*    DETERMINE SIGN OF ZZTOTI & D, 91 IF NEG.
0371 CSR         ZZTOTI    COMP 0                      9193
0372 CSR 93      ZZTOTD    COMP 0                      9193
0373 C*
0374 C*    IF ZZTOTAL IS ZERO, RETURN ZZAMOUNT.
0375 CSR 93                Z-ADDZZAMTI    ZZTOTI
0376 CSR 93                Z-ADDZZAMTD    ZZTOTD
0377 CSR 93                GOTO ZZSEND                     ZERO BYPASS
0378 C*    IF SIGNS DIFFER BYPASS OVERFLOW CHECKS.
0379 CSR 91N92
0380 CORN91 92             GOTO ZZOFPS
0381 C*
0382 CSR         ZZAMTD    ADD  ZZTOTD    ZZWK2   40
0383 CSR         ZZWK2     COMP 999                  93    '93' = CARRY
0384 CSRN93      ZZWK2     COMP -999                   93    INTO INTEGER.
0385 C*
0386 CSR 93N92   ZZAMTI    ADD  1         ZZWK3  150       ADD 'CARRY' +VE
0387 CSR    93 92ZZAMTI    SUB  1         ZZWK3            SUB 'CARRY' -VE
0388 CSR 93      ZZTOTI    ADD  ZZWK3     ZZWK3
0389 CSRN93      ZZTOTI    ADD  ZZAMTI    ZZWK3
0390 C*
0391 C* IF THE MODULUS OF ZZWK3 IS LT MOD. ZZTOTI THEN O/F HAS OCCURED
0392 CSRN92      ZZWK3     COMP ZZTOTI                 99  -92 MEANS NOS.
0393 CSR 92      ZZWK3     COMP ZZTOTI               99     NEGATIVE
0394 CSRN99                Z-ADDZZWK2     ZZTOTD
0395 CSRN99                Z-ADDZZWK3     ZZTOTI
0396 C*
0397 C* IF O/F ZEROIZE ZZAMT , IND '99' SET AND ZZTOT FIELDS LEFT INTACT.
0398 CSR 99                Z-ADD0         ZZAMT  153
0399 CSR                   GOTO ZZSEND
0400 C*
0401 C* THE 'SIGNS' ARE DIFFERENT
0402 CSR         ZZOFPS    TAG                             ** ZZOFPS TAG**
0403 C* IF ZZAMT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZTOT
0404 C*
0405 CSR 92                Z-SUBZZAMTI    ZZAMTI 150
0406 CSR 92                Z-SUBZZAMTD    ZZAMTD  30
0407 C*
0408 C* IF ZZTOT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZAMT.
0409 C*
0410 CSR 91                Z-SUBZZTOTI    ZZTOTI
0411 CSR 91                Z-SUBZZTOTD    ZZTOTD
0412 C* BOTH ZZAMT AND ZZTOT ARE NOW POSITIVE.
0413 C*
0414 CSR         ZZTOTI    COMP ZZAMTI               93  95
0415 CSR 95      ZZTOTD    COMP ZZAMTD               93  95
0416 C*
0417 C* IF ZZTOT EQ. ZZAMT RETURN ZERO.
0418 CSR 95                Z-ADD0         ZZTOTI
0419 CSR 95                Z-ADD0         ZZTOTD
0420 CSR 95                GOTO ZZSEND
0421 C*
0422 C* IF ZZTOT GT. ZZAMT.
0423 CSR 93      ZZAMTD    COMP ZZTOTD               94
0424 CSR 93 94   ZZTOTI    SUB  1         ZZTOTI
0425 CSR 93 94   ZZTOTD    ADD  1000      ZZWK2
0426 CSR 93      ZZTOTI    SUB  ZZAMTI    ZZTOTI
0427 CSR 93 94   ZZWK2     SUB  ZZAMTD    ZZTOTD
0428 CSR 93N94   ZZTOTD    SUB  ZZAMTD    ZZTOTD
0429 C*
0430 C*
0431 C* IF ZZAMT GT. ZZTOT.
0432 CSRN93      ZZTOTD    COMP ZZAMTD               94
0433 CSRN93 94   ZZAMTI    SUB  1         ZZWK3  150
0434 CSRN93 94   ZZAMTD    ADD  1000      ZZWK2
0435 CSRN93 94   ZZWK3     SUB  ZZTOTI    ZZTOTI
0436 CSRN93N94   ZZAMTI    SUB  ZZTOTI    ZZTOTI
0437 CSRN93 94   ZZWK2     SUB  ZZTOTD    ZZTOTD
0438 CSRN93N94   ZZAMTD    SUB  ZZTOTD    ZZTOTD
0439 C*
0440 C* REVERSE SIGN OF ZZTOT IF LARGER I/P FIELDS WERE NEGATIVE
0441 CSR                   SETOF                     94
0442 CSR 93 91
0443 CORN93 92             SETON                     94
0444 CSR 94                Z-SUBZZTOTI    ZZTOTI
0445 CSR 94                Z-SUBZZTOTD    ZZTOTD
0446 C**
0447 C**   RESTORE SIGN OF ZZAMTI & ZZAMTD IF IT WAS REVERSED.
0448 CSR 92                Z-SUBZZAMTI    ZZAMTI
0449 CSR 92                Z-SUBZZAMTD    ZZAMTD
0450 CSR         ZZSEND    TAG                             ** ZZSEND TAG *
0451 C**
0452 C**   IF ZZTOTD IS ZERO, AND ZZTOTI IS NEG. SET UP ZZNEGD.
0453 CSR                   SETOF                     96
0454 CSR         ZZTOTD    COMP 0                        91
0455 CSR 91      ZZTOTI    COMP 0                      96
0456 CSR 96                MOVE '.000-'   ZZNEGD  5
0457 CSR                   ENDSR                             ** ENDSR **
0458 C********************************************************************
     C/SPACE 3                                                            S01117
     C********************************************************************S01117
     C*                                                                   S01117
     C* SUBROUTINE : #ZZ                                                  S01117
     C*                                                                   S01117
     C* CALLED BY MAIN PROCESSING DURING TOTAL TIME CALCULATIONS IF       S01117
     C* THE P1 FILES HAVE NOT ALREADY BEEN OPENED (IE, IF THERE ARE       S01117
     C* NO RECORDS READ AND THEREFORE FILES OPENING NOT PERFORMED)        S01117
     C*                                                                   S01117
     C           #ZZ       BEGSR                                          S01117
     C*                                                                   S01117
     C** OPEN P1 SPOOL FILE                                               S01117
     C*                                                                   S01117
     C                     OPEN LE0620P1                                  S01117
     C                     SETON                     54                   S01117
     C*                                                                   S01117
     C** IF REPORT FOR ALL ENTITIES CALL ZSFILE WITH BLANK SENTY          S01117
     C*                                                                   S01117
     C           BRNCH     IFEQ 'ALL'                      B1             S01117
     C           MBIN      ORNE 'Y'                                       S01117
     C*                                                                   S01117
     C** ENSURE REPORT SPOOL FILE RECORDED BY RCF                         S01117
     C*                                                                   S01117
     C                     Z-ADDSFNUM     ZSNUM   60                      S01117
     C                     OUT  LDA                                       S01117
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           SEQ                             S01117
     C                     PARM *BLANKS   SENTY   3                       S01117
     C                     PARM           SFILE                           S01117
     C                     PARM           ZSNUM                           S01117
     C                     PARM           ZSERR   1                       S01117
     C*                                                                   S01117
      *                                                                   S01117
     C           *LOCK     IN   LDA                                       S01117
     C           ZSERR     IFEQ 'Y'                                       S01117
      **  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM       S01117
     C                     SETON                     U7U8LR               S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C**
     C                     MOVE 'ALL'     BRCA                            S01117
     C                     MOVE *BLANKS   BRNM                            S01117
     C*                                                                   S01117
     C** ELSE REPORT BY ENTITY SO CALL ZSFILE WITH ENTITY REQUESTED       S01117
     C*                                                                   S01117
     C                     ELSE                            X1             S01117
     C*                                                                   S01117
     C** ENSURE REPORT SPOOL FILE RECORDED BY RCF                         S01117
     C*                                                                   S01117
     C                     Z-ADDSFNUM     ZSNUM   60                      S01117
     C                     OUT  LDA                                       S01117
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           SEQ                             S01117
     C                     PARM BRNCH     SENTY   3                       S01117
     C                     PARM           SFILE                           S01117
     C                     PARM           ZSNUM                           S01117
     C                     PARM           ZSERR   1                       S01117
     C*                                                                   S01117
      *                                                                   S01117
     C           *LOCK     IN   LDA                                       S01117
     C           ZSERR     IFEQ 'Y'                                       S01117
      **  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM       S01117
     C                     SETON                     U7U8LR               S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C                     MOVE BRNCH     BRCA                            S01117
     C*                                                                   S01117
     C** AND GET ENTITY DETAILS FOR REPORT HEADINGS WHEN MULTIBRANCHING   S01117
     C*                                                                   S01117
     C           BRNCH     IFNE '   '                                     S01117
     C           BRNCH     ANDNE'ALL'                                     S01117
     C           MBIN      ANDEQ'Y'                                       S01117
     C**********           CALL 'AOBRCHR0'                                             S01117 CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       S01117
     C                     PARM '*KEY   ' @OPTN   7                       S01117
     C                     PARM BRCA      @DSNB   3                       S01117
     C********** SDBRCH    PARM SDBRCH    DSFDY                                        S01117 CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANKS                                   S01117
     C                     MOVEL@DSNB     DBKEY                           S01117
     C                     MOVEL'SDBRCHPD'DBFILE           ************   S01117
     C                     Z-ADD11        DBASE            * DBASE 11 *   S01117
     C                     MOVEL@OPTN     DBOPTN  7        ************   S01117
     C                     SETON                     U7U8                 S01117
     C                     EXSR *PSSR                                     S01117
     C                     GOTO #ZZ9                                      S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C                     END                             E1             S01117
     C*                                                                   S01117
     C** OUTPUT 'NO DETAILS TO REPORT' IN P1                              S01117
     C*                                                                   S01117
     C                     SETON                     43                   S01117
     C*                                                                   S01117
     C           #ZZ9      ENDSR                                          S01117
     C*                                                                   S01117
0340 C**                                                                  LE0930
     C********************************************************************S01117
     C/SPACE 3                                                            S01117
     C********************************************************************S01117
     C*                                                                   S01117
     C*  *PSSR --- SUBROUTINE TO HANDLE ABNORMAL ERROR CONDITIONS         S01117
     C*                                                                   S01117
     C*  CALLED FROM: AFTER ABNORMAL OPERATION OCCURS                     S01117
     C*                                                                   S01117
     C*  CALLS: NOTHING                                                   S01117
     C*                                                                   S01117
     C********************************************************************S01117
     C*                                                                   S01117
     C           *PSSR     BEGSR                           ** *PSSR **    S01117
     C*                                                                   S01117
     C           @RUN      IFEQ *BLANKS                                   S01117
     C                     MOVE 'Y'       @RUN    1                       S01117
     C                     DUMP                                           S01117
     C                     END                                            S01117
     C                     ENDSR                           ** *PSSR **    S01117
     C*                                                                   S01117
     C********************************************************************S01117
     C/EJECT                                                              S01117
0459 O*E0620P1H  203   L1                                        S01124   S01117
0460 O*******OR**      OFNL1                                              S01117
0461 O*******OR**      U7 U8                                              S01117
0462 O*******OR**      43 03                                              S01117
     OLE0620P1H  203   L1 37                                              S01117
     O       OR        OFNL1 37                                           S01117
0463 O***********                        22 'REFERENCE LE0620'            S01117
     O                                   24 'REFERENCE LE0620P1'          S01117
0464 O                         TITL      89
0465 O                                  104 'DATE'
0466 O                         RUNA     112
0467 O                                  122 'PAGE'
0468 O                         PAGE  Z  127
0469 O********H**1     L1                                                 S01117
0470 O*******OR**      OFNL1                                              S01117
0471 O*******OR**      U7 U8                                              S01117
0472 O*******OR**      43 03                                              S01117
     O        H  1     L1 37                                              S01117
     O       OR        OFNL1 37                                           S01117
0473 O**********************NU7          11 'BRANCH'                      E15806
0474 O**********************NU7BRCD      16                               E15806
0473 O***********        N43NU7          11 'BRANCH'                E15806S01117
0474 O***********        N43NU7BRCD      16                         E15806S01117
0475 O***********         03 43          16 '   '                         S01117
0476 O***********                        62 'OUTSTANDING DELIVERY'        S01117
0477 O***********                        82 'INSTRUCTIONS REPORT'         S01117
0476 O                                   60 'OUTSTANDING DELIVERY'        S01117
0477 O                                   80 'INSTRUCTIONS REPORT'         S01117
     O                       33          90 'BRANCH'                      S01117
     O                       33BRCA      96                               S01117
     O                   NU8 33          97 '-'                           S01117
     O                   NU8 33BRNM     129                               S01117
0478 O********H**3     L1                                                 S01117
0479 O*******OR**      OFNL1                                              S01117
0480 O*******OR**      U7 U8                                              S01117
0481 O*******OR**      43 03                                              S01117
     O        H  2     L1 37                                              S01117
     O       OR        OFNL1 37                                           S01117
0482 O***********                        62 '--------------------'
0483 O***********                        82 '--------------------'
0482 O                                   60 '--------------------'
0483 O                                   80 '--------------------'
0484 O********H**1     L1                                                 S01117
0485 O*******OR**      OFNL1                                              S01117
     O        H  1     L1 37                                              S01117
     O       OR        OFNL1 37                                           S01117
     O                                   49 'LOAN/FCLT'
     O                                   65 '----EVENT----'
0488 O                                   75 'SETTLT.'
0489 O********H**2     L1                                                 S01117
0490 O*******OR**      OFNL1                                              S01117
     O        H  2     L1 37                                              S01117
     O       OR        OFNL1 37                                           S01117
0491 O                                   12 'CUSTOMER'
0492 O                                   35 'TOWN'
     O                                   48 'NUMBER'
     O                                   65 'TYPE     DATE'
0494 O                                   87 'TYPE  OUR REC/PAY'
0495 O**********                        103 'THEIR REC/PAY'                                   CGL029
0496 O**********                        115 'FOR A/C OF'                                      CGL029
     O                                  109 'THEIR REC/PAY'                                   CGL029
     O                                  121 'FOR A/C OF'                                      CGL029
0497 O        D  1     02NU7 41
     O       AND       37                                                 S01117
0498 O                         CNUM       7
0499 O                         CRNM      29
0500 O                         CTWN      41
     O                      N44LNRF      48
     O                       44FACT      45
     O                       44          46 '/'
     O                       44FCNO      48
     O                         EVNAR     60
     O                         ZADATE    67
0507 O                         SETP      73
0508 O**********               OSAC      88                                                   CGL029
0509 O**********               TSEN     101                                                   CGL029
0510 O**********               FACO     115                                                   CGL029
     O                         OSAC      94                                                   CGL029
     O                         TSEN     107                                                   CGL029
     O                         FACO     121                                                   CGL029
0511 O        D  1     02NU7N54
0512 O*******AND*      41                                                 S01117
     O       AND       41 37                                              S01117
0513 O                                   86 'SPEC INSTR'
     O                 29                86 'BEN BANK  '
0514 O                         SPI1     117
0515 O        D  1     02NU7N52
     O       AND      N54 41 37                                           S01117
0516 O*******AND*     N54 41                                              S01117
     O                 29                86 'SPEC INSTR'
0517 O                         SPI2     117
0518 O        D  1     02NU7N53
     O       AND      N54 41 37                                           S01117
0519 O*******AND*     N54 41
0520 O                         SPI3     117
0646 O**                                                                  S01117
0647 O**   HEADINGS IF NO DETAIL RECORDS IN PRIMARY FILE                  S01117
0648 O**                                                                  S01117
     O        T  203   LR 37 39                                           S01117
     O       OR        LR U7 U8
     O                                   24 'REFERENCE LE0620P1'          S01117
0464 O                         TITL      89                               S01117
0465 O                                  104 'DATE'                        S01117
0466 O                         RUNA     112                               S01117
0467 O                                  122 'PAGE'                        S01117
0468 O                         PAGE  Z  127                               S01117
     O        T  1     LR 37 39                                           S01117
     O       OR        LR U7 U8                                           S01117
0476 O                                   60 'OUTSTANDING DELIVERY'        S01117
0477 O                                   80 'INSTRUCTIONS REPORT'         S01117
     O                       33          90 'BRANCH'                      S01117
     O                       33BRCA      96                               S01117
     O                   NU8 33          97 '-'                           S01117
     O                   NU8 33BRNM     129                               S01117
     O        T  2     LR 37 39                                           S01117
     O       OR        LR U7 U8                                           S01117
0482 O                                   60 '--------------------'        S01117
0483 O                                   80 '--------------------'        S01117
     O        T  1     LR 37 39                                           S01117
     O       OR        LR U7 U8                                           S01117
     O                                   49 'LOAN/FCLT'                   S01117
     O                                   65 '----EVENT----'               S01117
0488 O                                   75 'SETTLT.'                     S01117
     O        T  2     LR 37 39                                           S01117
     O       OR        LR U7 U8                                           S01117
0491 O                                   12 'CUSTOMER'                    S01117
0492 O                                   35 'TOWN'                        S01117
     O                                   48 'NUMBER'                      S01117
     O                                   65 'TYPE     DATE'               S01117
0494 O                                   87 'TYPE  OUR REC/PAY'           S01117
0495 O**********                        103 'THEIR REC/PAY'                            S01117 CGL029
0496 O**********                        115 'FOR A/C OF'                               S01117 CGL029
     O                                  109 'THEIR REC/PAY'                                   CGL029
     O                                  121 'FOR A/C OF'                                      CGL029
0676 O**                                                                  S01117
0677 O**   DATABASE ERROR                                                 S01117
0678 O**                                                                  S01117
0521 O        T 32     U7 U8 LR
0522 O***********                        42 '*** REFERENCE'               S01117
0522 O                                   39 '*** REFERENCE'               S01117
0523 O                         DBPGM     51
     O                                   71 'DATABASE ERROR ***'          S01117
0524 O***********                        71 '-DATABASE ERROR AT'          S01117
0525 O***********              DBASE     74                               S01117
0526 O********T**2     U7 U8 LR                                           S01117
0527 O***********                        37 'FILE NAME'                   S01117
0528 O***********              DBFILE    43                               S01117
0529 O***********                        48 'KEY'                         S01117
0530 O***********              DBKEY     78                               S01117
0531 O******* T 2      L1 43 37                                           S01117
0531 O        T 2      L1 43 37                                           S01117
     O       OR        LR 39 37                                           S01117
0532 O**********************             76 '*** END OF REPORT ***'       E15806
0533 O****************NU7*03             78 '* NO DETAILS TO REPORT *'    E15806
0532 O***********     NU7 43             65 '*** NO DETAILS '       E15806S01117
0533 O****************NU7*43             78 'TO REPORT *** '        E15806E18654
     O***********     NU7 43             79 'TO REPORT *** '        E18654S01117
     O                NU7                63 '***   NO DETAILS TO REPO'    S01117
     O                NU7                71 'RT   ***'                    S01117
     O        T 3      L1 37 33                                           S01117
     O                                   66 '*** END OF REPORT FOR'       S01117
     O                                   74 ' BRANCH '                    S01117
     O                         BRCA      77                               S01117
     O                                   81 ' ***'                        S01117
     O        T 3      LR 37N33                                           S01117
     O                                   76 '*** END OF REPORT ***'       S01117
     O**                                                                  S01117
     O**  CONTROL REPORT                                               ** S01117
     O**                                                                  S01117
     OLE0620AUT  203   LR                                                 S01117
0534 O********T**203   LR                                                 S01117
0535 O***********                        22 'REFERENCE LE0620'            S01117
     O                                   24 'REFERENCE LE0620AU'          S01117
0536 O                         TITL      89
0537 O                                  104 'DATE'
0538 O                         RUNA     112
0539 O                                  122 'PAGE'
0540 O***********              PAGE  Z  127                               S01117
0540 O                         PAGE1 Z  127                               S01117
0541 O        T  1     LR
0542 O                                   55 'OUTSTANDING DELIVERY'
0543 O                                   75 'INSTRUCTIONS REPORT'
0544 O                                   97 '- FILE CONTROL REPORT'
0545 O        T     15 LR
0546 O                                   55 '--------------------'
0547 O                                   75 '--------------------'
0548 O                                   97 '----------------------'
0549 O        T  1     LR
0550 O                                   28 'S/LVEDE - RUN CONTROLS'
0551 O                                   59 'NUMBER'
0552 O                                   84 'VALUE'
0553 O        T  2     LR
0554 O                                   28 '----------------------'
0555 O                                   59 'OF RECORDS'
0556 O                                   84 'OF RECORDS'
0557 O        T  2     LR
0558 O                                   29 'TOTAL RECORDS ON FILE'
0559 O                      NU7NORE  3   59
0560 O                      NU7HRWN  Z   81
0561 O                      NU7HRDC      84
0562 O        T        LR
0563 O                                   29 'TOTAL RECORDS ON FILE'
0564 O                                   42 '- CALCULATED'
0565 O                         NUMREC3   59
0566 O                         EAMTI Z   81
0567 O                         EAMTD     84
0568 O                 U8NU7            111 '*** DIFFERENCE ***'
0531 O        T 2      LR 39NU7                                           S01117
     O       OR        LR 43NU7                                           S01117
     O                                   63 '***   NO DETAILS TO REPO'    S01117
     O                                   71 'RT   ***'                    S01117
0676 O**                                                                  S01117
0677 O**   DATABASE ERROR                                                 S01117
0678 O**                                                                  S01117
0521 O        T 32     U7 U8 LR                                           S01117
0522 O                                   39 '*** REFERENCE'               S01117
0523 O                         DBPGM     51                               S01117
0524 O                                   71 'DATABASE ERROR AT'           S01117
0525 O                         DBASE     75                               S01117
0526 O        T  2     U7 U8 LR                                           S01117
0527 O                                   39 'FILE NAME'                   S01117
0528 O                         DBFILE    48                               S01117
0529 O                                   52 'KEY'                         S01117
0530 O                         DBKEY     82                               S01117
0569 O********T*3      LR                                                 S01117
0570 O***********                        76 '*** END OF REPORT ***'       S01117
     O**                                                                  S01392
     O** TWO ELEMENTS ARE PHYSICALLY ADDED TO THE ARRAY TABETY            S01392
     O**                                                                  S01392
**   ZYDY - YEARS IN DAYS CUMULATIVE IN FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
** CPY@   **      OBJECT COPYRIGHT
(c) Misys International Banking Systems Ltd. 2001
**   TABETY - EVENT TYPE LITERAL VALUES
V1START
V2START
I2INTEREST
R1REPAYMENT
R2REPAYMENT
V3PRIN. INC.
M1MATURITY
M2MATURITY
R5ROLLOVER
D1PAST DUE
A1DUMMY
F2END
R3ROLLOVER
R4ROLLOVER
VXSTART                                                                   CEU004
VYSTART                                                                   CEU004
VZPRIN.INC.                                                               CEU004
IYINTEREST                                                                CEU004
RXREPAYMENT                                                               CEU004
RYREPAYMENT                                                               CEU004
RZROLLOVER                                                                CEU004
MXMATURITY                                                                CEU004
MYMATURITY                                                                CEU004
H1START                                                                                       CLE028
