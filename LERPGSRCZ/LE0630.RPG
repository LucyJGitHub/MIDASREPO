0001 H        1                                                           S01117
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas LE Demand loans interest statements')            *
0001 H/TITLE LE0630 : DEMAND LOAN INTEREST STATEMENTS
0001 H***********                                                         S01117
0002 F********************************************************************
0003 F*                                                               *
0004 F*  Midas  Customer Lending Module                           *
0005 F*                                                               *
0006 F*  LE0630  - PRINT DEMAND LOAN INTEREST STATEMENTS              *
0007 F*                                                               *
      *  (c) Finastra International Limited 2001                      *
0007 F*                                                               *
      *  Last Amend No. CLE172             Date 01Oct20               *
      *  Prev Amend No. CSD103             Date 10Aug20               *
      *                 MD046248           Date 27Oct17               *
      *                 CLE141             Date 08Feb16               *
      *                 MD020290           Date 13May12               *
      *                 CLE075AO           Date 06Aug12               *
      *                 CLE134             Date 01Aug12               *
      *                 CLE148             Date 23Jul12               *
      *                 CER059             Date 19Jul10               *
      *                 CER047             Date 19May08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *                 CRE026             Date 24May06               *
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 BUG11782           Date 27Jul06               *
      *                 CSD031             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 CLE042             Date 06Sep05               *
      *                 CSW037A            Date 02May05               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 CLE025             Date 20Oct03               *
      *                 CGL029             Date 01Sep03               *
      * Midas Release 4.01 -------------------------------------------*
      *                 CLE015             Date 18Dec01               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.05 -----------------------------------------------*
      *                 CLE011             Date 07Nov00               *
      * Midas DBA 3.04 -----------------------------------------------*
      * Midas DBA 3.03 -----------------------------------------------*
      * Midas DBA 3.02 -----------------------------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 159022 (BD5114)    Date 04Mar97               *
      *                 156678             Date 05Mar98               *
     F*                 155278             Date 24Feb98               *
     F*                 136784             DATE 10SEP98               *
     F*                 CEU020             Date 13Mar98               *
     F*                 CLE006             DATE 02DEC96               *
     F*                 CLE004             DATE 02DEC96               *
     F*                 093584             DATE 28FEB96               *
     F*                 S01465             DATE 22MAR94               *
     F*                 S01392             DATE 14SEP92               *
0007 F*                 E20758             DATE 25JAN90               *
0007 F*                 LN0305             DATE 21MAY90               *
0007 F*                 BHF033             DATE 28MAY90               *
     F*                 LN0063             DATE 01MAY90               *
     F*                 LN0007             DATE 27APR90               *
0007 F*                 S01194             DATE 11JAN90               *
0007 F*                 S01117             DATE 21/08/89              *
0007 F*                 E15790             DATE 09/12/88              *
0007 F*                 E12727             DATE 31/03/88              *
0007 F*                                                               *
0012 F*---------------------------------------------------------------*
0007 F*                                                               *
      *  CLE172 - LIBOR Deregulation - Lending (Recompile)            *
      *  CSD103 - LIBOR Deregulation - Common Layer/Standing Data     *
      *           (Recompile)                                         *
      *  MD046248 - Finastra Rebranding                               *
      *  CLE141 - Currency and Location Business Day Convention       *
      *           (Recompile)                                         *
      *  MD020290 - C1 LE0630P1 vs. RU LE0630P1 with discrepancy      *
      *  CLE075AO - COB Restructure - LE COB Optimisation Phase 1     *
      *  CLE134 - Past Due Call Loan Processing (Recompile)           *
      *  CLE148 - Alpha Loan Reference                                *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  CER047 - German Features LF037-00 Reporting §24c             *
      *           (Recompile)                                         *
      *  CRE026 - Consumer Banking                                    *
      *  BUG11782 - Customer field COCUCL should not equal to         *
      *             '000000' to avoid database error.                 *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CLE042 - Extended Loan Sub Type                              *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  CLE025 - Credit Lines (Recompile)                            *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  CLE015 - Functionality moved from Syndicated Lending to      *
      *           Customer Lending                                    *
      *  CLE011 - Rate Fixing Days for Lending Rollover Processing    *
     F*  159022 - Need to check MLOAN as well as CLOAN, since, per
     F*           fix BD5073, loans matured today have already moved
     F*  156678 - File controls wrong (caused by 155278)              *
     F*  155278 - Demand Loan Int stmts don't look like a real report.*
     F*  136784 - For loans with capitalised interest, interest       *
     F*           amount should be shown in the report.               *
     F*  CEU020 - EMU Lending Multi-currency Rollover                 *
     F*  CLE006 - Customer Lending Enhancements - Rollovers           *
     F*  CLE004 - Customer Lending Enhancements - Syndications        *
     F*  093584 - Unable to change form length of spool file output   *
     F*           by changing printer file - remove Line specs.       *
     F*  S01465 - BLI Lending Enhancements                            *
     F*  S01392 - JAPANESE SUB MODULE ENHANCEMENTS                    *
     F*  E20758 - THE HEADING OF THE FILE CONTROL AUDIT REPORT        *
     F*           IS NON-STANDARD.                                    *
     F*  LN0305 - USE OF ALTERNATIVE ADDRESS INCORRECTLY CODED        *
     F*  BHF033 - FIELD CLIKEY NEEDS TO BE 10 LONG FOR AOCUSTR0       *
     F*  LN0063 - REPORT HEADING COSMETIC CHANGES                     *
     F*  LN0007 - USE OF ALTERNATIVE ADDRESS INCORRECTLY CODED        *
     F*  S01194 - STANDING DATA CHANGES                               *
0007 F*  S01117 - MULTIBRANCHING                                      *
0007 F*  E15790 - 'PAGE' NOT PRINTED ON CORRECT LINE.                 *
0007 F*  E12727 - CUSTOMER NAME AND ADDRESS IS NOT BEING              *
0007 F*           PRINTED WHEN A LOAN HAS MATURED AND THERE           *
0007 F*           IS NO CARRIED FORWARD LINE TO BE OUTPUT.            *
0007 F*                                                               *
0012 F*****************************************************************
0011 F*                                                                  *
     F*  C R E A T I O N     P A R A M E T E R S                         *
     F*                                                                  *
     F*                                                                  *
     F********************************************************************
0013 F*SINTS***IP**F*****100 22AI     3 DISK                                                  CLE042
     FSINTS   IP  F     104 22AI     3 DISK                                                   CLE042
0016 F*CLOAN***IF  F     458  7AI     2 DISK                       S01465 CLE011
     FCLOAN   IF  F    1310  7AI     2 DISK                               CLE011
0016 F*MLOAN***IF  F    1187  7AI     2 DISK                       159022 CLE011
     FMLOAN   IF  F    1310  7AI     2 DISK                               CLE011
     FSDCURRL1IF  E           K        DISK                                                 CLE075AO
     F/COPY WNCPYSRC,LE0630F001
0014 F*TABLE***IF**F      96 12AI     2 DISK                              S01194
0015 F*CLINT***IF**F     256  7AI     2 DISK                              S01194
0016 F*E0630P2O** F      90           LPRINTER                  S01124    S01117
0016 F*E0630P1O***F      90     OF    LPRINTER      KINFDS SPOOL   S01117 093584
0016 FLE0630P1O   F      90     OF     PRINTER      KINFDS SPOOL      UC  093584
0016 F*E0630P1O** F     132     OF     PRINTER                  S01124    S01117
0016 FLE0630AUO   F     132     OA     PRINTER      KINFDS SPOOLU         S01117
0016 FLEINTX  O   F      73            DISK                           U1
0011 F*                                                                  *
0017 F* ID F  C  H  L    FUNCTION OF INDICATORS
0018 F* 01            SINTS - INTEREST HEADER
0019 F* 02                  - RATE CHANGE DETAIL
0020 F* 03                  - MOVEMENT DETAIL
0021 F*       23      NO TELEXES GENERATED
      *       25      Cache Hit for Loan Types/SubTypes                                     CLE075AO
      *       26      Record access for Currency Codes                                      MD020290
0021 F*       30      PRINT BRANCH NAME
0021 F*       31      TELEX GENERATED
0022 F*       35      MULTIPLE USE
0023 F*       40      FIRST CYCLE
0024 F*       41      OUTPUT HEADINGS AND LOAN DETAILS
0025 F*       42      INTEREST IS CAPITALISED
0026 F*       43      PRINT ADJUSTMENT LINE
0027 F*       44      OUTPUT DETAIL LINE
0028 F*       45      OUTPUT CARRIED FORWARD LINE
0029 F*       46      RATE CHANGE NEGATIVE
0030 F********47******NO DETAIL RECORDS TO OUTPUT                         000040
     F****************OR, OUTSTANDING INTEREST & LOAN BALANCE BOTH ZERO   000040
     F*       47      OUTSTANDING INTEREST & LOAN BALANCE BOTH ZERO       000040
     F*       48      OUTPUT CONTINUED LINE
0030 F*       49      NO DETAIL RECORDS TO OUTPUT                         000040
     F*       50      RATE CHANGE ZERO - DO NOT PRINT LINE
     F*       52      MATURITY MOVEMENT - USED AT CHANGE OF LOAN
0031 F*       60-63   CURRENCY DPS 0-3
0032 F*       64      EDIT RATES
0033 F*       90-99   STANDARD SUBROUTINES
0034 F*       U7,U8   STANDARD MIDAS USAGE
0035 F*             L1 - LOAN CHANGE
0036 F*             L2 - BRANCH CODE CHANGE
0034 F*       U1      TELEX FILE
     E                    NARR    1  15 16                                CLE004
      /COPY ZSRSRC,ZDATE2Z1                                               S01392
0040 L*E0630P2*42FL 42OL                                        S01124    S01117
     E                    CPY@    1   1 80
     E                    #CCY      250  3               Currency Codes Array               CLE075AO
     E                    #LOA      300 13 0             Loan Types/SubTypes Array          CLE075AO
     E                    #LOS      300 13 0             Loan Types/SubTypes Sorted         CLE075AO
     E                    #LOK      300  8               Loan Types/SubTypes Cache Key      CLE075AO
0040 L*LE0630P1*42FL*42OL*****                                     S01117 093584
0041 I*
0042 I*    INTEREST STATEMENTS FILE - INTEREST HEADER
0043 I*
0044 ISINTS   NS  01   1 CD   2 CH
0045 I                                        1   1 RECI
0046 I                                        2   2 RCDT
0047 I***********                             3   50BRCD  L2              S01117
0047 I                                        3   5 BRCA  L2              S01117
0048 I**********                              6  110CNUM                                      CSD027
0048 I                                        6  11 CNUM                                      CSD027
0049 I**********                             12  170LNRF  L1                                  CLE148
     I                                       12  17 LNRF  L1                                  CLE148
0050 I                                       18  220VDAT
0051 I                                       23  240PRSQ
0052 I                                       25  270LASN
0053 I                                       35  36 LTYP
0054 I                                       37  38 SUTP
0055 I                                       39  400PTYP
0056 I                                       41  43 CCY
0057 I                                       44  45 AMTP
0058 I                                    P  46  520PRAM
0059 I                                    P  53  587BRTEL
0060 I                                    P  59  647RTSPL
0061 I                                       65  650CALC
0062 I                                       66  66 SPINL
0063 I                                    P  67  730INTA
0064 I                                    P  74  760STPG
0065 I                                       77  77 NACD
0066 I                                       78  78 INTC
0067 I                                    P  79  850PPIS
0068 I                                    P  86  920IOPS
0069 I                                    P  93  990IPPS
     I                                      101 104 CLAS                                      CLE042
0070 I*
0071 I*    INTEREST STATEMENTS FILE -  DETAIL RATES
0072 I*
0073 I        NS  02   1 CD   2 CE
0074 I                                        1   1 RECI
0075 I                                        2   2 RCDT
0076 I***********                             3   50BRCD  L2              S01117
0076 I                                        3   5 BRCA  L2              S01117
0077 I**********                              6  110CNUM                                      CSD027
0077 I                                        6  11 CNUM                                      CSD027
0078 I**********                             12  170LNRF  L1                                  CLE148
     I                                       12  17 LNRF  L1                                  CLE148
0079 I                                       18  220VDAT
0080 I                                       23  240PRSQ
0081 I                                       25  270LASN
0082 I**********                             28  330FCUS                                      CSD027
0082 I                                       28  33 FCUS                                      CSD027
0083 I                                       34  360FTYP
0084 I                                       37  380FSEQ
0085 I                                       39  400PTYP
0086 I                                       41  43 CCY
0087 I                                       44  45 AMTP
0088 I                                       46  470BRTT
0089 I                                    P  48  537BRTE
0090 I                                    P  54  597RTSP
0091 I                                       60  60 SPIN
0092 I                                       61  610CALC
0093 I                                       62  62 STAI
0094 I                                    P  80  820DAYS
0095 I                                    P  83  892ACUP
     I                                       90  92 RLCY                  CLE004
0096 I*
0097 I*    INTEREST STATEMENTS FILE - AMOUNT DETAIL
0098 I*
0099 I        NS  03   1 CD   2 CD
0100 I                                        1   1 RECI
0101 I                                        2   2 RCDT
0102 I***********                             3   50BRCD  L2              S01117
0102 I                                        3   5 BRCA  L2              S01117
0103 I**********                              6  110CNUM                                      CSD027
0103 I                                        6  11 CNUM                                      CSD027
0104 I**********                             12  170LNRF  L1                                  CLE148
     I                                       12  17 LNRF  L1                                  CLE148
0105 I                                       18  220VDAT
0106 I                                       23  240PRSQ
0107 I                                       25  270LASN
0108 I**********                             28  330FCUS                                      CSD027
0108 I                                       28  33 FCUS                                      CSD027
0109 I                                       34  360FTYP
0110 I                                       37  380FSEQ
0111 I                                       39  400PTYP
0112 I                                       41  43 CCY
0113 I                                       44  45 AMTP
0114 I                                    P  46  520PRAM
0115 I                                    P  53  590INTA
0116 I                                    P  60  660WTXA
0117 I                                    P  67  730FEAM
0118 I                                       74  750FECD
0119 I                                       76  76 WOIN
0120 I                                    P  77  790EXVD
0121 I                                    P  80  820DAYS
0122 I                                    P  83  892ACUP
     I**********                             90  950ROLN                               CLE004 CLE148
     I                                       90  95 ROLN                                      CLE148
0123 I*
0124 I*    INTEREST STATAMENTS FILE - TRAILER
0125 I*
0126 I        NS       1 CT
0127 I                                        1   1 RECI
0128 I                                    P   2   40NORE
0129 I*       NS
0123 I*
0124 I*    INTEREST STATAMENTS FILE - HEADER
0125 I*
0126 I        NS       1 CH
0127 I                                        1   1 RECI
     I*                                                                   S01465
     I** Loans file - Detail                                              S01465
     I*                                                                   S01465
     ICLOAN   NS       1 CD   8 CA                                        S01465
     I       OR        1 CM   8 CA                                        S01465
     I       OR        1 CR   8 CA                                        S01465
     I**********                            437 4420COCUCL                             S01465 CSD027
     I                                      437 442 COCUCL                                    CSD027
     IMLOAN   NS       1 CD   8 CA                                        159022
     I       OR        1 CM   8 CA                                        159022
     I       OR        1 CR   8 CA                                        159022
     I**********                            437 4420COCUCL                             159022 CSD027
     I                                      437 442 COCUCL                                    CSD027
0130 I**************                                                      S01194
0131 I*****TABLE*FILE - INSTALLATION CONTROL DATA RECORD 1.               S01194
0132 I**************                                                      S01194
0133 I*TABLE***NS***    2 C0   3 C1  12 C1                                S01194
0134 I*******AND****  13 C0                                               S01194
0135 I**************                          1   1 RECI                  S01194
0136 I**************                         12  130RCDE                  S01194
0137 I**************                         14  66 TITL                  S01194
0138 I***********                            67  67 DATF                  S01194
0139 I***********                            68  700DFBR                  S01194
0139 I**************                         71  71 TLXM                  S01194
0140 I**************                         74  74 MODI1                 S01194
0141 I**************                         75  75 MODI2                 S01194
0142 I**************                         76  76 MODI3                 S01194
0143 I***********                         P  77  790RUND                  S01194
0144 I***********                            80  86 RUNA                  S01194
0145 I**************                         87  870SFLG                  S01194
0146 I**************                                                      S01194
0147 I*****TABLE*FILE - INSTALLATION CONTROL DATA RECORD 5.               S01194
0148 I**************                                                      S01194
0149 I*TABLE***NS***    2 C0   3 C1  12 C4                                S01194
0150 I*******AND****  13 C0                                               S01194
0151 I**************                          1   1 RECI                  S01194
0152 I**************                          2   30RECT                  S01194
0153 I**************                         12  130RCDE                  S01194
0154 I**************                         18  210CSAC                  S01194
0155 I**************                         22  22 TLII                  S01194
0156 I**************                         23  23 MCRI                  S01194
0157 I**************                      P  24  250MCEP                  S01194
0158 I**************                         26  270MCLP                  S01194
0159 I**************                         28  28 FRDI                  S01194
0160 I**************                         29  29 BRCF                  S01194
0161 I**************                         30  350PSCN                  S01194
0162 I***********                            36  380DLBR                  S01194
0163 I**************                         39  420FRPA                  S01194
0164 I**************                         43  460FRPC                  S01194
0165 I**************                         47  49 USCY                  S01194
0166 I**************                         50  52 STCY                  S01194
0167 I**************                      P  53  553MBGE                  S01194
0168 I**************                         57  57 FFNY                  S01194
0169 I**************                         58  58 OURC                  S01194
0170 I**************                         59  59 BRNC                  S01194
0171 I**************                         60  60 LCYN                  S01194
0172 I**************                         61  61 ETBI                  S01194
0173 I**************                         62  640LSTT                  S01194
0174 I**************                         71  71 NAAI                  S01194
0175 I**************                         75  77 CLRC                  S01194
0176 I**************                         78  78 PRSW                  S01194
0177 I**************                         79  79 PRCI                  S01194
0178 I**************                         80  80 PRCA                  S01194
0179 I**************                         81  81 PRTX                  S01194
0180 I**************                         82  82 PRFW                  S01194
0181 I**************                         83  83 PRBW                  S01194
0182 I**************                      P  87  892TAXR                  S01194
0183 I**************                      P  90  920LCD                   S01194
0184 I**************                         93  93 CHTP                  S01194
0185 I**************                      P  94  960TNLU                  S01194
0186 I***********                                                         S01117
0187 I***********                                                         S01117
0188 I*****TABLE*FILE - BRANCH CODES RECORD.                              S01117
0189 I***********                                                         S01117
0190 I********NS*      2 C1   3 C0                                        S01117
0191 I***********                             1   1 RECI                  S01117
0192 I***********                             2   30RECT                  S01117
0193 I***********                            11  130BRCD                  S01117
0193 I***********                            11  13 BRCA                  S01117
0194 I***********                            14  43 BRNM                  S01117
0195 I***********                            44  490BICN                  S01117
0196 I***********                            50  51 LOCC                  S01117
0197 I***********                            52  53 CMPY                  S01117
0197 I***********                            52  54 CMPYM                 S01117
0198 I***********                         P  90  920LCD                   S01117
0199 I***********                            93  93 CHTP                  S01117
0200 I***********                         P  94  960TNLU                  S01117
0201 I*****TABLE*FILE - CURRENCIES RECORD 1.                              S01194
0202 I**************                                                      S01194
0203 I********NS****   2 C2   3 C0  13 C1                                 S01194
0204 I**************                          1   1 RECI                  S01194
0205 I**************                         13  130SREC                  S01194
0206 I**************                         14  27 CCNM                  S01194
0207 I**************                      P  28  348SPOT                  S01194
0208 I**************                         35  37 CCYS                  S01194
0209 I**************                         38  380CDP                   S01194
0210 I**************                         39  390TNOT                  S01194
0211 I**************                         40  40 DCCY                  S01194
0212 I**************                         41  44 SRC1                  S01194
0213 I**************                         45  48 SRC2                  S01194
0214 I**************                         49  520TACC                  S01194
0215 I**************                         53  560TEQV                  S01194
0216 I**************                         57  600SWQV                  S01194
0217 I**************                         61  640TAC4                  S01194
0218 I**************                         65  680TAC5                  S01194
0219 I**************                         69  69 HIND                  S01194
0220 I**************                      P  70  768PART                  S01194
0221 I**************                         77  780SSNO                  S01194
0222 I**************                      P  79  858ERLC                  S01194
0223 I**************                                                      S01194
0224 I*****LOAN*TYPE / SUB TYPE                                           S01194
0225 I**************                                                      S01194
0226 I********NS****   2 C4   3 C3                                        S01194
0227 I**************                          1   1 RECI                  S01194
0228 I**************                          2   30RECT                  S01194
0229 I**************                         10  11 LTYP                  S01194
0230 I**************                         12  13 SUTP                  S01194
0231 I**************                         14  43 LNARR                 S01194
0232 I**************                         44  450PTYP                  S01194
0233 I**************                      P  90  920LCD                   S01194
0234 I**************                         93  93 CHTP                  S01194
0235 I**************                      P  94  960TNLU                  S01194
0237 I**************                                                      S01194
0238 I*****CLIENT*FILE - CUSTOMER NAME AND ADDRESS RECORD.                S01194
0239 I**************                                                      S01194
0240 I*CLINT***NS***    8NCA                                              S01194
0241 I**************                          1   1 RECI                  S01194
0242 I**************                          2   70CNUM                  S01194
0243 I**************                          8   8 RCDT                  S01194
0244 I**************                          9  43 CNA1                  S01194
0245 I**************                         44  78 CNA2                  S01194
0246 I**************                         79 113 CNA3                  S01194
0247 I**************                        114 148 CNA4                  S01194
0248 I**************                        149 160 TELF                  S01194
0249 I**************                        161 172 TELX                  S01194
0250 I**************                        173 174 CLOC                  S01194
0251 I**************                        240 249 CTWN                  S01194
0252 I**************                      P 250 2520LCD                   S01194
0253 I**************                        253 253 CHTP                  S01194
0254 I**************                      P 254 2560TNLU                  S01194
0255 I********NS****   1 CD   8 CA                                        S01194
0241 I**************                          1   1 RECI                  S01194
0241 I**************                          9  28 CRNM                  S01194
0241 I**************                         29  38 CTWN                  S01194
0241 I**************                         69  80 CSIO                  S01194
0241 I**************                        244 244 TLEN                  S01194
0241 I**************                        245 245 TLXR                  S01194
0256 I**************                                                      S01194
0257 I*****DATA*STRUCTURES - KEY TO CURRENCY RECORDS                      S01194
0258 I**************                                                      S01194
0259 I************DS                                                      S01194
0260 I**************                          1  12 CCYKEY                S01194
0261 I**************                          9  11 CCY                   S01194
0262 I**************                                                      S01194
0263 I*****KEY*TO*LOAN TYPE/SUB TYPE RECORDS                              S01194
0264 I**************                                                      S01194
0265 I************DS                                                      S01194
0266 I**************                          1  12 LOKEY                 S01194
0267 I**************                          9  10 LTYP                  S01194
0268 I**************                         11  12 SUTP                  S01194
     I*                                                                   S01194
     ISDALTN    E DSSDALTNPD                                              S01194
     I**  EXTERNAL DS FOR ALTERNATIVE NAMES AND ADDRESSES                 S01194
     I              BCCNA1                          CNA1                  S01194
     I              BCCNA2                          CNA2                  S01194
     I              BCCNA3                          CNA3                  S01194
     I              BCCNA4                          CNA4                  S01194
     I*                                                                   S01194
     ISDBANK    E DSSDBANKPD                                              S01194
     I**  EXTERNAL DS FOR BANK DETAILS                                    S01194
     I              BJURPT                          TITL                  S01194
     I*                                                                   S01194
     ISDBRCH    E DSSDBRCHPD                                              S01117
     I**  EXTERNAL DS FOR BRANCH CODE DETAILS                             S01117
     I              A8BRNM                          BRNM                  S01117
     I*                                                                   S01194
     I***SDCURR*   E DSSDCURRPD                                                      S01194 CLE075AO
     ISDCURR    E DSSDCURRPD                250                                             CLE075AO
     I**  EXTERNAL DS FOR CURRENCY DETAILS                                S01194
     I              A6NBDP                          CDP                   S01194
     I              A6CYNM                          CCNM                  S01194
     I*                                                                   S01194
     ISDCUST    E DSSDCUSTPD                                              S01194
     I**  EXTERNAL DS FOR CUSTOMER DETAILS                                S01194
     I              BBCRNM                          CRNM                  S01194
     I              BBCRTN                          CTWN                  S01194
     I              QQDFAC                          QQDFA1                                    CGL029
     I*                                                                   S01194
     I***SDLOAN*   E DSSDLOANPD                                                      S01194 CLE075AO
     ISDLOAN    E DSSDLOANPD                300                                             CLE075AO
     I**  EXTERNAL DS FOR LOAN TYPE/SUB TYPE                              S01194
     I              AYLNTD                          LNARR                 S01194
     I*                                                                   S01194
     ISDMMOD    E DSSDMMODPD                                              S01194
     I**  EXTERNAL DS FOR LOAN TYPE/SUB TYPE                              S01194
     I*                                                                   S01194
     ISDTRAD    E DSSDTRADPD                                              S01194
     I**  EXTERNAL DS FOR TRADING DETAILS                                 S01194
     I              BLBNOC                          BRNC                  S01194
     I**                                                                  S01465
     ISCSARD    E DSSCSARDPD                                              S01465
     I* SAR FILE DETAILS ACCESSED VIA ACCESS PROGRAM  AOSARDR0            S01465
     I*
     IDSFDY     E DSDSFDY                                                 S01194
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01194
     I*                                                                   S01194
     IDSSDY     E DSDSSDY                                                 S01194
     I* SECOND DS FOR ACCESS PROGRAMS, LONG DATA STRUCTURE                S01194
     I*                                                                   S01194
0269 I**   LOCAL DATA AREA FOR DATABASE ERROR IDENTIFICATION
0270 ILDA        UDS                            256
0271 I***********                           134 138 DBFILE                S01117
0272 I***********                           139 167 DBKEY                 S01117
0273 I***********                           168 175 DBPGM                 S01117
0274 I***********                           176 1770DBASE                 S01117
0271 I                                      134 141 DBFILE                S01117
0272 I                                      142 170 DBKEY                 S01117
0273 I                                      171 180 DBPGM                 S01117
0274 I                                      181 1830DBASE                 S01117
0925 I**                                                                  S01117
0925 I**   FILE INFORMATION DATA STRUCTURE                                S01117
0925 I**                                                                  S01117
     ISPOOL       DS                                                      S01117
     I                                       83  92 SFILE                 S01117
     I                                    B 123 1240SFNUM                 S01117
0925 I**                                                                  S01117
     I**   FILE INFORMATION DATA STRUCTURE                                S01117
     I**                                                                  S01117
     ISPOOLU      DS                                                      S01117
     I                                       83  92 SFILEU                S01117
     I                                    B 123 1240SFNUMU                S01117
     I**                                                                  S01117
     IRUNDT       DS                                                      S01117
     I**  DATA AREA RUNDAT                                                S01117
     I                                        1   7 RUNA                  S01117
     I                                    P   8  100RUND                  S01117
     I                                       11  11 SSF                   S01117
     I                                       12  12 DATF                  S01117
     I                                       13  13 MBIN                  S01117
     I**                                                                  S01117
     I/EJECT                                                              S01117
     C                     MOVEACPY@      BIS@   80
     C*                                                                   S01465
     C** Field definitions                                                S01465
     C*                                                                   S01465
     C           *LIKE     DEFN CNUM      SVCNUM                          S01465
     C           *LIKE     DEFN CRNM      SVCRNM                          S01465
     C           *LIKE     DEFN CTWN      SVCTWN                          S01465
     C**                                                                  S01117
0275 C**
0276 C**   FIRST CYCLE
0277 C**
0278 C   40                GOTO ENDFC
0279 C                     SETON                     40
      **                                                                  S01117
      **   IN THE DATAAREA RUNDAT                                         S01117
      **                                                                  S01117
     C           *NAMVAR   DEFN RUNDAT    RUNDT                           S01117
     C                     IN   RUNDT                                     S01117
     C/COPY WNCPYSRC,LE0630C010
     C*    DEFINE LDA                                                     S01117
     C           *NAMVAR   DEFN           LDA                             S01117
     C           *LOCK     IN   LDA                                       S01117
     C**                                                                  S01117
0280 C                     EXSR ZSYSTM
0281 C***99*********       SETON                     U7U8LR               S01194
     C***99*********       MOVE 'TABLE'   DBFILE                          S01194
0283 C***99*********       MOVE ZTABKY    DBKEY                           S01194
0284 C***99*********       Z-ADD1         DBASE            DBASE 1        S01194
0285 C**
0286 C**   ACCESS ICD-5 FOR BRANCH NAME IND.
0287 C**
     C**    IF MULTIBRANCH AND BRANCH NAME ON CONFIRMATION (BRNC),        S01117
     C**    PRINT BRANCH NAME ON THE STATEMENT                            S01117
     C**                                                                  S01117
0288 C**************       MOVE '40'      ZTABKY                          S01194
0289 C***********ZTABKY    CHAINTABLE                99                   S01194
     C*                                                                   S01465
     C** Access SAR details file to determine if                          S01465
     C** core feature (S01465) is switched ON                             S01465
     C*                                                                   S01465
     C                     CALL 'AOSARDR0'                                S01465
     C                     PARM *BLANKS   @RTCD   7                       S01465
     C                     PARM '*VERIFY' @OPTN   7                       S01465
     C                     PARM 'S01465'  @SARD   6                       S01465
     C           SCSARD    PARM SCSARD    DSFDY                           S01465
     C                     MOVE 'N'       S01465  1                       S01465
     C*                                                                   S01465
     C** If core feature is switched ON, set a variable field to          S01465
     C** condition the rest of the processing                             S01465
     C*                                                                   S01465
     C           @RTCD     IFEQ *BLANKS                                   S01465
     C                     MOVE 'Y'       S01465                          S01465
     C                     ELSE                                           S01465
     C*                                                                   S01465
     C** else, database error (return code other than *NRF)               S01465
     C*                                                                   S01465
     C           @RTCD     IFNE '*NRF   '                                 S01465
     C                     MOVEL'LE0630 ' DBPGM                           S01465
     C                     MOVEL'SCSARDPD'DBFILE           ************   S01465
     C                     MOVEL'*VERIFY' DBKEY            * DBERR 09 *   S01465
     C                     Z-ADD09        DBASE            ************   S01465
     C                     SETON                     U7U8LR               S01465
     C                     GOTO ENDLR                                     S01465
     C                     END                                            S01465
     C                     END                                            S01465
      *                                                                   CLE004
      ** Access SAR details file to determine if CLE004 is switched on    CLE004
      *                                                                   CLE004
     C                     CALL 'AOSARDR0'                                CLE004
     C                     PARM *BLANKS   @RTCD   7                       CLE004
     C                     PARM '*VERIFY' @OPTN   7                       CLE004
     C                     PARM 'CLE004'  @SARD   6                       CLE004
     C           SCSARD    PARM SCSARD    DSFDY                           CLE004
      *                                                                   CLE004
      ** If core feature is switched ON, set a variable field to          CLE004
      ** condition the rest of the processing                             CLE004
      *                                                                   CLE004
     C           @RTCD     IFEQ *BLANKS                                   CLE004
     C                     MOVE 'Y'       CLE004  1                       CLE004
     C                     ELSE                                           CLE004
     C                     MOVE 'N'       CLE004                          CLE004
      *                                                                   CLE004
      ** else, database error (return code other than *NRF)               CLE004
      *                                                                   CLE004
     C           @RTCD     IFNE '*NRF   '                                 CLE004
     C                     MOVEL'LE0630 ' DBPGM                           CLE004
     C                     MOVEL'SCSARDPD'DBFILE           ************   CLE004
     C                     MOVEL'*VERIFY' DBKEY            * DBERR 11 *   CLE004
     C                     Z-ADD11        DBASE            ************   CLE004
     C                     SETON                     U7U8LR               CLE004
     C                     GOTO ENDLR                                     CLE004
     C                     ENDIF                                          CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE006
      ** Access SAR details file to determine if CLE006 is switched on    CLE006
      *                                                                   CLE006
     C                     CALL 'AOSARDR0'                                CLE006
     C                     PARM *BLANKS   @RTCD   7                       CLE006
     C                     PARM '*VERIFY' @OPTN   7                       CLE006
     C                     PARM 'CLE006'  @SARD   6                       CLE006
     C           SCSARD    PARM SCSARD    DSFDY                           CLE006
      *                                                                   CLE006
      ** If core feature is switched ON, set a variable field to          CLE006
      ** condition the rest of the processing                             CLE006
      *                                                                   CLE006
     C           @RTCD     IFEQ *BLANKS                                   CLE006
     C                     MOVE 'Y'       CLE006  1                       CLE006
     C                     ELSE                                           CLE006
     C                     MOVE 'N'       CLE006                          CLE006
      *                                                                   CLE006
      ** else, database error (return code other than *NRF)               CLE006
      *                                                                   CLE006
     C           @RTCD     IFNE '*NRF   '                                 CLE006
     C                     MOVEL'LE0630 ' DBPGM                           CLE006
     C                     MOVEL'SCSARDPD'DBFILE           ************   CLE006
     C                     MOVEL'*VERIFY' DBKEY            * DBERR 12 *   CLE006
     C                     Z-ADD12        DBASE            ************   CLE006
     C                     SETON                     U7U8LR               CLE006
     C                     GOTO ENDLR                                     CLE006
     C                     ENDIF                                          CLE006
     C                     ENDIF                                          CLE006
      *                                                                   CLE006
      ** Access SAR details file to determine if CLE007 is switched on    CLE015
      *                                                                   CLE015
     C                     CALL 'AOSARDR0'                                CLE015
     C                     PARM *BLANKS   @RTCD   7                       CLE015
     C                     PARM '*VERIFY' @OPTN   7                       CLE015
     C                     PARM 'CLE007'  @SARD   6                       CLE015
     C           SCSARD    PARM SCSARD    DSFDY                           CLE015
      *                                                                   CLE015
      ** If core feature is switched ON, set a variable field to          CLE015
      ** condition the rest of the processing                             CLE015
      *                                                                   CLE015
     C           @RTCD     IFEQ *BLANKS                                   CLE015
     C                     MOVE 'Y'       CLE007  1                       CLE015
     C                     ELSE                                           CLE015
     C                     MOVE 'N'       CLE007                          CLE015
      *                                                                   CLE015
      ** else, database error (return code other than *NRF)               CLE015
      *                                                                   CLE015
     C           @RTCD     IFNE '*NRF   '                                 CLE015
     C                     MOVEL'LE0630 ' DBPGM                           CLE015
     C                     MOVEL'SCSARDPD'DBFILE           ************   CLE015
     C                     MOVEL'*VERIFY' DBKEY            * DBERR 14 *   CLE015
     C                     Z-ADD14        DBASE            ************   CLE015
     C                     SETON                     U7U8LR               CLE015
     C                     GOTO ENDLR                                     CLE015
     C                     ENDIF                                          CLE015
     C                     ENDIF                                          CLE015
      *                                                                   CEU020
      ** Check if CEU020 is switched on                                   CEU020
      *                                                                   CEU020
     C                     CALL 'AOSARDR0'                                CEU020
     C                     PARM *BLANKS   @RTCD                           CEU020
     C                     PARM '*KEY   ' @OPTN                           CEU020
     C                     PARM 'CEU020'  @SARD                           CEU020
     C           SCSARD    PARM SCSARD    DSFDY                           CEU020
      *                                                                   CEU020
     C           @RTCD     IFEQ *BLANKS                                   CEU020
     C                     MOVE 'Y'       CEU020  1                       CEU020
     C                     ELSE                                           CEU020
     C                     MOVE 'N'       CEU020                          CEU020
      *                                                                   CEU020
     C           @RTCD     IFNE '*NRF    '                                CEU020
     C                     MOVEL'SCSARDPD'DBFILE           ************   CEU020
     C                     Z-ADD13        DBASE            * DBERR 13 *   CEU020
     C                     MOVEL'CEU020'  DBKEY            ************   CEU020
     C                     SETON                     U7U8LR               CEU020
     C                     GOTO ENDLR                                     CEU020
     C                     ENDIF                                          CEU020
     C                     ENDIF                                          CEU020
     C/COPY WNCPYSRC,LE0630C001
     C**                                                                  S01194
     C** ACCESS TRADING DATA                                              S01194
     C**                                                                  S01194
     C                     CALL 'AOTRADR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDTRAD    PARM SDTRAD    DSFDY                           S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     SETON                     99                   S01194
     C                     MOVEL'SDTRADPD'DBFILE                          S01194
     C                     MOVEL@OPTN     DBKEY                           S01194
     C                     END                                            S01194
0290 C**N99******RECI      COMP 'D'                  9999                 S01194
0291 C   99                SETON                     U7U8LR
0292 C***99*********       MOVE 'TABLE'   DBFILE                          S01194
0293 C***99*********       MOVELZTABKY    DBKEY                           S01194
0294 C   99                Z-ADD6         DBASE            DBASE 6
0295 C***99******          GOTO END                                       S01194
0295 C   99                GOTO ENDLR                                     S01194
     C**                                                                  S01194
     C** ACCESS MIDAS MODULE DETAILS                                      S01194
     C**                                                                  S01194
     C                     CALL 'AOMMODR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDMMOD    PARM SDMMOD    DSFDY                           S01194
     C           @RTCD     IFNE *BLANKS                                   S01194
     C                     SETON                     U7U8LR               S01194
     C                     SETON                     99                   S01194
     C                     MOVEL'SDMMODPD'DBFILE             *************S01194
     C                     MOVEL'008'     DBASE              * DBERR 008 *S01194
     C                     MOVEL@OPTN     DBKEY              *************S01194
     C                     GOTO ENDLR                                     S01194
     C                     END                                            S01194
0296 C**                                                                  S01117
0297 C***********BRNC      COMP 'Y'                      30               S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C           BRNC      ANDEQ'Y'                                       S01117
     C                     SETON                     30                   S01117
     C                     ELSE                                           S01117
     C                     SETOF                     30                   S01117
     C                     END                                            S01117
0298 C**
     C                     Z-ADD0         PGNO    30                      155278
      *                                                                   155278
0299 C                     Z-ADD1         COUNT   50
0300 C**************       MOVEL'20'      CCYKEY                          S01194
0301 C**************       MOVE '1'       CCYKEY                          S01194
0302 C**************       MOVEL'10'      BRKEY  12                       S01194
0303 C**************       MOVEL'43'      LOKEY                           S01194
0304 C**************       MOVE ' '       CLIKEY  7                       S01194
0305 C                     MOVE ' '       BLANKS 11
0306 C                     SETON                     47
0307 C                     GOTO END
0308 C           ENDFC     TAG                             ** ENDFC TAG **
0309 C**
0310 C**   MAIN PROCESSING
0311 C**   AT CHANGE OF BRANCH ACCESS BRANCH NAME
0312 C**
     C*                                                                   S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C**                                                                  S01117
     C           *INL2     IFEQ '1'                                       S01117
     C                     CLOSELE0630P1                                  S01117
     C**                                                                  S01117
     C*       IF MBIN=YES, AND A LEVEL BREAK,                             S01117
     C*       OPEN LE0630P1                                               S01117
     C**                                                                  S01117
     C                     MOVE 'Y'       P1OP    1                       S01117
     C                     OPEN LE0630P1                                  S01117
     C**                                                                  S01117
     C*       ENSURE REPORT SPOOL FILE RECORDED BY RCF                    S01117
     C**                                                                  S01117
     C                     Z-ADDSFNUM     ZSNUM                           S01117
     C                     OUT  LDA                                       S01117
      *                                                                   S01117
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           SEQ     5                       S01117
     C                     PARM BRCA      SENTY   3                       S01117
     C                     PARM           SFILE                           S01117
     C                     PARM           ZSNUM   60                      S01117
     C                     PARM           ZSERR   1                       S01117
      *                                                                   S01117
     C           *LOCK     IN   LDA                                       S01117
     C           ZSERR     IFEQ 'Y'                                       S01117
      **  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM       S01117
     C                     SETON                     U7U8LR               S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C**                                                                  S01117
     C*  To get Branch Name(in BRNM) :                                    S01117
     C**                                                                  S01117
     C**********           CALL 'AOBRCHR0'                                S01117              CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       S01117
     C                     PARM '*KEY   ' @OPTN   7                       S01117
     C                     PARM BRCA      @DSNB   3                       S01117
     C********** SDBRCH    PARM SDBRCH    DSFDY                           S01117              CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANKS                                   S01117
     C                     MOVEL@DSNB     DBKEY                           S01117
     C                     MOVEL'SDBRCHPD'DBFILE           ************   S01117
     C                     Z-ADD5         DBASE            * DBASE 05 *   S01117
     C                     SETON                     U7U8LR***************S01117
     C   U8                GOTO ENDLR                                     S01117
     C                     END                                            S01117
     C**                                                                  S01117
     C                     END                                            S01117
     C**                                                                  S01117
     C                     ELSE                                           S01117
     C**                                                                  S01117
     C*       IF MBIN='N' AND FIRST CYCLE,                                S01117
     C*       OPEN LE0630P1                                               S01117
     C**                                                                  S01117
     C           P1OP      IFNE 'Y'                                       S01117
     C                     MOVE 'Y'       P1OP    1                       S01117
     C                     OPEN LE0630P1                                  S01117
     C**                                                                  S01117
     C*       ENSURE REPORT SPOOL FILE RECORDED BY RCF                    S01117
     C**                                                                  S01117
     C                     Z-ADDSFNUM     ZSNUM                           S01117
     C                     OUT  LDA                                       S01117
      *                                                                   S01117
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           SEQ                             S01117
     C                     PARM BRCA      SENTY   3                       S01117
     C                     PARM           SFILE                           S01117
     C                     PARM           ZSNUM   60                      S01117
     C                     PARM           ZSERR   1                       S01117
      *
     C           *LOCK     IN   LDA                                       S01117
     C           ZSERR     IFEQ 'Y'                                       S01117
      **  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM       S01117
     C                     SETON                     U7U8LR               S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C                     END                                            S01117
0260 C**                                                                  S01117
0313 C***L2******          MOVE BRCD      BRKEY                           S01117
0314 C***L2******          SETOF                     99                   S01117
0315 C***L2******BRKEY     CHAINTABLE                99                   S01117
0316 C***L2N99***RECI      COMP 'D'                  9999                 S01117
0317 C***L2*99***          MOVE 'TABLE'   DBFILE                          S01117
0318 C***L2*99***          MOVE BRKEY     DBKEY                           S01117
0319 C***L2*99***          Z-ADD2         DBASE            DBASE 2        S01117
0320 C***L2*99***          SETON                     U7U8LR               S01117
0321 C***L2*99***          SETON                     47                   S01117
0322 C***L2*99***          GOTO END                                       S01117
0323 C**
0324 C**   EXECUTE SUBROUTINE ACCORDING TO INPUT
0325 C**
     C/COPY WNCPYSRC,LE0630C002
0326 C           COUNT     ADD  1         COUNT                           156678
     C/COPY WNCPYSRC,LE0630C020
      *                                                                   155278
      ** Processing should only be done for DEMAND/CALL loans.            155278
      *                                                                   155278
     C           PTYP      IFEQ 61                                        155278
     C           PTYP      OREQ 68                                        155278
     C           PTYP      OREQ 69                                        155278
      *                                                                   155278
0326 C***********COUNT     ADD  1         COUNT                           156678
0327 C   01                EXSR INTHED
0328 C   02                EXSR RATECH
0329 C   03                EXSR MOVE
      *                                                                   155278
     C                     ENDIF                                          155278
      *                                                                   155278
0330 C           END       TAG                             ** END TAG ****
0331 C**
0332 C**   TOTAL TIME CALCS- OUTPUT C/F LINE
     C**     IF C/F BAL AND INTEREST BOTH ZERO AT MATURITY
     C**      DON'T OUTPUT C/F LINE
      *                                                                   155278
     CL1         PTYP      IFEQ 61                                        155278
     CL1         PTYP      OREQ 68                                        155278
     CL1         PTYP      OREQ 69                                        155278
      *                                                                   155278
     CL1N47 52   BALL      COMP 0                        52
     CL1N47 52   INTO      COMP 0                        47
     C**
0333 C**
     C/COPY WNCPYSRC,LE0630C003
0334 CL1N47                SETON                     45
0335 C*1N47****************EXCPT                                          E12727
0335 C*1N47 31*************EXCPTTLX                                       E12727
0335 C*1N47 31*************ADD  1         TELEX   30                      E12727
0335 CL1                   EXCPT                                          E12727
0335 CL1    31             EXCPTTLX                                       E12727
0335 CL1    31             ADD  1         TELEX   30                      E12727
0336 CL1N47                SETOF                     45
      *                                                                   155278
     CL1                   ENDIF                                          155278
      *                                                                   155278
0337 C**
0338 C**   LAST RECORD CALCS
0339 C**
     C*       ENSURE TOTAL SPOOL FILE RECORDED BY RCF                     S01117
     C**                                                                  S01117
     CLR                   Z-ADDSFNUMU    ZSNUMU                          S01117
     CLR                   OUT  LDA                                       S01117
      *                                                                   S01117
     CLR                   CALL 'ZSFILE'                                  S01117
     CLR                   PARM           SEQ                             S01117
     CLR                   PARM *BLANK    SENTY   3                       S01117
     CLR                   PARM           SFILEU                          S01117
     CLR                   PARM           ZSNUMU  60                      S01117
     CLR                   PARM           ZSERR   1                       S01117
      *                                                                   S01117
     CLR         *LOCK     IN   LDA                                       S01117
     CLR         ZSERR     IFEQ 'Y'                                       S01117
      **  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM       S01117
     CLR                   SETON                     U7U8LR               S01117
     CLR                   RETRN                                          S01117
     CLR                   END                                            S01117
     C**                                                                  S01117
     C**                                                                  S01117
     CLR         ENDLR     TAG                                            S01117
0340 C***LR*****    COUNT     COMP NORE                 U8U8                                  CLE134
0340 C***LR*****    COUNT     COMP 2                      4949                       000040   CLE134
     C***LR*****    TELEX     COMP 0                        23                                CLE134
     CLR 40      COUNT     COMP NORE                 U8U8                                     CLE134
     CLR 40      COUNT     COMP 2                      4949                                   CLE134
     CLR 40      TELEX     COMP 0                        23                                   CLE134
0341 CLR U7                MOVE 'LE0630'  DBPGM
     C**                                                                  S01117
     C******WHEN*LR*INDICATOR*SET*ON*WITHOUT*EXECUTING*THE*FIRST*CYCLE,***S01117
     C******SET*ON*'NO*DETAILS*TO*REPORT'*IN*AU***************************S01117
     C************                                                  S01117000040
     C*LR*********P1OP      IFNE 'Y'                                S01117000040
     C*LR*********          SETON                     47            S01117000040
     C*LR*********          END                                     S01117000040
     CLR U7                EXSR *PSSR                                     S01117
0342 C********************************************************************
0343 C*                                                                  *
0344 C*    INTHED SR. TO PROCESS INTEREST HEADERS                        *
0345 C*                                                                  *
0346 C           INTHED    BEGSR                           ** INTHED BEGSR
0347 C                     SETOF                     47
     C**
     C**   COUNT NUMBER STATMENTS PRODUCED
     C**
     C                     ADD  1         NOST    50
0348 C**
0349 C*****ACCESS CUSTOMER NAME AND ADDRESS****** LE/TX REDUNDANT         S01194
0349 C**   SO TLXM DOES NOT HAVE AN SDMMODPD EQUIVALENT                   S01194
0350 C**
     C**************       TESTB'3'       TLXM           31               S01194
     C********** *IN31     IFEQ '1'                                       S01194
     C**************       MOVELCNUM      CLIKEY                          S01194
     C**************       MOVE 'A'       CLIKEY                          S01194
     C***********CLIKEY    CHAINCLINT                99    = NOT FOUND    S01194
     C**N99******RECI      COMP 'D'                  9999                 S01194
     C********** *IN99     IFEQ '1'                                       S01194
     C**************       MOVE 'CLINT'   DBFILE                          S01194
     C**************       MOVE CLIKEY    DBKEY                           S01194
     C**************       Z-ADD7         DBASE            DBASE 7        S01194
     C**************       SETON                     U7U8LR               S01194
     C**************       MOVE '1'       *IN47                           S01194
     C**************       GOTO IEND                                      S01194
     C**************       END                                            S01194
     C**************       TESTB'3'       TLXR           31               S01194
     C***31*********       TESTB'2'       TLEN           31               S01194
     C**************       END                                            S01194
     C  NU1                SETOF                         31
0351 C**************       MOVELCNUM      CLIKEY                          S01194
0504 C*
     C* CHECK VALUE OF ALTERNATE NAME & ADDRESS CODE IS NOT EQUAL TO 'B'  LN0007
     C* IFEQ 'B' BYPASS ALTERNATE NAME & ADDRESS VALIDATION               LN0007
     C***********NACD      IFNE 'B'                                 LN0007LN0305
0505 C*
0351 C**************       MOVELCNUM      CLIKEY  6                 S01194BHF033
0351 C                     MOVELCNUM      CLIKEY 10                       BHF033
0352 C**************       MOVE NACD      CLIKEY                          S01194
0353 C***********CUST      TAG                             ** CUST TAG ***S01194
0354 C                     SETOF                     99
     C           NACD      IFNE 'B'                                       LN0305
     C                     MOVE CNUM      AENB    6                       S01194
0355 C***********CLIKEY    CHAINCLINT                99                   S01194
     C                     CALL 'AOALTNR0'                                S01194
     C                     PARM '*BLANKS' @RTCD                           S01194
     C                     PARM '*KEY   ' @OPTN                           S01194
     C                     PARM           AENB                            S01194
     C                     PARM NACD      AZCD    1                       S01194
     C           SDALTN    PARM SDALTN    DSFDY                           S01194
     C                     END                                            LN0007
0358 C**   IF ALTERNATE NAME AND ADDRESS RECORD NOT FOUND DEFAULT         S01194
0359 C**   TO NAME AND ADDRESS ON SDCUSTPD                                S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C           NACD      OREQ 'B'                                       LN0007
     C                     CALL 'AOCUSTR0'                                S01194
     C                     PARM '*MSG   ' @RTCD                           S01194
     C                     PARM '*KEY   ' @OPTN                           S01194
     C                     PARM           CLIKEY                          S01194
     C                     PARM '*CNUM  ' KEYSTS  7                       S01194
     C           SDCUST    PARM SDCUST    DSSDY                           S01194
     C           @RTCD     IFNE *BLANKS                                   S01194
     C                     SETON                     99                   S01194
     C                     END                                            S01194
     C           *IN99     IFEQ '1'                                       S01194
     C                     MOVEL'SDCUSTPD'DBFILE                          S01194
     C                     MOVE CLIKEY    DBKEY                           S01194
     C                     Z-ADD7         DBASE            DBASE 7        S01194
     C                     SETON                     U7U8LR               S01194
     C                     MOVE '1'       *IN47                           S01194
     C                     GOTO IEND                                      S01194
     C                     ELSE                                           S01194
     C                     MOVELBBCNA1    CNA1                            S01194
     C                     MOVELBBCNA2    CNA2                            S01194
     C                     MOVELBBCNA3    CNA3                            S01194
     C                     MOVELBBCNA4    CNA4                            S01194
     C                     END                                            S01194
     C                     END                                            S01194
     C*                                                                   S01465
     C** If core feature is swithced ON, chain to CLOAN file to get       S01465
     C** customer confirmation field                                      S01465
     C*                                                                   S01465
     C           S01465    IFEQ 'Y'                                       S01465
     C                     MOVELLNRF      CLOKEY  7                       S01465
     C                     MOVE 'A'       CLOKEY                          S01465
     C           CLOKEY    CHAINCLOAN                99                   S01465
     C   99      CLOKEY    CHAINMLOAN                99                   159022
     C*                                                                   S01465
     C** Database error if no record found                                S01465
     C*                                                                   S01465
     C           *IN99     IFEQ '1'                                       S01465
     C***                  MOVEL'CLOAN   'DBFILE           ******* S01465 159022
     C                     MOVEL'C/MLOAN 'DBFILE           ************   159022
     C                     MOVELCLOKEY    DBKEY            * DBERR 10 *   S01465
     C                     Z-ADD10        DBASE            ************   S01465
     C                     SETON                     U7U8LR               S01465
     C                     SETON                     47                   S01465
     C                     GOTO IEND                                      S01465
     C                     ELSE                                           S01465
     C*                                                                   S01465
     C** Else, if customer confirmation field is not blank, then access   S01465
     C** customer details and print name and address instead of loan      S01465
     C** customer name and address                                        S01465
     C*                                                                   S01465
     C********** COCUCL    IFNE *ZERO                                                  S01465 CSD027
     C           COCUCL    IFNE *BLANKS                                                       CSD027
     C           COCUCL    ANDNE'000000'                                                    BUG11782
     C                     MOVELCOCUCL    CLIKEY 10                       S01465
     C                     MOVE CNUM      SVCNUM                          S01465
     C                     MOVE CRNM      SVCRNM                          S01465
     C                     MOVE CTWN      SVCTWN                          S01465
     C*                                                                   S01465
     C** Call program to access customer details                          S01465
     C*                                                                   S01465
     C                     CALL 'AOCUSTR0'                                S01465
     C                     PARM '*MSG   ' @RTCD                           S01465
     C                     PARM '*KEY   ' @OPTN                           S01465
     C                     PARM           CLIKEY                          S01465
     C                     PARM '*CNUM  ' KEYSTS  7                       S01465
     C           SDCUST    PARM SDCUST    DSSDY                           S01465
     C           @RTCD     IFNE *BLANKS                                   S01465
     C                     SETON                     99                   S01465
     C                     END                                            S01465
     C           *IN99     IFEQ '1'                                       S01465
     C                     MOVEL'SDCUSTPD'DBFILE                          S01465
     C                     MOVE CLIKEY    DBKEY                           S01465
     C                     Z-ADD7         DBASE            DBASE 7        S01465
     C                     SETON                     U7U8LR               S01465
     C                     MOVE '1'       *IN47                           S01465
     C                     GOTO IEND                                      S01465
     C                     ELSE                                           S01465
     C                     MOVELBBCNA1    CNA1                            S01465
     C                     MOVELBBCNA2    CNA2                            S01465
     C                     MOVELBBCNA3    CNA3                            S01465
     C                     MOVELBBCNA4    CNA4                            S01465
     C                     MOVE SVCNUM    CNUM                            S01465
     C                     MOVE SVCRNM    CRNM                            S01465
     C                     MOVE SVCTWN    CTWN                            S01465
     C                     END                                            S01465
     C                     END                                            S01465
     C                     END                                            S01465
     C                     END                                            S01465
0357 C**************                                                      S01194
0358 C*****IF*ALTERNATE NAME AND ADDRESS RECORD NOT FOUND DEFAULT         S01194
0359 C*****TO*B*RECORD. DATABASE ERROR ONLY IF B RECORD NOT FOUND.        S01194
0360 C**************                                                      S01194
0361 C***99*********       MOVE CLIKEY    CHECK   1                       S01194
0362 C***99******CHECK     COMP 'B'                  3535                 S01194
0363 C***99*35******       MOVE 'B'       CLIKEY                          S01194
0364 C***99*35******       GOTO CUST                                      S01194
0365 C**************                                                      S01194
0366 C***99*********       MOVE 'CLINT'   DBFILE                          S01194
0367 C***99*********       MOVE CLIKEY    DBKEY                           S01194
0368 C***99*********       Z-ADD3         DBASE            DBASE 3        S01194
0369 C***99*********       SETON                     U7U8LR               S01194
0370 C***99*********       SETON                     47                   S01194
0371 C***99*********       GOTO IEND                                      S01194
0372 C**
0373 C**   ACCESS CURRENCY FOR CDPS AND NAME
0374 C**
0375 C                     SETOF                     99
     C                     Z-ADDCURARR    A                                                 CLE075AO
     C********** CCY       LOKUP#CCY,A                   48                        CLE075AO MD020290
     C           CCY       LOKUP#CCY,A                   26                                 MD020290
     C           *IN48     IFEQ '1'                                                         CLE075AO
     C           A         OCUR SDCURR                                                      CLE075AO
     C                     ELSE                                                             CLE075AO
0376 C***********CCYKEY    CHAINTABLE                99                   S01194
     C                     CALL 'AOCURRR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C                     PARM CCY       TKEY    3                    A  S01194
     C           SDCURR    PARM SDCURR    DSSDY                        B  S01194
0377 C**N99******RECI      COMP 'D'                  9999                 S01194
     C           @RTCD     IFNE *BLANKS                                   S01194
     C                     SETON                     99                   S01194
     C                     MOVE 'SDCURRPD'DBFILE                          S01194
     C                     MOVELCCY       DBKEY                           S01194
     C                     END                                            S01194
0378 C***99*********       MOVE 'TABLE'   DBFILE                          S01194
0379 C***99*********       MOVE CCYKEY    DBKEY                           S01194
0380 C   99                Z-ADD4         DBASE            DBASE 4
0381 C   99                SETON                     U7U8LR
0382 C   99                SETON                     47
0383 C   99                GOTO IEND
     C                     ENDIF                                                            CLE075AO
0384 C**
0385 C           CDP       COMP 1                      6061
0386 C           CDP       COMP 2                    63  62
0387 C**
0388 C**   ACCESS LOAN TYPE/SUB TYPE RECORD
0389 C**
0390 C                     SETOF                     99
0391 C***********LOKEY     CHAINTABLE                99                   S01194
     C                     MOVELLTYP      TMPLN   4                                         CLE075AO
     C                     MOVE SUTP      TMPLN                                             CLE075AO
     C                     MOVELTMPLN     KEYLOA                                            CLE075AO
     C                     MOVE CLAS      KEYLOA                                            CLE075AO
     C                     ADD  1         LOASEQ                                            CLE075AO
     C                     EXSR CHKLOA                                                      CLE075AO
      *                                                                                     CLE075AO
      ** Use details from array if LOAKEY is found, otherwise,                              CLE075AO
      ** retrieve details from program call                                                 CLE075AO
      *                                                                                     CLE075AO
     C           LOAIC     IFEQ 'Y'                                                         CLE075AO
      *                                                                                     CLE075AO
      ** Set occurence to index found from #LOK array                                       CLE075AO
      *                                                                                     CLE075AO
     C           Q         OCUR SDLOAN                                                      CLE075AO
      *                                                                                     CLE075AO
     C                     ELSE                                                             CLE075AO
      *                                                                                     CLE075AO
     C           LOAIDX    IFNE 0                                                           CLE075AO
     C                     Z-ADDLOAIDX    Q                                                 CLE075AO
     C                     ELSE                                                             CLE075AO
     C                     Z-ADD1         Q                                                 CLE075AO
     C                     MOVEA#LOA      #LOS                                              CLE075AO
     C                     SORTA#LOS                                                        CLE075AO
     C                     Z-ADD#LOS,1    LOAKEY                                            CLE075AO
     C           LOAKEY    LOKUP#LOA,Q                   25                                 CLE075AO
     C                     ENDIF                                                            CLE075AO
      *                                                                                     CLE075AO
     C           Q         OCUR SDLOAN                                                      CLE075AO
      *                                                                                     CLE075AO
     C                     CALL 'AOLOANR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN                           S01194
     C                     PARM LTYP      ATCD    2                       S01194
     C                     PARM SUTP      AUCD    2                       S01194
     C                     PARM CLAS      AUCL    4                                           CLE042
     C           SDLOAN    PARM SDLOAN    DSFDY                           S01194
0392 C**N99******RECI      COMP 'D'                  9999                 S01194
     C           @RTCD     IFNE *BLANKS                                   S01194
     C                     SETON                       99                 S01194
     C                     MOVE 'SDLOANPD'DBFILE                          S01194
     C           LTYP      CAT  SUTP:1    DBKEY                                               CLE042
     C                     CAT  CLAS:1    DBKEY                                               CLE042
     C*********************MOVELLTYP      DBKEY                                        S01194 CLE042
     C*********************MOVE SUTP      DBKEY                                        S01194 CLE042
     C                     ELSE                                                             CLE075AO
     C                     EXSR ADDLOA                                                      CLE075AO
     C                     ENDIF                                                            CLE075AO
     C                     END                                            S01194
0393 C***99*********       MOVE 'TABLE'   DBFILE                          S01194
0394 C***99*********       MOVE LOKEY     DBKEY                           S01194
0395 C   99                Z-ADD5         DBASE            DBASE 5
0396 C   99                SETON                     U7U8LR
0397 C   99                SETON                     47
0398 C   99                GOTO IEND
0399 C**
0400 C**   CHECK FOR CAPITALISED
0401 C**
0402 C           INTC      COMP 'Y'                      42
0403 C**
0404 C**   CALCULATE PAGE NO.
0405 C**
0406 C***********STPG      ADD  1         PGNO    30                      155278
0406 C                     ADD  1         PGNO                            155278
0407 C**
0408 C**   CONVERT VALUE DATE
0409 C**
0410 C                     Z-ADDVDAT      ZDAYNO
0411 C                     EXSR ZDATE2
0412 C                     MOVE ZADATE    VDATA   7
     C/COPY WNCPYSRC,LE0630C011
0413 C**
     C*  ARRANGE DATES INTO DDMMYY FORMAT FOR OUTPUT TO TELEX FILE
     C*
     C                     MOVE ZYEAR     ZWRK4
     C                     MOVELZMTH      ZWRK4
     C                     MOVE ZWRK4     TXDATE  60
     C                     MOVELZDAY      TXDATE
     C*
0414 C**   SET UP AMOUNT FIELDS
0415 C**
     C/COPY WNCPYSRC,LE0630C016
0416 C           IOPS      SUB  IPPS      INTO   130
     C/COPY WNCPYSRC,LE0630C017
0417 C                     Z-ADDPPIS      BALL
     C/COPY WNCPYSRC,LE0630C018
0418 C                     Z-ADD0         LINES   20
0419 C**
0420 C**   CALCULATE OLD EFFECTIVE INTEREST RATE
0421 C**
0422 C           SPINL     COMP 'A'                      35
0423 C   35      BRTEL     ADD  RTSPL     ORATE  117
0424 C**
0425 C           SPINL     COMP 'S'                      35
0426 C   35      BRTEL     SUB  RTSPL     ORATE
0427 C**
0428 C           SPINL     COMP 'P'                      35
0429 C   35      RTSPL     DIV  100       PERC   117H
0430 C   35      PERC      MULT BRTEL     ORATE     H
0431 C**
0432 C**   CHECK FOR ADJUSTMENT
0433 C**
     C/COPY WNCPYSRC,LE0630C019
0434 C           PRAM      COMP PPIS                 4343
0435 C  N43      INTA      COMP IOPS                 4343
0436 C   43      INTA      SUB  IPPS      ADJI   130
0437 C**
0438 C**   OUTPUT TO REPORT
0439 C**
     C/COPY WNCPYSRC,LE0630C004
0440 C                     SETON                     41
0441 C                     EXCPT
0441 C   31                EXCPTTLX
0442 C                     SETOF                     4143
0443 C                     Z-ADDPRAM      BALL
0444 C                     Z-ADDORATE     ERATE
     C/COPY WNCPYSRC,LE0630C005
0445 C**
0446 C           IEND      ENDSR                           ** IEND ENDSR *
0447 C*                                                                  *
0448 C********************************************************************
0449 C********************************************************************
0450 C*                                                                  *
0451 C*    RATECH SR. TO PROCESS RATE CHANGE RECORDS                     *
0452 C*                                                                  *
0453 C           RATECH    BEGSR                           ** RATECH BEGSR
0454 C**
0455 C**   CONVERT VALUE DATE
0456 C**
0457 C                     EXSR SETUP
0458 C                     Z-ADDVDAT      ZDAYNO
0459 C                     EXSR ZDATE2
0460 C                     MOVE ZADATE    VDATA
     C/COPY WNCPYSRC,LE0630C012
0461 C**
0462 C**   CHANGE FIELDS ACCORDING TO CHANGE TYPE
0463 C**
0464 C           AMTP      COMP 'BC'                     35
0465 C  N35      AMTP      COMP 'BR'                     35
0466 C   35                Z-ADDBRTE      BRTEL
0467 C**
0468 C           AMTP      COMP 'SC'                     35
0469 C   35                Z-ADDRTSP      RTSPL
0470 C**
0471 C           AMTP      COMP 'RO'                     35
      *                                                                   CLE006
      ** Check if amendment type is MC, if not RO                         CLE006
      *                                                                   CLE006
     C           *IN35     IFEQ '0'                                       CLE006
     C           CLE006    ANDEQ'Y'                                       CLE006
     C           *IN35     OREQ '0'                                       CEU020
     C           CEU020    ANDEQ'Y'                                       CEU020
     C           *IN35     OREQ '0'                                       CLE015
     C           CLE007    ANDEQ'Y'                                       CLE015
     C           AMTP      COMP 'MC'                     35               CLE006
     C                     ENDIF                                          CLE006
      *                                                                   CLE006
0472 C   35                Z-ADDBRTE      BRTEL
0473 C   35                Z-ADDRTSP      RTSPL
0474 C   35                MOVE SPIN      SPINL
0475 C**
0476 C**   CALCULATE NEW EFFECTIVE INTEREST RATE
0477 C**
0478 C           SPINL     COMP 'A'                      35
0479 C   35      BRTEL     ADD  RTSPL     ERATE  117
0480 C**
0481 C           SPINL     COMP 'S'                      35
0482 C   35      BRTEL     SUB  RTSPL     ERATE
0483 C**
0484 C           SPINL     COMP 'P'                      35
0485 C   35      RTSPL     DIV  100       PERC      H
0486 C   35      PERC      MULT BRTEL     ERATE     H
0487 C**
0488 C**   CALCULATE DIFFERENCE BETWEEN NEW AND OLD RATES
0489 C**
     C           ERATE     SUB  ORATE     MAMTR  117   4650
0491 C**
0492 C**   CALCULATE INTEREST AMOUNT
0493 C**
0494 C           ACUP      SUB  IPPS      INTO   130H
     C/COPY WNCPYSRC,LE0630C006
0495 C                     Z-ADDERATE     ORATE
0496 C**
0497 C**   OUTPUT DETAILS
0498 C**
     C           SDAY      ADD  DAYS      SDAY    30
0500 C                     SETON                     4464
     C  N50                EXCPT
0501 C   31                EXCPTTLX
0502 C                     SETOF                     4464
0503 C**
0504 C**   ADD INTO TOTALS AND CHECK LINES
0505 C**
     C  N50      LINES     ADD  1         LINES
     C/COPY WNCPYSRC,LE0630C014
     C           LINES     COMP 11                       35
     C/COPY WNCPYSRC,LE0630C007
0508 C   35      PGNO      ADD  1         PGNO
     C   35                SETON                     4548
0510 C   35                EXCPT
     C   35                SETOF                     4548
0512 C**
0513 C   35                SETON                     41
0514 C   35                EXCPT
0515 C   35                SETOF                     41
0516 C   35                Z-ADD0         LINES
0517 C                     ENDSR
0518 C*                                                                  *
0519 C********************************************************************
0520 C********************************************************************
0521 C*                                                                  *
0522 C*    MOVE SR. TO PROCESS MOVEMENT RECORDS                          *
0523 C*                                                                  *
0524 C           MOVE      BEGSR                           ** MOVE BEGSR *
0525 C**
0526 C**   CONVERT DATE
0527 C**
0528 C                     EXSR SETUP
0529 C                     Z-ADDVDAT      ZDAYNO
0530 C                     EXSR ZDATE2
0531 C                     MOVE ZADATE    VDATA
     C/COPY WNCPYSRC,LE0630C013
0532 C**
0533 C**   MI - MANUAL INTEREST ADJUSTMENTS
0534 C**
0535 C           AMTP      COMP 'MI'                     35
0536 C   35                Z-ADDINTA      MAMT   130
0537 C**
0538 C**   MR - MANUAL REPAYMENT
0539 C**
0540 C           AMTP      COMP 'MR'                     35
      *                                                                   CLE004
      ** Check if amendment type is PF, if not MR                         CLE004
      **   PF - Principal Transfer From                                   CLE004
      *                                                                   CLE004
     C           *IN35     IFEQ '0'                                       CLE004
     C           CLE004    ANDEQ'Y'                                       CLE004
     C           AMTP      COMP 'PF'                     35               CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
0541 C   35      BALL      SUB  PRAM      BALL   130
0542 C   35      IPPS      ADD  INTA      IPPS
0543 C   35      PRAM      ADD  INTA      MAMT
0544 C   35      MAMT      ADD  FEAM      MAMT
0545 C**
0546 C**   IN - INTEREST PAYMENT
0547 C**
0548 C           AMTP      COMP 'IN'                     35
0549 C   35      IPPS      ADD  INTA      IPPS
0550 C   35 42   BALL      ADD  INTA      BALL
0551 C   35N42             Z-ADDINTA      MAMT
     C***35*42***          Z-ADD0         MAMT                            136784
     C           *IN35     IFEQ '1'                                       136784
     C           *IN42     ANDEQ'1'                                       136784
     C                     Z-ADDINTA      MAMT                            136784
     C                     END                                            136784
0553 C**
0554 C**   RE - REPAYMENT
0555 C**
0556 C           AMTP      COMP 'RE'                     35
0557 C   35      BALL      SUB  PRAM      BALL
0558 C   35      IPPS      ADD  INTA      IPPS
0559 C   35      PRAM      ADD  INTA      MAMT
0560 C**
0561 C**   MA - MATURITY
     C                     SETOF                     52
0562 C**
0563 C           AMTP      COMP 'MA'                     35
0564 C   35      BALL      SUB  PRAM      BALL
0565 C   35      IPPS      ADD  INTA      IPPS
0566 C   35 42   BALL      ADD  INTA      BALL
0567 C   35N42   PRAM      ADD  INTA      MAMT
0568 C   35 42             Z-ADDPRAM      MAMT
     C   35                SETON                     52
0569 C**
0570 C**   PI - PRINCIPLE INCREASE
0571 C**
0572 C           AMTP      COMP 'PI'                     35
      *                                                                   CLE004
      ** Check if amendment type is PT, if not PI                         CLE004
      **   PT - Principal Transfer To                                     CLE004
      *                                                                   CLE004
     C           *IN35     IFEQ '0'                                       CLE004
     C           CLE004    ANDEQ'Y'                                       CLE004
     C           AMTP      COMP 'PT'                     35               CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
0573 C   35      BALL      ADD  PRAM      BALL
0574 C   35                Z-ADDPRAM      MAMT
0575 C**
0576 C**   CALCULATE INTEREST AMOUNT
0577 C**
0578 C           ACUP      SUB  IPPS      INTO      H
     C/COPY WNCPYSRC,LE0630C008
0579 C**
0580 C**   OUTPUT DETAIL
0581 C**
     C           SDAY      ADD  DAYS      SDAY
0583 C                     SETON                     44
0584 C                     EXCPT
0584 C   31                EXCPTTLX
0585 C                     SETOF                     44
0586 C**
0587 C**   ADD INTO TOTALS AND CHECK LINES
0588 C**
0589 C           LINES     ADD  1         LINES
     C/COPY WNCPYSRC,LE0630C015
0590 C           LINES     COMP 11                       35
     C/COPY WNCPYSRC,LE0630C009
0591 C   35      PGNO      ADD  1         PGNO
     C   35                SETON                     4548
0593 C   35                EXCPT
     C   35                SETOF                     4548
0595 C**
0596 C   35                SETON                     41
0597 C   35                EXCPT
0598 C   35                SETOF                     41
0599 C   35                Z-ADD0         LINES
0600 C**
0601 C                     ENDSR
0602 C*                                                                  *
0603 C********************************************************************
0604 C********************************************************************
0605 C*                                                                  *
0606 C*    SETUP SR. TO SET UP NARTP FIELD                               *
0607 C*                                                                  *
0608 C           SETUP     BEGSR                           ** SETUP BEGSR
0609 C**
0610 C***********          MOVE BLANKS    NARTP  11                       CLE004
0610 C                     MOVE BLANKS    NARTP  16                       CLE004
      *                                                                   CLE004
0611 C***********AMTP      COMP 'BC'                     35               CLE004
0612 C***35******          MOVEL'BASE CHA'NARTP                           CLE004
0613 C***35******          MOVE 'NGE'     NARTP                           CLE004
0614 C**
0615 C***********AMTP      COMP 'BR'                     35               CLE004
0616 C***35******          MOVEL'RATE CHA'NARTP                           CLE004
0617 C***35******          MOVE 'NGE'     NARTP                           CLE004
0618 C**
0619 C***********AMTP      COMP 'IN'                     35               CLE004
0620 C***35******          MOVEL'INT PAYM'NARTP                           CLE004
0621 C***35******          MOVE 'ENT'     NARTP                           CLE004
0622 C**
0623 C***********AMTP      COMP 'MA'                     35               CLE004
0624 C***35******          MOVEL'MATURITY'NARTP                           CLE004
0625 C**
0626 C***********AMTP      COMP 'MR'                     35               CLE004
0627 C***35******          MOVEL'REPAYMEN'NARTP                           CLE004
0628 C***35******          MOVE 'T  '     NARTP                           CLE004
0629 C**
0630 C***********AMTP      COMP 'PI'                     35               CLE004
0631 C***35******          MOVEL'PRIN INC'NARTP                           CLE004
0632 C***35******          MOVE 'R  '     NARTP                           CLE004
0633 C**
0634 C***********AMTP      COMP 'RE'                     35               CLE004
0635 C***35******          MOVEL'REPAYMEN'NARTP                           CLE004
0636 C***35******          MOVE 'T  '     NARTP                           CLE004
0637 C**
0638 C***********AMTP      COMP 'RO'                     35               CLE004
0639 C***35******          MOVEL'ROLLOVER'NARTP                           CLE004
0640 C**
0641 C***********AMTP      COMP 'SA'                     35               CLE004
0642 C***35******          MOVEL'STOP/STA'NARTP                           CLE004
0643 C***35******          MOVE 'RT '     NARTP                           CLE004
0644 C**
0645 C***********AMTP      COMP 'SC'                     35               CLE004
0646 C***35******          MOVEL'SPREAD C'NARTP                           CLE004
0647 C***35******          MOVE 'HG '     NARTP                           CLE004
0648 C**
0649 C***********AMTP      COMP 'ST'                     35               CLE004
0650 C***35******          MOVEL'LOAN STA'NARTP                           CLE004
0651 C***35******          MOVE 'RT '     NARTP                           CLE004
0652 C**
0653 C***********AMTP      COMP 'MI'                     35               CLE004
0654 C***35******          MOVEL'INT ADJU'NARTP                           CLE004
0655 C***35******          MOVE 'ST '     NARTP                           CLE004
0656 C**
     C                     SELEC                                          CLE004
     C           AMTP      WHEQ 'BC'                                      CLE004
     C                     MOVELNARR,1    NARTP                           CLE004
     C           AMTP      WHEQ 'BR'                                      CLE004
     C                     MOVELNARR,2    NARTP                           CLE004
     C           AMTP      WHEQ 'IN'                                      CLE004
     C                     MOVELNARR,3    NARTP                           CLE004
     C           AMTP      WHEQ 'MA'                                      CLE004
     C                     MOVELNARR,4    NARTP                           CLE004
     C           AMTP      WHEQ 'MR'                                      CLE004
     C                     MOVELNARR,5    NARTP                           CLE004
     C           AMTP      WHEQ 'PI'                                      CLE004
     C                     MOVELNARR,6    NARTP                           CLE004
     C           AMTP      WHEQ 'RE'                                      CLE004
     C                     MOVELNARR,7    NARTP                           CLE004
     C           AMTP      WHEQ 'RO'                                      CLE004
     C                     MOVELNARR,8    NARTP                           CLE004
     C           AMTP      WHEQ 'SA'                                      CLE004
     C                     MOVELNARR,9    NARTP                           CLE004
     C           AMTP      WHEQ 'SC'                                      CLE004
     C                     MOVELNARR,10   NARTP                           CLE004
     C           AMTP      WHEQ 'ST'                                      CLE004
     C                     MOVELNARR,11   NARTP                           CLE004
     C           AMTP      WHEQ 'MI'                                      CLE004
     C                     MOVELNARR,12   NARTP                           CLE004
     C           AMTP      WHEQ 'MC'                                      CLE004
     C           CLE006    ANDEQ'Y'                                       CLE004
     C           AMTP      OREQ 'MC'                                      CEU020
     C           CEU020    ANDEQ'Y'                                       CEU020
     C           AMTP      OREQ 'MC'                                      CLE015
     C           CLE007    ANDEQ'Y'                                       CLE015
     C                     MOVELNARR,13   NARTP                           CLE004
     C                     MOVE RLCY      NARTP                           CLE004
     C           AMTP      WHEQ 'PF'                                      CLE004
     C           CLE004    ANDEQ'Y'                                       CLE004
     C                     MOVELNARR,14   NARTP                           CLE004
     C                     MOVE ROLN      NARTP                           CLE004
     C           AMTP      WHEQ 'PT'                                      CLE004
     C           CLE004    ANDEQ'Y'                                       CLE004
     C                     MOVELNARR,15   NARTP                           CLE004
     C                     MOVE ROLN      NARTP                           CLE004
     C                     ENDSL                                          CLE004
      *                                                                   CLE004
0657 C                     ENDSR
0658 C*                                                                  *
0659 C********************************************************************
      /COPY ZSRSRC,ZDATE2Z4                                               S01392
0750 C********************************************************************
0751 C**
0752 C**   ZSYSTM SR. TO CHAIN TO THE INSTALLATION CONTROL DATA RECORD.
0753 C**
0754 C           ZSYSTM    BEGSR                           *** ZSYSTM ***
0755 C**************                                                      S01194
0756 C*****SET*UP*KEY FOR INSTALLATION CONTROL RECORD.                    S01194
0757 C**************       MOVEL'01      'ZTABKY 12                       S01194
0758 C**************       MOVE '  10'    ZTABKY                          S01194
0759 C**************                                                      S01194
0760 C***********ZTABKY    CHAINTABLE                99    ON NOT THERE   S01194
0761 C**N99******RECI      COMP 'D'                  9999  ON, IS DELETED S01194
     C**                                                                  S01194
     C**   ACCESS BANK DETAILS                                            S01194
     C**                                                                  S01194
     C                     CALL 'AOBANKR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDBANK    PARM SDBANK    DSFDY                           S01194
     C*                                                                   S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     SETON                     U7U8LR               S01194
     C                     SETON                     99                   S01194
     C                     MOVEL'SDBANKPD'DBFILE           ***************S01194
     C                     MOVEL@OPTN     DBKEY            * DBERROR 001 *S01194
     C                     Z-ADD1         DBASE            ***************S01194
     C                     ELSE                                           S01194
0762 C**
0763 C**   CHECK SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.
0764 C***********DATF      COMP 'M'                      98MMDDYY, 98 ON  S01194
0764 C           BJDFIN    COMP 'M'                      98MMDDYY, 98 ON  S01194
     C                     END                                            S01194
0765 C**
0766 C                     ENDSR
0767 C**
0768 C**
0769 C********************************************************************
     C/SPACE 3
     C********************************************************************S01117
     C*                                                                   S01117
     C*  *PSSR --- SUBROUTINE TO HANDLE ABNORMAL ERROR CONDITIONS         S01117
     C*                                                                   S01117
     C*  CALLED FROM: AFTER ABNORMAL OPERATION OCCURS                     S01117
     C*                                                                   S01117
     C*  CALLS: NOTHING                                                   S01117
     C*                                                                   S01117
     C********************************************************************S01117
     C*                                                                   S01117
     C           *PSSR     BEGSR                           ** *PSSR **    S01117
     C*                                                                   S01117
     C           @RUN      IFEQ *BLANKS                                   S01117
     C                     MOVE 'Y'       @RUN    1                       S01117
     C                     DUMP                                           S01117
     C                     END                                            S01117
     C                     ENDSR                           ** *PSSR **    S01117
     C*                                                                   S01117
     C********************************************************************S01117
     C/EJECT                                                              S01117
      *****************************************************************                     CLE075AO
      *                                                               *                     CLE075AO
      *  *INZSR - Initial Subroutine                                  *                     CLE075AO
      *                                                               *                     CLE075AO
      *****************************************************************                     CLE075AO
     C           *INZSR    BEGSR                                                            CLE075AO
      *                                                                                     CLE075AO
      ** LRU element key and record arrival sequence                                        CLE075AO
      *                                                                                     CLE075AO
     C                     Z-ADD0         LOAKEY 130                                        CLE075AO
     C           *LIKE     DEFN LOAKEY    LOASEQ                                            CLE075AO
      *                                                                                     CLE075AO
      ** Set start index to upper limit of LRU Caching arrays                               CLE075AO
      *                                                                                     CLE075AO
     C                     Z-ADD300       LOAIDX  40                                        CLE075AO
     C           *LIKE     DEFN LOAIDX    LOAPRV                                            CLE075AO
     C           *LIKE     DEFN LOAIDX    Q                                                 CLE075AO
      *                                                                                     CLE075AO
      ** Initialize work fields of LRU array routines                                       CLE075AO
      *                                                                                     CLE075AO
     C                     MOVE *BLANK    LOAIC   1                                         CLE075AO
     C                     MOVE *BLANKS   KEYLOA  8                                         CLE075AO
     C                     Z-ADD300       LOAPRV                                            CLE075AO
     C                     Z-ADD300       Q                                                 CLE075AO
      *                                                                                     CLE075AO
      ** Full Cache SDCURRPD                                                                CLE075AO
      *                                                                                     CLE075AO
     C           *LOVAL    SETLLSDCURRL1                                                    CLE075AO
     C                     Z-ADD250       A       30                                        CLE075AO
     C           A         OCUR SDCURR                                                      CLE075AO
     C                     READ SDCURRL1                 13                                 CLE075AO
     C                     MOVE A6CYCD    #CCY,A                                            CLE075AO
     C                     MOVE A6NBDP    CDP                                               MD020290
     C                     MOVE A6CYNM    CCNM                                              MD020290
     C           *IN13     DOWEQ'0'                                                         CLE075AO
     C                     SUB  1         A                                                 CLE075AO
     C           A         OCUR SDCURR                                                      CLE075AO
     C                     READ SDCURRL1                 13                                 CLE075AO
     C                     MOVE A6CYCD    #CCY,A                                            CLE075AO
     C                     MOVE A6NBDP    CDP                                               MD020290
     C                     MOVE A6CYNM    CCNM                                              MD020290
     C                     ENDDO                                                            CLE075AO
     C                     Z-ADDA         CURARR  30                                        CLE075AO
      *                                                                                     CLE075AO
     C                     ENDSR                                                            CLE075AO
      *****************************************************************                     CLE075AO
     C/EJECT                                                                                CLE075AO
      *****************************************************************                     CLE075AO
      *                                                               *                     CLE075AO
      *  CHKLOA - Check Loan Types/SubTypes details to array          *                     CLE075AO
      *                                                               *                     CLE075AO
      *****************************************************************                     CLE075AO
     C           CHKLOA    BEGSR                                                            CLE075AO
      *                                                                                     CLE075AO
      ** Reinitialize work fields                                                           CLE075AO
      *                                                                                     CLE075AO
     C                     MOVEL*BLANK    LOAIC                                             CLE075AO
     C                     MOVE *OFF      *IN25                                             CLE075AO
      *                                                                                     CLE075AO
      ** Check previous base rate details if it's                                           CLE075AO
      ** same with current details                                                          CLE075AO
      *                                                                                     CLE075AO
     C                     Z-ADDLOAPRV    Q                                                 CLE075AO
      *                                                                                     CLE075AO
      ** Defend against index being 0                                                       CLE075AO
      ** Set current index to starting index                                                CLE075AO
      *                                                                                     CLE075AO
     C           Q         IFEQ 0                                                           CLE075AO
     C                     Z-ADDLOAIDX    Q                                                 CLE075AO
     C                     ENDIF                                                            CLE075AO
      *                                                                                     CLE075AO
      ** If the KEYLOA being checked is the same then use the index                         CLE075AO
      ** of the current detail rather than doing a LOKUP                                    CLE075AO
      *                                                                                     CLE075AO
     C           KEYLOA    IFEQ #LOK,Q                                                      CLE075AO
     C                     MOVE *ON       *IN25                                             CLE075AO
     C                     ELSE                                                             CLE075AO
      *                                                                                     CLE075AO
     C           LOAIDX    IFEQ 0                                                           CLE075AO
     C                     Z-ADD1         Q                                                 CLE075AO
     C                     ELSE                                                             CLE075AO
     C                     Z-ADDLOAIDX    Q                                                 CLE075AO
     C                     ENDIF                                                            CLE075AO
      *                                                                                     CLE075AO
     C           KEYLOA    LOKUP#LOK,Q                   25                                 CLE075AO
     C                     ENDIF                                                            CLE075AO
      *                                                                                     CLE075AO
      ** Save the last accessed detail to LOAPRV                                            CLE075AO
      ** Set the indicator to show the data was found                                       CLE075AO
      *                                                                                     CLE075AO
     C           *IN25     IFEQ *ON                                                         CLE075AO
     C                     MOVE LOASEQ    #LOS,Q                                            CLE075AO
     C                     Z-ADDQ         LOAPRV                                            CLE075AO
     C                     MOVEL'Y'       LOAIC                                             CLE075AO
     C                     ENDIF                                                            CLE075AO
      *                                                                                     CLE075AO
     C                     ENDSR                                                            CLE075AO
      *****************************************************************                     CLE075AO
      *                                                               *                     CLE075AO
      *  ADDLOA - Add Loan Types/SubTypes details to array            *                     CLE075AO
      *                                                               *                     CLE075AO
      *****************************************************************                     CLE075AO
     C           ADDLOA    BEGSR                                                            CLE075AO
      *                                                                                     CLE075AO
      ** If there is still room in the array then add the details                           CLE075AO
      *                                                                                     CLE075AO
     C           LOAIDX    IFNE 0                                                           CLE075AO
     C                     SUB  1         LOAIDX                                            CLE075AO
     C                     ENDIF                                                            CLE075AO
      *                                                                                     CLE075AO
     C                     MOVELKEYLOA    #LOK,Q                                            CLE075AO
     C                     ADD  LOASEQ    #LOS,Q                                            CLE075AO
      *                                                                                     CLE075AO
      ** Set last accessed detail to LOAIDX So that CHKLOA checks this                      CLE075AO
      ** latest detail first                                                                CLE075AO
      *                                                                                     CLE075AO
     C                     Z-ADDQ         LOAPRV                                            CLE075AO
      *                                                                                     CLE075AO
     C                     ENDSR                                                            CLE075AO
      *****************************************************************                     CLE075AO
     C/EJECT                                                                                CLE075AO
0770 O**
0771 O**   INTEREST STATEMENT - HEADINGS ETC.
0772 O**
0773 O***
0774 O***  ADJUSTMENT LINE
0775 O***
0776 O***
0777 O***  DETAIL OUTPUT - RATE CHANGE OR MOVEMENT
0778 O***
0779 O***
0780 O***  CARRIED FORWARD LINE -
0781 O***
0782 O**
0783 O**
0784 O*E0630P2E** 10   41                                       S01124    S01117
0784 OLE0630P1E   10   41                                                 S01117
0785 O                                    6 'PAGE'
0786 O                         PGNO  3   10
0787 O                       30BRNM      60
0788 O        E   12   41
0789 O                                    6 'DATE'
     O/COPY WNCPYSRC,LE0630O011
0790 O                         RUNA      15
     O/COPY WNCPYSRC,LE0630O009
0791 O                                   62 'CURRENCY'
0792 O                         CCNM      80
     O/COPY WNCPYSRC,LE0630O001
0793 O        E   13   41
0794 O                                   13 'LOAN NUMBER'
0795 O                         LNRF      20
0796 O        E   14   41
0797 O                                   11 'LOAN TYPE'
0798 O                         LNARR     42
0799 O                       42          75 '** INTEREST IS CAPITALIS'
0800 O                       42          80 'ED **'
0801 O        E   15   41
     O/COPY WNCPYSRC,LE0630O013
0802 O                                   26 'DEMAND LOAN INTEREST STA'
0803 O                                   32 'TEMENT'
     O/COPY WNCPYSRC,LE0630O014
0804 O        E   17   41
0805 O***********                        26 'VALUE  ------M O V E M E'    CLE004
0806 O***********                        36 'N T------'                   CLE004
0807 O***********                        48 'LOAN'                        CLE004
0808 O***********                        81 '------I N T E R E S T---'    CLE004
0809 O***********                        84 '---'                         CLE004
0805 O                                   26 'VALUE  --------M O V E M'    CLE004
0806 O                                   41 'E N T---------'              CLE004
0807 O                                   53 'LOAN'                        CLE004
0808 O                                   86 '------I N T E R E S T---'    CLE004
0809 O                                   89 '---'                         CLE004
0810 O        E   18   41
0811 O                                   20 'DATE  DESCRIPTION'
0812 O***********                        36 'RATE/AMOUNT'                 CLE004
0813 O***********                        50 'BALANCE'                     CLE004
0814 O***********                        80 'RATE     DAYS    AMOUNT'     CLE004
0815 O***********                        84 'DUE'                         CLE004
0812 O                                   41 'RATE/AMOUNT'                 CLE004
0813 O                                   55 'BALANCE'                     CLE004
0814 O                                   85 'RATE     DAYS    AMOUNT'     CLE004
0815 O                                   89 'DUE'                         CLE004
     O/COPY WNCPYSRC,LE0630O015
0816 O        E   20   41
     O/COPY WNCPYSRC,LE0630O016
0817 O                         VDATA      8
0818 O***********                        20 'BROUGHT FWD'                 CLE004
0819 O***********            60BALL      52 '           0 -'              CLE004
0820 O***********            61BALL      52 '          0 . -'             CLE004
0821 O***********            62BALL      52 '         0 .  -'             CLE004
0822 O***********            63BALL      52 '        0 .   -'             CLE004
0823 O***********              ORATE     66 '  0 .       -'               CLE004
0824 O***********            60INTO      85 '           0 -'              CLE004
0825 O***********            61INTO      85 '          0 . -'             CLE004
0826 O***********            62INTO      85 '         0 .  -'             CLE004
0827 O***********            63INTO      85 '        0 .   -'             CLE004
0818 O                                   25 'BROUGHT FORWARD '            CLE004
0819 O                       60BALL      57 '           0 -'              CLE004
0820 O                       61BALL      57 '          0 . -'             CLE004
0821 O                       62BALL      57 '         0 .  -'             CLE004
0822 O                       63BALL      57 '        0 .   -'             CLE004
0823 O                         ORATE     71 '  0 .       -'               CLE004
0824 O                       60INTO      90 '           0 -'              CLE004
0825 O                       61INTO      90 '          0 . -'             CLE004
0826 O                       62INTO      90 '         0 .  -'             CLE004
0827 O                       63INTO      90 '        0 .   -'             CLE004
     O/COPY WNCPYSRC,LE0630O003
0828 O**
0829 O**   ADJUSTMENT LINE
0830 O**
0831 O        E  121   41
     O/COPY WNCPYSRC,LE0630O010
0832 O                    43   VDATA      8
     O/COPY WNCPYSRC,LE0630O017
0833 O***********         43             20 'ADJUSTMENT '                 CLE004
0834 O***********         43 60PRAM      52 '           0 -'              CLE004
0835 O***********         43 61PRAM      52 '          0 . -'             CLE004
0836 O***********         43 62PRAM      52 '         0 .  -'             CLE004
0837 O***********         43 63PRAM      52 '        0 .   -'             CLE004
0838 O***********         43 60ADJI      85 '           0 -'              CLE004
0839 O***********         43 61ADJI      85 '          0 . -'             CLE004
0840 O***********         43 62ADJI      85 '         0 .  -'             CLE004
0841 O***********         43 63ADJI      85 '        0 .   -'             CLE004
     O/COPY WNCPYSRC,LE0630O018
0833 O                    43             25 'ADJUSTMENT      '            CLE004
0834 O                    43 60PRAM      57 '           0 -'              CLE004
0835 O                    43 61PRAM      57 '          0 . -'             CLE004
0836 O                    43 62PRAM      57 '         0 .  -'             CLE004
0837 O                    43 63PRAM      57 '        0 .   -'             CLE004
0838 O                    43 60ADJI      90 '           0 -'              CLE004
0839 O                    43 61ADJI      90 '          0 . -'             CLE004
0840 O                    43 62ADJI      90 '         0 .  -'             CLE004
0841 O                    43 63ADJI      90 '        0 .   -'             CLE004
     O/COPY WNCPYSRC,LE0630O004
0842 O**
0843 O**   DETAIL OUTPUT - RATE CHANGE OR MOVEMENT
0844 O**
0845 O        E  1     44
0846 O                         VDATA      8
0847 O***********              NARTP     20                               CLE004
0848 O***********        N64 60MAMT      37 '           0 -'              CLE004
0849 O***********        N64 61MAMT      37 '          0 . -'             CLE004
0850 O***********        N64 62MAMT      37 '         0 .  -'             CLE004
0851 O***********        N64 63MAMT      37 '        0 .   -'             CLE004
0852 O***********            64MAMTR     36 '  0 .       '                CLE004
0853 O***********         64 46          37 '-'                           CLE004
0854 O***********         64N46          37 '+'                           CLE004
0855 O***********            60BALL      52 '           0 -'              CLE004
0856 O***********            61BALL      52 '          0 . -'             CLE004
0857 O***********            62BALL      52 '         0 .  -'             CLE004
0858 O***********            63BALL      52 '        0 .   -'             CLE004
0859 O***********              ERATE     66 '  0 .       -'               CLE004
     O***********              SDAY  3B  69                               CLE004
0861 O***********            60INTO      85 '           0 -'              CLE004
0862 O***********            61INTO      85 '          0 . -'             CLE004
0863 O***********            62INTO      85 '         0 .  -'             CLE004
0864 O***********            63INTO      85 '        0 .   -'             CLE004
0847 O                         NARTP     25                               CLE004
0848 O                   N64 60MAMT      42 '           0 -'              CLE004
0849 O                   N64 61MAMT      42 '          0 . -'             CLE004
0850 O                   N64 62MAMT      42 '         0 .  -'             CLE004
0851 O                   N64 63MAMT      42 '        0 .   -'             CLE004
0852 O                       64MAMTR     41 '  0 .       '                CLE004
0853 O                    64 46          42 '-'                           CLE004
0854 O                    64N46          42 '+'                           CLE004
0855 O                       60BALL      57 '           0 -'              CLE004
0856 O                       61BALL      57 '          0 . -'             CLE004
0857 O                       62BALL      57 '         0 .  -'             CLE004
0858 O                       63BALL      57 '        0 .   -'             CLE004
0859 O                         ERATE     71 '  0 .       -'               CLE004
     O                         SDAY  3B  74                               CLE004
0861 O                       60INTO      90 '           0 -'              CLE004
0862 O                       61INTO      90 '          0 . -'             CLE004
0863 O                       62INTO      90 '         0 .  -'             CLE004
0864 O                       63INTO      90 '        0 .   -'             CLE004
     O/COPY WNCPYSRC,LE0630O005
0865 O**
0866 O**   CARRIED FORWARD LINE
0867 O**
0868 O        E 1      45
     O/COPY WNCPYSRC,LE0630O019
0869 O                         VDATA      8
0870 O***********                        20 'CARRIED FWD'                 CLE004
0871 O***********            60BALL      52 '           0 -'              CLE004
0872 O***********            61BALL      52 '          0 . -'             CLE004
0873 O***********            62BALL      52 '         0 .  -'             CLE004
0874 O***********            63BALL      52 '        0 .   -'             CLE004
0875 O***********            60INTO      85 '           0 -'              CLE004
0876 O***********            61INTO      85 '          0 . -'             CLE004
0877 O***********            62INTO      85 '         0 .  -'             CLE004
0878 O***********            63INTO      85 '        0 .   -'             CLE004
0870 O                                   25 'CARRIED FORWARD '            CLE004
0871 O                       60BALL      57 '           0 -'              CLE004
0872 O                       61BALL      57 '          0 . -'             CLE004
0873 O                       62BALL      57 '         0 .  -'             CLE004
0874 O                       63BALL      57 '        0 .   -'             CLE004
     O/COPY WNCPYSRC,LE0630O020
0875 O                       60INTO      90 '           0 -'              CLE004
0876 O                       61INTO      90 '          0 . -'             CLE004
0877 O                       62INTO      90 '         0 .  -'             CLE004
0878 O                       63INTO      90 '        0 .   -'             CLE004
     O/COPY WNCPYSRC,LE0630O002
     O**
     O********E   35   45 48                                              E12727
     O***********************************80 '- CONTD'                     E12727
0879 O**
0880 O********E   36   45                                                 E12727
0881 O*************************CNA1      45                               E12727
0881 O*****************31                70 '** TELEX GENERATED **'       E12727
0882 O********E   37   45                                                 E12727
0883 O*************************CNA2      45                               E12727
0884 O********E   38   45                                                 E12727
0885 O*************************CNA3      45                               E12727
0886 O********E   39   45                                                 E12727
0887 O*************************CNA4      45                               E12727
0782 O**                                                                  E12727
     O        E   35   45 48                                              E12727
     O/COPY WNCPYSRC,LE0630O008
     O       OR       N45 52 47                                           E12727
     O       AND       48                                                 E12727
     O                                   80 '- CONTD'                     E12727
0879 O**                                                                  E12727
0880 O        E   36   45                                                 E12727
     O       OR       N45 52 47                                           E12727
0881 O                         CNA1      45                               E12727
0881 O                 31                70 '** TELEX GENERATED **'       E12727
0880 O        E   37   45                                                 E12727
     O       OR       N45 52 47                                           E12727
0883 O                         CNA2      45                               E12727
0880 O        E   38   45                                                 E12727
     O       OR       N45 52 47                                           E12727
0885 O                         CNA3      45                               E12727
0880 O        E   39   45                                                 E12727
     O       OR       N45 52 47                                           E12727
0887 O                         CNA4      45                               E12727
     O/COPY WNCPYSRC,LE0630O007
0782 O**                                                                  E12727
0783 O**
0784 OLEINTX  E        41      TLX
0785 O                                    1 'D'
0786 O***********              BRCD       4                               S01117
0786 O                         BRCA       4                               S01117
0787 O                         CNUM      10
0788 O                         PTYP      12
0789 O                         TXDATE    18
0790 O                         CCY       21
0791 O                         LNRF      27
0792 O                                   28 'F'
0792 O                                   29 'C'
0793 O                                   70 'I'
0795 O***********              BRCD      73                               S01117
0795 O                         BRCA      73                               S01117
0784 O        E        41      TLX
0797 O                                   21 'CUSTOMER LENDING INTE'
0797 O                                   41 'REST STATEMENT TELEX'
0800 O***********              BRCD      73                               S01117
0800 O                         BRCA      73                               S01117
0784 O        E        41      TLX
0805 O                                    2 'TO'
0806 O                         CRNM      38
0807 O                         CTWN      50
0803 O***********              BRCD      73                               S01117
0803 O                         BRCA      73                               S01117
0784 O        E        41      TLX
0811 O                                    8 'TEST KEY'
0812 O                                   57 'DATE'
0813 O                         RUNA      65
0814 O***********              BRCD      73                               S01117
0814 O                         BRCA      73                               S01117
0784 O        E        41      TLX
0811 O                                    8 'LOAN REF'
0812 O                         LNRF      15
0813 O                                   26 'LOAN TYPE'
0812 O                         LNARR     58
0812 O                         CCY       64
0814 O***********              BRCD      73                               S01117
0814 O                         BRCA      73                               S01117
0784 O        E        41      TLX
0814 O***********              BRCD      73                               S01117
0814 O                         BRCA      73                               S01117
0784 O        E        41      TLX
     O/COPY WNCPYSRC,LE0630O021
0811 O                                   44 'DEMAND LOAN INTEREST '
0811 O                                   53 'STATEMENT'
     O/COPY WNCPYSRC,LE0630O022
0814 O***********              BRCD      73                               S01117
0814 O                         BRCA      73                               S01117
0784 O        E        41      TLX
0811 O                                   44 '- - - - - - - - - - -'
0811 O                                   53 ' - - - - '
0814 O***********              BRCD      73                               S01117
0814 O                         BRCA      73                               S01117
0784 O        E        41      TLX
0811 O                                    7 'VALUE'
0811 O                                   31 '------M O V E M E N T'
0811 O                                   37 '------'
0811 O                                   53 '---INTEREST---'
0811 O                                   65 'LOAN BAL/'
0814 O***********              BRCD      73                               S01117
0814 O                         BRCA      73                               S01117
0784 O        E        41      TLX
0811 O                                    7 'DATE '
0811 O                                   31 'DESCRIPTION     RATE/'
0811 O                                   37 'AMOUNT'
0811 O                                   53 'RATE     DAY  '
0811 O                                   66 'AMOUNT DUE'
0814 O***********              BRCD      73                               S01117
0814 O                         BRCA      73                               S01117
0784 O        E        41      TLX
0814 O***********              BRCD      73                               S01117
0814 O                         BRCA      73                               S01117
0784 O        E        41      TLX
0817 O                         VDATA      8
0818 O                                   21 'BROUGHT FWD'
0819 O                       60BALL      68 '           0 -'
0820 O                       61BALL      68 '          0 . -'
0821 O                       62BALL      68 '         0 .  -'
0822 O                       63BALL      68 '        0 .   -'
0814 O***********              BRCD      73                               S01117
0814 O                         BRCA      73                               S01117
0784 O        E        41      TLX
0823 O                         ORATE     47 '  0 .       -'
0824 O                       60INTO      68 '           0 -'
0825 O                       61INTO      68 '          0 . -'
0826 O                       62INTO      68 '         0 .  -'
0827 O                       63INTO      68 '        0 .   -'
0814 O***********              BRCD      73                               S01117
0814 O                         BRCA      73                               S01117
0828 O**
0829 O**   ADJUSTMENT LINE
0830 O**
     O/COPY WNCPYSRC,LE0630O023
0784 O        E        41      TLX
0832 O                    43   VDATA      8
0833 O                    43             21 'ADJUSTMENT '
0834 O                    43 60PRAM      68 '           0 -'
0835 O                    43 61PRAM      68 '          0 . -'
0836 O                    43 62PRAM      68 '         0 .  -'
0837 O                    43 63PRAM      68 '        0 .   -'
0814 O***********              BRCD      73                               S01117
0814 O                         BRCA      73                               S01117
0784 O        E        41      TLX
0838 O                    43 60ADJI      68 '           0 -'
0839 O                    43 61ADJI      68 '          0 . -'
0840 O                    43 62ADJI      68 '         0 .  -'
0841 O                    43 63ADJI      68 '        0 .   -'
0814 O***********              BRCD      73                               S01117
0814 O                         BRCA      73                               S01117
     O/COPY WNCPYSRC,LE0630O024
0842 O**
0843 O**   DETAIL OUTPUT - RATE CHANGE OR MOVEMENT
0844 O**
0784 O        E        44      TLX
0846 O                         VDATA      8
0847 O***********              NARTP     21                               CLE004
0848 O***********        N64 60MAMT      38 '           0 -'              CLE004
0849 O***********        N64 61MAMT      38 '          0 . -'             CLE004
0850 O***********        N64 62MAMT      38 '         0 .  -'             CLE004
0851 O***********        N64 63MAMT      38 '        0 .   -'             CLE004
0852 O***********            64MAMTR     37 '  0 .       '                CLE004
0853 O***********         64 46          38 '-'                           CLE004
0854 O***********         64N46          38 '+'                           CLE004
0847 O                         NARTP     31                               CLE004
0848 O                   N64 60MAMT      48 '           0 -'              CLE004
0849 O                   N64 61MAMT      48 '          0 . -'             CLE004
0850 O                   N64 62MAMT      48 '         0 .  -'             CLE004
0851 O                   N64 63MAMT      48 '        0 .   -'             CLE004
0852 O                       64MAMTR     47 '  0 .       '                CLE004
0853 O                    64 46          48 '-'                           CLE004
0854 O                    64N46          48 '+'                           CLE004
0855 O                       60BALL      68 '           0 -'
0856 O                       61BALL      68 '          0 . -'
0857 O                       62BALL      68 '         0 .  -'
0858 O                       63BALL      68 '        0 .   -'
0814 O***********              BRCD      73                               S01117
0814 O                         BRCA      73                               S01117
0784 O        E        44      TLX
0859 O                         ERATE     47 '  0 .       -'
0860 O                         SDAY  3   51
0861 O                       60INTO      68 '           0 -'
0862 O                       61INTO      68 '          0 . -'
0863 O                       62INTO      68 '         0 .  -'
0864 O                       63INTO      68 '        0 .   -'
0814 O***********              BRCD      73                               S01117
0814 O                         BRCA      73                               S01117
     O/COPY WNCPYSRC,LE0630O025
0865 O**
0866 O**   CARRIED FORWARD LINE
0867 O**
0784 O        E        45      TLX
     O/COPY WNCPYSRC,LE0630O026
0814 O***********              BRCD      73                               S01117
0814 O                         BRCA      73                               S01117
0784 O        E        45      TLX
0869 O                         VDATA      8
0870 O                                   21 'CARRIED FWD'
0871 O                       60BALL      68 '           0 -'
0872 O                       61BALL      68 '          0 . -'
0873 O                       62BALL      68 '         0 .  -'
0874 O                       63BALL      68 '        0 .   -'
0814 O***********              BRCD      73                               S01117
0814 O                         BRCA      73                               S01117
0784 O        E        45      TLX
     O/COPY WNCPYSRC,LE0630O027
0875 O                       60INTO      68 '           0 -'
0876 O                       61INTO      68 '          0 . -'
0877 O                       62INTO      68 '         0 .  -'
0878 O                       63INTO      68 '        0 .   -'
     O/COPY WNCPYSRC,LE0630O028
0814 O***********              BRCD      73                               S01117
0814 O                         BRCA      73                               S01117
0879 O**
0784 O        E        45      TLX
0881 O                                   20 'SPECIAL INSTRUCTIONS'
0814 O***********              BRCD      73                               S01117
0814 O                         BRCA      73                               S01117
0784 O        E        45      TLX
0881 O                         CNA1      45
0814 O***********              BRCD      73                               S01117
0814 O                         BRCA      73                               S01117
0784 O        E        45      TLX
0883 O                         CNA2      45
0883 O                 42                62 '** INTEREST IS CAPITALIS'
0883 O                 42                67 'ED **'
0814 O***********              BRCD      73                               S01117
0814 O                         BRCA      73                               S01117
0784 O        E        45      TLX
0885 O                         CNA3      45
0814 O***********              BRCD      73                               S01117
0814 O                         BRCA      73                               S01117
0784 O        E        45      TLX
0887 O                         CNA4      45
0814 O                                   70 '*'
0814 O***********              BRCD      73                               S01117
0814 O                         BRCA      73                               S01117
0888 O**
0889 O**   CONTROL REPORT
0890 O**
0891 O*E0630P1T** 10   LR                                       S01124    S01117
0891 OLE0630AUT   10   LR                                                 S01117
0892 O***********                        12 'REF LE0630'          E15790  E20758
0893 O***********              TITL      66                       E15790  E20758
0894 O***********                        71 'DATE'                E15790  E20758
0895 O***********              RUNA      79                       E15790  E20758
0897 O***********                        90 'PAGE    1'           E15790  E20758
0892 O                                   24 'REFERENCE LE0630AU'          E20758
0893 O                         TITL      89                               E20758
0894 O                                  104 'DATE'                        E20758
     O/COPY WNCPYSRC,LE0630O012
0895 O                         RUNA     112                               E20758
0897 O                                  127 'PAGE    1'                   E20758
     O/COPY WNCPYSRC,LE0630O006
0896 O***     T   11   LR                                                 E15790
0897 O***                                85 'PAGE    1'                   E15790
0898 O        T 2      LR
0899 O**********                         46 'DEMAND LOAN INTEREST STA'    LN0063
0900 O***********                        69 'TEMENTS - FILE CONTROLS'     LN0063
     O/COPY WNCPYSRC,LE0630O029
0899 O                                   66 'DEMAND LOAN INTEREST STA'    LN0063
0900 O                                   89 'TEMENTS - FILE CONTROLS'     LN0063
     O/COPY WNCPYSRC,LE0630O030
0901 O        T 1      LR
0902 O***********                        46 '------------------------'    LN0063
0903 O***********                        69 '-----------------------'     LN0063
0902 O                                   66 '------------------------'    LN0063
0903 O                                   89 '-----------------------'     LN0063
0904 O********T*32     LR U7                                              S01117
0905 O***********                        51 '*** REFERENCE LE0630'        S01117
0906 O***********                        71 '- DATABASE ERROR AT'         S01117
0907 O***********              DBASE     74                               S01117
0908 O********T**      LR U7                                              S01117
0909 O***********                        37 'FILENAME'                    S01117
0910 O***********              DBFILE    43                               S01117
0911 O***********                        48 'KEY'                         S01117
0912 O***********              DBKEY     78                               S01117
     O        T 2      LRNU7
     O***********                        52 'NUMBER OF STATMENTS PRI'     LN0063
     O***********                        56 'NTED'                        LN0063
     O***********              NOST  3   62                               LN0063
     O                                   52 'NUMBER OF STATEMENTS PR'     LN0063
     O                                   57 'INTED'                       LN0063
     O                         NOST  3   63                               LN0063
0913 O        T 3      LR
0914 O                                   24 'S/SINTS - RUN CONTROLS'
0915 O                                   50 'NUMBER'
0916 O        T 1      LR
0917 O                                   24 '----------------------'
0918 O                                   50 'OF RECORDS'
0919 O        T 2      LR
0920 O                                   25 'TOTAL RECORDS ON FILE'
0921 O                         NORE  3   50
0922 O        T 2      LR
0923 O                                   25 'TOTAL RECORDS ON FILE'
0924 O                                   38 '- CALCULATED'
0925 O                         COUNT 3   50
0926 O                   NU7 U8          85 '***   DIFFERENCE   ***'
0922 O        T 2      LR U1N23
0923 O                                   23 'TOTAL TELEX RECORDS'
0925 O                         TELEX 3   50
0904 O        T 32     LR U7                                              S01117
0421 O                                   39 '*** REFERENCE'               S01117
0422 O                         DBPGM     51                               S01117
0423 O                                   71 'DATABASE ERROR AT'           S01117
0424 O                         DBASE     75                               S01117
0908 O        T        LR U7                                              S01117
0909 O                                   39 'FILENAME'                    S01117
0910 O                         DBFILE    48                               S01117
0911 O                                   52 'KEY'                         S01117
0912 O                         DBKEY     82                               S01117
     O        T 23    NU7NU8 LR                                           S01117
     O*******AND*******47                                           S01117000040
     O       AND       49                                                 000040
     O                                   76 '*** NO DETAILS TO REPORT'    S01117
     O                                   80 '***'                         S01117
0927 O********T*3      LR                                                 S01117
0928 O***********                        56 '*** END OF REPORT ***'       S01117
**   NARR - NARRATIVE TEXT
BASE CHANGE
RATE CHANGE
INTEREST PAYMENT
MATURITY
REPAYMENT
PRINCIPAL INCR.
REPAYMENT
ROLLOVER
STOP/START
SPREAD CHANGE
START OF LOAN
INTEREST ADJUST
MC ROLL. CCY
TRANS. TO
REC. FROM
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
** CPY@   **      OBJECT COPYRIGHT
(c) Finastra International Limited 2001
