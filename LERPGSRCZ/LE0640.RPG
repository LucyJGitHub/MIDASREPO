0001 H        1                                                           S01117
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas LE Interest Accruals Extract')                   *
0001 H***********                                                         S01117
0002 F********************************************************************LE0640
0003 F*                                                                  *LE0640
     F*  Midas Customer Lending Module
0005 F*                                                                  *LE0640
0006 F*        LE0640 - INTEREST ACCRUALS EXTRACT                        *LE0640
0007 F*                                                                  *LE0640
      *  (c) Finastra International Limited 2001                      *
0009 F*                                                                  *LE0640
      *  Last Amend No. MD046248           Date 27Oct17               *
      *  Prev Amend No. AR1056323          Date 14Nov12               *
      *                 CLE134             Date 01Aug12               *
      *                 CLE148             Date 23Jul12               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      *                 CSC042             Date 16Feb09               *
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CSD031             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 CLE042             Date 06Sep05               *
      *                 CGL029             Date 01Sep03               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.05 -----------------------------------------------*
      *                 188691             Date 28Mar01               *
      *                 CLE011             Date 07Nov00               *
      * Midas DBA 3.02 -----------------------------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 125850             Date 30Sep98               *
      *                 113361             Date 25Feb98               *
     F*                 109350                DATE 17FEB98               *
     F*                 CAC001             DATE 13AUG96               *
     F*                 S01408             DATE 30JUN93               *
0010 F*                 055214             DATE 12MAY93               *
0010 F*                 E47260             DATE 15FEB90               *
     F*                       S01194                DATE  11JAN90        *
0010 F*                       S01117                DATE - 14/08/89      *LE0640
0010 F*                       E16380                DATE - 23/12/88      *LE0640
0011 F*                                                                  *LE0640
0011 F*------------------------------------------------------------------*E16380
0011 F*                                                                  *E16380
      *  MD046248 - Finastra Rebranding                               *
      *  AR1056323 - Revert back changes of CLE134 for LKEY1DP and    *
      *              LKEYFED                                          *
      *  CLE134 - Past Due Call Loan Processing                       *
      *  CLE148 - Alpha Loan Reference                                *
      *  CSC042 - COB Performance fix. RZB Sofia calls AOBRCHR* 220K  *
      *           times. Save data in array and reuse.                *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CLE042 - Extended Loan Sub Type                              *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  188691 -  A number of loans are not reported in LE0650P1     *
      *            report.  Add a condition to chain to CLOANCL only  *
      *            if record is not a reversal.  If record is not     *
      *            found, set off *IN02 instead of *IN70.             *
      *            Apply fix 164608.                                  *
      *  CLE011 - Rate Fixing Days for Lending Rollover Processing    *
      *           Recompile                                           *
     A*   125850 - Wrong "From Date" in interest accrual report.      *
     A*            Layout IACEXDP doesn't match with LKEY1DP.         *
     A*            Applied fix 090681.                                *
     F*  113361 -  Interest reversal does not appear on Interest Accrual *
     F*            report - reverse fix E16380 which incorrectly stopped *
     F*            reversals from being extracted, to prevent database   *
     F*            error in LE0650; this has been fixed in LE0650.       *
     F*  109350  - Output record to IACEXDP only if the loan exists in   *
     F*            file CLOANCL.                                         *
     F*  CAC001 -  Profit Centre Accounting Development:                 *
     F*                 Do not process new COF account keys.             *
     F*       S01408  -  Core hook LE0640FPG added                       *
     F*                  Core hook LE0640IPG added                       *
     F*                  Core hook LE0640CPG added                       *
     F*                  Core hook LE0640CVSF added                      *
     F*        055214 - Loan type sub-type keys are being ignored
     F*                 because the RECI is S
0011 F*        E47260  -  WRONG 'FROM DATE' ON INTEREST ACCRUAL REPORT,  *E47260
0011 F*                DUE TO AN ACCRUAL/PROFIT DATE OCCURING SINCE LAST *E47260
0011 F*                INTEREST DATE OF LOAN.                            *E47260
     F*        S01194 - STANDING DATA CHANGES                            *S01194
0011 F*        S01117  -  MULTIBRANCHING                                 *S01117
0011 F*        E16380  -  WRONGLY APPLIED ERROR FIX - E11590             *E16380
0011 F*                                                                  *E16380
0012 F********************************************************************LE0640
0013 F*KEY1***IP**F*****128**7AI*****1*DISK                               E47260
0013 F*KEY1***IP  F     134  7AI     1 DISK                         E47260S01117
0013 F***LKEY1** IP  F     143  7AI     1 DISK                                         S01117 CGL029
     F*LKEY1***IP**F*****366  7AI     1 DISK                                           CGL029 CLE042
     F***LKEY1** IP  F     392  7AI     1 DISK                                         CLE042 CLE134
     F***LKEY1** IP  F     396  7AI     1 DISK                                      CLE134 AR1056323
     FLKEY1   IP  F     392  7AI     1 DISK                                                AR1056323
     FCLOAN   IF  E           K        DISK                               109350
     F            CLOANCKF                          KIGNORE               109350
     F            CLOANZ1F                          KIGNORE               109350
     F            CLOANHHF                          KIGNORE               109350
     F/COPY WNCPYSRC,LE0640F001
0014 F*ABLE***IF* F      96 12AI     2 DISK                               S01194
0015 FIACEXHH O   F     128            DISK                               LE0640
0015 F*ACEXDP*O***F*****128************DISK                               E47260
0015 F*******IACEXDP O   F     134            DISK                 E47260 125850
0015 F***IACEXDP O   F     143            DISK                                         125850 CGL029
     F*IACEXDP*O***F*****161            DISK                                           CGL029 CLE042
     F***IACEXDP O   F     392            DISK                                         CLE042 CLE134
     F***IACEXDP O   F     396            DISK                                      CLE134 AR1056323
     FIACEXDP O   F     392            DISK                                                AR1056323
0015 FIACEXZZ O   F     128            DISK                               LE0640
0016 F*E0640P1O** F     132            PRINTER                  S01124    S01117
0016 FLE0640AUO   F     132     OA     PRINTER                            S01117
     F** Core hook for externalisation.                                   S01408
     F/COPY WNCPYSRC,LE0640FPG                                            S01408
0011 F*                                                                  *LE0640
0017 F* ID F  C  H  L    FUNCTION OF INDICATORS                           LE0640
0018 F* 01            S/LKEY1 - HEADER RECORD                             LE0640
0019 F* 02                    - DETAIL RECORD - INTEREST/DISCOUNT KEY     LE0640
0020 F* 03                                    - OTHER                     LE0640
0021 F**05****        S/TABLE - ICD 2                                     S01194
0022 F*       40      CONDITION FIRST CYCLE PROCESSING                    LE0640
0023 F*       41      GENERAL PURPOSE                                     LE0640
0024 F*       43      MODE '2' PROCESSING                                 LE0640
0025 F********55      CHAIN FAIL                                          S01194
0026 F*       70      EXTRACT DETAIL RECORD                               LE0640
0027 F*             U7STANDARD MIDAS USAGE                                LE0640
0028 F*             U8STANDARD MIDAS USAGE                                LE0640
     E                    CPY@    1   1 80
     E                    ##BR      999  3               Branch Codes                         CSC042
     E                    ##BC      999  3               Company Code                         CSC042
0029 I*                                                                   LE0640
0030 I*    ACCOUNT KEYS FILE - HEADER RECORD                              LE0640
0031 I*                                                                   LE0640
0032 ILKEY1   NS  01   1 CH                                               LE0640
0033 I*                                                                   LE0640
0034 I*    ACCOUNT KEYS FILE - DETAIL RECORD                              LE0640
0035 I*                                                                   LE0640
0036 I        NS  02   1 CD   4 CA  11 CI                                 LE0640
0037 I       OR        1 CD   4 CA  11 CP                                 LE0640
0038 I       OR        1 CD   4 CA  11 CD                                 LE0640
0039 I       OR        1 CG   4 CA  11 CI                                 LE0640
0040 I       OR        1 CG   4 CA  11 CP                                 LE0640
0041 I       OR        1 CG   4 CA  11 CD                                 LE0640
0042 I       OR   03   1 CD                                               LE0640
0043 I       OR        1 CG                                               LE0640
0059 I       OR        1 CS                                               055214
     I/COPY WNCPYSRC,LE0640I001
0044 I                                        1   1 RECI                  LE0640
0045 I****************************************2  11 AKEY                               LE0640 CLE042
     I****************************************7   7 AKY6                               CAC001 CLE042
0046 I**********                             12  170LNNO                               LE0640 CLE148
     I**********                             12  17 LNNO                               CLE148 CLE134
0047 I**********                             18  230CNUM                  LE0640              CSD027
0047 I**********                             18  23 CNUM                        LE0640 CSD027 CLE134
0048 I**********                             24  26 BRCA                               S01117 CLE134
0048 I***********                            24  260BRCD                  S01117
0049 I**********                             27  280ACSQ                               LE0640 CLE134
0050 I**********                          P  29  310EDAT                               LE0640 CLE134
0051 I**********                          P  32  380EAMT                               LE0640 CLE134
0052 I**********                             39  41 ECCY                               LE0640 CLE134
0053 I**********                             42  430SETP                               LE0640 CLE134
0054 I**********                             44  45 OSAC                               LE0640 CGL029
     I**********                             44  45 OSACQQ                             CGL029 CLE134
0055 I**********                             56  560REVI                               LE0640 CLE134
0056 I**********                          P  57  630OTHA                               LE0640 CLE134
0057 I**********                             64  66 OTHC                               LE0640 CLE134
0058 I**********                          P  67  738EXRT                               LE0640 CLE134
0059 I**********                          P  74  760VDAT                               LE0640 CLE134
0060 I**********                          P  77  790SLID                               LE0640 CLE134
0061 I**********                          P  80  820MDAT                               LE0640 CLE134
0062 I**********                             83  840BRTT                               LE0640 CLE134
0063 I**********                          P  85  907BRTE                               LE0640 CLE134
0064 I**********                          P  91  967RTSP                               LE0640 CLE134
0065 I**********                          P  97 1027INTR                               LE0640 CLE134
0066 I**********                            103 1030SSEQ                               LE0640 CLE134
     I**************************************349 366 OSAC                               CGL029 CLE042
     I**********                            361 378 OSAC                               CLE042 CLE134
     I**********                            379 392 AKEY                               CLE042 CLE134
     I**********                            379 388 SHAKEY                             CLE042 CLE134
     I**********                            389 392 CLAS                               CLE042 CLE134
     I**********                            384 384 AKY6                               CLE042 CLE134
0067 I*    RECORD CONTENTS                                                LE0640
0068 I****************************************2*128*LOTL                  E47260
0068 I****************************************2 134 LOTL                               E47260 CLE042
0068 I****************************************2 143 LOTL1                              S01117 CLE042
     I**********                              2 392 LOTL1                              CLE042 CLE134
     I**********                            391 396 LNNO                            CLE134 AR1056323
     I**********                             16  21 CNUM                            CLE134 AR1056323
     I**********                             22  24 BRCA                            CLE134 AR1056323
     I**********                             25  260ACSQ                            CLE134 AR1056323
     I**********                          P  27  290EDAT                            CLE134 AR1056323
     I**********                          P  30  360EAMT                            CLE134 AR1056323
     I**********                             37  39 ECCY                            CLE134 AR1056323
     I**********                             40  410SETP                            CLE134 AR1056323
     I**********                             42  53 OSACQQ                          CLE134 AR1056323
     I**********                             54  540REVI                            CLE134 AR1056323
     I**********                          P  55  610OTHA                            CLE134 AR1056323
     I**********                             62  64 OTHC                            CLE134 AR1056323
     I**********                          P  65  718EXRT                            CLE134 AR1056323
     I**********                          P  72  740VDAT                            CLE134 AR1056323
     I**********                          P  75  770SLID                            CLE134 AR1056323
     I**********                          P  78  800MDAT                            CLE134 AR1056323
     I**********                             81  820BRTT                            CLE134 AR1056323
     I**********                          P  83  887BRTE                            CLE134 AR1056323
     I**********                          P  89  947RTSP                            CLE134 AR1056323
     I**********                          P  95 1007INTR                            CLE134 AR1056323
     I**********                            101 1010SSEQ                            CLE134 AR1056323
     I**********                            359 376 OSAC                            CLE134 AR1056323
     I**********                            377 390 AKEY                            CLE134 AR1056323
     I**********                            377 386 SHAKEY                          CLE134 AR1056323
     I**********                            387 390 CLAS                            CLE134 AR1056323
     I**********                            382 382 AKY6                            CLE134 AR1056323
     I**********                              2 396 LOTL1                           CLE134 AR1056323
     I                                       12  17 LNNO                                   AR1056323
     I                                       18  23 CNUM                                   AR1056323
     I                                       24  26 BRCA                                   AR1056323
     I                                       27  280ACSQ                                   AR1056323
     I                                    P  29  310EDAT                                   AR1056323
     I                                    P  32  380EAMT                                   AR1056323
     I                                       39  41 ECCY                                   AR1056323
     I                                       42  430SETP                                   AR1056323
     I                                       44  45 OSACQQ                                 AR1056323
     I                                       56  560REVI                                   AR1056323
     I                                    P  57  630OTHA                                   AR1056323
     I                                       64  66 OTHC                                   AR1056323
     I                                    P  67  738EXRT                                   AR1056323
     I                                    P  74  760VDAT                                   AR1056323
     I                                    P  77  790SLID                                   AR1056323
     I                                    P  80  820MDAT                                   AR1056323
     I                                       83  840BRTT                                   AR1056323
     I                                    P  85  907BRTE                                   AR1056323
     I                                    P  91  967RTSP                                   AR1056323
     I                                    P  97 1027INTR                                   AR1056323
     I                                      103 1030SSEQ                                   AR1056323
     I                                      361 378 OSAC                                   AR1056323
     I                                      379 392 AKEY                                   AR1056323
     I                                      379 388 SHAKEY                                 AR1056323
     I                                      389 392 CLAS                                   AR1056323
     I                                      384 384 AKY6                                   AR1056323
     I* RECORD CONTENTS                                                                    AR1056323
     I                                        2 392 LOTL1                                  AR1056323
0069 I*                                                                   LE0640
0070 I*    ACCOUNT KEYS FILE - TRAILER RECORD                             LE0640
0071 I*                                                                   LE0640
0072 I        NS       1 CT                                               LE0640
0073 I                                    P   2   40NORE                  LE0640
0074 I                                    P   5  120VLAF                  LE0640
0075 I                                    P  13  140VLAL                  LE0640
0076 I*                                                                   LE0640
0077 I*    CATCH ALL                                                      LE0640
0078 I*                                                                   LE0640
0079 I        NS                                                          LE0640
     I** Core hook for externalisation.                                   S01408
     I/COPY WNCPYSRC,LE0640IPG                                            S01408
0080 I**********                                                          S01194
0081 I*****TABLE FILE - INSTALLATION CONTROL DATA RECORD 1.               S01194
0082 I**********                                                          S01194
0083 I*ABLE***NS       2 C0   3 C1  12 C1                                 S01194
0084 I*******AND      13 C0                                               S01194
0085 I**********                              1   1 RECI                  S01194
0086 I**********                              2   30RECT                  S01194
0087 I**********                             12  130RCDE                  S01194
0088 I**********                             14  66 TITL                  S01194
0089 I***********                            67  67 DATF                  S01194
0090 I***********                            68  700DFBR                  S01194
0091 I**********                             74  74 MODI1                 S01194
0092 I**********                             75  75 MODI2                 S01194
0093 I**********                             76  76 MODI3                 S01194
0094 I***********                         P  77  790RUND                  S01194
0095 I***********                            80  86 RUNA                  S01194
0096 I**********                             87  870SFLG                  S01194
0097 I**********                          P  90  920LCD                   S01194
0098 I**********                             93  93 CHTP                  S01194
0099 I**********                          P  94  960TNLU                  S01194
0100 I**********                                                          S01194
0101 I******TABLE FILE - INSTALLATION CONTROL DATA RECORD 2.              S01194
0102 I**********                                                          S01194
0103 I********NS  05   1 CD   2 C0   3 C1                                 S01194
0104 I*******AND      12 C1  13 C1                                        S01194
0105 I**********                              1   1 RECI                  S01194
0106 I**********                              2   30RECT                  S01194
0107 I**********                             12  130RCDE                  S01194
0108 I**********                             14  16 BCCY                  S01194
0109 I**********                             17  19 BCYL                  S01194
0110 I**********                             20  22 HOCY                  S01194
0111 I**********                             23  280HEAD                  S01194
0112 I**********                          P  29  310APDA                  S01194
0113 I**********                             35  35 APFQ                  S01194
0114 I**********                          P  36  380LOGS                  S01194
0115 I**********                             39  40 CUZR                  S01194
0116 I**********                          P  41  430DNWD                  S01194
0117 I**********                             44  460BVLP                  S01194
0118 I**********                             47  49 LOCY                  S01194
0119 I**********                             50  510FDAY                  S01194
0120 I**********                             52  52 ACLD                  S01194
0121 I***********                            53  53 MBIN                  S01194
0122 I**********                             86  86 ISAV                  S01194
0123 I**********                          P  87  890LLOG                  S01194
0124 I**********                          P  90  920LCD                   S01194
0125 I**********                             93  93 CHTP                  S01194
0126 I**********                          P  94  960TNLU                  S01194
0127 I**********                                                          S01194
0128 I*****CATCH ALL                                                      S01194
0129 I**********                                                          S01194
0130 I********NS                                                          S01194
0131 I*                                                                   S01194
0132 I*    LDA - DIAGNOSTIC FOR PROGRAM ABORT                             LE0640
0133 I*                                                                   LE0640
0134 ILDA        UDS                            256                       LE0640
0382 I***********                           134 138 DBFILE                S01117
0383 I***********                           139 167 DBKEY                 S01117
0384 I***********                           168 175 DBPGM                 S01117
0385 I***********                           176 177 DBASE                 S01117
0382 I                                      134 141 DBFILE                S01117
0383 I                                      142 170 DBKEY                 S01117
0384 I                                      171 180 DBPGM                 S01117
0385 I                                      181 1830DBASE                 S01117
     ISDGELR    E DSSDGELRPD                                              S01194
     I              BKAPFQ                          APFQ                  S01194
     I** GENERAL LEDGER DETAILS                                           S01194
     ISDBRCH    E DSSDBRCHPD                                              S01117
      **  EXTERNAL DS FOR BRANCH CODE DETAILS                             S01117
     I              A8CMCD                          CMPYM                 S01117
     ISDBANK    E DSSDBANKPD                                              S01194
      ** BANK DETAILS                                                     S01194
     I              BJURPT                          TITL                  S01194
     I              BJMRDT                          RUNA                  S01194
     I              BJDFIN                          DATF                  S01194
      *                                                                   CAC001
     ISDMMOD    E DSSDMMODPD                                              CAC001
      **  Module Details                                                  CAC001
      *                                                                   CAC001
     IDSFDY     E DSDSFDY                                                 S01194
      *                                                                                       CGL029
     IDSSDY     E DSDSSDY                                                                     CGL029
      *                                                                                       CGL029
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01194
     I*                                                                   S01194
     C**********           MOVEACPY@      BIS@   80                                           CSC042
0139 C********************************************************************LE0640
0140 C**      FIRST CYCLE PROCESSING                                      LE0640
0141 C**                                                                  LE0640
0142 C   40                GOTO DETAIL                                    LE0640
0143 C                     SETON                     40                   LE0640
      *                                                                                       CSC042
     C                     MOVEACPY@      BIS@   80                                           CSC042
      *                                                                                       CSC042
     C*    DEFINE LDA                                                     S01117
     C           *NAMVAR   DEFN           LDA                             S01117
0393 C*                                                                   S01117
0394 C**         FOR DATABASE ERROR REFERENCE                             S01117
0395 C*                                                                   S01117
0144 C                     MOVE 'LE0640'  DBPGM                           LE0640
0397 C                     MOVE ' '       BLANKS 29                       S01117
0398 C                     MOVE BLANKS    DBKEY                           S01117
0145 C**                                                                  LE0640
0230 C**                                                                  S01117
     C*     ACCESS ICD-1 FOR DATE FORMAT, DATABASE ERROR IF NOT FOUND     S01117
     C**
0146 C                     EXSR ZSYSTM                                    LE0640
0147 C   99                SETON                     U7U8  **DATABASE 01**LE0640
0148 C   99                Z-ADD1         DBASE                           LE0640
0149 C***99*****           MOVE ZTABKY    DBKEY                           LE0640
0150 C***99*****           MOVE 'TABLE'   DBFILE                          S01194
0150 C   99                MOVE 'SDBANKPD'DBFILE                          S01194
0151 C   99                GOTO END                                       LE0640
0152 C**                                                                  LE0640
0153 C**   ACCESS ICD 2                                                   LE0640
0154 C**********           MOVE '11'      ZTABKY                          S01194
0155 C********** ZTABKY    CHAINTABLE                55                   S01194
      ** ACCESS GENERAL LEDGER DETAILS                                    S01194
     C**********           CALL 'AOGELRR0'                                S01194              CGL029
     C                     CALL 'AOGELRR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C********** SDGELR    PARM SDGELR    DSFDY                           S01194              CGL029
     C           SDGELR    PARM SDGELR    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANKS                                   S01194
0156 C**N05*****           SETON                     U7U8  **DATABASE 02* S01194
0157 C**N05*****           Z-ADD2         DBASE                           S01194
0158 C**N05*****           MOVE ZTABKY    DBKEY                           S01194
0159 C**N05*****           MOVE 'TABLE'   DBFILE                          S01194
0160 C**N05****            GOTO END                                       S01194
0156 C                     SETON                     U7U8LR**DATABASE 02* S01194
0157 C                     Z-ADD2         DBASE                           S01194
0159 C                     MOVE 'SDGELRPD'DBFILE                          S01194
0160 C                     GOTO END                                       S01194
     C                     END                                            S01194
      *                                                                   CAC001
      **  Access Module Detals                                            CAC001
      *                                                                   CAC001
     C                     CALL 'AOMMODR0'                                CAC001
     C                     PARM '*MSG   ' @RTCD                           CAC001
     C                     PARM '*FIRST ' @OPTN                           CAC001
     C           SDMMOD    PARM SDMMOD    DSFDY                           CAC001
     C           @RTCD     IFNE *BLANKS                                   CAC001
     C                     SETON                     U7U8LR               CAC001
     C                     Z-ADD4         DBASE            ************   CAC001
     C                     MOVE 'SDMMODPD'DBFILE           * DBERR 04 *   CAC001
     C                     GOTO END                        ************   CAC001
     C                     ENDIF                                          CAC001
0161 C**                                                                  LE0640
0162 C**   DETERMINE MODE OF PROCESSING                                   LE0640
0163 C**   MODE 1 - ACCRUAL/PROFIT FREQ EQ DAILY                          LE0640
0164 C**   MODE 2 - ACCRUAL/PROFIT FREQ NE DAILY                          LE0640
0165 C           APFQ      COMP 'D'                  4343                 LE0640
0166 C**                                                                  LE0640
0167 C**   MODE 1 PROCESSING - EXTRACT ALL INTEREST/DISCOUNT ACCOUNT KEYS LE0640
0168 C  N43                SETON                     70                   LE0640
0169 C**                                                                  LE0640
0170 C**   COMMENCE COUNT OF RECORDS OUTPUT TO FILE                       LE0640
0171 C                     Z-ADD1         COUNT2  50                      LE0640
     C** Core hook for externalisation.                                   S01408
     C/COPY WNCPYSRC,LE0640CPG                                            S01408
      *                                                                                       CSC042
     C                     Z-ADD0         ##BNDX  40                                          CSC042
     C           *LIKE     DEFN ##BNDX    B                                                   CSC042
     C           *LIKE     DEFN ##BNDX    ##BSV                                               CSC042
      *                                                                                       CSC042
0172 C**********************************                                  LE0640
0173 C           DETAIL    TAG                             **DETAIL TAG** LE0640
0174 C**                                                                  LE0640
0175 C**    MAINTAIN COUNT OF ALL RECORDS                                 LE0640
0176 C           COUNT1    ADD  1         COUNT1  50                      LE0640
0177 C  N02N03             GOTO END                                       LE0640
     C/COPY WNCPYSRC,LE0640C001
0178 C**                                                                  LE0640
     C** TO GET COMPANY CODE                                              S01117
     C**                                                                  S01117
     C                     MOVELBRCA      ##KB                                                CSC042
     C                     EXSR ##CHKB                                                        CSC042
      * If branch is in the array then use the details                                        CSC042
     C           ##FIC     IFEQ 'Y'                        *** B10                            CSC042
     C                     EXSR ##SETB                                                        CSC042
     C                     ELSE                            *** X10                            CSC042
     C**********           CALL 'AOBRCHR0'                                S01117              CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       S01117
     C                     PARM '*KEY   ' @OPTN   7                       S01117
     C                     PARM BRCA      @DSNB   3                       S01117
     C********** SDBRCH    PARM SDBRCH    DSFDY                           S01117              CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANKS                                   S01117
     C                     MOVEL@DSNB     DBKEY                           S01117
     C                     MOVEL'SDBRCHPD'DBFILE           ************   S01117
     C                     Z-ADD03        DBASE            * DBASE 03 *   S01117
     C                     MOVEL@OPTN     DBOPTN  7        ************   S01117
     C                     SETON                     U7U8LR               S01117
     C                     GOTO END                                       S01117
     C                     ELSE                                                               CSC042
      * Details found on the DB so add them to the array                                      CSC042
      * if the array still has room                                                           CSC042
     C                     EXSR ##ADDB                                                        CSC042
     C                     END                                            S01117
     C                     END                             *** E10                            CSC042
     C*                                                                   S01117
0179 C**   MAINTAIN HASH TOTALS - DETAIL RECORDS                          LE0640
0180 C                     Z-ADDHSHWN1    ZZTOTI                          LE0640
0181 C                     Z-ADDHSHDC1    ZZTOTD                          LE0640
0182 C**                                                                  LE0640
0183 C**   IF AMOUNT IS NEGATIVE,REVERSE SIGN                             LE0640
0184 C           EAMT      DIV  1000      ZZAMT        41                 LE0640
0185 C   41                Z-SUBZZAMT     ZZAMT                           LE0640
0186 C                     EXSR GLZADD                                    LE0640
0187 C                     Z-ADDZZTOTI    HSHWN1 150                      LE0640
0188 C                     Z-ADDZZTOTD    HSHDC1  30                      LE0640
0189 C**                                                                  LE0640
     C           REVI      IFEQ 0                                         188691
0188 C**********           Z-ADDLNNO      KEY1    60                                   109350 CLE148
     C                     MOVELLNNO      KEY1    6                                           CLE148
0188 C                     MOVE 'A'       KEY2    1                       109350
0188 C           LOKY      KLIST                                          109350
0188 C                     KFLD           KEY1                            109350
0188 C                     KFLD           KEY2                            109350
0188 C           LOKY      CHAINCLOANCLF             55                   109350
0188 C           *IN55     IFEQ '1'                                       109350
0188 C**********           SETOF                     70            109350 188691
     C                     MOVE '0'       *IN02                           188691
0188 C                     GOTO END                                       109350
0188 C                     END                                            109350
     C                     ENDIF                                          188691
0190 C**   INTEREST/DISCOUNT ACCOUNT KEY RECORDS TO BE EXTRACTED          LE0640
0191 C  N02                GOTO END                                       LE0640
      *                                                                   CAC001
      **  If Analytical Accounting is installed, do not process new       CAC001
      **  Cost of Funds account keys                                      CAC001
      *                                                                   CAC001
     C           BGN0ST    IFEQ 'Y'                                       CAC001
     C           AKY6      IFEQ 'T'                                       CAC001
     C           AKY6      OREQ 'F'                                       CAC001
     C                     MOVE '0'       *IN02                           CAC001
     C                     GOTO END                                       CAC001
     C                     ENDIF                                          CAC001
     C                     ENDIF                                          CAC001
      *                                                                   CAC001
     C***********REVI      IFEQ 1                                  E16380 113361
     C***********          SETOF                     02            E16380 113361
     C***********          GOTO END                                E16380 113361
     C***********          END                                     E16380 113361
0192 C**                                                                  LE0640
0193 C**   FOR MODE '2' PROCESSING - EXTRACT SORT SEQ. '2' RECORDS ONLY   LE0640
0194 C   43      SSEQ      COMP 2                        70               LE0640
0195 C**                                                                  LE0640
0196 C  N70                GOTO END                                       LE0640
0197 C**                                                                  LE0640
     C** Core hook for externalisation.                                   S01408
     C/COPY WNCPYSRC,LE0640CVSF                                           S01408
0198 C**   MAINTAIN RECORD COUNT & HASH TOTALS FOR OUTPUT FILE            LE0640
0199 C           COUNT2    ADD  1         COUNT2                          LE0640
0200 C                     Z-ADDHSHWN2    ZZTOTI                          LE0640
0201 C                     Z-ADDHSHDC2    ZZTOTD                          LE0640
0202 C**                                                                  LE0640
0203 C**   IF AMOUNT IS NEGATIVE,REVERSE SIGN                             LE0640
0204 C           EAMT      DIV  1000      ZZAMT        41                 LE0640
0205 C   41                Z-SUBZZAMT     ZZAMT                           LE0640
0206 C                     EXSR GLZADD                                    LE0640
0207 C                     Z-ADDZZTOTI    HSHWN2 150                      LE0640
0208 C                     Z-ADDZZTOTD    HSHDC2  30                      LE0640
0209 C**                                                                  LE0640
0210 C           END       TAG                             **END TAG**    LE0640
0211 C   U7                SETON                     LR                   LE0640
0212 C**                                                                  LE0640
0213 C**   LAST RECORD PROCESSING                                         LE0640
0214 CLRNU8      NORE      COMP COUNT1               U8U8                 LE0640
0215 CLRNU8      VLAF      COMP HSHWN1               U8U8                 LE0640
0216 CLRNU8      VLAL      COMP HSHDC1               U8U8                 LE0640
0217 CLR         COUNT2    ADD  1         COUNT2                          LE0640
     CLR U7 U8             EXSR *PSSR                                     S01117
     C*                                                                   S01117
0218 C********************************************************************LE0640
      /EJECT                                                                                  CSC042
2431 C********************************************************************                    CSC042
      *                                                                                       CSC042
      * ##CHKB - Subroutine to check the Branch in the arrays                                 CSC042
      *                                                                                       CSC042
     C           ##CHKB    BEGSR                                                              CSC042
      *                                                                                       CSC042
     C           *LIKE     DEFN A8BRCD    ##KB                                                CSC042
      *                                                                                       CSC042
      * Set off the branch found indicator                                                    CSC042
     C                     MOVEL*BLANK    ##FIC   1                                           CSC042
      *                                                                                       CSC042
      * Save the state of indicator 30 so it can be reset at the end                          CSC042
      * of the SR as it may be used elsewhere in the code                                     CSC042
     C           *IN30     IFEQ *ON                                                           CSC042
     C                     MOVEL'Y'       #IN30   1                                           CSC042
     C                     ELSE                                                               CSC042
     C                     MOVEL'N'       #IN30                                               CSC042
     C                     ENDIF                                                              CSC042
      *                                                                                       CSC042
     C                     SETOF                         30                                   CSC042
      *                                                                                       CSC042
      * Restore the saved Value of B                                                          CSC042
     C                     Z-ADD##BSV     B                                                   CSC042
      *                                                                                       CSC042
     C* Check whether details for Branch already in array                                     CSC042
      *                                                                                       CSC042
      * Is this the same as the last LOKUP, if so we can bypass                               CSC042
      * the LOKUP                                                                             CSC042
      * Defend against B being 0                                                              CSC042
     C           B         IFEQ 0                                                             CSC042
     C                     Z-ADD1         B                                                   CSC042
     C                     ENDIF                                                              CSC042
      *                                                                                       CSC042
      * If the branch being checked is the same then use these                                CSC042
      * details rather than doing a LOKUP                                                     CSC042
     C           ##KB      IFEQ ##BR,B                                                        CSC042
      * Found so seton 30                                                                     CSC042
     C                     SETON                         30                                   CSC042
     C                     ELSE                                                               CSC042
     C                     Z-ADD1         B                                                   CSC042
     C           ##KB      LOKUP##BR,B                   30                                   CSC042
     C                     ENDIF                                                              CSC042
      *                                                                                       CSC042
      * Save the last update to B                                                             CSC042
     C           *IN30     IFEQ *ON                                                           CSC042
     C                     Z-ADDB         ##BSV                                               CSC042
      * Set the indicator to show the data was found                                          CSC042
     C                     MOVEL'Y'       ##FIC                                               CSC042
     C                     ENDIF                                                              CSC042
      *                                                                                       CSC042
      * Reset the state of indicator 30.                                                      CSC042
     C           #IN30     IFEQ 'Y'                                                           CSC042
     C                     MOVEL*ON       *IN30                                               CSC042
     C                     ELSE                                                               CSC042
     C                     MOVEL*OFF      *IN30                                               CSC042
     C                     ENDIF                                                              CSC042
      *                                                                                       CSC042
     C                     ENDSR                                                              CSC042
      ********************************************************************                    CSC042
      /EJECT                                                                                  CSC042
      ********************************************************************                    CSC042
      *                                                                                       CSC042
      * ##SETB - Sets up the SDBRCHPD fields used in the code from the                        CSC042
      * arrays                                                                                CSC042
      *                                                                                       CSC042
     C           ##SETB    BEGSR                                                              CSC042
      *                                                                                       CSC042
     C                     MOVEL##BR,B    A8BRCD                                              CSC042
     C                     MOVEL##BC,B    CMPYM                                               CSC042
      *                                                                                       CSC042
     C                     ENDSR                                                              CSC042
      *                                                                                       CSC042
      ********************************************************************                    CSC042
      /EJECT                                                                                  CSC042
      ********************************************************************                    CSC042
      *                                                                                       CSC042
      * ##ADDB - Adds the SDBRCHPD fields used in the code to the                             CSC042
      * arrays                                                                                CSC042
      *                                                                                       CSC042
     C           ##ADDB    BEGSR                                                              CSC042
      *                                                                                       CSC042
      * If there is still room in the array then add the details                              CSC042
     C           ##BNDX    IFLT 999                                                           CSC042
     C                     ADD  1         ##BNDX                                              CSC042
     C                     Z-ADD##BNDX    B                                                   CSC042
     C                     MOVELA8BRCD    ##BR,B                                              CSC042
     C                     MOVELCMPYM     ##BC,B                                              CSC042
     C                     ENDIF                                                              CSC042
      *                                                                                       CSC042
      * Update ##BSV  so next call to ##CHKB checks this latest adddition                     CSC042
      * to the array firss                                                                    CSC042
     C                     Z-ADDB         ##BSV                                               CSC042
      *                                                                                       CSC042
     C                     ENDSR                                                              CSC042
      ********************************************************************                    CSC042
      /EJECT                                                                                  CSC042
      ********************************************************************                    CSC042
0219 C/SPACE 3                                                            LE0640
0220 C********************************************************************LE0640
0221 C* SUBROUTINE TO ADD AN AMOUNT (ZZAMT) TO THE TOTAL (ZZTOTI,ZZTOTD)  LE0640
0222 C*   IND '99' IS SET BY AN OVERFLOW ERROR                            LE0640
0223 C*                                                                   LE0640
0224 CSR         GLZADD    BEGSR                           *** GLZADD ****LE0640
0225 C*                                                                   LE0640
0226 CSR                   Z-ADDZZAMT     ZZAMT  153     91-DEFINE ZZAMT  LE0640
0227 CSR 91                GOTO ZZAEND                     AMT = 0.BYPASS LE0640
0228 C*                                                                   LE0640
0229 C* SPLIT ZZAMT INTO INTEGER AND DECIMAL FIELDS                       LE0640
0230 CSR                   Z-ADDZZAMT     ZZAMTI 150       INTEGER FIELD  LE0640
0231 CSR                   MOVE ZZAMT     ZZAMTD  30       DECIMAL FIELD  LE0640
0232 C* BOTH ZZAMTI AND ZZAMTD CONTAIN A 'SIGN' ZONE NOW                  LE0640
0233 C*                                                                   LE0640
0234 CSR                   EXSR GLZSUM                                    LE0640
0235 CSR         ZZAEND    ENDSR                           ** ZZAEND TAG *LE0640
0236 C*                                                                   LE0640
0237 C********************************************************************LE0640
0238 C********************************************************************LE0640
0239 C* SUBROUTINE TO CARRY OUT THE ADDITION FOR SUBROUTINES -            LE0640
0240 C*                        GLZADD, GLZSUB, GLZCMP.                    LE0640
0241 C*          PARAMETERS PASSED -                                      LE0640
0242 C*                     I/P ZZAMTI ZZAMTD                             LE0640
0243 C*                     O/P ZZTOTI ZZTOTD ZZNEGD IND 96 IND 99.       LE0640
0244 C*                                                                   LE0640
0245 CSR         GLZSUM    BEGSR                           *** GLZSUM ****LE0640
0246 C*                                                                   LE0640
0247 CSR                   Z-ADDZZTOTI    ZZTOTI 150       DEFINE ZZTOTI  LE0640
0248 CSR                   Z-ADDZZTOTD    ZZTOTD  30       DEFINE ZZTOTD  LE0640
0249 CSR                   SETOF                     919293               LE0640
0250 CSR                   SETOF                     949599               LE0640
0251 C*                                                                   LE0640
0252 C*    DETERMINE SIGN OF ZZAMTI & D,   92 IF NEG                      LE0640
0253 CSR         ZZAMTI    COMP 0                      9293               LE0640
0254 CSR 93      ZZAMTD    COMP 0                      9293               LE0640
0255 CSR 93                GOTO ZZSEND                     ZERO BYPASS    LE0640
0256 C*                                                                   LE0640
0257 C*    DETERMINE SIGN OF ZZTOTI & D, 91 IF NEG.                       LE0640
0258 CSR         ZZTOTI    COMP 0                      9193               LE0640
0259 CSR 93      ZZTOTD    COMP 0                      9193               LE0640
0260 C*                                                                   LE0640
0261 C*    IF ZZTOTAL IS ZERO, RETURN ZZAMOUNT.                           LE0640
0262 CSR 93                Z-ADDZZAMTI    ZZTOTI                          LE0640
0263 CSR 93                Z-ADDZZAMTD    ZZTOTD                          LE0640
0264 CSR 93                GOTO ZZSEND                     ZERO BYPASS    LE0640
0265 C*    IF SIGNS DIFFER BYPASS OVERFLOW CHECKS.                        LE0640
0266 CSR 91N92                                                            LE0640
0267 CORN91 92             GOTO ZZOFPS                                    LE0640
0268 C*                                                                   LE0640
0269 CSR         ZZAMTD    ADD  ZZTOTD    ZZWK2   40                      LE0640
0270 CSR         ZZWK2     COMP 999                  93    '93' = CARRY   LE0640
0271 CSRN93      ZZWK2     COMP -999                   93    INTO INTEGER.LE0640
0272 C*                                                                   LE0640
0273 CSR 93N92   ZZAMTI    ADD  1         ZZWK3  150       ADD 'CARRY' +VELE0640
0274 CSR    93 92ZZAMTI    SUB  1         ZZWK3            SUB 'CARRY' -VELE0640
0275 CSR 93      ZZTOTI    ADD  ZZWK3     ZZWK3                           LE0640
0276 CSRN93      ZZTOTI    ADD  ZZAMTI    ZZWK3                           LE0640
0277 C*                                                                   LE0640
0278 C* IF THE MODULUS OF ZZWK3 IS LT MOD. ZZTOTI THEN O/F HAS OCCURED    LE0640
0279 CSRN92      ZZWK3     COMP ZZTOTI                 99  -92 MEANS NOS. LE0640
0280 CSR 92      ZZWK3     COMP ZZTOTI               99     NEGATIVE      LE0640
0281 CSRN99                Z-ADDZZWK2     ZZTOTD                          LE0640
0282 CSRN99                Z-ADDZZWK3     ZZTOTI                          LE0640
0283 C*                                                                   LE0640
0284 C* IF O/F ZEROIZE ZZAMT , IND '99' SET AND ZZTOT FIELDS LEFT INTACT. LE0640
0285 CSR 99                Z-ADD0         ZZAMT  153                      LE0640
0286 CSR                   GOTO ZZSEND                                    LE0640
0287 C*                                                                   LE0640
0288 C* THE 'SIGNS' ARE DIFFERENT                                         LE0640
0289 CSR         ZZOFPS    TAG                             ** ZZOFPS TAG**LE0640
0290 C* IF ZZAMT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZTOT            LE0640
0291 C*                                                                   LE0640
0292 CSR 92                Z-SUBZZAMTI    ZZAMTI 150                      LE0640
0293 CSR 92                Z-SUBZZAMTD    ZZAMTD  30                      LE0640
0294 C*                                                                   LE0640
0295 C* IF ZZTOT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZAMT.           LE0640
0296 C*                                                                   LE0640
0297 CSR 91                Z-SUBZZTOTI    ZZTOTI                          LE0640
0298 CSR 91                Z-SUBZZTOTD    ZZTOTD                          LE0640
0299 C* BOTH ZZAMT AND ZZTOT ARE NOW POSITIVE.                            LE0640
0300 C*                                                                   LE0640
0301 CSR         ZZTOTI    COMP ZZAMTI               93  95               LE0640
0302 CSR 95      ZZTOTD    COMP ZZAMTD               93  95               LE0640
0303 C*                                                                   LE0640
0304 C* IF ZZTOT EQ. ZZAMT RETURN ZERO.                                   LE0640
0305 CSR 95                Z-ADD0         ZZTOTI                          LE0640
0306 CSR 95                Z-ADD0         ZZTOTD                          LE0640
0307 CSR 95                GOTO ZZSEND                                    LE0640
0308 C*                                                                   LE0640
0309 C* IF ZZTOT GT. ZZAMT.                                               LE0640
0310 CSR 93      ZZAMTD    COMP ZZTOTD               94                   LE0640
0311 CSR 93 94   ZZTOTI    SUB  1         ZZTOTI                          LE0640
0312 CSR 93 94   ZZTOTD    ADD  1000      ZZWK2                           LE0640
0313 CSR 93      ZZTOTI    SUB  ZZAMTI    ZZTOTI                          LE0640
0314 CSR 93 94   ZZWK2     SUB  ZZAMTD    ZZTOTD                          LE0640
0315 CSR 93N94   ZZTOTD    SUB  ZZAMTD    ZZTOTD                          LE0640
0316 C*                                                                   LE0640
0317 C*                                                                   LE0640
0318 C* IF ZZAMT GT. ZZTOT.                                               LE0640
0319 CSRN93      ZZTOTD    COMP ZZAMTD               94                   LE0640
0320 CSRN93 94   ZZAMTI    SUB  1         ZZWK3  150                      LE0640
0321 CSRN93 94   ZZAMTD    ADD  1000      ZZWK2                           LE0640
0322 CSRN93 94   ZZWK3     SUB  ZZTOTI    ZZTOTI                          LE0640
0323 CSRN93N94   ZZAMTI    SUB  ZZTOTI    ZZTOTI                          LE0640
0324 CSRN93 94   ZZWK2     SUB  ZZTOTD    ZZTOTD                          LE0640
0325 CSRN93N94   ZZAMTD    SUB  ZZTOTD    ZZTOTD                          LE0640
0326 C*                                                                   LE0640
0327 C* REVERSE SIGN OF ZZTOT IF LARGER I/P FIELDS WERE NEGATIVE          LE0640
0328 CSR                   SETOF                     94                   LE0640
0329 CSR 93 91                                                            LE0640
0330 CORN93 92             SETON                     94                   LE0640
0331 CSR 94                Z-SUBZZTOTI    ZZTOTI                          LE0640
0332 CSR 94                Z-SUBZZTOTD    ZZTOTD                          LE0640
0333 C**                                                                  LE0640
0334 C**   RESTORE SIGN OF ZZAMTI & ZZAMTD IF IT WAS REVERSED.            LE0640
0335 CSR 92                Z-SUBZZAMTI    ZZAMTI                          LE0640
0336 CSR 92                Z-SUBZZAMTD    ZZAMTD                          LE0640
0337 CSR         ZZSEND    TAG                             ** ZZSEND TAG *LE0640
0338 C**                                                                  LE0640
0339 C**   IF ZZTOTD IS ZERO, AND ZZTOTI IS NEG. SET UP ZZNEGD.           LE0640
0340 CSR                   SETOF                     96                   LE0640
0341 CSR         ZZTOTD    COMP 0                        91               LE0640
0342 CSR 91      ZZTOTI    COMP 0                      96                 LE0640
0343 CSR 96                MOVE '.000-'   ZZNEGD  5                       LE0640
0344 CSR                   ENDSR                             ** ENDSR **  LE0640
0345 C********************************************************************LE0640
0346 C********************************************************************LE0640
0347 C**                                                                  LE0640
0348 C**   ZSYSTM SR. TO CHAIN TO THE INSTALLATION CONTROL DATA RECORD.   LE0640
0349 C**                                                                  LE0640
0350 C           ZSYSTM    BEGSR                           *** ZSYSTM *** LE0640
0351 C**********                                                          S01194
0352 C*****SET UP KEY FOR INSTALLATION CONTROL RECORD.                    S01194
0353 C**********           MOVEL'01      'ZTABKY 12                       S01194
0354 C**********           MOVE '  10'    ZTABKY                          S01194
0355 C**********                                                          S01194
0356 C********** ZTABKY    CHAINTABLE                99    ON NOT THERE   S01194
0357 C**N99***** RECI      COMP 'D'                  9999  ON, IS DELETED S01194
0358 C**                                                                  LE0640
     C                     CALL 'AOBANKR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDBANK    PARM SDBANK    DSFDY                           S01194
     C*                                                                   S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     SETON                         99               S01194
     C                     END                                            S01194
0359 C**   CHECK SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.                    LE0640
0360 C           DATF      COMP 'M'                      98MMDDYY, 98 ON  LE0640
0361 C**                                                                  LE0640
0362 C                     ENDSR                                          LE0640
0363 C**                                                                  LE0640
0364 C**                                                                  LE0640
0365 C********************************************************************LE0640
     C/SPACE 3                                                            S01117
     C********************************************************************S01117
     C*                                                                   S01117
     C*  *PSSR --- SUBROUTINE TO HANDLE ABNORMAL ERROR CONDITIONS         S01117
     C*                                                                   S01117
     C*  CALLED FROM: AFTER ABNORMAL OPERATION OCCURS                     S01117
     C*                                                                   S01117
     C*  CALLS: NOTHING                                                   S01117
     C*                                                                   S01117
     C********************************************************************S01117
     C*                                                                   S01117
     C           *PSSR     BEGSR                           ** *PSSR **    S01117
     C*                                                                   S01117
     C           @RUN      IFEQ *BLANKS                                   S01117
     C                     MOVE 'Y'       @RUN    1                       S01117
     C                     DUMP                                           S01117
     C                     END                                            S01117
     C                     ENDSR                           ** *PSSR **    S01117
     C*                                                                   S01117
     C********************************************************************S01117
0366 OIACEXHH D        01                                                 LE0640
0367 O                                    1 'H'                           LE0640
0368 OIACEXDP D        02 70                                              LE0640
0369 O                                    1 'D'                           LE0640
0370 O*************************LOTL*****128                               E47260
0370 O***********              LOTL     134                        E14260 125850
0370 O*************************LOTL1    143                                            125850 CLE042
     O**********               LOTL1    392                                            CLE042 CLE134
     O**********               LOTL1    396                                         CLE134 AR1056323
     O                         LOTL1    392                                                AR1056323
     O                         SHAKEY    11                                                   CLE042
0370 O                         CMPYM    128                               S01117
     O*************************OSAC     161                                            CGL029 CLE042
0371 OIACEXZZ T        LR                                                 LE0640
0372 O                                    1 'T'                           LE0640
0373 O                         COUNT2     4P                              LE0640
0374 O                         HSHWN2    12P                              LE0640
0375 O                         HSHDC2    14P                              LE0640
0376 O**                                                                  LE0640
0377 O**   RUN CONTROL REPORT                                             LE0640
0378 O**                                                                  LE0640
0379 O*E0640P1T** 03   LR                                       S01124    S01117
0379 OLE0640AUT   03   LR                                                 S01117
0380 O***********                        22 'REFERENCE  LE0640'           S01117
0380 O                                   24 'REFERENCE  LE0640AU'         S01117
0381 O                         TITL      89                               LE0640
0382 O                                  104 'DATE'                        LE0640
0383 O                         RUNA     112                               LE0640
0384 O                                  127 'PAGE    1'                   LE0640
0385 O        T   05   LR                                                 LE0640
0386 O                                   72 'INTEREST ACCRUAL EXTRACT'    LE0640
0387 O                                   88 '- FILE CONTROLS'             LE0640
0388 O        T   06   LR                                                 LE0640
0389 O                                   72 '------------------------'    LE0640
0390 O                                   88 '----------------'            LE0640
0391 O        T   09   LR                                                 LE0640
0392 O                                   28 'S/IACEX - RUN CONTROLS'      LE0640
0393 O                                   59 'NUMBER'                      LE0640
0394 O                                   84 'VALUE'                       LE0640
0395 O        T   10   LR                                                 LE0640
0396 O                                   28 '----------------------'      LE0640
0397 O                                   59 'OF RECORDS'                  LE0640
0398 O                                   84 'OF RECORDS'                  LE0640
0399 O        T   12   LR                                                 LE0640
0400 O                                   29 'TOTAL RECORDS ON FILE'       LE0640
0401 O                         COUNT23   59                               LE0640
0402 O                         HSHWN24   81                               LE0640
0403 O                         HSHDC2    84                               LE0640
0404 O        T   15   LR                                                 LE0640
0405 O                                   28 'S/LKEY1 - RUN CONTROLS'      LE0640
0406 O        T   16   LR                                                 LE0640
0407 O                                   28 '----------------------'      LE0640
0408 O        T   18   LR                                                 LE0640
0409 O                                   29 'TOTAL RECORDS ON FILE'       LE0640
0410 O                      NU7NORE  3   59                               LE0640
0411 O                      NU7VLAF  4   81                               LE0640
0412 O                      NU7VLAL      84                               LE0640
0413 O        T   20   LR                                                 LE0640
0414 O                                   29 'TOTAL RECORDS ON FILE'       LE0640
0415 O                                   42 '- CALCULATED'                LE0640
0416 O                         COUNT13   59                               LE0640
0417 O                         HSHWN14   81                               LE0640
0418 O                         HSHDC1    84                               LE0640
0419 O                    U8NU7         111 '***   DIFFERENCE   ***'      LE0640
0420 O        T 32     LR U7                                              LE0640
0421 O***********                        51 '*** REFERENCE LE0640'        S01117
0422 O***********                        71 '- DATABASE ERROR AT'         S01117
0423 O***********              DBASE     74                               S01117
0802 O                                   39 '*** REFERENCE ***'           S01117
0803 O                         DBPGM     51                               S01117
0804 O                                   71 'DATABASE ERROR AT'           S01117
0805 O                         DBASE     75                               S01117
0424 O        T        LR U7                                              LE0640
0425 O***********                        37 'FILENAME'                    S01117
0426 O***********              DBFILE    43                               S01117
0427 O***********                        48 'KEY'                         S01117
0428 O***********              DBKEY     78                               S01117
1063 O                                   39 'FILENAME'                    S01117
1064 O                         DBFILE    48                               S01117
1065 O                                   52 'KEY'                         S01117
1066 O                         DBKEY     82                               S01117
0429 O********T*3      LR                                                 S01117
0430 O***********                        76 '*** END OF REPORT ***'       S01117
** CPY@   **      OBJECT COPYRIGHT
(c) Finastra International Limited 2001
