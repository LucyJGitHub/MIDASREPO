0001 H        1                                                           S01117
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas LE Interest accruals report')                    *
0001 H***********                                                         S01117
0002 F********************************************************************LE0650
0003 F*                                                                  *LE0650
     F*  Midas   Customer Lending Module                              LE0650
0005 F*                                                                  *LE0650
0006 F*     LE0650 - INTEREST ACCRUALS REPORT                            *LE0650
0007 F*                                                                  *LE0650
      *  (c) Finastra International Limited 2001                      *
0009 F*                                                               *
      *  Last Amend No. MD046248           Date 27Oct17               *
      *  Prev Amend No. CLE154             Date 07Aug12               *
      *                 AR1056323          Date 14Nov12               *
      *                 CLE134             Date 01Aug12               *
      *                 CLE148             Date 23Jul12               *
      *                 CER059             Date 19Jul10               *
      *                 CER047             Date 19May08               *
      *                 CER043             Date 19May08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      *                 CSC042             Date 16Feb09               *
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CSD031             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 CLE042             Date 06Sep05               *
      *                 CSW037A            Date 02May05               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 CLE025             Date 20Oct03               *
      *                 CGL029             Date 01Sep03               *
      *                 CAS006             Date 21Jan03               *
      *                 CAS005             Date 16Dec02               *
      * Midas Release 4.01.02 ----------------------------------------*
      *                 201123             Date 07Mar02               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.05 -----------------------------------------------*
      *                 CLE011             Date 07Nov00               *
      * Midas DBA 3.04 -----------------------------------------------*
      *                 182576             Date 28Sep00               *
      * Midas DBA 3.03 -----------------------------------------------*
      *                 163100             Date 17Jan00               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
     F*                    125850          DATE 30SEP98               *
     F*                    134051          DATE 28SEP98               *
     F*                    093584             DATE 28FEB96               *
     F*                    072582             DATE 12OCT94               *S01392
     F*                    S01392             DATE 30OCT92               *S01392
     F*                    S01194             DATE 11JAN90               *LE0650
0010 F*                    E16863             DATE 13DEC89               *LE0650
0010 F*                    E47260             DATE 13DEC89               *LE0650
0010 F*                    S01117             DATE 15/08/89              *LE0650
0010 F*                    E16461             DATE 11/01/89              *LE0650
0010 F*                    E16380             DATE 23/12/88              *LE0650
0010 F*                    E11590             DATE 04/11/87              *LE0650
0010 F*                    E81286             DATE 08/01/87              *LE0650
0011 F*                                                                  *LE0650
     F*------------------------------------------------------------------*
     F*                                                                  *
      *  MD046248 - Finastra Rebranding                               *
      *  CLE154 - Loan Repayment Schedule Enhancement (Recompile)     *
      *  AR1056323 - Revert back changes of CLE134 for LKEY1DP and    *
      *              LKEYFED                                          *
      *  CLE134 - Past Due Call Loan Processing                       *
      *  CLE148 - Alpha Loan Reference                                *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  CER047 - German Features LF037-00 Reporting §24c             *
      *           (Recompile)                                         *
      *  CER043 - German Features LF041-00 New Fields and Defaulting  *
      *           (Recompile)                                         *
      *  CSC042 - COB Performance fix. Only access AOBRCHR0 on change *
      *           of branch rather than every record as input file    *
      *           sorted by branch                                    *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CLE042 - Extended Loan Sub Type                              *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  CLE025 - Credit Lines (Recompile)                            *
      *  CGL029 - Increase Account Code to 10 digits (Recompile)      *
      *  CAS006 - Hedge Accounting Phase B (Recompile)                *
      *  CAS005 - Enahancements to CAS001, CAS002 and CAS004          *
      *           (Recompile)                                         *
      *  201123 - Include Original Borrower in this report when       *
      *           processing type of loan is either 64, 65, 68 or 71. *
      *  CLE011 - Rate Fixing Days for Lending Rollover Processing    *
      *           Recompile                                           *
     F*   182576 - Recompile over changed version of HISTS            *
     A*   163100 - Interest rate and Principle not appearing on report*
     A*            LE0650P1. This is because the fields CPAM and INTR *
     A*            on file HISTSHP need to be renamed to something    *
     A*            else so they do not write over the IACEXDP fields. *
     A*   125850 - Wrong "From Date" in interest accrual report.      *
     A*            Layout IACEXDP doesn't match with LKEY1DP.         *
     A*            Applied fix 090681.                                *
     F*   134051 - Wrong "To Date" and interest rate in interest      *
     F*            accrual report. As an addition to the existing fix,*
     F*            it was necessary to rename field NLRA to NLRAK in  *  *
     F*            CLOANCK to avoid confusion with NLRA in CLOANZ1    *  *
     F*            which has different length.                        *  *
     F*     093584 - Unable to change form length of spool file output   *
     F*              by changing printer file - remove Line specs.       *
     F*     072582 - Margin posting amounts are calculated wrongly.      *
     F*     S01392  -  JAPANESE SUB MODULE ENHANCEMENTS                  *S01392
     F*     S01194  -  STANDING DATA CHANGES                             *S01194
     F*     E16863  -  REMOVE E11590,E16461,AND E16380 DUE TO WRONG      *E16863
     F*                ASSUMPTION.                                       *E16863
     F*     E47260  -  WRONG FROM DATE ON INTEREST ACCRUAL REPORT DUE    *E47260
     F*                TO AN ACCRUAL/PROFIT DATE OCCURRING SINCE LAST    *E47260
     F*                INTEREST DATE OF THE LOAN.                        *E47260
     F*     S01117  -  MULTIBRANCHING                                    *
     F*                                                                  *E16461
     F*     E16461  -  FOR AN ERROR ON THE CHAIN TO CLOAN, THE LOAN      *E16461
     F*                NUMBER IS MOVED INTO THE DBKEY FIELD              *E16461
     F*                INSTEAD OF THE FULL KEY.                          *E16461
     F*                                                                  *E16461
     F*     E16380  -  WRONGLY APPLIED ERROR FIX - E11590                *E16380
     F*                                                                  *E16461
     F*     E11590  -  FREQUENCY REPAYMENTS DATED TODAY ARE NOT          *E11590
     F*                REFLECTED IN THE PRINCIPLE AMOUNT.                *E11590
     F*                EVERYTHING IS OK IF IT IS A MANUAL REPAYMENT.     *E11590
     F*                                                                  *E16461
     F*     E81286  -  TOTAL LINES ON THE REPORT WERE BEING              *E81286
     F*                PRINTED ACROSS COMPUTER PAGES.                    *E81286
     F*                                                                  *
0012 F********************************************************************LE0650
0011 F*                                                                  *LE0650
     F*  C R E A T I O N     P A R A M E T E R S                      *
     F*                                                               *
     F*                                                               *
     F*****************************************************************
0011 F*                                                                  *LE0650
0013 F*NACS***IP**F     128 23AI     2 DISK                               E47260
0013 F*******INACS   IP  F     134 23AI     2 DISK                 E47260 125850
0013 F***INACS** IP  F     143 23AI     2 DISK                                         125850 CGL029
     F*INACS***IP**F*****161 23AI     2 DISK                                           CGL029 CLE042
     F***INACS** IP  F     392 27AI     2 DISK                                         CLE042 CLE134
     F***INACS** IP  F     396 27AI     2 DISK                                      CLE134 AR1056323
     FINACS   IP  F     392 27AI     2 DISK                                                AR1056323
     FHISTS   IF  E           K        DISK                               134051
     F            HISTSHMF                          KIGNORE               134051
     F            HISTSHNF                          KIGNORE               134051
     F            HISTSHHF                          KIGNORE               134051
     F            HISTSHQF                          KIGNORE               134051
     F            HISTSZXF                          KIGNORE               134051
     FCLOAN   IF  E           K        DISK                               072582
0014 F*TABLE***IF**F      96 12AI     2 DISK                              S01194
0015 F*TABLED**IF**F      96 12AI     2 DISK                              S01194
0016 F*LOAN***IF  F     400  7AI     2 DISK                        E11590 E16863
0016 F*CLINT***IF**F     256  7AI     2 DISK                              S01194
     FSDCURRPDIF  E                    DISK                               S01194
0017 F*E0650P1O** F     132     OF    LPRINTER                  S01124    S01117
0017 F*E0650P1O***F     132     OF    LPRINTER      KINFDS SPOOL   S01117 093584
0017 FLE0650P1O   F     132     OF     PRINTER      KINFDS SPOOL      UC  093584
0017 FLE0650AUO   F     132     OA     PRINTER      KINFDS SPOOLU         S01117
0011 F*                                                                  *LE0650
0018 F* ID F  C  H  L    FUNCTION OF INDICATORS                           LE0650
0019 F* 01            S/INACS - DETAIL RECORD                             LE0650
0020 F* 02                    -TRAILER RECORD                             LE0650
0021 F**07**********  S/TABLE - LOAN TYPE/SUB TYPE RECORD                 S01194
0022 F**08****        S/CLOAN - DETAIL RECORD 'D'                  E11590 E16863
0022 F**10**********  S/CLINT - DETAIL RECORD 'A'                         S01194
0023 F*    21         EVENT DATE NON-ZERO                                 LE0650
0024 F*    22         START/LAST INTEREST DATE NON-ZERO                   LE0650
0025 F*       30      ACCRUAL FREQUENCY IS DAILY                          LE0650
     F*       33      MULITBRANCHING INDICATOR (MBIN) = 'Y'               S01117
     F*       35      CONTROL TOTAL CHECKING SUPPRESSED                   S01117
0026 F*       40      CONTROLS FIRST CYCLE PROCESSING                     LE0650
0027 F*       41      GENERAL PURPOSE                                     LE0650
0028 F*       42      EMPTY PRIMARY FILE                                  LE0650
0028 F*       52      PRTF LE0650P1 OPEN FOR OUTPUT                       S01117
0029 F*       55      CHAIN FAIL                                          LE0650
0030 F*       60      CURRENCY DECIMAL PLACES - 0                         LE0650
0031 F*       61                              - 1                         LE0650
0032 F*       62                              - 2                         LE0650
0033 F*       63                              - 3                         LE0650
     F*       66      CHAIN FAIL ON FILE CLOAN                            072582
0034 F*       71      SORT SEQ. = 1                                       LE0650
0035 F*       72                = 2                                       LE0650
0036 F*       73                = 3                                       LE0650
0037 F*       74                = 4                                       LE0650
     F*       80      READE ON HISTORY FILE                               134051
0038 F*             L1LEVEL BREAK - CUSTOMER                              LE0650
0039 F*             L2            - SORT SEQ.                             LE0650
0040 F*             L3            - LOAN TYPE/SUB TYPE                    LE0650
0041 F*             L4            - CURRENCY                              LE0650
0042 F*             L5            - BRANCH                                LE0650
0043 F*             U7DATABASE ERROR                                      LE0650
0044 F*             U8DATABASE ERROR/FILE CONTROLS OUT OF BALANCE         LE0650
0045 E                    XCYA      150  3               CURRENCIES       LE0650
0046 E                    XDPA      150  1 0             DEC. PLACES      LE0650
0047 E                    XNME      150 14               CURRENCY NAMES   LE0650
0048 E                    UDR1       30  1               SRUNDR SR.ARRAY  LE0650
0049 E                    UDR2   30  30  1               SRUNDR SR.ARRAY  LE0650
     E/COPY ZSRSRC,ZDATE2Z1                                               S01392
     E                    CPY@    1   1 80
     E                    ##BR      999  3               Branch Codes                         CSC042
     E                    ##BN      999 30               Branch Names                         CSC042
0053 L*    LINE COUNTER SPEC. INCLUDED TO ACCOMMODATE TOTAL TIME OUTPUT   LE0650
0054 L*E0650P1*66FL*58OL***                                        S01124 E81286
     L*E0650P1*66FL*56OL***                                        E81286 093584
0055 I*                                                                   LE0650
0056 I*    ACCOUNT KEYS FILE - DETAIL RECORD                              LE0650
0057 I*                                                                   LE0650
0058 IINACS   NS  01   1 CD                                               LE0650
0059 I                                        1   1 RECI                  LE0650
0060 I****************************************2  11 AKEY                               LE0650 CLE042
0061 I*****FOLLOWING*FIELDS*DEFINED*FOR*THIS*PROGRAM - LOAN TYPE/SUB TYPE              LE0650 CLE042
0062 I****************************************2   3 AKEY1 L3                           LE0650 CLE042
0063 I****************************************5   6 AKEY2 L3                           LE0650 CLE042
0064 I*                                                                   LE0650
0065 I**********                             12  170LNNO                               LE0650 CLE148
     I**********                             12  17 LNNO                               CLE148 CLE134
0066 I**********                             18  230CNUM  L1              LE0650              CSD027
0066 I**********                             18  23 CNUM  L1                    LE0650 CSD027 CLE134
0067 I***********                            24  260BRCD  L5              S01117
0067 I**********                             24  26 BRCA  L5                           S01117 CLE134
0068 I**********                             27  280ACSQ                               LE0650 CLE134
0069 I**********                          P  29  310EDAT        21                     LE0650 CLE134
0070 I**********                          P  32  380EAMT                               LE0650 CLE134
0071 I**********                             39  41 ECCY  L4                           LE0650 CLE134
0072 I**********                             42  430SETP                               LE0650 CLE134
0073 I**********                             44  45 OSAC                               LE0650 CGL029
     I**********                             44  45 OSACQQ                             CGL029 CLE134
0074 I**********                             56  560REVI                               LE0650 CLE134
0075 I**********                          P  57  630OTHA                               LE0650 CLE134
0076 I**********                             64  66 OTHC                               LE0650 CLE134
0077 I**********                          P  67  738EXRT                               LE0650 CLE134
0078 I**********                          P  74  760VDAT                               LE0650 CLE134
0079 I**********                          P  77  790SLID        22                     LE0650 CLE134
0080 I**********                          P  80  820MDAT                               LE0650 CLE134
0081 I**********                             83  840BRTT                               LE0650 CLE134
0082 I**********                          P  85  907BRTE                               LE0650 CLE134
0083 I**********                          P  91  967RTSP                               LE0650 CLE134
0084 I**********                          P  97 1027INTR                               LE0650 CLE134
0085 I**********                            103 1030SSEQ  L2                           LE0650 CLE134
0086 I**********                          P 104 1100CPAM                               LE0650 CLE134
0087 I**********                          P 111 1130PACD                               LE0650 CLE134
0088 I**********                            114 1140ICBS                               LE0650 CLE134
0087 I*******                             P 129 1310PELAP          E47260 125850
0088 I*******                             P 132 1340LORED          E47260 125850
     I**********                          P 138 1400PELAP                              125850 CLE134
     I**********                          P 141 1430LORED                              125850 CLE134
     I**************************************144 161 OSAC                               CGL029 CLE042
     I**********                            361 378 OSAC                               CLE042 CLE134
     I**********                            379 392 AKEY                               CLE042 CLE134
     I*****FOLLOWING*FIELDS*DEFINED*FOR*THIS*PROGRAM*-*LOAN*TYPE/SUB*TYPE              CLE042 CLE134
     I**********                            379 380 AKEY1 L3                           CLE042 CLE134
     I**********                            382 383 AKEY2 L3                           CLE042 CLE134
     I**********                            389 392 AKEY3 L3                           CLE042 CLE134
     I**********                            391 396 LNNO                            CLE134 AR1056323
     I**********                             16  21 CNUM  L1                        CLE134 AR1056323
     I**********                             22  24 BRCA  L5                        CLE134 AR1056323
     I**********                             25  260ACSQ                            CLE134 AR1056323
     I**********                          P  27  290EDAT        21                  CLE134 AR1056323
     I**********                          P  30  360EAMT                            CLE134 AR1056323
     I**********                             37  39 ECCY  L4                        CLE134 AR1056323
     I**********                             40  410SETP                            CLE134 AR1056323
     I**********                             42  53 OSACQQ                          CLE134 AR1056323
     I**********                             54  540REVI                            CLE134 AR1056323
     I**********                          P  55  610OTHA                            CLE134 AR1056323
     I**********                             62  64 OTHC                            CLE134 AR1056323
     I**********                          P  65  718EXRT                            CLE134 AR1056323
     I**********                          P  72  740VDAT                            CLE134 AR1056323
     I**********                          P  75  770SLID        22                  CLE134 AR1056323
     I**********                          P  78  800MDAT                            CLE134 AR1056323
     I**********                             81  820BRTT                            CLE134 AR1056323
     I**********                          P  83  887BRTE                            CLE134 AR1056323
     I**********                          P  89  947RTSP                            CLE134 AR1056323
     I**********                          P  95 1007INTR                            CLE134 AR1056323
     I**********                            101 1010SSEQ  L2                        CLE134 AR1056323
     I**********                          P 102 1080CPAM                            CLE134 AR1056323
     I**********                          P 109 1110PACD                            CLE134 AR1056323
     I**********                            112 1120ICBS                            CLE134 AR1056323
     I**********                          P 136 1380PELAP                           CLE134 AR1056323
     I**********                          P 139 1410LORED                           CLE134 AR1056323
     I**********                            359 376 OSAC                            CLE134 AR1056323
     I**********                            377 390 AKEY                            CLE134 AR1056323
      ***FOLLOWING*FIELDS*DEFINED*FOR*THIS*PROGRAM*-*LOAN*TYPE/SUB*TYPE             CLE134 AR1056323
     I**********                            377 378 AKEY1 L3                        CLE134 AR1056323
     I**********                            380 381 AKEY2 L3                        CLE134 AR1056323
     I**********                            387 390 AKEY3 L3                        CLE134 AR1056323
     I                                       12  17 LNNO                                   AR1056323
     I                                       18  23 CNUM  L1                               AR1056323
     I                                       24  26 BRCA  L5                               AR1056323
     I                                       27  280ACSQ                                   AR1056323
     I                                    P  29  310EDAT        21                         AR1056323
     I                                    P  32  380EAMT                                   AR1056323
     I                                       39  41 ECCY  L4                               AR1056323
     I                                       42  430SETP                                   AR1056323
     I                                       44  45 OSACQQ                                 AR1056323
     I                                       56  560REVI                                   AR1056323
     I                                    P  57  630OTHA                                   AR1056323
     I                                       64  66 OTHC                                   AR1056323
     I                                    P  67  738EXRT                                   AR1056323
     I                                    P  74  760VDAT                                   AR1056323
     I                                    P  77  790SLID        22                         AR1056323
     I                                    P  80  820MDAT                                   AR1056323
     I                                       83  840BRTT                                   AR1056323
     I                                    P  85  907BRTE                                   AR1056323
     I                                    P  91  967RTSP                                   AR1056323
     I                                    P  97 1027INTR                                   AR1056323
     I                                      103 1030SSEQ  L2                               AR1056323
     I                                    P 104 1100CPAM                                   AR1056323
     I                                    P 111 1130PACD                                   AR1056323
     I                                      114 1140ICBS                                   AR1056323
     I                                    P 138 1400PELAP                                  AR1056323
     I                                    P 141 1430LORED                                  AR1056323
     I                                      361 378 OSAC                                   AR1056323
     I                                      379 392 AKEY                                   AR1056323
     I** FOLLOWING FIELDS DEFINED FOR THIS PROGRAM - LOAN TYPE/SUB TYPE                    AR1056323
     I                                      379 380 AKEY1 L3                               AR1056323
     I                                      382 383 AKEY2 L3                               AR1056323
     I                                      389 392 AKEY3 L3                               AR1056323
0089 I*                                                                   LE0650
0090 I*    ACCOUNT KEYS FILE - TRAILER RECORD                             LE0650
0091 I*                                                                   LE0650
0092 I        NS  02   1 CT                                               LE0650
0093 I                                    P   2   40NORE                  LE0650
0094 I                                    P   5  120VLRF                  LE0650
0095 I                                    P  13  140VLRL                  LE0650
0096 I*                                                                   LE0650
0097 I*    CATCH ALL                                                      LE0650
0098 I*                                                                   LE0650
0099 I        NS                                                          LE0650
0100 I**************                                                      S01194
0101 I*****TABLE*FILE - INSTALLATION CONTROL DATA RECORD 1.               S01194
0102 I**************                                                      S01194
0103 I*TABLE***NS***    2 C0   3 C1  12 C1                                S01194
0104 I*******AND****  13 C0                                               S01194
0105 I**************                          1   1 RECI                  S01194
0106 I**************                          2   30RECT                  S01194
0107 I**************                         12  130RCDE                  S01194
0108 I**************                         14  66 TITL                  S01194
0109 I***********                            67  67 DATF                  S01194
0110 I***********                            68  700DFBR                  S01194
0111 I**************                         74  74 MODI1                 S01194
0112 I**************                         75  75 MODI2                 S01194
0113 I**************                         76  76 MODI3                 S01194
0114 I***********                         P  77  790RUND                  S01194
0115 I***********                            80  86 RUNA                  S01194
0116 I**************                         87  870SFLG                  S01194
0117 I**************                      P  90  920LCD                   S01194
0118 I**************                         93  93 CHTP                  S01194
0119 I**************                      P  94  960TNLU                  S01194
0120 I**************                                                      S01194
0121 I******TABLE*FILE - INSTALLATION CONTROL DATA RECORD 2.              S01194
0122 I**************                                                      S01194
0123 I********NS****   1 CD   2 C0   3 C1                                 S01194
0124 I*******AND****  12 C1  13 C1                                        S01194
0125 I**************                          1   1 RECI                  S01194
0126 I**************                          2   30RECT                  S01194
0127 I**************                         12  130RCDE                  S01194
0128 I**************                         14  16 BCCY                  S01194
0129 I**************                         17  19 BCYL                  S01194
0130 I**************                         20  22 HOCY                  S01194
0131 I**************                         23  280HEAD                  S01194
0132 I**************                      P  29  310APDA                  S01194
0133 I**************                         35  35 APFQ                  S01194
0134 I**************                      P  36  380LOGS                  S01194
0135 I**************                         39  40 CUZR                  S01194
0136 I**************                      P  41  430DNWD                  S01194
0137 I**************                         44  460BVLP                  S01194
0138 I**************                         47  49 LOCY                  S01194
0139 I**************                         50  510FDAY                  S01194
0140 I**************                         52  52 ACLD                  S01194
0141 I***********                            53  53 MBIN                  S01194
0142 I**************                         86  86 ISAV                  S01194
0143 I**************                      P  87  890LLOG                  S01194
0144 I**************                      P  90  920LCD                   S01194
0145 I**************                         93  93 CHTP                  S01194
0146 I**************                      P  94  960TNLU                  S01194
0147 I**************                                                      S01194
0148 I*****LOAN*TYPE / SUB TYPE                                           S01194
0149 I**************                                                      S01194
0150 I********NS**07   1 CD   2 C4   3 C3                                 S01194
0151 I**************                          1   1 RECI                  S01194
0152 I**************                          2   30RECT                  S01194
0153 I**************                         10  11 LTYP                  S01194
0154 I**************                         12  13 SUTP                  S01194
0155 I**************                         14  43 NARR                  S01194
0156 I**************                         44  450PTYP                  S01194
0157 I**************                      P  90  920LCD                   S01194
0158 I**************                         93  93 CHTP                  S01194
0159 I**************                      P  94  960TNLU                  S01194
0160 I**************                                                      S01194
0161 I*****CATCH*ALL                                                      S01194
0162 I**************                                                      S01194
0163 I********NS****                                                      S01194
0164 I**************                                                      S01194
0165 I*****TABLE*FILE - CURRENCIES RECORD 1.                              S01194
0166 I**************                                                      S01194
0167 I*TABLED**NS***    2 C2   3 C0                                       S01194
0168 I**************                          1   1 RECI                  S01194
0169 I**************                          2   30RECT                  S01194
0170 I**************                         10  12 CCY                   S01194
0171 I**************                         13  130SREC                  S01194
0172 I**************                         14  27 CCNM                  S01194
0173 I**************                      P  28  348SPOT                  S01194
0174 I**************                         35  37 CCYS                  S01194
0175 I**************                         38  380CDP                   S01194
0176 I**************                         39  390TNOT                  S01194
0177 I**************                         40  40 DCCY                  S01194
0178 I**************                         41  44 SRC1                  S01194
0179 I**************                         45  48 SRC2                  S01194
0180 I**************                         49  520TACC                  S01194
0181 I**************                         53  560TEQV                  S01194
0182 I**************                         57  600SWQV                  S01194
0183 I**************                         61  640TAC4                  S01194
0184 I**************                         65  680TAC5                  S01194
0185 I**************                         69  69 HIND                  S01194
0186 I**************                      P  70  768PART                  S01194
0187 I**************                         77  780SSNO                  S01194
0188 I**************                      P  79  858ERLC                  S01194
0189 I**************                         86  860MDIN                  S01194
0190 I**************                         87  870MDIA                  S01194
0191 I**************                         88  880MDIB                  S01194
0192 I**************                      P  90  920LCD                   S01194
0193 I**************                         93  93 CHTP                  S01194
0194 I**************                      P  94  960TNLU                  S01194
0195 I**************                                                      S01194
0196 I*****CATCH*ALL                                                      S01194
0197 I**************                                                      S01194
0198 I********NS****                                                      S01194
0199 I**************                          2   30RECT                  S01194
0200 I********                                                     E11590 E16863
0201 I*****LENDING MASTER FILE                                     E11590 E16863
0202 I********                                                     E11590 E16863
0203 I*LOAN***NS  08   1 CD   8 CA                                 E11590 E16863
0204 I********                            P  50  560PAMT           E11590 E16863
0235 I********                                                     E11590 E16863
0236 I*****CATCH ALL                                               E11590 E16863
0237 I********                                                     E11590 E16863
0238 I********NS                                                   E11590 E16863
0204 I********                            P  50  560PAMT           E11590 E16863
0200 I**************                                                      S01194
0201 I*****CLIENT*FILE - CUSTOMER STANDING DATA RECORD.                   S01194
0202 I**************                                                      S01194
0203 I*CLINT***NS**10   1 CD   8 CA                                       S01194
0204 I**************                          1   1 RECI                  S01194
0205 I**************                          2   70CNUM                  S01194
0206 I**************                          8   8 RCDT                  S01194
0207 I**************                          9  28 CRNM                  S01194
0208 I**************                         29  38 CTWN                  S01194
0209 I**************                         39  48 CSNM                  S01194
0210 I**************                         49  56 CASK                  S01194
0211 I**************                         57  68 TELX                  S01194
0212 I**************                         69  80 CSID                  S01194
0213 I**************                         81  82 ACOC                  S01194
0214 I**************                         83  83 CBSI                  S01194
0215 I**************                         84  85 CCTZ                  S01194
0216 I**************                         86  87 CLOC                  S01194
0217 I**************                         88  930CPAR                  S01194
0218 I**************                                                      S01194
0219 I*****FOLLOWING FIELD RENAMED TO AVOID CONFUSION WITH S/INACS        S01194
0220 I***********                            94  960BRCDCL                S01194
0221 I**************                                                      S01194
0222 I**************                         97  980LINS                  S01194
0223 I**************                         99 1010LIND                  S01194
0224 I**************                      P 102 1040DASU                  S01194
0225 I**************                      P 105 1070CDIC                  S01194
0226 I**************                      P 108 1100DADE                  S01194
0227 I**************                        111 111 CMIN                  S01194
0228 I**************                        112 112 CTYP                  S01194
0229 I**************                        113 124 TELF                  S01194
0230 I**************                        125 133 CHID                  S01194
0231 I**************                        134 136 CHAB                  S01194
0232 I**************                      P 250 2520LCD                   S01194
0233 I**************                        253 253 CHTP                  S01194
0234 I**************                      P 254 2560TNLU                  S01194
0235 I**************                                                      S01194
0236 I*****CATCH*ALL                                                      S01194
0237 I**************                                                      S01194
0238 I********NS****                                                      S01194
0239 I**************                                                      S01194
0240 I*****DATA*STRUCTURE FOR KEY TO S/TABLE - CURRENCIES                 S01194
0241 I**************                                                      S01194
0242 I************DS                                                      S01194
0243 I**************                          1  12 CCYKEY                S01194
0244 I**************                          9  11 XCCY                  S01194
0245 I**************                                                      S01194
0246 I*****DATA*STRUCTURE FOR KEY TO S/TABLE - LOAN TYPE/SUB TYPE         S01194
0247 I**************                                                      S01194
0248 I************DS                                                      S01194
0249 I**************                          1  12 LSTKEY                S01194
0250 I**************                          9  10 AKEY1                 S01194
0251 I**************                         11  12 AKEY2                 S01194
0252 I**************                                                      S01194
0253 I*****DATA*STRUCTURE FOR KEY TO S/CLINT                              S01194
0254 I**************                                                      S01194
0255 I************DS                                                      S01194
0256 I**************                          1   7 CUSKEY                S01194
0257 I**************                          1   60CNUM                  S01194
     I*                                                                   134051
     ICLOANCLF                                                            134051
     I              RCDT                            RCDTA                 134051
     I              BRCA                            BRCAA                 134051
     I              CNUM                            CNUMA                 134051
     I              LNRF                            LNRFA                 134051
     I              VDAT                            VDATA                 134051
     I              INTR                            INTRA                 134051
     I              OLNO                            OLNOA                                     201123
     I              SLID                            SLIDA                 134051
     ICLOANCKF                                                            134051
     I              NLRA                            NLRAK                 134051
     I*                                                                   134051
     IHISTSHPF                                                            134051
     I              RCDT                            RCDTB                 134051
     I              BRCA                            BRCAB                 134051
     I              CNUM                            CNUMB                 134051
     I              LNRF                            LNRFB                 134051
     I              VDAT                            VDATB                 134051
     I              INTR                            INTRB                 163100
     I              CPAM                            CPAMB                 163100
     I*                                                                   S01194
     ISDCURRD0                                                            S01194
      **   CURRENCY DETAILS                                               S01194
     I              A6CYCD                          CCY                   S01194
     I              A6NBDP                          CDP                   S01194
     I              A6CYNM                          CCNM                  S01194
     I*                                                                   S01194
     ISDBANK    E DSSDBANKPD                                              S01194
     I**  EXTERNAL DS FOR BANK DETAILS                                    S01194
     I              BJURPT                          TITL                  S01194
     I*                                                                   S01194
     ISDBRCH    E DSSDBRCHPD                                              S01117
     I**  EXTERNAL DS FOR BRANCH CODE DETAILS                             S01117
     I              A8BRNM                          BRNM                  S01117
     I*                                                                   S01194
     ISDCUST    E DSSDCUSTPD                                              S01194
     I**  EXTERNAL DS FOR CUSTOMER DETAILS                                S01194
     I              BBCRNM                          CRNM                  S01194
     I              QQDFAC                          QQDFA1                                    CGL029
     I*                                                                   S01194
     ISDGELR    E DSSDGELRPD                                              S01194
     I**  EXTERNAL DS FOR GENERAL LEDGER                                  S01194
     I              BKAPFQ                          APFQ                  S01194
     I*                                                                   S01194
     ISDLOAN    E DSSDLOANPD                                              S01194
     I**  EXTERNAL DS FOR LOAN TYPE/SUB TYPE                              S01194
     I              AYLNTD                          NARR                  S01194
     I*
     IDSFDY     E DSDSFDY                                                 S01194
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01194
     I*                                                                   S01194
     IDSSDY     E DSDSSDY                                                 S01194
     I* SECOND DS FOR ACCESS PROGRAMS, LONG DATA STRUCTURE                S01194
     I*                                                                   S01194
0258 I*                                                                   LE0650
0259 I*    LDA - DIAGNOSTICS FOR PROGRAM ABORT                            LE0650
0260 I*                                                                   LE0650
0261 ILDA        UDS                            256                       LE0650
0211 I***********                           134 138 DBFILE                S01117
0212 I***********                           139 167 DBKEY                 S01117
0213 I***********                           168 175 DBPGM                 S01117
0214 I***********                           176 177 DBASE                 S01117
0211 I                                      134 141 DBFILE                S01117
0212 I                                      142 170 DBKEY                 S01117
0213 I                                      171 180 DBPGM                 S01117
0214 I                                      181 1830DBASE                 S01117
     I**                                                                  S01117
     I**   FILE INFORMATION DATA STRUCTURE                                S01117
     I**                                                                  S01117
     ISPOOL       DS                                                      S01117
     I                                       83  92 SFILE                 S01117
     I                                    B 123 1240SFNUM                 S01117
     I**                                                                  S01117
     I**   FILE INFORMATION DATA STRUCTURE                                S01117
     I**                                                                  S01117
     ISPOOLU      DS                                                      S01117
     I                                       83  92 SFILEU                S01117
     I                                    B 123 1240SFNUMU                S01117
0925 I**                                                                  S01117
     IRUNDT       DS                                                      S01117
      **  DATA AREA RUNDAT                                                S01117
     I                                        1   7 RUNA                  S01117
     I                                    P   8  100RUND                  S01117
     I                                       11  11 SSF                   S01117
     I                                       12  12 DATF                  S01117
     I                                       13  13 MBIN                  S01117
     I**                                                                  S01117
     C**********           MOVEACPY@      BIS@   80                                           CSC042
0266 C********************************************************************LE0650
     C**                                                                  S01117
     C           *ENTRY    PLIST                                          S01117
     C                     PARM           SEQ     5         SEQUENCE      S01117
     C                     PARM           BRNCH   3         BRANCH OR ALL S01117
0267 C**   FIRST CYCLE PROCESSING                                         LE0650
0268 C**                                                                  LE0650
0269 C   40                GOTO DETAIL                                    LE0650
0270 C                     SETON                     42                   LE0650
     C                     MOVEACPY@      BIS@   80                                           CSC042
     C                     Z-ADD0         ##BNDX  40                                          CSC042
     C           *LIKE     DEFN ##BNDX    B                                                   CSC042
     C           *LIKE     DEFN ##BNDX    ##BSV                                               CSC042
      *                                                                                       CSC042
0223 C*                                                                   LE0930
      **                                                                  S01117
      **   IN THE DATAAREA RUNDAT                                         S01117
      **                                                                  S01117
     C           *NAMVAR   DEFN RUNDAT    RUNDT                           S01117
     C                     IN   RUNDT                                     S01117
     C*    DEFINE LDA                                                     S01117
     C           *NAMVAR   DEFN           LDA                             S01117
     C           *LOCK     IN   LDA                                       S01117
     C**                                                                  S01117
     C*     IF MBIN=Y, SET ON *IN33                                       S01117
     C**                                                                  S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C                     SETON                     33                   S01117
     C*                                                                   S01117
     C**    IF MBIN=Y AND REQUEST ONLY ONE BRANCH,                        S01117
     C**    SUPPRESS CONTROL TOTAL                                        S01117
     C*                                                                   S01117
     C           BRNCH     IFNE 'ALL'                                     S01117
     C                     SETON                     35                   S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C**********           Z-ADD0         @PRLN   60                                   072582 CLE148
     C                     MOVEL*BLANK    @PRLN   6                                           CLE148
     C           LNKEY     KLIST                                          072582
     C**********           KFLD           LNRF    60                                   072582 CLE148
     C                     KFLD           LNRF    6                                           CLE148
     C                     KFLD           RCDT    1                       072582
     C                     MOVE 'A'       RCDT                            072582
     C*                                                                   134051
     C           LNKEY1    KLIST                                          134051
     C                     KFLD           BRCA    3                       134051
     C**********           KFLD           CNUM    60                                   134051 CSD027
     C                     KFLD           CNUM    6                                           CSD027
     C**********           KFLD           LNRF    60                                   072582 CLE148
     C                     KFLD           LNRF    6                                           CLE148
     C                     KFLD           EDAT    50                      134051
0224 C*                                                                   LE0930
0225 C**    FOR DATA BASE ERROR REFERENCE                                 LE0930
0226 C*                                                                   LE0930
0271 C                     MOVE 'LE0650'  DBPGM                           LE0650
0272 C**                                                                  LE0650
0273 C                     EXSR ZSYSTM                                    LE0650
0274 C***99*********       SETON                     U7U8  **DATABASE 01**S01194
0275 C***99*********       Z-ADD1         DBASE                           S01194
0276 C***99*********       MOVE ZTABKY    DBKEY                           S01194
0277 C***99*********       MOVE 'TABLE'   DBFILE                          S01194
0278 C   99                GOTO END                                       LE0650
0279 C**                                                                  LE0650
0280 C**       FIND IF ACCRUAL FREQUENCY IS DAILY OR MONTHLY              LE0650
0281 C**************       MOVEL'01      'ZTABKY                          S01194
0282 C**************       MOVE '  11'    ZTABKY                          S01194
0283 C***********ZTABKY    CHAINTABLE                99                   S01194
     C**                                                                  S01194
     C** ACCESS GENERAL LEDGER DETAILS                                    S01194
     C**                                                                  S01194
     C**********           CALL 'AOGELRR0'                                S01194              CGL029
     C                     CALL 'AOGELRR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C********** SDGELR    PARM SDGELR    DSFDY                           S01194              CGL029
     C           SDGELR    PARM SDGELR    DSSDY                                               CGL029
0284 C**N99******RECI      COMP 'D'                  9999                 S01194
     C           @RTCD     IFNE *BLANKS                                   S01194
     C                     SETON                     99                   S01194
     C                     MOVEL'SDGELRPD'DBFILE                          S01194
     C                     END                                            S01194
0285 C   99                SETON                     U7U8  **DATABASE 05**LE0650
0286 C   99                Z-ADD5         DBASE                           LE0650
0287 C***99*********       MOVE ZTABKY    DBKEY                           S01194
0288 C***99*********       MOVE 'TABLE'   DBFILE                          S01194
0289 C   99                GOTO END                                       LE0650
0290 C           APFQ      COMP 'D'                      30               LE0650
0291 C**************                                                      S01194
0292 C*****DEFINE*KEY FIELDS                                              S01194
0293 C**************       MOVEL'20'      CCYKEY                          S01194
0294 C**************       MOVE '1'       CCYKEY                          S01194
0295 C**************                                                      S01194
0296 C**************       MOVEL'43'      LSTKEY                          S01194
0297 C**************                                                      S01194
0298 C**************       MOVE 'A'       CUSKEY                          S01194
0299 C**                                                                  LE0650
0300 C**   LOAD CURRENCY ARRAYS                                           LE0650
0301 C                     EXSR CCYARR                                    LE0650
0302 C**                                                                  LE0650
0303 C**   COMMENCE RECORD COUNT                                          LE0650
0304 C                     Z-ADD2         NREC    50                      LE0650
     C**                                                                  S01117
0305 C                     SETON                     40                   LE0650
0306 C**********************************                                  LE0650
0307 C           DETAIL    TAG                             **DETAIL TAG** LE0650
0308 C   02                SETON                     LR                   LE0650
0309 C  N01                GOTO END                                       LE0650
0310 C***********          SETOF                     42                   S01117
     C**                                                                  S01117
     C**   MULTIBRANCH MAIN PROCESSING                                    S01117
     C*                                                                   S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C**      IF BRCA IS LESS THAN THE REQUIRED BRANCH,                   S01117
     C**      SKIP THE CALCULATION                                        S01117
     C*                                                                   S01117
     C           BRNCH     IFGT BRCA                                      S01117
     C           BRNCH     ANDNE'ALL'                                     S01117
     C                     SETOF                     52                   S01117
     C                     GOTO END                                       S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C           *INL5     IFEQ '1'                                       S01117
     C                     CLOSELE0650P1                                  S01117
     C*                                                                   S01117
     C**      IF BRCA IS GREATER THAN THE REQUIRED BRANCH,                S01117
     C**      END THE PROGRAM                                             S01117
     C*                                                                   S01117
     C           BRNCH     IFLT BRCA                                      S01117
     C           BRNCH     ANDNE'ALL'                                     S01117
     C                     SETON                     LR                   S01117
     C                     SETOF                     52                   S01117
     C                     GOTO ENDLR                                     S01117
     C                     END                                            S01117
     C**                                                                  S01117
     C*       IF MBIN=YES, AND A REQUIRED BRANCH AND A LEVEL BREAK,       S01117
     C*       OPEN LE0650P1                                               S01117
     C**                                                                  S01117
     C           BRNCH     IFEQ 'ALL'                                     S01117
     C           BRNCH     OREQ BRCA                                      S01117
     C                     SETON                     52                   S01117
0310 C                     SETOF                     42                   S01117
     C                     MOVE 'Y'       P1OP    1                       S01117
     C                     OPEN LE0650P1                                  S01117
     C                     Z-ADD0         PAGE                            S01117
     C                     Z-ADD0         PAGE1                           S01117
     C**                                                                  S01117
     C*       ENSURE REPORT SPOOL FILE RECORDED BY RCF                    S01117
     C**                                                                  S01117
     C                     Z-ADDSFNUM     ZSNUM   60                      S01117
     C**                                                                  S01117
     C                     OUT  LDA                                       S01117
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           SEQ                             S01117
     C                     PARM BRCA      SENTY   3                       S01117
     C                     PARM           SFILE                           S01117
     C                     PARM           ZSNUM                           S01117
     C                     PARM           ZSERR   1                       S01117
     C**                                                                  S01117
     C           *LOCK     IN   LDA                                       S01117
     C           ZSERR     IFEQ 'Y'                                       S01117
      **  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM       S01117
     C                     SETON                     U7U8                 S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C*  To get Branch Name(in BRNM) :                                    S01117
     C**                                                                  S01117
     C                     MOVELBRCA      ##KB                                                CSC042
     C                     EXSR ##CHKB                                                        CSC042
      * If branch is in the array then use the details                                        CSC042
     C           ##FIC     IFEQ 'Y'                        *** B10                            CSC042
     C                     EXSR ##SETB                                                        CSC042
     C                     ELSE                            *** X10                            CSC042
     C**********           CALL 'AOBRCHR0'                                S01117              CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       S01117
     C                     PARM '*KEY   ' @OPTN   7                       S01117
     C                     PARM BRCA      @DSNB   3                       S01117
     C********** SDBRCH    PARM SDBRCH    DSFDY                           S01117              CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANKS                                   S01117
     C                     MOVEL@DSNB     DBKEY                           S01117
     C                     MOVEL'SDBRCHPD'DBFILE           ************   S01117
     C                     Z-ADD5         DBASE            * DBASE 05 *   S01117
     C                     SETON                     U7U8LR************   S01117
     C   U8                GOTO END                                       S01117
     C                     ELSE                                                               CSC042
      * Details found on the DB so add them to the array                                      CSC042
      * if the array still has room                                                           CSC042
     C                     EXSR ##ADDB                                                        CSC042
     C                     END                                            S01117
     C                     ENDIF                           *** E10                            CSC042
     C**                                                                  S01117
     C                     ELSE                                           S01117
     C                     SETOF                     52                   S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C**                                                                  S01117
     C                     ELSE                                           S01117
     C**                                                                  S01117
     C*       IF MBIN='N' AND FIRST CYCLE,                                S01117
     C*       OPEN LE0650P1                                               S01117
     C**                                                                  S01117
     C           P1OP      IFNE 'Y'                                       S01117
     C                     SETON                     52    ALLOW OUTPUT   S01117
0310 C                     SETOF                     42                   S01117
     C                     MOVE 'Y'       P1OP    1                       S01117
     C                     OPEN LE0650P1                                  S01117
     C                     Z-ADD0         PAGE                            S01117
     C                     Z-ADD0         PAGE1                           S01117
     C**                                                                  S01117
     C*       ENSURE REPORT SPOOL FILE RECORDED BY RCF                    S01117
     C**                                                                  S01117
     C**                                                                  S01117
     C                     Z-ADDSFNUM     ZSNUM   60                      S01117
     C                     OUT  LDA                                       S01117
     C**                                                                  S01117
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           SEQ                             S01117
     C                     PARM BRCA      SENTY   3                       S01117
     C                     PARM           SFILE                           S01117
     C                     PARM           ZSNUM                           S01117
     C                     PARM           ZSERR   1                       S01117
     C**                                                                  S01117
     C           *LOCK     IN   LDA                                       S01117
     C           ZSERR     IFEQ 'Y'                                       S01117
      **  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM       S01117
     C                     SETON                     U7U8                 S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C**                                                                  S01117
     C                     END                                            S01117
     C                     END                                            S01117
0312 C**   IF LOAN ENTRY DATE > LAST ACCRUAL PROFIT DATE - SET ON *IN50   E47260
0313 C           LORED     COMP PELAP                50                   E47260
0311 C**                                                                  LE0650
0312 C**   AT CHANGE OF CURRENCY,ZEROIZE CURRENCY TOTALS                  LE0650
0313 C   L4                Z-ADD0         REVTOT 130                      LE0650
0314 C   L4                Z-ADD0         ACCTOT 130                      LE0650
0315 C   L4                Z-ADD0         MANTOT 130                      LE0650
0316 C   L4                Z-ADD0         GENTOT 130                      LE0650
0317 C**                                                                  LE0650
0318 C**   DETERMINE CURRENCY DETAILS                                     LE0650
0319 C   L4                MOVE ECCY      XCCY                            LE0650
0320 C   L4                EXSR CCYDEP                                    LE0650
0321 C   L4 99             SETON                     U7U8  **DATABASE 02**LE0650
0322 C   L4 99             Z-ADD2         DBASE                           LE0650
0323 C***L4*99******       MOVE CCYKEY    DBKEY                           S01194
0324 C***L4*99******       MOVE 'TABLE'   DBFILE                          S01194
0324 C   L4 99             MOVE 'SDCURRPD'DBFILE                          S01194
0323 C   L4 99             MOVE XCCY      DBKEY                           S01194
0325 C   L4 99             GOTO END                                       LE0650
0326 C**                                                                  LE0650
0327 C   L4      XDECP     COMP 1                      6061               LE0650
0328 C   L4      XDECP     COMP 2                    63  62               LE0650
0329 C**                                                                  LE0650
0330 C   L4                MOVE XNAME     CCYNME 14                       LE0650
0331 C**                                                                  LE0650
0332 C*****ACCESS*S/TABLE*-*LOAN*TYPE/SUB*TYPE*RECORD**********           S01194
0332 C**   ACCESS SDLOANPD - LOAN TYPE/SUB TYPE RECORD                    S01194
0333 C***L3******LSTKEY    CHAINTABLE                55                   S01194
     C   L3                CALL 'AOLOANR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C                     PARM AKEY1     ATCD    2                       S01194
     C                     PARM AKEY2     AUCD    2                       S01194
     C                     PARM AKEY3     AUCL    4                                           CLE042
     C           SDLOAN    PARM SDLOAN    DSFDY                           S01194
     C   L3      @RTCD     IFNE *BLANKS                                   S01194
     C                     SETON                       99                 S01194
     C                     SETON                     U7U8LR               S01194
     C                     MOVE 'SDLOANPD'DBFILE           ***************S01194
     C                     Z-ADD3         DBASE            * DBERROR 03  *S01194
     C           AKEY1     CAT  AKEY2:1   DBKEY            ***************                    CLE042
     C                     CAT  AKEY3:1   DBKEY                                               CLE042
     C*********************MOVELAKEY1     DBKEY            ***************             S01194 CLE042
     C*********************MOVE AKEY2     DBKEY                                        S01194 CLE042
     C                     GOTO END                                       S01194
     C                     END                                            S01194
0334 C***L3N07******       SETON                     U7U8  **DATABASE 03**S01194
0335 C***L3N07******       Z-ADD3         DBASE                           S01194
0336 C***L3N07******       MOVE LSTKEY    DBKEY                           S01194
0337 C***L3N07******       MOVE 'TABLE'   DBFILE                          S01194
0338 C***L3N07******       GOTO END                                       S01194
0339 C**                                                                  LE0650
0340 C**   DETERMINE UNDERLINING FOR LOAN TYPE/SUB TYPE NARRARIVE         LE0650
0341 C   L3                MOVE NARR      UNDRIN                          LE0650
0342 C   L3                EXSR SRUNDR                                    LE0650
0343 C   L3                MOVE UDROUT    UNDLIN 30                       LE0650
0344 C**                                                                  LE0650
0345 C**   AT CHANGE OF SORT SEQUENCE,ZEROIZE SEQ. TOTALS                 LE0650
0346 C   L2                Z-ADD0         SEQTOT 130                      LE0650
0347 C**                                                                  LE0650
0348 C**   DETERMINE SORT-SEQUENCE CODE                                   LE0650
0349 C   L2      SSEQ      COMP 2                      7172               LE0650
0350 C   L2      SSEQ      COMP 3                    74  73               LE0650
0351 C**                                                                  LE0650
0352 C*****ACCESS*S/CLINT                                                 S01194
0352 C**   ACCESS SDCUSTPD                                                S01194
0353 C***L1******CUSKEY    CHAINCLINT                55                   S01194
     C           *INL1     IFEQ '1'                                       S01194
     C                     MOVELCNUM      CUSKEY 10                       S01194
     C                     CALL 'AOCUSTR0'                                S01194
     C                     PARM '*MSG   ' @RTCD                           S01194
     C                     PARM '*KEY   ' @OPTN                           S01194
     C                     PARM           CUSKEY                          S01194
     C                     PARM *BLANKS   KEYSTS  7                       S01194
     C           SDCUST    PARM SDCUST    DSSDY                           S01194
     C           @RTCD     IFNE *BLANKS                                   S01194
     C                     MOVEL'SDCUSTPD'DBFILE                          S01194
     C                     MOVE CUSKEY    DBKEY            ***************S01194
     C                     Z-ADD4         DBASE            * DBERROR  04 *S01194
     C                     SETON                     U7U8  ***************S01194
     C                     GOTO END                                       S01194
     C                     END                                            S01194
     C                     END                                            S01194
0354 C***L1N10******       SETON                     U7U8  **DATABASE 04**S01194
0355 C***L1N10******       Z-ADD4         DBASE                           S01194
0356 C***L1N10******       MOVE CUSKEY    DBKEY                           S01194
0357 C***L1N10******       MOVE 'CLINT'   DBFILE                          S01194
0358 C***L1N10******       GOTO END                                       S01194
0359 C**                                                                  LE0650
0360 C**   FOR ALL BUT REVERSAL KEYS, REFORMAT DATES                      LE0650
0361 C***22N71***          Z-ADDSLID      ZDAYNO                          E47260
0362 C   22N71N50PELAP     COMP SLID                 51                   E47260
0363 C   22N71                                                            E47260
0364 CANN50 51             Z-ADDPELAP     ZDAYNO                          E47260
0365 C   22N71                                                            E47260
0366 CANN50N51             Z-ADDSLID      ZDAYNO                          E47260
0367 C   50                Z-ADDSLID      ZDAYNO                          E47260
     C                     MOVEL*BLANKS   OLNOZ                                               201123
     C           *IN22     IFEQ '1'                                       072582
     C           *IN71     ANDEQ'0'                                       072582
     C**********           Z-ADDLNNO      LNRF                                         072582 CLE148
     C                     MOVELLNNO      LNRF                                                CLE148
     C           LNKEY     CHAINCLOANCLF             66                   072582
     C           *IN66     IFEQ '0'                                       072582
     C                     Z-ADDORED      @ORED   50                      072582
      *                                                                                       201123
     C           PTYP      IFEQ 64                                                            201123
     C           PTYP      OREQ 65                                                            201123
     C           PTYP      OREQ 68                                                            201123
     C           PTYP      OREQ 71                                                            201123
     C                     MOVELOLNOA     OLNOZ   6                                           201123
     C                     ENDIF                                                              201123
      *                                                                                       201123
     C           @ORED     IFEQ RUND                                      072582
     C           @PRLN     ANDNELNNO                                      072582
     C                     Z-ADDVDAT      ZDAYNO                          072582
     C**********           Z-ADDLNNO      @PRLN                                        072582 CLE148
     C                     MOVELLNNO      @PRLN                                               CLE148
     C                     END                                            072582
     C                     ELSE                                           072582
     C                     SETON                     U7U8  *************  072582
     C                     MOVE LNRF      DBKEY            * DBERR 007 *  072582
     C                     MOVE 'CLOANCL' DBFILE           *************  072582
     C                     Z-ADD7         DBASE                           072582
     C                     GOTO END                                       072582
     C                     END                                            072582
     C                     END                                            072582
0362 C   22N71             EXSR ZDATE2                                    LE0650
0363 C   22N71             MOVE ZADATE    FRMDAT  7                       LE0650
0364 C**                                                                  LE0650
0365 C   21N71             Z-ADDEDAT      ZDAYNO                          LE0650
     C           *IN21     IFEQ '1'                                       134051
     C           *IN71     ANDEQ'0'                                       134051
     C           LNKEY1    SETLLHISTSHPF                                  134051
     C           LNKEY1    READEHISTSHPF                 80               134051
     C           *IN80     DOWEQ'0'                                       134051
     C           AMTP      IFEQ 'IN'                                      134051
     C           AMTP      OREQ 'MR'                                      134051
     C           INTA      ANDNE0                                         134051
     C           AMTP      OREQ 'RE'                                      134051
     C           INTA      ANDNE0                                         134051
     C           SLID      IFNE VDATB                                     134051
     C                     SUB  1         ZDAYNO                          134051
     C                     LEAVE                                          134051
     C                     ENDIF                                          134051
     C                     ENDIF                                          134051
     C           LNKEY1    READEHISTSHPF                 80               134051
     C                     ENDDO                                          134051
     C                     ENDIF                                          134051
0366 C   21N71             EXSR ZDATE2                                    LE0650
0367 C   21N71             MOVE ZADATE    TODAT   7                       LE0650
     C***********                                                  E11590 E16863
     C*****OBTAIN THE PRINCIPLE AMOUNT FROM THE LOAN DETAILS       E11590 E16863
     C*****THIS PROCESSING IS BECAUSE A REPAYMENT MADE BY FREQUENCYE11590 E16863
     C*****DOES NOT UPDATE THE PRINCIPLE AMOUNT ON THE INT. ACCRUALE11590 E16863
     C********KEY RECORD.                                          E11590 E16863
     C********                                                     E11590 E16863
     C***********          MOVE 'A'       LNKEY   7                E11590 E16863
     C***********          MOVELLNNO      LNKEY                    E11590 E16863
     C***********          SETOF                     55            E11590 E16863
     C***********                                                  E11590 E16863
     C***********LNKEY     CHAINCLOAN                55            E11590 E16863
     C************IN55     IFEQ '1'                                E11590 E16863
     C***********          SETON                     U7U8          E11592 E16863
     C***********          Z-ADD5         DBASE        **DBASE 5** E11590 E16380
     C***********          Z-ADD6         DBASE        **DBASE 6** E16380 E16863
     C***********          MOVE LNNO      DBKEY                    E11590 E16461
     C***********          MOVE LNKEY     DBKEY                    E16461 E16863
     C***********          MOVE 'CLOAN'   DBFILE                   E11590 E16863
     C***********          END                                     E11590 E16863
     C***********                                                  E11590 E16863
     C***********          Z-ADDPAMT      CPAM                     E11590 E16863
0368 C**                                                                  LE0650
0369 C**   TRUNCATE INTEREST RATE                                         LE0650
0370 C                     MOVE INTR      INTRAT 107                      LE0650
0371 C**                                                                  LE0650
0372 C**   MAINTAIN SEQUENCE TOTALS                                       LE0650
0373 C           EAMT      ADD  SEQTOT    SEQTOT                          LE0650
0374 C**                                                                  LE0650
0375 C**   MAINTAIN RECORD COUNT & HASH TOTALS                            LE0650
0376 C           NREC      ADD  1         NREC                            LE0650
0377 C                     Z-ADDNRECF     ZZTOTI                          LE0650
0378 C                     Z-ADDNRECL     ZZTOTD                          LE0650
0379 C**                                                                  LE0650
0380 C**   IF AMOUNT IS NEGATIVE,REVERSE SIGN                             LE0650
0381 C           EAMT      DIV  1000      ZZAMT        41                 LE0650
0382 C   41                Z-SUBZZAMT     ZZAMT                           LE0650
0383 C                     EXSR GLZADD                                    LE0650
0384 C                     Z-ADDZZTOTI    NRECF  150                      LE0650
0385 C                     Z-ADDZZTOTD    NRECL   30                      LE0650
0386 C**                                                                  LE0650
0387 C           END       TAG                             **END TAG**    LE0650
0388 C   U7                SETON                     LR                   LE0650
0389 C**                                                                  LE0650
0390 C**   TOTAL TIME CALCULATIONS                                        LE0650
0391 CL2 71      REVTOT    ADD  SEQTOT    REVTOT                          LE0650
0392 CL2 72      ACCTOT    ADD  SEQTOT    ACCTOT                          LE0650
0393 CL2 73      MANTOT    ADD  SEQTOT    MANTOT                          LE0650
0394 CL2 74      GENTOT    ADD  SEQTOT    GENTOT                          LE0650
0395 C**                                                                  LE0650
0396 C**   LAST RECORD PROCESSING                                         LE0650
     C**                                                                  S01117
     C*       IF MBIN='Y' AND BRNCH=A PARTICULAR BRANCH NAME              S01117
     C*       NO CHECKING ON THE CONTROL TOTAL                            S01117
     C**                                                                  S01117
     CLR         MBIN      IFEQ 'N'                                       S01117
     CLR         MBIN      OREQ 'Y'                                       S01117
     CLR         BRNCH     ANDEQ'ALL'                                     S01117
0397 CLRNU8      NREC      COMP NORE                 U8U8                 LE0650
0398 CLRNU8      NRECF     COMP VLRF                 U8U8                 LE0650
0399 CLRNU8      NRECL     COMP VLRL                 U8U8                 LE0650
     CLR                   END                                            S01117
     C**                                                                  S01117
0429 C**                                                                  LE0734
     C**   ENSURE TOTALS SPOOL FILE RECORDED BY RCF                       S01117
     C**                                                                  S01117
     CLR                   Z-ADDSFNUMU    ZSNUMU  60                      S01117
     CLR                   OUT  LDA                                       S01117
     C**                                                                  S01117
     CLR                   CALL 'ZSFILE'                                  S01117
     CLR                   PARM           SEQ     5                       S01117
     CLR                   PARM *BLANKS   SENTY   3                       S01117
     CLR                   PARM           SFILEU                          S01117
     CLR                   PARM           ZSNUMU                          S01117
     CLR                   PARM           ZSERR   1                       S01117
     CLR         *LOCK     IN   LDA                                       S01117
     C**                                                                  S01117
     CLR         ZSERR     IFEQ 'Y'                                       S01117
      **  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM       S01117
     CLR                   SETON                     U7U8                 S01117
     CLR                   RETRN                                          S01117
     CLR                   END                                            S01117
     C**                                                                  S01117
     C**    WHEN LR INDICATOR SET ON WITHOUT EXECUTING THE FIRST          S01117
     C**    CYCLE                                                         S01117
     C**                                                                  S01117
      *                                                                   S01117
     CLR         ENDLR     TAG                                            S01117
     CLR         P1OP      IFNE 'Y'                                       S01117
     CLR                   EXSR #ZZ                                       S01117
     CLR                   SETON                     4252
     CLR                   END                                            S01117
     CLR U7 U8             EXSR *PSSR                                     S01117
0400 C**                                                                  LE0650
0401 C********************************************************************LE0650
0402 C/SPACE 3                                                            LE0650
0403 C********************************************************************LE0650
0404 C**                                                                  LE0650
0405 C**   SR. TO SET UP AN ARRAY OF CURRENCIES AND ARRAYS OF             LE0650
0406 C**   DECIMAL PLACES AND NAMES FOR THOSE CURRENCIES.                 LE0650
0407 C**                                                                  LE0650
0408 C           CCYARR    BEGSR                           *** CCYARR  ***LE0650
0409 C**                                                                  LE0650
0410 C**   SET OFF ERROR INDICATOR                                        LE0650
0411 C                     SETOF                     99                   LE0650
0412 C**                                                                  LE0650
0413 C**   SET ARRAY INDEX TO ZERO.                                       LE0650
0414 C                     Z-ADD0         X       30                      LE0650
0415 C**************                                                      S01194
0416 C*****SET*UP*KEY FOR CURRENCY TABLE.                                 S01194
0417 C**************       MOVEL'20      'XCYKEY 12                       S01194
0418 C**************       MOVE '    '    XCYKEY                          S01194
0419 C**************                                                      S01194
0420 C*****SET*LOWER LIMIT AND READ CURRENCY TABLE HEADER.                S01194
0421 C***********XCYKEY    SETLLTABLED                                    S01194
0422 C**                                                                  LE0650
0423 C**   LOOP TO READ CURRENCY DETAIL RECORDS.                          LE0650
0424 C           XLOOP     TAG                             ** XLOOP TAG **LE0650
0425 C**************       READ TABLED                   99               S01194
     C                     READ SDCURRPD                 99               S01194
0426 C**N99******RECT      COMP 20                   9999                 S01194
0427 C**                                                                  LE0650
0428 C**   END IF ALL CURRENCY RECORDS PROCESSED                          LE0650
0429 C   99                GOTO XCAEND                                    LE0650
0430 C**************                                                      S01194
0431 C*****IGNORE*DELETED RECORDS AND NON-SUB-RECORD ONE.                 S01194
0432 C***********RECI      COMP 'D'                  9797                 S01194
0433 C***97*********       GOTO XLOOP                                     S01194
0434 C***********SREC      COMP 1                    9797                 S01194
0435 C***97*********       GOTO XLOOP                                     S01194
0436 C**                                                                  LE0650
0437 C**   INCREMENT ARRAY INDEX.                                         LE0650
0438 C           X         ADD  1         X                               LE0650
0439 C**                                                                  LE0650
0440 C**   MOVE DATA INTO ARRAYS.                                         LE0650
0441 C                     MOVE CCY       XCYA,X                          LE0650
0442 C                     MOVE CDP       XDPA,X                          LE0650
0443 C                     MOVE CCNM      XNME,X                          LE0650
0444 C**                                                                  LE0650
0445 C**   CHECK FOR FULL ARRAY.96 ON IF FULL.                            LE0650
0446 C           X         COMP 150                      96               LE0650
0447 C**                                                                  LE0650
0448 C**   GO TO READ NEXT RECORD.                                        LE0650
0449 C  N96                GOTO XLOOP                                     LE0650
0450 C**                                                                  LE0650
0451 C           XCAEND    ENDSR                           ** XCAEND **   LE0650
0452 C**                                                                  LE0650
0453 C********************************************************************LE0650
0454 C********************************************************************LE0650
0455 C**                                                                  LE0650
0456 C**   SR. TO OBTAIN NO. OF DECIMAL PLACES & NAME FOR A CURRENCY.     LE0650
0457 C**                                                                  LE0650
0458 C           CCYDEP    BEGSR                           *** CCYDEP  ***LE0650
0459 C**                                                                  LE0650
0460 C**   BLANK CURRENCY CODE IS INVALID                                 LE0650
0461 C           XCCY      COMP '   '                    99               LE0650
0462 C   99                GOTO XCDEND                                    LE0650
0463 C**                                                                  LE0650
0464 C**   SET ARRAY INDEX TO ONE                                         LE0650
0465 C                     Z-ADD1         X                               LE0650
0466 C**                                                                  LE0650
0467 C**   INITIALIZE INPUT-OUTPUT FIELDS.                                LE0650
0468 C                     Z-ADD0         XDECP   10                      LE0650
0469 C                     MOVE XCCY      XCCY    3                       LE0650
0470 C                     MOVE ' '       XBLKS  14                       LE0650
0471 C                     MOVE XBLKS     XNAME  14                       LE0650
0472 C**                                                                  LE0650
0473 C**   LOOK UP NO. OF DECIMAL PLACES FOR CURRENCY.                    LE0650
0474 C**   99 SETON FOR INVALID CURRENCY.                                 LE0650
0475 C           XCCY      LOKUPXCYA,X                   95               LE0650
0476 C   95                MOVE XDPA,X    XDECP                           LE0650
0477 C   95                MOVE XNME,X    XNAME                           LE0650
0478 C  N95                SETON                     99                   LE0650
0479 C**                                                                  LE0650
0480 C           XCDEND    ENDSR                           ** XCDEND **   LE0650
0481 C**                                                                  LE0650
0482 C********************************************************************LE0650
0483 C********************************************************************LE0650
0484 C**                                                                  LE0650
0485 C**   THIS S-R CALCULATES UNDERLINING REQUIRED FOR A FIELD TO BE     LE0650
0486 C**   PRINTED ON A REPORT.                                           LE0650
0487 C**                                                                  LE0650
0488 C**    INPUT FIELD - UNDRIN - 30A                                    LE0650
0489 C**   OUTPUT FIELD - UDROUT - 30A                                    LE0650
0490 C**     WORK FIELD - UDRBLK - 30A                                    LE0650
0491 C**     WORK ARRAY - UDR1                                            LE0650
0492 C**    STORE ARRAY - UDR2                                            LE0650
0493 C**                                                                  LE0650
0494 C           SRUNDR    BEGSR                           ** SRUNDR **   LE0650
0495 C**                                                                  LE0650
0496 C**   RESET WORK INDICATORS                                          LE0650
0497 C                     BITOF'01234567'UBIT    1                       LE0650
0498 C**                                                                  LE0650
0499 C   90                BITON'0'       UBIT                            LE0650
0500 C   91                BITON'1'       UBIT                            LE0650
0501 C   92                BITON'2'       UBIT                            LE0650
0502 C**                                                                  LE0650
0503 C                     SETOF                     909192               LE0650
0504 C**                                                                  LE0650
0505 C**   SET UP WORK FIELDS                                             LE0650
0506 C                     MOVEAUNDRIN    UDR1                            LE0650
0507 C                     MOVE ' '       UDRBLK 30                       LE0650
0508 C                     MOVE UDRBLK    UDROUT 30                       LE0650
0509 C                     Z-ADD31        UU      20                      LE0650
0510 C                     Z-ADD30        U       20   92                 LE0650
0511 C   92                MOVE UNDRIN    UNDRIN 30                       LE0650
0512 C           UB1       TAG                             ** UB1 TAG **  LE0650
0513 C**                                                                  LE0650
0514 C**   CHECK IF LAST CHAR. OF NAME IS BLANK                           LE0650
0515 C           UDR1,U    COMP ' '                      90               LE0650
0516 C   90      U         SUB  1         U            9191               LE0650
0517 C   90N91             GOTO UB1                                       LE0650
0518 C**                                                                  LE0650
0519 C**   NOW SET UNDERLINE FOR OUTPUT.                                  LE0650
0520 C  N91      UU        SUB  U         U                               LE0650
0521 C  N91                MOVEAUDR2,U    UDROUT                          LE0650
0522 C**                                                                  LE0650
0523 C**   PROC. NOW COMPLETE - RESET INDICATORS.                         LE0650
0524 C                     TESTB'0'       UBIT           90               LE0650
0525 C                     TESTB'1'       UBIT           91               LE0650
0526 C                     TESTB'2'       UBIT           92               LE0650
0527 C**                                                                  LE0650
0528 C                     ENDSR                                          LE0650
0529 C**                                                                  LE0650
0530 C********************************************************************LE0650
0622 C********************************************************************LE0650
0623 C* SUBROUTINE TO ADD AN AMOUNT (ZZAMT) TO THE TOTAL (ZZTOTI,ZZTOTD)  LE0650
0624 C*   IND '99' IS SET BY AN OVERFLOW ERROR                            LE0650
0625 C*                                                                   LE0650
0626 CSR         GLZADD    BEGSR                           *** GLZADD ****LE0650
0627 C*                                                                   LE0650
0628 CSR                   Z-ADDZZAMT     ZZAMT  153     91-DEFINE ZZAMT  LE0650
0629 CSR 91                GOTO ZZAEND                     AMT = 0.BYPASS LE0650
0630 C*                                                                   LE0650
0631 C* SPLIT ZZAMT INTO INTEGER AND DECIMAL FIELDS                       LE0650
0632 CSR                   Z-ADDZZAMT     ZZAMTI 150       INTEGER FIELD  LE0650
0633 CSR                   MOVE ZZAMT     ZZAMTD  30       DECIMAL FIELD  LE0650
0634 C* BOTH ZZAMTI AND ZZAMTD CONTAIN A 'SIGN' ZONE NOW                  LE0650
0635 C*                                                                   LE0650
0636 CSR                   EXSR GLZSUM                                    LE0650
0637 CSR         ZZAEND    ENDSR                           ** ZZAEND TAG *LE0650
0638 C*                                                                   LE0650
0639 C********************************************************************LE0650
0640 C********************************************************************LE0650
0641 C* SUBROUTINE TO CARRY OUT THE ADDITION FOR SUBROUTINES -            LE0650
0642 C*                        GLZADD, GLZSUB, GLZCMP.                    LE0650
0643 C*          PARAMETERS PASSED -                                      LE0650
0644 C*                     I/P ZZAMTI ZZAMTD                             LE0650
0645 C*                     O/P ZZTOTI ZZTOTD ZZNEGD IND 96 IND 99.       LE0650
0646 C*                                                                   LE0650
0647 CSR         GLZSUM    BEGSR                           *** GLZSUM ****LE0650
0648 C*                                                                   LE0650
0649 CSR                   Z-ADDZZTOTI    ZZTOTI 150       DEFINE ZZTOTI  LE0650
0650 CSR                   Z-ADDZZTOTD    ZZTOTD  30       DEFINE ZZTOTD  LE0650
0651 CSR                   SETOF                     919293               LE0650
0652 CSR                   SETOF                     949599               LE0650
0653 C*                                                                   LE0650
0654 C*    DETERMINE SIGN OF ZZAMTI & D,   92 IF NEG                      LE0650
0655 CSR         ZZAMTI    COMP 0                      9293               LE0650
0656 CSR 93      ZZAMTD    COMP 0                      9293               LE0650
0657 CSR 93                GOTO ZZSEND                     ZERO BYPASS    LE0650
0658 C*                                                                   LE0650
0659 C*    DETERMINE SIGN OF ZZTOTI & D, 91 IF NEG.                       LE0650
0660 CSR         ZZTOTI    COMP 0                      9193               LE0650
0661 CSR 93      ZZTOTD    COMP 0                      9193               LE0650
0662 C*                                                                   LE0650
0663 C*    IF ZZTOTAL IS ZERO, RETURN ZZAMOUNT.                           LE0650
0664 CSR 93                Z-ADDZZAMTI    ZZTOTI                          LE0650
0665 CSR 93                Z-ADDZZAMTD    ZZTOTD                          LE0650
0666 CSR 93                GOTO ZZSEND                     ZERO BYPASS    LE0650
0667 C*    IF SIGNS DIFFER BYPASS OVERFLOW CHECKS.                        LE0650
0668 CSR 91N92                                                            LE0650
0669 CORN91 92             GOTO ZZOFPS                                    LE0650
0670 C*                                                                   LE0650
0671 CSR         ZZAMTD    ADD  ZZTOTD    ZZWK2   40                      LE0650
0672 CSR         ZZWK2     COMP 999                  93    '93' = CARRY   LE0650
0673 CSRN93      ZZWK2     COMP -999                   93    INTO INTEGER.LE0650
0674 C*                                                                   LE0650
0675 CSR 93N92   ZZAMTI    ADD  1         ZZWK3  150       ADD 'CARRY' +VELE0650
0676 CSR    93 92ZZAMTI    SUB  1         ZZWK3            SUB 'CARRY' -VELE0650
0677 CSR 93      ZZTOTI    ADD  ZZWK3     ZZWK3                           LE0650
0678 CSRN93      ZZTOTI    ADD  ZZAMTI    ZZWK3                           LE0650
0679 C*                                                                   LE0650
0680 C* IF THE MODULUS OF ZZWK3 IS LT MOD. ZZTOTI THEN O/F HAS OCCURED    LE0650
0681 CSRN92      ZZWK3     COMP ZZTOTI                 99  -92 MEANS NOS. LE0650
0682 CSR 92      ZZWK3     COMP ZZTOTI               99     NEGATIVE      LE0650
0683 CSRN99                Z-ADDZZWK2     ZZTOTD                          LE0650
0684 CSRN99                Z-ADDZZWK3     ZZTOTI                          LE0650
0685 C*                                                                   LE0650
0686 C* IF O/F ZEROIZE ZZAMT , IND '99' SET AND ZZTOT FIELDS LEFT INTACT. LE0650
0687 CSR 99                Z-ADD0         ZZAMT  153                      LE0650
0688 CSR                   GOTO ZZSEND                                    LE0650
0689 C*                                                                   LE0650
0690 C* THE 'SIGNS' ARE DIFFERENT                                         LE0650
0691 CSR         ZZOFPS    TAG                             ** ZZOFPS TAG**LE0650
0692 C* IF ZZAMT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZTOT            LE0650
0693 C*                                                                   LE0650
0694 CSR 92                Z-SUBZZAMTI    ZZAMTI 150                      LE0650
0695 CSR 92                Z-SUBZZAMTD    ZZAMTD  30                      LE0650
0696 C*                                                                   LE0650
0697 C* IF ZZTOT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZAMT.           LE0650
0698 C*                                                                   LE0650
0699 CSR 91                Z-SUBZZTOTI    ZZTOTI                          LE0650
0700 CSR 91                Z-SUBZZTOTD    ZZTOTD                          LE0650
0701 C* BOTH ZZAMT AND ZZTOT ARE NOW POSITIVE.                            LE0650
0702 C*                                                                   LE0650
0703 CSR         ZZTOTI    COMP ZZAMTI               93  95               LE0650
0704 CSR 95      ZZTOTD    COMP ZZAMTD               93  95               LE0650
0705 C*                                                                   LE0650
0706 C* IF ZZTOT EQ. ZZAMT RETURN ZERO.                                   LE0650
0707 CSR 95                Z-ADD0         ZZTOTI                          LE0650
0708 CSR 95                Z-ADD0         ZZTOTD                          LE0650
0709 CSR 95                GOTO ZZSEND                                    LE0650
0710 C*                                                                   LE0650
0711 C* IF ZZTOT GT. ZZAMT.                                               LE0650
0712 CSR 93      ZZAMTD    COMP ZZTOTD               94                   LE0650
0713 CSR 93 94   ZZTOTI    SUB  1         ZZTOTI                          LE0650
0714 CSR 93 94   ZZTOTD    ADD  1000      ZZWK2                           LE0650
0715 CSR 93      ZZTOTI    SUB  ZZAMTI    ZZTOTI                          LE0650
0716 CSR 93 94   ZZWK2     SUB  ZZAMTD    ZZTOTD                          LE0650
0717 CSR 93N94   ZZTOTD    SUB  ZZAMTD    ZZTOTD                          LE0650
0718 C*                                                                   LE0650
0719 C*                                                                   LE0650
0720 C* IF ZZAMT GT. ZZTOT.                                               LE0650
0721 CSRN93      ZZTOTD    COMP ZZAMTD               94                   LE0650
0722 CSRN93 94   ZZAMTI    SUB  1         ZZWK3  150                      LE0650
0723 CSRN93 94   ZZAMTD    ADD  1000      ZZWK2                           LE0650
0724 CSRN93 94   ZZWK3     SUB  ZZTOTI    ZZTOTI                          LE0650
0725 CSRN93N94   ZZAMTI    SUB  ZZTOTI    ZZTOTI                          LE0650
0726 CSRN93 94   ZZWK2     SUB  ZZTOTD    ZZTOTD                          LE0650
0727 CSRN93N94   ZZAMTD    SUB  ZZTOTD    ZZTOTD                          LE0650
0728 C*                                                                   LE0650
0729 C* REVERSE SIGN OF ZZTOT IF LARGER I/P FIELDS WERE NEGATIVE          LE0650
0730 CSR                   SETOF                     94                   LE0650
0731 CSR 93 91                                                            LE0650
0732 CORN93 92             SETON                     94                   LE0650
0733 CSR 94                Z-SUBZZTOTI    ZZTOTI                          LE0650
0734 CSR 94                Z-SUBZZTOTD    ZZTOTD                          LE0650
0735 C**                                                                  LE0650
0736 C**   RESTORE SIGN OF ZZAMTI & ZZAMTD IF IT WAS REVERSED.            LE0650
0737 CSR 92                Z-SUBZZAMTI    ZZAMTI                          LE0650
0738 CSR 92                Z-SUBZZAMTD    ZZAMTD                          LE0650
0739 CSR         ZZSEND    TAG                             ** ZZSEND TAG *LE0650
0740 C**                                                                  LE0650
0741 C**   IF ZZTOTD IS ZERO, AND ZZTOTI IS NEG. SET UP ZZNEGD.           LE0650
0742 CSR                   SETOF                     96                   LE0650
0743 CSR         ZZTOTD    COMP 0                        91               LE0650
0744 CSR 91      ZZTOTI    COMP 0                      96                 LE0650
0745 CSR 96                MOVE '.000-'   ZZNEGD  5                       LE0650
0746 CSR                   ENDSR                             ** ENDSR **  LE0650
0747 C********************************************************************LE0650
0748 C********************************************************************LE0650
0749 C**                                                                  LE0650
0750 C**   ZSYSTM SR. TO CHAIN TO THE INSTALLATION CONTROL DATA RECORD.   LE0650
0751 C**                                                                  LE0650
0752 C           ZSYSTM    BEGSR                           *** ZSYSTM *** LE0650
0753 C**************                                                      S01194
0754 C*****SET*UP*KEY FOR INSTALLATION CONTROL RECORD.                    S01194
0755 C**************       MOVEL'01      'ZTABKY 12                       S01194
0756 C**************       MOVE '  10'    ZTABKY                          S01194
0757 C**************                                                      S01194
0758 C***********ZTABKY    CHAINTABLE                99    ON NOT THERE   S01194
0759 C**N99******RECI      COMP 'D'                  9999  ON, IS DELETED S01194
     C**                                                                  S01194
     C**   ACCESS BANK DETAILS                                            S01194
     C**                                                                  S01194
     C                     CALL 'AOBANKR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDBANK    PARM SDBANK    DSFDY                           S01194
     C*                                                                   S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     SETON                     U7U8LR               S01194
     C                     SETON                     99    ***************S01194
     C                     MOVEL'SDBANKPD'DBFILE           * DBERROR 01  *S01194
     C                     Z-ADD1         DBASE            ***************S01194
     C                     ELSE                                           S01194
0760 C**                                                                  LE0650
0761 C**   CHECK SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.                    LE0650
0762 C***********DATF      COMP 'M'                      98MMDDYY, 98 ON  S01194
     C           BJDFIN    COMP 'M'                      98MMDDYY, 98 ON  S01194
     C                     END                                            S01194
0763 C**                                                                  LE0650
0764 C                     ENDSR                                          LE0650
0765 C**                                                                  LE0650
0766 C**                                                                  LE0650
0433 C********************************************************************S01117
     C/SPACE 3                                                            S01117
     C********************************************************************S01117
     C*                                                                   S01117
     C* SUBROUTINE : #ZZ                                                  S01117
     C*                                                                   S01117
     C* CALLED BY MAIN PROCESSING DURING TOTAL TIME CALCULATIONS IF       S01117
     C* THE P1 FILES HAVE NOT ALREADY BEEN OPENED (IE, IF THERE ARE       S01117
     C* NO RECORDS READ AND THEREFORE FILES OPENING NOT PERFORMED)        S01117
     C*                                                                   S01117
     C           #ZZ       BEGSR                                          S01117
     C*                                                                   S01117
     C** OPEN P1 SPOOL FILE                                               S01117
     C*                                                                   S01117
     C                     OPEN LE0650P1                                  S01117
     C*                                                                   S01117
     C** IF REPORT FOR ALL ENTITIES CALL ZSFILE WITH BLANK SENTY          S01117
     C*                                                                   S01117
     C           BRNCH     IFEQ 'ALL'                      B1             S01117
     C           MBIN      ORNE 'Y'                                       S01117
     C*                                                                   S01117
     C** ENSURE REPORT SPOOL FILE RECORDED BY RCF                         S01117
     C*                                                                   S01117
     C                     Z-ADDSFNUM     ZSNUM   60                      S01117
     C                     OUT  LDA                                       S01117
     C**                                                                  S01117
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           SEQ                             S01117
     C                     PARM *BLANKS   SENTY   3                       S01117
     C                     PARM           SFILE                           S01117
     C                     PARM           ZSNUM                           S01117
     C                     PARM           ZSERR   1                       S01117
     C*                                                                   S01117
     C           *LOCK     IN   LDA                                       S01117
     C**                                                                  S01117
     C           ZSERR     IFEQ 'Y'                                       S01117
      **  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM       S01117
     C                     SETON                     U7U8                 S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C                     MOVE 'ALL'     BRCA                            S01117
     C                     MOVE *BLANKS   BRNM                            S01117
     C*                                                                   S01117
     C** ELSE REPORT BY ENTITY SO CALL ZSFILE WITH ENTITY REQUESTED       S01117
     C*                                                                   S01117
     C                     ELSE                            X1             S01117
     C*                                                                   S01117
     C** ENSURE REPORT SPOOL FILE RECORDED BY RCF                         S01117
     C*                                                                   S01117
     C**                                                                  S01117
     C                     Z-ADDSFNUM     ZSNUM   60                      S01117
     C                     OUT  LDA                                       S01117
     C**                                                                  S01117
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           SEQ                             S01117
     C                     PARM BRNCH     SENTY   3                       S01117
     C                     PARM           SFILE                           S01117
     C                     PARM           ZSNUM                           S01117
     C                     PARM           ZSERR   1                       S01117
     C*                                                                   S01117
     C           *LOCK     IN   LDA                                       S01117
     C**                                                                  S01117
     C           ZSERR     IFEQ 'Y'                                       S01117
      **  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM       S01117
     C                     SETON                     U7U8                 S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C                     MOVE BRNCH     BRCA                            S01117
     C*                                                                   S01117
     C** AND GET ENTITY DETAILS FOR REPORT HEADINGS WHEN MULTIBRANCHING   S01117
     C*                                                                   S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C           BRNCH     ANDNE*BLANKS                                   S01392
     C                     MOVELBRCA      ##KB                                                CSC042
     C                     EXSR ##CHKB                                                        CSC042
      * If branch is in the array then use the details                                        CSC042
     C           ##FIC     IFEQ 'Y'                        *** B10                            CSC042
     C                     EXSR ##SETB                                                        CSC042
     C                     ELSE                            *** X10                            CSC042
     C**********           CALL 'AOBRCHR0'                                S01117              CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       S01117
     C                     PARM '*KEY   ' @OPTN   7                       S01117
     C                     PARM BRCA      @DSNB   3                       S01117
     C********** SDBRCH    PARM SDBRCH    DSFDY                           S01117              CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANKS                                   S01117
     C                     MOVEL@DSNB     DBKEY            ***************S01117
     C                     MOVEL'SDBRCHPD'DBFILE           * DBERROR 11  *S01117
     C                     Z-ADD11        DBASE            ***************S01117
     C                     SETON                     U7U8                 S01117
     C                     EXSR *PSSR                                     S01117
     C                     GOTO #ZZ9                                      S01117
     C                     ELSE                                                               CSC042
      * Details found on the DB so add them to the array                                      CSC042
      * if the array still has room                                                           CSC042
     C                     EXSR ##ADDB                                                        CSC042
     C                     END                                            S01117
     C                     ENDIF                           *** E10                            CSC042
     C                     END                                            S01117
     C*                                                                   S01117
     C                     END                             E1             S01117
     C*                                                                   S01117
     C           #ZZ9      ENDSR                                          S01117
     C*                                                                   S01117
     C**                                                                  S01117
     C********************************************************************S01117
     C/SPACE 3                                                            S01117
     C********************************************************************S01117
      /EJECT                                                                                  CSC042
     C********************************************************************                    CSC042
      *                                                                                       CSC042
      * ##CHKB - Subroutine to check the Branch in the arrays                                 CSC042
      *                                                                                       CSC042
     C           ##CHKB    BEGSR                                                              CSC042
      *                                                                                       CSC042
     C           *LIKE     DEFN A8BRCD    ##KB                                                CSC042
      *                                                                                       CSC042
      * Set off the branch found indicator                                                    CSC042
     C                     MOVEL*BLANK    ##FIC   1                                           CSC042
      *                                                                                       CSC042
      * Save the state of indicator 30 so it can be reset at the end                          CSC042
      * of the SR as it may be used elsewhere in the code                                     CSC042
     C           *IN30     IFEQ *ON                                                           CSC042
     C                     MOVEL'Y'       #IN30   1                                           CSC042
     C                     ELSE                                                               CSC042
     C                     MOVEL'N'       #IN30                                               CSC042
     C                     ENDIF                                                              CSC042
      *                                                                                       CSC042
     C                     SETOF                         30                                   CSC042
      *                                                                                       CSC042
      * Restore the saved Value of B                                                          CSC042
     C                     Z-ADD##BSV     B                                                   CSC042
      *                                                                                       CSC042
     C* Check whether details for Branch already in array                                     CSC042
      *                                                                                       CSC042
      * Is this the same as the last LOKUP, if so we can bypass                               CSC042
      * the LOKUP                                                                             CSC042
      * Defend against B being 0                                                              CSC042
     C           B         IFEQ 0                                                             CSC042
     C                     Z-ADD1         B                                                   CSC042
     C                     ENDIF                                                              CSC042
      *                                                                                       CSC042
      * If the branch being checked is the same then use these                                CSC042
      * details rather than doing a LOKUP                                                     CSC042
     C           ##KB      IFEQ ##BR,B                                                        CSC042
      * Found so seton 30                                                                     CSC042
     C                     SETON                         30                                   CSC042
     C                     ELSE                                                               CSC042
     C                     Z-ADD1         B                                                   CSC042
     C           ##KB      LOKUP##BR,B                   30                                   CSC042
     C                     ENDIF                                                              CSC042
      *                                                                                       CSC042
      * Save the last update to B                                                             CSC042
     C           *IN30     IFEQ *ON                                                           CSC042
     C                     Z-ADDB         ##BSV                                               CSC042
      * Set the indicator to show the data was found                                          CSC042
     C                     MOVEL'Y'       ##FIC                                               CSC042
     C                     ENDIF                                                              CSC042
      *                                                                                       CSC042
      * Reset the state of indicator 30.                                                      CSC042
     C           #IN30     IFEQ 'Y'                                                           CSC042
     C                     MOVEL*ON       *IN30                                               CSC042
     C                     ELSE                                                               CSC042
     C                     MOVEL*OFF      *IN30                                               CSC042
     C                     ENDIF                                                              CSC042
      *                                                                                       CSC042
     C                     ENDSR                                                              CSC042
      ********************************************************************                    CSC042
      /EJECT                                                                                  CSC042
      ********************************************************************                    CSC042
      *                                                                                       CSC042
      * ##SETB - Sets up the SDBRCHPD fields used in the code from the                        CSC042
      * arrays                                                                                CSC042
      *                                                                                       CSC042
     C           ##SETB    BEGSR                                                              CSC042
      *                                                                                       CSC042
     C                     MOVEL##BR,B    A8BRCD                                              CSC042
     C                     MOVEL##BN,B    BRNM                                                CSC042
      *                                                                                       CSC042
     C                     ENDSR                                                              CSC042
      *                                                                                       CSC042
      ********************************************************************                    CSC042
      /EJECT                                                                                  CSC042
      ********************************************************************                    CSC042
      *                                                                                       CSC042
      * ##ADDB - Adds the SDBRCHPD fields used in the code to the                             CSC042
      * arrays                                                                                CSC042
      *                                                                                       CSC042
     C           ##ADDB    BEGSR                                                              CSC042
      *                                                                                       CSC042
      * If there is still room in the array then add the details                              CSC042
     C           ##BNDX    IFLT 999                                                           CSC042
     C                     ADD  1         ##BNDX                                              CSC042
     C                     Z-ADD##BNDX    B                                                   CSC042
     C                     MOVELA8BRCD    ##BR,B                                              CSC042
     C                     MOVELBRNM      ##BN,B                                              CSC042
     C                     ENDIF                                                              CSC042
      *                                                                                       CSC042
      * Update ##BSV  so next call to ##CHKB checks this latest adddition                     CSC042
      * to the array firss                                                                    CSC042
     C                     Z-ADDB         ##BSV                                               CSC042
      *                                                                                       CSC042
     C                     ENDSR                                                              CSC042
      ********************************************************************                    CSC042
      /EJECT                                                                                  CSC042
      ********************************************************************                    CSC042
     C*                                                                   S01117
     C*  *PSSR --- SUBROUTINE TO HANDLE ABNORMAL ERROR CONDITIONS         S01117
     C*                                                                   S01117
     C*  CALLED FROM: AFTER ABNORMAL OPERATION OCCURS                     S01117
     C*                                                                   S01117
     C*  CALLS: NOTHING                                                   S01117
     C*                                                                   S01117
     C********************************************************************S01117
     C*                                                                   S01117
     C           *PSSR     BEGSR                           ** *PSSR **    S01117
     C*                                                                   S01117
     C           @RUN      IFEQ *BLANKS                                   S01117
     C                     MOVE 'Y'       @RUN    1                       S01117
     C                     DUMP                                           S01117
     C                     END                                            S01117
     C                     ENDSR                           ** *PSSR **    S01117
     C*                                                                   S01117
     C********************************************************************S01117
     C/COPY ZSRSRC,ZDATE2Z4                                               S01392
     C********************************************************************S01392
     C/EJECT                                                              S01117
0768 O*E0650P1H** 03   OFNL4                                    S01124    S01117
0769 O*******OR**      L4                                                 S01117
0770 O*******OR**      LR 42                                              S01117
0771 O***********                        22 'REFERENCE LE0650'            S01117
0768 OLE0650P1H   03   OFNL4 52                                           S01117
0769 O       OR        L4 52                                              S01117
0771 O                                   24 'REFERENCE LE0650P1'          S01117
0772 O                         TITL      89                               LE0650
0773 O                                  104 'DATE'                        LE0650
0774 O                         RUNA     113                               LE0650
0775 O                                  122 'PAGE'                        LE0650
0776 O                         PAGE  3  128                               LE0650
0777 O********H** 05   OFNL4                                              S01117
0778 O*******OR**      L4                                                 S01117
0777 O        H   05   OFNL4 52                                           S01117
0778 O       OR        L4 52                                              S01117
0780 O***********           N42          12 'BRANCH'                      S01117
0781 O***********           N42BRCD      17                               S01117
0782 O                                   71 'INTEREST ACCRUAL REPORT'     LE0650
     O                       33          81 'BRANCH'                      S01117
     O                       33BRCA      86                               S01117
     O                       33          87 '-'                           S01117
     O                       33BRNM     117                               S01117
0783 O********H** 06   OFNL4                                              S01117
0784 O*******OR**      L4                                                 S01117
0783 O        H   06   OFNL4 52                                           S01117
0784 O       OR        L4 52                                              S01117
0786 O                                   71 '-----------------------'     LE0650
0787 O********H** 07   OFNL4                                              S01117
0788 O*******OR**      L4NU7                                              S01117
0787 O        H   09   OFNL4 52                                           S01117
0788 O       OR        L4NU7 52                                           S01117
0789 O                                    9 'CURRENCY'                    LE0650
0790 O                         CCYNME    24                               LE0650
0791 O********H** 09   OFNL4                                              S01117
0792 O*******OR**      L4                                                 S01117
0791 O        H   11   OFNL4 52                                           S01117
0792 O       OR        L4 52                                              S01117
0794 O                                    9 'CUSTOMER'                    LE0650
0795 O**********                         39 'LOAN'                                     LE0650 201123
     O                                   36 'LOAN'                                            201123
     O                                   47 'ORIGINAL'                                        201123
0796 O**********                         97 'FROM       TO       INTE'                 LE0650 201123
0797 O**********                        101 'REST'                                     LE0650 201123
     O                                   80 'FROM'                                            201123
     O                                   88 'TO'                                              201123
     O                                  101 'INTEREST'                                        201123
0798 O                                  127 'INTEREST'                    LE0650
0799 O********H**210   OFNL4                                              S01117
0800 O*******OR**      L4                                                 S01117
0799 O        H  212   OFNL4 52                                           S01117
0800 O       OR        L4 52                                              S01117
0802 O                                    7 'NUMBER'                      LE0650
0803 O                                   19 'NAME'                        LE0650
0804 O**********                         38 'NO'                                       LE0650 201123
     O                                   35 'NO'                                              201123
     O                                   47 'BORROWER'                                        201123
0805 O**********                         77 'PRINCIPAL      DATE'                      LE0650 201123
     O                                   69 'PRINCIPAL'                                       201123
     O                                   80 'DATE'                                            201123
0806 O**********                        103 'DATE   BASIS    RATE'                     LE0650 201123
     O                                   89 'DATE'                                            201123
     O                                   96 'BASIS'                                           201123
     O                                  103 'RATE'                                            201123
0807 O                                  126 'AMOUNT'                      LE0650
0808 O********D**      L3NU7                                              S01117
0808 O        D        L3NU7 52                                           S01117
0809 O                         NARR      31                               LE0650
0810 O********D**2     L3NU7                                              S01117
0810 O        D  2     L3NU7 52                                           S01117
0811 O                         UNDLIN    31                               LE0650
0812 O********D**2     01NU7                                              S01117
0812 O        D  2     01NU7 52                                           S01117
0813 O                       L1CNUM       7                               LE0650
0814 O**********             L1CRNM      31                                            LE0650 201123
     O                       L1CRNM      29                                                   201123
0815 O**********               LNNO      40                                            LE0650 201123
     O                         LNNO      37                                                   201123
     O                         OLNOZ     46                                                   201123
0816 O**********             60CPAM      69 ' ,   ,   ,   , 0 CR'                      LE0650 201123
0817 O**********             61CPAM      69 '   ,   ,   , 0 . CR'                      LE0650 201123
0818 O**********             62CPAM      69 '  ,   ,   , 0 .  CR'                      LE0650 201123
0819 O**********             63CPAM      69 ' ,   ,   , 0 .   CR'                      LE0650 201123
     O                       60CPAM      71 ' ,   ,   ,   , 0 CR'                             201123
     O                       61CPAM      71 '   ,   ,   , 0 . CR'                             201123
     O                       62CPAM      71 '  ,   ,   , 0 .  CR'                             201123
     O                       63CPAM      71 ' ,   ,   , 0 .   CR'                             201123
0820 O**********             71          87 '*** REVERSAL ***'                         LE0650 201123
     O                       71          89 '*** REVERSAL ***'                                201123
0821 O**********          22N71FRMDAT    78                                            LE0650 201123
0822 O**********          21N71TODAT     87                                            LE0650 201123
     O                    22N71FRMDAT    81                                                   201123
     O                    21N71TODAT     89                                                   201123
0823 O                         ICBS      94                               LE0650
0824 O                         INTRAT   107 '  0.       '                 LE0650
0825 O                       60EAMT     129 ' ,   ,   ,   , 0 CR'         LE0650
0826 O                       61EAMT     129 '   ,   ,   , 0 . CR'         LE0650
0827 O                       62EAMT     129 '  ,   ,   , 0 .  CR'         LE0650
0828 O                       63EAMT     129 ' ,   ,   , 0 .   CR'         LE0650
0829 O********T**2     L2N42NU7                                           E81286
     O        TF 2     L2N42NU7                                           E81286
     O       AND       52                                                 S01117
0830 O                    30 71          49 'TOTAL REVERSALS'             LE0650
0831 O                       72          56 'TOTAL ACCRUED INTEREST'      LE0650
0832 O                    30 73          55 'TOTAL MANUAL ADJSTMTS'       LE0650
0833 O                    30 74          58 'TOTAL GENERATED ADJSTMTS'    LE0650
0834 O                         NARR      89                               LE0650
0835 O                       60SEQTOT   129 ' ,   ,   ,   , 0 CR'         LE0650
0836 O                       61SEQTOT   129 '   ,   ,   , 0 . CR'         LE0650
0837 O                       62SEQTOT   129 '  ,   ,   , 0 .  CR'         LE0650
0838 O                       63SEQTOT   129 ' ,   ,   , 0 .   CR'         LE0650
0839 O        T  2     L4N42NU7                                           LE0650
     O       AND       52                                                 S01117
0840 O                                   49 'CURRENCY TOTAL REVERSALS'    LE0650
0841 O                       60REVTOT   129 ' ,   ,   ,   , 0 CR'         LE0650
0842 O                       61REVTOT   129 '   ,   ,   , 0 . CR'         LE0650
0843 O                       62REVTOT   129 '  ,   ,   , 0 .  CR'         LE0650
0844 O                       63REVTOT   129 ' ,   ,   , 0 .   CR'         LE0650
0845 O        T  2     L4N42NU7                                           LE0650
     O       AND       52                                                 S01117
0846 O                                   47 'CURRENCY TOTAL ACCRUED'      LE0650
0847 O                                   56 'INTEREST'                    LE0650
0848 O                       60ACCTOT   129 ' ,   ,   ,   , 0 CR'         LE0650
0849 O                       61ACCTOT   129 '   ,   ,   , 0 . CR'         LE0650
0850 O                       62ACCTOT   129 '  ,   ,   , 0 .  CR'         LE0650
0851 O                       63ACCTOT   129 ' ,   ,   , 0 .   CR'         LE0650
0852 O        T  2     L4N42NU7                                           LE0650
     O       AND       52                                                 S01117
0853 O                                   46 'CURRENCY TOTAL MANUAL'       LE0650
0854 O                                   55 'ADJSTMTS'                    LE0650
0855 O                       60MANTOT   129 ' ,   ,   ,   , 0 CR'         LE0650
0856 O                       61MANTOT   129 '   ,   ,   , 0 . CR'         LE0650
0857 O                       62MANTOT   129 '  ,   ,   , 0 .  CR'         LE0650
0858 O                       63MANTOT   129 ' ,   ,   , 0 .   CR'         LE0650
0859 O        T  2     L4N42NU7                                           LE0650
     O       AND       52                                                 S01117
0860 O                                   49 'CURRENCY TOTAL GENERATED'    LE0650
0861 O                                   58 'ADJSTMTS'                    LE0650
0862 O                       60GENTOT   129 ' ,   ,   ,   , 0 CR'         LE0650
0863 O                       61GENTOT   129 '   ,   ,   , 0 . CR'         LE0650
0864 O                       62GENTOT   129 '  ,   ,   , 0 .  CR'         LE0650
0865 O                       63GENTOT   129 ' ,   ,   , 0 .   CR'         LE0650
0646 O**                                                                  S01117
0647 O**   HEADINGS IF NO DETAILS TO REPORT OR D/B ERROR IN FIRST CYCLE   S01117
0648 O**                                                                  S01117
0768 O        T   03   LR 42 52                                           S01117
0771 O                                   24 'REFERENCE LE0650P1'          S01117
0772 O                         TITL      89                               S01117
0773 O                                  104 'DATE'                        S01117
0774 O                         RUNA     113                               S01117
0775 O                                  122 'PAGE'                        S01117
0776 O                         PAGE  3  128                               S01117
0777 O        T   05   LR 42 52                                           S01117
0782 O                                   71 'INTEREST ACCRUAL REPORT'     S01117
     O                       33          81 'BRANCH'                      S01117
     O                       33BRCA      86                               S01117
     O                       33          87 '-'                           S01117
     O                       33BRNM     117                               S01117
0783 O        T   06   LR 42 52                                           S01117
0786 O                                   71 '-----------------------'     S01117
0791 O        T   11   LR 42 52                                           S01117
0794 O                                    9 'CUSTOMER'                    S01117
0795 O**********                         39 'LOAN'                                     S01117 201123
     O                                   36 'LOAN'                                            201123
     O                                   47 'ORIGINAL'                                        201123
0796 O**********                         97 'FROM       TO       INTE'                 S01117 201123
0797 O**********                        101 'REST'                                     S01117 201123
     O                                   80 'FROM'                                            201123
     O                                   88 'TO'                                              201123
     O                                  101 'INTEREST'                                        201123
0798 O                                  127 'INTEREST'                    S01117
0799 O        T  212   LR 42 52                                           S01117
0802 O                                    7 'NUMBER'                      S01117
0803 O                                   19 'NAME'                        S01117
0804 O**********                         38 'NO'                                       S01117 201123
     O                                   35 'NO'                                              201123
     O                                   47 'BORROWER'                                        201123
0805 O**********                         77 'PRINCIPAL      DATE'                      S01117 201123
     O                                   69 'PRINCIPAL'                                       201123
     O                                   80 'DATE'                                            201123
0806 O**********                        103 'DATE   BASIS    RATE'                     S01117 201123
     O                                   89 'DATE'                                            201123
     O                                   96 'BASIS'                                           201123
     O                                  103 'RATE'                                            201123
0807 O                                  126 'AMOUNT'                      S01117
0866 O*    RUN CONTROLS                                                   LE0650
0867 O        T   17   LRNU7 42                                           S01117
0868 O                                   76 'NO DETAILS TO REPORT'        S01117
0869 O********T*32     LR U7                                              S01117
0869 O        T 32     LR U7 52                                           S01117
0870 O                                   51 '*** REFERENCE LE0650'        LE0650
0871 O***********                        71 '- DATABASE ERROR AT'         S01117
0871 O                                   72 'DATABASE ERROR ***'          S01117
0872 O***********              DBASE     74                               S01117
0873 O********T**      LR U7                                              S01117
0874 O***********                        37 'FILENAME'                    S01117
0875 O***********              DBFILE    43                               S01117
0876 O***********                        48 'KEY'                         S01117
0877 O***********              DBKEY     78                               S01117
0911 O********T**      LR                                                 S01117
0912 O***********                        76 '*** END OF REPORT ***'       S01117
     O        T 3      L5 52 33                                           S01117
     O                                   66 '*** END OF REPORT FOR'       S01117
     O                                   74 ' BRANCH '                    S01117
     O                         BRCA      77                               S01117
     O                                   81 ' ***'                        S01117
     O        T 3      LR 52N33                                           S01117
     O       AND         NU7                                              S01117
     O                                   76 '*** END OF REPORT ***'       S01117
0878 O********T** 03   LR                                                 S01117
     OLE0650AUT   03   LR                                                 S01117
0879 O***********                        22 'REFERENCE  LE0650'           S01117
0879 O                                   24 'REFERENCE  LE0650AU'         S01117
0880 O                         TITL      89                               LE0650
0881 O                                  104 'DATE'                        LE0650
0882 O                         RUNA     112                               LE0650
0883 O                                  122 'PAGE'                        LE0650
0884 O***********              PAGE  3  127                               S01117
0884 O                         PAGE1 3  127                               S01117
0885 O        T   05   LR                                                 LE0650
0886 O                                   71 'INTEREST ACCRUAL REPORT'     LE0650
0887 O                                   87 '- FILE CONTROLS'             LE0650
0888 O        T   06   LR                                                 LE0650
0889 O                                   71 '-----------------------'     LE0650
0890 O                                   87 '----------------'            LE0650
0891 O        T   09   LR                                                 LE0650
0892 O                                   28 'S/INACS - RUN CONTROLS'      LE0650
0893 O                                   59 'NUMBER'                      LE0650
0894 O                                   84 'VALUE'                       LE0650
0895 O        T   10   LR                                                 LE0650
0896 O                                   28 '----------------------'      LE0650
0897 O                                   59 'OF RECORDS'                  LE0650
0898 O                                   84 'OF RECORDS'                  LE0650
0899 O        T   12   LR                                                 LE0650
0900 O                                   29 'TOTAL RECORDS ON FILE'       LE0650
0901 O                      NU7NORE  3   59                               LE0650
0902 O                      NU7VLRF  4   81                               LE0650
0903 O                      NU7VLRL      84                               LE0650
0904 O        T   14   LR                                                 LE0650
0905 O                                   29 'TOTAL RECORDS ON FILE'       LE0650
0906 O                                   42 '- CALCULATED'                LE0650
0907 O                         NREC  3   59                               LE0650
0908 O                         NRECF 4   81                               LE0650
0909 O                         NRECL     84                               LE0650
0910 O                    U8NU7         111 '*** DIFFERENCE ***'          LE0650
0869 O        T 32     LR U7                                              S01117
0870 O                                   51 '*** REFERENCE LE0650'        S01117
0871 O                                   71 'DATABASE ERROR AT'           S01117
0872 O                         DBASE     75                               S01117
0873 O        T        LR U7                                              S01117
0874 O                                   39 'FILENAME'                    S01117
0875 O                         DBFILE    48                               S01117
0876 O                                   52 'KEY'                         S01117
0877 O                         DBKEY     82                               S01117
0867 O        T   17   LRNU7 42                                           S01117
0868 O                                   76 'NO DETAILS TO REPORT'        S01117
0911 O********T** 17   LR                                                 S01117
0912 O***********                        76 '*** END OF REPORT ***'       S01117
**   UDR2
------------------------------
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
** CPY@   **      OBJECT COPYRIGHT
(c) Finastra International Limited 2001
