0001 H        1                                                           S01117
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas Commitment Fees Accrual Extract')                *
0001 H***********                                                         S01117
0002 F********************************************************************LE0652
0003 F*                                                                  *LE0652
     F*  Midas Customer Lending Module                                LE0652
0005 F*                                                                  *LE0652
0006 F*        LE0652 - COMM.FEE ACCRUALS EXTRACT                        *LE0652
0007 F*                                                                  *LE0652
      *  (c) Finastra International Limited 2001                      *
0009 F*                                                                  *LE0652
      *  Last Amend No. CSD103             Date 10Aug20               *
      *  Prev Amend No. MD046248           Date 27Oct17               *
      *                 CLE148             Date 23Jul12               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CSD031             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 CLE042             Date 06Sep05               *
      *                 CGL029             Date 01Sep03               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
     F*                 E51633             Date 17Mar93                  *BHF581
     F*                 S01270             Date 02Nov92                  *BHF581
0010 F*                       S01194                DATE - 22JAN90       *S01117
0010 F*                       S01117                DATE - 07/09/89      *S01117
0011 F*                                                                  *
     F*----------------------------------------------------------------  *
     F*                                                                  *
      *  CSD103 - LIBOR Deregulation - Common Layer/Standing Data     *
      *  MD046248 - Finastra Rebranding                               *
      *  CLE148 - Alpha Loan Reference                                *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CLE042 - Extended Loan Sub Type                              *
      *  CGL029 - Increase Account Code to 10 digits                  *
     F*        E51633 - THIS PROGRAM IS NOT REDUNDANT FROM REL 10.3.22   *
     F*        S01270 - THIS PROGRAM IS REDUNDANT FROM REL 10.3.22       *
     F*        S01194 - STANDING DATA CHANGES                            *
     F*        S01117 - MULTIBRANCHING                                    S01117
0011 F*                                                                  *
0012 F********************************************************************LE0652
     F*  C R E A T I O N     P A R A M E T E R S                      *
     F*                                                               *
     F*                                                               *
     F*****************************************************************
0013 F*KEY2***IP* F     128 36AI    12 DISK                               S01117
0013 F***LKEY2** IP  F     131 36AI    12 DISK                                         S01117 CGL029
     F*LKEY2***IP**F*****154 36AI    12 DISK                                           CGL029 CLE042
     FLKEY2   IP  F     168 36AI    12 DISK                                                   CLE042
0014 F*TABLE***IF**F******96**2AI     2 DISK                              S01194
0015 FCFACXHH O   F     128            DISK                               LE0652
0015 F*FACXDP*O** F     128            DISK                               S01117
0015 F***CFACXDP O   F     131            DISK                                         S01117 CGL029
     F*CFACXDP*O***F*****154            DISK                                           CGL029 CLE042
     FCFACXDP O   F     168            DISK                                                   CLE042
0015 FCFACXZZ O   F     128            DISK                               LE0652
0016 F*E0652P1O** F     132            PRINTER                            S01117
0016 FLE0652AUO   F     132     OA     PRINTER                            S01117
0011 F*                                                                  *LE0652
0017 F* ID F  C  H  L    FUNCTION OF INDICATORS                           LE0652
0018 F* 01            S/LKEY2 - HEADER RECORD                             LE0652
0019 F* 02                    - DETAIL RECORD - COMM. FEE ACCRUAL KEY     LE0652
0020 F* 03                                    - OTHER                     LE0652
0021 F*       40      CONDITION FIRST CYCLE PROCESSING                    LE0652
0022 F*       41      GENERAL PURPOSE                                     LE0652
0023 F*             U7STANDARD MIDAS USAGE                                LE0652
0024 F*             U8STANDARD MIDAS USAGE                                LE0652
     E                    CPY@    1   1 80
0025 I*                                                                   LE0652
0026 I*    ACCOUNT KEYS FILE - HEADER RECORD                              LE0652
0027 I*                                                                   LE0652
0028 ILKEY2   NS  01   1 CH                                               LE0652
0029 I*                                                                   LE0652
0030 I*    ACCOUNT KEYS FILE - DETAIL RECORD                              LE0652
0031 I*                                                                   LE0652
0032 I        NS  02   1 CF   5 CA                                        LE0652
0033 I       OR   03   1 CF                                               LE0652
0034 I                                        1   1 RECI                  LE0652
0035 I****************************************2  11 AKEY                               LE0652 CLE042
0036 I**********                             12  170LNNO                               LE0652 CLE148
     I                                       12  17 LNNO                                      CLE148
0037 I**********                             18  230CNUM                               LE0652 CSD027
0037 I                                       18  23 CNUM                                      CSD027
0038 I***********                            24  260BRCD                  S01117
0038 I                                       24  26 BRCA                  S01117
0039 I                                       27  280ACSQ                  LE0652
0040 I                                    P  29  310EDAT                  LE0652
0041 I                                    P  32  380EAMT                  LE0652
0042 I                                       39  41 ECCY                  LE0652
0043 I                                       42  430SETP                  LE0652
0044 I**********                             44  45 OSAC                               LE0652 CGL029
     I                                       44  45 OSACQQ                                    CGL029
0045 I                                       56  560REVI                  LE0652
0046 I                                    P  57  630OTHA                  LE0652
0047 I                                       64  66 OTHC                  LE0652
0048 I                                    P  67  738EXRT                  LE0652
0049 I                                    P  74  760VDAT                  LE0652
0050 I                                    P  77  790SLID                  LE0652
0051 I                                    P  80  820MDAT                  LE0652
0052 I**********                             83  840BRTT                               LE0652 CSD103
     I                                       83  84 BRTT                                      CSD103
0053 I                                    P  85  907BRTE                  LE0652
0054 I                                    P  91  967RTSP                  LE0652
0055 I                                    P  97 1027INTR                  LE0652
0056 I                                      103 1030SSEQ                  LE0652
     I                                      137 154 OSAC                                      CGL029
     I                                      155 168 AKEY                                      CLE042
0057 I*    RECORD CONTENTS                                                LE0652
0058 I**********                              1 128 LOTL                               LE0652 CGL029
     I****************************************1 154 LOTL                               CGL029 CLE042
     I                                        1 168 LOTL                                      CLE042
0059 I*                                                                   LE0652
0060 I*    ACCOUNT KEYS FILE - TRAILER RECORD                             LE0652
0061 I*                                                                   LE0652
0062 I        NS       1 CT                                               LE0652
0063 I                                    P   2   40NORE                  LE0652
0064 I                                    P   5  120VLAF                  LE0652
0065 I                                    P  13  140VLAL                  LE0652
0066 I*                                                                   LE0652
0067 I*    CATCH ALL                                                      LE0652
0068 I*                                                                   LE0652
0069 I        NS                                                          LE0652
0070 I***********                                                         S01194
0071 I*****TABLE*FILE - INSTALLATION CONTROL DATA RECORD 1.               S01194
0072 I***********                                                         S01194
0073 I*TABLE***NS*******2*C0*  3 C1  12 C1                                S01194
0074 I*******AND******13*C0**                                             S01194
0075 I**********                              1   1 RECI                  S01194
0076 I**********                              2   30RECT                  S01194
0077 I**********                             12  130RCDE                  S01194
0078 I**********                             14  66 TITL                  S01194
0079 I***********                            67  67 DATF                  S01194
0080 I***********                            68  700DFBR                  S01194
0081 I**********                             74  74 MODI1                 S01194
0082 I**********                             75  75 MODI2                 S01194
0083 I**********                             76  76 MODI3                 S01194
0084 I***********                         P  77  790RUND                  S01194
0085 I***********                            80  86 RUNA                  S01194
0086 I**********                             87  870SFLG                  S01194
0087 I**********                          P  90  920LCD                   S01194
0088 I**********                             93  93 CHTP                  S01194
0089 I**********                          P  94  960TNLU                  S01194
0090 I**********                                                          S01194
0091 I*****CATCH ALL                                                      S01194
0092 I**********                                                          S01194
0093 I********NS                                                          S01194
     I*                                                                   S01194
     ISDBANK    E DSSDBANKPD                                              S01194
      ** BANK DETAILS                                                     S01194
     I              BJURPT                          TITL                  S01194
     I              BJMRDT                          RUNA                  S01194
     I              BJDFIN                          DATF                  S01194
     I*
     ISDBRCH    E DSSDBRCHPD                                              S01117
      **  EXTERNAL DS FOR BRANCH CODE DETAILS                             S01117
     I              A8CMCD                          CMPYM                 S01117
     I*
     IDSFDY     E DSDSFDY                                                 S01194
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01194
0094 I*                                                                   LE0652
0095 I*    LDA - DIAGNOSTIC FOR PROGRAM ABORT                             LE0652
0096 I*                                                                   LE0652
0097 ILDA        UDS                            256                       LE0652
0098 I***********                           134 138 DBFILE                S01117
0099 I***********                           139 167 DBKEY                 S01117
0100 I***********                           168 175 DBPGM                 S01117
0101 I***********                           176 1770DBASE                 S01117
0098 I                                      134 141 DBFILE                S01117
0099 I                                      142 170 DBKEY                 S01117
0100 I                                      171 180 DBPGM                 S01117
0101 I                                      181 1830DBASE                 S01117
     I/EJECT                                                              S01117
      *                                                                                       CGL029
     IDSSDY     E DSDSSDY                                                                     CGL029
      *                                                                                       CGL029
     C                     MOVEACPY@      BIS@   80
0102 C********************************************************************LE0652
0103 C**      FIRST CYCLE PROCESSING                                      LE0652
0104 C**                                                                  LE0652
0105 C   40                GOTO DETAIL                                    LE0652
0106 C                     SETON                     40                   LE0652
0107 C                     MOVE 'LE0652'  DBPGM                           LE0652
     C*    DEFINE LDA                                                     S01117
     C           *NAMVAR   DEFN           LDA                             S01117
0108 C**                                                                  LE0652
0109 C                     EXSR ZSYSTM                                    LE0652
0110 C   99                SETON                     U7U8  **DATABASE 01**LE0652
0111 C   99                Z-ADD1         DBASE                           LE0652
0112 C***99*******         MOVE ZTABKY    DBKEY                           S01194
0113 C***99******          MOVE 'TABLE'   DBFILE                          S01194
0113 C   99                MOVE 'SDBANKPD'DBFILE                          S01194
0114 C   99                GOTO END                                       LE0652
0115 C**                                                                  LE0652
0116 C*****COMMENCE*COUNT*OF*RECORDS*OUTPUT*TO*FILE**                     S01117
0117 C*********************Z-ADD1         COUNT2  50                      S01117
0118 C**********************************                                  S01117
0119 C           DETAIL    TAG                             **DETAIL TAG** LE0652
0120 C**                                                                  LE0652
0121 C**    MAINTAIN COUNT OF ALL RECORDS                                 LE0652
0122 C           COUNT1    ADD  1         COUNT1  50                      LE0652
0123 C  N02N03             GOTO END                                       LE0652
0124 C**                                                                  LE0652
0125 C**   MAINTAIN HASH TOTALS - DETAIL RECORDS                          LE0652
0126 C                     Z-ADDHSHWN1    ZZTOTI                          LE0652
0127 C                     Z-ADDHSHDC1    ZZTOTD                          LE0652
0128 C**                                                                  LE0652
0129 C**   IF AMOUNT IS NEGATIVE,REVERSE SIGN                             LE0652
0130 C           EAMT      DIV  1000      ZZAMT        41                 LE0652
0131 C   41                Z-SUBZZAMT     ZZAMT                           LE0652
0132 C                     EXSR GLZADD                                    LE0652
0133 C                     Z-ADDZZTOTI    HSHWN1 150                      LE0652
0134 C                     Z-ADDZZTOTD    HSHDC1  30                      LE0652
0135 C**                                                                  LE0652
0136 C**   COMM.FEE ACCRUAL RECORDS REQUIRED ONLY                         LE0652
0137 C  N02                GOTO END                                       LE0652
0138 C**                                                                  LE0652
0139 C**   MAINTAIN RECORD COUNT & HASH TOTALS FOR OUTPUT FILE            LE0652
0140 C           COUNT2    ADD  1         COUNT2                          LE0652
0141 C                     Z-ADDHSHWN2    ZZTOTI                          LE0652
0142 C                     Z-ADDHSHDC2    ZZTOTD                          LE0652
0143 C**                                                                  LE0652
0144 C**   IF AMOUNT IS NEGATIVE,REVERSE SIGN                             LE0652
0145 C           EAMT      DIV  1000      ZZAMT        41                 LE0652
0146 C   41                Z-SUBZZAMT     ZZAMT                           LE0652
0147 C                     EXSR GLZADD                                    LE0652
0148 C                     Z-ADDZZTOTI    HSHWN2 150                      LE0652
0149 C                     Z-ADDZZTOTD    HSHDC2  30                      LE0652
     C**                                                                  S01117
     C** To get COMPANY CODE(ie CMPYM):                                   S01117
     C**                                                                  S01117
     C**********           CALL 'AOBRCHR0'                                S01117              CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       S01117
     C                     PARM '*KEY   ' @OPTN   7                       S01117
     C                     PARM BRCA      @DSNB   3                       S01117
     C********** SDBRCH    PARM SDBRCH    DSFDY                           S01117              CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANKS                                   S01117
     C                     MOVEL@DSNB     DBKEY                           S01117
     C                     MOVEL'SDBRCHPD'DBFILE           ************   S01117
     C                     Z-ADD02        DBASE            * DBASE 02 *   S01117
     C                     MOVEL@OPTN     DBOPTN  7        ************   S01117
     C                     SETON                     U7U8LR               S01117
     C                     GOTO END                                       S01117
     C                     END                                            S01117
0150 C**                                                                  LE0652
0151 C           END       TAG                             **END TAG**    LE0652
0152 C   U7                SETON                     LR                   LE0652
0153 C**                                                                  LE0652
0154 C**   LAST RECORD PROCESSING                                         LE0652
     C*                                                                   S01117
     C**   GET HEADING IF NOT ALREADY OBTAINED IN FIRST CYCLE CALCS.      S01117
     C*                                                                   S01117
0109 CLRN40                EXSR ZSYSTM                                    S01117
0107 CLR 99                MOVE 'LE0652'  DBPGM                           S01117
0110 CLR 99                SETON                     U7U8  **DATABASE 03**S01117
0111 CLR 99                Z-ADD3         DBASE                           S01117
0112 C*LR*99********       MOVE ZTABKY    DBKEY                           S01194
0113 C*LR*99********       MOVE 'TABLE'   DBFILE                          S01194
0113 CLR 99                MOVE 'SDBANKPD'DBFILE                          S01194
     C*                                                                   S01117
0155 CLRNU8      NORE      COMP COUNT1               U8U8                 LE0652
0156 CLRNU8      VLAF      COMP HSHWN1               U8U8                 LE0652
0157 CLRNU8      VLAL      COMP HSHDC1               U8U8                 LE0652
0158 C******LR         COUNT2    ADD  1         COUNT2                    S01117
0158 CLR         COUNT2    ADD  2         COUNT2  50                      S01117
     C*                                                                   S01117
     CLR U7 U8             EXSR *PSSR                                     S01117
     C*                                                                   S01117
0159 C********************************************************************LE0652
0160 C/SPACE 3                                                            LE0652
0161 C********************************************************************LE0652
0162 C* SUBROUTINE TO ADD AN AMOUNT (ZZAMT) TO THE TOTAL (ZZTOTI,ZZTOTD)  LE0652
0163 C*   IND '99' IS SET BY AN OVERFLOW ERROR                            LE0652
0164 C*                                                                   LE0652
0165 CSR         GLZADD    BEGSR                           *** GLZADD ****LE0652
0166 C*                                                                   LE0652
0167 CSR                   Z-ADDZZAMT     ZZAMT  153     91-DEFINE ZZAMT  LE0652
0168 CSR 91                GOTO ZZAEND                     AMT = 0.BYPASS LE0652
0169 C*                                                                   LE0652
0170 C* SPLIT ZZAMT INTO INTEGER AND DECIMAL FIELDS                       LE0652
0171 CSR                   Z-ADDZZAMT     ZZAMTI 150       INTEGER FIELD  LE0652
0172 CSR                   MOVE ZZAMT     ZZAMTD  30       DECIMAL FIELD  LE0652
0173 C* BOTH ZZAMTI AND ZZAMTD CONTAIN A 'SIGN' ZONE NOW                  LE0652
0174 C*                                                                   LE0652
0175 CSR                   EXSR GLZSUM                                    LE0652
0176 CSR         ZZAEND    ENDSR                           ** ZZAEND TAG *LE0652
0177 C*                                                                   LE0652
0178 C********************************************************************LE0652
0179 C********************************************************************LE0652
0180 C* SUBROUTINE TO CARRY OUT THE ADDITION FOR SUBROUTINES -            LE0652
0181 C*                        GLZADD, GLZSUB, GLZCMP.                    LE0652
0182 C*          PARAMETERS PASSED -                                      LE0652
0183 C*                     I/P ZZAMTI ZZAMTD                             LE0652
0184 C*                     O/P ZZTOTI ZZTOTD ZZNEGD IND 96 IND 99.       LE0652
0185 C*                                                                   LE0652
0186 CSR         GLZSUM    BEGSR                           *** GLZSUM ****LE0652
0187 C*                                                                   LE0652
0188 CSR                   Z-ADDZZTOTI    ZZTOTI 150       DEFINE ZZTOTI  LE0652
0189 CSR                   Z-ADDZZTOTD    ZZTOTD  30       DEFINE ZZTOTD  LE0652
0190 CSR                   SETOF                     919293               LE0652
0191 CSR                   SETOF                     949599               LE0652
0192 C*                                                                   LE0652
0193 C*    DETERMINE SIGN OF ZZAMTI & D,   92 IF NEG                      LE0652
0194 CSR         ZZAMTI    COMP 0                      9293               LE0652
0195 CSR 93      ZZAMTD    COMP 0                      9293               LE0652
0196 CSR 93                GOTO ZZSEND                     ZERO BYPASS    LE0652
0197 C*                                                                   LE0652
0198 C*    DETERMINE SIGN OF ZZTOTI & D, 91 IF NEG.                       LE0652
0199 CSR         ZZTOTI    COMP 0                      9193               LE0652
0200 CSR 93      ZZTOTD    COMP 0                      9193               LE0652
0201 C*                                                                   LE0652
0202 C*    IF ZZTOTAL IS ZERO, RETURN ZZAMOUNT.                           LE0652
0203 CSR 93                Z-ADDZZAMTI    ZZTOTI                          LE0652
0204 CSR 93                Z-ADDZZAMTD    ZZTOTD                          LE0652
0205 CSR 93                GOTO ZZSEND                     ZERO BYPASS    LE0652
0206 C*    IF SIGNS DIFFER BYPASS OVERFLOW CHECKS.                        LE0652
0207 CSR 91N92                                                            LE0652
0208 CORN91 92             GOTO ZZOFPS                                    LE0652
0209 C*                                                                   LE0652
0210 CSR         ZZAMTD    ADD  ZZTOTD    ZZWK2   40                      LE0652
0211 CSR         ZZWK2     COMP 999                  93    '93' = CARRY   LE0652
0212 CSRN93      ZZWK2     COMP -999                   93    INTO INTEGER.LE0652
0213 C*                                                                   LE0652
0214 CSR 93N92   ZZAMTI    ADD  1         ZZWK3  150       ADD 'CARRY' +VELE0652
0215 CSR    93 92ZZAMTI    SUB  1         ZZWK3            SUB 'CARRY' -VELE0652
0216 CSR 93      ZZTOTI    ADD  ZZWK3     ZZWK3                           LE0652
0217 CSRN93      ZZTOTI    ADD  ZZAMTI    ZZWK3                           LE0652
0218 C*                                                                   LE0652
0219 C* IF THE MODULUS OF ZZWK3 IS LT MOD. ZZTOTI THEN O/F HAS OCCURED    LE0652
0220 CSRN92      ZZWK3     COMP ZZTOTI                 99  -92 MEANS NOS. LE0652
0221 CSR 92      ZZWK3     COMP ZZTOTI               99     NEGATIVE      LE0652
0222 CSRN99                Z-ADDZZWK2     ZZTOTD                          LE0652
0223 CSRN99                Z-ADDZZWK3     ZZTOTI                          LE0652
0224 C*                                                                   LE0652
0225 C* IF O/F ZEROIZE ZZAMT , IND '99' SET AND ZZTOT FIELDS LEFT INTACT. LE0652
0226 CSR 99                Z-ADD0         ZZAMT  153                      LE0652
0227 CSR                   GOTO ZZSEND                                    LE0652
0228 C*                                                                   LE0652
0229 C* THE 'SIGNS' ARE DIFFERENT                                         LE0652
0230 CSR         ZZOFPS    TAG                             ** ZZOFPS TAG**LE0652
0231 C* IF ZZAMT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZTOT            LE0652
0232 C*                                                                   LE0652
0233 CSR 92                Z-SUBZZAMTI    ZZAMTI 150                      LE0652
0234 CSR 92                Z-SUBZZAMTD    ZZAMTD  30                      LE0652
0235 C*                                                                   LE0652
0236 C* IF ZZTOT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZAMT.           LE0652
0237 C*                                                                   LE0652
0238 CSR 91                Z-SUBZZTOTI    ZZTOTI                          LE0652
0239 CSR 91                Z-SUBZZTOTD    ZZTOTD                          LE0652
0240 C* BOTH ZZAMT AND ZZTOT ARE NOW POSITIVE.                            LE0652
0241 C*                                                                   LE0652
0242 CSR         ZZTOTI    COMP ZZAMTI               93  95               LE0652
0243 CSR 95      ZZTOTD    COMP ZZAMTD               93  95               LE0652
0244 C*                                                                   LE0652
0245 C* IF ZZTOT EQ. ZZAMT RETURN ZERO.                                   LE0652
0246 CSR 95                Z-ADD0         ZZTOTI                          LE0652
0247 CSR 95                Z-ADD0         ZZTOTD                          LE0652
0248 CSR 95                GOTO ZZSEND                                    LE0652
0249 C*                                                                   LE0652
0250 C* IF ZZTOT GT. ZZAMT.                                               LE0652
0251 CSR 93      ZZAMTD    COMP ZZTOTD               94                   LE0652
0252 CSR 93 94   ZZTOTI    SUB  1         ZZTOTI                          LE0652
0253 CSR 93 94   ZZTOTD    ADD  1000      ZZWK2                           LE0652
0254 CSR 93      ZZTOTI    SUB  ZZAMTI    ZZTOTI                          LE0652
0255 CSR 93 94   ZZWK2     SUB  ZZAMTD    ZZTOTD                          LE0652
0256 CSR 93N94   ZZTOTD    SUB  ZZAMTD    ZZTOTD                          LE0652
0257 C*                                                                   LE0652
0258 C*                                                                   LE0652
0259 C* IF ZZAMT GT. ZZTOT.                                               LE0652
0260 CSRN93      ZZTOTD    COMP ZZAMTD               94                   LE0652
0261 CSRN93 94   ZZAMTI    SUB  1         ZZWK3  150                      LE0652
0262 CSRN93 94   ZZAMTD    ADD  1000      ZZWK2                           LE0652
0263 CSRN93 94   ZZWK3     SUB  ZZTOTI    ZZTOTI                          LE0652
0264 CSRN93N94   ZZAMTI    SUB  ZZTOTI    ZZTOTI                          LE0652
0265 CSRN93 94   ZZWK2     SUB  ZZTOTD    ZZTOTD                          LE0652
0266 CSRN93N94   ZZAMTD    SUB  ZZTOTD    ZZTOTD                          LE0652
0267 C*                                                                   LE0652
0268 C* REVERSE SIGN OF ZZTOT IF LARGER I/P FIELDS WERE NEGATIVE          LE0652
0269 CSR                   SETOF                     94                   LE0652
0270 CSR 93 91                                                            LE0652
0271 CORN93 92             SETON                     94                   LE0652
0272 CSR 94                Z-SUBZZTOTI    ZZTOTI                          LE0652
0273 CSR 94                Z-SUBZZTOTD    ZZTOTD                          LE0652
0274 C**                                                                  LE0652
0275 C**   RESTORE SIGN OF ZZAMTI & ZZAMTD IF IT WAS REVERSED.            LE0652
0276 CSR 92                Z-SUBZZAMTI    ZZAMTI                          LE0652
0277 CSR 92                Z-SUBZZAMTD    ZZAMTD                          LE0652
0278 CSR         ZZSEND    TAG                             ** ZZSEND TAG *LE0652
0279 C**                                                                  LE0652
0280 C**   IF ZZTOTD IS ZERO, AND ZZTOTI IS NEG. SET UP ZZNEGD.           LE0652
0281 CSR                   SETOF                     96                   LE0652
0282 CSR         ZZTOTD    COMP 0                        91               LE0652
0283 CSR 91      ZZTOTI    COMP 0                      96                 LE0652
0284 CSR 96                MOVE '.000-'   ZZNEGD  5                       LE0652
0285 CSR                   ENDSR                             ** ENDSR **  LE0652
0286 C********************************************************************LE0652
0287 C********************************************************************LE0652
0288 C**                                                                  LE0652
0289 C**   ZSYSTM SR. TO CHAIN TO THE INSTALLATION CONTROL DATA RECORD.   LE0652
0290 C**                                                                  LE0652
0291 C           ZSYSTM    BEGSR                           *** ZSYSTM *** LE0652
0292 C**                                                                  LE0652
0293 C*****SET*UP*KEY*FOR*INSTALLATION CONTROL RECORD.                    S01194
0294 C***********          MOVEL'01      'ZTABKY 12                       S01194
0295 C***********          MOVE '  10'    ZTABKY                          S01194
0296 C**                                                                  S01194
0297 C***********ZTABKY    CHAINTABLE                99    ON NOT THERE   S01194
0298 C**N99******RECI**    COMP 'D'                  9999  ON, IS DELETED S01194
0299 C**                                                                  S01194
      *                                                                   S01194
      ** ACCESS BANK DETAILS                                              S01194
     C                     CALL 'AOBANKR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDBANK    PARM SDBANK    DSFDY                           S01194
     C           @RTCD     IFNE *BLANKS                                   S01194
     C                     SETON                     99                   S01194
     C                     END                                            S01194
0300 C**   CHECK SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.                    LE0652
0301 C           DATF      COMP 'M'                      98MMDDYY, 98 ON  LE0652
0302 C**                                                                  LE0652
0303 C                     ENDSR                                          LE0652
0304 C**                                                                  LE0652
0305 C**                                                                  LE0652
0306 C********************************************************************LE0652
     C/SPACE 3                                                            S01117
     C********************************************************************S01117
     C*                                                                   S01117
     C*  *PSSR --- SUBROUTINE TO HANDLE ABNORMAL ERROR CONDITIONS         S01117
     C*                                                                   S01117
     C*  CALLED FROM: AFTER ABNORMAL OPERATION OCCURS                     S01117
     C*                                                                   S01117
     C*  CALLS: NOTHING                                                   S01117
     C*                                                                   S01117
     C********************************************************************S01117
     C*                                                                   S01117
     C           *PSSR     BEGSR                           ** *PSSR **    S01117
     C*                                                                   S01117
     C           @RUN      IFEQ *BLANKS                                   S01117
     C                     MOVE 'Y'       @RUN    1                       S01117
     C                     DUMP                                           S01117
     C                     END                                            S01117
     C                     ENDSR                           ** *PSSR **    S01117
     C*                                                                   S01117
     C********************************************************************S01117
     C/EJECT                                                              S01117
0307 O****CFACXHH D        01                                             S01117
0307 OCFACXHH T        LR                                                 S01117
0308 O                                    1 'H'                           LE0652
0309 OCFACXDP D        02                                                 LE0652
0310 O**********               LOTL     128                                            LE0652 CGL029
     O*************************LOTL     154                                            CGL029 CLE042
     O                         LOTL     168                                                   CLE042
0310 O                         CMPYM    131                               S01117
0311 OCFACXZZ T        LR                                                 LE0652
0312 O                                    1 'T'                           LE0652
0313 O                         COUNT2     4P                              LE0652
0314 O                         HSHWN2    12P                              LE0652
0315 O                         HSHDC2    14P                              LE0652
0316 O**                                                                  LE0652
0317 O**   RUN CONTROL REPORT                                             LE0652
0318 O**                                                                  LE0652
0319 O*E0652P1T** 03   LR                                         S01124  S01117
0319 OLE0652AUT   03   LR                                                 S01117
0320 O***********                        22 'REFERENCE  LE0652'           S01117
0320 O                                   24 'REFERENCE  LE0652AU'         S01117
0321 O                         TITL      89                               LE0652
0322 O                                  104 'DATE'                        LE0652
0323 O                         RUNA     112                               LE0652
0324 O                                  127 'PAGE    1'                   LE0652
0325 O        T   05   LR                                                 LE0652
0326 O                                   62 'COMMITMENT FEE ACCRUAL'      LE0652
0327 O                                   86 'EXTRACT - FILE CONTROLS'     LE0652
0328 O        T   06   LR                                                 LE0652
0329 O                                   62 '----------------------'      LE0652
0330 O                                   86 '------------------------'    LE0652
0331 O        T   09   LR                                                 LE0652
0332 O                                   28 'S/CFACX - RUN CONTROLS'      LE0652
0333 O                                   59 'NUMBER'                      LE0652
0334 O                                   84 'VALUE'                       LE0652
0335 O        T   10   LR                                                 LE0652
0336 O                                   28 '----------------------'      LE0652
0337 O                                   59 'OF RECORDS'                  LE0652
0338 O                                   84 'OF RECORDS'                  LE0652
0339 O        T   12   LR                                                 LE0652
0340 O                                   29 'TOTAL RECORDS ON FILE'       LE0652
0341 O                         COUNT23   59                               LE0652
0342 O                         HSHWN24   81                               LE0652
0343 O                         HSHDC2    84                               LE0652
0344 O        T   15   LR                                                 LE0652
0345 O                                   28 'S/LKEY2 - RUN CONTROLS'      LE0652
0346 O        T   16   LR                                                 LE0652
0347 O                                   28 '----------------------'      LE0652
0348 O        T   18   LR                                                 LE0652
0349 O                                   29 'TOTAL RECORDS ON FILE'       LE0652
0350 O                      NU7NORE  3   59                               LE0652
0351 O                      NU7VLAF  4   81                               LE0652
0352 O                      NU7VLAL      84                               LE0652
0353 O        T   20   LR                                                 LE0652
0354 O                                   29 'TOTAL RECORDS ON FILE'       LE0652
0355 O                                   42 '- CALCULATED'                LE0652
0356 O                         COUNT13   59                               LE0652
0357 O                         HSHWN14   81                               LE0652
0358 O                         HSHDC1    84                               LE0652
0359 O                    U8NU7         111 '***   DIFFERENCE   ***'      LE0652
0360 O        T 32     LR U7                                              LE0652
0361 O                                   51 '*** REFERENCE LE0652'        LE0652
0362 O***********                        71 '- DATABASE ERROR AT'         S01117
0363 O***********              DBASE     74                               S01117
0362 O                                   71 'DATABASE ERROR AT'           S01117
0363 O                         DBASE     75                               S01117
0364 O        T        LR U7                                              LE0652
0365 O***********                        37 'FILENAME'                    S01117
0366 O***********              DBFILE    43                               S01117
0367 O***********                        48 'KEY'                         S01117
0368 O***********              DBKEY     78                               S01117
0365 O                                   39 'FILENAME'                    S01117
0366 O                         DBFILE    48                               S01117
0367 O                                   52 'KEY'                         S01117
0368 O                         DBKEY     82                               S01117
0369 O********T*3      LR                                                 S01117
0370 O***********                        76 '*** END OF REPORT ***'       S01117
** CPY@   **      OBJECT COPYRIGHT
(c) Finastra International Limited 2001
