     H        1                                                           S01117
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas Commitment Fees Accrual Report')                 *
0001 H***********                                                         S01117
0002 F********************************************************************
0003 F*                                                                  *
     F*              Midas Customer Lending Module               *
0005 F*                                                                  *
0006 F*        LE0660 - COMM.FEE ACCRUALS REPORT                         *
0007 F*                                                                  *
      *  (c) Finastra International Limited 2001                      *
0009 F*                                                                  *
      *  Last Amend No. CSD103             Date 10Aug20               *
      *  Prev Amend No. MD046248           Date 27Oct17               *
      *                 CLE134             Date 01Aug12               *
      *                 CLE148             Date 23Jul12               *
      *                 CER059             Date 19Jul10               *
      *                 CER043             Date 19May08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CSD031             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 CLE042             Date 06Sep05               *
      *                 CSW037A            Date 02May05               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 CLE025             Date 20Oct03               *
      *                 CGL029             Date 01Sep03               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 072934             Date 06Jul94               *
     F*                 E51633             Date 17Mar93                  *
     F*                       S01270            DATE  02NOV92            *
     F*                       BHF792            DATE 09OCT90             *
     F*                       BHF739            DATE 04OCT90             *
     F*                       S01194            DATE 10JAN90             *
     F*                       S01117            DATE 29/09/89            *
     F*                       E47264            DATE 27/05/87            *
     F*                       E10036            DATE 12/01/87            *
     F*                                                                  *
     F*------------------------------------------------------------------*
     F*                                                                  *
      *  CSD103 - LIBOR Deregulation - Common Layer/Standing Data     *
      *  MD046248 - Finastra Rebranding                               *
      *  CLE134 - Past Due Call Loan Processing (Recompile)           *
      *  CLE148 - Alpha Loan Reference (Recompile)                    *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  CER043 - German Features LF041-00 New Fields and Defaulting  *
      *           (Recompile)                                         *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CLE042 - Extended Loan Sub Type                              *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  CLE025 - Credit Lines (Recompile)                            *
      *  CGL029 - Increase Account Code to 10 digits                  *
     F*        072934 - CHECK FOR ENTITY EQUAL TO '   ' AND PROCESS AS   *
     F*                 FOR ENTITY = 'ALL'                               *
     F*        E51633 - THIS PROGRAM IS NOT REDUNDANT FROM REL 10.3.22   *
     F*        S01270 - THIS PROGRAM IS REDUNDANT FROM REL 10.3.22       *
     F*        BHF792 - DO NOT HAVE A DATABASE ERROR IF CURRENCY FOUND   *
     F*        BHF739 - FIELDS REDEFINITION FOR SDCURRPD SHOULD TAKE     *
     F*               - PLACE IN FILE I SPECS NOT DATA STRUCTURE ONES    *
     F*        S01194 - STANDING DATA CHANGES                            *S01194
     F*        S01117 - MULTIBRANCHING CHANGES                           *S01117
     F*        E47264 - FROM DATE IS TO BE GREATER OF START/LAST         *E47264
     F*                 COMMITMENT FEE DUE DATE AND PREVIOUS ACCRUAL     *E47264
     F*                 DATE ON LKEY2.                                   *E47264
     F*        E10036 - THE WRONG 'FROM' DATE IS SOMETIMES USED          *E10036
     F*                 AT CHANGE OF FACILITY IN THE COMMITMENT          *E10036
     F*                 FEE ACCRUAL REPORT.                              *E10036
     F*                                                                  *
0012 F********************************************************************
     F*                                                               *
     F*****************************************************************
0013 F*FACS***IP* F     128 17AI    13 DISK                               S01117
0013 F***CFACS** IP  F     131 17AI    13 DISK                                         S01117 CGL029
     F*CFACS***IP**F*****154 17AI    13 DISK                                           CGL029 CLE042
     FCFACS   IP  F     168 17AI    13 DISK                                                   CLE042
0014 F*ABLE***IF* F      96 12AI     2 DISK                               S01194
0015 F*ABLED**IF* F      96 12AI     2 DISK                               S01194
0016 F*LINT***IF* F     256  7AI     2 DISK                               S01194
     FSDCURRPDIF  E                    DISK                               S01194
0016 FFCLTY   IF  F     256 12AI     2 DISK                               E47264
0017 F*E0660P1O** F     132     OF     PRINTER                   S01124   S01117
0017 FLE0660P1O   F     132     OF     PRINTER      KINFDS SPOOL      UC  S01117
0017 FLE0660AUO   F     132     OV     PRINTER      KINFDS SPOOLU         S01117
0011 F*                                                                  *
0018 F* ID F  C  H  L    FUNCTION OF INDICATORS
0019 F* 01            S/CFACS - DETAIL RECORD
0020 F* 02                    -TRAILER RECORD
0021 F**07**********  S/TABLE - FACILITY TYPE RECORD                      S01194
0022 F**10**********  S/CLINT - DETAIL RECORD 'A'                         S01194
0023 F*    21         EVENT DATE NON-ZERO
0024 F*    22         PREVIOUS ACCRUAL CONTROL DATE NON-ZERO
0025 F*       40      CONTROLS FIRST CYCLE PROCESSING
0026 F*       41      GENERAL PURPOSE
0027 F*       42      EMPTY PRIMARY FILE
     F*       50      1ST MONTH END FEE POSTING NOT DONE                  E47264
0028 F********55****  CHAIN FAIL                                          S01194
     F*       58      ALLOW OUTPUT FOR EACH BRANCH                        S01117
0029 F*       60      CURRENCY DECIMAL PLACES - 0
0030 F*       61                              - 1
0031 F*       62                              - 2
0032 F*       63                              - 3
     F*       75      P1 FILE HAS BEEN OPENED                             S01117
     F*       77      NO DETAIL TO REPORT                                 S01117
     F*       88      MBIN = 'Y'                                          S01117
     F*       89      BRNCH = 'ALL'                                       S01117
0033 F*             L1LEVEL BREAK - CUSTOMER
0034 F*             L2            - FACILITY TYPE
0035 F*             L3            - CURRENCY
0036 F*             L4            - BRANCH
0037 F*             U7DATABASE ERROR
0038 F*             U8DATABASE ERROR/FILE CONTROLS OUT OF BALANCE
0039 E                    XCYA      150  3               CURRENCIES
0040 E                    XDPA      150  1 0             DEC. PLACES
0041 E                    XNME      150 14
0042 E                    UDR1       30  1               SRUNDR SR.ARRAY
0043 E                    UDR2   30  30  1               SRUNDR SR.ARRAY
0044 E                    ZYDY    4   4  4 0             ZDATE1/2 SR.ARRAY
0045 E                    ZMDY   13  13  3 0             ZDATE1/2 SR.ARRAY
     E                    CPY@    1   1 80
0046 E                    ZMNM   12  12  3               ZDATE2 SR. ARRAY
0047 I*
0048 I*    ACCOUNT KEYS FILE - DETAIL RECORD
0049 I*
0050 ICFACS   NS  01   1 CF
0051 I                                        1   1 RECI
0052 I****************************************2  11 AKEY                                      CLE042
0053 I                                       13  150FTYP  L2
0054 I                                       16  170FCNO
     I                                       13  170FTFC
0055 I**********                             18  230CNUM  L1                                  CSD027
0055 I                                       18  23 CNUM  L1                                  CSD027
0056 I****                                   24  260BRCD  L4              S01117
0056 I                                       24  26 BRCA  L4              S01117
0057 I                                       27  280ACSQ
0058 I                                    P  29  310EDAT        21
0059 I                                    P  32  380EAMT
0060 I                                       39  41 ECCY  L3
0061 I                                       42  430SETP
0062 I**********                             44  45 OSAC                                      CGL029
     I                                       44  45 OSACQQ                                    CGL029
0063 I                                       56  560REVI
0064 I                                    P  57  630OTHA
0065 I                                       64  66 OTHC
0066 I                                    P  67  738EXRT
0067 I                                    P  74  760VDAT
0068 I                                    P  77  790SLID
0069 I                                    P  80  820MDAT
0070 I**********                             83  840BRTT                                      CSD103
0070 I                                       83  84 BRTT                                      CSD103
0071 I                                    P  85  907BRTE
0072 I                                    P  91  967RTSP
0073 I                                    P  97 1027INTR
0074 I                                      103 1030SSEQ
0075 I                                    P 104 1100CPAM
0076 I                                    P 111 1130PACD        22
0077 I                                      114 114 CFTP
0078 I                                    P 115 1210FAMT
     I                                    P 122 1240PELAP                 E47264
     I                                      137 154 OSAC                                      CGL029
     I                                      155 168 AKEY                                      CLE042
0079 I*
0080 I*    ACCOUNT KEYS FILE - TRAILER RECORD
0081 I*
0082 I        NS  02   1 CT
0083 I                                    P   2   40NORE
0084 I                                    P   5  120VLRF
0085 I                                    P  13  140VLRL
0086 I*
0087 I*    CATCH ALL
0088 I*
0089 I        NS
     I**  LOOK AHEAD USED TO SEE IF NEXT RECORD IS A C/FEE ACCRUAL RECORD
     I**  FOR THE SAME FACILTY/CUSTOMER AS IS CURRENTLY BEING PROCESSED
     F**  THE FACILITY AND DRAWN AMOUNTS ARE ONLY ADDED INTO THE TOTALS
     F**  THE NEXT RECORD ON S/CFACS IS FOR A DIFFERENT FACILITY/CUSTOM
     I        NS  **
     I                                        1   1 RECILA
     I                                       13  170FTFCLA
     I**********                             18  230CNUMLA                                    CSD027
     I                                       18  23 CNUMLA                                    CSD027
0090 I**********                                                          S01194
0091 I*****TABLE FILE - INSTALLATION CONTROL DATA RECORD 1.               S01194
0092 I**********                                                          S01194
0093 I*ABLE***NS       2 C0   3 C1  12 C1                                 S01194
0094 I*******AND      13 C0                                               S01194
0095 I**********                              1   1 RECI                  S01194
0096 I**********                              2   30RECT                  S01194
0097 I**********                             12  130RCDE                  S01194
0098 I**********                             14  66 TITL                  S01194
0099 I***********                            67  67 DATF                  S01194
0100 I**********                             68  700DFBR                  S01194
0101 I**********                             74  74 MODI1                 S01194
0102 I**********                             75  75 MODI2                 S01194
0103 I**********                             76  76 MODI3                 S01194
0104 I***********                         P  77  790RUND                  S01194
0105 I***********                            80  86 RUNA                  S01194
0106 I**********                             87  870SFLG                  S01194
0107 I**********                          P  90  920LCD                   S01194
0108 I**********                             93  93 CHTP                  S01194
0109 I**********                          P  94  960TNLU                  S01194
0110 I**********                                                          S01194
0111 I*****TABLE FILE - FACILITY TYPES RECORD.                            S01194
0112 I**********                                                          S01194
0113 I*ABLE***NS* 07   1 CD   2 C4   3 C6                                 S01194
0114 I**********                              1   1 RECI                  S01194
0115 I**********                              2   30RECT                  S01194
0116 I**********                             11  130FACT                  S01194
0117 I**********                             14  43 FACN                  S01194
0118 I**********                          P  90  920LCD                   S01194
0119 I**********                             93  93 CHTP                  S01194
0120 I**********                          P  94  960TNLU                  S01194
0121 I**********                                                          S01194
0122 I****CATCH ALL                                                       S01194
0123 I**********                                                          S01194
0124 I********NS                                                          S01194
0125 I**********                                                          S01194
0126 I*****TABLE FILE - CURRENCIES RECORD 1.                              S01194
0127 I**********                                                          S01194
0128 I*ABLED**NS       2 C2   3 C0                                        S01194
0129 I**********                              1   1 RECI                  S01194
0130 I**********                              2   30RECT                  S01194
0131 I**********                             10  12 CCY                   S01194
0132 I**********                             13  130SREC                  S01194
0133 I**********                             14  27 CCNM                  S01194
0134 I**********                          P  28  348SPOT                  S01194
0135 I**********                             35  37 CCYS                  S01194
0136 I**********                             38  380CDP                   S01194
0137 I**********                             39  390TNOT                  S01194
0138 I**********                             40  40 DCCY                  S01194
0139 I**********                             41  44 SRC1                  S01194
0140 I**********                             45  48 SRC2                  S01194
0141 I**********                             49  520TACC                  S01194
0142 I**********                             53  560TEQV                  S01194
0143 I**********                             57  600SWQV                  S01194
0144 I**********                             61  640TAC4                  S01194
0145 I**********                             65  680TAC5                  S01194
0146 I**********                             69  69 HIND                  S01194
0147 I**********                          P  70  768PART                  S01194
0148 I**********                             77  780SSNO                  S01194
0149 I**********                          P  79  858ERLC                  S01194
0150 I**********                             86  860MDIN                  S01194
0151 I**********                             87  870MDIA                  S01194
0152 I**********                             88  880MDIB                  S01194
0153 I**********                          P  90  920LCD                   S01194
0154 I**********                             93  93 CHTP                  S01194
0155 I**********                          P  94  960TNLU                  S01194
0156 I**********                                                          S01194
0157 I*****CATCH ALL                                                      S01194
0158 I**********                                                          S01194
0159 I********NS                                                          S01194
0160 I**********                              2   30RECT                  S01194
0161 I**********                                                          S01194
0162 I*****CLIENT FILE - CUSTOMER STANDING DATA RECORD.                   S01194
0163 I**********                                                          S01194
0164 I*LINT***NS  10   1 CD   8 CA                                        S01194
0165 I**********                              1   1 RECI                  S01194
0166 I**********                              2   70CNUM                  S01194
0167 I**********                              8   8 RCDT                  S01194
0168 I**********                              9  28 CRNM                  S01194
0169 I**********                             29  38 CTWN                  S01194
0170 I**********                             39  48 CSNM                  S01194
0171 I**********                             49  56 CASK                  S01194
0172 I**********                             57  68 TELX                  S01194
0173 I**********                             69  80 CSID                  S01194
0174 I**********                             81  82 ACOC                  S01194
0175 I**********                             83  83 CBSI                  S01194
0176 I**********                             84  85 CCTZ                  S01194
0177 I**********                             86  87 CLOC                  S01194
0178 I**********                             88  930CPAR                  S01194
0179 I**********                                                          S01194
0180 I*****FOLLOWING FIELD RENAMED TO AVOID CONFUSION WITH S/CFACS        S01194
0181 I**********                             94  960BRCDCL                S01194
0182 I**********                                                          S01194
0183 I**********                             97  980LINS                  S01194
0184 I**********                             99 1010LIND                  S01194
0185 I**********                          P 102 1040DASU                  S01194
0186 I**********                          P 105 1070CDIC                  S01194
0187 I**********                          P 108 1100DADE                  S01194
0188 I**********                            111 111 CMIN                  S01194
0189 I**********                            112 112 CTYP                  S01194
0190 I**********                            113 124 TELF                  S01194
0191 I**********                            125 133 CHID                  S01194
0192 I**********                            134 136 CHAB                  S01194
0193 I**********                          P 250 2520LCD                   S01194
0194 I**********                            253 253 CHTP                  S01194
0195 I**********                          P 254 2560TNLU                  S01194
0196 I**********                                                          S01194
0197 I*****CATCH ALL                                                      S01194
0198 I**********                                                          S01194
0199 I********NS                                                          S01194
     I*                                                                   E47264
     I*    FCLTY FILE RECORD TYPE - A                                     E47264
     I*                                                                   E47264
     IFCLTY   NS  11  13 CA                                               E47264
     I                                    P 247 2490ORED                  E47264
     ISDCURRD0                                                            BHF739
     I              A6CYNM                          CCNM                  BHF739
     I              A6NBDP                          CDP                   BHF739
     I              A6CYCD                          CCY                   BHF739
0200 I************                                                        S01194
0200 I************                                                        S01194
0201 I*****DATA*STRUCTURE FOR KEY TO S/TABLE - CURRENCIES                 S01194
0202 I************                                                        S01194
0203 I************DS                                                      S01194
0204 I************                            1  12 CCYKEY                S01194
0205 I************                            9  11 XCCY                  S01194
0206 I************                                                        S01194
0207 I*****DATA*STRUCTURE FOR KEY TO S/TABLE - FACILITY TYPE              S01194
0208 I************                                                        S01194
0209 I************DS                                                      S01194
0210 I**************                          1  12 FTPKEY                S01194
0211 I**************                         10  120FTYP                  S01194
0212 I************                                                        S01194
0213 I*****DATA*STRUCTURE FOR KEY TO S/CLINT                              S01194
0214 I************                                                        S01194
0215 I**********  DS                                                      S01194
0216 I**********                              1   7 CUSKEY                S01194
0217 I**********                              1   60CNUM                  S01194
0218 I*
0219 I*    LDA - DIAGNOSTICS FOR PROGRAM ABORT
0220 I*
0221 ILDA        UDS                            256
0222 I***********                           134 138 DBFILE                S01117
0223 I***********                           139 167 DBKEY                 S01117
0224 I***********                           168 175 DBPGM                 S01117
0225 I***********                           176 1770DBASE                 S01117
     I                                      134 141 DBFILE                S01117
     I                                      142 170 DBKEY                 S01117
     I                                      171 180 DBPGM                 S01117
     I                                      181 1830DBASE                 S01117
     I**                                                                  S01117
     I**   FILE INFORMATION DATA STRUCTURE                                S01117
     I**                                                                  S01117
     ISPOOL       DS                                                      S01117
     I                                       83  92 SFILE                 S01117
     I                                    B 123 1240SFNUM                 S01117
     ISPOOLU      DS                                                      S01117
     I                                       83  92 SFILEU                S01117
     I                                    B 123 1240SFNUMU                S01117
     I**                                                                  S01117
     I** DATA AREA RUNDAT                                                 S01117
     I**                                                                  S01117
     IRUNDT       DS                                                      S01117
     I                                        1   7 RUNA                  S01117
     I                                    P   8  100RUND                  S01117
     I                                       11  11 SSF                   S01117
     I                                       12  12 DATF                  S01117
     I                                       13  13 MBIN                  S01117
     I**                                                                  S01117
      *                                                                   S01117
      *                                                                   S01194
     ISDCUST    E DSSDCUSTPD                                              S01194
      **   CUSTOMER                                                       S01194
     I              BBCRNM                          CRNM                  S01194
      *                                                                   S01194
     ISDBANK    E DSSDBANKPD                                              S01194
      ** BANK DETAILS                                                     S01194
     I              BJURPT                          TITL                  S01194
      *                                                                   S01194
     ISDCURR    E DSSDCURRPD                                              S01194
      **   CURRENCY TYPE                                                  S01194
     I              A6CYNM                          CCNM                  S01194
     I              A6NBDP                          CDP                   S01194
     I              A6CYCD                          CCY                   S01194
      *                                                                   S01194
     ISDBRCH    E DSSDBRCHPD                                              S01117
     I**  EXTERNAL DS FOR BRANCH CODE DETAILS                             S01117
     I              A8BRNM                          BRNM                  S01117
     I              QQDFAC                          QQDFA1                                    CGL029
     ISDFACT    E DSSDFACTPD                                              S01194
     I              AMFCNM                          FACN                  S01194
     IDSFDY     E DSDSFDY                                                 S01194
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01194
     I*                                                                   S01194
     IDSSDY     E DSDSSDY                                                 S01194
     I* SECOND DS FOR ACCESS PROGRAMS, LONG DATA STRUCTURE                S01194
     I**                                                                  S01117
     C                     MOVEACPY@      BIS@   80
0226 C********************************************************************
0227 C**   FIRST CYCLE PROCESSING
0228 C**
0229 C   40                GOTO DETAIL
0230 C                     SETON                     42
0231 C                     MOVE 'LE0660  'DBPGM
     C           PLIST1    PLIST                                          S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C                     PARM           FKEY    3                       S01194
     C           SDFACT    PARM SDFACT    DSFDY                           S01194
     C**                                                                  S01117
     C           PLIST3    PLIST                                          S01194
     C                     PARM '*MSG   ' @RTCD                           S01194
     C                     PARM '*KEY   ' @OPTN                           S01194
     C                     PARM           KEYC   10                       S01194
     C                     PARM           KEYSTS  7                       S01194
     C           SDCUST    PARM SDCUST    DSSDY                           S01194
     C           PLIST2    PLIST                                          S01194
     C                     PARM '*MSG   ' @RTCD                           S01194
     C                     PARM '*KEY   ' @OPTN                           S01194
     C                     PARM           CKEY    3                       S01194
     C           SDCURR    PARM SDCURR    DSSDY                           S01194
     C**                                                                  S01117
     C           *ENTRY    PLIST                                          S01117
     C                     PARM           SEQ     5         SEQUENCE NO.  S01117
     C                     PARM           BRNCH   3         BRANCH OR ALL S01117
     C**    IN THE DATAAREA RUNDAT                                        S01117
     C**                                                                  S01117
     C           *NAMVAR   DEFN RUNDAT    RUNDT                           S01117
     C                     IN   RUNDT                                     S01117
     C*    DEFINE LDA                                                     S01117
     C           *NAMVAR   DEFN           LDA                             S01117
     C           *LOCK     IN   LDA                                       S01117
     C**                                                                  S01117
     C**    TEST FOR MULTIBRANCHING                                       S01117
     C**                                                                  S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C                     SETON                     88                   S01117
     C                     END                                            S01117
0232 C**
0233 C                     EXSR ZSYSTM
0234 C   99                SETON                     U7U8  **DATABASE 01**
0235 C   99                Z-ADD1         DBASE
0236 C***99*****           MOVE ZTABKY    DBKEY                           S01194
0237 C***99*****           MOVE 'TABLE'   DBFILE                          S01194
0237 C   99                MOVE 'SDBANKPD'DBFILE                          S01194
0238 C   99                GOTO END
0239 C***********                                                         S01194
0240 C*****DEFINE KEY FIELDS                                              S01194
0241 C***********          MOVEL'20'      CCYKEY                          S01194
0242 C***********          MOVE '1'       CCYKEY                          S01194
0243 C***********                                                         S01194
0244 C***********          MOVEL'46'      FTPKEY                          S01194
0245 C***********                                                         S01194
0246 C***********          MOVE 'A'       CUSKEY                          S01194
0247 C**
0248 C**   LOAD CURRENCY ARRAYS
0249 C                     EXSR CCYARR
0250 C**
0251 C**   COMMENCE RECORD COUNT
0252 C                     Z-ADD2         NREC    50
0253 C                     SETON                     40
0254 C**********************************
0255 C           DETAIL    TAG                             **DETAIL TAG**
0256 C   02                SETON                     LR
0257 C  N01                GOTO END
0258 C                     SETOF                     42
     C*                                                                   S01117
     C** MULTIBRANCHING MAIN PROCESSING                                   S01117
     C*                                                                   S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C*                                                                   S01117
     C** IF THE REQUIRED BRANCH IS GREATER THAN BRCA,                     S01117
     C** SKIP THE CALCULATION                                             S01117
     C*                                                                   S01117
     C           BRNCH     IFGT BRCA                                      S01117
     C           BRNCH     ANDNE'ALL'                                     S01117
     C           BRNCH     ANDNE'   '                                     072934
     C                     SETOF                     58                   S01117
     C                     GOTO END                                       S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C** IF THE REQUIRED BRANCH IS LESS THAN BRCA                         S01117
     C** END THE PROGRAM                                                  S01117
     C*                                                                   S01117
     C           BRNCH     IFLT BRCA                                      S01117
     C           BRNCH     ANDNE'ALL'                                     S01117
     C           BRNCH     ANDNE'   '                                     072934
     C                     SETON                     LR                   S01117
     C                     SETOF                     58                   S01117
     C                     GOTO END                                       S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C                     END                                            S01117
     C**                                                                  E47264
     C**   ACCESS FCLTY A RECORD                                          E47264
     C                     MOVELCNUM      FCLTP1  9                       E47264
     C                     MOVE FTYP      FCLTP1                          E47264
     C                     MOVELFCNO      FCLTP2  3                       E47264
     C                     MOVE 'A'       FCLTP2                          E47264
     C                     MOVELFCLTP1    FCLKEY 12                       E47264
     C                     MOVE FCLTP2    FCLKEY                          E47264
     C           FCLKEY    CHAINFCLTY                99                   E47264
     C   99                SETON                     U7U8  **DATABASE 06**E47264
     C   99                Z-ADD6         DBASE                           E47264
     C   99                MOVE FCLKEY    DBKEY                           E47264
     C   99                MOVE 'FCLTY'   DBFILE                          E47264
     C   99                GOTO END                                       E47264
     C           ORED      COMP PELAP                50                   E47264
     C**                                                                  S01117
     C**    IF CHANGE OF BRANCH, RETRIEVE NEW BRANCH NAME                 S01117
     C           *INL4     IFEQ '1'                                       S01117
     C                     CLOSELE0660P1                                  S01117
     C           BRNCH     IFEQ 'ALL'                                     S01117
     C           BRNCH     OREQ '   '                                     072934
     C** If Branch Report                                                 S01117
     C           BRNCH     OREQ BRCA                                      S01117
     C           MBIN      OREQ 'N'                                       S01117
     C                     SETON                     58                   S01117
     C                     OPEN LE0660P1                                  S01117
     C*                                                                   S01117
     C** INDICATE THAT THE P1 FILE HAS BEEN OPENED                        S01117
     C                     SETON                     75                   S01117
     C                     Z-ADD0         PAGE                            S01117
     C**                                                                  S01117
     C** ENSURE REPORT SPOOL FILE RECORDED BY RCF                         S01117
     C                     Z-ADDSFNUM     ZSNUM   60                      S01117
     C                     OUT  LDA                                       S01117
     C*                                                                   S01117
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           SEQ                             S01117
     C                     PARM BRCA      SENTY   3                       S01117
     C                     PARM           SFILE                           S01117
     C                     PARM           ZSNUM                           S01117
     C                     PARM           ZSERR   1                       S01117
     C*                                                                   S01117
     C           *LOCK     IN   LDA                                       S01117
     C           ZSERR     IFEQ 'Y'                                       S01117
     C**  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM       S01117
     C                     SETON                     U7U8LR               S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C*
     C           MBIN      IFEQ 'Y'                                       S01117
     C**                                                                  S01117
     C** GET BRANCH NAME (IN BRNM)                                        S01117
     C**                                                                  S01117
     C**********           CALL 'AOBRCHR0'                                S01117              CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       S01117
     C                     PARM '*KEY   ' @OPTN   7                       S01117
     C                     PARM BRCA      @DSNB   3                       S01117
     C********** SDBRCH    PARM SDBRCH    DSFDY                           S01117              CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANKS                                   S01117
     C                     MOVEL@DSNB     DBKEY            ***************S01117
     C                     MOVEL'SDBRCHPD'DBFILE           * DBERROR 12  *S01117
     C                     Z-ADD12        DBASE            ***************S01117
     C                     SETON                     U7U8LR               S01117
     C                     GOTO END                                       S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C                     ELSE                                           S01117
     C                     SETOF                     58                   S01117
     C                     END                                            S01117
     C                     END                                            S01117
0259 C**
0260 C**   DETERMINE CURRENCY DETAILS
0261 C   L3                MOVE ECCY      XCCY
0262 C   L3                EXSR CCYDEP
0263 C   L3 99             SETON                     U7U8  **DATABASE 02*
0264 C   L3 99             Z-ADD2         DBASE
0265 C***L3*99**           MOVE CCYKEY    DBKEY                           S01194
0266 C***L3*99**           MOVE 'TABLE'   DBFILE                          S01194
0266 C   L3 99             MOVE ECCY      DBKEY                           S01194
0266 C   L3 99             MOVE 'SDCURRPD'DBFILE                          S01194
0267 C   L3 99             GOTO END
0268 C**
0269 C   L3      XDECP     COMP 1                      6061
0270 C   L3      XDECP     COMP 2                    63  62
0271 C**
0272 C   L3                MOVE XNAME     CCYNME 14
0273 C**
0274 C**   AT CHANGE OF CURRENCY,ZEROIZE CURRENCY TOTALS
0275 C   L3                Z-ADD0         FTOT2  130
0276 C   L3                Z-ADD0         CDTOT2 130
0277 C   L3                Z-ADD0         CFTOT2 130
0278 C**
0279 C*****ACCESS*S/TABLE*-*FACILITY*TYPE*RECORD***********               S01194
0279 C**   ACCESS SDFACTPD - FACILITY TYPE RECORD                         S01194
0278 C**                                                                  S01194
0280 C***L2***** FTPKEY    CHAINTABLE                55                   S01194
     C   L2                MOVE FTYP      FKEY                            S01194
     C   L2                CALL 'AOFACTR0'PLIST1                          S01194
     C   L2      @RTCD     IFNE *BLANKS                                   S01194
0281 C   L2                SETON                     U7U8  **DATABASE 03* S01194
0282 C   L2                Z-ADD3         DBASE                           S01194
0283 C   L2                MOVE FTYP      DBKEY                           S01194
0284 C   L2                MOVE 'SDFACTPD'DBFILE                          S01194
0285 C   L2                GOTO END                                       S01194
     C                     END                                            S01194
0281 C***L2N07*****        SETON                     U7U8  **DATABASE 03* S01194
0282 C***L2N07*****        Z-ADD3         DBASE                           S01194
0283 C***L2N07*****        MOVE FTPKEY    DBKEY                           S01194
0284 C***L2N07*****        MOVE 'TABLE'   DBFILE                          S01194
0285 C***L2N07*****        GOTO END                                       S01194
0286 C**
0287 C**   DETERMINE UNDERLINING FOR FACILITY TYPE NARRARIVE
0288 C   L2                MOVE FACN      UNDRIN
0289 C   L2                EXSR SRUNDR
0290 C   L2                MOVE UDROUT    UNDLIN 30
0291 C**
0292 C**   AT CHANGE OF FACILITY TYPE,ZEROIZE FACILITY TOTALS
0293 C   L2                Z-ADD0         FTOT1  130
0294 C   L2                Z-ADD0         CDTOT1 130
0295 C   L2                Z-ADD0         CFTOT1 130
0296 C**
0297 C**   ACCESS S/CLINT
0515 C*                                                                   S01194
0298 C***L1***** CUSKEY    CHAINCLINT                55                   S01194
     C   L1                MOVELCNUM      KEYC
     C   L1                CALL 'AOCUSTR0'PLIST3                          S01194
     C   L1      @RTCD     IFNE *BLANKS                                   S01194
0299 C***L1N10**           SETON                     U7U8  **DATABASE 04* S01194
0300 C***L1N10**           Z-ADD4         DBASE                           S01194
0301 C***L1N10**           MOVE CUSKEY    DBKEY                           S01194
0302 C***L1N10**           MOVE 'CLINT'   DBFILE                          S01194
0303 C***L1N10**           GOTO END                                       S01194
0299 C                     SETON                     U7U8LR**DATABASE 04* S01194
0300 C                     Z-ADD4         DBASE                           S01194
0301 C                     MOVE CNUM      DBKEY                           S01194
0302 C                     MOVE 'SDCUSTPD'DBFILE                          S01194
0303 C                     GOTO END                                       S01194
     C                     END                                            S01194
0304 C**
0305 C**   REFORMAT DATES - FROM DATE TO BE GREATER OF PREV. ACCRUAL/
0306 C**   START,LAST FEE DUE DATE
0307 C***22******PACD      COMP SLID                 41                   E47264
0308 C***22*41***          Z-ADDPACD      ZDAYNO                          E47264
0309 C***22N41***          Z-ADDSLID      ZDAYNO                          E47264
0307 C  N50      PELAP     COMP SLID                 41                   E47264
0308 C  N50 41             Z-ADDPELAP     ZDAYNO                          E47264
0309 C  N50N41             Z-ADDSLID      ZDAYNO                          E47264
     C   50                Z-ADDSLID      ZDAYNO                          E47264
     C***  BUT IF CHANGE OF FACILITY TYPE THEN FIRST 'FROM' DATE          E10036
     C***  MUST BE START/LAST INTEREST DATE                               E10036
     C   22 L2             Z-ADDSLID      ZDAYNO                          E10036
     C***                                                                 E10036
0310 C***22                EXSR ZDATE2                                    E47264
0311 C***22                MOVE ZADATE    FRMDAT  7                       E47264
0310 C                     EXSR ZDATE2                                    E47264
0311 C                     MOVE ZADATE    FRMDAT  7                       E47264
0312 C**
0313 C   21                Z-ADDEDAT      ZDAYNO
0314 C   21                EXSR ZDATE2
0315 C   21                MOVE ZADATE    TODAT   7
0316 C**
0317 C**   TRUNCATE INTEREST RATE
0318 C                     MOVE INTR      INTRAT 107
0319 C**
0320 C**   MAINTAIN FACILITY TYPE TOTALS
     C*                                                                   S01117
     C**   ONLY ADD TO TOTALS IF LEVEL BREAK DUE ON FACILITY/CUSTOMER
     C** - MORE THAN 1 CFACS RECORD MAY EXIST FOR EACH FACILITY/CUSTOMER
     C           RECILA    COMP 'F'                      41
     C   41      FTFC      COMP FTFCLA                   41
     C   41      CNUM      COMP CNUMLA                   41
     C  N41      FAMT      ADD  FTOT1     FTOT1
     C  N41      CPAM      ADD  CDTOT1    CDTOT1
0323 C           EAMT      ADD  CFTOT1    CFTOT1
0324 C**
0325 C**   MAINTAIN RECORD COUNT & HASH TOTALS
0326 C           NREC      ADD  1         NREC
0327 C                     Z-ADDNRECF     ZZTOTI
0328 C                     Z-ADDNRECL     ZZTOTD
0329 C**
0330 C**   IF AMOUNT IS NEGATIVE,REVERSE SIGN
0331 C           EAMT      DIV  1000      ZZAMT        41
0332 C   41                Z-SUBZZAMT     ZZAMT
0333 C                     EXSR GLZADD
0334 C                     Z-ADDZZTOTI    NRECF  150
0335 C                     Z-ADDZZTOTD    NRECL   30
0336 C**
0337 C           END       TAG                             **END TAG**
0338 C   U7                SETON                     LR
0339 C**
0340 C**   TOTAL TIME CALCULATIONS
0341 CL2         FTOT1     ADD  FTOT2     FTOT2
0342 CL2         CDTOT1    ADD  CDTOT2    CDTOT2
0343 CL2         CFTOT1    ADD  CFTOT2    CFTOT2
     C*                                                                   S01117
     C** IF P1 FILE NOT OPEN (BECAUSE NO RECORDS READ) THEN OPEN IT       S01117
     C*                                                                   S01117
     CLR         *IN75     IFNE '1'                                       S01117
     CLR                   SETON                     77                   S01117
     CLR                   EXSR #ZZ                                       S01117
     CLR                   EXCPTNODTL                                     S01117
     CLR                   END                                            S01117
     C**                                                                  S01117
     C*       ENSURE TOTAL SPOOL FILE RECORDED BY RCF                     S01117
     C**                                                                  S01117
     CLR                   Z-ADDSFNUMU    ZSNUMU  60                      S01117
     CLR                   OUT  LDA                                       S01117
     C**                                                                  S01117
     CLR                   CALL 'ZSFILE'                                  S01117
     CLR                   PARM           SEQ     5                       S01117
     CLR                   PARM *BLANK    SENTY   3                       S01117
     CLR                   PARM           SFILEU                          S01117
     CLR                   PARM           ZSNUMU                          S01117
     CLR                   PARM           ZSERR   1                       S01117
     C*                                                                   S01117
     CLR         *LOCK     IN   LDA                                       S01117
     CLR         ZSERR     IFEQ 'Y'                                       S01117
     C**  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM       S01117
     CLR                   SETON                     U7U8                 S01117
     CLR                   RETRN                                          S01117
     CLR                   END                                            S01117
     C*                                                                   S01117
     C**  CHECK CONTROL TOTAL FOR THE CASES OF SINGLE-BRANCHING           S01117
     C**  AND MULTIBRANCHING ALL                                          S01117
     C*                                                                   S01117
     CLR         MBIN      IFEQ 'N'                                       S01117
     CLR         MBIN      OREQ 'Y'                                       S01117
     CLR         BRNCH     ANDEQ'ALL'                                     S01117
     CLR         MBIN      OREQ 'Y'                                       072934
     CLR         BRNCH     ANDEQ'   '                                     072934
0346 CLRNU8      NREC      COMP NORE                 U8U8
0347 CLRNU8      NRECF     COMP VLRF                 U8U8
0348 CLRNU8      NRECL     COMP VLRL                 U8U8
     CLR                   END                                            S01117
     CLR U7 U8             EXSR *PSSR                                     S01117
0349 C**
0350 C********************************************************************
0351 C/SPACE 3
0352 C********************************************************************
0353 C**
0354 C**   SR. TO SET UP AN ARRAY OF CURRENCIES AND ARRAYS OF
0355 C**   DECIMAL PLACES AND NAMES FOR THOSE CURRENCIES.
0356 C**
0357 C           CCYARR    BEGSR                           *** CCYARR  ***
0358 C**
0359 C**   SET OFF ERROR INDICATOR
0360 C                     SETOF                     99
0361 C**
0362 C**   SET ARRAY INDEX TO ZERO.
0363 C                     Z-ADD0         X       30
0364 C**************                                                      S01194
0365 C*****SET*UP*KEY*FOR*CURRENCY*TABLE.*                                S01194
0366 C**************       MOVEL'20      'XCYKEY 12                       S01194
0367 C**************       MOVE '    '    XCYKEY                          S01194
0368 C**************                                                      S01194
0369 C*****SET*LOWER*LIMIT*AND*READ*CURRENCY*TABLE*HEADER.*               S01194
0370 C***********XCYKEY    SETLLTABLED                                    S01194
0371 C**
0372 C**   LOOP TO READ CURRENCY DETAIL RECORDS.
0373 C           XLOOP     TAG                             ** XLOOP TAG **
0374 C**********           READ TABLED                   99               S01194
0375 C**N99***** RECT      COMP 20                   9999                 S01194
     C                     READ SDCURRPD                 99               S01194
0376 C**
0377 C**   END IF ALL CURRENCY RECORDS PROCESSED
0378 C   99                GOTO XCAEND
0379 C**************                                                      S01194
0380 C*****IGNORE*DELETED RECORDS AND NON-SUB-RECORD ONE.                 S01194
0381 C********** RECI      COMP 'D'                  9797                 S01194
0382 C***97*****           GOTO XLOOP                                     S01194
0383 C********** SREC      COMP 1                    9797                 S01194
0384 C***97*****           GOTO XLOOP                                     S01194
0385 C**
0386 C**   INCREMENT ARRAY INDEX.
0387 C           X         ADD  1         X
0388 C**
0389 C**   MOVE DATA INTO ARRAYS.
0390 C                     MOVE CCY       XCYA,X
0391 C                     MOVE CDP       XDPA,X
0392 C                     MOVE CCNM      XNME,X
0393 C**
0394 C**   CHECK FOR FULL ARRAY.96 ON IF FULL.
0395 C           X         COMP 150                      96
0396 C**
0397 C**   GO TO READ NEXT RECORD.
0398 C  N96                GOTO XLOOP
0399 C**
0400 C           XCAEND    ENDSR                           ** XCAEND **
0401 C**
0402 C********************************************************************
0403 C********************************************************************
0404 C**
0405 C**   SR. TO OBTAIN NO. OF DECIMAL PLACES & NAME FOR A CURRENCY.
0406 C**
0407 C           CCYDEP    BEGSR                           *** CCYDEP  ***
0408 C**
0409 C**   BLANK CURRENCY CODE IS INVALID
0410 C           XCCY      COMP '   '                    99
0411 C   99                GOTO XCDEND
0412 C**
0413 C**   SET ARRAY INDEX TO ONE
0414 C                     Z-ADD1         X
0415 C**
0416 C**   INITIALIZE INPUT-OUTPUT FIELDS.
0417 C                     Z-ADD0         XDECP   10
0418 C                     MOVE XCCY      XCCY    3
0419 C                     MOVE ' '       XBLKS  14
0420 C                     MOVE XBLKS     XNAME  14
0421 C**
0422 C**   LOOK UP NO. OF DECIMAL PLACES FOR CURRENCY.
0423 C**   99 SETON FOR INVALID CURRENCY.
0424 C           XCCY      LOKUPXCYA,X                   95
0425 C   95                MOVE XDPA,X    XDECP
0426 C   95                MOVE XNME,X    XNAME
0427 C***95*******         SETON                     99                   BHF792
0427 C  N95                SETON                     99                   BHF792
0428 C**
0429 C           XCDEND    ENDSR                           ** XCDEND **
0430 C**
0431 C********************************************************************
0432 C********************************************************************
0433 C*                                                                 **
0434 C*  THIS S-R CALCULATES UNDERLINING REQUIRED FOR A FIELD TO BE     **
0435 C*  PRINTED ON A REPORT.                                           **
0436 C*                                                                 **
0437 C*  INPUT FIELD - UNDRIN - 30A
0438 C* OUTPUT FIELD - UDROUT - 30A                                     **
0439 C*   WORK FIELD - UDRBLK - 30A                                     **
0440 C*   WORK ARRAY - UDR1                                             **
0441 C*  STORE ARRAY - UDR2
0442 C*                                                                 **
0443 C           SRUNDR    BEGSR                           ** SRUNDR **
0444 C*                                                                 **
0445 C** RESET WORK INDICATORS
0446 C*
0447 C                     BITOF'01234567'UBIT    1
0448 C*
0449 C   90                BITON'0'       UBIT
0450 C   91                BITON'1'       UBIT
0451 C   92                BITON'2'       UBIT
0452 C*
0453 C                     SETOF                     909192
0454 C*
0455 C** SET UP WORK FIELDS
0456 C*
0457 C                     MOVEAUNDRIN    UDR1
0458 C                     MOVE ' '       UDRBLK 30
0459 C                     MOVE UDRBLK    UDROUT 30
0460 C                     Z-ADD31        UU      20
0461 C                     Z-ADD30        U       20   92
0462 C   92                MOVE UNDRIN    UNDRIN 30
0463 C           UB1       TAG                             ** UB1 TAG **
0464 C*
0465 C** CHECK IF LAST CHAR. OF NAME IS BLANK
0466 C*
0467 C           UDR1,U    COMP ' '                      90
0468 C   90      U         SUB  1         U            9191
0469 C   90N91             GOTO UB1
0470 C*
0471 C** NOW SET UNDERLINE FOR OUTPUT.
0472 C*
0473 C  N91      UU        SUB  U         U
0474 C  N91                MOVEAUDR2,U    UDROUT
0475 C*
0476 C** PROC. NOW COMPLETE - RESET INDICATORS.
0477 C*
0478 C                     TESTB'0'       UBIT           90
0479 C                     TESTB'1'       UBIT           91
0480 C                     TESTB'2'       UBIT           92
0481 C*
0482 C                     ENDSR
0483 C*
0484 C********************************************************************
0485 C/SPACE 3
0486 C********************************************************************
0487 C**
0488 C**   ZDATE2 SR. TO CONVERT A DAY NUMBER TO DATE FORMATS.
0489 C**
0490 C**   THE YEAR 2000, BEING DIVISIBLE BY 400, IS A LEAP YEAR.
0491 C**
0492 C           ZDATE2    BEGSR                           *** ZDATE2 ***
0493 C**
0494 C**   CLEAR DATE FIELDS.
0495 C                     Z-ADD0         ZDATE   60
0496 C                     MOVEL'       ' ZADATE  7
0497 C**
0498 C**   CALCULATION TO DEFINE INPUT DAY NUMBER.
0499 C                     Z-ADDZDAYNO    ZDAYNO  50
0500 C**
0501 C**   DETERMINE YEAR NUMBER.
0502 C**
0503 C**   ADJUST DAY NUMBER IN CASE LAST DAY OF YEAR.
0504 C           ZDAYNO    SUB  1         ZDAYN1  50   99
0505 C   99                GOTO ZDEND2
0506 C**
0507 C**   CALCULATE NUMBER OF 4 YEAR SPANS SINCE 31/12/1971.
0508 C           ZDAYN1    DIV  1461      ZLYR    20
0509 C                     MVR            ZDAYN1           SAVE REMAINING
0510 C**                                                   DAYS
0511 C**   CALCULATE NUMBER OF REMAINING YEARS.
0512 C                     Z-ADD1         ZWRK2   20
0513 C           ZDTAG1    TAG                             ** ZDTAG1 TAG *
0514 C           ZDAYN1    COMP ZYDY,ZWRK2             90
0515 C  N90      ZWRK2     ADD  1         ZWRK2
0516 C  N90                GOTO ZDTAG1
0517 C           ZWRK2     SUB  1         ZWRK2          91LEAP YR, 91 ON
0518 C**
0519 C**   DECREMENT DAY NO. BY DAYS IN REMAINING YEARS.
0520 C  N91      ZDAYN1    SUB  ZYDY,ZWRK2ZDAYN1
0521 C**
0522 C**   CALCULATE ACTUAL YEAR NUMBER.
0523 C           ZLYR      MULT 4         ZWRK3   30
0524 C           ZWRK3     ADD  72        ZWRK3            BASE IS 1972
0525 C                     Z-ADDZWRK3     ZYEAR   20
0526 C           ZYEAR     ADD  ZWRK2     ZYEAR            YEAR
0527 C**
0528 C**   DETERMINE MONTH NUMBER.
0529 C**
0530 C**   ADJUST DAY NO. IN CASE LAST DAY OF LEAP YEAR FEBRUARY.
0531 C                     SETOF                     9293
0532 C   91      ZDAYN1    COMP 59                     9293
0533 C   91N92   ZDAYN1    SUB  1         ZDAYN1
0534 C**
0535 C**   CALCULATE MONTH NUMBER.
0536 C                     Z-ADD2         ZWRK2
0537 C           ZDTAG2    TAG                             ** ZDTAG2 TAG *
0538 C           ZDAYN1    COMP ZMDY,ZWRK2             94
0539 C  N94      ZWRK2     ADD  1         ZWRK2
0540 C  N94                GOTO ZDTAG2
0541 C           ZWRK2     SUB  1         ZWRK2
0542 C**
0543 C                     Z-ADDZWRK2     ZMTH    20       MONTH
0544 C**
0545 C**   DETERMINE DAY OF MONTH.
0546 C**
0547 C**   ADD BACK LAST DAY OF YEAR ADJUSTMENT.
0548 C           ZDAYN1    ADD  1         ZDAYN1
0549 C**
0550 C**   CALCULATE DAY OF MONTH.
0551 C           ZDAYN1    SUB  ZMDY,ZWRK2ZDAY    20       DAY
0552 C**
0553 C**   ADD BACK LEAP YEAR 29TH FEBUARY ADJUSTMENT, IF REQUIRED.
0554 C   93      ZDAY      ADD  1         ZDAY
0555 C**
0556 C**   FORMAT DATE, DDMMYY OR MMDDYY.
0557 C  N98                MOVELZDAY      ZWRK4   40
0558 C   98                MOVE ZDAY      ZWRK4
0559 C  N98                MOVE ZMTH      ZWRK4
0560 C   98                MOVELZMTH      ZWRK4
0561 C                     MOVELZWRK4     ZDATE
0562 C                     MOVE ZYEAR     ZDATE
0563 C**
0564 C**   FORMAT ALPHA DATE, DDMMMYY.
0565 C           ZDAY      COMP 10                     95
0566 C                     MOVELZDAY      ZWRK5   5
0567 C   95                MOVEL' '       ZWRK5
0568 C                     MOVE ZMNM,ZMTH ZWRK5
0569 C                     MOVELZWRK5     ZADATE
0570 C                     MOVE ZYEAR     ZADATE
0571 C**
0572 C           ZDEND2    ENDSR                           * ZDEND2 ENDSR*
0573 C**
0574 C**
0575 C********************************************************************
0576 C********************************************************************
0577 C* SUBROUTINE TO ADD AN AMOUNT (ZZAMT) TO THE TOTAL (ZZTOTI,ZZTOTD)
0578 C*   IND '99' IS SET BY AN OVERFLOW ERROR
0579 C*
0580 CSR         GLZADD    BEGSR                           *** GLZADD ****
0581 C*
0582 CSR                   Z-ADDZZAMT     ZZAMT  153     91-DEFINE ZZAMT
0583 CSR 91                GOTO ZZAEND                     AMT = 0.BYPASS
0584 C*
0585 C* SPLIT ZZAMT INTO INTEGER AND DECIMAL FIELDS
0586 CSR                   Z-ADDZZAMT     ZZAMTI 150       INTEGER FIELD
0587 CSR                   MOVE ZZAMT     ZZAMTD  30       DECIMAL FIELD
0588 C* BOTH ZZAMTI AND ZZAMTD CONTAIN A 'SIGN' ZONE NOW
0589 C*
0590 CSR                   EXSR GLZSUM
0591 CSR         ZZAEND    ENDSR                           ** ZZAEND TAG *
0592 C*
0593 C********************************************************************
0594 C********************************************************************
0595 C* SUBROUTINE TO CARRY OUT THE ADDITION FOR SUBROUTINES -
0596 C*                        GLZADD, GLZSUB, GLZCMP.
0597 C*          PARAMETERS PASSED -
0598 C*                     I/P ZZAMTI ZZAMTD
0599 C*                     O/P ZZTOTI ZZTOTD ZZNEGD IND 96 IND 99.
0600 C*
0601 CSR         GLZSUM    BEGSR                           *** GLZSUM ****
0602 C*
0603 CSR                   Z-ADDZZTOTI    ZZTOTI 150       DEFINE ZZTOTI
0604 CSR                   Z-ADDZZTOTD    ZZTOTD  30       DEFINE ZZTOTD
0605 CSR                   SETOF                     919293
0606 CSR                   SETOF                     949599
0607 C*
0608 C*    DETERMINE SIGN OF ZZAMTI & D,   92 IF NEG
0609 CSR         ZZAMTI    COMP 0                      9293
0610 CSR 93      ZZAMTD    COMP 0                      9293
0611 CSR 93                GOTO ZZSEND                     ZERO BYPASS
0612 C*
0613 C*    DETERMINE SIGN OF ZZTOTI & D, 91 IF NEG.
0614 CSR         ZZTOTI    COMP 0                      9193
0615 CSR 93      ZZTOTD    COMP 0                      9193
0616 C*
0617 C*    IF ZZTOTAL IS ZERO, RETURN ZZAMOUNT.
0618 CSR 93                Z-ADDZZAMTI    ZZTOTI
0619 CSR 93                Z-ADDZZAMTD    ZZTOTD
0620 CSR 93                GOTO ZZSEND                     ZERO BYPASS
0621 C*    IF SIGNS DIFFER BYPASS OVERFLOW CHECKS.
0622 CSR 91N92
0623 CORN91 92             GOTO ZZOFPS
0624 C*
0625 CSR         ZZAMTD    ADD  ZZTOTD    ZZWK2   40
0626 CSR         ZZWK2     COMP 999                  93    '93' = CARRY
0627 CSRN93      ZZWK2     COMP -999                   93    INTO INTEGER.
0628 C*
0629 CSR 93N92   ZZAMTI    ADD  1         ZZWK3  150       ADD 'CARRY' +VE
0630 CSR    93 92ZZAMTI    SUB  1         ZZWK3            SUB 'CARRY' -VE
0631 CSR 93      ZZTOTI    ADD  ZZWK3     ZZWK3
0632 CSRN93      ZZTOTI    ADD  ZZAMTI    ZZWK3
0633 C*
0634 C* IF THE MODULUS OF ZZWK3 IS LT MOD. ZZTOTI THEN O/F HAS OCCURED
0635 CSRN92      ZZWK3     COMP ZZTOTI                 99  -92 MEANS NOS.
0636 CSR 92      ZZWK3     COMP ZZTOTI               99     NEGATIVE
0637 CSRN99                Z-ADDZZWK2     ZZTOTD
0638 CSRN99                Z-ADDZZWK3     ZZTOTI
0639 C*
0640 C* IF O/F ZEROIZE ZZAMT , IND '99' SET AND ZZTOT FIELDS LEFT INTACT.
0641 CSR 99                Z-ADD0         ZZAMT  153
0642 CSR                   GOTO ZZSEND
0643 C*
0644 C* THE 'SIGNS' ARE DIFFERENT
0645 CSR         ZZOFPS    TAG                             ** ZZOFPS TAG**
0646 C* IF ZZAMT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZTOT
0647 C*
0648 CSR 92                Z-SUBZZAMTI    ZZAMTI 150
0649 CSR 92                Z-SUBZZAMTD    ZZAMTD  30
0650 C*
0651 C* IF ZZTOT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZAMT.
0652 C*
0653 CSR 91                Z-SUBZZTOTI    ZZTOTI
0654 CSR 91                Z-SUBZZTOTD    ZZTOTD
0655 C* BOTH ZZAMT AND ZZTOT ARE NOW POSITIVE.
0656 C*
0657 CSR         ZZTOTI    COMP ZZAMTI               93  95
0658 CSR 95      ZZTOTD    COMP ZZAMTD               93  95
0659 C*
0660 C* IF ZZTOT EQ. ZZAMT RETURN ZERO.
0661 CSR 95                Z-ADD0         ZZTOTI
0662 CSR 95                Z-ADD0         ZZTOTD
0663 CSR 95                GOTO ZZSEND
0664 C*
0665 C* IF ZZTOT GT. ZZAMT.
0666 CSR 93      ZZAMTD    COMP ZZTOTD               94
0667 CSR 93 94   ZZTOTI    SUB  1         ZZTOTI
0668 CSR 93 94   ZZTOTD    ADD  1000      ZZWK2
0669 CSR 93      ZZTOTI    SUB  ZZAMTI    ZZTOTI
0670 CSR 93 94   ZZWK2     SUB  ZZAMTD    ZZTOTD
0671 CSR 93N94   ZZTOTD    SUB  ZZAMTD    ZZTOTD
0672 C*
0673 C*
0674 C* IF ZZAMT GT. ZZTOT.
0675 CSRN93      ZZTOTD    COMP ZZAMTD               94
0676 CSRN93 94   ZZAMTI    SUB  1         ZZWK3  150
0677 CSRN93 94   ZZAMTD    ADD  1000      ZZWK2
0678 CSRN93 94   ZZWK3     SUB  ZZTOTI    ZZTOTI
0679 CSRN93N94   ZZAMTI    SUB  ZZTOTI    ZZTOTI
0680 CSRN93 94   ZZWK2     SUB  ZZTOTD    ZZTOTD
0681 CSRN93N94   ZZAMTD    SUB  ZZTOTD    ZZTOTD
0682 C*
0683 C* REVERSE SIGN OF ZZTOT IF LARGER I/P FIELDS WERE NEGATIVE
0684 CSR                   SETOF                     94
0685 CSR 93 91
0686 CORN93 92             SETON                     94
0687 CSR 94                Z-SUBZZTOTI    ZZTOTI
0688 CSR 94                Z-SUBZZTOTD    ZZTOTD
0689 C**
0690 C**   RESTORE SIGN OF ZZAMTI & ZZAMTD IF IT WAS REVERSED.
0691 CSR 92                Z-SUBZZAMTI    ZZAMTI
0692 CSR 92                Z-SUBZZAMTD    ZZAMTD
0693 CSR         ZZSEND    TAG                             ** ZZSEND TAG *
0694 C**
0695 C**   IF ZZTOTD IS ZERO, AND ZZTOTI IS NEG. SET UP ZZNEGD.
0696 CSR                   SETOF                     96
0697 CSR         ZZTOTD    COMP 0                        91
0698 CSR 91      ZZTOTI    COMP 0                      96
0699 CSR 96                MOVE '.000-'   ZZNEGD  5
0700 CSR                   ENDSR                             ** ENDSR **
0701 C********************************************************************
0702 C********************************************************************
0703 C**
0704 C**   ZSYSTM SR. TO CHAIN TO THE INSTALLATION CONTROL DATA RECORD.
0705 C**
0706 C           ZSYSTM    BEGSR                           *** ZSYSTM ***
0707 C**********                                                          S01194
0708 C*****SET*UP KEY FOR INSTALLATION CONTROL RECORD.                    S01194
0709 C**********           MOVEL'01      'ZTABKY 12                       S01194
0710 C**********           MOVE '  10'    ZTABKY                          S01194
0711 C**********                                                          S01194
0712 C********** ZTABKY    CHAINTABLE                99    ON NOT THERE   S01194
0713 C**N99***** RECI      COMP 'D'                  9999  ON, IS DELETED S01194
      *                                                                   S01194
      ** ACCESS BANK DETAILS                                              S01194
      *                                                                   S01194
     C                     CALL 'AOBANKR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDBANK    PARM SDBANK    DSFDY                           S01194
     C           @RTCD     IFNE *BLANKS                                   S01194
     C                     SETON                     99                   S01194
     C                     END                                            S01194
0714 C**
0715 C**   CHECK SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.
0716 C***********DATF      COMP 'M'                      98MMDDYY, 98 ON  S01194
0716 C           BJDFIN    COMP 'M'                      98MMDDYY, 98 ON  S01194
0717 C**
0718 C                     ENDSR
0719 C**
     C********************************************************************S01117
     C*                                                                   S01117
     C* SUBROUTINE : #ZZ                                                  S01117
     C*                                                                   S01117
     C* CALLED BY MAIN PROCESSING DURING TOTAL TIME CALCULATIONS IF       S01117
     C* THE P1 FILE HAS NOT ALREADY BEEN OPENED (IE. IF THERE ARE         S01117
     C* NO RECORDS READ AND THEREFORE FILE OPENING NOT PERFORMED          S01117
     C*                                                                   S01117
     C********************************************************************S01117
     C*                                                                   S01117
     C           #ZZ       BEGSR                                          S01117
     C*                                                                   S01117
     C** OPEN P1 SPOOL FILE                                               S01117
     C                     OPEN LE0660P1                                  S01117
     C*                                                                   S01117
     C** INDICATE THAT THE P1 FILE HAS BEEN OPENED                        S01117
     C                     SETON                     75                   S01117
     C                     Z-ADD0         PAGE                            S01117
     C*                                                                   S01117
     C** IF IT'S BRANCH ALL, NO BRANCH NAME WILL BE PRINTED               S01117
     C           BRNCH     IFEQ 'ALL'                                     S01117
     C           BRNCH     OREQ '   '                                     072934
     C                     SETON                     89                   S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C** IF REPORT FOR ALL ENTITIES CALL ZSFILE WITH BLANK SENTY          S01117
     C           BRNCH     IFEQ 'ALL'                      B1             S01117
     C           BRNCH     OREQ '   '                                     072934
     C           MBIN      ORNE 'Y'                                       S01117
     C**                                                                  S01117
     C** ENSURE REPORT SPOOL FILE RECORDED BY RCF                         S01117
     C                     Z-ADDSFNUM     ZSNUM   60                      S01117
     C                     OUT  LDA                                       S01117
     C*                                                                   S01117
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           SEQ                             S01117
     C                     PARM *BLANK    SENTY   3                       S01117
     C                     PARM           SFILE                           S01117
     C                     PARM           ZSNUM                           S01117
     C                     PARM           ZSERR   1                       S01117
     C*                                                                   S01117
     C           *LOCK     IN   LDA                                       S01117
     C           ZSERR     IFEQ 'Y'                                       S01117
     C**  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM       S01117
     C                     SETON                     U7U8LR               S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C** ELSE REPORT BY ENTITY SO CALL ZSFILE WITH ENTITY REQUESTED       S01117
     C                     ELSE                            X1             S01117
     C**                                                                  S01117
     C** ENSURE REPORT SPOOL FILE RECORDED BY RCF                         S01117
     C                     Z-ADDSFNUM     ZSNUM   60                      S01117
     C                     OUT  LDA                                       S01117
     C*                                                                   S01117
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           SEQ                             S01117
     C                     PARM BRNCH     SENTY   3                       S01117
     C                     PARM           SFILE                           S01117
     C                     PARM           ZSNUM                           S01117
     C                     PARM           ZSERR   1                       S01117
     C*                                                                   S01117
     C           *LOCK     IN   LDA                                       S01117
     C           ZSERR     IFEQ 'Y'                                       S01117
     C**  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM       S01117
     C                     SETON                     U7U8LR               S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C** AND GET ENTITY DETAILS FOR REPORT HEADINGS WHEN MULTIBRANCHING   S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C*                                                                   S01117
     C**********           CALL 'AOBRCHR0'                                S01117              CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       S01117
     C                     PARM '*KEY   ' @OPTN   7                       S01117
     C                     PARM BRNCH     @DSNB   3                       S01117
     C********** SDBRCH    PARM SDBRCH    DSFDY                           S01117              CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANKS                                   S01117
     C                     MOVEL@DSNB     DBKEY            ***************S01117
     C                     MOVEL'SDBRCHPD'DBFILE           * DBERROR 11  *S01117
     C                     Z-ADD11        DBASE            ***************S01117
     C                     SETON                     U7U8                 S01117
     C                     EXSR *PSSR                                     S01117
     C                     GOTO #ZZ9                                      S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C                     END                             E1             S01117
     C*                                                                   S01117
     C           #ZZ9      ENDSR                                          S01117
     C*                                                                   S01117
     C********************************************************************S01117
     C*                                                                   S01117
     C* *PSSR  --- SUBROUTINE TO HANDLE ABNORMAL ERROR CONDITIONS         S01117
     C*                                                                   S01117
     C* CALLED FROM: AFTER ABNORNAL OPERATION OCCURS                      S01117
     C*                                                                   S01117
     C* CALLS: NOTHING                                                    S01117
     C*                                                                   S01117
     C********************************************************************S01117
     C*                                                                   S01117
     C           *PSSR     BEGSR                           ** *PSSR **    S01117
     C*                                                                   S01117
     C           @RUN      IFEQ *BLANKS                                   S01117
     C                     MOVE 'Y'       @RUN    1                       S01117
     C                     DUMP                                           S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C                     ENDSR                           ** *PSSR **    S01117
0721 C********************************************************************S01117
0722 O*E0660P1H** 03   OFNL3                                    S01124    S01117
0723 O*******OR**      L3                                                 S01117
0724 O*******OR**      LR 42                                              S01117
0722 OLE0660P1H   03   OFNL3 58                                           S01117
0723 O       OR        L3 58                                              S01117
0725 O****                               22 'REFERENCE LE0660'            S01117
0725 O                                   24 'REFERENCE LE0660P1'          S01117
0726 O                         TITL      89
0727 O                                  104 'DATE'
0728 O                         RUNA     113
0729 O                                  122 'PAGE'
0730 O                         PAGE  3  128
0731 O********H** 07   OFNL3                                              S01117
0732 O*******OR**      L3                                                 S01117
0733 O*******OR**      LR 42                                              S01117
0731 O        H   05   OFNL3 58                                           S01117
0732 O       OR        L3 58                                              S01117
0736 O                                   66 'COMMITMENT FEE ACCRUAL'
0737 O                                   73 'REPORT'
0734 O                 88                83 'BRANCH'                      S01117
0735 O****                  N42BRCD      17                               S01117
0735 O                 88      BRCA      87                               S01117
0735 O                 88                88 '-'                           S01117
0735 O                 88      BRNM     118                               S01117
0738 O****    H   06   OFNL3                                              S01117
0738 O********H** 08   OFNL3                                              S01117
0739 O*******OR**      L3                                                 S01117
0740 O*******OR**      LR 42                                              S01117
0738 O        H   06   OFNL3 58                                           S01117
0739 O       OR        L3 58                                              S01117
0741 O                                   66 '----------------------'
0742 O                                   73 '-------'
0743 O****    H   07   OFNL3                                              S01117
0743 O********H** 09   OFNL3                                              S01117
0744 O*******OR**      L3NU7                                              S01117
0743 O        H   09   OFNL3 58                                           S01117
0744 O       OR        L3NU7 58                                           S01117
0745 O                                    9 'CURRENCY'
0746 O                         CCYNME    24
0747 O****    H   09   OFNL3                                              S01117
0747 O********H** 11   OFNL3                                              S01117
0748 O*******OR**      L3                                                 S01117
0749 O*******OR**      LR 42                                              S01117
0747 O        H   11   OFNL3 58                                           S01117
0748 O       OR        L3 58                                              S01117
0750 O                                    9 'CUSTOMER'
0751 O                                   53 'CMMT         FACILITY'
0752 O                                   75 'CURRENT DRAWN'
0753 O                                   93 'FROM      TO'
0754 O                                  111 'COMMITMENT FEE'
0755 O                                  131 'COMMITMENT FEE'
0756 O****    H  210   OFNL3                                              S01117
0756 O********H**212   OFNL3                                              S01117
0757 O*******OR**      L3                                                 S01117
0758 O*******OR**      LR 42                                              S01117
0756 O        H  212   OFNL3 58                                           S01117
0757 O       OR        L3 58                                              S01117
0759 O                                   19 'NUMBER        NAME'
0760 O                                   52 'N0           AMOUNT'
0761 O                                   85 'AMOUNT          DATE'
0762 O                                  111 'DATE   TYPE      RATE'
0763 O                                  127 'ACCRUED'
0764 O********D**      L2NU7                                              S01117
0764 O        D        L2NU7 58                                           S01117
0765 O                         FACN      31
0766 O********D**2     L2NU7                                              S01117
0766 O        D  2     L2NU7 58                                           S01117
0767 O                         UNDLIN    31
0768 O********D**2     01NU7                                              S01117
0768 O        D  2     01NU7 58                                           S01117
0769 O                       L1CNUM       7
0770 O                       L1CRNM      29
0771 O                         FTYP      34
0772 O                                   35 '/'
0773 O                         FCNO      37
0774 O*
0775 O                       60FAMT      56 ' ,   ,   ,   , 0 '
0776 O                       61FAMT      56 '   ,   ,   , 0 . '
0777 O                       62FAMT      56 '  ,   ,   , 0 .  '
0778 O                       63FAMT      56 ' ,   ,   , 0 .   '
0779 O*
0780 O                       60CPAM      78 ' ,   ,   ,   , 0 CR'
0781 O                       61CPAM      78 '   ,   ,   , 0 . CR'
0782 O                       62CPAM      78 '  ,   ,   , 0 .  CR'
0783 O                       63CPAM      78 ' ,   ,   , 0 .   CR'
0784 O*
0785 O                       22FRMDAT    86
0786 O                       21TODAT     95
0787 O                         CFTP      98
0788 O                         INTRAT   111 '  0.       '
0789 O*
0790 O                       60EAMT     131 ' ,   ,   ,   , 0 -'
0791 O                       61EAMT     131 '   ,   ,   , 0 . -'
0792 O                       62EAMT     131 '  ,   ,   , 0 .  -'
0793 O                       63EAMT     131 ' ,   ,   , 0 .   -'
0794 O********T**2     L2N42NU7                                           S01117
0794 O        T  2     L2NU7 58                                           S01117
0795 O                                   38 'FACILITY TYPE TOTAL'
0796 O                       60FTOT1     56 ' ,   ,   ,   , 0 '
0797 O                       61FTOT1     56 '   ,   ,   , 0 . '
0798 O                       62FTOT1     56 '  ,   ,   , 0 .  '
0799 O                       63FTOT1     56 ' ,   ,   , 0 .   '
0800 O*
0801 O                       60CDTOT1    78 ' ,   ,   ,   , 0 CR'
0802 O                       61CDTOT1    78 '   ,   ,   , 0 . CR'
0803 O                       62CDTOT1    78 '  ,   ,   , 0 .  CR'
0804 O                       63CDTOT1    78 ' ,   ,   , 0 .   CR'
0805 O*
0806 O                       60CFTOT1   131 ' ,   ,   ,   , 0 -'
0807 O                       61CFTOT1   131 '   ,   ,   , 0 . -'
0808 O                       62CFTOT1   131 '  ,   ,   , 0 .  -'
0809 O                       63CFTOT1   131 ' ,   ,   , 0 .   -'
0810 O********T**2     L3N42NU7                                           S01117
0810 O        T  2     L3NU7 58                                           S01117
0811 O                                   38 'CURRENCY TOTAL'
0812 O                       60FTOT2     56 ' ,   ,   ,   , 0 '
0813 O                       61FTOT2     56 '   ,   ,   , 0 . '
0814 O                       62FTOT2     56 '  ,   ,   , 0 .  '
0815 O                       63FTOT2     56 ' ,   ,   , 0 .   '
0816 O*
0817 O                       60CDTOT2    78 ' ,   ,   ,   , 0 CR'
0818 O                       61CDTOT2    78 '   ,   ,   , 0 . CR'
0819 O                       62CDTOT2    78 '  ,   ,   , 0 .  CR'
0820 O                       63CDTOT2    78 ' ,   ,   , 0 .   CR'
0821 O*
0822 O                       60CFTOT2   131 ' ,   ,   ,   , 0 -'
0823 O                       61CFTOT2   131 '   ,   ,   , 0 . -'
0824 O                       62CFTOT2   131 '  ,   ,   , 0 .  -'
0825 O                       63CFTOT2   131 ' ,   ,   , 0 .   -'
0826 O*    RUN CONTROLS
0827 O********T** 17   LRNU7 42                                           S01117
0828 O***********                        76 'NO DETAILS TO REPORT'        S01117
0829 O********T*32     LR U7                                              S01117
0829 O        T 32     L4 U7 58                                           S01117
0830 O                                   51 '*** REFERENCE LE0660'
0831 O                                   71 'DATABASE ERROR ***'          S01117
0831 O**                                 71 '- DATABASE ERROR AT'         S01117
0832 O**                       DBASE     74                               S01117
0833 O**      T        LR U7                                              S01117
0834 O**                                 37 'FILENAME'                    S01117
0835 O**                       DBFILE    43                               S01117
0836 O**                                 48 'KEY'                         S01117
0837 O**                       DBKEY     78                               S01117
0871 O        T 22     L4 58                                              S01117
     O                 88                66 '*** END OF REPORT FOR'       S01117
     O                 88                74 ' BRANCH '                    S01117
     O                 88      BRCA      77                               S01117
     O                 88                81 ' ***'                        S01117
     O                N88                76 '*** END OF REPORT ***'       S01117
     O        E   03           NODTL                                      S01117
     O                                   24 'REFERENCE LE0660P1'          S01117
     O                         TITL      89                               S01117
     O                                  104 'DATE'                        S01117
     O                         RUNA     113                               S01117
     O                                  122 'PAGE'                        S01117
     O                         PAGE  3  128                               S01117
     O        E   05           NODTL                                      S01117
     O                                   66 'COMMITMENT FEE ACCRUAL'      S01117
     O                                   73 'REPORT'                      S01117
     O                 88                83 'BRANCH'                      S01117
     O                 88      BRNCH     87                               S01117
     O                 88N89             88 '-'                           S01117
     O                 88N89   BRNM     118                               S01117
     O        E   06           NODTL                                      S01117
     O                                   66 '----------------------'      S01117
     O                                   73 '-------'                     S01117
     O        E 3              NODTL                                      S01117
     O                                   63 '***   NO DETAILS TO REPO'    S01117
     O                                   71 'RT   ***'                    S01117
     O        E 3              NODTL                                      S01117
     O                 88                66 '*** END OF REPORT FOR'       S01117
     O                 88                74 ' BRANCH '                    S01117
     O                 88      BRNCH     77                               S01117
     O                 88                81 ' ***'                        S01117
     O                N88                76 '*** END OF REPORT ***'       S01117
0722 OLE0660AUT   03   LR                                                 S01117
0838 O****    T   03   LR                                                 S01117
0839 O****                               22 'REFERENCE  LE0660'           S01117
0839 O                                   24 'REFERENCE  LE0660AU'         S01117
0840 O                         TITL      89
0841 O                                  104 'DATE'
0842 O                         RUNA     112
0843 O                                  122 'PAGE'
0844 O***********              PAGE  3  127                               S01117
0844 O                         PAGE1 3  127                               S01117
0845 O        T   05   LR
0846 O                                   66 'COMMITMENT FEE ACCRUAL'
0847 O                                   89 'REPORT - FILE CONTROLS'
0848 O        T   06   LR
0849 O                                   66 '----------------------'
0850 O                                   89 '-----------------------'
0851 O        T   09   LR
0852 O                                   28 'S/CFACS - RUN CONTROLS'
0853 O                                   59 'NUMBER'
0854 O                                   84 'VALUE'
0855 O        T   10   LR
0856 O                                   28 '----------------------'
0857 O                                   59 'OF RECORDS'
0858 O                                   84 'OF RECORDS'
0859 O        T   12   LR
0860 O                                   29 'TOTAL RECORDS ON FILE'
0861 O                      NU7NORE  3   59
0862 O                      NU7VLRF  4   81
0863 O                      NU7VLRL      84
0864 O        T   14   LR
0865 O                                   29 'TOTAL RECORDS ON FILE'
0866 O                                   42 '- CALCULATED'
0867 O                         NREC  3   59
0868 O                         NRECF 4   81
0869 O                         NRECL     84
0870 O                    U8NU7         111 '*** DIFFERENCE ***'
0829 O        T 32     LR U7                                              S01117
0830 O                                   51 '*** REFERENCE LE0660'        S01117
0831 O                                   71 'DATABASE ERROR AT'           S01117
0832 O                         DBASE     75                               S01117
0833 O        T  3     LR U7                                              S01117
0834 O                                   37 'FILENAME'                    S01117
0835 O                         DBFILE    46                               S01117
0836 O                                   51 'KEY'                         S01117
0837 O                         DBKEY     81                               S01117
     O        T 3      LR 77                                              S01117
     O                                   63 '***   NO DETAILS TO REPO'    S01117
     O                                   71 'RT   ***'                    S01117
0871 O********T** 17   LR                                                 S01117
0872 O***********                        76 '*** END OF REPORT ***'       S01117
**   UDR2
------------------------------
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
** CPY@   **      OBJECT COPYRIGHT
(c) Finastra International Limited 2001
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
