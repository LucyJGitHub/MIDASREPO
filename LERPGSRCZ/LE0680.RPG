     H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas LE Financial loans diary extract')               *
     F*****************************************************************
     F*                                                               *
     F*  Midas - Customer Lending Module                              *
     F*                                                               *
     F*  LE0680 - FINANCIAL LOAN DIARY EVENTS EXTRACT                 *
     F*                                                               *
      *  (c) Finastra International Limited 2001                      *
     F*                                                               *
      *  Last Amend No. CSD103             Date 01Oct20               *
      *  Prev Amend No. MD054101           Date 08Aug19               *
      *                 MD053873           Date 10Jul19               *
      *                 MD052216           Date 04Apr19               *
      *                 MD046248           Date 27Oct17               *
      *                 CLE154             Date 02Aug12               *
      *                 CLE141A            Date 28Apr16               *
      *                 CLE141             Date 08Feb16               *
      *                 CLE134             Date 01Aug12               *
      *                 CLE148             Date 23Jul12               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      *                 CSC042             Date 16Feb09               *
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      *                 244589             Date 19Dec06               *
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 223215             Date 06Jun06               *
      *                 CLE042             Date 06Sep05               *
      *                 237466             Date 24Mar06               *
      *                 CSD031             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 CSW037A            Date 02May05               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 CLE025             Date 20Oct03               *
      *                 CGL029             Date 01Sep03               *
      *                 CLE028             Date 27Jun02               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.05 -----------------------------------------------*
      *                 193413             Date 17May01               *
      * Midas DBA 3.03 -----------------------------------------------*
      * Midas DBA 3.02 -----------------------------------------------*
      *                 163486             Date 13Oct99               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 154799             Date 24Feb99               *
      *                 140163             DATE 28Apr99               *
      *                 146126             Date 27Apr99               *
     F*                 CEU020             Date 13Mar98               *
     F*                 127048             Date 26Feb98               *
     F*                 124026             DATE 16OCT97               *
     F*                 CLE005             DATE 22MAY97               *
     F*                 CLE004             DATE 02DEC96               *
     F*                 101841             DATE 22MAY96               *
     F*                 100373             DATE 22MAY96               *
     F*                 103278             DATE 16MAY96               *
     F*                 S01408             DATE 11DEC95               *
     F*                 060308             DATE 16OCT95               *
     F*                 S01408             DATE 30AUG95               *
     F*                 S01408             DATE 25JUL95               *
     F*                 S01408             DATE 13DEC94               *
     F*                 S01408             DATE 19AUG94               *
     F*                 S01392             DATE 14SEP92               *
     F*                 E26745             DATE 01APR92               *  *
     F*                 BHF816             DATE 01APR92               *  *
     F*                 BHF737             DATE 01APR92               *  *
     F*                 BHF736             DATE 01APR92               *  *BHF431
     F*                 S01339             DATE 29JUL91               *
     F*                 MOF60              DATE 29JUL91               *
     F*                 BHF431             DATE 14AUG90               *
     F*                 BHF420             DATE 13AUG90               *
     F*                 BHF417             DATE 13AUG90               *
     F*                 S01260             DATE 23MAY90               *
     F*                 S01194             DATE 12JAN90               *
     F*                 S01117             DATE 27/09/89              *
     F*                 S01195             DATE 27/09/89              *
     F*                 S01153             DATE 06/05/88              *
     F*                                                               *
     F*---------------------------------------------------------------*
     F*                                                               *
      *  CSD103 - LIBOR Deregulation - Common Layer/Standing Data     *
      *  MD054101 - When loan fee and CLE141 is ON, access CLOAN to   *
      *             ensure that correct currency/location combination *
      *             was used in holiday checking.                     *
      *  MD053873 - Set fee currency as first basis for checking      *
      *             currency holiday setup. Then, use settlement      *
      *             currency when CLE031 is ON and value is not blank *
      *  MD052216 - Lending Fee's Payment Due and Taken Day           *
      *  MD046248 - Finastra Rebranding                               *
      *  CLE154 - Loan Repayment Schedule Enhancement                 *
      *           (Amendable Payment Type)                            *
      *  CLE141A - CLE141 Change Control 1                            *
      *  CLE141 - Currency and Location Business Day Convention       *
      *           for LE Transactions                                 *
      *  CLE134 - Past Due Call Loan Processing (Recompile)           *
      *  CLE148 - Alpha Loan Reference                                *
      *  CSC042 - COB Performance Fix
      *           Reduce number of calls to AOBRCHR* At RZB this AO   *
      *           is called more than 920K times for 200 branches     *
      *  244589 - Enhance report for syndicated loans.                *
      *  223215 - Get repayment due date to reflect actual date of    *
      *           repayment event.  FIX IS PART OF 237466.            *
      *  CLE042 - Extended Loan Sub Type                              *
      *  237466 - Interest and repayment date should be shown in      *
      *           Financial loans diary in its actual date and not the*
      *           taken date.  Applied fix 236098.                    *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  CLE025 - Credit Lines (Recompile)                            *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  CLE028 - Flat Rate Personal Loans (Rule of 78s)              *
     F*  193413 - Ensure hash totalling is done for event type 'V5'   *
     F*           (Principal Transfer to) if CLE004 and CEU020 are on.*
     F*  163486 - Recompiled due to changes in LVENTL1.               *
     F*  154799 - Recompiled due to changes in /COPY,ZACCH            *
     F*  140163 - The amount shown on the Financial Loans Diary is    *
     F*           equal to 0 for loans with processing type 70.       *
     F*           Apply fix 003837 and fix 034364.                    *
     F*  146126 - Add 'X2' event into Financial Loans Diary to show   *
     F*           interest capitalised.                               *
     F*  CEU020 - EMU Lending Multi-currency Rollover                 *
     F*  127048 - Events are generated even after a loan has past     *
     F*           dues. Extract these additional events for printing  *
     F*           on the Financial Loans Diary.                       *
     F*         - For future-valued rollover of discount loans, show  *
     F*           Rollover Principal amount, not zero. Update file    *
     F*           controls for R3 events - 'New Principal' for        *
     F*           rollover of discount loan.                          *
     F*  124026 - File controls out of balance in LE0691 due to       *
     F*           incorrect trailer set up in this program.           *
     F*  CLE005 - Customer Lending Enhancements - Others (T3)         *
     F*  CLE004 - Customer Lending Enhancements - Syndications        *
     F*  101841 - Fee currency should be shown on the Financial Loans *
     F*           Diary.                                              *
     F*  100373 - Fee sequence should be passed to LVEDIF1.           *
     F*       103278 - FOR PARTICIPATIONS PURCHASED WITH RECOURSE     *
     F*                INDICATOR NOT EQUAL TO Y LE0690 CORRECTLY      *
     F*                REPORTS THE ORIGINAL BORROWER NUMBER BUT WITH  *
     F*                THE AGENTS CUSTOMERS NAME AND TOWN. (CORE FIX) *
     F*       S01408 - Addition of hook LE0680CCP1                    *
     F*       060308 - FOR LOAN FEE EVENTS, OUTPUT THE EVENT CCY TO   *
     F*                BOTH THE COMMITMENT AND DRAWDOWN CCY FIELDS TO *
     F*                SHOW THE FINANACIAL LOANS DIARY CORRECTLY.     *
     F*       S01408 - Addition of hook LE0680OOP1                    *
     F*       S01408 - Addition of hook LE0680IIPG                    *
     F*                Addition of hook LE0680OOPG                    *
     F*       S01408 - Addition of hook LE0680CCPG                    *
     F*       S01408 - Addition of hook LE0680CRSP                    *
     F*       S01392 - JAPANESE SUB MODULE ENHANCEMENTS                  *S01392
     F*       E26745 - INCORRECT CHECK ON RECOURSE IND - IT IS NOW Y/N   *
     F*       BHF816 - ONLY ADD TO OUTREC IF ADDING TO HASH TOTAL ALSO   *
     F*       BHF737 - EXTRA EXTRACT RECORD WITH ZERO AMT CREATED UNDER  *BHF737
0008 F*                SOME CASES                                        *BHF737
     F*       BHF736 - EXCLUDE INTERBRANCH EVENTS FROM THE EXTRACT FILE  *BHF431
     F*  S01339 - Remove Syndicated Loans Processing, due to Module   *
     F*           redundancy.                                         *
     F*  MOF60  - Customer Profitability and Fees Processing.         *
     F*  BHF431 - If Original Borrower Number is zero, don't Output.  *
     F*  BHF420 - Should use 6 zoned version of OLNO.                 *
     F*  BHF417 - Should call AOCUSTR0, not SDCUSTR0.                 *
     F*  S01260 - ORIGINAL BORROWER ON PARTICIPATIONS PURCHASED.      *   S01260
     F*  S01194 - STANDING DATA CHANGES.                              *   S01194
     F*  S01117 - MULTIBRANCHING.                                     *   S01117
     F*  S01195 - HOLIDAY AMENDMENT.                                  *
     F*  S01153 - CLOSE OF BUSINESS ENHANCEMENTS.                     *
     F*                                                               *
     F*****************************************************************
     F*                                                               *
     F*  C R E A T I O N     P A R A M E T E R S                      *
     F*                                                               *
     F*                                                               *
     F*****************************************************************
      *
0011 F*VENT***IP**F     400 17AI     2 DISK                               S01153
0011 F***LVENTL1*IP**F     400 17AI     2 DISK                     S01153 CLE004
     F***LVENTL1 IP  F     410 17AI     2 DISK                                         CLE004 CGL029
     F*LVENTL1*IP  F     416 17AI     2 DISK                                           CGL029 CLE042
     F*LVENTL1*IP  F     420 17AI     2 DISK                                           CLE042 CLE154
     FLVENTL1 IP  F     421 17AI     2 DISK                                                   CLE154
     FCLOAN   IF  E           K        DISK                                                   237466
     F            CLOANHHF                          KIGNORE                                   237466
     F            CLOANCKF                          KIGNORE                                   237466
     F            CLOANZ1F                          KIGNORE                                   237466
     FLEFEEDL0IF  E           K        DISK                                                 MD052216
     FLEFEEXQDIF  E           K        DISK                                                 MD052216
0012 F*SLDEX***IS**F*****128*10AI*****2 DISK                           U1 S01339
0013 F*TABLE***IF  F      96 12AI     2 DISK
0014 FLVEDIH2 O   F     128            DISK
0014 F***LVEDIF1*O***F     128            DISK                            100373
     F***LVEDIF1*O***F     131            DISK                     100373 CLE004
     F*LVEDIF1*O   F     132            DISK                                           CLE004 CLE042
     F***LVEDIF1 O   F     194            DISK                                         CLE042 244589
     F*LVEDIF1*O   F     211            DISK                                           244589 CLE154
     FLVEDIF1 O   F     212            DISK                                                   CLE154
0014 FLVEDIT2 O   F     128            DISK
     F/COPY WNCPYSRC,LE0680F001
0015 F*E0680P1O** F     132     OF     PRINTER                  S01124    S01117
0015 FLE0680AUO   F     132     OF     PRINTER                            S01117
      /EJECT
     F*****************************************************************
     F*                                                               *
     F*  F U N C T I O N   O F   I N D I C A T O R S                  *
     F*                                                               *
0017 F*    01  - LVENT HEADER                                         *
0018 F*  02-09 - LVENT DETAIL RECS,POSSIBLY REQUIRED FOR OUTPUT       *
0019 F*    10  - LVENT DETAIL RECS,OTHER LIVE RECS-NOT OUTPUT         *
0020 F*****11**-*LVENT*TRAILER*****************************************   S01153
     F*    11  - LVENT DETAIL RECS - TYPE 'X2'                            146126
0021 F*****12**-*LVENT*CATCHALL****************************************   S01153
0022 F*****13**-*SLDEX*HEADER******************************************   S01339
0023 F*****14**-*SLDEX*DETAIL******************************************   S01339
0024 F*****15**-*SLDEX*TRAILER*****************************************   S01339
0025 F*****16**-*SLDEX*CATCHALL****************************************   S01339
0026 F*****17**-*I/C*DATA*REC.ONE)*************************************   S01194
0027 F*****18**-*I/C*DATA*REC.TWO*)-TABLE******************************   S01194
0028 F*****19**-*HOLIDAY*RECS.****)************************************   S01194
0029 F*****20**-*TABLE*ACCESS*ERROR************************************   S01194
0029 F*    21  - Identifies Loan fee event                            *   MOF60
      *    23  - Read of Fee Detail Main and Extension File           *                     MD052216
     F*    27  - LVENT DETAIL RECS - TYPE 'R3'                            S01392
     F*    28  - LVENT DETAIL RECS - TYPE 'R4'                            S01392
0030 F*                                                               *
0031 F*    30  - EVENT DATE (LVENT) < OR = DAYNO TEN > RUN DATE       *
0032 F*    31  - EVENT DATE = RUN DATE                                *
0033 F*****32**-*OUTPUT*LDEX*REC***************************************   S01339
0034 F*    33  - WITHHOLDING TAX INDICATOR BLANK                      *
0035 F*    34  - EVENT AMOUNT NEGATIVE                                *
0035 F*    35  - INTERBRANCH EVENT, DON'T OUTPUT TO EXTRACT FILE      *   BHF736
     F*    37  - USED FOR EVENT TYPE '63R3' '63R4' & '63R5'           *   S01392
0036 F*                                                               *
     F*    40  - GUARANTEE ISSUED                                     *
     F*    41  - DISCOUNT LOAN                                        *
     F*    50  - CLE004 is switched on                                *   CLE004
     F*    51  - Event type 'R7'                                      *   CLE004
     F*    52  - Event type 'V5'                                      *   CLE004
     F*    53  - Event type 'R9'                                      *   CLE004
     F*    54  - Event type 'V7'                                      *   CLE004
      *    55  - Event type 'H2'                                      *                       CLE028
     F*    60  - CEU020 is switched on                                *   CEU020
      *    61  - CLE028 is switched on                                *                       CLE028
0037 F*    70  - LVENT CONTROLS OUT OF BALANCE                        *
0038 F*****71**-*SLDEX*CONTROLS*OUT*OF*BALANCE*************************   S01339
     F*    81  - PARTICIPATION PURCHASED                              *   S01260
     F*    83  - RECOURSE INDICATOR = N                               *   S01260
0039 F*                                                               *
0040 F*****U1**-*COMM.*LOANS*DETAIL*EXTRACT*FILE*PRESENT***************   S01339
0040 F*    U8  - CONTROLS OUT OF BALANCE                              *
     F*  U7+U8 - Database Error                                       *
     F*                                                               *
     F*****************************************************************
     E/EJECT
0042 E***********         HCCY       25  3               HOLIDAY CURENCIESS01195
0043 E*
     E/COPY ZSRSRC,ZDATE2Z1                                                                   237466
     E/COPY ZSRSRC,ZHOLE                                                  S01195
     E                    CPY@    1   1 80
     E                    ##BR      999  3               Branch codes                         CSC042
     E                    ##BC      999  3               Company codes                        CSC042
     I/EJECT
0045 I*
0046 I***LVENT*-*HEADER****                                               S01153
0046 I** LVENT - HEADER                                                   S01153
0045 I*                                                                   S01153
0047 I*VENT***NS**01   1 CH                                               S01153
0047 ILVENTL1 NS  01   1 CH                                               S01153
0048 I                                        1   1 RECI
0049 I*
0050 I*
0051 I***LVENT*-*DETAIL****                                               S01153
0051 I** LVENTL1 - DETAIL                                                 S01153
0052 I        NS  02   1 CL  16 CV  17 C1
0053 I       OR   03   1 CL  16 CM  17 C1
0054 I       OR   04   1 CL  16 CR  17 C5
0055 I       OR   05   1 CL  16 CV  17 C3
0056 I       OR   06   1 CL  16 CI  17 C2
0057 I       OR   07   1 CL  16 CR  17 C2
0058 I       OR   08   1 CL  16 CR  17 C1
0059 I       OR   09   1 CL  16 CF  17 C2
0059 I       OR   11   1 CL  16 CX  17 C2                                 146126
0059 I       OR   21   1 CL  16 CF  17 C1                                 MOF60
     I       OR   27   1 CL  16 CR  17 C3                                 S01392
     I       OR   28   1 CL  16 CR  17 C4                                 S01392
     I       OR   51   1 CL  16 CR  17 C7                                 CLE004
     I       OR   52   1 CL  16 CV  17 C5                                 CLE004
     I       OR   53   1 CL  16 CR  17 C9                                 CLE004
     I       OR   54   1 CL  16 CV  17 C7                                 CLE004
     I       OR   55   1 CL  16 CH  17 C2                                                     CLE028
0060 I       OR   10   1 CL
     I/COPY WNCPYSRC,LE0680I001
0061 I                                        1   1 RECI
0062 I***********                             2   70LNRF                                      CLE148
     I                                        2   7 LNRF                                      CLE148
0063 I************                            8  130CNUM                                      CSD027
     I                                        8  13 CNUM                                      CSD027
0064 I                                       14  17 ETYP
     I                                       14  150PTYP
0065 I*
0066 I                                    P  18  200EDAT
0067 I                                    P  21  270EAMT          34
0068 I                                       28  30 ECCY
0069 I                                       31  320ECSS
     I                                       33  34 LTYP
0071 I                                       35  36 SUTP
0072 I***********                            37  390BRCD                  S01117
0072 I                                       37  39 BRCA                  S01117
0073 I                                    P  40  457INTR
0074 I                                       46  46 NGII
0075 I                                    P  47  490OTHD
0076 I                                    P  50  560OTHA
0077 I                                       57  59 FCCY
0078 I                                       60  610FCSS
0079 I                                       62  620ECDP
0080 I                                       63  630FCDP
0081 I                                    P  64  700DBCE
0082 I                                    P  71  770BCEQ
0083 I                                    P  78  848DBCR
0084 I                                    P  85  910DFCE
0085 I                                    P  92  980FCEQ
0086 I                                    P  99 1058DFCR
0087 I                                      106 106 FIPI
0088 I                                      107 1080SETP
0089 I**********                            109 120 OSAC                                      CGL029
0090 I**********                            121 130 TSEN                                      CGL029
0091 I**********                            131 140 FACO                                      CGL029
0092 I**********                            141 170 SPI1                                      CGL029
0093 I**********                            171 200 SPI2                                      CGL029
0094 I**********                            201 230 SPI3                                      CGL029
0095 I**********                            231 231 INOI                                      CGL029
0096 I**********                            232 2370CPAR                                      CGL029
0097 I**********                            238 2380PARI                                      CGL029
0098 I**********                            239 258 CRNM                                      CGL029
0099 I**********                            259 268 CTWN                                      CGL029
0100 I**********                            269 276 CASK                                      CGL029
0101 I**********                            277 296 PRNM                                      CGL029
0102 I**********                            297 306 PTWN                                      CGL029
0103 I**********                            307 314 PASK                                      CGL029
0104 I**********                            315 3200FCUS                                      CGL029
0105 I**********                            321 3230FTYP                                      CGL029
0106 I**********                            324 3250FSEQ                                      CGL029
0107 I**********                            326 327 CRSK                                      CGL029
0108 I**********                            328 329 REGC                                      CGL029
0109 I**********                            330 331 CDOM                                      CGL029
0110 I**********                            332 333 RDOM                                      CGL029
0111 I**********                            334 3360LASN                                      CGL029
0112 I**********                            337 337 FREQ                                      CGL029
0113 I**********                            338 338 WTIN                                      CGL029
0114 I**********                          P 339 3447WTRT                                      CGL029
0115 I**********                          P 345 3510CPAM                                      CGL029
0116 I**********                            352 352 AUTO                                      CGL029
0117 I**********                            353 3530MRIN                                      CGL029
0118 I**********                            354 355 ACOF                                      CGL029
0119 I**********                            356 356 RCSI                                      CGL029
     I**********                            363 363 IBRE                               BHF736 CGL029
     I************                          381 3840OLNO            S01260BHF420
     I**********                            381 3860OLNO                               BHF420 CGL029
     I**********                            410 410 GASI                               CLE004 CGL029
     I                                      109 126 OSAC                                      CGL029
     I                                      127 136 TSEN                                      CGL029
     I                                      137 146 FACO                                      CGL029
     I                                      147 176 SPI1                                      CGL029
     I                                      177 206 SPI2                                      CGL029
     I                                      207 236 SPI3                                      CGL029
     I                                      237 237 INOI                                      CGL029
     I***********                           238 2430CPAR                                CGL029CSD027
     I                                      238 243 CPAR                                      CSD027
     I                                      244 2440PARI                                      CGL029
     I                                      245 264 CRNM                                      CGL029
     I                                      265 274 CTWN                                      CGL029
     I                                      275 282 CASK                                      CGL029
     I                                      283 302 PRNM                                      CGL029
     I                                      303 312 PTWN                                      CGL029
     I                                      313 320 PASK                                      CGL029
     I**********                            321 3260FCUS                               CGL029 CSD027
     I                                      321 326 FCUS                                      CSD027
     I                                      327 3290FTYP                                      CGL029
     I                                      330 3310FSEQ                                      CGL029
     I                                      332 333 CRSK                                      CGL029
     I                                      334 335 REGC                                      CGL029
     I                                      336 337 CDOM                                      CGL029
     I                                      338 339 RDOM                                      CGL029
     I                                      340 3420LASN                                      CGL029
     I                                      343 343 FREQ                                      CGL029
     I                                      344 344 WTIN                                      CGL029
     I                                    P 345 3507WTRT                                      CGL029
     I                                    P 351 3570CPAM                                      CGL029
     I                                      358 358 AUTO                                      CGL029
     I                                      359 3590MRIN                                      CGL029
     I                                      360 361 ACOF                                      CGL029
     I                                      362 362 RCSI                                      CGL029
     I                                      369 369 IBRE                                      CGL029
     I***********                           387 3920OLNO                                CGL029CSD027
     I                                      387 392 OLNO                                      CSD027
     I                                      416 416 GASI                                      CGL029
     I                                      417 420 CLAS                                      CLE042
     I                                      421 4210REPT                                      CLE154
     I*                                                                   S01408
     I/COPY WNCPYSRC,LE0680IIPG                                           S01408
     I*                                                                   S01408
0121 I*
0122 I***LVENT*-*TRAILER**                                                S01153
0123 I********NS**11   1 CT                                               S01153
0124 I************                            1   1 RECI                  S01153
0125 I************                            2   60NOREL                 S01153
0126 I************                        P   7  140HRWNL                 S01153
0127 I                                    P  15  160HRDCL
0128 I*
0130 I***LVENT*-*CATCHALL                                                 S01153
0131 I********NS**12                                                      S01153
0131 I        NS  12                                                      S01117
0132 I************                            1   1 RECI                  S01153
      *                                                                                       237466
      ** Fields for program described CLOAN.                                                  237466
      *                                                                                       237466
     ICLOANCLF                                                                                237466
     I              RECI                            MRECI                                     237466
     I              LNRF                            MLNRF                                     237466
     I              LTYP                            MLTYP                                     237466
     I              SUTP                            MSUTP                                     237466
     I              FCUS                            MFCUS                                     237466
     I              INTR                            MINTR                                     237466
     I              WTRT                            MWTRT                                     237466
     I              FCCY                            MFCCY                                     237466
     I              CRSK                            MCRSK                                     237466
     I              FACO                            MFACO                                     237466
     I              IBDT                            MIBDT                                     237466
     I              MDAT                            MMDAT                                     237466
     I              RBDT                            MRBDT                                     237466
     I              CPAM                            MCPAM                                     237466
     I              AUTO                            MAUTO                                     237466
     I              MRIN                            MMRIN                                     237466
     I              ACOF                            MACOF                                     237466
     I              RCSI                            MRCSI                                     237466
     I              ORBR                            MORBR                                     237466
     I              BRCA                            MBRCA                                     237466
     I              OLNO                            MOLNO                                     237466
     I              BOKC                            MBOKC                                     237466
     I              PTFR                            MPTFR                                     237466
     I              NRPD                            MNRPD                                     237466
     I              NIDT                            MNIDT                                     237466
     I              PCRF                            MPCRF                                     244589
     I              LPFI                            MLPFI                                     244589
      *                                                                                       CLE141
     IACCY        DS                             30                                           CLE141
     I                                        1   3 C1PI                                      CLE141
     I                                        4   6 C2PI                                      CLE141
     I                                        7   9 C3PI                                      CLE141
     I                                       10  12 C4PI                                      CLE141
     I                                       13  15 C5PI                                      CLE141
     I                                       16  18 C6PI                                      CLE141
     I                                       19  21 C7PI                                      CLE141
     I                                       22  24 C8PI                                      CLE141
     I                                       25  27 C9PI                                      CLE141
     I                                       28  30 C0PI                                      CLE141
     IALOC        DS                             30                                           CLE141
     I                                        1   3 L1PI                                      CLE141
     I                                        4   6 L2PI                                      CLE141
     I                                        7   9 L3PI                                      CLE141
     I                                       10  12 L4PI                                      CLE141
     I                                       13  15 L5PI                                      CLE141
     I                                       16  18 L6PI                                      CLE141
     I                                       19  21 L7PI                                      CLE141
     I                                       22  24 L8PI                                      CLE141
     I                                       25  27 L9PI                                      CLE141
     I                                       28  30 L0PI                                      CLE141
0133 I*
0135 I***SLDEX*-*HEADER                                                   S01339
0136 I*SLDEX***NS**13***1*CH                                              S01339
0137 I********************************        1   1 RECI                  S01339
     I********************************                                    S01339
0140 I***LDEX*-*DETAIL****************                                    S01339
0141 I********NS**14***1*CD***********                                    S01339
0142 I********************************        1   1 RECI                  S01339
0143 I********************************        2   2 EVNT                  S01339
0144 I********************************        3   80BWCN                  S01339
0145 I********************************        9   9 CONI                  S01339
0146 I********************************       10  10 CDTI                  S01339
0147 I********************************       11  12 ACOC                  S01339
0148 I********************************    P  13  150EVND                  S01339
0149 I********************************       16  210LNRF                  S01339
0150 I********************************       22  22 EVNF                  S01339
0151 I********************************    P  23  290AMNT          34      S01339
0152 I********************************       30  350DDRF                  S01339
0153 I********************************       36  38 CMCY                  S01339
0154 I********************************       39  41 DDCY                  S01339
0155 I********************************    P  42  440RFXD                  S01339
0156 I********************************       45  500AGNT                  S01339
0157 I********************************    P  51  570RPYA                  S01339
0158 I********************************    P  58  640INTA                  S01339
0159 I********************************       65  65 WTXI                  S01339
0160 I********************************       66  670OFCD                  S01339
0161 I********************************       68  75 CASK                  S01339
0162 I********************************       76  95 CRNM                  S01339
0163 I********************************       96 105 CTWN                  S01339
0164 I********************************      106 116 SPARE1          S01117S01339
0164 I********************************      106 125 SPARE1          S01117S01339
0165 I********************************      117 1190BRCD            S01117S01339
0166 I********************************      120 128 SPARE2          S01117S01339
0165 I********************************      126 128 BRCA            S01117S01339
0167 I****DEFINE*WHOLE*RECORD*FOR*OUTPUT                                  S01339
0168 I********************************        1 128 DEXLOT                S01339
0169 I********************************                                    S01339
0170 I********************************                                    S01339
0171 I****LDEX*-*TRAILER**************                                    S01339
0172 I********NS**15***1*CT***********                                    S01339
0173 I********************************        1   1 RECI                  S01339
0174 I********************************    P   2   40NORE                  S01339
0175 I********************************    P   5  120HRWN                  S01339
0176 I********************************    P  13  140HRDC                  S01339
0177 I****LDEX*-*CATCHALL*************                                    S01339
0178 I********NS**16******************                                    S01339
0179 I********************************        1   1 RECI                  S01339
0183 I*
0184 I*****TABLE*FILE*-*INSTALLATION*CONTROL*DATA*RECORD*1.               S01194
0185 I**********                                                          S01194
0186 I*TABLE***NS  17   2 C0   3 C1  12 C1                                S01194
0187 I*******AND      13 C0                                               S01194
0188 I**********                              1   1 RECI                  S01194
0189 I**********                              2   30RECT                  S01194
0190 I**********                             12  130RCDE                  S01194
0191 I**********                             14  66 TITL                  S01194
0192 I**********                             67  67 DATF                  S01194
0193 I***********                            68  700DFBR                  S01194
0194 I**********                             74  74 MODI1                 S01194
0195 I**********                             75  75 MODI2                 S01194
0196 I**********                             76  76 MODI3                 S01194
0197 I**********                          P  77  790RUND                  S01194
0198 I**********                             80  86 RUNA                  S01194
0199 I**********                             87  870SFLG                  S01194
0200 I**********                          P  90  920LCD                   S01194
0201 I**********                             93  93 CHTP                  S01194
0202 I**********                          P  94  960TNLU                  S01194
0203 I**********                                                          S01194
0204 I**********                                                          S01194
0205 I*****TABLE*FILE*-*INSTALLATION*CONTROL*DATA*RECORD*2.               S01194
0206 I**********                                                          S01194
0207 I*TABLE***NS  18   1 CD   2 C0   3 C1                                S01194
0208 I*******AND      12 C1  13 C1                                        S01194
0209 I**********                              1   1 RECI                  S01194
0210 I**********                              2   30RECT                  S01194
0211 I**********                             12  130RCDE                  S01194
0212 I**********                             14  16 BCCY                  S01194
0213 I**********                             17  19 BCYL                  S01194
0214 I**********                             20  22 HOCY                  S01194
0215 I**********                             23  280HEAD                  S01194
0216 I**********                          P  29  310APDA                  S01194
0217 I**********                             35  35 APFQ                  S01194
0218 I**********                          P  36  380LOGS                  S01194
0219 I**********                             39  40 CUZR                  S01194
0220 I**********                          P  41  430DNWD                  S01194
0221 I**********                             44  460BVLP                  S01194
0222 I***********                            47  49 LOCY                  S01195
0223 I**********                             50  510FDAY                  S01194
0224 I**********                             52  52 ACLD                  S01194
0225 I**********                             53  53 MBIN                  S01194
0226 I**********                             86  86 ISAV                  S01194
0227 I**********                          P  87  890LLOG                  S01194
0228 I**********                          P  90  920LCD                   S01194
0229 I**********                             93  93 CHTP                  S01194
0230 I**********                          P  94  960TNLU                  S01194
0231 I*****TABLE*FILE*-*HOLIDAY*RECORD.*                                  S01194
0232 I********E-EXCLUDE,*I-INCLUDE.*                                      S01194
0233 I************                                                        S01194
0234 I*TABLE***NS* 19   1 CD   2 C2   3 C2                                S01195
0235 I*******AND*     14 CE                                               S01195
0236 I*******OR**      1 CD   2 C2   3 C2                                 S01195
0237 I*******AND*     14 CI                                               S01195
0238 I***********                             1   1 RECI                  S01195
0239 I***********                             2   30RECT                  S01195
0240 I***********                             8  120HOL                   S01195
0241 I***********                            13  130SREC                  S01195
0242 I***********                            14  14 INEX                  S01195
0243 I***********                            15  89 HCCY                  S01195
0244 I***********                         P  90  920LCD                   S01195
0245 I***********                            93  93 CHTP                  S01195
0246 I***********                         P  94  960TNLU                  S01195
     I*                                                                   S01194
0248 I***TABLE*CATCH****ALL                                               S01194
0249 I*TABLE***NS                                                         S01194
0250 I**********                              1   1 RECI                  S01194
0251 I**
0252 I** L.D.A.
0253 ILDA        UDS                            256
0344 I***********                           134 138 DBFILE                S01117
0345 I***********                           139 167 DBKEY                 S01117
0346 I***********                           168 175 DBPGM                 S01117
0347 I***********                           176 177 DBASE                 S01117
0344 I                                      134 141 DBFILE                S01117
0345 I                                      142 170 DBKEY                 S01117
0346 I                                      171 180 DBPGM                 S01117
0347 I                                      181 1830DBASE                 S01117
     ISDBRCH    E DSSDBRCHPD                                              S01117
      **  EXTERNAL DS FOR BRANCH CODE DETAILS                             S01117
     I              A8CMCD                          CMPYM                 S01194
     ISDBANK    E DSSDBANKPD                                              S01195
      **  EXTERNAL DS FOR BANK DETAILS                                    S01195
     I              BJURPT                          TITL                  S01194
     I              BJLCCY                          LOCY                  S01194
     I              BJDFIN                          DATF                  S01194
     I              BJMRDT                          RUNA                  S01194
     I              BJRDNB                          RUND                  S01194
     I              BJSLCD                          SYSL                  S01194
     I*                                                                   S01194
     ISDGELR    E DSSDGELRPD                                              S01194
      **  EXTERNAL DS FOR GENERAL LEDGER DETAILS                          S01194
      *                                                                   S01194
     I*                                                                   S01260
     ISDCUST    E DSSDCUSTPD                                              S01260
     I              QQDFAC                          QQDFA1                                    CGL029
      **  EXTERNAL DS FOR CUSTOMER DETAILS                                S01260
      *                                                                   CLE004
     ISDNOST    E DSSDNOSTPD                                                                  237466
      **  External DS for Nostro Details                                                      237466
     I              QQACCD                          QQACC2                                    237466
     I              A7NOSN                          CSNM                                      237466
     ISCSARD    E DSSCSARDPD                                              CLE004
      ** SAR File Details Accessed via Access Program AOSARDR0            CLE004
     I*                                                                   S01260
     IDSFDY     E DSDSFDY                                                 S01194
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01194
     I*                                                                   S01194
     IDSSDY     E DSDSSDY                                                 S01194
     I* SECOND DS FOR ACCESS PROGRAMS, LONG DATA STRUCTURE                S01194
     I*                                                                   S01194
     IDSCSNM      DS                             10                                           237466
      ** Data area for the location code in customer shortname field                          237466
     I                                        8  10 NRLC                                      237466
     I/COPY ZSRSRC,ZHOLI                                                  S01195
     I*
     C/EJECT
      *****************************************************************
      *                                                               *
      *  Main Processing.                                             *
      *                                                               *
      *****************************************************************
      *
     C           PLIST1    PLIST                                          S01260
     C                     PARM '*BLANKS' @RTCD                           S01260
     C                     PARM '*KEY   ' @OPTN                           S01260
     C                     PARM           KEYC   10                       S01260
     C                     PARM           KEYSTS  7                       S01260
     C           SDCUST    PARM SDCUST    DSSDY                           S01260
     C*
      ** Set up copyright statement
     C**********           MOVEACPY@      BIS@   80                                           CSC042
     C** PARAMETER LIST FOR PROGRAM 'AOGELRR0'                            S01194
     C           PLISTA    PLIST                                          S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C********** SDGELR    PARM SDGELR    DSFDY                                        S01194 CGL029
     C           SDGELR    PARM SDGELR    DSSDY                                               CGL029
     C           *NAMVAR   DEFN           LDA                             S01194
     C           *LOCK     IN   LDA                                       S01194
      *                                                                                       CLE141
     C           BDCHK     PLIST                                                              CLE141
     C                     PARM           ZDAYNO                                              CLE141
     C                     PARM           ACCY                                                CLE141
     C                     PARM           ALOC                                                CLE141
     C                     PARM           PAYIND  1                                           CLE141
     C                     PARM           DATF                                                CLE141
     C                     PARM           ZCCY                                               CLE141A
     C                     PARM           ZLOC                                               CLE141A
     C                     PARM *ZEROS    ZADJDT  50                                          CLE141
      *                                                                                       237466
      ** Key list for CLOANCL of CLOAN.                                                       237466
      *                                                                                       237466
     C           KLNRF     KLIST                                                              237466
     C                     KFLD           LNRF                                                237466
     C                     KFLD           KRTP    1                                           237466
     C                     MOVE 'A'       KRTP                                                237466
      *                                                                                     MD052216
      ** Key list for Fee Main and Extension File                                           MD052216
      *                                                                                     MD052216
     C           KFEE      KLIST                                                            MD052216
     C                     KFLD           CNUM                                              MD052216
     C                     KFLD           WFACL                                             MD052216
     C                     KFLD           WLNRF                                             MD052216
     C                     KFLD           WFSEQ                                             MD052216
     C*                                                                   S01194
     C                     Z-ADD0         ZERO15 150                                          CLE042
0258 C     N01             GOTO BY01
     C                     MOVEACPY@      BIS@   80                       CSC042
0259 C*
0260 C** FIRST CYCLE CALCS
0261 C*
0262 C** SETUP DATABASE ERROR REFERENCE
0263 C                     MOVEL'LE0680  'DBPGM
0264 C                     MOVEL'     '   DBFILE
0265 C*
     C**                                                                  S01195
     C**   ACCESS BANK DETAILS FOR SYSTEM LOCATION CODE                   S01195
     C**                                                                  S01195
     C                     CALL 'AOBANKR0'                                S01195
     C                     PARM '*MSG   ' @RTCD   7                       S01195
     C                     PARM '*FIRST ' @OPTN   7                       S01195
     C           SDBANK    PARM SDBANK    DSFDY                           S01195
     C*                                                                   S01195
     C           @RTCD     IFNE *BLANKS                                   S01195
     C                     SETON                     U7U8LR               S01195
     C                     MOVEL'SDBANKPD'DBFILE                          S01195
     C                     MOVEL@OPTN     DBKEY            ************** S01195
     C                     Z-ADD05        DBASE            ** DBERR 5 *** S01195
     C                     GOTO END                        ************   S01195
     C                     END                                            S01195
     C*    CHECK SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.                    S01194
     C           DATF      COMP 'M'                      98MMDDYY, 98 ON  S01194
0266 C** ACCESS I/C ONE
0267 C**********           EXSR ZSYSTM                                    S01194
0268 C*********99          SETON                     U7U8                 S01194
0269 C*********99          MOVEL'TABLE'   DBFILE                          S01194
0270 C*********99          MOVELZTABKY    DBKEY                           S01194
0271 C*********99          MOVEL'01'      DBASE            ** DBASE  01 **S01194
0272 C*********99          GOTO END                                       S01194
0273 C*
0274 C** ACCESS I/C TWO.
0275 C**********           MOVEL'01      'ZTABKY                          S01194
0276 C**********           MOVE '  11'    ZTABKY                          S01194
0277 C**********           EXSR TABCHN                                    S01194
     C**********           CALL 'AOGELRR0'PLISTA                          S01194              CGL029
     C                     CALL 'AOGELRR1'PLISTA                                              CGL029
     C           @RTCD     IFNE *BLANKS                                   S01194
     C                     SETON                     U7U8                 S01194
     C                     MOVE '02'      DBASE                           S01194
     C                     MOVE 'SDGELRPD'DBFILE                          S01194
     C                     GOTO END                                       S01194
     C                     END                                            S01194
      *                                                                   CLE004
      ** Determine if Customer Lending Enhancements - Syndications        CLE004
      ** (CLE004) is installed                                            CLE004
      *                                                                   CLE004
     C                     CALL 'AOSARDR0'                                CLE004
     C                     PARM *BLANKS   @RTCD                           CLE004
     C                     PARM '*VERIFY' @OPTN                           CLE004
     C                     PARM 'CLE004'  PSARD   6                       CLE004
     C           SCSARD    PARM SCSARD    DSFDY                           CLE004
     C                     MOVE 'N'       CLE004  1                       CLE004
     C                     MOVE '0'       *IN50                           CLE004
      *                                                                   CLE004
      ** If feature is on, set up SAR work flag                           CLE004
      *                                                                   CLE004
     C           @RTCD     IFEQ *BLANKS                                   CLE004
     C                     MOVE 'Y'       CLE004                          CLE004
     C                     MOVE '1'       *IN50                           CLE004
     C                     ELSE                                           CLE004
      *                                                                   CLE004
      ** else, database error (return code other than *NRF)               CLE004
      *                                                                   CLE004
     C           @RTCD     IFNE '*NRF   '                                 CLE004
     C                     MOVEL'SCSARDPD'DBFILE           ************   CLE004
     C                     MOVEL'*VERIFY' DBKEY            * DBERR 04 *   CLE004
     C                     Z-ADD4         DBASE            ************   CLE004
     C                     MOVE '1'       *INU7                           CLE004
     C                     MOVE '1'       *INU8                           CLE004
     C                     GOTO END                                       CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE005
      ** Determine if Customer Lending Enhancements - Others              CLE005
      ** (CLE005) is installed.                                           CLE005
      *                                                                   CLE005
     C                     CALL 'AOSARDR0'                                CLE005
     C                     PARM *BLANKS   @RTCD                           CLE005
     C                     PARM '*VERIFY' @OPTN                           CLE005
     C                     PARM 'CLE005'  PSARD                           CLE005
     C           SCSARD    PARM SCSARD    DSFDY                           CLE005
     C                     MOVE 'N'       CLE005  1                       CLE005
      *                                                                   CLE005
      ** If feature is on, set up SAR work flag                           CLE005
      *                                                                   CLE005
     C           @RTCD     IFEQ *BLANKS                                   CLE005
     C                     MOVE 'Y'       CLE005                          CLE005
     C                     ELSE                                           CLE005
      *                                                                   CLE005
      ** else, database error (return code other than *NRF)               CLE005
      *                                                                   CLE005
     C           @RTCD     IFNE '*NRF   '                                 CLE005
     C                     MOVEL'SCSARDPD'DBFILE           ***************CLE005
     C                     MOVEL'CLE005 ' DBKEY            * DB ERROR 06 *CLE005
     C                     Z-ADD006       DBASE            ***************CLE005
     C                     MOVE '1'       *INU7                           CLE005
     C                     MOVE '1'       *INU8                           CLE005
     C                     GOTO END                                       CLE005
     C                     ENDIF                                          CLE005
     C                     ENDIF                                          CLE005
      *                                                                                       237466
      ** Access SAR details file to see if CEU004 is installed                                237466
      *                                                                                       237466
     C                     MOVE 'N'       CEU004  1                                           237466
      *                                                                                       237466
     C                     CALL 'AOSARDR0'                                                    237466
      *                                                                                       237466
     C                     PARM '       ' @RTCD   7                                           237466
     C                     PARM '*VERIFY' @OPTN   7                                           237466
     C                     PARM 'CEU004'  P@SARD  6                                           237466
      *                                                                                       237466
     C           SCSARD    PARM SCSARD    DSFDY                                               237466
      *                                                                                       237466
     C           @RTCD     IFEQ *BLANK                                                        237466
     C                     MOVE 'Y'       CEU004                                              237466
      *                                                                                       237466
     C                     ENDIF                                                              237466
      *                                                                   CEU020
      ** Check if CEU020 is Installed                                     CEU020
      *                                                                   CEU020
     C                     CALL 'AOSARDR0'                                CEU020
     C                     PARM *BLANKS   @RTCD                           CEU020
     C                     PARM '*VERIFY' @OPTN                           CEU020
     C                     PARM 'CEU020'  PSARD   6                       CEU020
     C           SCSARD    PARM SCSARD    DSFDY                           CEU020
     C           @RTCD     IFEQ *BLANKS                                   CEU020
     C                     MOVE 'Y'       CEU020  1                       CEU020
     C                     MOVE '1'       *IN60                           CEU020
     C                     ELSE                                           CEU020
     C                     MOVE 'N'       CEU020                          CEU020
     C                     MOVE '0'       *IN60                           CEU020
     C           @RTCD     IFNE '*NRF    '                                CEU020
     C                     MOVEL'SCSARDPD'DBFILE           ***************CEU020
     C                     MOVEL'CEU020'  DBKEY            * DB ERROR 11 *CEU020
     C                     Z-ADD011       DBASE            ***************CEU020
     C                     MOVE '1'       *INU7                           CEU020
     C                     MOVE '1'       *INU8                           CEU020
     C                     GOTO END                                       CEU020
     C                     ENDIF                                          CEU020
     C                     ENDIF                                          CEU020
      *                                                                                       CLE028
      ** Determine if Flat Rate Personal Loans (Rule of 78s) is                               CLE028
      ** installed                                                                            CLE028
      *                                                                                       CLE028
     C                     CALL 'AOSARDR0'                                                    CLE028
     C                     PARM *BLANKS   PRTCD   7                                           CLE028
     C                     PARM '*VERIFY' POPTN   7                                           CLE028
     C                     PARM 'CLE028'  PSARD                                               CLE028
     C           SCSARD    PARM SCSARD    DSFDY                                               CLE028
      *                                                                                       CLE028
     C           PRTCD     IFNE *BLANKS                                                       CLE028
     C           PRTCD     ANDNE'*NRF   '                                                     CLE028
     C           *LOCK     IN   LDA                                                           CLE028
     C                     MOVEL'SCSARDPD'DBFILE                                              CLE028
     C                     Z-ADD12        DBASE                                               CLE028
     C                     MOVELPSARD     DBKEY                                               CLE028
     C                     OUT  LDA                                                           CLE028
     C                     MOVE *ON       *INU7                                               CLE028
     C                     MOVE *ON       *INU8                                               CLE028
     C                     GOTO END                                                           CLE028
     C                     ENDIF                                                              CLE028
      *                                                                                       CLE028
     C           PRTCD     IFEQ *BLANKS                                                       CLE028
     C                     MOVE 'Y'       CLE028  1                                           CLE028
     C                     MOVE *ON       *IN61                                               CLE028
     C                     ELSE                                                               CLE028
     C                     MOVE 'N'       CLE028                                              CLE028
     C                     MOVE *OFF      *IN61                                               CLE028
     C                     ENDIF                                                              CLE028
      *                                                                                       CLE141
      ** Determine if CLE141 is switched ON                                                   CLE141
      *                                                                                       CLE141
     C                     MOVEL'N'       CLE141  1                                           CLE141
     C                     CALL 'AOSARDR0'                                                    CLE141
     C                     PARM *BLANKS   PRTCD                                               CLE141
     C                     PARM '*VERIFY' POPTN                                               CLE141
     C                     PARM 'CLE141'  PSARD                                               CLE141
     C           SCSARD    PARM SCSARD    DSFDY                                               CLE141
     C           PRTCD     IFEQ *BLANKS                                                       CLE141
     C                     MOVEL'Y'       CLE141                                              CLE141
     C                     ENDIF                                                              CLE141
      *                                                                                       CLE154
      ** Access SAR file to determine if CLE154 is switched ON.                               CLE154
      *                                                                                       CLE154
     C                     CALL 'AOSARDR0'                                                    CLE154
     C                     PARM *BLANKS   PRTCD   7                                           CLE154
     C                     PARM '*VERIFY' POPTN   7                                           CLE154
     C                     PARM 'CLE154'  PSARD                                               CLE154
     C           SCSARD    PARM SCSARD    DSFDY                                               CLE154
      *                                                                                       CLE154
     C           PRTCD     IFNE *BLANKS                                                       CLE154
     C           PRTCD     ANDNE'*NRF   '                                                     CLE154
     C           *LOCK     IN   LDA                                                           CLE154
     C                     MOVEL'SCSARDPD'DBFILE                                              CLE154
     C                     Z-ADD13        DBASE                                               CLE154
     C                     MOVELPSARD     DBKEY                                               CLE154
     C                     OUT  LDA                                                           CLE154
     C                     MOVE *ON       *INU7                                               CLE154
     C                     MOVE *ON       *INU8                                               CLE154
     C                     GOTO END                                                           CLE154
     C                     ENDIF                                                              CLE154
      *                                                                                       CLE154
     C           PRTCD     IFEQ *BLANKS                                                       CLE154
     C                     MOVE 'Y'       CLE154  1                                           CLE154
     C                     SETON                     29                                       CLE154
     C                     ELSE                                                               CLE154
     C                     MOVE 'N'       CLE154                                              CLE154
     C                     ENDIF                                                              CLE154
      *                                                                                     MD053873
      ** Check if CLE031 is switched on                                                     MD053873
      *                                                                                     MD053873
     C                     MOVEL'N'       CLE031  1                                         MD053873
     C                     CALL 'AOSARDR0'                                                  MD053873
     C                     PARM *BLANKS   PRTCD                                             MD053873
     C                     PARM '*VERIFY' POPTN                                             MD053873
     C                     PARM 'CLE031'  PSARD                                             MD053873
     C           SCSARD    PARM SCSARD    DSFDY                                             MD053873
     C           PRTCD     IFEQ *BLANKS                                                     MD053873
     C                     MOVEL'Y'       CLE031                                            MD053873
     C                     ENDIF                                                            MD053873
      *                                                                   CLE005
0278 C*****N20**           GOTO BY02                                      S01194
0279 C**********           MOVEL'02'      DBASE            ** DBASE  02 **S01194
0280 C**********           GOTO END                                       S01194
0281 C*
0282 C           BY02      TAG                             ** BY02  TAG **
0283 C*
0284 C** INITIATE COUNTS & SETUP BLANK FIELDS
0284 C***(OUTREC*is*now*given*an*initial*value*of*1*because*records**S01339 0045
0284 C***from*SLDEX*are*no*longer*processed*and*therefore*their*headeS01339 0045
0284 C***record*should*not*be*counted).******************************S01339 0045
0285 C*************        Z-ADD2         OUTREC  50                      S01339
0285 C*********************Z-ADD1         OUTREC  50                 S01339 0045
     C                     Z-ADD2         OUTREC  50                        0045
0286 C                     Z-ADD1         LVREC   50
0287 C                     Z-ADD0         P5      50
0288 C                     Z-ADD0         P13    130
0289 C                     MOVE ' '       BL128 128
0290 C*
0291 C** CALCULATE RUN DATE + TEN WORKING DAYS
0292 C                     Z-ADD10        ZNRDYS
     C*                                                                   S01408
     C/COPY WNCPYSRC,LE0680CCP1                                           S01408
     C*                                                                   S01408
0293 C                     Z-ADDRUND      ZDAYNO
0294 C                     MOVE LOCY      ZCCY
     C                     MOVE SYSL      ZLOC                            S01195
0295 C***********          EXSR ZDATE3                                    S01195
     C                     EXSR ZFWDT                                     S01195
     C                     Z-ADDZDYNBR    WDYNBR  50                                          237466
     C**                                                                  S01408
     C/COPY WNCPYSRC,LE0680CCPG                                           S01408
     C*                                                                   S01408
     C                     Z-ADD0         ##BNDX  40                                          CSC042
     C           *LIKE     DEFN ##BNDX    B                                                   CSC042
     C           *LIKE     DEFN ##BNDX    ##BSV                                               CSC042
      *                                                                                       CSC042
0296 C           BY01      TAG                             ** BY01  TAG **
0297 C*
0298 C***********          SETOF                     303132               MOF60
0298 C                     SETOF                     3031                 MOF60
     C                     SETOF                     4041
0299 C                     SETOF                     33
     C                     SETOF                     83                   S01260
0300 C*
     C                     SETOF                     35                   BHF736
     C           IBRE      IFEQ 'Y'                                       BHF736
     C                     SETON                     35                   BHF736
     C                     END                                            BHF736
     C/COPY WNCPYSRC,LE0680C001
     C*                                                                   BHF736
0301 C*  RECORD UNREQUIRED FOR PROCESSING
0302 C******01****                                                        S01153
0303 C*R****12****                                                        S01153
0302 C      01                                                            S01153
     C*OR****13********                                             S01117S01339
0304 C*OR***16*********                                                   S01339
     COR    35                                                            BHF736
     COR    12             GOTO END                                 S01117S01339
     C**                                                                  S01117
     C******15***          GOTO END2                                S01117MOF60
     C*                                                                   MOF60
     C** For Facility Fees due, Loan number should be zero and Event      MOF60
     C** Currency should be blank.                                        MOF60
     C************IN21     IFEQ '1'                                 MOF60 060308
     C           *IN09     IFEQ '1'                                       060308
     C**********           Z-ADD0         LNRF                                          MOF60 CLE148
     C                     MOVEL*BLANKS   LNRF                                                CLE148
     C***********          MOVE *BLANKS   ECCY                      MOF60 101841
     C                     END                                            MOF60
0305 C*
     C**                                                                  S01117
     C** To get COMPANY CODE                                              S01117
     C* Check whether details for Branch already in array                                     CSC042
     C                     MOVELBRCA      ##KB                                                CSC042
     C                     EXSR ##CHKB                                                        CSC042
      * If branch is in the array then use the details                                        CSC042
     C           ##FIC     IFEQ 'Y'                        *** B10                            CSC042
     C                     EXSR ##SETB                                                        CSC042
     C                     ELSE                            *** X10                            CSC042
     C**********           CALL 'AOBRCHR0'                                S01117              CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       S01117
     C                     PARM '*KEY   ' @OPTN   7                       S01117
     C                     PARM BRCA      @DSNB   3                       S01117
     C********** SDBRCH    PARM SDBRCH    DSFDY                           S01117              CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANKS                                   S01117
     C                     MOVEL@DSNB     DBKEY            ***********    S01117
     C                     MOVEL'SDBRCHPD'DBFILE           * DBERR 10*    S01117
     C                     Z-ADD10        DBASE            ***********    S01117
     C                     SETON                     U7U8LR               S01117
     C                     GOTO END                                       MOF60
     C***********          GOTO END                                       S01117
     C                     ELSE                                                               CSC042
      * Details found on the DB so add them to the array                                      CSC042
      * if the array still has room                                                           CSC042
     C                     EXSR ##ADDB                                                        CSC042
     C                     END                                            S01117
     C                     ENDIF                           *** E10                            CSC042
     C**                                                                  S01117
     C           END2      TAG                             ** END2 TAG ** S01117
     C**                                                                  S01117
0306 C***PERFORM*REQUIRED*PROCESSING*FOR*EACH*REC.*TYPE****************   MOF60
0307 C******11****         EXSR LVTR                                      S01153
0308 C******11****         GOTO END                                       S01153
0309 C******13***          EXSR LDHR                                      S01339
0310 C******13***          GOTO END                                       S01339
0311 C******14***          EXSR LDDT                                      S01339
0312 C******14***          GOTO END                                       S01339
0313 C******15***          EXSR LDTR                                      S01339
0314 C******15***          GOTO END                                       S01339
0315 C*
0316 C*  IF NOT ANY OF ABOVE REC MUST BE LVENT DETAIL
0317 C                     EXSR LVDT
0318 C*
0319 C           END       TAG                             ** END  TAG ***
     C*                                                                   MOF60
0320 C   U7
0321 COR U8                SETON                     LR
     C**
     C*   PRODUCE A PROGRAM DUMP IF DATABASE ERROR OCCUR                  S01117
     C**                                                                  S01117
     CLR U7 U8             EXSR *PSSR                                     S01117
      *
      *****************************************************************
      /EJECT
     C********************************************************************                    CSC042
      *                                                                                       CSC042
      * ##CHKB - Subroutine to check the Branch in the arrays                                 CSC042
      *                                                                                       CSC042
     C           ##CHKB    BEGSR                                                              CSC042
      *                                                                                       CSC042
     C           *LIKE     DEFN A8BRCD    ##KB                                                CSC042
      *                                                                                       CSC042
      * Set off the branch found indicator                                                    CSC042
     C                     MOVEL*BLANK    ##FIC   1                                           CSC042
      *                                                                                       CSC042
      * Save the state of indicator 30 so it can be reset at the end                          CSC042
      * of the SR as it may be used elsewhere in the code                                     CSC042
     C           *IN30     IFEQ *ON                                                           CSC042
     C                     MOVEL'Y'       #IN30   1                                           CSC042
     C                     ELSE                                                               CSC042
     C                     MOVEL'N'       #IN30                                               CSC042
     C                     ENDIF                                                              CSC042
      *                                                                                       CSC042
     C                     SETOF                         30                                   CSC042
      *                                                                                       CSC042
      * Restore the saved Value of B                                                          CSC042
     C                     Z-ADD##BSV     B                                                   CSC042
      *                                                                                       CSC042
     C* Check whether details for Branch already in array                                     CSC042
      *                                                                                       CSC042
      * Is this the same as the last LOKUP, if so we can bypass                               CSC042
      * the LOKUP                                                                             CSC042
      * Defend against B being 0                                                              CSC042
     C           B         IFEQ 0                                                             CSC042
     C                     Z-ADD1         B                                                   CSC042
     C                     ENDIF                                                              CSC042
      *                                                                                       CSC042
      * If the branch being checked is the same then use these                                CSC042
      * details rather than doing a LOKUP                                                     CSC042
     C           ##KB      IFEQ ##BR,B                                                        CSC042
      * Found so seton 30                                                                     CSC042
     C                     SETON                         30                                   CSC042
     C                     ELSE                                                               CSC042
     C                     Z-ADD1         B                                                   CSC042
     C           ##KB      LOKUP##BR,B                   30                                   CSC042
     C                     ENDIF                                                              CSC042
      *                                                                                       CSC042
      * Save the last update to B                                                             CSC042
     C           *IN30     IFEQ *ON                                                           CSC042
     C                     Z-ADDB         ##BSV                                               CSC042
      * Set the indicator to show the data was found                                          CSC042
     C                     MOVEL'Y'       ##FIC                                               CSC042
     C                     ENDIF                                                              CSC042
      *                                                                                       CSC042
      * Reset the state of indicator 30.                                                      CSC042
     C           #IN30     IFEQ 'Y'                                                           CSC042
     C                     MOVEL*ON       *IN30                                               CSC042
     C                     ELSE                                                               CSC042
     C                     MOVEL*OFF      *IN30                                               CSC042
     C                     ENDIF                                                              CSC042
      *                                                                                       CSC042
     C                     ENDSR                                                              CSC042
      ********************************************************************                    CSC042
      /EJECT                                                                                  CSC042
      ********************************************************************                    CSC042
      *                                                                                       CSC042
      * ##SETB - Sets up the SDBRCHPD fields used in the code from the                        CSC042
      * arrays                                                                                CSC042
      *                                                                                       CSC042
     C           ##SETB    BEGSR                                                              CSC042
      *                                                                                       CSC042
     C                     MOVEL##BR,B    A8BRCD                                              CSC042
     C                     MOVEL##BC,B    CMPYM                                               CSC042
      *                                                                                       CSC042
     C                     ENDSR                                                              CSC042
      *                                                                                       CSC042
      ********************************************************************                    CSC042
      /EJECT                                                                                  CSC042
      ********************************************************************                    CSC042
      *                                                                                       CSC042
      * ##ADDB - Adds the SDBRCHPD fields used in the code to the                             CSC042
      * arrays                                                                                CSC042
      *                                                                                       CSC042
     C           ##ADDB    BEGSR                                                              CSC042
      *                                                                                       CSC042
      * If there is still room in the array then add the details                              CSC042
     C           ##BNDX    IFLT 999                                                           CSC042
     C                     ADD  1         ##BNDX                                              CSC042
     C                     Z-ADD##BNDX    B                                                   CSC042
     C                     MOVELA8BRCD    ##BR,B                                              CSC042
     C                     MOVELCMPYM     ##BC,B                                              CSC042
     C                     ENDIF                                                              CSC042
      *                                                                                       CSC042
      * Update ##BSV  so next call to ##CHKB checks this latest adddition                     CSC042
      * to the array first                                                                    CSC042
     C                     Z-ADDB         ##BSV                                               CSC042
      *                                                                                       CSC042
     C                     ENDSR                                                              CSC042
      ********************************************************************                    CSC042
      /EJECT                                                                                  CSC042
      ********************************************************************                    CSC042
      *****************************************************************
      *                                                               *
0326  *  LVDT   - SUBROUTINE HANDLES LVENT DETAIL RECORDS             *
0327  *                                                               *
      *****************************************************************
0327  *
0328 C           LVDT      BEGSR                           **LVDT BEGSR***
0329 C*
0330 C*  INCREMENT CONTROLS
0331 C           LVREC     ADD  1         LVREC
0332 C           EAMT      DIV  1000      ZZAMT
0333 C         34          Z-SUBZZAMT     ZZAMT
0334 C                     Z-ADDLVINT     ZZTOTI
0335 C                     Z-ADDLVDEC     ZZTOTD
0336 C                     EXSR GLZADD
0337 C                     Z-ADDZZTOTI    LVINT  150
0338 C                     Z-ADDZZTOTD    LVDEC   30
0339 C*
0340 C***BYPASS*REMAINING*CALCS*FOR*UNREQUIRED*EVENT*TYPES****            S01153
0341 C******10***          GOTO LVDEND                                    S01153
     C**                                                                  S01392
     C   27                                                               S01392
     COR 28      PTYP      COMP 63                       30ON, ROLL DISC. S01392
     C   27N30                                                            S01392
     COR 28N30             GOTO LVDEND                                    S01392
      *                                                                                       237466
      ** Get repayment base date to reflect actual event date.                                237466
      *                                                                                       237466
     C           KLNRF     CHAINCLOAN                14                                       237466
      *                                                                                       237466
     C           *IN14     IFEQ '0'                                                           237466
     C           LASN      ANDEQ0                                                             237466
      *                                                                                       237466
      ** Check if repayment event date was obtaind from base date.                            237466
      *                                                                                       237466
     C           CLE005    IFEQ 'Y'                                                           237466
     C                     Z-ADD0         ZNRDYS                                              237466
     C                     Z-ADD0         WEDAT   50                                          237466
     C                     EXSR SRSCUR                                                        237466
     C                     EXSR MATLOC                                                        237466
     C                     MOVE ZCCY      ZCCY3   3                                           237466
     C                     MOVE ZLOC      ZLOC3   3                                           237466
     C                     MOVE ZCCY2     ZCCY                                                237466
     C                     MOVE W@MDSL    ZLOC                                                237466
     C           *IN06     IFEQ '1'                                                           237466
     C                     Z-ADDMIBDT     WEDAT                                               237466
     C                     ENDIF                                                              237466
     C           *IN03     IFEQ '1'                                                           237466
     C                     Z-ADDMMDAT     WEDAT                                               237466
     C                     ENDIF                                                              237466
     C           *IN08     IFEQ '1'                                                           237466
     C           *IN07     OREQ '1'                                                           237466
     C                     Z-ADDMRBDT     WEDAT                                               237466
     C                     ENDIF                                                              237466
     C                     Z-ADDWEDAT     ZDAYNO                                              237466
     C           CLE141    IFEQ 'Y'                                                           CLE141
     C********** MDST      ANDEQ01                                                    CLE141 CLE141A
     C********** CLE141    OREQ 'Y'                                                   CLE141 CLE141A
     C********** MDST      ANDEQ07                                                    CLE141 CLE141A
     C********** CLE141    OREQ 'Y'                                                   CLE141 CLE141A
     C********** MDST      ANDEQ08                                                    CLE141 CLE141A
     C********** CLE141    OREQ 'Y'                                                   CLE141 CLE141A
     C********** MDST      ANDEQ02                                                    CLE141 CLE141A
     C********** CLE141    OREQ 'Y'                                                   CLE141 CLE141A
     C********** MDST      ANDEQ12                                                    CLE141 CLE141A
     C                     MOVELPTDI      PAYIND                                              CLE141
     C                     CALL 'LEZBDYCD'BDCHK                                               CLE141
     C                     MOVELZADJDT    ZDYNBR                                              CLE141
     C                     ELSE                                                               CLE141
     C                     SELEC                                                              237466
     C           PTDI      WHEQ 'P'                                                           237466
     C                     EXSR ZBKDT                                                         237466
     C           PTDI      WHEQ 'N'                                                           237466
     C                     EXSR ZFWDT                                                         237466
     C           PTDI      WHEQ 'M'                                                           237466
     C           PTDI      OREQ ' '                                                           237466
     C                     EXSR ZDATE2                                                        237466
     C           *IN98     IFEQ *OFF                                                          237466
     C                     MOVE ZDATE     MMYY    40P                                         237466
     C                     MOVELMMYY      MMNLCD  20P                                         237466
     C                     ELSE                                                               237466
     C                     MOVELZDATE     MMNLCD    P                                         237466
     C                     ENDIF                                                              237466
     C                     Z-ADDZDAYNO    @DAYNO  50                                          237466
     C                     EXSR ZFWDT                                                         237466
     C                     Z-ADDZDYNBR    ZDAYNO                                              237466
     C                     EXSR ZDATE2                                                        237466
     C           *IN98     IFEQ *OFF                                                          237466
     C                     MOVE ZDATE     MMYY      P                                         237466
     C                     MOVELMMYY      MMNWKD  20P                                         237466
     C                     ELSE                                                               237466
     C                     MOVELZDATE     MMNWKD    P                                         237466
     C                     ENDIF                                                              237466
     C           MMNLCD    IFNE MMNWKD                                                        237466
     C                     Z-ADD@DAYNO    ZDAYNO                                              237466
     C                     EXSR ZBKDT                                                         237466
     C                     ENDIF                                                              237466
     C                     ENDSL                                                              237466
     C                     ENDIF                                                              CLE141
     C                     Z-ADDZDYNBR    WEDAT                                               237466
     C                     MOVE ZCCY3     ZCCY                                                237466
     C                     MOVE ZLOC3     ZLOC                                                237466
     C                     ENDIF                                                              237466
      *                                                                                       237466
      ** If event type is I2.                                                                 237466
      *                                                                                       237466
     C           *IN06     IFEQ '1'                                                           237466
     C           WEDAT     ANDEQEDAT                                                          237466
     C                     Z-ADDMNIDT     EDAT                                                237466
     C                     ENDIF                                                              237466
      *                                                                                       237466
      ** If event type is R1 or  R2.                                                          237466
      *                                                                                       237466
     C           *IN08     IFEQ '1'                                                           237466
     C           WEDAT     ANDEQEDAT                                                          237466
     C           *IN07     OREQ '1'                                                           237466
     C           WEDAT     ANDEQEDAT                                                          237466
     C                     Z-ADDMNRPD     EDAT                                                237466
     C                     ENDIF                                                              237466
      *                                                                                       237466
      ** If event type is M1 OR M2.                                                           237466
      *                                                                                       237466
     C           *IN03     IFEQ '1'                                                           237466
     C           WEDAT     ANDEQEDAT                                                          237466
     C                     Z-ADDMMDAT     EDAT                                                237466
     C                     ENDIF                                                              237466
      *                                                                                       237466
     C                     ENDIF                                                              237466
      *                                                                                     MD052216
      ** Get fee payment base date to reflect actual event date                             MD052216
      *                                                                                     MD052216
     C           *IN09     IFEQ *ON                                                         MD052216
     C           LASN      ANDNE*ZEROS                                                      MD052216
     C           *IN21     OREQ *ON                                                         MD052216
     C           LASN      ANDNE*ZEROS                                                      MD052216
      *                                                                                     MD052216
     C           ETYP      IFEQ '71F2'                                                      MD052216
     C                     MOVELFTYP      WFACL   50                                        MD052216
     C                     MOVE FSEQ      WFACL                                             MD052216
     C                     MOVEL*BLANKS   WLNRF   6                                         MD052216
     C                     ENDIF                                                            MD052216
      *                                                                                     MD052216
     C           ETYP      IFEQ '71F1'                                                      MD052216
     C                     Z-ADD*ZEROS    WFACL                                             MD052216
     C                     MOVELLNRF      WLNRF                                             MD052216
     C                     ENDIF                                                            MD052216
      *                                                                                     MD052216
     C                     MOVE LASN      WFSEQ   20                                        MD052216
     C           KFEE      CHAINLEFEEDL0             23                                     MD052216
     C           *IN23     IFEQ *OFF                                                        MD052216
     C           KFEE      CHAINLEFEEXQD             23                                     MD052216
     C                     ENDIF                                                            MD052216
      *                                                                                     MD052216
     C           *IN23     IFEQ *OFF                                                        MD052216
     C           FECALT    ANDNE*BLANKS                                                     MD052216
      *                                                                                     MD052216
      ** Set fee payment date                                                               MD052216
      *                                                                                     MD052216
     C           FELPDT    IFGT RUND                                                        MD052216
     C                     Z-ADDFELPDT    WENPYD  50                                        MD052216
     C                     ELSE                                                             MD052216
     C                     Z-ADDFENPYD    WENPYD                                            MD052216
     C                     ENDIF                                                            MD052216
      *                                                                                     MD052216
     C           WENPYD    IFEQ *ZEROS                                                      MD052216
     C                     Z-ADDFEPEND    WENPYD                                            MD052216
     C                     ENDIF                                                            MD052216
      *                                                                                     MD052216
     C                     Z-ADDFQFPBD    WEDAT                                             MD052216
     C                     EXSR CHKPAY                                                      MD052216
     C           WEDAT     IFEQ EDAT                                                        MD052216
     C                     Z-ADDWENPYD    EDAT                                              MD052216
     C                     ENDIF                                                            MD052216
      *                                                                                     MD052216
     C                     ENDIF                                                            MD052216
     C                     ENDIF                                                            MD052216
0342 C*
0343 C*  CHECK EVENT DATE TO SEE IF RECORD TO BE OUTPUT
0344 C********** EDAT      COMP ZDYNBR                 3030                                   237466
     C           EDAT      IFLE WDYNBR                                                        237466
     C                     MOVE '1'       *IN30                                               237466
     C                     ELSE                                                               237466
     C                     MOVE '0'       *IN30                                               237466
     C                     ENDIF                                                              237466
0345 C         30EDAT      COMP RUND                   3131
0346 C      30 31          SETOF                     30
     C**                                                                  S01392
     C***********ETYP      COMP '63R3'                   37         S01392127048
     C***37******          Z-ADDEAMT      NPEAMT 130       NEW PRINCS01392127048
     C***37******          SETOF                     30             S01392127048
     C           ETYP      COMP '63R4'                   37               S01392
     C   37                Z-ADDEAMT      OPEAMT 130       CURR PRINC     S01392
     C   37                SETOF                     30                   S01392
     C           ETYP      COMP '63R5'                   37               S01392
     C***37******OPEAMT    SUB  NPEAMT    DIFFA  130       PRIN REPAS01392127048
     C   37                Z-ADDEAMT      NEWDIS 130       NEW DISCOUNT   127048
     C   37                SETOF                     30                   127048
     C           ETYP      COMP '63R3'                   37               127048
     C   37                Z-ADDEAMT      NPEAMT 130       NEW PRINC      127048
     C   37      OPEAMT    SUB  NPEAMT    DIFFA  130       PRINC REPAY    127048
0347 C*
0348 C     N30             GOTO LVDEND
     C**
     C** SET INDICATORS FOR PROCESSING TYPE IF MATURITY EVENT
     C**
     C     N03             GOTO NMAT
     C           PTYP      COMP 70                       40
      *                                                                   CLE005
      ** If CLE005 is *ON, include processing types 71 and 72 when        CLE005
      ** switching on indicator 40 signifying that a risk type loan       CLE005
      ** is being processed.                                              CLE005
      *                                                                   CLE005
     C           CLE005    IFEQ 'Y'                                       CLE005
     C           PTYP      IFEQ 71                                        CLE005
     C           PTYP      OREQ 72                                        CLE005
     C                     MOVE *ON       *IN40                           CLE005
     C                     ENDIF                                          CLE005
     C                     ENDIF                                          CLE005
      *                                                                   CLE005
     C           PTYP      COMP 63                       41
     C     N41   PTYP      COMP 65                       41
     C     N41   PTYP      COMP 67                       41
     C**
     C*                                                                   S01408
     C** Core hook for externalisation.                                   S01408
     C/COPY WNCPYSRC,LE0680CRSP                                           S01408
     C*                                                                   S01408
     C           NMAT      TAG                             ** NMAT TAG*
0349 C*
     C*  IF PARTIC.PURCH. AND RECOURSE INDIC=N, SET ON INDICATOR          S01260
     C*  TO OUTPUT ORIGINAL BORROWER  NUMBER                              S01260
     C           PTYP      COMP 64                       81               S01260
      *                                                                   CLE005
      ** If CLE005 is *ON, include processing types 68 and 71 when        CLE005
      ** switching on indicator 81.                                       CLE005
      *                                                                   CLE005
     C           CLE005    IFEQ 'Y'                                       CLE005
     C           PTYP      IFEQ 68                                        CLE005
     C           PTYP      OREQ 71                                        CLE005
     C                     MOVE *ON       *IN81                           CLE005
     C                     ENDIF                                          CLE005
     C                     ENDIF                                          CLE005
      *                                                                   CLE005
     C  N81      PTYP      COMP 65                       81               S01260
     C*                                                                   S01260
     C***81******RCSI      COMP ' '                      83         S01260E26745
     C   81      RCSI      COMP 'Y'                  8383                 E26745
     C***********OLNO      IFEQ *ZEROS                                    BHF431
     C           OLNO      IFEQ *BLANKS                                   BHF431
     C           MLPFI     OREQ 'I'                                                           244589
     C                     SETOF                     83                   BHF431
     C                     END                                            BHF431
     C  N83                GOTO NOCHAN                                    S01260
     C                     MOVELOLNO      KEYC                            S01260
     C***********          MOVE 'A'       KEYC                      S01260BHF417
     C***********          CALL 'SDCUSTR0'PLIST1                    S01260BHF417
     C                     CALL 'AOCUSTR0'PLIST1                          BHF417
     C           @RTCD     IFNE *BLANKS                                   S01260
     C                     SETON                     U7U8LR***************S01260
     C                     MOVEL'03'      DBASE              DBASE 03     S01260
     C                     MOVE 'SDCUSTPD'DBFILE           ***************S01260
     C                     MOVELKEYC      DBKEY                           S01260
     C                     GOTO LVDEND                                    S01260
     C                     ELSE                                           103278
     C                     MOVELBBCRTN    CTWN                            103278
     C                     MOVELBBCRNM    CRNM                            103278
     C                     END                                            S01260
     C           NOCHAN    TAG                             *** NOCHAN *** S01260
0350 C*
0351 C** ACCUMULATE TOTALS FOR LVEDI TRAILER
0352 C*********  OUTREC    ADD  1         OUTREC                          BHF816
0352 C  N35 30N10OUTREC    ADD  1         OUTREC                          BHF816
     C*                                                                   MOF60
0353 C***02******                                                         140163
     C***OR*03N40                                                         140163
     C***OR*04***                                                         140163
0355 C***OR*05***                                                         140163
0355 C***OR*21***                                                   MOF60 140163
     C***OR*27***                                    R3, TYPE 63   127048 140163
0356 C***OR*09***             GOTO TRAIL                                  140163
0352 C*                                                                   124026
     C           *IN02     IFEQ '1'                                       140163
     C           *IN03     OREQ '1'                                       140163
     C           *IN04     OREQ '1'                                       140163
     C           *IN05     OREQ '1'                                       140163
     C           *IN21     OREQ '1'                                       140163
     C           *IN27     OREQ '1'                                       140163
     C           *IN09     OREQ '1'                                       140163
     C           CLE028    OREQ 'Y'                                                           CLE028
     C           *IN55     ANDEQ*ON                                                           CLE028
     C                     GOTO TRAIL                                     140163
     C                     ENDIF                                          140163
0352 C           CLE004    IFEQ 'N'                                       124026
     C           CEU020    ANDEQ'N'                                       CEU020
0352 C           CLE004    OREQ 'Y'                                       124026
0352 C           *IN52     ANDEQ'0'                                       124026
0352 C           *IN54     ANDEQ'0'                                       124026
     C           CEU020    OREQ 'Y'                                       CEU020
0352 C           CLE004    ANDNE'Y'                                       193413
     C           *IN54     ANDEQ'0'                                       CEU020
0357 C                     GOTO TRBYP
     C                     ENDIF                                          124026
0352 C*                                                                   124026
0358 C           TRAIL     TAG                             ** TRAIL TAG **
0359 C           EAMT      DIV  1000      ZZAMT
0360 C         34          Z-SUBZZAMT     ZZAMT
     C***37******NPEAMT    DIV  1000      ZZAMT            NEW PRINCS01392127048
0361 C                     Z-ADDOUTINT    ZZTOTI
0362 C                     Z-ADDOUTDEC    ZZTOTD
0363 C                     EXSR GLZADD
0364 C                     Z-ADDZZTOTI    OUTINT 150
0365 C                     Z-ADDZZTOTD    OUTDEC  30
0366 C           TRBYP     TAG                             ** TRBYP TAG **
0367 C*
0368 C*  CHECK WITHHOLDING TAX TYPE IND.
0369 C   03
0370 COR 04      WTIN      COMP ' '                      33
0371 C*
0373 C           LVDEND    ENDSR                           ** LVDEND-SR **
      *
      *****************************************************************                     MD052216
      /EJECT                                                                                MD052216
      *****************************************************************                     MD052216
      *                                                                                     MD052216
      *  CHKPAY - Check Payment Taken Day Indicator                                         MD052216
      *                                                                                     MD052216
      *  CALLED FROM: LVDT                                                                  MD052216
      *                                                                                     MD052216
      *  CALLS: CCYLOC                                                                      MD052216
      *                                                                                     MD052216
      *****************************************************************                     MD052216
     C           CHKPAY    BEGSR                                                            MD052216
      *                                                                                     MD052216
     C                     Z-ADDWEDAT     ZDAYNO                                            MD052216
     C                     Z-ADDWEDAT     ZDYNBR                                            MD052216
     C                     Z-ADD*ZEROS    ZNRDYS                                            MD052216
     C                     EXSR CCYLOC                                                      MD052216
      *                                                                                     MD052216
     C           CLE141    IFEQ 'Y'                                                         MD052216
     C           FELOAN    ANDNE*BLANKS                                                     MD052216
      *                                                                                     MD052216
     C           FELOAN    CHAINCLOAN                97                                     MD054101
     C           FQPTDI    IFEQ *BLANK                                                      MD052216
     C                     MOVEL'M'       PAYIND                                            MD052216
     C                     ELSE                                                             MD052216
     C                     MOVELFQPTDI    PAYIND                                            MD052216
     C                     ENDIF                                                            MD052216
     C                     CALL 'LEZBDYCD'BDCHK                                             MD052216
     C                     MOVELZADJDT    ZDYNBR                                            MD052216
      *                                                                                     MD052216
     C                     ELSE                                                             MD052216
     C                     SELEC                                                            MD052216
      *                                                                                     MD052216
     C           FQPTDI    WHEQ 'P'                                                         MD052216
     C                     EXSR ZBKDT                                                       MD052216
      *                                                                                     MD052216
     C           FQPTDI    WHEQ 'N'                                                         MD052216
     C                     EXSR ZFWDT                                                       MD052216
      *                                                                                     MD052216
     C           FQPTDI    WHEQ 'M'                                                         MD052216
     C           FQPTDI    OREQ *BLANK                                                      MD052216
     C                     EXSR ZDATE2                                                      MD052216
     C           *IN98     IFEQ *OFF                                                        MD052216
     C                     MOVE ZDATE     MMYY      P                                       MD052216
     C                     MOVELMMYY      MMNLCD    P                                       MD052216
     C                     ELSE                                                             MD052216
     C                     MOVELZDATE     MMNLCD    P                                       MD052216
     C                     ENDIF                                                            MD052216
     C                     Z-ADDZDAYNO    @DAYNO                                            MD052216
     C                     EXSR ZFWDT                                                       MD052216
     C                     Z-ADDZDYNBR    ZDAYNO                                            MD052216
     C                     EXSR ZDATE2                                                      MD052216
     C           *IN98     IFEQ *OFF                                                        MD052216
     C                     MOVE ZDATE     MMYY      P                                       MD052216
     C                     MOVELMMYY      MMNWKD    P                                       MD052216
     C                     ELSE                                                             MD052216
     C                     MOVELZDATE     MMNWKD    P                                       MD052216
     C                     ENDIF                                                            MD052216
     C           MMNLCD    IFNE MMNWKD                                                      MD052216
     C                     Z-ADD@DAYNO    ZDAYNO                                            MD052216
     C                     EXSR ZBKDT                                                       MD052216
     C                     ENDIF                                                            MD052216
      *                                                                                     MD052216
     C                     ENDSL                                                            MD052216
     C                     ENDIF                                                            MD052216
      *                                                                                     MD052216
     C                     Z-ADDZDYNBR    WEDAT                                             MD052216
      *                                                                                     MD052216
     C                     ENDSR                                                            MD052216
      *****************************************************************                     MD052216
      /EJECT                                                                                MD052216
      *****************************************************************                     MD052216
      *                                                                                     MD052216
      *  CCYLOC - Set currency & location depending on settlement type                      MD052216
      *                                                                                     MD052216
      *  CALLED FROM: CHKPAY                                                                MD052216
      *                                                                                     MD052216
      *  CALLS:                                                                             MD052216
      *                                                                                     MD052216
      *****************************************************************                     MD052216
     C           CCYLOC    BEGSR                                                            MD052216
      *                                                                                     MD052216
      ** If Fee Settlement type is '01', '02', '07', '08' or '12',                          MD052216
      ** use Fee Currency and Nostro location                                               MD052216
      *                                                                                     MD052216
     C           FESTTL    IFEQ 01                                                          MD052216
     C           FESTTL    OREQ 02                                                          MD052216
     C           FESTTL    OREQ 07                                                          MD052216
     C           FESTTL    OREQ 08                                                          MD052216
     C           FESTTL    OREQ 12                                                          MD052216
      *                                                                                     MD052216
     C                     MOVELFEFCCY    PCURR                                             MD053873
      *                                                                                     MD053873
     C           CLE031    IFEQ 'Y'                                                         MD053873
      *                                                                                     MD053873
     C           PTFI      IFEQ *BLANKS                                                     MD053873
     C           FESCCY    ANDNE*BLANKS                                                     MD053873
     C                     MOVELFESCCY    PCURR                                             MD053873
     C                     ENDIF                                                            MD053873
      *                                                                                     MD053873
     C           PTFI      IFNE *BLANKS                                                     MD053873
     C           FEPSCY    ANDNE*BLANKS                                                     MD053873
     C                     MOVELFEPSCY    PCURR                                             MD053873
     C                     ENDIF                                                            MD053873
      *                                                                                     MD053873
     C                     ENDIF                                                            MD053873
      *                                                                                     MD053873
     C                     CALL 'AONOSTR0'                                                  MD052216
     C                     PARM *BLANKS   PRTCD   7                                         MD052216
     C                     PARM '*KEY   ' POPTN   7                                         MD052216
     C                     PARM *BLANKS   PCUSN   6                                         MD052216
     C**********           PARM FEFCCY    PCURR   3                                MD052216 MD053873
     C                     PARM           PCURR   3                                         MD053873
     C                     PARM *BLANKS   PACCD  10                                         MD052216
     C                     PARM *BLANKS   PACSN   2                                         MD052216
     C                     PARM FEOURS    PNONB   2                                         MD052216
     C                     PARM *BLANKS   PBRCA   3                                         MD052216
     C                     PARM *BLANKS   PCSSN  10                                         MD052216
     C                     PARM *BLANKS   PPNOI   1                                         MD052216
     C           SDNOST    PARM SDNOST    DSFDY                                             MD052216
      *                                                                                     MD052216
     C           PRTCD     IFNE *BLANKS                                                     MD052216
     C           *LOCK     IN   LDA                                                         MD052216
     C                     MOVEL'AONOSTR0'DBFILE                                            MD052216
     C                     Z-ADD56        DBASE                                             MD052216
     C                     MOVELFEFCCY    DBKEY                                             MD052216
     C                     OUT  LDA                                                         MD052216
     C                     EXSR *PSSR                                                       MD052216
     C                     ELSE                                                             MD052216
      *                                                                                     MD052216
     C**********           MOVELFEFCCY    ZCCY                                     MD052216 MD053873
     C                     MOVELPCURR     ZCCY                                              MD053873
     C                     MOVE CSNM      ZLOC                                              MD052216
     C                     ENDIF                                                            MD052216
      *                                                                                     MD052216
     C                     ELSE                                                             MD052216
      *                                                                                     MD052216
      ** For other settlement types, use Local Currency & Location                          MD052216
      *                                                                                     MD052216
     C                     MOVE LOCY      ZCCY                                              MD052216
     C                     MOVE SYSL      ZLOC                                              MD052216
      *                                                                                     MD052216
     C                     ENDIF                                                            MD052216
      *                                                                                     MD052216
     C                     ENDSR                                                            MD052216
      *****************************************************************
      /EJECT
      *****************************************************************   S01153
      ***********                                                     *   S01153
0377  ****LVTR-**HANDLE*LVENT*TRAILER**********************************   S01153
      ***********                                                     *   S01153
      *****************************************************************   S01153
0378 C***********                                                     *   S01153
0379 C***********LVTR      BEGSR                           **LVTR BEGSR** S01153
0380 C***********                                                     *   S01153
0381 C***ADD*TO*REC.COUNT**********************************************   S01153
0382 C***********LVREC     ADD  1         LVREC                       *   S01153
0383 C***********                                                     *   S01153
0384 C***COMPARE*TRAILER*TOTALS*TO*THOSE*CALCULATED********************   S01153
0385 C***********NOREL     COMP LVREC                7070             *   S01153
0386 C********N70HRWNL     COMP LVINT                7070             *   S01153
0387 C********N70HRDCL     COMP LVDEC                7070             *   S01153
0388 C*********70          SETON                     U8               *   S01153
0390 C***********                                                     *   S01153
0391 C***********          ENDSR                           **  ENDSR  *** S01153
0392 C***********                                                     *   S01153
0393 C*****************************************************************   S01339
0394 C***********                                                     *   S01339
0395 C***LDHR*-**HANDLES*LDEX*HEADER***********************************   S01339
0396 C***********                                                     *   S01339
0393 C*****************************************************************   S01339
0396 C***********                                                     *   S01339
0397 C***********LDHR      BEGSR                           **LDHR BEGSR** S01339
0398 C***RECORD*COUNT**************************************************   S01339
0399 C***********          Z-ADD0         LDREC   50                  *   S01339
0400 C***********                                                     *   S01339
0401 C***********          ENDSR                           ***  ENDSR ****S01339
0402 C***********                                                     *   S01339
0403 C*****************************************************************   S01339
0404 C***********                                                     *   S01339
0405 C***LDDT*-**HANDLED*LDEX*DETAIL***********************************   S01339
0404 C***********                                                     *   S01339
0403 C*****************************************************************   S01339
0406 C***********                                                     *   S01339
0407 C***********LDDT      BEGSR                           **LDDT BEGSR** S01339
0408 C***ACCUMULATE*FILE*CONTROLS**************************************   S01339
0409 C***********LDREC     ADD  1         LDREC                       *   S01339
0410 C***********          MOVE AMNT      ZZAMT                       *   S01339
0411 C******34***          Z-SUBZZAMT     ZZAMT                       *   S01339
0412 C***********          Z-ADDLDINT     ZZTOTI                      *   S01339
0413 C***********          Z-ADDLDDEC     ZZTOTD                      *   S01339
0414 C***********          EXSR GLZADD                                *   S01339
0415 C***********          Z-ADDZZTOTI    LDINT  150                  *   S01339
0416 C***********          Z-ADDZZTOTD    LDDEC   30                  *   S01339
0417 C***********                                                     *   S01339
0418 C***ADD*TO*LVEDI*TRAILER*TOTALS***********************************   S01339
0419 C***********OUTREC    ADD  1         OUTREC                      *   S01339
0420 C***********          MOVE AMNT      ZZAMT                       *   S01339
0421 C******34***          Z-SUBZZAMT     ZZAMT                       *   S01339
0422 C***********          Z-ADDOUTINT    ZZTOTI                      *   S01339
0423 C***********          Z-ADDOUTDEC    ZZTOTD                      *   S01339
0424 C***********          EXSR GLZADD                                *   S01339
0425 C***********          Z-ADDZZTOTI    OUTINT                      *   S01339
0426 C***********          Z-ADDZZTOTD    OUTDEC                      *   S01339
0427 C***********                                                     *   S01339
0428 C***SETON*OUTPUT*INDICATOR***********                            *   S01339
0429 C***********          SETON                     32               *   S01339
0430 C***********                                                     *   S01339
0431 C***********                                                     *   S01339
0432 C***********          ENDSR                           ***  ENDSR *** S01339
0433 C***********                                                     *   S01339
0434 C*****************************************************************   S01339
0435 C***********                                                     *   S01339
0436 C***LDTR*-*HANDLES*LDEX*TRAILER***********************************   S01339
0437 C***********                                                     *   S01339
0434 C*****************************************************************   S01339
0435 C***********                                                     *   S01339
0438 C***********LDTR      BEGSR                           **LDTR BEGSR** S01339
0439 C***********                                                     *   S01339
0441 C***COMPARE*TRAILER*TOTALS*TO*CALCULATED*TOTALS*******************   S01339
0442 C***********NORE      COMP LDREC                7171             *   S01339
0443 C********N71HRWN      COMP LDINT                7171             *   S01339
0444 C********N71HRDC      COMP LDDEC                7171             *   S01339
0445 C*********71          SETON                     U8               *   S01339
0446 C***********                                                     *   S01339
0447 C***THIS*WILL*BE*LAST*RECORD*READ*********************************   S01339
0448 C***********          SETON                     LR               *   S01339
0449 C***********                                                     *   S01339
0450 C***********                                                     *   S01339
0451 C***********          ENDSR                           **   ENDSR * **S01339
0435 C***********                                                     *   S01339
0452 C*****************************************************************   S01194
0455 C**********                                                      *   S01194
0453 C*****TABCHN---*TO*ACCESS*TABLE*FILE******************************   S01194
0454 C***************ERROR*INDICATOR*=*20******************************   S01194
0455 C**********                                                      *   S01194
0452 C*****************************************************************   S01194
0455 C***********                                                     *   S01194
0456 C***********TABCHN    BEGSR                           **** TABCHN****S01194
0457 C***********                                                     *   S01194
0458 C***********ZTABKY    CHAINTABLE                20               *   S01194
0459 C**N18******          SETON                     20               *   S01194
0460 C******20***          SETON                     U7U8             *   S01194
0461 C******20***          MOVEL'TABLE'   DBFILE                      *   S01194
0462 C******20***          MOVELZTABKY    DBKEY                       *   S01194
0463 C***********                                                     *   S01194
0464 C***********          ENDSR                           **** ENDSR ****S01194
0463 C***********                                                     *   S01194
0465 C*****************************************************************   S01194
0468 C***********                                                     *   S01194
0469 C*****ZSYSTM*SR.*TO*CHAIN*TO*THE*INSTALLATION*CONTROL*DATA*RECORD*   S01194
0470 C**********                                                      *   S01194
0465 C*****************************************************************   S01194
0470 C***********                                                     *   S01194
0471 C***********ZSYSTM    BEGSR                           *** ZSYSTM *** S01194
0472 C***********                                                     *   S01194
0473 C*****SET*UP*KEY*FOR*INSTALLATION*CONTROL*RECORD.*****************   S01194
0474 C***********          MOVEL'01      'ZTABKY 12                   *   S01194
0475 C***********          MOVE '  10'    ZTABKY                      *   S01194
0476 C***********                                                     *   S01194
0477 C***********ZTABKY    CHAINTABLE                99    ON NOT THERE   S01194
0478 C**N99******RECI      COMP 'D'                  9999  ON, IS DELETED S01194
0479 C***********                                                     *   S01194
0480 C*****CHECK*SYSTEM*DATE*FORMAT,*DDMMYY*OR*MMDDYY.*****************   S01194
0481 C***********DATF      COMP 'M'                      98MMDDYY, 98 ON  S01194
0482 C***********                                                     *   S01194
0483 C***********          ENDSR                                      *   S01194
0484 C***********                                                     *   S01194
0486 C*****************************************************************   S01194
      /EJECT
0487  *****************************************************************
0490  *                                                               *
0488  * SUBROUTINE TO ADD AN AMOUNT (ZZAMT) TO THE TOTAL (ZZTOTI,ZZTOTD)
0489  *   IND '99' IS SET BY AN OVERFLOW ERROR                        *
0490  *                                                               *
0487  *****************************************************************
0490  *
0491 CSR         GLZADD    BEGSR                           *** GLZADD ****
0492 C*
0493 CSR                   Z-ADDZZAMT     ZZAMT  153     91-DEFINE ZZAMT
0494 CSR 91                GOTO ZZAEND                     AMT = 0.BYPASS
0495 C*
0496 C* SPLIT ZZAMT INTO INTEGER AND DECIMAL FIELDS
0497 CSR                   Z-ADDZZAMT     ZZAMTI 150       INTEGER FIELD
0498 CSR                   MOVE ZZAMT     ZZAMTD  30       DECIMAL FIELD
0499 C* BOTH ZZAMTI AND ZZAMTD CONTAIN A 'SIGN' ZONE NOW
0500 C*
0501 CSR                   EXSR GLZSUM
0502 CSR         ZZAEND    ENDSR                           ** ZZAEND TAG *
0490  *
0486  *****************************************************************
      /EJECT
0487  *****************************************************************
0490  *                                                               *
0505  * SUBROUTINE TO CARRY OUT THE ADDITION FOR SUBROUTINES -        *
0506  *                        GLZADD, GLZSUB, GLZCMP.                *
0507  *          PARAMETERS PASSED -                                  *
0508  *                     I/P ZZAMTI ZZAMTD                         *
0509  *                     O/P ZZTOTI ZZTOTD ZZNEGD IND 96 IND 99.   *
0490  *                                                               *
0487  *****************************************************************
0510  *
0511 CSR         GLZSUM    BEGSR                           *** GLZSUM ****
0512 C*
0513 CSR                   Z-ADDZZTOTI    ZZTOTI 150       DEFINE ZZTOTI
0514 CSR                   Z-ADDZZTOTD    ZZTOTD  30       DEFINE ZZTOTD
0515 CSR                   SETOF                     919293
0516 CSR                   SETOF                     949599
0517 C*
0518 C*    DETERMINE SIGN OF ZZAMTI & D,   92 IF NEG
0519 CSR         ZZAMTI    COMP 0                      9293
0520 CSR 93      ZZAMTD    COMP 0                      9293
0521 CSR 93                GOTO ZZSEND                     ZERO BYPASS
0522 C*
0523 C*    DETERMINE SIGN OF ZZTOTI & D, 91 IF NEG.
0524 CSR         ZZTOTI    COMP 0                      9193
0525 CSR 93      ZZTOTD    COMP 0                      9193
0526 C*
0527 C*    IF ZZTOTAL IS ZERO, RETURN ZZAMOUNT.
0528 CSR 93                Z-ADDZZAMTI    ZZTOTI
0529 CSR 93                Z-ADDZZAMTD    ZZTOTD
0530 CSR 93                GOTO ZZSEND                     ZERO BYPASS
0531 C*    IF SIGNS DIFFER BYPASS OVERFLOW CHECKS.
0532 CSR 91N92
0533 CORN91 92             GOTO ZZOFPS
0534 C*
0535 CSR         ZZAMTD    ADD  ZZTOTD    ZZWK2   40
0536 CSR         ZZWK2     COMP 999                  93    '93' = CARRY
0537 CSRN93      ZZWK2     COMP -999                   93    INTO INTEGER.
0538 C*
0539 CSR 93N92   ZZAMTI    ADD  1         ZZWK3  150       ADD 'CARRY' +VE
0540 CSR    93 92ZZAMTI    SUB  1         ZZWK3            SUB 'CARRY' -VE
0541 CSR 93      ZZTOTI    ADD  ZZWK3     ZZWK3
0542 CSRN93      ZZTOTI    ADD  ZZAMTI    ZZWK3
0543 C*
0544 C* IF THE MODULUS OF ZZWK3 IS LT MOD. ZZTOTI THEN O/F HAS OCCURED
0545 CSRN92      ZZWK3     COMP ZZTOTI                 99  -92 MEANS NOS.
0546 CSR 92      ZZWK3     COMP ZZTOTI               99     NEGATIVE
0547 CSRN99                Z-ADDZZWK2     ZZTOTD
0548 CSRN99                Z-ADDZZWK3     ZZTOTI
0549 C*
0550 C* IF O/F ZEROIZE ZZAMT , IND '99' SET AND ZZTOT FIELDS LEFT INTACT.
0551 CSR 99                Z-ADD0         ZZAMT  153
0552 CSR                   GOTO ZZSEND
0553 C*
0554 C* THE 'SIGNS' ARE DIFFERENT
0555 CSR         ZZOFPS    TAG                             ** ZZOFPS TAG**
0556 C* IF ZZAMT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZTOT
0557 C*
0558 CSR 92                Z-SUBZZAMTI    ZZAMTI 150
0559 CSR 92                Z-SUBZZAMTD    ZZAMTD  30
0560 C*
0561 C* IF ZZTOT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZAMT.
0562 C*
0563 CSR 91                Z-SUBZZTOTI    ZZTOTI
0564 CSR 91                Z-SUBZZTOTD    ZZTOTD
0565 C* BOTH ZZAMT AND ZZTOT ARE NOW POSITIVE.
0566 C*
0567 CSR         ZZTOTI    COMP ZZAMTI               93  95
0568 CSR 95      ZZTOTD    COMP ZZAMTD               93  95
0569 C*
0570 C* IF ZZTOT EQ. ZZAMT RETURN ZERO.
0571 CSR 95                Z-ADD0         ZZTOTI
0572 CSR 95                Z-ADD0         ZZTOTD
0573 CSR 95                GOTO ZZSEND
0574 C*
0575 C* IF ZZTOT GT. ZZAMT.
0576 CSR 93      ZZAMTD    COMP ZZTOTD               94
0577 CSR 93 94   ZZTOTI    SUB  1         ZZTOTI
0578 CSR 93 94   ZZTOTD    ADD  1000      ZZWK2
0579 CSR 93      ZZTOTI    SUB  ZZAMTI    ZZTOTI
0580 CSR 93 94   ZZWK2     SUB  ZZAMTD    ZZTOTD
0581 CSR 93N94   ZZTOTD    SUB  ZZAMTD    ZZTOTD
0582 C*
0583 C*
0584 C* IF ZZAMT GT. ZZTOT.
0585 CSRN93      ZZTOTD    COMP ZZAMTD               94
0586 CSRN93 94   ZZAMTI    SUB  1         ZZWK3  150
0587 CSRN93 94   ZZAMTD    ADD  1000      ZZWK2
0588 CSRN93 94   ZZWK3     SUB  ZZTOTI    ZZTOTI
0589 CSRN93N94   ZZAMTI    SUB  ZZTOTI    ZZTOTI
0590 CSRN93 94   ZZWK2     SUB  ZZTOTD    ZZTOTD
0591 CSRN93N94   ZZAMTD    SUB  ZZTOTD    ZZTOTD
0592 C*
0593 C* REVERSE SIGN OF ZZTOT IF LARGER I/P FIELDS WERE NEGATIVE
0594 CSR                   SETOF                     94
0595 CSR 93 91
0596 CORN93 92             SETON                     94
0597 CSR 94                Z-SUBZZTOTI    ZZTOTI
0598 CSR 94                Z-SUBZZTOTD    ZZTOTD
0599 C**
0600 C**   RESTORE SIGN OF ZZAMTI & ZZAMTD IF IT WAS REVERSED.
0601 CSR 92                Z-SUBZZAMTI    ZZAMTI
0602 CSR 92                Z-SUBZZAMTD    ZZAMTD
0603 CSR         ZZSEND    TAG                             ** ZZSEND TAG *
0604 C**
0605 C**   IF ZZTOTD IS ZERO, AND ZZTOTI IS NEG. SET UP ZZNEGD.
0606 CSR                   SETOF                     96
0607 CSR         ZZTOTD    COMP 0                        91
0608 CSR 91      ZZTOTI    COMP 0                      96
0609 CSR 96                MOVE '.000-'   ZZNEGD  5
0610 CSR                   ENDSR                             ** ENDSR **
0490  *
0486  *****************************************************************
      /EJECT
0487  *****************************************************************   S01195
0490  ***********                                                     *   S01195
0614 C*****ZDATE3*SR.*TO*CALCULATE*ANY*NUMBER*OF*WORKING***************   S01195
0615 C***********     DAYS FORWARD IN ANY CURRENCY.                   *   S01195
0616 C***********                                                     *   S01195
0617 C*********THIS*SR.*CAN*BE*USED*WHEN*THE*INPUT*CYCLE*IS*RUNNING*AS*   S01195
0618 C*********HOLIDAY*RECORDS*ARE*ACCESSED*BY*CHAIN.*THEREFORE*NEWLY**   S01195
0619 C*********ADDED*RECORDS*IN*THE*OVERFLOW*AREA*CAN*ALSO*BE*ACCESSED*   S01195
0490  ***********                                                     *   S01195
0487  *****************************************************************   S01195
0620 C***********                                                     *   S01195
0621 C***********ZDATE3    BEGSR                           *** ZDATE3 *** S01195
0622 C***********                                                     *   S01195
0623 C*****CALCULATIONS*TO*DEFINE*INPUT*FIELDS.************************   S01195
0624 C***********          Z-ADDZDAYNO    ZDAYNO  50       STARTING DATE  S01195
0625 C***********          MOVE ZCCY      ZCCY    3        DATE CURRENCY  S01195
0626 C***********          Z-ADDZNRDYS    ZNRDYS  20       NBR OF WORKING S01195
0627 C***********                                          DAYS FORWARD   S01195
0628 C*****CLEAR*COUNT*OF*NBR*OF*DAYS*ADDED,*&*DEFINE*ZDYNBR.**********   S01195
0629 C***********          Z-ADD0         ZDCNT   20                  *   S01195
0630 C***********          Z-ADDZDAYNO    ZDYNBR  50                  *   S01195
0631 C***********                                                     *   S01195
0632 C*****LOOP*TO*INCREMENT*DAY*NUMBER*AND*CHECK*FOR*HOLIDAY.*********   S01195
0633 C***********ZDLOP1    TAG                             ** ZDLOP1 TAG *S01195
0634 C***********                                                     *   S01195
0635 C***********          SETOF                     9596             *   S01195
0636 C***********ZDYNBR    ADD  1         ZDYNBR                      *   S01195
0637 C***********                                                     *   S01195
0638 C*****SET*KEY*FOR*FIRST*HOLIDAY*RECORD.***************************   S01195
0639 C***********          MOVEL'22    '  ZDHKEY 12                   *   S01195
0640 C***********          MOVELZDYNBR    ZWRK6   6                   *   S01195
0641 C***********          MOVE '1'       ZWRK6                       *   S01195
0642 C***********          MOVE ZWRK6     ZDHKEY                      *   S01195
0643 C***********                                                     *   S01195
0644 C*****CHAIN*FOR*HOLIDAY*RECORD,*RECORD*1*OR*2*********************   S01195
0645 C***********ZDHCHN    TAG                             ** ZDHCHN TAG *S01195
0646 C***********                                                     *   S01195
0647 C***********ZDHKEY    CHAINTABLE                90    ON NOT THERE   S01195
0648 C**N90******RECI      COMP 'D'                  9090  DELETED    *   S01195
0649 C***********                                                     *   S01195
0650 C*****NO*RECORD*1*FOUND,*IS*NOT*A*HOLIDAY*************************   S01195
0651 C***90N95***          GOTO ZDOAGN                                *   S01195
0652 C***********                                                     *   S01195
0653 C*****NO*RECORD*2*FOUND*******************************************   S01195
0654 C***90*95*96          GOTO ZDLOP1                     EXC. NOT FOUND S01195
0655 C***90*95N96          GOTO ZDOAGN                     INC. NOT FOUND S01195
0656 C***********                                                     *   S01195
0657 C*****DETERMINE*TYPE*FOUND,*INCLUDE*OR*EXCLUDE********************   S01195
0658 C***********INEX      COMP 'E'                  92  91           *   S01195
0659 C***********                                                     *   S01195
0660 C*****CHECK*IF*DAY*IS*HOLIDAY*FOR*CURRENCY.***********************   S01195
0661 C***********ZCCY      LOKUPHCCY                     93           *   S01195
0662 C***91*93***          GOTO ZDOAGN                     EXCLUDE FOUND  S01195
0663 C***92*93***          GOTO ZDLOP1                     INCLUDE FOUND  S01195
0664 C***********                                                     *   S01195
0665 C*****IF*EXCLUDE*OR*INCLUDE*NOT*FOUND*CHECK***********************   S01195
0666 C*****FOR*SECOND*HOLIDAY*RECORD,*IF*REQUIRED.*********************   S01195
0667 C***********'   '     LOKUPHCCY                     94ON IF NO RCD.2 S01195
0668 C***********          MOVE ZDHKEY    ZWRK1   1                   *   S01195
0669 C***********ZWRK1     COMP '1'                      95           *   S01195
0670 C***91*95***          SETON                     96               *   S01195
0671 C***95N94***          MOVE '2'       ZDHKEY                      *   S01195
0672 C***95N94***          GOTO ZDHCHN                     GET SECOND REC S01195
0673 C***********                                                     *   S01195
0674 C***91******          GOTO ZDLOP1                     EXC. NOT FOUND S01195
0675 C***92******          GOTO ZDOAGN                     INC. NOT FOUND S01195
0676 C***********                                                     *   S01195
0677 C*****INCREMENT*COUNT*AND*CHECK*IF*REQUIRED*NUMBER*OF*DAYS********   S01195
0678 C*****HAVE*BEEN*ADDED.*IF*NOT,*GO*THROUGH*LOOP1*AGAIN.************   S01195
0679 C***********ZDOAGN    TAG                             ** ZDOAGN TAG *S01195
0680 C***********                                                     *   S01195
0681 C***********ZDCNT     ADD  1         ZDCNT                       *   S01195
0682 C***********ZDCNT     COMP ZNRDYS                 97             *   S01195
0683 C***97******          GOTO ZDLOP1                                *   S01195
0684 C***********                                                     *   S01195
0685 C***********          ENDSR                                      *   S01195
0687 C***********                                                     *   S01195
0487  *****************************************************************   S01195
      /EJECT                                                              S01195
     C/COPY ZSRSRC,ZACCH                                                  S01195
      /EJECT                                                              S01195
     C/COPY ZSRSRC,ZFWDT                                                  S01195
      /EJECT                                                              S01195
     C*****************************************************************   S01117
     C*                                                               *   S01117
     C* *PSSR  --- SUBROUTINE TO HANDLE ABNORMAL ERROR CONDITIONS     *   S01117
     C*                                                               *   S01117
     C* CALLED FROM: AFTER ABNORNAL OPERATION OCCURS                  *   S01117
     C*                                                               *   S01117
     C*****************************************************************   S01117
     C*                                                                   S01117
     C           *PSSR     BEGSR                           ** *PSSR **    S01117
     C*                                                                   S01117
     C           @RUN      IFEQ *BLANKS                                   S01117
     C                     MOVE 'Y'       @RUN    1                       S01117
     C                     DUMP                                           S01117
     C                     ELSE                                           MOF60
     C*                                                                   MOF60
     C** If *PSSR already called , then end the program here.             MOF60
     C                     SETON                     U7U8LR               MOF60
     C                     RETRN                                          MOF60
     C                     END                                            S01117
     C*                                                                   S01117
     C                     ENDSR                           ** *PSSR **    S01117
     C*                                                                   S01117
      /EJECT                                                                                  237466
      *****************************************************************                       237466
      *                                                               *                       237466
      *  SRSCUR - Subroutine to set correct currency depeding on the  *                       237466
      *           settlement type.                                    *                       237466
      *                                                               *                       237466
      *  Called By: LVDT   - Process each forward repayment           *                       237466
      *                                                               *                       237466
      *****************************************************************                       237466
      *                                                                                       237466
     C           SRSCUR    BEGSR                                                              237466
      *                                                                                       237466
     C           MDST      IFEQ 01                                                            237466
     C           MDST      OREQ 07                                                            237466
     C           MDST      OREQ 08                                                            237466
     C           MDST      OREQ 02                                                            237466
     C           MDST      OREQ 12                                                            237466
     C                     MOVE CCY       ZCCY2   3                                           237466
     C                     ELSE                                                               237466
     C                     MOVE LOCY      ZCCY2                                               237466
     C                     ENDIF                                                              237466
      *                                                                                       237466
      ** If feature CEU004 is on, use settlement currency                                     237466
      ** if Settlement currency from the LOAN is not blank.                                   237466
      *                                                                                       237466
     C           CEU004    IFEQ 'Y'                                                           237466
     C           SCCY      ANDNE*BLANKS                                                       237466
     C                     MOVE SCCY      ZCCY2                                               237466
     C                     ENDIF                                                              237466
      *                                                                                       237466
     C                     ENDSR                                                              237466
      /EJECT                                                                                  237466
      *****************************************************************                       237466
      *                                                               *                       237466
      *  MATLOC - Subroutine to get maturity location                 *                       237466
      *                                                               *                       237466
      *  Called By: LVDT   - Process each forward repayment           *                       237466
      *                                                               *                       237466
      *****************************************************************                       237466
     C           MATLOC    BEGSR                                                              237466
      *                                                                                       237466
     C           *LIKE     DEFN NRLC      W@MDSL                                              237466
     C                     MOVE *BLANKS   W@MDSL                                              237466
      *                                                                                       237466
      ** For Type 01,02,07,08 OR 12, settlement location is determined                        237466
      ** by the nostro branch.                                                                237466
      *                                                                                       237466
     C           MDST      IFEQ 01                                                            237466
     C           MDST      OREQ 02                                                            237466
     C           MDST      OREQ 07                                                            237466
     C           MDST      OREQ 08                                                            237466
     C           MDST      OREQ 12                                                            237466
      *                                                                                       237466
     C                     MOVELOMDA      SNOS    2                                           237466
      *                                                                                       237466
      ** If feature CEU004 is on                                                              237466
      ** If Settlement currency for EMU non-blank, set the Nostro Cccy                        237466
      *                                                                                       237466
     C                     MOVE CCY       @KEYB                                               237466
      *                                                                                       237466
     C           CEU004    IFEQ 'Y'                                                           237466
      *                                                                                       237466
     C           SCCY      IFNE *BLANKS                                                       237466
     C                     MOVE SCCY      @KEYB                                               237466
     C                     ENDIF                                                              237466
      *                                                                                       237466
     C                     ENDIF                                                              237466
      *                                                                                       237466
     C                     CALL 'AONOSTR0'                                                    237466
     C                     PARM '*MSG   ' @RTCD   7                                           237466
     C                     PARM '*KEY   ' @OPTN   7                                           237466
     C                     PARM *BLANKS   @KEYA   6                                           237466
     C                     PARM           @KEYB   3                                           237466
     C                     PARM *BLANKS   @KEYC   4                                           237466
     C                     PARM *BLANKS   @KEYD   2                                           237466
     C                     PARM SNOS      @KEYE   2                                           237466
     C                     PARM *BLANKS   @KEYF   3                                           237466
     C                     PARM *BLANKS   @KEYG  10                                           237466
     C                     PARM *BLANKS   @KEYH   1                                           237466
     C           SDNOST    PARM SDNOST    DSFDY                                               237466
      *                                                                                       237466
     C           @RTCD     IFEQ *BLANKS                                                       237466
      *                                                                                       237466
      **                                                                                      237466
      ** Move the last 3 characters of customer short code (which is                          237466
      ** the location code) to start location code field                                      237466
      **                                                                                      237466
      *                                                                                       237466
     C                     MOVE CSNM      DSCSNM                                              237466
     C                     MOVE NRLC      W@MDSL                                              237466
     C                     END                                                                237466
      *                                                                                       237466
     C                     END                                                                237466
     C                     ENDSR                                                              237466
     C/COPY ZSRSRC,ZDATE2Z4                                                                   237466
     C/COPY ZSRSRC,ZBKDT                                                                      237466
      *                                                                                       237466
0688 C*****************************************************************
     O/EJECT
0689 O*
0690 O** LVEDI - HEADER
0691 OLVEDIH2 D        01
0692 O                                    1 'H'
0693 O*
0694 O** LVEDI - DETAIL (FROM LVENT)
0695 O*LVEDIF1*D******  30                                                BHF736
0695 O*LVEDIF1*D******  30N35                                       BHF736BHF737
0695 OLVEDIF1 D        30N35N10                                           BHF737
0696 O*
0697 O                                    1 'D'
0698 O                       02           2 'B'
0699 O                       03           2 'D'
0700 O                       04           2 'F'
0701 O                       05           2 'G'
0702 O                       06           2 'H'
0703 O                       07           2 'H'
0704 O                       08           2 'J'
0705 O                       09           2 'L'
0705 O                       11           2 'H'                           146126
0705 O                       21           2 'L'                           MOF60
     O                       27           2 'F'                           S01392
     O                       28           2 'F'                           S01392
     O                    50 51           2 'J'                           CLE004
     O                    50 53           2 'J'                           CLE004
     O                    60 53           2 'J'                           CEU020
     O                    50 52           2 'G'                           CLE004
     O                    50 54           2 'G'                           CLE004
     O                    60 54           2 'G'                           CEU020
     O                    61 55           2 'K'                                               CLE028
0706 O                         CNUM       8
     O                    83   OLNO       8                               S01260
0707 O                         ACOF      12
      *                                                                   S01408
     O/COPY WNCPYSRC,LE0680OOP1                                           S01408
      *                                                                   S01408
0708 O                         EDAT      15P
0709 O                                   16 'F'
0710 O                         FTYP      19
0711 O                         FSEQ      21
0712 O                         FREQ      22
0713 O                    02             22 ' '
0714 O                    03             22 ' '
0715 O                    05             22 ' '
     O                    50 52          22 ' '                           CLE004
     O                    50 54          22 ' '                           CLE004
     O                    60 54          22 ' '                           CEU020
0716 O                         P13       29P
0717 O                    02   EAMT      29P
     O***********         03N40EAMT      29P                              140163
     O                    03   EAMT      29P                              140163
     O                    04   EAMT      29P
0719 O                    05   EAMT      29P
     O                    50 52EAMT      29P                              CLE004
     O                    50 54EAMT      29P                              CLE004
     O                    60 54EAMT      29P                              CEU020
0720 O                    09   EAMT      29P
0720 O                    21   EAMT      29P                              MOF60
     O                    37   NPEAMT    29P                              S01392
0721 O                         LNRF      35
0722 O                         FCCY      38
     O                    21   ECCY      38                               060308
0723 O                         ECCY      41
0724 O********************09*************41 '   '                         101841
0724 O***********         21             41 '   '                   MOF60 MOF608
0725 O                         P5        44P
0726 O                                   50 '000000'
0727 O                         P13       57P
     O***********         03N40EAMT      57P                              140163
     O                    03   EAMT      57P                              140163
0729 O                    08   EAMT      57P
     O                    50 51EAMT      57P                              CLE004
     O                    50 53EAMT      57P                              CLE004
     O                    60 53EAMT      57P                              CEU020
     O                    37   DIFFA     57P                              S01392
0730 O                         P13       64P
0731 O                    02   OTHA      64P
     O                    03N41OTHA      64P
0733 O                    06   EAMT      64P
0734 O                    07   EAMT      64P
0733 O                    11   EAMT      64P                              146126
     O***********         37   EAMT      64P                        S01392127048
     O                    37   NEWDIS    64P                              127048
0735 O                    03N33          65 'Y'
0736 O                    04N33          65 'Y'
0737 O                                   67 '00'
0738 O                         CASK      75
0739 O                         CRNM      95
0740 O                         CTWN     105
0741 O                         FCUS     111
0742 O                         AUTO     112
0743 O                         LTYP     114
0744 O                         SUTP     116
0745 O***********              BRCD     119                               S01117
0745 O                         BRCA     119                               S01117
     O                         CMPYM    122                               S01117
     O                         LASN     131                               100373
     O                 50 05   GASI     132                               CLE004
     O                 50 08   GASI     132                               CLE004
     O                 50 51            132 'T'                           CLE004
     O                 50 52            132 'T'                           CLE004
     O                 50 53            132 'R'                           CLE004
     O                 60 53            132 'R'                           CEU020
     O                 50 54            132 'R'                           CLE004
     O                 60 54            132 'R'                           CEU020
     O                         ZERO15   190P                                                  CLE042
     O                         CLAS     194                                                   CLE042
     O                         MPCRF    209                                                   244589
     O                         MLPFI    210                                                   244589
     O                         INOI     211                                                   244589
     O                 29      REPT     212                                                   CLE154
     O*                                                                   S01408
     O/COPY WNCPYSRC,LE0680OOPG                                           S01408
     O*                                                                   S01408
0746 O*
     O********************                                                S01339
0747 O***LVEDI*-*DETAIL*(FROM*LDEX)************                           S01339
0748 O********D********32*                                                S01339
0749 O********************     DEXLOT   128                               S01339
     O********************     CMPYM    122                         S01117S01339
0750 O***OUTPUT*'Y'*BECAUSE*BECAUSE******                                 S01339
0751 O**C.LOANS*ALWAYS*AUTO*SETTLE*******                                 S01339
0752 O********************              112 'Y'                           S01339
0753 O*
0754 O** LVEDI - TRAILER
0755 OLVEDIT2 T        LR
0756 O                                    1 'T'
0757 O                         OUTREC     4P
0758 O                         OUTINT    12P
0759 O                         OUTDEC    14P
0761 O**
0762 O**  CONTROL REPORT
0763 O*E0680P1T**103   LR                                       S01124    S01117
0763 OLE0680AUT  103   LR                                                 S01117
0764 O***********                        22 'REFERENCE LE0680'            S01117
0764 O                                   24 'REFERENCE LE0680AU'          S01117
0765 O                         TITL      89
0766 O                                  104 'DATE'
0767 O                         RUNA     112
0768 O                                  122 'PAGE'
0769 O                         PAGE  Z  127
0770 O        T 1      LR
0771 O                                   55 ' FINANCIAL LOAN DIA'
0772 O                                   68 'RY EVENTS EXT'
0773 O                                   89 'RACT - FILE CONTROLS '
0774 O        T 13        LR
0775 O                                   55 ' ------------------'
0776 O                                   68 '-------------'
0777 O                                   89 '-------------------- '
0778 O        T 1      LR
0779 O                                   28 'S/LVEDI - RUN CONTROLS'
0780 O                                   59 'NUMBER'
0781 O                                   84 'VALUE'
0782 O        T 11     LR
0783 O                                   28 '----------------------'
0784 O                                   59 'OF RECORDS'
0785 O                                   84 'OF RECORDS'
0786 O        T 12     LR
0787 O                                   29 'TOTAL RECORDS ON FILE'
0788 O                         OUTREC3   59
0789 O                         OUTINTZ   81
0790 O                         OUTDEC    84
0791 O        T 1      LR
0792 O                                   28 'S/LVENT - RUN CONTROLS'
0793 O        T 11     LR
0794 O                                   28 '----------------------'
0795 O********T*11     LR                                                 S01153
0796 O************                       29 'TOTAL RECORDS ON FILE'       S01153
0797 O************          NU7NOREL 3   59                               S01153
0798 O************          NU7HRWNL Z   81                               S01153
0799 O************          NU7HRDCL     84                               S01153
0800 O        T 12     LR
0801 O                                   29 'TOTAL RECORDS ON FILE'
0802 O                                   42 '- CALCULATED'
0803 O                         LVREC 3   59
0804 O                         LVINT Z   81
0805 O                         LVDEC     84
0806 O************           70         111 '***   DIFFERENCE   ***'      S01153
     O***********************                                             S01339
0807 O********T*1******LR*U1*                                             S01339
0808 O***********************            28 'S/LDEX  - RUN CONTROLS'      S01339
0809 O********T*11*****LR*U1*                                             S01339
0810 O***********************            28 '----------------------'      S01339
0811 O********T*11*****LR*U1*                                             S01339
0812 O***********************            28 'TOTAL RECORDS ON FILE'       S01339
0813 O**********************NU7NORE  3   59                               S01339
0814 O**********************NU7HRWN  Z   81                               S01339
0815 O**********************NU7HRDC      84                               S01339
0816 O********T*12*****LR*U1*                                             S01339
0817 O***********************            28 'TOTAL RECORDS ON FILE'       S01339
0818 O***********************            42 '- CALCULATED'                S01339
0819 O***********************  LDREC 3   59                               S01339
0820 O***********************  LDINT Z   81                               S01339
0821 O***********************  LDDEC     84                               S01339
0822 O***********************71         111 '***   DIFFERENCE   ***'      S01339
0823 O*
0824 O**
0825 O**  REPORT DATABASE ERRORS
0826 O        T 3      U7 U8 LR
0827 O                                   42 '*** REFERENCE'
0828 O***********              DBPGM     51                               S01117
0828 O                         DBPGM     53                               S01117
0829 O***********                        71 ' -DATABASE ERROR AT'         S01117
0829 O                                   73 ' -DATABASE ERROR AT'         S01117
0830 O***********              DBASE     74                               S01117
0830 O                         DBASE     77                               S01117
0831 O        T 1      U7 U8 LR
0832 O                                   37 'FILE NAME'
0833 O***********              DBFILE    43                               S01117
0833 O                         DBFILE    47                               S01117
0834 O***********                        48 'KEY'                         S01117
0834 O                                   52 'KEY'                         S01117
0835 O***********              DBKEY     78                               S01117
0835 O                         DBKEY     84                               S01117
0836 O********T*3      LR                                                 S01117
0837 O***********                        76 '*** END OF REPORT ***'       S01117
      /EJECT                                                              S01195
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN                                          237466
0366073110961461                                                                              237466
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR                                            237466
000031059090120151181212243273304334365                                                       237466
**   ZMNM - MONTHS SHORT NAMES                                                                237466
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC                                                          237466
** CPY@   **      OBJECT COPYRIGHT
(c) Finastra International Limited 2001
