     H        1                                                           S01117
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas LE Commitment, Fclty & Loan Detls Rept')         *
0001 H***********                                                         S01117
0002 F*****************************************************************
0003 F*                                                               *
     F*  Midas - Customer Lending Module
0005 F*                                                               *
0006 F*  LE0720 - COMMITMENT/FACILITY AVAILABILITY REPORT BY CUSTOMER *
0007 F*                                                               *
      *  (c) Finastra International Limited 2001                      *
0009 F*                                                               *
      *  Last Amend No. MD054690           Date 21Nov19               *
      *  Prev Amend No. MD046248           Date 27Oct17               *
      *                 CLE134             Date 01Aug12               *
      *                 CLE148             Date 23Jul12               *
      *                 AR888974           Date 09Jan12               *
      *                 AR787620           Date 10Jun11               *
      *                 259282             Date 03Nov10               *
      *                 CER059             Date 19Jul10               *
      *                 CER043             Date 19May08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      *                 CSC042             Date 16Feb09               *
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *                 246590             Date 22Mar07               *
      * Midas Plus 1.4 Base ------------------------------------------*
      *                 245110             Date 19Jan06               *
      *                 244459             Date 14Dec06               *
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CSD031             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 236212             Date 28Nov05               *
      *                 CLE042             Date 06Sep05               *
      *                 BUG8220            Date 20Aug05               *
      *                 BUG8070            Date 04Aug05               *
      *                 CLE040             Date 05Jul04               *
      *                 CGL029             Date 01Sep03               *
      * Midas Release 4.01.03 ----------------------------------------*
      *                 190571             Date 13Jan03               *
      *                 193470             Date 08Jan03               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.04 -----------------------------------------------*
     F*                 171784             Date 01Aug00               *
      * Midas DBA 3.02 -----------------------------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
     F*                 CLE004             DATE 02DEC96               *
     F*                 S01473             DATE 22JUL94               *
     F*                 060091             DATE 13OCT93               *
     F*                 S01392             DATE 05OCT92               *
     F*                 S01339             DATE 09APR92               *
     F*                 E20763             DATE 24JAN90               *
     F*                 S01194             DATE 12JAN90               *
     F*                 S01117             DATE 16/08/89              *
     F*                 E13592             DATE 09/06/88              *
     F*                 E12122             DATE 22/04/88              *
     F*                                                               *
0012 F*****************************************************************
     F*                                                               *
      *  MD054690 - Adjust positions to accomodate max AMNT (18 chars)*
      *  MD046248 - Finastra Rebranding                               *
      *  CLE134 - Past Due Call Loan Processing (Recompile)           *
      *  CLE148 - Alpha Loan Reference                                *
      *  AR888974 - LEC08 10001 DBerr 013 on file LEFCLTQD            *
      *  AR787620 - Hooks Incorporation                               *
      *             WNCPYSRC,LEH00149                                 *
      *  259282 - Field overlap between PCRF and LPFI causes the last *
      *           digit of the PCRF to show in the LPFI field.        *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  CER043 - German Features LF041-00 New Fields and Defaulting  *
      *           (Recompile)                                         *
      *  CSC042 - COB Performance fix.                                *
      *           Reduce number of AOBRCHR* pgm calls. RZB sofia calls*
      *           AO pgm 220K times for 205 records                   *
      *  246590 - Reverse 245110.                                     *
      *  245110 - Moved CCY field (LOANS/MFU) 4 characters to the     *
      *           left to display correct amount                      *
      *  244459 - Facility and Availablity Report not showing         *
      *           syndications correctly                              *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  236212 - Use FCLB instead of BRCA in chaining LEFCLTLG.      *
      *  CLE042 - Extended Loan Sub Type                              *
      *  BUG8220- Database error 013 in program LE0720 file LEFCLTQD  *
      *           key DOC00000000000 encountered.                     *
      *         - Only access LEFCLTQD if Facility/Commitment type    *
      *           record (*IN01 = '1') is being processed             *
      *  BUG8070- LEC08 10002 DBASE error 013 in LE0720               *
      *  CLE040 - Collateralised Lending Phase 2                      *
      *  CGL029 - Increase Account Code to 10 digits                  *
     F*  190571 - Report should show MFUs as well as loans.           *  *
     F*           Print customer name and number on page overflow.    *  *
     F*  193470 - Customer Name & Number missing. Amend the conditons *
     F*           for resetting the indicators that enable the display*
     F*           of these fields. Also corrected the output of the   *
     F*           second detail record so the customer name & number  *
     F*           are printed on page overflow.                       *
     F*  171784 - Report shows negative facility amounts as positive. *  *
     F*           Add negative sign to edit word.                     *
     F*  CLE004 - Customer Lending Enhancements - Syndications        *
     F*  S01473 - Leo Midas Integration. Include Leo Transactions on  *
     F*           the report                                          *
     F*  060091 - Deal type and subtype not shown on report as they   *
     F*           were commented out                                  *
     F*  S01392 - JAPANESE SUB MODULE ENHANCEMENTS                    *   S01392
     F*  S01339 - REMOVE SYNDICATED LOANS PROCESSING, DUE TO          *
     F*           MODULE REDUNDANCY.                                  *
     F*  E20763 - SET OFF INDICATORS 45 AND 46 BEFORE USING, NOT      *   E20763
     F*           AT THE BEGINNING OF EACH CYCLE.                     *   E20763
     F*  S01194 - STANDING DATA CHANGES                               *   S01194
     F*  S01117 - MULTIBRANCHING                                      *
     F*  E13592 - INDICATORS 45 AND 46 NOT BEING SET OFF.             *
     F*  E12122 - COMMITMENT/FACILITY AMOUNT AVAILABLE SHOWS '0.00'   *   E12122
     F*           FOR EXPIRED FACILITY INSTEAD OF '*EXP*'.            *   E12122
     F*                                                               *
     F*****************************************************************
     F*                                                               *
     F*  C R E A T I O N     P A R A M E T E R S                      *
     F*                                                               *
     F*                                                               *
     F*****************************************************************
0013 F*FCX2***IP**F      80 23AI     2 DISK                               S01117
0013 F***SFCX2***IP  F      83 23AI     2 DISK                     S01117 CLE004
     FSFCX2   IP  F     100 23AI     2 DISK                               CLE004
0014 F*TABLE***IF**F      96 12AI     2 DISK                              S01194
0015 F*TABLED**IF**F      96 12AI     2 DISK                              S01194
     FSDCURRPDIF  E                    DISK                               S01194
     FLEFCLTLGIF  E           K        DISK                                                   CLE040
     FLEAGFYL4IF  E           K        DISK                                                 AR888974
     F            LEFCLTD0                          KRENAMELEAGLTD0                         AR888974
      ** Facilities Extension File                                                            CLE040
0016 F*E0720P1O***F     132     OF     PRINTER                   S01124   S01117
0016 FLE0720P1O   F     132     OF     PRINTER      KINFDS SPOOL      UC  S01117
0016 FLE0720AUO   F     132            PRINTER      KINFDS SPOOLU         S01117
     F/COPY WNCPYSRC,LE0720F001
0017 F* ID F  C  H  L    FUNCTION OF INDICATORS
0018 F* 01            FACILITY/COMMITMENT EXTRACT - FAC/CMMT TYPE RECORD
0019 F* 02                                        - LOAN TYPE RECORD
0019 F* 02 & 04                                   - LEO  TYPE RECORD      S01473
0020 F* 03                                        - TRAILER RECORD
0021 F*    21         POSITIVE MAT. DATE ON FILE
0022 F*****22*********BLANK*LOAN*TYPE/SUB*TYPE****************************S01339
     F*    23         Blank field denotes MFU type record                                     190571
0023 F*       40      CONDITIONS FIRST CYCLE PROCESSING
0024 F*       41      GENERAL PURPOSE
0025 F*       42      EMPTY PRIMARY FILE
      *       44      Do not print participant facilities(I,P,R)                              244459
0026 F*       45      FACILITY RECORD
     F*       46      FACILITY HAS EXPIRED
0027 F*       47      DETERMINES FIRST DRAWDOWN/LOAN PER FAC./COMMT.
0028 F*       48          ''      ''      ''     ''  ''  ''    ''
     F*       50      NEXT RECORD IS A LOAN RECORD
     F*       51      WORK INDICATOR
     F*       52      OUTPUT CUSTOMER NAME
     F*       53      Save Overflow indicator                                                 193470
     F*       60      FACILITY CCY DEC PLACES - 0
0029 F*       60      CURRENCY DECIMAL PLACES - 0
0030 F*       61                              - 1
0031 F*       62                              - 2
0032 F*       63                              - 3
0033 F*       64      FILE OUT OF BALANCE - LOAN TYPE RECORD
0034 F*       65                          - FAC/CMMT TYPE RECORD
     F*       66      DRAWDOWN CCY DEC PLACES - 0
     F*       67                              - 1
     F*       68                              - 2
     F*       69                              - 3
     F*   70  - CLE004 is switched *ON                                *   CLE004
     F*       37      ALLOW OUTPUT                                        S01117
     F*       73      MULTIBRANCHING INDICATOR                            S01117
     F*       74      REQUESTS SINGLE BRANCH                              S01117
     F*       75      ALLOW CONTROL TOTAL CHECKING                        S01117
     F*       85      REPORT FILE OPENED IN FIRST PROCESSING CYCLE        S01117
0035 F*             U7SYSTEM ERROR
0036 F*             U8DATABASE ERROR, REQUIRED RECORDS NOT FOUND
0037 F*             L1CUSTOMER CHANGE
0038 F*             L2BRANCH CHANGE
0039 E                    XCYA      150  3               CURRENCIES
0040 E                    XDPA      150  1 0             DEC. PLACES
     E/COPY ZSRSRC,ZDATE2Z1                                               S01392
     E                    CPY@    1   1 80
     E                    ##BR      999  3               Branch codes                         CSC042
     E                    ##BN      999 30               Branch Name                          CSC042
0044 I*
0045 I*    EXTRACT CMMT/FCLTY DETAILS - FACILITIES
0046 I*
0047 ISFCX2   NS  01   1 CD  23 CF
0048 I                                        1   1 RECI
0049 I***********                             2   40BRCD  L2              S01117
0049 I                                        2   4 BRCA                  S01117
0050 I**********                              5  100PNUM                                      CSD027
0051 I**********                             11  160CNUM  L1                                  CSD027
0050 I                                        5  10 PNUM                                      CSD027
0051 I                                       11  16 CNUM  L1                                  CSD027
0052 I                                       17  220CFNO
0053 I**   FOLLOWING RECORDS DEFINED FOR PURPOSE OF THIS PROGRAM
0054 I                                       17  190CFN1
0055 I                                       20  210CFN2
0056 I**
0057 I                                       23  23 RCDT
0058 I                                       24  26 CMCY
     I                                       27  27 EXPI                  S01117
0059 I                                    P  28  340OAMT
0060 I                                    P  35  410CAMT
0061 I                                    P  42  480CAVL
0062 I                                       49  49 FACI
0063 I                                       50  50 FATP
0064 I                                    P  51  570CFTA
0065 I                                       58  77 CNAM
     I***********                            78  78 EXPI                  S01117
     I                                       78  80 CMPYM                 S01117
     I                                       81  83 FCLB  L2              S01117
     I/COPY WNCPYSRC,LE0720I003
      *                                                                   CLE004
      ** Participant Facility Indicator                                   CLE004
     I                                      100 100 PRTR                  CLE004
0066 I*
0067 I*    EXTRACT CMMT/FCLTY DETAILS - LOANS
     I*    and Manual Facility Utilisations                                                   190571
0068 I*
0069 I        NS  02   1 CD  23 CL
     I       OR        1 CD  23 CM                                                            190571
0070 I                                        1   1 RECI
0071 I***********                             2   40BRCD                  S01117
0071 I                                        2   4 BRCA                  S01117
0072 I**********                              5  100PNUM                                      CSD027
0073 I**********                             11  160CNUM                                      CSD027
0072 I                                        5  10 PNUM                                      CSD027
0073 I                                       11  16 CNUM                                      CSD027
0074 I                                       17  220CFNO
0075 I                                       23  23 RCDT
0076 I                                       24  26 DDCY
0077 I                                    P  27  330AMNT
0078 I                                       34  35 CRSK
0079 I                                       36  37 CLOC
0080 I                                    P  38  400MDAT        21
     I                                       41  43 FCLB                  S01117
0081 I                                       63  640PTYP
0082 I                                       65  66 LTYP
0083 I                                       67  68 SUTP
0084 I*    FOLLOWING FIELD DEFINED FOR PURPOSE OF THIS PROGRAM
0085 I***********                            65  68 LTPSTP          22    S01339
0085 I                                       65  68 LTPSTP                S01339
0086 I*
0087 I**********                             69  740ORGL                                      CLE148
0088 I**********                             75  800DDRF                                      CLE148
     I                                       69  74 ORGL                                      CLE148
     I                                       75  80 DDRF                                      CLE148
     I**********                             84  99 PCRF                               244459 259282
     I**********                             99 100 LPFI                               244459 259282
     I                                       85  99 PCRF                                      259282
     I                                      100 100 LPFI                                      259282
      * Fields redefined for MFU type records                                                 190571
     I                                       75  77 SQNO                                      190571
     I                                       78  80 MFU             23                        190571
     I                                       81  84 CLAS                                      CLE042
0089  *                                                                   S01473
0090  **   Extract Cmmt/Fclty Details - Leo Detail                        S01473
0091  **                                                                  S01473
0047 I        NS  02   1 CL  23 CL                                        S01473
0070 I                                        1   1 RECI                  S01473
0071 I                                        2   4 BRCA                  S01473
0073 I**********                             11  160CNUM                               S01473 CSD027
0073 I                                       11  16 CNUM                                      CSD027
0074 I                                       17  220CFNO                  S01473
0075 I                                       23  23 RCDT                  S01473
0076 I                                       24  26 DDCY                  S01473
0077 I                                    P  27  330AMNT                  S01473
0078 I                                       34  35 CRSK                  S01473
0079 I                                       36  37 CLOC                  S01473
0080 I                                    P  38  400MDAT        21        S01473
     I                                       41  43 FCLB                  S01473
0081 I                                       63  640PTYP                  S01473
0082 I                                       65  66 LTYP                  S01473
0083 I                                       67  68 SUTP                  S01473
0084  *    Following Field Defined for purpose of this program            S01473
0085 I                                       65  68 LTPSTP          22    S01473
0086  *                                                                   S01473
0087 I                                       69  80 LCREF                 S01473
0088 I                                       69  74 LCNO                  S01473
     I                                       81  84 CLAS                                      CLE042
0089 I*
0090 I*    EXTRACT CMMT/FCLTY DETAILS - TRAILER
0091 I*
0092 I        NS  03   1 CT
0093 I                                        1   1 RECI
0094 I                                    P   2   40NOLR
0095 I                                    P   5  120HLDW
0096 I                                    P  13  140HLDC
0097 I                                    P  15  170NOFR
0098 I                                    P  18  250HFDW
0099 I                                    P  26  270HFDC
0100 I*
     I*    LOOK AHEAD FIELD
     I*
     I        NS  **
     I                                       23  23 NRECT
     I*
0101 I*    CATCH ALL
0102 I*
0103 I        NS
     I/COPY WNCPYSRC,LE0720I001
0104 I**************                                                      S01194
0105 I*****TABLE*FILE - INSTALLATION CONTROL DATA RECORD 1.               S01194
0106 I**************                                                      S01194
0107 I*TABLE***NS***    2 C0   3 C1  12 C1                                S01194
0108 I*******AND****  13 C0                                               S01194
0109 I**************                          1   1 RECI                  S01194
0110 I**************                          2   30RECT                  S01194
0111 I**************                         12  130RCDE                  S01194
0112 I**************                         14  66 TITL                  S01194
0113 I**************                         67  67 DATF                  S01194
0114 I***********                            68  700DFBR                  S01194
0115 I**************                         74  74 MODI1                 S01194
0116 I**************                         75  75 MODI2                 S01194
0117 I**************                         76  76 MODI3                 S01194
0118 I**************                      P  77  790RUND                  S01194
0119 I**************                         80  86 RUNA                  S01194
0120 I**************                         87  870SFLG                  S01194
0121 I**************                      P  90  920LCD                   S01194
0122 I**************                         93  93 CHTP                  S01194
0123 I**************                      P  94  960TNLU                  S01194
0124 I**************                                                      S01194
0125 I*****CATCH*ALL                                                      S01194
0126 I**************                                                      S01194
0127 I********NS****                                                      S01194
0128 I**************                                                      S01194
0129 I*****TABLE*FILE - CURRENCIES RECORD 1.                              S01194
0130 I**************                                                      S01194
0131 I*TABLED**NS***    2 C2   3 C0                                       S01194
0132 I**************                          1   1 RECI                  S01194
0133 I**************                          2   30RECT                  S01194
0134 I**************                         10  12 CCY                   S01194
0135 I**************                         13  130SREC                  S01194
0136 I**************                         14  27 CCNM                  S01194
0137 I**************                      P  28  348SPOT                  S01194
0138 I**************                         35  37 CCYS                  S01194
0139 I**************                         38  380CDP                   S01194
0140 I**************                         39  390TNOT                  S01194
0141 I**************                         40  40 DCCY                  S01194
0142 I**************                         41  44 SRC1                  S01194
0143 I**************                         45  48 SRC2                  S01194
0144 I**************                         49  520TACC                  S01194
0145 I**************                         53  560TEQV                  S01194
0146 I**************                         57  600SWQV                  S01194
0147 I**************                         61  640TAC4                  S01194
0148 I**************                         65  680TAC5                  S01194
0149 I**************                         69  69 HIND                  S01194
0150 I**************                      P  70  768PART                  S01194
0151 I**************                         77  780SSNO                  S01194
0152 I**************                      P  79  858ERLC                  S01194
0153 I**************                         86  860MDIN                  S01194
0154 I**************                         87  870MDIA                  S01194
0155 I**************                         88  880MDIB                  S01194
0156 I**************                      P  90  920LCD                   S01194
0157 I**************                         93  93 CHTP                  S01194
0158 I**************                      P  94  960TNLU                  S01194
0159 I**************                                                      S01194
0160 I*****CATCH*ALL                                                      S01194
0161 I**************                                                      S01194
0162 I********NS****                                                      S01194
0163 I**************                          2   30RECT                  S01194
     I*                                                                   S01194
     ISDBANK    E DSSDBANKPD                                              S01194
     I** EXTERNAL DS FOR BANK DETAILS                                     S01194
     I              BJURPT                          TITL                  S01194
     I**                                                                  S01194
     I/COPY WNCPYSRC,LE0720I002
     I*                                                                   S01117
     ISDBRCH    E DSSDBRCHPD                                              S01117
     I** EXTERNAL DS FOR BRANCHES DETAILS                                 S01117
     I**                                                                  S01117
     I              A8BRNM                          BRNM                  S01117
     I*                                                                   S01194
     IDSFDY     E DSDSFDY                                                 S01194
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01194
     I*                                                                   S01194
     IDSSDY     E DSDSSDY                                                 S01194
     I* SECOND DS FOR ACCESS PROGRAMS, LONG DATA STRUCTURE                S01194
     I*                                                                   S01194
     ISCSARD    E DSSCSARDPD                                              CLE004
      **  Switchable Features File                                        CLE004
     I**                                                                  S01194
0164 I**************                                                      S01194
0165 I*****DATA*STRUCTURE FOR KEY TO S/TABLE - CURRENCIES RECORD          S01194
0166 I**************                                                      S01194
0167 I************DS                                                      S01194
0168 I**************                          1  12 CCYKEY                S01194
0169 I**************                          9  11 XCCY                  S01194
0170 I*
0171 I*    LDA - DIAGNOSTICS FOR PROGRAM ABORT
0172 I*
0173 ILDA        UDS                            256
0174 I***********                           134 138 DBFILE                S01117
0175 I***********                           139 167 DBKEY                 S01117
0176 I***********                           168 175 DBPGM                 S01117
0177 I***********                           176 1770DBASE                 S01117
     I                                      134 141 DBFILE                S01117
     I                                      142 170 DBKEY                 S01117
     I                                      171 180 DBPGM                 S01117
     I                                      181 1830DBASE                 S01117
     I**                                                                  S01117
     I**   FILE INFORMATION DATA STRUCTURE                                S01117
     I**                                                                  S01117
     ISPOOL       DS                                                      S01117
     I                                       83  92 SFILE                 S01117
     I                                    B 123 1240SFNUM                 S01117
     ISPOOLU      DS                                                      S01117
     I                                       83  92 SFILEU                S01117
     I                                    B 123 1240SFNUMU                S01117
     I            DS                                                                          CLE040
     I                                        1  14 WKFCLT                                    CLE040
     I                                        1   3 BRCA                                      CLE040
     I                                        4   9 KCNUM                                     CLE040
     I                                       10  12 KFTYP                                     CLE040
     I                                       13  14 KFCNO                                     CLE040
     I**                                                                  S01117
     I**    DATA AREA RUNDAT                                              S01117
     I**                                                                  S01117
     IRUNDT       DS                                                      S01117
     I                                        1   7 RUNA                  S01117
     I                                    P   8  100RUND                  S01117
     I                                       11  11 SSF                   S01117
     I                                       12  12 DATF                  S01117
     I                                       13  13 MBIN                  S01117
     I**                                                                  S01117
     C**********           MOVEACPY@      BIS@   80                                           CSC042
     C********************************************************************S01117
     C           *ENTRY    PLIST                                          S01117
     C                     PARM           SEQ     5         SEQUENCE NO   S01117
     C                     PARM           BRNCH   3                       S01117
0178 C********************************************************************
     C           *NAMVAR   DEFN           LDA                             S01194
     C           *LOCK     IN   LDA                                       S01194
0179 C**   FIRST CYCLE PROCESSING
0180 C**
0181 C   40                GOTO DETAIL
0182 C                     SETON                     42
     C                     MOVEACPY@      BIS@   80                                           CSC042
0183 C                     MOVE 'LE0720'  DBPGM
     C                     Z-ADD0         ##BNDX  40                                          CSC042
     C           *LIKE     DEFN ##BNDX    B                                                   CSC042
     C           *LIKE     DEFN ##BNDX    ##BSV                                               CSC042
      *                                                                                       CSC042
     C**                                                                  S01117
     C**      IN THE DATAAREA RUNDAT                                      S01117
     C**                                                                  S01117
     C           *NAMVAR   DEFN RUNDAT    RUNDT                           S01117
     C                     IN   RUNDT                                     S01117
     C**                                                                  S01117
     C**      SETUP MULTIBRANCHING INDICATOR                              S01117
     C**                                                                  S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C                     SETON                     73                   S01117
     C                     END                                            S01117
     C           BRNCH     IFNE 'ALL'                                     S01117
     C                     SETON                     74                   S01117
     C                     END                                            S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C           BRNCH     ANDEQ'ALL'                                     S01117
     C           MBIN      ORNE 'Y'                                       S01117
     C                     SETON                     75                   S01117
     C                     END                                            S01117
0184 C**
0185 C                     EXSR ZSYSTM
0186 C***99*********       SETON                     U7U8  **DATABASE 01**S01194
0187 C***99*********       Z-ADD1         DBASE                           S01194
0188 C***99*********       MOVE ZTABKY    DBKEY                           S01194
0189 C***99*********       MOVE 'TABLE'   DBFILE                          S01194
0190 C   99                GOTO END
     C**                                                                  S01117
     C**      OPEN SPOOL FILE WHEN NON-MULTIBRANCHING                     S01117
     C**                                                                  S01117
     C           MBIN      IFNE 'Y'                                       S01117
     C                     SETON                     3785  ALLOW OUTPUT   S01117
     C                     OPEN LE0720P1                                  S01117
     C                     Z-ADD0         PAGE                            S01117
     C**   ENSURE REPORT SPOOL FILE RECORDED BY RCF                       S01117
     C**
     C                     Z-ADDSFNUM     ZSNUM   60                      S01117
     C                     OUT  LDA                                       S01117
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           SEQ                             S01117
     C                     PARM *BLANKS   SENTY   3                       S01117
     C                     PARM           SFILE                           S01117
     C                     PARM           ZSNUM                           S01117
     C                     PARM           ZSERR   1                       S01117
     C           *LOCK     IN   LDA                                       S01117
      *                                                                   S01117
     C           ZSERR     IFEQ 'Y'                                       S01117
      **  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM       S01117
     C                     SETON                     U7U8LR               S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C                     END                                            S01117
0191 C**************                                                      S01194
0192 C*****DEFINE*KEY FIELD                                               S01194
0193 C**************       MOVEL'20'      CCYKEY                          S01194
0194 C**************       MOVE '1'       CCYKEY                          S01194
0195 C**
0196 C**   LOAD CURRENCY ARRAYS
0197 C                     EXSR CCYARR
      *                                                                   CLE004
      ** Check if CLE004 is switched *ON                                  CLE004
      *                                                                   CLE004
     C                     MOVE 'N'       CLE004  1                       CLE004
     C                     CALL 'AOSARDR0'                                CLE004
     C                     PARM *BLANKS   @RTCD                           CLE004
     C                     PARM '*VERIFY' @OPTN                           CLE004
     C                     PARM 'CLE004'  @SARD   6                       CLE004
     C           SCSARD    PARM SCSARD    DSFDY                           CLE004
      *                                                                   CLE004
     C           @RTCD     IFEQ *BLANKS                                   CLE004
     C                     MOVE 'Y'       CLE004                          CLE004
     C                     END                                            CLE004
      *                                                                   CLE004
     C           @RTCD     IFNE *BLANKS                                   CLE004
     C           @RTCD     ANDNE'*NRF   '                                 CLE004
      *                                                                   CLE004
      ** Call to program ended in error                                   CLE004
      *                                                                   CLE004
     C                     SETON                     U7U8                 CLE004
     C                     MOVEL'CLE004'  DBKEY            ***************CLE004
     C                     MOVE 'SCSARDPD'DBFILE           * DB ERROR 10 *CLE004
     C                     Z-ADD10        DBASE            ***************CLE004
     C                     GOTO END                                       CLE004
     C                     ENDIF                                          CLE004
      *                                                                   CLE004
      ** Set on indicator if CLE004 is switched *ON                       CLE004
      *                                                                   CLE004
     C           CLE004    IFEQ 'Y'                                       CLE004
     C                     MOVE *ON       *IN70                           CLE004
     C                     END                                            CLE004
      *                                                                                       CLE040
      ** Check if Collateralised Lending is available                                         CLE040
      *                                                                                       CLE040
     C                     MOVE 'N'       CLE024  1                                           CLE040
     C                     MOVE *OFF      *IN43                                               CLE040
     C                     CALL 'AOSARDR0'                                                    CLE040
     C                     PARM *BLANKS   @RTCD                                               CLE040
     C                     PARM '*VERIFY' @OPTN                                               CLE040
     C                     PARM 'CLE024'  @SARD                                               CLE040
     C           SCSARD    PARM SCSARD    DSFDY                                               CLE040
      *                                                                                       CLE040
     C           @RTCD     IFEQ *BLANKS                                                       CLE040
     C                     MOVE *ON       *IN43                                               CLE040
     C                     MOVE 'Y'       CLE024                                              CLE040
     C                     ENDIF                                                              CLE040
      *                                                                                       CLE040
     C           @RTCD     IFNE *BLANKS                                                       CLE040
     C           @RTCD     ANDNE'*NRF   '                                                     CLE040
      *                                                                                       CLE040
      ** Call to program ended in error                                                       CLE040
      *                                                                                       CLE040
     C                     MOVE *ON       *INU7                                               CLE040
     C                     MOVE *ON       *INU8                                               CLE040
     C                     MOVEL'CLE024'  DBKEY                                               CLE040
     C                     MOVE 'SCSARDPD'DBFILE                                              CLE040
     C                     Z-ADD11        DBASE                                               CLE040
     C                     GOTO END                                                           CLE040
     C                     ENDIF                                                              CLE040
      *                                                                                       CLE040
      ** Check if Credit Lines is available                                                   CLE040
      *                                                                                       CLE040
     C                     MOVE 'N'       CLE025  1                                           CLE040
     C                     MOVE *OFF      *IN39                                               CLE040
     C                     CALL 'AOSARDR0'                                                    CLE040
     C                     PARM *BLANKS   @RTCD                                               CLE040
     C                     PARM '*VERIFY' @OPTN                                               CLE040
     C                     PARM 'CLE025'  @SARD                                               CLE040
     C           SCSARD    PARM SCSARD    DSFDY                                               CLE040
      *                                                                                       CLE040
     C           @RTCD     IFEQ *BLANKS                                                       CLE040
     C                     MOVE *ON       *IN39                                               CLE040
     C                     MOVE 'Y'       CLE025                                              CLE040
     C                     ENDIF                                                              CLE040
      *                                                                                       CLE040
     C           @RTCD     IFNE *BLANKS                                                       CLE040
     C           @RTCD     ANDNE'*NRF   '                                                     CLE040
      *                                                                                       CLE040
      ** Call to program ended in error                                                       CLE040
      *                                                                                       CLE040
     C                     MOVE *ON       *INU7                                               CLE040
     C                     MOVE *ON       *INU8                                               CLE040
     C                     MOVEL'CLE025'  DBKEY                                               CLE040
     C                     MOVE 'SCSARDPD'DBFILE                                              CLE040
     C                     Z-ADD12        DBASE                                               CLE040
     C                     GOTO END                                                           CLE040
     C                     ENDIF                                                              CLE040
     C/COPY WNCPYSRC,LEH00149
0198 C**
0199 C                     SETON                     40
0200 C**********************************
0201 C           DETAIL    TAG                             **DETAIL TAG**
     C**
     C***********          SETOF                     4546         E13592  E20763
     C***51*52****         SETOF                     5152                                     193470
      *                                                                                       193470
      ** Do not reset indicators if next record is a Loan/MFU.                                193470
      *                                                                                       193470
     C           *IN51     IFEQ '1'                                                           193470
     C           *IN52     ANDEQ'1'                                                           193470
     C           *IN50     ANDEQ'0'                                                           193470
     C                     MOVE '0'       *IN51                                               193470
     C                     MOVE '0'       *IN52                                               193470
     C                     ENDIF                                                              193470
     C   51                SETON                     52
     C   L1                SETON                     51
      *                                                                                       190571
      ** Set on *IN51 on page overflow in order to print the customer                         190571
      ** name and number at the top of a new page. (OF is off by the                          190571
      ** time the Loan/MFU type record has been read).                                        190571
      *                                                                                       190571
     C   OF                SETON                     51                                       190571
      *                                                                                       193470
      ** Save Overflow indicator so that the Customer name and number                         193470
      ** are not displayed unnecessarily when the first detail record                         193470
      ** sets the overflow upon writing to the last line of the page.                         193470
      *                                                                                       193470
     C           *INOF     IFEQ '1'                                                           193470
     C                     MOVE '1'       *IN53                                               193470
     C                     ELSE                                                               193470
     C                     MOVE '0'       *IN53                                               193470
     C                     ENDIF                                                              193470
     C**
0202 C   03                SETON                     LR
0203 C  N01N02             GOTO END
     C**                                                                  S01117
     C**      END AFTER THE REQUESTED BRANCH                              S01117
      *                                                                                       CLE040
      ** If either Credit Lines or Collateralised Lending is available,                       CLE040
      ** access Facilities Extension file                                                     CLE040
      *                                                                                       CLE040
     C           CLE024    IFEQ 'Y'                                                           CLE040
     C           CLE025    OREQ 'Y'                                                           CLE040
     C           *IN01     IFEQ '1'                                                          BUG8220
     C                     MOVE 'N'       WKERRF  1                                           CLE040
     C                     EXSR SRRTVX                                                        CLE040
     C           WKERRF    IFEQ 'Y'                                                           CLE040
     C                     MOVE *ON       *INU7                                               CLE040
     C                     MOVE *ON       *INU8                                               CLE040
     C                     MOVE *BLANKS   DBKEY                                               CLE040
     C                     MOVELWKFCLT    DBKEY                                               CLE040
     C                     MOVE 'LEFCLTQD'DBFILE                                              CLE040
     C                     Z-ADD13        DBASE                                               CLE040
     C                     GOTO END                                                           CLE040
     C                     ENDIF                                                              CLE040
     C                     ENDIF                                                             BUG8220
     C                     ENDIF                                                              CLE040
      *                                                                                       244459
      ** Deleted codes, changed facility participant indicator                                244459
      ** to loan participant indicator.                                                       244459
      *                                                                                       244459
      *****************************************************************                CLE004 244459
      ***Move*the*value*of*the*participant*indicator*for*printing******                CLE004 244459
      *****************************************************************                CLE004 244459
     C***********CLE004****IFEQ*'Y'************************************                CLE004 244459
     C*********************MOVE*PRTR******RPART***1********************                CLE004 244459
     C*********************ENDIF***************************************                CLE004 244459
      *                                                                                       244459
      ** Do not print participant facilities(I,P,R) as they are                               244459
      ** redundant since participant loans are already shown in                               244459
      ** agent facility                                                                       244459
      *                                                                                       244459
     C                     MOVE *OFF      *IN44                                               244459
     C           PRTR      IFNE 'A'                                                           244459
     C           PRTR      ANDNE*BLANK                                                        244459
     C                     MOVE *ON       *IN44                                               244459
     C                     ENDIF                                                              244459
     C**                                                                  S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C           BRNCH     ANDNE'ALL'                                     S01117
     C           FCLB      ANDGTBRNCH                                     S01117
     C                     SETON                     LR                   S01117
     C                     SETOF                     37                   S01117
     C                     GOTO END                                       S01117
     C                     END                                            S01117
     C**                                                                  S01117
     C**      SKIP TO THE REQUESTED BRANCH                                S01117
     C**                                                                  S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C           BRNCH     ANDNE'ALL'                                     S01117
     C           BRNCH     ANDNEFCLB                                      S01117
     C                     SETOF                     37                   S01117
     C                     GOTO END                                       S01117
     C                     END                                            S01117
     C*                                                                   S01117
0204 C                     SETOF                     42
     C*                                                                   S01117
     C**      AT CHANGE OF BRANCH CODE EXECUTE PRINT                      S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C           *INL2     ANDEQ'1'                                       S01117
     C                     CLOSELE0720P1                                  S01117
     C           BRNCH     IFEQ 'ALL'                                     S01117
     C           BRNCH     OREQ FCLB                                      S01117
     C                     SETON                     3785  ALLOW OUTPUT   S01117
     C                     OPEN LE0720P1                                  S01117
     C                     Z-ADD0         PAGE                            S01117
     C**   ENSURE REPORT SPOOL FILE RECORDED BY RCF                       S01117
     C**
     C                     Z-ADDSFNUM     ZSNUM   60                      S01117
     C                     OUT  LDA                                       S01117
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           SEQ                             S01117
     C                     PARM FCLB      SENTY   3                       S01117
     C                     PARM           SFILE                           S01117
     C                     PARM           ZSNUM                           S01117
     C                     PARM           ZSERR   1                       S01117
     C           *LOCK     IN   LDA                                       S01117
      *                                                                   S01117
     C           ZSERR     IFEQ 'Y'                                       S01117
      **  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM       S01117
     C                     SETON                     U7U8LR               S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C**  GET BRANCH NAME                                                 S01117
     C* Check whether details for Branch already in array                                     CSC042
     C                     MOVELFCLB      ##KB                                                CSC042
     C                     EXSR ##CHKB                                                        CSC042
      * If branch is in the array then use the details                                        CSC042
     C           ##FIC     IFEQ 'Y'                        *** B10                            CSC042
     C                     EXSR ##SETB                                                        CSC042
     C                     ELSE                            *** X10                            CSC042
     C**********           CALL 'AOBRCHR0'                                S01117              CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       S01117
     C                     PARM '*KEY   ' @OPTN   7                       S01117
     C                     PARM FCLB      @DSNB   3                       S01117
     C********** SDBRCH    PARM SDBRCH    DSFDY                           S01194              CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C*                                                                   S01117
     C           @RTCD     IFNE *BLANKS                                   S01117
     C                     SETON                     U7U8LR               S01117
     C                     MOVEL'SDBRCHPD'DBFILE                          S01117
     C                     MOVEL@DSNB     DBKEY            ************** S01117
     C                     MOVEL@OPTN     DBOPTN  7        *DATABASE 04 * S01117
     C                     Z-ADD4         DBASE            ************** S01117
     C                     MOVEL*BLANKS   BRNM                            S01117
     C                     EXSR *PSSR                                     S01117
     C                     GOTO END                                       S01117
     C                     ELSE                                                               CSC042
      * Details found on the DB so add them to the array                                      CSC042
      * if the array still has room                                                           CSC042
     C                     EXSR ##ADDB                                                        CSC042
     C                     END                                            S01117
     C                     END                             *** E10                            CSC042
     C*                                                                   S01117
     C                     ELSE                                           S01117
     C*                                                                   S01117
     C                     SETOF                     37                   S01117
     C                     END                                            S01117
     C                     END                                            S01117
0205 C**********************************
0206 C**   COMMITMENT/FACILITY RECORD PROCESSING
0207 C**
0208 C**   SET INDICATORS TO DETERMINE FIRST LOAN PER FAC/CMMT.
0209 C   01                SETON                     4748
0210 C**
0211 C**   DETERMINE IF FACILITY/COMMITMENT
     C**   SET OFF INDICATORS BEFORE USING                                E20763
     C   01                SETOF                     4546                 E20763
0212 C   01      FACI      COMP 'F'                      45
     C/COPY WNCPYSRC,LE0720C002
     C**
     C**   IF FACILITY, AND HAS EXPIRED, SET AVAILABLE AMOUNT TO ZERO
     C   01 45   EXPI      COMP 'E'                      46
     C/COPY WNCPYSRC,LE0720C001
     C***01*45*46          Z-ADD0         CAVL                            E12122
0213 C**
0214 C**   DETERMINE CURRENCY DEC. PLACES
0215 C   01                MOVE CMCY      XCCY
0216 C   01                EXSR CCYDEP
0217 C   01 99             SETON                     U7U8  **DATABASE 02**
0218 C   01 99             Z-ADD2         DBASE
0219 C***01*99******       MOVE CCYKEY    DBKEY                           S01194
0220 C***01*99******       MOVE 'TABLE'   DBFILE                          S01194
0219 C   01 99             MOVE XCCY      DBKEY                           S01194
0220 C   01 99             MOVE 'SDCURRPD'DBFILE                          S01194
0221 C   01 99             GOTO END
0222 C**
0223 C   01      XDECP     COMP 1                      6061
0224 C   01      XDECP     COMP 2                    63  62
     C/COPY WNCPYSRC,LE0720C003
0225 C**
0226 C**   PERFORM RECORD COUNT & HASH TOTALLING
0227 C   01      COUNT1    ADD  1         COUNT1  50
0228 C   01                Z-ADDHSHWN1    ZZTOTI
0229 C   01                Z-ADDHSHDC1    ZZTOTD
0230 C   01                MOVE CAMT      ZZAMT
0231 C   01                EXSR GLZADD
0232 C   01                Z-ADDZZTOTI    HSHWN1 150
0233 C   01                Z-ADDZZTOTD    HSHDC1  30
0234 C**********************************
0235 C*****DRAWDOWN/LOAN*RECORD*PROCESSING*****************************   S01339
0236 C**                                                                  S01339
0235 C**   LOAN RECORD PROCESSING                                         S01339
0236 C**                                                                  S01339
0237 C**   SET INDICATORS TO DETERMINE FIRST LOAN PER FAC/CMMT.
0238 C   02N47             SETOF                     48
0239 C   02                SETOF                     47
      *                                                                   S01473
      **   Set *IN04 on if it is a Leo Transaction                        S01473
     C   02      RECI      COMP 'L'                      04               S01473
     C**
     C**   CHECK IF NEXT RECORD IS LOAN RECORD
     C                     SETOF                     50
     C           NRECT     COMP 'L'                      50
     C  N50      NRECT     COMP 'M'                      50                                   190571
     C   01 51N50          SETON                     52
0240 C**
0241 C**   DETERMINE CURRENCY DEC.PLACES
0242 C   02                MOVE DDCY      XCCY
0243 C   02                EXSR CCYDEP
0244 C   02 99             SETON                     U7U8  **DATABASE 03**
0245 C   02 99             Z-ADD3         DBASE
0246 C***02*99******       MOVE CCYKEY    DBKEY                           S01194
0247 C***02*99******       MOVE 'TABLE'   DBFILE                          S01194
0246 C   02 99             MOVE XCCY      DBKEY                           S01194
0247 C   02 99             MOVE 'SDCURRPD'DBFILE                          S01194
0248 C   02 99             GOTO END
0249 C**
     C   02      XDECP     COMP 1                      6667
     C   02      XDECP     COMP 2                    69  68
0252 C**   DETERMINE MATURITY DATE
0253 C   02 21             Z-ADDMDAT      ZDAYNO
0254 C   02 21             EXSR ZDATE2
0255 C   02 21             MOVE ZADATE    MATDAT  7
      *                                                                   S01473
      **   If this is a Leo Transaction, do not do the Hash total         S01473
      **   Processing.                                                    S01473
     C   02 04             GOTO END                                       S01473
0256 C**
0257 C**   PERFORM RECORD COUNT & HASH TOTALLING
0258 C   02      COUNT2    ADD  1         COUNT2  50
0259 C   02                Z-ADDHSHWN2    ZZTOTI
0260 C   02                Z-ADDHSHDC2    ZZTOTD
0261 C**
0262 C**   IF AMOUNT IS NEGATIVE,REVERSE SIGN
0263 C   02      AMNT      DIV  1000      ZZAMT        41
0264 C   02 41             Z-SUBZZAMT     ZZAMT
0265 C   02                EXSR GLZADD
0266 C   02                Z-ADDZZTOTI    HSHWN2 150
0267 C   02                Z-ADDZZTOTD    HSHDC2  30
0268 C**
0269 C           END       TAG                             **END TAG**
0270 C   U7                SETON                     LR
0271 C**
0272 C**   LAST RECORD PROCESSING
0273 C*RNU8******COUNT1    COMP NOFR                 U8U8                 S01117
0274 C*RNU8******HSHWN1    COMP HFDW                 U8U8                 S01117
0275 C*RNU8******HSHDC1    COMP HFDC                 U8U8                 S01117
0273 CLRNU8 75   COUNT1    COMP NOFR                 U8U8                 S01117
0274 CLRNU8 75   HSHWN1    COMP HFDW                 U8U8                 S01117
0275 CLRNU8 75   HSHDC1    COMP HFDC                 U8U8                 S01117
0276 CLR U8NU7             SETON                     65
0277 C**
0278 C*RNU8******COUNT2    COMP NOLR                 U8U8                 S01117
0279 C*RNU8******HSHWN2    COMP HLDW                 U8U8                 S01117
0280 C*RNU8******HSHDC2    COMP HLDC                 U8U8                 S01117
0278 CLRNU8 75   COUNT2    COMP NOLR                 U8U8                 S01117
0279 CLRNU8 75   HSHWN2    COMP HLDW                 U8U8                 S01117
0280 CLRNU8 75   HSHDC2    COMP HLDC                 U8U8                 S01117
0281 CLR U8NU7N65          SETON                     64
     C*                                                                   S01117
     C**   ENSURE TOTALS SPOOL FILE RECORDED BY RCF                       S01117
     C**
     CLR                   Z-ADDSFNUMU    ZSNUMU  60                      S01117
     CLR                   OUT  LDA                                       S01117
     CLR                   CALL 'ZSFILE'                                  S01117
     CLR                   PARM           SEQ                             S01117
     CLR                   PARM *BLANKS   SENTY   3                       S01117
     CLR                   PARM           SFILEU                          S01117
     CLR                   PARM           ZSNUMU                          S01117
     CLR                   PARM           ZSERR   1                       S01117
     CLR         *LOCK     IN   LDA                                       S01117
      *                                                                   S01117
     CLR         ZSERR     IFEQ 'Y'                                       S01117
      **  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM       S01117
     CLR                   SETON                     U7U8                 S01117
     CLR                   RETRN                                          S01117
     CLR                   END                                            S01117
     CLR U7 U8             EXSR *PSSR                                     S01117
     C*                                                                   S01117
     C**   OPEN REPORT FILE WHEN NO DETAIL TO REPORT                      S01117
     CLRN85                EXSR #ZZ                                       S01117
0260  ********************************************************************                    CLE040
0261  /SPACE 3                                                                                CLE040
0262  ********************************************************************                    CLE040
0263  *                                                                  *                    CLE040
0264  * SRRTVX - Subroutine that Retrieves Fields in Facility Extension  *                    CLE040
0264  *          File                                                    *                    CLE040
0266  *                                                                  *                    CLE040
0262  ********************************************************************                    CLE040
     C           SRRTVX    BEGSR                                                              CLE040
      *                                                                                       CLE040
     C                     MOVE FCLB      KFCLB   3                                          BUG8070
     C                     MOVE CNUM      KCNUM   6                                           CLE040
     C                     MOVE CFN1      KFTYP   3                                           CLE040
     C                     MOVE CFN2      KFCNO   2                                           CLE040
      *                                                                                       CLE040
     C           KLFEXT    KLIST                                                              CLE040
     C**********           KFLD           BRCA                                               BUG8070
     C                     KFLD           KFCLB                                              BUG8070
     C                     KFLD           KCNUM                                               CLE040
     C                     KFLD           KFTYP                                               CLE040
     C                     KFLD           KFCNO                                               CLE040
      *                                                                                       CLE040
     C           KLFEXT    CHAINLEFCLTLG             38                                       CLE040
     C           *IN38     IFEQ *ON                                                           CLE040
     C           KLFEXT    CHAINLEAGFYL4             38                                     AR888974
     C           *IN38     IFEQ *ON                                                         AR888974
     C                     MOVE 'Y'       WKERRF                                              CLE040
     C                     ENDIF                                                            AR888974
     C                     ENDIF                                                              CLE040
      *                                                                                       CLE040
     C                     ENDSR                                                              CLE040
0282 C********************************************************************
0283 C/SPACE 3
0284 C********************************************************************
0285 C**
0286 C**   SR. TO SET UP AN ARRAY OF CURRENCIES AND AN ARRAY OF
0287 C**   DECIMAL PLACES FOR THOSE CURRENCIES.
0288 C**
0289 C           CCYARR    BEGSR                           *** CCYARR  ***
0290 C**
0291 C**   SET OFF ERROR INDICATOR
0292 C                     SETOF                     99
0293 C**
0294 C**   SET ARRAY INDEX TO ZERO.
0295 C                     Z-ADD0         X       30
0296 C**************                                                      S01194
0297 C*****SET*UP*KEY FOR CURRENCY TABLE.                                 S01194
0298 C**************       MOVEL'20      'XCYKEY 12                       S01194
0299 C**************       MOVE '    '    XCYKEY                          S01194
0300 C**
0301 C*****SET*LOWER*LIMIT*AND*READ*CURRENCY*TABLE*HEADER.*               S01194
0301 C**   SET LOWER LIMIT AND READ SDCURRPD HEADER.                      S01194
0302 C***********XCYKEY    SETLLTABLED                                    S01194
0303 C**                                                                  S01194
0304 C**   LOOP TO READ CURRENCY DETAIL RECORDS.
0305 C           XLOOP     TAG                             ** XLOOP TAG **
0306 C**************       READ TABLED                   99               S01194
     C                     READ SDCURRPD                 99               S01194
0307 C**N99******RECT      COMP 20                   9999                 S01194
0308 C**
0309 C**   END IF ALL CURRENCY RECORDS PROCESSED
0310 C   99                GOTO XCAEND
0311 C**************                                                      S01194
0312 C*****IGNORE*DELETED RECORDS AND NON-SUB-RECORD ONE.                 S01194
0313 C***********RECI      COMP 'D'                  9797                 S01194
0314 C***97*********       GOTO XLOOP                                     S01194
0315 C***********SREC      COMP 1                    9797                 S01194
0316 C***97*********       GOTO XLOOP                                     S01194
0317 C**
0318 C**   INCREMENT ARRAY INDEX.
0319 C           X         ADD  1         X
0320 C**
0321 C**   MOVE DATA INTO ARRAYS.
0322 C***********          MOVE CCY       XCYA,X                          S01194
0323 C***********          MOVE CDP       XDPA,X                          S01194
     C                     MOVE A6CYCD    XCYA,X                          S01194
     C                     MOVE A6NBDP    XDPA,X                          S01194
0324 C**
0325 C**   CHECK FOR FULL ARRAY.96 ON IF FULL.
0326 C           X         COMP 150                      96
0327 C**
0328 C**   GO TO READ NEXT RECORD.
0329 C  N96                GOTO XLOOP
0330 C**
0331 C           XCAEND    ENDSR                           ** XCAEND **
0332 C**
0333 C********************************************************************
0334 C********************************************************************
0335 C**
0336 C**   SR. TO OBTAIN NO. OF DECIMAL PLACES FOR A CURRENCY.
0337 C**
0338 C           CCYDEP    BEGSR                           *** CCYDEP  ***
0339 C**
0340 C**   BLANK CURRENCY CODE IS INVALID
0341 C           XCCY      COMP '   '                    99
0342 C   99                GOTO XCDEND
0343 C**
0344 C**   SET ARRAY INDEX TO ONE
0345 C                     Z-ADD1         X
0346 C**
0347 C**   INITIALIZE INPUT-OUTPUT FIELDS.
0348 C                     Z-ADD0         XDECP   10
0349 C                     MOVE XCCY      XCCY    3
0350 C**
0351 C**   LOOK UP NO. OF DECIMAL PLACES FOR CURRENCY.
0352 C**   99 SETON FOR INVALID CURRENCY.
0353 C           XCCY      LOKUPXCYA,X                   95
0354 C   95                MOVE XDPA,X    XDECP
0355 C  N95                SETON                     99
0356 C**
0357 C           XCDEND    ENDSR                           ** XCDEND **
0358 C**
0359 C********************************************************************
      /EJECT                                                                                  CSC042
     C********************************************************************                    CSC042
      *                                                                                       CSC042
      * ##CHKB - Subroutine to check the Branch in the arrays                                 CSC042
      *                                                                                       CSC042
     C           ##CHKB    BEGSR                                                              CSC042
      *                                                                                       CSC042
     C           *LIKE     DEFN A8BRCD    ##KB                                                CSC042
      *                                                                                       CSC042
      * Set off the branch found indicator                                                    CSC042
     C                     MOVEL*BLANK    ##FIC   1                                           CSC042
      *                                                                                       CSC042
      * Save the state of indicator 30 so it can be reset at the end                          CSC042
      * of the SR as it may be used elsewhere in the code                                     CSC042
     C           *IN30     IFEQ *ON                                                           CSC042
     C                     MOVEL'Y'       #IN30   1                                           CSC042
     C                     ELSE                                                               CSC042
     C                     MOVEL'N'       #IN30                                               CSC042
     C                     END                                                                CSC042
      *                                                                                       CSC042
     C                     SETOF                         30                                   CSC042
      *                                                                                       CSC042
      * Restore the saved Value of B                                                          CSC042
     C                     Z-ADD##BSV     B                                                   CSC042
      *                                                                                       CSC042
     C* Check whether details for Branch already in array                                     CSC042
      *                                                                                       CSC042
      * Is this the same as the last LOKUP, if so we can bypass                               CSC042
      * the LOKUP                                                                             CSC042
      * Defend against B being 0                                                              CSC042
     C           B         IFEQ 0                                                             CSC042
     C                     Z-ADD1         B                                                   CSC042
     C                     END                                                                CSC042
      *                                                                                       CSC042
      * If the branch being checked is the same then use these                                CSC042
      * details rather than doing a LOKUP                                                     CSC042
     C           ##KB      IFEQ ##BR,B                                                        CSC042
      * Found so seton 30                                                                     CSC042
     C                     SETON                         30                                   CSC042
     C                     ELSE                                                               CSC042
     C                     Z-ADD1         B                                                   CSC042
     C           ##KB      LOKUP##BR,B                   30                                   CSC042
     C                     END                                                                CSC042
      *                                                                                       CSC042
      * Save the last update to B                                                             CSC042
     C           *IN30     IFEQ *ON                                                           CSC042
     C                     Z-ADDB         ##BSV                                               CSC042
      * Set the indicator to show the data was found                                          CSC042
     C                     MOVEL'Y'       ##FIC                                               CSC042
     C                     END                                                                CSC042
      *                                                                                       CSC042
      * Reset the state of indicator 30.                                                      CSC042
     C           #IN30     IFEQ 'Y'                                                           CSC042
     C                     MOVEL*ON       *IN30                                               CSC042
     C                     ELSE                                                               CSC042
     C                     MOVEL*OFF      *IN30                                               CSC042
     C                     END                                                                CSC042
      *                                                                                       CSC042
     C                     ENDSR                                                              CSC042
      ********************************************************************                    CSC042
      /EJECT                                                                                  CSC042
      ********************************************************************                    CSC042
      *                                                                                       CSC042
      * ##SETB - Sets up the SDBRCHPD fields used in the code from the                        CSC042
      * arrays                                                                                CSC042
      *                                                                                       CSC042
     C           ##SETB    BEGSR                                                              CSC042
      *                                                                                       CSC042
     C                     MOVEL##BR,B    A8BRCD                                              CSC042
     C                     MOVEL##BN,B    BRNM                                                CSC042
      *                                                                                       CSC042
     C                     ENDSR                                                              CSC042
      *                                                                                       CSC042
      ********************************************************************                    CSC042
      /EJECT                                                                                  CSC042
      ********************************************************************                    CSC042
      *                                                                                       CSC042
      * ##ADDB - Adds the SDBRCHPD fields used in the code to the                             CSC042
      * arrays                                                                                CSC042
      *                                                                                       CSC042
     C           ##ADDB    BEGSR                                                              CSC042
      *                                                                                       CSC042
      * If there is still room i` the array then add the details                              CSC042
     C           ##BNDX    IFLT 999                                                           CSC042
     C                     ADD  1         ##BNDX                                              CSC042
     C                     Z-ADD##BNDX    B                                                   CSC042
     C                     MOVELA8BRCD    ##BR,B                                              CSC042
     C                     MOVELBRNM      ##BN,B                                              CSC042
     C                     END                                                                CSC042
      *                                                                                       CSC042
      * Update ##BSV  so next call to ##CHKB checks this latest adddition                     CSC042
      * to the array first                                                                    CSC042
     C                     Z-ADDB         ##BSV                                               CSC042
      *                                                                                       CSC042
     C                     ENDSR                                                              CSC042
      ********************************************************************                    CSC042
      /EJECT                                                                                  CSC042
      ********************************************************************                    CSC042
0360 C********************************************************************
0361 C* SUBROUTINE TO ADD AN AMOUNT (ZZAMT) TO THE TOTAL (ZZTOTI,ZZTOTD)
0362 C*   IND '99' IS SET BY AN OVERFLOW ERROR
0363 C*
0364 CSR         GLZADD    BEGSR                           *** GLZADD ****
0365 C*
0366 CSR                   Z-ADDZZAMT     ZZAMT  153     91-DEFINE ZZAMT
0367 CSR 91                GOTO ZZAEND                     AMT = 0.BYPASS
0368 C*
0369 C* SPLIT ZZAMT INTO INTEGER AND DECIMAL FIELDS
0370 CSR                   Z-ADDZZAMT     ZZAMTI 150       INTEGER FIELD
0371 CSR                   MOVE ZZAMT     ZZAMTD  30       DECIMAL FIELD
0372 C* BOTH ZZAMTI AND ZZAMTD CONTAIN A 'SIGN' ZONE NOW
0373 C*
0374 CSR                   EXSR GLZSUM
0375 CSR         ZZAEND    ENDSR                           ** ZZAEND TAG *
0376 C*
0377 C********************************************************************
0378 C********************************************************************
0379 C* SUBROUTINE TO CARRY OUT THE ADDITION FOR SUBROUTINES -
0380 C*                        GLZADD, GLZSUB, GLZCMP.
0381 C*          PARAMETERS PASSED -
0382 C*                     I/P ZZAMTI ZZAMTD
0383 C*                     O/P ZZTOTI ZZTOTD ZZNEGD IND 96 IND 99.
0384 C*
0385 CSR         GLZSUM    BEGSR                           *** GLZSUM ****
0386 C*
0387 CSR                   Z-ADDZZTOTI    ZZTOTI 150       DEFINE ZZTOTI
0388 CSR                   Z-ADDZZTOTD    ZZTOTD  30       DEFINE ZZTOTD
0389 CSR                   SETOF                     919293
0390 CSR                   SETOF                     949599
0391 C*
0392 C*    DETERMINE SIGN OF ZZAMTI & D,   92 IF NEG
0393 CSR         ZZAMTI    COMP 0                      9293
0394 CSR 93      ZZAMTD    COMP 0                      9293
0395 CSR 93                GOTO ZZSEND                     ZERO BYPASS
0396 C*
0397 C*    DETERMINE SIGN OF ZZTOTI & D, 91 IF NEG.
0398 CSR         ZZTOTI    COMP 0                      9193
0399 CSR 93      ZZTOTD    COMP 0                      9193
0400 C*
0401 C*    IF ZZTOTAL IS ZERO, RETURN ZZAMOUNT.
0402 CSR 93                Z-ADDZZAMTI    ZZTOTI
0403 CSR 93                Z-ADDZZAMTD    ZZTOTD
0404 CSR 93                GOTO ZZSEND                     ZERO BYPASS
0405 C*    IF SIGNS DIFFER BYPASS OVERFLOW CHECKS.
0406 CSR 91N92
0407 CORN91 92             GOTO ZZOFPS
0408 C*
0409 CSR         ZZAMTD    ADD  ZZTOTD    ZZWK2   40
0410 CSR         ZZWK2     COMP 999                  93    '93' = CARRY
0411 CSRN93      ZZWK2     COMP -999                   93    INTO INTEGER.
0412 C*
0413 CSR 93N92   ZZAMTI    ADD  1         ZZWK3  150       ADD 'CARRY' +VE
0414 CSR    93 92ZZAMTI    SUB  1         ZZWK3            SUB 'CARRY' -VE
0415 CSR 93      ZZTOTI    ADD  ZZWK3     ZZWK3
0416 CSRN93      ZZTOTI    ADD  ZZAMTI    ZZWK3
0417 C*
0418 C* IF THE MODULUS OF ZZWK3 IS LT MOD. ZZTOTI THEN O/F HAS OCCURED
0419 CSRN92      ZZWK3     COMP ZZTOTI                 99  -92 MEANS NOS.
0420 CSR 92      ZZWK3     COMP ZZTOTI               99     NEGATIVE
0421 CSRN99                Z-ADDZZWK2     ZZTOTD
0422 CSRN99                Z-ADDZZWK3     ZZTOTI
0423 C*
0424 C* IF O/F ZEROIZE ZZAMT , IND '99' SET AND ZZTOT FIELDS LEFT INTACT.
0425 CSR 99                Z-ADD0         ZZAMT  153
0426 CSR                   GOTO ZZSEND
0427 C*
0428 C* THE 'SIGNS' ARE DIFFERENT
0429 CSR         ZZOFPS    TAG                             ** ZZOFPS TAG**
0430 C* IF ZZAMT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZTOT
0431 C*
0432 CSR 92                Z-SUBZZAMTI    ZZAMTI 150
0433 CSR 92                Z-SUBZZAMTD    ZZAMTD  30
0434 C*
0435 C* IF ZZTOT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZAMT.
0436 C*
0437 CSR 91                Z-SUBZZTOTI    ZZTOTI
0438 CSR 91                Z-SUBZZTOTD    ZZTOTD
0439 C* BOTH ZZAMT AND ZZTOT ARE NOW POSITIVE.
0440 C*
0441 CSR         ZZTOTI    COMP ZZAMTI               93  95
0442 CSR 95      ZZTOTD    COMP ZZAMTD               93  95
0443 C*
0444 C* IF ZZTOT EQ. ZZAMT RETURN ZERO.
0445 CSR 95                Z-ADD0         ZZTOTI
0446 CSR 95                Z-ADD0         ZZTOTD
0447 CSR 95                GOTO ZZSEND
0448 C*
0449 C* IF ZZTOT GT. ZZAMT.
0450 CSR 93      ZZAMTD    COMP ZZTOTD               94
0451 CSR 93 94   ZZTOTI    SUB  1         ZZTOTI
0452 CSR 93 94   ZZTOTD    ADD  1000      ZZWK2
0453 CSR 93      ZZTOTI    SUB  ZZAMTI    ZZTOTI
0454 CSR 93 94   ZZWK2     SUB  ZZAMTD    ZZTOTD
0455 CSR 93N94   ZZTOTD    SUB  ZZAMTD    ZZTOTD
0456 C*
0457 C*
0458 C* IF ZZAMT GT. ZZTOT.
0459 CSRN93      ZZTOTD    COMP ZZAMTD               94
0460 CSRN93 94   ZZAMTI    SUB  1         ZZWK3  150
0461 CSRN93 94   ZZAMTD    ADD  1000      ZZWK2
0462 CSRN93 94   ZZWK3     SUB  ZZTOTI    ZZTOTI
0463 CSRN93N94   ZZAMTI    SUB  ZZTOTI    ZZTOTI
0464 CSRN93 94   ZZWK2     SUB  ZZTOTD    ZZTOTD
0465 CSRN93N94   ZZAMTD    SUB  ZZTOTD    ZZTOTD
0466 C*
0467 C* REVERSE SIGN OF ZZTOT IF LARGER I/P FIELDS WERE NEGATIVE
0468 CSR                   SETOF                     94
0469 CSR 93 91
0470 CORN93 92             SETON                     94
0471 CSR 94                Z-SUBZZTOTI    ZZTOTI
0472 CSR 94                Z-SUBZZTOTD    ZZTOTD
0473 C**
0474 C**   RESTORE SIGN OF ZZAMTI & ZZAMTD IF IT WAS REVERSED.
0475 CSR 92                Z-SUBZZAMTI    ZZAMTI
0476 CSR 92                Z-SUBZZAMTD    ZZAMTD
0477 CSR         ZZSEND    TAG                             ** ZZSEND TAG *
0478 C**
0479 C**   IF ZZTOTD IS ZERO, AND ZZTOTI IS NEG. SET UP ZZNEGD.
0480 CSR                   SETOF                     96
0481 CSR         ZZTOTD    COMP 0                        91
0482 CSR 91      ZZTOTI    COMP 0                      96
0483 CSR 96                MOVE '.000-'   ZZNEGD  5
0484 CSR                   ENDSR                             ** ENDSR **
0485 C********************************************************************
0576 C********************************************************************
0577 C**
0578 C**   ZSYSTM SR. TO CHAIN TO THE INSTALLATION CONTROL DATA RECORD.
0579 C**
0580 C           ZSYSTM    BEGSR                           *** ZSYSTM ***
0581 C**************                                                      S01194
0582 C*****SET*UP*KEY FOR INSTALLATION CONTROL RECORD.                    S01194
0583 C**************       MOVEL'01      'ZTABKY 12                       S01194
0584 C**************       MOVE '  10'    ZTABKY                          S01194
0585 C**************                                                      S01194
0586 C***********ZTABKY    CHAINTABLE                99    ON NOT THERE   S01194
0587 C**N99******RECI      COMP 'D'                  9999  ON, IS DELETED S01194
     C**                                                                  S01194
     C**   ACCESS BANK DETAILS                                            S01194
     C**                                                                  S01194
     C                     CALL 'AOBANKR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDBANK    PARM SDBANK    DSFDY                           S01194
     C*                                                                   S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     SETON                     U7U8LR               S01194
     C                     SETON                     99                   S01194
     C                     MOVEL'SDBANKPD'DBFILE                          S01194
     C                     MOVEL@OPTN     DBKEY            ***************S01194
     C                     MOVEL@OPTN     DBOPTN  7        * DBERROR 001 *S01194
     C                     Z-ADD1         DBASE            ***************S01194
     C                     ELSE                                           S01194
0588 C**
0589 C**   CHECK SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.
0590 C           DATF      COMP 'M'                      98MMDDYY, 98 ON
     C                     END                                            S01194
0591 C**
     C/COPY WNCPYSRC,LE0720C004
0592 C                     ENDSR
0593 C**
     C********************************************************************S01117
     C*                                                                   S01117
     C*    SUBROUTINE : #ZZ                                               S01117
     C*                                                                   S01117
     C*    CALLED BY MAIN PROCESSING DURING TOTAL TIME CALCLATIONS IF     S01117
     C*    THE P1 FILES HAVE NOT ALREADY BEEN OPENDED (IE, IF THERE ARE   S01117
     C*    NO RECORDS READ AND THEREFORE FILES OPENING NOT PERFORMED)     S01117
     C*                                                                   S01117
     C           #ZZ       BEGSR                                          S01117
     C*                                                                   S01117
     C**   OPEN P1 SPOOL FILE                                             S01117
     C                     OPEN LE0720P1                                  S01117
     C                     SETON                     37                   S01117
     C**   IF REPORT FOR ALL ENTITIES OR NOT MULTIBRANCHING               S01117
     C**   CALL ZSFILE WITH BLANK SENTY                                   S01117
     C           BRNCH     IFEQ 'ALL'                                     S01117
     C           MBIN      ORNE 'Y'                                       S01117
     C**   ENSURE REPORT SPOOL FILE RECORDED BY RCF                       S01117
     C**
     C                     Z-ADDSFNUM     ZSNUM   60                      S01117
     C                     OUT  LDA                                       S01117
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           SEQ                             S01117
     C                     PARM *BLANKS   SENTY   3                       S01117
     C                     PARM           SFILE                           S01117
     C                     PARM           ZSNUM                           S01117
     C                     PARM           ZSERR   1                       S01117
     C           *LOCK     IN   LDA                                       S01117
      *                                                                   S01117
     C           ZSERR     IFEQ 'Y'                                       S01117
      **  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM       S01117
     C                     SETON                     U7U8LR               S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C                     MOVEL'ALL'     FCLB                            S01117
     C                     MOVEL*BLANKS   BRNM                            S01117
     C**   ELSE REPORT BY ENTITY SO CALL ZSFILE WITH ENTITY REQUESTED     S01117
     C                     ELSE                                           S01117
     C**   ENSURE REPORT SPOOL FILE RECORDED BY RCF                       S01117
     C                     Z-ADDSFNUM     ZSNUM   60                      S01117
     C                     OUT  LDA                                       S01117
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           SEQ                             S01117
     C                     PARM BRNCH     SENTY   3                       S01117
     C                     PARM           SFILE                           S01117
     C                     PARM           ZSNUM                           S01117
     C                     PARM           ZSERR   1                       S01117
     C           *LOCK     IN   LDA                                       S01117
      *                                                                   S01117
     C           ZSERR     IFEQ 'Y'                                       S01117
      **  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM       S01117
     C                     SETON                     U7U8LR               S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C**
     C*                                                                   S01117
     C                     MOVE BRNCH     FCLB                            S01117
     C**   AND GET ENTITY DETAILS FOR REPORT HEADINGS WHEN                S01117
     C**   MULTIBRANCHING                                                 S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C* Check whether details for Branch already in array                                     CSC042
     C                     MOVELBRNCH     ##KB                                                CSC042
     C                     EXSR ##CHKB                                                        CSC042
      * If branch is in the array then use the details                                        CSC042
     C           ##FIC     IFEQ 'Y'                        *** B10                            CSC042
     C                     EXSR ##SETB                                                        CSC042
     C                     ELSE                            *** X10                            CSC042
     C**********           CALL 'AOBRCHR0'                                S01117              CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       S01117
     C                     PARM '*KEY   ' @OPTN   7                       S01117
     C                     PARM BRNCH     @DSNB   3                       S01117
     C********** SDBRCH    PARM SDBRCH    DSFDY                           S01194              CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C*                                                                   S01117
     C           @RTCD     IFNE *BLANKS                                   S01117
     C                     SETON                     U7U8LR               S01117
     C                     MOVEL'SDBRCHPD'DBFILE                          S01117
     C                     MOVEL@DSNB     DBKEY            ************** S01117
     C                     MOVEL@OPTN     DBOPTN  7        *DATABASE 05 * S01117
     C                     Z-ADD5         DBASE            ************** S01117
     C                     MOVEL*BLANKS   BRNM                            S01117
     C                     EXSR *PSSR                                     S01117
     C                     GOTO #ZZ9                                      S01117
     C                     ELSE                                                               CSC042
      * Details found on the DB so add them to the array                                      CSC042
      * if the array still has room                                                           CSC042
     C                     EXSR ##ADDB                                                        CSC042
     C                     END                                            S01117
     C                     END                             *** E10                            CSC042
     C                     END                                            S01117
     C*                                                                   S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C           #ZZ9      ENDSR                                          S01117
     C********************************************************************S01117
     C********************************************************************S01117
     C*                                                                   S01117
     C*  *PSSR --- SUBROUTINE TO HANDLE ABNORMAL ERROR CONDITIONS         S01117
     C*                                                                   S01117
     C*  CALLED FROM: AFTER ABNORMAL OPERATION OCCURS                     S01117
     C*                                                                   S01117
     C*  CALLS: NOTHING                                                   S01117
     C*                                                                   S01117
     C********************************************************************S01117
     C*                                                                   S01117
     C           *PSSR     BEGSR                           ** *PSSR **    S01117
     C*                                                                   S01117
     C           @RUN      IFEQ *BLANKS                                   S01117
     C                     MOVE 'Y'       @RUN    1                       S01117
     C                     DUMP                                           S01117
     C                     END                                            S01117
     C                     ENDSR                           ** *PSSR **    S01117
0594 C**
0595 C********************************************************************
     C/COPY ZSRSRC,ZDATE2Z4                                               S01392
     C**************************************************************************
0596 O*E0720P1H** 03   OFNL2                                     S01124   S01117
0597 O*******OR**      L2                                                 S01117
0598 O*******OR**      LR 42                                              S01117
0599 O***********                        22 'REFERENCE  LE0720'           S01117
0596 OLE0720P1H   03   OFNL2 37                                           S01117
     O       AND      N44                                                                     244459
0597 O       OR        L2    37                                           S01117
     O       AND      N44                                                                     244459
0598 O       OR        U7 U8 37                                           S01117
     O       AND      N44                                                                     244459
0599 O                                   24 'REFERENCE  LE0720P1'         S01117
0600 O                         TITL      89
0601 O                                  104 'DATE'
0602 O                         RUNA     113
0603 O                                  122 'PAGE'
0604 O                         PAGE  3  128
0605 O********H** 05   OFNL2                                              S01117
0606 O*******OR**      L2                                                 S01117
0607 O*******OR**      LR 42                                              S01117
0608 O***********           N42          11 'BRANCH'                      S01117
0609 O***********           N42BRCD      16                               S01117
0610 O***********                        60 'COMMITMENT AND FACILITY'     S01117
0611 O***********                        83 'AVAILABILITY REPORT BY'      S01117
0612 O***********                        92 'CUSTOMER'                    S01117
0605 O        H   05   OFNL2 37                                           S01117
     O       AND      N44                                                                     244459
0606 O       OR        L2    37                                           S01117
     O       AND      N44                                                                     244459
0607 O       OR        U7 U8 37                                           S01117
     O       AND      N44                                                                     244459
0610 O                                   48 'COMMITMENT AND FACILITY'     S01117
0611 O                                   71 'AVAILABILITY REPORT BY'      S01117
0612 O                                   80 'CUSTOMER'                    S01117
     O                       73          93 'BRANCH'                      S01117
     O                       73FCLB      97                               S01117
     O                       73          98 '-'                           S01117
     O                 73N74 42          98 ' '                           S01117
     O                       73BRNM     128                               S01117
0613 O********H** 06   OFNL2                                              S01117
0614 O*******OR**      L2                                                 S01117
0615 O*******OR**      LR 42                                              S01117
0616 O***********                        60 '-----------------------'     S01117
0617 O***********                        83 '-----------------------'     S01117
0618 O***********                        92 '---------'                   S01117
0613 O        H   06   OFNL2 37                                           S01117
     O       AND      N44                                                                     244459
0614 O       OR        L2    37                                           S01117
     O       AND      N44                                                                     244459
0615 O       OR        U7 U8 37                                           S01117
     O       AND      N44                                                                     244459
0616 O                                   48 '-----------------------'     S01117
0617 O                                   71 '-----------------------'     S01117
0618 O                                   80 '---------'                   S01117
0619 O********H** 08   OFNL2                                              S01117
0620 O*******OR**      L2                                                 S01117
0621 O*******OR**      LR 42                                              S01117
0619 O        H   08   OFNL2 37                                           S01117
     O       AND      N44                                                                     244459
0620 O       OR        L2    37                                           S01117
     O       AND      N44                                                                     244459
0621 O       OR        U7 U8 37                                           S01117
     O       AND      N44                                                                     244459
0622 O                                   52 '----------------COMMITME'
0623 O**********                         76 'NT/FACILITY-------------'                        244459
0624 O**********                         87 '---   -----'                                     244459
     O                                   76 'NT/FACILITY------------ '                        244459
     O                                   87 '----------'                                      244459
0625 O**********                        111 '--------------------LOAN'                        190571
0626 O**********                        130 'S------------------'                             190571
     O                                  111 '--------------LOANS/MFUS'                        190571
     O                                  130 '-------------------'                             190571
0624 O**********                         80 '-'                                        CLE004 244459
     O/COPY WNCPYSRC,LE0720O001
0627 O********H** 09   OFNL2                                              S01117
0628 O*******OR**      L2                                                 S01117
0629 O*******OR**      LR 42                                              S01117
0627 O        H   09   OFNL2 37                                           S01117
     O       AND      N44                                                                     244459
0628 O       OR        L2    37                                           S01117
     O       AND      N44                                                                     244459
0629 O       OR        U7 U8 37                                           S01117
     O       AND      N44                                                                     244459
0630 O                                   23 'CUSTOMER NAME        NO'
     O***********                        42 'NO  TYPE CCY'                CLE004
     O                                   40 'NO TYP CCY'                  CLE004
0632 O***********                        76 'AMOUNT     AVAILABLE AMO'    CLE004
0633 O***********                        97 'UNT   REF   TYPE  CCY'       S01117
0634 O***********                       130 'AMOUNT    COUNTRY   MAT.'    S01117
     O***********           N73          97 'UNT   REF   TYPE  CCY'S01117 CLE004
      *                                                                   CLE004
     O                                   52 'AMOUNT'                      CLE004
     O**********                         75 'AVAILABLE AMOUNT'            CLE004            MD054690
     O                                   74 'AVAILABLE AMOUNT'                              MD054690
     O**********             70          80 'PRT'                                      CLE004 244459
     O**********            N73          97 'REF   TYPE  CCY'                          CLE004 244459
     O**********             73          96 'REF  TYPE  CCY'                           CLE004 244459
     O*                                  81 'LPFI'                                   244459 MD054690
     O                                   80 'LPFI'                                          MD054690
     O**********            N73         100 'REF   TYPE     CCY'                     244459 MD054690
     O**********             73          99 'REF  TYPE     CCY'                      244459 MD054690
     O                      N73          98 'REF   TYPE   CCY'                              MD054690
     O                       73          97 'REF  TYPE   CCY'                               MD054690
      *                                                                   CLE004
     O**********            N73         130 'AMOUNT    COUNTRY   MAT.'               S01117 MD054690
     O***********            73          96 'UNT   REF  TYPE  CCY' S01117 CLE004
     O**********             73         126 'AMOUNT   COUNTRY MAT.'                  S01117 MD054690
     O**********             73         132 'BRANCH'                                 S01117 MD054690
     O                      N73         125 'AMOUNT      COUNTRY'                           MD054690
     O                      N73         132 '   MAT.'                                       MD054690
     O                       73         128 'AMOUNT     COUNTRY MAT.'                       MD054690
     O                       73         132 'BRCH'                                          MD054690
0635 O********H**210   OFNL2                                              S01117
0636 O*******OR** 10   L2                                                 S01117
0637 O*******OR** 10   LR 42                                              S01117
0638 O***********                       130 'RISK DOM.  DATE'             S01117
0635 O        H  210   OFNL2 37                                           S01117
     O       AND      N44                                                                     244459
0636 O       OR   10   L2    37                                           S01117
     O       AND      N44                                                                     244459
0637 O       OR   10   U7 U8 37                                           S01117
     O       AND      N44                                                                     244459
     O/COPY WNCPYSRC,LE0720O003
0638 O**********            N73         130 'RISK DOM.  DATE'                        S01117 MD054690
     O**********             73         126 'RISK DOM.DATE'                          S01117 MD054690
     O                      N73         132 'RISK DOM.  DATE'                               MD054690
     O                       73         128 'RISK DOM.  DATE'                               MD054690
     O        DF20     01NU7N50
     O       AND       37N44                                                                  244459
     O*******AND       37                                                              S01117 244459
     O       ORF20     02NU7 48
     O       AND       37N44                                                                  244459
     O*******AND       37                                                              S01117 244459
     O                 52      CNAM      20
     O                 52      CNUM      27
     O                 OFN52   CNAM      20                                                   190571
     O                 OFN52   CNUM      27                                                   190571
0642 O                      N45CFNO      34
0643 O                       45CFN1      31
0644 O                       45          32 '/'
0645 O                       45CFN2      34
0646 O***********              FATP      37                               CLE004
     O                         FATP      36                               CLE004
     O***********              CMCY      42                               CLE004
     O                         CMCY      40                               CLE004
     O***********      60      CFTA      60 ' ,   ,   ,   , 0 '           CLE004
     O***********      61      CFTA      60 '   ,   ,   , 0 . '           CLE004
     O***********      62      CFTA      60 '  ,   ,   , 0 .  '           CLE004
     O***********      63      CFTA      60 ' ,   ,   , 0 .   '           CLE004
     O***********      60      CFTA      58 ' ,   ,   ,   , 0 '    CLE004 171784
     O***********      61      CFTA      58 '   ,   ,   , 0 . '    CLE004 171784
     O***********      62      CFTA      58 '  ,   ,   , 0 .  '    CLE004 171784
     O***********      63      CFTA      58 ' ,   ,   , 0 .   '    CLE004 171784
     O                 60      CFTA      58 ' ,   ,   ,   , 0 -'          171784
     O                 61      CFTA      58 '   ,   ,   , 0 . -'          171784
     O                 62      CFTA      58 '  ,   ,   , 0 .  -'          171784
     O                 63      CFTA      58 ' ,   ,   , 0 .   -'          171784
     O***********      46                76 '**EXPIRED**'          E12122 CLE004
0652 O***********      60      CAVL      79 ' ,   ,   ,   , 0 -'          E12122
0653 O***********      61      CAVL      79 '   ,   ,   , 0 . -'          E12122
0654 O***********      62      CAVL      79 '  ,   ,   , 0 .  -'          E12122
0655 O***********      63      CAVL      79 ' ,   ,   , 0 .   -'          E12122
     O***********      60N46   CAVL      79 ' ,   ,   ,   , 0 -'   E12122 CLE004
     O***********      61N46   CAVL      79 '   ,   ,   , 0 . -'   E12122 CLE004
     O***********      62N46   CAVL      79 '  ,   ,   , 0 .  -'   E12122 CLE004
     O***********      63N46   CAVL      79 ' ,   ,   , 0 .   -'   E12122 CLE004
     O                 46                74 '**EXPIRED**'                 CLE004
     O***********      60N46   CAVL      77 ' ,   ,   ,   , 0 -'          CLE004            MD054690
     O***********      61N46   CAVL      77 '   ,   ,   , 0 . -'          CLE004            MD054690
     O***********      62N46   CAVL      77 '  ,   ,   , 0 .  -'          CLE004            MD054690
     O***********      63N46   CAVL      77 ' ,   ,   , 0 .   -'          CLE004            MD054690
     O                 60N46   CAVL      76 ' ,   ,   ,   , 0 -'                            MD054690
     O                 61N46   CAVL      76 '   ,   ,   , 0 . -'                            MD054690
     O                 62N46   CAVL      76 '  ,   ,   , 0 .  -'                            MD054690
     O                 63N46   CAVL      76 ' ,   ,   , 0 .   -'                            MD054690
     O**********       70      RPART     79                                            CLE004 244459
     O/COPY WNCPYSRC,LE0720O004
0656 O        D 00     02NU7 48
     O       AND       37N44                                                                  244459
     O*******AND       37                                                              S01117 244459
0657 O       OR 20     02NU7N48
     O       AND       37N44                                                                  244459
     O*******AND       37                                                              S01117 244459
      *                                                                                       193470
      ** Write Customer Name and Number if not a Facility/Commitment                          193470
      ** record upon page overflow.                                                           193470
      *                                                                                       193470
     O                 OF 02 53CNAM      20                                                   193470
     O                 OF 02 53CNUM      27                                                   193470
0658 O***********              DDRF      87                               S01117
0659 O***********            22          93 'SYN.L'                       S01117
0660 O***********           N22LTYP      90                               S01117
0661 O***********           N22          91 '-'                           S01117
0662 O***********           N22SUTP      93                               S01117
0663 O***********              DDCY      97                               S01117
     O***********      66      AMNT     115 ' ,   ,   ,   , 0 -'          S01117
     O***********      67      AMNT     115 '   ,   ,   , 0 . -'          S01117
     O***********      68      AMNT     115 '  ,   ,   , 0 .  -'          S01117
     O***********      69      AMNT     115 ' ,   ,   , 0 .   -'          S01117
0668 O***********              CRSK     119                               S01117
0669 O***********              CLOC     122                               S01117
0670 O***********            21MATDAT   130                               S01117
0658 O***********        N73   DDRF      87                         S01117S01473
0658 O**********      N04N73   DDRF      87                                            S01473 190571
     O***********              LPFI      79                                          244459 MD054690
     O                         LPFI      77                                                 MD054690
     O                N04N73N23DDRF      87                                                   190571
     O                N04N73 23SQNO      83                                                   190571
     O                 04N73   LCNO      87                               S01473
0659 O*****************  N73 22          93 'SYN.L'                S01117 S01339
0660 O*****************  N73N22LTYP      90                        S01117 S01339
0661 O*****************  N73N22          91 '-'                    S01117 S01339
0662 O*****************  N73N22SUTP      93                        S01117 S01339
0660 O***********        N73   LTYP      90                         S01339S01473
0661 O***********        N73             91 '-'                     S01339S01473
0662 O***********        N73   SUTP      93                         S01339S01473
0660 O**********      N04N73   LTYP      90                                            S01473 190571
0661 O**********      N04N73             91 '-'                                        S01473 190571
0662 O**********      N04N73   SUTP      93                                            S01473 190571
     O                N04N73N23LTYP      90                                                   190571
     O**********      N04N73N23          91 '-'                                        190571 244459
     O**********      N04N73N23SUTP      93                                            190571 244459
     O**********      N04N73N23CLAS      97                                            CLE042 244459
     O                N04N73N23SUTP      92                                                   244459
     O                N04N73N23CLAS      96                                                   244459
     O                N04N73 23          93 'MFU  '                                           190571
     O                 04N73   LTPSTP    92                               S01473
0663 O*******************N73   DDCY      97                                            S01117 CLE042
     O**********       66N73   AMNT     115 ' ,   ,   ,   , 0 -'                     S01117 MD054690
     O**********       67N73   AMNT     115 '   ,   ,   , 0 . -'                     S01117 MD054690
     O**********       68N73   AMNT     115 '  ,   ,   , 0 .  -'                     S01117 MD054690
     O**********       69N73   AMNT     115 ' ,   ,   , 0 .   -'                     S01117 MD054690
     O**********         N73   DDCY     100                                            CLE042 245110
     O**********         N73   DDCY      96                                            245110 246590
     O                 66N73   AMNT     118 ' ,   ,   ,   , 0 -'                            MD054690
     O                 67N73   AMNT     118 '   ,   ,   , 0 . -'                            MD054690
     O                 68N73   AMNT     118 '  ,   ,   , 0 .  -'                            MD054690
     O                 69N73   AMNT     118 ' ,   ,   , 0 .   -'                            MD054690
     O                   N73   DDCY     100                                                   246590
     O                   N73   CRSK     121                                                 MD054690
     O                   N73   CLOC     124                                                 MD054690
     O                   N73 21MATDAT   132                                                 MD054690
0668 O**********         N73   CRSK     119                                          S01117 MD054690
0669 O**********         N73   CLOC     122                                          S01117 MD054690
0670 O**********         N73 21MATDAT   130                                          S01117 MD054690
0658 O***********         73   DDRF      86                         S01117S01473
0658 O**********      N04 73   DDRF      86                                            S01473 190571
     O****************N04 73N23DDRF      86                                          190571 MD054690
     O****************N04 73 23SQNO      83                                          190571 MD054690
     O**************** 04 73   LCNO      86                               S01473            MD054690
0659 O****************    73 22          92 'SYN.L'                S01117 S01339
0660 O****************    73N22LTYP      89                        S01117 S01339
0661 O****************    73N22          90 '-'                    S01117 S01339
0662 O****************    73N22SUTP      92                        S01117 S01339
0660 O********************73   LTYP      89                               S01339
0661 O********************73             90 '-'                           S01339
0662 O********************73   SUTP      92                               S01339
     O***********         73   LTYP      89                         060091S01473
     O***********         73             90 '-'                     060091S01473
     O***********         73   SUTP      92                         060091S01473
0660 O**********      N04 73   LTYP      89                                            S01473 190571
0661 O**********      N04 73             90 '-'                                        S01473 190571
0662 O**********      N04 73   SUTP      92                                            S01473 190571
     O****************N04 73N23LTYP      89                                          190571 MD054690
     O**********      N04 73N23          90 '-'                                        190571 244459
     O**********      N04 73N23SUTP      92                                            190571 244459
     O**********      N04 73N23CLAS      96                                            CLE042 244459
     O****************N04 73N23SUTP      91                                          244459 MD054690
     O****************N04 73N23CLAS      95                                          244459 MD054690
     O****************N04 73 23          92 'MFU  '                                  190571 MD054690
     O**************** 04 73   LTPSTP    91                               S01473            MD054690
0663 O********************73   DDCY      96                                            S01117 CLE042
     O**********       66 73   AMNT     114 ' ,   ,   ,   , 0 -'                     S01117 MD054690
     O**********       67 73   AMNT     114 '   ,   ,   , 0 . -'                     S01117 MD054690
     O**********       68 73   AMNT     114 '  ,   ,   , 0 .  -'                     S01117 MD054690
     O**********       69 73   AMNT     114 ' ,   ,   , 0 .   -'                     S01117 MD054690
     O**********          73   DDCY      99                                            CLE042 245110
     O**********          73   DDCY      96                                            245110 246590
     O                N04 73N23DDRF      84                                                 MD054690
     O                N04 73 23SQNO      81                                                 MD054690
     O                 04 73   LCNO      84                                                 MD054690
     O                N04 73N23LTYP      87                                                 MD054690
     O                N04 73N23SUTP      89                                                 MD054690
     O                N04 73N23CLAS      93                                                 MD054690
     O                N04 73 23          90 'MFU  '                                         MD054690
     O                 04 73   LTPSTP    89                                                 MD054690
     O                 66 73   AMNT     116 ' ,   ,   ,   , 0 -'                            MD054690
     O                 67 73   AMNT     116 '   ,   ,   , 0 . -'                            MD054690
     O                 68 73   AMNT     116 '  ,   ,   , 0 .  -'                            MD054690
     O                 69 73   AMNT     116 ' ,   ,   , 0 .   -'                            MD054690
     O                    73   DDCY      97                                                 MD054690
     O********************73   DDCY      99                                          246590 MD054690
     O                    73   CRSK     118                                                 MD054690
     O                    73   CLOC     120                                                 MD054690
0668 O**********          73   CRSK     117                                          S01117 MD054690
0669 O**********          73   CLOC     120                                          S01117 MD054690
0670 O                    73 21MATDAT   128                               S01117
     O                    73   BRCA     132                               S01117
     O        DF20     01NU7N50                                                               CLE040
     O       AND       37 39N44                                                               244459
     O*******AND       37 39                                                           CLE040 244459
     O       ORF20     01NU7N50                                                               CLE040
     O       AND       37 43N44                                                               244459
     O*******AND       37 43                                                           CLE040 244459
     O       ORF20     02NU7 48                                                               CLE040
     O       AND       37 39N44                                                               244459
     O*******AND       37 39                                                           CLE040 244459
     O       ORF20     02NU7 48                                                               CLE040
     O       AND       37 43N44                                                               244459
     O*******AND       37 43                                                           CLE040 244459
     O                N46 39             30 'CURRENT OFFSET: '                                CLE040
     O                 60N46 39FCXCOF    50 ' ,   ,   ,   , 0 -'                              CLE040
     O                 61N46 39FCXCOF    50 '   ,   ,   , 0 . -'                              CLE040
     O                 62N46 39FCXCOF    50 '  ,   ,   , 0 .  -'                              CLE040
     O                 63N46 39FCXCOF    50 ' ,   ,   , 0 .   -'                              CLE040
     O                N46 43             66 'ADVANCE LTV: '                                   CLE040
     O                N46 43   FCXALV    70                                                   CLE040
     O                N46 43             96 'CURRENT LENDING VALUE: '                         CLE040
     O                 60N46 43FCXCV1   120 '   ,   ,   ,   , 0 -'                            CLE040
     O                 61N46 43FCXCV1   120 '  ,   ,   ,   , 0 . -'                           CLE040
     O                 62N46 43FCXCV1   120 ' ,   ,   ,   , 0 .  -'                           CLE040
     O                 63N46 43FCXCV1   120 '   ,   ,   , 0 .   -'                            CLE040
     O/COPY WNCPYSRC,LE0720O002
     O        T   03   42 LR 37                                           S01117
     O                                   24 'REFERENCE  LE0720P1'         S01117
     O                         TITL      89                               S01117
     O                                  104 'DATE'                        S01117
     O                         RUNA     113                               S01117
     O                                  122 'PAGE'                        S01117
     O                         PAGE  3  128                               S01117
     O        T   05   42 LR 37                                           S01117
     O                                   48 'COMMITMENT AND FACILITY'     S01117
     O                                   71 'AVAILABILITY REPORT BY'      S01117
     O                                   80 'CUSTOMER'                    S01117
     O                       73          93 'BRANCH'                      S01117
     O                       73FCLB      97                               S01117
     O                       73          98 '-'                           S01117
     O                 73N74 42          98 ' '                           S01117
     O                       73BRNM     128                               S01117
     O        T   06   42 LR 37                                           S01117
     O                                   48 '-----------------------'     S01117
     O                                   71 '-----------------------'     S01117
     O                                   80 '---------'                   S01117
0671 O*    RUN CONTROLS
0672 O        T   17   LRNU7 42
     O       AND       37                                                 S01117
     O                                   77 '* NO DETAILS TO REPORT *'    S01117
0673 O***********                        76 'NO DETAILS TO REPORT'        S01117
0674 O********T*32     LR U7                                              S01117
     O        T 32     LR U7 37                                           S01117
0675 O                                   51 '*** REFERENCE LE0720'
0676 O                                   71 '- DATABASE ERROR   '         S01117
0676 O***********                        71 '- DATABASE ERROR AT'         S01117
0677 O***********              DBASE     74                               S01117
0678 O********T**      LR U7                                              S01117
0679 O***********                        37 'FILENAME'                    S01117
0680 O***********              DBFILE    43                               S01117
0681 O***********                        48 'KEY'                         S01117
0682 O***********              DBKEY     78                               S01117
     O        T 3      LR 37N73                                           S01117
     O                                   76 '*** END OF REPORT ***'       S01117
     O        T 3      L2 37 73                                           S01117
     O                                   66 '*** END OF REPORT FOR'       S01117
     O                                   74 ' BRANCH '                    S01117
     O                         FCLB      77                               S01117
     O                                   81 '***'                         S01117
0683 O********T** 03   LR                                                 S01117
0684 O***********                        22 'REFERENCE  LE0720'           S01117
0683 OLE0720AUT   03   LR                                                 S01117
0684 O                                   24 'REFERENCE  LE0720AU'         S01117
0685 O                         TITL      89
0686 O                                  104 'DATE'
0687 O                         RUNA     112
0688 O                                  122 'PAGE'
0689 O***********              PAGE  3  127                               S01117
0689 O                         PAGE1 3  127                               S01117
0690 O        T   05   LR
0691 O                                   50 'COMMITMENT AND FACILITY'
0692 O                                   73 'AVAILABILITY REPORT BY'
0693 O                                   98 'CUSTOMER - FILE CONTROLS'
0694 O        T   06   LR
0695 O                                   50 '-----------------------'
0696 O                                   74 '------------------------'
0697 O                                   98 '------------------------'
0698 O        T   09   LR
0699 O                                   28 'S/SFCX2 - RUN CONTROLS'
0700 O                                   59 'NUMBER'
0701 O                                   84 'VALUE'
0702 O**********                        106 'LOAN TYPE RECORDS'                               190571
     O                                  106 'LOAN/MFU TYPE RECORDS'                           190571
0703 O        T   10   LR
0704 O                                   28 '----------------------'
0705 O                                   59 'OF RECORDS'
0706 O                                   84 'OF RECORDS'
0707 O**********                        106 '-----------------'                               190571
     O                                  106 '---------------------'                           190571
0708 O        T   12   LR
0709 O                                   29 'TOTAL RECORDS ON FILE'
0710 O                      NU7NOLR  3   59
0711 O                      NU7HLDW  4   81
0712 O                      NU7HLDC      84
0713 O        T   14   LR
0714 O                                   29 'TOTAL RECORDS ON FILE'
0715 O                                   42 '- CALCULATED'
0716 O                         COUNT23   59
0717 O                         HSHWN24   81
0718 O                         HSHDC2    84
0719 O                       64         111 '*** DIFFERENCE ***'
0720 O        T   17   LR
0721 O                                   28 'S/SFCX2 - RUN CONTROLS'
0722 O                                   59 'NUMBER'
0723 O                                   84 'VALUE'
0724 O                                  110 'FAC/CMMT TYPE RECORDS'
0725 O        T   18   LR
0726 O                                   28 '----------------------'
0727 O                                   59 'OF RECORDS'
0728 O                                   84 'OF RECORDS'
0729 O                                  110 '---------------------'
0730 O        T   20   LR
0731 O                                   29 'TOTAL RECORDS ON FILE'
0732 O                      NU7NOFR  3   59
0733 O                      NU7HFDW  4   81
0734 O                      NU7HFDC      84
0735 O        T   22   LR
0736 O                                   29 'TOTAL RECORDS ON FILE'
0737 O                                   42 '- CALCULATED'
0738 O                         COUNT13   59
0739 O                         HSHWN14   81
0740 O                         HSHDC1    84
0741 O                       65         111 '*** DIFFERENCE ***'
     O        T 32     LRNU7 42                                           S01117
     O                                   77 '* NO DETAILS TO REPORT *'    S01117
     O        T 32     LR U7                                              S01117
     O                                   51 '*** REFERENCE LE0720'        S01117
     O                                   71 '- DATABASE ERROR AT'         S01117
     O                         DBASE     75                               S01117
     O        T        LR U7                                              S01117
     O                                   37 'FILENAME'                    S01117
     O                         DBFILE    46                               S01117
     O                                   51 'KEY'                         S01117
     O                         DBKEY     81                               S01117
0742 O********T** 25   LR                                                 S01117
0743 O***********                        76 '*** END OF REPORT ***'       S01117
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
** CPY@   **      OBJECT COPYRIGHT
(c) Finastra International Limited 2001
