     H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas Leo LE Facility Availability Update')
      *****************************************************************
      *                                                               *
      *  Midas - LEO/Midas Lending Integration                        *
      *                                                               *
      *  LE0721 - LEO LE Facility Availability Update                 *
      *                                                               *
      *  Function: This program allows the file FACEXLC to be         *
      *  (COB)     updated with parameters passed to it.              *
      *                                                               *
      *  Called By: RPG/CMIU45                                        *
      *                                                               *
      *  Calls: None                                                  *
      *                                                               *
      *  (c) Finastra International Limited 2001                      *
      *                                                               *
      *****************************************************************
      *                                                               *
      *  Last Amend No. CLE124             Date 02Nov21               * *
      *  Prev Amend No. MD046248           Date 27Oct17               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CSD027             Date 09Dec05               *
      *                 CLE042             Date 06Sep05               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 S01473             Date 23AUG94               *
      *                 999999             Date  99XXX99              *
      *                                                               *
      *****************************************************************
      *                                                               *
      *  CLE124 - Commitment and Outstanding Report by Customer Name  *
      *  MD046248 - Finastra Rebranding                               *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *     CLE042 - Extended Loan Sub Type                           *
      *     S01473 - New program created for Midas/Leo Integration    *
      *                                                               *
      *****************************************************************
     F/EJECT
     FFACEXLC O   E                    DISK
      *
     F/EJECT
     F*****************************************************************
     F*                                                               *
     F*  F U N C T I O N   O F   I N D I C A T O R S                  *
     F*                                                               *
     F*    01  - Currency array set up                                *
     F*                                                               *
     F*****************************************************************
      /EJECT
     F*****************************************************************
     F*                                                               *
     F*  S U B R O U T I N E   I N D E X                              *
     F*                                                               *
     F*  INIT   - Program Initialisation                              *
     F*  UPDATE - Update File                                         *
     F*                                                               *
     F*****************************************************************
     E/EJECT
     E                    CPY@    1   1 80               COPYRIGHT
      *
     I/EJECT
     I*DETL********DS*****************************80                                          CLE042
     IDETL        DS                             84                                           CLE042
      ** DS for parameters DETL passed to program
     I                                        1   1 @RECI
     I                                        2   4 @BRCA
     I                                        5  10 @ZZ006
     I**********                             11  160@FCUS                                     CSD027
     I                                       11  16 @FCUS                                     CSD027
     I                                       17  220@CFNO
     I                                       23  23 @RCDT
     I                                       24  26 @CCY
     I                                    P  27  330@AMNT
     I                                       34  35 @CRSK
     I                                       36  37 @CLOC
     I                                    P  38  400@MDAT
     I                                       41  43 @FCLB
     I                                       44  59 @ZZ016
     I                                       60  62 @CMPYM
     I                                       63  640@PTYP
     I                                       65  66 @LTYP
     I                                       67  68 @SUTP
     I                                       69  80 @LCREF
     I                                       81  84 @CLAS                                     CLE042
     I*
     ILDA       E DSLDA
      ** Database error Data Structure
      *
     C/TITLE Main Processing
      *================================================================
      *  P R O G R A M   S T A R T                                    *
      *================================================================
      *
      ***  Perform Initialisation.
      *
     C                     EXSR INIT
      *
      ***  Perform Update File  Processing.
      *
     C                     EXSR UPDATE
      *
      ***  End Program.
      *
     C                     SETON                     LR
     C                     RETRN
      *
      *****************************************************************
      /TITLE SR/INIT
      *****************************************************************
      *                                                               *
      *  INIT   - SUBROUTINE TO DO PROGRAM INITIALISATION.            *
      *                                                               *
      *  Called By: MAIN PROCESSING                                   *
      *                                                               *
      *  Calls:     NONE                                              *
      *                                                               *
      *****************************************************************
      *
     C           INIT      BEGSR
      *
     C           *ENTRY    PLIST
     C                     PARM           RTCD    7        RETURN CODE
     C                     PARM           DETL             UPDAT DETAIL
     C*
     C** Set up copyright statement
     C*
     C                     MOVEACPY@      BIS@   80
     C*
     C** Define LDA
     C*
     C           *NAMVAR   DEFN           LDA
     C*
     C** Initialise update fields
     C*
     C                     MOVE *BLANKS   RECI
     C                     MOVE *BLANKS   BRCA
     C                     MOVE *BLANKS   ZZ006
     C**********           Z-ADD0         FCUS                                                CSD027
     C                     MOVE *BLANKS   FCUS                                                CSD027
     C                     Z-ADD0         CFNO
     C                     MOVE *BLANKS   RCDT
     C                     MOVE *BLANKS   CCY
     C                     Z-ADD0         AMNT
     C                     MOVE *BLANKS   CRSK
     C                     MOVE *BLANKS   CLOC
     C                     Z-ADD0         MDAT
     C                     MOVE *BLANKS   FCLB
     C                     MOVE *BLANKS   ZZ016
     C                     MOVE *BLANKS   CMPYM
     C                     Z-ADD0         PTYP
     C                     MOVE *BLANKS   LTYP
     C                     MOVE *BLANKS   SUTP
     C                     MOVE *BLANKS   CLAS                                                CLE042
     C                     MOVE *BLANKS   LCREF
     C*
     C                     ENDSR
     C*
      *****************************************************************
      /TITLE SR/UPDATE
      *****************************************************************
      *                                                               *
      *  UPDATE - SUBROUTINE TO UPDATE FILE FACEXLC                   *
      *                                                               *
      *  Called By: MAIN PROCESSING                                   *
      *                                                               *
      *  Calls:     NONE                                              *
      *                                                               *
      *****************************************************************
      *
     C           UPDATE    BEGSR
      *
      ** Move input L/C parameters to output fields
      *
     C                     MOVE @RECI     RECI
     C                     MOVE @BRCA     BRCA
     C                     MOVE @ZZ006    ZZ006
     C**********           Z-ADD@FCUS     FCUS                                                CSD027
     C                     MOVE @FCUS     FCUS                                                CSD027
     C                     Z-ADD@CFNO     CFNO
     C                     MOVE @RCDT     RCDT
     C                     MOVE @CCY      CCY
     C                     Z-ADD@AMNT     AMNT
     C                     MOVE @CRSK     CRSK
     C                     MOVE @CLOC     CLOC
     C                     Z-ADD@MDAT     MDAT
     C                     MOVE @FCLB     FCLB
     C                     MOVE @ZZ016    ZZ016
     C                     MOVE @CMPYM    CMPYM
     C                     Z-ADD@PTYP     PTYP
     C                     MOVE @LTYP     LTYP
     C                     MOVE @SUTP     SUTP
     C                     MOVE @CLAS     CLAS                                                CLE042
     C                     MOVE @LCREF    LCREF
     C*
     C** Update file FACEXLC
     C*
     C                     WRITEFACEXLCF               01
     C*
     C** If error setup return code
     C*
     C           *IN01     IFEQ '1'
     C                     MOVE '*ERROR'  RTCD
     C                     END
     C*
     C                     ENDSR
     C*
      *****************************************************************
      /EJECT
** CPY@
(c) Finastra International Limited 2001
