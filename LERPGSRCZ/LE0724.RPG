000100220217     H        1
000101220217      *****************************************************************
000102220217/*STD *  RPGBASE                                                      *
000103220217/*EXI *  TEXT('Midas LE Commitment and Outstanding -Cust Name Rpt')   *
000104220217      *****************************************************************
000105220217      *                                                               *
000106220217      *  Midas - Customer Lending Module                              *
000107220217      *                                                               *
000108220217      *  LE0724 - COMMITMENT/FACILITY AVAILABILITY REPORT BY CUSTOMER *
000109220217      *           Note: Any changes to LE0720 should be considered for*
000110220217      *                 this program.                                 *
000111220217      *                                                               *
000112220217      *  (c) Finastra International Limited 2021                      *
000113220217      *                                                               *
000114220217      *  Last Amend No. MD024504           Date 16Feb22               *
000115220217      *  Prev Amend No. 254270             Date 02Nov21               *
000116220217      *                 251579             Date 02Nov21               *
000117220217      *                 CLE124  *Create    Date 02Nov21               *
000118220217      *                                                               *
000119220217      *****************************************************************
000120220217      *  MD024504 - LE0723P1 produced without headings                *
000121220217      *             Applied for MD059597                              *
000122220217      *  254270 - Wrong customer shows on LE0724P1.                   *
000123220217      *  251579 - Field overlap between PCRF and LPFI causes the last *
000124220217      *           digit of the PCRF to show in the LPFI field.        *
000125220217      *  CLE124 - Commitment and Outstanding Report by Customer Name  *
000126220217      *                                                               *
000127220217      *****************************************************************
000128220217      *                                                               *
000129220217      *  C R E A T I O N     P A R A M E T E R S                      *
000130220217      *                                                               *
000131220217      *                                                               *
000132220217      *****************************************************************
000133220217     FLEFAXL0 IP  F     205 23AI     2 DISK
000134220217     FSDCURRPDIF  E                    DISK
000135220217     FLEFCLTLGIF  E           K        DISK
000136220217      ** Facilities Extension File
000137220217     FLE0724P1O   F     132     OF     PRINTER      KINFDS SPOOL      UC
000138220217     FLE0724AUO   F     132            PRINTER      KINFDS SPOOLU
000139220217     F/COPY WNCPYSRC,LE0724F001
000140220217     F* ID F  C  H  L    FUNCTION OF INDICATORS
000141220217     F* 01            FACILITY/COMMITMENT EXTRACT - FAC/CMMT TYPE RECORD
000142220217     F* 02                                        - LOAN TYPE RECORD
000143220217     F* 02 & 04                                   - LEO  TYPE RECORD
000144220217     F* 03                                        - TRAILER RECORD
000145220217     F*    21         POSITIVE MAT. DATE ON FILE
000146220217     F*    23         Blank field denotes MFU type record
000147220217     F*       40      CONDITIONS FIRST CYCLE PROCESSING
000148220217     F*       41      GENERAL PURPOSE
000149220217     F*       42      EMPTY PRIMARY FILE
000150220217     F*       44      Do not print participant facilities(I,P,R)
000151220217     F*       45      FACILITY RECORD
000152220217     F*       46      FACILITY HAS EXPIRED
000153220217     F*       47      DETERMINES FIRST DRAWDOWN/LOAN PER FAC./COMMT.
000154220217     F*       48          ''      ''      ''     ''  ''  ''    ''
000155220217     F*       50      NEXT RECORD IS A LOAN RECORD
000156220217     F*       51      WORK INDICATOR
000157220217     F*       52      OUTPUT CUSTOMER NAME
000158220217     F*       53      Save Overflow indicator
000159220217     F*       60      FACILITY CCY DEC PLACES - 0
000160220217     F*       60      CURRENCY DECIMAL PLACES - 0
000161220217     F*       61                              - 1
000162220217     F*       62                              - 2
000163220217     F*       63                              - 3
000164220217     F*       64      FILE OUT OF BALANCE - LOAN TYPE RECORD
000165220217     F*       65                          - FAC/CMMT TYPE RECORD
000166220217     F*       66      DRAWDOWN CCY DEC PLACES - 0
000167220217     F*       67                              - 1
000168220217     F*       68                              - 2
000169220217     F*       69                              - 3
000170220217     F*       70      CLE004 is switched *ON
000171220217     F*       37      ALLOW OUTPUT
000172220217     F*       73      MULTIBRANCHING INDICATOR
000173220217     F*       74      REQUESTS SINGLE BRANCH
000174220217     F*       75      ALLOW CONTROL TOTAL CHECKING
000175220217     F*       85      REPORT FILE OPENED IN FIRST PROCESSING CYCLE
000176220217     F*       U7      SYSTEM ERROR
000177220217     F*       U8      DATABASE ERROR, REQUIRED RECORDS NOT FOUND
000178220217     F*       L1      CUSTOMER CHANGE
000179220217     F*       L2      BRANCH CHANGE
000180220217     E                    XCYA      150  3               CURRENCIES
000181220217     E                    XDPA      150  1 0             DEC. PLACES
000182220217     E/COPY ZSRSRC,ZDATE2Z1
000183220217     E                    CPY@    1   1 80
000184220217      *
000185220217      ** EXTRACT CMMT/FCLTY DETAILS - FACILITIES
000186220217      *
000187220217     ILEFAXL0 NS  01   1 CD  23 CF
000188220217     I                                        1   1 RECI
000189220217     I                                        2   4 BRCA
000190220217     I                                        5  10 PNUM
000191220217     I                                       11  16 CNUM
000192220217     I                                       17  220CFNO
000193220217      *
000194220217      **   FOLLOWING RECORDS DEFINED FOR PURPOSE OF THIS PROGRAM
000195220217      *
000196220217     I                                       17  190CFN1
000197220217     I                                       20  210CFN2
000198220217      *
000199220217     I                                       23  23 RCDT
000200220217     I                                       24  26 CMCY
000201220217     I                                       27  27 EXPI
000202220217     I                                    P  28  340OAMT
000203220217     I                                    P  35  410CAMT
000204220217     I                                    P  42  480CAVL
000205220217     I                                       49  49 FACI
000206220217     I                                       50  50 FATP
000207220217     I                                    P  51  570CFTA
000208220217     I                                       58  77 CNAM  L1
000209220217     I                                       78  80 CMPYM
000210220217     I                                       81  83 FCLB  L2
000211220217     I/COPY WNCPYSRC,LE0724I003
000212220217      *
000213220217      ** Participant Facility Indicator
000214220217      *
000215220217     I                                      100 100 PRTR
000216220217      *
000217220217      **   EXTRACT CMMT/FCLTY DETAILS - LOANS
000218220217      **   and Manual Facility Utilisations
000219220217      *
000220220217     I        NS  02   1 CD  23 CL
000221220217     I       OR        1 CD  23 CM
000222220217     I                                        1   1 RECI
000223220217     I                                        2   4 BRCA
000224220217     I                                        5  10 PNUM
000225220217     I                                       11  16 CNUM
000226220217     I                                       17  220CFNO
000227220217     I                                       23  23 RCDT
000228220217     I                                       24  26 DDCY
000229220217     I                                    P  27  330AMNT
000230220217     I                                       34  35 CRSK
000231220217     I                                       36  37 CLOC
000232220217     I                                    P  38  400MDAT        21
000233220217     I                                       41  43 FCLB
000234220217     I                                       63  640PTYP
000235220217     I                                       65  66 LTYP
000236220217     I                                       67  68 SUTP
000237220217      *
000238220217      ** Following Field Defined for purpose of this program
000239220217      *
000240220217     I                                       65  68 LTPSTP
000241220217      *
000242220217     I                                       69  74 ORGL
000243220217     I                                       75  80 DDRF
000244220217     C**********                             84  99 PCRF                                      251579
000245220217     C**********                             99 100 LPFI                                      251579
000246220217     I                                       85  99 PCRF                                      251579
000247220217     I                                      100 100 LPFI                                      251579
000248220217     I                                      101 102 LNACOC
000249220217     I                                      103 132 LNACON
000250220217     I                                      133 135 ANDPCD
000251220217     I                                      136 165 ANDPNM
000252220217     I                                      166 185 ANCRNM
000253220217     I                                      186 205 CNAM
000254220217      *
000255220217      ** Fields redefined for MFU type records
000256220217      *
000257220217     I                                       75  77 SQNO
000258220217     I                                       78  80 MFU             23
000259220217     I                                       81  84 CLAS
000260220217      *
000261220217      **   Extract Cmmt/Fclty Details - Leo Detail
000262220217      *
000263220217     I        NS  02   1 CL  23 CL
000264220217     I                                        1   1 RECI
000265220217     I                                        2   4 BRCA
000266220217     I                                       11  16 CNUM
000267220217     I                                       17  220CFNO
000268220217     I                                       23  23 RCDT
000269220217     I                                       24  26 DDCY
000270220217     I                                    P  27  330AMNT
000271220217     I                                       34  35 CRSK
000272220217     I                                       36  37 CLOC
000273220217     I                                    P  38  400MDAT        21
000274220217     I                                       41  43 FCLB
000275220217     I                                       63  640PTYP
000276220217     I                                       65  66 LTYP
000277220217     I                                       67  68 SUTP
000278220217      *    Following Field Defined for purpose of this program
000279220217     I                                       65  68 LTPSTP          22
000280220217      *
000281220217     I                                       69  80 LCREF
000282220217     I                                       69  74 LCNO
000283220217     I                                       81  84 CLAS
000284220217      *
000285220217      ** EXTRACT CMMT/FCLTY DETAILS - TRAILER
000286220217      *
000287220217     I        NS  03   1 CT
000288220217     I                                        1   1 RECI
000289220217     I                                    P   2   40NOLR
000290220217     I                                    P   5  120HLDW
000291220217     I                                    P  13  140HLDC
000292220217     I                                    P  15  170NOFR
000293220217     I                                    P  18  250HFDW
000294220217     I                                    P  26  270HFDC
000295220217      *
000296220217      ** LOOK AHEAD FIELD
000297220217      *
000298220217     I        NS  **
000299220217     I                                       23  23 NRECT
000300220217      *
000301220217      ** CATCH ALL
000302220217      *
000303220217     I        NS
000304220217     I/COPY WNCPYSRC,LE0724I001
000305220217      *
000306220217     ISDBANK    E DSSDBANKPD
000307220217      ** EXTERNAL DS FOR BANK DETAILS
000308220217     I              BJURPT                          TITL
000309220217      *
000310220217     I/COPY WNCPYSRC,LE0724I002
000311220217      *
000312220217     ISDBRCH    E DSSDBRCHPD
000313220217      ** EXTERNAL DS FOR BRANCHES DETAILS
000314220217      *
000315220217     I              A8BRNM                          BRNM
000316220217      *
000317220217     IDSFDY     E DSDSFDY
000318220217      ** FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE
000319220217      *
000320220217     IDSSDY     E DSDSSDY
000321220217      ** SECOND DS FOR ACCESS PROGRAMS, LONG DATA STRUCTURE
000322220217      *
000323220217     ISCSARD    E DSSCSARDPD
000324220217      ** Switchable Features File
000325220217      *
000326220217      ** LDA - DIAGNOSTICS FOR PROGRAM ABORT
000327220217      *
000328220217     ILDA        UDS                            256
000329220217     I                                      134 141 DBFILE
000330220217     I                                      142 170 DBKEY
000331220217     I                                      171 180 DBPGM
000332220217     I                                      181 1830DBASE
000333220217      *
000334220217      ** FILE INFORMATION DATA STRUCTURE
000335220217      *
000336220217     ISPOOL       DS
000337220217     I                                       83  92 SFILE
000338220217     I                                    B 123 1240SFNUM
000339220217     ISPOOLU      DS
000340220217     I                                       83  92 SFILEU
000341220217     I                                    B 123 1240SFNUMU
000342220217     I            DS
000343220217     I                                        1  14 WKFCLT
000344220217     I                                        1   3 BRCA
000345220217     I                                        4   9 KCNUM
000346220217     I                                       10  12 KFTYP
000347220217     I                                       13  14 KFCNO
000348220217      *
000349220217      ** DATA AREA RUNDAT
000350220217      *
000351220217     IRUNDT       DS
000352220217     I                                        1   7 RUNA
000353220217     I                                    P   8  100RUND
000354220217     I                                       11  11 SSF
000355220217     I                                       12  12 DATF
000356220217     I                                       13  13 MBIN
000357220217      *
000358220217     C                     MOVEACPY@      BIS@   80
000359220217     C********************************************************************
000360220217     C           *ENTRY    PLIST
000361220217     C                     PARM           SEQ     5         SEQUENCE NO
000362220217     C                     PARM           BRNCH   3
000363220217     C********************************************************************
000364220217     C           *NAMVAR   DEFN           LDA
000365220217     C           *LOCK     IN   LDA
000366220217      *
000367220217      ** FIRST CYCLE PROCESSING
000368220217      *
000369220217     C   40                GOTO DETAIL
000370220217     C                     SETON                     42
000371220217     C                     MOVE 'LE0724'  DBPGM
000372220217      *
000373220217      ** IN THE DATAAREA RUNDAT
000374220217      *
000375220217     C           *NAMVAR   DEFN RUNDAT    RUNDT
000376220217     C                     IN   RUNDT
000377220217      *
000378220217      ** SETUP MULTIBRANCHING INDICATOR
000379220217      *
000380220217     C           MBIN      IFEQ 'Y'
000381220217     C                     SETON                     73
000382220217     C                     END
000383220217     C           BRNCH     IFNE 'ALL'
000384220217     C                     SETON                     74
000385220217     C                     END
000386220217     C           MBIN      IFEQ 'Y'
000387220217     C           BRNCH     ANDEQ'ALL'
000388220217     C           MBIN      ORNE 'Y'
000389220217     C                     SETON                     75
000390220217     C                     END
000391220217      *
000392220217     C                     EXSR ZSYSTM
000393220217     C   99                GOTO END
000394220217      *
000395220217      ** OPEN SPOOL FILE WHEN NON-MULTIBRANCHING
000396220217      *
000397220217     C           MBIN      IFNE 'Y'
000398220217     C                     SETON                     3785  ALLOW OUTPUT
000399220217     C                     OPEN LE0724P1
000400220217     C                     Z-ADD0         PAGE
000401220217      *
000402220217      ** ENSURE REPORT SPOOL FILE RECORDED BY RCF
000403220217      *
000404220217     C                     Z-ADDSFNUM     ZSNUM   60
000405220217     C                     OUT  LDA
000406220217     C                     CALL 'ZSFILE'
000407220217     C                     PARM           SEQ
000408220217     C                     PARM *BLANKS   SENTY   3
000409220217     C                     PARM           SFILE
000410220217     C                     PARM           ZSNUM
000411220217     C                     PARM           ZSERR   1
000412220217     C           *LOCK     IN   LDA
000413220217      *
000414220217     C           ZSERR     IFEQ 'Y'
000415220217      *
000416220217      ** ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM
000417220217      *
000418220217     C                     SETON                     U7U8LR
000419220217     C                     RETRN
000420220217     C                     END
000421220217     C                     END
000422220217      *
000423220217      **   LOAD CURRENCY ARRAYS
000424220217      *
000425220217     C                     EXSR CCYARR
000426220217      *
000427220217      ** Check if CLE004 is switched *ON
000428220217      *
000429220217     C                     MOVE 'N'       CLE004  1
000430220217     C                     CALL 'AOSARDR0'
000431220217     C                     PARM *BLANKS   @RTCD
000432220217     C                     PARM '*VERIFY' @OPTN
000433220217     C                     PARM 'CLE004'  @SARD   6
000434220217     C           SCSARD    PARM SCSARD    DSFDY
000435220217      *
000436220217     C           @RTCD     IFEQ *BLANKS
000437220217     C                     MOVE 'Y'       CLE004
000438220217     C                     END
000439220217      *
000440220217     C           @RTCD     IFNE *BLANKS
000441220217     C           @RTCD     ANDNE'*NRF   '
000442220217      *
000443220217      ** Call to program ended in error
000444220217      *
000445220217     C                     SETON                     U7U8
000446220217     C                     MOVEL'CLE004'  DBKEY            ***************
000447220217     C                     MOVE 'SCSARDPD'DBFILE           * DB ERROR 10 *
000448220217     C                     Z-ADD10        DBASE            ***************
000449220217     C                     GOTO END
000450220217     C                     ENDIF
000451220217      *
000452220217      ** Set on indicator if CLE004 is switched *ON
000453220217      *
000454220217     C           CLE004    IFEQ 'Y'
000455220217     C                     MOVE *ON       *IN70
000456220217     C                     END
000457220217      *
000458220217      ** Check if Collateralised Lending is available
000459220217      *
000460220217     C                     MOVE 'N'       CLE024  1
000461220217     C                     MOVE *OFF      *IN43
000462220217     C                     CALL 'AOSARDR0'
000463220217     C                     PARM *BLANKS   @RTCD
000464220217     C                     PARM '*VERIFY' @OPTN
000465220217     C                     PARM 'CLE024'  @SARD
000466220217     C           SCSARD    PARM SCSARD    DSFDY
000467220217      *
000468220217     C           @RTCD     IFEQ *BLANKS
000469220217     C                     MOVE *ON       *IN43
000470220217     C                     MOVE 'Y'       CLE024
000471220217     C                     ENDIF
000472220217      *
000473220217     C           @RTCD     IFNE *BLANKS
000474220217     C           @RTCD     ANDNE'*NRF   '
000475220217      *
000476220217      ** Call to program ended in error
000477220217      *
000478220217     C                     MOVE *ON       *INU7
000479220217     C                     MOVE *ON       *INU8
000480220217     C                     MOVEL'CLE024'  DBKEY
000481220217     C                     MOVE 'SCSARDPD'DBFILE
000482220217     C                     Z-ADD11        DBASE
000483220217     C                     GOTO END
000484220217     C                     ENDIF
000485220217      *
000486220217      ** Check if Credit Lines is available
000487220217      *
000488220217     C                     MOVE 'N'       CLE025  1
000489220217     C                     MOVE *OFF      *IN39
000490220217     C                     CALL 'AOSARDR0'
000491220217     C                     PARM *BLANKS   @RTCD
000492220217     C                     PARM '*VERIFY' @OPTN
000493220217     C                     PARM 'CLE025'  @SARD
000494220217     C           SCSARD    PARM SCSARD    DSFDY
000495220217      *
000496220217     C           @RTCD     IFEQ *BLANKS
000497220217     C                     MOVE *ON       *IN39
000498220217     C                     MOVE 'Y'       CLE025
000499220217     C                     ENDIF
000500220217      *
000501220217     C           @RTCD     IFNE *BLANKS
000502220217     C           @RTCD     ANDNE'*NRF   '
000503220217      *
000504220217      ** Call to program ended in error
000505220217      *
000506220217     C                     MOVE *ON       *INU7
000507220217     C                     MOVE *ON       *INU8
000508220217     C                     MOVEL'CLE025'  DBKEY
000509220217     C                     MOVE 'SCSARDPD'DBFILE
000510220217     C                     Z-ADD12        DBASE
000511220217     C                     GOTO END
000512220217     C                     ENDIF
000513220217      *
000514220217     C                     SETON                     40
000515220217      **********************************
000516220217     C           DETAIL    TAG                             **DETAIL TAG**
000517220217      *
000518220217      ** Do not reset indicators if next record is a Loan/MFU.
000519220217      *
000520220217     C           *IN51     IFEQ '1'
000521220217     C           *IN52     ANDEQ'1'
000522220217     C           *IN50     ANDEQ'0'
000523220217     C                     MOVE '0'       *IN51
000524220217     C                     MOVE '0'       *IN52
000525220217     C                     ENDIF
000526220217     C***51                SETON                     52                                       254270
000527220217     C   L1                SETON                     51
000528220217      *
000529220217      ** Set on *IN51 on page overflow in order to print the customer
000530220217      ** name and number at the top of a new page. (OF is off by the
000531220217      ** time the Loan/MFU type record has been read).
000532220217      *
000533220217     C   OF                SETON                     51
000534220217     C   51                SETON                     52                                       254270
000535220217      *
000536220217      ** Save Overflow indicator so that the Customer name and number
000537220217      ** are not displayed unnecessarily when the first detail record
000538220217      ** sets the overflow upon writing to the last line of the page.
000539220217      *
000540220217     C           *INOF     IFEQ '1'
000541220217     C                     MOVE '1'       *IN53
000542220217     C                     ELSE
000543220217     C                     MOVE '0'       *IN53
000544220217     C                     ENDIF
000545220217      *
000546220217     C   03                SETON                     LR
000547220217     C  N01N02             GOTO END
000548220217      *
000549220217      **      END AFTER THE REQUESTED BRANCH
000550220217      *
000551220217      ** If either Credit Lines or Collateralised Lending is available,
000552220217      ** access Facilities Extension file
000553220217      *
000554220217     C           CLE024    IFEQ 'Y'
000555220217     C           CLE025    OREQ 'Y'
000556220217     C           *IN01     IFEQ '1'
000557220217     C                     MOVE 'N'       WKERRF  1
000558220217     C                     EXSR SRRTVX
000559220217     C           WKERRF    IFEQ 'Y'
000560220217     C                     MOVE *ON       *INU7
000561220217     C                     MOVE *ON       *INU8
000562220217     C                     MOVE *BLANKS   DBKEY
000563220217     C                     MOVELWKFCLT    DBKEY
000564220217     C                     MOVE 'LEFCLTQD'DBFILE
000565220217     C                     Z-ADD13        DBASE
000566220217     C                     GOTO END
000567220217     C                     ENDIF
000568220217     C                     ENDIF
000569220217     C                     ENDIF
000570220217      *
000571220217      ** Do not print participant facilities(I,P,R) as they are
000572220217      ** redundant since participant loans are already shown in
000573220217      ** agent facility
000574220217      *
000575220217     C                     MOVE *OFF      *IN44
000576220217     C           PRTR      IFNE 'A'
000577220217     C           PRTR      ANDNE*BLANK
000578220217     C                     MOVE *ON       *IN44
000579220217     C                     ENDIF
000580220217      *
000581220217     C           MBIN      IFEQ 'Y'
000582220217     C           BRNCH     ANDNE'ALL'
000583220217     C           FCLB      ANDGTBRNCH
000584220217     C                     SETON                     LR
000585220217     C                     SETOF                     37
000586220217     C                     GOTO END
000587220217     C                     END
000588220217      *
000589220217      ** SKIP TO THE REQUESTED BRANCH
000590220217      *
000591220217     C           MBIN      IFEQ 'Y'
000592220217     C           BRNCH     ANDNE'ALL'
000593220217     C           BRNCH     ANDNEFCLB
000594220217     C                     SETOF                     37
000595220217     C                     GOTO END
000596220217     C                     END
000597220217      *
000598220217     C                     SETOF                     42
000599220217      *
000600220217      ** AT CHANGE OF BRANCH CODE EXECUTE PRINT
000601220217      *
000602220217     C           MBIN      IFEQ 'Y'
000603220217     C           *INL2     ANDEQ'1'
000604220217     C                     CLOSELE0724P1
000605220217     C           BRNCH     IFEQ 'ALL'
000606220217     C           BRNCH     OREQ FCLB
000607220217     C                     SETON                     3785  ALLOW OUTPUT
000608220217     C                     OPEN LE0724P1
000609220217     C                     Z-ADD0         PAGE
000610220217      *
000611220217      ** ENSURE REPORT SPOOL FILE RECORDED BY RCF
000612220217      *
000613220217     C                     Z-ADDSFNUM     ZSNUM   60
000614220217     C                     OUT  LDA
000615220217     C                     CALL 'ZSFILE'
000616220217     C                     PARM           SEQ
000617220217     C                     PARM FCLB      SENTY   3
000618220217     C                     PARM           SFILE
000619220217     C                     PARM           ZSNUM
000620220217     C                     PARM           ZSERR   1
000621220217     C           *LOCK     IN   LDA
000622220217      *
000623220217     C           ZSERR     IFEQ 'Y'
000624220217      *
000625220217      ** ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM
000626220217      *
000627220217     C                     SETON                     U7U8LR
000628220217     C                     RETRN
000629220217     C                     END
000630220217      *
000631220217      **  GET BRANCH NAME
000632220217      *
000633220217     C                     CALL 'AOBRCHR1'
000634220217     C                     PARM '*MSG   ' @RTCD   7
000635220217     C                     PARM '*KEY   ' @OPTN   7
000636220217     C                     PARM FCLB      @DSNB   3
000637220217     C           SDBRCH    PARM SDBRCH    DSSDY
000638220217      *
000639220217     C           @RTCD     IFNE *BLANKS
000640220217     C                     SETON                     U7U8LR
000641220217     C                     MOVEL'SDBRCHPD'DBFILE
000642220217     C                     MOVEL@DSNB     DBKEY            **************
000643220217     C                     MOVEL@OPTN     DBOPTN  7        *DATABASE 04 *
000644220217     C                     Z-ADD4         DBASE            **************
000645220217     C                     MOVEL*BLANKS   BRNM
000646220217     C                     EXSR *PSSR
000647220217     C                     GOTO END
000648220217     C                     END
000649220217      *
000650220217     C                     ELSE
000651220217      *
000652220217     C                     SETOF                     37
000653220217     C                     END
000654220217     C                     END
000655220217      *
000656220217      ** COMMITMENT/FACILITY RECORD PROCESSING
000657220217      *
000658220217      ** SET INDICATORS TO DETERMINE FIRST LOAN PER FAC/CMMT.
000659220217      *
000660220217     C   01                SETON                     4748
000661220217      *
000662220217      ** DETERMINE IF FACILITY/COMMITMENT
000663220217      **   SET OFF INDICATORS BEFORE USING
000664220217      *
000665220217     C   01                SETOF                     4546
000666220217     C   01      FACI      COMP 'F'                      45
000667220217     C/COPY WNCPYSRC,LE0724C002
000668220217      *
000669220217      ** IF FACILITY, AND HAS EXPIRED, SET AVAILABLE AMOUNT TO ZERO
000670220217      *
000671220217     C   01 45   EXPI      COMP 'E'                      46
000672220217     C/COPY WNCPYSRC,LE0724C001
000673220217      *
000674220217      ** DETERMINE CURRENCY DEC. PLACES
000675220217      *
000676220217     C   01                MOVE CMCY      XCCY
000677220217     C   01                EXSR CCYDEP
000678220217     C   01 99             SETON                     U7U8  **DATABASE 02**
000679220217     C   01 99             Z-ADD2         DBASE
000680220217     C   01 99             MOVE XCCY      DBKEY
000681220217     C   01 99             MOVE 'SDCURRPD'DBFILE
000682220217     C   01 99             GOTO END
000683220217      *
000684220217     C   01      XDECP     COMP 1                      6061
000685220217     C   01      XDECP     COMP 2                    63  62
000686220217     C/COPY WNCPYSRC,LE0724C003
000687220217      *
000688220217      ** PERFORM RECORD COUNT & HASH TOTALLING
000689220217      *
000690220217     C   01      COUNT1    ADD  1         COUNT1  50
000691220217     C   01                Z-ADDHSHWN1    ZZTOTI
000692220217     C   01                Z-ADDHSHDC1    ZZTOTD
000693220217     C   01                MOVE CAMT      ZZAMT
000694220217     C   01                EXSR GLZADD
000695220217     C   01                Z-ADDZZTOTI    HSHWN1 150
000696220217     C   01                Z-ADDZZTOTD    HSHDC1  30
000697220217      *
000698220217      ** LOAN RECORD PROCESSING
000699220217      *
000700220217      ** SET INDICATORS TO DETERMINE FIRST LOAN PER FAC/CMMT.
000701220217      *
000702220217     C   02N47             SETOF                     48
000703220217     C   02                SETOF                     47
000704220217      *
000705220217      ** Set *IN04 on if it is a Leo Transaction
000706220217      *
000707220217     C   02      RECI      COMP 'L'                      04
000708220217      *
000709220217      ** CHECK IF NEXT RECORD IS LOAN RECORD
000710220217      *
000711220217     C                     SETOF                     50
000712220217     C           NRECT     COMP 'L'                      50
000713220217     C  N50      NRECT     COMP 'M'                      50
000714220217     C   01 51N50          SETON                     52
000715220217      *
000716220217      ** DETERMINE CURRENCY DEC.PLACES
000717220217      *
000718220217     C   02                MOVE DDCY      XCCY
000719220217     C   02                EXSR CCYDEP
000720220217     C   02 99             SETON                     U7U8  **DATABASE 03**
000721220217     C   02 99             Z-ADD3         DBASE
000722220217     C   02 99             MOVE XCCY      DBKEY
000723220217     C   02 99             MOVE 'SDCURRPD'DBFILE
000724220217     C   02 99             GOTO END
000725220217      *
000726220217     C   02      XDECP     COMP 1                      6667
000727220217     C   02      XDECP     COMP 2                    69  68
000728220217      *
000729220217      ** DETERMINE MATURITY DATE
000730220217      *
000731220217     C   02 21             Z-ADDMDAT      ZDAYNO
000732220217     C   02 21             EXSR ZDATE2
000733220217     C   02 21             MOVE ZADATE    MATDAT  7
000734220217      *
000735220217      ** If this is a Leo Transaction, do not do the Hash total
000736220217      ** Processing.
000737220217      *
000738220217     C   02 04             GOTO END
000739220217      *
000740220217      ** PERFORM RECORD COUNT & HASH TOTALLING
000741220217      *
000742220217     C   02      COUNT2    ADD  1         COUNT2  50
000743220217     C   02                Z-ADDHSHWN2    ZZTOTI
000744220217     C   02                Z-ADDHSHDC2    ZZTOTD
000745220217      *
000746220217      ** IF AMOUNT IS NEGATIVE,REVERSE SIGN
000747220217      *
000748220217     C   02      AMNT      DIV  1000      ZZAMT        41
000749220217     C   02 41             Z-SUBZZAMT     ZZAMT
000750220217     C   02                EXSR GLZADD
000751220217     C   02                Z-ADDZZTOTI    HSHWN2 150
000752220217     C   02                Z-ADDZZTOTD    HSHDC2  30
000753220217      *
000754220217     C           END       TAG                             **END TAG**
000755220217     C   U7                SETON                     LR
000756220217      *
000757220217      ** LAST RECORD PROCESSING
000758220217      *
000759220217     CLRNU8 75   COUNT1    COMP NOFR                 U8U8
000760220217     CLRNU8 75   HSHWN1    COMP HFDW                 U8U8
000761220217     CLRNU8 75   HSHDC1    COMP HFDC                 U8U8
000762220217     CLR U8NU7             SETON                     65
000763220217      *
000764220217     CLRNU8 75   COUNT2    COMP NOLR                 U8U8
000765220217     CLRNU8 75   HSHWN2    COMP HLDW                 U8U8
000766220217     CLRNU8 75   HSHDC2    COMP HLDC                 U8U8
000767220217     CLR U8NU7N65          SETON                     64
000768220217      *
000769220217      ** ENSURE TOTALS SPOOL FILE RECORDED BY RCF
000770220217      *
000771220217     CLR                   Z-ADDSFNUMU    ZSNUMU  60
000772220217     CLR                   OUT  LDA
000773220217     CLR                   CALL 'ZSFILE'
000774220217     CLR                   PARM           SEQ
000775220217     CLR                   PARM *BLANKS   SENTY   3
000776220217     CLR                   PARM           SFILEU
000777220217     CLR                   PARM           ZSNUMU
000778220217     CLR                   PARM           ZSERR   1
000779220217     CLR         *LOCK     IN   LDA
000780220217      *
000781220217     CLR         ZSERR     IFEQ 'Y'
000782220217      *
000783220217      ** ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM
000784220217      *
000785220217     CLR                   SETON                     U7U8
000786220217     CLR                   RETRN
000787220217     CLR                   END
000788220217     CLR U7 U8             EXSR *PSSR
000789220217      *
000790220217      ** OPEN REPORT FILE WHEN NO DETAIL TO REPORT
000791220217      *
000792220217     CLRN85                EXSR #ZZ
000793220217      ********************************************************************
000794220217      /SPACE 3
000795220217      ********************************************************************
000796220217      *                                                                  *
000797220217      ** SRRTVX - Subroutine that Retrieves Fields in Facility Extension *
000798220217      **          File                                                   *
000799220217      *                                                                  *
000800220217      ********************************************************************
000801220217     C           SRRTVX    BEGSR
000802220217      *
000803220217     C                     MOVE FCLB      KFCLB   3
000804220217     C                     MOVE CNUM      KCNUM   6
000805220217     C                     MOVE CFN1      KFTYP   3
000806220217     C                     MOVE CFN2      KFCNO   2
000807220217      *
000808220217     C           KLFEXT    KLIST
000809220217     C                     KFLD           KFCLB
000810220217     C                     KFLD           KCNUM
000811220217     C                     KFLD           KFTYP
000812220217     C                     KFLD           KFCNO
000813220217      *
000814220217     C           KLFEXT    CHAINLEFCLTLG             38
000815220217     C           *IN38     IFEQ *ON
000816220217     C                     MOVE 'Y'       WKERRF
000817220217     C                     ENDIF
000818220217      *
000819220217     C                     ENDSR
000820220217      ********************************************************************
000821220217     C/SPACE 3
000822220217      ********************************************************************
000823220217      *
000824220217      ** SR. TO SET UP AN ARRAY OF CURRENCIES AND AN ARRAY OF
000825220217      ** DECIMAL PLACES FOR THOSE CURRENCIES.
000826220217      *
000827220217     C           CCYARR    BEGSR                           *** CCYARR  ***
000828220217      *
000829220217      ** SET OFF ERROR INDICATOR
000830220217      *
000831220217     C                     SETOF                     99
000832220217      *
000833220217      ** SET ARRAY INDEX TO ZERO.
000834220217      *
000835220217     C                     Z-ADD0         X       30
000836220217      *
000837220217      ** SET LOWER LIMIT AND READ SDCURRPD HEADER.
000838220217      *
000839220217      ** LOOP TO READ CURRENCY DETAIL RECORDS.
000840220217      *
000841220217     C           XLOOP     TAG                             ** XLOOP TAG **
000842220217     C                     READ SDCURRPD                 99
000843220217      *
000844220217      ** END IF ALL CURRENCY RECORDS PROCESSED
000845220217      *
000846220217     C   99                GOTO XCAEND
000847220217      *
000848220217      ** INCREMENT ARRAY INDEX.
000849220217      *
000850220217     C           X         ADD  1         X
000851220217      *
000852220217      ** MOVE DATA INTO ARRAYS.
000853220217      *
000854220217     C                     MOVE A6CYCD    XCYA,X
000855220217     C                     MOVE A6NBDP    XDPA,X
000856220217      *
000857220217      ** CHECK FOR FULL ARRAY.96 ON IF FULL.
000858220217      *
000859220217     C           X         COMP 150                      96
000860220217      *
000861220217      ** GO TO READ NEXT RECORD.
000862220217      *
000863220217     C  N96                GOTO XLOOP
000864220217      *
000865220217     C           XCAEND    ENDSR                           ** XCAEND **
000866220217      *
000867220217      ********************************************************************
000868220217      **
000869220217      **   SR. TO OBTAIN NO. OF DECIMAL PLACES FOR A CURRENCY.
000870220217      **
000871220217      ********************************************************************
000872220217      *
000873220217     C           CCYDEP    BEGSR                           *** CCYDEP  ***
000874220217      *
000875220217      ** BLANK CURRENCY CODE IS INVALID
000876220217      *
000877220217     C           XCCY      COMP '   '                    99
000878220217     C   99                GOTO XCDEND
000879220217      *
000880220217      ** SET ARRAY INDEX TO ONE
000881220217      *
000882220217     C                     Z-ADD1         X
000883220217      *
000884220217      ** INITIALIZE INPUT-OUTPUT FIELDS.
000885220217      *
000886220217     C                     Z-ADD0         XDECP   10
000887220217     C                     MOVE XCCY      XCCY    3
000888220217      *
000889220217      ** LOOK UP NO. OF DECIMAL PLACES FOR CURRENCY.
000890220217      ** 99 SETON FOR INVALID CURRENCY.
000891220217      *
000892220217     C           XCCY      LOKUPXCYA,X                   95
000893220217     C   95                MOVE XDPA,X    XDECP
000894220217     C  N95                SETON                     99
000895220217      *
000896220217     C           XCDEND    ENDSR                           ** XCDEND **
000897220217      *
000898220217      ********************************************************************
000899220217      *
000900220217      ** SUBROUTINE TO ADD AN AMOUNT (ZZAMT) TO THE TOTAL (ZZTOTI,ZZTOTD)
000901220217      **   IND '99' IS SET BY AN OVERFLOW ERROR
000902220217      *
000903220217      ********************************************************************
000904220217      *
000905220217     CSR         GLZADD    BEGSR                           *** GLZADD ****
000906220217      *
000907220217     CSR                   Z-ADDZZAMT     ZZAMT  153     91-DEFINE ZZAMT
000908220217     CSR 91                GOTO ZZAEND                     AMT = 0.BYPASS
000909220217      *
000910220217      ** SPLIT ZZAMT INTO INTEGER AND DECIMAL FIELDS
000911220217      *
000912220217     CSR                   Z-ADDZZAMT     ZZAMTI 150       INTEGER FIELD
000913220217     CSR                   MOVE ZZAMT     ZZAMTD  30       DECIMAL FIELD
000914220217      *
000915220217      ** BOTH ZZAMTI AND ZZAMTD CONTAIN A 'SIGN' ZONE NOW
000916220217      *
000917220217     CSR                   EXSR GLZSUM
000918220217     CSR         ZZAEND    ENDSR                           ** ZZAEND TAG *
000919220217      *
000920220217      ********************************************************************
000921220217      *
000922220217      ** SUBROUTINE TO CARRY OUT THE ADDITION FOR SUBROUTINES -
000923220217      **                        GLZADD, GLZSUB, GLZCMP.
000924220217      **          PARAMETERS PASSED -
000925220217      **                     I/P ZZAMTI ZZAMTD
000926220217      **                     O/P ZZTOTI ZZTOTD ZZNEGD IND 96 IND 99.
000927220217      *
000928220217      ********************************************************************
000929220217      *
000930220217     CSR         GLZSUM    BEGSR                           *** GLZSUM ****
000931220217      *
000932220217     CSR                   Z-ADDZZTOTI    ZZTOTI 150       DEFINE ZZTOTI
000933220217     CSR                   Z-ADDZZTOTD    ZZTOTD  30       DEFINE ZZTOTD
000934220217     CSR                   SETOF                     919293
000935220217     CSR                   SETOF                     949599
000936220217      *
000937220217      ** DETERMINE SIGN OF ZZAMTI & D,   92 IF NEG
000938220217      *
000939220217     CSR         ZZAMTI    COMP 0                      9293
000940220217     CSR 93      ZZAMTD    COMP 0                      9293
000941220217     CSR 93                GOTO ZZSEND                     ZERO BYPASS
000942220217      *
000943220217      ** DETERMINE SIGN OF ZZTOTI & D, 91 IF NEG.
000944220217      *
000945220217     CSR         ZZTOTI    COMP 0                      9193
000946220217     CSR 93      ZZTOTD    COMP 0                      9193
000947220217      *
000948220217      ** IF ZZTOTAL IS ZERO, RETURN ZZAMOUNT.
000949220217      *
000950220217     CSR 93                Z-ADDZZAMTI    ZZTOTI
000951220217     CSR 93                Z-ADDZZAMTD    ZZTOTD
000952220217     CSR 93                GOTO ZZSEND                     ZERO BYPASS
000953220217      *
000954220217      ** IF SIGNS DIFFER BYPASS OVERFLOW CHECKS.
000955220217      *
000956220217     CSR 91N92
000957220217     CORN91 92             GOTO ZZOFPS
000958220217      *
000959220217     CSR         ZZAMTD    ADD  ZZTOTD    ZZWK2   40
000960220217     CSR         ZZWK2     COMP 999                  93    '93' = CARRY
000961220217     CSRN93      ZZWK2     COMP -999                   93    INTO INTEGER.
000962220217      *
000963220217     CSR 93N92   ZZAMTI    ADD  1         ZZWK3  150       ADD 'CARRY' +VE
000964220217     CSR    93 92ZZAMTI    SUB  1         ZZWK3            SUB 'CARRY' -VE
000965220217     CSR 93      ZZTOTI    ADD  ZZWK3     ZZWK3
000966220217     CSRN93      ZZTOTI    ADD  ZZAMTI    ZZWK3
000967220217      *
000968220217      ** IF THE MODULUS OF ZZWK3 IS LT MOD. ZZTOTI THEN O/F HAS OCCURED
000969220217      *
000970220217     CSRN92      ZZWK3     COMP ZZTOTI                 99  -92 MEANS NOS.
000971220217     CSR 92      ZZWK3     COMP ZZTOTI               99     NEGATIVE
000972220217     CSRN99                Z-ADDZZWK2     ZZTOTD
000973220217     CSRN99                Z-ADDZZWK3     ZZTOTI
000974220217      *
000975220217      ** IF O/F ZEROIZE ZZAMT , IND '99' SET AND ZZTOT FIELDS LEFT INTACT.
000976220217      *
000977220217     CSR 99                Z-ADD0         ZZAMT  153
000978220217     CSR                   GOTO ZZSEND
000979220217      *
000980220217      ** THE 'SIGNS' ARE DIFFERENT
000981220217      *
000982220217     CSR         ZZOFPS    TAG                             ** ZZOFPS TAG**
000983220217      *
000984220217      ** IF ZZAMT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZTOT
000985220217      *
000986220217     CSR 92                Z-SUBZZAMTI    ZZAMTI 150
000987220217     CSR 92                Z-SUBZZAMTD    ZZAMTD  30
000988220217      *
000989220217      ** IF ZZTOT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZAMT.
000990220217      *
000991220217     CSR 91                Z-SUBZZTOTI    ZZTOTI
000992220217     CSR 91                Z-SUBZZTOTD    ZZTOTD
000993220217      *
000994220217      ** BOTH ZZAMT AND ZZTOT ARE NOW POSITIVE.
000995220217      *
000996220217     CSR         ZZTOTI    COMP ZZAMTI               93  95
000997220217     CSR 95      ZZTOTD    COMP ZZAMTD               93  95
000998220217      *
000999220217      ** IF ZZTOT EQ. ZZAMT RETURN ZERO.
001000220217      *
001001220217     CSR 95                Z-ADD0         ZZTOTI
001002220217     CSR 95                Z-ADD0         ZZTOTD
001003220217     CSR 95                GOTO ZZSEND
001004220217      *
001005220217      ** IF ZZTOT GT. ZZAMT.
001006220217      *
001007220217     CSR 93      ZZAMTD    COMP ZZTOTD               94
001008220217     CSR 93 94   ZZTOTI    SUB  1         ZZTOTI
001009220217     CSR 93 94   ZZTOTD    ADD  1000      ZZWK2
001010220217     CSR 93      ZZTOTI    SUB  ZZAMTI    ZZTOTI
001011220217     CSR 93 94   ZZWK2     SUB  ZZAMTD    ZZTOTD
001012220217     CSR 93N94   ZZTOTD    SUB  ZZAMTD    ZZTOTD
001013220217      *
001014220217      ** IF ZZAMT GT. ZZTOT.
001015220217      *
001016220217     CSRN93      ZZTOTD    COMP ZZAMTD               94
001017220217     CSRN93 94   ZZAMTI    SUB  1         ZZWK3  150
001018220217     CSRN93 94   ZZAMTD    ADD  1000      ZZWK2
001019220217     CSRN93 94   ZZWK3     SUB  ZZTOTI    ZZTOTI
001020220217     CSRN93N94   ZZAMTI    SUB  ZZTOTI    ZZTOTI
001021220217     CSRN93 94   ZZWK2     SUB  ZZTOTD    ZZTOTD
001022220217     CSRN93N94   ZZAMTD    SUB  ZZTOTD    ZZTOTD
001023220217      *
001024220217      ** REVERSE SIGN OF ZZTOT IF LARGER I/P FIELDS WERE NEGATIVE
001025220217      *
001026220217     CSR                   SETOF                     94
001027220217     CSR 93 91
001028220217     CORN93 92             SETON                     94
001029220217     CSR 94                Z-SUBZZTOTI    ZZTOTI
001030220217     CSR 94                Z-SUBZZTOTD    ZZTOTD
001031220217      **
001032220217      ** RESTORE SIGN OF ZZAMTI & ZZAMTD IF IT WAS REVERSED.
001033220217     CSR 92                Z-SUBZZAMTI    ZZAMTI
001034220217     CSR 92                Z-SUBZZAMTD    ZZAMTD
001035220217     CSR         ZZSEND    TAG                             ** ZZSEND TAG *
001036220217      **
001037220217      ** IF ZZTOTD IS ZERO, AND ZZTOTI IS NEG. SET UP ZZNEGD.
001038220217     CSR                   SETOF                     96
001039220217     CSR         ZZTOTD    COMP 0                        91
001040220217     CSR 91      ZZTOTI    COMP 0                      96
001041220217     CSR 96                MOVE '.000-'   ZZNEGD  5
001042220217     CSR                   ENDSR                             ** ENDSR **
001043220217      ********************************************************************
001044220217      ********************************************************************
001045220217      **
001046220217      ** ZSYSTM SR. TO CHAIN TO THE INSTALLATION CONTROL DATA RECORD.
001047220217      **
001048220217     C           ZSYSTM    BEGSR                           *** ZSYSTM ***
001049220217      **
001050220217      ** ACCESS BANK DETAILS
001051220217      **
001052220217     C                     CALL 'AOBANKR0'
001053220217     C                     PARM '*MSG   ' @RTCD   7
001054220217     C                     PARM '*FIRST ' @OPTN   7
001055220217     C           SDBANK    PARM SDBANK    DSFDY
001056220217      *
001057220217     C           @RTCD     IFNE *BLANK
001058220217     C                     SETON                     U7U8LR
001059220217     C                     SETON                     99
001060220217     C                     MOVEL'SDBANKPD'DBFILE
001061220217     C                     MOVEL@OPTN     DBKEY            ***************
001062220217     C                     MOVEL@OPTN     DBOPTN  7        * DBERROR 001 *
001063220217     C                     Z-ADD1         DBASE            ***************
001064220217     C                     ELSE
001065220217      **
001066220217      ** CHECK SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.
001067220217     C           DATF      COMP 'M'                      98MMDDYY, 98 ON
001068220217     C                     END
001069220217      **
001070220217     C/COPY WNCPYSRC,LE0724C004
001071220217     C                     ENDSR
001072220217      **
001073220217      ********************************************************************
001074220217      *
001075220217      ** SUBROUTINE : #ZZ
001076220217      *
001077220217      ** CALLED BY MAIN PROCESSING DURING TOTAL TIME CALCLATIONS IF
001078220217      ** THE P1 FILES HAVE NOT ALREADY BEEN OPENDED (IE, IF THERE ARE
001079220217      ** NO RECORDS READ AND THEREFORE FILES OPENING NOT PERFORMED)
001080220217      *
001081220217     C           #ZZ       BEGSR
001082220217      *
001083220217      ** OPEN P1 SPOOL FILE
001084220217     C                     OPEN LE0724P1
001085220217     C                     SETON                     37
001086220217      ** IF REPORT FOR ALL ENTITIES OR NOT MULTIBRANCHING
001087220217      ** CALL ZSFILE WITH BLANK SENTY
001088220217     C           BRNCH     IFEQ 'ALL'
001089220217     C           MBIN      ORNE 'Y'
001090220217      ** ENSURE REPORT SPOOL FILE RECORDED BY RCF
001091220217      **
001092220217     C                     Z-ADDSFNUM     ZSNUM   60
001093220217     C                     OUT  LDA
001094220217     C                     CALL 'ZSFILE'
001095220217     C                     PARM           SEQ
001096220217     C                     PARM *BLANKS   SENTY   3
001097220217     C                     PARM           SFILE
001098220217     C                     PARM           ZSNUM
001099220217     C                     PARM           ZSERR   1
001100220217     C           *LOCK     IN   LDA
001101220217      *
001102220217     C           ZSERR     IFEQ 'Y'
001103220217      ** ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM
001104220217     C                     SETON                     U7U8LR
001105220217     C                     RETRN
001106220217     C                     END
001107220217      *
001108220217     C                     MOVEL'ALL'     FCLB
001109220217     C                     MOVEL*BLANKS   BRNM
001110220217      ** ELSE REPORT BY ENTITY SO CALL ZSFILE WITH ENTITY REQUESTED
001111220217     C                     ELSE
001112220217      ** ENSURE REPORT SPOOL FILE RECORDED BY RCF
001113220217     C                     Z-ADDSFNUM     ZSNUM   60
001114220217     C                     OUT  LDA
001115220217     C                     CALL 'ZSFILE'
001116220217     C                     PARM           SEQ
001117220217     C                     PARM BRNCH     SENTY   3
001118220217     C                     PARM           SFILE
001119220217     C                     PARM           ZSNUM
001120220217     C                     PARM           ZSERR   1
001121220217     C           *LOCK     IN   LDA
001122220217      *
001123220217     C           ZSERR     IFEQ 'Y'
001124220217      ** ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM
001125220217     C                     SETON                     U7U8LR
001126220217     C                     RETRN
001127220217     C                     END
001128220217      **
001129220217      *
001130220217     C                     MOVE BRNCH     FCLB
001131220217      ** AND GET ENTITY DETAILS FOR REPORT HEADINGS WHEN
001132220217      ** MULTIBRANCHING
001133220217     C           MBIN      IFEQ 'Y'
001134220217     C                     CALL 'AOBRCHR1'
001135220217     C                     PARM '*MSG   ' @RTCD   7
001136220217     C                     PARM '*KEY   ' @OPTN   7
001137220217     C                     PARM BRNCH     @DSNB   3
001138220217     C           SDBRCH    PARM SDBRCH    DSSDY
001139220217      *
001140220217     C           @RTCD     IFNE *BLANKS
001141220217     C                     SETON                     U7U8LR
001142220217     C                     MOVEL'SDBRCHPD'DBFILE
001143220217     C                     MOVEL@DSNB     DBKEY            **************
001144220217     C                     MOVEL@OPTN     DBOPTN  7        *DATABASE 05 *
001145220217     C                     Z-ADD5         DBASE            **************
001146220217     C                     MOVEL*BLANKS   BRNM
001147220217     C                     EXSR *PSSR
001148220217     C                     GOTO #ZZ9
001149220217     C                     END
001150220217     C                     END
001151220217      *
001152220217     C                     END
001153220217      *
001154220217     C           #ZZ9      ENDSR
001155220217      ********************************************************************
001156220217      ********************************************************************
001157220217      *
001158220217      ** *PSSR --- SUBROUTINE TO HANDLE ABNORMAL ERROR CONDITIONS
001159220217      *
001160220217      ** CALLED FROM: AFTER ABNORMAL OPERATION OCCURS
001161220217      *
001162220217      ** CALLS: NOTHING
001163220217      *
001164220217      ********************************************************************
001165220217      *
001166220217     C           *PSSR     BEGSR                           ** *PSSR **
001167220217      *
001168220217     C           @RUN      IFEQ *BLANKS
001169220217     C                     MOVE 'Y'       @RUN    1
001170220217     C                     DUMP
001171220217     C                     END
001172220217     C                     ENDSR                           ** *PSSR **
001173220217      **
001174220217      ********************************************************************
001175220217     C/COPY ZSRSRC,ZDATE2Z4
001176220217      ********************************************************************
001177220217     OLE0724P1H   03   OFNL2 37
001178220217     O*******AND      N44                                                                   MD024504
001179220217     O       OR        L2    37
001180220217     O*******AND      N44                                                                   MD024504
001181220217     O       OR        U7 U8 37
001182220217     O*******AND      N44                                                                   MD024504
001183220217     O                                   24 'REFERENCE  LE0724P1'
001184220217     O                         TITL      89
001185220217     O                                  104 'DATE'
001186220217     O                         RUNA     113
001187220217     O                                  122 'PAGE'
001188220217     O                         PAGE  3  128
001189220217     O        H   05   OFNL2 37
001190220217     O*******AND      N44                                                                   MD024504
001191220217     O       OR        L2    37
001192220217     O*******AND      N44                                                                   MD024504
001193220217     O       OR        U7 U8 37
001194220217     O*******AND      N44                                                                   MD024504
001195220217     O                                   48 'COMMITMENT AND FACILITY'
001196220217     O                                   71 'AVAILABILITY REPORT BY'
001197220217     O                                   85 'CUSTOMER NAME'
001198220217     O                       73          93 'BRANCH'
001199220217     O                       73FCLB      97
001200220217     O                       73          98 '-'
001201220217     O                 73N74 42          98 ' '
001202220217     O                       73BRNM     128
001203220217     O        H   06   OFNL2 37
001204220217     O*******AND      N44                                                                   MD024504
001205220217     O       OR        L2    37
001206220217     O*******AND      N44                                                                   MD024504
001207220217     O       OR        U7 U8 37
001208220217     O*******AND      N44                                                                   MD024504
001209220217     O                                   48 '-----------------------'
001210220217     O                                   71 '-----------------------'
001211220217     O                                   85 '--------------'
001212220217     O        H   08   OFNL2 37
001213220217     O*******AND      N44                                                                   MD024504
001214220217     O       OR        L2    37
001215220217     O*******AND      N44                                                                   MD024504
001216220217     O       OR        U7 U8 37
001217220217     O*******AND      N44                                                                   MD024504
001218220217     O                                   52 '----------------COMMITME'
001219220217     O                                   76 'NT/FACILITY------------ '
001220220217     O                                   87 '----------'
001221220217     O                                  111 '--------------LOANS/MFUS'
001222220217     O                                  130 '-------------------'
001223220217     O/COPY WNCPYSRC,LE0724O001
001224220217     O        H   09   OFNL2 37
001225220217     O*******AND      N44                                                                   MD024504
001226220217     O       OR        L2    37
001227220217     O*******AND      N44                                                                   MD024504
001228220217     O       OR        U7 U8 37
001229220217     O*******AND      N44                                                                   MD024504
001230220217     O                                   23 'CUSTOMER NAME        NO'
001231220217     O                                   40 'NO TYP CCY'
001232220217      *
001233220217     O                                   52 'AMOUNT'
001234220217     O                                   75 'AVAILABLE AMOUNT'
001235220217     O                                   81 'LPFI'
001236220217     O                      N73         100 'REF   TYPE     CCY'
001237220217     O                       73          99 'REF  TYPE     CCY'
001238220217      *
001239220217     O                      N73         130 'AMOUNT    COUNTRY   MAT.'
001240220217     O                       73         126 'AMOUNT   COUNTRY MAT.'
001241220217     O                       73         132 'BRANCH'
001242220217     O        H  210   OFNL2 37
001243220217     O*******AND      N44                                                                   MD024504
001244220217     O       OR   10   L2    37
001245220217     O*******AND      N44                                                                   MD024504
001246220217     O       OR   10   U7 U8 37
001247220217     O*******AND      N44                                                                   MD024504
001248220217     O/COPY WNCPYSRC,LE0724O003
001249220217     O                      N73         130 'RISK DOM.  DATE'
001250220217     O                       73         126 'RISK DOM.DATE'
001251220217     O        DF20     01NU7N50
001252220217     O       AND       37N44
001253220217     O       ORF20     02NU7 48
001254220217     O       AND       37N44
001255220217     O                 52      CNAM      20
001256220217     O                 52      CNUM      27
001257220217     O                 OFN52   CNAM      20
001258220217     O                 OFN52   CNUM      27
001259220217     O                      N45CFNO      34
001260220217     O                       45CFN1      31
001261220217     O                       45          32 '/'
001262220217     O                       45CFN2      34
001263220217     O                         FATP      36
001264220217     O                         CMCY      40
001265220217     O                 60      CFTA      58 ' ,   ,   ,   , 0 -'
001266220217     O                 61      CFTA      58 '   ,   ,   , 0 . -'
001267220217     O                 62      CFTA      58 '  ,   ,   , 0 .  -'
001268220217     O                 63      CFTA      58 ' ,   ,   , 0 .   -'
001269220217     O                 46                74 '**EXPIRED**'
001270220217     O                 60N46   CAVL      77 ' ,   ,   ,   , 0 -'
001271220217     O                 61N46   CAVL      77 '   ,   ,   , 0 . -'
001272220217     O                 62N46   CAVL      77 '  ,   ,   , 0 .  -'
001273220217     O                 63N46   CAVL      77 ' ,   ,   , 0 .   -'
001274220217     O/COPY WNCPYSRC,LE0724O004
001275220217     O        D 00     02NU7 48
001276220217     O       AND       37N44
001277220217     O       OR 20     02NU7N48
001278220217     O       AND       37N44
001279220217      *
001280220217      ** Write Customer Name and Number if not a Facility/Commitment
001281220217      ** record upon page overflow.
001282220217      *
001283220217     O                 OF 02 53CNAM      20
001284220217     O                 OF 02 53CNUM      27
001285220217     O                         LPFI      79
001286220217     O                N04N73N23DDRF      87
001287220217     O                N04N73 23SQNO      83
001288220217     O                 04N73   LCNO      87
001289220217     O                N04N73N23LTYP      90
001290220217     O                N04N73N23SUTP      92
001291220217     O                N04N73N23CLAS      96
001292220217     O                N04N73 23          93 'MFU  '
001293220217     O                 04N73   LTPSTP    92
001294220217     O                 66N73   AMNT     115 ' ,   ,   ,   , 0 -'
001295220217     O                 67N73   AMNT     115 '   ,   ,   , 0 . -'
001296220217     O                 68N73   AMNT     115 '  ,   ,   , 0 .  -'
001297220217     O                 69N73   AMNT     115 ' ,   ,   , 0 .   -'
001298220217     O                   N73   DDCY     100
001299220217     O                   N73   CRSK     119
001300220217     O                   N73   CLOC     122
001301220217     O                   N73 21MATDAT   130
001302220217     O                N04 73N23DDRF      86
001303220217     O                N04 73 23SQNO      83
001304220217     O                 04 73   LCNO      86
001305220217     O                N04 73N23LTYP      89
001306220217     O                N04 73N23SUTP      91
001307220217     O                N04 73N23CLAS      95
001308220217     O                N04 73 23          92 'MFU  '
001309220217     O                 04 73   LTPSTP    91
001310220217     O                 66 73   AMNT     114 ' ,   ,   ,   , 0 -'
001311220217     O                 67 73   AMNT     114 '   ,   ,   , 0 . -'
001312220217     O                 68 73   AMNT     114 '  ,   ,   , 0 .  -'
001313220217     O                 69 73   AMNT     114 ' ,   ,   , 0 .   -'
001314220217     O                    73   DDCY      99
001315220217     O                    73   CRSK     117
001316220217     O                    73   CLOC     120
001317220217     O                    73 21MATDAT   128
001318220217     O                    73   BRCA     132
001319220217     O        DF20     01NU7N50
001320220217     O       AND       37 39N44
001321220217     O       ORF20     01NU7N50
001322220217     O       AND       37 43N44
001323220217     O       ORF20     02NU7 48
001324220217     O       AND       37 39N44
001325220217     O       ORF20     02NU7 48
001326220217     O       AND       37 43N44
001327220217     O                N46 39             30 'CURRENT OFFSET: '
001328220217     O                 60N46 39FCXCOF    50 ' ,   ,   ,   , 0 -'
001329220217     O                 61N46 39FCXCOF    50 '   ,   ,   , 0 . -'
001330220217     O                 62N46 39FCXCOF    50 '  ,   ,   , 0 .  -'
001331220217     O                 63N46 39FCXCOF    50 ' ,   ,   , 0 .   -'
001332220217     O                N46 43             66 'ADVANCE LTV: '
001333220217     O                N46 43   FCXALV    70
001334220217     O                N46 43             96 'CURRENT LENDING VALUE: '
001335220217     O                 60N46 43FCXCV1   120 '   ,   ,   ,   , 0 -'
001336220217     O                 61N46 43FCXCV1   120 '  ,   ,   ,   , 0 . -'
001337220217     O                 62N46 43FCXCV1   120 ' ,   ,   ,   , 0 .  -'
001338220217     O                 63N46 43FCXCV1   120 '   ,   ,   , 0 .   -'
001339220217     O/COPY WNCPYSRC,LE0724O002
001340220217     O        T   03   42 LR 37
001341220217     O                                   24 'REFERENCE  LE0724P1'
001342220217     O                         TITL      89
001343220217     O                                  104 'DATE'
001344220217     O                         RUNA     113
001345220217     O                                  122 'PAGE'
001346220217     O                         PAGE  3  128
001347220217     O        T   05   42 LR 37
001348220217     O                                   48 'COMMITMENT AND FACILITY'
001349220217     O                                   71 'AVAILABILITY REPORT BY'
001350220217     O                                   80 'CUSTOMER'
001351220217     O                       73          93 'BRANCH'
001352220217     O                       73FCLB      97
001353220217     O                       73          98 '-'
001354220217     O                 73N74 42          98 ' '
001355220217     O                       73BRNM     128
001356220217     O        T   06   42 LR 37
001357220217     O                                   48 '-----------------------'
001358220217     O                                   71 '-----------------------'
001359220217     O                                   80 '---------'
001360220217      *
001361220217      ** RUN CONTROLS
001362220217      *
001363220217     O        T   17   LRNU7 42
001364220217     O       AND       37
001365220217     O                                   77 '* NO DETAILS TO REPORT *'
001366220217     O        T 32     LR U7 37
001367220217     O                                   51 '*** REFERENCE LE0724'
001368220217     O                                   71 '- DATABASE ERROR   '
001369220217     O        T 3      LR 37N73
001370220217     O                                   76 '*** END OF REPORT ***'
001371220217     O        T 3      L2 37 73
001372220217     O                                   66 '*** END OF REPORT FOR'
001373220217     O                                   74 ' BRANCH '
001374220217     O                         FCLB      77
001375220217     O                                   81 '***'
001376220217     OLE0724AUT   03   LR
001377220217     O                                   24 'REFERENCE  LE0724AU'
001378220217     O                         TITL      89
001379220217     O                                  104 'DATE'
001380220217     O                         RUNA     112
001381220217     O                                  122 'PAGE'
001382220217     O                         PAGE1 3  127
001383220217     O        T   05   LR
001384220217     O                                   50 'COMMITMENT AND FACILITY'
001385220217     O                                   73 'AVAILABILITY REPORT BY'
001386220217     O                                   94 'CUSTOMER NAME - FILE'
001387220217     O                                  103 'CONTROLS'
001388220217     O        T   06   LR
001389220217     O                                   50 '-----------------------'
001390220217     O                                   74 '------------------------'
001391220217     O                                   94 '--------------------'
001392220217     O                                  103 '---------'
001393220217     O        T   09   LR
001394220217     O                                   28 'S/LEFAXL0 - RUN CONTROLS'
001395220217     O                                   59 'NUMBER'
001396220217     O                                   84 'VALUE'
001397220217     O                                  110 'LOAN/MFU TYPE RECORDS'
001398220217     O        T   10   LR
001399220217     O                                   28 '----------------------'
001400220217     O                                   59 'OF RECORDS'
001401220217     O                                   84 'OF RECORDS'
001402220217     O                                  110 '---------------------'
001403220217     O        T   12   LR
001404220217     O                                   29 'TOTAL RECORDS ON FILE'
001405220217     O                      NU7NOLR  3   59
001406220217     O                      NU7HLDW  4   81
001407220217     O                      NU7HLDC      84
001408220217     O        T   14   LR
001409220217     O                                   29 'TOTAL RECORDS ON FILE'
001410220217     O                                   42 '- CALCULATED'
001411220217     O                         COUNT23   59
001412220217     O                         HSHWN24   81
001413220217     O                         HSHDC2    84
001414220217     O                       64         111 '*** DIFFERENCE ***'
001415220217     O        T   17   LR
001416220217     O                                   28 'S/LEFAXL0 - RUN CONTROLS'
001417220217     O                                   59 'NUMBER'
001418220217     O                                   84 'VALUE'
001419220217     O                                  110 'FAC/CMMT TYPE RECORDS'
001420220217     O        T   18   LR
001421220217     O                                   28 '----------------------'
001422220217     O                                   59 'OF RECORDS'
001423220217     O                                   84 'OF RECORDS'
001424220217     O                                  110 '---------------------'
001425220217     O        T   20   LR
001426220217     O                                   29 'TOTAL RECORDS ON FILE'
001427220217     O                      NU7NOFR  3   59
001428220217     O                      NU7HFDW  4   81
001429220217     O                      NU7HFDC      84
001430220217     O        T   22   LR
001431220217     O                                   29 'TOTAL RECORDS ON FILE'
001432220217     O                                   42 '- CALCULATED'
001433220217     O                         COUNT13   59
001434220217     O                         HSHWN14   81
001435220217     O                         HSHDC1    84
001436220217     O                       65         111 '*** DIFFERENCE ***'
001437220217     O        T 32     LRNU7 42
001438220217     O                                   77 '* NO DETAILS TO REPORT *'
001439220217     O        T 32     LR U7
001440220217     O                                   51 '*** REFERENCE LE0724'
001441220217     O                                   71 '- DATABASE ERROR AT'
001442220217     O                         DBASE     75
001443220217     O        T        LR U7
001444220217     O                                   37 'FILENAME'
001445220217     O                         DBFILE    46
001446220217     O                                   51 'KEY'
001447220217     O                         DBKEY     81
001448220217**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0014492202170366073110961461
001450220217**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
001451220217000031059090120151181212243273304334365
001452220217**   ZMNM - MONTHS SHORT NAMES
001453220217JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
001454220217** CPY@   **      OBJECT COPYRIGHT
001455220217(c) Finastra International Limited 2021
