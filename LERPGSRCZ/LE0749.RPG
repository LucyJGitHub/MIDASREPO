0001 H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas Cust lending portfolio -by company')             *
0002 F********************************************************************
0003 F*                                                                  *
     F*              Midas Customer Lending Module               *
0005 F*                                                                  *
0006 F*     LE0749  -  CUSTOMER LENDING PORTFOLIO - BY COMPANY           *
0007 F*                                                                  *
      *  (c) Finastra International Limited 2001                      *
0007 F*                                                                  *
      *  Last Amend No. MD041994           Date 28Apr20               *
      *  Last Amend No. MD046248           Date 27Oct17               *
      *  Prev Amend No. CLE148             Date 23Jul12               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CSD031             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 CLE042             Date 06Sep05               *
      *                 CSW037A            Date 02May05               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 CLE025             Date 20Oct03               *
      *                 CGL029             Date 01Sep03               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 091807             Date 15Aug95               *
      *                 S01339             Date 05Nov92               *
     F*                    MEP062         DATE  05NOV92                  *
     F*                    S01392         DATE  07OCT92                  *S01392
     F*                    E26745         DATE  12MAR92                  *
     F*                    BHF305         DATE  20SEP90                  *
     F*                    BHF248         DATE  25JUL90                  *
     F*                    LN0284         DATE  05JUNE90                  LN0284
     F********************************************************************
     F*                                                                  *
      *  MD041994 - COB components LEC08 10012 and LEC08 10003 failed *
      *             due to closed customer. Do not process DBERR when *
      *             when customer is closed for an expired facility.  *
      *           - Applied for MD-55209                              *
      *  MD046248 - Finastra Rebranding                               *
      *  CLE148 - Alpha Loan Reference                                *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CLE042 - Extended Loan Sub Type                              *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  CLE025 - Credit Lines (Recompile)                            *
      *  CGL029 - Increase Account Code to 10 digits                  *
     F*     091807 - REMOVE FILE CONTROL CHECK AS NOT ALL DETAIL         *
     F*              RECORDS ARE PROCESSED BY THE PROGRAM.               *
     F*     S01339 - REMOVAL OF SYNICATED LOANS PROCESSING DUE TO        *S01392
     F*              MODULE REDUNDANCY - R10.3.22                        *S01392
     F*     MEP062 - PRINT VALUE DATE WITH LOAN DETAILS.                 *
     F*     S01392 - JAPANESE SUB MODULE ENHANCEMENTS                    *S01392
     F*     E26745 - INCORRECT CHECK ON RECOURSE IND - IT IS NOW Y/N     *
     F*     BHF305 - FIX OVERFLOW PROBLEM                                *
     F*     BHF248 - DARN SYNDICATED LOAN CODING AGAIN                   *
     F*     LN0284 - DATABASE ERROR MESSAGE NEEDS KEY TO BE SET UP        LN0284
0012 F********************************************************************LN0284
     F*  C R E A T I O N     P A R A M E T E R S                      *
     F*                                                               *
     F*                                                               *
     F*****************************************************************
0013 F*
     F***PORTL3* IP  F      96 33AI     2 DISK                           U1
     F***PORTL4* IS  F      96 33AI     2 DISK                           U2
     F*PORTL3**IP**F*****122 33AI     2 DISK                           U1                     CLE042
     F*PORTL4**IS**F*****122 33AI     2 DISK                           U2                     CLE042
     FPORTL3  IP  F     126 33AI     2 DISK                           U1                      CLE042
     FPORTL4  IS  F     126 33AI     2 DISK                           U2                      CLE042
     F/COPY WNCPYSRC,LE0749F001
     FLE0749AUO   F     132            PRINTER      KINFDS SPOOLU
     FLE0749P1O   F     132     OF     PRINTER      KINFDS SPOOL      UC
0018 F* ID F  C  H  L    FUNCTION OF INDICATORS
0019 F* 01            SFPOR - DETAIL RECORD
0020 F* 02                  - TRAILER
     F*       10      ALLOW OUTPUT TO COMPANY
0026 F*    20         S/SFPOR - PARENT NO. ZERO
0027 F*    21         A/C OFFICER CODE BLANK
0028 F*    22        GRANTED/UTILISED AMOUNT NEGATIVE
0029 F*    23         CHILD/PARENT IND BLANK - REC. RELATES TO PARENT
0030 F*       25      LINE SPACING
0031 F*       30      FIRST CYCLE INDICATOR
0032 F*       31      GRANTED RECORD
0033 F*       32      UTILISED RECORD
0034 F*       33      PARENT DETAILS
0035 F*       34      DETAILS TO REPORT INDICATOR
0036 F*       35      CREDIT LINE TYPE - 1 - RET.
0037 F*       36                       - 2 - FAC.
0038 F********37********               - 3 - COM.                         S01339
0039 F*       38                       - 4 - LIMIT
0040 F*       39      EXPIRY DATE LESS THAN OR EQUAL TO RUNDATE
0041 F*       40      UTILISED AMOUNT EXCEEDED AMOUNT GRANTED- FOR REF.TYP
0042 F*       41                                             - FOR CUST.
0043 F*       42                                 -FOR PARENT CR LINE TYPE
0044 F*       43      WORK INDICATOR
0045 F*       44      FOR PARENT - OVERALL TOTAL - EXCEEDED AMOUNT
0046 F*       45 46   CONTROL OF HEADINGS ON NORMAL OF
0047 F*       47      CREDIT LINE TYPE - 5 - GTE
0048 F*       48      RECORD SOURCE B
0049 F*       49      PARTICIPATION SOLD
0050 F*       50      NO RECOURSE
0051 F*       51      OUTPUT HEADINGS ONCE IF NO DETAILS TO REPORT
0052 F*       52      CREDIT LINE TYPE - 6 - FCL.
0053 F*       53      LINE SPACING
     F*       54      SUPPRESS O/P OF RETAIL HEADINGS
     F*       55      OUTPUT CUSTOMER NAME AND TOWN
0053 F*       56      CREDIT LINE TYPE - 7 - LC
0053 F********57******COMMERCIAL LOANS IS ON THE SYSTEM                   S01339
0053 F*       58      PRINT SECURITY HOLDINGS TOTAL FOR CHILD
0053 F*       59      PRINT SECURITY HOLDINGS TOTAL FOR PARENT
0054 F*       61      FACILITY GRANTED TO PARENT
0055 F*       62      FACILITY TO PARENT UTILIZED
0055 F*       65      FETCH OVERFLOW CONDITION, NOT AFTER TOTAL OUTPUT
0056 F*       70      NO DETAILS TO REPORT
0056 F*       74      ORIGINATING BRANCH USED
0056 F*       75      MULTIBRANCHING (MBIN = 'Y')
0056 F*       76      MDIN 0 - US CCY
0057 F*       77      MDIN 0 - G/U CCY
0058 F*       90-99   STANDARD SUBROUTINES
     F*       U1      BY BOOKING BRANCH
     F*       U2      BY ORIGINATING BRANCH
0059 F*       U7,U8   STANDARD MIDAS USAGE
0060 F*             L1REFERENCE TYPE CHANGE
0061 F*             L2CREDIT LINE TYPE CHANGE
0062 F*             L3CUST. NO. CHANGE
0063 F*             L4PARENT NO. CHANGE
0064 F*             L5A/C OFFICER CHANGE
0065 F*             L6COMPANYCODE CHANGE
     E/COPY ZSRSRC,ZDATE2Z1                                               S01392
     E                    CPY@    1   1 80
0069 E**
0070 I*
0071 I*    LOANS PORTFOLIO SORTED FILE - DETAIL RECORD
0072 I*
     IPORTL3  NS  01   1 CD
0074 I                                        1   1 RECI
0075 I                                        2   3 ACOC  L5        21
0076 I**********                              4   90PARN  L4        20                        CSD027
0077 I**********                             10  150CNUM  L3                                  CSD027
0076 I                                        4   9 PARN  L4        20                        CSD027
0077 I                                       10  15 CNUM  L3                                  CSD027
0078 I                                       16  16 PCIN
0079 I                                       17  17 CRLT  L2
0080 I                                       18  18 GUIN
0081 I                                       19  21 GUCY
0082 I                                    P  23  290GUAM          22
0083 I**********                             30  35 REFT  L1                                  CGL029
0083 I                                       30  35 REFTQQ                                    CGL029
0084 I                                    P  36  380EXPD
0085 I**********                             39  46 TRRF                                      CGL029
0085 I                                       39  46 TRRFQQ                                    CGL029
0086 I                                       47  47 RECS
0087 I                                       48  50 BRCA
0088 I**********                             51  560PSLN                                      CLE148
     I                                       51  56 PSLN                                      CLE148
0089 I                                       57  57 RCSI
0090 I                                       58  62 LTST
0091 I                                       63  63 CPIN            23
     I                                       68  70 CMPYM L6
     I                                       71  73 ORBR
     I                                       74  76 COOB
     I                                       77  79 LBRA
     I                                    P  80  820LVDT                  MEP062
0083 I                                       97 108 REFT  L1                                  CGL029
0085 I                                      109 122 TRRF                                      CGL029
     I                                      123 126 CLAS                                      CLE042
0092 I**
     I**  PORTL3 - TRAILER RECORD
0092 I**
0094 I        NS  02   1 CT
0095 I                                    P   2   40NORE
0096 I                                    P   5  120HRWN
0097 I                                    P  13  140HRDC
0098 I**
     I**  PORTL3  CATCHALL
0098 I**
0100 I        NS
     I**
     IPORTL4  NS  01   1 CD
0074 I                                        1   1 RECI
0075 I                                        2   3 ACOC  L5        21
0076 I**********                              4   90PARN  L4        20                        CSD027
0077 I**********                             10  150CNUM  L3                                  CSD027
0076 I                                        4   9 PARN  L4        20                        CSD027
0077 I                                       10  15 CNUM  L3                                  CSD027
0078 I                                       16  16 PCIN
0079 I                                       17  17 CRLT  L2
0080 I                                       18  18 GUIN
0081 I                                       19  21 GUCY
0082 I                                    P  23  290GUAM          22
0083 I**********                             30  35 REFT  L1                                  CGL029
0083 I                                       30  35 REFTQQ                                    CGL029
0084 I                                    P  36  380EXPD
0085 I*********                              39  46 TRRF                                      CGL029
0085 I                                       39  46 TRRFQQ                                    CGL029
0086 I                                       47  47 RECS
0087 I                                       48  50 BRCA
0088 I**********                             51  560PSLN                                      CLE148
     I                                       51  56 PSLN                                      CLE148
0089 I                                       57  57 RCSI
0090 I                                       58  62 LTST
0091 I                                       63  63 CPIN            23
     I                                       68  70 CMPYM
     I                                       71  73 ORBR
     I                                       74  76 COOB  L6
     I                                       77  79 LBRA
     I                                    P  80  820LVDT                  MEP062
0083 I                                       97 108 REFT  L1                                  CGL029
0085 I                                      109 122 TRRF                                      CGL029
     I                                      123 126 CLAS                                      CLE042
0092 I**
     I**  PORTL4 - TRAILER RECORD
0092 I**
0094 I        NS  02   1 CT
0095 I                                    P   2   40NORE
0096 I                                    P   5  120HRWN
0097 I                                    P  13  140HRDC
0098 I**
     I**  PORTL4  CATCHALL
0098 I**
0100 I        NS
      **
      *
     I****SDSYLN****E*DSSDSYLNPD****                                      S01339
     I**************BOCYCD**********                CLRC                  S01339
      *
     ISDACOF    E DSSDACOFPD
      **  EXTERNAL DS FOR ACCOUNT OFFICER DETAILS
     I              AZACON                          ACON
     I**
     I*
     ISDCUST    E DSSDCUSTPD
      **   CUSTOMER
     I              BBACOC                          ACOC
     I              BBCRNM                          CRNM
     I              BBCRTN                          CTWN
      *
     ISDCURR    E DSSDCURRPD
      **   CURRENCY
     I              A6NBDP                          CDP
     I              A6SPRT                          SPOT
     I              A6MDIN                          MDIN
      **
     I*****SDMMOD****E*DSSDMMODPD****                                     S01339
      ***MIDAS*MODULE*DETAILS********                                     S01339
      ***********                                                         S01339
     I*****SDTRAD****E*DSSDTRADPD****                                     S01339
      ****ACCESS*TO*TRADING*DETAILS**                                     S01339
     I**************BLUSCY***********               USCY                  S01339
      *
     ISDBANK    E DSSDBANKPD
      ** BANK DETAILS
     I              BJURPT                          TITL
     I              BJCYCD                          BCCY                  S01339
      *
     ISDCOMP    E DSSDCOMPPD
     I**  EXTERNAL DS FOR COMPANY CODE DETAILS
     I              APCMNM                          CMNM
     ISDGELR    E DSSDGELRPD
      **  EXTERNAL DS FOR GENERAL LEDGER DETAILS
     I              BKOBRU                          OBUU
0238 I**   LOCAL DATA AREA FOR DATABASE ERROR IDENTIFICATION
0239 ILDA        UDS                            256
0353 I                                      134 141 DBFILE
0354 I                                      142 170 DBKEY
0355 I                                      171 180 DBPGM
0356 I                                      181 1830DBASE
     I**
     I**   FILE INFORMATION DATA STRUCTURE
     I**
     ISPOOL       DS
     I                                       83  92 SFILE
     I                                    B 123 1240SFNUM
     I**
     I**   FILE INFORMATION DATA STRUCTURE
     I**
     ISPOOLU      DS
     I                                       83  92 SFILEU
     I                                    B 123 1240SFNUMU
     I**
     IRUNDT       DS
     I**  DATA AREA RUNDAT
     I                                        1   7 RUNA
     I                                    P   8  100RUND
     I                                       11  11 SSF
     I                                       12  12 DATF
     I                                       13  13 MBIN
     I*
     IDSFDY     E DSDSFDY
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE
     I*
     IDSSDY     E DSDSSDY
     I* SECOND DS FOR ACCESS PROGRAMS, LONG DATA STRUCTURE
     I*
     I/EJECT
0244 C**
0245 C**  FIRST CYCLE CALCULATIONS
0246 C   30                GOTO ENDFC
0247 C                     SETON                     30
     C                     MOVEACPY@      BIS@   80
0248 C**
     C**
     C           *ENTRY    PLIST
     C                     PARM           SEQ     5         SEQUENCE
     C                     PARM           BRNCH   3         COMPANYOR ALL
     C**
     C**   IN THE DATAAREA RUNDAT
     C**
     C           *NAMVAR   DEFN RUNDAT    RUNDT
     C                     IN   RUNDT
     C           *NAMVAR   DEFN           LDA
     C**
     C*     IF MBIN=Y, SET ON *IN75
     C**
     C           MBIN      IFEQ 'Y'
     C                     SETON                     75
     C                     END
     C**
     C**********           CALL 'AOGELRR0'                                                    CGL029
     C                     CALL 'AOGELRR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7
     C                     PARM '*FIRST ' @OPTN   7
     C********** SDGELR    PARM SDGELR    DSFDY                                               CGL029
     C           SDGELR    PARM SDGELR    DSSDY                                               CGL029
     C*
     C           @RTCD     IFNE *BLANK
     C                     SETON                     U7U8LR
     C                     MOVEL'SDGELRPD'DBFILE           ***************
     C                     MOVEL@OPTN     DBKEY            * DBERROR 010 *
     C                     Z-ADD10        DBASE            ***************
     C                     GOTO END
     C                     END
     C*
     C           OBUU      IFEQ 'Y'
     C                     SETON                     74
     C                     ELSE
     C                     SETOF                     74
     C                     END
     C*
0249 C**  OBTAIN INSTALLATION CONTROL RECORD 1
     C*
     C                     CALL 'AOBANKR0'
     C                     PARM '*MSG   ' @RTCD   7
     C                     PARM '*FIRST ' @OPTN   7
     C           SDBANK    PARM SDBANK    DSFDY
0253 C**
     C           @RTCD     IFNE *BLANK
0254 C                     SETON                     U7U8LRNOT FOUND
0255 C                     SETON                     OF45  O/P HEADINGS
0257 C                     MOVE 'SDBANKPD'DBFILE           ************
0258 C                     Z-ADD9         DBASE            * DBASE 09 *
0259 C                     GOTO END                        ************
     C                     END
0261 C**  CHECK SYSTEM DATE FORMAT DDMMYY OR MMDDYY
0262 C           DATF      COMP 'M'                      98DDMMYY 98 ON
0263 C**
0265 C****OBTAIN*INST.*CONTROL*5 FOR*COMM*LOANS*REPORTING*CCY****         S01339
     C***********                                                         S01339
     C***ACCESS*TRADING*DATA                                              S01339
     C***********                                                         S01339
     C***********          CALL 'AOTRADR0'                                S01339
     C***********          PARM '*MSG   ' @RTCD   7                       S01339
     C***********          PARM '*FIRST ' @OPTN   7                       S01339
     C***********SDTRAD    PARM SDTRAD    DSFDY                           S01339
0268 C***********                                                         S01339
     C***********@RTCD     IFNE *BLANK                                    S01339
0269 C***********          SETON                     U7U8LR               S01339
0270 C***********          SETON                     OF45  O/P HEADINGS   S01339
0272 C***********          MOVE 'SDTRADPD'DBFILE           ************   S01339
0273 C***********          Z-ADD2         DBASE            * DBASE 02 *   S01339
0274 C***********          GOTO END                        ************   S01339
     C***********          END                                            S01339
0249 C****OBTAIN*MODULES*SWITCHED*ON******                         BHF248 S01339
     C***********                                                  BHF248 S01339
     C***********          CALL 'AOMMODR0'                         BHF248 S01339
     C***********          PARM '*MSG   ' @RTCD                    BHF248 S01339
     C***********          PARM '*FIRST ' @OPTN                    BHF248 S01339
     C***********SDMMOD    PARM SDMMOD    DSFDY                    BHF248 S01339
     C***********@RTCD     IFNE *BLANKS                            BHF248 S01339
0199 C***********          SETON                     U7U8LR**DATABABHF248 S01339
0200 C***********          Z-ADD99        DBASE                    BHF248 S01339
0202 C***********          MOVE 'SDMMODPD'DBFILE                   BHF248 S01339
     C***********          GOTO END                                BHF248 S01339
     C***********          END                                     BHF248 S01339
0275 C***********                                                         S01339
     C****IF*COMMERCIAL*LOANS*HAS*BEEN*SET*UP*ON*THE*SYSTEM*THEN**        S01339
     C****USE*SPOT*RATE*AND*NO.*OF*DECIMAL*PLACES*FOR*CL*CCY*OTHERWISE    S01339
     C****USE*USD*CURRENCY.****                                           S01339
     C***********BGSYLN    COMP 'Y'                      57               S01339
     C***57******          MOVE CLRC      CCY     3                       S01339
     C**N57******          MOVE USCY      CCY                             S01339
     C                     MOVE BCCY      CCY     3                       S01339
     C                     CALL 'AOCURRR0'
     C                     PARM '*MSG   ' @RTCD
     C                     PARM '*KEY   ' @OPTN
     C                     PARM CCY       K101    3                    A
     C           SDCURR    PARM SDCURR    DSSDY                        B
     C           @RTCD     IFNE *BLANK
0282 C**                                                   USD CCY CODE
0283 C                     SETON                     U7U8LRNOT FOUND
0284 C                     SETON                     OF45  O/P HEADINGS
0285 C                     MOVE K101      DBKEY
0286 C                     MOVE 'SDCURRPD'DBFILE           ************
0287 C                     Z-ADD3         DBASE            * DBASE 03 *
0288 C                     GOTO END                        ************
     C                     END
0289 C                     Z-ADDSPOT      USSPOT 138
0290 C                     Z-ADDCDP       USCDP   10
     C***********                                                         S01339
     C***IF*SYNDICATED*LOANS*MODULE*IS*PRESENT*TEST*MDIN****              S01339
     C***********                                                         S01339
     C************IN57     IFEQ '1'                                       S01339
     C***********MDIN      COMP 'D'                      77               S01339
     C***********          ELSE                                           S01339
     C           MDIN      COMP 'D'                      76               S01339
     C***********          END                                            S01339
0293 C                     MOVE ' '       BLANKS 30
0294 C           ENDFC     TAG                             * ENDFC TAG
     C**
     C**   MULTIBRANCH MAIN PROCESSING
     C**
     C           MBIN      IFEQ 'Y'                        B1
     C*
     C**      IF CMPYM(COOB) IS LESS THAN THE REQUIRED COMAPNY,
     C**      SKIP THE CALCULATION
     C*
     C                     MOVE *BLANK    @BRCH   3
     C   U1                MOVE CMPYM     @BRCH
     C   U2                MOVE COOB      @BRCH
     C*
     C           BRNCH     IFNE 'ALL'                      B3
     C           BRNCH     ANDGT@BRCH
     C                     SETOF                     10
     C                     GOTO END
     C                     END                             E3
     C*
     C**      IF CMYPM(COOB) IS GREATER THAN THE REQUIRED COMPANY,
     C**      END THE PROGRAM
     C*
     C           BRNCH     IFNE 'ALL'                      B3
     C           BRNCH     ANDLT@BRCH
     C                     SETON                     LR
     C                     SETOF                     10
     C                     GOTO END
     C                     END
     C*
     C           *INL6     IFEQ '1'                        B2
     C                     CLOSELE0749P1
     C**
     C*       IF MBIN=YES, AND A REQUIRED BRANCH AND A LEVEL BREAK,
     C*       OPEN LE0749P1
     C**
     C           BRNCH     IFEQ 'ALL'                      B3
     C           BRNCH     OREQ @BRCH
     C                     SETON                     10
     C                     MOVE 'Y'       P1OP    1
     C                     OPEN LE0749P1
     C                     Z-ADD0         PAGE
     C**
     C*    ENSURE REPORT SPOOL FILE RECORDED BY RCF
     C**
     C                     Z-ADDSFNUM     ZSNUM   60
     C                     OUT  LDA
     C**
     C                     MOVE *BLANK    @BRCH   3
     C   U1                MOVE CMPYM     @BRCH
     C   U2                MOVE COOB      @BRCH
     C**
     C                     CALL 'ZSFILE'
     C                     PARM           SEQ
     C                     PARM @BRCH     SENTY   3
     C                     PARM           SFILE
     C                     PARM           ZSNUM
     C                     PARM           ZSERR   1
     C           *LOCK     IN   LDA
      *
     C           ZSERR     IFEQ 'Y'
      **  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM
     C                     SETON                     U7U8LR
     C                     RETRN
     C                     END
     C**
     C** To get COMPANY Name(in cmpym) :
     C**
     C**
     C                     MOVE *BLANK    @BRCH   3
     C   U1                MOVE CMPYM     @BRCH
     C   U2                MOVE COOB      @BRCH
     C**
     C                     CALL 'AOCOMPR0'
     C                     PARM '*MSG   ' @RTCD   7
     C                     PARM '*KEY   ' @OPTN   7
     C                     PARM @BRCH     @CENB   3
     C           SDCOMP    PARM SDCOMP    DSFDY
     C**
     C           @RTCD     IFNE *BLANKS                    B4
     C                     MOVEL@CENB     DBKEY
     C                     MOVEL'SDCOMPPD'DBFILE           ************
     C                     Z-ADD1         DBASE            * DBASE 01 *
     C                     MOVEL@OPTN     DBOPTN  7        ************
     C                     SETON                     U7U8LR
     C   U8                GOTO END
     C                     END                             E4
     C*
     C                     ELSE                            X3
     C                     SETOF                     10
     C                     END                             E3
     C                     END                             E2
     C**
     C*       IF MBIN='N' AND FIRST CYCLE,
     C*       OPEN LE1121P1
     C**
     C                     ELSE                            X1
     C           P1OP      IFNE 'Y'                        B2
     C                     SETON                     10OF  ALLOW OUTPUTPUT
     C                     SETON                     70    NO DETAILS  PUT
     C                     MOVE 'Y'       P1OP    1
     C                     OPEN LE0749P1
     C                     Z-ADD0         PAGE
     C                     Z-ADD0         PAGE1
     C**
     C*       ENSURE REPORT SPOOL FILE RECORDED BY RCF
     C**
     C                     Z-ADDSFNUM     ZSNUM   60
     C                     OUT  LDA
     C**
     C                     MOVE *BLANK    @BRCH   3
     C   U1                MOVE CMPYM     @BRCH
     C   U2                MOVE COOB      @BRCH
     C**
     C                     CALL 'ZSFILE'
     C                     PARM           SEQ
     C                     PARM @BRCH     SENTY   3
     C                     PARM           SFILE
     C                     PARM           ZSNUM
     C                     PARM           ZSERR   1
     C           *LOCK     IN   LDA
      *
     C           ZSERR     IFEQ 'Y'
      **  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM
     C                     SETON                     U7U8LR
     C                     RETRN
     C                     END
     C**
     C                     END                             E2
     C                     END                             E1
     C**
0296 C**CONTROL OF 'OF' PRINT
     C**
     C                     SETOF                     55
     C                     SETON                     65
     C**
0297 C   45 46             SETOF                     4546
0298 C   OF                SETON                     46
0299 C**  SKIP PROCESSING FOR UN-IDENTIFIED RECORDS
0300 C           TOTREC    ADD  1         TOTREC  50
0301 C  N01N02             GOTO END
0302 C**  IF TRAILER SKIP TO TRAILER CONTROLS
0303 C   02                GOTO TOTRA
     C**
      /SPACE 5
     C**  START PROCESSING DETAIL RECORD
     C/COPY WNCPYSRC,LE0749C001
      /SPACE 3
     C** IF CREDIT LINE TYPE IS 9 (SECURITIES TRADING REL 2)
     C** DO NOT PRINT THE RECORD -
     C*
0382 C*   CONVERT GRANTED/UTILISED AMOUNT TO REPORTING CURRENCY
0383 C**  OBTAIN NO. OF DECIMAL PLACES AND SPOT OF FOREIGN CURRENCY
     C           CRLT      IFEQ '9'
0384 C                     MOVE GUCY      CCY
     C                     CALL 'AOCURRR0'
     C                     PARM '*MSG   ' @RTCD
     C                     PARM '*KEY   ' @OPTN
     C                     PARM CCY       K101                         A
     C           SDCURR    PARM SDCURR    DSSDY                        B
     C           @RTCD     IFNE *BLANKS
     C                     SETON                     U7U8LRNOT FOUND
     C                     MOVE CCY       DBKEY
     C                     MOVE 'SDCURRPD'DBFILE
     C                     Z-ADD9         DBASE            DBASE 9
     C                     GOTO END
     C                     END
0392 C**
     C**  SET UP MDIN INDICATOR FOR FOREIGN CURRENCY                      S01339
     C*                                                                   S01339
     C           MDIN      COMP 'D'                      77               S01339
     C*
0393 C                     Z-ADDGUAM      FCAMT
0394 C                     EXSR CCYUS2
0392 C**
0392 C** ADD CONVERTED AMOUNT TO TOTAL HOLDINGS FIELDS
0393 C                     DIV  1000      USAMT     H
0393 C                     ADD  USAMT     CUSSHT 150
     C                     END
0395 C**
     C                     SETOF                     5470
0304 C**
0305 C***46                SETON                       45                 BHF305
0305 C   46                SETON                     OF45                 BHF305
0306 C*    FORCE L1 ON FOR RETAIL RECORDS
0307 C                     SETOF                     53
0308 C  NL1      CRLT      COMP '1'                      53
0309 C   53                SETON                     L1
0310 C**
0311 C**   ZEROISE FACILITY TOTAL FIELD.
0312 C   L2                Z-ADD0         FCTOT
0313 C**
0314 C**  ACCUMULATE COUNT AND HASH OF DETAIL RECORDS
0315 C                     SETON                     34
0316 C                     Z-ADDTOTWHN    ZZTOTI
0317 C                     Z-ADDTOTDC     ZZTOTD
0318 C                     MOVE GUAM      ZZAMT
0319 C   22                Z-SUBZZAMT     ZZAMT
0320 C                     EXSR GLZADD
0321 C**
0322 C                     Z-ADDZZTOTI    TOTWHN 150
0323 C                     Z-ADDZZTOTD    TOTDC   30
0324 C**  CHANGE OF A/C OFFICER CODE - OBTAIN A/C OFFICER NAME
0325 C   L5                SETON                     OF4546
0326 C   L5 21             MOVE BLANKS    ACON             BLANK A/C OFF.
0327 C   L5 21             GOTO LAB1
     C   L5                CALL 'AOACOFR0'
     C                     PARM '*MSG   ' @RTCD
     C                     PARM '*KEY   ' @OPTN
     C                     PARM ACOC      ACOKEY  2
     C           SDACOF    PARM SDACOF    DSFDY
     C   L5      @RTCD     IFNE *BLANKS
0332 C**
0333 C   L5                SETON                     U7U8LR
0335 C   L5                MOVE 'SDTRADPD'DBFILE           ************
0336 C   L5                Z-ADD4         DBASE            * DBASE 04 *
0337 C   L5                GOTO END                        ************
     C                     END
0338 C**
0339 C           LAB1      TAG                             * LAB1 TAG
0342 C**
0343 C** CHANGE OF PARENT OBTAIN PARENT NAME IF NON-ZERO
0344 C***L4N20**           Z-ADDPARN      CUST    60                                          CSD027
0344 C   L4N20             MOVE PARN      CUST    6                                           CSD027
0345 C   L4N20             EXSR CLNCHN
0346 C**
     C   L4N20   @RTCD     IFNE *BLANKS
     C           @RTCD     ANDNE'*CUSCLS'                                                   MD041994
0347 C   L4N20             SETON                     U7U8LR
0348 C   L4N20             MOVE KEYC      DBKEY
0349 C   L4N20             MOVE 'SDCUSTPD'DBFILE           ************
0350 C   L4N20             Z-ADD5         DBASE            * DBASE 05 *
0351 C   L4N20             GOTO END                        ************
     C                     END
0352 C   L4N20NOF          SETON                     OF4546
0353 C**  SAVE PARENT DETAILS IF RECORD FOUND
0354 C   L4N20             MOVE CRNM      PRNM   20
0355 C   L4N20             MOVE CTWN      PTWN   10
0356 C**
0357 C**   SET ON INDICATOR FOR PRINT SPACING
0358 C**
0359 C**  IF CUST. NO. CHANGE, OBTAIN CUST. DETAILS IF NOT A PARENT
     C***L4N20             MOVELBBCUST    CNUM                            BHF305
0360 C********** CNUM      COMP 999999                   33                                   CSD027
0360 C           CNUM      COMP '999999'                 33                                   CSD027
0361 C   33                GOTO PARENT
0362 C**
0363 C***L3*****           MOVE CNUM      CUST    60                                          CSD027
0363 C   L3                MOVE CNUM      CUST    6                                           CSD027
0364 C   L3                EXSR CLNCHN
0365 C**  CUST. NOT FOUND D/B ERROR
     C   L3      @RTCD     IFNE *BLANKS
     C           @RTCD     ANDNE'*CUSCLS'                                                   MD041994
0366 C   L3                SETON                     U7U8LR
0367 C   L3                MOVE KEYC      DBKEY
0368 C   L3                MOVE 'SDCUSTPD'DBFILE           ************
0369 C   L3                Z-ADD6         DBASE            * DBASE 06 *
0370 C   L3                GOTO END                        ************
     C                     END
     C**
     C   L3NOFN33          SETON                     55
     C**
0372 C   31 32             SETOF                     31
0373 C  N31      GUIN      COMP 'G'                  323231
0374 C   31      GUIN      COMP 'U'                      32
0375 C                     SETOF                     39
     C**  SETON IND TO SUPPRESS O/P OF RETAIL HEADINGS
     C**
     C   31 32             SETON                     54
0376 C**  CONVERT EXPIRY DATE TO DDMMMYY FOR GRANTED RECORDS
0377 C   31N32             Z-ADDEXPD      ZDAYNO
0378 C   31N32             EXSR ZDATE2
0379 C   31N32   EXPD      COMP RUND                   3939EXPIRED
0380 C   31N32 39EXPD      COMP 0                    3939  EXPD=0,NOT EXP
0382 C****CONVERT*AMOUNT*TO*COMM*LOANS*CCY*EQUIV.**********               S01339
     C*                                                                   S01339
     C*   CONVERT AMOUNT TO BASE CURRENCY EQUIVALENT                      S01339
0383 C**  OBTAIN NO. OF DECIMAL PLACES AND SPOT OF FOREIGN CURRENCY
0384 C                     MOVE GUCY      CCY
     C                     CALL 'AOCURRR0'
     C                     PARM '*MSG   ' @RTCD   7
     C                     PARM '*KEY   ' @OPTN   7
     C                     PARM CCY       K101    3                    A
     C           SDCURR    PARM SDCURR    DSSDY                        B
0386 C**
     C           @RTCD     IFNE *BLANK
0387 C                     SETON                     U7U8LR D/B ERROR
     C                     MOVE CCY       DBKEY                           LN0284
0389 C                     MOVE 'SDCURRPD'DBFILE           ************
0390 C                     Z-ADD7         DBASE            * DBASE 07 *
0391 C                     GOTO END                        ************
0392 C                     END
0392 C**                                                                  S01339
0392 C**   SET UP MDIN INDICATOR FOR FOREIGN CURRENCY                     S01339
0392 C**                                                                  S01339
     C           MDIN      COMP 'D'                      77               S01339
0392 C**                                                                  S01339
0393 C                     Z-ADDGUAM      FCAMT
0394 C                     EXSR CCYUS2
0395 C**
0397 C*****CONVERT*TO*'000'S*OF*COMM*LOANS*REPORTING*CCY*************     S01339
0395 C**                                                                  S01339
0395 C**  CONVERT TO '000'S OF BASE CURRENCY EQUIVALENT                   S01339
0395 C**
0398 C           USAMT     DIV  1000      TUSD   130H
0399 C**
0400 C**  ACCUMULATE GRANTED AND UTILISED AMOUNTS FOR CUSTOMER
0401 C   31N32   CUSGRA    ADD  TUSD      CUSGRA 130
0402 C**
0403 C**  SAVE GRANTED AMOUNT FOR REF TYPE
0404 C   31N32   GAMT      ADD  TUSD      GAMT   130
0405 C**
0406 C** ACCUMULATE UTILISED AMOUNT FOR CUSTOMER AND REFERENCE TYPE
0407 C**   DEPENDING ON RECORD SOURCE AND TRANS REF.
0408 C**
0409 C                     SETOF                     4950
     C                     MOVE *BLANKS   LVDAT   7                       MEP062
0410 C           RECS      COMP 'B'                      48
0411 C  N48                GOTO NOTLE
0412 C                     MOVE TRRF      TR2     2
0413 C           TR2       COMP 'SO'                     49
0414 C***49******RCSI      COMP ' '                      50               E26745
0414 C   49      RCSI      COMP 'Y'                  5050                 E26745
0415 C**
0416 C**   REFORMAT TRANS REF.
0417 C**
0418 C                     MOVELTRRF      TR6     6
0419 C  N49                MOVE TR6       TRRF
0420 C   49                MOVE PSLN      TRRF
0421 C                     MOVEL'LE'      TRRF
     C/COPY WNCPYSRC,LE0749C002
0422 C**
     C**  CONVERT VALUE DATE TO DDMMMYY FOR LOANS.                        MEP062
     C                     MOVE ZADATE    EXPIRY  7                       MEP062
     C                     Z-ADDLVDT      ZDAYNO                          MEP062
     C                     EXSR ZDATE2                                    MEP062
     C                     MOVE ZADATE    LVDAT                           MEP062
     C                     MOVE EXPIRY    ZADATE                          MEP062
     C*
0423 C**   ADJUST ACCUMULATORS
0424 C**
0425 C           NOTLE     TAG                             ** NOTLE TAG **
0426 C   32N49   UTCTOT    ADD  TUSD      UTCTOT 130       CUST. TOTAL
0427 C   32N49   UTRTOT    ADD  TUSD      UTRTOT 130       REF.TYPE TOTAL
0428 C**
0429 C   32 50   UTCTOT    SUB  TUSD      UTCTOT
0430 C   32 50   UTRTOT    SUB  TUSD      UTRTOT
0431 C**
0432 C**  TEST FOR CREDIT LINE TYPE
0433 C           CRLT      COMP '1'                      35
0434 C           CRLT      COMP '2'                      36
0435 C***********CRLT      COMP '3'                      37               S01339
0436 C           CRLT      COMP '4'                      38
0437 C           CRLT      COMP '5'                      47
0438 C           CRLT      COMP '6'                      52
0438 C           CRLT      COMP '7'                      56
0439 C**
0440 C**   PRINT SPACING UNNECESSARY ON FIRST UTILISATION RECORD.
0441 C   53 31 32          SETOF                     53
0442 C**
0443 C**  END OF PROCESSING FOR LONER/CHILD REPORTING
0444 C                     GOTO END
0445 C**
0447 C**  PARENT PROCESSING/REPORTING
0448 C**
0449 C           PARENT    TAG                             * PARENT TAG
0450 C                     SETOF                     3132
0451 C**
0452 C**  SUMMARY REPORTING FOR CREDIT LINE TYPES 1,3,4,5
0453 C   L2      CRLT      COMP '1'                      35
0454 C   L2      CRLT      COMP '2'                      36
0455 C***L2******CRLT      COMP '3'                      37               S01339
0456 C   L2      CRLT      COMP '4'                      38
0457 C   L2      CRLT      COMP '5'                      47
0458 C   L2      CRLT      COMP '6'                      52
0458 C   L2      CRLT      COMP '7'                      56
0459 C**
0460 C**   FACILITIES RELATING TO PARENTS - CHECK GRANTED/UTILIZED
0461 C**
0462 C  N23
0463 CORN52                GOTO NOTLEF
0464 C**
0465 C   61 62             SETOF                     61
0466 C  N61      GUIN      COMP 'G'                  626261
0467 C   61      GUIN      COMP 'U'                      62
0468 C**
0469 C                     SETOF                     39
0470 C**   CONVERT EXPIRY DATE TO MMDDDYY FOR GRANTED RECORDS
0471 C   61N62             Z-ADDEXPD      ZDAYNO
0472 C   61N62             EXSR ZDATE2
0473 C   61N62   EXPD      COMP RUND                   3939
0474 C   61N62 39EXPD      COMP 0                    3939
0475 C**
0476 C           NOTLEF    TAG                             ** NOTLEF TAG *
0477 C**
0478 C**  FACILITY DETAILS -PRINT GRANTED LINE SUMMARISE UTILISED DETAILS
0479 C           GUIN      COMP 'G'                      31
0480 C**
0481 C**   CHECK FOR GRANTED DETAILS IF CRLT ='2'
0482 C** L2N36N35
0483 C**
0488 C*
0485 C****CONVERT*AMOUNT*TO*COMM*LOANS*CCY*FROM*FOREIGN*CCY***            S01339
0488 C*                                                                   S01339
0485 C**  CONVERT AMOUNT TO BASE CURRENCY FROM FOREIGN CURRENCY           S01339
0488 C*
0486 C                     MOVE GUCY      CCY
0488 C*
     C                     CALL 'AOCURRR0'
     C                     PARM '*MSG   ' @RTCD   7
     C                     PARM '*KEY   ' @OPTN   7
     C                     PARM CCY       K101    3                    A
     C           SDCURR    PARM SDCURR    DSSDY                        B
0386 C**
     C           @RTCD     IFNE *BLANK
0489 C                     SETON                     U7U8LR
     C                     MOVE CCY       DBKEY                           LN0284
0491 C                     MOVE 'SDCURRPD'DBFILE           ************
0492 C                     Z-ADD8         DBASE            * DBASE 08 *
0493 C                     GOTO END                        ************
0494 C                     END
0494 C*
0392 C**   SET UP MDIN INDICATOR FOR FOREIGN CURRENCY                     S01339
0392 C**                                                                  S01339
     C           MDIN      COMP 'D'                      77               S01339
0392 C**                                                                  S01339
0495 C                     Z-ADDGUAM      FCAMT
0496 C                     EXSR CCYUS2
0497 C**   CHECK FOR PART SOLD AND ADJUST ACCUMULATOR
0498 C**
0499 C                     SETOF                     4950
0500 C           RECS      COMP 'B'                      48
0501 C  N48                GOTO NOTLEP
0502 C                     MOVE TRRF      TR2     2
0503 C           TR2       COMP 'SO'                     49
0504 C***49******RCSI      COMP ' '                      50               E26745
0504 C   49      RCSI      COMP 'Y'                  5050                 E26745
0505 C**
0506 C**   REFORMAT TRANS REF.
0507 C**
0508 C                     MOVELTRRF      TR6     6
0509 C  N49                MOVE TR6       TRRF
0510 C   49                MOVE PSLN      TRRF
0511 C                     MOVEL'LE'      TRRF
     C/COPY WNCPYSRC,LE0749C003
0512 C**
0513 C           NOTLEP    TAG                             ** NOTLEP TAG *
0514 C**
0515 C           USAMT     DIV  1000      TUSD      H
0516 C   31N36   PGTOT     ADD  TUSD      PGTOT  130
0517 C   31 36   FCTOT     ADD  TUSD      FCTOT  130
0518 C  N31N49   PUTOT     ADD  TUSD      PUTOT  130
0519 C  N31 50   PUTOT     SUB  TUSD      PUTOT
0520 C**
0521 C**  ACCUMULATE GRANTED AND UTILISED AMOUNTS FOR A PARENT
0522 C   31      PARGT     ADD  TUSD      PARGT  130
0523 C  N31N49   PARUT     ADD  TUSD      PARUT  130
0524 C  N31 50   PARUT     SUB  TUSD      PARUT
0525 C**
0526 C**  CREDIT LINE TYPE 2 CONVERT GRANTED AMOUNT TO '000'S USD
0527 C**
0528 C                     GOTO END
0530 C**  ACCUMULATE TRAILER CONTROLS
0531 C           TOTRA     TAG                             * TOTRA TAG
0532 C                     SETOF                     32
0533 C  N34N51             SETON                     OF4551
0534 C**
     C                     SETOF                     525361
     C                     SETOF                     62
     C**
0535 C***********TNORE     ADD  NORE      TNORE   50                      091807
0536 C***********          Z-ADDTHRWN     ZZTOTI                          091807
0537 C***********          Z-ADDTHRDC     ZZTOTD                          091807
0538 C***********          Z-ADDHRWN      ZZAMTI                          091807
0539 C***********          Z-ADDHRDC      ZZAMTD                          091807
0540 C***********          EXSR GLZSUM                                    091807
0541 C***********                                                         091807
0542 C***********          Z-ADDZZTOTI    THRWN  150                      091807
0543 C***********          Z-ADDZZTOTD    THRDC   30                      091807
0544 C**
0545 C           END       TAG                             * END TAG
0546 C*****************
0547 C**  ********   TOTAL TIME CALCULATIONS   ********
0547 CL1                   SETOF                     65
0547 C**
0548 C**  TOTAL TIME CALCULATIONS FOR REFERENCE TYPE CHANGE - L1
0549 C**  WORK OUT IF UTILISED AMOUNT HAS EXCEEDED THE AMOUNT GRANTED
0550 CL1         UTRTOT    SUB  GAMT      EXDAMT 130 40
0551 C**
0552 C**  ZEROISE TOTAL FIELDS
0553 CL1                   Z-ADD0         UTRTOT
0554 CL1                   Z-ADD0         GAMT
0555 C**
0556 C**  CHANGE OF CREDIT LINE TYPE - WORK OUT EXCEEDED AMOUNT
0557 CL2 33N36   PUTOT     SUB  PGTOT     PETOT  130 42
0558 CL2 33 36   PUTOT     SUB  FCTOT     PETOT      42
0559 C**
0560 C**  TOTAL TIME CALCULATIONS FOR CUSTOMER NO. CHANGE - L3
0561 C**  WORK OUT CUSTOMERS EXCEEDED AMOUNT
0562 CL3N33      UTCTOT    SUB  CUSGRA    CEXAMT 130 41
0559 C**
0397 C*    ROUND TOTAL SECURITY HOLDINGS TO NEAREST 1000
0397 C*    REVERSE SIGN
0397 C*    SET INDICATOR TO PRINT ONLY IF GREATER THAN ZERO
     CL3                   ADD  CUSSHT    PARSHT 150
     CL3                   SETOF                     58
     CL3         CUSSHT    MULT -1        CUSSHT
     CL3         CUSSHT    COMP 0                    5858
0563 C**
0564 C**   WORK OUT EXCEEDED PARENT AMOUNT
0565 CL4 33      PARUT     SUB  PARGT     PARET  130 44
0566 C**
0559 C**
0397 C*    ROUND TOTAL SECURITY HOLDINGS TO NEAREST 1000
0397 C*    REVERSE SIGN
0397 C*    SET INDICATOR TO PRINT ONLY IF GREATER THAN ZERO
     CL4 33                SETOF                     59
     CL4 33      PARSHT    MULT -1        PARSHT
     CL4 33      PARSHT    COMP 0                    5959
0567 C**
0568 C**  LR CALCULATIONS - FILE BALANCE CHECK
0569 C**
     C**
     C*       IF MBIN='Y' AND BRNCH=A PARTICULAR BRANCH NAME
     C*       NO CHECKING ON THE CONTROL TOTAL
     C**
     C*       ENSURE AUDIT SPOOL FILE RECORDED BY RCF
     C**
     CLR                   Z-ADDSFNUMU    ZSNUMU  60
     CLR                   OUT  LDA
     C**
     CLR                   CALL 'ZSFILE'
     CLR                   PARM           SEQ
     CLR                   PARM @BRCH     SENTY   3
     CLR                   PARM           SFILEU
     CLR                   PARM           ZSNUMU
     CLR                   PARM           ZSERR   1
     CLR         *LOCK     IN   LDA
      *
     CLR         ZSERR     IFEQ 'Y'
      **  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM
     CLR                   SETON                     U7U8LR
     CLR                   RETRN
     CLR                   END
     C**
     C*R*********MBIN      IFEQ 'N'                                       091807
     C*R*********MBIN      OREQ 'Y'                                       091807
     C*R*********BRNCH     ANDEQ'ALL'                                     091807
0570 C*RNU8******TOTREC    COMP TNORE                U8U8                 091807
0571 C*RNU8******TOTWHN    COMP THRWN                U8U8                 091807
0572 C*RNU8******TOTDC     COMP THRDC                U8U8                 091807
     C*R*********          END                                            091807
     C**
     C**    WHEN LR INDICATOR SET ON WITHOUT EXECUTING THE FIRST
     C**    CYCLE
     C**
     CLR         P1OP      IFNE 'Y'
     CLR                   EXSR #ZZ
     CLR                   END
0573 CLR U7                MOVE 'LE0749'  DBPGM
     CLR U7 U8             EXSR *PSSR
0574 C**
0575 C********************************************************************
     C/SPACE 3
0575 C********************************************************************
0576 C**  CLNCHN SUBR. TO RANDOM ACCESS CLINT FILE
0577 CSR         CLNCHN    BEGSR                           **   CLNCHN
0578 C*
     C                     MOVELCUST      KEYC
     C                     CALL 'AOCUSTR0'
     C                     PARM '*MSG   ' @RTCD
     C                     PARM '*KEY   ' @OPTN
     C                     PARM           KEYC   10
     C                     PARM           KEYSTS  7
     C           SDCUST    PARM SDCUST    DSSDY
0581 C*
0582 C                     ENDSR
0581 C*
0584 C********************************************************************
0596 C/SPACE 3
0597 C********************************************************************
0598 C* SUBROUTINE TO ADD AN AMOUNT (ZZAMT) TO THE TOTAL (ZZTOTI,ZZTOTD)
0599 C*   IND '99' IS SET BY AN OVERFLOW ERROR
0600 C*
0601 CSR         GLZADD    BEGSR                           *** GLZADD ****
0602 C*
0603 CSR                   Z-ADDZZAMT     ZZAMT  153     91-DEFINE ZZAMT
0604 CSR 91                GOTO ZZAEND                     AMT = 0.BYPASS
0605 C*
0606 C* SPLIT ZZAMT INTO INTEGER AND DECIMAL FIELDS
0607 CSR                   Z-ADDZZAMT     ZZAMTI 150       INTEGER FIELD
0608 CSR                   MOVE ZZAMT     ZZAMTD  30       DECIMAL FIELD
0609 C* BOTH ZZAMTI AND ZZAMTD CONTAIN A 'SIGN' ZONE NOW
0610 C*
0611 CSR                   EXSR GLZSUM
0612 CSR         ZZAEND    ENDSR                           ** ZZAEND TAG *
0613 C*
0614 C********************************************************************
     C/SPACE 3
0615 C********************************************************************
0616 C* SUBROUTINE TO CARRY OUT THE ADDITION FOR SUBROUTINES -
0617 C*                        GLZADD, GLZSUB, GLZCMP.
0618 C*          PARAMETERS PASSED -
0619 C*                     I/P ZZAMTI ZZAMTD
0620 C*                     O/P ZZTOTI ZZTOTD ZZNEGD IND 96 IND 99.
0621 C*
0622 CSR         GLZSUM    BEGSR                           *** GLZSUM ****
0623 C*
0624 CSR                   Z-ADDZZTOTI    ZZTOTI 150       DEFINE ZZTOTI
0625 CSR                   Z-ADDZZTOTD    ZZTOTD  30       DEFINE ZZTOTD
0626 CSR                   SETOF                     919293
0627 CSR                   SETOF                     949599
0628 C*
0629 C*    DETERMINE SIGN OF ZZAMTI & D,   92 IF NEG
0630 CSR         ZZAMTI    COMP 0                      9293
0631 CSR 93      ZZAMTD    COMP 0                      9293
0632 CSR 93                GOTO ZZSEND                     ZERO BYPASS
0633 C*
0634 C*    DETERMINE SIGN OF ZZTOTI & D, 91 IF NEG.
0635 CSR         ZZTOTI    COMP 0                      9193
0636 CSR 93      ZZTOTD    COMP 0                      9193
0637 C*
0638 C*    IF ZZTOTAL IS ZERO, RETURN ZZAMOUNT.
0639 CSR 93                Z-ADDZZAMTI    ZZTOTI
0640 CSR 93                Z-ADDZZAMTD    ZZTOTD
0641 CSR 93                GOTO ZZSEND                     ZERO BYPASS
0642 C*    IF SIGNS DIFFER BYPASS OVERFLOW CHECKS.
0643 CSR 91N92
0644 CORN91 92             GOTO ZZOFPS
0645 C*
0646 CSR         ZZAMTD    ADD  ZZTOTD    ZZWK2   40
0647 CSR         ZZWK2     COMP 999                  93    '93' = CARRY
0648 CSRN93      ZZWK2     COMP -999                   93    INTO INTEGER.
0649 C*
0650 CSR 93N92   ZZAMTI    ADD  1         ZZWK3  150       ADD 'CARRY' +VE
0651 CSR    93 92ZZAMTI    SUB  1         ZZWK3            SUB 'CARRY' -VE
0652 CSR 93      ZZTOTI    ADD  ZZWK3     ZZWK3
0653 CSRN93      ZZTOTI    ADD  ZZAMTI    ZZWK3
0654 C*
0655 C* IF THE MODULUS OF ZZWK3 IS LT MOD. ZZTOTI THEN O/F HAS OCCURED
0656 CSRN92      ZZWK3     COMP ZZTOTI                 99  -92 MEANS NOS.
0657 CSR 92      ZZWK3     COMP ZZTOTI               99     NEGATIVE
0658 CSRN99                Z-ADDZZWK2     ZZTOTD
0659 CSRN99                Z-ADDZZWK3     ZZTOTI
0660 C*
0661 C* IF O/F ZEROIZE ZZAMT , IND '99' SET AND ZZTOT FIELDS LEFT INTACT.
0662 CSR 99                Z-ADD0         ZZAMT  153
0663 CSR                   GOTO ZZSEND
0664 C*
0665 C* THE 'SIGNS' ARE DIFFERENT
0666 CSR         ZZOFPS    TAG                             ** ZZOFPS TAG**
0667 C* IF ZZAMT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZTOT
0668 C*
0669 CSR 92                Z-SUBZZAMTI    ZZAMTI 150
0670 CSR 92                Z-SUBZZAMTD    ZZAMTD  30
0671 C*
0672 C* IF ZZTOT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZAMT.
0673 C*
0674 CSR 91                Z-SUBZZTOTI    ZZTOTI
0675 CSR 91                Z-SUBZZTOTD    ZZTOTD
0676 C* BOTH ZZAMT AND ZZTOT ARE NOW POSITIVE.
0677 C*
0678 CSR         ZZTOTI    COMP ZZAMTI               93  95
0679 CSR 95      ZZTOTD    COMP ZZAMTD               93  95
0680 C*
0681 C* IF ZZTOT EQ. ZZAMT RETURN ZERO.
0682 CSR 95                Z-ADD0         ZZTOTI
0683 CSR 95                Z-ADD0         ZZTOTD
0684 CSR 95                GOTO ZZSEND
0685 C*
0686 C* IF ZZTOT GT. ZZAMT.
0687 CSR 93      ZZAMTD    COMP ZZTOTD               94
0688 CSR 93 94   ZZTOTI    SUB  1         ZZTOTI
0689 CSR 93 94   ZZTOTD    ADD  1000      ZZWK2
0690 CSR 93      ZZTOTI    SUB  ZZAMTI    ZZTOTI
0691 CSR 93 94   ZZWK2     SUB  ZZAMTD    ZZTOTD
0692 CSR 93N94   ZZTOTD    SUB  ZZAMTD    ZZTOTD
0693 C*
0694 C*
0695 C* IF ZZAMT GT. ZZTOT.
0696 CSRN93      ZZTOTD    COMP ZZAMTD               94
0697 CSRN93 94   ZZAMTI    SUB  1         ZZWK3  150
0698 CSRN93 94   ZZAMTD    ADD  1000      ZZWK2
0699 CSRN93 94   ZZWK3     SUB  ZZTOTI    ZZTOTI
0700 CSRN93N94   ZZAMTI    SUB  ZZTOTI    ZZTOTI
0701 CSRN93 94   ZZWK2     SUB  ZZTOTD    ZZTOTD
0702 CSRN93N94   ZZAMTD    SUB  ZZTOTD    ZZTOTD
0703 C*
0704 C* REVERSE SIGN OF ZZTOT IF LARGER I/P FIELDS WERE NEGATIVE
0705 CSR                   SETOF                     94
0706 CSR 93 91
0707 CORN93 92             SETON                     94
0708 CSR 94                Z-SUBZZTOTI    ZZTOTI
0709 CSR 94                Z-SUBZZTOTD    ZZTOTD
0710 C**
0711 C**   RESTORE SIGN OF ZZAMTI & ZZAMTD IF IT WAS REVERSED.
0712 CSR 92                Z-SUBZZAMTI    ZZAMTI
0713 CSR 92                Z-SUBZZAMTD    ZZAMTD
0714 CSR         ZZSEND    TAG                             ** ZZSEND TAG *
0715 C**
0716 C**   IF ZZTOTD IS ZERO, AND ZZTOTI IS NEG. SET UP ZZNEGD.
0717 CSR                   SETOF                     96
0718 CSR         ZZTOTD    COMP 0                        91
0719 CSR 91      ZZTOTI    COMP 0                      96
0720 CSR 96                MOVE '.000-'   ZZNEGD  5
0721 CSR                   ENDSR                             ** ENDSR **
0722 C********************************************************************
     C/SPACE 3
0723 C********************************************************************
0724 C***********                                                         S01339
0726 C*****SR.*TO OBTAIN COMM LOANS CCY EQUIV. OF FOREIGN CURRENCY        S01339
0727 C***********                                                         S01339
0728 C*****PARAMETERS. I/P - FCAMT - THE AMOUNT IN FOREIGN CURRENCY       S01339
0730 C***********      I/P - CLRC - COMM LOANS REPORTING CCY              S01339
0732 C***********      I/P - USSPOT - SPOT RATE FOR COMM LOANS CCY        S01339
0734 C***********      O/P - USAMT - THE AMOUNT IN COMM LOANS CCY         S01339
0735 C**                                                                  S01339
0726 C*    SR. TO CONVERT AMOUNT INTO BASE CURRENCY                       S01339
0727 C*                                                                   S01339
0728 C**   PARAMETERS. I/P - FCAMT - THE AMOUNT IN FOREIGN CURRENCY       S01339
0732 C*                I/P - USSPOT - SPOT RATE FOR COMM LOANS CCY        S01339
     C*                I/P - SPOT - FOREIGN CURRENCY SPOT RATE            S01339
     C*                I/P - CDPT - FOREIGN CURRENCY DECIMAL PLACES       S01339
     C*                I/P - *IN76- M/DIV IND=0 FOR BASE CCY IF ON        S01339
     C*                I/P - *IN77- M/DIV IND=0 FOR FOREIGN CCY IF ON     S01339
0734 C*                O/P - USAMT - THE AMOUNT IN BASE CURRENCY          S01339
0736 C*
0737 C           CCYUS2    BEGSR                           *** CCYUS2  ***
0738 C*
0739 C*    TO DEFINE INPUT FIELDS
0740 C                     Z-ADDFCAMT     FCAMT  150
0741 C                     Z-ADDUSSPOT    USSPOT 138
0742 C*
0744 C*****BY-PASS*IF*AMOUNT*ALREADY*IN*COMM*LOANS*CCY****                S01339
0745 C***********CCY       COMP CLRC                     97               S01339
0746 C***97******          Z-ADDFCAMT     USDOL                           S01339
0749 C***97******          GOTO ENDUS                                     S01339
0749 C***********                                                         S01339
0750 C*****CONVERT*TO*COMM*LOANS*EQUIV.****                               S01339
0749 C***********                                                         S01339
0750 C*    CONVERT TO BASE CURRENCY EQUIVALENT.                           S01339
0751 C   76 77
0752 CORN76N77   SPOT      DIV  USSPOT    DIVD   159H
0753 C   76N77
0754 CORN76 77   SPOT      MULT USSPOT    DIVD      H
0755 C  N77      FCAMT     MULT DIVD      USDOL  150H
0756 C   77      FCAMT     DIV  DIVD      USDOL     H
0757 C*
0758 C***********ENDUS     TAG                             * ENDUS TAG
0759 C*    CONVERT FOR NO. OF DEC. POSITIONS
0760 C           CDP       COMP 1                      9495
0761 C           CDP       COMP 2                    97  96
0762 C   94                Z-ADDUSDOL     USAMT  130
0763 C   95      USDOL     DIV  10        USAMT     H
0764 C   96      USDOL     DIV  100       USAMT     H
0765 C   97      USDOL     DIV  1000      USAMT     H
0766 C*
0767 C                     ENDSR
0768 C*
0769 C********************************************************************
     C/SPACE 3
     C********************************************************************
     C*
     C* SUBROUTINE : #ZZ
     C*
     C* CALLED BY MAIN PROCESSING DURING TOTAL TIME CALCULATIONS IF
     C* THE P1 FILES HAVE NOT ALREADY BEEN OPENED (IE, IF THERE ARE
     C* NO RECORDS READ AND THEREFORE FILES OPENING NOT PERFORMED)
     C*
     C           #ZZ       BEGSR
     C*
     C** OPEN P1 SPOOL FILE
     C*
     C                     OPEN LE0749P1
     C                     SETON                     1034
     C*
     C** IF REPORT FOR ALL ENTITIES CALL ZSFILE WITH BLANK SENTY
     C*
     C           BRNCH     IFEQ 'ALL'                      B1
     C           MBIN      ORNE 'Y'
     C*
     C** ENSURE REPORT SPOOL FILE RECORDED BY RCF
     C*
     C**
     C                     Z-ADDSFNUM     ZSNUM   60
     C                     OUT  LDA
     C*
     C                     CALL 'ZSFILE'
     C                     PARM           SEQ
     C                     PARM *BLANKS   SENTY   3
     C                     PARM           SFILE
     C                     PARM           ZSNUM
     C                     PARM           ZSERR   1
     C           *LOCK     IN   LDA
     C*
     C           ZSERR     IFEQ 'Y'
      **  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM
     C                     SETON                     U7U8LR
     C                     RETRN
     C                     END
     C*
     C   U1                MOVE 'ALL'     CMPYM
     C   U2                MOVE 'ALL'     COOB
     C                     MOVE *BLANKS   CMNM
     C*
     C** ELSE REPORT BY ENTITY SO CALL ZSFILE WITH ENTITY REQUESTED
     C*
     C                     ELSE                            X1
     C*
     C** ENSURE REPORT SPOOL FILE RECORDED BY RCF
     C*
     C**
     C                     Z-ADDSFNUM     ZSNUM   60
     C                     OUT  LDA
     C                     CALL 'ZSFILE'
     C                     PARM           SEQ
     C                     PARM BRNCH     SENTY   3
     C                     PARM           SFILE
     C                     PARM           ZSNUM
     C                     PARM           ZSERR
     C           *LOCK     IN   LDA
     C*
     C           ZSERR     IFEQ 'Y'
      **  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM
     C                     SETON                     U7U8LR
     C                     RETRN
     C                     END
     C*
     C   U1                MOVE BRNCH     CMPYM
     C   U2                MOVE BRNCH     COOB
     C*
     C** AND GET ENTITY DETAILS FOR REPORT HEADINGS WHEN MULTIBRANCHING
     C*
     C           MBIN      IFEQ 'Y'
     C**
     C                     CALL 'AOCOMPR0'
     C                     PARM '*MSG   ' @RTCD   7
     C                     PARM '*KEY   ' @OPTN   7
     C                     PARM BRNCH     @CENB   3
     C           SDCOMP    PARM SDCOMP    DSFDY
     C*
     C           @RTCD     IFNE *BLANKS
     C                     MOVEL@CENB     DBKEY
     C                     MOVEL'SDCOMPPD'DBFILE           ************
     C                     Z-ADD11        DBASE            * DBASE 11 *
     C                     MOVEL@OPTN     DBOPTN  7        ************
     C                     SETON                     U7U8
     C                     EXSR *PSSR
     C                     GOTO #ZZ9
     C                     END
     C                     END
     C*
     C                     END                             E1
     C*
     C** OUTPUT 'NO DETAILS TO REPORT' IN P1
     C*
     C                     SETON                     70
     C*
     C           #ZZ9      ENDSR
     C*
     C**
     C********************************************************************
     C/SPACE 3
     C********************************************************************
     C*
     C*  *PSSR --- SUBROUTINE TO HANDLE ABNORMAL ERROR CONDITIONS
     C*
     C*  CALLED FROM: AFTER ABNORMAL OPERATION OCCURS
     C*
     C*  CALLS: NOTHING
     C*
     C********************************************************************
     C*
     C           *PSSR     BEGSR                           ** *PSSR **
     C*
     C           @RUN      IFEQ *BLANKS
     C                     MOVE 'Y'       @RUN    1
     C                     DUMP
     C                     END
     C                     ENDSR                           ** *PSSR **
     C*
     C********************************************************************
     C/COPY ZSRSRC,ZDATE2Z4                                               S01392
     C********************************************************************S01392
     C/EJECT
     C/COPY WNCPYSRC,LE0749C004
     OLE0749P1H  201   OF 45 10
     O       AND      N70
     O       OR        OF 55 65
     O       AND       10N70
0861 O                                   24 'REFERENCE LE0749P1'
0862 O                         TITL      89
0863 O                                  104 'DATE'
0864 O                         RUNA     112
0865 O                                  122 'PAGE'
0866 O                         PAGE  3  127
0867 O        H  1     OF 45 10
     O       AND      N70
     O       OR        OF 55 65
     O       AND       10N70
0868 O                                   67 'LENDING PORTFOLIO BY CUS'
0869 O                                   80 'TOMER - 000''S'
0870 O***********         57   CLRC      84                               S01339
     O***********        N57   USCY      84                               S01339
     O                         BCCY      84                               S01339
0875 O                    75             93 'COMPANY'
     O                 U1 75   CMPYM     98
     O                 U2 75   COOB      98
     O                    75NU7         101 ' - '
     O                    75NU7CMNM     131
0871 O        H  2     OF 45 10
     O       AND      N70
     O       OR        OF 55 65
     O       AND       10N70
0872 O                                   67 '------------------------'
0873 O                                   84 '-----------------'
0871 O        H  2     OF 45 10
     O       AND      N70
     O       OR        OF 55 65
     O       AND       10N70
     O                 U1                25 'BY COMPANY OF BOOKING '
     O                 U1              +  0 'BRANCH'
     O                 U2                28 'BY COMPANY OF ORIGINATIN'
     O                 U2              +  0 'G BRANCH'
0874 O        H  2     OF 45 10
     O       AND      N70
     O       OR        OF 55 65
     O       AND       10N70
0877 O                                   17 'A/C OFFICER'
0878 O                         ACON      49
0879 O        H  1     OF 45N20
0880 O       AND       34 10N70
0881 O                                    7 'PARENT'
0882 O                         PARN      14
0883 O                      NL4          23 '-CONT''D'
0884 O        H  1     OF 45N20
0885 O       AND       34 10N70
0886 O                                    7 '------'
0887 O        H  2     OF 45 10
0880 O       AND      N70
0888 O                    34N20PRNM      21
0889 O                    34N20PTWN      33
0890 O        H  1     OF 45 10
     O       AND      N70
     O       OR        OF 55 65
     O       AND       10N70
     O                                   39 '--'
0891 O                                   63 '- CREDIT LINES GRANTED -'
0892 O                                   87 '--- ---------------- UTI'
0893 O                                  109 'LISED ----------------'
0894 O        H  1     OF 45 10
     O       AND      N70
     O       OR        OF 55 65
     O       AND       10N70
0895 O                                    9 'CUSTOMER'
     O                                   29 'TYPE'
     O                    74 U1          36 'ORG'
     O                       U2          35 'BK'
     O                                   41 'BR.'
     O                                   53 'CCY       AMOUNT'
0897 O***********************************84 'EXPIRY  TRANS   TYPE/ CC'                        CLE042
     O***********************************92 'Y BRANCH'                                        CLE042
     O**********************************104 'AMOUNT'                                          CLE042
     O                                   79 'EXPIRY  TRANS'                                   CLE042
     O                                   85 'TYPE/'                                           CLE042
     O                                   95 'CCY'                                             CLE042
     O                                   99 'BRN'                                             CLE042
     O                                  110 'AMOUNT'                                          CLE042
0899 O                                  132 'EXCEEDED   EXPD'
0900 O        H  1     OF 45 10
     O       AND      N70
     O       OR        OF 55 65
     O       AND       10N70
     O                    74 U1          35 'BR'
     O                       U2          35 'BR'
0901 O***********************************80 'SUB'                                             CLE042
     O**********************************123 'DATE'                                     MEP062 CLE042
     O                                   84 'SUB'                                             CLE042
     O                                  132 'DATE'                                            CLE042
0902 O        H  1     OFN33 45
0903 O       AND       34 10N70
     O       OR        55 10N70
0905 O                         CNUM       7
0906 O                    OFNL3          16 '-CONT''D'
0907 O        H  1     OFN33 45
0908 O       AND       34 10N70
     O       OR        55 10N70
0910 O                         CRNM      21
0911 O                         CTWN      33
0912 O**
0913 O        DF 0     L4 10
0914 O        DF 0     45NL4 10
0915 O        DF10     35 53N33
     O       AND       10
0916 O        DF 0     01 L1N33
     O       AND       10NU7
     O                   N54 35          25 'RET'
     O                       36          25 'FAC'
     O***********            37          25 'COM'                         S01339
     O                       38          25 'LIM'
     O                       47          25 'GTE'
     O                       52          25 'FCL'
     O                       56          25 'LC '
     O**********         N35   REFT      32                                                   CGL029
     O                   N35   REFT      38                                                   CGL029
0929 O**
0924 O**  GRANTED LINE FROM GRANTED DETAILS
0929 O**
     O**********          U1 74ORBR      36                                                   CGL029
     O**********          U2   BRCA      36                                                   CGL029
0925 O**********          31N32GUCY      40                                                   CGL029
0926 O**********          31N32TUSD  K   58                                                   CGL029
0927 O**********          31N32ZADATE    66                                                   CGL029
     O                    U1 74ORBR      42                                                   CGL029
     O                    U2   BRCA      42                                                   CGL029
0925 O                    31N32GUCY      46                                                   CGL029
0926 O                    31N32TUSD  K   64                                                   CGL029
0927 O                    31N32ZADATE    72                                                   CGL029
0928 O                 31N32 39         132 '***'
0929 O**
0930 O**  UTILISED LINE IF NO GRANTED DETAILS
0929 O**
0931 O**********          32N31TRRF      75                                                   CGL029
0932 O**********          32N31LTST      81                                                   CGL029
0933 O**********          32N31GUCY      85                                                   CGL029
     O**********          32N31LBRA      90                                                   CGL029
0934 O**********          32N31TUSD  K  108                                                   CGL029
     O**********       32N31 50         109 '-'                                               CGL029
     O**********          32N31LVDAT    124                                            MEP062 CGL029
0931 O                    32N31TRRF      81                                                   CGL029
0932 O                    32N31LTST      87                                                   CGL029
     O                    32N31CLAS      91                                                   CLE042
0933 O********************32N31GUCY      91                                            CGL029 CLE042
     O********************32N31LBRA      96                                            CGL029 CLE042
     O                    32N31GUCY      95                                                   CLE042
0934 O                    32N31TUSD  K  114                                                   CGL029
     O                    32N31LBRA      99                                                   CLE042
     O                 32N31 50         115 '-'                                               CGL029
     O                    32N31LVDAT    130                                                   CGL029
0935 O**
0936 O**  PRINT FIRST UTILISED LINE AFTER GRANTED LINE
0935 O**
0937 O        D  0     01 31 32
     O       AND       10
0938 O**********               TRRF      75                                                   CGL029
0939 O**********               LTST      81                                                   CGL029
0940 O**********               GUCY      85                                                   CGL029
     O**********               LBRA      90                                                   CGL029
0941 O**********               TUSD  K  108                                                   CGL029
     O**********             50         109 '-'                                               CGL029
0938 O                         TRRF      81                                                   CGL029
0939 O                         LTST      87                                                   CGL029
     O                         CLAS      91                                                   CLE042
0940 O*************************GUCY      92                                            CGL029 CLE042
     O*************************LBRA      96                                            CGL029 CLE042
     O                         GUCY      95                                                   CLE042
0941 O                         TUSD  K  114                                                   CGL029
     O                         LBRA      99                                                   CLE042
     O                       50         115 '-'                                               CGL029
0942 O**
0943 O**  PRINT UTILISED DETAILS IF MORE THAN ONE UTILISED LINE
0942 O**
0944 O        D 10     32N31NL1
     O       AND       10
0945 O**********               TRRF      75                                                   CGL029
0946 O**********               LTST      81                                                   CGL029
0947 O**********               GUCY      85                                                   CGL029
     O**********               LBRA      90                                                   CGL029
0948 O**********               TUSD  K  108                                                   CGL029
     O**********             50         109 '-'                                               CGL029
0945 O                         TRRF      81                                                   CGL029
0946 O                         LTST      87                                                   CGL029
     O                         CLAS      91                                                   CLE042
0947 O*************************GUCY      92                                            CGL029 CLE042
     O*************************LBRA      96                                            CGL029 CLE042
     O                         GUCY      95                                                   CLE042
0948 O                         TUSD  K  114                                                   CGL029
     O                         LBRA      99                                                   CLE042
     O                       50         115 '-'                                               CGL029
0959 O**
0949 O**  PARENT'S DETAIL REPORTING
0959 O**
0950 O        D 11     33 L3 10
0951 O       OR        33 OFNL3
     O       AND       10
0952 O                         PARN       7
0953 O                                   27 '*** PARENT ***'
0954 O                    OFNL3          37 '-CONT"D'
0955 O        D  0     33 L3 10
0956 O       OR        33 OFNL3
     O       AND       10
0957 O                         PRNM      21
0958 O                         PTWN      33
0959 O**
0960 O**  PARENT'S FACILITY CREDIT LINE TYPE
0961 O**
0963 O        D 1      33 52 31
0964 O       AND       23 10
0965 O                                   23 'FCL'
0966 O**********               REFT      32                                                   CGL029
0967 O**********               GUCY      40                                                   CGL029
0968 O**********               TUSD  K   58                                                   CGL029
0969 O**********               ZADATE    66                                                   CGL029
0966 O                         REFT      38                                                   CGL029
0967 O                         GUCY      46                                                   CGL029
0968 O                         TUSD  K   54                                                   CGL029
0969 O                         ZADATE    72                                                   CGL029
0970 O                       39         132 '***'
0971 O**
0971 O**   PRINT FIRST UTILISED LINE AFTER GRANTED LINE
0971 O**
0972 O        D  0     23 61 62
     O       AND       33 52 10
0974 O**********               TRRF      75                                                   CGL029
0975 O**********               LTST      81                                                   CGL029
0976 O**********               GUCY      85                                                   CGL029
     O**********               LBRA      90                                                   CGL029
0977 O**********               TUSD  K  108                                                   CGL029
     O**********             50         109 '-'                                               CGL029
0974 O                         TRRF      81                                                   CGL029
0975 O                         LTST      87                                                   CGL029
     O                         CLAS      91                                                   CLE042
0976 O*************************GUCY      92                                            CGL029 CLE042
     O*************************LBRA      96                                            CGL029 CLE042
     O                         GUCY      95                                                   CLE042
0977 O                         TUSD  K  114                                                   CGL029
     O                         LBRA      99                                                   CLE042
     O                       50         115 '-'                                               CGL029
0978 O**
0971 O**   PRINT UTILESED DETAILS IF MORE THAN ONE UTILISED LINE
0978 O**
0979 O        D 10     62N61NL1
     O       AND       23 33 52
     O       AND       10
0981 O**********               TRRF      75                                                   CGL029
0982 O**********               LTST      81                                                   CGL029
0983 O**********               GUCY      85                                                   CGL029
     O**********               LBRA      90                                                   CGL029
0984 O**********               TUSD  K  108                                                   CGL029
     O**********             50         109 '-'                                               CGL029
0981 O                         TRRF      81                                                   CGL029
0982 O                         LTST      87                                                   CGL029
     O                         CLAS      91                                                   CLE042
0983 O*************************GUCY      92                                            CGL029 CLE042
     O*************************LBRA      96                                            CGL029 CLE042
     O                         GUCY      95                                                   CLE042
0984 O                         TUSD  K  114                                                   CGL029
     O                         LBRA      99                                                   CLE042
     O                       50         115 '-'                                               CGL029
0985 O**
0986 O**  TOTAL L1 LINE - REFERENCE TYPE CHANGE
0985 O**
0987 O        T  1     L1 34N33
     O       AND       10N70
0988 O                    40   EXDAMTKB 127
0989 O**
0990 O**  PARENT'S CREDIT LINE SUMMARY TOTALS
0989 O**
0991 O        T 10     L2 33 34
     O       AND       10N70NU7
0992 O                       35          25 'RET'
0993 O                       36          25 'FAC'
0994 O************           37          25 'COM'                         S01339
0995 O                       38          25 'LIM'
0996 O                       47          25 'GTE'
0997 O                       52          25 'FCL'
0922 O                       56          25 'LC '
0998 O                      N36PGTOT KB  58
0999 O                       36FCTOT KB  58
1000 O                         PUTOT KB 108
1001 O                       42PETOT KB 127
1002 O**
1003 O**  L3 CUSTOMER TOTAL LINE OUTPUT
1002 O**
1004 O        T 12     L3 34N33
     O       AND       10N70NU7
1005 O                                   32 'TOTAL'
1006 O                         CUSGRAJB  58
1007 O                         UTCTOTJB 108
1008 O                    41   CEXAMTKB 127
 002 O**
1003 O**  L3 CUSTOMER TOTAL LINE OUTPUT - SECURITY HOLDINGS
1004 O        T  2     L3 34
1004 O       AND       58N70
1005 O                                   58 'VALUE OF SECURITY HOLDIN'
1005 O                                   60 'GS'
1006 O                         CUSSHTJB  84
1009 O**
1010 O**  PARENT TOTAL UTILISED AND GRANTED TOTALS
1009 O**
1011 O        T 21     L4 33 34
     O       AND       10N70NU7
1012 O                                   32 'TOTAL'
1013 O                         PARGT JB  58
1014 O                         PARUT JB 108
1015 O                       44PARET KB 127
1002 O**
1003 O**  L4 PARENT TOTAL LINE OUTPUT - SECURITY HOLDINGS
1004 O        T  2     L4 33 34
1004 O       AND       59N70
1005 O                                   58 'VALUE OF SECURITY HOLDIN'
1005 O                                   60 'GS'
1006 O                         PARSHTJB  84
1016 O**
0647 O**   HEADINGS IF NO DETAILS TO REPORT OR D/B ERROR IN FIRST CYCLE
0648 O**
     O        T  201   LR 70
     O       OR        LR U7 U8
0861 O                                   24 'REFERENCE LE0749P1'
0862 O                         TITL      89
0863 O                                  104 'DATE'
0864 O                         RUNA     112
0865 O                                  122 'PAGE'
0866 O                         PAGE  3  127
0867 O        T  1     LR 70
     O       OR        LR U7 U8
0868 O                                   70 'LENDING PORTFOLIO BY CUS'
0869 O                                   83 'TOMER - 000''S'
0875 O                    75             93 'COMPANY'
     O                 U1 75 34CMPYM     98
     O                 U2 75 34COOB      98
     O                    75NU7         101 ' - '
     O                    75NU7CMNM     131
0871 O        T  2     LR 70
     O       OR        LR U7 U8
0872 O                                   70 '------------------------'
0873 O                                   87 '-----------------'
1017 O        T  2     LR 70
     O       OR        LR U7 U8
     O                 U1                25 'BY COMPANY OF BOOKING '
     O                 U1              +  0 'BRANCH'
     O                 U2                28 'BY COMPANY OF ORIGINATIN'
     O                 U2              +  0 'G BRANCH'
     O        T 32     LR U7
1023 O                                   51 '*** REFERENCE LE0749'
1024 O                                   72 'DATABASE ERROR ***'
1017 O        T 33     LR 70
0675 O                                   76 '*** NO DETAILS TO REPORT'
0675 O                                   80 '***'
1019 O**
     O        T 3      L6 10 75
     O                                   66 '*** END OF REPORT FOR'
     O                                   74 ' COMPANY'
     O                 U1      CMPYM     78
     O                 U2      COOB      78
     O                                   82 ' ***'
     O        T 3      L6 10N75
     O                                   76 '*** END OF REPORT ***'
1021 O**
1020 O**   CONTROL REPORT
1021 O**
1031 OLE0749AUT   03   LR
1032 O                                   24 'REFERENCE LE0749AU'
1033 O                         TITL      89
1034 O                                  104 'DATE'
1035 O                         RUNA     112
1036 O                                  122 'PAGE'
1037 O                         PAGE1 3  127
1038 O        T 2      LR
1039 O                                   68 'LENDING PORTFOLIO BY CUS'
1040 O                                   89 'TOMER - FILE CONTROLS'
1041 O        T 1      LR
1042 O                                   68 '------------------------'
1043 O                                   89 '---------------------'
1044 O        T 3      LR
1045 O                                   28 'S/SFPOR - RUN CONTROLS'
1046 O                                   59 'NUMBER'
1047 O                                   84 'VALUE'
1048 O        T 1      LR
1049 O                                   28 '----------------------'
1050 O                                   59 'OF RECORDS'
1051 O                                   84 'OF RECORDS'
1052 O********T*2      LR                                                 091807
1053 O***********                        29 'TOTAL RECORDS ON FILE'       091807
1054 O***********           NU7TNORE 3   59                               091807
1055 O***********           NU7THRWN 4   81                               091807
1056 O***********           NU7THRDC     84                               091807
1057 O        T 2      LR
1058 O                                   29 'TOTAL RECORDS ON FILE'
1059 O                                   42 '- CALCULATED'
1060 O                         TOTREC3   59
1061 O                         TOTWHN4   81
1062 O                         TOTDC     84
1063 O**********         NU7 U8         111 '***   DIFFERENCE   ***'      091807
     O        T 32     LR U7
1023 O                                   51 '*** REFERENCE LE0749'
1024 O                                   71 'DATABASE ERROR AT'
1025 O                         DBASE     75
1026 O        T        LR U7
1027 O                                   39 'FILENAME'
1028 O                         DBFILE    48
1029 O                                   52 'KEY'
1030 O                         DBKEY     82
     O        T 3      LR 70
0675 O                                   76 '*** NO DETAILS TO REPORT'
0675 O                                   80 '***'
     O/COPY WNCPYSRC,LE0749O001
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
** CPY@   **      OBJECT COPYRIGHT
(c) Finastra International Limited 2001
