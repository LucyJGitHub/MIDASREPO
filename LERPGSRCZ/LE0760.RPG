0001 H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas Parts Purchased by Seller Report')               *
0002 F********************************************************************
     F*  Midas CUSTOMER LENDING
0004 F*                                                                  *
0005 F*       LE0760 - PRINT PARTS. PURCHASED BY SELLER - BY BRANCH      *S01117
0006 F*
      *  (c) Finastra International Limited 2001                      *
0008 F*                                                                  *
      *  Last Amend No. MD046248           Date 27Oct17               *
      *  Prev Amend No. CLE148             Date 23Jul12               *
      *                 CER059             Date 19Jul10               *
      *                 CER043             Date 19May08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      *                 CSC042             Date 16Feb09               *
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CSD031             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 CLE042             Date 06Sep05               *
      *                 CSW037A            Date 02May05               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 CLE025             Date 20Oct03               *
      *                 CGL029             Date 01Sep03               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 087325             Date 23May95               *
     F*                 S01392             Date 07Oct92                  *
     F*                       LN0559              DATE  3AUG90           *S01194
     F*                       BHF252              DATE 25JUL90           *S01194
     F*                       S01194              DATE 15JAN90           *S01194
0009 F*                       S01117              DATE 11/06/89          *
     F*                                                                  *
0010 F*------------------------------------------------------------------*
     F*                                                                  *
      *  MD046248 - Finastra Rebranding                               *
      *  CLE148 - Alpha Loan Reference                                *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  CER043 - German Features LF041-00 New Fields and Defaulting  *
      *           (Recompile)                                         *
      *  CSC042 - COB Performance fix.                                   *
      *           Reduce number of AOBRCHR* calls. RZB Sofia calls AO    *
      *           pgm 210K times for 205 branches                        *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CLE042 - Extended Loan Sub Type                              *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  CLE025 - Credit Lines (Recompile)                            *
      *  CGL029 - Increase Account Code to 10 digits                  *
     F*       087325 - THE CCY OF FIRST RECORD TO BE PRINTED SHOULD NOT  *
     F*                BE OVERRIDDEN BY THE LAST CCY READ FROM SDCURRPD  *
     F*                WHEN SETTING UP DECIMAL PLACES ARRAY ON FIRST RUN *
     F*       S01392 - JAPANESE SUB MODULE ENHANCEMENTS                  *S01392
     F*       LN0559 - PROGRAM PREVIOUSLY OUTPUT NO DETAILS TO REPORT    *
     F*                WHEN REPORT WAS FOR A SINGLE BRANCH AS LEVEL      *
     F*                BREAK NEVER OCCURRED DUE TO THE OVERRIDE IN THE   *
     F*                CALLING CL WHICH EXCLUDES THE HEADER RECORD.      *
     F*       BHF252 - CORRECTING BAD PAGING.                            *
     F*       S01194 - STANDING DATA CHANGES.                            *S01194
     F*       S01117 - MULTIBRANCHING                                    *
     F*                                                                  *
0010 F********************************************************************
     F*  C R E A T I O N     P A R A M E T E R S                      *
     F*                                                               *
     F*                                                               *
     F*****************************************************************
0011 F*PARP***IP* F      80 14AI     2 DISK                               S01117
0011 F*SPARP***IP**F******90 14AI     2 DISK                                           S01117 CLE042
0011 FSPARP   IP  F      92 14AI     2 DISK                                                   CLE042
0012 F*TABLED**IF  F      96 12AI     2 DISK                              S01194
0013 F*CLINT***IF  F     256  7AI     2 DISK                              S01194
     FSDCURRPDIF  E                    DISK                               S01194
0014 F*E0760P1O** F     132     OF     PRINTER                    S01124  S01117
0014 FLE0760P1O   F     132     OF     PRINTER      KINFDS SPOOL      UC  S01117
     FLE0760AUO   F     132     OA     PRINTER      KINFDS SPOOLU         S01117
0015 F********************************************************************
0016 F* ID F  C  H  L    FUNCTION OF INDICATORS
0017 F* 01            SPARP - HEADER
0018 F* 03            SPARP - DETAIL
0019 F* 05            SPARP - TRAILER
0020 F**07*****       TABLE- I/C DATA REC 1                               S01194
0021 F**09*****       TABLE- CURRENCIES RECS 1 & 2                        S01194
0022 F**11*****       CLINT- REC TYPE A                                   S01194
     F*       13      MULTIBRANCH OUTPUT                                  S01117
0023 F*       20      FIRST CYCLE CALCS
0024 F*       24      0 DECIMAL PLACES
0025 F*       25      1 DECIMAL PLACE
0026 F*       26      2 DECIMAL PLACES
0027 F*       27      3 DECIMAL PLACES
0028 F*
0029 F********40      REC NOT ON CLINT                                    S01194
0030 F*       43      DIFFERENCE IN CONTROLS
0031 F*
0032 F*       50      FOR NEW PAGE
0033 F*       51      AT LEAST ONE DETAIL RECORD READ
0034 F*
0035 F*
0036 F********60      FOR ACCESSING I/C DATA REC-1                        S01194
0037 F*       89      USED IN CURRENCY ARRAY SETUP
0038 F*
0039 F*       98      DATA FORMAT = M
0040 F*
0041 F*             L1CHANGE OF SELLER (CUSTOMER)
0042 F*             L2CHANGE OF BRANCH
0043 E                    XCYA      150  3               CURRENCY CODES
0044 E                    XDPA      150  1 0             CURRENCY DEC. POS
     E                    CPY@    1   1 80
     E/COPY ZSRSRC,ZDATE2Z1                                               S01392
     E                    ##BR      999  3               Branch codes                         CSC042
     E                    ##BN      999 30               Branch Names                         CSC042
0048 ISPARP   NS  01   1 CH
0049 I                                        1   1 RECI
0050 I***********                             2   40BRCD  L2              S01117
0051 I***********                             5  100CNUM  L1
0052 I*SPARP DETAIL     REC
0053 I        NS  03   1 CD
0054 I                                        1   1 RECI
0055 I***********                             2   40BRCD  L2              S01117
0055 I                                        2   4 BRCA  L2              S01117
0056 I**********                              5  100CNUM  L1                                  CSD027
0056 I                                        5  10 CNUM  L1                                  CSD027
0057 I                                       11  11 RCDT
0058 I**********                             12  170LNRF                                      CLE148
     I                                       12  17 LNRF                                      CLE148
0059 I                                       18  20 CCY
0060 I                                    P  21  267INTR
0061 I                                    P  27  330CPAM
0062 I                                    P  34  400INTA
0063 I                                    P  41  430MDAT
0064 I                                       44  49 OBLN
0065 I                                    P  50  520PURD
0066 I                                    P  53  590ACFE
0067 I                                    P  60  660DACR
0068 I                                       67  67 GSCI
0069 I                                       68  71 ATST
0070 I**********                             72  770BWCN                                      CSD027
0070 I                                       72  77 BWCN                                      CSD027
0071 I                                       78  79 ACOF
     I                                       89  92 CLAS                                      CLE042
0072 I* SPARP TRAILER
0073 I        NS  05   1 CT
0074 I                                        1   1 RECI
0075 I                                    P   2   40NORP
0076 I                                    P   5  120HPWN
0077 I                                    P  13  140HPDC
0078 I                                    P  15  170NORS
0079 I                                    P  18  250HSWN
0080 I                                    P  26  270HSDC
0081 I*
0082 I* SPARP CATCHALL
0083 I        NS
0084 I                                        1   1 RECI
0085 I*
0086 I*****TABLE*FILE*-*INSTALLATION*CONTROL*DATA*RECORD*1.               S01194
0087 I**********                                                          S01194
0088 I*TABLED**NS  07   2 C0   3 C1  12 C1                                S01194
0089 I*******AND      13 C0                                               S01194
0090 I**********                              1   1 RECI                  S01194
0091 I**********                              2   30RECT                  S01194
0092 I**********                             12  130RCDE                  S01194
0093 I**********                             14  66 TITL                  S01194
0094 I**********                             67  67 DATF                  S01194
0095 I***********                            68  70 DFBR                  S01194
0096 I**********                             74  74 MODI1                 S01194
0097 I**********                             75  75 MODI2                 S01194
0098 I**********                             76  76 MODI3                 S01194
0099 I**********                          P  77  790RUND                  S01194
0100 I**********                             80  86 RUNA                  S01194
0101 I**********                             87  870SFLG                  S01194
0102 I**********                          P  90  920LCD                   S01194
0103 I**********                             93  93 CHTP                  S01194
0104 I**********                          P  94  960TNLU                  S01194
0105 I**********                                                          S01194
0106 I**********                                                          S01194
0107 I*****TABLE*FILE*-*CURRENCIES*RECORDS*1*&*2*(FIELDS*FOR*1*ONLY)*     S01194
0108 I**********                                                          S01194
0109 I*TABLED**NS  09   1 CD   2 C2   3 C0                                S01194
0110 I**********                              1   1 RECI                  S01194
0111 I**********                              2   30RECT                  S01194
0112 I**********                             10  12 CCY                   S01194
0113 I**********                             13  130SREC                  S01194
0114 I**********                             14  27 CCNM                  S01194
0115 I**********                          P  28  348SPOT                  S01194
0116 I**********                             35  37 CCYS                  S01194
0117 I**********                             38  380CDP                   S01194
0118 I**********                             39  390TNOT                  S01194
0119 I**********                             40  40 DCCY                  S01194
0120 I**********                             41  44 SRC1                  S01194
0121 I**********                             45  48 SRC2                  S01194
0122 I**********                             49  520TACC                  S01194
0123 I**********                             53  560TEQV                  S01194
0124 I**********                             57  600SWQV                  S01194
0125 I**********                             61  640TAC4                  S01194
0126 I**********                             65  680TAC5                  S01194
0127 I**********                             69  69 HIND                  S01194
0128 I**********                          P  70  768PART                  S01194
0129 I**********                             77  780SSNO                  S01194
0130 I**********                          P  79  858ERLC                  S01194
0131 I**********                          P  90  920LCD                   S01194
0132 I**********                             93  93 CHTP                  S01194
0133 I**********                          P  94  960TNLU                  S01194
0134 I**********                                                          S01194
0135 I**********                                                          S01194
0136 I*****TABLE*FILE*-*CATCHALL                                          S01194
0137 I**********                                                          S01194
0138 I********NS                                                          S01194
0139 I**********                              1   1 RECI                  S01194
0140 I**********                              2   30RECT                  S01194
0141 I**********                                                          S01194
0142 I**********                                                          S01194
0143 I*****CLIENT*FILE*-*CUSTOMER*STANDING*DATA*RECORD.                   S01194
0144 I**********                                                          S01194
0145 I*CLINT***NS  11   1 CD   8 CA                                       S01194
0146 I**********                              1   1 RECI                  S01194
0147 I**********                              2   70CNUM                  S01194
0148 I**********                              8   8 RCDT                  S01194
0149 I**********                              9  28 CRNM                  S01194
0150 I**********                             29  38 CTWN                  S01194
0151 I**********                             39  48 CSNM                  S01194
0152 I**********                             49  56 CASK                  S01194
0153 I**********                             57  68 TELX                  S01194
0154 I**********                             69  80 CSID                  S01194
0155 I**********                             81  82 ACOC                  S01194
0156 I**********                             83  83 CBSI                  S01194
0157 I**********                             84  85 CCTZ                  S01194
0158 I**********                             86  87 CLOC                  S01194
0159 I**********                             88  930CPAR                  S01194
0160 I***********                            94  960BRCDA                 S01194
0161 I**********                             97  980LINS                  S01194
0162 I**********                             99 1010LIND                  S01194
0163 I**********                          P 102 1040DASU                  S01194
0164 I**********                          P 105 1070CDIC                  S01194
0165 I**********                          P 108 1100DADE                  S01194
0166 I**********                            111 111 CMIN                  S01194
0167 I**********                            112 112 CTYP                  S01194
0168 I**********                            113 124 TELF                  S01194
0169 I**********                            125 133 CHID                  S01194
0170 I**********                            134 136 CHAB                  S01194
0171 I**********                          P 250 2520LCD                   S01194
0172 I**********                            253 253 CHTP                  S01194
0173 I**********                          P 254 2560TNLU                  S01194
0174 I**********                                                          S01194
0175 I**********                                                          S01194
0176 I*****CLIENT*FILE*-*CATCHALL                                         S01194
0177 I**********                                                          S01194
0178 I********NS                                                          S01194
0179 I**********                              1   1 RECI                  S01194
0180 I**********                                                          S01194
0181 I*
     ISDCURRD0                                                            S01194
     I              A6CYCD                          CCY                   S01194
     I              A6NBDP                          CDP                   S01194
0182 I* L.D.A.
0183 ILDA        UDS                            256
0139 I***********                           134 138 DBFILE                S01117
0140 I***********                           139 167 DBKEY                 S01117
0141 I***********                           168 175 DBPGM                 S01117
0142 I***********                           176 1770DBASE                 S01117
0232 I                                      134 141 DBFILE                S01117
0233 I                                      142 170 DBKEY                 S01117
0234 I                                      171 180 DBPGM                 S01117
0235 I                                      181 1830DBASE                 S01117
     I**                                                                  S01117
     I**   FILE INFORMATION DATA STRUCTURE                                S01117
     I**                                                                  S01117
     ISPOOL       DS                                                      S01117
     I                                       83  92 SFILE                 S01117
     I                                    B 123 1240SFNUM                 S01117
     ISPOOLU      DS                                                      S01117
     I                                       83  92 SFILEU                S01117
     I                                    B 123 1240SFNUMU                S01117
     I**                                                                  S01117
     I** DATA AREA RUNDAT                                                 S01117
     I**                                                                  S01117
     IRUNDT       DS                                                      S01117
     I                                        1   7 RUNA                  S01117
     I                                    P   8  100RUND                  S01117
     I                                       11  11 SSF                   S01117
     I                                       12  12 DATF                  S01117
     I                                       13  13 MBIN                  S01117
     I**                                                                  S01117
     ISDBRCH    E DSSDBRCHPD                                              S01117
     I              A8BRNM                          BRNM                  S01117
     I**  EXTERNAL DS FOR BRANCH CODES                                    S01117
     ISDBANK    E DSSDBANKPD                                              S01194
      **  EXTERNAL DS FOR BANK DETAILS                                    S01194
     I              BJURPT                          TITL                  S01194
      *                                                                   S01194
     ISDCUST    E DSSDCUSTPD                                              S01194
     I              QQDFAC                          QQDFA1                                    CGL029
      **  EXTERNAL DS FOR CUSTOMER DETAILS                                S01194
     I              BBCRNM                          CRNM                  S01194
     I*                                                                   S01194
     IDSFDY     E DSDSFDY                                                 S01194
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01194
     IDSSDY     E DSDSSDY                                                 S01194
     I* SECOND DS FOR ACCESS PROGRAMS, LONG DATA STRUCTURE                S01194
     I**                                                                  S01117
     C**********           MOVEACPY@      BIS@   80                                           CSC042
     C**                                                                  S01117
     C           *ENTRY    PLIST                                          S01117
     C                     PARM           SEQ     5         SEQUENCE NUM. S01117
     C                     PARM           BRNCH   3                       S01117
     C** PARAMETER LIST FOR PROGRAM 'AOBANKR0'                            S01194
     C           PLISTA    PLIST                                          S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDBANK    PARM SDBANK    DSFDY                           S01194
     C** PARAMETER LIST FOR PROGRAM 'AOCUSTR0'                            S01194
     C*                                                                   S01194
     C           PLIST1    PLIST                                          S01194
     C                     PARM '*MSG   ' @RTCD                           S01194
     C                     PARM '*KEY   ' @OPTN                           S01194
     C                     PARM           CKEY   10                       S01194
     C                     PARM '*CNUM  ' KEYSTS  7                       S01194
     C           SDCUST    PARM SDCUST    DSSDY                           S01194
     C*                                                                   S01194
     C**                                                                  S01194
0188 C* FIRST CYCLE OR TRAILER
0189 C*
     C           *NAMVAR   DEFN           LDA                             S01117
     C           *LOCK     IN   LDA                                       S01117
     C           *NAMVAR   DEFN RUNDAT    RUNDT                           S01117
0190 C                     SETOF                     50
0191 C         20          GOTO BY01
0192 C* DB ERROR FIELD
     C                     MOVEACPY@      BIS@   80                                           CSC042
0193 C                     MOVE 'LE0760'  DBPGM
0194 C                     SETON                     20
     C                     IN   RUNDT                                     S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C                     SETON                     88                   S01117
     C                     END                                            S01117
0195 C*
0196 C* STORE CCY OF FIRST RECORD TO BE PRINTED                           087325
0197 C                     MOVE CCY       CCY1    3                       087325
0196 C* SET UP CURRENCY ARRAYS
0197 C                     EXSR CCYARR
0196 C* RESTORE VALUE OF CCY OF FIRST RECORD TO BE PRINTED                087325
0197 C                     MOVE CCY1      CCY                             087325
0198 C*
     C                     Z-ADD0         ##BNDX  40                                          CSC042
     C           *LIKE     DEFN ##BNDX    B                                                   CSC042
     C           *LIKE     DEFN ##BNDX    ##BSV                                               CSC042
      *                                                                                       CSC042
0199 C*
0200 C* ACCESS I/C DATA REC 1
0201 C**********           MOVEL'01      'TKEY   12                       S01194
0202 C**********           MOVE '10'      TKEY                            S01194
0203 C********** TKEY      SETLLTABLED                                    S01194
0204 C**********           READ TABLED                   62               S01194
0205 C******07** RECI      COMP 'D'                      07               S01194
0206 C*********07          GOTO BY02                                      S01194
     C                     CALL 'AOBANKR0'PLISTA                          S01194
     C           @RTCD     IFNE *BLANKS                                   S01194
0207 C                     SETON                     U7U8LR
0208 C**********           MOVE TKEY      DBKEY                           S01194
0209 C                     MOVE '01'      DBASE
0210 C                     MOVE 'SDBANKPD'DBFILE                          S01194
0210 C**********           MOVE 'TABLE'   DBFILE                          S01194
0211 C                     GOTO END
     C                     END                                            S01194
0212 C*
0213 C           BY02      TAG                             ** BY02 TAG **
0214 C*  CHECK DATE FORMAT
0215 C           DATF      COMP 'M'                      98
     C*                                                                   S01117
     C*  SETUP RECORD COUNT                                               S01117
     C                     Z-ADD0         RECTOT  50                      S01117
0220 C*                                                                   S01117
0216 C*  SETUP BLANK FIELDS
0217 C                     MOVE ' '       B20    20
0218 C                     MOVE ' '       B6      6
     C*                                                                   LN0559
     C* IF FIRST RECORD READ IS A DETAIL RECORD THEN DO NOT WANT          LN0559
     C* TO SKIP MAIN PROCESSING                                           LN0559
     C           *IN03     IFNE '1'                                       LN0559
0219 C                     GOTO END
     C                     END                                            LN0559
0220 C*
0221 C           BY01      TAG                             ** BY01 TAG**
0222 C*
0223 C*
0224 C*
0225 C*   MAIN PROCESSING FOR DETAIL REC
0226 C*
0227 C     N03             GOTO END
0228 C** AT LEAST ONE DETAIL RECORD READ - SET INDICATOR
0229 C                     SETON                     51
     C*                                                                   S01117
     C**  MULTIBRANCH TEST FOR OUTPUT                                     S01117
     C*                                                                   S01117
     C           *INL2     IFEQ '1'                                       S01117
     C                     CLOSELE0760P1                                  S01117
     C           BRNCH     IFEQ 'ALL'                                     S01117
     C           BRNCH     OREQ BRCA                                      S01117
     C           MBIN      ORNE 'Y'                                       S01117
     C                     SETON                     1356                 S01117
     C                     OPEN LE0760P1                                  S01117
     C                     Z-ADD0         PAGE                            S01117
      *                                                                   S01117
     C                     Z-ADDSFNUM     ZSNUM                           S01117
      *                                                                   S01117
     C                     OUT  LDA                                       S01117
      *                                                                   S01117
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           SEQ                             S01117
     C                     PARM BRCA      SENTY                           S01117
     C                     PARM           SFILE                           S01117
     C                     PARM           ZSNUM   60                      S01117
     C                     PARM           ZSERR   1                       S01117
      *                                                                   S01117
     C           *LOCK     IN   LDA                                       S01117
     C           ZSERR     IFEQ 'Y'                                       S01117
      ** ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM        S01117
     C                     SETON                     U7U8LR               S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C**                                                                  S01117
     C** RETRIEVE BRANCH NAME FROM SDBRCHPD                               S01117
     C**                                                                  S01117
     C                     MOVELBRCA      ##KB                                                CSC042
     C                     EXSR ##CHKB                                                        CSC042
      * If branch is in the array then use the details                                        CSC042
     C           ##FIC     IFEQ 'Y'                        *** B10                            CSC042
     C                     EXSR ##SETB                                                        CSC042
     C                     ELSE                            *** X10                            CSC042
     C**********           CALL 'AOBRCHR0'                                S01117              CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       S01117
     C                     PARM '*KEY   ' @OPTN   7                       S01117
     C                     PARM BRCA      @DSNB   3                       S01117
     C********** SDBRCH    PARM SDBRCH    DSFDY                           S01117              CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANK                                    S01117
     C                     SETON                     U7U8LR               S01117
     C                     MOVEL'SDBRCHPD'DBFILE                          S01117
     C                     MOVEL@DSNB     DBKEY            ***************S01117
     C                     MOVEL@OPTN     DBOPTN  7        * DBERROR 004 *S01117
     C                     MOVEL'004'     DBASE            ***************S01117
     C                     EXSR *PSSR                                     S01117
     C                     GOTO END                                       S01117
     C                     ELSE                                                               CSC042
      * Details found on the DB so add them to the array                                      CSC042
      * if the array still has room                                                           CSC042
     C                     EXSR ##ADDB                                                        CSC042
     C                     END                                            S01117
     C                     END                                                                CSC042
     C                     ELSE                                           S01117
     C                     SETOF                     13                   S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C           BRCA      ANDGTBRNCH                                     S01117
     C                     SETON                     LR                   S01117
     C                     GOTO END                                       S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C                     END                                            S01117
0230 C*
0231 C* MAINTAIN CONTROLS
0232 C                     EXSR FCONT
0233 C*
0234 C* PICK UP CURRENCY DECIMAL POSITIONS
0235 C                     MOVE CCY       XCCY
0236 C                     EXSR CCYDEP
0237 C      99             SETON                     U7U8
0238 C      99             MOVE '03'      DBASE
0239 C******99**           MOVEL'TABLE'   DBFILE                          S01194
0239 C      99             MOVEL'SDCURRPD'DBFILE                          S01194
0240 C******99**           MOVEL'20      'DBKEY                           S01194
0241 C******99**           MOVELXCCY      WK4     4                       S01194
0242 C******99**           MOVE '1'       WK4                             S01194
0243 C******99**           MOVE WK4       DBKEY                           S01194
0243 C      99             MOVELXCCY      DBKEY                           S01194
0244 C      99             GOTO END
0245 C                     SETOF                     242526
0246 C                     SETOF                     27
0247 C           XDECP     COMP 0                        24
0248 C        N24XDECP     COMP 2                    272526
0249 C*
0250 C                     MOVE B20       SELLER
0251 C                     MOVE B6        SELNUM
0252 C*  IF CHANGE OF SELLER PICK UP CLIENT REC
0253 C     NL1             GOTO BY03
0254 C**********           MOVELCNUM      CLKEY   7                       S01194
0255 C**********           MOVE 'A'       CLKEY                           S01194
0256 C********** CLKEY     CHAINCLINT                40                   S01194
0257 C*****N11**           SETON                     40                   S01194
0258 C******40**           MOVE '02'      DBASE                           S01194
0259 C*********40          GOTO BY04                                      S01194
     C                     MOVELCNUM      CKEY                            S01194
     C                     CALL 'AOCUSTR0'PLIST1                          S01194
     C           @RTCD     IFNE *BLANKS                                   S01194
     C                     MOVE CKEY      DBKEY                        ***S01194
     C                     MOVE 'SDCUSTPD'DBFILE           ***************S01194
0237 C                     Z-ADD2         DBASE            DBASE 2        S01194
0234 C                     SETON                     U7U8LR               S01194
0209 C                     GOTO END                                       S01194
     C                     END                                            S01194
      *                                                                   S01194
0260 C*  STORE SELLER NAME DETAILS
0261 C                     MOVE CRNM      SELLER 20
0262 C**********           MOVELCLKEY     SELNUM  6                       S01194
0262 C                     MOVELCKEY      SELNUM  6                       S01194
0263 C*
0264 C           BY03      TAG                             ** BY03 TAG **
0265 C*  ACCESS CLINT FOR BORROWER NAME
0266 C                     MOVELOBLN      CKEY                            S01194
     C                     CALL 'AOCUSTR0'PLIST1                          S01194
     C           @RTCD     IFNE *BLANKS                                   S01194
     C                     MOVE CKEY      DBKEY                        ***S01194
     C                     MOVE 'SDCUSTPD'DBFILE           ***************S01194
0237 C                     Z-ADD5         DBASE            DBASE 5        S01194
0234 C                     SETON                     U7U8LR               S01194
0209 C                     GOTO END                                       S01194
     C                     END                                            S01194
      *                                                                   S01194
0266 C**********           MOVELOBLN      CLKEY                           S01194
0267 C********** CLKEY     CHAINCLINT                40                   S01194
0268 C*****N11**           SETON                     40                   S01194
0269 C******40**           MOVE '03'      DBASE                           S01194
0270 C*********40          GOTO BY04                                      S01194
0271 C*  STORE BORROWER
0272 C                     MOVE CRNM      BORROW 20
0273 C**********           MOVELCLKEY     BORNUM  6                       S01194
0273 C                     MOVELCKEY      BORNUM  6                       S01194
0274 C                     GOTO BY05
0275 C*  TO GET HERE MEANS D.B. ERROR
0276 C********** BY04      TAG                             ** BY04 TAG ** S01194
0277 C**********           SETON                     U7U8                 S01194
0278 C**********           MOVE CLKEY     DBKEY                           S01194
0279 C**********           MOVE 'CLINT'   DBFILE                          S01194
0280 C**********           GOTO END                                       S01194
0281 C*
0282 C*
0283 C           BY05      TAG                             ** BY05 TAG **
0284 C*  CONVERT DAY NOS TO CORRECT FORMAT.
0285 C*  MATURITY DATE
0286 C                     Z-ADDMDAT      ZDAYNO
0287 C                     EXSR ZDATE2
0288 C                     MOVE ZADATE    MATDAT  7
0289 C*  DATE PURCHASED
0290 C                     Z-ADDPURD      ZDAYNO
0291 C                     EXSR ZDATE2
0292 C                     MOVE ZADATE    PURDAT  7
0293 C** SET INDICATOR FOR NEW PAGE
0294 C   L2
0295 COR OF                SETON                     50
0296 C*  CUT DOWN INTEREST RATE
0297 C                     Z-ADDINTR      INTOUT  75H
0298 C*
0299 C           END       TAG                             ** END TAG **
0300 C      U7 U8          SETON                     LR
0301 C** IF NO DETAIL RECS. READ, O/P HEADINGS
0302 C   05N51             SETON                     50
0303 C** PRINT HEADINGS IF DATABASE ERROR IN FIRST CYCLE
0304 C   01 U7 U8          SETON                     50
      *                                                                   S01117
      ** ENSURE TOTAL SPOOL FILE RECORDED BY RCF                          S01117
     CLR                   Z-ADDSFNUMU    ZSNUMU                          S01117
      *                                                                   S01117
     CLR                   OUT  LDA                                       S01117
     CLR                   CALL 'ZSFILE'                                  S01117
     CLR                   PARM           SEQ                             S01117
     CLR                   PARM *BLANK    SENTY                           S01117
     CLR                   PARM           SFILEU                          S01117
     CLR                   PARM           ZSNUMU  60                      S01117
     CLR                   PARM           ZSERR   1                       S01117
      *                                                                   S01117
     CLR         *LOCK     IN   LDA                                       S01117
     CLR         ZSERR     IFEQ 'Y'                                       S01117
      ** ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM        S01117
     CLR                   SETON                     U7U8                 S01117
     CLR                   RETRN                                          S01117
     CLR                   END                                            S01117
     C**                                                                  S01117
     CLR         *IN13     IFEQ '0'                                       S01117
     CLR         BRNCH     ANDNE'ALL'                                     S01117
     CLR         *IN56     ANDEQ'0'                                       S01117
     CLR                   EXSR NODETL                                    S01117
     CLR                   ELSE                                           S01117
     C**                                                                  S01117
     CLR         RECTOT    IFLT 1                                         S01117
     CLR                   SETON                     U8                   S01117
     CLRN51                OPEN LE0760P1                                  S01117
      *                                                                   S01117
      ** ENSURE TOTAL SPOOL FILE RECORDED BY RCF                          S01117
     CLR                   Z-ADDSFNUM     ZSNUM                           S01117
      *                                                                   S01117
     CLR                   OUT  LDA                                       S01117
     CLR                   CALL 'ZSFILE'                                  S01117
     CLR                   PARM           SEQ                             S01117
     CLR                   PARM *BLANK    SENTY                           S01117
     CLR                   PARM           SFILE                           S01117
     CLR                   PARM           ZSNUM   60                      S01117
     CLR                   PARM           ZSERR   1                       S01117
      *                                                                   S01117
     CLR         *LOCK     IN   LDA                                       S01117
     CLR         ZSERR     IFEQ 'Y'                                       S01117
      ** ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM        S01117
     CLR                   SETON                     U7U8                 S01117
     CLR                   RETRN                                          S01117
     CLR                   END                                            S01117
      *                                                                   S01117
     CLR                   EXCPTNODTL                                     S01117
     CLR                   SETOF                     U8                   S01117
     CLR                   END                                            S01117
     CLR                   END                                            S01117
0305 CLR    U7 U8          GOTO LREND
     CLR         MBIN      IFEQ 'N'                                       S01117
     CLR         MBIN      OREQ 'Y'                                       S01117
     CLR         BRNCH     ANDEQ'ALL'                                     S01117
0306 CLR         ZZTOTI    COMP HPWN                 4343
0307 CLR   N43   ZZTOTD    COMP HPDC                 4343
0308 CLR   N43   RECTOT    COMP NORP                 4343
0309 CLR    43             SETON                     U8
     CLR                   END                                            S01117
0310 CLR         LREND     TAG                             ** LREND TAG **S01117
     CLR    U7 U8          EXSR *PSSR                                     S01117
0311 C********************************************************************
0312 C*                   SUBROUTINES                                    *
0313 C********************************************************************
0314 C*
0315 C           FCONT     BEGSR                           **FCONT BEGSR**
0316 C*  ACCUMULATE CONTROLS - ONLY FOR 'D' RECORDS.
0317 C*
0318 C*  NO OF RECORDS
0319 C           RECTOT    ADD  1         RECTOT  50
0320 C*
0321 C*  HASH OF VALUE
0322 C           CPAM      COMP 0                      30
0323 C                     MOVE CPAM      ZZAMT
0324 C      30             Z-SUBZZAMT     ZZAMT
0325 C                     EXSR GLZADD
0326 C*
0327 C*
0328 C                     ENDSR                           ***  ENDSR  ***
0329 C********************************************************************
0330 C********************************************************************
0331 C**
0332 C**   SR. TO SET UP AN ARRAY OF CURRENCIES AND AN ARRAY OF
0333 C**   DECIMAL PLACES FOR THOSE CURRENCIES.
0334 C**
0335 C           CCYARR    BEGSR                           *** CCYARR  ***
0336 C**
0337 C**   SET OFF E.O.F.INDICATOR
0338 C                     SETOF                     89
0339 C**
0340 C**   SET ARRAY INDEX TO ZERO.
0341 C                     Z-ADD0         X       30
0342 C**
0343 C*****SET*UP*KEY*FOR*CURRENCY*TABLE.                                 S01194
0344 C**********           MOVEL'20      'XCYKEY 12                       S01194
0345 C**********           MOVE '    '    XCYKEY                          S01194
0346 C**
0347 C*****SET*LOWER*LIMIT*AND*READ*CURRENCY*TABLE*HEADER.*               S01194
0348 C********** XCYKEY    SETLLTABLED                                    S01194
0349 C**
0350 C**   LOOP TO READ CURRENCY DETAIL RECORDS.
0351 C           XLOOP     TAG                             ** XLOOP TAG **
0352 C**********           READ TABLED                   89               S01194
0352 C                     READ SDCURRPD                 89               S01194
0353 C**N89***** RECT      COMP 20                   8989                 S01194
0354 C**
0355 C**   END IF ALL CURRENCY RECORDS PROCESSED
0356 C   89                GOTO XCAEND
0357 C**
0358 C**   IGNORE DELETED RECORDS AND NON-SUB-RECORD ONE.
0359 C********** RECI      COMP 'D'                  9797                 S01194
0360 C***97*****           GOTO XLOOP                                     S01194
0361 C********** SREC      COMP 1                    9797                 S01194
0362 C***97*****           GOTO XLOOP                                     S01194
0363 C**
0364 C**   INCREMENT ARRAY INDEX.
0365 C           X         ADD  1         X
0366 C**
0367 C**   MOVE DATA INTO ARRAYS.
0368 C                     MOVE CCY       XCYA,X
0369 C                     MOVE CDP       XDPA,X
0370 C**
0371 C**   CHECK FOR FULL ARRAY.96 ON IF FULL.
0372 C           X         COMP 150                      96
0373 C**
0374 C**   GO TO READ NEXT RECORD.
0375 C  N96                GOTO XLOOP
0376 C**
0377 C           XCAEND    ENDSR                           ** XCAEND **
0378 C**
0379 C********************************************************************
0380 C********************************************************************
0381 C**
0382 C**   SR. TO OBTAIN NO. OF DECIMAL PLACES FOR A CURRENCY.
0383 C**
0384 C           CCYDEP    BEGSR                           *** CCYDEP  ***
0385 C**
0386 C**   BLANK CURRENCY CODE IS INVALID
0387 C           XCCY      COMP '   '                    99
0388 C   99                GOTO XCDEND
0389 C**
0390 C**   SET ARRAY INDEX TO ONE
0391 C                     Z-ADD1         X
0392 C**
0393 C**   INITIALIZE INPUT-OUTPUT FIELDS.
0394 C                     Z-ADD0         XDECP   10
0395 C                     MOVE XCCY      XCCY    3
0396 C**
0397 C**   LOOK UP NO. OF DECIMAL PLACES FOR CURRENCY.
0398 C**   99 SETON FOR INVALID CURRENCY.
0399 C           XCCY      LOKUPXCYA,X                   95
0400 C   95                MOVE XDPA,X    XDECP
0401 C  N95                SETON                     99
0402 C**
0403 C           XCDEND    ENDSR                           ** XCDEND **
0404 C**
0405 C********************************************************************
0497 C********************************************************************
0498 C* SUBROUTINE TO ADD AN AMOUNT (ZZAMT) TO THE TOTAL (ZZTOTI,ZZTOTD)
0499 C*   IND '99' IS SET BY AN OVERFLOW ERROR
0500 C*
0501 CSR         GLZADD    BEGSR                           *** GLZADD ****
0502 C*
0503 CSR                   Z-ADDZZAMT     ZZAMT  153     91-DEFINE ZZAMT
0504 CSR 91                GOTO ZZAEND                     AMT = 0.BYPASS
0505 C*
0506 C* SPLIT ZZAMT INTO INTEGER AND DECIMAL FIELDS
0507 CSR                   Z-ADDZZAMT     ZZAMTI 150       INTEGER FIELD
0508 CSR                   MOVE ZZAMT     ZZAMTD  30       DECIMAL FIELD
0509 C* BOTH ZZAMTI AND ZZAMTD CONTAIN A 'SIGN' ZONE NOW
0510 C*
0511 CSR                   EXSR GLZSUM
0512 CSR         ZZAEND    ENDSR                           ** ZZAEND TAG *
0513 C*
0514 C********************************************************************
0515 C* SUBROUTINE TO CARRY OUT THE ADDITION FOR SUBROUTINES -
0516 C*                        GLZADD, GLZSUB, GLZCMP.
0517 C*          PARAMETERS PASSED -
0518 C*                     I/P ZZAMTI ZZAMTD
0519 C*                     O/P ZZTOTI ZZTOTD ZZNEGD IND 96 IND 99.
0520 C*
0521 CSR         GLZSUM    BEGSR                           *** GLZSUM ****
0522 C*
0523 CSR                   Z-ADDZZTOTI    ZZTOTI 150       DEFINE ZZTOTI
0524 CSR                   Z-ADDZZTOTD    ZZTOTD  30       DEFINE ZZTOTD
0525 CSR                   SETOF                     919293
0526 CSR                   SETOF                     949599
0527 C*
0528 C*    DETERMINE SIGN OF ZZAMTI & D,   92 IF NEG
0529 CSR         ZZAMTI    COMP 0                      9293
0530 CSR 93      ZZAMTD    COMP 0                      9293
0531 CSR 93                GOTO ZZSEND                     ZERO BYPASS
0532 C*
0533 C*    DETERMINE SIGN OF ZZTOTI & D, 91 IF NEG.
0534 CSR         ZZTOTI    COMP 0                      9193
0535 CSR 93      ZZTOTD    COMP 0                      9193
0536 C*
0537 C*    IF ZZTOTAL IS ZERO, RETURN ZZAMOUNT.
0538 CSR 93                Z-ADDZZAMTI    ZZTOTI
0539 CSR 93                Z-ADDZZAMTD    ZZTOTD
0540 CSR 93                GOTO ZZSEND                     ZERO BYPASS
0541 C*    IF SIGNS DIFFER BYPASS OVERFLOW CHECKS.
0542 CSR 91N92
0543 CORN91 92             GOTO ZZOFPS
0544 C*
0545 CSR         ZZAMTD    ADD  ZZTOTD    ZZWK2   40
0546 CSR         ZZWK2     COMP 999                  93    '93' = CARRY
0547 CSRN93      ZZWK2     COMP -999                   93    INTO INTEGER.
0548 C*
0549 CSR 93N92   ZZAMTI    ADD  1         ZZWK3  150       ADD 'CARRY' +VE
0550 CSR    93 92ZZAMTI    SUB  1         ZZWK3            SUB 'CARRY' -VE
0551 CSR 93      ZZTOTI    ADD  ZZWK3     ZZWK3
0552 CSRN93      ZZTOTI    ADD  ZZAMTI    ZZWK3
0553 C*
0554 C* IF THE MODULUS OF ZZWK3 IS LT MOD. ZZTOTI THEN O/F HAS OCCURED
0555 CSRN92      ZZWK3     COMP ZZTOTI                 99  -92 MEANS NOS.
0556 CSR 92      ZZWK3     COMP ZZTOTI               99     NEGATIVE
0557 CSRN99                Z-ADDZZWK2     ZZTOTD
0558 CSRN99                Z-ADDZZWK3     ZZTOTI
0559 C*
0560 C* IF O/F ZEROIZE ZZAMT , IND '99' SET AND ZZTOT FIELDS LEFT INTACT.
0561 CSR 99                Z-ADD0         ZZAMT  153
0562 CSR                   GOTO ZZSEND
0563 C*
0564 C* THE 'SIGNS' ARE DIFFERENT
0565 CSR         ZZOFPS    TAG                             ** ZZOFPS TAG**
0566 C* IF ZZAMT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZTOT
0567 C*
0568 CSR 92                Z-SUBZZAMTI    ZZAMTI 150
0569 CSR 92                Z-SUBZZAMTD    ZZAMTD  30
0570 C*
0571 C* IF ZZTOT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZAMT.
0572 C*
0573 CSR 91                Z-SUBZZTOTI    ZZTOTI
0574 CSR 91                Z-SUBZZTOTD    ZZTOTD
0575 C* BOTH ZZAMT AND ZZTOT ARE NOW POSITIVE.
0576 C*
0577 CSR         ZZTOTI    COMP ZZAMTI               93  95
0578 CSR 95      ZZTOTD    COMP ZZAMTD               93  95
0579 C*
0580 C* IF ZZTOT EQ. ZZAMT RETURN ZERO.
0581 CSR 95                Z-ADD0         ZZTOTI
0582 CSR 95                Z-ADD0         ZZTOTD
0583 CSR 95                GOTO ZZSEND
0584 C*
0585 C* IF ZZTOT GT. ZZAMT.
0586 CSR 93      ZZAMTD    COMP ZZTOTD               94
0587 CSR 93 94   ZZTOTI    SUB  1         ZZTOTI
0588 CSR 93 94   ZZTOTD    ADD  1000      ZZWK2
0589 CSR 93      ZZTOTI    SUB  ZZAMTI    ZZTOTI
0590 CSR 93 94   ZZWK2     SUB  ZZAMTD    ZZTOTD
0591 CSR 93N94   ZZTOTD    SUB  ZZAMTD    ZZTOTD
0592 C*
0593 C*
0594 C* IF ZZAMT GT. ZZTOT.
0595 CSRN93      ZZTOTD    COMP ZZAMTD               94
0596 CSRN93 94   ZZAMTI    SUB  1         ZZWK3  150
0597 CSRN93 94   ZZAMTD    ADD  1000      ZZWK2
0598 CSRN93 94   ZZWK3     SUB  ZZTOTI    ZZTOTI
0599 CSRN93N94   ZZAMTI    SUB  ZZTOTI    ZZTOTI
0600 CSRN93 94   ZZWK2     SUB  ZZTOTD    ZZTOTD
0601 CSRN93N94   ZZAMTD    SUB  ZZTOTD    ZZTOTD
0602 C*
0603 C* REVERSE SIGN OF ZZTOT IF LARGER I/P FIELDS WERE NEGATIVE
0604 CSR                   SETOF                     94
0605 CSR 93 91
0606 CORN93 92             SETON                     94
0607 CSR 94                Z-SUBZZTOTI    ZZTOTI
0608 CSR 94                Z-SUBZZTOTD    ZZTOTD
0609 C**
0610 C**   RESTORE SIGN OF ZZAMTI & ZZAMTD IF IT WAS REVERSED.
0611 CSR 92                Z-SUBZZAMTI    ZZAMTI
0612 CSR 92                Z-SUBZZAMTD    ZZAMTD
0613 CSR         ZZSEND    TAG                             ** ZZSEND TAG *
0614 C**
0615 C**   IF ZZTOTD IS ZERO, AND ZZTOTI IS NEG. SET UP ZZNEGD.
0616 CSR                   SETOF                     96
0617 CSR         ZZTOTD    COMP 0                        91
0618 CSR 91      ZZTOTI    COMP 0                      96
0619 CSR 96                MOVE '.000-'   ZZNEGD  5
0620 C                     ENDSR
0621 C********************************************************************
     C*                                                                   S01117
     C** PRINT OUT NO DETAIL TO REPORT IN LE0760P1                        S01117
     C*                                                                   S01117
0454 C           NODETL    BEGSR                           *** NODETL *** S01117
     C**                                                                  S01117
     C                     OPEN LE0760P1                                  S01117
     C                     Z-ADD*ZEROS    PAGE                            S01117
      *                                                                   S01117
      ** ENSURE REPORT SPOOL FILE RECORDED BY RCF                         S01117
     C                     Z-ADDSFNUM     ZSNUM                           S01117
      *                                                                   S01117
     C                     OUT  LDA                                       S01117
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           SEQ                             S01117
     C                     PARM BRNCH     SENTY   3                       S01117
     C                     PARM           SFILE                           S01117
     C                     PARM           ZSNUM   60                      S01117
     C                     PARM           ZSERR   1                       S01117
      *                                                                   S01117
     C           *LOCK     IN   LDA                                       S01117
     C           ZSERR     IFEQ 'Y'                                       S01117
      ** ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM        S01117
     C                     SETON                     U7U8LR               S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
      **                                                                  S01117
     C** To get Branch Name - WHEN MBIN = 'Y'                             S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C           BRNCH     ANDNE'ALL'                                     S01117
     C           BRNCH     ANDNE'   '                                     S01117
     C                     MOVELBRNCH     ##KB                                                CSC042
     C                     EXSR ##CHKB                                                        CSC042
      * If branch is in the array then use the details                                        CSC042
     C           ##FIC     IFEQ 'Y'                        *** B10                            CSC042
     C                     EXSR ##SETB                                                        CSC042
     C                     ELSE                            *** X10                            CSC042
     C**********           CALL 'AOBRCHR0'                                S01117              CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       S01117
     C                     PARM '*KEY   ' @OPTN   7                       S01117
     C                     PARM BRNCH     @DSNB   3                       S01117
     C**********           PARM           SDBRCH                          S01117              CGL029
     C                     PARM           DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANK                                    S01117
     C                     SETON                     U7U8LR               S01117
     C                     MOVEL'SDBRCHPD'DBFILE                          S01117
     C                     MOVEL@DSNB     DBKEY            ***************S01117
     C                     MOVEL@OPTN     DBOPTN  7        * DBERROR 013 *S01117
     C                     MOVEL'013'     DBASE            ***************S01117
     C                     EXSR *PSSR                                     S01117
     C                     ELSE                                                               CSC042
      * Details found on the DB so add them to the array                                      CSC042
      * if the array still has room                                                           CSC042
     C                     EXSR ##ADDB                                                        CSC042
     C                     END                                            S01117
     C                     END                                                                CSC042
     C                     END                                            S01117
     C                     EXCPTNODTL                                     S01117
0466 C                     ENDSR                                          S01117
     C*                                                                   S01117
      /EJECT                                                                                  CSC042
     C********************************************************************                    CSC042
      *                                                                                       CSC042
      * ##CHKB - Subroutine to check the Branch in the arrays                                 CSC042
      *                                                                                       CSC042
     C           ##CHKB    BEGSR                                                              CSC042
      *                                                                                       CSC042
     C           *LIKE     DEFN A8BRCD    ##KB                                                CSC042
      *                                                                                       CSC042
      * Set off the branch found indicator                                                    CSC042
     C                     MOVEL*BLANK    ##FIC   1                                           CSC042
      *                                                                                       CSC042
      * Save the state of indicator 30 so it can be reset at the end                          CSC042
      * of the SR as it may be used elsewhere in the code                                     CSC042
     C           *IN30     IFEQ *ON                                                           CSC042
     C                     MOVEL'Y'       #IN30   1                                           CSC042
     C                     ELSE                                                               CSC042
     C                     MOVEL'N'       #IN30                                               CSC042
     C                     END                                                                CSC042
      *                                                                                       CSC042
     C                     SETOF                         30                                   CSC042
      *                                                                                       CSC042
      * Restore the saved Value of B                                                          CSC042
     C                     Z-ADD##BSV     B                                                   CSC042
      *                                                                                       CSC042
     C* Check whether details for Branch already in array                                     CSC042
      *                                                                                       CSC042
      * Is this the same as the last LOKUP, if so we can bypass                               CSC042
      * the LOKUP                                                                             CSC042
      * Defend against B being 0                                                              CSC042
     C           B         IFEQ 0                                                             CSC042
     C                     Z-ADD1         B                                                   CSC042
     C                     END                                                                CSC042
      *                                                                                       CSC042
      * If the branch being checked is the same then use these                                CSC042
      * details rather than doing a LOKUP                                                     CSC042
     C           ##KB      IFEQ ##BR,B                                                        CSC042
      * Found so seton 30                                                                     CSC042
     C                     SETON                         30                                   CSC042
     C                     ELSE                                                               CSC042
     C                     Z-ADD1         B                                                   CSC042
     C           ##KB      LOKUP##BR,B                   30                                   CSC042
     C                     END                                                                CSC042
      *                                                                                       CSC042
      * Save the last update to B                                                             CSC042
     C           *IN30     IFEQ *ON                                                           CSC042
     C                     Z-ADDB         ##BSV                                               CSC042
      * Set the indicator to show the data was found                                          CSC042
     C                     MOVEL'Y'       ##FIC                                               CSC042
     C                     END                                                                CSC042
      *                                                                                       CSC042
      * Reset the state of indicator 30.                                                      CSC042
     C           #IN30     IFEQ 'Y'                                                           CSC042
     C                     MOVEL*ON       *IN30                                               CSC042
     C                     ELSE                                                               CSC042
     C                     MOVEL*OFF      *IN30                                               CSC042
     C                     END                                                                CSC042
      *                                                                                       CSC042
     C                     ENDSR                                                              CSC042
      ********************************************************************                    CSC042
      /EJECT                                                                                  CSC042
      ********************************************************************                    CSC042
      *                                                                                       CSC042
      * ##SETB - Sets up the SDBRCHPD fields used in the code from the                        CSC042
      * arrays                                                                                CSC042
      *                                                                                       CSC042
     C           ##SETB    BEGSR                                                              CSC042
      *                                                                                       CSC042
     C                     MOVEL##BR,B    A8BRCD                                              CSC042
     C                     MOVEL##BN,B    BRNM                                                CSC042
      *                                                                                       CSC042
     C                     ENDSR                                                              CSC042
      *                                                                                       CSC042
      ********************************************************************                    CSC042
      /EJECT                                                                                  CSC042
      ********************************************************************                    CSC042
      *                                                                                       CSC042
      * ##ADDB - Adds the SDBRCHPD fields used in the code to the                             CSC042
      * arrays                                                                                CSC042
      *                                                                                       CSC042
     C           ##ADDB    BEGSR                                                              CSC042
      *                                                                                       CSC042
      * If there is still room in the array then add the details                              CSC042
     C           ##BNDX    IFLT 999                                                           CSC042
     C                     ADD  1         ##BNDX                                              CSC042
     C                     Z-ADD##BNDX    B                                                   CSC042
     C                     MOVELA8BRCD    ##BR,B                                              CSC042
     C                     MOVELBRNM      ##BN,B                                              CSC042
     C                     END                                                                CSC042
      *                                                                                       CSC042
      * Update ##BSV  so next call to ##CHKB checks this latest adddition                     CSC042
      * to the array first                                                                    CSC042
     C                     Z-ADDB         ##BSV                                               CSC042
      *                                                                                       CSC042
     C                     ENDSR                                                              CSC042
      ********************************************************************                    CSC042
      /EJECT                                                                                  CSC042
      ********************************************************************                    CSC042
0497 C********************************************************************S01117
     C*                                                                   S01194
     C* *PSSR  --- SUBROUTINE TO HANDLE ABNORMAL ERROR CONDITIONS         S01194
     C*                                                                   S01194
     C* CALLED FROM: AFTER ABNORNAL OPERATION OCCURS                      S01194
     C*                                                                   S01194
     C* CALLS: NOTHING                                                    S01194
     C*                                                                   S01194
     C********************************************************************S01194
     C*                                                                   S01194
     C           *PSSR     BEGSR                           ** *PSSR **    S01194
     C*                                                                   S01194
     C           @RUN      IFEQ *BLANKS                                   S01194
     C                     MOVE 'Y'       @RUN    1                       S01194
     C                     DUMP                                           S01194
     C                     END                                            S01194
     C*                                                                   S01194
     C                     ENDSR                           ** *PSSR **    S01194
     C********************************************************************S01194
     C/COPY ZSRSRC,ZDATE2Z4                                               S01392
     C********************************************************************S01392
0622 C*
0623 O*
0624 O*  REPORT
0625 O*E0760P1D**103   50                                         S01124  S01117
0625 O*LE0760P1D**103   50 13 L2                                    S01117BHF252
0625 OLE0760P1D  103   50 13                                              BHF252
0626 O***********                        22 'REFERENCE  LE0760'           S01117
0626 O                                   24 'REFERENCE  LE0760P1'         S01117
0627 O                         TITL      89
0628 O                                  104 'DATE'
0629 O                         RUNA     113
0630 O                                  122 'PAGE'
0631 O                         PAGE  Z  128
0632 O********D*1      50                                                 S01117
0632 O********D*1      50 13 L2                                     S01117BHF252
0632 O        D 1      50 13                                              BHF252
0633 O***********                        11 'BRANCH'                      S01117
0634 O***********              BRCD      16                               S01117
0635 O***********                        63 'PARTICIPATIONS PURCHASED'    S01117
0636 O***********                        85 'OUTSTANDING BY SELLER'       S01117
0635 O                                   58 'PARTICIPATIONS PURCHASED'    S01117
0636 O                                   80 'OUTSTANDING BY SELLER'       S01117
0421 O                       88          88 'BRANCH'                      S01117
0422 O                       88BRCA      92                               S01117
     O                       88          93 '-'                           S01117
     O                       88BRNM     123                               S01117
0637 O********D*1      50                                                 S01117
0637 O********D*1      50 13 L2                                     S01117BHF252
0637 O        D 1      50 13                                              BHF252
0638 O                                   58 '------------------------'    S01117
0639 O                                   80 '----------------------'      S01117
0638 O***********                        63 '------------------------'    S01117
0639 O***********                        85 '----------------------'      S01117
0640 O********D*1      50                                                 S01117
0640 O********D*1      50 13 L2                                     S01117BHF252
0640 O        D 1      50 13                                              BHF252
0641 O                                   82 'PRINCIPAL'
0642 O********D*11     50                                                 S01117
0642 O********D*11     50 13 L2                                     S01117BHF252
0642 O        D 11     50 13                                              BHF252
0643 O                                   13 'SELLER'
0644 O                                   38 'BORROWER'
0645 O                                   63 'LOAN   CCY   RATE'
0646 O                                   79 'BAL'
0647 O                                  103 'ACCRUED INT'
0648 O                                  116 'PURCH.'
0649 O                                  125 'MAT.'
0650 O********D*3      50 05N51                                           S01117
0651 O*******AND*     NU7                                                 S01117
0652 O***********                        77 '* NO DETAILS TO REPORT *'    S01117
0653 O** DETAIL REC LINES
0654 O********D*1      03NL1                                              S01117
0654 O        D 1      03NL1 13                                           S01117
0655 O*******OR*2      03 L1                                              S01117
0655 O       OR 2      03 L1 13                                           S01117
0656 O                    L1   SELLER    21
0656 O                    50   SELLER    21                               BHF252
0657 O                         BORROW    44
0658 O                         LNRF      52
0659 O                         CCY       56
0660 O                         INTOUT    66 '0 .     '
0661 O                    24   CPAM      86 ' ,   ,   ,   , 0 '
0662 O                    25   CPAM      86 '   ,   ,   , 0 . '
0663 O                    26   CPAM      86 '  ,   ,   , 0 .  '
0664 O                    27   CPAM      86 ' ,   ,   , 0 .   '
0665 O                       30          87 '-'
0666 O                    24   INTA     106 ' ,   ,   ,   , 0 '
0667 O                    25   INTA     106 '   ,   ,   , 0 . '
0668 O                    26   INTA     106 '  ,   ,   , 0 .  '
0669 O                    27   INTA     106 ' ,   ,   , 0 .   '
0670 O                         PURDAT   116
0671 O                         MATDAT   126
0672 O********D*1      03                                                 S01117
0672 O        D 1      03 13                                              S01117
0673 O                    L1   SELNUM     7
0674 O                         BORNUM    30
0675 O********T*3      LRNU7 51                                           S01117
0676 O***********                        76 '*** END OF REPORT ***'       S01117
0677 O        T 3      LR U7 U8
     O       AND       13                                                 S01117
     O                                   74 '** DATABASE IN ERROR **'     S01117
0678 O***********                        42 '*** REFERENCE'               S01117
0679 O***********              DBPGM     51                               S01117
0680 O***********                        71 '-DATA BASE ERROR AT'         S01117
0680 O***********                        71 '-DATA BASE ERROR'            S01117
0681 O***********              DBASE     74                               S01117
0682 O********T*1      LR U7 U8                                           S01117
0683 O***********                        37 'FILE NAME'                   S01117
0684 O***********              DBFILE    43                               S01117
0685 O***********                        48 'KEY'                         S01117
0686 O***********              DBKEY     78                               S01117
0687 O*
     O        T 3      L2 13                                              S01117
     O                 88                66 '*** END OF REPORT FOR'       S01117
     O                 88                74 ' BRANCH '                    S01117
     O                 88      BRCA      77                               S01117
     O                 88                81 ' ***'                        S01117
0518 O                N88                76 '*** END OF REPORT ***'       S01117
0688 O*
0409 O        E   03           NODTL                                      S01117
0412 O                                   24 'REFERENCE  LE0760P1'         S01117
0413 O                         TITL      89                               S01117
0414 O                                  103 'DATE'                        S01117
0415 O                         RUNA     112                               S01117
0416 O                                  122 'PAGE'                        S01117
0417 O                         PAGE  3  128                               S01117
0632 O        E 2              NODTL                                      S01117
0635 O                                   58 'PARTICIPATIONS PURCHASED'    S01117
0636 O                                   80 'OUTSTANDING BY SELLER'       S01117
0421 O                       88          88 'BRANCH'                      S01117
0422 O                       88BRNCH     92                               S01117
     O                       88          93 '-'                           S01117
     O                       88BRNM     123                               S01117
      *                                                                   S01117
0637 O        E 1              NODTL                                      S01117
0638 O                                   58 '------------------------'    S01117
0639 O                                   80 '----------------------'      S01117
     O        E 3     NU7N56   NODTL                                      S01117
     O                                   63 '***   NO DETAILS TO REPO'    S01117
     O                                   71 'RT   ***'                    S01117
     O        E 3      U8 U7   NODTL                                      S01117
     O                                   74 '** DATABASE IN ERROR **'     S01117
     O        E 3              NODTL                                      S01197
     O                 88                66 '*** END OF REPORT FOR'       S01117
     O                 88                74 ' BRANCH '                    S01117
     O                 88      BRNCH     77                               S01117
     O                 88                81 ' ***'                        S01117
0518 O                N88                76 '*** END OF REPORT ***'       S01117
0689 O*
0690 O******** CONTROL REPORT *******
0691 O*
0692 O*E0760P1T**103   LR                                       S01124    S01117
0692 OLE0760AUT  103   LR                                                 S01117
0693 O***********                        22 'REFERENCE LE0760'            S01117
0693 O                                   24 'REFERENCE LE0760AU'          S01117
0694 O                         TITL      89
0695 O                                  104 'DATE'
0696 O                         RUNA     112
0697 O                                  122 'PAGE'
0698 O***********              PAGE  Z  127                               S01117
0698 O                         PAGE1 Z  127                               S01117
0699 O        T 1      LR
0700 O                                   55 'PARTICIPATIONS PURCHASED'
0701 O                                   69 'OUTSTANDING B'
0702 O                                   93 'Y SELLER - FILE CONTROLS'
0703 O        T 13     LR
0704 O                                   55 '------------------------'
0705 O                                   69 '--------------'
0706 O                                   93 '------------------------'
0707 O        T 1         LR
0708 O                                   28 'S/SPARP- RUN CONTROLS'
0709 O                                   59 'NUMBER'
0710 O                                   84 'VALUE'
0711 O        T 11     LR
0712 O                                   28 '---------------------'
0713 O                                   59 'OF RECORDS'
0714 O                                   84 'OF RECORDS'
0715 O        T 11        LR
0716 O                                   29 'TOTAL RECORDS ON FILE'
0717 O                         NORP  3   59
0718 O                         HPWN  Z   81
0719 O                         HPDC      84
0720 O        T 13        LR
0721 O                                   29 'TOTAL RECORDS ON FILE'
0722 O                                   42 '- CALCULATED'
0723 O                         RECTOT3   59
0724 O                         ZZTOTIZ   81
0725 O                         ZZTOTD    84
0726 O                       43         111 '***   DIFFERENCE   ***'
     O        T 3      LRN56                                              S01117
     O                                   63 '***   NO DETAILS TO REPO'    S01117
     O                                   71 'RT   ***'                    S01117
0677 O        T 3      LR U7 U8                                           S01117
0678 O                                   42 '*** REFERENCE'               S01117
0679 O                         DBPGM     53                               S01117
0680 O                                   73 '-DATA BASE ERROR AT'         S01117
0681 O                         DBASE     77                               S01117
0682 O        T 1      LR U7 U8                                           S01117
0683 O                                   37 'FILE NAME'                   S01117
0481 O                         DBFILE    46                               S01117
0482 O                                   51 'KEY'                         S01117
0483 O                         DBKEY     81                               S01117
0727 O********T*3      LR                                                 S01117
0728 O***********                        76 '*** END OF REPORT ***'       S01117
** CPY@   **      OBJECT COPYRIGHT
(c) Finastra International Limited 2001
**   ZYDY - YEARS IN DAYS CUMALATIVE, FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMALATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
