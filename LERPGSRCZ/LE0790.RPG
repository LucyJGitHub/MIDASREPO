0001 H        1                                                           LE0790
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas LE Guarantees by loan report')                   *
0002 F********************************************************************LE0790
0003 F*                                                                  *LE0790
     F*  Midas   Customer Lending Module
0005 F*                                                                  *LE0790
0006 F*     LE0790 - LOANS AND GUARANTEES BY BRANCH REPORT               *LE0790
0007 F*                                                                  *LE0790
      *  (c) Finastra International Limited 2001                      *
0009 F*                                                                  *LE0790
      *  Last Amend No. MD050457           Date 06Mar19               *
      *  Prev Amend No. MD046248           Date 27Oct17               *
      *                 CLE141             Date 08Feb16               *
      *                 CLE134             Date 01Aug12               *
      *                 CLE148             Date 23Jul12               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      *                 CSC042             Date 16Feb09               *
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *                 246506             Date 10Apr07               *
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CSD031             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 217857             Date 06Jun06               *
      *                 198910             Date 06Jun06               *
      *                 206319             Date 06Jun06               *
      *                 CLE042             Date 06Sep05               *
      *                 CSW037A            Date 02May05               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 CLE025             Date 20Oct03               *
      *                 CGL029             Date 01Sep03               *
      * Midas Release 4.01.03 ----------------------------------------*
      *                 204037             Date 04Dec02               *
      * Midas Release 4 --------------- Base -------------------------*
      *                 193661             Date 12Jul01               *
      * Midas DBA 3.05 -----------------------------------------------*
     F*                 168442             Date 19Feb01               *
      * Midas DBA 3.03 -----------------------------------------------*
     F*                 168304             Date 10Mar00               *
      * Midas DBA 3.02 -----------------------------------------------*
     F*                 168267             Date 11Oct99               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
     F*                 060984             Date 15Oct98               *
     F*                 124245             Date 11Oct98               *
     F*                 S01194             Date 16Jan90               *
0010 F*                 S01117             Date 03Jun89               *S01117
0010 F*                     E80665             DATE  23/10/86            *LE0790
     F*                                                                  *
     F*------------------------------------------------------------------*
     F*                                                                  *
      *  MD050457 - Do not issue database error if customer is closed.*
      *             Patterned fix from 263371.                        *
      *  MD046248 - Finastra Rebranding                               *
      *  CLE141 - Currency and Location Business Day Convention       *
      *           (Recompile)                                         *
      *  CLE134 - Past Due Call Loan Processing (Recompile)           *
      *  CLE148 - Alpha Loan Reference                                *
      *  CSC042 - COB Performance Fixes.                              *
      *              This pgm calls AOCURRR0 230K times for just 5    *
      *              currencies at RZB sofia. Cache the data from AO  *
      *              pgm when it is read.                             *
      *  246506 - Previous fixes are contradictory and lead to output *
      *           of duplicate lines. If only the Loan ref differs,   *  *
      *           do not output the details again.                    *  *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  217857 - LE0790P2 producing several blank pages. Error was   *
      *           caused by gems fix 193661. Remove fix 193661 excpt  *
      *           for checking GUSN for detail printing. In LF/SGSCX  *
      *           move key field GUSN above key feld LNNO.            *
      *  198910 - Complete 193661.                                    *
      *           Details for which only the Loan Number is           *
      *           different are not output.                           *
      *  206319 - Add FCLN and  FCLNF as part of the key of SGSCX.    *
      *  CLE042 - Extended Loan Sub Type (Recompile)                  *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  CLE025 - Credit Lines (Recompile)                            *
      *  CGL029 - Increase Account Code to 10 digits                  *
     F*  204037 - For multi-branch facilities, branch specified at end*
     F*           of report differs from branch at the top.           *
      *     193661 - Only one collateral is reflected in LE0790P2.    *
     F*     168442 - DB err 004 in file FCLTYL1 when loan branch is   *
     F*              different from the facility branch.              *
     F*     168304 - Report LE0790P2 does not have Spool File Number  *
     F*              in PF/FCSFNOPD.  Move value of SFNUMA to ZSNUMA  *
     F*              before calling ZSFILE.                           *
     F*     060984 - Add codes missed by 124245.                      *
     F*     168267 - Correction to 124245, to add COLC to end of      *
     F*           GSCEXGG, to comply with standard coding practice.   *
     F*     124245 - Upgrade of 61326 and 60984 to DBA2.              *
     F*              Add additional report - Collateral by Facility   *
     F*              Read in collateral code field and print in the   *
     F*              report.                                          *
     F*     S01194 - STANDING DATA CHANGES                               *S01194
     F*     S01117 - MULTIBRANCHING                                       S01117
     F*     E80665 - INCORRECT EDIT WORD DOES NOT ALLOW FOR THE CURRENT  *E80665
     F*              PRINCIPAL BEING NEGATIVE (R11 TO R21 TRANSFER)      *E80665
0011 F*                                                                  *LE0790
0012 F********************************************************************LE0790
0011 F*                                                                  *LE0790
     F*  C R E A T I O N     P A R A M E T E R S                      *
     F*                                                               *
     F*                                                               *
     F*****************************************************************
0013 F*SGSCX   IP  F     128 18AI     6 DISK                       LE0790 124245
     F*SGSCX**IP**F**** 134 18AI     6 DISK                        124245 168267
     F*GSCX***IP**F**** 137 18AI     6 DISK                        168267 206319
     FSGSCX   IP  F     137 29AI     6 DISK                               206319
0014 F*TABLE***IF**F      96 12AI     2 DISK                              S01194
0015 F*CLINT***IF**F     256  7AI     2 DISK                              S01194
     FCLOAN   IF  F    1290  7AI     2 DISK                               168442
0015 FFCLTYL1 IF  E           K        DISK                               124245
0016 F*E0790P1O** F     132     OF     PRINTER                            S01117
0016 FLE0790P1O   F     132     OF     PRINTER      KINFDS SPOOL      UC  S01117
0016 FLE0790P2O   F     132     OB     PRINTER      KINFDS SPOOLA     UC  124245
0016 F*E0790AUO   F     132     OA     PRINTER                            S01117
     FLE0790AUO   F     132     OA     PRINTER      KINFDS SPOOLU         S01117
0011 F*                                                                  *LE0790
0017 F* ID F  C  H  L    FUNCTION OF INDICATORS                           LE0790
0018 F* 01            SGSCX - DETAIL                                      LE0790
0019 F* 02                  - TRAILER                                     LE0790
0020 F**10**********  TABLE,CLINT LIVE DETAIL                             S01194
0021 F*       11-14   LOAN CURRENCY DPS 0-3                               LE0790
0022 F*       15-18   COLLATERAL CURRENCY DPS 0-3                         LE0790
0023 F*       19      NO DETAILS TO REPORT                                LE0790
0024 F*       20      FIRST CYCLE                                         LE0790
0024 F*       21      NO DETAILS TO REPORT FOR FACILITY                   124245
0025 F*       24      DETAIL OUTPUT                                       LE0790
0026 F*       25      CONTROL SPACING AFTER OVERFLOW                      LE0790
      ********27******Printing of headers                                 193661 217857
0027 F********39      CHAIN FAIL                                          S01194
     F*       51      LOAN REPORT DETAIL LINE                             124245
     F*       52      FACILITY REPORT DETAIL LINE                         124245
     F*       75      REPORT FILE OPENED                                  S01117
     F********76***** AT LEAST ONE RECORD WRITEN                   S01117 124245
     F*       76      AT LEAST ONE RECORD WRITEN on the Loan Report       124245
     F*       77      AT LEAST ONE RECORD WRITEN on the Facility Report   124245
     F*       88      MBIN                                                S01117
0028 F*       90-99   STANDARD SUBROUTINES                                LE0790
0029 F*       U7,U8   STANDARD MIDAS USAGE                                LE0790
0030 F*             L1 - LOAN                                             LE0790
0031 F*             L2 - CUSTOMER                                         LE0790
0032 F*             L3 - BRANCH                                           LE0790
     E                    CPY@    1   1 80
     E                    CURR      150  3               Currency                             CSC042
     E                    #CDP      150  1 0             Decimal Places                       CSC042
0033 I**                                                                  LE0790
0034 I**   SORTED GUARANTEES AND LOANS EXTRACT FILE                       LE0790
0035 I**                                                                  LE0790
0036 ISGSCX   NS  01   1 CD                                               LE0790
0037 I                                        1   1 RECI                  LE0790
0038 I                                        2   3 REGC                  LE0790
0039 I                                        4   5 CTYC                  LE0790
0040 I***********                             6   8 BRCD  L3              S01117
0040 I                                        6   8 BRCA  L3              S01117
0041 I**********                              9  140CNUM  L2              LE0790              CSD027
0041 I                                        9  14 CNUM  L2              LE0790              CSD027
0042 I**********                             15  200LNNO  L1                           LE0790 CLE148
     I                                       15  20 LNNO  L1                                  CLE148
0043 I                                       21  230GUSN                  LE0790
0044 I**********                             24  290GBCN                  LE0790              CSD027
0044 I                                       24  29 GBCN                  LE0790              CSD027
0045 I                                       30  32 CCY                   LE0790
0046 I                                    P  33  390UAMT                  LE0790
0047 I                                    P  40  420NOUN                  LE0790
0048 I                                    P  43  490TAMT                  LE0790
0049 I                                       50  84 NARR                  LE0790
0050 I                                       85  85 GSCI                  LE0790
0051 I                                       86  88 CCYL                  LE0790
0052 I                                    P  89  950CPAM                  LE0790
0052 I***********                            96  98 COLC           124245 168267
0052 I                                      124 1260FACT                  124245
0052 I                                      127 1280FCNO                  124245
0052 I                                      124 1280FCLNF                 124245
0052 I**********                            129 1340FCLN                               124245 CSD027
0052 I                                      129 134 FCLN                                      CSD027
0052 I                                      135 137 COLC                  168267
0053 I        NS  02   1 CT                                               LE0790
0054 I                                        1   1 RECI                  LE0790
0055 I                                    P   2   40NORE                  LE0790
0056 I                                    P   5  120HRWN                  LE0790
0057 I                                    P  13  140HRDC                  LE0790
0058 I        NS                                                          LE0790
     I*                                                                   124245
     I* Facility Details File                                             124245
     I*                                                                   124245
     ICLOAN   NS  04                                                      168442
     I                                        2   6 LLNRF                 168442
     I                                        7   7 LRCDT                 168442
     I                                      278 280 LFCLB                 168442
     I*                                                                   168442
     IFCLTYFMF                                                            124245
     I              CNUM                            FCNUM                 124245
     I              BRCA                            FBRCA                                     204037
0059 I**************                                                      S01194
0060 I*****TABLE*FILE - INSTALLATION CONTROL DATA RECORD 1.               S01194
0061 I**************                                                      S01194
0062 I*TABLE***NS***    2 C0   3 C1  12 C1                                S01194
0063 I*******AND****  13 C0                                               S01194
0064 I**************                          1   1 RECI                  S01194
0065 I**************                         12  130RCDE                  S01194
0066 I**************                         14  66 TITL                  S01194
0067 I**************                         67  67 DATF                  S01194
0068 I***********                            68  700DFBR                  S01194
0069 I**************                         74  74 MODI1                 S01194
0070 I**************                         75  75 MODI2                 S01194
0071 I**************                         76  76 MODI3                 S01194
0072 I**************                      P  77  790RUND                  S01194
0073 I**************                         80  86 RUNA                  S01194
0074 I**************                         87  870SFLG                  S01194
0075 I**************                                                      S01194
0076 I*****TABLE*FILE - CURRENCIES RECORD 1.                              S01194
0077 I**************                                                      S01194
0078 I********NS**10   1 CD   2 C2   3 C0                                 S01194
0079 I*******AND****  13 C1                                               S01194
0080 I**************                          1   1 RECI                  S01194
0081 I**************                         13  130SREC                  S01194
0082 I**************                         14  27 CCNM                  S01194
0083 I**************                      P  28  348SPOT                  S01194
0084 I**************                         35  37 CCYS                  S01194
0085 I**************                         38  380CDP                   S01194
0086 I**************                         39  390TNOT                  S01194
0087 I**************                         40  40 DCCY                  S01194
0088 I**************                         41  44 SRC1                  S01194
0089 I**************                         45  48 SRC2                  S01194
0090 I**************                         49  520TACC                  S01194
0091 I**************                         53  560TEQV                  S01194
0092 I**************                         57  600SWQV                  S01194
0093 I**************                         61  640TAC4                  S01194
0094 I**************                         65  680TAC5                  S01194
0095 I**************                         69  69 HIND                  S01194
0096 I**************                      P  70  768PART                  S01194
0097 I**************                         77  780SSNO                  S01194
0098 I**************                      P  79  858ERLC                  S01194
0099 I********NS****                                                      S01194
0100 I**************                                                      S01194
0101 I*****CLIENT*FILE - CUSTOMER STANDING DATA RECORD.                   S01194
0102 I**************                                                      S01194
0103 I*CLINT***NS**10   1 CD   8 CA                                       S01194
0104 I**************                          1   1 RECI                  S01194
0105 I**************                          2   70CNUMC                 S01194
0106 I**************                          9  28 CRNM                  S01194
0107 I**************                         29  38 CTWN                  S01194
0108 I**************                         39  48 CSNM                  S01194
0109 I**************                         49  56 CASK                  S01194
0110 I**************                         57  68 TELX                  S01194
0111 I**************                         69  80 CSID                  S01194
0112 I**************                         81  82 ACOC                  S01194
0113 I**************                         83  83 CBSI                  S01194
0114 I**************                         84  85 CCTZ                  S01194
0115 I**************                         86  87 CLOC                  S01194
0116 I**************                         88  930CPAR                  S01194
0117 I*****FIELD*NAME CHANGED FOR PROGRAM                                 S01194
0118 I***********                            94  960BRCDC                 S01194
0119 I**************                         97  980LINS                  S01194
0120 I**************                         99 1010LIND                  S01194
0121 I**************                      P 102 1040DASU                  S01194
0122 I**************                      P 105 1070CDIC                  S01194
0123 I**************                      P 108 1100DADE                  S01194
0124 I**************                        111 111 CMIN                  S01194
0125 I**************                        112 112 CTYP                  S01194
0126 I**************                        113 124 TELF                  S01194
0127 I**************                        125 133 CHID                  S01194
0128 I****CLINT*FILE - CATCHALL                                           S01194
0129 I**************                                                      S01194
0130 I********NS****                                                      S01194
0131 I**************                                                      S01194
0132 I*****DATA*STRUCTURE - KEY TO CURRENCY RECORDS                       S01194
0133 I**************                                                      S01194
0134 I************DS                                                      S01194
0135 I**************                          1  12 CCYKEY                S01194
0136 I**************                          9  11 CCYD                  S01194
0137 I**   LOCAL DATA AREA FOR DATABASE ERROR IDENTIFICATION              LE0790
0138 ILDA        UDS                            256                       LE0790
0139 I***********                           134 138 DBFILE                S01117
0140 I***********                           139 167 DBKEY                 S01117
0141 I***********                           168 175 DBPGM                 S01117
0142 I***********                           176 1770DBASE                 S01117
0232 I                                      134 141 DBFILE                S01117
0233 I                                      142 170 DBKEY                 S01117
0234 I                                      171 180 DBPGM                 S01117
0235 I                                      181 1830DBASE                 S01117
     I**                                                                  S01117
     I**   FILE INFORMATION DATA STRUCTURE                                S01117
     I**                                                                  S01117
     ISPOOL       DS                                                      S01117
     I                                       83  92 SFILE                 S01117
     I                                    B 123 1240SFNUM                 S01117
     I**                                                                  124245
     ISPOOLA      DS                                                      124245
     I                                       83  92 SFILEA                124245
     I                                    B 123 1240SFNUMA                124245
     ISPOOLU      DS                                                      S01117
     I                                       83  92 SFILEU                S01117
     I                                    B 123 1240SFNUMU                S01117
     I****************                                                    S01117
     I*****SPOOL FILE INFORMATION DATA STRUCTURE                          S01117
     I*****                                                               S01117
     I*****       DS                                                      S01117
     I*****                                   1  42 SPLFA                 S01117
     I*****                                   1   8 SFILP                 S01117
     I*****                                   9  18 JBNMP                 S01117
     I*****                                  19  28 USERP                 S01117
     I*****                                  29  340JBNOP                 S01117
     I*****                                  35  390SPLNO                 S01117
     I*****                                  40  42 BRCHP                 S01117
     I**                                                                  S01117
     I** DATA AREA RUNDAT                                                 S01117
     I**                                                                  S01117
     IRUNDT       DS                                                      S01117
     I                                        1   7 RUNA                  S01117
     I                                    P   8  100RUND                  S01117
     I                                       11  11 SSF                   S01117
     I                                       12  12 DATF                  S01117
     I                                       13  13 MBIN                  S01117
     I**                                                                  S01194
     ISDBANK    E DSSDBANKPD                                              S01194
     I**  EXTERNAL DS FOR BANK CODES                                      S01194
     I              BJURPT                          TITL                  S01194
     I**                                                                  S01194
     I**                                                                  S01117
     ISDBRCH    E DSSDBRCHPD                                              S01117
     I              A8BRNM                          BRNM                  S01117
     I**  EXTERNAL DS FOR BRANCH CODES                                    S01117
     I**                                                                  S01194
     ISDCURR    E DSSDCURRPD                                              S01194
     I**  EXTERNAL DS FOR CURRENCY DETAILS                                S01194
     I              A6NBDP                          CDP                   S01194
     I**                                                                  S01194
     I**                                                                  S01194
     ISDCUST    E DSSDCUSTPD                                              S01194
     I**  EXTERNAL DS FOR CUSTOMER DETAILS                                S01194
     I              BBCRNM                          CRNM                  S01194
     I              BBCRTN                          CTWN                  S01194
     I              QQDFAC                          QQDFA1                                    CGL029
     I**                                                                  S01194
     I*                                                                   S01194
     IDSFDY     E DSDSFDY                                                 S01194
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01194
     I*                                                                   S01194
     IDSSDY     E DSDSSDY                                                 S01194
     I* SECOND DS FOR ACCESS PROGRAMS, LONG DATA STRUCTURE                S01194
     I*                                                                   S01194
     I**                                                                  S01117
0084 I/EJECT                                                              S01117
     C**********           MOVEACPY@      BIS@   80                                           CSC042
     C**                                                                  S01117
     C           *ENTRY    PLIST                                          S01117
     C                     PARM           SEQ     5         SEQUENCE NUM. S01117
     C                     PARM           BRNCH   3         BRANCH OR ALL S01117
      *                                                                   124245
      **  Key List for FCLTYL1 file                                       124245
      *                                                                   124245
     C           FCKEY     KLIST                                          124245
     C***********          KFLD           BRCA                     124245 168442
     C                     KFLD           @BRCA   3                       168442
     C                     KFLD           FCLN                            124245
     C                     KFLD           FACT                            124245
     C                     KFLD           FCNO                            124245
     C**                                                                  S01117
     C           *NAMVAR   DEFN RUNDAT    RUNDT                           S01117
     C                     IN   RUNDT                                     S01117
     C*    DEFINE LDA                                                     S01117
     C           *NAMVAR   DEFN           LDA                             S01117
     C           *LOCK     IN   LDA                                       S01117
0143 C   20                GOTO ENDFC                                     LE0790
0144 C***********          SETON                     2019                 LE0790
     C                     SETON                     201921               124245
     C                     MOVEACPY@      BIS@   80                                           CSC042
      * Set up index used by ccy arrays                                                       CSC042
     C                     Z-ADD0         ##QNDX                                              CSC042
      *                                                                                       CSC042
0145 C**                                                                  LE0790
0146 C**   FIRST CYCLE CALCS                                              LE0790
0147 C**                                                                  LE0790
     C           MBIN      IFEQ 'Y'                                       S01117
     C                     SETON                     88                   S01117
     C                     END                                            S01117
     C                     MOVE *BLANK    DBFILE                          S01117
     C                     MOVE *BLANK    DBKEY                           S01117
     C                     MOVE *BLANK    DBOPTN                          S01117
     C                     MOVE *BLANK    DBASE                           S01117
     C                     MOVEL'LE0790'  DBPGM                           S01117
0148 C                     EXSR ZSYSTM                                    LE0790
0149 C***99*********       SETON                     LRU7U8               S01194
0150 C***99*********       MOVE 'TABLE'   DBFILE                          S01194
0151 C***99*********       Z-ADD1         DBASE            DBASE 1        S01194
0152 C***99*********       MOVE ZTABKY    DBKEY                           S01194
0153 C   99                GOTO END                                       LE0790
0154 C**                                                                  LE0790
0155 C                     Z-ADD2         COUNT   50                      LE0790
     C                     Z-ADD2         COUNT1  50                      124245
     C                     Z-ADD2         COUNT2  50                      124245
     C*******************  Z-ADD10        WCTR    20                      193661 217857
0156 C                     Z-ADD0         HASHF  150                      LE0790
0157 C                     Z-ADD0         HASHL   30                      LE0790
0158 C**                                                                  LE0790
0159 C**************       MOVEL'20'      CCYKEY                          S01194
0160 C**************       MOVE '1'       CCYKEY                          S01194
0161 C**************       MOVE 'A'       CLIKEY  7                       S01194
0162 C           ENDFC     TAG                             ** ENDFC TAG **LE0790
0163 C**                                                                  LE0790
0164 C**   DETAIL PROCESSING                                              LE0790
0165 C**                                                                  LE0790
0166 C                     SETOF                     2425                 LE0790
     C                     SETOF                     5152                 124245
0167 C   02                SETON                     LR                   LE0790
     C********   *IN02     IFEQ '1'                                       193661 217857
     C********             MOVE '0'       *IN27                           193661 217857
     C********             ENDIF                                          193661 217857
0168 C  N01                GOTO END                                       LE0790
0169 C                     SETOF                     19                   LE0790
      *                                                                   124245
      ** If previous record facility and new record loan and not          124245
      ** change in customer - force change in customer/loan.              124245
      *                                                                   124245
     C           FCLNF     IFEQ *ZEROS                                    124245
     C           *IN51     ANDEQ*OFF                                      124245
     C           *INL2     ANDEQ*OFF                                      124245
     C                     SETON                     L1L2                 124245
     C                     END                                            124245
     C**                                                                  S01117
     C           *INL3     IFEQ '1'                                       S01117
     C                     CLOSELE0790P1                                  S01117
     C                     CLOSELE0790P2                                  124245
     C           BRNCH     IFEQ 'ALL'                                     S01117
     C           BRNCH     OREQ BRCA                                      S01117
     C           MBIN      ORNE 'Y'                                       S01117
     C***********          SETON                     7576          S01117 124245
     C                     SETON                     75                   124245
     C                     OPEN LE0790P1                                  S01117
     C                     OPEN LE0790P2                                  124245
     C**************       Z-ADD10        WCTR                            193661 217857
     C**                                                                  S01117
     C*    ENSURE REPORT SPOOL FILE RECORDED BY RCF                       S01117
     C**                                                                  S01117
     C                     Z-ADDSFNUM     ZSNUM   60                      S01117
     C                     OUT  LDA                                       S01117
      *                                                                   S01117
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           SEQ                             S01117
     C                     PARM BRCA      SENTY                           S01117
     C                     PARM           SFILE                           S01117
     C                     PARM           ZSNUM                           S01117
     C                     PARM           ZSERR   1                       S01117
      *                                                                   S01117
     C           *LOCK     IN   LDA                                       S01117
     C           ZSERR     IFEQ 'Y'                                       S01117
      **  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM       S01117
     C                     SETON                     U7U8LR               S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C**
     C                     Z-ADDSFNUMA    ZSNUMA  60                      168304
     C                     OUT  LDA                                       124245
     C                     CALL 'ZSFILE'                                  124245
     C                     PARM           SEQ                             124245
     C                     PARM BRCA      SENTY                           124245
     C                     PARM           SFILEA                          124245
     C                     PARM           ZSNUMA                          124245
     C                     PARM           ZSERR                           124245
      *                                                                   124245
     C           *LOCK     IN   LDA                                       124245
     C           ZSERR     IFEQ 'Y'                                       124245
      **  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM       124245
     C                     SETON                     U7U8LR               124245
     C                     RETRN                                          124245
     C                     END                                            124245
      *                                                                   124245
     C                     Z-ADD0         PAGE                            S01117
     C                     Z-ADD0         PAGE1                           S01117
     C                     Z-ADD0         PAGE2                           124245
     C** To get Branch Name                                               S01117
     C**********           CALL 'AOBRCHR0'                                             S01117 CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       S01117
     C                     PARM '*KEY   ' @OPTN   7                       S01117
     C                     PARM BRCA      @DSNB   3                       S01117
     C**********           PARM           SDBRCH                                       S01117 CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANK                                    S01117
     C                     SETON                     U7U8LR               S01117
     C                     MOVEL'SDBRCHPD'DBFILE                          S01117
     C                     MOVEL@DSNB     DBKEY            ***************S01117
     C                     MOVEL@OPTN     DBOPTN  7        * DBERROR 005 *S01117
     C                     MOVEL'005'     DBASE            ***************S01117
     C                     EXSR *PSSR                                     S01117
     C                     END                                            S01117
     C                     ELSE                                           S01117
     C                     SETOF                     75                   S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C           BRCA      ANDGTBRNCH                                     S01117
     C                     SETON                     LR                   S01117
     C                     END                                            S01117
     C                     END                                            S01117
      *                                                                   124245
      **  Reset comparison fields for facility reporting                  124245
      *                                                                   124245
     C                     Z-ADD*ZEROS    #FCLNF  50                      124245
     C**********           Z-ADD*ZEROS    #FCLN   60                                   124245 CSD027
     C                     MOVE *BLANKS   #FCLN   6                                           CSD027
     C***********          Z-ADD*ZEROS    #LNNO   60                                   198910 246506
     C                     Z-ADD*ZEROS    #GUSN   30                                          193661
     C                     END                                            S01117
0170 C**                                                                  LE0790
0171 C*****CHAIN*TO*CLINT*FOR*CUSTOMER*NAME*AND*TOWN*                     S01194
0171 C**   ACCESS SDCUSTPD FOR CUSTOMER NAME AND TOWN                     S01194
0172 C**                                                                  LE0790
0173 C***L2*********       MOVELCNUM      CLIKEY                          S01194
0173 C   L2                MOVELCNUM      CLIKEY 10                       S01194
0174 C   L2                EXSR CLICHN                                    LE0790
0175 C   L2N10             GOTO END                                       LE0790
0176 C   L2                MOVE CRNM      CRNMC  20                       LE0790
0177 C   L2                MOVE CTWN      CTWNC  10                       LE0790
0178 C**                                                                  LE0790
0179 C*****CHAIN*TO*CLINT*FOR*GUARANTOR*NAME*AND*TOWN*                    S01194
0179 C**   ACCESS SDCUSTPD FOR GUARANTOR NAME AND TOWN                    S01194
0180 C**                                                                  LE0790
0181 C                     MOVELGBCN      CLIKEY                          LE0790
0182 C                     EXSR CLICHN                                    LE0790
0183 C  N10                GOTO END                                       LE0790
0184 C                     MOVE CRNM      CRNMG  20                       LE0790
0185 C                     MOVE CTWN      CTWNG  10                       LE0790
0186 C**                                                                  LE0790
0187 C*****CHAIN*TO*TABLE*FOR*LOAN*CURRENCY*DPS*                          S01194
0187 C**   ACCESS SDCURRPD FOR LOAN CURRENCY DPS                          S01194
0188 C**                                                                  LE0790
0189 C***L1*********       MOVE CCYL      CCYD                            S01194
0189 C   L1                MOVE CCYL      CCYD    3                       S01194
0190 C   L1                EXSR TABCHN                                    LE0790
0191 C   L1N10             GOTO END                                       LE0790
0192 C   L1      CDP       COMP 1                      1112               LE0790
0193 C   L1      CDP       COMP 2                    14  13               LE0790
      *                                                                   124245
      ** Is current detail record a facility derived loan ?               124245
      ** If not a facility - set on loan output indicator                 124245
      *                                                                   124245
0197 C           FCLNF     IFEQ *ZEROS                                    124245
     C                     MOVE *ON       *IN51            Loan           124245
0199 C                     ELSE                                           124245
     C                     MOVE *OFF      *IN51            Facility       124245
0201 C                     END                                            124245
      *                                                                   124245
      ** If Facility record, check if new or already printed ?            124245
      *                                                                   124245
     C           *IN51     IFEQ *OFF                                      124245
     C           FCLNF     IFNE #FCLNF                                    124245
     C           FCLN      ORNE #FCLN                                     124245
     C***********LNNO      ORNE #LNNO                                                  198910 246506
     C           GUSN      ORNE #GUSN                                                         193661
     C***********          MOVE '0'       *IN27                           193661 217857
     C                     MOVE *ON       *IN52            Set print      124245
     C                     MOVE FCLNF     #FCLNF            indicator     124245
     C                     MOVE FCLN      #FCLN                           124245
     C***********          MOVE LNNO      #LNNO                                        198910 246506
     C                     MOVE GUSN      #GUSN                                               193661
     C**********           ADD  3         WCTR                            193661 217857
     C********** 60        SUB  WCTR      WCTR2   20                      193661 217857
     C********** WCTR2     IFLT 0                                         193661 217857
     C**********           MOVE '1'       *IN27                           193661 217857
     C**********           Z-ADD13        WCTR                            193661 217857
     C**********           END                                            193661 217857
     C                     EXSR FCLCHN                                    124245
0181 C*                                                                   124245
0181 C*  Retrieve Facility Customer Details                               124245
0181 C                     MOVELFCLN      CLIKEY                          124245
0182 C                     EXSR CLICHN                                    124245
0184 C                     MOVE CRNM      CRNMF  20                       124245
0185 C                     MOVE CTWN      CTWNF  10                       124245
     C                     MOVE *OFF      *IN21                           124245
0181 C*                                                                   124245
     C                     END                                            124245
     C                     END                                            124245
0194 C**                                                                  LE0790
0195 C*****CHAIN*TO*TABLE*FOR*GUARANTEE*CURRENCY*DPS*                     S01194
0195 C**  ACCESS SDCUSTPD FOR GUARANTEE CURRENCY DPS                      S01194
0196 C**                                                                  LE0790
0197 C                     MOVE CCY       CCYD                            LE0790
0198 C                     EXSR TABCHN                                    LE0790
0199 C  N10                GOTO END                                       LE0790
0200 C           CDP       COMP 1                      1516               LE0790
0201 C           CDP       COMP 2                    18  17               LE0790
0202 C**                                                                  LE0790
0203 C**   MAINTAIN HASH TOTALS                                           LE0790
0204 C**                                                                  LE0790
0205 C           COUNT     ADD  1         COUNT                           LE0790
0206 C                     Z-ADDHASHF     ZZTOTI                          LE0790
0207 C                     Z-ADDHASHL     ZZTOTD                          LE0790
0208 C                     MOVE TAMT      ZZAMT                           LE0790
0209 C                     EXSR GLZADD                                    LE0790
0210 C                     Z-ADDZZTOTI    HASHF                           LE0790
0211 C                     Z-ADDZZTOTD    HASHL                           LE0790
0212 C**                                                                  LE0790
      *                                                                   124245
      ** Add to counter if print a record (used for no details msg)       124245
      *                                                                   124245
0205 C           *IN51     IFEQ *ON                                       124245
0205 C                     MOVE *ON       *IN76                           124245
0205 C                     ADD  1         COUNT1                          124245
0205 C                     END                                            124245
0205 C           *IN52     IFEQ *ON                                       124245
0205 C                     MOVE *ON       *IN77                           124245
0205 C                     ADD  1         COUNT2                          124245
0205 C                     END                                            124245
0213 C                     SETON                     24                   LE0790
0214 C   24 OF             SETON                     25                   LE0790
0215 C           END       TAG                             ** END TAG ****LE0790
0216 C**                                                                  LE0790
0217 C**   LAST RECORD CALCS                                              LE0790
0218 C**                                                                  LE0790
     C**                                                                  S01117
     C**                                                                  S01117
     C** SET UP FOR CONTROL REPORT                                        S01117
     C**                                                                  S01117
     C**                                                                  S01117
     C*    ENSURE REPORT SPOOL FILE RECORDED BY RCF                       S01117
     C**                                                                  S01117
     CLR                   Z-ADDSFNUMU    ZSNUMU  60                      S01117
      *                                                                   S01117
     CLR                   OUT  LDA                                       S01117
     CLR                   CALL 'ZSFILE'                                  S01117
     CLR                   PARM           SEQ     5                       S01117
     CLR                   PARM *BLANK    SENTY   3                       S01117
     CLR                   PARM           SFILEU                          S01117
     CLR                   PARM           ZSNUMU                          S01117
     CLR                   PARM           ZSERR                           S01117
     CLR         *LOCK     IN   LDA                                       S01117
     CLR         ZSERR     IFEQ 'Y'                                       S01117
      **  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM       S01117
     CLR                   SETON                     U7U8LR               S01117
     CLR                   RETRN                                          S01117
     CLR                   END                                            S01117
     C**                                                                  S01117
     C**                                                                  S01117
     CLR         *IN75     IFEQ '0'                                       S01117
     CLR         BRNCH     ANDNE'ALL'                                     S01117
     CLR         *IN76     ANDEQ'0'                                       S01117
     CLR                   EXSR #ZZ                                       S01117
     CLR                   ELSE                                           S01117
     C**                                                                  S01117
     C***********COUNT     IFLE 2                                  S01117 124245
     CLR         COUNT1    IFLE 2                                         124245
     CLR                   SETON                     U8                   S01117
     CLRN75                OPEN LE0790P1                                  S01117
     CLR                   Z-ADDSFNUM     ZSNUM   60                      S01117
     CLR                   OUT  LDA                                       S01117
     CLR                   CALL 'ZSFILE'                                  S01117
     CLR                   PARM           SEQ     5                       S01117
     CLR                   PARM *BLANK    SENTY   3                       S01117
     CLR                   PARM           SFILE                           S01117
     CLR                   PARM           ZSNUM                           S01117
     CLR                   PARM           ZSERR                           S01117
     CLR         *LOCK     IN   LDA                                       S01117
     C**                                                                  S01117
     CLR         ZSERR     IFEQ 'Y'                                       S01117
      **  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM       S01117
     CLR                   SETON                     U7U8LR               S01117
     CLR                   RETRN                                          S01117
     CLR                   END                                            S01117
      *                                                                   S01117
     C***********          EXCPTNODTL                              S01117 124245
     CLR                   MOVE *ON       *IN19                           124245
     C**                                                                  S01117
     CLR                   SETOF                     U8                   S01117
     CLR                   END                                            S01117
     CLR                   END                                            S01117
      *                                                                   124245
      **  Check report by Facility that something has printed             124245
      *                                                                   124245
     CLR         *IN75     IFEQ '0'                                       124245
     CLR         BRNCH     ANDNE'ALL'                                     124245
     CLR         *IN77     ANDEQ'0'                                       124245
     CLR                   EXSR #ZZA                                      124245
     CLR                   ELSE                                           124245
     C**                                                                  124245
     CLR         COUNT2    IFLE 2                                         124245
     CLR                   SETON                     U8                   124245
     CLRN75                OPEN LE0790P2                                  124245
     CLR                   Z-ADDSFNUMA    ZSNUMA  60                      124245
     CLR                   OUT  LDA                                       124245
     CLR                   CALL 'ZSFILE'                                  124245
     CLR                   PARM           SEQ     5                       124245
     CLR                   PARM *BLANK    SENTY   3                       124245
     CLR                   PARM           SFILEA                          124245
     CLR                   PARM           ZSNUMA                          124245
     CLR                   PARM           ZSERR                           124245
     CLR         *LOCK     IN   LDA                                       124245
     C**                                                                  124245
     CLR         ZSERR     IFEQ 'Y'                                       124245
      **  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM       124245
     CLR                   SETON                     U7U8LR               124245
     CLR                   RETRN                                          124245
     CLR                   END                                            124245
      *                                                                   124245
     CLR                   MOVE *ON       *IN21                           124245
     C**                                                                  124245
     CLR                   SETOF                     U8                   124245
     CLR                   END                                            124245
     CLR                   END                                            124245
     C**                                                                  124245
     C**                                                                  124245
0219 CLR U7                GOTO ENDLR                                     LE0790
     CLR         MBIN      IFEQ 'Y'                                       S01117
     CLR         BRNCH     ANDEQ'ALL'                                     S01117
     CLR         MBIN      OREQ 'N'                                       S01117
0220 CLR         COUNT     COMP NORE                 U8U8                 LE0790
0221 CLRNU8      HASHF     COMP HRWN                 U8U8                 LE0790
0222 CLRNU8      HASHL     COMP HRDC                 U8U8                 LE0790
     CLR                   END                                            S01117
0223 C**                                                                  LE0790
0224 CLR         ENDLR     TAG                             ** ENDLR TAG **LE0790
0225 CLR U7                MOVE 'LE0790'  DBPGM                           LE0790
0226 C********************************************************************LE0790
0227 C*                                                                  *LE0790
0228 C*****TABCHN*SR.*TO*CHAIN*TO*TABLE*AND*SET*ERROR*                    S01194
0228 C*    TABCHN SR. TO ACCESS SDCURRPD AND SET ERROR                    S01194
0229 C*    INDICATORS IF RECORD NOT FOUND .                              *LE0790
0230 C*                                                                  *LE0790
0231 C           TABCHN    BEGSR                           ** TABCHN BEGSRLE0790
0232 C**                                                                  LE0790
0233 C**********           SETOF                     1039                 S01194
0233 C                     SETOF                     10                   S01194
0234 C***********CCYKEY    CHAINTABLE                39                   S01194
      * Are the details for this CCY already stored in the arrays                             CSC042
     C                     MOVELCCYD      ##KC                                                CSC042
     C                     EXSR ##CHKC                                                        CSC042
     C           ##FIC     IFEQ 'Y'                                                           CSC042
      * Found in the arrays so use the details from there                                     CSC042
     C                     EXSR ##SETC                                                        CSC042
      * Set On *IN10 to show record found                                                     CSC042
     C                     SETON                     10                                       CSC042
     C                     ELSE                                                               CSC042
     C                     CALL 'AOCURRR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C                     PARM           CCYD                         A  S01194
     C           SDCURR    PARM SDCURR    DSSDY                        B  S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     SETON                     LRU7U8               S01194
     C                     MOVE 'SDCURRPD'DBFILE                          S01194
     C                     Z-ADD3         DBASE            DBASE 3        S01194
     C                     MOVE CCYD      DBKEY                           S01194
     C                     MOVE @OPTN     DBOPTN  7                       S01194
     C                     ELSE                                           S01194
     C                     SETON                     10                   S01194
      * Found on the DB and not in the array so add to the array                              CSC042
     C                     EXSR ##ADDC                                                        CSC042
     C                     END                                            S01194
     C                     ENDIF                                                              CSC042
0235 C**N10*********       SETON                     LRU7U8               S01194
0236 C**N10*********       MOVE 'TABLE'   DBFILE                          S01194
0237 C**N10*********       Z-ADD3         DBASE            DBASE 3        S01194
0238 C**N10*********       MOVE CCYKEY    DBKEY                           S01194
0239 C**                                                                  LE0790
0240 C                     ENDSR                                          LE0790
0241 C*                                                                  *LE0790
0242 C********************************************************************LE0790
      /EJECT                                                                                  CSC042
     C********************************************************************                    CSC042
     C*                                                                                       CSC042
     C*  ##CHKC  - Check the currency details                                                 CSC042
     C*                                                                                       CSC042
     C********************************************************************                    CSC042
     C           ##CHKC    BEGSR                                                              CSC042
      *                                                                                       CSC042
     C           *LIKE     DEFN BJCYCD    ##KC                                                CSC042
     C           *LIKE     DEFN Q         ##QSV                                               CSC042
      *                                                                                       CSC042
      * Set off the currency found indicator                                                  CSC042
     C                     MOVEL*BLANK    ##FIC   1                                           CSC042
      *                                                                                       CSC042
      * Save the state of indicator 87 so it can be reset at the end                          CSC042
      * of the SR as it may be used elsewhere in the code                                     CSC042
     C           *IN87     IFEQ *ON                                                           CSC042
     C                     MOVEL'Y'       #IN87   1                                           CSC042
     C                     ELSE                                                               CSC042
     C                     MOVEL'N'       #IN87                                               CSC042
     C                     ENDIF                                                              CSC042
      *                                                                                       CSC042
     C                     SETOF                         87                                   CSC042
      *                                                                                       CSC042
      * Restore Q from ##QSV in case Q is used elsewhere in the code                          CSC042
     C                     Z-ADD##QSV     Q       40                                          CSC042
      *                                                                                       CSC042
      * Are we looking for the same details as the last time this                             CSC042
      * subroutine was called i.e. is Q already set correctly?                                CSC042
      * If so then use the data rather than do another LOKUP                                  CSC042
      * First make sure that we don't reference the 0th array element                         CSC042
     C           Q         IFEQ 0                                                             CSC042
     C                     Z-ADD1         Q                                                   CSC042
     C                     ENDIF                                                              CSC042
      * Now see if this search is same as last one performed                                  CSC042
      * If we have a match then seton 87 so the code after this                               CSC042
      * subroutine knows it can use Q directly                                                CSC042
     C           ##KC      IFEQ CURR,Q                                                        CSC042
     C                     SETON                         87                                   CSC042
     C                     ELSE                                                               CSC042
      * Otherwise hunt in the array and seton 87 if found                                     CSC042
     C                     Z-ADD1         Q                                                   CSC042
     C           ##KC      LOKUPCURR,Q                   87                                   CSC042
     C                     ENDIF                                                              CSC042
      *                                                                                       CSC042
      * Save Q for next time                                                                  CSC042
     C           *IN87     IFEQ *ON                                                           CSC042
     C                     Z-ADDQ         ##QSV                                               CSC042
      * Set the indicator to show the data was found                                          CSC042
     C                     MOVEL'Y'       ##FIC                                               CSC042
     C                     ENDIF                                                              CSC042
      *                                                                                       CSC042
      * Reset the state of indicator 87.                                                      CSC042
     C           #IN87     IFEQ 'Y'                                                           CSC042
     C                     MOVEL*ON       *IN87                                               CSC042
     C                     ELSE                                                               CSC042
     C                     MOVEL*OFF      *IN87                                               CSC042
     C                     ENDIF                                                              CSC042
      *                                                                                       CSC042
     C                     ENDSR                                                              CSC042
      *                                                                                       CSC042
     C********************************************************************                    CSC042
      /EJECT                                                                                  CSC042
     C********************************************************************                    CSC042
     C*                                                                                       CSC042
     C*  ##SETB  - Set up the SDCURRPD fields as expected by this program                     CSC042
     C*            from the array fields                                                      CSC042
     C*                                                                                       CSC042
     C********************************************************************                    CSC042
     C           ##SETC    BEGSR                                                              CSC042
     C*                                                                                       CSC042
     C                     MOVELCURR,Q    A6CYCD                                              CSC042
     C                     Z-ADD#CDP,Q    CDP                                                 CSC042
     C*                                                                                       CSC042
     C                     ENDSR                                                              CSC042
     C********************************************************************                    CSC042
      /EJECT                                                                                  CSC042
      ********************************************************************                    CSC042
      *                                                                                       CSC042
      * ##ADDC - Adds the SDCURRPD fields used in the code to the                             CSC042
      * arrays                                                                                CSC042
      *                                                                                       CSC042
     C           ##ADDC    BEGSR                                                              CSC042
      *                                                                                       CSC042
     C           *LIKE     DEFN Q         ##QNDX                                              CSC042
      * If there is still room in the array then add the details                              CSC042
     C           ##QNDX    IFLT 150                                                           CSC042
     C                     ADD  1         ##QNDX                                              CSC042
     C                     Z-ADD##QNDX    Q                                                   CSC042
     C                     MOVELA6CYCD    CURR,Q                                              CSC042
     C                     Z-ADDCDP       #CDP,Q                                              CSC042
     C                     ENDIF                                                              CSC042
      *                                                                                       CSC042
      * Update ##QSV so next call to ##CHKC checks this latest adddition                      CSC042
      * to the array firss                                                                    CSC042
     C                     Z-ADDQ         ##QSV                                               CSC042
      *                                                                                       CSC042
     C                     ENDSR                                                              CSC042
      ********************************************************************                    CSC042
      /EJECT                                                                                  CSC042
0243 C********************************************************************LE0790
0244 C*                                                                  *LE0790
0245 C*    CLICHN SR. TO CHAIN TO CLINT AND SET ERROR                    *LE0790
0246 C*    INDICATORS IF RECORD NOT FOUND.                               *LE0790
0247 C*                                                                  *LE0790
0248 C           CLICHN    BEGSR                           ** CLICHN BEGSRLE0790
0249 C**                                                                  LE0790
0250 C**********           SETOF                     1039                 S01194
0250 C                     SETOF                     10                   S01194
0251 C***********CLIKEY    CHAINCLINT                39                   S01194
      * If this lookup is for the same customer as the previous lookup                        CSC042
      * the reuse the data rather then call AOCUST yet again                                  CSC042
     C           *LIKE     DEFN BBCUST    ##LCUS                                              CSC042
     C           *LIKE     DEFN BBCUST    ##CUS6                                              CSC042
     C           *LIKE     DEFN CRNM      ##LCRN                                              CSC042
     C           *LIKE     DEFN CTWN      ##LCTW                                              CSC042
     C                     MOVELCLIKEY    ##CUS6                                              CSC042
     C           ##CUS6    IFEQ ##LCUS                                                        CSC042
     C                     MOVEL##LCRN    CRNM                                                CSC042
     C                     MOVEL##LCTW    CTWN                                                CSC042
     C                     SETON                     10                                       CSC042
     C                     ELSE                                                               CSC042
     C                     CALL 'AOCUSTR0'                                S01194
     C                     PARM '*MSG   ' @RTCD                           S01194
     C                     PARM '*KEY   ' @OPTN                           S01194
     C                     PARM           CLIKEY                          S01194
     C                     PARM '*CNUM  ' KEYSTS  7                       S01194
     C           SDCUST    PARM SDCUST    DSSDY                           S01194
     C           @RTCD     IFNE *BLANKS                                   S01194
     C           @RTCD     ANDNE'*CUSCLS'                                                   MD050457
     C                     SETON                     U7U8LR               S01194
     C                     MOVE 'SDCUSTPD'DBFILE           ***************S01194
     C                     MOVE CLIKEY    DBKEY            * DBERROR 02  *S01194
     C                     MOVE '02'      DBASE            ***************S01194
     C                     ELSE                                           S01194
     C                     SETON                     10                   S01194
     C                     MOVEL##CUS6    ##LCUS                                              CSC042
     C                     MOVELCRNM      ##LCRN                                              CSC042
     C                     MOVELCTWN      ##LCTW                                              CSC042
     C                     END                                            S01194
     C                     ENDIF                                                              CSC042
0252 C**N10*********       SETON                     LRU7U8               S01194
0253 C**N10*********       MOVE 'CLINT'   DBFILE                          S01194
0254 C**N10*********       Z-ADD2         DBASE            DBASE 2        S01194
0255 C**N10*********       MOVE CLIKEY    DBKEY                           S01194
0256 C**                                                                  LE0790
0257 C                     ENDSR                                          LE0790
0258 C*                                                                  *LE0790
0259 C********************************************************************LE0790
0260 C********************************************************************LE0790
0261 C* SUBROUTINE TO ADD AN AMOUNT (ZZAMT) TO THE TOTAL (ZZTOTI,ZZTOTD)  LE0790
0262 C*   IND '99' IS SET BY AN OVERFLOW ERROR                            LE0790
0263 C*                                                                   LE0790
0264 CSR         GLZADD    BEGSR                           *** GLZADD ****LE0790
0265 C*                                                                   LE0790
0266 CSR                   Z-ADDZZAMT     ZZAMT  153     91-DEFINE ZZAMT  LE0790
0267 CSR 91                GOTO ZZAEND                     AMT = 0.BYPASS LE0790
0268 C*                                                                   LE0790
0269 C* SPLIT ZZAMT INTO INTEGER AND DECIMAL FIELDS                       LE0790
0270 CSR                   Z-ADDZZAMT     ZZAMTI 150       INTEGER FIELD  LE0790
0271 CSR                   MOVE ZZAMT     ZZAMTD  30       DECIMAL FIELD  LE0790
0272 C* BOTH ZZAMTI AND ZZAMTD CONTAIN A 'SIGN' ZONE NOW                  LE0790
0273 C*                                                                   LE0790
0274 CSR                   EXSR GLZSUM                                    LE0790
0275 CSR         ZZAEND    ENDSR                           ** ZZAEND TAG *LE0790
0276 C*                                                                   LE0790
0277 C********************************************************************LE0790
0278 C********************************************************************LE0790
0279 C* SUBROUTINE TO CARRY OUT THE ADDITION FOR SUBROUTINES -            LE0790
0280 C*                        GLZADD, GLZSUB, GLZCMP.                    LE0790
0281 C*          PARAMETERS PASSED -                                      LE0790
0282 C*                     I/P ZZAMTI ZZAMTD                             LE0790
0283 C*                     O/P ZZTOTI ZZTOTD ZZNEGD IND 96 IND 99.       LE0790
0284 C*                                                                   LE0790
0285 CSR         GLZSUM    BEGSR                           *** GLZSUM ****LE0790
0286 C*                                                                   LE0790
0287 CSR                   Z-ADDZZTOTI    ZZTOTI 150       DEFINE ZZTOTI  LE0790
0288 CSR                   Z-ADDZZTOTD    ZZTOTD  30       DEFINE ZZTOTD  LE0790
0289 CSR                   SETOF                     919293               LE0790
0290 CSR                   SETOF                     949599               LE0790
0291 C*                                                                   LE0790
0292 C*    DETERMINE SIGN OF ZZAMTI & D,   92 IF NEG                      LE0790
0293 CSR         ZZAMTI    COMP 0                      9293               LE0790
0294 CSR 93      ZZAMTD    COMP 0                      9293               LE0790
0295 CSR 93                GOTO ZZSEND                     ZERO BYPASS    LE0790
0296 C*                                                                   LE0790
0297 C*    DETERMINE SIGN OF ZZTOTI & D, 91 IF NEG.                       LE0790
0298 CSR         ZZTOTI    COMP 0                      9193               LE0790
0299 CSR 93      ZZTOTD    COMP 0                      9193               LE0790
0300 C*                                                                   LE0790
0301 C*    IF ZZTOTAL IS ZERO, RETURN ZZAMOUNT.                           LE0790
0302 CSR 93                Z-ADDZZAMTI    ZZTOTI                          LE0790
0303 CSR 93                Z-ADDZZAMTD    ZZTOTD                          LE0790
0304 CSR 93                GOTO ZZSEND                     ZERO BYPASS    LE0790
0305 C*    IF SIGNS DIFFER BYPASS OVERFLOW CHECKS.                        LE0790
0306 CSR 91N92                                                            LE0790
0307 CORN91 92             GOTO ZZOFPS                                    LE0790
0308 C*                                                                   LE0790
0309 CSR         ZZAMTD    ADD  ZZTOTD    ZZWK2   40                      LE0790
0310 CSR         ZZWK2     COMP 999                  93    '93' = CARRY   LE0790
0311 CSRN93      ZZWK2     COMP -999                   93    INTO INTEGER.LE0790
0312 C*                                                                   LE0790
0313 CSR 93N92   ZZAMTI    ADD  1         ZZWK3  150       ADD 'CARRY' +VELE0790
0314 CSR    93 92ZZAMTI    SUB  1         ZZWK3            SUB 'CARRY' -VELE0790
0315 CSR 93      ZZTOTI    ADD  ZZWK3     ZZWK3                           LE0790
0316 CSRN93      ZZTOTI    ADD  ZZAMTI    ZZWK3                           LE0790
0317 C*                                                                   LE0790
0318 C* IF THE MODULUS OF ZZWK3 IS LT MOD. ZZTOTI THEN O/F HAS OCCURED    LE0790
0319 CSRN92      ZZWK3     COMP ZZTOTI                 99  -92 MEANS NOS. LE0790
0320 CSR 92      ZZWK3     COMP ZZTOTI               99     NEGATIVE      LE0790
0321 CSRN99                Z-ADDZZWK2     ZZTOTD                          LE0790
0322 CSRN99                Z-ADDZZWK3     ZZTOTI                          LE0790
0323 C*                                                                   LE0790
0324 C* IF O/F ZEROIZE ZZAMT , IND '99' SET AND ZZTOT FIELDS LEFT INTACT. LE0790
0325 CSR 99                Z-ADD0         ZZAMT  153                      LE0790
0326 CSR                   GOTO ZZSEND                                    LE0790
0327 C*                                                                   LE0790
0328 C* THE 'SIGNS' ARE DIFFERENT                                         LE0790
0329 CSR         ZZOFPS    TAG                             ** ZZOFPS TAG**LE0790
0330 C* IF ZZAMT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZTOT            LE0790
0331 C*                                                                   LE0790
0332 CSR 92                Z-SUBZZAMTI    ZZAMTI 150                      LE0790
0333 CSR 92                Z-SUBZZAMTD    ZZAMTD  30                      LE0790
0334 C*                                                                   LE0790
0335 C* IF ZZTOT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZAMT.           LE0790
0336 C*                                                                   LE0790
0337 CSR 91                Z-SUBZZTOTI    ZZTOTI                          LE0790
0338 CSR 91                Z-SUBZZTOTD    ZZTOTD                          LE0790
0339 C* BOTH ZZAMT AND ZZTOT ARE NOW POSITIVE.                            LE0790
0340 C*                                                                   LE0790
0341 CSR         ZZTOTI    COMP ZZAMTI               93  95               LE0790
0342 CSR 95      ZZTOTD    COMP ZZAMTD               93  95               LE0790
0343 C*                                                                   LE0790
0344 C* IF ZZTOT EQ. ZZAMT RETURN ZERO.                                   LE0790
0345 CSR 95                Z-ADD0         ZZTOTI                          LE0790
0346 CSR 95                Z-ADD0         ZZTOTD                          LE0790
0347 CSR 95                GOTO ZZSEND                                    LE0790
0348 C*                                                                   LE0790
0349 C* IF ZZTOT GT. ZZAMT.                                               LE0790
0350 CSR 93      ZZAMTD    COMP ZZTOTD               94                   LE0790
0351 CSR 93 94   ZZTOTI    SUB  1         ZZTOTI                          LE0790
0352 CSR 93 94   ZZTOTD    ADD  1000      ZZWK2                           LE0790
0353 CSR 93      ZZTOTI    SUB  ZZAMTI    ZZTOTI                          LE0790
0354 CSR 93 94   ZZWK2     SUB  ZZAMTD    ZZTOTD                          LE0790
0355 CSR 93N94   ZZTOTD    SUB  ZZAMTD    ZZTOTD                          LE0790
0356 C*                                                                   LE0790
0357 C*                                                                   LE0790
0358 C* IF ZZAMT GT. ZZTOT.                                               LE0790
0359 CSRN93      ZZTOTD    COMP ZZAMTD               94                   LE0790
0360 CSRN93 94   ZZAMTI    SUB  1         ZZWK3  150                      LE0790
0361 CSRN93 94   ZZAMTD    ADD  1000      ZZWK2                           LE0790
0362 CSRN93 94   ZZWK3     SUB  ZZTOTI    ZZTOTI                          LE0790
0363 CSRN93N94   ZZAMTI    SUB  ZZTOTI    ZZTOTI                          LE0790
0364 CSRN93 94   ZZWK2     SUB  ZZTOTD    ZZTOTD                          LE0790
0365 CSRN93N94   ZZAMTD    SUB  ZZTOTD    ZZTOTD                          LE0790
0366 C*                                                                   LE0790
0367 C* REVERSE SIGN OF ZZTOT IF LARGER I/P FIELDS WERE NEGATIVE          LE0790
0368 CSR                   SETOF                     94                   LE0790
0369 CSR 93 91                                                            LE0790
0370 CORN93 92             SETON                     94                   LE0790
0371 CSR 94                Z-SUBZZTOTI    ZZTOTI                          LE0790
0372 CSR 94                Z-SUBZZTOTD    ZZTOTD                          LE0790
0373 C**                                                                  LE0790
0374 C**   RESTORE SIGN OF ZZAMTI & ZZAMTD IF IT WAS REVERSED.            LE0790
0375 CSR 92                Z-SUBZZAMTI    ZZAMTI                          LE0790
0376 CSR 92                Z-SUBZZAMTD    ZZAMTD                          LE0790
0377 CSR         ZZSEND    TAG                             ** ZZSEND TAG *LE0790
0378 C**                                                                  LE0790
0379 C**   IF ZZTOTD IS ZERO, AND ZZTOTI IS NEG. SET UP ZZNEGD.           LE0790
0380 CSR                   SETOF                     96                   LE0790
0381 CSR         ZZTOTD    COMP 0                        91               LE0790
0382 CSR 91      ZZTOTI    COMP 0                      96                 LE0790
0383 CSR 96                MOVE '.000-'   ZZNEGD  5                       LE0790
0384 CSR                   ENDSR                             ** ENDSR **  LE0790
0385 C********************************************************************LE0790
0386 C********************************************************************LE0790
0387 C**                                                                  LE0790
0388 C**   ZSYSTM SR. TO CHAIN TO THE INSTALLATION CONTROL DATA RECORD.   LE0790
0389 C**                                                                  LE0790
0390 C           ZSYSTM    BEGSR                           *** ZSYSTM *** LE0790
0391 C**************                                                      S01194
0392 C*****SET*UP*KEY FOR INSTALLATION CONTROL RECORD.                    S01194
0393 C**************       MOVEL'01      'ZTABKY 12                       S01194
0394 C**************       MOVE '  10'    ZTABKY                          S01194
0395 C**************                                                      S01194
0396 C***********ZTABKY    CHAINTABLE                99    ON NOT THERE   S01194
0397 C**N99******RECI      COMP 'D'                  9999  ON, IS DELETED S01194
     C**                                                                  S01194
     C**   ACCESS BANK DETAILS                                            S01194
     C**                                                                  S01194
     C                     CALL 'AOBANKR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDBANK    PARM SDBANK    DSFDY                           S01194
     C*                                                                   S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     SETON                     U7U8LR               S01194
     C                     SETON                     99                   S01194
     C                     MOVEL'SDBANKPD'DBFILE                          S01194
     C                     MOVEL@OPTN     DBKEY            ***************S01194
     C                     MOVEL@OPTN     DBOPTN  7        * DBERROR 001 *S01194
     C                     Z-ADD1         DBASE            ***************S01194
     C                     ELSE                                           S01194
0398 C**                                                                  LE0790
0399 C**   CHECK SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.                    LE0790
0400 C           DATF      COMP 'M'                      98MMDDYY, 98 ON  LE0790
     C                     END                                            S01194
0401 C**                                                                  LE0790
0402 C                     ENDSR                                          LE0790
0403 C**                                                                  LE0790
0404 C**                                                                  LE0790
0405 C********************************************************************LE0790
0226 C********************************************************************124245
0227 C*                                                                   124245
0229 C*    Retrieve Facility record.                                      124245
0230 C*                                                                   124245
0231 C           FCLCHN    BEGSR                                          124245
0232 C**                                                                  124245
      ** Get facility branch from loans file to ensure correct branch     168442
      ** in chaining to facility                                          168442
      *                                                                   168442
     C                     MOVELLNNO      LNKEY   7                       168442
     C                     MOVE 'A'       LNKEY                           168442
     C           LNKEY     CHAINCLOAN                38                   168442
     C           *IN38     IFEQ '1'                                       168442
     C                     MOVE BRCA      @BRCA                           168442
     C                     ELSE                                           168442
     C                     MOVE LFCLB     @BRCA                           168442
     C                     ENDIF                                          168442
      *                                                                   168442
0233 C                     SETOF                     10                   124245
0234 C           FCKEY     CHAINFCLTYFMF             39                   124245
     C*                                                                   124245
     C*  Data Base Error ?                                                124245
     C           *IN39     IFEQ *ON                                       124245
     C                     SETON                     LRU7U8               124245
     C                     MOVE 'FCLTYL1 'DBFILE           *******        124245
     C                     Z-ADD4         DBASE            DBASE 4        124245
     C                     MOVELBRCA      #WRK9   9        *******        124245
     C                     MOVE FCLN      #WRK9                           124245
     C                     MOVEL#WRK9     #WRK14 14                       124245
     C                     MOVE FCLNF     #WRK14                          124245
     C                     MOVE #WRK14    DBKEY                           124245
     C                     ELSE                                           124245
     C                     SETON                     10                   124245
     C                     END                                            124245
0239 C*                                                                   124245
0240 C                     ENDSR                                          124245
0241 C*                                                                   124245
0242 C********************************************************************124245
     C*                                                                   S01117
     C** PRINT OUT NO DETAIL TO REPORT IN LE0790P1                        S01117
     C*                                                                   S01117
0454 C           #ZZ       BEGSR                           *** NODETL *** S01117
     C**                                                                  S01117
     C                     OPEN LE0790P1                                  S01117
     C                     Z-ADD*ZEROS    PAGE                            S01117
     C                     MOVE BRNCH     BRCA                            S01117
     C                     MOVE *BLANKS   BRNM                            S01117
     C**                                                                  S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C           BRNCH     ANDNE'ALL'                                     S01117
     C                     MOVE BRNCH     SENTY                           S01117
     C                     ELSE                                           S01117
     C                     MOVE *BLANKS   SENTY                           S01117
     C                     END                                            S01117
     C**                                                                  S01117
     C                     Z-ADDSFNUM     ZSNUM   60                      S01117
     C**                                                                  S01117
     C                     OUT  LDA                                       S01117
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           SEQ                             S01117
     C                     PARM           SENTY                           S01117
     C                     PARM           SFILE                           S01117
     C                     PARM           ZSNUM                           S01117
     C                     PARM           ZSERR                           S01117
     C           *LOCK     IN   LDA                                       S01117
      *                                                                   S01117
     C           ZSERR     IFEQ 'Y'                                       S01117
      **  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM       S01117
     C                     SETON                     U7U8LR               S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
      *                                                                   S01117
     C** To get Branch Name                                               S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C           BRNCH     ANDNE'ALL'                                     S01117
     C**********           CALL 'AOBRCHR0'                                             S01117 CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       S01117
     C                     PARM '*KEY   ' @OPTN   7                       S01117
     C                     PARM BRNCH     @DSNB   3                       S01117
     C**********           PARM           SDBRCH                                       S01117 CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANK                                    S01117
     C                     SETON                     U7U8LR               S01117
     C                     MOVEL'SDBRCHPD'DBFILE                          S01117
     C                     MOVEL@DSNB     DBKEY            ***************S01117
     C                     MOVEL@OPTN     DBOPTN  7        * DBERROR 013 *S01117
     C                     MOVEL'013'     DBASE            ***************S01117
     C                     EXSR *PSSR                                     S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C                     EXCPTNODTL                                     S01117
0466 C                     ENDSR                                          S01117
     C*                                                                   S01117
0242 C********************************************************************124245
     C*                                                                   124245
     C** PRINT OUT NO DETAIL TO REPORT IN LE0790P2                        124245
     C*                                                                   124245
0454 C           #ZZA      BEGSR                           *** NODETL *** 124245
     C**                                                                  124245
     C                     OPEN LE0790P2                                  124245
     C                     Z-ADD*ZEROS    PAGE2                           124245
     C                     MOVE BRNCH     BRCA                            124245
     C                     MOVE *BLANKS   BRNM                            124245
     C**                                                                  124245
     C           MBIN      IFEQ 'Y'                                       124245
     C           BRNCH     ANDNE'ALL'                                     124245
     C                     MOVE BRNCH     SENTY                           124245
     C                     ELSE                                           124245
     C                     MOVE *BLANKS   SENTY                           124245
     C                     END                                            124245
     C**                                                                  124245
     C                     Z-ADDSFNUMA    ZSNUMA  60                      124245
     C**                                                                  124245
     C                     OUT  LDA                                       124245
     C                     CALL 'ZSFILE'                                  124245
     C                     PARM           SEQ                             124245
     C                     PARM           SENTY                           124245
     C                     PARM           SFILEA                          124245
     C                     PARM           ZSNUMA                          124245
     C                     PARM           ZSERR                           124245
     C           *LOCK     IN   LDA                                       124245
      *                                                                   124245
     C           ZSERR     IFEQ 'Y'                                       124245
      **  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM       124245
     C                     SETON                     U7U8LR               124245
     C                     RETRN                                          124245
     C                     END                                            124245
      *                                                                   124245
     C** To get Branch Name                                               124245
     C           MBIN      IFEQ 'Y'                                       124245
     C           BRNCH     ANDNE'ALL'                                     124245
     C**********           CALL 'AOBRCHR0'                                             124245 CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       124245
     C                     PARM '*KEY   ' @OPTN   7                       124245
     C                     PARM BRNCH     @DSNB   3                       124245
     C**********           PARM           SDBRCH                                       124245 CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANK                                    124245
     C                     SETON                     U7U8LR               124245
     C                     MOVEL'SDBRCHPD'DBFILE                          124245
     C                     MOVEL@DSNB     DBKEY            ***************124245
     C                     MOVEL@OPTN     DBOPTN  7        * DBERROR 014 *124245
     C                     MOVEL'014'     DBASE            ***************124245
     C                     EXSR *PSSR                                     124245
     C                     END                                            124245
     C                     END                                            124245
     C                     EXCPTNODTL2                                    124245
0466 C                     ENDSR                                          124245
     C*                                                                   124245
0497 C********************************************************************S01117
     C*                                                                   S01117
     C* *PSSR  --- SUBROUTINE TO HANDLE ABNORMAL ERROR CONDITIONS         S01117
     C*                                                                   S01117
     C* CALLED FROM: AFTER ABNORNAL OPERATION OCCURS                      S01117
     C*                                                                   S01117
     C* CALLS: NOTHING                                                    S01117
     C*                                                                   S01117
     C********************************************************************S01117
     C*                                                                   S01117
     C           *PSSR     BEGSR                           ** *PSSR **    S01117
     C*                                                                   S01117
     C           @RUN      IFEQ *BLANKS                                   S01117
     C                     MOVE 'Y'       @RUN    1                       S01117
     C                     DUMP                                           S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C                     ENDSR                           ** *PSSR **    S01117
     C********************************************************************S01117
0406 O**                                                                  LE0790
0407 O**  COLLATERAL BY LOAN REPORT                                       LE0790
0408 O**                                                                  LE0790
0409 O*E0790P1H** 03   OFNL3                                              S01117
0409 OLE0790P1H   03   OFNL3 75                                           S01117
0410 O*******OR**      L3                                                 S01117
0410 O       OR        L3 75                                              S01117
0411 O*******OR**      LR 19                                              S01117
0411 O       OR        L3 19 75                                           S01117
0412 O***********                        22 'REFERENCE  LE0790'           S01117
0412 O                                   24 'REFERENCE  LE0790P1'         S01117
0413 O                         TITL      89                               LE0790
0414 O                                  103 'DATE'                        LE0790
0415 O                         RUNA     112                               LE0790
0416 O                                  122 'PAGE'                        LE0790
0417 O                         PAGE  3  128                               LE0790
0418 O********H** 05   OFNL3                                              S01117
0418 O        H   05   OFNL3 75                                           S01117
0419 O*******OR**      L3                                                 S01117
0419 O       OR        L3 75                                              S01117
0420 O*******OR**      LR 19                                              S01117
0420 O       OR        L3 19 75                                           S01117
0423 O                                   70 'COLLATERAL BY LOAN'          LE0790
0421 O                       88          89 'BRANCH'                      S01117
0422 O                       88BRCA      93                               S01117
     O                       88          96 ' - '                         S01117
     O                       88BRNM     126                               S01117
0424 O********H** 06   OFNL3                                              S01117
0424 O        H   06   OFNL3 75                                           S01117
0425 O*******OR**      L3                                                 S01117
0425 O       OR        L3 75                                              S01117
0426 O*******OR**      LR 19                                              S01117
0426 O       OR        L3 19 75                                           S01117
0427 O                                   70 '------------------'          LE0790
0428 O********H** 08   OFNL3                                              S01117
0428 O        H   08   OFNL3 75                                           S01117
0429 O*******OR**      L3                                                 S01117
0429 O       OR        L3 75                                              S01117
0430 O*******OR**      LR 19                                              S01117
0430 O       OR        L3 19 75                                           S01117
0431 O                                   19 'BORROWER NAME/TOWN'          LE0790
0432 O***********                        33 'LOAN  CCY'                   060984
0432 O                                   31 'LOAN  CCY'                   060984
0433 O***********                        62 'CURRENT    G/S/C  SEQ.'      060984
0433 O                                   54 'CURRENT    G/S/C'            060984
0433 O                                   63 'CODE SEQ'                    060984
0434 O                                   77 'GIVEN BY'                    LE0790
0435 O                                  102 'CCY    UNIT AMOUNT'          LE0790
0436 O                                  127 'NO.UNITS  TOTAL AMOUNT'      LE0790
0437 O********H**009   OFNL3                                              S01117
0437 O        H  009   OFNL3 75                                           S01117
0438 O*******OR**      L3                                                 S01117
0438 O       OR        L3 75                                              S01117
0439 O*******OR**      LR 19                                              S01117
0439 O       OR        L3 19 75                                           S01117
0440 O***********                        48 'PRINCIPAL'                   060984
0440 O                                   46 'PRINCIPAL'                   060984
0441 O                                  110 'DESCRIPTION'                 LE0790
0442 O        D 21     24 L2N25                                           LE0790
     O*******AND*      75                                          S01117 124245
     O       AND       75 51                                              124245
0443 O       OR 11     24 L1NL2                                           LE0790
0444 O*******AND*     N25                                                 S01117
0444 O*******AND*     N25 75                                       S01117 124245
0444 O       AND      N25 75 51                                           124245
0445 O       OR  1     24NL1N25                                           LE0790
     O*******AND*      75                                          S01117 124245
     O       AND       75 51                                              124245
0446 O*******OR**111   25                                                 S01117
0446 O*******OR**111   25 75                                       S01117 124245
0446 O       OR  111   25 75 51                                           124245
0447 O***********            L2CRNMC     21                               060984
0448 O***********            L1LNNO      29                               060984
0449 O***********            L1CCYL      33                               060984
0447 O                       L2CRNMC     20                               060984
0448 O                       L1LNNO      27                               060984
0449 O                       L1CCYL      31                               060984
0450 O***********         L1 11CPAM      51 ' ,   ,   ,   , 0 '           E80665
0451 O***********         L1 12CPAM      51 '   ,   ,   , 0 . '           E80665
0452 O***********         L1 13CPAM      51 '  ,   ,   , 0 .  '           E80665
0453 O***********         L1 14CPAM      51 ' ,   ,   , 0 .   '           E80665
0450 O***********         L1 11CPAM      52 ' ,   ,   ,   , 0 -'   E80665 060984
0451 O***********         L1 12CPAM      52 '   ,   ,   , 0 . -'   E80665 060984
0452 O***********         L1 13CPAM      52 '  ,   ,   , 0 .  -'   E80665 060984
0453 O***********         L1 14CPAM      52 ' ,   ,   , 0 .   -'   E80665 060984
0450 O                    L1 11CPAM      50 ' ,   ,   ,   , 0 -'          060984
0451 O                    L1 12CPAM      50 '   ,   ,   , 0 . -'          060984
0452 O                    L1 13CPAM      50 '  ,   ,   , 0 .  -'          060984
0453 O                    L1 14CPAM      50 ' ,   ,   , 0 .   -'          060984
0454 O***********              GSCI      54                               060984
0454 O                         GSCI      52                               060984
0454 O                         COLC      59                               060984
0455 O***********              GUSN  3   61                               060984
0455 O                         GUSN  3   62                               060984
0456 O                         CRNMG     83                               LE0790
0457 O                         CCY       87                               LE0790
0458 O                       15UAMT     105 ' ,   ,   ,   , 0 '           LE0790
0459 O                       16UAMT     105 '   ,   ,   , 0 . '           LE0790
0460 O                       17UAMT     105 '  ,   ,   , 0 .  '           LE0790
0461 O                       18UAMT     105 ' ,   ,   , 0 .   '           LE0790
0462 O                         NOUN  3  111                               LE0790
0463 O                       15TAMT     130 ' ,   ,   ,   , 0 '           LE0790
0464 O                       16TAMT     130 '   ,   ,   , 0 . '           LE0790
0465 O                       17TAMT     130 '  ,   ,   , 0 .  '           LE0790
0466 O                       18TAMT     130 ' ,   ,   , 0 .   '           LE0790
0467 O********D**      24                                                 S01117
0467 O********D**      24 75                                       S01117 124245
0467 O        D        24 75 51                                           124245
0468 O***********            L2CTWNC     11                               060984
0468 O                       L2CTWNC     10                               060984
0469 O***********            L2CNUM      21                               060984
0469 O                       L2CNUM      20                               060984
0470 O                         CTWNG     73                               LE0790
0471 O                         GBCN      83                               LE0790
0472 O                         NARR     130                               LE0790
0473 O********T** 17   LR 19NU7                                           S01117
0473 O        T   17   L3 19NU7                                           S01117
     O       AND       75                                                 S01117
0474 O                                   76 'NO DETAILS TO REPORT'        LE0790
0475 O********T*32     LR U7                                              S01117
0475 O        T 32     L3 U7 75                                           S01117
     O                                   71 'DATABASE IN ERROR'           S01117
     OLE0790P1T 3      L3 75                                              S01117
     O***********                        66 '*** END OF BRANCH '          S01117
     O***********                        76 'REPORT ***'                  S01117
     O                 88                66 '*** END OF REPORT FOR'       S01117
     O                 88                74 ' BRANCH '                    S01117
     O                 88      BRCA      77                               S01117
     O                 88                81 ' ***'                        S01117
0518 O                N88                76 '*** END OF REPORT ***'       S01117
     O***                                                                 S01117
0476 O***********                        51 '*** REFERENCE LE0790'        S01117
0477 O***********                        71 '- DATABASE ERROR AT'         S01117
0478 O***********              DBASE     74                               S01117
0479 O********T**      LR U7                                              S01117
0480 O***********                        37 'FILENAME'                    S01117
0481 O***********              DBFILE    43                               S01117
0482 O***********                        48 'KEY'                         S01117
0483 O***********              DBKEY     78                               S01117
0409 OLE0790P1E   03           NODTL                                      S01117
0412 O                                   24 'REFERENCE  LE0790P1'         S01117
0413 O                         TITL      89                               S01117
0414 O                                  103 'DATE'                        S01117
0415 O                         RUNA     112                               S01117
0416 O                                  122 'PAGE'                        S01117
0417 O                         PAGE  3  128                               S01117
0418 O        E   05           NODTL                                      S01117
0423 O                                   70 'COLLATERAL BY LOAN'          S01117
0421 O                       88          89 'BRANCH'                      S01117
0422 O                       88BRNCH     93                               S01117
     O                       88          96 ' - '                         S01117
     O                       88BRNM     126                               S01117
0424 O        E   06           NODTL                                      S01117
0427 O                                   70 '------------------'          S01117
     O        E 3              NODTL                                      S01117
     O                                   63 '***   NO DETAILS TO REPO'    S01117
     O                                   71 'RT   ***'                    S01117
     O        E 3      U8 U7   NODTL                                      S01117
     O                                   74 '** DATABASE IN ERROR **'     S01117
     O        E 3              NODTL                                      S01117
     O                 88                66 '*** END OF REPORT FOR'       S01117
     O                 88                74 ' BRANCH '                    S01117
     O                 88      BRNCH     77                               S01117
     O                 88                81 ' ***'                        S01117
0518 O                N88                76 '*** END OF REPORT ***'       S01117
0484 O********T** 03   LR                                                 S01117
0407 O**                                                                  124245
0407 O**  COLLATERAL BY FACILITY REPORT                                   124245
0408 O**                                                                  124245
0409 OLE0790P2H   03   OBNL3 75                                           124245
0410 O       OR        L3 75                                              124245
     O*******OR        27                                                 193661 217857
0412 O                                   24 'REFERENCE  LE0790P2'         124245
0413 O                         TITL      89                               124245
0414 O                                  103 'DATE'                        124245
0415 O                         RUNA     112                               124245
0416 O                                  122 'PAGE'                        124245
0417 O                         PAGE2 3  128                               124245
0418 O        H   05   OBNL3 75                                           124245
0419 O       OR        L3 75                                              124245
     O****** OR        27                                                 193661 217857
0423 O                                   72 'COLLATERAL BY FACILITY'      124245
0421 O                       88          89 'BRANCH'                      124245
0422 O                       88BRCA      93                               124245
     O                       88          96 ' - '                         124245
     O                       88BRNM     126                               124245
0424 O        H   06   OBNL3 75                                           124245
0425 O       OR        L3 75                                              124245
     O*******OR        27                                                 193661 217857
0427 O                                   72 '----------------------'      124245
0428 O        H   08   OBNL3 75                                           124245
0429 O       OR        L3 75                                              124245
     O*******OR        27                                                 193661 217857
0431 O                                   19 'CUSTOMER NAME/TOWN'          124245
0432 O                                   42 'FACILITY'                    124245
0433 O                                   49 'CCY'                         124245
0433 O                                   66 'FACILITY'                    124245
0433 O                                   73 'G/S/C'                       124245
0434 O                                   82 'CODE SEQ'                    124245
0435 O                                  102 'CCY    UNIT AMOUNT'          124245
0436 O                                  127 'NO.UNITS  TOTAL AMOUNT'      124245
0437 O        H  109   OBNL3 75                                           124245
0438 O       OR        L3 75                                              124245
     O*******OR        27                                                 193661 217857
0440 O                                   37 'CUST.'                       124245
0440 O                                   44 'NO.'                         124245
0440 O                                   65 'AMOUNT'                      124245
0442 O        D 11     52 75                                              124245
0448 O                         CRNMF     20                               124245
0448 O                         CTWNF     31                               124245
0448 O                         FCLN      38                               124245
0448 O                         FCLNF     45 '   /  '                      124245
0449 O                         FCCY      49                               124245
0450 O                       11FAMT      68 ' ,   ,   ,   , 0 -'          124245
0451 O                       12FAMT      68 '   ,   ,   , 0 . -'          124245
0452 O                       13FAMT      68 '  ,   ,   , 0 .  -'          124245
0453 O                       14FAMT      68 ' ,   ,   , 0 .   -'          124245
0454 O                         GSCI      71                               124245
0455 O                         GUSN  3   82                               124245
0457 O                         CCY       87                               124245
0458 O                       15UAMT     105 ' ,   ,   ,   , 0 '           124245
0459 O                       16UAMT     105 '   ,   ,   , 0 . '           124245
0460 O                       17UAMT     105 '  ,   ,   , 0 .  '           124245
0461 O                       18UAMT     105 ' ,   ,   , 0 .   '           124245
0462 O                         NOUN  3  111                               124245
0463 O                       15TAMT     130 ' ,   ,   ,   , 0 '           124245
0464 O                       16TAMT     130 '   ,   ,   , 0 . '           124245
0465 O                       17TAMT     130 '  ,   ,   , 0 .  '           124245
0466 O                       18TAMT     130 ' ,   ,   , 0 .   '           124245
     O******* D  1     52 75                                              193661 217857
     O*******                            38 'Loan Ref:'                   193661 217857
     O*******                  LNNO      45                               193661 217857
     O*                                                                   124245
0473 O        T   17   L3 21NU7                                           124245
     O       AND       75                                                 124245
0474 O                                   76 'NO DETAILS TO REPORT'        124245
0475 O        T 32     L3 U7 75                                           124245
     O                                   71 'DATABASE IN ERROR'           124245
     O*                                                                   124245
     OLE0790P2T 3      L3 75                                              124245
     O                 88                66 '*** END OF REPORT FOR'       124245
     O                 88                74 ' BRANCH '                    124245
     O                 88      BRCA      77                               124245
     O                 88                81 ' ***'                        124245
0518 O                N88                76 '*** END OF REPORT ***'       124245
0409 OLE0790P2E   03           NODTL2                                     124245
0412 O                                   24 'REFERENCE  LE0790P2'         124245
0413 O                         TITL      89                               124245
0414 O                                  103 'DATE'                        124245
0415 O                         RUNA     112                               124245
0416 O                                  122 'PAGE'                        124245
0417 O                         PAGE2 3  128                               124245
0418 O        E   05           NODTL2                                     124245
0423 O                                   72 'COLLATERAL BY FACILITY'      124245
0421 O                       88          89 'BRANCH'                      124245
0422 O                       88BRNCH     93                               124245
     O                       88          96 ' - '                         124245
     O                       88BRNM     126                               124245
0424 O        E   06           NODTL2                                     124245
0427 O                                   72 '----------------------'      124245
     O        E 3              NODTL2                                     124245
     O                                   69 '***   NO DETAILS TO REPO'    124245
     O                                   77 'RT   ***'                    124245
     O        E 3      U8 U7   NODTL2                                     124245
     O                                   74 '** DATABASE IN ERROR **'     124245
     O        E 3              NODTL2                                     124245
     O                 88                66 '*** END OF REPORT FOR'       124245
     O                 88                74 ' BRANCH '                    124245
     O                 88      BRNCH     77                               124245
     O                 88                81 ' ***'                        124245
0518 O                N88                76 '*** END OF REPORT ***'       124245
     O*                                                                   124245
0484 OLE0790AUT   03   LR                                                 S01117
0485 O***********                        22 'REFERENCE LE0790'            S01117
0485 O                                   24 'REFERENCE LE0790AU'          S01117
0486 O                         TITL      89                               LE0790
0487 O                                  104 'DATE'                        LE0790
0488 O                         RUNA     112                               LE0790
0489 O                                  122 'PAGE'                        LE0790
0490 O***********              PAGE  3  127                               S01117
0490 O                         PAGE1 3  127                               S01117
0491 O        T   05   LR                                                 LE0790
0492 O                                   73 'COLLATERAL BY LOAN - FIL'    LE0790
0493 O                                   83 'E CONTROLS'                  LE0790
0494 O        T   06   LR                                                 LE0790
0495 O                                   73 '------------------------'    LE0790
0496 O                                   83 '----------'                  LE0790
0497 O        T   09   LR                                                 LE0790
0498 O                                   28 'S/SGSCX - RUN CONTROLS'      LE0790
0499 O                                   59 'NUMBER'                      LE0790
0500 O                                   84 'VALUE'                       LE0790
0501 O        T   10   LR                                                 LE0790
0502 O                                   28 '----------------------'      LE0790
0503 O                                   59 'OF RECORDS'                  LE0790
0504 O                                   84 'OF RECORDS'                  LE0790
0505 O        T   12   LR                                                 LE0790
0506 O                                   29 'TOTAL RECORDS ON FILE'       LE0790
0507 O                         NORE  3   59                               LE0790
0508 O                         HRWN  4   81                               LE0790
0509 O                         HRDC      84                               LE0790
0510 O        T   14   LR                                                 LE0790
0511 O                                   29 'TOTAL RECORDS ON FILE'       LE0790
0512 O                                   42 '- CALCULATED'                LE0790
0513 O                         COUNT 3   59                               LE0790
0514 O                         HASHF 4   81                               LE0790
0515 O                         HASHL     84                               LE0790
0516 O                   NU7 U8         111 '***   DIFFERENCE   ***'      LE0790
     O        T 3      LRNU7N76                                           S01117
     O                                   63 '***   NO DETAILS TO REPO'    S01117
     O                                   71 'RT   ***'                    S01117
     O        T 3      LR U7 U8                                           S01117
0476 O                                   51 '*** REFERENCE LE0790'        S01117
0477 O                                   71 '- DATABASE ERROR AT'         S01117
0478 O                         DBASE     76                               S01117
0479 O        T 1      LR U7                                              S01117
0480 O                                   37 'FILENAME'                    S01117
0481 O                         DBFILE    46                               S01117
0482 O                                   51 'KEY'                         S01117
0483 O                         DBKEY     81                               S01117
0517 O********T*  17   LR                                                 S01117
0518 O**********                         76 '*** END OF REPORT ***'       S01117
** CPY@   **      OBJECT COPYRIGHT
(c) Finastra International Limited 2001
