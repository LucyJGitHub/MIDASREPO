0001 H        1                                                           S01117
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas LE Facilities Extract')                          *
0001 H***********                                                         S01117
0002 F********************************************************************LE0840
     F*  Midas   Customer Lending Module
0004 F*                                                                  *LE0840
0005 F*    LE0840 - EXTRACT FACILITIES EXPIRING                          *LE0840
0006 F*                                                                  *LE0840
      *  (c) Misys International Banking Systems Ltd. 2001            *
0008 F*                                                                  *LE0840
      *  Last Amend No. AR787620           Date 10Jun11               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *  Prev Amend No. CSD027             Date 09Dec05               *
      *                 CLE042             Date 06Sep05               *
      *                 CLE041             Date 11Oct04               *
      *                 CGL029             Date 01Sep03               *
      * Midas Release 4.01 -------------------------------------------*
      *                 193603             Date 31Aug01               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 CLE004             Date 02Dec96               *
      *                 S01270             Date 22Mar91               *
     F*                 S01194             DATE 17JAN90               *
0009 F*                    S01117             DATE 03/10/89              *S01117
     F*                                                                  *LE0840
     F*------------------------------------------------------------------*LE0840
     F*                                                                  *LE0840
      *  AR787620 - Hooks Incorporation                               *
      *             WNCPYSRC,LEH00171                                 *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CLE042 - Extended Loan Sub Type (Recompile)                  *
      *  CLE041 - Collateralised Lending Phase 2B                     *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  193603 - Take negative facility amounts into consideration   *
     F*  CLE004 - Customer Lending Enhancements - Syndication         *
     F*    S01270 - CUSTOMER LENDING CHANGES                             *S01270
     F*    S01194 - STANDING DATA CHANGES                                *S01194
     F*    S01117 - MULTIBRANCHING                                       *S01117
0010 F*                                                                  *LE0840
0011 F********************************************************************LE0840
0012 F*                                                               *   LE0840
0013 F*                                                               *   LE0840
     F*  C R E A T I O N     P A R A M E T E R S                      *
     F*                                                               *
     F*                                                               *
     F*****************************************************************
0012 F*                                                                   LE0840
0013 F*                                                                   LE0840
0014 F*FCLTY***IP  F     256 12AI     2 DISK                       LE0840 CLE004
0014 F***FCLTY** IP  F     401 12AI     2 DISK                                         CLE004 CLE041
     FLEFCLTLKIP  F     401 12AI     2 DISK                                                   CLE041
     FLEAGFCL2IS  F     401 12AI     2 DISK                           U1                      CLE041
     FFCLTYZZ IS  F     256            DISK                                                   CLE041
     FLEAGFZPDIF  E                    DISK                                                   CLE041
     F            FCLTYZZF                          KRENAMEAGFCTYZF                           CLE041
0015 F*TABLE***IF  F      96 12AI     2 DISK                              S01194
     FEXPDUHH O   F      64            DISK
0016 FEXPDUEX O   F      64            DISK                               LE0840
     FEXPDUT2 O   F      64            DISK
0017 F*E0840P1O** F     132            PRINTER                  S01124    S01117
0017 FLE0840AUO   F     132     OV     PRINTER                            S01117
0018 F*                                                                   LE0840
0019 F* ID F  C  H  L    FUNTION OF INDICATORS                            LE0840
0020 F*                                                                   LE0840
0021 F* 01            FCLTY - HEADER RECORD                               LE0840
0022 F* 02                  - LIVE DETAIL RECORD 1 - ID='D'               LE0840
0023 F* 03                  - EXPRD   "     "    1 - ID='E'               LE0840
0024 F* 04                  - LIVE    "     "    2                        LE0840
0025 F* 05                  - EXPRD   "     "    2                        LE0840
0026 F* 06                  - TRAILER RECORD                              LE0840
0027 F**07******      TABLE - INST.CONTROL DATA REC.1                     S01194
0028 F* 08            FCLTY - DELETED RECORD                              LE0840
0029 F*                                                                   LE0840
0030 F*                                                                   LE0840
0031 F*       10      FIRST CYCLE INDICATOR                               LE0840
0032 F**                                                                  LE0840
0033 F*       12      WORK INDICATOR                                      LE0840
0034 F*       13        "      "    - REVIEW DATE BLANK                   LE0840
0035 F**                                                                  LE0840
0036 F*       21      EXPIRED RECORD                                      LE0840
0037 F*       22      EXPIRY DATE WITHIN 90 DAYS                          LE0840
0038 F*       23      REVIEW  "     "    "   "                            LE0840
0039 F**                                                                  LE0840
0040 F*       25      WORK INDICATOR - RECORDS IN CORRECT SEQUENCE        LE0840
0041 F*       26       "       "          "    "     "       "            LE0840
0042 F*       27       "       "          "    "     "       "            LE0840
0043 F*       28      FILE CONTROLS BALANCE                               LE0840
0044 F*       29      OUTPUT TO EXPDU DETAIL RECORD                       LE0840
     F*                                                               *   CLE004
     F*       30      SAR CLE004 is present                           *   CLE004
      *       31      End of File                                     *                       CLE041
0045 F**                                                                  LE0840
0046 F*       U8      FILE CONTROLS OUT OF BALANCE                        LE0840
0047 F*       U7U8    DATABASE ERROR                                      LE0840
     E                    CPY@    1   1 80
0048 I*                                                                   LE0840
0049 I*                                                                   LE0840
0050 I**   FACILITIES FILE - HEADER                                       LE0840
0051 I*                                                                   LE0840
0052 I***FCLTY** NS  01   1 CH                                                         LE0840 CLE041
     ILEFCLTLKNS  01   1 CH                                                                   CLE041
0053 I                                        1   1 RECI                  LE0840
0054 I*                                                                   LE0840
0055 I**   FACILITIES FILE - DETAIL RECORD 1                              LE0840
0056 I*                                                                   LE0840
0057 I        NS  02   1 CD  13 CA                                        LE0840
0058 I       OR   03   1 CE  13 CA                                        LE0840
0059 I                                        1   1 RECI                  LE0840
0060 I**********                              2   70CNUM                               LE0840 CSD027
0060 I                                        2   7 CNUM                                      CSD027
0061 I                                        8  100FACT                  LE0840
0062 I                                       11  120FCNO                  LE0840
0063 I                                       13  13 RCTP                  LE0840
0064 I***********                            14  160BRCD                  S01117
0064 I                                       14  16 BRCA                  S01117
0065 I                                       17  17 FCTI                  LE0840
0066 I                                       18  20 FCCY                  LE0840
0067 I                                    P  21  270FAMT                  LE0840
0068 I                                    P  28  303OVPC                  LE0840
0069 I                                    P  31  330DTAP                  LE0840
0070 I                                    P  34  360DTEX                  LE0840
0071 I                                       37  37 RVCR                  LE0840
0072 I                                       38  38 SECI                  LE0840
0073 I                                       39  39 MCCY                  LE0840
0074 I                                       40  40 MCSI                  LE0840
0075 I                                       41  41 NACD                  LE0840
0076 I                                       42  43 CRSK                  LE0840
0077 I                                    P  44  460DLFS                  LE0840
0078 I                                    P  47  527NOMR                  LE0840
0079 I                                    P  53  550RVDT                  LE0840
0080 I                                       56  56 RVFR                  LE0840
0081 I                                       57  580RVDY                  LE0840
0082 I                                       59  93 NAR1                  LE0840
0083 I                                       94 128 NAR2                  LE0840
0084 I                                      129 163 NAR3                  LE0840
0085 I                                      164 198 NAR4                  LE0840
0086 I                                    P 199 2050MTDH                  LE0840
0087 I                                    P 206 2120MTDL                  LE0840
0088 I                                    P 213 2190MTDA                  LE0840
0089 I                                    P 220 2270QTDA                  LE0840
0090 I                                    P 228 2350YTDA                  LE0840
0091 I                                      236 237 ACOF                  LE0840
     I                                    P 242 2440RVCD                  S01270
0092 I                                    P 247 2490ORED                  LE0840
0093 I                                    P 250 2520LCD                   LE0840
0094 I                                      253 253 CHTP                  LE0840
0095 I                                    P 254 2560TNLU                  LE0840
0095 I                                      401 401 PRTR                  CLE004
0096 I*  COMBINED FIELD FOR SEQUENCE CHECK                                LE0840
0097 I                                        1  12 DSA1                  LE0840
0098 I*  COMBINED FIELD FOR DATABASE REFERENCE                            LE0840
0099 I                                        2  13 KEY                   LE0840
0100 I*                                                                   LE0840
0101 I**   FACILITIES FILE - DETAIL RECORD 2                              LE0840
0102 I*                                                                   LE0840
0103 I        NS  04   1 CD  13 CB                                        LE0840
0104 I       OR   05   1 CE  13 CB                                        LE0840
0105 I                                        1   1 RECI                  LE0840
0106 I**********                              2   70CNUM                               LE0840 CSD027
0106 I                                        2   7 CNUM                                      CSD027
0107 I                                        8  100FACT                  LE0840
0108 I                                       11  120FCNO                  LE0840
0109 I                                       13  13 RCTP                  LE0840
0110 I                                       14  14 CMFT                  LE0840
0111 I                                       15  150CALC                  LE0840
0112 I                                    P  16  217SPRD                  LE0840
0113 I                                       22  230BCOD                  LE0840
0114 I                                    P  24  297BRAT                  LE0840
0115 I                                    P  30  320STDT                  LE0840
0116 I                                    P  33  350EDDT                  LE0840
0117 I                                    P  36  380DUDT                  LE0840
0118 I                                       39  39 BLFR                  LE0840
0119 I                                       40  410BLDN                  LE0840
0120 I                                       42  42 BTIN                  LE0840
0121 I                                       43  440BLDY                  LE0840
0122 I                                       45  460SETT                  LE0840
0123 I**********                             47  58 OBAC                               LE0840 CGL029
     I                                       47  58 QQOBAC                                    CGL029
0124 I                                       59  68 TNAC                  LE0840
0125 I                                    P  69  710SLCD                  LE0840
0126 I                                    P  72  740ACCD                  LE0840
0127 I                                    P  75  810ADNP                  LE0840
0128 I                                    P  82  880PDTD                  LE0840
0129 I                                    P  89  950AFPD                  LE0840
0130 I                                    P  96 1020ADJP                  LE0840
0131 I                                    P 103 1090ADJN                  LE0840
0132 I                                    P 110 1160TOTD                  LE0840
0133 I                                    P 117 1230CAMD                  LE0840
0134 I*****FIELD DOES NOT EXIST ON FCLTY  P 124 1300HFAM                  S01117
     I                                      130 130 MBFC                  S01117
0135 I                                    P 147 1490RUN0                  LE0840
0136 I                                    P 150 1520RUN1                  LE0840
0137 I                                    P 153 1550RUN2                  LE0840
0138 I                                    P 156 1580RUN3                  LE0840
0139 I                                    P 159 1610RUN4                  LE0840
0140 I                                    P 162 1640RUN5                  LE0840
0141 I                                    P 165 1670RUN6                  LE0840
0142 I                                    P 168 1700RUN7                  LE0840
0143 I                                    P 171 1730RUN8                  LE0840
0144 I                                    P 174 1760RUN9                  LE0840
0145 I                                    P 177 1830OAM1                  LE0840
0146 I                                    P 184 1900OAM2                  LE0840
0147 I                                    P 191 1970OAM3                  LE0840
0148 I                                    P 198 2040OAM4                  LE0840
0149 I                                    P 205 2110OAM5                  LE0840
0150 I                                    P 212 2180OAM6                  LE0840
0151 I                                    P 219 2250OAM7                  LE0840
0152 I                                    P 226 2320OAM8                  LE0840
0153 I                                    P 233 2390OAM9                  LE0840
0154 I                                    P 240 2460OA10                  LE0840
0155 I                                    P 247 2490ORED                  LE0840
0156 I                                    P 250 2520LCD                   LE0840
0157 I                                      253 253 CHTP                  LE0840
0158 I                                    P 254 2560TNLU                  LE0840
     I                                      331 348 OBAC                                      CGL029
     I/COPY WNCPYSRC,LEH00171
0095 I                                      401 401 PRTR                  CLE004
0159 I* COMBINED FIELD FOR SEQUENCE CHECK                                 LE0840
0160 I                                        1  12 DSB1                  LE0840
0161 I* COMBINED FIELD FOR DATABASE REFERENCE                             LE0840
0162 I                                        2  13 KEY                   LE0840
0163 I*****************************************************************                LE0840 CLE041
0164 I*****FACILITIES*FILE*-*TRAILER***********************************                LE0840 CLE041
0165 I*****************************************************************                LE0840 CLE041
0166 I********NS  06   1 CT                                                            LE0840 CLE041
0167 I**********                              1   1 RECI                               LE0840 CLE041
0168 I**********                          P  17  190NORE                               LE0840 CLE041
0169 I**********                          P  20  220FLSZ                               LE0840 CLE041
0170 I**********                          P  23  250NLRB                               LE0840 CLE041
0171 I**********                          P  26  280NINS                               LE0840 CLE041
0172 I**********                          P  29  310NDEL                               LE0840 CLE041
0173 I**********                          P  32  340NLRA                               LE0840 CLE041
0174 I**********                          P  35  420VLBF                               LE0840 CLE041
0175 I**********                          P  43  440VLBL                               LE0840 CLE041
0176 I**********                          P  45  520VRIF                               LE0840 CLE041
0177 I**********                          P  53  540VRIL                               LE0840 CLE041
0178 I**********                          P  55  620VRDF                               LE0840 CLE041
0179 I**********                          P  63  640VRDL                               LE0840 CLE041
0180 I**********                          P  65  720VRAF                               LE0840 CLE041
0181 I**********                          P  73  740VRAL                               LE0840 CLE041
0182 I**********                          P  75  820VLAF                               LE0840 CLE041
0183 I**********                          P  83  840VLAL                               LE0840 CLE041
0184 I**********                          P 250 2520LCD                                LE0840 CLE041
0185 I**********                            253 253 CHTP                               LE0840 CLE041
0186 I**********                          P 254 2560TNLU                               LE0840 CLE041
0187 I*                                                                   LE0840
0188 I*    FACILITIES FILE - DELETED RECORD                               LE0840
0189 I*                                                                   LE0840
0190 I        NS  08   1 C*                                               LE0840
0191 I                                        1   1 RECI                  LE0840
0192 I*                                                                   LE0840
0193 I*    FACILITIES FILE - CATCHALL                                     LE0840
0194 I*                                                                   LE0840
0195 I        NS                                                          LE0840
0196 I                                        1   1 RECI                  LE0840
      *                                                                                       CLE041
      ** Aggregate Facilities file - detail record 1                                          CLE041
      *                                                                                       CLE041
     ILEAGFCL2NS  02   1 CD  13 CA                                                            CLE041
     I       OR   03   1 CE  13 CA                                                            CLE041
     I                                        1   1 RECI                                      CLE041
     I**********                              2   70CNUM                               CLE041 CSD027
     I                                        2   7 CNUM                                      CSD027
     I                                        8  100FACT                                      CLE041
     I                                       11  120FCNO                                      CLE041
     I                                       13  13 RCTP                                      CLE041
     I                                       14  16 BRCA                                      CLE041
     I                                       17  17 FCTI                                      CLE041
     I                                       18  20 FCCY                                      CLE041
     I                                    P  21  270FAMT                                      CLE041
     I                                    P  28  303OVPC                                      CLE041
     I                                    P  31  330DTAP                                      CLE041
     I                                    P  34  360DTEX                                      CLE041
     I                                       37  37 RVCR                                      CLE041
     I                                       38  38 SECI                                      CLE041
     I                                       39  39 MCCY                                      CLE041
     I                                       40  40 MCSI                                      CLE041
     I                                       41  41 NACD                                      CLE041
     I                                       42  43 CRSK                                      CLE041
     I                                    P  44  460DLFS                                      CLE041
     I                                    P  47  527NOMR                                      CLE041
     I                                    P  53  550RVDT                                      CLE041
     I                                       56  56 RVFR                                      CLE041
     I                                       57  580RVDY                                      CLE041
     I                                       59  93 NAR1                                      CLE041
     I                                       94 128 NAR2                                      CLE041
     I                                      129 163 NAR3                                      CLE041
     I                                      164 198 NAR4                                      CLE041
     I                                    P 199 2050MTDH                                      CLE041
     I                                    P 206 2120MTDL                                      CLE041
     I                                    P 213 2190MTDA                                      CLE041
     I                                    P 220 2270QTDA                                      CLE041
     I                                    P 228 2350YTDA                                      CLE041
     I                                      236 237 ACOF                                      CLE041
     I                                    P 242 2440RVCD                                      CLE041
     I                                    P 247 2490ORED                                      CLE041
     I                                    P 250 2520LCD                                       CLE041
     I                                      253 253 CHTP                                      CLE041
     I                                    P 254 2560TNLU                                      CLE041
     I                                      401 401 PRTR                                      CLE041
      *                                                                                       CLE041
      ** Combined field for sequence check                                                    CLE041
     I                                        1  12 DSA1                                      CLE041
      *                                                                                       CLE041
      ** Combined field for database message                                                  CLE041
     I                                        2  13 KEY                                       CLE041
      *                                                                                       CLE041
      ** Aggregate Facilities File - Detail Record 2                                          CLE041
      *                                                                                       CLE041
     I        NS  04   1 CD  13 CB                                                            CLE041
     I       OR   05   1 CE  13 CB                                                            CLE041
     I                                        1   1 RECI                                      CLE041
     I**********                              2   70CNUM                               CLE041 CSD027
     I                                        2   7 CNUM                                      CSD027
     I                                        8  100FACT                                      CLE041
     I                                       11  120FCNO                                      CLE041
     I                                       13  13 RCTP                                      CLE041
     I                                       14  14 CMFT                                      CLE041
     I                                       15  150CALC                                      CLE041
     I                                    P  16  217SPRD                                      CLE041
     I                                       22  230BCOD                                      CLE041
     I                                    P  24  297BRAT                                      CLE041
     I                                    P  30  320STDT                                      CLE041
     I                                    P  33  350EDDT                                      CLE041
     I                                    P  36  380DUDT                                      CLE041
     I                                       39  39 BLFR                                      CLE041
     I                                       40  410BLDN                                      CLE041
     I                                       42  42 BTIN                                      CLE041
     I                                       43  440BLDY                                      CLE041
     I                                       45  460SETT                                      CLE041
     I                                       47  58 OBACQQ                                    CLE041
     I                                       59  68 TNAC                                      CLE041
     I                                    P  69  710SLCD                                      CLE041
     I                                    P  72  740ACCD                                      CLE041
     I                                    P  75  810ADNP                                      CLE041
     I                                    P  82  880PDTD                                      CLE041
     I                                    P  89  950AFPD                                      CLE041
     I                                    P  96 1020ADJP                                      CLE041
     I                                    P 103 1090ADJN                                      CLE041
     I                                    P 110 1160TOTD                                      CLE041
     I                                    P 117 1230CAMD                                      CLE041
     I                                      130 130 MBFC                                      CLE041
     I                                    P 132 1380PEXP                                      CLE041
     I                                    P 147 1490RUN0                                      CLE041
     I                                    P 150 1520RUN1                                      CLE041
     I                                    P 153 1550RUN2                                      CLE041
     I                                    P 156 1580RUN3                                      CLE041
     I                                    P 159 1610RUN4                                      CLE041
     I                                    P 162 1640RUN5                                      CLE041
     I                                    P 165 1670RUN6                                      CLE041
     I                                    P 168 1700RUN7                                      CLE041
     I                                    P 171 1730RUN8                                      CLE041
     I                                    P 174 1760RUN9                                      CLE041
     I                                    P 177 1830OAM1                                      CLE041
     I                                    P 184 1900OAM2                                      CLE041
     I                                    P 191 1970OAM3                                      CLE041
     I                                    P 198 2040OAM4                                      CLE041
     I                                    P 205 2110OAM5                                      CLE041
     I                                    P 212 2180OAM6                                      CLE041
     I                                    P 219 2250OAM7                                      CLE041
     I                                    P 226 2320OAM8                                      CLE041
     I                                    P 233 2390OAM9                                      CLE041
     I                                    P 240 2460OA10                                      CLE041
     I                                    P 247 2490ORED                                      CLE041
     I                                    P 250 2520LCD                                       CLE041
     I                                      253 253 CHTP                                      CLE041
     I                                    P 254 2560TNLU                                      CLE041
     I                                    P 257 2630CEXP                                      CLE041
     I                                      331 348 OBAC                                      CLE041
     I                                      401 401 PRTR                                      CLE041
      *                                                                                       CLE041
      ** Combined field for sequence check                                                    CLE041
     I                                        1  12 DSB1                                      CLE041
      *                                                                                       CLE041
      ** Combined field for database message                                                  CLE041
     I                                        2  13 KEY                                       CLE041
      *                                                                                       CLE041
      ** Aggregate Facilities File - Deleted                                                  CLE041
      *                                                                                       CLE041
     I        NS  08   1 C*                                                                   CLE041
     I                                        1   1 RECI                                      CLE041
      *                                                                                       CLE041
      ** Aggregate Facilities file - catchall                                                 CLE041
      *                                                                                       CLE041
     I        NS                                                                              CLE041
     I                                        1   1 RECI                                      CLE041
      *                                                                                       CLE041
      ** Facilities File - Trailer                                                            CLE041
      *                                                                                       CLE041
     IFCLTYZZ NS  06   1 CT                                                                   CLE041
     I                                        1   1 RECI                                      CLE041
     I                                    P  17  190NORE                                      CLE041
     I                                    P  20  220FLSZ                                      CLE041
     I                                    P  23  250NLRB                                      CLE041
     I                                    P  26  280NINS                                      CLE041
     I                                    P  29  310NDEL                                      CLE041
     I                                    P  32  340NLRA                                      CLE041
     I                                    P  35  420VLBF                                      CLE041
     I                                    P  43  440VLBL                                      CLE041
     I                                    P  45  520VRIF                                      CLE041
     I                                    P  53  540VRIL                                      CLE041
     I                                    P  55  620VRDF                                      CLE041
     I                                    P  63  640VRDL                                      CLE041
     I                                    P  65  720VRAF                                      CLE041
     I                                    P  73  740VRAL                                      CLE041
     I                                    P  75  820VLAF                                      CLE041
     I                                    P  83  840VLAL                                      CLE041
     I                                    P 250 2520LCD                                       CLE041
     I                                      253 253 CHTP                                      CLE041
     I                                    P 254 2560TNLU                                      CLE041
      *                                                                                       CLE041
      ** Aggregate Facilities File - Trailer Record                                           CLE041
      *                                                                                       CLE041
     IAGFCTYZF                                                                                CLE041
     I              RECI                            AGRECI                                    CLE041
     I              NORE                            AGNORE                                    CLE041
     I              NLRB                            AGNLRB                                    CLE041
     I              NINS                            AGNINS                                    CLE041
     I              NDEL                            AGNDEL                                    CLE041
     I              NLRA                            AGNLRA                                    CLE041
     I              VLBF                            AGVLBF                                    CLE041
     I              VLBL                            AGVLBL                                    CLE041
     I              VRIF                            AGVRIF                                    CLE041
     I              VRIL                            AGVRIL                                    CLE041
     I              VRDF                            AGVRDF                                    CLE041
     I              VRDL                            AGVRDL                                    CLE041
     I              VRAF                            AGVRAF                                    CLE041
     I              VRAL                            AGVRAL                                    CLE041
     I              VLAF                            AGVLAF                                    CLE041
     I              VLAL                            AGVLAL                                    CLE041
     I              LCD                             AGLCD                                     CLE041
     I              CHTP                            AGCHTP                                    CLE041
     I              TNLU                            AGTNLU                                    CLE041
0197 I*                                                                   LE0840
0198 I*****TABLE*FILE***INSTALLATION*CONTROL*DATA RECORD 1.               S01194
0199 I**********                                                          S01194
0200 I*TABLE***NS  07   2 C0   3 C1  12 C1                                S01194
0201 I*******AND      13 C0                                               S01194
0202 I**********                              1   1 RECI                  S01194
0203 I**********                              2   30RECT                  S01194
0204 I**********                             12  130RCDE                  S01194
0205 I**********                             14  66 TITL                  S01194
0206 I**********                             67  67 DATF                  S01194
0208 I**********                             74  74 MODI1                 S01194
0209 I**********                             75  75 MODI2                 S01194
0210 I**********                             76  76 MODI3                 S01194
0211 I**********                          P  77  790RUND                  S01194
0212 I**********                             80  86 RUNA                  S01194
0213 I**********                             87  870SFLG                  S01194
0214 I**********                          P  90  920LCD                   S01194
0215 I**********                             93  93 CHTP                  S01194
0216 I**********                          P  94  960TNLU                  S01194
0217 I**********                                                          S01194
0218 I*****TABLE*FILE***CATCH-ALL                                         S01194
0219 I**********                                                          S01194
0220 I********NS       1NCD                                               S01194
0221 I**********                              1   1 RECI                  S01194
0222 I**********                                                          S01194
0223 I*    LOCAL DATA AREA FOR DATABASE ERROR REFERENCES                  LE0840
0224 I*                                                                   LE0840
0225 ILDA        UDS                            256                       LE0840
0226 I***********                           134 138 DBFILE                S01117
0227 I***********                           139 167 DBKEY                 S01117
0228 I***********                           168 175 DBPGM                 S01117
0229 I***********                           176 177 DBASE                 S01117
     I                                      134 141 DBFILE                S01117
     I                                      142 170 DBKEY                 S01117
     I                                      171 180 DBPGM                 S01117
     I                                      181 1830DBASE                 S01117
     ISDBANK    E DSSDBANKPD                                              S01194
      **  EXTERNAL DS FOR BANK DETAILS                                    S01194
     I              BJURPT                          TITL                  S01194
     I              BJDFIN                          DATF                  S01194
     I              BJMRDT                          RUNA                  S01194
     I              BJRDNB                          RUND                  S01194
     ISCSARD    E DSSCSARDPD                                              CLE004
      ***  External data structures for SAR Details                       CLE004
      *                                                                   CLE004
     IDSFDY     E DSDSFDY                                                 S01194
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01194
     I*                                                                   S01194
     IDSSDY     E DSDSSDY                                                 S01194
     I* SECOND DS FOR ACCESS PROGRAMS, LONG DATA STRUCTURE                S01194
     I*                                                                   S01194
     I**                                                                  S01117
     C** PARAMETER LIST FOR PROGRAM 'AOBANKR0'                            S01194
     C           PLISTA    PLIST                                          S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDBANK    PARM SDBANK    DSFDY                           S01194
     C**                                                                  S01194
     C                     MOVEACPY@      BIS@   80
0230 C********************************************************************LE0840
0231 C*                                                                   LE0840
0232 C*    FIRST CYCLE/HEADER PROCESSING                                  LE0840
0233 C*                                                                   LE0840
0234 C   10                GOTO ENDFC                                     LE0840
0235 C                     SETON                     10                   LE0840
0236 C*                                                                   LE0840
0237 C*    COUNT HEADER READ                                              LE0840
0238 C*                                                                   LE0840
0239 C   01                Z-ADD1         NRIP    50       = NO.RECS INPUTLE0840
0240 C*                                                                   LE0840
0241 C*    SETUP DATABASE REFERENCES                                      LE0840
0242 C*                                                                   LE0840
0243 C                     MOVE 'LE0840  'DBPGM                           LE0840
0244 C                     MOVE ' '       BLANKS 29                       LE0840
0245 C                     MOVE BLANKS    DBKEY                           LE0840
0246 C*                                                                   LE0840
0247 C*    ACCESS ICD-1 FOR RUN DATE, DATABASE ERROR IF NOT FOUND         LE0840
0248 C*                                                                   LE0840
0267 C**********           EXSR ZSYSTM                                    S01194
0268 C*********99          SETON                     U7U8LR               S01194
0269 C*********99          MOVEL'TABLE'   DBFILE                          S01194
0270 C*********99          MOVELZTABKY    DBKEY                           S01194
0271 C*********99          MOVEL'01'      DBASE            ** DBASE  01 **S01194
0272 C*********99          GOTO ENDT                                      S01194
     C                     CALL 'AOBANKR0'PLISTA                          S01194
     C           @RTCD     IFNE *BLANKS                                   S01194
0199 C                     SETON                     U7U8LR**DATABASE 01**S01194
0200 C                     Z-ADD1         DBASE                           S01194
0202 C                     MOVE 'SDBANKPD'DBFILE                          S01194
0203 C                     GOTO ENDT                                      S01194
     C                     END                                            S01194
     C*                                                                   S01194
     C*    CHECK SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.                    S01194
0481 C           DATF      COMP 'M'                      98MMDDYY, 98 ON  S01194
      *                                                                   CLE004
      ** Check if SAR CLE004 is present                                   CLE004
      *                                                                   CLE004
     C                     CALL 'AOSARDR0'                                CLE004
     C                     PARM *BLANKS   P@RTCD  7                       CLE004
     C                     PARM '*KEY   ' P@OPTN  7                       CLE004
     C                     PARM 'CLE004'  P@SARD  6                       CLE004
     C           SCSARD    PARM SCSARD    DSFDY                           CLE004
      *                                                                   CLE004
     C           P@RTCD    IFEQ *BLANKS                                   CLE004
     C                     MOVE *ON       *IN30                           CLE004
     C                     ENDIF                                          CLE004
      *                                                                                       CLE041
      ** from LEC1002A, if *INU1 is *ON, CLE025 is *ON                                        CLE041
      *                                                                                       CLE041
     C                     MOVE 'N'       CLE025  1                                           CLE041
     C           *INU1     IFEQ *ON                                                           CLE041
     C                     MOVE 'Y'       CLE025                                              CLE041
     C                     ENDIF                                                              CLE041
      *                                                                                       CLE041
     C           *LIKE     DEFN NORE      WNORE                                               CLE041
     C           *LIKE     DEFN VLAF      WVLAF                                               CLE041
     C           *LIKE     DEFN VLAL      WVLAL                                               CLE041
      *                                                                                       CLE041
0255 C*                                                                   LE0840
0256 C*    DETERMINE DAYNO IN 90 DAYS.                                    LE0840
0257 C*                                                                   LE0840
0258 C           RUND      ADD  90        RUNX    50                      LE0840
0259 C*                                                                   LE0840
0260 C*    COUNT RECORD OUTPUT TO FILE                                    LE0840
0261 C*                                                                   LE0840
0262 C                     Z-ADD1         NROP    50       =NO.RECS OUTPUTLE0840
0263 C*                                                                   LE0840
0264 C                     GOTO ENDT                                      LE0840
0265 C*                                                                   LE0840
0266 C           ENDFC     TAG                             ** ENDFC TAG **LE0840
0267 C*                                                                   LE0840
0268 C/SPACE 3                                                            LE0840
0269 C********************************************************************LE0840
0270 C******     MAIN PROCESSING                     *********************LE0840
0271 C*                                                                   LE0840
0272 C   02                                                               LE0840
0273 COR 03                SETOF                     212223               LE0840
0274 C                     SETOF                     29                   LE0840
0275 C*                                                                   LE0840
0276 C*    CHECK CORRECT RECI OF TYPE 2 RECORD FOLLOWING LIVE TYPE 1      LE0840
0277 C*    IF NOT, DATABASE ERROR                                         LE0840
0278 C*                                                                   LE0840
0279 C   25N04                                                            LE0840
0280 COR 26N05             SETON                     U7U8LR               LE0840
0281 C   U7 U8             MOVE '02'      DBASE                           LE0840
0282 C   U7 U8             MOVE 'FCLTY'   DBFILE                          LE0840
0283 C   U7 U8             MOVELKEY       DBKEY                           LE0840
0284 C   U7 U8             GOTO ENDT                                      LE0840
0285 C*                                                                   LE0840
0286 C   02                SETON                     25                   LE0840
0287 C   03                SETON                     26                   LE0840
0288 C   04                SETOF                     25                   LE0840
0289 C   05                SETOF                     26                   LE0840
0290 C*    COUNT ALL RECORDS READ - EXCEPT DELETED                        LE0840
0291 C*                                                                   LE0840
0292 C  N08      NRIP      ADD  1         NRIP                            LE0840
0293 C*                                                                   LE0840
0294 C*    HASH TOTAL FACILITY AMOUNT EACH 'D' OR 'E' RECORD 1.           LE0840
0295 C*                                                                   LE0840
0296 C   02                                                               LE0840
0297 COR 03                SETON                     12                   LE0840
0298 C   12                Z-ADD0         ZZAMT                           LE0840
0299 C   12                MOVE FAMT      ZZAMT                           LE0840
     C   12      ZZAMT     IFLT 0                                                             193603
     C                     Z-SUBZZAMT     ZZAMT                                               193603
     C                     END                                                                193603
0300 C   12                Z-ADDLVTOTI    ZZTOTI                          LE0840
0301 C   12                Z-ADDLVTOTD    ZZTOTD                          LE0840
0302 C   12                EXSR GLZADD                                    LE0840
0303 C   12                Z-ADDZZTOTI    LVTOTI 150                      LE0840
0304 C   12                Z-ADDZZTOTD    LVTOTD  30                      LE0840
0305 C                     SETOF                     12                   LE0840
0306 C*                                                                   LE0840
0307 C*    DETERMINE SUBROUTINE FOR FUTHER PROCESSING                     LE0840
0308 C*                                                                   LE0840
0309 C   02                EXSR LIVE                                      LE0840
0310 C   03                EXSR EXPRD                                     LE0840
0311 C   04                                                               LE0840
0312 COR 05                EXSR DETB                                      LE0840
0313 C   06                EXSR TRAILR                                    LE0840
0314 C*                                                                   LE0840
0315 C           ENDT      TAG                             ** ENDT TAG ** LE0840
0316 C*                                                                   LE0840
     CLR U7 U8             EXSR *PSSR                                     S01117
0349 C**                                                                  S01117
0317 C********************************************************************LE0840
0318 C********************************************************************LE0840
0319 C*                                                                   LE0840
0320 C*    LIVE SR - CALLED FROM MAIN PROCESSING                          LE0840
0321 C*            - CALLS SR RNCNTL                                      LE0840
0322 C*    PROCESSING FOR LIVE RECORD TYPE 1.                             LE0840
0323 C*                                                                   LE0840
0324 C*                                                                   LE0840
0325 C           LIVE      BEGSR                           ***  LIVE  *** LE0840
0326 C*                                                                   LE0840
0327 C*                                                                   LE0840
0328 C*    DETERMINE IF EXPIRY DATE WITHIN 90 DAYS                        LE0840
0329 C*                                                                   LE0840
0330 C           DTEX      COMP RUNX                   2222               LE0840
0331 C*                                                                   LE0840
0332 C*    DETERMINE IF REVIEW DATE WITHIN 90 DAYS (UNLESS = ZERO)        LE0840
0333 C*                                                                   LE0840
0334 C           RVDT      COMP 0                        13               LE0840
0335 C  N13      RVDT      COMP RUNX                   2323               LE0840
0336 C*                                                                   LE0840
0337 C*    COUNT AND HASH TOTAL EACH RECORD OUTPUT                        LE0840
0338 C*                                                                   LE0840
0339 C   22                EXSR RNCNTL                                    LE0840
0340 C   23                EXSR RNCNTL                                    LE0840
0341 C*                                                                   LE0840
0342 C*                                                                   LE0840
0343 C                     ENDSR                           * END LIVE SR *LE0840
0344 C********************************************************************LE0840
0345 C********************************************************************LE0840
0346 C*                                                                   LE0840
0347 C*    EXPRD SR - CALLED FROM MAIN PROCESSING                         LE0840
0348 C*             - CALLS SR RNCNTL                                     LE0840
0349 C*    PROCESSING FOR EXPIRED RECORD TYPE 1                           LE0840
0350 C*                                                                   LE0840
0351 C           EXPRD     BEGSR                           ***  EXPRD  ***LE0840
0352 C*                                                                   LE0840
0353 C*    COUNT AND HASH TOTAL EACH RECORD OUTPUT                        LE0840
0354 C*                                                                   LE0840
0355 C                     EXSR RNCNTL                                    LE0840
0356 C*                                                                   LE0840
0357 C*    SET OUTPUT INDICATOR FOR EXPIRED RECORD                        LE0840
0358 C*                                                                   LE0840
0359 C                     SETON                     21                   LE0840
0360 C*                                                                   LE0840
0361 C*                                                                   LE0840
0362 C                     ENDSR                           * END EXPRD SR*LE0840
0363 C********************************************************************LE0840
0364 C********************************************************************LE0840
0365 C*                                                                   LE0840
0366 C*    DETB SR - CALLED FROM MAIN PROCESSING                          LE0840
0367 C*     CHECK SEQUENCE OF '1' AND '2' RECORDS (RECI ALREADY CHECKED)  LE0840
0368 C*                                                                   LE0840
0369 C           DETB      BEGSR                           ***  DETB  *** LE0840
0370 C*                                                                   LE0840
0371 C*                                                                   LE0840
0372 C*                                                                   LE0840
0373 C           DSA1      COMP DSB1                     27               LE0840
0374 C*                                                                   LE0840
0375 C*    IF NOT SAME, DATABASE ERROR                                    LE0840
0376 C*                                                                   LE0840
0377 C  N27                SETON                     U7U8LR               LE0840
0378 C  N27                MOVE '03'      DBASE                           LE0840
0379 C  N27                MOVE 'FCLTY'   DBFILE                          LE0840
0380 C  N27                MOVELKEY       DBKEY                           LE0840
0381 C  N27                GOTO ENDB                                      LE0840
0382 C*                                                                   LE0840
0383 C*    SET INDICATOR FOR DETAIL RECORD OUTPUT TO EXPDU.               LE0840
0384 C*                                                                   LE0840
0385 C   21                                                               LE0840
0386 COR 22                                                               LE0840
0387 COR 23                SETON                     29                   LE0840
0388 C*                                                                   LE0840
0389 C*                                                                   LE0840
0390 C           ENDB      ENDSR                           ** ENDB TAG ** LE0840
0391 C********************************************************************LE0840
0392 C********************************************************************LE0840
0393 C*                                                                   LE0840
0394 C*    RNCNTL SR - CALLED FROM LIVE SR (TWICE) AND EXPRD SR.          LE0840
0395 C*    PROCESSING TO COUNT AND HASH TOTAL EACH RECORD OUTPUT TO EXPDU LE0840
0396 C*                                                                   LE0840
0397 C           RNCNTL    BEGSR                           *** RNCNTL *** LE0840
0398 C*                                                                   LE0840
0399 C*    COUNT RECORDS OUTPUT                                           LE0840
0400 C           NROP      ADD  1         NROP                            LE0840
0401 C*                                                                   LE0840
0402 C*    HASH TOTAL RECORDS OUTPUT                                      LE0840
0403 C*                                                                   LE0840
0404 C                     Z-ADD0         ZZAMT                           LE0840
0405 C                     MOVE FAMT      ZZAMT                           LE0840
     C           ZZAMT     IFLT 0                                                             193603
     C                     Z-SUBZZAMT     ZZAMT                                               193603
     C                     END                                                                193603
0406 C                     Z-ADDVROF      ZZTOTI                          LE0840
0407 C                     Z-ADDVROL      ZZTOTD                          LE0840
0408 C                     EXSR GLZADD                                    LE0840
0409 C                     Z-ADDZZTOTI    VROF   150                      LE0840
0410 C                     Z-ADDZZTOTD    VROL    30                      LE0840
0411 C*                                                                   LE0840
0412 C                     ENDSR                           *END RNCNTL SR*LE0840
0413 C********************************************************************LE0840
0414 C********************************************************************LE0840
0415 C*                                                                   LE0840
0416 C*    TRAILR SR - CALLED FROM MAIN PROCESSING                        LE0840
0417 C*    PROCESSING FOR TRAILER/LR                                      LE0840
0418 C*                                                                   LE0840
0419 C           TRAILR    BEGSR                           *** TRAILR *** LE0840
0420 C*                                                                   LE0840
      *                                                                                       CLE041
     C           CLE025    IFEQ 'Y'                                                           CLE041
     C                     READ LEAGFZPD                 31                                   CLE041
     C                     ENDIF                                                              CLE041
      *                                                                                       CLE041
     C           CLE025    IFEQ 'Y'                                                           CLE041
     C           *IN31     ANDEQ*OFF                                                          CLE041
     C           NORE      ADD  AGNORE    WNORE                                               CLE041
      *                                                                                       CLE041
      ** Header and trailer record count for AGFCTY are redundant for                         CLE041
      ** the extract file, hence remove them from record count                                CLE041
      *                                                                                       CLE041
     C           WNORE     SUB  2         WNORE                                               CLE041
      *                                                                                       CLE041
     C           VLAF      ADD  AGVLAF    WVLAF                                               CLE041
     C           VLAL      ADD  AGVLAL    WTMP40  40                                          CLE041
     C           WTMP40    IFGT 999                                                           CLE041
     C                     ADD  1         WVLAF                                               CLE041
     C                     ENDIF                                                              CLE041
     C                     MOVE WTMP40    WVLAL                                               CLE041
      *                                                                                       CLE041
      ** Compare input file controls calculated with agg/facility trailer                     CLE041
      *                                                                                       CLE041
     C           NRIP      COMP WNORE                    28                                   CLE041
     C   28      LVTOTI    COMP WVLAF                    28                                   CLE041
     C   28      LVTOTD    COMP WVLAL                    28                                   CLE041
     C  N28                SETON                     U8                                       CLE041
      *                                                                                       CLE041
     C                     ELSE                                                               CLE041
0421 C*                                                                   LE0840
0422 C*    COMPARE CALCULATED COUNT OF RECORDS READ,                      LE0840
0423 C*    AND HASH TOTALS, WITH THOSE ON FACILITY FILE TRAILER.          LE0840
0424 C*    IF DIFFERENT, SETON U8.                                        LE0840
0425 C*                                                                   LE0840
0426 C           NRIP      COMP NORE                     28               LE0840
0427 C   28      LVTOTI    COMP VLAF                     28               LE0840
0428 C   28      LVTOTD    COMP VLAL                     28               LE0840
0429 C  N28                SETON                     U8                   LE0840
      *                                                                                       CLE041
     C                     Z-ADDNORE      WNORE                                               CLE041
     C                     Z-ADDVLAF      WVLAF                                               CLE041
     C                     Z-ADDVLAL      WVLAL                                               CLE041
     C                     ENDIF                                                              CLE041
0430 C*                                                                   LE0840
0431 C*    COUNT RECORD OUTPUT TO EXPDU                                   LE0840
0432 C*                                                                   LE0840
0433 C           NROP      ADD  1         NROP                            LE0840
0434 C*                                                                   LE0840
0435 C*                                                                   LE0840
0436 C                     ENDSR                           * END TRAILR * LE0840
0437 C*                                                                   LE0840
0438 C*                                                                   LE0840
0439 C********************************************************************LE0840
0440 C* SUBROUTINE TO ADD AN AMOUNT (ZZAMT) TO THE TOTAL (ZZTOTI,ZZTOTD)  LE0840
0441 C*   IND '99' IS SET BY AN OVERFLOW ERROR                            LE0840
0442 C*                                                                   LE0840
0443 CSR         GLZADD    BEGSR                           *** GLZADD ****LE0840
0444 C*                                                                   LE0840
0445 CSR                   Z-ADDZZAMT     ZZAMT  153     91-DEFINE ZZAMT  LE0840
0446 CSR 91                GOTO ZZAEND                     AMT = 0.BYPASS LE0840
0447 C*                                                                   LE0840
0448 C* SPLIT ZZAMT INTO INTEGER AND DECIMAL FIELDS                       LE0840
0449 CSR                   Z-ADDZZAMT     ZZAMTI 150       INTEGER FIELD  LE0840
0450 CSR                   MOVE ZZAMT     ZZAMTD  30       DECIMAL FIELD  LE0840
0451 C* BOTH ZZAMTI AND ZZAMTD CONTAIN A 'SIGN' ZONE NOW                  LE0840
0452 C*                                                                   LE0840
0453 CSR                   EXSR GLZSUM                                    LE0840
0454 CSR         ZZAEND    ENDSR                           ** ZZAEND TAG *LE0840
0455 C*                                                                   LE0840
0456 C********************************************************************LE0840
0457 C* SUBROUTINE TO CARRY OUT THE ADDITION FOR SUBROUTINES -            LE0840
0458 C*                        GLZADD, GLZSUB, GLZCMP.                    LE0840
0459 C*          PARAMETERS PASSED -                                      LE0840
0460 C*                     I/P ZZAMTI ZZAMTD                             LE0840
0461 C*                     O/P ZZTOTI ZZTOTD ZZNEGD IND 96 IND 99.       LE0840
0462 C*                                                                   LE0840
0463 CSR         GLZSUM    BEGSR                           *** GLZSUM ****LE0840
0464 C*                                                                   LE0840
0465 CSR                   Z-ADDZZTOTI    ZZTOTI 150       DEFINE ZZTOTI  LE0840
0466 CSR                   Z-ADDZZTOTD    ZZTOTD  30       DEFINE ZZTOTD  LE0840
0467 CSR                   SETOF                     919293               LE0840
0468 CSR                   SETOF                     949599               LE0840
0469 C*                                                                   LE0840
0470 C*    DETERMINE SIGN OF ZZAMTI & D,   92 IF NEG                      LE0840
0471 CSR         ZZAMTI    COMP 0                      9293               LE0840
0472 CSR 93      ZZAMTD    COMP 0                      9293               LE0840
0473 CSR 93                GOTO ZZSEND                     ZERO BYPASS    LE0840
0474 C*                                                                   LE0840
0475 C*    DETERMINE SIGN OF ZZTOTI & D, 91 IF NEG.                       LE0840
0476 CSR         ZZTOTI    COMP 0                      9193               LE0840
0477 CSR 93      ZZTOTD    COMP 0                      9193               LE0840
0478 C*                                                                   LE0840
0479 C*    IF ZZTOTAL IS ZERO, RETURN ZZAMOUNT.                           LE0840
0480 CSR 93                Z-ADDZZAMTI    ZZTOTI                          LE0840
0481 CSR 93                Z-ADDZZAMTD    ZZTOTD                          LE0840
0482 CSR 93                GOTO ZZSEND                     ZERO BYPASS    LE0840
0483 C*    IF SIGNS DIFFER BYPASS OVERFLOW CHECKS.                        LE0840
0484 CSR 91N92                                                            LE0840
0485 CORN91 92             GOTO ZZOFPS                                    LE0840
0486 C*                                                                   LE0840
0487 CSR         ZZAMTD    ADD  ZZTOTD    ZZWK2   40                      LE0840
0488 CSR         ZZWK2     COMP 999                  93    '93' = CARRY   LE0840
0489 CSRN93      ZZWK2     COMP -999                   93    INTO INTEGER.LE0840
0490 C*                                                                   LE0840
0491 CSR 93N92   ZZAMTI    ADD  1         ZZWK3  150       ADD 'CARRY' +VELE0840
0492 CSR    93 92ZZAMTI    SUB  1         ZZWK3            SUB 'CARRY' -VELE0840
0493 CSR 93      ZZTOTI    ADD  ZZWK3     ZZWK3                           LE0840
0494 CSRN93      ZZTOTI    ADD  ZZAMTI    ZZWK3                           LE0840
0495 C*                                                                   LE0840
0496 C* IF THE MODULUS OF ZZWK3 IS LT MOD. ZZTOTI THEN O/F HAS OCCURED    LE0840
0497 CSRN92      ZZWK3     COMP ZZTOTI                 99  -92 MEANS NOS. LE0840
0498 CSR 92      ZZWK3     COMP ZZTOTI               99     NEGATIVE      LE0840
0499 CSRN99                Z-ADDZZWK2     ZZTOTD                          LE0840
0500 CSRN99                Z-ADDZZWK3     ZZTOTI                          LE0840
0501 C*                                                                   LE0840
0502 C* IF O/F ZEROIZE ZZAMT , IND '99' SET AND ZZTOT FIELDS LEFT INTACT. LE0840
0503 CSR 99                Z-ADD0         ZZAMT  153                      LE0840
0504 CSR                   GOTO ZZSEND                                    LE0840
0505 C*                                                                   LE0840
0506 C* THE 'SIGNS' ARE DIFFERENT                                         LE0840
0507 CSR         ZZOFPS    TAG                             ** ZZOFPS TAG**LE0840
0508 C* IF ZZAMT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZTOT            LE0840
0509 C*                                                                   LE0840
0510 CSR 92                Z-SUBZZAMTI    ZZAMTI 150                      LE0840
0511 CSR 92                Z-SUBZZAMTD    ZZAMTD  30                      LE0840
0512 C*                                                                   LE0840
0513 C* IF ZZTOT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZAMT.           LE0840
0514 C*                                                                   LE0840
0515 CSR 91                Z-SUBZZTOTI    ZZTOTI                          LE0840
0516 CSR 91                Z-SUBZZTOTD    ZZTOTD                          LE0840
0517 C* BOTH ZZAMT AND ZZTOT ARE NOW POSITIVE.                            LE0840
0518 C*                                                                   LE0840
0519 CSR         ZZTOTI    COMP ZZAMTI               93  95               LE0840
0520 CSR 95      ZZTOTD    COMP ZZAMTD               93  95               LE0840
0521 C*                                                                   LE0840
0522 C* IF ZZTOT EQ. ZZAMT RETURN ZERO.                                   LE0840
0523 CSR 95                Z-ADD0         ZZTOTI                          LE0840
0524 CSR 95                Z-ADD0         ZZTOTD                          LE0840
0525 CSR 95                GOTO ZZSEND                                    LE0840
0526 C*                                                                   LE0840
0527 C* IF ZZTOT GT. ZZAMT.                                               LE0840
0528 CSR 93      ZZAMTD    COMP ZZTOTD               94                   LE0840
0529 CSR 93 94   ZZTOTI    SUB  1         ZZTOTI                          LE0840
0530 CSR 93 94   ZZTOTD    ADD  1000      ZZWK2                           LE0840
0531 CSR 93      ZZTOTI    SUB  ZZAMTI    ZZTOTI                          LE0840
0532 CSR 93 94   ZZWK2     SUB  ZZAMTD    ZZTOTD                          LE0840
0533 CSR 93N94   ZZTOTD    SUB  ZZAMTD    ZZTOTD                          LE0840
0534 C*                                                                   LE0840
0535 C*                                                                   LE0840
0536 C* IF ZZAMT GT. ZZTOT.                                               LE0840
0537 CSRN93      ZZTOTD    COMP ZZAMTD               94                   LE0840
0538 CSRN93 94   ZZAMTI    SUB  1         ZZWK3  150                      LE0840
0539 CSRN93 94   ZZAMTD    ADD  1000      ZZWK2                           LE0840
0540 CSRN93 94   ZZWK3     SUB  ZZTOTI    ZZTOTI                          LE0840
0541 CSRN93N94   ZZAMTI    SUB  ZZTOTI    ZZTOTI                          LE0840
0542 CSRN93 94   ZZWK2     SUB  ZZTOTD    ZZTOTD                          LE0840
0543 CSRN93N94   ZZAMTD    SUB  ZZTOTD    ZZTOTD                          LE0840
0544 C*                                                                   LE0840
0545 C* REVERSE SIGN OF ZZTOT IF LARGER I/P FIELDS WERE NEGATIVE          LE0840
0546 CSR                   SETOF                     94                   LE0840
0547 CSR 93 91                                                            LE0840
0548 CORN93 92             SETON                     94                   LE0840
0549 CSR 94                Z-SUBZZTOTI    ZZTOTI                          LE0840
0550 CSR 94                Z-SUBZZTOTD    ZZTOTD                          LE0840
0551 C**                                                                  LE0840
0552 C**   RESTORE SIGN OF ZZAMTI & ZZAMTD IF IT WAS REVERSED.            LE0840
0553 CSR 92                Z-SUBZZAMTI    ZZAMTI                          LE0840
0554 CSR 92                Z-SUBZZAMTD    ZZAMTD                          LE0840
0555 CSR         ZZSEND    TAG                             ** ZZSEND TAG *LE0840
0556 C**                                                                  LE0840
0557 C**   IF ZZTOTD IS ZERO, AND ZZTOTI IS NEG. SET UP ZZNEGD.           LE0840
0558 CSR                   SETOF                     96                   LE0840
0559 CSR         ZZTOTD    COMP 0                        91               LE0840
0560 CSR 91      ZZTOTI    COMP 0                      96                 LE0840
0561 CSR 96                MOVE '.000-'   ZZNEGD  5                       LE0840
0562 CSR                   ENDSR                             ** ENDSR **  LE0840
0563 C********************************************************************LE0840
0564 C**                                                                  LE0840
0469 C*****ZSYSTM*SR.*TO*CHAIN TO THE INSTALLATION CONTROL DATA RECORD.   S01194
0470 C**********                                                          S01194
0471 C********** ZSYSTM    BEGSR                           *** ZSYSTM *** S01194
0472 C**********                                                          S01194
0473 C*****SET*UP*KEY*FOR*INSTALLATION CONTROL RECORD.                    S01194
0474 C**********           MOVEL'01      'ZTABKY 12                       S01194
0475 C**********           MOVE '  10'    ZTABKY                          S01194
0476 C**********                                                          S01194
0477 C********** ZTABKY    CHAINTABLE                99    ON NOT THERE   S01194
0478 C**N99***** RECI      COMP 'D'                  9999  ON, IS DELETED S01194
0479 C**********                                                          S01194
0480 C*****CHECK*SYSTEM*DATE FORMAT, DDMMYY OR MMDDYY.                    S01194
0481 C********** DATF      COMP 'M'                      98MMDDYY, 98 ON  S01194
0482 C**********                                                          S01194
0483 C**********           ENDSR                                          S01194
0580 C**                                                                  LE0840
     C********************************************************************S01117
     C*                                                                   S01117
     C* *PSSR  --- SUBROUTINE TO HANDLE ABNORMAL ERROR CONDITIONS         S01117
     C*                                                                   S01117
     C* CALLED FROM: AFTER ABNORNAL OPERATION OCCURS                      S01117
     C*                                                                   S01117
     C* CALLS: NOTHING                                                    S01117
     C*                                                                   S01117
     C********************************************************************S01117
     C*                                                                   S01117
     C           *PSSR     BEGSR                           ** *PSSR **    S01117
     C*                                                                   S01117
     C           @RUN      IFEQ *BLANKS                                   S01117
     C                     MOVE 'Y'       @RUN    1                       S01117
     C                     DUMP                                           S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C                     ENDSR                           ** *PSSR **    S01117
0581 C**                                                                  S01117
0582 C********************************************************************LE0840
0583 OEXPDUHH H        01                                                 LE0840
0584 O                                    1 'H'                           LE0840
0585 O**                                                                  LE0840
0586 O*    FACILITY EXPIRED OR DUE TO EXPIRE                              LE0840
0587 OEXPDUEX D        29 21                                              LE0840
0588 O       OR        29 22                                              LE0840
0589 O                                    1 'D'                           LE0840
0590 O***********              BRCD       4                               S01117
0590 O                         BRCA       4                               S01117
0591 O                         ACOF       6                               LE0840
0592 O                 21                 7 '1'                           LE0840
0593 O                 22                 7 '2'                           LE0840
0594 O                         DTEX      10P                              LE0840
0595 O                         CNUM      16                               LE0840
0596 O                         FACT      19                               LE0840
0597 O                         FCNO      21                               LE0840
0598 O                         DTAP      24P                              LE0840
0599 O                         FCCY      27                               LE0840
0600 O                         FAMT      34P                              LE0840
0601 O                         SECI      35                               LE0840
0602 O                         MCCY      36                               LE0840
     O                         MBFC      37                               S01117
     O                 30      PRTR      64                               CLE004
0603 O*                                                                   LE0840
0604 O*    FACILITY DUE FOR REVIEW                                        LE0840
0605 OEXPDUEX D        29 23                                              LE0840
0606 O                                    1 'D'                           LE0840
0607 O***********              BRCD       4                               S01117
0607 O                         BRCA       4                               S01117
0608 O                         ACOF       6                               LE0840
0609 O                                    7 '3'                           LE0840
0610 O                         RVDT      10P                              LE0840
0611 O                         CNUM      16                               LE0840
0612 O                         FACT      19                               LE0840
0613 O                         FCNO      21                               LE0840
0614 O                         DTAP      24P                              LE0840
0615 O                         FCCY      27                               LE0840
0616 O                         FAMT      34P                              LE0840
0617 O                         SECI      35                               LE0840
0618 O                         MCCY      36                               LE0840
     O                         MBFC      37                               S01117
     O                 30      PRTR      64                               CLE004
0619 OEXPDUT2 D        06                                                 LE0840
0620 O                                    1 'T'                           LE0840
0621 O                         NROP       4P                              LE0840
0622 O                         VROF      12P                              LE0840
0623 O                         VROL      14P                              LE0840
0624 O**                                                                  LE0840
0625 O**                                                                  LE0840
0626 O*E0840P1T**203   U7 U8 LR                                 S01124    S01117
0626 OLE0840AUT  203   U7 U8 LR                                           S01117
0627 O***********                        22 'REFERENCE LE0840'            S01117
0627 O                                   24 'REFERENCE LE0840AU'          S01117
0628 O                         TITL      89                               LE0840
0629 O                                  104 'DATE'                        LE0840
0630 O                         RUNA     112                               LE0840
0631 O                                  122 'PAGE'                        LE0840
0632 O                         PAGE     127                               LE0840
0633 O        T     15 U7 U8 LR                                           LE0840
0634 O                                   52 '----------------'            LE0840
0635 O                                   71 'FACILITIES EXTRACT'          LE0840
0636 O                                   89 '-----------------'           LE0840
0637 O        T  2     U7 U8 LR                                           LE0840
0638 O                                   51 '*** REFERENCE LE0840'        LE0840
0639 O                                   71 'DATABASE ERROR AT'           LE0840
0640 O***********              DBASE     74                               S01117
     O                         DBASE     75                               S01117
0641 O        T        U7 U8 LR                                           LE0840
0642 O                                   37 'FILENAME'                    LE0840
0643 O***********              DBFILE    43                               S01117
0644 O***********                        48 'KEY'                         S01117
0645 O***********              DBKEY     78                               S01117
     O                         DBFILE    46                               S01117
     O                                   51 'KEY'                         S01117
     O                         DBKEY     81                               S01117
0646 O        T  203   LR                                                 LE0840
0647 O***********                        22 'REFERENCE LE0840'            S01117
0647 O                                   24 'REFERENCE LE0840AU'          S01117
0648 O                         TITL      89                               LE0840
0649 O                                  104 'DATE'                        LE0840
0650 O                         RUNA     112                               LE0840
0651 O                                  122 'PAGE'                        LE0840
0652 O                         PAGE     127                               LE0840
0653 O        T  1     LR                                                 LE0840
0654 O                                   65 'FACILITIES EXTRACT  -'       LE0840
0655 O                                   80 'FILE CONTROLS'               LE0840
0656 O        T     15 LR                                                 LE0840
0657 O                                   67 '-----------------------'     LE0840
0658 O                                   80 '-------------'               LE0840
0659 O        T  1     LR                                                 LE0840
0660 O                                   28 'S/FCLTY - RUN CONTROLS'      LE0840
0661 O                                   59 'NUMBER'                      LE0840
0662 O                                   84 'VALUE'                       LE0840
0663 O        T  2     LR                                                 LE0840
0664 O                                   28 '----------------------'      LE0840
0665 O                                   59 'OF RECORDS'                  LE0840
0666 O                                   84 'OF RECORDS'                  LE0840
0667 O        T  2     LR                                                 LE0840
0668 O                                   29 'TOTAL RECORDS ON FILE'       LE0840
0669 O**********         NU7   NORE  3   59                                            LE0840 CLE041
0670 O**********         NU7   VLAF  Z   81                                            LE0840 CLE041
0671 O**********         NU7   VLAL      84                                            LE0840 CLE041
0669 O                   NU7   WNORE 3   59                                            LE0840 CLE041
0670 O                   NU7   WVLAF Z   81                                            LE0840 CLE041
0671 O                   NU7   WVLAL     84                                            LE0840 CLE041
0672 O        T     25 LR                                                 LE0840
0673 O                                   29 'TOTAL RECORDS ON FILE'       LE0840
0674 O                                   42 '- CALCULATED'                LE0840
0675 O                         NRIP  3   59                               LE0840
0676 O                         LVTOTIZ   81                               LE0840
0677 O                         LVTOTD    84                               LE0840
0678 O                    U8NU7         111 '***   DIFFERENCE   ***'      LE0840
0679 O        T  1     LR                                                 LE0840
0680 O                                   28 'S/EXPDU - RUN CONTROLS'      LE0840
0681 O        T  2     LR                                                 LE0840
0682 O                                   28 '----------------------'      LE0840
0683 O        T  3     LR                                                 LE0840
0684 O                                   29 'TOTAL RECORDS ON FILE'       LE0840
0685 O                         NROP  3   59                               LE0840
0686 O                         VROF  Z   81                               LE0840
0687 O                         VROL      84                               LE0840
0688 O********T*3      LR                                                 S01117
0689 O***********                        76 '*** END OF REPORT ***'       S01117
** CPY@   **      OBJECT COPYRIGHT
(c) Misys International Banking Systems Ltd. 2001
