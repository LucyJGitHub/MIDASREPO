0001 H        1                                                           S01117
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas LE Facilities expiring/review report')           *
0001 H***********                                                         S01117
0002 F********************************************************************
     F*  Midas - Customer Lending Module
0004 F*                                                                  *
0005 F*    LE0850 - PRINT FACILITIES EXPIRING/REVIEW REPORT              *
0006 F*                                                                  *
      *  (c) Misys International Banking Systems Ltd. 2001            *
0008 F*                                                                  *
      *  Last Amend No. CLE134             Date 01Aug12               *
      *  Prev Amend No. AR787620           Date 10Jun11               *
      *                 CER059             Date 19Jul10               *
      *                 CER043             Date 19May08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CSD031             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 CLE042             Date 06Sep05               *
      *                 CSW037A            Date 02May05               *
      *                 CLE041             Date 11Oct04               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 CLE025             Date 20Oct03               *
      *                 CGL029             Date 01Sep03               *
      * Midas Release 4.01.03 ----------------------------------------*
      *                 201127             Date 20Jan03               *
      *                 163474             Date 06Jan03               *
      * Midas Release 4.01.02 ----------------------------------------*
      *                 205910             Date 11Jun02               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.05 -----------------------------------------------*
      *                 176415             Date 29Nov00               *
      * Midas DBA 3.04 -----------------------------------------------*
      *                 171784             Date 01Aug00               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 CLE004             DATE 02DEC96               *
     F*                 S01392             DATE 05OCT92               *
     F*                 BH3538             DATE 22SEP92               *S01270
     F*                    S01270                  DATE 13AUG90          *S01270
     F*                    BHF144                  DATE 19JUN90          *BHF144
     F*                    BHF115                  DATE 08JUN90          *BHF115
     F*                    S01194                  DATE.19/01/90         *S01194
     F*                    S01117                  DATE.18/07/89         *S01194
     F*                                                                   S01117
     F*---------------------------------------------------------------    S01117
      *  CLE134 - Past Due Call Loan Processing                       *
      *  AR787620 - Hooks Incorporation                               *
      *             WNCPYSRC,LEH00097                                 *
      *             WNCPYSRC,LEH00102                                 *
      *             WNCPYSRC,LEH00103                                 *
      *             WNCPYSRC,LEH00104                                 *
      *             WNCPYSRC,LEH00105                                 *
      *             WNCPYSRC,LEH00098                                 *
      *             WNCPYSRC,LEH00099                                 *
      *             WNCPYSRC,LEH00100                                 *
      *             WNCPYSRC,LEH00101                                 *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  CER043 - German Features LF041-00 New Fields and Defaulting  *
      *           (Recompile)                                         *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CLE042 - Extended Loan Sub Type (Recompile)                  *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  CLE041 - Collateralised Lending Phase 2B                     *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  CLE025 - Credit Lines (Recompile)                            *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  201127 - Reports should show START instead of APPROVED for   *
      *           the facility start date.                            *
      *  163474 - Reports are not properly distributed to its correct *
      *           output queue. Pass correct branch to RCF program.   *
      *  205910 - Take negative facility amounts into consideration.  *
      *  176415 - Facility Expiring/Review Report showing 'To Drop'   *
      *           instead of 'Due to Expire'.  Applied fix 146421.    *
      *         - Expired facility dropped before retention period    *
      *           in year 2000.  Applied fix 173479.                  *
     F*  171784 - Report shows negative facility amounts as positive. *
     F*           Add negative sign to edit word.                     *
     F*  CLE004 - Customer Lending Enhancements - Syndication         *
     F*    S01392 - JAPANESE SUB MODULE ENHANCEMENTS
     F*    BH3538 - Month handling wrong for facility expiry check
     F*             when US date format
     F*    S01270 - CUSTOMER LENDING AMENDMENTS                          *S01270
     F*    BHF144 - LIKE BHF115 BUT FOR READ OF SDACOFPD NOT SDCURRPD    *BHF115
     F*    BHF115 - HAS 2 GOTOS NEXT TO EACH OTHER ON 44 AND NOT 44      *BHF115
     F*    S01194 - STANDING DATA CHANGES                                *S01194
     F*    S01117 - MULTIBRANCHING                                       *S01117
     F*                                                                  *S01117
0011 F********************************************************************
0012 F*                                                                  *
0013 F*                                                                  *
0014 F*                                                                  *
     F*  C R E A T I O N     P A R A M E T E R S                         *
     F*                                                                  *
     F*                                                                  *
0011 F********************************************************************
0012 F*                                                                  *
0013 F*                                                                  *
0014 F*
0015 FSEXPD   IP  F      64 20AI     2 DISK
0016 F*TABLE***IF**F******96*12AI*****2*DISK*****                         S01194
     FFCLTY   IF  E           K        DISK                               S01270
     FLEAGFCL5IF  E           K        DISK                                                   CLE041
     F            FCLTYHHF                          KRENAMEFCLTY6HF                           CLE041
     F            FCLTYFMF                          KRENAMEFCLTY6MF                           CLE041
     F            FCLTYFNF                          KRENAMEFCLTY6NF                           CLE041
     F            FCLTYZZF                          KRENAMEFCLTY6ZF                           CLE041
      *                                                                                       CLE041
     FSDCURRPDIF  E                    DISK                               S01194
     FSDACOFPDIF  E                    DISK                               S01194
0017 F*CLINT***IF**F*****256**7AI*****2*DISK*****                         S01194
0018 F*E0850P1O** F     132     OF     PRINTER                  S01124    S01117
0018 FLE0850P1O   F     132     OF     PRINTER      KINFDS SPOOL      UC  S01117
0018 FLE0850AUO   F     132            PRINTER      KINFDS SPOOLU         S01117
0019 F*
0020 F* ID F  C  H  L    FUNCTION OF INDICATORS
0021 F* 01            SORTED EXTRACT FILE - HEADER
0022 F* 02            SORTED EXTRACT FILE - FACILITY EXPIRED
0023 F* 03            SORTED EXTRACT FILE - FACILITY DUE TO EXPIRE
0024 F* 04            SORTED EXTRACT FILE - FACILITY DUE FOR REVIEW
0025 F* 05            SORTED EXTRACT FILE - TRAILER
0025 F* 06            FACILITY TO BE DROPPED AT MONTHEND                  S01270
0025 F* 07            FACILITY TO BE DROPPED AT EXPIRY DATE               S01270
0026 F**06************TABLE FILE - ICD1                                   S01194
0027 F**07************TABLE FILE - CURRENCY RECORD 1                      S01194
0028 F**08************TABLE FILE - ACCOUNT OFFICER CODE                   S01194
0029 F**09************CLIENT FILE- CUSTOMER DETAILS 'A' RECORD            S01194
0030 F**
0031 F*       15      FIRST CYCLE INDICATOR
0032 F*       16      AT LEAST ONE DETAIL RECORD BEEN READ
0033 F**
0034 F*       19      SEQUENCE - PREVIOUS RECORD = FCLTY DUE EXPIRE
0035 F*       20      SEQUENCE - PREVIOUS RECORD = FCLTY DUE REVIEW
0036 F**
0037 F*       30      0 DEC.PLACES
0038 F*       31      1 DEC.PLACE
0039 F*       32      2 DEC.PLACES
0040 F*       33      3 DEC.PLACES
0041 F*       36      FILE CONTROLS BALANCE
0042 F*       39      EXCEPTION OUTPUT - NO INPUT TODAY
0043 F* *
0044 F********40******CHAIN TO CLIENT FILE FAILED                         S01194
0044 F*       40      ACCESS TO SDCUSTPD FILE FAILED                      S01194
0045 F********41******WORK IND. TO ACCESS ACCOUNT OFFICER TABLE           S01194
0046 F********43******WORK IND. TO ACCESS ICD-1                           S01194
0046 F*       43      WORK IND. TO ACCESS SDBANKPD                        S01194
0047 F********44******WORK IND. TO ACCESS CCY TABLE                       S01194
0048 F*       45      CCY BLANK ON INPUT
0049 F*       46      ACOF  "   "    "
0050 F*       47      CCY CODE FOUND IN ARRAY
0051 F*       48      ACOF CODE FOUND IN ARRAY
     F*                                                                   S01117
     F*       50      MULTI-BRANCHING = 'YES'                             S01117
     F*                                                               *   CLE004
     F*   60  - SAR CLE004 is Present                                 *   CLE004
     F*                                                                   S01117
     F*       70      INDICATOR FOR MULTI-BRANCH OUTPUT                   S01117
     F*       75      INPUT FILE CONTAINS AT LEAST ONE RECORD             S01117
     F*       76      INDICATOR FOR PRINTING 'NO DETAILS TO REPORT'       S01117
     F*                                                                   S01117
     F*       86      SUPPRESS THE CONTROL TOTAL CHECKING                 S01117
0052 F**
0053 F*            L1 CHANGE OF ACCOUNT OFFICER
0054 F*            L2 CHANGE OF BRANCH
0055 F**
0056 F*         U7+U8 DATABASE ERROR
0057 F*         U8    FILE CONTROLS OUT OF BALANCE
0058 F*
0059 F*
0060 E                    ACY       150  3               CURRENCY CODES
0061 E                    ADP       150  1 0             CCY DEC.PLACES
     E                    AOC       100  2               A/C OFFICER CODES
0063 E                    AON       100 30               A/C OFFICER NAMES
0064 E*
     E/COPY ZSRSRC,ZDATE2Z1                                               S01392
     E                    CPY@    1   1 80
0068 E**
0069 I*
0070 I*    SORTED FACILITIES EXTRACT FILE - HEADER
0071 I*
0072 ISEXPD   NS  01   1 CH
0073 I                                        1   1 RECI
0074 I*
0075 I*    DETAIL RECORD
0076 I*
0077 I        NS  02   1 CD   7 C1
0078 I       OR   03   1 CD   7 C2
0079 I       OR   04   1 CD   7 C3
0080 I                                        1   1 RECI
0081 I***********                             2   40BRCDA L2              S01117
0081 I                                        2   4 BRCA  L2              S01117
     I                                        5   6 ACOF  L1
0083 I                                        7   70EXPR
0084 I                                    P   8  100DTEX
0085 I**********                             11  160CNUM                                      CSD027
0085 I                                       11  16 CNUM                                      CSD027
0086 I                                       17  190FACT
0087 I                                       20  210FCNO
0088 I                                    P  22  240DTAP
0089 I                                       25  27 FCCY
0090 I                                    P  28  340FAMT
0091 I                                       35  35 SECI
0092 I                                       36  36 MCCY
     I                                       37  37 MBFC                  S01117
     I                                       64  64 PRTR                  CLE004
0093 I*
0094 I*    TRAILER
0095 I*
0096 I        NS  05   1 CT
0097 I                                        1   1 RECI
0098 I                                    P   2   40NORE
0099 I                                    P   5  120VLRF
0100 I                                    P  13  140VLRL
0101 I*
0102 I*    CATCHALL
0103 I*
0104 I        NS
0105 I                                        1   1 RECI                  S01194
0106 I************                                                        S01194
0107 I*****TABLE*FILE*-*INSTALLATION*CONTROL DATA RECORD 1                S01194
0108 I************                                                        S01194
0109 I*TABLE***NS**06***1*CD***2*C0***3*C1******                          S01194
0110 I*******AND******12*C1**13 C0                                        S01194
0111 I************                            1   1 RECI                  S01194
0112 I************                            2   30RECT                  S01194
0113 I************                           12  130RCDE                  S01194
0114 I************                           14  66 TITL                  S01194
0115 I************                           67  67 DATF                  S01194
0116 I************                           68  700DFBR                  S01194
0117 I************                           74  74 MODI1                 S01194
0118 I************                           75  75 MODI2                 S01194
0119 I************                           76  76 MODI3                 S01194
0120 I************                        P  77  790RUND                  S01194
0121 I************                           80  86 RUNA                  S01194
0122 I************                           87  870SFLG                  S01194
0123 I************                        P  90  920LCD                   S01194
0124 I************                           93  93 CHTP                  S01194
0125 I************                        P  94  960TNLU                  S01194
0126 I************                                                        S01194
0127 I*****TABLE*FILE*-*CURRENCY*RECORD 1                                 S01194
0128 I************                                                        S01194
0129 I********NS**07***2*C2   3 C0                                        S01194
0130 I************                            1   1 RECI                  S01194
0131 I************                            2   30RECT                  S01194
0132 I************                           10  12 CCY                   S01194
0133 I************                           13  130SREC                  S01194
0134 I************                           14  27 CCNM                  S01194
0135 I************                        P  28  348SPOT                  S01194
0136 I************                           35  37 CCYS                  S01194
0137 I************                           38  380CDP                   S01194
0138 I************                           39  390TNOT                  S01194
0139 I************                           40  40 DCCY                  S01194
0140 I************                           41  44 SRC1                  S01194
0141 I************                           45  48 SRC2                  S01194
0142 I************                           49  520TACC                  S01194
0143 I************                           53  560TEQV                  S01194
0144 I************                           57  600SWQV                  S01194
0145 I************                           61  640TAC4                  S01194
0146 I************                           65  680TAC5                  S01194
0147 I************                           69  69 HIND                  S01194
0148 I************                        P  70  768PART                  S01194
0149 I************                           77  780SSNO                  S01194
0150 I************                        P  79  858ERLC                  S01194
0151 I************                           86  860MDIN                  S01194
0152 I************                           87  870MDIA                  S01194
0153 I************                           88  880MDIB                  S01194
0154 I************                           93  93 CHTP                  S01194
0155 I************                        P  94  960TNLU                  S01194
     I************                                                        S01194
0156 I************                                                        S01194
0157 I*****TABLE*FILE*-*ACCOUNT*OFFICERS*                                 S01194
0158 I************                                                        S01194
0159 I********NS**08**********2*C1***3*C4**                               S01194
0160 I************                            1   1 RECI                  S01194
0161 I************                            2   30RECT                  S01194
0162 I************                           12  13 ACOC                  S01194
0163 I************                           14  43 ACON                  S01194
0164 I************                           44  46 DEPC                  S01194
0165 I************                        P  90  920LCD                   S01194
0166 I************                           93  93 CHTP                  S01194
0167 I************                        P  94  960TNLU                  S01194
0168 I************                                                        S01194
0169 I*****TABLE*FILE*-*CATCHALL**                                        S01194
0170 I************                                                        S01194
0171 I********NS                                                          S01194
0172 I************                            1   1 RECI                  S01194
     I** FACILITY FILE FIELD NAME CHANGES TO PREVENT CONFUSION            S01270
     I** WITH SEXPD DETAILS                                               S01270
     IFCLTYZZF                                                            S01270
     I              CNUM                            CNUMF                 S01270
     I              FACT                            FACTF                 S01270
     I              FCNO                            FCNOF                 S01270
     ISDCURRD0                                                            S01194
     I              A6NBDP                          CDP                   S01194
     I              A6CYCD                          CCY                   S01194
     ISDACOFD0                                                            S01194
     I              AZACOC                          ACOC                  S01194
     I              AZACON                          ACON                  S01194
     ISDCLND    E DSSDCLNDPD                                              S01270
      **  EXTERNAL DS FOR CUSTOMER LENDING DETAILS                        S01270
     I              BPEFRP                          EFRP                  S01270
0173 I************                                                        S01194
0174 I*****CLIENT*FILE*-*CUSTOMER*STANDING*DATA*RECORD****                S01194
0175 I************                                                        S01194
0176 I*CLINT***NS**09***1*CD***8*CA**                                     S01194
0177 I************                            1   1 RECI                  S01194
0178 I************                            2   70CNUM                  S01194
0179 I************                            8   8 RCDT                  S01194
0180 I************                            9  28 CRNM                  S01194
0181 I************                           29  38 CTWN                  S01194
0182 I************                           39  48 CSNM                  S01194
0183 I************                           49  56 CASK                  S01194
0184 I************                           57  68 TELX                  S01194
0185 I************                           69  80 CSID                  S01194
0186 I************                           81  82 ACOC                  S01194
0187 I************                           83  83 CBSI                  S01194
0188 I************                           84  85 CCTZ                  S01194
0189 I************                           86  87 CLOC                  S01194
0190 I************                           88  930CPAR                  S01194
0191 I************                           94  960BRCD                  S01194
0192 I************                           97  980LINS                  S01194
0193 I************                           99 1010LIND                  S01194
0194 I************                        P 102 1040DASU                  S01194
0195 I************                        P 105 1070CDIC                  S01194
0196 I************                        P 108 1100DADE                  S01194
0197 I************                          111 111 CMIN                  S01194
0198 I************                          112 112 CTYP                  S01194
0199 I************                          113 124 TELF                  S01194
0200 I************                          125 133 CHID                  S01194
0201 I************                          134 136 CHAB                  S01194
0202 I************                        P 250 2520LCD                   S01194
0203 I************                          253 253 CHTP                  S01194
0204 I************                        P 254 2560TNLU                  S01194
0205 I************                                                        S01194
0206 I*****CLIENT*FILE*-*CATCHALL**                                       S01194
0207 I************                                                        S01194
0208 I********NS*******1NCD*****                                          S01194
0209 I************                            1   1 RECI                  S01194
0210 I*
0211 I*    LOCAL DATA AREA FOR DATABASE ERROR REFERENCES
0212 I*
0213 ILDA        UDS                            256
0214 I***********                           134 138 DBFILE                S01117
0215 I***********                           139 167 DBKEY                 S01117
0216 I***********                           168 175 DBPGM                 S01117
0217 I***********                           176 177 DBASE                 S01117
0214 I                                      134 141 DBFILE                S01117
0215 I                                      142 170 DBKEY                 S01117
0216 I                                      171 180 DBPGM                 S01117
0217 I                                      181 1830DBASE                 S01117
     I*                                                                   S01117
     I**   PROGRAM STATUS DATA STRUCTURE                                  S01117
     I*                                                                   S01117
     I*                                                                   S01117
     I**   FILE INFORMATION DATA STRUCTURE                                S01117
     I*                                                                   S01117
     ISPOOL       DS                                                      S01117
     I                                       83  92 SFILE                 S01117
     I                                    B 123 1240SFNUM                 S01117
     I**                                                                  S01117
     I**  EXTERNAL DATA AREA OF DATA QUEUE NAME/LIBRARY/SIZE              S01117
     I**                                                                  S01117
     I**                                                                  S01117
     ISPOOLU      DS                                                      S01117
     I                                       83  92 SFILEU                S01117
     I                                    B 123 1240SFNUMU                S01117
      *                                                                   S01194
     ISDBANK    E DSSDBANKPD                                              S01194
     I              BJURPT                          TITL                  S01194
     ISDBRCH    E DSSDBRCHPD                                              S01117
      **  EXTERNAL DS FOR BRANCH CODE DETAILS                             S01117
     I              A8BRNM                          BRNM                  S01194
     ISDCUST    E DSSDCUSTPD                                              S01194
      **   CUSTOMER                                                       S01194
     I              QQDFAC                          DFAC01                                    CGL029
     I              BBCRNM                          CRNM                  S01194
     I              BBCRTN                          CTWN                  S01194
     ISCSARD    E DSSCSARDPD                                              CLE004
      ***  External data structures for SAR Details                       CLE004
      *                                                                   CLE004
     IDSFDY     E DSDSFDY                                                 S01194
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01194
     I*                                                                   S01194
     IDSSDY     E DSDSSDY                                                 S01194
     I* SECOND DS FOR ACCESS PROGRAMS, LONG DATA STRUCTURE                S01194
     I*                                                                   S01194
     IRUNDT       DS                                                      S01117
     I                                        1   7 RUNA                  S01117
     I                                    P   8  100RUND                  S01117
     I                                       11  11 SSF                   S01117
     I                                       12  12 DATF                  S01117
     I                                       13  13 MBIN                  S01117
     C                     MOVEACPY@      BIS@   80
     C**                                                                  S01117
     C           *ENTRY    PLIST                                          S01117
     C                     PARM           SEQ     5                       S01117
     C                     PARM           BRNCH   3                       S01117
     C           PLIST3    PLIST                                          S01194
     C                     PARM '*MSG   ' @RTCD                           S01194
     C                     PARM '*KEY   ' @OPTN                           S01194
     C                     PARM           KEYC   10                       S01194
     C                     PARM '*CNUM'   KEYSTS  7                       S01194
     C           SDCUST    PARM SDCUST    DSSDY                           S01194
0218 C*
0219 C*    FIRST CYCLE/HEADER PROCESSING
0220 C*
     C**                                                                  S01194
     C*     IN THE DATAAREA LDA                                           S01194
     C**                                                                  S01194
     C           *NAMVAR   DEFN           LDA                             S01194
     C           *LOCK     IN   LDA                                       S01194
     C**                                                                  S01194
0221 C   15                GOTO ENDFC
0222 C                     SETON                     15
     C**                                                                  S01117
     C*     IN THE DATAAREA RUNDAT                                        S01117
     C**                                                                  S01117
     C           *NAMVAR   DEFN RUNDAT    RUNDT                           S01117
     C                     IN   RUNDT                                     S01117
0223 C*
0224 C*    SET UP DATABASE ERROR REFERENCE
0225 C*
0226 C                     MOVE 'LE0850  'DBPGM
0227 C                     MOVE ' '       BLANKS 30
0228 C                     MOVE BLANKS    DBKEY
0229 C*
0230 C* ACCESS ICD-1 FOR DATE FORMAT,TITLE,ETC.
0231 C*    DATABASE ERROR IF NOT THERE.
0232 C*
0233 C************         MOVEL'01    '  ICDKEY 12                       S01194
0234 C************         MOVE '    10'  ICDKEY                          S01194
0235 C***********ICDKEY    SETLLTABLE                                     S01194
0236 C***********          READ TABLE                    43               S01194
      ** ACCESS BANK DETAILS                                              S01194
     C                     CALL 'AOBANKR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDBANK    PARM SDBANK    DSFDY                           S01194
     C           @RTCD     IFNE *BLANKS                                   S01194
     C                     SETON                         43               S01194
     C                     END                                            S01194
0237 C***06N43***DATF      COMP 'M'                      98  = MMDDYY     S01194
0237 C     N43   DATF      COMP 'M'                      98  = MMDDYY     S01194
0238 C*
0239 C**N06**********                                                     S01194
0240 C*OR*43*********      SETON                     U7U8LR               S01194
0240 C   43                SETON                     U7U8LR               S01194
0241 C   U7 U8 LR          MOVE '01'      DBASE
0242 C***U7*U8*LR*******   MOVE 'TABLE'   DBFILE                          S01194
0242 C   U7 U8 LR          MOVE 'SDBANKPD'DBFILE                          S01194
0243 C***U7*U8*LR*******   MOVELICDKEY    DBKEY                           S01194
0244 C   U7 U8 LR          GOTO ENDC
      *                                                                   CLE004
      ** Check if SAR CLE004 is present                                   CLE004
      *                                                                   CLE004
     C                     CALL 'AOSARDR0'                                CLE004
     C                     PARM *BLANKS   P@RTCD  7                       CLE004
     C                     PARM '*KEY   ' P@OPTN  7                       CLE004
     C                     PARM 'CLE004'  P@SARD  6                       CLE004
     C           SCSARD    PARM SCSARD    DSFDY                           CLE004
      *                                                                   CLE004
     C           P@RTCD    IFEQ *BLANKS                                   CLE004
     C                     MOVE *ON       *IN60                           CLE004
     C                     ENDIF                                          CLE004
      *                                                                                       CLE041
     C                     CALL 'AOSARDR0'                                                    CLE041
     C                     PARM *BLANKS   P@RTCD                                              CLE041
     C                     PARM '*KEY   ' P@OPTN                                              CLE041
     C                     PARM 'CLE025'  P@SARD                                              CLE041
     C           SCSARD    PARM SCSARD    DSFDY                                               CLE041
      *                                                                                       CLE041
     C           P@RTCD    IFNE *BLANK                                                        CLE041
     C           P@RTCD    ANDNE'*NRF   '                                                     CLE041
     C                     MOVE *ON       *INU7                                               CLE041
     C                     MOVE *ON       *INU8                                               CLE041
     C                     MOVE *ON       *INLR                                               CLE041
     C                     MOVEL'SCSARDPD'DBFILE                                              CLE041
     C                     MOVELP@SARD    DBKEY                                               CLE041
     C                     MOVELP@OPTN    DBOPTN                                              CLE041
     C                     MOVEL'007'     DBASE                                               CLE041
     C                     EXSR *PSSR                                                         CLE041
     C                     ENDIF                                                              CLE041
      *                                                                                       CLE041
     C                     MOVE 'N'       CLE025  1                                           CLE041
     C           P@RTCD    IFEQ *BLANKS                                                       CLE041
     C                     MOVE 'Y'       CLE025                                              CLE041
     C                     ENDIF                                                              CLE041
     C/COPY WNCPYSRC,LEH00097
0245 C*
0246 C*    SET UP CURRENCY ARRAYS
0247 C***************      MOVEL'20'      CCYKEY 12                       S01194
0248 C***************      MOVE '1'       CCYKEY                          S01194
0249 C********** CCYKEY    SETLLTABLE                                     S01194
0250 C                     Z-ADD0         Y       30
0251 C*
0252 C           LOP1      TAG                             ** LOP1 TAG **
0253 C**************       SETOF                     0744                 S01194
0253 C                     SETOF                     44                   S01194
0254 C*************        READ TABLE                    44               S01194
     C                     READ SDCURRPD                 44               S01194
0255 C**N07********                                                       S01194
0256 C*OR*44*******        GOTO CCYEND                                    S01194
0256 C   44                GOTO CCYEND                                    S01194
0257 C*******    RECI      COMP 'D'                      44               S01194
0258 C**N44******          GOTO LOP1                                      BHF115
0259 C***********SREC      COMP 2                        44               S01194
0260 C***44******          GOTO LOP1                                      S01194
0261 C           Y         ADD  1         Y
0262 C                     MOVE CCY       ACY,Y
0263 C                     Z-ADDCDP       ADP,Y
0264 C           Y         COMP 150                    44
0265 C   44                GOTO LOP1
0266 C*
0267 C           CCYEND    TAG                             ** CCYEND TAG**
0268 C*
0269 C*    SET UP ACCOUNT OFFICER ARRAYS
0270 C*********            MOVEL'14'      ACOFKY 12                       S01194
0271 C*********  ACOFKY    SETLLTABLE                                     S01194
0272 C                     Z-ADD0         Y
0273 C*
0274 C           LOP2      TAG                             ** LOP2 TAG **
0275 C************         SETOF                     0841                 S01194
0275 C                     SETOF                     41                   S01194
0276 C************         READ TABLE                    41               S01194
     C                     READ SDACOFPD                 41               S01194
0277 C**N08********                                                       S01194
0278 C*OR*41*******        GOTO ACFEND                                    S01194
0278 C   41                GOTO ACFEND                                    S01194
0279 C*
0280 C***********RECI      COMP 'D'                      41               S01194
0281 C**N41******          GOTO LOP2                                      BHF144
0282 C           Y         ADD  1         Y
0283 C                     MOVE ACOC      AOC,Y
0284 C                     MOVE ACON      AON,Y
0285 C           Y         COMP 100                    41
0286 C   41                GOTO LOP2
0287 C*
0288 C           ACFEND    TAG                             ** ACFEND TAG**
0289 C*
0290 C*    COUNT HEADER RECORD READ.
0291 C*
0292 C   01                Z-ADD1         NORR    50
     C           MBIN      IFEQ 'Y'                                       S01117
     C                     SETON                     50                   S01117
     C           BRNCH     IFNE 'ALL'                                     S01117
     C                     SETON                     86                   S01117
     C                     END                                            S01117
     C                     END                                            S01117
0297 C**************************************************************      S01117
0296 C           ENDFC     TAG                             **ENDFC TAG **
     C*                                                                   S01117
0298 C*    DETERMINE SUB-ROUTINE FOR FURTHER PROCESSING
0299 C*
     C** SET OFF THE INDICATORS THAT CONDITION MESSAGE OUTPUT             S01270
     C** ON REPORT LE0850P1                                               S01270
     C*                                                                   S01270
     C                     SETOF                     0607                 S01270
0300 C   02
0301 COR 03
0302 COR 04                EXSR DETAIL
     C**                                                                  S01117
     C*    IGNORE THE TAILER PROCESSING IF NO CHECKING ON CONTROL TOTAL   S01117
     C**                                                                  S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C           BRNCH     ANDNE'ALL'                                     S01117
     C                     GOTO ENDC                                      S01117
     C                     END                                            S01117
0303 C*                                                                   S01117
0304 C   05                EXSR TRAILR
0305 C*                                                                   S01117
0306 C           ENDC      TAG                             ** ENDC TAG **
     C**                                                                  S01117
     C*   ENSURE TOTALS SPOOL FILE RECORDED BY RCF                        S01117
     C**                                                                  S01117
     CLR                   Z-ADDSFNUMU    ZSNUMU  60                      S01117
     CLR                   OUT  LDA
     C**                                                                  S01117
     CLR                   CALL 'ZSFILE'                                  S01117
     CLR                   PARM           SEQ                             S01117
     CLR                   PARM *BLANKS   SENTY                           S01117
     CLR                   PARM           SFILEU                          S01117
     CLR                   PARM           ZSNUMU                          S01117
     CLR                   PARM           ZSERR   1                       S01117
     CLR         *LOCK     IN   LDA
     C**                                                                  S01117
     CLR         ZSERR     IFEQ 'Y'                                       S01117
     C**  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM       S01117
     CLR                   SETON                     U7U8                 S01117
     CLR                   RETRN                                          S01117
     CLR                   END                                            S01117
     C**                                                                  S01117
     C*     IF P1 FILE NT OPEN (BECAUSE NO RECORDS READ) THEN OPEN IT     S01117
     C**                                                                  S01117
     CLR         *IN75     IFEQ '0'                                       S01117
     CLR                   EXSR #ZZ                                       S01117
     CLR                   END                                            S01117
0307 C**                                                                  S01117
     C*   PRODUCE A PROGRAM DUMP IF DTATBASE ERROR OCCUR                  S01117
     C**                                                                  S01117
     CLR U7 U8             EXSR *PSSR                                     S01117
     C*                                                                   S01117
0308 C********************************************************************
0309 C**
     C*    CALL BY : MAIN PROCESSING FOR DETAIL RECORD PROCESSING         S01117
0311 C*
0312 C           DETAIL    BEGSR                           *** DETAIL ***
     C**                                                                  S01117
     C           MBIN      IFNE 'Y'                                       S01117
     C                     SETON                     75                   S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C*                                                                   S01117
     C**      IF BRCA IS LESS THAN THE REQUIRED BRANCH,                   S01117
     C**      SKIP THE CALCULATION                                        S01117
     C*                                                                   S01117
     C           BRNCH     IFGT BRCA                                      S01117
     C           BRNCH     ANDNE'ALL'                                     S01117
     C                     SETOF                     70                   S01117
     C                     GOTO ENDD                                      S01117
     C                     END                                            S01117
     C**                                                                  S01117
     C           *INL2     IFEQ '1'                                       S01117
     C                     CLOSELE0850P1                                  S01117
     C*                                                                   S01117
     C**      IF BRCA IS GREATER THAN THE REQUIRED BRANCH,                S01117
     C**      END THE PROGRAM                                             S01117
     C*                                                                   S01117
     C           BRNCH     IFLT BRCA                                      S01117
     C           BRNCH     ANDNE'ALL'                                     S01117
     C                     SETON                     LR                   S01117
     C                     SETOF                     70                   S01117
     C                     GOTO ENDD                                      S01117
     C                     END                                            S01117
     C**                                                                  S01117
     C*       IF MBIN=YES, AND A REQUIRED BRANCH AND A LEVEL BREAK,       S01117
     C*       OPEN LE0850P1                                               S01117
     C**                                                                  S01117
     C           BRNCH     IFEQ 'ALL'                                     S01117
     C           BRNCH     OREQ BRCA                                      S01117
     C                     SETON                     7075  ALLOW OUTPUT   S01117
     C                     OPEN LE0850P1                                  S01117
     C                     Z-ADD0         PAGE                            S01117
     C                     Z-ADD0         PAGE1                           S01117
     C**                                                                  S01117
     C**  ENSURE TOTALS SPOOL FILE RECORDED BY RCF                        S01117
     C**                                                                  S01117
     C                     Z-ADDSFNUM     ZSNUM   60                      S01117
     C                     OUT  LDA
      *                                                                   S01117
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           SEQ                             S01117
     C**********           PARM BRNCH     SENTY                                        S01117 163474
     C                     PARM BRCA      SENTY                                               163474
     C                     PARM           SFILE                           S01117
     C                     PARM           ZSNUM                           S01117
     C                     PARM           ZSERR   1                       S01117
     C           *LOCK     IN   LDA
      *                                                                   S01117
     C           ZSERR     IFEQ 'Y'                                       S01117
      ** ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM        S01117
     C                     SETON                     U7U8LR               S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C**                                                                  S01117
     C** RETRIEVE SETTLEMENT BRANCH NAME                                  S01117
     C**********           CALL 'AOBRCHR0'                                S01117              CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       S01117
     C                     PARM '*KEY   ' @OPTN   7                       S01117
     C                     PARM BRCA      @DSNB   3                       S01117
     C********** SDBRCH    PARM SDBRCH    DSFDY                           S01117              CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANK                                    S01117
     C                     SETON                     U7U8LR               S01117
     C                     MOVEL'SDBRCHPD'DBFILE                          S01117
     C                     MOVEL@DSNB     DBKEY            ***************S01117
     C                     MOVEL@OPTN     DBOPTN  7        * DBERROR  05 *S01117
     C                     MOVEL'005'     DBASE            ***************S01117
     C                     MOVE BRCA      BRCAX                           S01117
     C                     MOVE *BLANKS   BRNM                            S01117
     C                     EXSR *PSSR                                     S01117
     C                     END                                            S01117
     C   U7                GOTO ENDD                                      S01117
     C**                                                                  S01117
     C                     ELSE                                           S01117
     C                     SETOF                     70                   S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C**                                                                  S01117
     C                     ELSE                                           S01117
     C**                                                                  S01117
     C*       IF MBIN='N' AND FIRST CYCLE,                                S01117
     C*       OPEN LE0850P1                                               S01117
     C**                                                                  S01117
     C           P1OP      IFNE 'Y'                                       S01117
     C                     SETON                     70    ALLOW OUTPUTPUTS01117
     C                     MOVE 'Y'       P1OP    1                       S01117
     C                     OPEN LE0850P1                                  S01117
     C                     Z-ADD0         PAGE                            S01117
     C                     Z-ADD0         PAGE1                           S01117
     C**                                                                  S01117
     C*       ENSURE REPORT SPOOL FILE RECORDED BY RCF                    S01117
     C**                                                                  S01117
     C                     Z-ADDSFNUM     ZSNUM                           S01117
     C                     OUT  LDA
      *                                                                   S01117
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           SEQ                             S01117
     C                     PARM BRCA      SENTY   3                       S01117
     C                     PARM           SFILE                           S01117
     C                     PARM           ZSNUM                           S01117
     C                     PARM           ZSERR   1                       S01117
     C           *LOCK     IN   LDA
      *                                                                   S01117
     C           ZSERR     IFEQ 'Y'                                       S01117
      ** ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM        S01117
     C                     SETON                     U7U8LR               S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C** MOVE 'BRCA' TO 'BRCX' FOR OUTPUT, OTHERWISE OUTPUTED             S01117
     C** VALUE IS THAT PICKED UP BY CHAIN TO CLIENT FILE                  S01117
     C*                                                                   S01117
     C                     MOVE BRCA      BRCAX   3                       S01117
0313 C*
0314 C*    CHECK SEQUENCE OF RECORDS. DATABASE ERROR IF WRONG.
0315 C   02 19NL1
0316 COR 02 20NL1
0317 COR 03 20NL1          SETON                     U7U8LR
0318 C*
0319 C**NU7NU8NLR          GOTO SEQ                                       S01117
0319 C  NU7NU8NLR          GOTO SEQ1                                      S01117
0320 C*
0321 C                     MOVE '02'      DBASE
0322 C                     MOVE 'SEXPD'   DBFILE
0323 C*
0324 C                     MOVEL'   /'    DBKEY1  6
0325 C                     MOVELFACT      DBKEY1
0326 C                     MOVE FCNO      DBKEY1
0327 C                     MOVEL'      -' DBKEY2 13
0328 C                     MOVELCNUM      DBKEY2
0329 C                     MOVE DBKEY1    DBKEY2
0330 C                     MOVELDBKEY2    DBKEY
0331 C                     GOTO ENDD
0332 C*
0333 C*
0334 C***********SEQ       TAG                             ** SEQ TAG **  S01117
0334 C           SEQ1      TAG                             **SEQ1 TAG **  S01117
0335 C*
0336 C*    SET SEQUENCE INDICATOR FOR DATABASE CHECK ON NEXT RECORD
0337 C*
0338 C                     SETOF                     1920
0339 C   03                SETON                     19
0340 C   04                SETON                     20
0341 C*
0342 C*    COUNT RECORDS READ
0343 C*
0344 C           NORR      ADD  1         NORR
0345 C*
0346 C*HASH TOTAL FACILITY AMOUNT. OUTPUT FIELDS ZZTOTI/ZZTOTD
0347 C                     Z-ADD0         ZZAMT
0348 C                     MOVE FAMT      ZZAMT
     C           ZZAMT     IFLT 0                                                             205910
     C                     Z-SUBZZAMT     ZZAMT                                               205910
     C                     END                                                                205910
0349 C                     EXSR GLZADD
0350 C*
0351 C*CHAIN*TO*CLIENT*FILE FOR CUSTOMER DETAILS                          S01194
0351 C*CALL ACCESS PROGRAMME FOR CUSTOMER DETAILS                         S01194
0352 C*
0353 C*************        MOVELCNUM      CLINKY  7                       S01194
0354 C*************        MOVE 'A'       CLINKY                          S01194
0353 C                     MOVELCNUM      KEYC                            S01194
0355 C***********CLINKY    CHAINCLINT                40                   S01194
0356 C*                                                                   S01194
     C                     CALL 'AOCUSTR0'PLIST3                          S01194
     C*                                                                   S01194
     C           @RTCD     COMP *BLANKS              4040                 S01194
0357 C*    DATABASE ERROR IF LIVE RECORD NOT FOUND
0358 C*
0359 C**N40******RECI      COMP 'D'                  4040                 S01194
0360 C   40                SETON                     U7U8LR
0361 C   40                MOVE '03'      DBASE
0362 C***40********        MOVE 'CLINT'   DBFILE                          S01194
0362 C   40                MOVE 'SDCUSTPD'DBFILE                          S01194
0363 C***40********        MOVELCLINKY    DBKEY                           S01194
0363 C   40                MOVELKEYC      DBKEY                           S01194
0364 C   40                GOTO ENDD
0365 C*
0366 C* ACCESS CURRENCY ARRAYS FOR DECIMAL PLACES
0367 C* IF BLANK ON FILE, DATABASE ERROR
0368 C                     SETOF                     303132
0369 C                     SETOF                     3347
0370 C           FCCY      COMP '   '                    45
0371 C   45                GOTO DBASE4
0372 C                     Z-ADD1         T       30
0373 C           FCCY      LOKUPACY,T                    47
0374 C*
0375 C   47      ADP,T     COMP 1                      3031
0376 C   47N30N31ADP,T     COMP 3                      3233
0377 C*
0378 C* DATABASE ERROR IF NOT FOUND
0379 C           DBASE4    TAG                             ** DBASE4 TAG**
0380 C  N47                SETON                     U7U8LR
0381 C  N47                MOVE '04'      DBASE
0382 C**N47*********       MOVE 'TABLE'   DBFILE                          S01194
0382 C  N47                MOVE 'SDCURRPD'DBFILE                          S01194
0383 C  N47                MOVELFCCY      CKEY1   4
0384 C  N47                MOVE '1'       CKEY1
0385 C**N47*********       MOVEL'20'      CCYKEY                          S01194
0386 C**N47********        MOVE CKEY1     CCYKEY                          S01194
0387 C**N47********        MOVELCCYKEY    DBKEY                           S01194
0387 C  N47                MOVELCKEY1     DBKEY                           S01194
0388 C  N47                GOTO ENDD
0389 C*
0390 C* IF FIRST DETAIL RECORD (N16) OR NEW ACCOUNT OFFICER,
0391 C* ACCESS A/C OFFICER ARRAY FOR NAME
0392 C* IF BLANK ON FILE, DATABASE ERROR
0393 C   16NL1             GOTO QACOF
0394 C                     SETOF                     48
     C           ACOF      COMP '  '                     46
0396 C* IF NOT FOUND - NOT A DATABASE ERROR -- DBASE5 REMOVED
0397 C   46                SETON                     4816
0398 C   46                MOVE BLANKS    ACON
0399 C   46                MOVEL'UNKNOWN' ACON
0400 C   46                GOTO QACOF
0401 C                     Z-ADD1         T
0402 C           ACOF      LOKUPAOC,T                    48
0403 C   48                MOVE AON,T     ACON
0404 C*
0405 C*
0406 C                     SETON                     16
0407 C*
0408 C           QACOF     TAG                             **QACOF TAG **
0409 C*
0410 C*    CONVERT DAYNOS TO DATE FORMAT
0411 C*
0412 C                     Z-ADDDTEX      ZDAYNO
0413 C                     EXSR ZDATE2
0414 C                     MOVE ZADATE    DTEXO   7
0415 C*
0416 C                     Z-ADDDTAP      ZDAYNO
0417 C                     EXSR ZDATE2
0418 C                     MOVE ZADATE    DTAPO   7
0419 C*
     C*                                                                   S01270
     C** SETUP KEYFIELD FOR SETTING LOWER LIMITS ON FACILITY FILES        S01270
     C** FOR CURRENT LOAN NUMBER AND FACILITY DETAILS                     S01270
     C** FOR AN EXPIRED LOAN THE CURRENT AMOUNT DRAWN IS REQUIRED         S01270
     C** FROM FCLTYFN - FACILITY B RECORD                                 S01270
     C** REVOLVING CREDIT INDICATOR IS REQUIRED FOR ALL RECORDS           S01270
     C*                                                                   S01270
     C           FACKY     KLIST                                          S01270
     C                     KFLD           CNUM                            S01270
     C                     KFLD           FACT                            S01270
     C                     KFLD           FCNO                            S01270
     C                     KFLD           RTYP    1                       S01270
     C*                                                                   S01270
     C** CHECK WHETHER EXPIRED FACILITY SHOULD BE DROPPED FROM FILES      S01270
     C*                                                                   S01270
     C**                                                                  S01270
     C** ACCESS CUSTOMER LENDING DATA                                     S01270
     C**                                                                  S01270
     C                     CALL 'AOCLNDR0'                                S01270
     C                     PARM '*MSG   ' @RTCD   7                       S01270
     C                     PARM '*FIRST ' @OPTN   7                       S01270
     C********** SDCLND    PARM SDCLND    DSFDY                                        S01270 CLE134
     C           SDCLND    PARM SDCLND    DSSDY                                               CLE134
     C           @RTCD     IFNE *BLANK                                    S01270
     C                     SETON                     U7U8LR               S01270
     C                     MOVEL@OPTN     DBKEY            ***************S01270
     C                     Z-ADD6         DBASE            *** DBASE 6 ***S01270
     C                     MOVEL'SDCLNDPD'DBFILE           ***************S01270
     C                     GOTO ENDD                                      S01270
     C                     END                                            S01270
     C*                                                                   S01270
     C** CHECK THE EXPIRED FACILITY RETENTION PERIOD (EFRP) ON SDCLNDPD   S01270
     C** AND THE RUN TYPE FROM LDA.                                       S01270
     C** IF EFRP IS BETWEEN 0 AND 99 IE. A SET RETENTION PERIOD AND       S01270
     C** THE RUNTYPE IS MONTHEND OR YEAREND CONTINUE THE CHECKING         S01270
     C** OF THE EXPIRY DATE                                               S01270
     C*                                                                   S01270
     C           EFRP      IFGE 0                                         S01270
     C           EFRP      ANDLT99                                        S01270
     C           EXPR      ANDEQ2                                         S01270
     C*                                                                   S01270
     C** READ FACILITY B RECORD AND CHECK THAT CURRENT AMOUNT DRAWN       S01270
     C** IS ZERO OTHERWISE EXPIRED FACILITY DROPPING UNNECESSARY          S01270
     C*                                                                   S01270
     C                     MOVE 'B'       RTYP                            S01270
     C           CLE025    IFEQ 'Y'                                                           CLE041
     C           FACKY     SETLLLEAGFCL5                                                      CLE041
     C                     READ LEAGFCL5                 99                                   CLE041
     C                     ELSE                                                               CLE041
     C           FACKY     SETLLFCLTY                                     S01270
     C                     READ FCLTY                    99               S01270
     C                     ENDIF                                                              CLE041
     C/COPY WNCPYSRC,LE0850C001
     C*                                                                   S01270
     C** CHECK THAT THE CURRENT EXPOSURE AMOUNT DRAWN IS ZERO OTHERWISE   S01270
     C** LOAN WILL NOT HAVE EXPIRED ANYWAY AND RETENTION PERIOD CHECK     S01270
     C** IS UNNECESSARY                                                   S01270
     C*                                                                   S01270
     C           CAMD      IFEQ 0                                         S01270
     C           *IN99     ANDEQ'0'                                       S01270
     C                     EXSR EXPDRP                                    S01270
     C*                                                                   S01270
     C                     END                                            S01270
     C                     END                                            S01270
     C*                                                                   S01270
     C/COPY WNCPYSRC,LEH00454
     C** FOR EACH RECORD CHECK THE FACILITY A RECORD FOR THE REVOLVING    S01270
     C** CREDIT INDICATOR AND OUTPUT TO THE REPORT                        S01270
     C*                                                                   S01270
     C                     MOVE 'A'       RTYP                            S01270
     C           CLE025    IFEQ 'Y'                                                           CLE041
     C           FACKY     SETLLLEAGFCL5                                                      CLE041
     C                     READ LEAGFCL5                 99                                   CLE041
     C                     ELSE                                                               CLE041
     C           FACKY     SETLLFCLTY                                     S01270
     C                     READ FCLTY                    99               S01270
     C                     ENDIF                                                              CLE041
0420 C*
0421 C           ENDD      ENDSR                           ** ENDD TAG **
0422 C*
0423 C*
0424 C********************************************************************
0425 C*
0426 C*    TRAILER/LR PROCESSING
0427 C*
0428 C           TRAILR    BEGSR                           *** TRAILR ***
0429 C*
0430 C*    COUNT RECORD READ
0431 C*
0432 C           NORR      ADD  1         NORR
0433 C*
0434 C*    IF DETAIL RECORDS HAVE BEEN PRINTED,
0435 C*    EXCEPTION OUTPUT 'END OF REPORT' STATEMENT
0436 C*
0437 C***16******          EXCPT                                          S01117
0438 C*
0439 C*    IF NO DETAIL RECORD ON FILE, EXCEPTION OUTPUT
0440 C*    "NO INPUT TODAY"
0441 C*
0442 C**N16******          SETON                     39OF                 S01117
0443 C***39******          EXCPT                                          S01117
0444 C***********          SETOF                     39                   S01117
0445 C*
0446 C*    COMPARE COUNT OF RECORDS READ WITH FILE CONTROLS
0447 C*
0448 C           NORR      COMP NORE                     36
0449 C*
0450 C*    IF ABOVE EQUAL, COMPARE HASH TOTALS WITH FILE CONTROLS
0451 C*
0452 C   36      ZZTOTI    COMP VLRF                     36
0453 C   36      ZZTOTD    COMP VLRL                     36
0454 C*
0455 C*    IF ANY TOTALS NOT AGREE, SET ON U8
0456 C*
0457 C  N36                SETON                     U8
0458 C*
0459 C*
0460 C                     ENDSR
0461 C*
     C**                                                                  S01117
     C**                                                                  S01117
0463 C********************************************************************
     C/COPY ZSRSRC,ZDATE1Z2                                               S01392
     C/COPY ZSRSRC,ZDATE2Z4                                               S01392
0552 C********************************************************************
0553 C* SUBROUTINE TO ADD AN AMOUNT (ZZAMT) TO THE TOTAL (ZZTOTI,ZZTOTD)
0554 C*   IND '99' IS SET BY AN OVERFLOW ERROR
0555 C*
0556 CSR         GLZADD    BEGSR                           *** GLZADD ****
0557 C*
0558 CSR                   Z-ADDZZAMT     ZZAMT  153     91-DEFINE ZZAMT
0559 CSR 91                GOTO ZZAEND                     AMT = 0.BYPASS
0560 C*
0561 C* SPLIT ZZAMT INTO INTEGER AND DECIMAL FIELDS
0562 CSR                   Z-ADDZZAMT     ZZAMTI 150       INTEGER FIELD
0563 CSR                   MOVE ZZAMT     ZZAMTD  30       DECIMAL FIELD
0564 C* BOTH ZZAMTI AND ZZAMTD CONTAIN A 'SIGN' ZONE NOW
0565 C*
0566 CSR                   EXSR GLZSUM
0567 CSR         ZZAEND    ENDSR                           ** ZZAEND TAG *
0568 C*
0569 C********************************************************************
0570 C* SUBROUTINE TO CARRY OUT THE ADDITION FOR SUBROUTINES -
0571 C*                        GLZADD, GLZSUB, GLZCMP.
0572 C*          PARAMETERS PASSED -
0573 C*                     I/P ZZAMTI ZZAMTD
0574 C*                     O/P ZZTOTI ZZTOTD ZZNEGD IND 96 IND 99.
0575 C*
0576 CSR         GLZSUM    BEGSR                           *** GLZSUM ****
0577 C*
0578 CSR                   Z-ADDZZTOTI    ZZTOTI 150       DEFINE ZZTOTI
0579 CSR                   Z-ADDZZTOTD    ZZTOTD  30       DEFINE ZZTOTD
0580 CSR                   SETOF                     919293
0581 CSR                   SETOF                     949599
0582 C*
0583 C*    DETERMINE SIGN OF ZZAMTI & D,   92 IF NEG
0584 CSR         ZZAMTI    COMP 0                      9293
0585 CSR 93      ZZAMTD    COMP 0                      9293
0586 CSR 93                GOTO ZZSEND                     ZERO BYPASS
0587 C*
0588 C*    DETERMINE SIGN OF ZZTOTI & D, 91 IF NEG.
0589 CSR         ZZTOTI    COMP 0                      9193
0590 CSR 93      ZZTOTD    COMP 0                      9193
0591 C*
0592 C*    IF ZZTOTAL IS ZERO, RETURN ZZAMOUNT.
0593 CSR 93                Z-ADDZZAMTI    ZZTOTI
0594 CSR 93                Z-ADDZZAMTD    ZZTOTD
0595 CSR 93                GOTO ZZSEND                     ZERO BYPASS
0596 C*    IF SIGNS DIFFER BYPASS OVERFLOW CHECKS.
0597 CSR 91N92
0598 CORN91 92             GOTO ZZOFPS
0599 C*
0600 CSR         ZZAMTD    ADD  ZZTOTD    ZZWK2   40
0601 CSR         ZZWK2     COMP 999                  93    '93' = CARRY
0602 CSRN93      ZZWK2     COMP -999                   93    INTO INTEGER.
0603 C*
0604 CSR 93N92   ZZAMTI    ADD  1         ZZWK3  150       ADD 'CARRY' +VE
0605 CSR    93 92ZZAMTI    SUB  1         ZZWK3            SUB 'CARRY' -VE
0606 CSR 93      ZZTOTI    ADD  ZZWK3     ZZWK3
0607 CSRN93      ZZTOTI    ADD  ZZAMTI    ZZWK3
0608 C*
0609 C* IF THE MODULUS OF ZZWK3 IS LT MOD. ZZTOTI THEN O/F HAS OCCURED
0610 CSRN92      ZZWK3     COMP ZZTOTI                 99  -92 MEANS NOS.
0611 CSR 92      ZZWK3     COMP ZZTOTI               99     NEGATIVE
0612 CSRN99                Z-ADDZZWK2     ZZTOTD
0613 CSRN99                Z-ADDZZWK3     ZZTOTI
0614 C*
0615 C* IF O/F ZEROIZE ZZAMT , IND '99' SET AND ZZTOT FIELDS LEFT INTACT.
0616 CSR 99                Z-ADD0         ZZAMT  153
0617 CSR                   GOTO ZZSEND
0618 C*
0619 C* THE 'SIGNS' ARE DIFFERENT
0620 CSR         ZZOFPS    TAG                             ** ZZOFPS TAG**
0621 C* IF ZZAMT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZTOT
0622 C*
0623 CSR 92                Z-SUBZZAMTI    ZZAMTI 150
0624 CSR 92                Z-SUBZZAMTD    ZZAMTD  30
0625 C*
0626 C* IF ZZTOT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZAMT.
0627 C*
0628 CSR 91                Z-SUBZZTOTI    ZZTOTI
0629 CSR 91                Z-SUBZZTOTD    ZZTOTD
0630 C* BOTH ZZAMT AND ZZTOT ARE NOW POSITIVE.
0631 C*
0632 CSR         ZZTOTI    COMP ZZAMTI               93  95
0633 CSR 95      ZZTOTD    COMP ZZAMTD               93  95
0634 C*
0635 C* IF ZZTOT EQ. ZZAMT RETURN ZERO.
0636 CSR 95                Z-ADD0         ZZTOTI
0637 CSR 95                Z-ADD0         ZZTOTD
0638 CSR 95                GOTO ZZSEND
0639 C*
0640 C* IF ZZTOT GT. ZZAMT.
0641 CSR 93      ZZAMTD    COMP ZZTOTD               94
0642 CSR 93 94   ZZTOTI    SUB  1         ZZTOTI
0643 CSR 93 94   ZZTOTD    ADD  1000      ZZWK2
0644 CSR 93      ZZTOTI    SUB  ZZAMTI    ZZTOTI
0645 CSR 93 94   ZZWK2     SUB  ZZAMTD    ZZTOTD
0646 CSR 93N94   ZZTOTD    SUB  ZZAMTD    ZZTOTD
0647 C*
0648 C*
0649 C* IF ZZAMT GT. ZZTOT.
0650 CSRN93      ZZTOTD    COMP ZZAMTD               94
0651 CSRN93 94   ZZAMTI    SUB  1         ZZWK3  150
0652 CSRN93 94   ZZAMTD    ADD  1000      ZZWK2
0653 CSRN93 94   ZZWK3     SUB  ZZTOTI    ZZTOTI
0654 CSRN93N94   ZZAMTI    SUB  ZZTOTI    ZZTOTI
0655 CSRN93 94   ZZWK2     SUB  ZZTOTD    ZZTOTD
0656 CSRN93N94   ZZAMTD    SUB  ZZTOTD    ZZTOTD
0657 C*
0658 C* REVERSE SIGN OF ZZTOT IF LARGER I/P FIELDS WERE NEGATIVE
0659 CSR                   SETOF                     94
0660 CSR 93 91
0661 CORN93 92             SETON                     94
0662 CSR 94                Z-SUBZZTOTI    ZZTOTI
0663 CSR 94                Z-SUBZZTOTD    ZZTOTD
0664 C**
0665 C**   RESTORE SIGN OF ZZAMTI & ZZAMTD IF IT WAS REVERSED.
0666 CSR 92                Z-SUBZZAMTI    ZZAMTI
0667 CSR 92                Z-SUBZZAMTD    ZZAMTD
0668 CSR         ZZSEND    TAG                             ** ZZSEND TAG *
0669 C**
0670 C**   IF ZZTOTD IS ZERO, AND ZZTOTI IS NEG. SET UP ZZNEGD.
0671 CSR                   SETOF                     96
0672 CSR         ZZTOTD    COMP 0                        91
0673 CSR 91      ZZTOTI    COMP 0                      96
0674 CSR 96                MOVE '.000-'   ZZNEGD  5
0675 CSR                   ENDSR                             ** ENDSR **
0581 C********************************************************************S01117
1185 C********************************************************************S01270
     C** EXPDRP TO CHECK EXPIRED LOANS AND TO DROP FROM FILES AS          S01270
     C** APPROPRIATE                                                      S01270
     C*                                                                   S01270
     C** CALLED BY: DETAIL                                                S01270
     C** CALLS: ZDATE1, ZDATE2                                            S01270
     C** FACILITIES TO BE DROPPED INDICATED BY *IN06 OR *IN07 HAVING      S01270
     C** SET ON ACCORDING TO WHETHER BEING DROPPED AT MONTHEND OR
     C** SPECIFIED DATE
     C*                                                                   S01270
     C           EXPDRP    BEGSR                                          S01270
     C*                                                                   S01270
     C** IF EXPIRED FACILITY RETENTION PERIOD WAS 00 THEN BYPASS DATE     S01270
     C** CHECKING                                                         S01270
     C*                                                                   S01270
     C           EFRP      IFGT 0                                         S01270
     C*                                                                   S01270
     C** CHECK THE RETENTION PERIOD FOR THE NUMBER OF YEARS AND MONTHS    S01270
     C** AND MOVE THE YEAR AND MONTH VALUES INTO APPROPRIATE FIELDS       S01270
     C*                                                                   S01270
     C           EFRP      IFGT 12                                        S01270
     C           EFRP      DIV  12        FACRTN  10                      S01270
     C                     MVR            FACREM  20                      S01270
     C                     ELSE                                           S01270
     C                     Z-ADD0         FACRTN                          S01270
     C                     Z-ADDEFRP      FACREM                          S01270
     C                     END                                            S01270
     C*                                                                   S01270
     C** CONVERT RUNDATE INTO DDMMYY FORMAT                               S01270
     C*                                                                   S01270
     C                     Z-ADDRUND      ZDAYNO                          S01270
     C                     EXSR ZDATE2                                    S01270
     C*                                                                   S01270
     C** CREATE TWO SEPARATE FIELDS FOR THE MONTH AND THE YEAR            S01270
     C** FROM THE RESULTING DATE                                          S01270
     C*                                                                   S01270
     C** European date format                                             BH3538
     C*                                                                   BH3538
     C           *IN98     IFEQ '0'                                       BH3538
     C                     MOVE ZDATE     TEST1   4                       S01270
     C                     MOVE ZDATE     YEAR    20                      S01270
     C                     MOVELTEST1     MONTH   20                      S01270
     C*                                                                   BH3538
     C** US date format                                                   BH3538
     C*                                                                   BH3538
     C                     ELSE                                           BH3538
     C                     MOVE ZDATE     YEAR    20                      BH3538
     C                     MOVELZDATE     MONTH   20                      BH3538
     C                     END                                            BH3538
     C*                                                                   S01270
     C** ADD ONE TO THE MONTH TO CHECK WHETHER TO BE DROPPED              S01270
     C** AT COMING MONTHEND                                               S01270
     C*                                                                   S01270
     C           MONTH     ADD  1         MONTH                           S01270
     C*                                                                   S01270
     C** CHECK THAT NEW MONTH NUMBER VALID AND ADJUST ACCORDINGLY         S01270
     C*                                                                   S01270
     C           MONTH     IFGT 12                                        S01270
     C           YEAR      ADD  1         YEAR                            S01270
     C           MONTH     SUB  12        MONTH                           S01270
     C                     END                                            S01270
     C*                                                                   S01270
     C** AND USE THE RETENTION PERIOD TO CALCULATE THE DATE FOR           S01270
     C** DROPPING EXPIRED FACILITIES                                      S01270
     C*                                                                   S01270
     C           YEAR      SUB  FACRTN    RTNYR   20                      S01270
     C           MONTH     SUB  FACREM    RTNMTH  20                      S01270
     C*                                                                   S01270
     C** CHECK WHETHER THE RESULTING MONTH IS NEGATIVE AND IF SO ADJUST   S01270
     C** ACCORDINGLY                                                      S01270
     C*                                                                   S01270
     C********** RTNMTH    IFLT 0                                  S01270 176415
     C           RTNMTH    IFLE 0                                         176415
     C           RTNYR     SUB  1         RTNYR                           S01270
     C           RTNMTH    ADD  12        RTNMTH                          S01270
     C                     END                                            S01270
      *                                                                   176415
      ** To cater for dates past the year 2000, check for negative        176415
      ** year.  If so, add 100 to negative year.                          176415
      *                                                                   176415
     C           RTNYR     IFLT 0                                         176415
     C           RTNYR     ADD  100       RTNYR                           176415
     C                     ENDIF                                          176415
     C*                                                                   S01270
     C** CONSTRUCT CHECK DATE WITH DAY NUMBER 01                          S01270
     C*                                                                   S01270
     C*                                                                   S01270
     C** European date format                                             BH3538
     C*                                                                   BH3538
     C           *IN98     IFEQ '0'                                       BH3538
     C                     MOVEL'01'      TEST2   40                      S01270
     C                     MOVE RTNMTH    TEST2                           S01270
     C                     MOVE RTNYR     ZDATE   60                      S01270
     C                     MOVELTEST2     ZDATE                           S01270
     C*                                                                   BH3538
     C** US date format                                                   BH3538
     C*                                                                   BH3538
     C                     ELSE                                           BH3538
     C                     MOVE '01'      TEST2                           BH3538
     C                     MOVELRTNMTH    TEST2                           BH3538
     C                     MOVE RTNYR     ZDATE                           BH3538
     C                     MOVELTEST2     ZDATE                           BH3538
     C                     END                                            BH3538
     C*                                                                   S01270
     C** CONVERT RESULTING DATE INTO A MIDAS DAY NUMBER                   S01270
     C*                                                                   S01270
     C                     EXSR ZDATE1                                    S01270
     C                     MOVE ZDAYNO    CHKDT   50                      S01270
     C*                                                                   S01270
     C** IF EXPIRED FACILITY RETENTION PERIOD WAS 00 MAKE CHKDT ZERO      S01270
     C*                                                                   S01270
     C                     ELSE                                           S01270
     C                     Z-ADD0         CHKDT                           S01270
     C                     END                                            S01270
     C*                                                                   S01270
     C** CHECK THE VALUE OF THE CHECK DATE AGAINST EXPIRY DATE            S01270
     C** AND SET ON INDICATOR 06 IF FACILITY TO BE DROPPED AT MONTH       S01270
     C** END OR SET ON INDICATOR 07 IF IT IS TO BE DROPPED AT EXPIRY      S01270
     C** DATE                                                             S01270
     C*                                                                   S01270
     C           CHKDT     IFNE 0                                         S01270
     C           DTEX      ANDLECHKDT                                     S01270
     C                     MOVE '1'       *IN06                           S01270
     C                     END                                            S01270
     C*                                                                   S01270
     C           CHKDT     IFEQ 0                                         S01270
     C                     MOVE '1'       *IN07                           S01270
     C                     MOVE DTEXO     DRPDT   7                       S01270
     C                     END                                            S01270
     C*                                                                   S01270
     C                     ENDSR                                          S01270
1184 C********************************************************************S01270
     C*                                                                   S01117
     C*                                                                   S01117
     C* SUBROUTINE : #ZZ                                                  S01117
     C*                                                                   S01117
     C* CALLED BY MAIN PROCESSING DURING TOTAL TIME CALCULATIONS IF       S01117
     C* THE P1 FILES HAVE NOT ALREADY BEEN OPENED (IE, IF THERE ARE       S01117
     C* NO RECORDS READ AND THEREFORE FILES OPENING NOT PERFORMED)        S01117
     C**                                                                  S01117
0454 C           #ZZ       BEGSR                           *** NODETL *** S01117
     C**                                                                  S01117
     C                     MOVE 'Y'       P1OP                            S01117
     C                     MOVELBRNCH     BRCA    3                       S01117
     C                     OPEN LE0850P1                                  S01117
     C                     Z-ADD*ZEROS    PAGE                            S01117
     C                     Z-ADD*ZEROS    PAGE1                           S01117
      *                                                                   S01117
      ** IF REPORT FOR ALL ENTITIES CALL ZSFILE WITH BLANK SENTY          S01117
     C           BRNCH     IFEQ 'ALL'                      B1             S01117
     C           MBIN      ORNE 'Y'                                       S01117
     C**                                                                  S01117
     C                     MOVEL*BLANKS   BRNM                            S01117
     C*                                                                   S01117
     C** ENSURE REPORT SPOOL FILE RECORDED BY RCF                         S01117
     C**                                                                  S01117
     C                     Z-ADDSFNUM     ZSNUM   60                      S01117
     C                     OUT  LDA
     C**                                                                  S01117
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           SEQ                             S01117
     C                     PARM *BLANKS   SENTY   3                       S01117
     C                     PARM           SFILE                           S01117
     C                     PARM           ZSNUM                           S01117
     C                     PARM           ZSERR   1                       S01117
     C           *LOCK     IN   LDA
      *                                                                   S01117
     C           ZSERR     IFEQ 'Y'                                       S01117
      **  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM       S01117
     C                     SETON                     U7U8LR               S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C**                                                                  S01117
      *                                                                   S01117
      ** ELSE REPORT BY ENTITY SO CALL ZSFILE WITH ENTITY REQUESTED       S01117
     C                     ELSE                            X1             S01117
      *                                                                   S01117
      ** ENSURE REPORT SPOOL FILE RECORDED BY RCF                         S01117
     C**                                                                  S01117
     C                     Z-ADDSFNUM     ZSNUM   60                      S01117
     C                     OUT  LDA
     C**                                                                  S01117
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           SEQ                             S01117
     C                     PARM BRNCH     SENTY   3                       S01117
     C                     PARM           SFILE                           S01117
     C                     PARM           ZSNUM                           S01117
     C                     PARM           ZSERR   1                       S01117
     C           *LOCK     IN   LDA
      *                                                                   S01117
     C           ZSERR     IFEQ 'Y'                                       S01117
      **  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM       S01117
     C                     SETON                     U7U8LR               S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C**                                                                  S01117
      *                                                                   S01117
      ** AND GET ENTITY DETAILS FOR REPORT HEADINGS WHEN MULTIBRANCHING   S01117
     C           MBIN      IFEQ 'Y'                                       S01117
      *                                                                   S01117
     C**********           CALL 'AOBRCHR0'                                S01117              CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       S01117
     C                     PARM '*KEY   ' @OPTN   7                       S01117
     C                     PARM BRNCH     @CENB   3                       S01117
     C********** SDBRCH    PARM SDBRCH    DSFDY                           S01117              CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANKS                                   S01117
     C                     MOVEL@CENB     DBKEY                           S01117
     C                     MOVEL'SDBRCHPD'DBFILE           ***************S01117
     C                     Z-ADD009       DBASE            * DBERROR 009 *S01117
     C                     MOVEL@OPTN     DBOPTN  7        ***************S01117
     C                     SETON                     U7U8                 S01117
     C                     EXSR *PSSR                                     S01117
     C                     GOTO #ZZ9                                      S01117
     C                     END                                            S01117
      *                                                                   S01117
     C                     END                                            S01117
      *                                                                   S01117
     C                     END                             E1             S01117
      *                                                                   S01117
     C           #ZZ9      TAG                                            S01117
     C**                                                                  S01117
      ** OUTPUT 'NO DETAILS TO REPORT' IN P1                              S01117
     C                     EXCPT                                          S01117
     C**                                                                  S01117
     C*                                                                   S01117
0466 C                     ENDSR                                          S01117
     C*                                                                   S01117
     C********************************************************************S01117
     C*                                                                   S01117
     C* *PSSR  --- SUBROUTINE TO HANDLE ABNORMAL ERROR CONDITIONS         S01117
     C*                                                                   S01117
     C* CALLED FROM: AFTER ABNORNAL OPERATION OCCURS                      S01117
     C*                                                                   S01117
     C* CALLS: NOTHING                                                    S01117
     C*                                                                   S01117
     C********************************************************************S01117
     C*                                                                   S01117
     C           *PSSR     BEGSR                           ** *PSSR **    S01117
     C*                                                                   S01117
     C           @RUN      IFEQ *BLANKS                                   S01117
     C                     MOVE 'Y'       @RUN    1                       S01117
     C                     DUMP                                           S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C                     ENDSR                           ** *PSSR **    S01117
     C********************************************************************S01117
0676 C********************************************************************
0677 O*E0850P1H**203   OFNL1                                    S01124    S01117
0677 OLE0850P1H  203   OFNL1 70                                           S01117
0678 O*******OR**      L1                                                 S01117
0678 O       OR        L1 70                                              S01117
0679 O       OR        01 U7 U8
     O       AND       70                                                 S01117
0680 O***********                        22 'REFERENCE  LE0850'           S01117
0680 O*****                              24 'REFERENCE  LE0850AU'         S01117
     O                                   24 'REFERENCE  LE0850P1'         S01117
0681 O                         TITL      89
0682 O                                  104 'DATE'
0683 O                         RUNA     112
0684 O                                  122 'PAGE'
0685 O                         PAGE  Z  127
0686 O********H**1     OFNL1                                              S01117
0686 O        H  1     OFNL1 70                                           S01117
0687 O*******OR**      L1                                                 S01117
0687 O       OR        L1 70                                              S01117
0688 O       OR        01 U7 U8
     O       AND       70                                                 S01117
0689 O***********     N05NU7             11 'BRANCH'                      S01117
0690 O***********     N05NU7   BRCDA     16                               S01117
0691 O                                   64 'FACILITIES EXPIRING/'
0692 O                                   77 'REVIEW REPORT'
     O                 50                88 'BRANCH'                      S01117
     O                 50      BRCAX     92                               S01117
     O                 50                93 '-'                           S01117
     O                 50      BRNM     123                               S01117
0693 O********H**1     OFNL1                                              S01117
0693 O        H  1     OFNL1 70                                           S01117
0694 O*******OR**      L1                                                 S01117
0694 O       OR        L1 70                                              S01117
0695 O       OR        01 U7 U8
     O       AND       70                                                 S01117
0696 O                                   64 '--------------------'
0697 O                                   77 '-------------'
0698 O        H  2     OFNL1N05
     O       AND       70                                                 S01117
0699 O*******OR**      L1                                                 S01117
0699 O       OR        L1 70                                              S01117
0700 O                                   11 'A/C OFFICER'
0701 O                NU7NU8   ACON      44
0702 O        H  1     OFNL1N05
     O*******AND*      70                                          S01117 CLE004
     O       AND       70N60                                              CLE004
0703 O*******OR**      L1 70                                       S01117 CLE004
0703 O       OR        L1 70N60                                           CLE004
0704 O                                    7 'REVIEW/'
0705 O                                   67 'CMMT/'
     O                                   96 'SEC'                         S01270
     O                                  100 'REV'                         S01270
     O                                  107 'MULTI'                       S01117
     O                 50               114 'MULTI'                       S01117
0706 O        H  2     OFNL1N05
     O*******AND*      70                                          S01117 CLE004
     O       AND       70N60                                              CLE004
0707 O*******OR**      L1 70                                       S01117 CLE004
0707 O       OR        L1 70N60                                           CLE004
0708 O**********                         18 'EXPIRES   APPROVED'                              201127
     O/COPY WNCPYSRC,LEH00102
     O                                   18 'EXPIRES     START '                              201127
0709 O                                   34 'CUSTOMER  NAME'
0710 O                                   55 'TOWN'
0711 O                                   73 'FCLT NO CCY'
     O/COPY WNCPYSRC,LEH00103
0712 O                                   88 'AMOUNT'
     O                                   96 'IND'                         S01270
     O                                   99 'CR'                          S01270
0713 O*****                             112 'SECURED  MULTI-CCY'          S01117
0713 O**********                        106 'SECURED  CCY'          S01117S01270
0713 O                                  106 'CCY'                         S01270
     O                 50               115 'BRANCH'                      S01117
     O        H  1     OFNL1N05                                           CLE004
     O       AND       70 60                                              CLE004
     O       OR        L1 70 60                                           CLE004
     O                                    7 'REVIEW/'                     CLE004
     O                                   65 'CMMT/'                       CLE004
     O                                   94 'SEC'                         CLE004
     O                                   98 'REV'                         CLE004
     O                                  104 'MULTI'                       CLE004
     O                 50               110 'MULTI'                       CLE004
     O        H  2     OFNL1N05                                           CLE004
     O       AND       70 60                                              CLE004
     O       OR        L1 70 60                                           CLE004
     O**********                         18 'EXPIRES   APPROVED'                       CLE004 201127
     O/COPY WNCPYSRC,LEH00104
     O                                   18 'EXPIRES     START '                              201127
     O                                   34 'CUSTOMER  NAME'              CLE004
     O                                   54 'TOWN'                        CLE004
     O                                   71 'FCLT NO CCY'                 CLE004
     O/COPY WNCPYSRC,LEH00105
     O                                   86 'AMOUNT'                      CLE004
     O                                   94 'IND'                         CLE004
     O                                   98 'CR'                          CLE004
     O                                  103 'CCY'                         CLE004
     O                 50               111 'BRANCH'                      CLE004
     O                 60               115 'PRT'                         CLE004
0714 O        D  2     16N05NU7
     O*******AND*      70                                          S01117 CLE004
     O       AND       70N60                                              CLE004
     O/COPY WNCPYSRC,LEH00098
0715 O                         DTEXO     08
0716 O                         DTAPO     18
0717 O                         CNUM      27
0718 O                         CRNM      49
0719 O                         CTWN      60
0720 O                         FACT      65
0721 O                                   66 '/'
0722 O                         FCNO      68
     O/COPY WNCPYSRC,LEH00099
0723 O                         FCCY      73
0724 O***********      30      FAMT      92 ' ,   ,   ,   , 0 '           171784
0725 O***********      31      FAMT      92 '   ,   ,   , 0 . '           171784
0726 O***********      32      FAMT      92 '  ,   ,   , 0 .  '           171784
0727 O***********      33      FAMT      92 ' ,   ,   , 0 .   '           171784
0724 O                 30      FAMT      92 ' ,   ,   ,   , 0 -'          171784
0725 O                 31      FAMT      92 '   ,   ,   , 0 . -'          171784
0726 O                 32      FAMT      92 '  ,   ,   , 0 .  -'          171784
0727 O                 33      FAMT      92 ' ,   ,   , 0 .   -'          171784
0728 O**********               SECI      98                               S01270
0728 O                         SECI      95                               S01270
     O                         RVCR      99                               S01270
0729 O*****                    MCCY     107                               S01117
0729 O                         MCCY     105                               S01117
     O                 50      MBFC     111                               S01117
     O/COPY WNCPYSRC,LE0850O003
0730 O                 02               121 'EXPIRED'
0731 O**********       03               127 'DUE TO EXPIRE'               S01270
0731 O                 03N06N07         127 'DUE TO EXPIRE'               S01270
0732 O                 04               130 'DUE FOR REVIEWAL'
     O/COPY WNCPYSRC,LE0850O004
     O                 06               130 'TO DROP MONTHEND'            S01270
     O                 07               122 'TO DROP '                    S01270
     O                 07      DRPDT    130                               S01270
     O        D  2     16N05NU7                                           CLE004
     O       AND       70 60                                              CLE004
     O/COPY WNCPYSRC,LEH00100
     O                         DTEXO     08                               CLE004
     O                         DTAPO     18                               CLE004
     O                         CNUM      27                               CLE004
     O                         CRNM      49                               CLE004
     O                         CTWN      59                               CLE004
     O                         FACT      63                               CLE004
     O                                   64 '/'                           CLE004
     O                         FCNO      66                               CLE004
     O/COPY WNCPYSRC,LEH00101
     O                         FCCY      71                               CLE004
     O***********      30      FAMT      90 ' ,   ,   ,   , 0 '    CLE004 171784
     O***********      31      FAMT      90 '   ,   ,   , 0 . '    CLE004 171784
     O***********      32      FAMT      90 '  ,   ,   , 0 .  '    CLE004 171784
     O***********      33      FAMT      90 ' ,   ,   , 0 .   '    CLE004 171784
     O                 30      FAMT      90 ' ,   ,   ,   , 0 -'          171784
     O                 31      FAMT      90 '   ,   ,   , 0 . -'          171784
     O                 32      FAMT      90 '  ,   ,   , 0 .  -'          171784
     O                 33      FAMT      90 ' ,   ,   , 0 .   -'          171784
     O                         SECI      93                               CLE004
     O                         RVCR      97                               CLE004
     O                         MCCY     102                               CLE004
     O                 50      MBFC     107                               CLE004
     O                         PRTR     114                               CLE004
     O/COPY WNCPYSRC,LE0850O001
     O                 02               123 'EXPIRED'                     CLE004
     O                 03N06N07         129 'DUE TO EXPIRE'               CLE004
     O                 04               132 'DUE FOR REVIEWAL'            CLE004
     O/COPY WNCPYSRC,LE0850O002
     O                 06               132 'TO DROP MONTHEND'            CLE004
     O                 07               124 'TO DROP '                    CLE004
     O                 07      DRPDT    132                               CLE004
0733 O*
0734 O********E*3      16 05                                              S01117
0735 O***********                        76 '*** END OF REPORT ***'       S01117
0736 O***********                                                         S01117
0737 O********EF*321   39                                                 S01117
0738 O***********                        72 '* NO DETAILS TO REPORT *'    S01117
0739 O*
0740 O*
0741 O        T 33     U7 U8 LR
     O       AND       70                                                 S01117
0742 O                                   10 ' '
0743 O        T 32     U7 U8 LR
     O       AND       70                                                 S01117
0744 O                                   51 '*** REFERENCE LE0850'
0745 O***********                        71 'DATABASE ERROR AT'           S01117
0745 O                                   71 'DATABASE ERROR'              S01117
0746 O***********              DBASE     74                               S01117
0747 O********T**      U7 U8 LR                                           S01117
0748 O***********                        37 'FILENAME'                    S01117
0749 O***********              DBFILE    43                               S01117
0750 O***********                        48 'KEY'                         S01117
0751 O***********              DBKEY     78                               S01117
0752 O********T**203   LR                                                 S01117
0743 O        T 32     L2 70 50                                           S01117
     O                                   66 '*** END OF REPORT FOR'       S01117
     O                                   74 ' BRANCH '                    S01117
     O                         BRCAX     77                               S01117
     O                                   81 ' ***'                        S01117
     O        T 32     LRN50 75                                           S01117
     O                                   76 '*** END OF REPORT ***'       S01117
     OLE0850P1E   10                                                      S01117
     O                                   24 'REFERENCE LE0850P1'          S01117
0681 O                         TITL      89                               S01117
0682 O                                  104 'DATE'                        S01117
0683 O                         RUNA     112                               S01117
0684 O                                  122 'PAGE'                        S01117
0685 O                         PAGE  Z  127                               S01117
     O        E   13                                                      S01117
0691 O                                   64 'FACILITIES EXPIRING/'        S01117
0692 O                                   77 'REVIEW REPORT'               S01117
     O                 50                88 'BRANCH'                      S01117
     O                 50      BRCA      92                               S01117
     O                 50      BRNM     123                               S01117
     O        E   14                                                      S01117
0696 O                                   64 '--------------------'        S01117
0697 O                                   77 '-------------'               S01117
     O        E   19                                                      S01117
     O                                   76 '*** NO DETAILS TO REPORT'    S01117
     O                                   80 '***'                         S01117
     O        E   25   50                                                 S01117
     O                                   66 '*** END OF REPORT FOR'       S01117
     O                                   74 ' BRANCH '                    S01117
     O                         BRNCH     77                               S01117
     O                                   81 ' ***'                        S01117
     O        E   25  N50                                                 S01117
     O                                   76 '*** END OF REPORT ***'       S01117
0752 OLE0850AUT  203   LR                                                 S01117
0753 O***********                        22 'REFERENCE  LE0850'           S01117
0753 O                                   24 'REFERENCE  LE0850AU'         S01117
0754 O                         TITL      89
0755 O                                  104 'DATE'
0756 O                         RUNA     112
0757 O                                  122 'PAGE'
0758 O***********              PAGE  Z  127                               S01117
0758 O                         PAGE1 Z  127                               S01117
0759 O        T  1     LR
0760 O***********                        60 'FACILITIES EXPIRING/'        S01117
0761 O***********                        84 'REVIEW  -  FILE CONTROLS'    S01117
0760 O                                   67 'FACILITIES EXPIRING/'        S01117
0761 O                                   73 'REVIEW'                      S01117
     O                                   95 'RUN CONTROL'                 S01117
0762 O********T**   15 LR                                                 S01117
0762 O        T        LR                                                 S01117
0763 O***********                        60 '--------------------'        S01117
0764 O***********                        84 '------------------------'    S01117
0763 O                                   67 '--------------------'        S01117
0764 O                                   73 '------'                      S01117
0765 O        T  1     LR
0766 O                                   28 'S/SEXPD - RUN CONTROLS'
0767 O                                   59 'NUMBER'
0768 O***********                        84 'VALUE'                       S01117
0768 O                N86                84 'VALUE'                       S01117
0769 O        T  2     LR
0770 O                                   28 '----------------------'
0771 O                                   59 'OF RECORDS'
0772 O***********                        84 'OF RECORDS'                  S01117
0772 O                N86                84 'OF RECORDS'                  S01117
0773 O********T**2     LR                                                 S01117
0773 O        T  2     LRN86                                              S01117
0774 O                                   29 'TOTAL RECORDS ON FILE'
0775 O                   NU7   NORE  3   59
0776 O                   NU7   VLRF  4   81
0777 O                   NU7   VLRL      84
0778 O        T  3     LR                                                 S01117
0779 O                                   29 'TOTAL RECORDS ON FILE'
0780 O                                   42 '- CALCULATED'
0781 O                         NORR  3   59
0782 O***********              ZZTOTI4   81                               S01117
0783 O***********              ZZTOTD    84                               S01117
0782 O                N86      ZZTOTI4   81                               S01117
0783 O                N86      ZZTOTD    84                               S01117
0784 O                 U8NU7            111 '***   DIFFERENCE   ***'
0741 O        T 33     U7 U8 LR                                           S01117
0742 O                                   10 ' '                           S01117
0743 O        T 32     U7 U8 LR                                           S01117
0744 O                                   51 '*** REFERENCE LE0850'        S01117
0745 O                                   71 'DATABASE ERROR AT'           S01117
0746 O                         DBASE     76                               S01117
0747 O        T        U7 U8 LR                                           S01117
0748 O                                   37 'FILENAME'                    S01117
0749 O                         DBFILE    47                               S01117
0750 O                                   53 'KEY'                         S01117
0751 O                         DBKEY     86                               S01117
0762 O        T  2     LRN75                                              S01117
     O                                   76 '*** NO DETAILS TO REPORT'    S01117
     O                                   80 '***'                         S01117
0785 O********T*3            LR                                           S01117
0786 O***********                        76 '*** END OF REPORT ***'       S01117
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
** CPY@   **      OBJECT COPYRIGHT
(c) Misys International Banking Systems Ltd. 2001
