0001 H        1                                                           S01117
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas LE Average Use of Lines Report')                 *
0002 F********************************************************************
0004 F*                                                                  *
     F*  Midas Customer Lending Module
0004 F*                                                                  *
0005 F*****LE0870 - PRINT AVERAGE USE OF LINES REPORT                    *S01117
0005 F*    LE0870 - PRINT AVERAGE USE OF LINES REPORT - BY BRANCH        *S01117
0006 F*                                                                  *
      *  (c) Finastra International Limited 2001                      *
     F*                                                                  *
      *  Last Amend No. MD050457           Date 06Mar19               *
      *  Prev Amend No. MD046248           Date 27Oct17               *
      *                 AR997263           Date 21Dec12               *
      *                 CLE064             Date 06Dec10               *
      *                 CER059             Date 19Jul10               *
      *                 BUG23624           Date 30Mar09               *
      *                 CER043             Date 19May08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 235358             Date 06Jun06               *
      *                 CSD031             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 CLE042             Date 06Sep05               *
      *                 CSW037A            Date 02May05               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 CLE025             Date 20Oct03               *
      *                 CGL029             Date 01Sep03               *
      *                 193603             Date 31Aug01               *
      * Midas Release 4.01 -------------------------------------------*
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 S01392             Date 05Oct92               *
      *                 S01270             Date 22Mar91               *
     F*                   BHF117             DATE 11JUN90                *
0009 F*                   S01194             DATE 17JAN90                *
0009 F*                   S01117             DATE 26/07/89               *
0009 F*                   E86101             DATE 21/04/86               *
0006 F*                                                                  *
     F********************************************************************
     F*                                                                  *
      *  MD050457 - Do not process DBERR when received *CUSCLS from   *
      *             AOCUSTR0. Patterned fix from 261272 and 263371.   *
      *  MD046248 - Finastra Rebranding                               *
      *  AR997263 - Also do not process DBERR when received *CUSCLS   *
      *             from AOCUSTR0.(Child:  AR997265)                  *
      *  CLE064 - Enhancement of Lending Frequencies (Recompile)      *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  BUG23624 - No value being defaulted in new fields:Previous   *
      *             Exp Date and Penultimate Exp Date (Recompile)     *
      *  CER043 - German Features LF041-00 New Fields and Defaulting  *
      *           (Recompile)                                         *
      *  235358 - High order truncation causes file controls out of    *
      *           balance. Amend processing to truncate program        *
      *           value and compare if initial compare fails.          *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CLE042 - Extended Loan Sub Type (Recompile)                  *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  CLE025 - Credit Lines (Recompile)                            *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  193603 - Take negative facility amounts into consideration   *
     F*    S01392 - JAPANESE SUB MODULE ENHANCEMENTS                     *S01392
     F*    S01270 - CUSTOMER LENDING CHANGES                             *S01270
     F*    BHF117 - DATABASE ERROR WHEN END OF SDCURRPD INSTEAD OF       *BHF117
     F*           - EMPTY FILE & P1 SHOULD BE OPEN IF A DATABASE ERROR   *BHF117
     F*    S01194 - STANDING DATA CHANGES                                *S01194
0006 F*    S01117 - MULTIBRANCHING                                       *
0006 F*                                                                  *
0011 F********************************************************************
0014 F*
     F*  C R E A T I O N     P A R A M E T E R S                      *
     F*                                                               *
     F*                                                               *
0011 F********************************************************************
0014 F*
0015 FSORTA   IP  F     256 14AI     2 DISK
0016 F*TABLE***IF**F      96 12AI     2 DISK                              S01194
0017 F*CLINT***IF**F     256  7AI     2 DISK                              S01194
     FSDCURRPDIF  E                    DISK                               S01194
0018 F*E0870P1O** F     132     OF     PRINTER                  S01124    S01117
0018 FLE0870P1O   F     132     OF     PRINTER      KINFDS SPOOL      UC  S01117
0018 F*E0870AUO** F     132     OA     PRINTER                            S01117
0018 FLE0870AUO   F     132     OA     PRINTER      KINFDS SPOOLU         S01117
0019 F*
0020 F* ID F  C  H  L    FUNCTION OF INDICATORS
0021 F* 01            SORTED FCLTY - HEADER
0022 F* 02                         - DETAIL RECORD
0023 F* 03                         - TRAILER
0024 F**04**********  TABLE FILE - ICD1                                   S01194
0025 F**05**********             - ICD2                                   S01194
0026 F**06**********             - CCY1                                   S01194
0027 F**07**********  CLINT FILE - RECORD A                               S01194
0028 F**
0029 F*   08          BASE CCY BLANK
0030 F*   09          FCLTY CCY BLANK
0031 F**
0032 F*      10       FIRST CYCLE
0033 F*      11       AT LEAST ONE DETAIL RECORD READ
     F*      13       MULTIBRANCH OUTPUT INDICATOR                        S01117
0034 F*      21       MONTH FOUND IN ARRAY
0035 F*      22       FIRST QUARTER
0036 F*      23       SECOND QUARTER
0037 F*      24       THIRD QUARTER
0038 F*      25       FOURTH QUARTER
0039 F*      30       WORK IND.- SET UP CCY ARRAYS
0040 F*      31       BASE CCY FOUND IN ARRAY
0041 F*      32       FCCY SAME AS PREVIOUS CYCLE
0042 F*      33       FCCY FOUND IN ARRAY
0043 F*      34       MULT/DIV INDICATOR  = DIVIDE
0044 F*      35       FCCY = BCCY
0045 F*      36       WORK IND. - USE START DATE OF FACILITY
0046 F*      37       PREVENT DIVIDE BY ZERO OR NEGATIVE
0047 F**
0048 F*******40*****  END OF TABLE FILE FOR READ OPERATIONS               S01194
0049 F*******42*****  CHAIN TO CLINT FAILED                               S01194
0050 F**
0051 F*      43       FILE CONTROLS BALANCE
     F*                                                                   S01117
     F*      50       MULTI-BRANCHING = 'NO'                              S01117
     F*                                                                   S01117
     F*      70       INDICATOR FOR  MULTI-BRANCHING OUTPUT               S01117
     F*      75       NO DETAILS RECORDS IN INPUT FILE IF MBIN = 'Y'      S01117
     F*      76       NO DETAILS RECORDS IN INPUT FILE IF MBIN = 'N'      S01117
     F*      78       MBIN = 'Y' AND INPUT FILE HAS DETAIL RECORDS,       S01117
     F*               BUT NO RECORDS THAT MATCH THE REQUIRED BRANCH       S01117
     F*                                                                   S01117
0052 F*      80       O DEC.PL.-BASE CCY
0053 F*      81       1 DEC.PL.-BASE CCY
0054 F*      82       2 DEC.PL.-BASE CCY
0055 F*      83       3 DEC.PL.-BASE CCY
     F*      85       MULTI-BRANCH = 'Y' AND BRNCH = ONE BRANCH NAME
     F*      86       SUPPRESS THE CONTROL TOTAL FOR AU REPORT            S01117
     F*      87       MULTI-BRANCH = 'Y' AND BRNCH = 'ALL'                S01117
0056 F**
0057 F*         U7+U8 DATABASE ERROR
0058 F*            U8 FILE CONTROLS OUT OF BALANCE
0059 F**
0060 F*            L1 CHANGE OF CUSTOMER NUMBER
0061 F*            L2 CHANGE OF BRANCH
0062 F/SPACE 2
0063 F**     COUNT FIELDS USED FOR ARRAYS
0064 F**
0065 F*      Y - USED TO LOAD CCY ARRAY
0066 F*      B - ARRAY ELEMENT FOR BASE CCY
0067 F*      Z - ARRAY ELEMENT FOR FCLTY CCY
0068 F*      X - ARRAY ELEMENT FOR POWER FOR CONV.RATE CALCS
0069 F*      M - ARRAY ELEMENT FOR MONTH
0070 E*
0071 E                    ACY       150  3               CURRENCY CODES
0072 E                    ADP       150  1 0             CCY DEC PLACES
0073 E                    ASR       150 13 8             CCY SPOT RATES
0074 E**************      AMD       150  1 0             CCY MULT/DIV INDSS01194
0074 E                    AMD       150  1               CCY MULT/DIV INDSS01194
0075 E*
0076 E                    POWER   1   7  7 3             FOR CCY CONVERS.
0077 E*
     E/COPY ZSRSRC,ZDATE2Z1                                               S01392
     E                    CSTS    1   1 20                                                  MD050457
     E                    CPY@    1   1 80
0081 E**
0082 I*
0083 I* SORTED FACILITY FILE - HEADER
0084 I*
0085 ISORTA   NS  01   1 CH
0086 I                                        1   1 RECI
0087 I*
0088 I* SORTED FACILITY FILE - 'A' RECORDS
0089 I*
0090 ISORTA   NS  02   1 CD  13 CA
0091 I       OR        1 CE  13 CA
0092 I                                        1   1 RECI
0093 I**********                              2   70CNUM  L1                                  CSD027
0093 I                                        2   7 CNUM  L1                                  CSD027
0094 I                                        8  100FACT
0095 I                                       11  120FCNO
0096 I                                       13  13 RCTP
0097 I***********                            14  160BRCD  L2              S01117
0097 I                                       14  16 BRCA  L2              S01117
0098 I                                       17  17 FCTI
0099 I                                       18  20 FCCY            09
0100 I                                    P  21  270FAMT
0101 I                                    P  28  303OVPC
0102 I                                    P  31  330DTAP
0103 I                                    P  34  360DTEX
0104 I                                       37  37 RVCR
0105 I                                       38  38 SECI
0106 I                                       39  39 MCCY
0107 I                                       40  40 MCSI
0108 I                                       41  41 NACD
0109 I                                       42  43 CRSK
0110 I                                    P  44  460DLFS
0111 I                                    P  47  527NOMR
0112 I                                    P  53  550RVDT
0113 I                                       56  56 RVFR
0114 I                                       57  580RVDY
0115 I                                       59  93 NAR1
0116 I                                       94 128 NAR2
0117 I                                      129 163 NAR3
0118 I                                      164 198 NAR4
0119 I                                    P 199 2050MTDH
0120 I                                    P 206 2120MTDL
0121 I                                    P 213 2190MTDA
0122 I                                    P 220 2270QTDA
0123 I                                    P 228 2350YTDA
0124 I                                      236 237 ACOF
     I                                    P 242 2440RVCD                  S01270
0125 I                                    P 247 2490ORED
0126 I                                    P 250 2520LCD
0127 I                                      253 253 CHTP
0128 I                                    P 254 2560TNLU
0129 I* COMBINED FIELD FOR FACILITY TYPE AND NUMBER                  LE087
0130 I                                        8  120FCTN
0131 I*
0132 I* SORTED FACILITY FILE - TRAILER (FIELDS REFER TO FCLTY FILE)
0133 I*
0134 I        NS  03   1 CT
0135 I                                        1   1 RECI
0136 I                                    P  17  190NORE
0137 I                                    P  20  220FLSZ
0138 I                                    P  23  250NLRB
0139 I                                    P  26  280NINS
0140 I                                    P  29  310NDEL
0141 I                                    P  32  340NLRA
0142 I                                    P  35  420VLBF
0143 I                                    P  43  440VLBL
0144 I                                    P  45  520VRIF
0145 I                                    P  53  540VRIL
0146 I                                    P  55  620VRDF
0147 I                                    P  63  640VRDL
0148 I                                    P  65  720VRAF
0149 I                                    P  73  740VRAL
0150 I                                    P  75  820VLAF
0151 I                                    P  83  840VLAL
0152 I                                    P 250 2520LCD
0153 I                                      253 253 CHTP
0154 I                                    P 254 2560TNLU
0155 I*
0156 I* SORTED FACILITY FILE - CATCHALL
0157 I*
0158 I        NS
0159 I                                        1   1 RECI
0160 I**************                                                      S01194
0161 I**TABLE*FILE*- INSTALLATION CONTROL DATA RECORD 1.                  S01194
0162 I**************                                                      S01194
0163 I*TABLE***NS**04   1 CD   2 C0   3 C1                                S01194
0164 I*******AND****  12 C1  13 C0                                        S01194
0165 I**************                          1   1 RECI                  S01194
0166 I**************                          2   30RECT                  S01194
0167 I**************                         12  130RCDE                  S01194
0168 I**************                         14  66 TITL                  S01194
0169 I**************                         67  67 DATF                  S01194
0170 I***********                            68  700DFBR                  S01194
0171 I**************                         74  74 MODI1                 S01194
0172 I**************                         75  75 MODI2                 S01194
0173 I**************                         76  76 MODI3                 S01194
0174 I**************                      P  77  790RUND                  S01194
0175 I**************                         80  86 RUNA                  S01194
0176 I**************                         87  870SFLG                  S01194
0177 I**************                      P  90  920LCD                   S01194
0178 I**************                         93  93 CHTP                  S01194
0179 I**************                      P  94  960TNLU                  S01194
0180 I**************                                                      S01194
0181 I**TABLE*FILE*- INSTALLATION CONTROL DATA RECORD 2                   S01194
0182 I**************                                                      S01194
0183 I********NS**05   1 CD   2 C0   3 C1                                 S01194
0184 I*******AND****  12 C1  13 C1                                        S01194
0185 I**************                          1   1 RECI                  S01194
0186 I**************                          2   30RECT                  S01194
0187 I**************                         12  130RCDE                  S01194
0188 I**************                         14  16 BCCY            08    S01194
0189 I**************                         17  19 BCYL                  S01194
0190 I**************                         20  22 HOCY                  S01194
0191 I**************                         23  280HEAD                  S01194
0192 I**************                      P  29  310APDA                  S01194
0193 I**************                         35  35 APFQ                  S01194
0194 I**************                      P  36  380LOGS                  S01194
0195 I**************                         39  40 CUZR                  S01194
0196 I**************                      P  41  430DNWD                  S01194
0197 I**************                         44  460BVLP                  S01194
0198 I**************                         47  49 LOCY                  S01194
0199 I**************                         50  510FDAY                  S01194
0200 I**************                         86  86 ISAV                  S01194
0201 I**************                      P  87  890LLOG                  S01194
0202 I**************                                                      S01194
0203 I**TABLE*FILE*- CURRENCY RECORD 1                                    S01194
0204 I**************                                                      S01194
0205 I********NS**06   2 C2   3 C0                                        S01194
0206 I**************                          1   1 RECI                  S01194
0207 I**************                          2   30RECT                  S01194
0208 I**************                         10  12 CCY                   S01194
0209 I**************                         13  130SREC                  S01194
0210 I**************                         14  27 CCNM                  S01194
0211 I**************                      P  28  348SPOT                  S01194
0212 I**************                         35  37 CCYS                  S01194
0213 I**************                         38  380CDP                   S01194
0214 I**************                         39  390TNOT                  S01194
0215 I**************                         40  40 DCCY                  S01194
0216 I**************                         41  44 SRC1                  S01194
0217 I**************                         45  48 SRC2                  S01194
0218 I**************                         49  520TACC                  S01194
0219 I**************                         53  560TEQV                  S01194
0220 I**************                         57  600SWQV                  S01194
0221 I**************                         61  640TAC4                  S01194
0222 I**************                         65  680TAC5                  S01194
0223 I**************                         69  69 HIND                  S01194
0224 I**************                      P  70  768PART                  S01194
0225 I**************                         77  780SSNO                  S01194
0226 I**************                      P  79  858ERLC                  S01194
0227 I**************                         86  860MDIN                  S01194
0228 I**************                         87  870MDIA                  S01194
0229 I**************                         88  880MDIB                  S01194
0230 I**************                         93  93 CHTP                  S01194
0231 I**************                      P  94  960TNLU                  S01194
0232 I**************                                                      S01194
0233 I**TABLE*FILE*- CATCHALL                                             S01194
0234 I**************                                                      S01194
0235 I********NS****                                                      S01194
0236 I**************                          1   1 RECI                  S01194
0237 I**************                                                      S01194
0238 I****CLIENT*FILE - CUSTOMER STANDING DATA RECORD                     S01194
0239 I**************                                                      S01194
0240 I*CLINT***NS**07   1 CD   8 CA                                       S01194
0241 I**************                          1   1 RECI                  S01194
0242 I**************                          2   70CNUM                  S01194
0243 I**************                          8   8 RCDT                  S01194
0244 I**************                          9  28 CRNM                  S01194
0245 I**************                         29  38 CTWN                  S01194
0246 I**************                         39  48 CSNM                  S01194
0247 I**************                         49  56 CASK                  S01194
0248 I**************                         57  68 TELX                  S01194
0249 I**************                         69  80 CSID                  S01194
0250 I**************                         81  82 ACOC                  S01194
0251 I**************                         83  83 CBSI                  S01194
0252 I**************                         84  85 CCTZ                  S01194
0253 I**************                         86  87 CLOC                  S01194
0254 I**************                         88  930CPAR                  S01194
0255 I**USE*BRCD*FROM PRIMARY FILE                                        S01194
0256 I**************                         94  960BRCD                  S01194
0257 I**************                         97  980LINS                  S01194
0258 I**************                         99 1010LIND                  S01194
0259 I**************                      P 102 1040DASU                  S01194
0260 I**************                      P 105 1070CDIC                  S01194
0261 I**************                      P 108 1100DADE                  S01194
0262 I**************                        111 111 CMIN                  S01194
0263 I**************                        112 112 CTYP                  S01194
0264 I**************                        113 124 TELF                  S01194
0265 I**************                        125 133 CHID                  S01194
0266 I**************                        134 136 CHAB                  S01194
0267 I**************                      P 250 2520LCD                   S01194
0268 I**************                        253 253 CHTP                  S01194
0269 I**************                      P 254 2560TNLU                  S01194
0270 I**************                                                      S01194
0271 I*****CLIENT*FILE - CATCHALL                                         S01194
0272 I**************                                                      S01194
0273 I********NS****                                                      S01194
0274 I**************                          1   1 RECI                  S01194
     I**                                                                  S01194
     ISDCURRD0                                                            S01194
      **  EXTERNAL FILE DESCRIPTION  FOR CURRENCY FILE                    S01194
     I              A6CYCD                          CCY                   S01194
     I              A6NBDP                          CDP                   S01194
     I              A6SPRT                          SPOT                  S01194
0275 I*
0276 I*    LOCAL DATA AREA FOR DATABASE ERROR REFERENCES
0277 I*
0213 ILDA        UDS                            256                       S01117
0214 I***********                           134 138 DBFILE                S01117
0215 I***********                           139 167 DBKEY                 S01117
0216 I***********                           168 175 DBPGM                 S01117
0217 I***********                           176 177 DBASE                 S01117
0214 I                                      134 141 DBFILE                S01117
0215 I                                      142 170 DBKEY                 S01117
0216 I                                      171 180 DBPGM                 S01117
0217 I                                      181 1830DBASE                 S01117
     I*                                                                   S01117
     I*    FILE INFORMATION DATA STRUCTURE                                S01117
     I*                                                                   S01117
     ISPOOL       DS                                                      S01117
     I                                       83  92 SFILE                 S01117
     I                                    B 123 1240SFNUM                 S01117
     ISPOOLU      DS                                                      S01117
     I                                       83  92 SFILEU                S01117
     I                                    B 123 1240SFNUMU                S01117
     I**                                                                  S01194
     ISDBANK    E DSSDBANKPD                                              S01194
      **  EXTERNAL DS FOR BANK DETAILS                                    S01194
     I              BJCYCD                          BCCY                  S01194
     I              BJDNWD                          DNWD                  S01194
     I              BJURPT                          TITL                  S01194
     I**                                                                  S01194
     ISDBRCH    E DSSDBRCHPD                                              S01117
      **  EXTERNAL DS FOR BRANCH CODE DETAILS                             S01117
     I              A8BRNM                          BRNM                  S01117
     I**                                                                  S01194
     ISDCUST    E DSSDCUSTPD                                              S01194
      **  EXTERNAL DS FOR CUSTOMER DETAILS                                S01194
     I              QQDFAC                          DFAC01                                    CGL029
     I              BBCRNM                          CRNM                  S01194
     I**                                                                  S01194
     I**                                                                  S01194
     IDSFDY     E DSDSFDY                                                 S01194
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01194
     I*                                                                   S01194
     IDSSDY     E DSDSSDY                                                 S01194
     I* SECOND DS FOR ACCESS PROGRAMS, LONG DATA STRUCTURE                S01194
     I*                                                                   S01194
     IRUNDT       DS                                                      S01117
     I                                        1   7 RUNA                  S01117
     I                                    P   8  100RUND                  S01117
     I                                       11  11 SSF                   S01117
     I                                       12  12 DATF                  S01117
     I                                       13  13 MBIN                  S01117
0283 I/EJECT
     C                     MOVEACPY@      BIS@   80
0284 C********************************************************************
0285 C**
     C           *ENTRY    PLIST                                          S01117
     C                     PARM           SEQ     5                       S01117
     C                     PARM           BRNCH   3                       S01117
     C**                                                                  S01117
     C           *NAMVAR   DEFN           LDA                             S01117
     C           *LOCK     IN   LDA                                       S01117
     C*     IN THE DATAAREA RUNDAT                                        S01117
     C**                                                                  S01117
     C           *NAMVAR   DEFN RUNDAT    RUNDT                           S01117
     C                     IN   RUNDT                                     S01117
     C*                                                                   S01117
0286 C   10                GOTO ENDFC
0287 C                     SETON                     10
0289 C*
0290 C/SPACE 3
0291 C*
0292 C********************************************************************
0293 C******     FIRST CYCLE/HEADER PROCESSING       *********************
0294 C*
0295 C**N01******          GOTO ENDD                                      S01117
0295 C  N01                GOTO ENDFC                                     S01117
0296 C*
0297 C* COUNT HEADER READ
0298 C   01                Z-ADD1         NORI    50
0299 C*
0300 C* SET UP BLANK AND ZERO FIELDS
0301 C                     MOVE ' '       BLANKS 29
0302 C                     Z-ADD0         ZEROS  150
0303 C*
0304 C* SET UP DATABASE ERROR REFERENCE IN LDA
0305 C                     MOVE 'LE0870  'DBPGM
0306 C                     MOVE BLANKS    DBKEY
0307 C*
0308 C**READ*TABLE*FILE*-*ACCESS*ICD1*                                    S01194
0309 C**************       MOVEL'01    '  TABKEY 12                       S01194
0310 C**************       MOVE '    10'  TABKEY                          S01194
0311 C***********TABKEY    SETLLTABLE                                     S01194
0312 C**************       READ TABLE                    40 40=END OF FILES01194
     C**                                                                  S01194
     C**   ACCESS BANK DETAILS                                            S01194
     C**                                                                  S01194
     C                     CALL 'AOBANKR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDBANK    PARM SDBANK    DSFDY                           S01194
     C*                                                                   S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     SETON                     U7U8LR               S01194
     C                     SETON                     99    ***************S01194
     C                     MOVEL'SDBANKPD'DBFILE           * DBERROR 001 *S01194
     C                     Z-ADD1         DBASE            ***************S01194
     C                     END                                            S01194
0313 C*
0314 C* DATABASE ERROR IF LIVE RECORD NOT FOUND
0315 C**N04*********                                                      S01194
0316 C*OR*40********        SETON                     U7U8LR              S01194
0317 C***U7*U8******       MOVE 'TABLE'   DBFILE                          S01194
0318 C***U7*U8******       MOVELTABKEY    DBKEY                           S01194
0319 C***U7*U8******       Z-ADD01        DBASE             (**DBASE 01)  S01194
0320 C***U7*U8***          GOTO ENDD                                      S01117
0320 C   U7 U8             GOTO ENDC                                      S01117
0321 C*
0322 C**READ*AGAIN*- ACCESS ICD2 FOR BASE CCY                             S01194
0323 C**************       READ TABLE                    40 40=END OF FILES01194
0324 C**************                                                      S01194
0325 C**N05*********                                                      S01194
0326 C*OR*40********        SETON                     U7U8LR              S01194
0327 C***U7*U8******       MOVE 'TABLE'   DBFILE                          S01194
0328 C***U7*U8******       MOVELTABKEY    DBKEY                           S01194
0329 C***U7*U8******       Z-ADD02        DBASE             (**DBASE 02)  S01194
0330 C***U7*U8***          GOTO ENDD                                      S01117
0331 C*
0332 C* ACCESS CCY RECORDS AND LOAD ARRAYS
0333 C**************       MOVE BLANKS    TABKEY                          S01194
0334 C**************       MOVEL'20'      TABKEY                          S01194
0335 C***********TABKEY    SETLLTABLE                                     S01194
0336 C                     Z-ADD0         Y       30
0337 C*
0338 C           CCYLOP    TAG                             **CCYLOP TAG**
0339 C                     SETOF                     3040                 S01194
0339 C***********          SETOF                     063040               S01194
0340 C***********          READ TABLE                    40 40=END OF FILES01194
     C                     READ SDCURRD0                 40               S01194
     C   40                GOTO CCYEND                                    S01194
0341 C**N06******                                                         S01194
0342 C*OR*40*****           GOTO CCYEND                                   S01194
0343 C***********RECI      COMP 'D'                      30               S01194
0344 C**N30******          GOTO CCYLOP                                    S01194
0345 C***********SREC      COMP 1                        30               S01194
0346 C**N30******          GOTO CCYLOP                                    S01194
0347 C           Y         ADD  1         Y
0348 C                     MOVE CCY       ACY,Y
0349 C                     Z-ADDCDP       ADP,Y
0350 C                     Z-ADDSPOT      ASR,Y
0351 C**************       Z-ADDMDIN      AMD,Y                           S01194
     C                     MOVE A6MDIN    AMD,Y                           S01194
0352 C           Y         COMP 150                    30
0353 C   30                GOTO CCYLOP
0354 C*
0355 C           CCYEND    TAG                             **CCYEND TAG**
0356 C*
0357 C* IF END OF FILE, DATABASE ERROR
0358 C***40******          SETON                     U7U8LR               BHF117
     C           Y         IFEQ 0                                         BHF117
0358 C                     SETON                     U7U8LR               BHF117
     C                     END                                            BHF117
0359 C***U7*U8******       MOVE 'TABLE'   DBFILE                          S01194
0359 C   U7 U8             MOVE 'SDCURRPD'DBFILE                          S01194
0360 C***U7*U8******       MOVELTABKEY    DBKEY                           S01194
0361 C   U7 U8             Z-ADD03        DBASE             (**DBASE 03)
0362 C***U7*U8***          GOTO ENDD                                      S01117
0362 C   U7 U8             GOTO ENDC                                      S01117
0363 C*
0364 C* LOOK UP ARRAYS FOR BASE CCY DEC PLACES
0365 C* IF BLANK OR INVALID, DATABASE ERROR
     C           BCCY      IFEQ *BLANKS                                   S01194
     C                     SETON                     08                   S01194
     C                     END                                            S01194
0366 C   08                GOTO DBASE4
0367 C*
0368 C                     SETOF                     808182
0369 C                     SETOF                     8331
0370 C                     Z-ADD1         B       30
0371 C           BCCY      LOKUPACY,B                    31
0372 C*
0373 C   31      ADP,B     COMP 1                      8081
0374 C   31N80N81ADP,B     COMP 3                      8283
0375 C*
0376 C           DBASE4    TAG                             ** DBASE4 TAG**
0377 C   08
0378 CORN31                SETON                     U7U8LR
0379 C***U7*U8******       MOVE 'TABLE'   DBFILE                          S01194
0380 C***U7*U8******       MOVELBCCY      TBKEY1  4                       S01194
0381 C***U7*U8******       MOVE '1'       TBKEY1                          S01194
0382 C***U7*U8******       MOVEL'20      'TABKEY                          S01194
0383 C***U7*U8******       MOVE TBKEY1    TABKEY                          S01194
0384 C***U7*U8******       MOVELTABKEY    DBKEY                           S01194
0379 C   U7 U8             MOVE 'SDCURRPD'DBFILE                          S01194
0380 C   U7 U8             MOVELBCCY      DBKEY                           S01194
0385 C   U7 U8             Z-ADD04        DBASE             (**DBASE 04)
0386 C**                                                                  E86101
0386 C* FIND CURRENT MONTH                                                E86101
0386 C**                                                                  E86101
0369 C                     MOVE RUNA      MOTDY   5                       E86101
0369 C                     MOVELMOTDY     MONTH   3                       E86101
0294 C**                                                                  S01117
     C*    SETON INDICATOR FOR NO PRINTING, IF MULTIBRANCHING = NO        S01117
     C**                                                                  S01117
     C           MBIN      IFNE 'Y'                                       S01117
     C                     SETON                     50                   S01117
     C                     OPEN LE0870P1                                  S01117
     C                     END                                            S01117
     C**                                                                  S01117
     C*     CHECK IF CONTROL TOTAL NEEDED OT BE SUPPRESSED                S01117
     C**                                                                  S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C           BRNCH     ANDNE'ALL'                                     S01117
     C                     SETON                     85                   S01117
     C                     END                                            S01117
     C**                                                                  S01117
     C*     CHECK IF MBIN = 'Y' AND BRNCH = 'ALL'                         S01117
     C**                                                                  S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C           BRNCH     ANDEQ'ALL'                                     S01117
     C                     SETON                     8786                 S01117
     C                     END                                            S01117
0386 C**                                                                  E86101
0386 C* FIND END DATE FOR PERIOD. IF MONTH END THEN USE LAST CALENDAR     E86101
0386 C* DAY AS END DATE.  OTHERWISE USE RUN DATE                          E86101
0386 C**                                                                  E86101
0369 C           DNWD      SUB  1         DPNWD   50                      E86101
0369 C           DPNWD     COMP RUND                     51               E86101
0369 C***51******          GOTO ENDD                                E86101S01117
0369 C   51                GOTO ENDC                                      S01117
0369 C           DOAGN     TAG                             ** DOAGN TAG **E86101
0369 C                     Z-ADDDPNWD     ZDAYNO                          E86101
0369 C                     EXSR ZDATE2                                    E86101
0369 C                     MOVE ZADATE    MOTDY                           E86101
0369 C                     MOVELMOTDY     DMOT    3                       E86101
0369 C           MONTH     COMP DMOT                 5151                 E86101
0369 C   51      DPNWD     SUB  1         DPNWD                           E86101
0369 C   51                GOTO DOAGN                                     E86101
0386 C*
0387 C* END FIRST CYCLE PROCESSING
0388 C*
0389 C***********          GOTO ENDD                                      S01117
0389 C                     GOTO ENDC                                      S01117
0390 C*
0391 C/SPACE 3
0404 C********************************************************************S01117
0405 C******     MAIN PROCESSING                     *********************S01117
0309 C**                                                                  S01117
0392 C*
0393 C           ENDFC     TAG                             ** ENDFC TAG **
0297 C*                                                                   S01117
0298 C*    DETERMINE SUB-ROUTINE FOR FURTHER PROCESSING                   S01117
0299 C*                                                                   S01117
0300 C   02                EXSR DETAIL                                    S01117
     C   50 76             SETON                     86                   S01117
     C**                                                                  S01117
     C*    IGNORE THE TRAIL PROCESSING IF CONTROL TOTAL IS NOT CHECK      S01117
     C**                                                                  S01117
     C   85                                                               S01117
     CORN75                                                               S01117
     CORN76                GOTO ENDC                                      S01117
0394 C*
0395 C*
0396 C*          FOR TRAILER SKIP MAIN PROCESSING
0397 C*
0398 C   03                EXSR TRAILR
0399 C***03******          GOTO ENDD                                      S01117
0399 C           ENDC      TAG                                            S01117
0400 C*
     C**                                                                  S01117
     C*     EXCUTE ERROR ROUTINE IF DATABASE ERROR EXISTS                 S01117
     C**                                                                  S01117
     CLR         *INU7     IFEQ '1'                                       S01117
     CLR         *INU8     ANDEQ'1'                                       S01117
     CLR                   EXSR *PSSR                                     S01117
     CLR                   END                                            S01117
     C**                                                                  S01117
     C*   ENSURE TOTALS SPOOL FILE RECORDED BY RCF                        S01117
     C**                                                                  S01117
     CLR                   Z-ADDSFNUMU    ZSNUMU  60                      S01117
     C**                                                                  S01117
     CLR                   OUT  LDA                                       S01117
     CLR                   CALL 'ZSFILE'                                  S01117
     CLR                   PARM           SEQ                             S01117
     CLR                   PARM *BLANKS   SENTY                           S01117
     CLR                   PARM           SFILEU                          S01117
     CLR                   PARM           ZSNUMU                          S01117
     CLR                   PARM           ZSERR   1                       S01117
     CLR         *LOCK     IN   LDA                                       S01117
      **  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM       S01117
     CLR         ZSERR     IFEQ 'Y'                                       S01117
     CLR                   SETON                     U7U8LR               S01117
     CLR                   RETRN                                          S01117
     CLR                   END                                            S01117
     C**                                                                  S01117
     C*     IF P1 FILE NT OPEN (BECAUSE NO RECORDS READ) THEN OPEN IT     S01117
     C**                                                                  S01117
     CLRN75                                                               S01117
     COR LRN78             EXSR #ZZ                                       S01117
0401 C*
0307 C*                                                                   S01117
0403 C********************************************************************S01117
0405 C**   CALLED BY : MAIN PROCESSING FOR DETAIL RECORD PROCESSIG     ***S01117
0309 C**                                                                  S01117
0311 C*                                                                   S01117
0312 C           DETAIL    BEGSR                           *** DETAIL *** S01117
0406 C*                                                                   S01117
0407 C*                                                                   S01117
0408 C* SET INDICATOR FOR AT LEAST ONE DETAIL RECORD READ                 S01117
     C                     SETON                     761370               S01117
     C                     SETON                     75                   S01117
     C**                                                                  S01117
     C*   IF MBIN = YES, AND A REQUIRED BRANCH AND A LEVEL BREAK,         S01117
     C*   OPEN LE0850P1                                                   S01117
     C**                                                                  S01117
     C           *INL2     IFEQ '1'                                       S01117
     C*                                                                   S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C           BRNCH     ANDEQ'ALL'                                     S01117
     C                     MOVE BRCA      BRNP    3                       S01117
     C                     END                                            S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C           BRNCH     ANDNE'ALL'                                     S01117
     C                     MOVE BRNCH     BRNP                            S01117
     C                     END                                            S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C**                                                                  S01117
     C*   GET BRANCH NAME, ONLY WHEN MBIN = YES                           S01117
     C**                                                                  S01117
     C**********           CALL 'AOBRCHR0'                                S01117              CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       S01117
     C                     PARM '*KEY   ' @OPTN   7                       S01117
     C                     PARM BRNP      @DSNB   3                       S01117
     C********** SDBRCH    PARM SDBRCH    DSFDY                           S01117              CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANKS                                   S01117
     C                     MOVEL@DSNB     DBKEY                           S01117
     C                     MOVEL'SDBRCHPD'DBFILE                          S01117
     C                     Z-ADD15        DBASE                           S01117
     C                     MOVEL@OPTN     DBOPTN  7        ***************S01117
*    C                     SETON                     U7U8LR* DBERROR 015 *S01117
     C                     EXSR *PSSR                      ***************S01117
     C                     GOTO ENDD                                      S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C           BRNCH     ANDEQ'ALL'                                     S01117
     C           MBIN      OREQ 'Y'                                       S01117
     C           BRNCH     ANDEQBRCA                                      S01117
     C                     CLOSELE0870P1                                  S01117
     C***********BRNCH     IFEQ 'ALL'                                     S01117
     C***********BRNCH     OREQ BRCA                                      S01117
     C                     OPEN LE0870P1                                  S01117
     C**                                                                  S01117
     C*     INDICATE THAT THE P1 FILE HAS BEEN OPENED                     S01117
     C**                                                                  S01117
     C                     SETON                     707578               S01117
     C**                                                                  S01117
     C*     ENSURE REPORT SPOOL FILE RECORDED BY RCF                      S01117
     C**
     C                     Z-ADDSFNUM     ZSNUM   60                      S01117
     C**                                                                  S01117
     C                     OUT  LDA                                       S01117
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           SEQ     5                       S01117
     C                     PARM BRCA      SENTY   3                       S01117
     C                     PARM           SFILE                           S01117
     C                     PARM           ZSNUM                           S01117
     C                     PARM           ZSERR   1                       S01117
     C           *LOCK     IN   LDA                                       S01117
      **  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM       S01117
     C           ZSERR     IFEQ 'Y'                                       S01117
     C                     SETON                     U7U8LR               S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C                     Z-ADD0         PAGE                            S01117
     C                     ELSE                                           S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C           BRCA      ANDGTBRNCH                                     S01117
     C                     SETOF                     1370                 S01117
     C                     SETON                     LR                   S01117
     C                     GOTO ENDD                                      S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C**                                                                  S01117
     C*     SKIP TO END IF MBIN = YES, BRANCH REQUIRED <> ALL,            S01117
     C*     AND THE BRANCH READ ON RECORD <> REQUESTED BRANCH             S01117
     C**                                                                  S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C           BRNCH     ANDNE'ALL'                                     S01117
     C           BRCA      ANDNEBRNCH                                     S01117
     C                     SETOF                     70                   S01117
     C                     GOTO ENDD                                      S01117
     C                     END                                            S01117
0402 C/SPACE 3
0410 C*
0411 C* COUNT RECORDS INPUT
0412 C   02      NORI      ADD  1         NORI
0413 C*
0414 C* HASH TOTAL FCLTY AMT. OUTPUT ZZZTOTI/D.
0415 C                     Z-ADD0         ZZAMT
0416 C                     MOVE FAMT      ZZAMT
     C           ZZAMT     IFLT 0                                                             193603
     C                     Z-SUBZZAMT     ZZAMT                                               193603
     C                     END                                                                193603
0417 C                     EXSR GLZADD
0418 C*
0419 C* AT CHANGE OF CUSTOMER, CHAIN TO CLIENT FILE FOR REPORT NAME
0420 C***L1*********       MOVELCNUM      CLINKY  7                       S01194
0421 C***L1*********       MOVE 'A'       CLINKY                          S01194
0422 C***L1******CLINKY    CHAINCLINT                42     42=NOT FOUND  S01194
     C   L1                MOVELCNUM      CLINKY 10                       S01194
     C   L1                CALL 'AOCUSTR0'                                S01194
     C                     PARM '*MSG   ' @RTCD                           S01194
     C                     PARM '*KEY   ' @OPTN                           S01194
     C                     PARM           CLINKY                          S01194
     C                     PARM '*CNUM  ' KEYSTS  7                       S01194
     C           SDCUST    PARM SDCUST    DSSDY                           S01194
     C           @RTCD     IFNE *BLANKS                                   S01194
     C           @RTCD     ANDNE'*CUSCLS'                                                   AR997263
     C                     SETON                     U7U8LR               S01194
     C                     MOVE 'SDCUSTPD'DBFILE                          S01194
     C                     END                                            S01194
     C           @RTCD     IFEQ '*CUSCLS'                                                   MD050457
     C                     MOVEACSTS      CRNM                                              MD050457
     C                     ENDIF                                                            MD050457
0423 C*
0424 C* DATABASE ERROR IF LIVE RECORD NOT FOUND
0425 C**N07*L1******                                                      S01194
0426 C*OR*42*L1*****        SETON                     U7U8LR              S01194
0427 C***U7*U8******       MOVE 'CLINT'   DBFILE                          S01194
0428 C   U7 U8             MOVELCLINKY    DBKEY
0429 C   U7 U8             Z-ADD05        DBASE             (**DBASE 05)
0430 C   U7 U8             GOTO ENDD
0431 C/SPACE 3
0432 C*
0433 C********************************************************************
0434 C**
0435 C******     IF FCLTY CCY = BASE CCY, SKIP CONVERSION  ***************
0436 C           FCCY      COMP BCCY                     35
0437 C   35                GOTO BCYAMT
0438 C**
0439 C********************************************************************
0440 C**
0441 C******     CONVERT AMOUNTS TO BASE CCY         *********************
0442 C*
0443 C* COMPARE THIS FCCY WITH PREVIOUS - IF SAME, SKIP TO CONVERT
0444 C           FCCY      COMP FCCYY                    32
0445 C   32                GOTO CONVRT
0446 C*
0447 C*
0448 C* SAVE THIS FCCY AS FCCYY FOR COMPARISON NEXT CYCLE
0449 C                     MOVE FCCY      FCCYY   3
0450 C*
0451 C* GET FCCY DEC.PLACES,SPOT RATE & MULT/DIV IND.
0452 C* IF BLANK (09 ON) OR INVALID, DATABASE ERROR
0453 C  N09                SETOF                     33
0454 C  N09                Z-ADD1         Z       30
0455 C  N09      FCCY      LOKUPACY,Z                    33
0456 C*
0457 C   09
0458 CORN33                SETON                     U7U8LR
0459 C***U7*U8******       MOVE 'TABLE'   DBFILE                          S01194
0460 C***U7*U8******       MOVELFCCY      TBKEY1                          S01194
0461 C***U7*U8******       MOVE '1'       TBKEY1                          S01194
0462 C***U7*U8******       MOVEL'20      'TABKEY                          S01194
0463 C***U7*U8******       MOVE TBKEY1    TABKEY                          S01194
0464 C***U7*U8******       MOVELTABKEY    DBKEY                           S01194
0459 C   U7 U8             MOVE 'SDCURRPD'DBFILE                          S01194
0460 C   U7 U8             MOVELFCCY      DBKEY                           S01194
0465 C   U7 U8             Z-ADD06        DBASE             (**DBASE 06)
0466 C   U7 U8             GOTO ENDD
0467 C*
0468 C* DETERMINE EFFECTIVE CONVERSION RATE,
0469 C* ALLOWING FOR DIFFERENT DEC.PLACES.
0470 C           ADP,B     SUB  ADP,Z     X       10
0471 C           X         ADD  4         X
0472 C***********AMD,Z     COMP 0                        34  (34=DIVIDE)  S01194
0472 C           AMD,Z     COMP 'D'                      34  (34=DIVIDE)  S01194
0473 C   34      ASR,Z     DIV  POWER,X   RATE1  138
0474 C   34      1         DIV  RATE1     RATE1
0475 C  N34      ASR,Z     MULT POWER,X   RATE1
0476 C*
0477 C*
0478 C           CONVRT    TAG                             **CONVRT TAG**
0479 C* FROM: BEGINNING CONVERSION TO BASE CCY
0480 C*
0481 C* CONVERT AMOUNTS TO BASE CCY
0482 C           MTDA      MULT RATE1     MTDAB  130H
0483 C           QTDA      MULT RATE1     QTDAB  150H
0484 C           YTDA      MULT RATE1     YTDAB  150H
0485 C           MTDH      MULT RATE1     MTDHB  130H
0486 C           MTDL      MULT RATE1     MTDLB  130H
0487 C*
0488 C* IF FCCY = BCCY, MOVE AMTS TO NEW FIELDS
0489 C*
0490 C           BCYAMT    TAG                             ** BCYAMT TAG**
0491 C* FROM: BEFORE CONVERSION TO BASE CCY
0492 C   35                Z-ADDMTDA      MTDAB
0493 C   35                Z-ADDQTDA      QTDAB
0494 C   35                Z-ADDYTDA      YTDAB
0495 C   35                Z-ADDMTDH      MTDHB
0496 C   35                Z-ADDMTDL      MTDLB
0497 C/SPACE 3
0498 C*
0499 C********************************************************************
0500 C**
0501 C******     CALCULATE AVERAGE AMOUNTS           *********************
     C                     SETOF                     36
0502 C*
     C* *CALCULATE*DNWD*-*1******                                  E00395 E86101
     C*                                                                   E00395
     C***********DNWD******SUB  1         DPNWD   50               E00395 E86101
     C*
0503 C* DETERMINE MONTH NUMBER
0504 C                     MOVE RUNA      WRK2    5        (MMMYY)
0505 C                     MOVELWRK2      WRK3    3        (MMM)
0506 C                     Z-ADD1         M       20
0507 C           WRK3      LOKUPZMNM,M                   21(M=MONTH NO.)
0508 C*
0509 C* GET DAYNO FIRST DAY THIS MONTH
0510 C                     Z-ADDM         WRK4    40       (00MM)
0511 C                     MOVEL'01'      WRK4             (01MM)
0512 C                     MOVE RUNA      ZDATE            (DMMMYY)
0513 C                     MOVELWRK4      ZDATE            (01MMYY)
0514 C                     SETOF                     98
0515 C                     EXSR ZDATE1
0516 C*
0519 C**
0517 C**   CALC. NO DAYS FROM LAST DAY LAST MONTH
0520 C**   USE START DATE OF FACILITY IF GREATER THAN END LAST MONTH
0521 C**
0522 C           DTAP      COMP ZDAYNO               36
     C   36      DPNWD     SUB  DTAP      DAYSM   20
     C  N36      DPNWD     SUB  ZDAYNO    DAYSM
0524 C           DAYSM     ADD  1         DAYSM        3737
0525 C*
0526 C* AGG.BAL.(IN BASE CCY) DIVIDED BY DAYS IN MONTH GIVES AVERAGE
0527 C  N37      MTDAB     DIV  DAYSM     MTDAV  130H
0528 C   37                Z-ADD0         MTDAV
0529 C*
0530 C* DETERMINE WHICH QUARTER
0531 C                     SETOF                     222324
     C                     SETOF                     3625
0533 C           M         COMP 3                      2222
0534 C  N22      M         COMP 6                      2323
0535 C  N22N23   M         COMP 9                      2424
0536 C  N22N23N24          SETON                         25
0537 C*
0538 C* GET DAYNO FIRST DAY THIS QUARTER
0539 C   22                Z-ADD1         WRK4             (0001)
0540 C   23                Z-ADD4         WRK4             (0004)
0541 C   24                Z-ADD7         WRK4                 ETC.
0542 C   25                Z-ADD10        WRK4
0543 C                     MOVEL'01'      WRK4             (0101 ETC)
0544 C                     MOVELWRK4      ZDATE            (0101YY)
0545 C                     EXSR ZDATE1
0546 C*
0549 C**
0547 C**   CALC. NO. DAYS FROM LAST DAY OF LAST QUARTER
0550 C**   USE START DATE OF FACILITY IF GREATER THAN END LAST QUARTER
0551 C**
0552 C           DTAP      COMP ZDAYNO               36
0553 C   36      DPNWD     SUB  DTAP      DAYSQ   20
     C  N36      DPNWD     SUB  ZDAYNO    DAYSQ
0554 C           DAYSQ     ADD  1         DAYSQ        3737
0555 C*
0556 C* AGG.BAL.(IN BASE CCY) DIVIDED BY DAYS IN QUARTER GIVES AVERAGE
0557 C  N37      QTDAB     DIV  DAYSQ     QTDAV  130H
0558 C   37                Z-ADD0         QTDAV
0559 C*
     C                     SETOF                     36
0559 C*
0560 C* DETERMINE DAYNO ON FIRST JANUARY
0561 C* IF IN FIRST QUARTER (22 ON), THESE CALCS SAME AS ABOVE
0562 C  N22                MOVEL'0101'    ZDATE            (0101YY)
0563 C  N22                EXSR ZDATE1
0564 C*
0567 C**
0565 C**   CALC. NO DAYS FROM 31 DECEMBER LAST YEAR
0568 C**   USE START DATE OF FACILITY IF GREATER THAN END LAST YEAR
0569 C**
0570 C  N22      DTAP      COMP ZDAYNO               36
0571 C  N22 36   DPNWD     SUB  DTAP      DAYSY   30
     C  N22N36   DPNWD     SUB  ZDAYNO    DAYSY
0572 C  N22      DAYSY     ADD  1         DAYSY        3737
0573 C*
0574 C* AGG.BAL.(IN BASE CCY) DIVIDED BY DAYS IN YEAR GIVES AVERAGE
0575 C  N22N37   YTDAB     DIV  DAYSY     YTDAV  130H
0576 C  N22 37             Z-ADD0         YTDAV
0577 C*
0578 C* IF IN FIRST QUARTER, USE QTDAV
0579 C   22                Z-ADDQTDAV     YTDAV
0580 C*
0581 C***********ENDD      TAG                             ** ENDD TAG ** S01117
0581 C           ENDD      ENDSR                           ** ENDD TAG ** S01117
0582 C* FROM: BEGINNING FIRST CYCLE, END FIRST CYCLE, 6 DATABASE ERRORS
0583 C*
0584 C********************************************************************
0585 C/SPACE 3
0652 C********************************************************************
0653 C* SUBROUTINE TO ADD AN AMOUNT (ZZAMT) TO THE TOTAL (ZZTOTI,ZZTOTD)
0654 C*   IND '99' IS SET BY AN OVERFLOW ERROR
0655 C*
0656 C* CALLED BY: MAIN PROCESSING
0657 C*
0658 CSR         GLZADD    BEGSR                           *** GLZADD ****
0659 C*
0660 CSR                   Z-ADDZZAMT     ZZAMT  153     91-DEFINE ZZAMT
0661 CSR 91                GOTO ZZAEND                     AMT = 0.BYPASS
0662 C*
0663 C* SPLIT ZZAMT INTO INTEGER AND DECIMAL FIELDS
0664 CSR                   Z-ADDZZAMT     ZZAMTI 150       INTEGER FIELD
0665 CSR                   MOVE ZZAMT     ZZAMTD  30       DECIMAL FIELD
0666 C* BOTH ZZAMTI AND ZZAMTD CONTAIN A 'SIGN' ZONE NOW
0667 C*
0668 CSR                   EXSR GLZSUM
0669 CSR         ZZAEND    ENDSR                           ** ZZAEND TAG *
0670 C*
0671 C********************************************************************
0672 C********************************************************************
0673 C* SUBROUTINE TO CARRY OUT THE ADDITION FOR SUBROUTINES -
0674 C*                        GLZADD, GLZSUB, GLZCMP.
0675 C*          PARAMETERS PASSED -
0676 C*                     I/P ZZAMTI ZZAMTD
0677 C*                     O/P ZZTOTI ZZTOTD ZZNEGD IND 96 IND 99.
0678 C*
0679 CSR         GLZSUM    BEGSR                           *** GLZSUM ****
0680 C*
0681 CSR                   Z-ADDZZTOTI    ZZTOTI 150       DEFINE ZZTOTI
0682 CSR                   Z-ADDZZTOTD    ZZTOTD  30       DEFINE ZZTOTD
0683 CSR                   SETOF                     919293
0684 CSR                   SETOF                     949599
0685 C*
0686 C*    DETERMINE SIGN OF ZZAMTI & D,   92 IF NEG
0687 CSR         ZZAMTI    COMP 0                      9293
0688 CSR 93      ZZAMTD    COMP 0                      9293
0689 CSR 93                GOTO ZZSEND                     ZERO BYPASS
0690 C*
0691 C*    DETERMINE SIGN OF ZZTOTI & D, 91 IF NEG.
0692 CSR         ZZTOTI    COMP 0                      9193
0693 CSR 93      ZZTOTD    COMP 0                      9193
0694 C*
0695 C*    IF ZZTOTAL IS ZERO, RETURN ZZAMOUNT.
0696 CSR 93                Z-ADDZZAMTI    ZZTOTI
0697 CSR 93                Z-ADDZZAMTD    ZZTOTD
0698 CSR 93                GOTO ZZSEND                     ZERO BYPASS
0699 C*    IF SIGNS DIFFER BYPASS OVERFLOW CHECKS.
0700 CSR 91N92
0701 CORN91 92             GOTO ZZOFPS
0702 C*
0703 CSR         ZZAMTD    ADD  ZZTOTD    ZZWK2   40
0704 CSR         ZZWK2     COMP 999                  93    '93' = CARRY
0705 CSRN93      ZZWK2     COMP -999                   93    INTO INTEGER.
0706 C*
0707 CSR 93N92   ZZAMTI    ADD  1         ZZWK3  150       ADD 'CARRY' +VE
0708 CSR    93 92ZZAMTI    SUB  1         ZZWK3            SUB 'CARRY' -VE
0709 CSR 93      ZZTOTI    ADD  ZZWK3     ZZWK3
0710 CSRN93      ZZTOTI    ADD  ZZAMTI    ZZWK3
0711 C*
0712 C* IF THE MODULUS OF ZZWK3 IS LT MOD. ZZTOTI THEN O/F HAS OCCURED
0713 CSRN92      ZZWK3     COMP ZZTOTI                 99  -92 MEANS NOS.
0714 CSR 92      ZZWK3     COMP ZZTOTI               99     NEGATIVE
0715 CSRN99                Z-ADDZZWK2     ZZTOTD
0716 CSRN99                Z-ADDZZWK3     ZZTOTI
0717 C*
0718 C* IF O/F ZEROIZE ZZAMT , IND '99' SET AND ZZTOT FIELDS LEFT INTACT.
0719 CSR 99                Z-ADD0         ZZAMT  153
0720 CSR                   GOTO ZZSEND
0721 C*
0722 C* THE 'SIGNS' ARE DIFFERENT
0723 CSR         ZZOFPS    TAG                             ** ZZOFPS TAG**
0724 C* IF ZZAMT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZTOT
0725 C*
0726 CSR 92                Z-SUBZZAMTI    ZZAMTI 150
0727 CSR 92                Z-SUBZZAMTD    ZZAMTD  30
0728 C*
0729 C* IF ZZTOT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZAMT.
0730 C*
0731 CSR 91                Z-SUBZZTOTI    ZZTOTI
0732 CSR 91                Z-SUBZZTOTD    ZZTOTD
0733 C* BOTH ZZAMT AND ZZTOT ARE NOW POSITIVE.
0734 C*
0735 CSR         ZZTOTI    COMP ZZAMTI               93  95
0736 CSR 95      ZZTOTD    COMP ZZAMTD               93  95
0737 C*
0738 C* IF ZZTOT EQ. ZZAMT RETURN ZERO.
0739 CSR 95                Z-ADD0         ZZTOTI
0740 CSR 95                Z-ADD0         ZZTOTD
0741 CSR 95                GOTO ZZSEND
0742 C*
0743 C* IF ZZTOT GT. ZZAMT.
0744 CSR 93      ZZAMTD    COMP ZZTOTD               94
0745 CSR 93 94   ZZTOTI    SUB  1         ZZTOTI
0746 CSR 93 94   ZZTOTD    ADD  1000      ZZWK2
0747 CSR 93      ZZTOTI    SUB  ZZAMTI    ZZTOTI
0748 CSR 93 94   ZZWK2     SUB  ZZAMTD    ZZTOTD
0749 CSR 93N94   ZZTOTD    SUB  ZZAMTD    ZZTOTD
0750 C*
0751 C*
0752 C* IF ZZAMT GT. ZZTOT.
0753 CSRN93      ZZTOTD    COMP ZZAMTD               94
0754 CSRN93 94   ZZAMTI    SUB  1         ZZWK3  150
0755 CSRN93 94   ZZAMTD    ADD  1000      ZZWK2
0756 CSRN93 94   ZZWK3     SUB  ZZTOTI    ZZTOTI
0757 CSRN93N94   ZZAMTI    SUB  ZZTOTI    ZZTOTI
0758 CSRN93 94   ZZWK2     SUB  ZZTOTD    ZZTOTD
0759 CSRN93N94   ZZAMTD    SUB  ZZTOTD    ZZTOTD
0760 C*
0761 C* REVERSE SIGN OF ZZTOT IF LARGER I/P FIELDS WERE NEGATIVE
0762 CSR                   SETOF                     94
0763 CSR 93 91
0764 CORN93 92             SETON                     94
0765 CSR 94                Z-SUBZZTOTI    ZZTOTI
0766 CSR 94                Z-SUBZZTOTD    ZZTOTD
0767 C**
0768 C**   RESTORE SIGN OF ZZAMTI & ZZAMTD IF IT WAS REVERSED.
0769 CSR 92                Z-SUBZZAMTI    ZZAMTI
0770 CSR 92                Z-SUBZZAMTD    ZZAMTD
0771 CSR         ZZSEND    TAG                             ** ZZSEND TAG *
0772 C**
0773 C**   IF ZZTOTD IS ZERO, AND ZZTOTI IS NEG. SET UP ZZNEGD.
0774 CSR                   SETOF                     96
0775 CSR         ZZTOTD    COMP 0                        91
0776 CSR 91      ZZTOTI    COMP 0                      96
0777 CSR 96                MOVE '.000-'   ZZNEGD  5
0778 CSR                   ENDSR                             ** ENDSR **
0779 C********************************************************************
0780 C********************************************************************
0781 C******
0782 C******     SUBROUTINE FOR TRAILER PROCESSING   *********************
0783 C**
0784 C**  CALLED BY: BEGINNING OF PROG.
0785 C**
0786 C           TRAILR    BEGSR                           *** TRAILR ***
0787 C*
0788 C*  EXCPT OUTPUT: END REPORT (11 ON), OR NO DETAILS (N11)
0789 C*  IF NO DETAILS, SET ON OVERFLOW FOR HEADINGS
0790 C**N11******          SETON                     OF                   S01117
0791 C***********          EXCPT                                          S01117
0792 C*
0793 C* COUNT TRAILER READ
0794 C           NORI      ADD  1         NORI
0795 C*
0796 C* COMPARE RECORD COUNTS
0797 C*
0798 C* NLRA REFERS TO NO. LIVE RECORDS ON S/FCLTY (INC.'B' RECORDS)
0799 C* SO CONVERT TO NO.RECORDS EXPECTED ON S/SORTA (NLRE)
0800 C           NLRA      DIV  2         NLRE    50
0801 C* ADD HEADER & TRAILER
0802 C           NLRE      ADD  2         NLRE
0803 C*
0804 C* COMPARE NO. RECORDS EXPECTED WITH THOSE INPUT
0805 C           NLRE      COMP NORI                     43
0806 C*
      * If compare fails, try multiplying up NORI in case difference results from high        235358
      * order truncation.                                                                     235358
     C           *IN43     IFEQ '0'                                                           235358
     C           NORI      SUB  2         NORI2   50                                          235358
     C                     MULT 2         NORI2                                               235358
     C           NLRA      COMP NORI2                    43                                   235358
     C                     ENDIF                                                              235358
      *                                                                                       235358
0807 C* COMPARE HASH TOTALS
0808 C   43      VLAF      COMP ZZTOTI                   43
0809 C   43      VLAL      COMP ZZTOTD                   43
0810 C*
0811 C* IF ANY NOT BALANCE, SET ON U8
0812 C  N43                SETON                     U8
0813 C*
0814 C                     ENDSR
0815 C*
0935 C********************************************************************S01117
     C*                                                                   S01117
     C* SUBROUTINE : #ZZ                                                  S01117
     C*                                                                   S01117
     C* CALLED BY MAIN PROCESSING DURING TOTAL TIME CALCULATIONS IF       S01117
     C* THE P1 FILES HAVE NOT ALREADY BEEN OPENED (IE, IF THERE ARE       S01117
     C* NO RECORDS READ AND THEREFORE FILES OPENING NOT PERFORMED)        S01117
     C*                                                                   S01117
     C           #ZZ       BEGSR                                          S01117
      *                                                                   S01117
      ** OPEN P1 SPOOL FILE                                               S01117
     C**N50NU7***          OPEN LE0870P1                            S01117BHF117
     C  N50                OPEN LE0870P1                                  BHF117
     C                     SETON                     70                   S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C           BRNCH     ANDNE'ALL'                                     S01117
     C                     MOVE BRNCH     BRNP                            S01117
     C**                                                                  S01117
     C*   GET BRANCH NAME, ONLY WHEN MBIN = YES                           S01117
     C**                                                                  S01117
     C**********           CALL 'AOBRCHR0'                                S01117              CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       S01117
     C                     PARM '*KEY   ' @OPTN   7                       S01117
     C                     PARM BRNP      @DSNB   3                       S01117
     C********** SDBRCH    PARM SDBRCH    DSFDY                           S01117              CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANKS                                   S01117
     C                     MOVEL@DSNB     DBKEY                           S01117
     C                     MOVEL'SDBRCHPD'DBFILE           ***************S01117
     C                     Z-ADD10        DBASE            * DBERROR 010 *S01117
     C                     MOVEL@OPTN     DBOPTN  7        ***************S01117
*    C                     SETON                     U7U8LR               S01117
     C                     EXSR *PSSR                                     S01117
     C                     GOTO #ZZ9                                      S01117
     C                     END                                            S01117
     C                     END                                            S01117
      *                                                                   S01117
      ** IF REPORT FOR ALL ENTITIES CALL ZSFILE WITH BLANK SENTY          S01117
     C           BRNCH     IFEQ 'ALL'                      B1             S01117
     C           MBIN      ORNE 'Y'                                       S01117
      *                                                                   S01117
      ** ENSURE REPORT SPOOL FILE RECORDED BY RCF                         S01117
     C                     Z-ADDSFNUM     ZSNUM   60                      S01117
     C                     OUT  LDA                                       S01117
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           SEQ                             S01117
     C                     PARM *BLANKS   SENTY   3                       S01117
     C                     PARM           SFILE                           S01117
     C                     PARM           ZSNUM                           S01117
     C                     PARM           ZSERR   1                       S01117
     C           *LOCK     IN   LDA                                       S01117
      **  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM       S01117
     C           ZSERR     IFEQ 'Y'                                       S01117
     C                     SETON                     U7U8LR               S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
      *                                                                   S01117
     C                     MOVE 'ALL'     BRCA                            S01117
     C                     MOVE *BLANKS   BRNM                            S01117
      *                                                                   S01117
      ** ELSE REPORT BY ENTITY SO CALL ZSFILE WITH ENTITY REQUESTED       S01117
     C                     ELSE                            X1             S01117
      *                                                                   S01117
      ** ENSURE REPORT SPOOL FILE RECORDED BY RCF                         S01117
     C                     Z-ADDSFNUM     ZSNUM   60                      S01117
     C                     OUT  LDA                                       S01117
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           SEQ                             S01117
     C                     PARM BRNCH     SENTY   3                       S01117
     C                     PARM           SFILE                           S01117
     C                     PARM           ZSNUM                           S01117
     C                     PARM           ZSERR   1                       S01117
     C           *LOCK     IN   LDA                                       S01117
      **  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM       S01117
     C           ZSERR     IFEQ 'Y'                                       S01117
     C                     SETON                     U7U8LR               S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
      *                                                                   S01117
     C                     MOVE BRNCH     BRCA                            S01117
     C                     END                             E1             S01117
      *                                                                   S01117
      ** OUTPUT 'NO DETAILS TO REPORT' IN P1                              S01117
     C                     SETON                     70                   S01117
      *                                                                   S01117
     C           #ZZ9      ENDSR                                          S01117
      *                                                                   S01117
     C********************************************************************S01117
     C*                                                                   S01117
     C* *PSSR  --- SUBROUTINE TO HANDLE ABNORMAL ERROR CONDITIONS         S01117
     C*                                                                   S01117
     C* CALLED FROM: AFTER ABNORNAL OPERATION OCCURS                      S01117
     C*                                                                   S01117
     C* CALLS: NOTHING                                                    S01117
     C*                                                                   S01117
     C********************************************************************S01117
     C*                                                                   S01117
     C           *PSSR     BEGSR                           ** *PSSR **    S01117
     C*                                                                   S01117
     C           @RUN      IFEQ *BLANKS                                   S01117
     C                     MOVE 'Y'       @RUN    1                       S01117
     C                     DUMP                                           S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C                     ENDSR                           ** *PSSR **    S01117
     C********************************************************************S01117
     C/COPY ZSRSRC,ZDATE1Z2                                               S01392
     C/COPY ZSRSRC,ZDATE2Z4                                               S01392
0527 C********************************************************************E86101
0817 O*E0870P1H**203   L2                                       S01124    S01117
0817 O*E0870P1H**203   L2 13                                              S01117
0817 OLE0870P1H  203   L2 70                                              S01117
0818 O*******OR**      OFNL2                                              S01117
0818 O*******OR**      OFNL2 13                                           S01117
0818 O       OR        OFNL2 70                                           S01117
0819 O       OR        01 U7 U8
     O*******AND*******13                                                 S01117
     O       AND       70                                                 S01117
0820 O***********                        23 'REFERENCE  LE0870'           S01117
0820 O                                   25 'REFERENCE  LE0870P1'         S01117
0821 O                         TITL      89
0822 O                                  104 'DATE'
0823 O                         RUNA     112
0824 O                                  122 'PAGE'
0825 O                         PAGE  Z  127
0826 O********H**1     L2                                                 S01117
0826 O********H**1     L2 13                                              S01117
0826 O        H  1     L2 70                                              S01117
0827 O*******OR**      OFNL2                                              S01117
0818 O*******OR**      OFNL2 13                                           S01117
0818 O       OR        OFNL2 70                                           S01117
0828 O       OR        01 U7 U8
     O*******AND**     13                                                 S01117
     O       AND       70                                                 S01117
0829 O***********           NLR          12 'BRANCH'                      S01117
0830 O***********           NLRBRCD      17                               S01117
0831 O***********      03N11NU7          17 '           '                 S01117
0832 O                                   68 'AVERAGE USE OF LINES'
0833 O                                   73 ' - IN'
0834 O                         BCCY      77
     O                N50                88 'BRANCH'                      S01117
     O                N50      BRCA      92                               S01117
     O                N50                93 '-'                           S01117
     O                N50      BRNM     123                               S01117
0835 O********H**2     L2                                                 S01117
0835 O********H**2     L2 13                                              S01117
0835 O        H  2     L2 70                                              S01117
0836 O*******OR**      OFNL2                                              S01117
0818 O*******OR**      OFNL2 13                                           S01117
0818 O       OR        OFNL2 70                                           S01117
0837 O       OR        01 U7 U8
     O*******AND**     13                                                 S01117
     O       AND       70                                                 S01117
0838 O                                   68 '--------------------'
0839 O                                   77 '---------'
0826 O********H**2     L2 13                                              S01117
0818 O*******OR***     OFNL2 13                                           S01117
     O************                       12 'BRANCH'                      S01117
     O************             BRCA      16                               S01117
     O************             BRNM      48                               S01117
0840 O********H**2     L2                                                 S01117
0840 O********H**2     L2 13                                              S01117
0840 O        H  2     L2 70                                              S01117
0841 O*******OR**      OFNL2                                              S01117
0818 O*******OR**      OFNL2 13                                           S01117
0818 O       OR        OFNL2 70                                           S01117
0842 O                                   16 'CUSTOMER NAME'
0843 O                                   39 'NO     FCLT REF'
0844 O                                   75 'AVERAGE USED'
0845 O                                   95 'HIGH BAL'
0846 O                                  115 'LOW BAL'
0847 O        D  1     02NU7NU8
     O*******AND*      13                                                 S01117
     O       AND       70                                                 S01117
0848 O                       L1CRNM      23
0849 O                 OFNL1   CRNM      23
0850 O                       L1CNUM      30
0851 O                 OFNL1   CNUM      30
0852 O                         FCTN      38 '   /  '
0853 O                                   56 'MONTH TO DATE'
0854 O                       80MTDAV     76 ' ,   ,   ,   , 0 '
0855 O                       81MTDAV     76 '   ,   ,   , 0 . '
0856 O                       82MTDAV     76 '  ,   ,   , 0 .  '
0857 O                       83MTDAV     76 ' ,   ,   , 0 .   '
0858 O*
0859 O                       80MTDHB     96 ' ,   ,   ,   , 0 '
0860 O                       81MTDHB     96 '   ,   ,   , 0 . '
0861 O                       82MTDHB     96 '  ,   ,   , 0 .  '
0862 O                       83MTDHB     96 ' ,   ,   , 0 .   '
0863 O*
0864 O                       80MTDLB    116 ' ,   ,   ,   , 0 '
0865 O                       81MTDLB    116 '   ,   ,   , 0 . '
0866 O                       82MTDLB    116 '  ,   ,   , 0 .  '
0867 O                       83MTDLB    116 ' ,   ,   , 0 .   '
0868 O        D  1     02NU7NU8
     O*******AND*      13                                                 S01117
     O       AND       70                                                 S01117
0869 O                                   56 'QUARTER TO DATE'
0870 O                       80QTDAV     76 ' ,   ,   ,   , 0 '
0871 O                       81QTDAV     76 '   ,   ,   , 0 . '
0872 O                       82QTDAV     76 '  ,   ,   , 0 .  '
0873 O                       83QTDAV     76 ' ,   ,   , 0 .   '
0874 O        D  2     02NU7NU8
     O*******AND*      13                                                 S01117
     O       AND       70                                                 S01117
0875 O                                   56 'YEAR TO DATE'
0876 O                       80YTDAV     76 ' ,   ,   ,   , 0 '
0877 O                       81YTDAV     76 '   ,   ,   , 0 . '
0878 O                       82YTDAV     76 '  ,   ,   , 0 .  '
0879 O                       83YTDAV     76 ' ,   ,   , 0 .   '
0880 O*
0881 O********D*33     U7 U8                                              S01117
0881 O********D*33     U7 U8 13                                           S01117
0881 O        T 33     U7 U8 70                                           S01117
     O       AND       LR                                                 S01117
0882 O                                   10 ' '
0883 O********D*32     U7 U8                                              S01117
0883 O********D*33     U7 U8 13                                           S01117
0881 O        D 33     U7 U8 70                                           S01117
     O       AND       LR                                                 S01117
0884 O***********                        51 '*** REFERENCE LE0870'        S01117
0885 O***********                        71 'DATABASE ERROR AT'           S01117
0885 O                                   71 'DATABASE ERROR'              S01117
0886 O***********              DBASE     74                               S01117
0887 O********D**      U7 U8                                              S01117
0888 O***********                        37 'FILENAME'                    S01117
0889 O***********              DBFILE    43                               S01117
0890 O***********                        48 'KEY'                         S01117
0891 O***********                                                         S01117
0892 O/SPACE 3
0893 O********EF* 21   03N11NU7                                           S01117
0894 O***********                        76 '* NO DETAILS TO REPORT *'    S01117
0895 O*
0896 O********E*32     03 11NU7                                           S01117
0897 O***********                        10 ' '                           S01117
0898 O********E**      03 11NU7                                           S01117
     O        T  203   L2 70NU7                                           S01117
     O       AND      N50N75                                              S01117
     O       OR        LRN76NU7                                           S01117
     O       AND       50 70                                              S01117
     O       OR        LR 70NU7                                           S01117
     O       AND      N50N78                                              S01117
     O                                   24 'REFERENCE LE0850P1'          S01117
0681 O                         TITL      89                               S01117
0682 O                                  104 'DATE'                        S01117
0683 O                         RUNA     112                               S01117
0684 O                                  122 'PAGE'                        S01117
0685 O                         PAGE  Z  127                               S01117
     O        T  1     L2 70NU7                                           S01117
     O       AND      N50N75                                              S01117
     O       OR        LRN76NU7                                           S01117
     O       AND       50 70                                              S01117
     O       OR        LR 70NU7                                           S01117
     O       AND      N50N78                                              S01117
0691 O                                   68 'AVERAGE USE OF LINES'        S01117
0692 O                                   73 ' - IN'                       S01117
     O                         BCCY      77                               S01117
     O                N50                88 'BRANCH'                      S01117
     O                N50      BRCA      92                               S01117
     O                N50N85 87          92 'BRANCH ALL'                  S01117
     O                N50                93 '-'                           S01117
     O                N50N85 87          93 ' '                           S01117
     O                N50      BRNM     123                               S01117
     O        T  3     L2 70NU7                                           S01117
     O       AND      N50N75                                              S01117
     O       OR        LRN76NU7                                           S01117
     O       AND       50 70                                              S01117
     O       OR        LR 70NU7                                           S01117
     O       AND      N50N78                                              S01117
0696 O                                   68 '--------------------'        S01117
0697 O                                   77 '-------------'               S01117
     O        T  326   L2 70NU7                                           S01117
     O       AND      N50N75                                              S01117
     O       OR        LRN76NU7                                           S01117
     O       AND       50 70                                              S01117
     O       OR        LR 70NU7                                           S01117
     O       AND      N50N78                                              S01117
     O                                   76 '*** NO DETAILS TO REPORT'    S01117
     O                                   80 '***'                         S01117
     O********T*2      L2 13                                              S01117
0899 O***********                        73 '*** END OF REPORT ***'       S01117
     O***********                        66 '*** END OF BRANCH '          S01117
     O***********                        76 'REPORT ***'                  S01117
0900 O*                                                                   S01117
     O        T 3      L2 70N50                                           S01117
     O                                   66 '*** END OF REPORT FOR'       S01117
     O                                   74 ' BRANCH '                    S01117
     O                         BRNP      77                               S01117
     O                                   81 ' ***'                        S01117
     O        T 3      LR 50                                              S01117
     O                                   76 '*** END OF REPORT ***'       S01117
0901 O/SPACE 3
0902 O********T**203   LR                                                 S01117
0902 OLE0870AUT  203   LR                                                 S01117
0903 O***********                        23 'REFERENCE  LE0870'           S01117
0903 O                                   25 'REFERENCE  LE0870AU'         S01117
0904 O                         TITL      89
0905 O                                  104 'DATE'
0906 O                         RUNA     112
0907 O                                  122 'PAGE'
0908 O***********              PAGE  Z  127                               S01117
0908 O                         PAGE1 Z  127                               S01117
0909 O        T  1     LR
0910 O***********                        66 'AVERAGE USE OF LINES  -'     S01117
0911 O***********                        81 'FILE CONTROLS'               S01117
0910 O                                   72 'AVERAGE USE OF LINES'        S01117
     O                                   95 'RUN CONTROL'                 S01117
0912 O        T  3     LR
0913 O***********                        66 '-----------------------'     S01117
0914 O***********                        81 '---------------'             S01117
0913 O                                   72 '--------------------'        S01117
     O        T  326   L2 70NU7                                           S01117
     O       AND      N50N75                                              S01117
     O       OR        LRN76NU7                                           S01117
     O       AND       50 70                                              S01117
     O       OR        LR 70NU7                                           S01117
     O       AND      N50N78                                              S01117
     O                                   76 '*** NO DETAILS TO REPORT'    S01117
     O                                   80 '***'                         S01117
0915 O********T**1     LR                                                 S01117
0915 O        T  1     LR 75 78                                           S01117
0915 O       OR        LR 75 50                                           S01117
0916 O                                   28 'S/SORTA - RUN CONTROLS'
0917 O                                   59 'NUMBER'
0918 O***********                        84 'VALUE'                       S01117
0918 O                 86                84 'VALUE'                       S01117
0919 O********T**2     LR                                                 S01117
0919 O        T  2     LR 75 78                                           S01117
0919 O       OR        LR 75 50                                           S01117
0920 O                                   28 '----------------------'
0921 O                                   59 'OF RECORDS'
0922 O***********                        84 'OF RECORDS'                  S01117
0922 O                 86                84 'OF RECORDS'                  S01117
0923 O********T**2     LR                                                 S01117
0923 O        T  2     LR 75 86                                           S01117
     O       AND       78                                                 S01117
0923 O       OR        LR 75 86                                           S01117
     O       AND       50                                                 S01117
0924 O                                   29 'TOTAL RECORDS ON FILE'
0925 O                   NU7   NLRE  3   59
0926 O                   NU7   VLAF  Z   81
0927 O                   NU7   VLAL      84
0928 O********T**3     LR                                                 S01117
0928 O        T  3     LR 75 78                                           S01117
0928 O       OR        LR 75 50                                           S01117
0929 O                                   29 'TOTAL RECORDS ON FILE'
0930 O                                   42 '- CALCULATED'
0931 O                         NORI  3   59
0932 O***********              ZZTOTIZ   81                               S01117
0933 O***********              ZZTOTD    84                               S01117
0932 O                 86      ZZTOTIZ   81                               S01117
0933 O                 86      ZZTOTD    84                               S01117
0934 O                 U8NU7            112 '***   DIFFERENCE   ***'
0883 O        T 32     U7 U8 LR                                           S01117
0884 O                                   51 '*** REFERENCE LE0870'        S01117
0885 O                                   71 'DATABASE ERROR AT'           S01117
0886 O***********              DBASE     74                               S01117
0886 O                         DBASE     76                               S01117
0887 O        T        U7 U8 LR                                           S01117
0888 O                                   37 'FILENAME'                    S01117
0889 O***********              DBFILE    43                               S01117
0890 O***********                        48 'KEY'                         S01117
0891 O***********              DBKEY     78                               S01117
0889 O                         DBFILE    47                               S01117
0890 O                                   53 'KEY'                         S01117
0891 O                         DBKEY     86                               S01117
0935 O********T*3      LR                                                 S01117
0936 O***********                        73 '*** END OF REPORT ***'       S01117
** POWER ARRAY FOR CCY CONVERSIONS
0000001
0000010
0000100
0001000
0010000
0100000
1000000
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
** CSTS   **      CUSTOMER STATUS                                                           MD050457
*CUST DELETED/CLOSED                                                                        MD050457
** CPY@   **      OBJECT COPYRIGHT
(c) Finastra International Limited 2001
