0001 H        1                                                           S01117
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas Update Year to Date File')                       *
0001 H***********                                                         S01117
0002 F********************************************************************LE0910
0003 F*                                                                   LE0910
     F*  Midas   Customer Lending Module
0005 F*                                                                   LE0910
0006 F*     UPDATE YEAR TO DATE FILE     -  LE0910                        LE0910
0007 F*                                                                   LE0910
      *  (c) Finastra International Limited 2001                      *
0009 F*                                                                   LE0910
      *  Last Amend No. CSD103             Date 10Aug20               *
      *  Prev Amend No. MD046248           Date 27Oct17               *
      *                 CLE148             Date 23Jul12               *
      *                 CER059             Date 19Jul10               *
      *                 BUG23967           Date 13May09               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CSD027             Date 09Dec05               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 BHF773             Date 29NOV90               *
0010 F*                 BHF420             Date 13AUG90               *   BHF420
0010 F*                   S01260                DATE 14MAR90              S01260
0010 F*                   S01194                DATE 17JAN90              S01194
0010 F*                   E86114                DATE 13DEC89              E86114
0010 F*                   S01117                DATE 05/10/87             LE0910
0011 F*                                                                  *
0011 F*------------------------------------------------------------------*
      *  CSD103 - LIBOR Deregulation - Common Layer/Standing Data     *
      *  MD046248 - Finastra Rebranding                               *
      *  CLE148 - Alpha Loan Reference                                *
      *  CER059 - German Feature Upgrade to Delhi                     *
     F*     BUG23967 - Add Local Industry Code Field.                    *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
     F*     BHF773 - USE FULL LAYOUT OF LEYTDYT                          *
     F*     BHF420 - SHOULD USE 6 ZONED VERDSION OF OLNO                 *BHF420
     F*     S01260 - ORIGINAL BORROWER ON PARTICIPATIONS PURCHASED.      *S01260
     F*     S01194 - NEW STANDING DATA                                   *
0008 F*     E86114 - INCORRECT YTD INTEREST FOR CUSTOMERS WITH DROPPED   *E86114
0009 F*              MATURED LOANS INPUT LAST YEAR.                      *E86114
0009 F*     S01117 - MULTI-BRANCHING                                      LE0910
0009 F*                                                                   LE0910
     F*****************************************************************
0012 F***LEYTD***IP AF      80  6AI     2 DISK                            BHF773
0012 F***LEYTD** IP AF      87  6AI     2 DISK                                       BHF773 BUG23967
0012 FLEYTD   IP AF      90  6AI     2 DISK                                                 BUG23967
0013 F***MATLN** IS AF     128  6AI     2 DISK                                       LE0910 BUG23967
0013 FMATLN   IS AF     131  6AI     2 DISK                                                 BUG23967
0014 F*TABLE***IF  F      96 12AI     2 DISK                              S01194
0015 FUPYTDHH O   F      80            DISK                               LE0910
     F**UPYTDYT*O***F**    80            DISK                             S01260
     F*PYTDYT*O***F      85            DISK                         S01260BHF420
     F***UPYTDYT O   F      87            DISK                                       BHF420 BUG23967
     FUPYTDYT O   F      90            DISK                                                 BUG23967
     FUPYTDZY O   F      80            DISK
0016 F*E0910P1O** F     132            PRINTER                            S01117
0016 FLE0910AUO   F     132            PRINTER                            S01117
0017 F* ID F  C  H  L    FUNCTION OF INDICATORS                           LE0910
0018 F* 01            LEYTD HEADER                                        LE0910
0019 F* 02            MATLN HEADER                                        LE0910
0020 F* 03            LEYTD DETAIL                                        LE0910
0021 F* 04            MATLN DETAIL                                        LE0910
0022 F* 05            LEYTD TRAILER                                       LE0910
0023 F* 06            MATLN TRAILER                                       LE0910
0024 F**07******      TABLE FILE                                          S01194
0025 F* 20            LEYTD CATCH ALL                                     LE0910
0026 F* 21            MATLN CATCH ALL                                     LE0910
0027 F*       40      LEYTD CONTROLS DIFFER                               LE0910
     E                    CPY@    1   1 80
0028 F*       41      MATLN CONTROLS DIFFER                               LE0910
0029 I* MATURED LOANS YTD FILE                                            LE0910
0030 I*       HEADER                                                      LE0910
0031 ILEYTD   NS  01   1 CH                                               LE0910
0032 I                                        1   1 RECI                  LE0910
0033 I*       DETAIL                                                      LE0910
0034 I*                                                                   LE0910
0035 I        NS  03   1 CD                                               LE0910
0036 I                                        1   1 RECI                  LE0910
0037 I**********                              2   70CNUM                               LE0910 CSD027
0037 I                                        2   7 CNUM                                      CSD027
0038 I**********                              8  130LNRF    M1                         LE0910 CLE148
     I                                        8  13 LNRF    M1                                CLE148
0039 I***********                            14  160BRCD                  S01117
0039 I                                       14  16 BRCA                  S01117
0040 I                                       17  18 CRSK                  LE0910
0041 I                                       19  210LIND                  LE0910
0042 I                                    P  22  290YPLC                  LE0910
0043 I                                    P  30  370YWLC                  LE0910
0044 I                                    P  38  450YFLC                  LE0910
0045 I                                    P  46  530ABLC                  LE0910
0046 I                                    P  54  560MDAT                  LE0910
0047 I                                       57  570MRIN                  LE0910
0048 I                                       58  590PTYP                  LE0910
     I                                       64  66 CCY                   BHF773
     I                                    P  67  730AITC                  BHF773
     I                                    P  74  800YILN                  BHF773
     I***********                            81  860OLNO            BHF773CSD027
     I                                       81  86 OLNO                  CSD027
     I                                       87  87 RCSI                  BHF773
0041 I                                       88  90 LOIC                                    BUG23967
0049 I* REC REDEFINED IN ONE FILE                                         LE0910
0050 I**********                              1  80 LOTA            LE0910BHF773
0050 I**********                              1  87 LOTA                             BHF773 BUG23967
0050 I                                        1  90 LOTA                                    BUG23967
0051 I*                                                                   LE0910
0052 I*       TRAILER                                                     LE0910
0053 I*                                                                   LE0910
0054 I        NS  05   1 CT                                               LE0910
0055 I                                        1   1 RECI                  LE0910
0056 I                                    P   2   40NORE                  LE0910
0057 I* CATCH ALL                                                         LE0910
0058 I        NS  20                                                      LE0910
0059 I*                                                                   LE0910
0060 I* MATURED LOANS FILE                                                LE0910
0061 I*       HEADER                                                      LE0910
0062 IMATLN   NS  02   1 CH                                               LE0910
0063 I                                        1   1 RECI                  LE0910
0064 I*                                                                   LE0910
0065 I*       DETAIL                                                      LE0910
0066 I* FIELDS REDEFINED IF SAME AS LEYTD                                 LE0910
0067 I*                                                                   LE0910
0068 I        NS  04   1 CD                                               LE0910
0069 I                                        1   1 RECI                  LE0910
0070 I***********                             2   40BRCDM                 S01117
0070 I                                        2   4 BRCAM                 S01117
0071 I**********                              5  100CNUMM                              LE0910 CSD027
0071 I                                        5  10 CNUMM                                     CSD027
0072 I**********                             11  160LNRFM   M1                         LE0910 CLE148
     I                                       11  16 LNRFM   M1                                CLE148
0073 I                                    P  17  190MDATM                 LE0910
0074 I                                    P  20  260TINT                  LE0910
0075 I                                    P  27  330IPRD                  LE0910
0076 I                                    P  34  400ICTD                  LE0910
0077 I                                    P  41  470IWOD                  LE0910
0078 I                                    P  48  537BRTE                  LE0910
0079 I                                    P  54  597RTSP                  LE0910
0080 I**********                             60  610BRTT                               LE0910 CSD103
0080 I                                       60  61 BRTT                                      CSD103
0081 I                                       62  62 SPIN                  LE0910
0082 I                                    P  63  690YPLCM                 LE0910
0083 I                                    P  70  760YILC                  LE0910
0084 I                                    P  77  830YFLCM                 LE0910
0085 I                                    P  84  900YWLCM                 LE0910
0086 I                                    P  91  970ABLCM                 LE0910
0087 I                                       98  99 CRSKM                 LE0910
0088 I                                      100 1020LINDM                 LE0910
0089 I                                      103 1040PTYPM                 LE0910
     I******************                    114 1170OLNO            S01260BHF420
     I***********                           112 1170OLNO            BHF420CSD027
     I                                      112 117 OLNO                  CSD027
     I                                      118 118 RCSI                  S01260
0088 I                                      119 121 CCYM                  E86114
0089 I                                    P 122 1280YILN                  E86114
0088 I                                      129 131 LOICM                                   BUG23967
0090 I*                                                                   LE0910
0091 I*       TRAILER                                                     LE0910
0092 I*                                                                   LE0910
0093 I        NS  06   1 CT                                               LE0910
0094 I                                        1   1 RECI                  LE0910
0095 I* FIELD REDEFINED                                                   LE0910
0096 I                                    P   2   40NORES                 LE0910
0097 I* CATCHALL                                                          LE0910
0098 I        NS  21                                                      LE0910
0099 I*                                                                   LE0910
0100 I*                                                                   LE0910
0101 I*****TABLE*FILE***INSTALLATION*CONTROL*DATA*RECORD*1.               S01194
0102 I**********                                                          S01194
0103 I*TABLE***NS  07   2 C0   3 C1  12 C1                                S01194
0104 I*******AND      13 C0                                               S01194
0105 I**********                              1   1 RECI                  S01194
0106 I**********                              2   30RECT                  S01194
0107 I**********                             12  130RCDE                  S01194
0108 I**********                             14  66 TITL                  S01194
0109 I***********                            67  67 DATF                  S01194
0110 I***********                            68  700DFBR                  S01194
0110 I**********                             68  70 DFBM                  S01194
0111 I**********                             74  74 MODI1                 S01194
0112 I**********                             75  75 MODI2                 S01194
0113 I**********                             76  76 MODI3                 S01194
0114 I***********                         P  77  790RUND                  S01194
0115 I***********                            80  86 RUNA                  S01194
0116 I**********                             87  870SFLG                  S01194
0117 I**********                          P  90  920LCD                   S01194
0118 I**********                             93  93 CHTP                  S01194
0119 I**********                          P  94  960TNLU                  S01194
0120 I*CATCHALL                                                           S01194
0121 I********NS                                                          S01194
0122 I**********                              1   1 RECI                  S01194
0123 I** LOCAL DATA AREA FOR DATABASE ERROR                               LE0910
0124 ILDA        UDS                            256                       LE0910
0125 I***********                           134 138 DBFILE                S01117
0126 I***********                           139 167 DBKEY                 S01117
0127 I***********                           168 175 DBPGM                 S01117
0128 I***********                           176 1770DBASE                 S01117
0125 I                                      134 141 DBFILE                S01117
0126 I                                      142 170 DBKEY                 S01117
0127 I                                      171 180 DBPGM                 S01117
0128 I                                      181 1830DBASE                 S01117
     ISDBANK    E DSSDBANKPD                                              S01194
      ** BANK DETAILS                                                     S01194
     I              BJURPT                          TITL                  S01194
     IDSFDY     E DSDSFDY                                                 S01194
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01194
     I*                                                                   S01194
      **                                                                  S01117
     IRUNDT       DS                                                      S01117
      **  DATA AREA RUNDAT                                                S01117
     I                                        1   7 RUNA                  S01117
     I                                    P   8  100RUND                  S01117
     I                                       11  11 SSF                   S01117
     I                                       12  12 DATF                  S01117
     I                                       13  13 MBIN                  S01117
     I/EJECT                                                              S01117
     C** PARAMETER LIST FOR PROGRAM 'AOBANKR0'                            S01194
     C           PLISTA    PLIST                                          S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDBANK    PARM SDBANK    DSFDY                           S01194
      *
     C                     MOVEACPY@      BIS@   80
      *
0129 C*********   FIRST CYCLE PROCESSING ******************               LE0910
0130 C*                                                                   LE0910
0131 C*OBTAIN ICDR                                                        LE0910
0132 C*                                                                   LE0910
0133 C***01*****           EXSR ZSYSTM                                    S01194
0268 C*********99          SETON                     U7U8LR               S01194
0269 C*********99          MOVEL'TABLE'   DBFILE                          S01194
0270 C*********99          MOVELZTABKY    DBKEY                           S01194
0271 C*********99          MOVEL'01'      DBASE            ** DBASE  01 **S01194
0138 C***99*****           MOVE 'LE0910'  DBPGM                           S01194
     C           *IN01     IFEQ '1'                                       S01194
      *
     C           *NAMVAR   DEFN           LDA                             S01194
     C           *LOCK     IN   LDA                                       S01194
     C           *NAMVAR   DEFN RUNDAT    RUNDT                           S01194
     C                     IN   RUNDT                                     S01194
      *
     C                     CALL 'AOBANKR0'PLISTA                          S01194
     C           @RTCD     IFNE *BLANKS                                   S01194
0199 C                     SETON                     U7U8LR**DATABASE 01**S01194
     C                     Z-ADD1         DBASE                           S01194
     C                     MOVE 'SDBANKPD'DBFILE                          S01194
0138 C                     MOVE 'LE0910'  DBPGM                           S01194
     C                     GOTO PASS                                      S01194
     C                     ELSE                                           S01194
     C**   CHECK SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.                    S01194
     C           DATF      COMP 'M'                      98MMDDYY, 98 ON  S01194
     C                     END                                            S01194
     C                     END                                            S01194
     C**                                                                  S01117
0139 C*                                                                   LE0910
0140 C*********  MAIN PROCESSING (RECORD COUNTS) **********               LE0910
0141 C*                                                                   LE0910
0142 C   01                                                               LE0910
0143 COR 03                                                               LE0910
0144 COR 05      PNOR      ADD  1         PNOR    50                      LE0910
0145 C   02                                                               LE0910
0146 COR 04                                                               LE0910
0147 COR 06      SNOR      ADD  1         SNOR    50                      LE0910
0148 C  N04                GOTO PASS                                      LE0910
0149 C* LENGTHEN FIELDS FOR OUTPUT TO YTD FILE                            LE0910
0150 C                     Z-ADDYPLCM     YPLCY  150                      LE0910
0151 C                     Z-ADDYFLCM     YFLCY  150                      LE0910
0152 C                     Z-ADDYWLCM     YWLCY  150                      LE0910
0153 C                     Z-ADDABLCM     ABLCY  150                      LE0910
0154 C*                                                                   LE0910
0155 C           PASS      TAG                             ** PASS TAG ** LE0910
0156 C* ON READ OF LAST REC COMPARE RECORDS                               LE0910
     CLR         *INLR     IFEQ '1'                                       S01117
0157 CLRNU7      NORE      COMP PNOR                 4040                 LE0910
0158 C*                                                                   LE0910
0159 CLRNU7      NORES     COMP SNOR                 4141                 LE0910
0160 CLR 41                                                               LE0910
0161 COR 40                SETON                     U8                   LE0910
0162 C*                                                                   LE0910
0163 C* ADD TOTALS FOR NEW FILE, MINUS 2 FOR EXTRA HEAD/TRAIL             LE0910
0164 CLRNU7      PNOR      ADD  SNOR      TOTNOR  50                      LE0910
0165 CLRNU7      TOTNOR    SUB  2         TOTNOR                          LE0910
     CLR U7 U8             EXSR *PSSR                                     S01117
     CLR                   END                                            S01117
0166 C********************************************************************LE0910
0167 C**                                                                  LE0910
0469 C*****ZSYSTM*SR.*TO*CHAIN TO THE INSTALLATION CONTROL DATA RECORD.   S01194
0470 C**********                                                          S01194
0471 C********** ZSYSTM    BEGSR                           *** ZSYSTM *** S01194
0472 C**********                                                          S01194
0473 C*****SET*UP*KEY*FOR*INSTALLATION CONTROL RECORD.                    S01194
0474 C**********           MOVEL'01      'ZTABKY 12                       S01194
0475 C**********           MOVE '  10'    ZTABKY                          S01194
0476 C**********                                                          S01194
0477 C********** ZTABKY    CHAINTABLE                99    ON NOT THERE   S01194
0478 C**N99***** RECI      COMP 'D'                  9999  ON, IS DELETED S01194
0479 C**********                                                          S01194
0480 C*****CHECK*SYSTEM*DATE FORMAT, DDMMYY OR MMDDYY.                    S01194
0481 C********** DATF      COMP 'M'                      98MMDDYY, 98 ON  S01194
0482 C**********                                                          S01194
0483 C**********           ENDSR                                          S01194
0183 C**                                                                  LE0910
0184 C**                                                                  LE0910
0185 C********************************************************************LE0910
     C/SPACE 3                                                            S01117
     C********************************************************************S01117
     C*                                                                   S01117
     C*  *PSSR --- SUBROUTINE TO HANDLE ABNORMAL ERROR CONDITIONS         S01117
     C*                                                                   S01117
     C*  CALLED FROM: AFTER ABNORMAL OPERATION OCCURS                     S01117
     C*                                                                   S01117
     C*  CALLS: NOTHING                                                   S01117
     C*                                                                   S01117
     C********************************************************************S01117
     C*                                                                   S01117
     C           *PSSR     BEGSR                           ** *PSSR **    S01117
     C*                                                                   S01117
     C           @RUN      IFEQ *BLANKS                                   S01117
     C                     MOVE 'Y'       @RUN    1                       S01117
     C                     DUMP                                           S01117
     C                     END                                            S01117
     C                     ENDSR                           ** *PSSR **    S01117
     C*                                                                   S01117
     C********************************************************************S01117
     C/EJECT                                                              S01117
0186 O** UPDATED YTD FILE                                                 LE0910
0187 O*                                                                   LE0910
0188 O*       HEADER                                                      LE0910
0189 O*                                                                   LE0910
0190 OUPYTDHH D        01                                                 LE0910
0191 O                                    1 'H'                           LE0910
0192 O*                                                                   LE0910
0193 O*       DETAIL FROM LEYTD                                           LE0910
0194 O*                                                                   LE0910
0195 OUPYTDYT D        03                                                 LE0910
0196 O**********               LOTA      80                         LE0910BHF773
0196 O**********               LOTA      87                                          BHF773 BUG23967
0196 O                         LOTA      90                                                 BUG23967
0197 O*                                                                   LE0910
0198 O*       DETAIL FROM MATLN                                           LE0910
0199 O*                                                                   LE0910
0200 O        D        04                                                 LE0910
0201 O                                    1 'D'                           LE0910
0202 O                         CNUMM      7                               LE0910
0203 O                         LNRFM     13                               LE0910
0204 O***********              BRCDM     16                               S01117
0204 O                         BRCAM     16                               S01117
0205 O                         CRSKM     18                               LE0910
0206 O                         LINDM     21                               LE0910
0207 O                         YPLCY     29P                              LE0910
0208 O                         YWLCY     37P                              LE0910
0209 O                         YFLCY     45P                              LE0910
0210 O                         ABLCY     53P                              LE0910
0211 O                         MDATM     56P                              LE0910
0212 O                                   57 '5'                           LE0910
0213 O                         PTYPM     59                               LE0910
0209 O                         CCYM      66                               E86114
0210 O                         TINT      73P                              E86114
0211 O                         YILN      80P                              E86114
     O****************         OLNO      84                         S01260BHF420
     O****************         RCSI      85                         S01260BHF420
     O                         OLNO      86                               BHF420
     O                         RCSI      87                               BHF420
     O                         LOIC      90                                                 BUG23967
0214 O*                                                                   LE0910
0215 O*       TRAILER                                                     LE0910
0216 OUPYTDZY T        LR                                                 LE0910
0217 O                                    1 'T'                           LE0910
0218 O                         TOTNOR     4P                              LE0910
0219 O* CONTROL REPORT                                                    LE0910
0220 O*                                                                   LE0910
0221 O*E0910P1T** 03   LR                                                 S01117
0221 OLE0910AUT   03   LR                                                 S01117
0222 O***********                        22 'REFERENCE LE0910'            S01117
0222 O                                   24 'REFERENCE LE0910AU'          S01117
0223 O                         TITL      89                               LE0910
0224 O                                  122 'DATE               PAGE'     LE0910
0225 O                         RUNA     112                               LE0910
0226 O                         PAGE  Z  127                               LE0910
0227 O        T 2      LR                                                 LE0910
0228 O                                   63 'UPDATE Y.T.D. FILE - FIL'    LE0910
0229 O                                   73 'E CONTROLS'                  LE0910
0230 O        T 12     LR                                                 LE0910
0231 O                                   63 '------------------------'    LE0910
0232 O                                   73 '----------'                  LE0910
0233 O        T 1      LR                                                 LE0910
0234 O                                   28 'S/LEYTD - RUN CONTROLS'      LE0910
0235 O                                   59 'NUMBER'                      LE0910
0236 O        T 1      LR                                                 LE0910
0237 O                                   28 '----------------------'      LE0910
0238 O                                   59 'OF RECORDS'                  LE0910
0239 O        T 2      LR                                                 LE0910
0240 O                                   29 'TOTAL RECORDS ON FILE'       LE0910
0241 O                      NU7NORE  3   59                               LE0910
0242 O        T 2      LR                                                 LE0910
0243 O                                   32 'TOTAL RECORDS ON FILE -C'    LE0910
0244 O                                   41 'ALCULATED'                   LE0910
0245 O                         PNOR  3   59                               LE0910
0246 O                       40         111 '**   DIFFERENCE   ***'       LE0910
0247 O* MATLN FILE                                                        LE0910
0248 O        T 3      LR                                                 LE0910
0249 O                                   28 'S/MATLN - RUN CONTROLS'      LE0910
0250 O        T 1      LR                                                 LE0910
0251 O                                   28 '----------------------'      LE0910
0252 O        T 2      LR                                                 LE0910
0253 O                                   29 'TOTAL RECORDS ON FILE'       LE0910
0254 O                      NU7NORES 3   59                               LE0910
0255 O        T 2      LR                                                 LE0910
0256 O                                   32 'TOTAL RECORDS ON FILE -C'    LE0910
0257 O                                   41 'ALCULATED'                   LE0910
0258 O                         SNOR  3   59                               LE0910
0259 O                    41            111 '***   DIFFERENCE   ***'      LE0910
0260 O* UPYTD FILE                                                        LE0910
0261 O        T 3      LR                                                 LE0910
0262 O                                   28 'S/UPYTD - RUN CONTROLS'      LE0910
0263 O        T 1      LR                                                 LE0910
0264 O                                   28 '----------------------'      LE0910
0265 O        T 23     LR                                                 LE0910
0266 O                                   29 'TOTAL RECORDS ON FILE'       LE0910
0267 O                         TOTNOR3   59                               LE0910
0268 O        T 3      LR U7 U8                                           LE0910
0269 O***********                        42 '*** REFERENCE'               S01117
0270 O***********              DBPGM     51                               S01117
0271 O***********                        71 '-DATABASE ERROR AT'          S01117
0272 O***********              DBASE     74                               S01117
     O                                   42 '*** REFERENCE'               S01117
     O                         DBPGM     51                               S01117
     O                                   71 '-DATABASE ERROR AT'          S01117
     O                         DBASE     75                               S01117
0273 O        T 23     LR U7 U8                                           LE0910
0274 O***********                        37 'FILENAME'                    S01117
0275 O***********              DBFILE    43                               S01117
0276 O***********                        48 'KEY'                         S01117
0277 O***********              DBKEY     78                               S01117
     O                                   39 'FILENAME'                    S01117
     O                         DBFILE    48                               S01117
     O                                   52 'KEY'                         S01117
     O                         DBKEY     82                               S01117
0278 O********T*3      LR                                                 LE0910
0279 O***********                        68 '***   END OF REPORT'         LE0910
0280 O***********                        74 '***'                         LE0910
** CPY@   **      OBJECT COPYRIGHT
(c) Finastra International Limited 2001
