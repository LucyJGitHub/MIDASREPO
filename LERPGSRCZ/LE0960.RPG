0001 H        1                                                           S01117
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas LE Extract Guarantees for Review')               *
0001 H**********                                                          S01117
0002 F********************************************************************
0003 F*                                                                  *
     F*  Midas  Customer Lending Module
0005 F*                                                                  *
0006 F*       LE0960 - GUARANTEES FOR REVIEW EXTRACT                     *
0007 F*                                                                  *
      *  (c) Misys International Banking Systems Ltd. 2001            *
     F*                                                               *
      *  Last Amend No. CLE134             Date 01Aug12               *
      *  Prev Amend No. CLE148             Date 23Jul12               *
      *                 AR759833           Date 27Jul12               *
      *                 CLE064             Date 06Dec10               *
      *                 CER059             Date 19Jul10               *
      *                 CER020             Date 19May08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CSD031             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 CLE042             Date 06Sep05               *
      *                 CSW037A            Date 02May05               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 CLE025             Date 20Oct03               *
      *                 CGL029             Date 01Sep03               *
      * Midas Release 4 --------------- Base -------------------------*
      *                 181864             Date 24Apr01               *
      * Midas DBA 3.05 -----------------------------------------------*
      *                 CLE011             Date 07Nov00               *
      * Midas DBA 3.02 -----------------------------------------------*
      *                 165426             Date 08Oct99               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 154799             Date 24Feb99               *
      *                 151295             Date 18Feb99               *
     F*                 116180             DATE 19MAY98               *
     F*                 123915             DATE 31OCT97               *
     F*                 080970             DATE 29DEC94               *
     F*                 S01392             DATE 05OCT92               *
     F*                       S01270               DATE  21MAR91         *
     F*                       S01220               DATE  15MAR91         *
0009 F*                       S01194               DATE 06FEB90          *
0009 F*                       S01195               DATE 09/08/89         *
0009 F*                       S01117               DATE 19/07/89         *
0009 F*                                                                  *
0009 F*------------------------------------------------------------------*
0009 F*                                                               *
      *  CLE134 - Past Due Call Loan Processing                       *
      *  CLE148 - Alpha Loan Reference                                *
      *  AR759833 - Component LEC10A 00008 failed because there are   *
      *             more than 100,000 records and the number of       *
      *             records being dropped is greater than the last 5  *
      *             digits of the 'Number or records before Update'.  *
      *             Amend program such that File out of balance would *
      *             not be encountered when there are more than       *
      *             100,000 records. Applied fix 248293.              *
      *             (Child: AR759834)                                 *
      *  CLE064 - Enhancement of Lending Frequencies (Recompile)      *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  CER020 - Enhanced Rollover Window: Upgrade FGE089 to         *
      *           Midas Plus                                          *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CLE042 - Extended Loan Sub Type                              *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  CLE025 - Credit Lines (Recompile)                            *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  181864 - Database error 004 occurred when a guarantor is     *
      *           deleted from the customer master file.  If the      *
      *           guarantor is deleted, continue processing.  If      *
      *           customer is not found, database error 004 should    *
      *           occur.                                              *
      *  CLE011 - Rate Fixing Days for Lending Rollover Processing    *
      *           Recompile                                           *
     F*  165426 - To include the dropping of deleted records from file*
     F*           GTEESGT. Also to count the deleted records when     *
     F*           calculating total number of records.                *
      *  154799 - Recompiled due to changes in /COPY,ZACCH            *
      *  151295 - Problems authorising repayment schedules            *
      *           Recompiled due to changes in ZCHKH                  *
     F*  116180 - Dealing with the occurrence of RVDT equalling zero. *
     F*  123915 - Need to include new CLE002 fields                   *
     F*        080970 - GUARANTY BRANCH NOT TAKEN                        *
     F*        S01392 - JAPANESE SUB MODULE ENHANCEMENTS                 *S01392
     F*        S01270 - CUSTOMER LENDING AMENDMENTS                      *S01270
     F*        S01220 - AMENDED FOR STRATEGIC RISK MANAGEMENT            *S01220
     F*                 RELEASE 10 TO ALLOW THE INPUT OF A BOOK          *S01220
     F*                 CODE AGAINST A LOAN.                             *S01220
     F*        S01194 - STANDING DATA CHANGES                            *S01194
     F*        S01195 - HOLIDAY AMENDMENT                                *
0009 F*        S01117 - MULTIBRANCHING                                   *
0009 F*                                                                  *
0012 F********************************************************************
     F*  C R E A T I O N     P A R A M E T E R S                      *
     F*                                                               *
     F*                                                               *
     F*****************************************************************
0013 F***GTEES   IP  F     128 15AI     2 DISK                            123915
0013 FGTEES   IP  F     159 15AI     2 DISK                               123915
0014 FFCLTY   IF  F     256 12AI     2 DISK
0015 F*CLINT***IF**F     256  7AI     2 DISK                              S01194
0016 F*CLOAN***IF**F*****400  7AI     2 DISK                              S01220
0016 F*CLOAN***IF**F     436  7AI     2 DISK                       S01220 CLE011
0016 F***CLOAN** IF  F    1310  7AI     2 DISK                                         CLE011 CGL029
     F*CLOAN   IF  F    1461  7AI     2 DISK                                           CGL029 CLE042
     F***CLOAN** IF  F    1773  7AI     2 DISK                                         CLE042 CER020
     F***CLOAN** IF  F    1782  7AI     2 DISK                                         CER020 CLE134
     FCLOAN   IF  F    1874  7AI     2 DISK                                                   CLE134
0017 F*ABLE***IF**F***   96 12AI     2 DISK                               S01194
0018 FGTEXTHH O   F     128            DISK
0018 FGTEXTGX O   F     128            DISK
0018 FGTEXTZZ O   F     128            DISK
0019 FGTUPDHH O   F     128            DISK
0019 F***GTUPDGT O   F     128            DISK                            123915
0019 FGTUPDGT O   F     159            DISK                               123915
0019 FGTUPDZZ O   F     128            DISK
0020 F*E0960P1O** F     132     OF     PRINTER                            S01124
0020 FLE0960AUO   F     132     OF     PRINTER                            S01117
0021 F* ID F  C  H  L    FUNCTION OF INDICATORS
0022 F* 01            GTEES HEADER
0023 F* 02            GTEES LIVE DETAIL
0024 F* 03            GTEES EXPIRED DETAIL
0025 F* 04            GTEES TRAILER
0026 F* 05            GTEES CATCHALL
0026 F* 06            GTEES DELETED DETAIL                                165426
0027 F* 09            CLOAN,FACILITY VALID DETAIL
0028 F**10**********  CLINT VALID DETAIL                                  S01194
0029 F*       20      FIRST CYCLE
0030 F*       21      EXCPT OUTPUT TO GTEXT
0031 F*       22      EXPIRY DATE DETAILS ON GTEXT
0032 F*       23      EXPIRY DATE REACHED
0033 F*       24      FACILITY BASED
0034 F*       25      EXPIRED WITHIN PREVIOUS 30 DAYS - RETAIN
0035 F*       26      FILE O/O/B 1
0036 F*       27      FILE O/O/B 2
0037 F*       28      FILE O/O/B 3
0038 F*    33         REVIEW DATE ZERO
0039 F*    34         REVIEW FREQUENCY BLANK
0040 F*       39      CHAIN FAIL INDICATOR
0041 F*       40      MULTIPLE USE
0042 F*       90-99   STANDARD SUBROUTINES
0043 F*       U7 U8   STANDARD MIDAS USAGE
     E/COPY ZSRSRC,ZFREQBZ1                                               S01392
     E/COPY ZSRSRC,ZDATE2Z1                                               S01392
     E                    CPY@    1   1 80
     E/COPY ZSRSRC,ZHOLE                                                  S01195
0050 I*
0051 I*    GUARANTEES/SECURITIES/COLLATERAL FILE
0052 I*
0053 IGTEES   NS  01   1 CH
0054 I                                        1   1 RECI
0055 I        NS  02   1 CD
0056 I       OR   03   1 CE
0056 I       OR   06   1 C*                                               165426
0057 I                                        1   1 RECI
0058 I**   FIELD NAME CHANGED FOR PROGRAM
0059 I**********                              2   70CNUMC                                     CSD027
0059 I                                        2   7 CNUMC                                     CSD027
0060 I                                        8  13 FCLN
0061 I**   FIELD NAME CHANGED FOR PROGRAM
0062 I                                        9  13 FCLNF
0063 I                                       14  160GUSN
0064 I                                    P  17  190STTD
0065 I                                    P  20  220EDDT
0066 I                                    P  23  250RVDT            33
0067 I                                       26  26 RVFR            34
0068 I                                       27  280RVDY
0069 I                                       29  31 CCY
0070 I                                    P  32  380UAMT
0071 I                                    P  39  410NOUN
0072 I                                    P  42  480TAMT
0073 I                                       49  83 NARR
0074 I                                       84  84 GSCI
0075 I                                       85  90 GBCN
0076 I                                       95  96 GCRK
0077 I                                       97  99 COLC
     I                                      109 111 BRCA                   80970
0078 I                                    P 112 1180STAM
0079 I                                    P 119 1210ORED
0080 I                                    P 122 1240LCD
0081 I                                      125 125 CHTP
0082 I                                    P 126 1280TNLU
0083 I**   RECORD REDEFINED FOR PROGRAM
0084 I****                                    1 128 RECORD                123915
0084 I                                        1 159 RECORD                123915
0085 I*
0086 I*    GUARANTEES/SECURITIES/COLLATERAL FILE - TRAILER
0087 I*
0088 I        NS  04   1 CT
0089 I                                        1   1 RECI
0090 I**********                              2   70CNUM                                      CSD027
0090 I                                        2   7 CNUM                                      CSD027
0091 I                                        8  13 FCLN
0092 I                                       14  160GUSN
0093 I                                    P  17  190NORE
0094 I                                    P  20  220FLSZ
0095 I                                    P  23  250NLRB
0096 I                                    P  26  280NINS
0097 I                                    P  29  310NDEL
0098 I                                    P  32  340NLRA
0099 I                                    P  35  420VLBF
0100 I                                    P  43  440VLBL
0101 I                                    P  45  520VRIF
0102 I                                    P  53  540VRIL
0103 I                                    P  55  620VRDF
0104 I                                    P  63  640VRDL
0105 I                                    P  65  720VRAF
0106 I                                    P  73  740VRAL
0107 I                                    P  75  820VLAF
0108 I                                    P  83  840VLAL
0109 I                                    P 122 1240LCD
0110 I                                      125 125 CHTP
0111 I                                    P 126 1280TNLU
0112 I**   RECORD REDEFINED FOR PROGRAM
0113 I                                        1 128 TRALER
0114 I        NS  05
0115 I**************                                                      S01194
0116 I*****CLIENT*FILE - CUSTOMER STANDING DATA RECORD.                   S01194
0117 I**************                                                      S01194
0118 I*CLINT***NS**10   1 CD   8 CA                                       S01194
0119 I**************                          1   1 RECI                  S01194
0120 I**************                          2   70CNUM                  S01194
0121 I**************                          9  28 CRNM                  S01194
0122 I**************                         29  38 CTWN                  S01194
0123 I**************                         39  48 CSNM                  S01194
0124 I**************                         49  56 CASK                  S01194
0125 I**************                         57  68 TELX                  S01194
0126 I**************                         69  80 CSID                  S01194
0127 I**************                         81  82 ACOC                  S01194
0128 I**************                         83  83 CBSI                  S01194
0129 I**************                         84  85 CCTZ                  S01194
0130 I**************                         86  87 CLOC                  S01194
0131 I**************                         88  930CPAR                  S01194
0132 I*****FIELD*NAME CHANGED FOR PROGRAM                                 S01194
0133 I***********                            94  960BRCDC                 S01194
0134 I**************                         97  980LINS                  S01194
0135 I**************                         99 1010LIND                  S01194
0136 I**************                      P 102 1040DASU                  S01194
0137 I**************                      P 105 1070CDIC                  S01194
0138 I**************                      P 108 1100DADE                  S01194
0139 I**************                        111 111 CMIN                  S01194
0140 I**************                        112 112 CTYP                  S01194
0141 I**************                        113 124 TELF                  S01194
0142 I**************                        125 133 CHID                  S01194
0143 I****CLINT*FILE - CATCHALL                                           S01194
0144 I**************                                                      S01194
0145 I********NS****                                                      S01194
0146 I*
0147 I*    CUSTOMER LENDING LOANS FILE - DETAIL RECORD 1
0148 I*
0149 ICLOAN   NS  09   1 CD   8 CA
0150 I       OR   09   1 CM   8 CA
0151 I                                        1   1 RECI
0152 I                                        2   7 LNRF
0153 I                                        8   8 RCDT
0154 I                                        9   90MRIN
0155 I                                       10  110PTYP
0156 I**   FIELD NAME CHANGED FOR PROGRAM
0157 I**********                             12  170CNUML                                     CSD027
0157 I                                       12  17 CNUML                                     CSD027
0158 I***********                            18  200BRCD                  S01117
0158 I                                       18  20 BRCA                  S01117
0159 I                                       21  22 LTYP
0160 I                                       23  24 SUTP
0161 I                                    P  25  270DDAT
0162 I                                    P  28  300VDAT
0163 I                                    P  31  330MDAT
0164 I                                       34  350LASQ
0165 I**********                             36  410FCUS                                      CSD027
0165 I                                       36  41 FCUS                                      CSD027
0166 I                                       42  440FTYP
0167 I                                       45  460FSEQ
0168 I                                       47  49 CCYL
0169 I                                    P  50  560CPAM
0170 I                                       57  57 INTC
0171 I                                    P  58  637INTR
0172 I                                       64  650BRTT
0173 I                                    P  66  717BRTE
0174 I                                    P  72  777RTSP
0175 I                                    P  78  815MARG
0176 I                                       82  82 SPIN
0177 I                                       83  83 CHIN
0178 I                                    P  84  897WTRT
0179 I                                       90  90 WTIN
0180 I                                       91  910REPT
0181 I                                    P  92  980RAMT
0182 I                                    P  99 1010NRPD
0183 I                                      102 102 RFRQ
0184 I                                      103 1040RDYN
0185 I                                      105 107 FCCY
0186 I                                      108 1100LIND
0187 I                                      111 112 CRSK
0188 I                                      113 114 ACOF
0189 I                                      115 115 NACD
0190 I                                      116 116 RELI
0191 I                                      117 117 AUTO
0192 I                                    P 118 1240PSAM
0193 I                                    P 125 1318BCXR
0194 I                                    P 132 1388FCXR
0195 I                                      139 1400SDST
0196 I**********                            141 152 OSDA                                      CGL029
     I                                      141 152 QQOSDA                                    CGL029
0197 I                                      153 162 TSTN
0198 I                                      163 1640MDST
0199 I**********                            165 176 OMDA                                      CGL029
     I                                      165 176 QQOMDA                                    CGL029
0200 I                                      177 186 TMAN
0201 I                                      187 196 FACO
0202 I                                    P 197 1990RLDT
0203 I                                    P 200 2020NROD
0204 I                                      203 203 RLFQ
0205 I                                      204 2050RLDY
0206 I                                      207 2080NBRA
0207 I                                    P 209 2147NRTS
0208 I                                      215 215 NSIN
0209 I                                      216 2160NCAC
0210 I                                    P 217 2230AWTP
0211 I                                    P 224 2300WTRD
0212 I                                    P 231 2370WTWD
0213 I                                    P 238 2440IWOD
0214 I                                    P 245 2510PWOD
0215 I                                      252 252 BMDI
0216 I                                      253 253 FMDI
0217 I                                    P 254 2600PDIN
0218 I                                      287 287 BTIN
0219 I                                      288 2890BLDY
0220 I***********                           290 2950OLNO                  CSD027
     I                                      290 295 OLNO                  CSD027
0221 I                                      296 296 RCSI
0222 I                                      297 2970ICBS
0223 I                                      298 298 IPFR
0224 I                                    P 299 3050TOTI
0225 I                                    P 306 3080NIDT
0226 I                                    P 309 3110IBDT
0227 I                                    P 312 3140SLID
0228 I                                    P 315 3210AIPD
0229 I                                    P 322 3240DLRC
0230 I                                    P 325 3270IACD
0231 I                                    P 328 3340AITC
0232 I                                    P 335 3410TFEP
0233 I                                    P 342 3480AIAP
0234 I                                    P 349 3550IPRD
0235 I                                    P 356 3620IPRM
0236 I                                    P 363 3690ICTD
0237 I                                    P 370 3760AIMN
0238 I                                    P 377 3790RBDT
0239 I                                      384 3850IFDY
0240 I                                      386 386 LONI
0241 I                                      387 387 CNFI
0242 I                                      388 388 ACEI
0243 I                                      389 389 TLXI
0244 I                                      390 390 CBLI
0245 I                                    P 391 3930ORED
0246 I                                    P 394 3960LCD
0247 I                                      397 397 CHTP
0248 I                                    P 398 4000TNLU
     I                                      435 436 BOKC                  S01220
     I*************************************13901407 OSDA                               CGL029 CLE042
     I*************************************14081425 OMDA                               CGL029 CLE042
     I                                     15611578 OSDA                                      CLE042
     I                                     15791596 OMDA                                      CLE042
     I                                     17621765 CLAS                                      CLE042
     I                                     17801782 LOIC                                      CER020
      *                                                                                       CLE134
     I                                     18301830 FAMU                                      CLE134
     I                                     18311831 FPNR                                      CLE134
     I                                    P183218340RIDT                                      CLE134
     I                                    P183518360RIDC                                      CLE134
     I                                     183718370RCAT                                      CLE134
     I                                    P183818390RCAC                                      CLE134
     I                                    P184018420RCSD                                      CLE134
     I                                    P184318440RCDY                                      CLE134
     I                                    P184518460RCCY                                      CLE134
      *                                                                                       CLE134
     I                                    P184718490BIDT                                      CLE134
     I                                    P185018510BIDC                                      CLE134
     I                                     185218520BCAT                                      CLE134
     I                                    P185318540BCAC                                      CLE134
     I                                    P185518570BCSD                                      CLE134
     I                                    P185818590BCDY                                      CLE134
     I                                    P186018610BICC                                      CLE134
      *                                                                                       CLE134
     I                                     18621864 XRFI                                      CLE134
     I                                     186518740XRFN                                      CLE134
      *                                                                                       CLE134
0249 I        NS
0250 I*
0251 I*    FACILITY FILE - DETAIL 1
0252 I*    SEVERAL FIELDS SUFFIXED WITH F FOR PROGRAM
0253 I*
0254 IFCLTY   NS  09   1 CD  13 CA
0255 I       OR   09   1 CE  13 CA
0256 I       OR   09   1 CC  13 CA
0257 I                                        1   1 RECI
0258 I**********                              2   70CNUMF                                     CSD027
0258 I                                        2   7 CNUMF                                     CSD027
0259 I                                        8  10 FACT
0260 I                                       11  12 FCNO
0261 I                                       13  13 RCTP
0262 I***********                            14  160BRCD                  S01117
0262 I                                       14  16 BRCA                  S01117
0263 I                                       17  17 FCTI
0264 I                                       18  20 FCCY
0265 I                                    P  21  270FAMT
0266 I                                    P  28  300OVPC
0267 I                                    P  31  330DTAP
0268 I                                    P  34  360DTEX
0269 I                                       37  37 RVCR
0270 I                                       38  38 SECI
0271 I                                       39  39 MCCY
0272 I                                       40  40 MCSI
0273 I                                       41  41 NACD
0274 I                                       42  43 CRSK
0275 I                                    P  44  460DLFS
0276 I                                    P  47  527NOMR
0277 I                                    P  53  550RVDTF
0278 I                                       56  56 RVFRF
0279 I                                       57  580RVDYF
0280 I                                       59  93 NAR1
0281 I                                       94 178 NAR2
0282 I                                      129 163 NAR3
0283 I                                      164 198 NAR4
0284 I                                    P 199 2050MTDH
0285 I                                    P 206 2120MTDL
0286 I                                    P 213 2190MTDA
0287 I                                    P 220 2270QTDA
0288 I                                    P 228 2350YTDA
0289 I                                      236 237 ACOF
     I                                    P 242 2440RVCD                  S01270
0290 I                                    P 247 2490ORED
0291 I                                    P 250 2520LCD
0292 I                                      253 253 CHTP
0293 I                                    P 254 2560TNLU
0294 I        NS
0295 I**************                                                      S01194
0296 I*****TABLE*FILE - INSTALLATION CONTROL DATA RECORD 1.               S01194
0297 I**************                                                      S01194
0298 I*TABLE***NS***    2 C0   3 C1  12 C1                                S01194
0299 I*******AND****  13 C0                                               S01194
0300 I**************                          1   1 RECI                  S01194
0301 I**************                         12  130RCDE                  S01194
0302 I**************                         14  66 TITL                  S01194
0303 I**************                         67  67 DATF                  S01194
0304 I***********                            68  700DFBR                  S01194
0305 I**************                         74  74 MODI1                 S01194
0306 I**************                         75  75 MODI2                 S01194
0307 I**************                         76  76 MODI3                 S01194
0308 I**************                      P  77  790RUND                  S01194
0309 I**************                         80  86 RUNA                  S01194
0310 I**************                         87  870SFLG                  S01194
0311 I**************                                                      S01194
0312 I*****TABLE*FILE - INSTALLATION CONTROL DATA RECORD 2.               S01194
0313 I**************                                                      S01194
0314 I*TABLE***NS***    1 CD   2 C0   3 C1                                S01194
0315 I*******AND****  12 C1  13 C1                                        S01194
0316 I**************                          1   1 RECI                  S01194
0317 I**************                          2   30RECT                  S01194
0318 I**************                         12  130RCDE                  S01194
0319 I**************                         14  16 BCCY                  S01194
0320 I**************                         17  19 BCYL                  S01194
0321 I**************                         20  22 HOCY                  S01194
0322 I**************                         23  280HEAD                  S01194
0323 I**************                      P  29  310APDA                  S01194
0324 I**************                         35  35 APFQ                  S01194
0325 I**************                      P  36  380LOGS                  S01194
0326 I**************                         39  40 CUZR                  S01194
0327 I**************                      P  41  430DNWD                  S01194
0328 I**************                         44  460BVLP                  S01194
0329 I**********                             47  49 LOCY                  S01195
0330 I**************                         50  510FDAY                  S01194
0331 I**************                         52  52 ACLD                  S01194
0332 I**************                         53  53 MBIN                  S01194
0333 I**************                         86  86 ISAV                  S01194
0334 I**************                      P  87  890LLOG                  S01194
0335 I**************                      P  90  920LCD                   S01194
0336 I**************                         93  93 CHTP                  S01194
0337 I**************                      P  94  960TNLU                  S01194
0338 I*****TABLE*FILE*-*HOLIDAY*RECORD.***                                S01195
0339 I********E-EXCLUDE,*I-INCLUDE.*******                                S01195
0340 I**********                                                          S01195
0341 I*ABLE***NS       1 CD   2 C2   3 C2                                 S01195
0342 I*******AND      14 CE                                               S01195
0343 I*******OR        1 CD   2 C2   3 C2                                 S01195
0344 I*******AND      14 CI                                               S01195
0345 I**********                              1   1 RECI                  S01195
0346 I**********                              2   30RECT                  S01195
0347 I**********                              8  120HOL                   S01195
0348 I**********                             13  130SREC                  S01195
0349 I**********                             14  14 INEX                  S01195
0350 I**********                             15  89 HCCY                  S01195
0351 I**********                          P  90  920LCD                   S01195
0352 I**********                             93  93 CHTP                  S01195
0353 I**********                          P  94  960TNLU                  S01195
0354 I********NS****                                                      S01194
0355 I**************                          1   1 RECI                  S01194
0356 I**
0357 I**   DATA STRUCTURES
0358 I**
0359 I**   KEY TO FCLTY
0360 I            DS
0361 I                                        1  12 FCKEY
0362 I**********                              1   60CNUMC                                     CSD027
0362 I                                        1   6 CNUMC                                     CSD027
0363 I                                        7  11 FCLNF
     ISDBANK    E DSSDBANKPD                                              S01195
     I** EXTERNAL DS FOR BANK DETAILS                                     S01195
     I**                                                                  S01195
     I              BJLCCY                          LOCY                  S01194
     I              BJSLCD                          SYSL                  S01194
     I              BJDFIN                          DATF                  S01194
     I              BJMRDT                          RUNA                  S01194
     I              BJRDNB                          RUND                  S01194
     I              BJURPT                          TITL                  S01194
     ISDCUST    E DSSDCUSTPD                                              S01194
     I** EXTERNAL DS FOR CUSTOMER DETAILS                                 S01194
     I              BBCRNM                          CRNM                  S01194
     ISDGELR    E DSSDGELRPD                                              S01194
     I** EXTERNAL DS FOR GENERAL LEDGER                                   S01194
     I*****         BKAPDT                          APDA                  S01194
     I*                                                                   S01194
     IDSFDY     E DSDSFDY                                                 S01194
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01194
     I*                                                                   S01194
     IDSSDY     E DSDSSDY                                                 S01194
     I* SECOND DS FOR ACCESS PROGRAMS, LONG DATA STRUCTURE                S01194
     I*                                                                   S01194
0364 I**   LOCAL DATA AREA FOR DATABASE ERROR IDENTIFICATION
0365 ILDA        UDS                            256
0647 I***********                           134 138 DBFILE                S01117
0648 I***********                           139 167 DBKEY                 S01117
0649 I***********                           168 175 DBPGM                 S01117
0650 I***********                           176 1770DBASE                 S01117
0647 I                                      134 141 DBFILE                S01117
0648 I                                      142 170 DBKEY                 S01117
0649 I                                      171 180 DBPGM                 S01117
0650 I                                      181 1830DBASE                 S01117
     I**                                                                  S01195
     I/COPY ZSRSRC,ZHOLI                                                  S01195
     C                     MOVEACPY@      BIS@   80
0370 C   20                GOTO ENDFC
0371 C                     SETON                     20
     C           *NAMVAR   DEFN           LDA                             S01117
     C           *LOCK     IN   LDA                                       S01117
0372 C**
0373 C**   FIRST CYCLE PROCESSING
0374 C**
0375 C**************       EXSR ZSYSTM                                    S01194
0376 C***99*********       SETON                     LRU7U8               S01194
0377 C***99*********       Z-ADD1         DBASE            DBASE 1        S01194
0378 C***99*********       MOVE 'TABLE'   DBFILE                          S01194
0379 C***99*********       MOVELZTABKY    DBKEY                           S01194
0380 C***99*********       GOTO END                                       S01194
     C**                                                                  S01195
     C**   ACCESS BANK DETAILS FOR SYSTEM LOCATION CODE                   S01195
     C**                                                                  S01195
     C                     CALL 'AOBANKR0'                                S01195
     C                     PARM '*MSG   ' @RTCD   7                       S01195
     C                     PARM '*FIRST ' @OPTN   7                       S01195
     C           SDBANK    PARM SDBANK    DSFDY                           S01195
     C*                                                                   S01195
     C           @RTCD     IFNE *BLANKS                                   S01195
     C                     SETON                     U7U8LR               S01195
     C                     MOVEL'SDBANKPD'DBFILE                          S01195
     C                     MOVEL@OPTN     DBKEY            ************** S01195
     C                     MOVEL@OPTN     DBOPTN  7        *** DB  01 *** S01195
     C                     Z-ADD1         DBASE            ************** S01195
     C                     EXSR *PSSR                                     S01195
     C                     GOTO END                                       S01195
     C                     END                                            S01195
     C**   CHECK SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.                    S01194
     C           DATF      COMP 'M'                      98MMDDYY, 98 ON  S01194
0381 C**
0382 C           RUND      ADD  90        RN90    50
0383 C           RUND      SUB  30        RN30    50
0384 C**
0385 C                     Z-ADD0         NEXP    50
0386 C                     Z-ADD0         NEXPF  150
0387 C                     Z-ADD0         NEXPL   30
0388 C                     MOVE 'A'       FCKEY
0389 C                     MOVE 'A'       CLOKEY  7
0390 C                     MOVE 'A'       CLIKEY  7
0391 C                     Z-ADD2         GTXREC  50
0392 C                     Z-ADD0         GTXF   150
0393 C                     Z-ADD0         GTXL    30
0394 C                     Z-ADD2         COUNT   50
0395 C                     Z-ADD0         DROP    50
0396 C                     Z-ADD0         TOTREC  50
0397 C                     Z-ADD0         LIVE    50
0398 C                     Z-ADD0         LIVEF  150
0399 C                     Z-ADD0         LIVEL   30
0400 C                     Z-ADD0         POUT   130
0401 C           ENDFC     TAG                             ** ENDFC TAG **
0402 C                     SETOF                     23
0403 C**N05******TOTREC    ADD  1         TOTREC                          165426
0403 C           TOTREC    ADD  1         TOTREC                          165426
0404 C   02                EXSR QLIVE
0405 C   03                EXSR EXPRD
     C   06                EXSR DELET                                     165426
0406 C   04                EXSR TRAIL
0407 C           END       TAG                             ** END TAG ****
0408 C   U7                MOVE 'LE0960'  DBPGM
     CLR U7 U8             EXSR *PSSR                                     S01117
0409 C********************************************************************
0410 C*                                                                  *
0411 C*   QLIVE SR. TO PROCESS LIVE RECORDS                              *
0412 C*                                                                  *
0413 C           QLIVE     BEGSR                           ** QLIVE BEGSR*
0414 C**
0415 C**   CHECK FOR UPDATE OF REVIEW DATE
0416 C**
0417 C   34                GOTO NOREV
     C           RVDT      IFEQ 0                                         116180
     C                     GOTO NOREV                                     116180
     C                     ENDIF                                          116180
0418 C           RVDT      COMP RUND                   4040
0419 C  N40                GOTO NOREV
0420 C                     Z-ADDRVDT      ZDAYNO
0421 C                     MOVE RVFR      ZFREQ
0422 C**********           MOVE CCY       ZCCY                            S01195
0422 C                     MOVE LOCY      ZCCY                            S01195
0423 C                     MOVE RVDY      ZMDAY
     C                     MOVE SYSL      ZLOC                            S01195
0424 C           UPDFQ     TAG                             ** UPDFQ TAG **
0425 C**********           EXSR ZFREQB                                    S01195
0425 C*****                EXSR FREQB                                     S01392
0425 C                     EXSR ZFREQB                                    S01392
0426 C           ZDAYNO    COMP RUND                   4040
0427 C   40                GOTO UPDFQ
0428 C**
0429 C           EDDT      COMP ZDAYNO                 4040
0430 C  N40                Z-ADDZDAYNO    RVDT
0431 C           NOREV     TAG                             ** NOREV TAG **
0432 C**
0433 C**   CHECK FOR OUTPUT TO GTEXT
0434 C**
0435 C  N33      RVDT      COMP RUND                 40  40
0436 C  N33 40   RVDT      COMP RN90                   2121
0437 C   21                EXSR GETDET
0438 C   U7                GOTO LEND
0439 C   21                EXCPT
0440 C                     SETOF                     21
0441 C           EDDT      COMP RN90                   2222
0442 C   22                SETON                     21
0443 C   21                EXSR GETDET
0444 C   U7                GOTO LEND
0445 C   21                EXCPT
0446 C                     SETOF                     2122
0447 C**
0448 C**   CHECK FOR EXPIRY
0449 C**
0450 C           EDDT      COMP RUND                   2323
0451 C   23      NEXP      ADD  1         NEXP
0452 C   23                Z-ADDNEXPF     ZZTOTI
0453 C   23                Z-ADDNEXPL     ZZTOTD
0454 C   23                MOVE UAMT      ZZAMT
0455 C   23                EXSR GLZADD
0456 C   23                Z-ADDZZTOTI    NEXPF
0457 C   23                Z-ADDZZTOTD    NEXPL
0458 C**
0459 C**   MAINTAIN HASH TOTAL OF LIVE RECORDS OUTPUT TO GTUPD
0460 C**
0461 C  N23      LIVE      ADD  1         LIVE
0462 C  N23                Z-ADDLIVEF     ZZTOTI
0463 C  N23                Z-ADDLIVEL     ZZTOTD
0464 C  N23                MOVE UAMT      ZZAMT
0465 C  N23                EXSR GLZADD
0466 C  N23                Z-ADDZZTOTI    LIVEF
0467 C  N23                Z-ADDZZTOTD    LIVEL
0468 C**
0469 C           COUNT     ADD  1         COUNT
0470 C**
0471 C           LEND      ENDSR
0472 C*                                                                  *
0473 C********************************************************************
0474 C********************************************************************
0475 C*                                                                  *
0476 C*    GETDET SR. TO OBTAIN DETAILS FOR EXTRACT AND DO               *
0477 C*    HASH TOTALLING                                                *
0478 C*
0479 C           GETDET    BEGSR                           ** GETDET BEGSR
0480 C**
0481 C**   ASCERTAIN WHETHER LOAN OR FACILITY BASED
0482 C**
0483 C                     MOVELFCLN      F       1
0484 C********** F         COMP 'F'                      24                                   CLE148
     C           F         COMP ' '                      24                                   CLE148
0485 C   24                GOTO FCHN
0486 C**   LOAN BASED
0487 C                     MOVELFCLN      CLOKEY
0488 C                     SETOF                     0939
0489 C           CLOKEY    CHAINCLOAN                39
0490 C**
0491 C                     GOTO LCHN
0492 C           FCHN      TAG                             ** FCHN TAG ***
0493 C**   FACILITY BASED
0494 C                     SETOF                     0939
0495 C           FCKEY     CHAINFCLTY                39
0496 C**
0497 C           LCHN      TAG                             ** LCHN TAG ***
0498 C**
0499 C**   CHAIN TO CLINT FOR GUARANTORS NAME
0500 C**
0501 C**************       MOVELGBCN      CLIKEY                          S01194
0502 C**************       SETOF                     1039                 S01194
0503 C***********CLIKEY    CHAINCLINT                39                   S01194
     C                     MOVELGBCN      CKEY                            S01194
     C                     CALL 'AOCUSTR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C                     PARM           CKEY   10                       S01194
     C                     PARM '*CNUM'   KEYSTS  7                       S01194
     C           SDCUST    PARM SDCUST    DSSDY                           S01194
0504 C**N10*********       SETON                     LRU7U8               S01194
0505 C**N10*********       MOVE 'CLINT'   DBFILE                          S01194
0506 C**N10*********       Z-ADD4         DBASE            DBASE 4        S01194
0507 C**N10*********       MOVELCLIKEY    DBKEY                           S01194
0508 C**N10*********       GOTO GETEND                                    S01194
     C           @RTCD     IFNE *BLANKS                                   S01194
     C           @RTCD     IFNE '*NRF'                                    181864
     C           BBDTDL    OREQ 0                                         181864
     C                     SETON                     LRU7U8               S01194
     C                     Z-ADD4         DBASE                           S01194
     C                     MOVEL'SDCUSTPD'DBFILE                          S01194
     C                     MOVELCKEY      DBKEY                           S01194
     C                     GOTO GETEND                                    S01194
     C                     ENDIF                                          181864
     C                     END                                            S01194
0509 C**
0510 C**   PERFORM HASH TOTALLING
0511 C**
0512 C           GTXREC    ADD  1         GTXREC
0513 C                     Z-ADDGTXF      ZZTOTI
0514 C                     Z-ADDGTXL      ZZTOTD
0515 C                     MOVE TAMT      ZZAMT
0516 C                     EXSR GLZADD
0517 C                     Z-ADDZZTOTI    GTXF
0518 C                     Z-ADDZZTOTD    GTXL
0519 C**
0520 C           GETEND    ENDSR                           ** GETEND ENDSR
0521 C*                                                                  *
0522 C********************************************************************
0523 C********************************************************************
0524 C*                                                                  *
0525 C*    EXPRD SR. TO PROCESS EXPIRED RECORDS                          *
0526 C*                                                                  *
0527 C           EXPRD     BEGSR                           ** EXPRD BEGSR
0528 C**
0529 C           EDDT      COMP RN30                 25  25
0530 C  N25      DROP      ADD  1         DROP
0531 C   25      COUNT     ADD  1         COUNT
0532 C                     ENDSR
0533 C*                                                                  *
0534 C********************************************************************
0523 C********************************************************************165426
0524 C*                                                                  *165426
0525 C*    DELET SR. TO PROCESS DELETED RECORDS                          *165426
0526 C*                                                                  *165426
0527 C           DELET     BEGSR                           ** DELET BEGSR 165426
0528 C**                                                                  165426
     C           *IN06     IFEQ *ON                                       165426
0530 C           DROP      ADD  1         DROP                            165426
     C                     ENDIF                                          165426
0532 C                     ENDSR                                          165426
0533 C*                                                                  *165426
0534 C********************************************************************165426
0535 C********************************************************************
0536 C*                                                                  *
0537 C*    TRAIL SR. TO PROCESS THE TRAILER                              *
0538 C*                                                                  *
0539 C           TRAIL     BEGSR                           ** TRAIL BEGSR
0540 C**
0541 C**   COMPARE HASH TOTALS
0542 C**
0543 C           NORE      COMP TOTREC               2626
0544 C   26                SETON                     U8
0545 C**
0546 C           NLRA      SUB  NEXP      WK05    50
      *                                                                                     AR759833
     C           WK05      IFLT 0                                                           AR759833
     C                     ADD  100000    WK05                                              AR759833
     C                     ENDIF                                                            AR759833
      *                                                                                     AR759833
0547 C           WK05      COMP LIVE                 2727
0548 C**
0549 C                     Z-ADDVLAF      ZZTOTI
0550 C                     Z-ADDVLAL      ZZTOTD
0551 C                     Z-SUBNEXPF     ZZAMTI
0552 C                     Z-SUBNEXPL     ZZAMTD
0553 C                     EXSR GLZSUM
0554 C  N27      ZZTOTI    COMP LIVEF                2727
0555 C  N27      ZZTOTD    COMP LIVEL                2727
0556 C   27                SETON                     U8
0557 C**
0558 C           NORE      SUB  DROP      WK05
      *                                                                                     AR759833
     C           WK05      IFLT 0                                                           AR759833
     C                     ADD  100000    WK05                                              AR759833
     C                     ENDIF                                                            AR759833
      *                                                                                     AR759833
0559 C           WK05      COMP COUNT                2828
0560 C   28                SETON                     U8
0561 C**
0562 C                     ENDSR
0563 C*
0564 C********************************************************************
0565 C********************************************************************
0566 C* SUBROUTINE TO ADD AN AMOUNT (ZZAMT) TO THE TOTAL (ZZTOTI,ZZTOTD)
0567 C*   IND '99' IS SET BY AN OVERFLOW ERROR
0568 C*
0569 CSR         GLZADD    BEGSR                           *** GLZADD ****
0570 C*
0571 CSR                   Z-ADDZZAMT     ZZAMT  153     91-DEFINE ZZAMT
0572 CSR 91                GOTO ZZAEND                     AMT = 0.BYPASS
0573 C*
0574 C* SPLIT ZZAMT INTO INTEGER AND DECIMAL FIELDS
0575 CSR                   Z-ADDZZAMT     ZZAMTI 150       INTEGER FIELD
0576 CSR                   MOVE ZZAMT     ZZAMTD  30       DECIMAL FIELD
0577 C* BOTH ZZAMTI AND ZZAMTD CONTAIN A 'SIGN' ZONE NOW
0578 C*
0579 CSR                   EXSR GLZSUM
0580 CSR         ZZAEND    ENDSR                           ** ZZAEND TAG *
0581 C*
0582 C********************************************************************
0583 C********************************************************************
0584 C* SUBROUTINE TO CARRY OUT THE ADDITION FOR SUBROUTINES -
0585 C*                        GLZADD, GLZSUB, GLZCMP.
0586 C*          PARAMETERS PASSED -
0587 C*                     I/P ZZAMTI ZZAMTD
0588 C*                     O/P ZZTOTI ZZTOTD ZZNEGD IND 96 IND 99.
0589 C*
0590 CSR         GLZSUM    BEGSR                           *** GLZSUM ****
0591 C*
0592 CSR                   Z-ADDZZTOTI    ZZTOTI 150       DEFINE ZZTOTI
0593 CSR                   Z-ADDZZTOTD    ZZTOTD  30       DEFINE ZZTOTD
0594 CSR                   SETOF                     919293
0595 CSR                   SETOF                     949599
0596 C*
0597 C*    DETERMINE SIGN OF ZZAMTI & D,   92 IF NEG
0598 CSR         ZZAMTI    COMP 0                      9293
0599 CSR 93      ZZAMTD    COMP 0                      9293
0600 CSR 93                GOTO ZZSEND                     ZERO BYPASS
0601 C*
0602 C*    DETERMINE SIGN OF ZZTOTI & D, 91 IF NEG.
0603 CSR         ZZTOTI    COMP 0                      9193
0604 CSR 93      ZZTOTD    COMP 0                      9193
0605 C*
0606 C*    IF ZZTOTAL IS ZERO, RETURN ZZAMOUNT.
0607 CSR 93                Z-ADDZZAMTI    ZZTOTI
0608 CSR 93                Z-ADDZZAMTD    ZZTOTD
0609 CSR 93                GOTO ZZSEND                     ZERO BYPASS
0610 C*    IF SIGNS DIFFER BYPASS OVERFLOW CHECKS.
0611 CSR 91N92
0612 CORN91 92             GOTO ZZOFPS
0613 C*
0614 CSR         ZZAMTD    ADD  ZZTOTD    ZZWK2   40
0615 CSR         ZZWK2     COMP 999                  93    '93' = CARRY
0616 CSRN93      ZZWK2     COMP -999                   93    INTO INTEGER.
0617 C*
0618 CSR 93N92   ZZAMTI    ADD  1         ZZWK3  150       ADD 'CARRY' +VE
0619 CSR    93 92ZZAMTI    SUB  1         ZZWK3            SUB 'CARRY' -VE
0620 CSR 93      ZZTOTI    ADD  ZZWK3     ZZWK3
0621 CSRN93      ZZTOTI    ADD  ZZAMTI    ZZWK3
0622 C*
0623 C* IF THE MODULUS OF ZZWK3 IS LT MOD. ZZTOTI THEN O/F HAS OCCURED
0624 CSRN92      ZZWK3     COMP ZZTOTI                 99  -92 MEANS NOS.
0625 CSR 92      ZZWK3     COMP ZZTOTI               99     NEGATIVE
0626 CSRN99                Z-ADDZZWK2     ZZTOTD
0627 CSRN99                Z-ADDZZWK3     ZZTOTI
0628 C*
0629 C* IF O/F ZEROIZE ZZAMT , IND '99' SET AND ZZTOT FIELDS LEFT INTACT.
0630 CSR 99                Z-ADD0         ZZAMT  153
0631 CSR                   GOTO ZZSEND
0632 C*
0633 C* THE 'SIGNS' ARE DIFFERENT
0634 CSR         ZZOFPS    TAG                             ** ZZOFPS TAG**
0635 C* IF ZZAMT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZTOT
0636 C*
0637 CSR 92                Z-SUBZZAMTI    ZZAMTI 150
0638 CSR 92                Z-SUBZZAMTD    ZZAMTD  30
0639 C*
0640 C* IF ZZTOT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZAMT.
0641 C*
0642 CSR 91                Z-SUBZZTOTI    ZZTOTI
0643 CSR 91                Z-SUBZZTOTD    ZZTOTD
0644 C* BOTH ZZAMT AND ZZTOT ARE NOW POSITIVE.
0645 C*
0646 CSR         ZZTOTI    COMP ZZAMTI               93  95
0647 CSR 95      ZZTOTD    COMP ZZAMTD               93  95
0648 C*
0649 C* IF ZZTOT EQ. ZZAMT RETURN ZERO.
0650 CSR 95                Z-ADD0         ZZTOTI
0651 CSR 95                Z-ADD0         ZZTOTD
0652 CSR 95                GOTO ZZSEND
0653 C*
0654 C* IF ZZTOT GT. ZZAMT.
0655 CSR 93      ZZAMTD    COMP ZZTOTD               94
0656 CSR 93 94   ZZTOTI    SUB  1         ZZTOTI
0657 CSR 93 94   ZZTOTD    ADD  1000      ZZWK2
0658 CSR 93      ZZTOTI    SUB  ZZAMTI    ZZTOTI
0659 CSR 93 94   ZZWK2     SUB  ZZAMTD    ZZTOTD
0660 CSR 93N94   ZZTOTD    SUB  ZZAMTD    ZZTOTD
0661 C*
0662 C*
0663 C* IF ZZAMT GT. ZZTOT.
0664 CSRN93      ZZTOTD    COMP ZZAMTD               94
0665 CSRN93 94   ZZAMTI    SUB  1         ZZWK3  150
0666 CSRN93 94   ZZAMTD    ADD  1000      ZZWK2
0667 CSRN93 94   ZZWK3     SUB  ZZTOTI    ZZTOTI
0668 CSRN93N94   ZZAMTI    SUB  ZZTOTI    ZZTOTI
0669 CSRN93 94   ZZWK2     SUB  ZZTOTD    ZZTOTD
0670 CSRN93N94   ZZAMTD    SUB  ZZTOTD    ZZTOTD
0671 C*
0672 C* REVERSE SIGN OF ZZTOT IF LARGER I/P FIELDS WERE NEGATIVE
0673 CSR                   SETOF                     94
0674 CSR 93 91
0675 CORN93 92             SETON                     94
0676 CSR 94                Z-SUBZZTOTI    ZZTOTI
0677 CSR 94                Z-SUBZZTOTD    ZZTOTD
0678 C**
0679 C**   RESTORE SIGN OF ZZAMTI & ZZAMTD IF IT WAS REVERSED.
0680 CSR 92                Z-SUBZZAMTI    ZZAMTI
0681 CSR 92                Z-SUBZZAMTD    ZZAMTD
0682 CSR         ZZSEND    TAG                             ** ZZSEND TAG *
0683 C**
0684 C**   IF ZZTOTD IS ZERO, AND ZZTOTI IS NEG. SET UP ZZNEGD.
0685 CSR                   SETOF                     96
0686 CSR         ZZTOTD    COMP 0                        91
0687 CSR 91      ZZTOTI    COMP 0                      96
0688 CSR 96                MOVE '.000-'   ZZNEGD  5
0689 CSR                   ENDSR                             ** ENDSR **
0690 C********************************************************************
1074 C********************************************************************
1075 C**************                                                      S01194
1076 C*****ZSYSTM*SR. TO CHAIN TO THE INSTALLATION CONTROL DATA RECORD.   S01194
1077 C**************                                                      S01194
1078 C***********ZSYSTM    BEGSR                           *** ZSYSTM *** S01194
1079 C**************                                                      S01194
1080 C*****SET*UP*KEY FOR INSTALLATION CONTROL RECORD.                    S01194
1081 C**************       MOVEL'01      'ZTABKY 12                       S01194
1082 C**************       MOVE '  10'    ZTABKY                          S01194
1083 C**************                                                      S01194
1084 C***********ZTABKY    CHAINTABLE                99    ON NOT THERE   S01194
1085 C**N99******RECI      COMP 'D'                  9999  ON, IS DELETED S01194
1086 C**************                                                      S01194
1087 C*****CHECK*SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.                    S01194
1088 C***********DATF      COMP 'M'                      98MMDDYY, 98 ON  S01194
1089 C**************                                                      S01194
1090 C**************       ENDSR                                          S01194
1091 C**************                                                      S01194
1092 C**************                                                      S01194
1093 C********************************************************************S01194
     C********************************************************************S01117
     C*                                                                   S01117
     C*  *PSSR --- SUBROUTINE TO HANDLE ABNORMAL ERROR CONDITIONS         S01117
     C*                                                                   S01117
     C*  CALLED FROM: AFTER ABNORMAL OPERATION OCCURS                     S01117
     C*                                                                   S01117
     C*  CALLS: NOTHING                                                   S01117
     C*                                                                   S01117
     C********************************************************************S01117
     C*                                                                   S01117
     C           *PSSR     BEGSR                           ** *PSSR **    S01117
     C*                                                                   S01117
     C           @RUN      IFEQ *BLANKS                                   S01117
     C                     MOVE 'Y'       @RUN    1                       S01117
     C                     DUMP                                           S01117
     C                     END                                            S01117
     C                     ENDSR                           ** *PSSR **    S01117
     C*                                                                   S01117
     C********************************************************************S01117
     C/COPY ZSRSRC,ZACCH                                                  S01195
     C/COPY ZSRSRC,ZFWDT                                                  S01195
     C/COPY ZSRSRC,ZBKDT                                                  S01195
     C/COPY ZSRSRC,ZCHKH                                                  S01195
     C/COPY ZSRSRC,ZDATE1Z2                                               S01392
     C/COPY ZSRSRC,ZDATE2Z4                                               S01392
     C/COPY ZSRSRC,ZFREQBZ2                                               S01392
     C**************************************************************************
1094 O**
1095 O**   OUTPUT TO GTUPD - UPDATED GUARANTEES FILE
1096 O**
1097 OGTUPDHH H        1P
1098 O                                    1 'H'
1099 OGTUPDGT D        02
1100 O       OR        03 25
1101 O***                      RECORD   128                               123915
1101 O                         RECORD   159                               123915
1102 O                       23           1 'E'
1103 O                         RVDT      25P
1104 OGTUPDZZ T        LRNU7
1105 O                         TRALER   128
1106 O                         COUNT     19P
1107 O                         LIVE      25P
1108 O                         LIVE      34P
1109 O                         LIVEF     42P
1110 O                         LIVEL     44P
1111 O                         LIVEF     82P
1112 O                         LIVEL     84P
1113 O**
1114 O**   OUTPUT TO GTEXT - GUARANTEES EXTRACT FILE
1115 O**
1116 OGTEXTHH H        1P
1117 O                                    1 'H'
1118 OGTEXTZZ T        LRNU7
1119 O                                    1 'T'
1120 O                         GTXREC     4P
1121 O                         GTXF      12P
1122 O                         GTXL      14P
1123 OGTEXTGX E        21
1124 O                                    1 'D'
1125 O***********              BRCD       4                               S01117
1125 O                         BRCA       4                               S01117
1126 O                         CNUMC     10
1127 O                         FCLN      16
1128 O                      N22RVDT      19P
1129 O                       22EDDT      19P
1130 O                      N22          20 'R'
1131 O                       22          20 'E'
1132 O                      N22RVFR      21
1133 O                         GUSN      24
1134 O                    09N24CCYL      27
1135 O                    09 24FCCY      27
1136 O                    09N24CPAM      34P
1137 O                    09 24FAMT      34P
1138 O                      N09          27 '   '
1139 O                      N09POUT      34P
1140 O                         CCY       37
1141 O                         TAMT      44P
1142 O                         GSCI      45
1143 O                         GBCN      51
1144 O                         CRNM      71
1145 O                         NARR     106
1146 O**
1147 O**   RUN CONTROL REPORT
1148 O**
1149 O*E0960P1T** 03   LR U7                                              S01117
1149 OLE0960AUT   03   LR U7                                              S01117
1150 O***********                        22 'REFERENCE LE0960'            S01117
1150 O                                   22 'REFERENCE LE0960AU'          S01117
1151 O                         TITL      89
1152 O                                  104 'DATE'
1153 O                         RUNA     112
1154 O                                  127 'PAGE    1'
1155 O        T 2      LR U7
1156 O                                   73 'GUARANTEES  UPDATE  AND'
1157 O                                   82 'EXTRACT'
1158 O        T 13     LR U7
1159 O                                   73 '-----------------------'
1160 O                                   82 '---------'
1161 O        T 3      LR U7
1162 O***********                        51 '*** REFERENCE LE0960'        S01117
1162 O                                   51 '*** REFERENCE LE0960AU'      S01117
1163 O                                   71 '- DATABASE ERROR AT'
1164 O**********               DBASE     74                               S01117
1164 O                         DBASE     75                               S01117
1165 O        T 2      LR U7
1166 O                                   37 'FILENAME'
1167 O**********               DBFILE    43                               S01117
1167 O                         DBFILE    46                               S01117
1168 O**********                         48 'KEY'                         S01117
1168 O                                   51 'KEY'                         S01117
1169 O**********               DBKEY     78                               S01117
1169 O                         DBKEY     81                               S01117
1170 O        T   03   LR
1171 O***********                        22 'REFERENCE LE0960'            S01117
1171 O                                   22 'REFERENCE LE0960AU'          S01117
1172 O                         TITL      89
1173 O                                  104 'DATE'
1174 O                         RUNA     112
1175 O                                  127 'PAGE    1'
1176 O        T 2      LR
1177 O                                   63 'GUARANTEES  UPDATE  AND'
1178 O                                   88 'EXTRACT  FILE  CONTROLS'
1179 O        T 1      LR
1180 O                                   64 '------------------------'
1181 O                                   88 '------------------------'
1182 O        T 3      LR
1183 O                                   28 'S/GTEES - RUN CONTROLS'
1184 O                                   58 'NUMBER'
1185 O                                   84 'VALUE'
1186 O        T 1      LR
1187 O                                   28 '----------------------'
1188 O                                   59 'OF RECORDS'
1189 O                                   84 'OF RECORDS'
1190 O        T 2      LR
1191 O                                   31 'TOTAL RECORDS ON FILE -'
1192 O                                   39 'TRAILER'
1193 O                      NU7NORE  3   59
1194 O        T 2      LR
1195 O                                   31 'TOTAL RECORDS ON FILE -'
1196 O                                   36 'READ'
1197 O                         TOTREC3   59
1198 O                       26         111 '***   DIFFERENCE   ***'
1199 O        T 2      LR
1200 O                                   31 '- - - - - - - - - - - -'
1201 O                                   43 '- - - - - -'
1202 O        T 2      LR
1203 O                                   28 'LIVE RECORDS ON FILE'
1204 O                                   42 'BEFORE UPDATE'
1205 O                      NU7NLRA  3   59
1206 O                      NU7VLAF  4   81
1207 O                      NU7VLAL      84
1208 O        T 2      LR
1209 O                                   30 'RECORDS MARKED EXPIRED'
1210 O                         NEXP  3   59
1211 O                         NEXPF 4   81
1212 O                         NEXPL     84
1213 O        T 2      LR
1214 O                                   28 'LIVE RECORDS ON FILE'
1215 O                                   41 'AFTER UPDATE'
1216 O                         LIVE  3   59
1217 O                         LIVEF 4   81
1218 O                         LIVEL     84
1219 O                       27         111 '***   DIFFERENCE   ***'
1220 O        T 2      LR
1221 O                                   31 '- - - - - - - - - - - -'
1222 O                                   43 '- - - - - -'
1223 O        T 2      LR
1224 O                                   28 'TOTAL RECORDS BEFORE'
1225 O                                   35 'UPDATE'
1226 O                      NU7NORE  3   59
1227 O        T 2      LR
1228 O                                   29 'TOTAL RECORDS DROPPED'
1229 O                                   43 'DURING UPDATE'
1230 O                         DROP  3   59
1231 O        T 21     LR
1232 O                                   27 'TOTAL RECORDS AFTER'
1233 O                                   34 'UPDATE'
1234 O                         COUNT 3   59
1235 O                       28         111 '***   DIFFERENCE   ***'
1236 O        T 3      LR
1237 O                                   28 'S/GTEXT - RUN CONTROLS'
1238 O        T 1      LR
1239 O                                   28 '----------------------'
1240 O        T 2      LR
1241 O                                   29 'TOTAL RECORDS ON FILE'
1242 O                         GTXREC3   59
1243 O                         GTXF  4   81
1244 O                         GTXL      84
1245 O******* T 3      LR                                                 S01117
1246 O*******                            76 '*** END OF REPORT ***'       S01117
**   ZFMD  -  NUMBER OF DAYS IN THE MONTH
312831303130313130313031
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
** CPY@   **      OBJECT COPYRIGHT
(c) Misys International Banking Systems Ltd. 2001
