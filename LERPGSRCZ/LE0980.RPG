0001 H        1                                                           S01117
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas LE Extract Commitment Details')                  *
0001 H**********                                                          S01117
0002 F********************************************************************
0004 F*                                                                  *
     F*  Midas - CUSTOMER LENDING
0004 F*                                                                  *
0005 F*     LE0980 - EXTRACT COMMITMENT DETAILS                          *
0006 F*                                                                  *
      *  (c) Misys International Banking Systems Ltd. 2001            *
0008 F*                                                                  *
      *  Last Amend No. AR787620           Date 10Jun11               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *  Prev Amend No. CRE026             Date 24May06               *
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CSD031             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 CLE042             Date 06Sep05               *
      *                 CLE040             Date 05Jul04               *
      *                 BUG3644            Date 12Jul04               *
      *                 CGL029             Date 01Sep03               *
      * Midas Release 4.01 -------------------------------------------*
      *                 193603             Date 31Aug01               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 S01339             Date 29Jul91               *
      *                 S01270             Date 22Mar91               *
     F*                    S01194                DATE 17JAN90            *
     F*                    S01117                DATE 20/07/89           *
     F*                                                                  *
     F*------------------------------------------------------------------*
     F*                                                                  *
      *  AR787620 - Hooks Incorporation                               *
      *             WNCPYSRC,LEH00235                                 *
      *             WNCPYSRC,LEH00236                                 *
      *             WNCPYSRC,LEH00172                                 *
      *  CRE026 - Consumer Banking                                    *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CLE042 - Extended Loan Sub Type (Recompile)                  *
      *  CLE040 - Collateralised Lending Phase 2                      *
      *  BUG3644 - Serious Error in Collateralised Lending (Recompile)*
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  193603 - Take negative facility amounts into consideration   *
     F*     S01339 - REMOVE SYNDICATED LOANS PROCESSING, DUE TO          *
     F*              MODULE REDUNDANCY.                                  *
     F*     S01270 - CUSTOMER LENDING AMENDMENTS                         *
     F*     S01194 - NEW STANDING DATA                                   *
     F*     S01117 - MULTIBRANCHING                                      *
     F*                                                                  *
0010 F********************************************************************
     F*  C R E A T I O N     P A R A M E T E R S                      *
     F*                                                               *
     F*                                                               *
     F*****************************************************************
0011 F***FCLTY** IP  F     256 12AI     2 DISK                                                CGL029
     F/COPY WNCPYSRC,LEH00235
     FFCLTY   IP  F     348 12AI     2 DISK                                                   CGL029
     F/COPY WNCPYSRC,LEH00236
     FLEFCLTLGIF  E           K        DISK                                                   CLE040
0012 F*LOANS***IS**F*****400 13AI     2 DISK                           U1 S01339
0013 F*TABLE***IF  F      96 12AI     2 DISK                              S01194
0014 FCOMEXHH O   F      80            DISK
0014 F***COMEXCF O   F      80            DISK                                                CLE040
     FCOMEXCF O   F     104            DISK                                                   CLE040
0014 FCOMEXZZ O   F      80            DISK
0015 F*E0980P1O   F     132     OF     PRINTER                            S01117
     FLE0980AUO   F     132     OF     PRINTER                            S01117
0016 F* ID F  C  H  L    FUNCTION OF INDICATORS
0017 F*  01           FACILITY HEADER
0018 F* 02            FACILITY DETAIL 'A'
0019 F* 03            FACILITY DETAIL 'B'
0020 F* 04            FACILITY TRAILER
0021 F**05******      LOANS,COMMITMENT-DETAIL                             S01339
0022 F**06******      LOANS,COMMITMENT-TRAILER                            S01339
0023 F**07******      TABLE INSTALLATION CONTROL-1                        S01194
0024 F**08******      TABLE COUNTRIES.                                    S01194
0025 F**
0026 F**
0027 F**
0028 F*       20      FIRST CYCLE OFF
0029 F********21      DRAWDOWN REFERENCE = 0                              S01339
0030 F**
0031 F**
0032 F**
0033 F*       30      LIVE FACILITY 'A' REC.
0034 F**
0035 F**
0036 F**
0037 F*       50      FACILITY INDICATOR = C. OUTPUT RECORD TO S/COMEX
0038 F*       51      OUTPUT COMEX HEADER
0039 F**
0040 F**
0041 F**
0042 F********60      TABLE FILE CHAIN FAIL                               S01194
0043 F**
0044 F**
0045 F**
0046 F*       70      FACILITY CONTROLS DIFFER
0047 F********71      LOANS CONTROLS DIFFER                               S01339
0048 F**
0049 F**
0050 F**
0051 F*       75      INTEGER PART OF COMEX HASH VALUE =0 (CALCULATED)
0052 F*       76      INTEGER PART OF FACILITY HASH VALUE =0 (CALCULATED)
0053 F********77      INTEGER PART OF LOANS HASH VALUE =0 (CALCULATED)    S01339
0054 F*       78      INTEGER PART OF FACILITY HASH VALUE =0 (TRAILER)
0055 F********79      INTEGER PART OF LOANS HASH VALUE =0 (TRAILER)       S01339
0056 F**
0057 F**
0058 F**
0059 F*       99      INSTALLATION CONTROL NOT FOUND
     F**************U1COMM. LOANS - LOANS FILE IS PRESENT                 S01339
0060 F*          U7 U8DATA BASE ERROR
     E                    CPY@    1   1 80
0061 F*          U8   CONTROLS OUT OF BALANCE
0062 I*
0063 I*
0064 I*** FACILTY HEADER
0065 IFCLTY   NS  01   1 CH
0066 I                                        1   1 RECI
0067 I*
0068 I*
0069 I***  FACILITIES FILE - DETAIL RECORD 1
0070 I*
0071 IFCLTY   NS  02   1 CD  13 CA
0072 I       OR        1 CR  13 CA
0073 I       OR        1 CC  13 CA
0074 I       OR        1 CE  13 CA
0075 I                                        1   1 RECI
0076 I**********                              2   70CNUM                                      CSD027
0076 I                                        2   7 CNUM                                      CSD027
0077 I                                        8  100FACT
0078 I                                       11  120FCNO
0079 I                                       13  13 RCTP
0080 I**********                             14  160BRCD                  S01117
     I                                       14  16 BRCA                  S01117
0081 I                                       17  17 FCTI
0082 I                                       18  20 FCCY
0083 I                                    P  21  270FAMT
0084 I                                    P  28  303OVPC
0085 I                                    P  31  330DTAP
0086 I                                    P  34  360DTEX
0087 I                                       37  37 RVCR
0088 I                                       38  38 SECI
0089 I                                       39  39 MCCY
0090 I                                       40  40 MCSI
0091 I                                       41  41 NACD
0092 I                                       42  43 CRSK
0093 I                                    P  44  460DLFS
0094 I                                    P  47  527NOMR
0095 I                                    P  53  550RVDT
0096 I                                       56  56 RVFR
0097 I                                       57  580RVDY
0098 I                                       59  93 NAR1
0099 I                                       94 128 NAR2
0100 I                                      129 163 NAR3
0101 I                                      164 198 NAR4
0102 I                                    P 199 2050MTDH
0103 I                                    P 206 2120MTDL
0104 I                                    P 213 2190MTDA
0105 I                                    P 220 2270QTDA
0106 I                                    P 228 2350YTDA
0107 I                                      236 237 ACOF
     I                                    P 242 2440RVCD                  S01270
0108 I                                    P 247 2490ORED
0109 I                                    P 250 2520LCD
0110 I                                      253 253 CHTP
0111 I                                    P 254 2560TNLU
0112 I*
0113 I***  FACILITIES FILE - DETAIL RECORD 2
0114 I*
0115 I        NS  03   1 CD  13 CB
0116 I       OR        1 CR  13 CB
0117 I       OR        1 CC  13 CB
0118 I       OR        1 CE  13 CB
0119 I                                        1   1 RECI
0120 I**********                              2   70CNUM                                      CSD027
0120 I                                        2   7 CNUM                                      CSD027
0121 I                                        8  100FACT
0122 I                                       11  120FCNO
0123 I                                       13  13 RCTP
0124 I                                       14  14 CMFT
0125 I                                       15  150CALC
0126 I                                    P  16  217SPRD
0127 I                                       22  230BCOD
0128 I                                    P  24  297BRAT
0129 I                                    P  30  320STDT
0130 I                                    P  33  350EDDT
0131 I                                    P  36  380DUDT
0132 I                                       39  39 BLFR
0133 I                                       40  410BLDN
0134 I                                       42  42 BTIN
0135 I                                       43  440BLDY
0136 I                                       45  460SETT
0137 I**********                             47  58 OBAC                                      CGL029
     I                                       47  58 QQOBAC                                    CGL029
0138 I                                       59  68 TNAC
0139 I                                    P  69  710SLCD
0140 I                                    P  72  740ACCD
0141 I                                    P  75  810ADNP
0142 I                                    P  82  880PDTD
0143 I                                    P  89  950AFPD
0144 I                                    P  96 1020ADJP
0145 I                                    P 103 1090ADJN
0146 I                                    P 110 1160TOTD
0147 I                                    P 117 1230CAMD
0148 I                                    P 124 1300HFAM
     I                                    P 132 1380PEXP
0149 I                                    P 147 1490RUN0
0150 I                                    P 150 1520RUN1
0151 I                                    P 153 1550RUN2
0152 I                                    P 156 1580RUN3
0153 I                                    P 159 1610RUN4
0154 I                                    P 162 1640RUN5
0155 I                                    P 165 1670RUN6
0156 I                                    P 168 1700RUN7
0157 I                                    P 171 1730RUN8
0158 I                                    P 174 1760RUN9
0159 I                                    P 177 1830OAM1
0160 I                                    P 184 1900OAM2
0161 I                                    P 191 1970OAM3
0162 I                                    P 198 2040OAM4
0163 I                                    P 205 2110OAM5
0164 I                                    P 212 2180OAM6
0165 I                                    P 219 2250OAM7
0166 I                                    P 226 2320OAM8
0167 I                                    P 233 2390OAM9
0168 I                                    P 240 2460OA10
0169 I                                    P 247 2490ORED
0170 I                                    P 250 2520LCD
0171 I                                      253 253 CHTP
0172 I                                    P 254 2560TNLU
     I                                      331 348 OBAC                                      CGL029
     I/COPY WNCPYSRC,LEH00172
0173 I*
0174 I*
0175 I** FACILITY TRAILER
0176 I**
0177 I        NS  04   1 CT  13 CZ
0178 I                                        1   1 RECI
0179 I                                    P  17  190NORE
0180 I                                    P  20  220FLSZ
0181 I                                    P  23  250NLRB
0182 I                                    P  26  280NINS
0183 I                                    P  29  310NDEL
0184 I                                    P  32  340NLRA
0185 I                                    P  35  420VLBF
0186 I                                    P  43  440VLBL
0187 I                                    P  45  520VRIF
0188 I                                    P  53  540VRIL
0189 I                                    P  55  620VRDF
0190 I                                    P  63  640VRDL
0191 I                                    P  65  720VRAF
0192 I                                    P  73  740VRAL
0193 I                                    P  75  820VLAF
0194 I                                    P  83  840VLAL
0195 I                                    P 250 2520LCD
0196 I                                      253 253 CHTP
0197 I                                    P 254 2560TNLU
0198 I*
0199 I** FACILITY CATCHALL
0200 I        NS
0201 I                                        1   1 RECI
0202 I**********                                                          S01339
0203 I***LOANS*COMMITMENT*DETAIL****                                      S01339
0204 I*LOANS***NS**05***1*CD***8*CD*                                      S01339
0205 I*******OR********1*CM***8*CD**                                      S01339
0206 I**********                              1   1 RECI                  S01339
0207 I**********                              2   70LNRF                  S01339
0208 I**********                              8   8 RCDT                  S01339
0209 I**********                              9  140DDRF            21    S01339
0210 I**********                             15  200BWCN                  S01339
0211 I**********                             21  22 CRSK                  S01339
0212 I**********                          P  23  290ORCA                  S01339
0213 I**********                             30  320BRCD            S01117S01339
0202 I**********                             30  32 BRCA            S01117S01339
0214 I**********                             33  380LMNO                  S01339
0215 I**********                             39  40 LNTP                  S01339
0216 I**********                             41  42 LNST                  S01339
0217 I**********                             43  43 MANT                  S01339
0218 I**********                             44  44 MGRI                  S01339
0219 I**********                             45  45 PLDI                  S01339
0220 I**********                          P  46  520PDHA                  S01339
0221 I**********                             53  53 MCYI                  S01339
0222 I**********                             54  54 GDSD                  S01339
0223 I**********                          P  55  570SGND                  S01339
0224 I**********                          P  58  600STTD                  S01339
0225 I**********                          P  61  630FAVD                  S01339
0226 I**********                          P  64  660LAVD                  S01339
0227 I**********                          P  67  690COND                  S01339
0228 I**********                          P  70  720MATD                  S01339
0229 I**********                          P  73  790MSAM                  S01339
0230 I**********                          P  80  820MSBD                  S01339
0231 I**********                          P  83  850MSSD                  S01339
0232 I**********                             86  86 MSF                   S01339
0233 I**********                          P  87  930TLAM                  S01339
0234 I**********                          P  94 1000OLAM                  S01339
0235 I**********                            101 103 CMCY                  S01339
0236 I**********                          P 104 1100TTCA                  S01339
0237 I**********                          P 111 1170TTDA                  S01339
0238 I**********                          P 118 1240TTUA                  S01339
0239 I**********                          P 125 1310AUNA                  S01339
0240 I**********                          P 132 1380ORDA                  S01339
0241 I**********                          P 139 1450ORUA                  S01339
0242 I**********                            146 1460RCUI                  S01339
0243 I**********                            147 147 WTXT                  S01339
0244 I**********                          P 148 1510WTXR                  S01339
0245 I**********                          P 152 1577SPRD                  S01339
0246 I**********                          P 158 1610CFRT                  S01339
0247 I**********                          P 162 1640CRSD                  S01339
0248 I**********                          P 165 1670CFED                  S01339
0249 I**********                          P 168 1700CFBD                  S01339
0250 I**********                          P 171 1730CFDD                  S01339
0251 I**********                            174 174 CFF                   S01339
0252 I**********                          P 175 1820CFAD                  S01339
0253 I**********                          P 183 1850LSFD                  S01339
0254 I**********                          P 186 1920CFPD                  S01339
0255 I**********                          P 193 1990CFPT                  S01339
0256 I**********                            200 2010CFST                  S01339
0257 I**********                            202 213 CFON                  S01339
0258 I**********                            214 223 CFBN                  S01339
0259 I**********                            224 2250ACSQ                  S01339
0260 I**********                          P 226 2280ACTD                  S01339
0261 I**********                            229 2380OFCD                  S01339
0262 I**********                          P 239 2450OFAM1                 S01339
0263 I**********                          P 246 2520OFAM2                 S01339
0264 I**********                          P 253 2590OFAM3                 S01339
0265 I**********                          P 260 2660OFAM4                 S01339
0266 I**********                          P 267 2730OFAM5                 S01339
0267 I**********                          P 274 2760OFDD1                 S01339
0268 I**********                          P 277 2790OFDD2                 S01339
0269 I**********                          P 280 2820OFDD3                 S01339
0270 I**********                          P 283 2850OFDD4                 S01339
0271 I**********                          P 286 2880OFDD5                 S01339
0272 I**********                          P 289 2950ACFP                  S01339
0273 I**********                          P 296 3020ACFN                  S01339
0274 I**********                            303 3040MSDY                  S01339
0275 I**********                            305 3060CFDY                  S01339
0276 I**********                          P 307 3130SICH                  S01339
0277 I**********                            314 314 CATD                  S01339
0278 I**********                            315 3150CFCM                  S01339
0279 I**********                          P 316 3230CFADL                 S01339
0280 I**********                          P 391 3930ORED                  S01339
0281 I**********                          P 394 3960LCD                   S01339
0282 I**********                            397 397 CHTP                  S01339
0283 I**********                          P 398 4000TNLU                  S01339
0284 I**********                                                          S01339
0285 I***LOANS*COMMITMENT*TRAILER***                                      S01339
0286 I********NS**06***1*CT***8*CD**                                      S01339
0287 I**********                              1   1 RECI                  S01339
0288 I**********                              2   7 KEY1                  S01339
0289 I**********                              8   8 RCDT                  S01339
0290 I**********                              9  22 KEY2                  S01339
0291 I**********                          P  27  290NORET                 S01339
0292 I**********                          P  30  370HRWN                  S01339
0293 I**********                          P  38  390HRDC                  S01339
0294 I**********                          P  40  420NLRB                  S01339
0295 I**********                          P  43  500RBWN                  S01339
0296 I**********                          P  51  520RBDC                  S01339
0297 I**********                          P  53  550NINS                  S01339
0298 I**********                          P  56  630INWN                  S01339
0299 I**********                          P  64  650INDC                  S01339
0300 I**********                          P  66  680NAMD                  S01339
0301 I**********                          P  69  760AMWN                  S01339
0302 I**********                          P  77  780AMDC                  S01339
0303 I**********                          P  79  810NDEL                  S01339
0304 I**********                          P  82  890DLWN                  S01339
0305 I**********                          P  90  910DLDC                  S01339
0306 I**********                             92  92 IRRI                  S01339
0307 I**********                          P 100 1020TNLU                  S01339
0308 I**********                                                          S01339
0309 I***LOANS*CATCHALL***                                                S01339
0310 I********NS                                                          S01339
0311 I**********                              1   1 RECI                  S01339
0312 I*
0313 I*
0314 I*****TABLE*FILE***INSTALLATION*CONTROL*DATA*RECORD*1.               S01194
0315 I**********                                                          S01194
0316 I*TABLE***NS  07   2 C0   3 C1  12 C1                                S01194
0317 I*******AND      13 C0                                               S01194
0318 I**********                              1   1 RECI                  S01194
0319 I**********                              2   30RECT                  S01194
0320 I**********                             12  130RCDE                  S01194
0321 I**********                             14  66 TITL                  S01194
0322 I**********                             67  67 DATF                  S01194
0323 I**********                             68  700DFBR                  S01194
0324 I**********                             74  74 MODI1                 S01194
0325 I**********                             75  75 MODI2                 S01194
0326 I**********                             76  76 MODI3                 S01194
0327 I**********                          P  77  790RUND                  S01194
0328 I**********                             80  86 RUNA                  S01194
0329 I**********                             87  870SFLG                  S01194
0330 I**********                          P  90  920LCD                   S01194
0331 I**********                             93  93 CHTP                  S01194
0332 I**********                          P  94  960TNLU                  S01194
0333 I**********                                                          S01194
0334 I**********                                                          S01194
0335 I*****TABLE*FILE***COUNTRY*CODES*RECORD.                             S01194
0336 I**********                                                          S01194
0337 I*TABLE***NS  08   1 CD   2 C5   3 C0                                S01194
0338 I**********                              1   1 RECI                  S01194
0339 I**********                              2   30RECT                  S01194
0340 I**********                             12  13 CCOD                  S01194
0341 I**********                             14  43 CNM                   S01194
0342 I**********                             44  45 REGC                  S01194
0343 I**********                             46  480DEPT                  S01194
0344 I**********                          P  49  510DEPX                  S01194
0345 I**********                          P  52  560DEPA                  S01194
0346 I**********                             57  57 DEPF                  S01194
0347 I**********                          P  58  600DEPR                  S01194
0348 I**********                             61  620DLRD                  S01194
0349 I**********                             63  650FRXT                  S01194
0350 I**********                          P  66  680FRXX                  S01194
0351 I**********                          P  69  730FRXA                  S01194
0352 I**********                             74  74 FRXF                  S01194
0353 I**********                          P  75  770FRXR                  S01194
0354 I**********                             78  790FLRD                  S01194
0355 I**********                          P  90  920LCD                   S01194
0356 I**********                             93  93 CHTP                  S01194
0357 I**********                          P  94  960TNLU                  S01194
0358 I**********                                                          S01194
0359 I***TABLE*CATCHALL                                                   S01194
0360 I********NS                                                          S01194
0361 I**********                              1   1 RECI                  S01194
     ISDBRCH    E DSSDBRCHPD                                              S01117
     I** EXTERNAL DS FOR BRANCHES DETAILS                                 S01117
     I**                                                                  S01117
     I              A8CMCD                          CMPYM                 S01117
     ISDBANK    E DSSDBANKPD                                              S01194
      ** BANK DETAILS                                                     S01194
     I              BJURPT                          TITL                  S01194
     I              BJDFIN                          DATF                  S01194
     I              BJMRDT                          RUNA                  S01194
     ISDCTRY    E DSSDCTRYPD                                              S01194
      ** COUNTRY DETAILS                                                  S01194
     I              A4CNNM                          CNM                   S01194
     I              A4RGCD                          REGC                  S01194
     I              A4CNCD                          CCOD                  S01194
     ISCSARD    E DSSCSARDPD                                                                  CLE040
      ** External DS for Switchable Details                                                   CLE040
      *                                                                                       CLE040
     IDSFDY     E DSDSFDY                                                 S01194
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01194
0362 I*
0364 ILDA        UDS                            256
0363 I** L.D.A.
0647 I***********                           134 138 DBFILE                S01117
0648 I***********                           139 167 DBKEY                 S01117
0649 I***********                           168 175 DBPGM                 S01117
0650 I***********                           176 1770DBASE                 S01117
0647 I                                      134 141 DBFILE                S01117
0648 I                                      142 170 DBKEY                 S01117
0649 I                                      171 180 DBPGM                 S01117
0650 I                                      181 1830DBASE                 S01117
     I*                                                                   S01117
     I**   FILE INFORMATION DATA STRUCTURE                                S01117
     I*                                                                   S01117
     ISPOOLU      DS                                                      S01117
     I                                       83  92 SFILEU                S01117
     I                                    B 123 1240SFNUMU                S01117
      *                                                                                       CGL029
     IDSSDY     E DSDSSDY                                                                     CGL029
      *                                                                                       CGL029
     C** PARAMETER LIST FOR PROGRAM 'AOBANKR0'                            S01194
     C           PLISTA    PLIST                                          S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDBANK    PARM SDBANK    DSFDY                           S01194
     C** PARAMETER LIST FOR PROGRAM 'AOCTRYR0'                            S01194
     C           PLIST1    PLIST                                          S01194
     C                     PARM '*MSG   ' @RTCD                           S01194
     C                     PARM '*KEY   ' @OPTN                           S01194
     C                     PARM           CTYKEY  2                       S01194
     C           SDCTRY    PARM SDCTRY    DSFDY                           S01194
     C                     MOVEACPY@      BIS@   80
0370 C*
0369 C      20             GOTO BY01
0370 C*
0371 C** FIRST CYCLE CALCS
0372 C*
     C           *NAMVAR   DEFN           LDA                             S01194
     C           *LOCK     IN   LDA                                       S01194
0373 C** SETUP DATA BASE ERROR REFERENCE
0374 C                     MOVEL'LE0980  'DBPGM
0375 C                     MOVEL'     '   DBFILE
0376 C***SET*UP*FIELD*FOR*ACCESSING*TABLE*                                S01194
0377 C**********           MOVEL'50'      TABKEY 12                       S01194
0378 C************                                                        S01194
0379 C***ACCESS*INSTALLATION*CONTROL 1.                                   S01194
0380 C**********           EXSR ZSYSTM                                    S01194
0381 C*********99          SETON                     U7U8                 S01194
0382 C*********99          MOVEL'TABLE'   DBFILE                          S01194
0383 C*********99          MOVELZTABKY    DBKEY                           S01194
0384 C*********99          MOVEL'01'      DBASE            ** DBASE  01 **S01194
0385 C*********99          GOTO END                                       S01194
0386 C*
     C                     CALL 'AOBANKR0'PLISTA                          S01194
     C           @RTCD     IFNE *BLANKS                                   S01194
0199 C                     SETON                     U7U8  **DATABASE 01**S01194
0200 C                     Z-ADD1         DBASE                           S01194
0202 C                     MOVE 'SDBANKPD'DBFILE                          S01194
0203 C                     GOTO END                                       S01194
     C                     END                                            S01194
0480 C**   CHECK SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.                    S01194
0481 C           DATF      COMP 'M'                      98MMDDYY, 98 ON  S01194
      *                                                                                       CLE040
     C                     MOVE 'N'       CLE025  1                                           CLE040
     C                     MOVE *OFF      *IN55                                               CLE040
     C                     CALL 'AOSARDR0'                                                    CLE040
     C                     PARM '*MSG   ' PRTCD   7                                           CLE040
     C                     PARM '*KEY   ' POPTN   7                                           CLE040
     C                     PARM 'CLE025'  PSARD   6                                           CLE040
     C           SCSARD    PARM SCSARD    DSFDY                                               CLE040
      *                                                                                       CLE040
     C           PRTCD     IFNE *BLANKS                                                       CLE040
     C           PRTCD     ANDNE'*NRF   '                                                     CLE040
     C                     MOVEL'SCSARDPD'DBFILE                                              CLE040
     C                     MOVELPSARD     DBKEY                                               CLE040
     C                     MOVELPOPTN     DBOPTN                                              CLE040
     C                     Z-ADD5         DBASE                                               CLE040
     C                     GOTO END                                                           CLE040
     C                     ENDIF                                                              CLE040
      *                                                                                       CLE040
     C           PRTCD     IFEQ *BLANKS                                                       CLE040
     C                     MOVE 'Y'       CLE025                                              CLE040
     C                     MOVE *ON       *IN55                                               CLE040
     C                     ENDIF                                                              CLE040
      *                                                                                       CLE040
     C                     MOVE 'N'       CLE024  1                                           CLE040
     C                     MOVE *OFF      *IN56                                               CLE040
     C                     CALL 'AOSARDR0'                                                    CLE040
     C                     PARM '*MSG   ' PRTCD                                               CLE040
     C                     PARM '*KEY   ' POPTN                                               CLE040
     C                     PARM 'CLE024'  PSARD                                               CLE040
     C           SCSARD    PARM SCSARD    DSFDY                                               CLE040
      *                                                                                       CLE040
     C           PRTCD     IFNE *BLANKS                                                       CLE040
     C           PRTCD     ANDNE'*NRF   '                                                     CLE040
     C                     MOVEL'SCSARDPD'DBFILE                                              CLE040
     C                     MOVELPSARD     DBKEY                                               CLE040
     C                     MOVELPOPTN     DBOPTN                                              CLE040
     C                     Z-ADD6         DBASE                                               CLE040
     C                     GOTO END                                                           CLE040
     C                     ENDIF                                                              CLE040
      *                                                                                       CLE040
     C           PRTCD     IFEQ *BLANKS                                                       CLE040
     C                     MOVE 'Y'       CLE024                                              CLE040
     C                     MOVE *ON       *IN56                                               CLE040
     C                     ENDIF                                                              CLE040
      *                                                                                       CLE040
     C           KLFCLT    KLIST                                                              CLE040
     C                     KFLD           BRCA                                                CLE040
     C                     KFLD           KCNUM   6                                           CLE040
     C                     KFLD           KFACT   3                                           CLE040
     C                     KFLD           KFCNO   2                                           CLE040
      *                                                                                       CLE040
0387 C** OUTPUT THE EXTRACT FILE HEADER
0388 C                     MOVEL' '       BLK80  80
0389 C                     SETON                     51
0390 C                     EXCPT
0391 C                     SETOF                     51
0392 C*
0393 C** INCREMENT RECORD COUNTS
0394 C                     Z-ADD1         RECRIT  50
0395 C                     Z-ADD1         FCT     50
0396 C***********          Z-ADD0         LCT     50                      S01339
0397 C                     Z-ADD2         FCLTOT  50
0398 C*
0399 C                     SETON                     20
0400 C                     GOTO END
0401 C           BY01      TAG                             ** BY01  TAG **
0402 C*
0403 C** PERFORM RELEVENT SUBROUTINE ACCORDING TO REC TYPE
0404 C      02             EXSR FACA
0405 C      02             GOTO END
0406 C      03             EXSR FACB
0407 C      03             GOTO END
0408 C      04             EXSR QFACT
0409 C      04             GOTO END
0410 C******05***          EXSR LND                                       S01339
0411 C******05***          GOTO END                                       S01339
0412 C******06***          EXSR LNT                                       S01339
0413 C*
0414 C           END       TAG                             ** END TAG ***
0415 C   U7
0416 COR U8                SETON                     LR
     C**
     CLR U7 U8             EXSR *PSSR                                     S01117
0417 C*************************SUBROUTINES********************************
0418 C**
0419 C**
0420 C**
0421 C***  FACA -  HANDLE CALCS.FOR FACILITY TYPE A REC.
0422 C*
0423 C           FACA      BEGSR                           ** FACA BEGSR *
0424 C*
0425 C** CONTROLS FOR LIVE RECORD
0426 C           RECI      COMP '*'                      30
0427 C         30          GOTO FACEND
0428 C           FCT       ADD  1         FCT     50
0429 C           RECI      COMP 'D'                      30
0430 C     N30   RECI      COMP 'E'                      30
0431 C     N30             GOTO FACEND
0432 C                     MOVE FAMT      ZZAMT
     C           ZZAMT     IFLT 0                                                             193603
     C                     Z-SUBZZAMT     ZZAMT                                               193603
     C                     END                                                                193603
0433 C                     Z-ADDFINT      ZZTOTI
0434 C                     Z-ADDFDEC      ZZTOTD
0435 C                     EXSR GLZADD
0436 C                     Z-ADDZZTOTI    FINT   150
0437 C                     Z-ADDZZTOTD    FDEC    30
0438 C*
0439 C*
0440 C           RECI      COMP 'D'                      30
0441 C     N30             GOTO FACEND
0442 C*
0443 C** CHECK FACILITY INDICATOR
0444 C           FCTI      COMP 'C'                      50
0445 C        N50          GOTO FACEND
0446 C*
0447 C** USING 'COUNTRY OF RISK' OBTAIN COUNTRY NAME & REGION CODE
0448 C**********           MOVE CRSK      TABKEY                          S01194
0449 C**********           EXSR TABCHN                                    S01194
0448 C                     MOVE CRSK      CTYKEY                          S01194
     C                     CALL 'AOCTRYR0'PLIST1                          S01194
     C           @RTCD     IFNE *BLANKS                                   S01194
     C                     SETON                     U7U8LR               S01194
     C                     MOVE 'SDCTRYPD'DBFILE                          S01194
     C                     MOVE CTYKEY    DBKEY                           S01194
0794 C                     Z-ADD2         DBASE                        ***S01194
0795 C                     GOTO FACEND                     ***************S01194
     C                     END                                            S01194
0450 C*********60          MOVEL'02'      DBASE            ** DBASE  02 **S01194
0451 C*********60          GOTO FACEND                                    S01194
0452 C*
0453 C** ACCUMULATE TOTALS FOR OUTPUT TRAILER
0454 C           FCLTOT    ADD  1         FCLTOT
0455 C                     MOVE FAMT      ZZAMT
     C           ZZAMT     IFLT 0                                                             193603
     C                     Z-SUBZZAMT     ZZAMT                                               193603
     C                     END                                                                193603
0456 C                     Z-ADDTINT      ZZTOTI
0457 C                     Z-ADDTDEC      ZZTOTD
0458 C                     EXSR GLZADD
0459 C                     Z-ADDZZTOTI    TINT   150
0460 C                     Z-ADDZZTOTD    TDEC    30
0461 C*
0462 C*
0463 C*
0464 C*
0465 C           FACEND    ENDSR                           ***  ENDSR  ***
0466 C********************************************************************
0467 C**
0468 C**
0469 C***  FACB - HANDLE CALCS FOR FACILITY 'B' REC.
0470 C*
0471 C           FACB      BEGSR                           ** FACB BEGSR *
0472 C*
0473 C** REC COUNT IF LIVE
0474 C           RECI      COMP '*'                      30
0475 C     N30   FCT       ADD  1         FCT
0476 C     N50             GOTO FCBEND
      *                                                                                       CLE040
     C           CLE024    IFEQ 'Y'                                                           CLE040
     C           CLE025    OREQ 'Y'                                                           CLE040
      *                                                                                       CLE040
     C                     MOVE CNUM      KCNUM                                               CLE040
     C                     MOVE FACT      KFACT                                               CLE040
     C                     MOVE FCNO      KFCNO                                               CLE040
      *                                                                                       CLE040
     C           KLFCLT    CHAINLEFCLTLG             54                                       CLE040
      *                                                                                       CLE040
     C                     Z-ADDFCXOF2    WOFSET 150                                          CLE040
      *                                                                                       CLE040
     C           FCXALV    IFGT 0                                                             CLE040
      *                                                                                       CLE040
     C           FCXALV    MULT FCXCV2    WCALTV 150                                          CLE040
      *                                                                                       CLE040
     C           WCALTV    IFLT FAMT                                                          CLE040
     C                     Z-ADDWCALTV    TCALTV 150                                          CLE040
     C                     ELSE                                                               CLE040
     C                     Z-ADDFAMT      TCALTV                                              CLE040
     C                     ENDIF                                                              CLE040
      *                                                                                       CLE040
     C                     ELSE                                                               CLE040
     C                     Z-ADDFAMT      TCALTV                                              CLE040
     C                     ENDIF                                                              CLE040
      *                                                                                       CLE040
     C                     ENDIF                                                              CLE040
0477 C*
0478 C** CALCULATE AMOUNT AVAILABLE
      *                                                                                       CLE040
     C           CLE025    IFEQ 'N'                                                           CLE040
     C           CLE024    ANDEQ'N'                                                           CLE040
      *                                                                                       CLE040
0479 C           FAMT      SUB  OAM1      AMAVB  130
      *                                                                                       CLE040
     C                     ELSE                                                               CLE040
      *                                                                                       CLE040
     C           FAMT      SUB  OAM1      WKAVB1 150                                          CLE040
     C                     ADD  FCXOF2    WKAVB1                                              CLE040
      *                                                                                       CLE040
     C           FCXALV    IFLE 0                                                             CLE040
     C                     Z-ADDWKAVB1    AMAVB                                               CLE040
     C                     ELSE                                                               CLE040
      *                                                                                       CLE040
     C           FCXALV    MULT FCXCV2    WKAVB2 150                                          CLE040
     C                     SUB  OAM1      WKAVB2                                              CLE040
     C                     ADD  FCXOF2    WKAVB2                                              CLE040
      *                                                                                       CLE040
     C           WKAVB1    IFLT WKAVB2                                                        CLE040
     C                     Z-ADDWKAVB1    AMAVB                                               CLE040
     C                     ELSE                                                               CLE040
     C                     Z-ADDWKAVB2    AMAVB                                               CLE040
     C                     ENDIF                                                              CLE040
      *                                                                                       CLE040
     C                     ENDIF                                                              CLE040
      *                                                                                       CLE040
     C                     ENDIF                                                              CLE040
0480 C*
     C**                                                                  S01117
     C** GET COMPANY CODE BY ACCESSING BRANCHES DETAILS                   S01117
     C**                                                                  S01117
     C**********           CALL 'AOBRCHR0'                                S01117              CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       S01117
     C                     PARM '*KEY   ' @OPTN   7                       S01117
     C                     PARM BRCA      @DSNB   3                       S01117
     C********** SDBRCH    PARM SDBRCH    DSFDY                           S01117              CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C*                                                                   S01117
     C           @RTCD     IFNE *BLANKS                                   S01117
     C                     SETON                     U7U8LR               S01117
     C                     MOVEL'SDBRCHPD'DBFILE                          S01117
     C                     MOVEL@DSNB     DBKEY            ************** S01117
     C                     MOVEL@OPTN     DBOPTN  7        *DBASE 04 **** S01117
     C                     Z-ADD4         DBASE            ************** S01117
     C                     EXSR *PSSR                                     S01117
     C                     GOTO FCBEND                                    S01117
     C                     END                                            S01117
0481 C**  IF A REC WAS SELECTED OUTPUT COMEX RECORD
0482 C         50          EXCPT
0483 C*
0484 C*
0485 C                     SETOF                     50
0486 C*
0487 C*
0488 C           FCBEND    ENDSR                           ***  ENDSR  ***
0489 C*
0490 C*
0491 C********************************************************************
0492 C**
0493 C**
0494 C***  QFACT - HANDLE CALCS FOR FACILITY TRAILER
0495 C*
0496 C           QFACT     BEGSR                           ** QFACT BEGR *
0497 C*
0498 C*
0499 C           FCT       ADD  1         FCT
0500 C*
0501 C** COMPARE TRAILER CONTROLS TO THOSE CALCULATED IN 'FACA'
0502 C           NORE      COMP FCT                  7070
0503 C        N70VLAF      COMP FINT                 7070
0504 C        N70VLAL      COMP FDEC                 7070
0505 C         70          SETON                     U8
0506 C*
0507 C*
0508 C                     ENDSR                           ***  ENDSR  ***
0509 C*
0510 C*
0511 C********************************************************************
0512 C***********                                                         S01339
0513 C***********                                                         S01339
0514 C*****LND*-*HANDLES CALCS FOR LOAN COMMITMENT DETAIL REC.            S01339
0515 C*********** CALLS TABCHN                                            S01339
0516 C***********LND       BEGSR                           ** LND BEGSR **S01339
0517 C***********                                                         S01339
0518 C*****IF*ZERO/BLANK INDICATOR NOT SET THEN RECORD IS NOT             S01339
0519 C*****A*COMMITMENT DETAIL                                            S01339
0520 C********N21          GOTO LNDEND                                    S01339
0521 C***********                                                         S01339
0522 C***********                                                         S01339
0523 C***********RECI      COMP '*'                      30               S01339
0524 C******30***          GOTO LNDEND                                    S01339
0525 C***********                                                         S01339
0526 C*****CONTROLS FOR LIVE RECORDS                                      S01339
0527 C***********LCT       ADD  1         LCT     50                      S01339
0528 C***********          MOVE ORCA      ZZAMT                           S01339
0529 C***********          Z-ADDLINT      ZZTOTI                          S01339
0530 C***********          Z-ADDLDEC      ZZTOTD                          S01339
0531 C***********          EXSR GLZADD                                    S01339
0532 C***********          Z-ADDZZTOTI    LINT   150                      S01339
0533 C***********          Z-ADDZZTOTD    LDEC    30                      S01339
0534 C***********RECI      COMP 'D'                      30               S01339
0535 C*****N30***          GOTO LNDEND                                    S01339
0536 C***********                                                         S01339
0537 C*****OBTAIN COUNTRY NAME & REGION                                   S01339
0538 C***********          MOVE CRSK      TABKEY                    S01194S01339
0539 C***********          EXSR TABCHN                              S01194S01339
0538 C***********          MOVE CRSK      CTYKEY                    S01194S01339
0512 C***********          CALL 'AOCTRYR0'PLIST1                    S01194S01339
0512 C***********@RTCD     IFNE *BLANKS                             S01194S01339
0512 C***********          SETON                     U7U8LR         S01194S01339
0512 C***********          MOVE 'SDCTRYPD'DBFILE                    S01194S01339
0512 C***********          MOVE CTYKEY    DBKEY                     S01194S01339
0794 C***********          Z-ADD3         DBASE                  ***S01194S01339
0795 C***********          GOTO LNDEND                     *********S01194S01339
0512 C***********          END                                      S01194S01339
0540 C*********60          MOVEL'03'      DBASE         DBASE  03 **S01194S01339
0541 C*********60          GOTO LNDEND                              S01194S01339
0542 C***********                                                         S01339
0543 C***ACCUMULATE FOR OUTPUT TRAILER                                    S01339
0544 C***********FCLTOT    ADD  1         FCLTOT                          S01339
0545 C***********          MOVE ORCA      ZZAMT                           S01339
0546 C***********          Z-ADDTINT      ZZTOTI                          S01339
0547 C***********          Z-ADDTDEC      ZZTOTD                          S01339
0548 C***********          EXSR GLZADD                                    S01339
0549 C***********          Z-ADDZZTOTI    TINT                            S01339
0550 C***********          Z-ADDZZTOTD    TDEC                            S01339
0551 C***********                                                         S01339
0512 C***********                                                   S01117S01339
0512 C***GET*COMPANY CODE BY ACCESSING BRANCH CODE DETAILS          S01117S01339
0512 C***********                                                   S01117S01339
0512 C***********          CALL 'AOBRCHR0'                          S01117S01339
0512 C***********          PARM '*MSG   ' @RTCD   7                 S01117S01339
0512 C***********          PARM '*KEY   ' @OPTN   7                 S01117S01339
0512 C***********          PARM BRCA      @DSNB   3                 S01117S01339
0512 C***********SDBRCH    PARM SDBRCH    DSFDY                     S01117S01339
0512 C***********                                                   S01117S01339
0512 C***********@RTCD     IFNE *BLANKS                             S01117S01339
0512 C***********          SETON                     U7U8LR         S01117S01339
0512 C***********          MOVEL'SDBRCHPD'DBFILE                    S01117S01339
0512 C***********          MOVEL@DSNB     DBKEY            *********S01117S01339
0512 C***********          MOVEL@OPTN     DBOPTN  7        *DBASE 05S01117S01339
0512 C***********          Z-ADD5         DBASE            *********S01117S01339
0512 C***********          EXSR *PSSR                               S01117S01339
0512 C***********          GOTO LNDEND                              S01117S01339
0512 C***********          END                                      S01117S01339
0552 C***OUTPUT*COMEX RECORD                                              S01339
0553 C***********          SETON                     50                   S01339
0554 C***********          EXCPT                                          S01339
0555 C***********          SETOF                     50                   S01339
0556 C***********                                                         S01339
0557 C***********                                                         S01339
0558 C***********                                                         S01339
0559 C***********LNDEND    ENDSR                           ***  ENDSR  ***S01339
0560 C********************************************************************S01339
0561 C***********                                                         S01339
0562 C***********                                                         S01339
0563 C*****LNT*-*HANDLE CALCS FOR LOAN COMMITMENT TRAILER                 S01339
0564 C***********                                                         S01339
0565 C***********LNT       BEGSR                           ** LNT BEGSR **S01339
0566 C***********                                                         S01339
0567 C***********                                                         S01339
0568 C***********                                                         S01339
0569 C***COMPARE*TRAILER CONTROLS TO THOSE CALCULATED IN 'LND'            S01339
0570 C***********NORET     COMP LCT                  7171                 S01339
0571 C********N71HRWN      COMP LINT                 7171                 S01339
0572 C********N71HRDC      COMP LDEC                 7171                 S01339
0573 C*********71          SETON                     U8                   S01339
0574 C***********                                                         S01339
0575 C***********                                                         S01339
0576 C***THIS*WILL BE THE LAST RECORD READ IN PROGRAM                     S01339
0577 C***********          SETON                     LR                   S01339
0578 C***********                                                         S01339
0579 C***********                                                         S01339
0580 C***********          ENDSR                           ***  ENDSR  ***S01339
0578 C***********                                                         S01339
0581 C********************************************************************
0582 C********************************************************************
0583 C********************************************************************
0584 C**
0469 C*****ZSYSTM*SR.*TO*CHAIN TO THE INSTALLATION CONTROL DATA RECORD.   S01194
0470 C**********                                                          S01194
0471 C********** ZSYSTM    BEGSR                           *** ZSYSTM *** S01194
0472 C**********                                                          S01194
0473 C*****SET*UP*KEY*FOR*INSTALLATION CONTROL RECORD.                    S01194
0474 C**********           MOVEL'01      'ZTABKY 12                       S01194
0475 C**********           MOVE '  10'    ZTABKY                          S01194
0476 C**********                                                          S01194
0477 C********** ZTABKY    CHAINTABLE                99    ON NOT THERE   S01194
0478 C**N99***** RECI      COMP 'D'                  9999  ON, IS DELETED S01194
0479 C**********                                                          S01194
0480 C*****CHECK*SYSTEM*DATE FORMAT, DDMMYY OR MMDDYY.                    S01194
0481 C********** DATF      COMP 'M'                      98MMDDYY, 98 ON  S01194
0482 C**********                                                          S01194
0483 C**********           ENDSR                                          S01194
0600 C**
0601 C**
0602 C********************************************************************
0603 C********************************************************************
0604 C* SUBROUTINE TO ADD AN AMOUNT (ZZAMT) TO THE TOTAL (ZZTOTI,ZZTOTD)
0605 C*   IND '99' IS SET BY AN OVERFLOW ERROR
0606 C*
0607 CSR         GLZADD    BEGSR                           *** GLZADD ****
0608 C*
0609 CSR                   Z-ADDZZAMT     ZZAMT  153     91-DEFINE ZZAMT
0610 CSR 91                GOTO ZZAEND                     AMT = 0.BYPASS
0611 C*
0612 C* SPLIT ZZAMT INTO INTEGER AND DECIMAL FIELDS
0613 CSR                   Z-ADDZZAMT     ZZAMTI 150       INTEGER FIELD
0614 CSR                   MOVE ZZAMT     ZZAMTD  30       DECIMAL FIELD
0615 C* BOTH ZZAMTI AND ZZAMTD CONTAIN A 'SIGN' ZONE NOW
0616 C*
0617 CSR                   EXSR GLZSUM
0618 CSR         ZZAEND    ENDSR                           ** ZZAEND TAG *
0619 C*
0620 C********************************************************************
0621 C* SUBROUTINE TO CARRY OUT THE ADDITION FOR SUBROUTINES -
0622 C*                        GLZADD, GLZSUB, GLZCMP.
0623 C*          PARAMETERS PASSED -
0624 C*                     I/P ZZAMTI ZZAMTD
0625 C*                     O/P ZZTOTI ZZTOTD ZZNEGD IND 96 IND 99.
0626 C*
0627 CSR         GLZSUM    BEGSR                           *** GLZSUM ****
0628 C*
0629 CSR                   Z-ADDZZTOTI    ZZTOTI 150       DEFINE ZZTOTI
0630 CSR                   Z-ADDZZTOTD    ZZTOTD  30       DEFINE ZZTOTD
0631 CSR                   SETOF                     919293
0632 CSR                   SETOF                     949599
0633 C*
0634 C*    DETERMINE SIGN OF ZZAMTI & D,   92 IF NEG
0635 CSR         ZZAMTI    COMP 0                      9293
0636 CSR 93      ZZAMTD    COMP 0                      9293
0637 CSR 93                GOTO ZZSEND                     ZERO BYPASS
0638 C*
0639 C*    DETERMINE SIGN OF ZZTOTI & D, 91 IF NEG.
0640 CSR         ZZTOTI    COMP 0                      9193
0641 CSR 93      ZZTOTD    COMP 0                      9193
0642 C*
0643 C*    IF ZZTOTAL IS ZERO, RETURN ZZAMOUNT.
0644 CSR 93                Z-ADDZZAMTI    ZZTOTI
0645 CSR 93                Z-ADDZZAMTD    ZZTOTD
0646 CSR 93                GOTO ZZSEND                     ZERO BYPASS
0647 C*    IF SIGNS DIFFER BYPASS OVERFLOW CHECKS.
0648 CSR 91N92
0649 CORN91 92             GOTO ZZOFPS
0650 C*
0651 CSR         ZZAMTD    ADD  ZZTOTD    ZZWK2   40
0652 CSR         ZZWK2     COMP 999                  93    '93' = CARRY
0653 CSRN93      ZZWK2     COMP -999                   93    INTO INTEGER.
0654 C*
0655 CSR 93N92   ZZAMTI    ADD  1         ZZWK3  150       ADD 'CARRY' +VE
0656 CSR    93 92ZZAMTI    SUB  1         ZZWK3            SUB 'CARRY' -VE
0657 CSR 93      ZZTOTI    ADD  ZZWK3     ZZWK3
0658 CSRN93      ZZTOTI    ADD  ZZAMTI    ZZWK3
0659 C*
0660 C* IF THE MODULUS OF ZZWK3 IS LT MOD. ZZTOTI THEN O/F HAS OCCURED
0661 CSRN92      ZZWK3     COMP ZZTOTI                 99  -92 MEANS NOS.
0662 CSR 92      ZZWK3     COMP ZZTOTI               99     NEGATIVE
0663 CSRN99                Z-ADDZZWK2     ZZTOTD
0664 CSRN99                Z-ADDZZWK3     ZZTOTI
0665 C*
0666 C* IF O/F ZEROIZE ZZAMT , IND '99' SET AND ZZTOT FIELDS LEFT INTACT.
0667 CSR 99                Z-ADD0         ZZAMT  153
0668 CSR                   GOTO ZZSEND
0669 C*
0670 C* THE 'SIGNS' ARE DIFFERENT
0671 CSR         ZZOFPS    TAG                             ** ZZOFPS TAG**
0672 C* IF ZZAMT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZTOT
0673 C*
0674 CSR 92                Z-SUBZZAMTI    ZZAMTI 150
0675 CSR 92                Z-SUBZZAMTD    ZZAMTD  30
0676 C*
0677 C* IF ZZTOT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZAMT.
0678 C*
0679 CSR 91                Z-SUBZZTOTI    ZZTOTI
0680 CSR 91                Z-SUBZZTOTD    ZZTOTD
0681 C* BOTH ZZAMT AND ZZTOT ARE NOW POSITIVE.
0682 C*
0683 CSR         ZZTOTI    COMP ZZAMTI               93  95
0684 CSR 95      ZZTOTD    COMP ZZAMTD               93  95
0685 C*
0686 C* IF ZZTOT EQ. ZZAMT RETURN ZERO.
0687 CSR 95                Z-ADD0         ZZTOTI
0688 CSR 95                Z-ADD0         ZZTOTD
0689 CSR 95                GOTO ZZSEND
0690 C*
0691 C* IF ZZTOT GT. ZZAMT.
0692 CSR 93      ZZAMTD    COMP ZZTOTD               94
0693 CSR 93 94   ZZTOTI    SUB  1         ZZTOTI
0694 CSR 93 94   ZZTOTD    ADD  1000      ZZWK2
0695 CSR 93      ZZTOTI    SUB  ZZAMTI    ZZTOTI
0696 CSR 93 94   ZZWK2     SUB  ZZAMTD    ZZTOTD
0697 CSR 93N94   ZZTOTD    SUB  ZZAMTD    ZZTOTD
0698 C*
0699 C*
0700 C* IF ZZAMT GT. ZZTOT.
0701 CSRN93      ZZTOTD    COMP ZZAMTD               94
0702 CSRN93 94   ZZAMTI    SUB  1         ZZWK3  150
0703 CSRN93 94   ZZAMTD    ADD  1000      ZZWK2
0704 CSRN93 94   ZZWK3     SUB  ZZTOTI    ZZTOTI
0705 CSRN93N94   ZZAMTI    SUB  ZZTOTI    ZZTOTI
0706 CSRN93 94   ZZWK2     SUB  ZZTOTD    ZZTOTD
0707 CSRN93N94   ZZAMTD    SUB  ZZTOTD    ZZTOTD
0708 C*
0709 C* REVERSE SIGN OF ZZTOT IF LARGER I/P FIELDS WERE NEGATIVE
0710 CSR                   SETOF                     94
0711 CSR 93 91
0712 CORN93 92             SETON                     94
0713 CSR 94                Z-SUBZZTOTI    ZZTOTI
0714 CSR 94                Z-SUBZZTOTD    ZZTOTD
0715 C**
0716 C**   RESTORE SIGN OF ZZAMTI & ZZAMTD IF IT WAS REVERSED.
0717 CSR 92                Z-SUBZZAMTI    ZZAMTI
0718 CSR 92                Z-SUBZZAMTD    ZZAMTD
0719 CSR         ZZSEND    TAG                             ** ZZSEND TAG *
0720 C**
0721 C**   IF ZZTOTD IS ZERO, AND ZZTOTI IS NEG. SET UP ZZNEGD.
0722 CSR                   SETOF                     96
0723 CSR         ZZTOTD    COMP 0                        91
0724 CSR 91      ZZTOTI    COMP 0                      96
0725 CSR 96                MOVE '.000-'   ZZNEGD  5
0726 CSR                   ENDSR                             ** ENDSR **
0727 C********************************************************************
0728 C********************************************************************
0729 C*****TABCHN-***TO*ACCESS*TABLE*FILE                                 S01194
0730 C**********     ERROR*INDICATOR*=*60                                 S01194
0731 C**********                                                          S01194
0732 C********** TABCHN    BEGSR                           **** TABCHN ***S01194
0733 C**********                                                          S01194
0734 C********** TABKEY    CHAINTABLE                60                   S01194
0735 C*****N60** RECI      COMP 'D'                  6060                 S01194
0736 C******60**           SETON                     U7U8                 S01194
0737 C******60**           MOVEL'TABLE'   DBFILE                          S01194
0738 C******60**           MOVELTABKEY    DBKEY                           S01194
0739 C**********                                                          S01194
0740 C**********           ENDSR                           **** ENDSR ****S01194
0741 C******************************************    **********************
     C********************************************************************S01117
     C*                                                                   S01117
     C*  *PSSR --- SUBROUTINE TO HANDLE ABNORMAL ERROR CONDITIONS         S01117
     C*                                                                   S01117
     C*  CALLED FROM: AFTER ABNORMAL OPERATION OCCURS                     S01117
     C*                                                                   S01117
     C*  CALLS: NOTHING                                                   S01117
     C*                                                                   S01117
     C********************************************************************S01117
     C*                                                                   S01117
     C           *PSSR     BEGSR                           ** *PSSR **    S01117
     C*                                                                   S01117
     C           @RUN      IFEQ *BLANKS                                   S01117
     C                     MOVE 'Y'       @RUN    1                       S01117
     C                     DUMP                                           S01117
     C                     END                                            S01117
     C                     ENDSR                           ** *PSSR **    S01117
     C*                                                                   S01117
     C********************************************************************S01117
0742 O*
0743 O**  OUTPUT COMEX HEADER
0744 OCOMEXHH E        51
0745 O                         BLK80     80
0746 O                                    1 'H'
0747 O*
0748 O**  OUTPUT COMEX DETAIL
0749 OCOMEXCF E        50
0750 O                                    1 'D'
0751 O                         REGC       3
0752 O                         CCOD       5
0753 O                       03           6 'F'
0754 O                       03FACT       9
0755 O                       03FCNO      11
0756 O**********             05LNRF      11                               S01339
0757 O                       03FAMT      18P
0758 O**********             05ORCA      18P                              S01339
     O                       03PEXP      25P
0760 O**********             05ORDA      25P                              S01339
0761 O                       03AMAVB     32P
0762 O**********             05ORUA      32P                              S01339
0763 O                         CNM       62
0764 O                       03FCCY      65
0765 O**********             05CMCY      65                               S01339
0766 O**********               BRCD      68                               S01117
     O                         BRCA      68                               S01117
     O                         CMPYM     71                               S01117
0767 O**********                         80 '            '                S01117
0767 O                                   80 '         '                   S01117
     O                    55 03WOFSET    88P                                                  CLE040
     O                    56 03FCXCV2    96P                                                  CLE040
     O                    56 03TCALTV   104P                                                  CLE040
0768 O*
0769 O**  OUTPUT COMEX TRAILER
0770 OCOMEXZZ T        LR
0771 O                         BLK80     80
0772 O                                    1 'T'
0773 O                         FCLTOT     4P
0774 O                         TINT      12P
0775 O                         TDEC      14P
0776 O**
0777 O** REPORT DATA BASE ERRORS
0778 O*E0980P1T   03   U7 U8 LR                                           S01117
     OLE0980AUT   03   U7 U8 LR                                           S01117
     O                                   24 'REFERENCE LE0980AU'          S01117
0779 O**********                         22 'REFERENCE LE0980'            S01117
0780 O                         TITL      89
0781 O                                  104 'DATE'
0782 O                         RUNA     112
0783 O                                  122 'PAGE'
0784 O                         PAGE  Z  127
0785 O        T 2      U7 U8 LR
0786 O                                   71 'EXTRACT COMMITMENT'
0787 O                                   79 'DETAILS'
0788 O        T 13     U7 U8 LR
0789 O                                   71 '------------------'
0790 O                                   79 '--------'
0791 O        T 3      U7 U8 LR
0792 O                                   42 '*** REFERENCE'
0793 O**********               DBPGM     51                               S01117
0794 O**********                         71 ' -DATABASE ERROR AT'         S01117
0795 O**********               DBASE     74                               S01117
0793 O                         DBPGM     53                               S01117
0794 O                                   73 ' -DATABASE ERROR AT'         S01117
0795 O                         DBASE     77                               S01117
0796 O        T 1      U7 U8 LR
0797 O                                   37 'FILE NAME'
0798 O**********               DBFILE    43                               S01117
0799 O**********                         48 'KEY'                         S01117
0800 O**********               DBKEY     78                               S01117
0798 O                         DBFILE    46                               S01117
0799 O                                   51 'KEY'                         S01117
0800 O                         DBKEY     81                               S01117
0801 O**
0802 O**
0803 O** CONTROL REPORT
0804 O        T  103   LR
     O                                   24 'REFERENCE LE0980AU'          S01117
0805 O**********                         22 'REFERENCE LE0980'            S01117
0806 O                         TITL      89
0807 O                                  104 'DATE'
0808 O                         RUNA     112
0809 O                                  122 'PAGE'
0810 O                         PAGE  Z  127
0811 O        T 1      LR
0812 O                                   55 '      EXTRACT COMMI'
0813 O                                   68 'TMENT DETAILS'
0814 O                                   89 ' - FILE CONTROLS     '
0815 O        T 13     LR
0816 O                                   55 '      -------------'
0817 O                                   68 '-------------'
0818 O                                   89 '----------------     '
0819 O        T 1      LR
0820 O                                   28 'S/COMEX - RUN CONTROLS'
0821 O                                   59 'NUMBER'
0822 O                                   84 'VALUE'
0823 O        T 11     LR
0824 O                                   28 '----------------------'
0825 O                                   59 'OF RECORDS'
0826 O                                   84 'OF RECORDS'
0827 O        T 12     LR
0828 O                                   29 'TOTAL RECORDS ON FILE'
0829 O                         FCLTOT3   59
0830 O                         TINT  4   81
0831 O                         TDEC      84
0832 O        T 1      LR
0833 O                                   28 'S/FCLTY - RUN CONTROLS'
0834 O        T 11     LR
0835 O                                   28 '----------------------'
0836 O        T 11     LR
0837 O                                   29 'TOTAL RECORDS ON FILE'
0838 O                         NORE  3   59
0839 O                         VLAF  4   81
0840 O                         VLAL      84
0841 O        T 12     LR
0842 O                                   29 'TOTAL RECORDS ON FILE'
0843 O                                   42 '- CALCULATED'
0844 O                         FCT   3   59
0845 O                         FINT  4   81
0846 O                         FDEC      84
0847 O                    70            111 '***   DIFFERENCE   ***'
     O********T*1******LR*U1**                                            S01339
0849 O**********                         28 'S/LOANS - RUN CONTROLS'      S01339
     O********T*11*****LR*U1**                                            S01339
0851 O**********                         28 '----------------------'      S01339
     O********T*11*****LR*U1**                                            S01339
0853 O**********                         29 'TOTAL RECORDS ON FILE'       S01339
0854 O**********               NORET 3   59                               S01339
0855 O**********               HRWN  4   81                               S01339
0856 O**********               HRDC      84                               S01339
     O********T*12*****LR*U1**                                            S01339
0858 O**********                         29 'TOTAL RECORDS ON FILE'       S01339
0859 O**********                         42 '- CALCULATED'                S01339
0860 O**********               LCT   3   59                               S01339
0861 O**********               LINT  4   81                               S01339
0862 O**********               LDEC      84                               S01339
0863 O********************71**          111 '***   DIFFERENCE   ***'      S01339
0864 O******* T 3      LR                                                 S01117
0865 O*******                            76 '*** END OF REPORT ***'       S01117
** CPY@   **      OBJECT COPYRIGHT
(c) Misys International Banking Systems Ltd. 2001
