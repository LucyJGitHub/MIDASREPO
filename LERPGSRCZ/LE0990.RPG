     H        1                                                           S01117
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas LE Commitment summary report by branch')
0001 H**********                                                          S01117
0002 F********************************************************************
0004 F*                                                                  *
     F*  Midas Customer Lending Module                                S01194
0004 F*                                                                  *
0005 F*       LE0990 - PRINT COMMITMENT SUMMARY REPORT                   *
0006 F*                                                                  *
      *  (c) Finastra International Limited 2001                      *
0008 F*                                                                  *
      *  Last Amend No. MD046248           Date 27Oct17               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *  Prev Amend No. CSD031             Date 10Apr06               *
      *                 CLE040             Date 05Jul04               *
      *                 CGL029             Date 01Sep03               *
      * Midas Release 4.01.02 ----------------------------------------*
      *                 205910             Date 11Jun02               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.04 -----------------------------------------------*
      *                 171784             Date 01Aug00               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
     F*                      090987              DATE 27SEP95            *
     F*                      S01194              DATE 18JAN90            *
0009 F*                      S01117              DATE 25/07/89           *
     F*                                                                  *
     F*------------------------------------------------------------------*
     F*                                                                  *
      *  MD046248 - Finastra Rebranding                               *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CLE040 - Collateralised Lending Phase 2                      *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  205910 - Take negative facility amounts into consideration   *
     F*       171784 - Report shows negative facility amounts            *
     F*                as positive. Add negative sign for facility amt.  *
     F*       090987 - No heading is printed when a specific branch is   *
     F*                specified by the user.                            *
     F*       S01194 - STANDING DATA CHANGES                             *S01194
     F*       S01117 - MULTIBRANCHING                                    *
     F*                                                                  *
0010 F********************************************************************
     F*  C R E A T I O N     P A R A M E T E R S                      *
     F*                                                               *
     F*                                                               *
     F*****************************************************************
0011 F***SCOMX** IP  F      80  7AI     2 DISK                                                CLE040
     FSCOMX   IP  F     104  7AI     2 DISK                                                   CLE040
0012 F*TABLE***IF**F      96 12AI     2 DISK                              S01194
0013 F*E0990P1O   F     132     OF     PRINTER                            S01124
     FLE0990P1O   F     132     OF     PRINTER      KINFDS SPOOL      UC  S01117
     FLE0990AUO   F     132            PRINTER      KINFDS SPOOLU         S01117
0014 F* ID F  C  H  L    FUNCTION OF INDICATORS
0015 F* 01            SCOMX - HEADER
0016 F* 03            SCOMX - DETAIL
0017 F* 05            SCOMX - TRAILER
0018 F**07**********  TABLE - INSTALLATION CONTROL ONE                    S01194
0019 F**08**********  TABLE - INSTALLATION CONTROL TWO                    S01194
0020 F**09**********  TABLE - CURRENCIES RECORD ONE                       S01194
0021 F**10**********  TABLE - REGION RECORD                               S01194
0022 F**
0023 F*       16      AT LEAST ONE DETAIL RECORD READ
0024 F**
0025 F********20****  TABLE CHAIN FAIL                                    S01194
0026 F*       21      USED IN AMOUNTS CONVERSION LOOP
     F*       22      REGION CODE BLANK
0027 F**
0028 F*       38      TOTAL OUTSTANDING NEGATIVE
0029 F*       39      TOTAL AVAILABLE NEGATIVE
0030 F*       40      0 DECIMAL POSITIONS
0031 F*       41      1 DECIMAL POSITIONS
0032 F*       42      2 DECIMAL POSITIONS
0033 F*       43      3 DECIMAL POSITIONS
     F**                                                                  S01117
     F*       37      ALLOW OUTPUT                                        S01117
     F*       60      MULTIBRANCHING INDICATOR                            S01117
     F*       65      REQUESTS SINGLE BRANCH                              S01117
     F*       75      ALLOW CONTROL TOTAL CHECKING                        S01117
     F*       85      REPORT FILE OPENED IN FIRST PROCESSING CYCLE        S01117
0034 F**
0035 F*       45      CONTROLS OUT OF BALANCE
0036 F*       80      MULTIPLY DIVIDE IND.=0...CURRENCY CONVERSION
0037 F**
0038 F*          U7 U8DATA BASE ERROR
0039 F*          U8   FILE CONTROLS OUT OF BALANCE
0040 F*             L3CHANGE OF BRANCH
0041 F*             L2CHANGE OF REGION
0042 F*             L1CHANGE OF COUNTRY
0043 E                    AMT         3 13 0             SCOMX AMOUNTS
0044 E                    BMT         3 13 0             IN BASE CURRENCY
0045 E                    POWR    1   7  7 3             POWER ARRAY
     E                    CPY@    1   1 80
0046 E                    TMT         3 13 0             TOTALS BY COUNTRY
     E                    ACT         3 15 0                                                  CLE040
     E                    BCT         3 15 0                                                  CLE040
     E                    TCT         3 15 0                                                  CLE040
0047 I**
0048 I***  SCOMX - HEADER
0049 ISCOMX   NS  01   1 CH
0050 I                                        1   1 RECI
0051 I**
0052 I***  SCOMX - DETAIL
0053 ISCOMX   NS  03   1 CD
0054 I                                        1   1 RECI
0055 I                                        2   3 REGC  L2        22
0056 I                                        4   5 CCOD  L1
0057 I                                        6  11 FLNO
0058 I****   1.COMMITMENT AMT.  2.OUTSTANDING AMT.  3.AVAILABLE AMT.
0059 I                                    P  12  18 AMT,1
0060 I                                    P  19  25 AMT,2
0061 I                                    P  26  32 AMT,3
0062 I                                       33  62 CNM
0063 I                                       63  65 CCCY
0064 I**********                             66  68 BRCD  L3              S01117
     I                                       66  68 BRCA  L3              S01117
0059 I                                    P  81  88 ACT,1                                     CLE040
0060 I                                    P  89  96 ACT,2                                     CLE040
0061 I                                    P  97 104 ACT,3                                     CLE040
0065 I**
0066 I***  SCOMX - TRAILER
0067 ISCOMX   NS  05   1 CT
0068 I                                        1   1 RECI
0069 I                                    P   2   40NORE
0070 I                                    P   5  120TINT
0071 I                                    P  13  140TDEC
0072 I**
0073 I**  SCOMX - CATCHALL
0074 I        NS
0075 I                                        1   1 RECI
0076 I*
0077 I**************                                                      S01194
0078 I*****TABLE*FILE - INSTALLATION CONTROL DATA RECORD 1.               S01194
0079 I**************                                                      S01194
0080 I*TABLE***NS**07   2 C0   3 C1  12 C1                                S01194
0081 I*******AND****  13 C0                                               S01194
0082 I**************                          1   1 RECI                  S01194
0083 I**************                          2   30RECT                  S01194
0084 I**************                         12  130RCDE                  S01194
0085 I**************                         14  66 TITL                  S01194
0086 I**************                         67  67 DATF                  S01194
0087 I**************                         68  700DFBR                  S01194
0088 I**************                         74  74 MODI1                 S01194
0089 I**************                         75  75 MODI2                 S01194
0090 I**************                         76  76 MODI3                 S01194
0091 I**************                      P  77  790RUND                  S01194
0092 I**************                         80  86 RUNA                  S01194
0093 I**************                         87  870SFLG                  S01194
0094 I**************                      P  90  920LCD                   S01194
0095 I**************                         93  93 CHTP                  S01194
0096 I**************                      P  94  960TNLU                  S01194
0097 I**************                                                      S01194
0098 I**************                                                      S01194
0099 I*****TABLE*FILE - INSTALLATION CONTROL DATA RECORD 2.               S01194
0100 I**************                                                      S01194
0101 I*TABLE***NS**08   1 CD   2 C0   3 C1                                S01194
0102 I*******AND****  12 C1  13 C1                                        S01194
0103 I**************                          1   1 RECI                  S01194
0104 I**************                          2   30RECT                  S01194
0105 I**************                         12  130RCDE                  S01194
0106 I**************                         14  16 BCCY                  S01194
0107 I**************                         17  19 BCYL                  S01194
0108 I**************                         20  22 HOCY                  S01194
0109 I**************                         23  280HEAD                  S01194
0110 I**************                      P  29  310APDA                  S01194
0111 I**************                         35  35 APFQ                  S01194
0112 I**************                      P  36  380LOGS                  S01194
0113 I**************                         39  40 CUZR                  S01194
0114 I**************                      P  41  430DNWD                  S01194
0115 I**************                         44  460BVLP                  S01194
0116 I**************                         47  49 LOCY                  S01194
0117 I**************                         50  510FDAY                  S01194
0118 I**************                         52  52 ACLD                  S01194
0119 I**********                             53  53 MBIN                  S01194
0120 I**************                         86  86 ISAV                  S01194
0121 I**************                      P  87  890LLOG                  S01194
0122 I**************                      P  90  920LCD                   S01194
0123 I**************                         93  93 CHTP                  S01194
0124 I**************                      P  94  960TNLU                  S01194
0125 I**************                                                      S01194
0126 I**************                                                      S01194
0127 I*****TABLE*FILE - CURRENCIES RECORD 1.                              S01194
0128 I**************                                                      S01194
0129 I*TABLE***NS**09   1 CD   2 C2   3 C0                                S01194
0130 I*******AND****  13 C1                                               S01194
0131 I**************                          1   1 RECI                  S01194
0132 I**************                          2   30RECT                  S01194
0133 I**************                         10  12 CCY                   S01194
0134 I**************                         13  130SREC                  S01194
0135 I**************                         14  27 CCNM                  S01194
0136 I**************                      P  28  348SPOT                  S01194
0137 I**************                         35  37 CCYS                  S01194
0138 I**************                         38  380CDP                   S01194
0139 I**************                         39  390TNOT                  S01194
0140 I**************                         40  40 DCCY                  S01194
0141 I**************                         41  44 SRC1                  S01194
0142 I**************                         45  48 SRC2                  S01194
0143 I**************                         49  520TACC                  S01194
0144 I**************                         53  560TEQV                  S01194
0145 I**************                         57  600SWQV                  S01194
0146 I**************                         61  640TAC4                  S01194
0147 I**************                         65  680TAC5                  S01194
0148 I**************                         69  69 HIND                  S01194
0149 I**************                      P  70  768PART                  S01194
0150 I**************                         77  780SSNO                  S01194
0151 I**************                      P  79  858ERLC                  S01194
0152 I**************                         86  860MDIN                  S01194
0153 I**************                         87  870MDIA                  S01194
0154 I**************                         88  880MDIB                  S01194
0155 I**************                      P  90  920LCD                   S01194
0156 I**************                         93  93 CHTP                  S01194
0157 I**************                      P  94  960TNLU                  S01194
0158 I**************                                                      S01194
0159 I**************                                                      S01194
0160 I*****TABLE*FILE - REGION CODES RECORD.                              S01194
0161 I**************                                                      S01194
0162 I*TABLE***NS**10   1 CD   2 C5   3 C1                                S01194
0163 I**************                          1   1 RECI                  S01194
0164 I**************                          2   30RECT                  S01194
0165 I**************                         12  13 REGC                  S01194
0166 I**************                         14  43 REGN                  S01194
0167 I**************                         44  460DEPT                  S01194
0168 I**************                      P  47  490DEPX                  S01194
0169 I**************                      P  50  540DEPA                  S01194
0170 I**************                         55  55 DEPF                  S01194
0171 I**************                      P  56  580DEPR                  S01194
0172 I**************                         59  600DLRD                  S01194
0173 I**************                         61  630FRXT                  S01194
0174 I**************                      P  64  660FRXX                  S01194
0175 I**************                      P  67  710FRXA                  S01194
0176 I**************                         72  72 FRXF                  S01194
0177 I**************                      P  73  750FRXR                  S01194
0178 I**************                         76  770FLRD                  S01194
0179 I**************                      P  90  920LCD                   S01194
0180 I**************                         93  93 CHTP                  S01194
0181 I**************                      P  94  960TNLU                  S01194
0182 I**************                                                      S01194
0183 I*****TABLE*-*CATCHALL                                               S01194
0184 I********NS****                                                      S01194
0185 I**************                          1   1 RECI                  S01194
     I*                                                                   S01194
     ISDBANK    E DSSDBANKPD                                              S01194
     I** EXTERNAL DS FOR BANK DETAILS                                     S01194
     I**                                                                  S01194
     I              BJURPT                          TITL                  S01194
     I              BJCYCD                          BCCY                  S01194
     I*                                                                   S01117
     ISDBRCH    E DSSDBRCHPD                                              S01117
     I** EXTERNAL DS FOR BRANCHES DETAILS                                 S01117
     I**                                                                  S01117
     I              A8BRNM                          BRNM                  S01117
     I*                                                                   S01194
     ISDCURR    E DSSDCURRPD                                              S01194
     I** EXTERNAL DS FOR CURRENCY DETAILS                                 S01194
     I**                                                                  S01194
     I              A6NBDP                          CDP                   S01194
     I              A6SPRT                          SPOT                  S01194
     I*                                                                   S01194
     ISDREGN    E DSSDREGNPD                                              S01194
     I** EXTERNAL DS FOR REGION DETAILS                                   S01194
     I**                                                                  S01194
     I              A3RGNM                          REGN                  S01194
     I*                                                                   S01194
     ISCSARD    E DSSCSARDPD                                                                  CLE040
      ** External DS for Switchable Details                                                   CLE040
      *                                                                                       CLE040
     IDSFDY     E DSDSFDY                                                 S01194
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01194
     I*                                                                   S01194
     IDSSDY     E DSDSSDY                                                 S01194
     I* SECOND DS FOR ACCESS PROGRAMS, LONG DATA STRUCTURE                S01194
     I*                                                                   S01194
0186 I**
0187 I***  LOCAL DATA AREA
0188 ILDA        UDS                            256
0189 I**********                            134 138 DBFILE                S01117
0190 I**********                            139 167 DBKEY                 S01117
0191 I**********                            168 175 DBPGM                 S01117
0192 I**********                            176 177 DBASE                 S01117
     I                                      134 141 DBFILE                S01117
     I                                      142 170 DBKEY                 S01117
     I                                      171 180 DBPGM                 S01117
     I                                      181 1830DBASE                 S01117
0925 I**                                                                  S01117
0925 I**   FILE INFORMATION DATA STRUCTURE                                S01117
0925 I**                                                                  S01117
     ISPOOL       DS                                                      S01117
     I                                       83  92 SFILE                 S01117
     I                                    B 123 1240SFNUM                 S01117
     ISPOOLU      DS                                                      S01117
     I                                       83  92 SFILEU                S01117
     I                                    B 123 1240SFNUMU                S01117
     I**                                                                  S01117
     I**    DATA AREA RUNDAT                                              S01117
     I**                                                                  S01117
     IRUNDT       DS                                                      S01117
     I                                        1   7 RUNA                  S01117
     I                                    P   8  100RUND                  S01117
     I                                       11  11 SSF                   S01117
     I                                       12  12 DATF                  S01117
     I                                       13  13 MBIN                  S01117
     I**                                                                  S01117
     C                     MOVEACPY@      BIS@   80
     C********************************************************************S01117
     C           *ENTRY    PLIST                                          S01117
     C                     PARM           SEQ     5           SEQUENCE NO S01117
     C                     PARM           BRNCH   3                       S01117
0193 C**
0194 C***  FIRST CYCLE ONLY
0195 C*****N01***          GOTO BY00                                      090987
     C      46             GOTO BY00                                      090987
0196 C*
0197 C**********           MOVEL'LE0990  'DBPGM                           S01117
     C**                                                                  S01117
     C**      FOR DATABASE ERROR REFERENCE                                S01117
     C**                                                                  S01117
     C                     MOVE *BLANKS   DBPGM                           S01117
     C                     MOVE *BLANKS   DBKEY                           S01117
     C                     MOVE *BLANKS   DBFILE                          S01117
     C                     Z-ADD0         DBASE                           S01117
     C                     MOVEL'LE0990  'DBPGM                           S01117
     C**                                                                  S01117
     C**      IN THE DATAAREA RUNDAT                                      S01117
     C**                                                                  S01117
     C           *NAMVAR   DEFN RUNDAT    RUNDT                           S01117
     C                     IN   RUNDT                                     S01117
     C           *NAMVAR   DEFN           LDA                             S01194
      *                                                                                       CLE040
     C                     MOVE 'N'       CLE025  1                                           CLE040
     C                     MOVE *OFF      *IN55                                               CLE040
     C                     CALL 'AOSARDR0'                                                    CLE040
     C                     PARM '*MSG   ' PRTCD   7                                           CLE040
     C                     PARM '*KEY   ' POPTN   7                                           CLE040
     C                     PARM 'CLE025'  PSARD   6                                           CLE040
     C           SCSARD    PARM SCSARD    DSFDY                                               CLE040
      *                                                                                       CLE040
     C           PRTCD     IFNE *BLANKS                                                       CLE040
     C           PRTCD     ANDNE'*NRF   '                                                     CLE040
     C                     MOVE *ON       *INU7                                               CLE040
     C                     MOVE *ON       *INU8                                               CLE040
     C                     MOVE *ON       *INLR                                               CLE040
     C                     MOVE *ON       *IN99                                               CLE040
     C                     MOVEL'SCSARDPD'DBFILE                                              CLE040
     C                     MOVELPSARD     DBKEY                                               CLE040
     C                     MOVELPOPTN     DBOPTN                                              CLE040
     C                     Z-ADD8         DBASE                                               CLE040
     C                     ENDIF                                                              CLE040
      *                                                                                       CLE040
     C           PRTCD     IFEQ *BLANKS                                                       CLE040
     C                     MOVE 'Y'       CLE025                                              CLE040
     C                     MOVE *ON       *IN55                                               CLE040
     C                     ENDIF                                                              CLE040
      *                                                                                       CLE040
     C                     MOVE 'N'       CLE024  1                                           CLE040
     C                     MOVE *OFF      *IN56                                               CLE040
     C                     CALL 'AOSARDR0'                                                    CLE040
     C                     PARM '*MSG   ' PRTCD                                               CLE040
     C                     PARM '*KEY   ' POPTN                                               CLE040
     C                     PARM 'CLE024'  PSARD                                               CLE040
     C           SCSARD    PARM SCSARD    DSFDY                                               CLE040
      *                                                                                       CLE040
     C           PRTCD     IFNE *BLANKS                                                       CLE040
     C           PRTCD     ANDNE'*NRF   '                                                     CLE040
     C                     MOVE *ON       *INU7                                               CLE040
     C                     MOVE *ON       *INU8                                               CLE040
     C                     MOVE *ON       *INLR                                               CLE040
     C                     MOVE *ON       *IN99                                               CLE040
     C                     MOVEL'SCSARDPD'DBFILE                                              CLE040
     C                     MOVELPSARD     DBKEY                                               CLE040
     C                     MOVELPOPTN     DBOPTN                                              CLE040
     C                     Z-ADD9         DBASE                                               CLE040
     C                     ENDIF                                                              CLE040
      *                                                                                       CLE040
     C           PRTCD     IFEQ *BLANKS                                                       CLE040
     C                     MOVE 'Y'       CLE024                                              CLE040
     C                     MOVE *ON       *IN56                                               CLE040
     C                     ENDIF                                                              CLE040
      *                                                                                       CLE040
     C**                                                                  S01117
     C**      SETUP MULTIBRANCHING INDICATOR                              S01117
     C**                                                                  S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C                     SETON                     60                   S01117
     C                     END                                            S01117
     C           BRNCH     IFNE 'ALL'                                     S01117
     C                     SETON                     65                   S01117
     C                     END                                            S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C           BRNCH     ANDEQ'ALL'                                     S01117
     C           MBIN      ORNE 'Y'                                       S01117
     C                     SETON                     75                   S01117
     C                     END                                            S01117
     C**                                                                  S01117
     C**      OPEN SPOOL FILE WHEN NON-MULTIBRANCHING                     S01117
     C**                                                                  S01117
     C           MBIN      IFNE 'Y'                                       S01117
     C                     SETON                     3785  ALLOW OUTPUT   S01117
     C                     OPEN LE0990P1                                  S01117
     C                     Z-ADD0         PAGE                            S01117
     C**   ENSURE REPORT SPOOL FILE RECORDED BY RCF                       S01117
     C**
     C                     Z-ADDSFNUM     ZSNUM   60                      S01117
     C                     OUT  LDA
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           SEQ                             S01117
     C                     PARM *BLANKS   SENTY   3                       S01117
     C                     PARM           SFILE                           S01117
     C                     PARM           ZSNUM                           S01117
     C                     PARM           ZSERR   1                       S01117
     C           *LOCK     IN   LDA
      *                                                                   S01117
     C           ZSERR     IFEQ 'Y'                                       S01117
      **  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM       S01117
     C                     SETON                     U7U8LR               S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C**
     C                     END                                            S01117
0198 C**
0199 C**   ACCESS INSTALLATION CONTROL ONE
0200 C                     EXSR ZSYSTM
0201 C     N99             GOTO BY01
0202 C**************       MOVE 'TABLE'   DBFILE                          S01194
0203 C**************       MOVELZTABKY    DBKEY            ***************S01194
0204 C**********           MOVEL'01'      DBASE            * DATABASE 01 *S01117
0205 C**************       SETON                     U7U8  ***************S01194
0206 C                     GOTO END
0207 C*
0208 C           BY01      TAG                             ** BY01  TAG **
0209 C**************                                                      S01194
0210 C*****ACCESS*INSTALLATION CONTROL TWO                                S01194
0211 C**************       MOVEL'01      'ZTABKY                          S01194
0212 C**************       MOVE '  11'    ZTABKY                          S01194
0213 C**************       EXSR TABCHN                                    S01194
0214 C********N20***       GOTO BY02                                      S01194
0215 C**************                                                      S01194
0216 C**************                                       ***************S01194
0217 C**********           MOVEL'02'      DBASE            * DATABASE 02 *S01117
0218 C**************                                       ***************S01194
0219 C**************       GOTO END                                       S01194
0220 C**************                                                      S01194
0221 C***********BY02      TAG                             ** BY02  TAG **S01194
0222 C**
0223 C***  PICK BASE CURRENCY DECIMAL POSITIONS
0224 C**************       MOVEL'20      'ZTABKY                          S01194
0225 C**************       MOVELBCCY      WK1     4                       S01194
0226 C**************       MOVE '1'       WK1                             S01194
0227 C**************       MOVE WK1       ZTABKY                          S01194
0228 C**************       EXSR TABCHN                                    S01194
0229 C********N20***       GOTO BY03                                      S01194
     C                     CALL 'AOCURRR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C                     PARM BCCY      CCYKEY  3                    A  S01194
     C           SDCURR    PARM SDCURR    DSSDY                        B  S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     SETON                     U7U8                 S01194
     C                     MOVE 'SDCURRPD'DBFILE                          S01194
     C                     MOVE CCYKEY    DBKEY                           S01194
     C                     MOVE @OPTN     DBOPTN  7                       S01194
0230 C*
0231 C*                                                    ***************
0232 C**********           MOVEL'03'      DBASE            * DATABASE 03 *S01117
0232 C                     Z-ADD3         DBASE            * DATABASE 03 *S01117
0233 C*                                                    ***************
0234 C                     GOTO END
     C                     END                                            S01194
0235 C***********BY03      TAG                             ** BY03  TAG **S01194
0236 C                     MOVE CDP       BCDP    10
0237 C**
0238 C***  CHECK NUMBER OF DECIMAL PLACES
0239 C           BCDP      COMP 0                        40
0240 C        N40BCDP      COMP 2                    434142
0241 C**
0242 C***  INITIATE RECORD COUNT & LINE COUNT
0243 C                     Z-ADD1         RECTOT  50
     C                     MOVE '1'       *IN46                           090987
0244 C******************************************
0245 C           BY00      TAG                             ** BY00  TAG **
0246 C**
0247 C**  IF NOT SCOMX DETAIL - GO TO END
0248 C     N03             GOTO END
     C**                                                                  S01117
     C**      END AFTER THE REQUESTED BRANCH                              S01117
     C**                                                                  S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C           BRNCH     ANDNE'ALL'                                     S01117
     C           BRCA      ANDGTBRNCH                                     S01117
     C                     SETON                     LR05                 S01117
     C                     SETOF                     37                   S01117
     C                     GOTO END                                       S01117
     C                     END                                            S01117
     C**                                                                  S01117
     C**      SKIP TO THE REQUESTED BRANCH                                S01117
     C**                                                                  S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C           BRNCH     ANDNE'ALL'                                     S01117
     C           BRNCH     ANDNEBRCA                                      S01117
     C                     SETOF                     37                   S01117
     C                     GOTO END                                       S01117
     C                     END                                            S01117
0249 C** AT LEAST ONE DETAIL RECORD READ - SET INDICATOR
0250 C                     SETON                     16
0251 C**
0252 C***  ACCUMULATE CONTROLS
0253 C           RECTOT    ADD  1         RECTOT
     C** AT CHANGE OF BRANCH CODE EXECUTE PRINT                           S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C           *INL3     ANDEQ'1'                                       S01117
     C                     CLOSELE0990P1                                  S01117
     C           BRNCH     IFEQ 'ALL'                                     S01117
     C           BRNCH     OREQ BRCA                                      S01117
     C                     SETON                     3785  ALLOW OUTPUT   S01117
     C                     OPEN LE0990P1                                  S01117
     C                     Z-ADD0         PAGE                            S01117
     C**   ENSURE REPORT SPOOL FILE RECORDED BY RCF                       S01117
     C**
     C                     Z-ADDSFNUM     ZSNUM   60                      S01117
     C                     OUT  LDA                                       S01194
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           SEQ                             S01117
     C                     PARM BRCA      SENTY   3                       S01117
     C                     PARM           SFILE                           S01117
     C                     PARM           ZSNUM                           S01117
     C                     PARM           ZSERR   1                       S01117
     C           *LOCK     IN   LDA                                       S01194
      *                                                                   S01117
     C           ZSERR     IFEQ 'Y'                                       S01117
      **  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM       S01117
     C                     SETON                     U7U8LR               S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C**
     C*                                                                   S01117
     C**  GET BRANCH NAME                                                 S01117
     C**********           CALL 'AOBRCHR0'                                S01117              CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       S01117
     C                     PARM '*KEY   ' @OPTN   7                       S01117
     C                     PARM BRCA      @DSNB   3                       S01117
     C********** SDBRCH    PARM SDBRCH    DSFDY                           S01117              CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C*                                                                   S01117
     C           @RTCD     IFNE *BLANKS                                   S01117
     C                     SETON                     U7U8LR               S01117
     C                     MOVEL'SDBRCHPD'DBFILE                          S01117
     C                     MOVEL@DSNB     DBKEY            ************** S01117
     C                     MOVEL@OPTN     DBOPTN  7        *DATABASE 06 * S01117
     C                     Z-ADD6         DBASE            ************** S01117
     C                     MOVEL*BLANKS   BRNM                            S01117
     C                     EXSR *PSSR                                     S01117
     C                     GOTO BY05                                      S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C                     ELSE                                           S01117
     C                     SETOF                     37                   S01117
     C                     END                                            S01117
     C                     END                                            S01117
0254 C*
0255 C                     MOVE AMT,1     ZZAMT
     C           ZZAMT     IFLT 0                                                             205910
     C                     Z-SUBZZAMT     ZZAMT                                               205910
     C                     END                                                                205910
0256 C                     EXSR GLZADD
0257 C**
0258 C***  CONVERT AMOUNTS TO BASE CURRENCY PRIOR TO ACCUMULATION
0259 C***  PICK UP CURRENCY RECORD
0260 C**************       MOVEL'20      'ZTABKY                          S01194
0261 C**************       MOVELCCCY      WK1                             S01194
0262 C**************       MOVE '1'       WK1                             S01194
0263 C**************       MOVE WK1       ZTABKY                          S01194
0264 C**************       EXSR TABCHN                                    S01194
0265 C*****N20******       GOTO BY04                                      S01194
     C                     CALL 'AOCURRR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C                     PARM CCCY      CCYKEY                       A  S01194
     C           SDCURR    PARM SDCURR    DSSDY                        B  S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     SETON                     U7U8                 S01194
     C                     MOVE 'SDCURRPD'DBFILE                          S01194
     C                     MOVE CCYKEY    DBKEY                           S01194
     C                     MOVE @OPTN     DBOPTN  7                       S01194
0266 C*
0267 C*                                                    ***************
0268 C**********           MOVEL'04'      DBASE            * DATABASE 04 *S01117
0268 C                     Z-ADD4         DBASE            * DATABASE 04 *S01117
0269 C*                                                    ***************
0270 C**********           GOTO END                                       S01117
     C                     GOTO BY05                                      S01117
     C                     END                                            S01194
0271 C***********BY04      TAG                             ** BY04  TAG **S01194
0272 C                     Z-ADD1         X       10
0273 C**
0274 C***  CONVERT TO BASE
0275 C           BCDP      SUB  CDP       XX      10
0276 C           XX        ADD  4         XX
0277 C***********MDIN      COMP 0                        80               S01194
0277 C           A6MDIN    COMP 'D'                      80               S01194
0278 C* 80 ON = DIVIDE
0279 C      80   SPOT      DIV  POWR,XX   ERAT   159H
0280 C      80   1         DIV  ERAT      ERAT
0281 C*
0282 C     N80   SPOT      MULT POWR,XX   ERAT      H
0283 C*
0284 C           LOOP      TAG                             ** LOOP  TAG **
0285 C           AMT,X     MULT ERAT      BMT,X     H
0286 C*  ACCUMULATE
0287 C           TMT,X     ADD  BMT,X     TMT,X  130
0288 C           X         ADD  1         X
0289 C           X         COMP 4                        21
0290 C     N21             GOTO LOOP
      *                                                                                       CLE040
     C           CLE025    IFEQ 'Y'                                                           CLE040
     C           CLE024    OREQ 'Y'                                                           CLE040
      *                                                                                       CLE040
     C                     Z-ADD1         Y       10                                          CLE040
      *                                                                                       CLE040
     C           Y         DOWLT4                                                             CLE040
     C           ACT,Y     MULT ERAT      BCT,Y     H                                         CLE040
     C                     ADD  BCT,Y     TCT,Y                                               CLE040
     C                     ADD  1         Y                                                   CLE040
     C                     ENDDO                                                              CLE040
      *                                                                                       CLE040
     C                     ENDIF                                                              CLE040
     C**
     C**   BYPASS IF REGION CODE BLANK
     C**
     C   22                GOTO BY05
0291 C**
0292 C***  PICK UP REGION NAME
0293 C******L2******       MOVEL'51'      ZTABKY                          S01194
0294 C******L2******       MOVE REGC      ZTABKY                          S01194
0295 C******L2******       EXSR TABCHN                                    S01194
     C           *INL2     IFEQ '1'                                       S01194
     C                     CALL 'AOREGNR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C                     PARM REGC      @KEY    2                       S01194
     C           SDREGN    PARM SDREGN    DSFDY                           S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     SETON                     U7U8LR               S01194
     C                     MOVEL'SDREGNPD'DBFILE                          S01194
     C                     MOVEL@KEY      DBKEY                           S01194
     C                     MOVEL@OPTN     DBOPTN  7                       S01194
     C                     Z-ADD5         DBASE                           S01194
     C                     GOTO END                                       S01194
0296 C******L2N20***       GOTO BY05                       ***************S01194
0297 C******L2***          MOVE '05'      DBASE            * DATABASE 05 *S01194
0298 C******L2***          GOTO END                        ***************S01117
     C                     END                                            S01194
     C                     END                                            S01194
0299 C           BY05      TAG                             ** BY05 TAG **
0300 C**
0301 C      L2
0302 COR    L3
0303 COR    OF             EXCPT
0304 C           END       TAG                             ** END  TAG **
0305 C   U7 U8             SETON                     LR
0306 C** PRINT HEADINGS IF DATABASE ERROR IN FIRST CYCLE
0307 C***01*U7*U8          EXCPT                                          090987
     C  N46 U7 U8          EXCPT                                          090987
0308 C*
0309 C**
0310 C*** IF TRAILER CHECK BALANCES
0311 C     N05             GOTO FIN
0312 C           RECTOT    ADD  1         RECTOT
0313 C*
0314 C*******    RECTOT    COMP NORE                 4545                 S01117
0315 C**** N45   ZZTOTI    COMP TINT                 4545                 S01117
0316 C**** N45   ZZTOTD    COMP TDEC                 4545                 S01117
0314 C   75      RECTOT    COMP NORE                 4545                 S01117
0315 C   75N45   ZZTOTI    COMP TINT                 4545                 S01117
0316 C   75N45   ZZTOTD    COMP TDEC                 4545                 S01117
0317 C*
0318 C                     SETON                     LR
0319 C      45             SETON                     U8
0320 C**********                                                          S01117
0321 C***IF NO DETAILS TO REPORT,PRINT HEADINGS                           S01117
0322 C**N16*****           EXCPT                                          S01117
0323 C**********                                                          S01117
0324 C           FIN       TAG                             ** FIN  TAG ***
     CL1         TMT,1     COMP 0                      51                 171784
0325 CL1         TMT,2     COMP 0                      38
0326 CL1         TMT,3     COMP 0                      39
     CL1 55      TCT,1     COMP 0                      57                                     CLE040
     CL1 56      TCT,2     COMP 0                      58                                     CLE040
     CL1 56      TCT,3     COMP 0                      59                                     CLE040
     C*                                                                   S01117
     C**   ENSURE TOTALS SPOOL FILE RECORDED BY RCF                       S01117
     C**
     CLR                   Z-ADDSFNUMU    ZSNUMU  60                      S01117
     C                     OUT  LDA                                       S01194
     CLR                   CALL 'ZSFILE'                                  S01117
     CLR                   PARM           SEQ                             S01117
     CLR                   PARM *BLANKS   SENTY   3                       S01117
     CLR                   PARM           SFILEU                          S01117
     CLR                   PARM           ZSNUMU                          S01117
     CLR                   PARM           ZSERR                           S01117
     C           *LOCK     IN   LDA                                       S01194
     CLR         ZSERR     IFEQ 'Y'                                       S01117
      **  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM       S01117
     CLR                   SETON                     U7U8LR               S01117
     CLR                   RETRN                                          S01117
     CLR                   END                                            S01117
     C**
     CLR U7 U8             EXSR *PSSR                                     S01117
     C*                                                                   S01117
     C**   OPEN REPORT FILE WHEN NO DETAIL TO REPORT                      S01117
     CLRN85                EXSR #ZZ                                       S01117
     C**   PRINT HEADINGS FOR NO DETAILS TO OUTPUT                        S01117
     CLRN16N46             EXSR ZSYSTM                                    090987
     CLRN16N46             IN   RUNDT                                     090987
     CLRN16                EXCPT                                          S01117
0327 C********************************************************************
0328 C**************                                                      S01194
0329 C*****-*TABCHN.  SUBROUTINE TO CHAIN TO TABLE FILE                   S01194
0330 C*****-*CALLED*AT VARIOUS STAGES IN DETAIL CALCS                     S01194
0331 C***********TABCHN    BEGSR                           ***  TABCHN ***S01194
0332 C**************                                                      S01194
0333 C***********ZTABKY    CHAINTABLE                20                   S01194
0334 C*****N20***RECI      COMP 'D'                  2020                 S01194
0335 C******20******       MOVE 'TABLE'   DBFILE                          S01194
0336 C******20******       MOVE ZTABKY    DBKEY                           S01194
0337 C******20******       SETON                     U7U8                 S01194
0338 C**************                                                      S01194
0339 C***BLANK*KEY**                                                      S01194
0340 C**************       MOVEL'        'ZTABKY                          S01194
0341 C**************       MOVE '    '    ZTABKY                          S01194
0342 C**************       ENDSR                           **  ENDSR  **  S01194
0343 C********************************************************************S01194
0344 C********************************************************************
0345 C**
0346 C**   ZSYSTM SR. TO CHAIN TO THE INSTALLATION CONTROL DATA RECORD.
0347 C**
0348 C           ZSYSTM    BEGSR                           *** ZSYSTM ***
0349 C**************                                                      S01194
0350 C*****SET*UP*KEY FOR INSTALLATION CONTROL RECORD.                    S01194
0351 C**************       MOVEL'01      'ZTABKY 12                       S01194
0352 C**************       MOVE '  10'    ZTABKY                          S01194
0353 C**************                                                      S01194
0354 C***********ZTABKY    CHAINTABLE                99    ON NOT THERE   S01194
0355 C**N99******RECI      COMP 'D'                  9999  ON, IS DELETED S01194
     C**                                                                  S01194
     C**   ACCESS BANK DETAILS                                            S01194
     C**                                                                  S01194
     C                     CALL 'AOBANKR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDBANK    PARM SDBANK    DSFDY                           S01194
     C*                                                                   S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     SETON                     U7U8LR               S01194
     C                     SETON                     99                   S01194
     C                     MOVEL'SDBANKPD'DBFILE                          S01194
     C                     MOVEL@OPTN     DBKEY            ***************S01194
     C                     MOVEL@OPTN     DBOPTN  7        * DBERROR 001 *S01194
     C                     Z-ADD1         DBASE            ***************S01194
     C                     ELSE                                           S01194
0356 C**
0357 C**   CHECK SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.
0358 C           DATF      COMP 'M'                      98MMDDYY, 98 ON
     C                     END                                            S01194
0359 C**
0360 C                     ENDSR
0361 C**
0362 C**
0363 C********************************************************************
0364 C********************************************************************
0365 C* SUBROUTINE TO ADD AN AMOUNT (ZZAMT) TO THE TOTAL (ZZTOTI,ZZTOTD)
0366 C*   IND '99' IS SET BY AN OVERFLOW ERROR
0367 C*
0368 CSR         GLZADD    BEGSR                           *** GLZADD ****
0369 C*
0370 CSR                   Z-ADDZZAMT     ZZAMT  153     91-DEFINE ZZAMT
0371 CSR 91                GOTO ZZAEND                     AMT = 0.BYPASS
0372 C*
0373 C* SPLIT ZZAMT INTO INTEGER AND DECIMAL FIELDS
0374 CSR                   Z-ADDZZAMT     ZZAMTI 150       INTEGER FIELD
0375 CSR                   MOVE ZZAMT     ZZAMTD  30       DECIMAL FIELD
0376 C* BOTH ZZAMTI AND ZZAMTD CONTAIN A 'SIGN' ZONE NOW
0377 C*
0378 CSR                   EXSR GLZSUM
0379 CSR         ZZAEND    ENDSR                           ** ZZAEND TAG *
0380 C*
0381 C********************************************************************
0382 C* SUBROUTINE TO CARRY OUT THE ADDITION FOR SUBROUTINES -
0383 C*                        GLZADD, GLZSUB, GLZCMP.
0384 C*          PARAMETERS PASSED -
0385 C*                     I/P ZZAMTI ZZAMTD
0386 C*                     O/P ZZTOTI ZZTOTD ZZNEGD IND 96 IND 99.
0387 C*
0388 CSR         GLZSUM    BEGSR                           *** GLZSUM ****
0389 C*
0390 CSR                   Z-ADDZZTOTI    ZZTOTI 150       DEFINE ZZTOTI
0391 CSR                   Z-ADDZZTOTD    ZZTOTD  30       DEFINE ZZTOTD
0392 CSR                   SETOF                     919293
0393 CSR                   SETOF                     949599
0394 C*
0395 C*    DETERMINE SIGN OF ZZAMTI & D,   92 IF NEG
0396 CSR         ZZAMTI    COMP 0                      9293
0397 CSR 93      ZZAMTD    COMP 0                      9293
0398 CSR 93                GOTO ZZSEND                     ZERO BYPASS
0399 C*
0400 C*    DETERMINE SIGN OF ZZTOTI & D, 91 IF NEG.
0401 CSR         ZZTOTI    COMP 0                      9193
0402 CSR 93      ZZTOTD    COMP 0                      9193
0403 C*
0404 C*    IF ZZTOTAL IS ZERO, RETURN ZZAMOUNT.
0405 CSR 93                Z-ADDZZAMTI    ZZTOTI
0406 CSR 93                Z-ADDZZAMTD    ZZTOTD
0407 CSR 93                GOTO ZZSEND                     ZERO BYPASS
0408 C*    IF SIGNS DIFFER BYPASS OVERFLOW CHECKS.
0409 CSR 91N92
0410 CORN91 92             GOTO ZZOFPS
0411 C*
0412 CSR         ZZAMTD    ADD  ZZTOTD    ZZWK2   40
0413 CSR         ZZWK2     COMP 999                  93    '93' = CARRY
0414 CSRN93      ZZWK2     COMP -999                   93    INTO INTEGER.
0415 C*
0416 CSR 93N92   ZZAMTI    ADD  1         ZZWK3  150       ADD 'CARRY' +VE
0417 CSR    93 92ZZAMTI    SUB  1         ZZWK3            SUB 'CARRY' -VE
0418 CSR 93      ZZTOTI    ADD  ZZWK3     ZZWK3
0419 CSRN93      ZZTOTI    ADD  ZZAMTI    ZZWK3
0420 C*
0421 C* IF THE MODULUS OF ZZWK3 IS LT MOD. ZZTOTI THEN O/F HAS OCCURED
0422 CSRN92      ZZWK3     COMP ZZTOTI                 99  -92 MEANS NOS.
0423 CSR 92      ZZWK3     COMP ZZTOTI               99     NEGATIVE
0424 CSRN99                Z-ADDZZWK2     ZZTOTD
0425 CSRN99                Z-ADDZZWK3     ZZTOTI
0426 C*
0427 C* IF O/F ZEROIZE ZZAMT , IND '99' SET AND ZZTOT FIELDS LEFT INTACT.
0428 CSR 99                Z-ADD0         ZZAMT  153
0429 CSR                   GOTO ZZSEND
0430 C*
0431 C* THE 'SIGNS' ARE DIFFERENT
0432 CSR         ZZOFPS    TAG                             ** ZZOFPS TAG**
0433 C* IF ZZAMT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZTOT
0434 C*
0435 CSR 92                Z-SUBZZAMTI    ZZAMTI 150
0436 CSR 92                Z-SUBZZAMTD    ZZAMTD  30
0437 C*
0438 C* IF ZZTOT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZAMT.
0439 C*
0440 CSR 91                Z-SUBZZTOTI    ZZTOTI
0441 CSR 91                Z-SUBZZTOTD    ZZTOTD
0442 C* BOTH ZZAMT AND ZZTOT ARE NOW POSITIVE.
0443 C*
0444 CSR         ZZTOTI    COMP ZZAMTI               93  95
0445 CSR 95      ZZTOTD    COMP ZZAMTD               93  95
0446 C*
0447 C* IF ZZTOT EQ. ZZAMT RETURN ZERO.
0448 CSR 95                Z-ADD0         ZZTOTI
0449 CSR 95                Z-ADD0         ZZTOTD
0450 CSR 95                GOTO ZZSEND
0451 C*
0452 C* IF ZZTOT GT. ZZAMT.
0453 CSR 93      ZZAMTD    COMP ZZTOTD               94
0454 CSR 93 94   ZZTOTI    SUB  1         ZZTOTI
0455 CSR 93 94   ZZTOTD    ADD  1000      ZZWK2
0456 CSR 93      ZZTOTI    SUB  ZZAMTI    ZZTOTI
0457 CSR 93 94   ZZWK2     SUB  ZZAMTD    ZZTOTD
0458 CSR 93N94   ZZTOTD    SUB  ZZAMTD    ZZTOTD
0459 C*
0460 C*
0461 C* IF ZZAMT GT. ZZTOT.
0462 CSRN93      ZZTOTD    COMP ZZAMTD               94
0463 CSRN93 94   ZZAMTI    SUB  1         ZZWK3  150
0464 CSRN93 94   ZZAMTD    ADD  1000      ZZWK2
0465 CSRN93 94   ZZWK3     SUB  ZZTOTI    ZZTOTI
0466 CSRN93N94   ZZAMTI    SUB  ZZTOTI    ZZTOTI
0467 CSRN93 94   ZZWK2     SUB  ZZTOTD    ZZTOTD
0468 CSRN93N94   ZZAMTD    SUB  ZZTOTD    ZZTOTD
0469 C*
0470 C* REVERSE SIGN OF ZZTOT IF LARGER I/P FIELDS WERE NEGATIVE
0471 CSR                   SETOF                     94
0472 CSR 93 91
0473 CORN93 92             SETON                     94
0474 CSR 94                Z-SUBZZTOTI    ZZTOTI
0475 CSR 94                Z-SUBZZTOTD    ZZTOTD
0476 C**
0477 C**   RESTORE SIGN OF ZZAMTI & ZZAMTD IF IT WAS REVERSED.
0478 CSR 92                Z-SUBZZAMTI    ZZAMTI
0479 CSR 92                Z-SUBZZAMTD    ZZAMTD
0480 CSR         ZZSEND    TAG                             ** ZZSEND TAG *
0481 C**
0482 C**   IF ZZTOTD IS ZERO, AND ZZTOTI IS NEG. SET UP ZZNEGD.
0483 CSR                   SETOF                     96
0484 CSR         ZZTOTD    COMP 0                        91
0485 CSR 91      ZZTOTI    COMP 0                      96
0486 CSR 96                MOVE '.000-'   ZZNEGD  5
0487 CSR                   ENDSR                             ** ENDSR **
     C********************************************************************S01117
     C*                                                                   S01117
     C*    SUBROUTINE : #ZZ                                               S01117
     C*                                                                   S01117
     C*    CALLED BY MAIN PROCESSING DURING TOTAL TIME CALCLATIONS IF     S01117
     C*    THE P1 FILES HAVE NOT ALREADY BEEN OPENDED (IE, IF THERE ARE   S01117
     C*    NO RECORDS READ AND THEREFORE FILES OPENING NOT PERFORMED)     S01117
     C*                                                                   S01117
     C           #ZZ       BEGSR                                          S01117
     C*                                                                   S01117
     C**   OPEN P1 SPOOL FILE                                             S01117
     C                     OPEN LE0990P1                                  S01117
     C                     SETON                     37                   S01117
     C**   IF REPORT FOR ALL ENTITIES OR NOT MULTIBRANCHING               S01117
     C**   CALL ZSFILE WITH BLANK SENTY                                   S01117
     C           BRNCH     IFEQ 'ALL'                                     S01117
     C           MBIN      ORNE 'Y'                                       S01117
     C**   ENSURE REPORT SPOOL FILE RECORDED BY RCF                       S01117
     C**                                                                  S01117
     C                     Z-ADDSFNUM     ZSNUM   60                      S01117
     C**                                                                  S01117
     C                     OUT  LDA                                       S01194
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           SEQ                             S01117
     C                     PARM *BLANKS   SENTY   3                       S01117
     C                     PARM           SFILE                           S01117
     C                     PARM           ZSNUM                           S01117
     C                     PARM           ZSERR                           S01117
     C           *LOCK     IN   LDA                                       S01194
      *                                                                   S01117
     C           ZSERR     IFEQ 'Y'                                       S01117
      **  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM       S01117
     C                     SETON                     U7U8LR               S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C                     MOVEL'ALL'     BRCA                            S01117
     C                     MOVEL*BLANKS   BRNM                            S01117
     C**   ELSE REPORT BY ENTITY SO CALL ZSFILE WITH ENTITY REQUESTED     S01117
     C                     ELSE                                           S01117
     C**   ENSURE REPORT SPOOL FILE RECORDED BY RCF                       S01117
     C**                                                                  S01117
     C                     Z-ADDSFNUM     ZSNUM   60                      S01117
     C**                                                                  S01117
     C                     OUT  LDA                                       S01194
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           SEQ                             S01117
     C                     PARM BRNCH     SENTY   3                       S01117
     C                     PARM           SFILE                           S01117
     C                     PARM           ZSNUM                           S01117
     C                     PARM           ZSERR                           S01117
     C           *LOCK     IN   LDA                                       S01194
      *                                                                   S01117
     C           ZSERR     IFEQ 'Y'                                       S01117
      **  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM       S01117
     C                     SETON                     U7U8LR               S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
      *                                                                   S01117
     C*                                                                   S01117
     C                     MOVE BRNCH     BRCA                            S01117
     C**   AND GET ENTITY DETAILS FOR REPORT HEADINGS WHEN                S01117
     C**   MULTIBRANCHING                                                 S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C**********           CALL 'AOBRCHR0'                                S01117              CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       S01117
     C                     PARM '*KEY   ' @OPTN   7                       S01117
     C                     PARM BRNCH     @DSNB   3                       S01117
     C********** SDBRCH    PARM SDBRCH    DSFDY                           S01117              CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C*                                                                   S01117
     C           @RTCD     IFNE *BLANKS                                   S01117
     C                     SETON                     U7U8LR               S01117
     C                     MOVEL'SDBRCHPD'DBFILE                          S01117
     C                     MOVEL@DSNB     DBKEY            ************** S01117
     C                     MOVEL@OPTN     DBOPTN  7        *DATABASE 07 * S01117
     C                     Z-ADD7         DBASE            ************** S01117
     C                     MOVEL*BLANKS   BRNM                            S01117
     C                     EXSR *PSSR                                     S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C                     ENDSR                                          S01117
     C********************************************************************S01117
     C********************************************************************S01117
     C*                                                                   S01117
     C*  *PSSR --- SUBROUTINE TO HANDLE ABNORMAL ERROR CONDITIONS         S01117
     C*                                                                   S01117
     C*  CALLED FROM: AFTER ABNORMAL OPERATION OCCURS                     S01117
     C*                                                                   S01117
     C*  CALLS: NOTHING                                                   S01117
     C*                                                                   S01117
     C********************************************************************S01117
     C*                                                                   S01117
     C           *PSSR     BEGSR                           ** *PSSR **    S01117
     C*                                                                   S01117
     C           @RUN      IFEQ *BLANKS                                   S01117
     C                     MOVE 'Y'       @RUN    1                       S01117
     C                     DUMP                                           S01117
     C                     END                                            S01117
     C                     ENDSR                           ** *PSSR **    S01117
     C*                                                                   S01117
     C********************************************************************S01117
0488 C********************************************************************
0489 O***
0490 O****  PRINT REPORT HEADINGS
0491 O***
0492 O*E0990P1E* 103                                                      S01124
     OLE0990P1E  103   37                                                 S01117
     O                                   24 'REFERENCE  LE0990P1'         S01117
0493 O**********                         22 'REFERENCE  LE0990'           S01117
0494 O                         TITL      89
0495 O                                  104 'DATE'
0496 O                         RUNA     113
0497 O                                  122 'PAGE'
0498 O                         PAGE  Z  128
0499 O******* E 1                                                         S01117
0500 O**********                         11 'BRANCH'                      S01117
0501 O**********               BRCD      16                               S01117
0502 O**********                         66 'COMMITMENT SUMMARY BY CO'    S01117
0503 O**********                         90 'UNTRY AND REGION IN BASE'    S01117
0504 O**********                         99 'CURRENCY'                    S01117
     O        E 1      37                                                 S01117
0502 O                                   47 'COMMITMENT SUMMARY BY CO'    S01117
0503 O                                   71 'UNTRY AND REGION IN BASE'    S01117
0504 O                                   80 'CURRENCY'                    S01117
     O                       60          93 'BRANCH'                      S01117
     O                       60BRCA      97                               S01117
     O                       60          98 '-'                           S01117
     O                 60N65N16          98 ' '                           S01117
     O                       60BRNM     128                               S01117
0505 O******* E 11                                                        S01117
0506 O**********                         66 '------------------------'    S01117
0507 O**********                         90 '------------------------'    S01117
0508 O**********                         99 '---------'                   S01117
     O        E 11     37                                                 S01117
0506 O                                   47 '------------------------'    S01117
0507 O                                   71 '------------------------'    S01117
0508 O                                   80 '---------'                   S01117
0509 O******* E 11                                                        S01117
     O        E 11     37                                                 S01117
     O                      N22           8 'REGION'
     O                      N22REGN      41
0512 O******* E 11                                                        S01117
     O        E 11     37                                                 S01117
0513 O                                   18 'COUNTRY'
0514 O**********                         50 'TOTAL COMMITMENT'                                CLE040
0515 O**********                         75 'TOTAL AVAILABLE'                                 CLE040
0516 O**********                        100 'TOTAL OUTSTANDING'                               CLE040
     O                N55                50 'TOTAL COMMITMENT'                                CLE040
     O                N56                75 'TOTAL AVAILABLE'                                 CLE040
     O                N56               100 'TOTAL OUTSTANDING'                               CLE040
     O                 55                50 'TOTAL COMMITMENT/'                               CLE040
     O                 56                75 'TOTAL AVAILABLE/'                                CLE040
     O                 56               100 'TOTAL OUTSTANDING/'                              CLE040
     O        E 11     37 55                                                                  CLE040
     O       OR        37 56                                                                  CLE040
     O                 55                45 'TOTAL COMMITMENT'                                CLE040
     O                 55                54 'ADJUSTED'                                        CLE040
     O                 56                73 'TOTAL OFFSET'                                    CLE040
     O                 56               101 'TOTAL LENDING VALUE'                             CLE040
0517 O******* E 3      05N16NU7                                           S01117
0517 O        E 3      LRN16NU7                                           S01117
     O       AND       37                                                 S01117
0518 O                                   77 '* NO DETAILS TO REPORT *'
0517 O        E 3      LRN16NU7                                           S01117
     O       AND       37                                                 S01117
     O                 60                66 '*** END OF REPORT FOR'       S01117
0688 O                 60                74 ' BRANCH '                    S01117
     O                 60      BRCA      79                               S01117
     O                 60                85 '   ***'                      S01117
     O                N60                76 '*** END OF REPORT ***'       S01117
0519 O**
0520 O***  PRINT DETAILS BY COUNTRY
0521 O**
0522 O        T 11     L1NU7 16
     O       AND       37                                                 S01117
0523 O                         CNM       30
0524 O                    40   TMT,1  B  50 ' ,   ,   ,   , 0 '
0525 O                    41   TMT,1  B  50 '   ,   ,   , 0 . '
0526 O                    42   TMT,1  B  50 '  ,   ,   , 0 .  '
0527 O                    43   TMT,1  B  50 ' ,   ,   , 0 .   '
     O                       51          51 '-'                           171784
0528 O                    40   TMT,3  B  75 ' ,   ,   ,   , 0 '
0529 O                    41   TMT,3  B  75 '   ,   ,   , 0 . '
0530 O                    42   TMT,3  B  75 '  ,   ,   , 0 .  '
0531 O                    43   TMT,3  B  75 ' ,   ,   , 0 .   '
0532 O                       39          76 '-'
0533 O                    40   TMT,2  B 100 ' ,   ,   ,   , 0 '
0534 O                    41   TMT,2  B 100 '   ,   ,   , 0 . '
0535 O                    42   TMT,2  B 100 '  ,   ,   , 0 .  '
0536 O                    43   TMT,2  B 100 ' ,   ,   , 0 .   '
0537 O                       38         101 '-'
     O        T 11     L1NU7 16                                                               CLE040
     O       AND       37 55                                                                  CLE040
     O       OR        L1NU7 16                                                               CLE040
     O       AND       37 56                                                                  CLE040
     O                 55 40   TCT,1  B  50 '   ,   ,   ,   , 0 '                             CLE040
     O                 55 41   TCT,1  B  50 '  ,   ,   ,   , 0 . '                            CLE040
     O                 55 42   TCT,1  B  50 ' ,   ,   ,   , 0 .  '                            CLE040
     O                 55 43   TCT,1  B  50 '   ,   ,   , 0 .   '                             CLE040
     O                       57          51 '-'                                               CLE040
     O                 56 40   TCT,2  B  75 '   ,   ,   ,   , 0 '                             CLE040
     O                 56 41   TCT,2  B  75 '  ,   ,   ,   , 0 . '                            CLE040
     O                 56 42   TCT,2  B  75 ' ,   ,   ,   , 0 .  '                            CLE040
     O                 56 43   TCT,2  B  75 '   ,   ,   , 0 .   '                             CLE040
     O                       58          76 '-'                                               CLE040
     O                 56 40   TCT,3  B 100 '   ,   ,   ,   , 0 '                             CLE040
     O                 56 41   TCT,3  B 100 '  ,   ,   ,   , 0 . '                            CLE040
     O                 56 42   TCT,3  B 100 ' ,   ,   ,   , 0 .  '                            CLE040
     O                 56 43   TCT,3  B 100 '   ,   ,   , 0 .   '                             CLE040
     O                       59         101 '-'                                               CLE040
0538 O        T 3      LRNU7 16
     O       AND       37N60                                              S01117
0539 O                                   76 '*** END OF REPORT ***'
     O        T 3      L3NU7 16                                           S01117
     O       AND       37 60                                              S01117
     O                                   66 '*** END OF REPORT FOR'       S01117
     O                                   74 ' BRANCH '                    S01117
     O                         BRCA      77                               S01117
     O                                   81 '***'                         S01117
0540 O**
0541 O***  DATA BASE ERRORS
0542 O**
0543 O        T 3      U7 U8
0544 O                                   42 '*** REFERENCE'
0545 O                         DBPGM     53                               S01117
0546 O                                   71 ' -DATABASE ERROR'            S01117
0545 O**********               DBPGM     51                               S01117
0546 O**********                         71 ' -DATABASE ERROR AT'         S01117
0547 O**********               DBASE     74                               S01117
0548 O******* T 1      U7 U8                                              S01117
0549 O**********                         37 'FILE NAME'                   S01117
0550 O**********               DBFILE    43                               S01117
0551 O**********                         48 'KEY'                         S01117
0552 O**********               DBKEY     78                               S01117
0553 O**
0554 O***  CONTROL REPORT
0555 O**
0556 O******* T  103   LR                                                 S01117
     OLE0990AUT  103   LR                                                 S01117
     O                                   24 'REFERENCE LE0990AU'          S01117
0557 O**********                         22 'REFERENCE LE0990'            S01117
0558 O                         TITL      89
0559 O                                  104 'DATE'
0560 O                         RUNA     112
0561 O                                  122 'PAGE'
0562 O**********               PAGE  Z  127                               S01117
0562 O                         PAGE1 Z  127                               S01117
0540 O**                                                                  S01117
0541 O***  DATA BASE ERRORS                                               S01117
0542 O**                                                                  S01117
0543 O        T 3      U7 U8                                              S01117
0544 O                                   42 '*** REFERENCE'               S01117
0545 O                         DBPGM     53                               S01117
0546 O                                   73 ' -DATABASE ERROR AT'         S01117
0547 O                         DBASE     77                               S01117
0548 O        T 1      U7 U8                                              S01117
0549 O                                   37 'FILE NAME'                   S01117
0550 O                         DBFILE    46                               S01117
0551 O                                   51 'KEY'                         S01117
0552 O                         DBKEY     81                               S01117
0563 O        T 1      LR
0564 O                                   58 'COMMITMENT SUMMARY BY CO'
0565 O                                   82 'UNTRY AND REGION IN BASE'
0566 O                                  107 'CURRENCY - FILE CONTROLS'
0567 O        T 13     LR
0568 O                                   58 '------------------------'
0569 O                                   82 '------------------------'
0570 O                                  106 '------------------------'
0571 O                                  107 '-'
0572 O        T 1      LR
0573 O                                   28 'S/SCOMX - RUN CONTROLS'
0574 O                                   59 'NUMBER'
0575 O                                   84 'VALUE'
0576 O        T 11     LR
0577 O                                   28 '----------------------'
0578 O                                   59 'OF RECORDS'
0579 O                                   84 'OF RECORDS'
0580 O        T 11     LR
0581 O                                   29 'TOTAL RECORDS ON FILE'
0582 O                NU7      NORE  3   59
0583 O                NU7      TINT  Z   81
0584 O                NU7      TDEC      84
0585 O        T 13     LR
0586 O                                   29 'TOTAL RECORDS ON FILE'
0587 O                                   42 '- CALCULATED'
0588 O                         RECTOT3   59
0589 O                         ZZTOTIZ   81
0590 O                         ZZTOTD    84
0591 O                    45            111 '***   DIFFERENCE   ***'
     O        T 3      LRN16NU7                                           S01117
     O                                   77 '* NO DETAILS TO REPORT *'    S01117
0592 O******* T 3      LR                                                 S01117
0593 O*******                            76 '*** END OF REPORT ***'       S01117
**  POWR -- USED IN CURRENCY CONVERSION
0000001
0000010
0000100
0001000
0010000
0100000
1000000
** CPY@   **      OBJECT COPYRIGHT
(c) Finastra International Limited 2001
