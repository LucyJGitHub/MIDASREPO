0001 H        1                                                           S01117
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas LE Loans outstanding by industry extract')       *
0002 F*****************************************************************
0003 F*                                                               *
     F*  Midas Customer Lending Module                                *
0005 F*                                                               *
0006 F*     LE1030 - LOANS OUTSTANDING BY INDUSTRY EXTRACT            *
0007 F*                                                               *
      *  (c) Finastra International Limited 2001                      *
      *                                                               *
      *  Last Amend No. AR981899           Date 27Feb23               *
      *  Prev Amend No. MD058815           Date 28Sep21               *
      *                 CLE172             Date 01Oct20               *
      *                 CSD103             Date 10Aug20               *
      *                 MD055733           Date 03Jul20               *
      *                 MD053295           Date 13Apr19               *
      *                 MD050139           Date 23Mar18               *
      *                 MD046248           Date 27Oct17               *
      *                 MD047993           Date 23Sep17               *
      *                 MD035545           Date 11Sep15               *
      *                 CGL184             Date 07Dec16               *
      *                 CLE141             Date 08Feb16               *
      *                 AR830785           Date 07May13               *
      *                 AR996895           Date 25Nov12               *
      *                 CLE134             Date 01Aug12               *
      *                 CLE148             Date 23Jul12               *
      *                 CLE064             Date 06Dec10               *
      *                 263666             Date 01Feb10               *
      *                 CER059             Date 19Jul10               *
      *                 CER016A            Date 19May08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *                 246141             Date 26Mar07               *
      *                 245082             Date 30Jan07               *
      *                 164847             Date 30Nov06               *
      *                 BUG12990           Date 05Jan07               *
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 242286             Date 25Sep06               *
      *                 CSD031             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 CLE042             Date 06Sep05               *
      *                 CIR013             Date 25Apr05               *
      *                 CGL029             Date 01Sep03               *
      *                 CLE028             Date 27Jun02               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.05 -----------------------------------------------*
      *                 CLE011             Date 07Nov00               *
      * Midas DBA 3.03 -----------------------------------------------*
      *                 CIR004             Date 20Jan00               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 121768             Date 19Feb98               *
      *                 126017             Date 18Mar97               *
      *                 CLE005             Date 22MAY97               *
      *                 097885             DATE 31JAN97               *
      *                 095244             DATE 01NOV95               *
      *                 095238             DATE 31OCT95               *
      *                 066550             DATE 04FEB94               *
      *                 S01392             DATE 14SEP92               *
      *                 S01220             DATE 15MAR91               *
      *                 S01270             DATE 22AUG90               *
      *                 S01194             DATE 18JAN90               *
      *                 S01117             DATE 28/09/89              *
      *                 S01147             DATE 20/11/87              *
      *                 E43644             DATE 07/05/87              *
      *                 E86112             DATE 06/04/87              *
      *                 E86111             DATE 06/04/87              *
      *                 E86097             DATE 26/03/87              *
      *                 E10175             DATE 11/03/87              *
      *                 E80945             DATE 25/06/86              *
      *                                                               *
      *---------------------------------------------------------------*
      *                                                               *
      *  AR981899 - Incorrect details on LE1040P1. Compute interest   *
      *             even if ABLN is zero so that manual interest adj  *
      *             can be considered. Also, initialise INTINC field. *
      *             (Child: AR981900)                                 *
      *  MD058815 - Dealing interest Calculation type 6 have different*
      *             interest amount for Calculation type 1 for non-   *
      *             leap year interest period with same parameters.   *
      *             Based from MD052690. (Recompile)                  *
      *  CLE172 - LIBOR Deregulation - Lending (Recompile)            *
      *  CSD103 - LIBOR Deregulation - Common Layer/Standing Data     *
      *  MD055733 - COB: Multiple UTCHOBJEX calls in LEC06A           *
      *             components.                                       *
      *           - Redeliver of MD050139.                            *
      *  MD053295 - Lending loan with Interest Calculation Basis      *
      *             method 3 (30/360) has wrong interest payment      *
      *             amount for month of March (Recompile)             *
      *  MD050139- AOSARDR0 called every time causing performance     *
      *            issue. Recompile due to changes in /COPY           *
      *            ZFREQ/ZFRQ*.                                       *
      *  MD046248 - Finastra Rebranding                               *
      *  MD047993 - Modified MD035545. Removed dependency on Accrue   *
      *             on Last Day indicator.                            *
      *  MD035545 - LE: Interest Calculation in Leap year. Consider   *
      *             Accrue on Last Day Indicator for method 6.        *
      *  CGL184 - New Frequencies for Account Statements (Recompile)  *
      *  CLE141 - Currency and Location Business Day Convention       *
      *           (Recompile)                                         *
      *  AR830785 - Recompiled due to changes in core hook RULE78Z1.  *
      *             (Child: AR830786)                                 *
      *  AR996895 - Incorrect acrrual interest calculation            *
      *             (Child: AR996897) (Recompile)                     *
      *  CLE134 - Past Due Call Loan Processing                       *
      *  CLE148 - Alpha Loan Reference                                *
      *  CLE064 - Enhancement of Lending Frequencies (Recompile)      *
      *  263666 - Recompiled due to changes in ZINTDYZ2               *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  CER016A - German Interest Calculation: Upgarde of FGE059     *
      *            to Midas Plus (Recompile)                          *
      *  246141 - Recompiled due to changes in ZINTDYZ2               *
      *  245082 - Loans with first and last day accrual should be     *
      *           treated as first day accruals until maturity        *
      *           date.  Then add one day on the maturity date.       *
      *           Applied fix 235784 from Release 4.                  *
      *  164847 - Recompile over changes in /COPY ZINTDYZ2.           *
      *  BUG12990 - Recompiled due to changes in ZINTDYZ2/ZINTDYZ2LE  *
      *  242286 - Recompile over changes in /COPY ZINTDYZ2.           *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CLE042 - Extended Loan Sub Type                              *
      *  CIR013 - Additional Calculation Method for FRA/IRS/CCF       *
      *           Recompile over GLINTC and ZINTDY.                   *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  CLE028 - Flat Rate Personal Loans (Rule of 78s)              *
      *  CLE011 - Rate Fixing Days for Lending Rollover Processing    *
      *           Recompile                                           *
      *  CIR004 - Dealing Calculation Method Change.                  *
      *         - Recompiled due to GLINTC and ZINTDY changes         *
     F*  121768 - Recompile over changed GLINTCZ1                     *
     F*  126017 - Correction to interest calculation for calculation  *
     F*           basis 6 in SR/GLINTC. Add SR/ZDAT10                 *
     F*  CLE005 - Customer Lending Enhancements - Others (T3)         *
     F*  097885 - Recompiled for wrong calculation of number of day   *
     F*           interest (ZINTDYZ2).                                *
     F*  095244 - Recompiled for Calculation method 3                 *
     F*  095238 - Recompiled for Calculation method 3                 *
     F*    066550 - GLINTC has had historical problems and inaccuracies  *
     F*             and is now externaly descibed and changed to use     *
     F*             ZINTDYZ1. See document atached to error no on GEMS   *
     A*     S01392  -  JAPANESE SUB MODULE ENHANCEMENTS                  *
     F*     S01220  -  AMENDED FOR STRATEGIC RISK MANAGEMENT             *S01220
     F*                RELEASE 10 TO ALLOW THE INPUT OF A BOOK           *S01220
     F*                CODE AGAINST A LOAN.                              *S01220
     F*     S01270  -  CUSTOMER LENDING AMENDMENTS                       *S01194
     F*     S01194  -  STANDING DATA CHANGES                             *S01194
0011 F*     S01117  -  MULTI-BRANCHING II                                *S01117
     F*     S01147  -  RELEASE 22 (AMENDMENT TO GLINTC)                  *S01147
     F*     E43644  -  WRONG YTD AVERAGE BEING CALCULATED.               *E43644
     F*     E86112  -  CALCULATE INTEREST FROM INTEREST CONTROL DATE     *E86112
     F*                FOR LOANS WITHOUT MATURITY DATE.                  *E86112
     F*     E86111  -  CALCULATE INTEREST UP TO LAST CALENDAR DAY OF     *E86111
     F*                MONTH.                                            *E86111
     F*     E86097  -  AMENDED TO USE YEAR END DATE/LAST YEAR END        *E86097
     F*                DATE AND NOT '31 DEC'                             *E86097
     F*     E10175  -  INDICATOR 06 SHOULD BE SET ON BY MATURED LOANS    *E10175
     F*                AS WELL AS LIVE LOANS,AS IT SHOULD BE POSSIBLE    *E10175
     F*                TO LINK A PARTICIPATION RECORD TO AN ORIGINAL     *E10175
     F*                LOAN THAT HAS NOW MATURED WITHOUT CAUSING A       *E10175
     F*                DATABASE ERROR.                                   *E10175
0011 F*     E80945  -  INDICATOR 98 SETTING IS SAVED AND RESTORED        *S01117
0011 F*                WHEN S.R.GLINTC IS PERFORMED.                     *S01117
0008 F*                                                                  *
0012 F********************************************************************
     F*                                                                   S01117
     F*  C R E A T I O N     P A R A M E T E R S                      *   S01117
     F*                                                               *   S01117
     F*                                                               *   S01117
     F*****************************************************************   S01117
     F*
0013 F*CLOAN***IP**F*****400  7AI     2 DISK                              S01270
0013 F*CLOAN***IP**F*****434  7AI     2 DISK                       S01270 S01220
0013 F*CLOAN***IP**F     436  7AI     2 DISK                       S01220 CLE011
0013 F***CLOAN** IP  F    1310  7AI     2 DISK                                         CLE011 CLE028
0013 F***CLOAN** IP  F    1375  7AI     2 DISK                                         CLE028 CGL029
     F*CLOAN***IP**F****1461  7AI     2 DISK                                           CGL029 CLE042
     F***CLOAN** IP  F    1773  7AI     2 DISK                                         CLE042 CLE134
     FCLOAN   IP  F    1874  7AI     2 DISK                                                   CLE134
0014 FCLOANC  IF  F     400  7AI     2 DISK
0015 F*TABLE***IF**F      96 12AI     2 DISK                              S01194
0016 FINDUSHH O   F      90            DISK
0016 F*INDUSIN*O***F*     90            DISK                              S01270
0016 F*INDUSIN*O***F******91            DISK                                           S01270 CLE042
     FINDUSIN O   F      95            DISK                                                   CLE042
0016 FINDUSZZ O   F      90            DISK
     F/COPY WNCPYSRC,LE1030F001
0017 F*E1030P1O** F     132            PRINTER                  S01124    S01117
0017 FLE1030AUO   F     132            PRINTER                            S01117
0018 F* ID F  C  H  L    FUNCTION OF INDICATORS
0019 F* 01            S/CLOAN - HEADER RECORD
0020 F* 02                    - DETAIL RECORD 1
0021 F* 03                    - DETAIL RECORD 2
0022 F* 04                    - '*' RECORD
0023 F* 06            S/CLOANC - DETAIL RECORD 1
0024 F*    21         AGGREGATE BALANCE = 0
0025 F*       40      CONDITION FIRST CYCLE PROCESSING
0026 F*       41      WORK INDICATOR
     F*       42      WORK INDICATOR
     F*       43      ACCRUE ON FIRST DAY
0027 F*       55      CHAIN FAIL
0028 F*       60      EXTRACT DETAIL RECORD
     F*       61      ACCRUAL PROFIT DATE LESS THAN DNWD                  E86111
     F*       64      PART PURCHASED                                      S01270
0029 F*       66      PART. SOLD
0030 F*             U7STANDARD MIDAS USAGE
0031 F*             U8STANDARD MIDAS USAGE
     E/COPY ZSRSRC,ZDATE2Z1                                               S01392
     E                    CPY@    1   1 80
     E                    TABMN  12  12  3   TABDY   2   ZENDAT TABLE     E86111
     E/COPY ZSRSRC,ZDATE9Z1                                               066550
     E/COPY ZSRSRC,ZFREQBZ1                                                                   CLE028
     E/COPY ZSRSRC,ZHOLE                                                                      CLE028
0034 I*
0035 I*    CUSTOMER LENDING LOANS FILE - HEADER RECORD
0036 I*
0037 ICLOAN   NS  01   1 CH
0038 I*
0039 I*    CUSTOMER LENDING LOANS FILE - DETAIL RECORD 1
0040 I*
0041 I        NS  02   1 CD   8 CA
0042 I       OR        1 CM   8 CA
0043 I                                        1   1 RECI
0044 I**********                              2   70LNRF                                      CLE148
     I                                        2   7 LNRF                                      CLE148
0045 I                                        8   8 RCDT
0046 I                                        9   90MRIN
0047 I                                       10  110PTYP
0048 I**********                             12  170CNUM                                      CSD027
0048 I                                       12  17 CNUM                                      CSD027
0049 I***********                            18  200BRCD                  S01117
0049 I                                       18  20 BRCA                  S01117
0050 I                                       21  22 LTYP
0051 I                                       23  24 SUTP
0052 I                                    P  25  270DDAT
0053 I                                    P  28  300VDAT
0054 I                                    P  31  330MDAT
0055 I                                       34  350LASQ
0056 I**********                             36  410FCUS                                      CSD027
0056 I                                       36  41 FCUS                                      CSD027
0057 I                                       42  440FTYP
0058 I                                       45  460FSEQ
0059 I                                       47  49 CCY
0060 I                                    P  50  560CPAM
0061 I                                       57  57 INTC
0062 I                                    P  58  637INTR
0063 I**********                             64  650BRTT                                      CSD103
0063 I                                       64  65 BRTT                                      CSD103
0064 I                                    P  66  717BRTE
0065 I                                    P  72  777RTSP
0066 I                                    P  78  815MARG
0067 I                                       82  82 SPIN
0068 I                                       83  83 CHIN
0069 I                                    P  84  897WTRT
0070 I                                       90  90 WTIN
0071 I                                       91  910REPT
0072 I                                    P  92  980RAMT
0073 I                                    P  99 1010NRPD
0074 I                                      102 102 RFRQ
0075 I                                      103 1040RDYN
0076 I                                      105 107 FCCY
0077 I                                      108 1100LIND
0078 I                                      111 112 CRSK
0079 I                                      113 114 ACOF
0080 I                                      115 115 NACD
0081 I                                      116 116 RELI
0082 I                                      117 117 AUTO
0083 I                                    P 118 1240PSAM
0084 I                                    P 125 1318BCXR
0085 I                                    P 132 1388FCXR
0086 I                                      139 1400SDST
0087 I**********                            141 152 OSDA                                      CGL029
     I                                      141 152 QQOSDA                                    CGL029
0088 I                                      153 162 TSTN
0089 I                                      163 1640MDST
0090 I**********                            165 176 OMDA                                      CGL029
     I                                      165 176 QQOMDA                                    CGL029
0091 I                                      177 186 TMAN
0092 I                                      187 196 FACO
0093 I                                    P 197 1990RLDT
0094 I                                    P 200 2020NROD
0095 I                                      203 203 RLFQ
0096 I                                      204 2050RLDY
     I                                      206 206 LRDFC                 S01392
0097 I**********                            207 2080NBRA                                      CSD103
0097 I                                      207 208 NBRA                                      CSD103
0098 I                                    P 209 2147NRTS
0099 I                                      215 215 NSIN
0100 I                                      216 2160NCAC
0101 I                                    P 217 2230AWTP
0102 I                                    P 224 2300WTRD
0103 I                                    P 231 2370WTWD
0104 I                                    P 238 2440IWOD
0105 I                                    P 245 2510PWOD
0106 I                                      252 252 BMDI
0107 I                                      253 253 FMDI
0108 I                                    P 254 2600PDIN
0109 I                                      287 287 BTIN
0110 I                                      288 2890BLDY
0111 I**********                            290 2950OLNO                                      CSD027
0111 I                                      290 295 OLNO                                      CSD027
0112 I                                      296 296 RCSI
0113 I                                      297 2970ICBS
0114 I                                      298 298 IPFR
0115 I                                    P 299 3050TOTI
0116 I                                    P 306 3080NIDT
0117 I                                    P 309 3110IBDT
0118 I                                    P 312 3140SLID
0119 I                                    P 315 3210AIPD
0120 I                                    P 322 3240DLRC
0121 I                                    P 325 3270IACD
0122 I                                    P 328 3340AITC
0123 I                                    P 335 3410TFEP
0124 I                                    P 342 3480AIAP
0125 I                                    P 349 3550IPRD
0126 I                                    P 356 3620IPRM
0127 I                                    P 363 3690ICTD
0128 I                                    P 370 3760AIMN
0129 I                                    P 377 3790RBDT
0130 I                                      384 3850IFDY
0131 I                                      386 386 LONI
0132 I                                      387 387 CNFI
0133 I                                      388 388 ACEI
0134 I                                      389 389 TLXI
0135 I                                      390 390 CBLI
0136 I                                    P 391 3930ORED
0137 I                                    P 394 3960LCD
0138 I                                      397 397 CHTP
0139 I                                    P 398 4000TNLU
     I                                      401 401 ADDI                  S01392
     I                                      435 436 BOKC                  S01220
      ** Additional fields for Flate Rate Personal Loans (Rule of 78s)                        CLE028
     I                                     13491349 ADIF                                      CLE028
     I                                     13501350 ADCF                                      CLE028
     I                                    P135113570CHGA                                      CLE028
     I                                     13581358 ICIF                                      CLE028
     I                                    P135913650FLTI                                      CLE028
     I                                    P136613680FRPD                                      CLE028
     I                                    P136913750ACCH                                      CLE028
     I*************************************13901407 OSDA                               CGL029 CLE042
     I*************************************14081425 OMDA                               CGL029 CLE042
     I                                     15611578 OSDA                                      CLE042
     I                                     15791596 OMDA                                      CLE042
     I                                     17621765 CLAS                                      CLE042
      *                                                                                       CLE134
     I                                     18301830 FAMU                                      CLE134
     I                                     18311831 FPNR                                      CLE134
     I                                    P183218340RIDT                                      CLE134
     I                                    P183518360RIDC                                      CLE134
     I                                     183718370RCAT                                      CLE134
     I                                    P183818390RCAC                                      CLE134
     I                                    P184018420RCSD                                      CLE134
     I                                    P184318440RCDY                                      CLE134
     I                                    P184518460RCCY                                      CLE134
      *                                                                                       CLE134
     I                                    P184718490BIDT                                      CLE134
     I                                    P185018510BIDC                                      CLE134
     I                                     185218520BCAT                                      CLE134
     I                                    P185318540BCAC                                      CLE134
     I                                    P185518570BCSD                                      CLE134
     I                                    P185818590BCDY                                      CLE134
     I                                    P186018610BICC                                      CLE134
      *                                                                                       CLE134
     I                                     18621864 XRFI                                      CLE134
     I                                     186518740XRFN                                      CLE134
      *                                                                                       CLE134
0140 I*
0141 I*    CUSTOMER LENDING LOANS FILE - DETAIL RECORD 2
0142 I*
0143 I        NS  03   1 CD   8 CB
0144 I                                        1   1 RECI
0145 I**********                              2   70LNRF                                      CLE148
     I                                        2   7 LNRF                                      CLE148
0146 I                                        8   8 RCDT
0147 I                                        9   90MRIN
0148 I                                       10  44 NAR1
0149 I                                       45  79 NAR2
0150 I                                       80 114 NAR3
0151 I                                      115 149 NAR4
0152 I                                    P 150 1560OPAM
0153 I                                      157 1610FRBC
0154 I                                    P 162 1680YPLN
0155 I                                    P 169 1750YFLN
0156 I                                    P 176 1820YWLN
0157 I                                    P 183 1890ABLN            21
0158 I                                    P 190 1960YPLC
0159 I                                    P 197 2030YFLC
0160 I                                    P 204 2100YWLC
0161 I                                    P 211 2170ABLC
0162 I                                    P 218 2240WWLN
0163 I                                    P 225 2310IWLN
0164 I                                    P 232 2380PWLN
0165 I                                      245 274 SPI1
0166 I                                      275 304 SPI2
0167 I                                      305 334 SPI3
0168 I                                    P 335 3410YILN
0169 I                                    P 391 3930ORED
0170 I                                    P 394 3960LCD
0171 I                                      397 397 CHTP
0172 I                                    P 398 4000TNLU
0173 I*
0174 I*    LOANS FILE '*' RECORD
0175 I*
0176 I        NS  04   1 C*
0177 I*
0178 I*    LOANS FILE - TRAILER
0179 I*
0180 I        NS       1 CT
0181 I                                        1   1 RECI
0182 I**********                              2   70LNRF                                      CLE148
     I                                        2   7 LNRF                                      CLE148
0183 I                                        8   8 RCDT
0184 I                                    P  17  190NORE
0185 I                                    P  20  220FLSZ
0186 I                                    P  23  250NLRB
0187 I                                    P  26  280NINS
0188 I                                    P  29  310NDEL
0189 I                                    P  32  340NLRA
0190 I                                    P  35  420VLBF
0191 I                                    P  43  440VLBL
0192 I                                    P  45  520VRIF
0193 I                                    P  53  540VRIL
0194 I                                    P  55  620VRDF
0195 I                                    P  63  640VRDL
0196 I                                    P  65  720VLAF
0197 I                                    P  73  740VLAL
0198 I                                    P  75  770DTMR
0199 I                                    P  78  800ITMR
0200 I                                    P 394 3960LCD
0201 I                                      397 397 CHTP
0202 I                                    P 398 4000TNLU
0203 I*
0204 I*    CATCH ALL
0205 I*
0206 I        NS
0207 I*
0208 I*    CUSTOMER LENDING LOANS FILE DETAIL RECORD 1
0209 I*
0210 ICLOANC  NS  06   1 CD
     I       OR   06   1 CM                                               E10175
0211 I**********                             12  170ORCUS                                     CSD027
0211 I                                       12  17 ORCUS                                     CSD027
0212 I                                      108 1100ORIND
0213 I*
0214 I*    CATCH ALL
0215 I*
0216 I        NS
0217 I**************                                                      S01194
0218 I*****TABLE*FILE - INSTALLATION CONTROL DATA RECORD 1.               S01194
0219 I**************                                                      S01194
0220 I*TABLE***NS***    2 C0   3 C1  12 C1                                S01194
0221 I*******AND****  13 C0                                               S01194
0222 I**************                          1   1 RECI                  S01194
0223 I**************                          2   30RECT                  S01194
0224 I**************                         12  130RCDE                  S01194
0225 I**************                         14  66 TITL                  S01194
0226 I**************                         67  67 DATF                  S01194
0227 I***********                            68  700DFBR                  S01194
0228 I**************                         74  74 MODI1                 S01194
0229 I**************                         75  75 MODI2                 S01194
0230 I**************                         76  76 MODI3                 S01194
0231 I**************                      P  77  790RUND                  S01194
0232 I**************                         80  86 RUNA                  S01194
0233 I**************                         87  870SFLG                  S01194
0234 I**************                      P  90  920LCD                   S01194
0235 I**************                         93  93 CHTP                  S01194
0236 I**************                      P  94  960TNLU                  S01194
     I**************                                                      S01194
     I*****TABLE*FILE - INSTALLATION CONTROL DATA RECORD 2.               S01194
     I**************                                                      S01194
     I********NS****   2 C0   3 C1  12 C1                                 S01194
     I*******AND****  13 C1                                               S01194
     I**************                          1   1 RECI                  S01194
     I**************                          2   30RECT                  S01194
     I**************                         12  130RCDE                  S01194
     I**************                         14  16 BCCY                  S01194
     I**************                         17  19 BCYL                  S01194
     I**************                         20  22 HOCY                  S01194
     I**************                         23  280HEAD                  S01194
     I**************                      P  29  310APDA                  S01194
     I**************                         35  35 APFQ                  S01194
     I**************                      P  36  380LOGS                  S01194
     I**************                         39  40 CUZR                  S01194
     I**************                      P  41  430DNWD                  S01194
     I**************                         44  460BVLP                  S01194
     I**************                         47  49 LOCY                  S01194
     I**************                         50  510FDAY                  S01194
     I**************                         52  52 ACLD                  S01194
     I**************                         53  53 MBIN                  S01194
     I**************                      P  54  560EOYD                  S01194
     I**************                      P  57  590LEYD                  S01194
     I**************                         86  86 ISAV                  S01194
     I**************                      P  87  890LLOG                  S01194
     I**************                      P  90  920LCD                   S01194
     I**************                         93  93 CHTP                  S01194
     I**************                      P  94  960TNLU                  S01194
0237 I**************                                                      S01194
0238 I*****CATCH*ALL                                                      S01194
0239 I**************                                                      S01194
0240 I********NS****                                                      S01194
0241 I*
0242 I*    DATA STRUCTURE FOR KEY TO S/CLOAN
0243 I*
0244 I            DS
0245 I                                        1   7 CLNKEY
0246 I*************                           1   60OLNO                                      CSD027
0246 I                                        1   6 OLNO                                      CSD027
     I*                                                                   S01194
     ISDBANK    E DSSDBANKPD                                              S01194
      **  EXTERNAL DS FOR BANK DETAILS                                    S01194
     I              BJURPT                          TITL                  S01194
     I              BJDNWD                          DNWD                  S01194
     I              BJDFIN                          DATF                  S01194
     I              BJMRDT                          RUNA                  S01194
     I              BJRDNB                          RUND                  S01194
     I              BJPEYD                          LEYD                  S01194
      **                                                                  S01194
     ISDBRCH    E DSSDBRCHPD                                              S01117
      **  EXTERNAL DS FOR BRANCH CODE DETAILS                             S01117
     I              A8CMCD                          CMPYM                 S01117
      **                                                                  S01194
     I*                                                                   S01194
     ISDGELR    E DSSDGELRPD                                              S01194
      **  EXTERNAL DS FOR GENERAL LEDGER                                  S01194
     I**************BKALDI                          ACLD            S01194S01392
     I              BKAPDT                          APDA                  S01194
     I**                                                                  CLE005
     ISCSARD    E DSSCSARDPD                                              CLE005
      **  External DS for SAR Details                                     CLE005
     I**                                                                  S01194
     IDSFDY     E DSDSFDY                                                 S01194
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01194
      *                                                                                       CLE028
     IDSSDY     E DSDSSDY                                                                     CLE028
      ** Second DS for Access Programs, Long Data Structure                                   CLE028
      *                                                                                       CLE028
0247 I*
0248 I*    LDA - DIAGNOSTIC FOR PROGRAM ABORT
0249 I*
0250 ILDA        UDS                            256
0251 I***********                           134 138 DBFILE                S01117
0252 I***********                           139 167 DBKEY                 S01117
0253 I***********                           168 175 DBPGM                 S01117
0254 I***********                           176 1770DBASE                 S01117
0251 I                                      134 141 DBFILE                S01117
0252 I                                      142 170 DBKEY                 S01117
0253 I                                      171 180 DBPGM                 S01117
0254 I                                      181 1830DBASE                 S01117
     I              'LECalcBasis6LeapYear'C         WPARML                                  MD035545
     I/COPY ZSRSRC,ZINTDYZ1                                               066550
     I/COPY ZSRSRC,ZDATE9Z2                                               066550
     I/COPY ZSRSRC,ZDAT10Z1                                               126017
     I/COPY ZSRSRC,ZHOLI                                                                      CLE028
     I/EJECT                                                              S01117
     C                     MOVEACPY@      BIS@   80
0255 C********************************************************************
0256 C**      FIRST CYCLE PROCESSING
0257 C**
     C           *NAMVAR   DEFN           LDA                             S01117
     C           *LOCK     IN   LDA                                       S01117
0258 C   40                GOTO DETAIL
0259 C                     SETON                     40
0260 C                     MOVE 'LE1030'  DBPGM
0261 C**
0262 C                     EXSR ZSYSTM
0263 C***99******          SETON                     U7U8  **DATABASE 01**S01194
0264 C***99*********       Z-ADD1         DBASE                           S01194
0265 C***99*********       MOVE ZTABKY    DBKEY                           S01194
0266 C***99*********       MOVE 'TABLE'   DBFILE                          S01194
0267 C   99                GOTO END
      *                                                                   CLE005
      ** Check if SAR CLE005 is present                                   CLE005
      *                                                                   CLE005
     C                     MOVE 'N'       CLE005  1                       CLE005
     C                     CALL 'AOSARDR0'                                CLE005
     C                     PARM *BLANKS   P@RTCD  7                       CLE005
     C                     PARM '*KEY   ' P@OPTN  7                       CLE005
     C                     PARM 'CLE005'  P@SARD  6                       CLE005
     C           SCSARD    PARM SCSARD    DSFDY                           CLE005
      *                                                                   CLE005
     C           P@RTCD    IFEQ *BLANKS                                   CLE005
     C                     MOVE 'Y'       CLE005  1                       CLE005
     C                     ELSE                                           CLE005
      *                                                                   CLE005
      ** Handle Database Error                                            CLE005
      *                                                                   CLE005
     C           P@RTCD    IFNE '*NRF    '                                CLE005
     C                     MOVEL'SCSARDPD'DBFILE           ************   CLE005
     C                     Z-ADD5         DBASE            * DBERR 05 *   CLE005
     C                     MOVEL'CLE005'  DBKEY            ************   CLE005
     C                     MOVE *ON       *INU7                           CLE005
     C                     MOVE *ON       *INU8                           CLE005
     C                     MOVE *ON       *INLR                           CLE005
     C                     GOTO END                                       CLE005
     C                     ENDIF                                          CLE005
      *                                                                   CLE005
     C                     ENDIF                                          CLE005
      *                                                                                       CLE028
      ** Determine if Flat Rate Personal Loans (Rule of 78s) is                               CLE028
      ** installed                                                                            CLE028
      *                                                                                       CLE028
     C                     CALL 'AOSARDR0'                                                    CLE028
     C                     PARM *BLANKS   P@RTCD                                              CLE028
     C                     PARM '*VERIFY' P@OPTN                                              CLE028
     C                     PARM 'CLE028'  P@SARD                                              CLE028
     C           SCSARD    PARM SCSARD    DSFDY                                               CLE028
      *                                                                                       CLE028
     C           P@RTCD    IFNE *BLANKS                                                       CLE028
     C           P@RTCD    ANDNE'*NRF   '                                                     CLE028
     C           *LOCK     IN   LDA                                                           CLE028
     C                     MOVEL'SCSARDPD'DBFILE                                              CLE028
     C                     Z-ADD10        DBASE                                               CLE028
     C                     MOVELP@SARD    DBKEY                                               CLE028
     C                     OUT  LDA                                                           CLE028
     C                     EXSR *PSSR                                                         CLE028
     C                     ENDIF                                                              CLE028
      *                                                                                       CLE028
     C           P@RTCD    IFEQ *BLANKS                                                       CLE028
     C                     MOVE 'Y'       CLE028  1                                           CLE028
     C                     ELSE                                                               CLE028
     C                     MOVE 'N'       CLE028                                              CLE028
     C                     ENDIF                                                              CLE028
     C/COPY WNCPYSRC,LEH01322
     C**
     C**   ACCESS ICDR 2 FOR LAST DAY ACCRUALS OPTION
     C**
     C**************       MOVE '1'       ZTABKY                          S01194
     C***********ZTABKY    CHAINTABLE                99                   S01194
     C**                                                                  S01194
     C** ACCESS GENERAL LEDGER DETAILS                                    S01194
     C**                                                                  S01194
     C**********           CALL 'AOGELRR0'                                S01194              CGL029
     C                     CALL 'AOGELRR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C********** SDGELR    PARM SDGELR    DSFDY                           S01194              CGL029
     C           SDGELR    PARM SDGELR    DSSDY                                               CGL029
     C**N99******RECI      COMP 'D'                  9999                 S01194
     C           @RTCD     IFNE *BLANKS                                   S01194
     C                     SETON                     U7U8LR***************S01194
     C                     Z-ADD4         DBASE            * DBERROR 04  *S01194
     C                     MOVEL@OPTN     DBOPTN  7        ***************S01194
     C                     MOVEL@OPTN     DBKEY                           S01194
     C                     MOVEL'SDGELRPD'DBFILE                          S01194
     C                     GOTO END                                       S01194
     C                     END                                            S01194
      *                                                                                     MD035545
      ** Retrieve system value setting.                                                     MD035545
      *                                                                                     MD035545
     C                     MOVELWPARML    P@OP01                                            MD035545
     C                     CALL 'AOSVALR0'                                                  MD035545
     C                     PARM *BLANKS   @RTCD                                             MD035545
     C                     PARM           P@OP01 20                                         MD035545
     C                     PARM           P@VL01200                                         MD035545
     C                     PARM           P@OP02 20                                         MD035545
     C                     PARM           P@VL02200                                         MD035545
     C                     PARM           P@OP03 20                                         MD035545
     C                     PARM           P@VL03200                                         MD035545
     C                     PARM           P@OP04 20                                         MD035545
     C                     PARM           P@VL04200                                         MD035545
     C                     PARM           P@OP05 20                                         MD035545
     C                     PARM           P@VL05200                                         MD035545
     C                     PARM           P@OP06 20                                         MD035545
     C                     PARM           P@VL06200                                         MD035545
     C                     PARM           P@OP07 20                                         MD035545
     C                     PARM           P@VL07200                                         MD035545
     C                     PARM           P@OP08 20                                         MD035545
     C                     PARM           P@VL08200                                         MD035545
     C                     PARM           P@OP09 20                                         MD035545
     C                     PARM           P@VL09200                                         MD035545
     C                     PARM           P@OP10 20                                         MD035545
     C                     PARM           P@VL10200                                         MD035545
      *                                                                                     MD035545
      ** If system value is not found then default value to 'N'.                            MD035545
      *                                                                                     MD035545
     C           @RTCD     IFNE '       '                                                   MD035545
     C                     MOVE 'N'       WCALC6                                            MD035545
     C                     ELSE                                                             MD035545
     C                     MOVELP@VL01    WCALC6                                            MD035545
     C********** WCALC6    IFEQ 'Y'                                                MD035545 MD047993
     C********** BKALDI    ANDEQ'Y'                                                MD035545 MD047993
     C**********           MOVE 'Y'       WCALC6                                   MD035545 MD047993
     C**********           ELSE                                                    MD035545 MD047993
     C**********           MOVE 'N'       WCALC6                                   MD035545 MD047993
     C**********           ENDIF                                                   MD035545 MD047993
     C                     ENDIF                                                            MD035545
     C***99******          SETON                     U7U8  **DATABASE 04**S01117
     C***99*********       Z-ADD4         DBASE                           S01194
     C***99*********       MOVE ZTABKY    DBKEY                           S01194
     C***99*********       MOVE 'TABLE'   DBFILE                          S01194
     C***99*********       GOTO END                                       S01194
     C**
     C***********ACLD      COMP 'Y'                  4343                 S01392
     C**                                                                  E86111
     C**    FIND ENDDATE (FOR INTEREST CALCULATION) BY COMPARING          E86111
     C**    DNWD AGAINST APDA. IF APDA LT DNWD. USE APDA AS ENDDATE       E86111
     C**    OTHERWISE USE MONTH END DATE.                                 E86111
     C**                                                                  E86111
     C           APDA      COMP DNWD                   61                 E86111
     C   61                Z-ADDAPDA      ENDATE  50                      E86111
     C  N61                EXSR ZENDAT                                    E86111
0268 C**
0269 C** DETERMINE NO. OF DAYS YEAR-TO-DATE
0270 C***********          MOVE RUNA      YEAR    20                      E86097
0271 C***********YEAR      SUB  1         YEAR                            E86097
0272 C**N98******          MOVEL'3112'    ZDATE                           E86097
0273 C***98******          MOVEL'1231'    ZDATE                           E86097
0274 C***********          MOVE YEAR      ZDATE                           E86097
0275 C***********          EXSR ZDATE1                                    E86097
0276 C***99******          SETON                     U7U8  **DATABASE 02**E86097
0277 C***99******          Z-ADD2         DBASE                           E86097
0278 C***99******          GOTO END                                       E86097
0279 C***********                                                         E86097
0280 C***********RUND      SUB  ZDAYNO    DAYS    50                      E86097
0280 C***********RUND      SUB  LEYD      DAYS    50                      E43644
0280 C           ENDATE    SUB  LEYD      DAYS    50                      E43644
0281 C**
0282 C**   DEFINE KEY FIELD
0283 C                     MOVE 'A'       CLNKEY
0284 C**
0285 C**   COMMENCE COUNT OF RECORDS OUTPUT TO FILE
0286 C                     Z-ADD1         COUNT2  50
0287 C**********************************
     C/COPY WNCPYSRC,LE1030C001
0288 C           DETAIL    TAG                             **DETAIL TAG**
0289 C                     SETOF                     60
     C*
     C/COPY WNCPYSRC,LE1030C002
     C** SET OFF THE PARTS PURCHASED INDICATOR
     C*
     C                     MOVE '0'       *IN64
0290 C**
0291 C**    MAINTAIN COUNT OF ALL NON - * RECORDS
0292 C  N04      COUNT1    ADD  1         COUNT1  50
0293 C**
0294 C**   HASH CURRENT PRINCIPAL LIVE/MATURED RECORDS
0295 C   02                Z-ADDHSHWN1    ZZTOTI
0296 C   02                Z-ADDHSHDC1    ZZTOTD
0297 C   02      CPAM      DIV  1000      ZZAMT        41
0298 C**
0299 C**   IF AMOUNT IS NEGATIVE,REVERSE SIGN
0300 C   02 41             Z-SUBZZAMT     ZZAMT
0301 C   02                EXSR GLZADD
0302 C   02                Z-ADDZZTOTI    HSHWN1 150
0303 C   02                Z-ADDZZTOTD    HSHDC1  30
0304 C  N03                GOTO END
0305 C**
0306 C**   LIVE 'B' RECORD PROCESSING - OUTPUT RECORD IF REQUIRED TYPE
0307 C           PTYP      COMP 61                   60  60
0308 C   60      PTYP      COMP 67                     6060
      *                                                                   CLE005
      ** If SAR CLE005 is Present, inlcude PTYP 68 and 69 for Extract     CLE005
      *                                                                   CLE005
     C           CLE005    IFEQ 'Y'                                       CLE005
      *                                                                   CLE005
     C           PTYP      IFEQ 68                                        CLE005
     C           PTYP      OREQ 69                                        CLE005
     C                     MOVE *ON       *IN60                           CLE005
     C                     ENDIF                                          CLE005
      *                                                                   CLE005
     C                     ENDIF                                          CLE005
      *                                                                   CLE005
      ** If CLE028 is installed, include PTYP 80 for extract                                  CLE028
      *                                                                                       CLE028
     C           CLE028    IFEQ 'Y'                                                           CLE028
     C           PTYP      ANDEQ80                                                            CLE028
     C                     MOVE *ON       *IN60                                               CLE028
     C                     ENDIF                                                              CLE028
      *                                                                                       CLE028
0309 C  N60                GOTO END
0310 C**
0311 C**   FOR PARTS. SOLD - ACCESS S/CLOAN WITH ORIGINAL LOAN NO.
0312 C**   TO DETERMINE ORIGINAL CUSTOMER NO. & INDUSTRY CODE
0313 C           PTYP      COMP 66                       66
0314 C  N66      PTYP      COMP 67                       66
      *                                                                   CLE005
      ** If SAR CLE005 is Present, inlcude PTYP 69                        CLE005
      *                                                                   CLE005
     C           CLE005    IFEQ 'Y'                                       CLE005
     C           PTYP      ANDEQ69                                        CLE005
     C                     MOVE *ON       *IN66                           CLE005
     C                     ENDIF                                          CLE005
     C*                                                                   S01270
     C** SIMILARLY FOR PARTS PURCHASED USE OLNO INSTEAD OF CUSTOMER NUMBERS01270
     C*                                                                   S01270
     C           PTYP      IFEQ 64                                        S01270
     C           PTYP      OREQ 65                                        S01270
      *                                                                   CLE005
      ** If SAR CLE005 is Present, inlcude PTYP 68                        CLE005
      *                                                                   CLE005
     C           CLE005    OREQ 'Y'                                       CLE005
     C           PTYP      ANDEQ68                                        CLE005
      *                                                                   CLE005
     C                     MOVE '1'       *IN64                           S01270
     C                     END                                            S01270
0315 C**
0316 C   66      CLNKEY    CHAINCLOANC               55
0317 C***66N06***          SETON                     U7U8  **DATABASE 03**S01117
0317 C   66N06             SETON                     U7U8LR**DATABASE 03**S01117
0318 C   66N06             Z-ADD3         DBASE
0319 C   66N06             MOVE CLNKEY    DBKEY
0320 C   66N06             MOVE 'CLOANC'  DBFILE
0321 C   66N06             GOTO END
     C**                                                                  S01117
     C** To get COMPANY CODE(ie CMPYM):                                   S01117
     C**                                                                  S01117
     C**********           CALL 'AOBRCHR0'                                S01117              CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       S01117
     C                     PARM '*KEY   ' @OPTN   7                       S01117
     C                     PARM BRCA      @DSNB   3                       S01117
     C********** SDBRCH    PARM SDBRCH    DSFDY                           S01117              CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANKS                                   S01117
     C                     MOVE *BLANKS   DBKEY                           S01117
     C                     MOVEL@DSNB     DBKEY                           S01117
     C                     MOVEL'SDBRCHPD'DBFILE           ************   S01117
     C                     Z-ADD02        DBASE            * DBASE 02 *   S01117
     C                     MOVEL@OPTN     DBOPTN  7        ************   S01117
     C                     SETON                     U7U8LR               S01117
     C                     GOTO END                                       S01117
     C                     END                                            S01117
0322 C**
0323 C**   MAINTAIN RECORD COUNT & HASH TOTALS FOR OUTPUT FILE
0324 C           COUNT2    ADD  1         COUNT2
0325 C                     Z-ADDHSHWN2    ZZTOTI
0326 C                     Z-ADDHSHDC2    ZZTOTD
0327 C           CPAM      DIV  1000      ZZAMT        41
0328 C**
0329 C**   IF AMOUNT IS NEGATIVE,REVERSE SIGN
0330 C   41                Z-SUBZZAMT     ZZAMT
0331 C                     EXSR GLZADD
0332 C                     Z-ADDZZTOTI    HSHWN2 150
0333 C                     Z-ADDZZTOTD    HSHDC2  30
0334 C**********************************
0335 C**   DETERMINE YEAR-TO-DATE AVERAGE BALANCE
0336 C           ABLN      DIV  DAYS      YTDAV  130H
0337 C**
0338 C**   DETERMINE CURRENT YIELD
0339 C   21                Z-ADD0         CYIELD 117
     C***21*****           GOTO END                                                         AR981899
     C**
     C**   CALCULATE INTEREST FROM CONTROL DATE TO RUN DATE (OR
     C**   MATURITY DATE IF EARLIER) AND ALSO INCLUDE ADJUSTMENTS.
     C**
     C                     Z-ADD0         INTINC                                            AR981899
     C***********MDAT      COMP RUND                   42                 E86111
     C***********          Z-ADDRUND      ZIEND                           E86111
     C           MDAT      COMP 0                    4242                 E86112
     C   42      MDAT      COMP ENDATE                 4242               E86111
     C   42                Z-ADDMDAT      ZIEND
     C  N42                Z-ADDENDATE    ZIEND                           E86111
     C***43N42***ZIEND     ADD  1         ZIEND                           S01392
      *                                                                                       CLE028
     C           CLE028    IFEQ 'Y'                                                           CLE028
     C           PTYP      ANDEQ80                                                            CLE028
     C                     Z-ADDVDAT      ZIBEG                                               CLE028
     C                     ELSE                                                               CLE028
     C                     Z-ADDIACD      ZIBEG
     C                     ENDIF                                                              CLE028
      *                                                                                       CLE028
      ** When CLE028 is installed, process RULE78 to compute for                              CLE028
      ** outstanding interest                                                                 CLE028
      *                                                                                       CLE028
     C           CLE028    IFEQ 'Y'                                                           CLE028
     C           PTYP      ANDEQ80                                                            CLE028
     C                     Z-ADDAPDA      BKAPDT  60                                          CLE028
     C                     Z-ADDVDAT      W78VDT                                              CLE028
     C                     Z-ADDMDAT      W78MDT                                              CLE028
     C                     Z-ADDFLTI      W78FLT                                              CLE028
     C                     MOVE RFRQ      W78RPF                                              CLE028
     C                     Z-ADDFRPD      W78FRD                                              CLE028
     C                     Z-ADDRDYN      W78RPM                                              CLE028
     C                     MOVE CCY       W78CCY                                              CLE028
     C                     MOVE ' '       W78LCN                                              CLE028
     C                     Z-ADDZIBEG     W78BEG                                              CLE028
     C                     Z-ADDZIEND     W78END                                              CLE028
     C                     MOVE 'A'       W78ROA                                              CLE028
     C                     EXSR RULE78                                                        CLE028
     C                     Z-ADDW78INT    ZINTR                                               CLE028
     C                     ELSE                                                               CLE028
     C*
     C**   ADD EXTRA DAYS IF FIRST DAY ACCRUALS                           S01392
     C                     Z-ADDMDAT      ZMDAT                           S01392
     C                     EXSR ZFLDC                                     S01392
     C*                                                                   S01392
     C**   ADD EXTRA DAYS IF FIRST & LAST DAY ACCRUALS                    S01392
     C**********           Z-ADDVDAT      ZVDAT                                        S01392 245082
     C                     Z-ADDMDAT      ZMDAT                                               245082
     C                     EXSR ZFLAC                                     S01392
     C*
     C                     MOVE ICBS      ZICALC
     C                     Z-ADDCPAM      ZIAMT
     C                     Z-ADDINTR      ZIRATE
     C/COPY WNCPYSRC,LE1030C003
     C                     EXSR GLINTC
     C/COPY WNCPYSRC,LE1030C004
     C                     ENDIF                                                              CLE028
      *                                                                                       CLE028
     C           ZINTR     COMP 0                      42
     C   42                Z-ADD0         ZINTR
     C**
      *                                                                                       CLE028
     C           CLE028    IFEQ 'Y'                                                           CLE028
     C           PTYP      ANDEQ80                                                            CLE028
      *                                                                                       CLE028
     C                     Z-ADDZINTR     INTINC    H                                         CLE028
      *                                                                                       CLE028
     C                     ELSE                                                               CLE028
      *                                                                                       CLE028
     C***********ZINTR     ADD  AITC      INTINC 130H                     S01392
     C**                                                                  S01392
     C**   ROUND DOWN INTEREST IF REQUIRED                                S01392
     C           LRDFC     COMP 'Y'                      42               S01392
     C  N42      ZINTR     ADD  AITC      INTINC 130H                     S01392
     C   42      ZINTR     ADD  AITC      INTINC                          S01392
     C                     ENDIF                                                              CLE028
     C*
     C                     ADD  AIMN      INTINC
     C                     ADD  AIAP      INTINC
     C                     SUB  YILN      INTINC
0341 C  N21      INTINC    ADD  YFLN      WORK1  150
0342 C  N21      WORK1     MULT 365       WORK1
0343 C  N21      WORK1     DIV  ABLN      WORK2  119H
0344 C  N21      WORK2     MULT 100       CYIELD
0345 C**
0346 C           END       TAG                             **END TAG**
0347 C   U7                SETON                     LR
0348 C**
0349 C**   LAST RECORD PROCESSING
0350 CLRNU8      NORE      COMP COUNT1               U8U8
0351 CLRNU8      VLAF      COMP HSHWN1               U8U8
0352 CLRNU8      VLAL      COMP HSHDC1               U8U8
0353 CLRNU8      COUNT2    ADD  1         COUNT2
     C*                                                                   S01117
     CLR U7 U8             EXSR *PSSR                                     S01117
     C*                                                                   S01117
0354 C********************************************************************
0355 C/SPACE 3
0356 C********************************************************************
0357 C* SUBROUTINE TO ADD AN AMOUNT (ZZAMT) TO THE TOTAL (ZZTOTI,ZZTOTD)
0358 C*   IND '99' IS SET BY AN OVERFLOW ERROR
0359 C*
0360 CSR         GLZADD    BEGSR                           *** GLZADD ****
0361 C*
0362 CSR                   Z-ADDZZAMT     ZZAMT  153     91-DEFINE ZZAMT
0363 CSR 91                GOTO ZZAEND                     AMT = 0.BYPASS
0364 C*
0365 C* SPLIT ZZAMT INTO INTEGER AND DECIMAL FIELDS
0366 CSR                   Z-ADDZZAMT     ZZAMTI 150       INTEGER FIELD
0367 CSR                   MOVE ZZAMT     ZZAMTD  30       DECIMAL FIELD
0368 C* BOTH ZZAMTI AND ZZAMTD CONTAIN A 'SIGN' ZONE NOW
0369 C*
0370 CSR                   EXSR GLZSUM
0371 CSR         ZZAEND    ENDSR                           ** ZZAEND TAG *
0372 C*
0373 C********************************************************************
0374 C********************************************************************
0375 C* SUBROUTINE TO CARRY OUT THE ADDITION FOR SUBROUTINES -
0376 C*                        GLZADD, GLZSUB, GLZCMP.
0377 C*          PARAMETERS PASSED -
0378 C*                     I/P ZZAMTI ZZAMTD
0379 C*                     O/P ZZTOTI ZZTOTD ZZNEGD IND 96 IND 99.
0380 C*
0381 CSR         GLZSUM    BEGSR                           *** GLZSUM ****
0382 C*
0383 CSR                   Z-ADDZZTOTI    ZZTOTI 150       DEFINE ZZTOTI
0384 CSR                   Z-ADDZZTOTD    ZZTOTD  30       DEFINE ZZTOTD
0385 CSR                   SETOF                     919293
0386 CSR                   SETOF                     949599
0387 C*
0388 C*    DETERMINE SIGN OF ZZAMTI & D,   92 IF NEG
0389 CSR         ZZAMTI    COMP 0                      9293
0390 CSR 93      ZZAMTD    COMP 0                      9293
0391 CSR 93                GOTO ZZSEND                     ZERO BYPASS
0392 C*
0393 C*    DETERMINE SIGN OF ZZTOTI & D, 91 IF NEG.
0394 CSR         ZZTOTI    COMP 0                      9193
0395 CSR 93      ZZTOTD    COMP 0                      9193
0396 C*
0397 C*    IF ZZTOTAL IS ZERO, RETURN ZZAMOUNT.
0398 CSR 93                Z-ADDZZAMTI    ZZTOTI
0399 CSR 93                Z-ADDZZAMTD    ZZTOTD
0400 CSR 93                GOTO ZZSEND                     ZERO BYPASS
0401 C*    IF SIGNS DIFFER BYPASS OVERFLOW CHECKS.
0402 CSR 91N92
0403 CORN91 92             GOTO ZZOFPS
0404 C*
0405 CSR         ZZAMTD    ADD  ZZTOTD    ZZWK2   40
0406 CSR         ZZWK2     COMP 999                  93    '93' = CARRY
0407 CSRN93      ZZWK2     COMP -999                   93    INTO INTEGER.
0408 C*
0409 CSR 93N92   ZZAMTI    ADD  1         ZZWK3  150       ADD 'CARRY' +VE
0410 CSR    93 92ZZAMTI    SUB  1         ZZWK3            SUB 'CARRY' -VE
0411 CSR 93      ZZTOTI    ADD  ZZWK3     ZZWK3
0412 CSRN93      ZZTOTI    ADD  ZZAMTI    ZZWK3
0413 C*
0414 C* IF THE MODULUS OF ZZWK3 IS LT MOD. ZZTOTI THEN O/F HAS OCCURED
0415 CSRN92      ZZWK3     COMP ZZTOTI                 99  -92 MEANS NOS.
0416 CSR 92      ZZWK3     COMP ZZTOTI               99     NEGATIVE
0417 CSRN99                Z-ADDZZWK2     ZZTOTD
0418 CSRN99                Z-ADDZZWK3     ZZTOTI
0419 C*
0420 C* IF O/F ZEROIZE ZZAMT , IND '99' SET AND ZZTOT FIELDS LEFT INTACT.
0421 CSR 99                Z-ADD0         ZZAMT  153
0422 CSR                   GOTO ZZSEND
0423 C*
0424 C* THE 'SIGNS' ARE DIFFERENT
0425 CSR         ZZOFPS    TAG                             ** ZZOFPS TAG**
0426 C* IF ZZAMT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZTOT
0427 C*
0428 CSR 92                Z-SUBZZAMTI    ZZAMTI 150
0429 CSR 92                Z-SUBZZAMTD    ZZAMTD  30
0430 C*
0431 C* IF ZZTOT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZAMT.
0432 C*
0433 CSR 91                Z-SUBZZTOTI    ZZTOTI
0434 CSR 91                Z-SUBZZTOTD    ZZTOTD
0435 C* BOTH ZZAMT AND ZZTOT ARE NOW POSITIVE.
0436 C*
0437 CSR         ZZTOTI    COMP ZZAMTI               93  95
0438 CSR 95      ZZTOTD    COMP ZZAMTD               93  95
0439 C*
0440 C* IF ZZTOT EQ. ZZAMT RETURN ZERO.
0441 CSR 95                Z-ADD0         ZZTOTI
0442 CSR 95                Z-ADD0         ZZTOTD
0443 CSR 95                GOTO ZZSEND
0444 C*
0445 C* IF ZZTOT GT. ZZAMT.
0446 CSR 93      ZZAMTD    COMP ZZTOTD               94
0447 CSR 93 94   ZZTOTI    SUB  1         ZZTOTI
0448 CSR 93 94   ZZTOTD    ADD  1000      ZZWK2
0449 CSR 93      ZZTOTI    SUB  ZZAMTI    ZZTOTI
0450 CSR 93 94   ZZWK2     SUB  ZZAMTD    ZZTOTD
0451 CSR 93N94   ZZTOTD    SUB  ZZAMTD    ZZTOTD
0452 C*
0453 C*
0454 C* IF ZZAMT GT. ZZTOT.
0455 CSRN93      ZZTOTD    COMP ZZAMTD               94
0456 CSRN93 94   ZZAMTI    SUB  1         ZZWK3  150
0457 CSRN93 94   ZZAMTD    ADD  1000      ZZWK2
0458 CSRN93 94   ZZWK3     SUB  ZZTOTI    ZZTOTI
0459 CSRN93N94   ZZAMTI    SUB  ZZTOTI    ZZTOTI
0460 CSRN93 94   ZZWK2     SUB  ZZTOTD    ZZTOTD
0461 CSRN93N94   ZZAMTD    SUB  ZZTOTD    ZZTOTD
0462 C*
0463 C* REVERSE SIGN OF ZZTOT IF LARGER I/P FIELDS WERE NEGATIVE
0464 CSR                   SETOF                     94
0465 CSR 93 91
0466 CORN93 92             SETON                     94
0467 CSR 94                Z-SUBZZTOTI    ZZTOTI
0468 CSR 94                Z-SUBZZTOTD    ZZTOTD
0469 C**
0470 C**   RESTORE SIGN OF ZZAMTI & ZZAMTD IF IT WAS REVERSED.
0471 CSR 92                Z-SUBZZAMTI    ZZAMTI
0472 CSR 92                Z-SUBZZAMTD    ZZAMTD
0473 CSR         ZZSEND    TAG                             ** ZZSEND TAG *
0474 C**
0475 C**   IF ZZTOTD IS ZERO, AND ZZTOTI IS NEG. SET UP ZZNEGD.
0476 CSR                   SETOF                     96
0477 CSR         ZZTOTD    COMP 0                        91
0478 CSR 91      ZZTOTI    COMP 0                      96
0479 CSR 96                MOVE '.000-'   ZZNEGD  5
0480 CSR                   ENDSR                             ** ENDSR **
0481 C********************************************************************
0545 C**
0546 C**   ZSYSTM SR. TO CHAIN TO THE INSTALLATION CONTROL DATA RECORD.
0547 C**
0548 C           ZSYSTM    BEGSR                           *** ZSYSTM ***
0549 C**************                                                      S01194
0550 C*****SET*UP*KEY FOR INSTALLATION CONTROL RECORD.                    S01194
0551 C**************       MOVEL'01      'ZTABKY 12                       S01194
0552 C**************       MOVE '  10'    ZTABKY                          S01194
0553 C**************                                                      S01194
0554 C***********ZTABKY    CHAINTABLE                99    ON NOT THERE   S01194
0555 C**N99******RECI      COMP 'D'                  9999  ON, IS DELETED S01194
     C**                                                                  S01194
     C**   ACCESS BANK DETAILS                                            S01194
     C**                                                                  S01194
     C                     CALL 'AOBANKR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDBANK    PARM SDBANK    DSFDY                           S01194
     C*                                                                   S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     SETON                     U7U8LR               S01194
     C                     SETON                     99                   S01194
     C                     MOVEL'SDBANKPD'DBFILE                          S01194
     C                     MOVEL@OPTN     DBKEY            ***************S01194
     C                     MOVEL@OPTN     DBOPTN  7        * DBERROR 001 *S01194
     C                     Z-ADD1         DBASE            ***************S01194
     C                     ELSE                                           S01194
0556 C**
0557 C**   CHECK SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.
0558 C           DATF      COMP 'M'                      98MMDDYY, 98 ON
     C                     END                                            S01194
0559 C**
0560 C                     ENDSR
0561 C**
0562 C**
     C********************************************************************E86111
     C**                                                                  E86111
     C**   ZENDAT SR.  TO CALCULATE THE END DATE TO BE USED IN INTEREST   E86111
     C**               CALCULATIONS.                                      E86111
     C**                                                                  E86111
     CSR         ZENDAT    BEGSR                           *** ZENDAT *** E86111
     C**                                                                  E86111
     C** SPLIT RUN DATE INTO ITS COMPONENTS                               E86111
     C**                                                                  E86111
     CSR                   MOVELRUNA      RDAY    20                      E86111
     CSR                   MOVE RUNA      RMNYR   5                       E86111
     CSR                   MOVELRMNYR     RMN     3                       E86111
     CSR                   MOVE RMNYR     RYR     20                      E86111
     C**                                                                  E86111
     C** LOOK UP TABLE FOR NUMBER OF DAYS IN MONTH                        E86111
     C**                                                                  E86111
     CSR         RMN       LOKUPTABMN     TABDY          42               E86111
     CSR                   MOVE TABDY     CALC1   20                      E86111
     C**                                                                  E86111
     C** CHECK IF FEBRUARY AND A LEAP YEAR                                E86111
     C**                                                                  E86111
     CSR         RMN       COMP 'FEB'                    42               E86111
     CSR       42RYR       DIV  4         CALC2   20                      E86111
     CSR       42          MVR            QUOT    20                      E86111
     CSR       42QUOT      COMP 0                        41               E86111
     CSR    41 42CALC1     ADD  1         CALC1                           E86111
     C**                                                                  E86111
     C** CALCULATE END DATE IN ABSOLUTE DAYS                              E86111
     C**                                                                  E86111
     CSR         CALC1     SUB  RDAY      CALC1                           E86111
     CSR         RUND      ADD  CALC1     ENDATE                          E86111
     CSR                   ENDSR                           * ZENDAT ENDSR*E86111
0563 C********************************************************************
     C/SPACE 3                                                            S01117
     C********************************************************************S01117
     C*                                                                   S01117
     C*  *PSSR --- SUBROUTINE TO HANDLE ABNORMAL ERROR CONDITIONS         S01117
     C*                                                                   S01117
     C*  CALLED FROM: AFTER ABNORMAL OPERATION OCCURS                     S01117
     C*                                                                   S01117
     C*  CALLS: NOTHING                                                   S01117
     C*                                                                   S01117
     C********************************************************************S01117
     C*                                                                   S01117
     C           *PSSR     BEGSR                           ** *PSSR **    S01117
     C*                                                                   S01117
     C           @RUN      IFEQ *BLANKS                                   S01117
     C                     MOVE 'Y'       @RUN    1                       S01117
     C                     DUMP                                           S01117
     C                     END                                            S01117
     C                     ENDSR                           ** *PSSR **    S01117
     C*                                                                   S01117
     C********************************************************************S01117
     C/TITLE SR/ZDATE2                                                    S01392
     C/COPY ZSRSRC,ZDATE2Z4                                               S01392
     C/TITLE SR/GLINTC                                                    S01392
     C/COPY ZSRSRC,GLINTCZ1                                        S01195 S01392
     C/TITLE SR/ZSAVE                                                     S01392
     C/COPY ZSRSRC,ZSAVEZ1                                         S01195 S01392
     C/TITLE SR/ZRSTOR                                                    S01392
     C/COPY ZSRSRC,ZRSTORZ1                                        S01195 S01392
     C/TITLE SR/ZFLAC                                                     S01392
     C/COPY ZSRSRC,ZFLACZ2                                                S01392
      /EJECT                                                              066550
     C/COPY ZSRSRC,ZINTDYZ2                                               066550
      /EJECT                                                              066550
     C/COPY ZSRSRC,ZDATE9Z3                                               066550
     C/COPY ZSRSRC,ZDAT10Z2                                               126017
      /EJECT                                                              066550
     C/COPY ZSRSRC,ZFREQBZ2                                                                   CLE028
     C/COPY ZSRSRC,ZDATE1Z2                                                                   CLE028
     C/COPY ZSRSRC,ZACCH                                                                      CLE028
     C/COPY ZSRSRC,ZCHKH                                                                      CLE028
     C/COPY ZSRSRC,RULE78Z1                                                                   CLE028
      ****************************************************************    S01392
     C/EJECT                                                              S01117
0564 OINDUSHH D        01
0565 O                                    1 'H'
0566 OINDUSIN D        60
0567 O                                    1 'D'
0568 O***********              BRCD       4                               S01117
0568 O                         BRCA       4                               S01117
0569 O                       66ORIND      7
0570 O                      N66LIND       7
0571 O                         CNUM      13
0572 O                         LNRF      19
0573 O                         CCY       22
0574 O                         YTDAV     29P
0575 O                         CPAM      36P
0576 O                         INTINC    43P
0577 O                         YFLN      50P
0578 O                         CYIELD    56P
0579 O                         LTYP      61
0580 O                         SUTP      63
0581 O                       66OLNO      69
0582 O                      N66LNRF      69
0583 O                         PTYP      71
0584 O                       66ORCUS     77
0581 O                       64OLNO      77                               S01270
0585 O**********            N66CNUM      77                               S01270
0585 O                   N64N66CNUM      77                               S01270
0586 O                         ABLN      84P
     O                         CMPYM     90                               S01117
     O                         RCSI      91                               S01270
     O                         CLAS      95                                                   CLE042
0587 OINDUSZZ T        LRNU8
0588 O                                    1 'T'
0589 O                         COUNT2     4P
0590 O                         HSHWN2    12P
0591 O                         HSHDC2    14P
0592 O**
0593 O**   RUN CONTROL REPORT
0594 O**
0595 O*E1030P1T** 03   LR                                        S01124   S01117
0595 OLE1030AUT   03   LR                                                 S01117
0596 O***********                        22 'REFERENCE  LE1030'           S01117
0596 O                                   22 'REFERENCE  LE1030AU'         S01117
0597 O                         TITL      89
0598 O                                  104 'DATE'
0599 O                         RUNA     112
0600 O                                  127 'PAGE    1'
0601 O        T   05   LR
0602 O                                   54 'LOANS OUTSTANDING BY IND'
0603 O                                   78 'USTRY EXTRACT - FILE CON'
0604 O                                   83 'TROLS'
0605 O        T   06   LR
0606 O                                   54 '------------------------'
0607 O                                   78 '------------------------'
0608 O                                   83 '-----'
0609 O        T   09   LR
0610 O                                   28 'S/INDUS - RUN CONTROLS'
0611 O                                   59 'NUMBER'
0612 O                                   84 'VALUE'
0613 O        T   10   LR
0614 O                                   28 '----------------------'
0615 O                                   59 'OF RECORDS'
0616 O                                   84 'OF RECORDS'
0617 O        T   12   LR
0618 O                                   29 'TOTAL RECORDS ON FILE'
0619 O                         COUNT23   59
0620 O                         HSHWN24   81
0621 O                         HSHDC2    84
0622 O        T   15   LR
0623 O                                   28 'S/CLOAN - RUN CONTROLS'
0624 O        T   16   LR
0625 O                                   28 '----------------------'
0626 O        T   18   LR
0627 O                                   29 'TOTAL RECORDS ON FILE'
0628 O                      NU7NORE  3   59
0629 O                      NU7VLAF  4   81
0630 O                      NU7VLAL      84
0631 O        T   20   LR
0632 O                                   29 'TOTAL RECORDS ON FILE'
0633 O                                   42 '- CALCULATED'
0634 O                         COUNT13   59
0635 O                         HSHWN14   81
0636 O                         HSHDC1    84
0637 O                    U8NU7         111 '***   DIFFERENCE   ***'
0638 O        T 32     LR U7
0639 O***********                        51 '*** REFERENCE LE1030'        S01117
0639 O                                   51 '*** REFERENCE LE1030AU'      S01117
0640 O***********                        71 '- DATABASE ERROR AT'         S01117
0641 O***********              DBASE     74                               S01117
0640 O                                   71 'DATABASE ERROR AT'           S01117
0641 O                         DBASE     75                               S01117
0642 O        T        LR U7
0643 O***********                        37 'FILENAME'                    S01117
0644 O***********              DBFILE    43                               S01117
0645 O***********                        48 'KEY'                         S01117
0646 O***********              DBKEY     78                               S01117
0643 O                                   39 'FILENAME'                    S01117
0644 O                         DBFILE    48                               S01117
0645 O                                   52 'KEY'                         S01117
0646 O                         DBKEY     82                               S01117
0647 O********T*3      LR                                                 S01117
0648 O***********                        76 '*** END OF REPORT ***'       S01117
**   ZYDY - YEARS IN DAYS CUMULATIVE IN FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
** CPY@   **      OBJECT COPYRIGHT
(c) Finastra International Limited 2001
**   TABMN - MONTH END TABLE
JAN31FEB28MAR31APR30MAY31JUN30JUL31AUG31SEP30OCT31NOV30DEC31
** @YD  USED BY SR. ZDATE9 - YEARS, IN DAYS, CUMULATIVE IN 4 YEAR SPAN
00366007310109601461
** @MD  USED BY SR. ZDATE9 - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
00000000310005900090001200015100181002120024300273003040033400365
**   ZFMD  -  NUMBER OF DAYS IN THE MONTH                                                     CLE028
312831303130313130313031                                                                      CLE028
