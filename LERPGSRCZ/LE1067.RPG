     H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas LE Create pay/receive extract files for MS')     *
     F*****************************************************************
     F*                                                               *
     F*  Midas - Customer Lending Module                              *
     F*                                                               *
     F*  LE1067  -  CREATE PAY/RECEIVE EXTRACT FILES                  *
     F*             FOR MIDAS/SWIFT DIRECT LINK                       *
     F*                                                               *
      *  (c) Finastra International Limited 2001                      *
      *                                                               *
      *  Last Amend No. CSD103             Date 10Aug20               *
      *  Prev Amend No. MD055733           Date 03Jul20               *
      *                 MD053295           Date 13Apr19               *
      *                 MD050139           Date 23Mar18               *
      *                 CLE071             Date 18Jul18               *
      *                 MD046248           Date 27Oct17               *
      *                 MD047993           Date 23Sep17               *
      *                 MD035545           Date 11Sep15               *
      *                 CGL184             Date 07Dec16               *
      *                 CLE141             Date 08Feb16               *
      *                 AR830785           Date 07May13               *
      *                 AR996895           Date 25Nov12               *
      *                 CLE134             Date 01Aug12               *
      *                 CLE148             Date 23Jul12               *
      *                 CLE064             Date 06Dec10               *
      *                 263666             Date 01Feb10               *
      *                 CER059             Date 19Jul10               *
      *                 CER016A            Date 19May08               *
      *                 CER020             Date 19May08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *                 246141             Date 26Mar07               *
      *                 232787             Date 31Jul07               *
      *                 245691             Date 19Feb07               *
      *                 164847             Date 30Nov06               *
      *                 BUG12990           Date 05Jan07               *
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 242286             Date 25Sep06               *
      *                 239588             Date 10May06               *
      *                 CSD031             Date 10Apr06               *
      *                 CSD027             Date 16Mar06               *
      *                 CLE042             Date 06Sep05               *
      *                 227719             Date 08Jun04               *
      *                 CLE038             Date 11May04               *
      *                 CLE036             Date 22Sep03               *
      *                 CSW037A            Date 02May05               *
      *                 CIR013             Date 25Apr05               *
      *                 230521             Date 28Oct04               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 CLE025             Date 20Oct03               *
      *                 CGL029             Date 01Sep03               *
      *                 CAP075             Date 16Sep03               *
      *                 CAP074             Date 16Sep03               *
      *                 CLE034             Date 05May03               *
      *                 CLE031             Date 13Feb03               *
      *                 CLE028             Date 27Jun02               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.05 -----------------------------------------------*
      *                 CLE011             Date 07Nov00               *
      *                 137584             Date 11Jan01               *
      * Midas DBA 3.03 -----------------------------------------------*
      *                 CIR004             Date 20Jan00               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 157863             Date 06Apr99               *
      *                 157903 (E44967)    Date 06May98               *
      *                 155570             Date  4Mar99               *
      *                 142406             Date  4Mar99               *
      *                 156523             Date 25Mar99               *
      *                 148104             Date 10Dec98               *
      *                 147236             Date 11NOV98               *
     F*                 141893             Date 02Sep98               *
     F*                 138764             Date 13Aug98               *
     F*                 137920             Date 29Jun98               *
     F*                 135378             Date 18May98               *
     F*                 CEU004             Date 29MAR98               *
     F*                 121768             DATE 19FEB98               *
     F*                 128092             Date 24Dec97               *
     F*                 128093             Date 24Dec97               *
     F*                 128094             Date 24DEC97               *
     F*                 128095             Date 24DEC97               *
     F*                 CLE002             Date 02DEC96               *
     F*                 S01518             DATE 03OCT94               *
     F*                 046673             DATE 31OCT92               *
     F*                 043772             DATE 15OCT92               *
     F*                 E45727             DATE 23NOV92               *
     F*                 S01392             DATE 14SEP92               *
     F*                 BHF991             DATE 31MAR92               *
     F*                 S01220             DATE 15MAR91               *
     F*                 LN1040             DATE 27NOV90               *
     F*                 LN1039             DATE 27NOV90               *
     F*                 BHF550             DATE 01JAN90               *
     F*                 S01194             DATE 18JAN90               *
     F*                 S01117             DATE 28MAY89               *
     F*                                                               *
     F*---------------------------------------------------------------*
      *                                                               *
      *  CSD103 - LIBOR Deregulation - Common Layer/Standing Data     *
      *  MD055733 - COB: Multiple UTCHOBJEX calls in LEC06A           *
      *             components.                                       *
      *           - Redeliver of MD050139.                            *
      *  MD053295 - Lending loan with Interest Calculation Basis      *
      *             method 3 (30/360) has wrong interest payment      *
      *             amount for month of March (Recompile)             *
      *  MD050139- AOSARDR0 called every time causing performance     *
      *            issue. Recompile due to changes in /COPY           *
      *            ZFREQ/ZFRQ*.                                       *
      *  CLE071 - Value Dating of Rate Changes to Fees (Recompile)    *
      *  MD046248 - Finastra Rebranding                               *
      *  MD047993 - Modified MD035545. Removed dependency on Accrue   *
      *             on Last Day indicator.                            *
      *  MD035545 - LE: Interest Calculation in Leap year. Consider   *
      *             Accrue on Last Day Indicator for method 6.        *
      *  CGL184 - New Frequencies for Account Statements (Recompile)  *
      *  CLE141 - Currency and Location Business Day Convention       *
      *           (Recompile)                                         *
      *  AR830785 - Recompiled due to changes in core hook RULE78Z1.  *
      *             (Child: AR830786)                                 *
      *  AR996895 - Incorrect acrrual interest calculation            *
      *             (Child: AR996897) (Recompile)                     *
      *  CLE134 - Past Due Call Loan Processing                       *
      *  CLE148 - Alpha Loan Reference                                *
      *  CLE064 - Enhancement of Lending Frequencies (Recompile)      *
      *  263666 - Recompiled due to changes in ZINTDYZ2               *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  CER016A - German Interest Calculation: Upgarde of FGE059     *
      *            to Midas Plus (Recompile)                          *
      *  CER020 - Enhanced Rollover Window: Upgrade FGE089 to         *
      *           Midas Plus                                          *
      *  246141 - Recompiled due to changes in ZINTDYZ2               *
      *  232787 - Infinite Loop during run, applied fix GEMS 232787   *
      *  245691 - Allow File Control Amounts to be negative.          *
      *           (complete 219063). Remove 157903.  Applied fix      *
      *           230531.                                             *
      *  164847 - Recompile over changes in /COPY ZINTDYZ2.           *
      *  BUG12990 - Recompiled due to changes in ZINTDYZ2/ZINTDYZ2LE  *
      *  242286 - Recompile over changes in /COPY ZINTDYZ2.           *
      *  239588 - Incorrect Currency code on SWIFT messages when IN   *
      *           currency being settle by EUR.                       *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CLE042 - Extended Loan Sub Type                              *
      *  227719 - Settlement account details are not being set up     *
      *           correctly for loans with settlement allocations.    *
      *  CLE038 - Lending Enhancement for Nordea: Allocation by Amount*
      *  CLE036 - Lending Enhancements for Nordea Phase 1 Priority 2: *
      *           Allow repayments in facility currency               *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  CIR013 - Additional Calculation Method for FRA/IRS/CCF       *
      *           Recompile over GLINTC and ZINTDY.                   *
      *  230521 - Store the loan/facility customer number.  Applied   *
      *           fix 215643.                                         *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  CLE025 - Credit Lines (Recompile)                            *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  CAP075 - Lending API enhancements - Loan Amendments Input    *
      *  CAP074 - Lending API enhancements - Loans input.             *
      *  CLE034 - Lending Enhancements Phase 1 Priority 1A            *
      *  CLE031 - Lending Enhancements.                               *
      *  CLE028 - Flat Rate Personal Loans (Rule of 78s)              *
      *  CLE011 - Rate Fixing Days for Lending Rollover Processing    *
     F*  137584 - Data Base error on LE0510.  OSBR is blank.          *
     F*           Only OURAG is checked if it is blank when           *
     F*           defaulting BRCA to OSBR.  Also check if OSBR        *
     F*           is still blank.  If blank, default to BRCA.         *
      *  CIR004 - Dealing Calculation Method Change.                  *
      *         - Recompiled due to GLINTC and ZINTDY changes         *
      *  157863 - LE0520, FOOB caused by fix to take out 0 payments   *
      *  157903 - Hash totalling does not take account of negative    *
      *           event amounts (e.g. from Manual Repayments)         *
      *  155570 - Program should include new processing types         *
      *           introduced in Customer Lending Enhancements.        *
      *  142406 - BHF: If we mature a part sold today, interest is    *
      *           not shown                                           *
     F*  156523 - Only the transaction currency is moved into DBKEY   *
     F*           at DBASE error 8 even when the settlement currency  *
     F*           is not blank.                                       *
     F*         - Use Extended Settlement fields when the feature is  *
     F*           switched on.
     F*  148104 - Blank OTAM output to PF/LEPXTAB.                    *
     F*           Save EAMT in transaction currency to AMTSV to be    *
     F*           output to field OTAM before it is converted to      *
     F*           settle currency.                                    *
     F*           Use Z-ADD instead of MOVE when storing values to    *
     F*           P@FRAM which is 18,3.                               *
     F*  147236 - INCORRECT SETTLEMENT CURRENCY TAKEN INTO CONSIDER.  *
     F*           FOR LOAN AMENDMENTS                                 *
     F*  141893 - Addition to 138764                                  *
     F*  138764 - Error in EU0200 due to blank from currency          *
     F*  137920 - EMU Additional Fixes for LE Settlement Currency     *
     F*  137920 - EMU Additional Fixes for LE Settlement Currency     *
     F*           Conversion                                          *
     F*  135378 - Additional Lending EMU Fixes                        *
      *  CEU004 - LE Settlement Ccy Conversion Upgrade to DBA R2.0    *
     F*  121768 - Recompile over changed GLINTCZ1                     *
     F*  128092 - No pay/recs produced for loan amendments. Amendment *
     F*           status defined in wrong position on LOAMSDK         *
     F*  128093 - Maturity pay/receives should be produced in I/C     *
     F*           if date is within notice days. Maturity pay/rec     *
     F*           indicator is set up in loans input but not          *
     F*           processed here. As part of this fix, the calculation*
     F*           of payment amounts for both value and maturity date *
     F*           messages was corrected                              *
     F*  128094 - Add Input Cycle Pay / Receive functionality         *
     F*           for Manual Repayments                               *
     F*  128095 - SWIFT messages erroneously produced for settlement  *
     F*           type 01  (install fix from GEMS passim)             *
     F*  CLE002 - Customer Lending Enhancements - Authorisation       *
     F*  S01518 - BLI Lending Swift Enhancement.                      *
     F*  046673 - INCREMENT COUNT OF RECORDS READ FROM LTRIN          *
     F*           FOR RECORD TYPE 'R' TO AVOID FCOOB ERROR            *
     F*  043772 - IF BLANK SETTLEMENT A/C, SYSTEM SHOULD DEFAULT      *
     F*           SETTLEMENT BRANCH TO BOOKING BRANCH.                *
     F*           ENHANCEMENT OF FIX S01117 IS INCOMPLETE.            *
     F*           APPLIED PARTIAL FIX OF S01117 OF LE1068.            *
     F*  E45727 - Recompile as fee sequence added to LETX3PR.         *
     F*  S01392 - Japanese sub module enhancements                    *
     F*  BHF991 - Chain to CLOAN after the chain to LOAMS causes      *
     F*           OUR settlement branch to have the wrong value       *
     F*  S01220 - Amended for Strategic Risk Management               *
     F*           release 10 to allow the input of a book             *
     F*           code against a loan.                                *
     F*  LN1040 - Does not output OUR settlement branch to            *
     F*           LEPXTAB                                             *
     F*  LN1039 - Incorrect resulting indicator placing               *
     F*           to ascertain if SWIFT member                        *
0006 F*  BHF550 - Incorrect message set up for LDA                    *
     F*  S01194 - New standing data                                   *
     F*  S01117 - Multibranching                                      *
     F*                                                               *
     F*****************************************************************
     F*                                                               *
     F* TRANSACTION FILES
     F*****************************************************************
     F***LTRIN***IP  F      40 20AI     1 DISK                            128093
     F***LTRIN   IP  F      41 20AI     1 DISK                      128093CLE031
     FLTRIN   IP  F      43 20AI     1 DISK                               CLE031
     F* MASTER FILES
     F*CLOAN***IF**F*****400  7AI     2 DISK                              S01220
     F***CLOAN***IF**F     436  7AI     2 DISK                     S01220 S01518
     F***CLOAN***IF  F    1087  7AI     2 DISK                     S01518 CLE002
     F***CLOAN***IF  F    1275  7AI     2 DISK                     CLE002 CEU004
     F*CLOAN***IF**F    1290  7AI     2 DISK                       CEU004 CLE011
     F*CLOAN***IF**F    1310  7AI     2 DISK                                           CLE011 CLE028
     F*CLOAN***IF**F    1389  7AI     2 DISK                                           CLE028 CLE031
     F*CLOAN***IF**F    1492  7AI     2 DISK                                           CLE031 CLE034
     F*CLOAN***IF**F    1493  7AI     2 DISK                                           CLE034 CAP074
     F***CLOAN** IF  F    1560  7AI     2 DISK                                         CAP074 CGL029
     F*CLOAN***IF**F****1632  7AI     2 DISK                                           CGL029 CLE042
     F***CLOAN** IF  F    1773  7AI     2 DISK                                         CLE042 CER020
     F***CLOAN** IF  F    1782  7AI     2 DISK                                         CER020 CLE134
     FCLOAN   IF  F    1874  7AI     2 DISK                                                   CLE134
     F***LOAMS***IF**F     320 14AI     2 DISK                            S01518
     F***LOAMS***IF  F     949 14AI     2 DISK                     S01518 CLE002
     F***LOAMS***IF  F    1051 14AI     2 DISK                     CLE002 CEU004
     F***LOAMS***IF  F    1066 14AI     2 DISK                                         CEU004 CLE028
     F***LOAMS***IF  F    1075 14AI     2 DISK                                         CLE028 CLE031
     F*LOAMS***IF**F    1108 14AI     2 DISK                                           CLE031 CLE034
     F*LOAMS***IF**F    1109 14AI     2 DISK                                           CLE034 CAP075
     F***LOAMS** IF  F    1176 14AI     2 DISK                                         CAP075 CGL029
     F***LOAMS** IF  F    1230 14AI     2 DISK                                         CGL029 CLE036
     F*LOAMS***IF**F****1644 14AI     2 DISK                                           CLE036 CLE042
     FLOAMS   IF  F    1291 14AI     2 DISK                                                   CLE042
     F*TABLE***IF  F      96 12AI     2 DISK                              S01194
     F*CLINT***IF  F     256  7AI     2 DISK                              S01194
     F* OUTPUT FILES
     FLETX1HH O   F     180            DISK
     F*LETX1PR O   F     180            DISK                              S01117
     F***LETX1PR*O   F     200            DISK                     S01117 CEU004
     F***LETX1PR O   F     210            DISK                                         CEU004 CGL029
     F*LETX1PR*O***F*****228            DISK                                           CGL029 CLE042
     FLETX1PR O   F     232            DISK                                                   CLE042
     FLETX1ZZ O   F     180            DISK
     FLETX2HH O   F     180            DISK
     F*LETX2PR O   F     180            DISK                              S01117
     F***LETX2PR*O   F     200            DISK                     S01117 CEU004
     F***LETX2PR O   F     210            DISK                                         CEU004 CGL029
     F*LETX2PR*O***F*****228            DISK                                           CGL029 CLE042
     FLETX2PR O   F     232            DISK                                                   CLE042
     FLETX2ZZ O   F     180            DISK
     FLETX3HH O   F     180            DISK
     F*LETX3PR O   F     180            DISK                              S01117
     F***LETX3PR*O   F     200            DISK                     S01117 CEU004
     F***LETX3PR O   F     210            DISK                                         CEU004 CGL029
     F*LETX3PR*O***F*****228            DISK                                           CGL029 CLE042
     FLETX3PR O   F     232            DISK                                                   CLE042
     FLETX3ZZ O   F     180            DISK
     FLEPXTAA O   F     320            DISK                           U4
     F***LEPXTAB*O***F     320            DISK                          U4S01518
     F***LEPXTAB*O   F     346            DISK                  U4 S01518 CEU004
     F***LEPXTAB O   F     356            DISK                           U4            CEU004 CGL029
     F***LEPXTAB O   F     392            DISK                           U4            CGL029 230521
     F*LEPXTAB*O***F*****398            DISK                           U4              230521 CLE042
     FLEPXTAB O   F     402            DISK                           U4                      CLE042
     FLEPXTAC O   F     320            DISK                           U4
     F/COPY WNCPYSRC,LE1067F002
     F*E1067AUO   F     132            PRINTER                            S01117
     FLE1067AUO   F     132     OB     PRINTER                            S01117
     F/COPY WNCPYSRC,LE1067F001
     F*
     F* ID F  C  H  L    FUNCTION OF INDICATORS
     F*
     F* 01            LTRIN FILE - HEADER RECORD
     F* 02                       - DETAIL
     F* 03                       - TRAILER
     F* 04            LOAMS FILE - LIVE DETAIL RECORD
     F* 05                       - REVERSED
     F**06******      CLINT FILE - DETAIL RECORD 'A'                      S01194
     F*    20         DEFAULT BRANCH CODE BLANK (I.C.D.R.1)
     F*    21         PAY/RECEIVE INDICATOR NOT ZERO (LTRIN)
     F*       22      WORK (IN PROC1)
     F*       30      Lending Swift feature is switched ON                S01518
     F*       34      OUTPUT A RECORD
     F*       37      WORK (CHKSW & PROCEE SUBROUTINES)
     F*       40      FIRST CYCLE INDICATOR
     F*       41      CHAIN FAILURE
     F*       42      WORK
     F*       43      LTRIN OUT OF BALANCE
     F*       44      DEFAULT BRANCH CODE ZERO
     F********45******RELATED*LOAN*PROCESSING*TYPE*61,62,63,64,65*OR*70***155570
     F********46***********************************66,67******************155570
     F********47***********************************64,65******************155570
     F*       45      RELATED LOAN PROCESSING TYPE 61,62,63,64,65,68      155570
     F*       46                                   66,67,69               155570
     F*       47                                   64,65,68               155570
     F*       48      LTRIN RECORD RELATES TO-A LOAN
     F*       49                             -A LOAN AMENDMENT
     F*       50      INSTRUCTIONS VALID
     F*       51      OUTPUT A RECORD TO - LETX1
     F*       52                           LETX2
     F*       53                           LETX3
     F*       54      LOCAL CCY NOSTRO-TELEX OR BANK AUTHORISATION = B
     F*       55      OUTPUT A RECORD TO LEPXT
     F*       62      REVERSAL,OR PREVIOUS TELEX/SWIFT MSG GENERATED
     F*          U4   SWIFT INTERFACE EXISTS
     F*       U7+U8   DATABASE ERROR
     F*          U8   LTRIN OUT OF BALANCE
     F*
     E                    CPY@    1   1 80
     E/COPY WNCPYSRC,LE1067E001
     E                    INT         4 15 0             RECORDS O/P
     E                    DEC         4  3 0             RECORDS O/P
     E                    ROP         4  5 0             NO.RECORDS O/P
     E/COPY WNCPYSRC,LE1067E002
     E*
     E                    IPSET   5   5  2 0             I/P CYC.SET.TYPES
     E********************TABTP1  5   5  2 0             DEPT. DEAL TYPES 155570
     E********************TABTP2  2   2  2 0             DEPT DL.AMD. TYPE155570
     E********************TABTP3  2   2  2 0                              155570
     E**********          TABTP1  6   6  2 0                                           155570 CLE028
     E                    TABTP1  7   7  2 0                                                  CLE028
     E                    TABTP2  3   3  2 0                              155570
     E                    TABTP3  3   3  2 0                              155570
     E/COPY ZSRSRC,ZDATE9Z1                                               128092
     E/COPY ZSRSRC,ZFREQBZ1                                                                   CLE028
     E/COPY ZSRSRC,ZDATE2Z1                                                                   CLE028
     E/COPY ZSRSRC,ZHOLE                                                                      CLE028
     E**
     I*    LOAN TRANSACTIONS INDEX FILE - HEADER RECORD.
     I*
     ILTRIN   NS  01   1 CH
     I                                        1   1 RECI
     I                                        2   2 RCDT
     I**********                              3   80LNRF                                      CLE148
     I                                        3   8 LNRF                                      CLE148
     I                                    P   9  110NORE
     I                                    P  12  140FLSZ
     I                                    P  15  170RRLC
     I                                    P  18  200RRNA
     I                                    P  21  230RRLX
     I                                    P  24  260RRXP
     I                                    P  27  290NLNR
     I                                    P  30  320NLAR
     I                                       33  330STPI
     I                                    P  38  400TNLU
     I*
     I*
     I*    LOAN TRANSACTIONS INDEX FILE - DETAIL RECORD.
     I*
     I        NS  02   1 CD   2 CA
     I       OR        1 CD   2 CL
     I       OR        1 CD   2 CR                                        S01392
     I                                        1   1 RECI
     I                                        2   2 RCDT
     I**********                              3   80LNRF                                      CLE148
     I                                        3   8 LNRF                                      CLE148
     I                                        9  130VDATLN
     I                                       14  160LASNLN
     I                                       17  17 CHTPXT
     I                                       18  18 CNRQ
     I                                       19  19 CNPR
     I                                       20  20 REPR
     I                                       21  250RRLA
     I                                       26  26 LADI
     I                                       27  270PRI1        2121
     I                                       32  34 BRCA                  S01117
     I                                    P  35  370RRNT
     I                                    P  38  400TNLU
      * Maturity pay/rec indicator                                        128093
     I                                       41  410PRI2                  128093
     I                                       42  420PRI3                  CLE031
     I*
     I*
     I*    LOAN INDEX FILE - TRAILER RECORD.
     I*
     I        NS  03   1 CT
     I                                        1   1 RECI
     I                                        2   60NORL
     I                                    P  14  160NLNR
     I                                    P  17  190NLAR
     I*
     I*
     I* CATCHALL
     I        NS
     I*
     I*    CLOAN FILE - DETAIL
     I*
     ICLOAN   NS       1 C*   8 CA
     I       OR        1 CD   8 CA
     I       OR        1 CM   8 CA
     I       OR        1 CR   8 CA
     I                                        1   1 RECI
     I**********                              2   70LNRF                                      CLE148
     I                                        2   7 LNRF                                      CLE148
     I                                        8   8 RCDTZ
     I                                        9   90MRIN
     I                                       10  110PTYP
     I***********                            12  170CNUM                                      CSD027
     I                                       12  17 CNUM                                      CSD027
     I***********                            18  200BRCD                  S01117
     I                                       18  20 BRCA                  S01117
     I                                       21  22 LTYP
     I                                       23  24 SUTP
     I                                    P  25  270DDAT
     I                                    P  28  300VDAT
     I                                    P  31  330MDAT
     I                                       34  350LASQ
     I**********                             36  410FCUS                                      CSD027
     I                                       36  41 FCUS                                      CSD027
     I                                       42  440FTYP
     I                                       45  460FSEQ
     I                                       47  49 CCY
     I                                    P  50  560CPAM
     I                                       57  57 INTC
     I                                    P  58  637INTR
     I**********                             64  650BRTT                                      CSD103
     I                                       64  65 BRTT                                      CSD103
     I                                    P  66  717BRTE
     I                                    P  72  777RTSP
     I                                    P  78  815MARG
     I                                       82  82 SPIN
     I                                       83  83 CHIN
     I                                    P  84  897WTRT
     I                                       90  90 WTIN
     I                                       91  91 REPT
     I                                    P  92  980RAMT
     I                                    P  99 1010NRPD
     I                                      102 102 RFRQ
     I                                      103 1040RDYN
     I                                      105 107 FCCY
     I                                      108 1100LIND
     I                                      111 112 CRSK
     I                                      113 114 ACOF
     I                                      115 115 NACD
     I                                      116 116 RELI
     I                                      117 117 AUTO
     I                                    P 118 1240PSAM
     I                                    P 125 1318BCXR
     I                                    P 132 1388FCXR
     I                                      139 1400SDST
     I**********                            141 152 OSDA                                      CGL029
     I                                      141 152 QQOSDA                                    CGL029
     I                                      153 162 TSTN
     I                                      163 1640MDST
     I**********                            165 176 OMDA                                      CGL029
     I                                      165 176 QQOMDA                                    CGL029
     I                                      177 186 TMAN
     I                                      187 196 FACO
     I                                    P 197 1990RLDT
     I                                    P 200 2020NROD
     I                                      203 203 RLFQ
     I                                      204 2050RLDY
     I                                      206 206 RDFC                  128093
     I**********                            207 2080NBRA                                      CSD103
     I                                      207 208 NBRA                                      CSD103
     I                                    P 209 2147NRTS
     I                                      215 215 NSIN
     I                                      216 2160NCAC
     I                                    P 217 2230AWTP
     I                                    P 224 2300WTRD
     I                                    P 231 2370WTWD
     I                                    P 238 2440IWOD
     I                                    P 245 2510PWOD
     I                                      252 252 BMDI
     I                                      253 253 FMDI
     I                                    P 254 2600PDIN
     I                                      265 267 @OSBR                 S01117
     I                                      287 287 BTIN
     I                                      288 2890BLDY
     I***********                           290 2950OLNO                                      CSD027
     I                                      290 295 OLNO                                      CSD027
     I                                      296 296 RCSI
     I                                      297 2970ICBS
     I                                      298 298 IPFR
     I                                    P 299 3050TOTI
     I                                    P 306 3080NIDT
     I                                    P 309 3110IBDT
     I                                    P 312 3140SLID
     I                                    P 315 3210AIPD
     I                                    P 322 3240DLRC
     I                                    P 325 3270IACD
     I                                    P 328 3340AITC
     I                                    P 335 3410TFEP
     I                                    P 342 3480AIAP
     I                                    P 349 3550IPRD
     I                                    P 356 3620IPRM
     I                                    P 363 3690ICTD
     I                                    P 370 3760AIMN
     I                                    P 377 3790RBDT
     I                                      384 3850IFDY
     I                                      386 386 LONI
     I                                      387 387 CNFI
     I                                      388 388 ACEI
     I                                      389 389 TLXI
     I                                      390 390 CBLI
     I                                    P 391 3930ORED
     I                                    P 394 3960LCD
     I                                      397 397 CHTP
     I                                    P 398 4000TNLU
     I                                      435 436 BOKC                  S01220
     I** Extended Settlement details                                      S01518
     I                                      459 4600RSTM                  S01518
     I**********                            461 472 RONS                               S01518 CGL029
     I                                      461 472 QQRONS                                    CGL029
     I                                      473 480 RIBN                  S01518
     I                                      481 515 RIBA                  S01518
     I***********                           516 5210ROBN                  S01518              CSD027
     I                                      516 521 ROBN                                      CSD027
     I***********                           522 5270ROCN                  S01518              CSD027
     I                                      522 527 ROCN                                      CSD027
     I                                      528 5290PSTM                  S01518
     I**********                            530 541 PONS                               S01518 CGL029
     I                                      530 541 QQPONS                                    CGL029
     I                                      542 549 PIBN                  S01518
     I                                      550 584 PIBA                  S01518
     I***********                           585 5900POBN                  S01518              CSD027
     I                                      585 590 POBN                                      CSD027
     I***********                           591 5960POCN                  S01518              CSD027
     I                                      591 596 POCN                                      CSD027
     I                                      597 604 RCRN                  S01518
     I                                      605 639 RCRA                  S01518
     I                                      640 647 RVNO                  S01518
     I                                      648 655 AWBN                  S01518
     I                                      656 690 AWBA                  S01518
     I                                      691 698 BENN                  S01518
     I                                      699 733 BENA                  S01518
     I                                      734 768 DTP1                  S01518
     I                                      769 803 DTP2                  S01518
     I                                      804 838 DTP3                  S01518
     I                                      839 873 DTP4                  S01518
     I                                      874 876 DCHG                  S01518
     I                                      877 911 BTB1                  S01518
     I                                      912 946 BTB2                  S01518
     I                                      947 981 BTB3                  S01518
     I                                      9821016 BTB4                  S01518
     I                                     10171051 BTB5                  S01518
     I                                     10521086 BTB6                  S01518
     I                                     10871087 CVMR                  S01518
     I                                     12161216 LSTS                  CLE002
     I                                     12851287 SCCY                  CEU004
     I                                     12881290 ICCY                  CEU004
     I                                     13491349 ADIF                                      CLE028
     I                                     13501350 ADCF                                      CLE028
     I                                    P135113570CHGA                                      CLE028
     I                                     13581358 ICIF                                      CLE028
     I                                    P135913650FLTI                                      CLE028
     I                                    P136613680FRPD                                      CLE028
     I                                    P136913750ACCH                                      CLE028
     I                                    P147414808REXR                  CLE031
     I                                     14811481 REXI                  CLE031
     I                                     14821484 PSCY                  CLE031
     I                                    P148514918PEXR                  CLE031
     I                                     14921492 PEXI                  CLE031
     I                                     14931493 STAL                                      CLE034
     I                                     14941513 FRNT                                      CAP074
     I                                     15141533 AFRT                                      CAP074
     I                                     15341534 REPA                                      CAP074
     I                                     15351560 TMST                                      CAP074
     I                                     15611578 OSDA                                      CGL029
     I                                     15791596 OMDA                                      CGL029
     I                                     15971614 RONS                                      CGL029
     I                                     16151632 PONS                                      CGL029
     I                                     17621765 CLAS                                      CLE042
     I                                     17661769 DFCL                                      CER020
     I                                     17701773 SLCL                                      CER020
     I                                    P177417760ISDT                                      CER020
     I                                    P177717790FMDT                                      CER020
     I                                     17801782 LOIC                                      CER020
      *                                                                                       CLE134
     I                                     18301830 FAMU                                      CLE134
     I                                     18311831 FPNR                                      CLE134
     I                                    P183218340RIDT                                      CLE134
     I                                    P183518360RIDC                                      CLE134
     I                                     183718370RCAT                                      CLE134
     I                                    P183818390RCAC                                      CLE134
     I                                    P184018420RCSD                                      CLE134
     I                                    P184318440RCDY                                      CLE134
     I                                    P184518460RCCY                                      CLE134
      *                                                                                       CLE134
     I                                    P184718490BIDT                                      CLE134
     I                                    P185018510BIDC                                      CLE134
     I                                     185218520BCAT                                      CLE134
     I                                    P185318540BCAC                                      CLE134
     I                                    P185518570BCSD                                      CLE134
     I                                    P185818590BCDY                                      CLE134
     I                                    P186018610BICC                                      CLE134
      *                                                                                       CLE134
     I                                     18621864 XRFI                                      CLE134
     I                                     186518740XRFN                                      CLE134
      *                                                                                       CLE134
     I/COPY WNCPYSRC,LE1067I002
     I**
     I**   CLOAN FILE - DETAIL 2
     I**
     I        NS       1 CD   8 CB
     I       OR        1 CM   8 CB
     I       OR        1 CR   8 CB
     I                                        1   1 RECI
     I**********                              2   70LNRF                                      CLE148
     I                                        2   7 LNRF                                      CLE148
     I                                        8   8 RCDTZ
     I                                        9   90MRIN
     I                                       10  44 NAR1
     I                                       45  79 NAR2
     I                                       80 114 NAR3
     I                                      115 149 NAR4
     I                                    P 150 1560OPAM
     I                                      157 1610FRBC
     I                                    P 162 1680YPLN
     I                                    P 169 1750YFLN
     I                                    P 176 1820YWLN
     I                                    P 183 1890ABLN
     I                                    P 190 1960YPLC
     I                                    P 197 2030YFLC
     I                                    P 204 2100YWLC
     I                                    P 211 2170ABLC
     I                                    P 218 2240WWLN
     I                                    P 225 2310IWLN
     I                                    P 232 2380PWLN
     I                                      245 274 SPI1
     I                                      275 304 SPI2
     I                                      305 334 SPI3
     I                                      245 334 SPI             24
     I                                    P 335 3410YILN
     I                                    P 365 3710NPRAM                 CLE031
     I                                    P 391 3930ORED
     I                                    P 394 3960LCD
     I                                      397 397 CHTP
     I                                    P 398 4000TNLU
     I                                      495 495 RSTS                  CLE031
     I                                     11121114 RRSC                  CEU004
     I                                     11151117 RPSC                  CEU004
     I                                     11181120 RICY                  CEU004
     I                                     11211121 ECIN                  CLE031
     I                                     112211230RPSM                  CLE031
     I**********                           11241135 RPOS                               CLE031 CGL029
     I                                     11241135 RPOSQQ                                    CGL029
     I                                     11361145 RPTS                  CLE031
     I                                     11461148 RPSB                  CLE031
     I                                     11491158 RFAO                  CLE031
     I                                     11591163 FSFYLB                CLE031
     I                                    P116411708RRSR                  CLE031
     I                                     11711171 RRSI                  CLE031
     I                                    P117211788RPSR                  CLE031
     I                                     11791179 RPSI                  CLE031
     I                                     11801180 RSTA                                      CLE034
     I                                     11811200 FRNT                  CAP074
     I                                     12011220 AFRT                  CAP074
     I                                     12211221 REPA                  CAP074
     I                                     12221247 TMST                  CAP074
     I                                     13021319 RPOS                                      CGL029
     I*
     I*
     I*    CLOAN FILE - CATCHALL
     I*
     I        NS
     I                                        1   1 RECI
     I*
     I*    LOAMS AMENDMENT FILE - DETAIL RECORD.
     I*
     ILOAMS   NS  04   1 CD
     I       OR   05   1 CR
     I                                        1   1 RECIDK
     I**********                              2   70LNRFDK                                    CLE148
     I                                        2   7 LNRFDK                                    CLE148
     I                                        8  120VDATDK
     I                                       13  150LASNDK
     I                                       17  18 LTYPDK
     I                                       19  20 SUTPDK
     I                                       21  220PTYPDK
     I                                       23  24 AMTPDK
     I                                       35  37 CCYDK
     I                                    P  38  440PRAMDK
     I                                    P  45  510INTADK
     I                                    P  52  580WTXADK
     I                                    P  59  650FEAMDK
     I                                    P  66  720TAMTDK
     I***********                            73  750BRCDDK                S01117
     I                                       73  75 BRCDDK                S01117
     I**********                             76  810CNUMDK                                    CSD027
     I                                       76  81 CNUMDK                                    CSD027
     I                                       85  860SETPDK
     I**********                             87  98 OSACDK                                    CGL029
     I                                       87  98 QQOSAC                                    CGL029
     I                                       99 108 TSENDK
     I                                      109 118 FACODK
     I                                      119 208 SPIDK
     I                                      209 209 LAIN
     I                                      261 263 @OSBR                 S01117
     I                                    P 314 3160LCDDK
     I                                      317 317 CHTPDK
     I                                    P 318 3200TNLU
     I** Extended Settlement details                                      S01518
     I                                      321 3220RSTMDK                S01518
     I**********                            323 334 RONSDK                             S01518 CGL029
     I                                      323 334 QQRONS                                    CGL029
     I                                      335 342 RIBNDK                S01518
     I                                      343 377 RIBADK                S01518
     I***********                           378 3830ROBNDK                S01518              CSD027
     I                                      378 383 ROBNDK                                    CSD027
     I***********                           384 3890ROCNDK                S01518              CSD027
     I                                      384 389 ROCNDK                                    CSD027
     I                                      390 3910PSTMDK                S01518
     I**********                            392 403 PONSDK                             S01518 CGL029
     I                                      392 403 QQPONS                                    CGL029
     I                                      404 411 PIBNDK                S01518
     I                                      412 446 PIBADK                S01518
     I***********                           447 4520POBNDK                S01518              CSD027
     I                                      447 452 POBNDK                                    CSD027
     I***********                           453 4580POCNDK                S01518              CSD027
     I                                      453 458 POCNDK                                    CSD027
     I                                      459 466 RCRNDK                S01518
     I                                      467 501 RCRADK                S01518
     I                                      502 509 RVNODK                S01518
     I                                      510 517 AWBNDK                S01518
     I                                      518 552 AWBADK                S01518
     I                                      553 560 BENNDK                S01518
     I                                      561 595 BENADK                S01518
     I                                      596 630 DTP1DK                S01518
     I                                      631 665 DTP2DK                S01518
     I                                      666 700 DTP3DK                S01518
     I                                      701 735 DTP4DK                S01518
     I                                      736 738 DCHGDK                S01518
     I                                      739 773 BTB1DK                S01518
     I                                      774 808 BTB2DK                S01518
     I                                      809 843 BTB3DK                S01518
     I                                      844 878 BTB4DK                S01518
     I                                      879 913 BTB5DK                S01518
     I                                      914 948 BTB6DK                S01518
     I                                      949 949 CVMRDK                S01518
     I**********                           10061006 ASTSDK         CLE002 128092
     I                                     10091009 ASTSDK                128092
     I                                     10611063 SCCY                  CEU004
     I                                     10641066 ICCY                  CEU004
     I                                     10671067 ECIN                                      CLE028
     I                                     10681068 REPI                                      CLE028
     I                                    P106910750CHDU                                      CLE028
     I                                    P109010968REXRDK                CLE031
     I                                     10971097 REXIDK                CLE031
     I                                     10981100 PSCYDK                CLE031
     I                                    P110111078PEXRDK                CLE031
     I                                     11081108 PEXIDK                CLE031
     I                                     11091109 STALDK                                    CLE034
     I                                     11101129 FRNTDK                                    CAP075
     I                                     11301149 AFRTDK                                    CAP075
     I                                     11501150 REPADK                                    CAP075
     I                                     11511176 TMSTDK                                    CAP075
     I                                     11771194 OSACDK                                    CGL029
     I                                     11951212 RONSDK                                    CGL029
     I                                     12131230 PONSDK                                    CGL029
     I                                     12801283 CLASDK                                    CLE042
     I**
     I**   LOAMS FILE CATCHALL
     I        NS
     I                                        1   1 RECI
     I*
     I*****TABLE*FILE***INSTALLATION*CONTROL*DATA*RECORD*1.               S01194
     I**********                                                          S01194
     I*TABLE***NS       2 C0   3 C1  12 C1                                S01194
     I*******AND      13 C0                                               S01194
     I**********                              1   1 RECI                  S01194
     I**********                              2   30RECT                  S01194
     I**********                             12  130RCDE                  S01194
     I**********                             14  66 TITL                  S01194
     I**********                             67  67 DATF                  S01194
     I**********                             68  700DFBR            20    S01194
     I**********                             74  74 MODI1                 S01194
     I**********                             75  75 MODI2                 S01194
     I**********                             76  76 MODI3                 S01194
     I**********                          P  77  790RUND                  S01194
     I**********                             80  86 RUNA                  S01194
     I**********                             87  870SFLG                  S01194
     I**********                          P  90  920LCD                   S01194
     I**********                             93  93 CHTP                  S01194
     I**********                          P  94  960TNLU                  S01194
     I**********                                                          S01194
     I**********                                                          S01194
     I*****TABLE*FILE***INSTALLATION*CONTROL*DATA*RECORD*2.               S01194
     I**********                                                          S01194
     I*TABLE***NS              2 C0   3 C1                                S01194
     I*******AND      12 C1  13 C1                                        S01194
     I**********                              1   1 RECI                  S01194
     I**********                              2   30RECT                  S01194
     I**********                             12  130RCDE                  S01194
     I**********                             14  16 BCCY                  S01194
     I**********                             17  19 BCYL                  S01194
     I**********                             20  22 HOCY                  S01194
     I**********                             23  280HEAD                  S01194
     I**********                          P  29  310APDA                  S01194
     I**********                             35  35 APFQ                  S01194
     I**********                          P  36  380LOGS                  S01194
     I**********                             39  40 CUZR                  S01194
     I**********                          P  41  430DNWD                  S01194
     I**********                             44  460BVLP                  S01194
     I**********                             47  49 LOCY                  S01194
     I**********                             50  510FDAY                  S01194
     I**********                             52  52 ACLD                  S01194
     I***********************************    53  53 MBIN                  S01194
     I**********                             86  86 ISAV                  S01194
     I**********                          P  87  890LLOG                  S01194
     I**********                          P  90  920LCD                   S01194
     I**********                             93  93 CHTP                  S01194
     I**********                          P  94  960TNLU                  S01194
     I**********                                                          S01194
     I*****TABLE*FILE***INSTALLATION*CONTROL*DATA*RECORD*5.               S01194
     I**********                                                          S01194
     I*TABLE***NS              2 C0   3 C1                                S01194
     I*******AND      12 C4  13 C0                                        S01194
     I**********                              1   1 RECI                  S01194
     I**********                              2   30RECT                  S01194
     I**********                             12  130RCDE                  S01194
     I**********                             18  210CSAC                  S01194
     I**********                             22  22 TLII                  S01194
     I**********                             23  23 MCRI                  S01194
     I**********                          P  24  250MCEP                  S01194
     I**********                             26  270MCLP                  S01194
     I**********                             28  28 FRDI                  S01194
     I**********                             29  29 BRCF                  S01194
     I**********                             30  350PSCN                  S01194
     I**********                             36  380DLBR                  S01194
     I**********                             39  420FRPA                  S01194
     I**********                             43  460FRPC                  S01194
     I**********                             47  49 USCY                  S01194
     I**********                             50  52 STCY                  S01194
     I**********                          P  53  553MBGE                  S01194
     I**********                             56  56 PRID                  S01194
     I**********                             57  57 FFNY                  S01194
     I**********                             58  58 OURC                  S01194
     I**********                             59  59 BRNC                  S01194
     I**********                             60  60 LCYN                  S01194
     I**********                             78  78 PRSW                  S01194
     I**********                             79  79 PRCI                  S01194
     I**********                             80  80 PRCA                  S01194
     I**********                             81  81 PRTX                  S01194
     I**********                             82  82 PRFW                  S01194
     I**********                             83  83 PRBW                  S01194
     I**********                          P  90  920LCD                   S01194
     I**********                             93  93 CHTP                  S01194
     I**********                          P  94  960TNLU                  S01194
     I**********                                                          S01194
     I*****TABLE*FILE***BRANCH*CODES*RECORD.                              S01194
     I**********                                                          S01194
     I*TABLE***NS              2 C1   3 C0                                S01194
     I**********                              1   1 RECI                  S01194
     I**********                              2   30RECT                  S01194
     I***********                            11  130BRCD                  S01194
     I**********                             14  43 BRNM                  S01194
     I**********                             44  490BICN                  S01194
     I**********                             50  51 LOCC                  S01194
     I**********                             52  53 CMPY                  S01194
     I**********                          P  90  920LCD                   S01194
     I**********                             93  93 CHTP                  S01194
     I**********                          P  94  960TNLU                  S01194
     I**********                                                          S01194
     I**********                                                          S01194
     I*****TABLE*FILE***NOSTROS RECORD.                                   S01194
     I**********                                                          S01194
     I*TABLE***NS              2 C7   3 C0                                S01194
     I**********                              1   1 RECI                  S01194
     I**********                              2   30RECT                  S01194
     I**********                              9  11 CCY                   S01194
     I**********                             12  130NOSN                  S01194
     I**********                             16  29 ONAC                  S01194
     I**********                             30  350CNUMTL                S01194
     I**********                             36  370ACSQ                  S01194
     I**********                             38  410ACOD                  S01194
     I**********                          P  90  920LCD                   S01194
     I**********                             93  93 CHTP                  S01194
     I**********                          P  94  960TNLU                  S01194
     I**********                                                          S01194
     I**CATCHALL                                                          S01194
     I********NS                                                          S01194
     I**********                              1   1 RECI                  S01194
     I*****CLIENT*FILE***CUSTOMER*STANDING*DATA*RECORD.                   S01194
     I**********                                                          S01194
     I*CLINT***NS  06   1 CD   8 CA                                       S01194
     I**********                              1   1 RECI                  S01194
     I**********                              2   70CNUMCL                S01194
     I**********                              8   8 RCDTCL                S01194
     I**********                              9  28 CRNM                  S01194
     I**********                             29  38 CTWN                  S01194
     I**********                             39  48 CSNM                  S01194
     I**********                             49  56 CASK                  S01194
     I**********                             57  68 TELX                  S01194
     I**********                                                          S01194
     I**********                             69  80 CSID                  S01194
     I**********                             81  82 ACOC                  S01194
     I**********                             83  83 CBSI                  S01194
     I**********                             84  85 CCTZ                  S01194
     I**********                             86  87 CLOC                  S01194
     I**********                             88  930CPAR                  S01194
     I***********                            94  960BRCDCL                S01194
     I**********                             97  980LINS                  S01194
     I**********                             99 1010LINDCL                S01194
     I**********                          P 102 1040DASU                  S01194
     I**********                          P 105 1070CDIC                  S01194
     I**********                          P 108 1100DADE                  S01194
     I**********                            111 111 CMIN                  S01194
     I**********                            112 112 CTYP                  S01194
     I**********                            113 124 TELF                  S01194
     I**********                            125 133 CHID                  S01194
     I**********                            134 136 CHAB                  S01194
     I**********                            245 245 TLXR                  S01194
     I**********                          P 250 2520LCD                   S01194
     I**********                            253 253 CHTP                  S01194
     I**********                          P 254 2560TNLU                  S01194
     I**********                                                          S01194
     I******CATCHALL                                                      S01194
     I**********                                                          S01194
     I********NS                                                          S01194
     I**********                              1   1 RECI                  S01194
     I* D A T A   S T R U C T U R E S
     I***   LOCAL DATA AREA
     ILDA        UDS                            256
0232 I*******                               134 138 DBFILE                S01117
0233 I*******                               139 167 DBKEY                 S01117
0234 I*******                               168 175 DBPGM                 S01117
0235 I*******                               176 1770DBASE                 S01117
0232 I                                      134 141 DBFILE                S01117
0233 I                                      142 170 DBKEY                 S01117
0234 I                                      171 180 DBPGM                 S01117
0235 I                                      181 1830DBASE                 S01117
     I* KEY FIELDS ON TRANS/DAIND FOR DUPLICATE KEY TEST
     I            DS
     I                                        1  14 KEY
     I**********                              1   60LNRF                                      CLE148
     I                                        1   6 LNRF                                      CLE148
     I                                        7  110VDATLN
     I                                       12  140LASNLN
     I**S/TABLE*KEY*                                                      S01194
     I**********  DS                                                      S01194
     I**********                              1  12 ZTABKY                S01194
     I**********                              1   20RECT                  S01194
     I**********                              8  10 CCY                   S01194
     I**********                             11  120NOSN                  S01194
     I* BLANK AREA FOR INITIALISING
     I            DS
     I                                        1  90 BLNK90
     I                                        1  10 BLNK10
     I**THEIR*SETTLEMENT*A/C****START/PURCHASE*                           S01194
     I**********  DS                                                      S01194
     I**********                              1  10 TSET1                 S01194
     I**********                              1  10 TSEN                  S01194
     I**TO*CHANGE*SHORT-NAME*TO*CUSTOMER*NUMBER*IF*APPLICABLE             S01194
     I**********  DS                                                      S01194
     I**********                              1  10 SNCUST                S01194
     I**********                              1   60CNUMCD                S01194
     I**SETTLEMENT*TYPE*AT*START/PURCHASE*                                S01194
     I**********  DS                                                      S01194
     I**********                              1   20SET1                  S01194
     I**********                              1   20SDST                  S01194
     I* D A T A   S T R U C T U R E   F O R   O U T P U T   R E C O R D
     I*    TO LETX1-3
     I            DS
     I***********                             1 180 LETX                  S01117
     I***********                             1 181 LETX           S01117 CEU004
     I**********                              1 210 LETX                               CEU004 CGL029
     I****************************************1 228 LETX                               CGL029 CLE042
     I                                        1 232 LETX                                      CLE042
     I                                        1   1 RECIPH
     I                                        2   2 PAYREC
     I                                        3   40SETTLE
     I                                        5   7 CURREN
     I**********                              8  19 OURAG                                     CGL029
     I                                        8  19 QQOUR                                     CGL029
     I* VALUE DATE WILL BE WRITTEN HERE
     I                                       23  32 THRAG
     I                                       23  32 IFCUST
     I***********                            23  280CUST                                      CSD027
     I                                       23  28 CUST                                      CSD027
     I***********                            33  380CNUMPH                                    CSD027
     I                                       33  38 CNUMPH                                    CSD027
     I**********                             39  440LNRFPH                                    CLE148
     I                                       39  44 LNRFPH                                    CLE148
     I* EVENT AMOUNT WILL BE WRITTEN HERE
     I                                       52  52 RCDT
     I                                       53  54 AMTPPH
     I                                       55  570LASNPH
     I                                       58  67 OTFACO
     I                                       68 157 OTSPI
     I                                      158 161 PINDS
     I***********                           162 1670BICN                                      CSD027
     I                                      162 167 BICN                                      CSD027
     I                                      168 169 LTYP
     I                                      170 171 SUTP
     I                                      172 1730PTYP
     I                                      174 1740TINDPH
     I***********                           175 1770BRCD                  S01117
     I                                      175 177 BRCA                  S01117
     I                                      178 178 INTCPH
     I                                      179 181 @OSBR                 S01117
     I* Original transaction amount                                       CEU004
     I                                      208 210 OTCY                  CEU004
     I                                      211 228 OURAG                                     CGL029
     I                                      229 232 CLAS                                      CLE042
     I**                                                                  S01117
     I** DATA AREA RUNDAT                                                 S01117
     I**                                                                  S01117
     IRUNDT       DS                                                      S01117
     I                                        1   7 RUNA                  S01117
     I                                    P   8  100RUND                  S01117
     I                                       11  11 SSF                   S01117
     I                                       12  12 DATF                  S01117
     I                                       13  13 MBIN                  S01117
     I**                                                                  S01117
     ISDBANK    E DSSDBANKPD                                              S01195
      **  EXTERNAL DS FOR BANK DETAILS                                    S01195
     I              BJURPT                          TITL                  S01117
     I              BJSBRC                          DFBR                  S01117
     I              BJLCCY                          LOCY                  S01117
     ISDGELR    E DSSDGELRPD                                              S01195
      **  EXTERNAL DS FOR GENERAL LEDGER DETAILS                          S01195
     ISDTRAD    E DSSDTRADPD                                              S01195
      **  EXTERNAL DS FOR GENERAL LEDGER DETAILS                          S01195
     I              BLSWPY                          PRSW                  S01194
     I              BLTXPY                          PRTX                  S01194
     I              BLLCTB                          LCYN                  S01194
     I              QQACCD                          QQACD1                                    CGL029
     ISDNOST    E DSSDNOSTPD                                              S01194
      **  EXTERNAL DS FOR NOSTRO DETAILS                                  S01194
     I              A7CUST                          CNUMTL                S01194
     I              QQACCD                          QQACD2                                    CGL029
     ISDCUST    E DSSDCUSTPD                                              S01195
      **  EXTERNAL DS FOR CUSTOMER DETAILS                                S01195
     I              BBGSFM                          GSFM                  S01117
     I              BBCSID                          CSID                  S01117
     ISDBRCH    E DSSDBRCHPD                                              S01117
     I              QQDFAC                          Q1FAC1                                    CGL029
     I*                                                                   S01518
     ISCSARD    E DSSCSARDPD                                              S01518
     I**  External data structure for Switchable Features                 S01518
     I**                                                                  S01117
     ISDCLND    E DSSDCLNDPD                                              CLE002
     I**  External data structure for Customer Lending ICD                CLE002
     I**                                                                  CLE002
     ISDCURR    E DSSDCURRPD                                              CLE031
      ** Currency Type                                                    CLE031
      *                                                                   CLE031
      ** Settlement Allocations file                                                          CLE034
     ILESTAL    E DSLESTALPD                                                                  CLE034
     I              RECI                            RECISA                                    CLE034
     I              TYPE                            TYPESA                                    CLE034
     I              TMST                            TMSTSA                                    CLE034
     I              PCRF                            PCRFSA                                    CLE034
     I              LNRF                            LNRFSA                                    CLE034
     I              VDAT                            VDATSA                                    CLE034
     I              LASQ                            LASQSA                                    CLE034
     I              CNUM                            CNUMSA                                    CLE034
     I              FACL                            FACLSA                                    CLE034
     I              FESQ                            FESQSA                                    CLE034
     I              SEQ                             SEQSA                                     CLE034
     I              RCPC                            RCPCSA                                    CLE034
     I              RSTM                            RSTMSA                                    CLE034
     I              RONS                            RONSSA                                    CLE034
     I              RIBN                            RIBNSA                                    CLE034
     I              RIBA                            RIBASA                                    CLE034
     I              ROBN                            ROBNSA                                    CLE034
     I              ROCN                            ROCNSA                                    CLE034
     I              ROBR                            ROBRSA                                    CLE034
     I              RSCY                            RSCYSA                                    CLE034
     I              REXR                            REXRSA                                    CLE034
     I              REXI                            REXISA                                    CLE034
     I              PYPC                            PYPCSA                                    CLE034
     I              PSTM                            PSTMSA                                    CLE034
     I              PONS                            PONSSA                                    CLE034
     I              PIBN                            PIBNSA                                    CLE034
     I              PIBA                            PIBASA                                    CLE034
     I              POBN                            POBNSA                                    CLE034
     I              POCN                            POCNSA                                    CLE034
     I              RCRN                            RCRNSA                                    CLE034
     I              RCRA                            RCRASA                                    CLE034
     I              RVNO                            RVNOSA                                    CLE034
     I              AWBN                            AWBNSA                                    CLE034
     I              AWBA                            AWBASA                                    CLE034
     I              BENN                            BENNSA                                    CLE034
     I              BENA                            BENASA                                    CLE034
     I              DTP1                            DTP1SA                                    CLE034
     I              DTP2                            DTP2SA                                    CLE034
     I              DTP3                            DTP3SA                                    CLE034
     I              DTP4                            DTP4SA                                    CLE034
     I              DCHG                            DCHGSA                                    CLE034
     I              BTB1                            BTB1SA                                    CLE034
     I              BTB2                            BTB2SA                                    CLE034
     I              BTB3                            BTB3SA                                    CLE034
     I              BTB4                            BTB4SA                                    CLE034
     I              BTB5                            BTB5SA                                    CLE034
     I              BTB6                            BTB6SA                                    CLE034
     I              POBR                            POBRSA                                    CLE034
     I              CVMR                            CVMRSA                                    CLE034
     I              PSCY                            PSCYSA                                    CLE034
     I              IC72                            IC72SA                                    CLE034
     I              PEXR                            PEXRSA                                    CLE034
     I              PEXI                            PEXISA                                    CLE034
     I              PTRF                            PTRFSA                                    CLE034
     I              PYBA                            PYBASA                                    CLE038
     I              PYAM                            PYAMSA                                    CLE038
     I              RCBA                            RCBASA                                    CLE038
     I              RCAM                            RCAMSA                                    CLE038
     I              CCY                             CCYSA                                     CLE038
      *                                                                                       CLE034
     IDSFDY     E DSDSFDY                                                 S01194
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01194
     I*                                                                   S01194
     IDSSDY     E DSDSSDY                                                 S01194
     I* SECOND DS FOR ACCESS PROGRAMS, LONG DATA STRUCTURE                S01194
     I*                                                                   S01194
     I              'LECalcBasis6LeapYear'C         WPARML                                  MD035545
     I/COPY ZSRSRC,ZINTDYZ1                                               128092
     I/COPY ZSRSRC,ZDATE9Z2                                               128092
     I/COPY ZSRSRC,ZDAT10Z1                                               128092
     I/COPY ZSRSRC,ZHOLI                                                                      CLE028
     I/COPY WNCPYSRC,LE1067I001
     I/EJECT                                                              S11117
     I**
     C** PARAMETER LIST FOR PROGRAM 'AOBANKR0'                            S01194
     C           PLISTA    PLIST                                          S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDBANK    PARM SDBANK    DSFDY                           S01194
     C** PARAMETER LIST FOR PROGRAM 'AOGELRR0'                            S01194
     C*                                                                   S01194
     C           PLISTB    PLIST                                          S01194
     C                     PARM '*MSG   ' @RTCD                           S01194
     C                     PARM '*FIRST ' @OPTN                           S01194
     C********** SDGELR    PARM SDGELR    DSFDY                                        S01194 CGL029
     C           SDGELR    PARM SDGELR    DSSDY                                               CGL029
     C*                                                                   S01194
     C** PARAMETER LIST FOR PROGRAM 'AOTRADR0'                            S01194
     C*                                                                   S01194
     C           PLISTC    PLIST                                          S01194
     C                     PARM '*MSG   ' @RTCD                           S01194
     C                     PARM '*FIRST ' @OPTN                           S01194
     C           SDTRAD    PARM SDTRAD    DSFDY                           S01194
     C*                                                                   S01194
     C** PARAMETER LIST FOR PROGRAM 'AOBRCHR0'                            S01194
     C           PLIST1    PLIST                                          S01194
     C                     PARM '*MSG   ' @RTCD                           S01194
     C                     PARM '*KEY   ' @OPTN                           S01194
     C                     PARM           BRCKEY  3                       S01194
     C********** SDBRCH    PARM SDBRCH    DSFDY                                        S01194 CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C** PARAMETER LIST FOR PROGRAM 'AONOSTR0'                            S01194
     C*                                                                   S01194
     C           PLIST2    PLIST                                          S01194
     C                     PARM '*MSG   ' @RTCD                           S01194
     C                     PARM '*KEY   ' @OPTN                           S01194
     C                     PARM           KEYA    6                    A  S01194
     C***********          PARM           CCY     3                 S01194137920
     C                     PARM           AONCCY  3        -Key Ccy    B  137920
     C**********           PARM           KEYC    4                    C               S01194 CGL029
     C                     PARM           KEYC   10                                           CGL029
     C                     PARM           KEYD    2                    D  S01194
     C                     PARM           NOSN    2                    E  S01194
     C                     PARM           KEYF    3                    F  S01194
     C                     PARM           KEYG   10                    G  S01194
     C                     PARM           KEYH    1                    H  S01194
     C           SDNOST    PARM SDNOST    DSFDY                           S01194
     C*                                                                   S01194
     C** PARAMETER LIST FOR PROGRAM 'AOCUSTR0'                            S01194
     C           PLIST3    PLIST                                          S01194
     C                     PARM '*MSG   ' @RTCD                           S01194
     C                     PARM '*KEY   ' @OPTN                           S01194
     C                     PARM           CKEY   10                       S01194
     C                     PARM '*CNUM  ' KEYSTS  7                       S01194
     C           SDCUST    PARM SDCUST    DSSDY                           S01194
     C*                                                                   S01518
     C** Parameter list for program 'AOSARDR0'                            S01518
     C*                                                                   S01518
     C           PLIST4    PLIST                                          S01518
     C                     PARM *BLANKS   @RTCD                           S01518
     C                     PARM '*VERIFY' @OPTN                           S01518
     C                     PARM 'S01518'  @SARD   6                       S01518
     C           SCSARD    PARM SCSARD    DSFDY                           S01518
     C*
     C                     MOVEACPY@      BIS@   80
     C*
     C* 1 S T   C Y C L E   P R O C E S S I N G
     C   40                GOTO START
     C                     SETON                     40
     C**
     C**   RECORD PROGRAM NAME IN CASE OF DBERR
     C                     MOVE *BLANKS   DBPGM                           BHF550
     C                     MOVE 'LE1067'  DBPGM
     C                     MOVE 'D'       RECIPH
     C**********           MOVEL'10'      BRKEY  12                       S01194
     C**
     C**   ACCESS I.C.D.R. 1
     C**********           EXSR ZSYSTM                                    S01194
     C***99*****           SETON                     LRU7U8               S01194
     C***99*****           MOVE '01'      DBASE            ** DBASE 01 ** S01194
     C***99*****           GOTO DBERR                                     S01194
     C                     CALL 'AOBANKR0'PLISTA                          S01194
     C           @RTCD     IFNE *BLANKS                                   S01194
0199 C                     SETON                     U7U8LR**DATABASE 01**S01194
0200 C                     Z-ADD1         DBASE                           S01194
0202 C                     MOVE 'SDBANKPD'DBFILE                          S01194
     C                     GOTO END                                       S01194
     C                     END                                            S01194
      *                                                                   CLE002
      ** Check if SAR CLE002 is present                                   CLE002
      *                                                                   CLE002
     C                     CALL 'AOSARDR0'                                CLE002
     C                     PARM *BLANKS   P@RTCD  7                       CLE002
     C                     PARM '*KEY   ' P@OPTN  7                       CLE002
     C                     PARM 'CLE002'  P@SARD  6                       CLE002
     C           SCSARD    PARM SCSARD    DSFDY                           CLE002
      *                                                                   CLE002
     C           P@RTCD    IFEQ *BLANKS                                   CLE002
     C                     MOVE *ON       CLE002  1                       CLE002
     C                     ELSE                                           CLE002
      *                                                                   CLE002
      ** Handle Database Error                                            CLE002
      *                                                                   CLE002
     C           P@RTCD    IFNE '*NRF    '                                CLE002
     C                     MOVEL'SCSARDPD'DBFILE           ************   CLE002
     C                     Z-ADD13        DBASE            * DBERR 13 *   CLE002
     C                     MOVEL'CLE002'  DBKEY     P      ************   CLE002
     C                     MOVE *ON       *INLR                           CLE002
     C                     MOVE *ON       *INU7                           CLE002
     C                     MOVE *ON       *INU8                           CLE002
     C                     GOTO END                                       CLE002
     C                     ENDIF                                          CLE002
      *                                                                   CLE002
     C                     ENDIF                                          CLE002
      *                                                                   CLE002
      ** If CLE002 is present, Access ICD                                 CLE002
      *                                                                   CLE002
     C           CLE002    IFEQ *ON                                       CLE002
      *                                                                   CLE002
     C                     CALL 'AOCLNDR0'                                CLE002
     C                     PARM *BLANKS   P@RTCD  7                       CLE002
     C                     PARM '*FIRST ' P@OPTN  7                       CLE002
     C********** SDCLND    PARM SDCLND    DSFDY                                        CLE002 CLE134
     C           SDCLND    PARM SDCLND    DSSDY                                               CLE134
      *                                                                   CLE002
      ** Handle Database Error                                            CLE002
      *                                                                   CLE002
     C           P@RTCD    IFNE *BLANKS                                   CLE002
     C                     MOVEL'SDCLNDPD'DBFILE           ************   CLE002
     C                     Z-ADD14        DBASE            * DBERR 14 *   CLE002
     C                     MOVEL'*FIRST'  DBKEY     P      ************   CLE002
     C                     MOVE *ON       *INLR                           CLE002
     C                     MOVE *ON       *INU7                           CLE002
     C                     MOVE *ON       *INU8                           CLE002
     C                     GOTO END                                       CLE002
     C                     ENDIF                                          CLE002
      *                                                                   CLE002
     C                     ENDIF                                          CLE002
     C*                                                                   S01518
     C** Check if Lending Swift feature is switched ON                    S01518
     C*                                                                   S01518
     C                     CALL 'AOSARDR0'PLIST4                          S01518
     C*                                                                   S01518
     C                     SETOF                     30                   S01518
     C           @RTCD     IFEQ *BLANKS                                   S01518
     C                     SETON                     30                   S01518
     C                     ELSE                                           S01518
     C           @RTCD     IFNE '*NRF   '                                 S01518
     C                     SETON                     U7U8LR               S01518
     C                     MOVEL'SCSARDPD'DBFILE           ************   S01518
     C                     MOVEL'*VERIFY' DBKEY            * DBERR 12 *   S01518
     C                     Z-ADD12        DBASE            ************   S01518
     C                     GOTO END                                       S01518
     C                     END                                            S01518
     C                     END                                            S01518
     C*                                                                   S01518
      *                                                                   CEU004
      ** Access SAR details file to see if CEU004 is installed            CEU004
      *                                                                   CEU004
     C                     MOVE 'N'       CEU004  1        Set SAR Flag   CEU004
      *                                                                   CEU004
     C                     CALL 'AOSARDR0'                 Rtv SAR Dtls   CEU004
      *                                                    Input:         CEU004
     C                     PARM *BLANKS   P@RTCD  7        -Return Code   CEU004
     C                     PARM '*VERIFY' P@OPTN  7        -Option        CEU004
     C                     PARM 'CEU004'  P@SARD  6        -SAR No        CEU004
      *                                                    Output:        CEU004
     C           SCSARD    PARM SCSARD    DSFDY            -Format        CEU004
      *                                                                   CEU004
     C           P@RTCD    IFEQ *BLANKS                    If Found       CEU004
     C                     MOVE 'Y'       CEU004            Set SAR Flag  CEU004
      *                                                                   CEU004
     C                     ELSE                            Else           CEU004
     C           P@RTCD    IFNE '*NRF   '                   If # NoRecFnd CEU004
     C                     MOVEL'SCSARDPD'DBFILE             Set File     CEU004
     C                     MOVEL'*VERIFY' DBKEY              Set Key      CEU004
     C                     Z-ADD14        DBASE              Set DBase RefCEU004
     C                     SETON                     U7U8LR  Set Ind      CEU004
     C                     GOTO END                          Bypass       CEU004
     C                     ENDIF                            End If        CEU004
     C                     ENDIF                           End If         CEU004
      *                                                                                       CLE028
      ** Check if Flat Rate Personal Loans (Rule of 78s) is installed                         CLE028
      *                                                                                       CLE028
     C                     CALL 'AOSARDR0'                                                    CLE028
     C                     PARM *BLANKS   PRTCD   7                                           CLE028
     C                     PARM '*VERIFY' POPTN   7                                           CLE028
     C                     PARM 'CLE028'  PSARD   6                                           CLE028
     C           SCSARD    PARM SCSARD    DSFDY                                               CLE028
      *                                                                                       CLE028
     C           PRTCD     IFNE *BLANKS                                                       CLE028
     C           PRTCD     ANDNE'*NRF   '                                                     CLE028
     C                     MOVEL'SCSARDPD'DBFILE                                              CLE028
     C                     Z-ADD015       DBASE                                               CLE028
     C                     MOVELPSARD     DBKEY                                               CLE028
     C                     MOVE *ON       *INU7                                               CLE028
     C                     MOVE *ON       *INU8                                               CLE028
     C                     MOVE *ON       *INLR                                               CLE028
     C                     GOTO END                                                           CLE028
     C                     ENDIF                                                              CLE028
      *                                                                                       CLE028
     C           PRTCD     IFEQ *BLANKS                                                       CLE028
     C                     MOVE 'Y'       CLE028  1                                           CLE028
     C                     ELSE                                                               CLE028
     C                     MOVE 'N'       CLE028                                              CLE028
     C                     ENDIF                                                              CLE028
      *                                                                   CLE031
      ** Access SAR details file to see if CLE031 is installed            CLE031
      *                                                                   CLE031
     C                     MOVE 'N'       CLE031  1                       CLE031
      *                                                                   CLE031
     C                     CALL 'AOSARDR0'                                CLE031
      *                                                                   CLE031
     C                     PARM *BLANKS   P@RTCD                          CLE031
     C                     PARM '*VERIFY' P@OPTN                          CLE031
     C                     PARM 'CLE031'  P@SARD                          CLE031
     C           SCSARD    PARM SCSARD    DSFDY                           CLE031
      *                                                                   CLE031
     C           P@RTCD    IFEQ *BLANKS                                   CLE031
     C                     MOVE 'Y'       CLE031                          CLE031
     C                     ELSE                                           CLE031
     C           P@RTCD    IFNE '*NRF   '                                 CLE031
     C                     MOVEL'SCSARDPD'DBFILE                          CLE031
     C                     MOVEL'*VERIFY' DBKEY                           CLE031
     C                     Z-ADD15        DBASE                           CLE031
     C                     SETON                     U7U8LR               CLE031
     C                     GOTO END                                       CLE031
     C                     ENDIF                                          CLE031
     C                     ENDIF                                          CLE031
      *                                                                                       CLE034
      ** Check if CLE034 is on                                                                CLE034
      *                                                                                       CLE034
     C                     CALL 'AOSARDR0'                                                    CLE034
     C                     PARM *BLANKS   P@RTCD                                              CLE034
     C                     PARM '*VERIFY' P@OPTN                                              CLE034
     C                     PARM 'CLE034'  P@SARD                                              CLE034
     C           SCSARD    PARM SCSARD    DSFDY                                               CLE034
      *                                                                                       CLE034
     C           P@RTCD    IFNE *BLANKS                                                       CLE034
     C           P@RTCD    ANDNE'*NRF   '                                                     CLE034
     C                     MOVE 'SCSARDPD'DBFILE                                              CLE034
     C                     MOVELP@SARD    DBKEY                                               CLE034
     C                     Z-ADD27        DBASE                                               CLE034
     C                     SETON                     U7U8LR                                   CLE034
     C                     ENDIF                                                              CLE034
      *                                                                                       CLE034
     C           P@RTCD    IFEQ *BLANKS                                                       CLE034
     C                     MOVE 'Y'       CLE034  1                                           CLE034
     C                     ELSE                                                               CLE034
     C                     MOVE 'N'       CLE034                                              CLE034
     C                     ENDIF                                                              CLE034
      *                                                                                       CLE038
      ** Check if CLE038 is on                                                                CLE038
      *                                                                                       CLE038
     C                     CALL 'AOSARDR0'                                                    CLE038
     C                     PARM *BLANKS   P@RTCD                                              CLE038
     C                     PARM '*VERIFY' P@OPTN                                              CLE038
     C                     PARM 'CLE038'  P@SARD                                              CLE038
     C           SCSARD    PARM SCSARD    DSFDY                                               CLE038
      *                                                                                       CLE038
     C           P@RTCD    IFNE *BLANKS                                                       CLE038
     C           P@RTCD    ANDNE'*NRF   '                                                     CLE038
     C                     MOVE 'SCSARDPD'DBFILE                                              CLE038
     C                     MOVELP@SARD    DBKEY                                               CLE038
     C                     Z-ADD29        DBASE                                               CLE038
     C                     MOVE *ON       *INU7                                               CLE038
     C                     MOVE *ON       *INU8                                               CLE038
     C                     MOVE *ON       *INLR                                               CLE038
     C                     ENDIF                                                              CLE038
      *                                                                                       CLE038
     C           P@RTCD    IFEQ *BLANKS                                                       CLE038
     C                     MOVE 'Y'       CLE038  1                                           CLE038
     C                     ELSE                                                               CLE038
     C                     MOVE 'N'       CLE038                                              CLE038
     C                     ENDIF                                                              CLE038
      *                                                                                       CLE038
     C/COPY WNCPYSRC,LE1067C001
      *                                                                   CEU004
     C**
     C**   DEFAULT BRANCH CODE BLANK
     C***20*****           SETON                     44                   S01194
     C           DFBR      COMP *BLANKS                  44               S01194
     C**
     C**   ACCESS I.C.D.R. 2
     C**********           MOVE ' 11'     ZTABKY                          S01194
     C**********           EXSR TABCHN                                    S01194
     C**********           CALL 'AOGELRR0'PLISTB                                       S01194 CGL029
     C                     CALL 'AOGELRR1'PLISTB                                              CGL029
     C           @RTCD     IFNE *BLANKS                                   S01194
     C                     SETON                     LRU7U8               S01194
     C                     Z-ADD2         DBASE            ** DBASE 02 ** S01194
     C                     MOVE 'SDGELRPD'DBFILE                          S01194
     C                     GOTO END                                       S01194
     C                     END                                            S01194
      *                                                                                     MD035545
      ** Retrieve system value setting.                                                     MD035545
      *                                                                                     MD035545
     C                     MOVELWPARML    P@OP01                                            MD035545
     C                     CALL 'AOSVALR0'                                                  MD035545
     C                     PARM *BLANKS   @RTCD                                             MD035545
     C                     PARM           P@OP01 20                                         MD035545
     C                     PARM           P@VL01200                                         MD035545
     C                     PARM           P@OP02 20                                         MD035545
     C                     PARM           P@VL02200                                         MD035545
     C                     PARM           P@OP03 20                                         MD035545
     C                     PARM           P@VL03200                                         MD035545
     C                     PARM           P@OP04 20                                         MD035545
     C                     PARM           P@VL04200                                         MD035545
     C                     PARM           P@OP05 20                                         MD035545
     C                     PARM           P@VL05200                                         MD035545
     C                     PARM           P@OP06 20                                         MD035545
     C                     PARM           P@VL06200                                         MD035545
     C                     PARM           P@OP07 20                                         MD035545
     C                     PARM           P@VL07200                                         MD035545
     C                     PARM           P@OP08 20                                         MD035545
     C                     PARM           P@VL08200                                         MD035545
     C                     PARM           P@OP09 20                                         MD035545
     C                     PARM           P@VL09200                                         MD035545
     C                     PARM           P@OP10 20                                         MD035545
     C                     PARM           P@VL10200                                         MD035545
      *                                                                                     MD035545
      ** If system value is not found then default value to 'N'.                            MD035545
      *                                                                                     MD035545
     C           @RTCD     IFNE '       '                                                   MD035545
     C                     MOVE 'N'       WCALC6                                            MD035545
     C                     ELSE                                                             MD035545
     C                     MOVELP@VL01    WCALC6                                            MD035545
     C********** WCALC6    IFEQ 'Y'                                                MD035545 MD047993
     C********** BKALDI    ANDEQ'Y'                                                MD035545 MD047993
     C**********           MOVE 'Y'       WCALC6                                   MD035545 MD047993
     C**********           ELSE                                                    MD035545 MD047993
     C**********           MOVE 'N'       WCALC6                                   MD035545 MD047993
     C**********           ENDIF                                                   MD035545 MD047993
     C                     ENDIF                                                            MD035545
     C***99*****           SETON                     LRU7U8               S01194
     C***99*****           MOVE '02'      DBASE            ** DBASE 02 ** S01194
     C***99*****           GOTO DBERR                                     S01194
     C**                                                                  S11117
     C           *NAMVAR   DEFN RUNDAT    RUNDT                           S01117
     C                     IN   RUNDT                                     S01117
     C           *NAMVAR   DEFN           LDA                             S01194
     C**                                                                  S11117
     C           DATF      IFEQ 'M'                                                           CLE028
     C                     MOVE *ON       *IN98                                               CLE028
     C                     ENDIF                                                              CLE028
     C           MBIN      IFEQ 'Y'                                       S01117
     C                     MOVE '1'       *IN44                           S01117
     C                     END                                            S01117
     C**
     C**   ACCESS I.C.D.R. 5
     C**********           MOVE ' 40'     ZTABKY                          S01194
     C**********           EXSR TABCHN                                    S01194
     C                     CALL 'AOTRADR0'PLISTC                          S01194
     C           @RTCD     IFNE *BLANKS                                   S01194
     C                     SETON                     LRU7U8               S01194
     C                     Z-ADD3         DBASE            ** DBASE 03 ** S01194
     C                     MOVE 'SDTRADPD'DBFILE                          S01194
     C                     GOTO END                                       S01194
     C                     END                                            S01194
     C***99*****           SETON                     LRU7U8               S01194
     C***99*****           MOVE '03'      DBASE            ** DBASE 03 ** S01194
     C***99*****           GOTO DBERR                                     S01194
     C**
     C**   IS LOCAL CCY NOSTRO-TELEX OR BANK AUTHORISATION
     C           LCYN      COMP 'B'                      54
     C* IF SINGLE BRANCH INSTALL'N BYPASS,ELSE ACCESS BRANCH CODES*TABLE* S01194
     C   44                GOTO END
     C**********           MOVE DFBR      ZTABKY                          S01194
     C**********           MOVEL'10'      ZTABKY                          S01194
     C**N42*****           EXSR TABCHN                                    S01194
     C                     MOVE DFBR      BRCKEY                          S01194
     C**********           CALL 'AOBRCHR0'PLIST1                                       S01194 CGL029
     C                     CALL 'AOBRCHR1'PLIST1                                              CGL029
     C           @RTCD     IFNE *BLANKS                                   S01194
     C                     SETON                     LRU7U8               S01194
     C                     Z-ADD4         DBASE                        ** S01194
     C                     MOVELBRCKEY    DBKEY            ** DBASE 04 ** S01194
     C                     MOVEL'SDBRCHPD'DBFILE                       ** S01194
     C                     GOTO END                                       S01194
     C                     END                                            S01194
     C                     MOVE A8BICN    BICN                            S01194
     C***99*****           SETON                     LRU7U8               S01194
     C***99*****           MOVE '04'      DBASE            ** DBASE 04 ** S01194
     C**N99*****           GOTO END                                       S01194
     C********** DBERR     TAG                             ** DBERR TAG **S01194
     C**********           MOVE 'TABLE'   DBFILE                          S01194
     C**********           MOVELZTABKY    DBKEY                           S01194
     C**********           GOTO END                                       S01194
     C/COPY WNCPYSRC,LE1067C010
     C           START     TAG                             ** START TAG **
     C* RESET INDS.
     C                     SETOF                     484962
      *                                                                                       230521
      ** Initialise field.                                                                    230521
      *                                                                                       230521
     C**********           Z-ADD0         LFCN    60                                   230521 CSD027
     C                     MOVE *BLANKS   LFCN    6                                           CSD027
      *                                                                                       230521
     C* M A I N L I N E   O F   P R O C E S S I N G
     C**
     C**   LTRIN DETAIL
     C   02                EXSR PROC5
     C**
     C**   LTRIN TRAILER
     C   03                EXSR TTRANS                     CONTROLS
     C           END       TAG                             **  END TAG  **
     C* E N D   O F   M A I N L I N E
     C* FOR CONTROLS ON S/LETX TRAILERS
     C**
     CLR         ROP,1     ADD  2         ROP,1
     CLR         ROP,2     ADD  2         ROP,2
     CLR         ROP,3     ADD  2         ROP,3
     CLR         ROP,4     ADD  2         ROP,4
     CLR U7 U8             EXSR *PSSR                                     S01117
     C********************************************************************
     C* P R O C E S S  .5.      - S / L T R I N
     C*
     C*    PROC5 IS CALLED BY - MAIN PROCESSING
     C*
     C*             CALLS - PROC1;PROC2
     C*
     C********************************************************************
     C           PROC5     BEGSR                           ***  PROC5  ***
     C* I/P CONTROLS
     C           COUNT     ADD  1         COUNT   50
      *                                                                   046673
      * Ignore records with record type of 'R'                            046673
     C           RCDT      IFEQ 'R'                                       046673
     C                     GOTO P5END                                     046673
     C                     END                                            046673
     C*
     C**
     **    DO NOT PROCESS S/LTRIN RECORDS CREATED BY REPRINT CONFS.
     C           RRLA      COMP 0                        42
     C   42                GOTO P5END
     C**
     C* THIS KEY EQ. LAST KEY - IF SO GOTO END.
     C           KEY       COMP PREKEY                   42
     C   42                GOTO P5END
     C                     MOVE KEY       PREKEY 14        SAVE KEY FIELD
     C           CHTPXT    COMP 'A'                      42
     C  N42      CHTPXT    COMP 'I'                      42
     C**
     C           *IN42     IFEQ '0'
     C           CHTPXT    ANDEQ'R'
     C***********RCDT      ANDEQ'L'                                       128092
     C/COPY WNCPYSRC,LE1067C002
     C                     SETON                     4262
     C                     END
     C**
     C*  42 SET IF ACTION CODE EQ 'A' OR 'I' OR 'R'
     C* IF ANY PAY/RECEIVE IND SET AND '42' THEN CONTINUE - ELSE END
     C*
      * If maturity pay/rec indicator on, set on *IN21                    128093
     C           PRI2      IFEQ 1                                         128093
     C                     SETON                     21                   128093
     C                     ENDIF                                          128093
     C**
     C** IF PAY/RECEIVE IND NOT ON AND NOT A LOAN REVERSAL
     C** OR CHANGE TYPE NOT I, A, OR R
     C  N21N62
     CORN42                GOTO P5END                      ELSE OPTION
     C**
     C**   DOES LTRIN REFER TO LOAN OR AMENDMENT - PROCESS ACCORDINGLY
     C           RCDT      COMP 'L'                      42
     C  N42      RCDT      COMP 'R'                      42               S01392
     C   42                EXSR PROC1                      DO LOAN
     C           RCDT      COMP 'A'                      42
     C   42                EXSR PROC2                      DO AMENDMENT
     C*
     C           P5END     ENDSR                           ** P5END TAG **
     C********************************************************************
     C* P R O C E S S  .1.      - L O A N S
     C*
     C*    PROC1 IS CALLED BY - PROC5
     C*
     C*             CALLS - PROCAA
     C*
     C********************************************************************
     C           PROC1     BEGSR                           ***  PROC1  ***
     C*    ACCESS S/CLOAN - 'A' & 'B' RECORDS
     C                     SETOF                     22
     C                     MOVELLNRF      CLKEY   7
     C                     MOVE 'B'       CLKEY
     C           AGAIN     TAG                             ** AGAIN TAG **
     C           CLKEY     CHAINCLOAN                41
     C   41                SETON                     LRU7U8
     C   41                MOVE '05'      DBASE            ** DBASE 05 **
     C   41                MOVE 'CLOAN'   DBFILE
     C   41                MOVELCLKEY     DBKEY
     C  N62      RECI      COMP 'D'                      42
     C   22                GOTO OUT
     C   42N41             MOVE 'A'       CLKEY
     C   42N41             SETON                     22
     C   22                GOTO AGAIN
     C           OUT       TAG                             **  OUT TAG  **
     C   41
     CORN42                GOTO P1END
      *                                                                   CLE002
      ** If SAR CLE002 is present                                         CLE002
      *                                                                   CLE002
     C           CLE002    IFEQ *ON                                       CLE002
      *                                                                   CLE031
     C           CLE031    IFEQ 'N'                                       CLE031
     C           CLE031    OREQ 'Y'                                       CLE031
     C           PRI1      ANDEQ1                                         CLE031
     C           CLE031    OREQ 'Y'                                       CLE031
     C           PRI2      ANDEQ1                                         CLE031
      *                                                                   CLE002
      ** If Authorization is *ON                                          CLE002
      *                                                                   CLE002
     C           BPLOAU    IFEQ 'Y'                                       CLE002
     C           BPPPAU    OREQ 'Y'                                       CLE002
     C           BPPSAU    OREQ 'Y'                                       CLE002
      *                                                                   CLE002
      ** If not Authorized                                                CLE002
      *                                                                   CLE002
     C           LSTS      IFNE 'A'                                       CLE002
     C                     GOTO P1END                                     CLE002
     C                     ENDIF                                          CLE002
      *                                                                   CLE002
     C                     ENDIF                                          CLE002
     C                     ELSE                                           CLE031
     C           PRI3      IFEQ 1                                         CLE031
     C           BPROAU    IFEQ 'Y'                                       CLE031
     C           RSTS      ANDNE'A'                                       CLE031
     C                     GOTO P1END                                     CLE031
     C                     ENDIF                                          CLE031
     C                     ELSE                                           CLE031
     C                     GOTO P1END                                     CLE031
     C                     ENDIF                                          CLE031
     C                     ENDIF                                          CLE031
      *                                                                   CLE002
     C                     ENDIF                                          CLE002
     C/COPY WNCPYSRC,LE1067C020
     C*
     C* 'CASE' ON TYPE OF CLOAN
     C*
     C           PTYP      LOKUPTABTP1                   45
     C           PTYP      LOKUPTABTP2                   46
     C           PTYP      LOKUPTABTP3                   47
     C   45
     COR 46                EXSR PROCAA
     C* A N Y   O T H E R S
     C* NULL
     C*
     C           P1END     ENDSR                           ** P1END TAG **
     C********************************************************************
     C* P R O C E S S  .2.      - L O A N   A M E N D M E N T S
     C*
     C*    PROC2 IS CALLED BY - PROC5
     C*
     C*             CALLS - PROCCC
     C*
     C********************************************************************
     C           PROC2     BEGSR                           ***  PROC2  ***
     C*    ACCESS LOAMS
     C           KEY       CHAINLOAMS                41
     C   41                SETON                     LRU7U8
     C   41                MOVE '06'      DBASE            ** DBASE 06
     C   41                MOVE 'LOAMS'   DBFILE
     C   41                MOVELKEY       DBKEY
     C   41                GOTO P2END
     C* TEST IF TELEX BIT ON OR OFF
     C                     TESTB'1'       LAIN           62-IF ON
     C           AMTPDK    COMP 'PI'                 4242
     C   42      AMTPDK    COMP 'MR'                 4242                 128094
     C   42      AMTPDK    COMP 'RE'                 4242                 128094
     C**N04******                                                         128092
     C  N04N05                                                            128092
     C/COPY WNCPYSRC,LE1067C003
     COR 42                GOTO P2END
     C**
     C**   SAVE THE VALUE OF OSBR FROM LOAMS                              BHF991
     C                     MOVE *BLANKS   LOSBR   3                       BHF991
     C                     MOVEL@OSBR     LOSBR                           BHF991
     C**   ACCESS CLOAN 'A' RECORD
     C                     MOVELLNRF      CLKEY
     C                     MOVE SCCY      SAVCCY  3                       147236
     C                     MOVE 'A'       CLKEY
     C           CLKEY     CHAINCLOAN                41
     C   41                SETON                     LRU7U8
     C   41                MOVE '07'      DBASE            ** DBASE 07 **
     C   41                MOVE 'CLOAN'   DBFILE
     C   41                MOVELCLKEY     DBKEY
     C   41                GOTO P2END
     C           RECI      COMP 'D'                      42
     C  N42                GOTO P2END
     C                     MOVE SAVCCY    SCCY                            147236
      *                                                                   CLE002
      ** If SAR CLE002 is present                                         CLE002
      *                                                                   CLE002
     C           CLE002    IFEQ *ON                                       CLE002
      *                                                                   CLE002
      ** If Authorization is *ON                                          CLE002
      *                                                                   CLE002
     C           BPLMAU    IFEQ 'Y'                                       CLE002
     C           BPMRAU    OREQ 'Y'                                       CLE002
     C           BPREAU    OREQ 'Y'                                       CLE002
     C           BPTPAU    OREQ 'Y'                                       CLE002
      *                                                                   CLE002
      ** If not Authorized                                                CLE002
      *                                                                   CLE002
      * Ignore this check if action is reversal since ASTSDK = 'D'        128092
      * in this case                                                      128092
     C           CHTPXT    IFNE 'R'                                       128092
     C           ASTSDK    IFNE 'A'                                       CLE002
     C                     GOTO P2END                                     CLE002
     C                     ENDIF                                          CLE002
     C                     ENDIF                                          128092
      *                                                                   CLE002
     C                     ENDIF                                          CLE002
      *                                                                   CLE002
     C                     ENDIF                                          CLE002
     C/COPY WNCPYSRC,LE1067C021
     C**
     C**  MOVE BACK SAVED VALUE OF OSBR FROM LOAMS                        BHF991
     C                     MOVELLOSBR     @OSBR                           BHF991
     C**
     C**  'CASE' ON TYPE OF RELATED CLOAN
     C           AMTPDK    IFEQ 'PI'                                      128094
     C           PTYP      LOKUPTABTP1                   45
     C           PTYP      LOKUPTABTP2                   46
     C                     ELSE                                           128094
     C           PTYP      LOKUPTABTP1                   46               128094
     C           PTYP      LOKUPTABTP2                   45               128094
     C                     ENDIF                                          128094
     C           PTYP      LOKUPTABTP3                   47
     C   45
     COR 46                EXSR PROCCC
     C*
     C           P2END     ENDSR                           ** P2END TAG **
     C********************************************************************
     C********************************************************************
     C*            L  O  A  N  S
     C*                                                    * LEP1068-AA  *
     C*    PROCAA IS CALLED BY - PROC1
     C*
     C*             CALLS - CREATE
     C*
     C********************************************************************
     C           PROCAA    BEGSR                           *** PROCAA ***
     C/COPY WNCPYSRC,LE1067C011
     C                     SETON                     48
     C                     MOVE *BLANKS   CVMI                                                232787
      *                                                                   128093
      * Since this routine could have been called as a result of the      128093
      * maturity date pay/rec indicator being on, must do another         128093
      * check here for value date indicator to avoid generating           128093
      * unwanted value date message                                       128093
     C                     MOVE *IN62     SAV62   1                       128093
     C           PRI1      IFEQ 1                                         128093
     C           *IN62     OREQ '1'                                       128093
     C**
     C**   START DATE TELEX INDICATOR MUST BE OFF,PAY/REC.INDIC MUST = 1
     C                     TESTB'0'       TLXI           42
      *                                                                                       CLE034
     C           CLE034    IFEQ 'Y'                                                           CLE034
     C           RCDT      ANDEQ'L'                                                           CLE034
     C           STAL      ANDEQ'Y'                                                           CLE034
     C           CLE034    OREQ 'Y'                                                           CLE034
     C           RCDT      ANDEQ'R'                                                           CLE034
     C           STAL      ANDEQ'Y'                                                           CLE034
      *                                                                                       CLE034
     C           *IN45     IFEQ *ON                                                           CLE034
     C                     MOVE 'P'       WPYREC  1                                           CLE034
     C                     ENDIF                                                              CLE034
     C           *IN46     IFEQ *ON                                                           CLE034
     C                     MOVE 'R'       WPYREC                                              CLE034
     C                     ENDIF                                                              CLE034
     C           *IN45     IFEQ *ON                                                           CLE034
     C           *IN46     OREQ *ON                                                           CLE034
     C                     MOVE 'Y'       WKPROC  1                                           CLE034
     C                     EXSR SR34A                                                         CLE034
     C                     ELSE                                                               CLE034
     C                     MOVE 'Y'       WFIELD  1                                           CLE034
     C                     MOVE '*EOF   ' PRTCD                                               CLE034
     C                     ENDIF                                                              CLE034
      *                                                                                       CLE034
     C                     ELSE                                                               CLE034
     C                     MOVE 'Y'       WFIELD                                              CLE034
     C                     MOVE '*EOF   ' PRTCD                                               CLE034
     C                     ENDIF                                                              CLE034
      *                                                                                       CLE034
     C           WFIELD    DOWEQ'Y'                                                           CLE034
     C           PRTCD     OREQ *BLANKS                                                       CLE034
      *                                                                                       CLE034
     C           CLE034    IFEQ 'Y'                                                           CLE034
     C           WKPROC    ANDEQ'Y'                                                           CLE034
     C                     EXSR SR34D                                                         CLE034
     C                     ENDIF                                                              CLE034
      *                                                                                       CLE034
     C   42                SETON                     62
     C**
      * Use the Extended Settlements fields if the feature (S01518) is    156523
      * switched on.                                                      156523
     C           *IN30     IFEQ *ON                                       156523
     C           *IN45     IFEQ *ON                                       CLE031
     C                     MOVE PONS      OURAG                           156523
     C                     MOVE PSTM      SETTLE                          156523
     C                     ELSE                                           CLE031
     C                     MOVE RONS      OURAG                           CLE031
     C                     MOVE RSTM      SETTLE                          CLE031
     C                     ENDIF                                          CLE031
     C                     ELSE                                           156523
     C                     MOVE OSDA      OURAG                           156523
     C                     MOVE SDST      SETTLE
     C                     ENDIF                                          156523
     C   45                MOVE 'P'       PAYREC
     C   46                MOVE 'R'       PAYREC
     C***********          MOVE OSDA      OURAG                           156523
     C                     MOVE TSTN      THRAG
     C                     MOVE CCY       CURREN
      *                                                                   138764
      ** If feature CEU004 is on,                                         138764
      ** If the Settlement Ccy *NE transaction Ccy, save some fields      138764
      *                                                                   138764
     C           CEU004    IFEQ 'Y'                                       138764
     C           CLE031    OREQ 'Y'                                       CLE031
     C*********  SCCY      IFNE CCY                                 138764CLE031
     C           CEU004    IFEQ 'Y'                                       CLE031
     C           SCCY      ANDNECCY                                       CLE031
     C           SCCY      ANDNE*BLANKS                                   138764
     C           CLE031    OREQ 'Y'                                       CLE031
     C           PSCY      ANDNECCY                                       CLE031
     C           PSCY      ANDNE*BLANKS                                   CLE031
     C           *IN45     ANDEQ*ON                                       CLE031
     C           CLE031    OREQ 'Y'                                       CLE031
     C           SCCY      ANDNECCY                                       CLE031
     C           SCCY      ANDNE*BLANKS                                   CLE031
     C           *IN46     ANDEQ*ON                                       CLE031
      *                                                                   CLE031
     C                     CALL 'AOCURRR0'             99                 CLE031
     C                     PARM '*MSG    '@RTCD   7                       CLE031
     C                     PARM '*KEY    '@OPTN   7                       CLE031
     C                     PARM CCY       CURKEY  3                       CLE031
     C           SDCURR    PARM SDCURR    DSSDY                           CLE031
      *                                                                   CLE031
     C           @RTCD     IFNE *BLANKS                                   CLE031
     C                     SETON                     U7U8LR               CLE031
     C                     Z-ADD16        DBASE                           CLE031
     C                     MOVE 'SDCURRPD'DBFILE                          CLE031
     C                     MOVELCCY       DBKEY                           CLE031
     C                     GOTO ENDAA                                     CLE031
     C                     ENDIF                                          CLE031
      *                                                                   CLE031
     C                     MOVE A6INCY    LCCYIN  1                       CLE031
      *                                                                   CLE031
     C           *IN45     IFEQ *ON                                       CLE031
     C           PSCY      ANDNE*BLANKS                                   CLE031
     C                     MOVE PSCY      CURKEY                          CLE031
     C                     ENDIF                                          CLE031
      *                                                                   CLE031
     C           *IN46     IFEQ *ON                                       CLE031
     C           SCCY      ANDNE*BLANKS                                   CLE031
     C                     MOVE SCCY      CURKEY                          CLE031
     C                     ENDIF                                          CLE031
      *                                                                                       239588
      ** If CLE031 is OFF and Settlement currency is not equal *BLANK                         239588
      ** use settlement currency                                                              239588
      *                                                                                       239588
     C           CLE031    IFNE 'Y'                                                           239588
     C           SCCY      ANDNE*BLANKS                                                       239588
     C                     MOVE SCCY      CURKEY                                              239588
     C                     ENDIF                                                              239588
      *                                                                   CLE031
     C                     CALL 'AOCURRR0'             99                 CLE031
     C                     PARM '*MSG    '@RTCD   7                       CLE031
     C                     PARM '*KEY    '@OPTN   7                       CLE031
     C                     PARM           CURKEY  3                       CLE031
     C           SDCURR    PARM SDCURR    DSSDY                           CLE031
      *                                                                   CLE031
     C           @RTCD     IFNE *BLANKS                                   CLE031
     C                     SETON                     U7U8LR               CLE031
     C                     Z-ADD17        DBASE                           CLE031
     C                     MOVE 'SDCURRPD'DBFILE                          CLE031
     C                     MOVELCURKEY    DBKEY                           CLE031
     C                     GOTO ENDAA                                     CLE031
     C                     ENDIF                                          CLE031
      *                                                                   CLE031
     C                     MOVE A6INCY    SCCYIN  1                       CLE031
      *                                                                   CLE031
     C           LCCYIN    IFEQ 'Y'                                       CLE031
     C           SCCYIN    OREQ 'Y'                                       CLE031
     C**********           MOVE SCCY      CURREN                   138764 CLE031
     C                     MOVE CURKEY    CURREN                          CLE031
     C                     MOVE CCY       CCYSV                           138764
     C                     MOVE EAMT      AMTSV                           138764
     C                     ELSE                                           CLE031
     C           *IN45     IFEQ *ON                                       CLE031
     C                     MOVE PSCY      CURREN                          CLE031
     C                     MOVE CCY       CCYSV                           CLE031
     C                     Z-ADDPEXR      WEXR   138                      CLE031
     C                     MOVE PEXI      WEXI    1                       CLE031
     C                     ENDIF                                          CLE031
     C           *IN46     IFEQ *ON                                       CLE031
     C                     MOVE SCCY      CURREN                          CLE031
     C                     MOVE CCY       CCYSV                           CLE031
     C                     Z-ADDREXR      WEXR                            CLE031
     C                     MOVE REXI      WEXI                            CLE031
     C                     ENDIF                                          CLE031
     C                     ENDIF                                          CLE031
     C                     ENDIF                                          138764
     C                     ENDIF                                          138764
     C**
     C**   SET UP & WRITE OUTPUT RECORDS
      *                                                                   128093
      * Signify value date pay/rec to be produced                         128093
     C                     MOVE 'V'       VORM    1                       128093
     C                     EXSR CREATE
      *                                                                                       CLE034
     C           CLE034    IFEQ 'Y'                                                           CLE034
     C           WKPROC    ANDEQ'Y'                                                           CLE034
     C                     EXSR SR34C                                                         CLE034
     C                     ELSE                                                               CLE034
     C                     MOVE *BLANK    WFIELD                                              CLE034
     C                     ENDIF                                                              CLE034
      *                                                                                       CLE034
     C                     ENDDO                                                              CLE034
      *                                                                                       CLE034
     C           CLE034    IFEQ 'Y'                                                           CLE034
     C           WKPROC    ANDEQ'Y'                                                           CLE034
     C                     EXSR SR34E                                                         CLE034
     C                     ENDIF                                                              CLE034
      *                                                                                       CLE034
     C                     ENDIF                                          128093
      *                                                                   128093
      * Maturity date pay/rec processing                                  128093
     C                     MOVE SAV62     *IN62                           128093
     C           PRI2      IFEQ 1                                         128093
     C           *IN62     OREQ '1'                                       128093
      *                                                                   128093
      * Check maturity date telex indicator                               128093
     C                     TESTB'1'       TLXI           42               128093
      *                                                                                       CLE034
     C           CLE034    IFEQ 'Y'                                                           CLE034
     C           RCDT      ANDEQ'L'                                                           CLE034
     C           STAL      ANDEQ'Y'                                                           CLE034
     C           CLE034    OREQ 'Y'                                                           CLE034
     C           RCDT      ANDEQ'R'                                                           CLE034
     C           STAL      ANDEQ'Y'                                                           CLE034
      *                                                                                       CLE034
     C           *IN45     IFEQ *ON                                                           CLE034
     C                     MOVE 'P'       WPYREC                                              CLE034
     C                     ENDIF                                                              CLE034
     C           *IN46     IFEQ *ON                                                           CLE034
     C                     MOVE 'R'       WPYREC                                              CLE034
     C                     ENDIF                                                              CLE034
     C           *IN45     IFEQ *ON                                                           CLE034
     C           *IN46     OREQ *ON                                                           CLE034
     C                     MOVE 'Y'       WKPROC                                              CLE034
     C                     EXSR SR34A                                                         CLE034
     C                     ELSE                                                               CLE034
     C                     MOVE 'Y'       WFIELD                                              CLE034
     C                     MOVE '*EOF   ' PRTCD                                               CLE034
     C                     ENDIF                                                              CLE034
      *                                                                                       CLE034
     C                     ELSE                                                               CLE034
     C                     MOVE 'Y'       WFIELD                                              CLE034
     C                     MOVE '*EOF   ' PRTCD                                               CLE034
     C                     ENDIF                                                              CLE034
      *                                                                                       CLE034
     C           WFIELD    DOWEQ'Y'                                                           CLE034
     C           PRTCD     OREQ *BLANKS                                                       CLE034
      *                                                                                       CLE034
     C           CLE034    IFEQ 'Y'                                                           CLE034
     C           WKPROC    ANDEQ'Y'                                                           CLE034
     C                     EXSR SR34D                                                         CLE034
     C                     ENDIF                                                              CLE034
      *                                                                                       CLE034
     C   42                SETON                     62                   128093
      *                                                                   128093
      * Use the Extended Settlements fields if the feature (S01518) is    156523
      * switched on.                                                      156523
     C           *IN30     IFEQ *ON                                       156523
     C           *IN45     IFEQ *ON                                       CLE031
     C                     MOVE RONS      OURAG                           156523
     C                     MOVE RSTM      SETTLE                          156523
     C                     ELSE                                           CLE031
     C                     MOVE PONS      OURAG                           CLE031
     C                     MOVE PSTM      SETTLE                          CLE031
     C                     ENDIF                                          CLE031
     C                     ELSE                                           156523
     C                     MOVE OMDA      OURAG                           156523
     C                     MOVE MDST      SETTLE                          128093
     C                     ENDIF                                          156523
     C   45                MOVE 'R'       PAYREC                          128093
     C   46                MOVE 'P'       PAYREC                          128093
     C***********          MOVE OMDA      OURAG                     128093156523
     C                     MOVE TMAN      THRAG                           128093
     C                     MOVE CCY       CURREN                          128093
      *                                                                   CEU004
      ** If feature CEU004 is on,                                         CEU004
      ** If the Settlement Ccy *NE transaction Ccy, set field CURREN.     CEU004
      *                                                                   CEU004
     C           CEU004    IFEQ 'Y'                        If Feature On  CEU004
     C           CLE031    OREQ 'Y'                                       CLE031
      *                                                                   CEU004
     C***********SCCY      IFNE CCY                   If Ccys # Eql CEU004CLE031
     C           CEU004    IFEQ 'Y'                                       CLE031
     C           SCCY      ANDNECCY                                       CLE031
     C           SCCY      ANDNE*BLANKS                                   CEU004
     C           CLE031    OREQ 'Y'                                       CLE031
     C           SCCY      ANDNECCY                                       CLE031
     C           SCCY      ANDNE*BLANKS                                   CLE031
     C           *IN45     ANDEQ*ON                                       CLE031
     C           CLE031    OREQ 'Y'                                       CLE031
     C           PSCY      ANDNECCY                                       CLE031
     C           PSCY      ANDNE*BLANKS                                   CLE031
     C           *IN46     ANDEQ*ON                                       CLE031
      *                                                                   CLE031
     C                     CALL 'AOCURRR0'             99                 CLE031
     C                     PARM '*MSG    '@RTCD   7                       CLE031
     C                     PARM '*KEY    '@OPTN   7                       CLE031
     C                     PARM CCY       CURKEY  3                       CLE031
     C           SDCURR    PARM SDCURR    DSSDY                           CLE031
      *                                                                   CLE031
     C           @RTCD     IFNE *BLANKS                                   CLE031
     C                     SETON                     U7U8LR               CLE031
     C                     Z-ADD18        DBASE                           CLE031
     C                     MOVE 'SDCURRPD'DBFILE                          CLE031
     C                     MOVELCCY       DBKEY                           CLE031
     C                     GOTO ENDAA                                     CLE031
     C                     ENDIF                                          CLE031
      *                                                                   CLE031
     C                     MOVE A6INCY    LCCYIN                          CLE031
      *                                                                   CLE031
     C           *IN45     IFEQ *ON                                       CLE031
     C           SCCY      ANDNE*BLANKS                                   CLE031
     C                     MOVE SCCY      CURKEY                          CLE031
     C                     ENDIF                                          CLE031
      *                                                                   CLE031
     C           *IN46     IFEQ *ON                                       CLE031
     C           PSCY      ANDNE*BLANKS                                   CLE031
     C                     MOVE PSCY      CURKEY                          CLE031
     C                     ENDIF                                          CLE031
      *                                                                                       239588
      ** If CLE031 is OFF and Settlement currency is not equal *BLANK                         239588
      ** use settlement currency                                                              239588
      *                                                                                       239588
     C           CLE031    IFNE 'Y'                                                           239588
     C           SCCY      ANDNE*BLANKS                                                       239588
     C                     MOVE SCCY      CURKEY                                              239588
     C                     ENDIF                                                              239588
      *                                                                   CLE031
     C                     CALL 'AOCURRR0'             99                 CLE031
     C                     PARM '*MSG    '@RTCD   7                       CLE031
     C                     PARM '*KEY    '@OPTN   7                       CLE031
     C                     PARM           CURKEY  3                       CLE031
     C           SDCURR    PARM SDCURR    DSSDY                           CLE031
      *                                                                   CLE031
     C           @RTCD     IFNE *BLANKS                                   CLE031
     C                     SETON                     U7U8LR               CLE031
     C                     Z-ADD19        DBASE                           CLE031
     C                     MOVE 'SDCURRPD'DBFILE                          CLE031
     C                     MOVELCURKEY    DBKEY                           CLE031
     C                     GOTO ENDAA                                     CLE031
     C                     ENDIF                                          CLE031
      *                                                                   CLE031
     C                     MOVE A6INCY    SCCYIN                          CLE031
      *                                                                   CLE031
     C           LCCYIN    IFEQ 'Y'                                       CLE031
     C           SCCYIN    OREQ 'Y'                                       CLE031
     C**********           MOVE SCCY      CURREN      Set Ccy Fld   CEU004CLE031
     C                     MOVE CURKEY    CURREN                          CLE031
     C                     MOVE CCY       CCYSV   3         Set Ccy sv fld135378
     C                     MOVE EAMT      AMTSV  130        Set Amt sv fld135378
     C                     ELSE                                           CLE031
     C           *IN45     IFEQ *ON                                       CLE031
     C           SCCY      ANDNE*BLANKS                                   CLE031
     C                     MOVE SCCY      CURREN                          CLE031
     C                     MOVE CCY       CCYSV                           CLE031
     C                     Z-ADDREXR      WEXR                            CLE031
     C                     MOVE REXI      WEXI                            CLE031
     C                     ENDIF                                          CLE031
     C           *IN46     IFEQ *ON                                       CLE031
     C           PSCY      ANDNE*BLANKS                                   CLE031
     C                     MOVE PSCY      CURREN                          CLE031
     C                     MOVE CCY       CCYSV                           CLE031
     C                     Z-ADDPEXR      WEXR                            CLE031
     C                     MOVE PEXI      WEXI                            CLE031
     C                     ENDIF                                          CLE031
     C                     ENDIF                                          CLE031
     C                     ENDIF                            End If        CEU004
      *                                                                   CEU004
     C                     ENDIF                           End If         CEU004
      *                                                                   128093
      **   SET UP & WRITE OUTPUT RECORDS                                  128093
      *                                                                   128093
      * Signify maturity date pay/rec to be produced                      128093
     C                     MOVE 'M'       VORM    1                       128093
     C                     EXSR CREATE                                    128093
      *                                                                                       CLE034
     C           CLE034    IFEQ 'Y'                                                           CLE034
     C           WKPROC    ANDEQ'Y'                                                           CLE034
     C                     EXSR SR34C                                                         CLE034
     C                     ELSE                                                               CLE034
     C                     MOVE *BLANK    WFIELD                                              CLE034
     C                     ENDIF                                                              CLE034
      *                                                                                       CLE034
     C                     ENDDO                                                              CLE034
      *                                                                                       CLE034
     C           CLE034    IFEQ 'Y'                                                           CLE034
     C           WKPROC    ANDEQ'Y'                                                           CLE034
     C                     EXSR SR34E                                                         CLE034
     C                     ENDIF                                                              CLE034
      *                                                                                       CLE034
     C                     ENDIF                                          128093
     C*
     C           CLE031    IFEQ 'Y'                                       CLE031
     C           VDATLN    ANDEQ0                                         CLE031
     C           PRI3      ANDEQ1                                         CLE031
     C           NPRAM     IFGT 0                                         CLE031
      *                                                                                       CLE034
     C           CLE034    IFEQ 'Y'                                                           CLE034
     C           RCDT      ANDEQ'L'                                                           CLE034
     C           STAL      ANDEQ'Y'                                                           CLE034
     C           CLE034    OREQ 'Y'                                                           CLE034
     C           RCDT      ANDEQ'R'                                                           CLE034
     C           STAL      ANDEQ'Y'                                                           CLE034
      *                                                                                       CLE034
     C           CPAM      IFLT NPRAM                                                         CLE034
      *                                                                                       CLE034
     C           *IN45     IFEQ *ON                                                           CLE034
     C                     MOVE 'P'       WPYREC                                              CLE034
     C                     ENDIF                                                              CLE034
     C           *IN46     IFEQ *ON                                                           CLE034
     C                     MOVE 'R'       WPYREC                                              CLE034
     C                     ENDIF                                                              CLE034
      *                                                                                       CLE034
     C                     ELSE                                                               CLE034
      *                                                                                       CLE034
     C           *IN45     IFEQ *ON                                                           CLE034
     C                     MOVE 'P'       WPYREC                                              CLE034
     C                     ENDIF                                                              CLE034
     C           *IN46     IFEQ *ON                                                           CLE034
     C                     MOVE 'R'       WPYREC                                              CLE034
     C                     ENDIF                                                              CLE034
      *                                                                                       CLE034
     C                     ENDIF                                                              CLE034
      *                                                                                       CLE034
     C           *IN45     IFEQ *ON                                                           CLE034
     C           *IN46     OREQ *ON                                                           CLE034
     C                     MOVE 'Y'       WKPROC                                              CLE034
     C                     EXSR SR34A                                                         CLE034
     C                     ELSE                                                               CLE034
     C                     MOVE 'Y'       WFIELD                                              CLE034
     C                     MOVE '*EOF   ' PRTCD                                               CLE034
     C                     ENDIF                                                              CLE034
      *                                                                                       CLE034
     C                     ELSE                                                               CLE034
     C                     MOVE 'Y'       WFIELD                                              CLE034
     C                     MOVE '*EOF   ' PRTCD                                               CLE034
     C                     ENDIF                                                              CLE034
      *                                                                                       CLE034
     C           WFIELD    DOWEQ'Y'                                                           CLE034
     C           PRTCD     OREQ *BLANKS                                                       CLE034
      *                                                                                       CLE034
     C           CLE034    IFEQ 'Y'                                                           CLE034
     C           WKPROC    ANDEQ'Y'                                                           CLE034
     C                     EXSR SR34D                                                         CLE034
     C                     ENDIF                                                              CLE034
      *                                                                                       CLE034
     C           CPAM      IFLT NPRAM                                     CLE031
     C           NPRAM     SUB  CPAM      EAMT                            CLE031
     C           *IN45     IFEQ *ON                                       CLE031
     C                     MOVE PONS      OURAG                           CLE031
     C                     MOVE PSTM      SETTLE                          CLE031
     C                     MOVE 'P'       PAYREC                          CLE031
     C           PSCY      IFNE *BLANKS                                   CLE031
     C                     MOVE PSCY      CURREN                          CLE031
     C                     MOVE CCY       CCYSV                           CLE031
     C                     Z-ADDPEXR      WEXR                            CLE031
     C                     MOVE PEXI      WEXI                            CLE031
     C                     ENDIF                                          CLE031
     C                     ENDIF                                          CLE031
     C           *IN46     IFEQ *ON                                       CLE031
     C                     MOVE RONS      OURAG                           CLE031
     C                     MOVE RSTM      SETTLE                          CLE031
     C                     MOVE 'R'       PAYREC                          CLE031
     C           SCCY      IFNE *BLANKS                                   CLE031
     C                     MOVE SCCY      CURREN                          CLE031
     C                     MOVE CCY       CCYSV                           CLE031
     C                     Z-ADDREXR      WEXR                            CLE031
     C                     MOVE REXI      WEXI                            CLE031
     C                     ENDIF                                          CLE031
     C                     ENDIF                                          CLE031
     C                     ELSE                                           CLE031
     C           CPAM      SUB  NPRAM     EAMT                            CLE031
     C           *IN45     IFEQ *ON                                       CLE031
     C                     MOVE RONS      OURAG                           CLE031
     C                     MOVE RSTM      SETTLE                          CLE031
     C                     MOVE 'R'       PAYREC                          CLE031
     C           SCCY      IFNE *BLANKS                                   CLE031
     C                     MOVE SCCY      CURREN                          CLE031
     C                     MOVE CCY       CCYSV                           CLE031
     C                     Z-ADDREXR      WEXR                            CLE031
     C                     MOVE REXI      WEXI                            CLE031
     C                     ENDIF                                          CLE031
     C                     ENDIF                                          CLE031
     C           *IN46     IFEQ *ON                                       CLE031
     C                     MOVE PONS      OURAG                           CLE031
     C                     MOVE PSTM      SETTLE                          CLE031
     C                     MOVE 'P'       PAYREC                          CLE031
     C           PSCY      IFNE *BLANKS                                   CLE031
     C                     MOVE PSCY      CURREN                          CLE031
     C                     MOVE CCY       CCYSV                           CLE031
     C                     Z-ADDPEXR      WEXR                            CLE031
     C                     MOVE PEXI      WEXI                            CLE031
     C                     ENDIF                                          CLE031
     C                     ENDIF                                          CLE031
     C                     ENDIF                                          CLE031
     C                     MOVE 'R'       VORM                            CLE031
     C                     EXSR CREATE                                    CLE031
      *                                                                                       CLE034
     C           CLE034    IFEQ 'Y'                                                           CLE034
     C           WKPROC    ANDEQ'Y'                                                           CLE034
     C                     EXSR SR34C                                                         CLE034
     C                     ELSE                                                               CLE034
     C                     MOVE *BLANK    WFIELD                                              CLE034
     C                     ENDIF                                                              CLE034
      *                                                                                       CLE034
     C                     ENDDO                                                              CLE034
      *                                                                                       CLE034
     C           CLE034    IFEQ 'Y'                                                           CLE034
     C           WKPROC    ANDEQ'Y'                                                           CLE034
     C                     EXSR SR34E                                                         CLE034
     C                     ENDIF                                                              CLE034
      *                                                                                       CLE034
     C                     ENDIF                                          CLE031
     C                     ENDIF                                          CLE031
     C           ENDAA     ENDSR
     C********************************************************************
     C*          L O A N     A M E N D M E N T S
     C*                                                    * LEP1068-CC  *
     C*    PROCCC IS CALLED BY - PROC2
     C*
     C*              CALLS - CREATE
     C*
     C********************************************************************
     C           PROCCC    BEGSR                           * PROCCC BEGSR*
     C/COPY WNCPYSRC,LE1067C012
     C                     SETON                     49
     C                     MOVE *BLANKS   CVMI                                                232787
     C**
     C*****PAY/REC. INDICATOR MUST EQUAL 1
     C                     MOVE SETPDK    SETTLE
     C   45                MOVE 'P'       PAYREC
     C   46                MOVE 'R'       PAYREC
      *                                                                                       CLE034
     C           CLE034    IFEQ 'Y'                                                           CLE034
     C           STALDK    ANDEQ'Y'                                                           CLE034
     C                     MOVE PAYREC    WPYREC                                              CLE034
     C                     MOVE 'Y'       WKPROC                                              CLE034
     C                     EXSR SR34A                                                         CLE034
     C                     ELSE                                                               CLE034
     C                     MOVE 'Y'       WFIELD                                              CLE034
     C                     MOVE '*EOF   ' PRTCD                                               CLE034
     C                     ENDIF                                                              CLE034
      *                                                                                       CLE034
     C           WFIELD    DOWEQ'Y'                                                           CLE034
     C           PRTCD     OREQ *BLANKS                                                       CLE034
      *                                                                                       CLE034
     C           CLE034    IFEQ 'Y'                                                           CLE034
     C           WKPROC    ANDEQ'Y'                                                           CLE034
     C                     EXSR SR34D                                                         CLE034
     C                     ENDIF                                                              CLE034
      *                                                                                       CLE034
     C                     MOVE OSACDK    OURAG
     C                     MOVE TSENDK    THRAG
     C                     MOVE CCYDK     CURREN
      *                                                                   CEU004
      ** If feature CEU004 is on,                                         CEU004
      ** If the Settlement Ccy *NE transaction Ccy, set field CURREN.     CEU004
      *                                                                   CEU004
     C           CEU004    IFEQ 'Y'                        If Feature On  CEU004
     C           CLE031    OREQ 'Y'                                       CLE031
      *                                                                   CEU004
     C***********SCCY      IFNE CCYDK                 If Ccys # Eql CEU004CLE031
     C           CEU004    IFEQ 'Y'                                       CLE031
     C           SCCY      ANDNECCYDK                                     CLE031
     C           SCCY      ANDNE*BLANKS                                   CEU004
     C           CLE031    OREQ 'Y'                                       CLE031
     C           PSCYDK    ANDNECCYDK                                     CLE031
     C           PSCYDK    ANDNE*BLANKS                                   CLE031
     C           *IN45     ANDEQ*ON                                       CLE031
     C           CLE031    OREQ 'Y'                                       CLE031
     C           SCCY      ANDNECCYDK                                     CLE031
     C           SCCY      ANDNE*BLANKS                                   CLE031
     C           *IN46     ANDEQ*ON                                       CLE031
      *                                                                   CLE031
     C                     CALL 'AOCURRR0'             99                 CLE031
     C                     PARM '*MSG    '@RTCD   7                       CLE031
     C                     PARM '*KEY    '@OPTN   7                       CLE031
     C                     PARM CCYDK     CURKEY  3                       CLE031
     C           SDCURR    PARM SDCURR    DSSDY                           CLE031
      *                                                                   CLE031
     C           @RTCD     IFNE *BLANKS                                   CLE031
     C                     SETON                     U7U8LR               CLE031
     C                     Z-ADD20        DBASE                           CLE031
     C                     MOVE 'SDCURRPD'DBFILE                          CLE031
     C                     MOVELCCYDK     DBKEY                           CLE031
     C                     GOTO ENDCC                                     CLE031
     C                     ENDIF                                          CLE031
      *                                                                   CLE031
     C                     MOVE A6INCY    LCCYIN                          CLE031
      *                                                                   CLE031
     C           *IN45     IFEQ *ON                                       CLE031
     C           PSCYDK    ANDNE*BLANKS                                   CLE031
     C                     MOVE PSCYDK    CURKEY                          CLE031
     C                     ENDIF                                          CLE031
      *                                                                   CLE031
     C           *IN46     IFEQ *ON                                       CLE031
     C           SCCY      ANDNE*BLANKS                                   CLE031
     C                     MOVE SCCY      CURKEY                          CLE031
     C                     ENDIF                                          CLE031
      *                                                                                       239588
      ** If CLE031 is OFF and Settlement currency is not equal *BLANK                         239588
      ** use settlement currency                                                              239588
      *                                                                                       239588
     C           CLE031    IFNE 'Y'                                                           239588
     C           SCCY      ANDNE*BLANKS                                                       239588
     C                     MOVE SCCY      CURKEY                                              239588
     C                     ENDIF                                                              239588
      *                                                                   CLE031
     C                     CALL 'AOCURRR0'             99                 CLE031
     C                     PARM '*MSG    '@RTCD   7                       CLE031
     C                     PARM '*KEY    '@OPTN   7                       CLE031
     C                     PARM           CURKEY  3                       CLE031
     C           SDCURR    PARM SDCURR    DSSDY                           CLE031
      *                                                                   CLE031
     C           @RTCD     IFNE *BLANKS                                   CLE031
     C                     SETON                     U7U8LR               CLE031
     C                     Z-ADD21        DBASE                           CLE031
     C                     MOVE 'SDCURRPD'DBFILE                          CLE031
     C                     MOVELCURKEY    DBKEY                           CLE031
     C                     GOTO ENDCC                                     CLE031
     C                     ENDIF                                          CLE031
      *                                                                   CLE031
     C                     MOVE A6INCY    SCCYIN                          CLE031
      *                                                                   CLE031
     C           LCCYIN    IFEQ 'Y'                                       CLE031
     C           SCCYIN    OREQ 'Y'                                       CLE031
     C**********           MOVE SCCY      CURREN       Set Ccy Fld  CEU004CLE031
     C                     MOVE CURKEY    CURREN                          CLE031
     C                     MOVE CCYDK     CCYSV   3         Set Ccy sv fld141893
     C                     MOVE EAMT      AMTSV  130        Set Amt sv fld141893
     C                     ELSE                                           CLE031
     C           *IN45     IFEQ *ON                                       CLE031
     C           PSCYDK    ANDNE*BLANKS                                   CLE031
     C                     MOVE PSCYDK    CURREN                          CLE031
     C                     MOVE CCYDK     CCYSV                           CLE031
     C                     Z-ADDPEXRDK    WEXR                            CLE031
     C                     MOVE PEXIDK    WEXI                            CLE031
     C                     ENDIF                                          CLE031
     C           *IN46     IFEQ *ON                                       CLE031
     C           SCCY      ANDNE*BLANKS                                   CLE031
     C                     MOVE SCCY      CURREN                          CLE031
     C                     MOVE CCYDK     CCYSV                           CLE031
     C                     Z-ADDREXRDK    WEXR                            CLE031
     C                     MOVE REXIDK    WEXI                            CLE031
     C                     ENDIF                                          CLE031
     C                     ENDIF                                          CLE031
     C                     ENDIF                            End If        CEU004
      *                                                                   CEU004
     C                     ENDIF                           End If         CEU004
      *                                                                   CEU004
     C**
     C**   SET UP & WRITE OUTPUT RECORDS
     C                     EXSR CREATE
      *                                                                                       CLE034
     C           CLE034    IFEQ 'Y'                                                           CLE034
     C           WKPROC    ANDEQ'Y'                                                           CLE034
     C                     EXSR SR34C                                                         CLE034
     C                     ELSE                                                               CLE034
     C                     MOVE *BLANK    WFIELD                                              CLE034
     C                     ENDIF                                                              CLE034
      *                                                                                       CLE034
     C                     ENDDO                                                              CLE034
      *                                                                                       CLE034
     C           CLE034    IFEQ 'Y'                                                           CLE034
     C           WKPROC    ANDEQ'Y'                                                           CLE034
     C                     EXSR SR34E                                                         CLE034
     C                     ENDIF                                                              CLE034
      *                                                                                       CLE034
     C*
     C           ENDCC     ENDSR
     C********************************************************************
     C* S U B R O U T I N E   T O   D E T E R M I N E   W H I C H
     C*
     C* R E C O R D S   T O   C R E A T E
     C*       I/P PARMS - SETTLE - SETTLEMENT TYPE
     C*                 - CURREN - CURRENCY
     C*                 - PAYREC - PAY/RECEIVE IND.
     C*                 - OURAG  - OUR AGENT
     C*                 - THRAG  - THEIR AGENT
     C*
     C*    CREATE IS CALLED BY - PROCAA;PROCCC
     C*
     C*
     C*              CALLS - CHKSW PROCEE OLETX1 OLETX2 OLETX3 OLEPXT
     C*
     C********************************************************************
     C           CREATE    BEGSR                           *** CREATE ***
     C**
     C**   SETTLEMENT TYPE MUST BE 01,02,07,08,OR 12
     C           SETTLE    LOKUPIPSET                    42
     C  N42                GOTO ENDCRE
     C*                                                                   043772
     C** IF NOSTRO MISSING, SET SETTLEMENT BRANCH TO BOOKING BRANCH.      043772
     C*                                                                   043772
     C           OURAG     IFEQ *BLANKS                                   043772
     C                     MOVE BRCA      @OSBR                           043772
     C                     END                                            043772
     C*                                                                   137584
     C** IF @OSBR IS BLANK, SET SETTLEMENT BRANCH TO BOOKING BRANCH.      137584
     C*                                                                   137584
     C           @OSBR     IFEQ *BLANKS                                   137584
     C                     MOVE BRCA      @OSBR                           137584
     C                     END                                            137584
     C*
     C                     SETOF                     375355
     C**
     C** OUTPUT RECORD DEPENDS ON SETTLEMENT TYPE
     C*
     C**    IF SETTLEMENT TYPE = 08, U4 ON, AND NOSTRO IS SWIFT MEMBER,
     C**    OUTPUT TO LEPXT
     C           SETTLE    COMP 08                       42
     C   42 U4             EXSR CHKSW
     C   U7 U8 LR          GOTO ENDCRE
     C/COPY WNCPYSRC,LE1067C004
     C*                                                                   S01518
     C           *IN42     IFEQ '1'                                       S01518
     C           *IN55     ANDEQ'1'                                       S01518
     C*                                                                   S01518
     C** If Lending Swift feature is switched ON                          S01518
     C*                                                                   S01518
     C           *IN30     IFEQ '1'                                       S01518
     C           CVMI      DOUNE'P'                                       S01518
     C                     EXSR OLEPXT                                    S01518
     C                     END                                            S01518
     C                     MOVE *BLANKS   CVMI    1                       S01518
     C*                                                                   S01518
     C** If Lending Swift feature not available                           S01518
     C*                                                                   S01518
     C                     ELSE                                           S01518
     C   42 55             EXSR OLEPXT
     C                     END                                            S01518
     C                     END                                            S01518
     C   42 55             GOTO ENDCRE
     C*
     C**   IF SETTLE = 08 BUT NOT SATISFY ABOVE, OR SETTLE = 07,
     C**   CALCULATE IF COMPLETE OR INCOMPLETE AND OUTPUT TO LETX1/2
     C  N42      SETTLE    COMP 07                       42
     C  N42                GOTO SELSE1
     C**
     C**   VALIDATE INSTRUCTIONS
     C* REVERSALS AND AMENDMENTS ARE ONLY PROCESSED FOR SWIFT
     C           *IN62     IFEQ '0'
     C                     EXSR PROCEE
     C   50                EXSR OLETX1
     C  N50                EXSR OLETX2
     C                     END
     C                     GOTO ENDCRE
     C*
     C**    IF SETTLEMENT TYPE = 01 :-
     C           SELSE1    TAG                             ** SELSE1 TAG**
     C           SETTLE    COMP 01                       42
     C  N42                GOTO SELSE2
     C/COPY WNCPYSRC,LE1067C019
     C*
     C**    AND IF CCY = LOCAL CCY, AND LCYN = 'B'
     C           CURREN    COMP LOCY                     42
     C*
     C* REVERSALS AND AMENDMENTS ARE ONLY PROCESSED FOR SWIFT
     C           *IN42     IFEQ '1'
     C           *IN54     ANDEQ'1'
     C           *IN62     ANDEQ'1'
     C/COPY WNCPYSRC,LE1067C005
     C                     GOTO ENDCRE
     C                     END
     C*
     C   42 54             EXSR OLETX3
     C   53                GOTO ENDCRE
     C**
     C**    IF SETTLE = 01, LOCAL CCY BUT LCYN = 'T', OR NOT LOCAL CCY:-
     C**    IF U4 AND NOSTRO IS SWIFT MEMBER, USE LEPXT.  ELSE USE LETX1/2
     C   U4                EXSR CHKSW
     C   U7 U8 LR          GOTO ENDCRE
     C*                                                                   S01518
     C           *IN55     IFEQ '1'                                       S01518
     C*                                                                   S01518
     C** If Lending Swift feature is switched ON                          S01518
     C*                                                                   S01518
     C           *IN30     IFEQ '1'                                       S01518
     C           CVMI      DOUNE'P'                                       S01518
     C                     EXSR OLEPXT                                    S01518
     C                     END                                            S01518
     C                     MOVE *BLANKS   CVMI                            S01518
     C*                                                                   S01518
     C** If Lending Swift feature not available                           S01518
     C*                                                                   S01518
     C                     ELSE                                           S01518
     C   55                EXSR OLEPXT
     C                     END                                            S01518
     C                     END                                            S01518
     C   55                GOTO ENDCRE
     C*
     C* REVERSALS AND AMENDMENTS ARE ONLY PROCESSED FOR SWIFT
     C           *IN62     IFEQ '0'
     C                     EXSR PROCEE
     C   50                EXSR OLETX1
     C  N50                EXSR OLETX2
     C                     END
     C**
     C                     GOTO ENDCRE
     C           SELSE2    TAG                             ** SELSE2 TAG**
     C*
     C* REVERSALS AND AMENDMENTS ARE ONLY PROCESSED FOR SWIFT
     C           *IN62     IFEQ '0'
     C           SETTLE    COMP 02                       42
     C  N42      SETTLE    COMP 12                       42
     C   42                EXSR OLETX3
     C                     END
     C*
     C           ENDCRE    ENDSR
     C*
     C********************************************************************
     C********************************************************************
     C*
     C*         SUBROUTINE TO CHECK IF NOSTRO IS SWIFT MEMBER
     C*
     C*         I/P PARMS - OURAG  - OUR AGENT  \  FROM PROCAA
     C*                     CURREN - CURRENCY   /  OR PROCCC
     C*
     C*         CHKSW IS CALLED BY - CREATE
     C*
     C***********************CALLS***TABCHN*                              S01194
     C*                      CALLS -                                      S01194
     C*
     C********************************************************************
     C*
     C*
     C           CHKSW     BEGSR                           *** CHKSW ***
     C*
     C*
     C**    OUR AGENT VALIDATION
     C           OURAG     COMP ' '                  5050
     C  N50                GOTO CHKEND
     C**
     C**    NOT BLANK - CHECK NOSTRO EXISTS/GET NOSTRO'S CUST.NO.
     C                     MOVELOURAG     NOSN
     C***********          MOVE CURREN    CCY                             137920
     C                     MOVE CURREN    AONCCY           Set Key Ccy    137920
     C**********           Z-ADD70        RECT                            S01194
     C                     CALL 'AONOSTR0'PLIST2                          S01194
     C           @RTCD     IFNE *BLANKS                                   S01194
     C                     SETON                     U7U8LR               S01194
     C                     Z-ADD8         DBASE            ** DBASE 08 ** S01194
     C                     MOVE 'SDNOSTPD'DBFILE                          S01194
     C                     MOVELNOSN      DBKEY                           S01194
     C**********           MOVE CCY       DBKEY                     S01194156523
     C                     MOVE CURREN    DBKEY                           156523
     C                     GOTO CHKEND                                    S01194
     C                     END                                            S01194
     C**********           EXSR TABCHN                                    S01194
     C***99*****           SETOF                     50                   S01194
     C**
     C***99*****           SETON                     U7U8LR               S01194
     C***99*****           MOVE '08'      DBASE            ** DBASE 08 ** S01194
     C***99*****           MOVELZTABKY    DBKEY                           S01194
     C***99*****           MOVE 'TABLE'   DBFILE                          S01194
     C***99*****           GOTO CHKEND                                    S01194
     C*
     C*    USE NOSTRO'S CUST. NO. TO CHAIN TO CLIENT FILE FOR SWIFT ID
     C*
     C                     SETOF                     06
     C**********           MOVELCNUMTL    CUSKEY  7                       S01194
     C**********           MOVE 'A'       CUSKEY                          S01194
     C********** CUSKEY    CHAINCLINT                41                   S01194
     C                     MOVELCNUMTL    CKEY                            S01194
     C                     CALL 'AOCUSTR0'PLIST3                          S01194
     C           @RTCD     IFNE *BLANKS                                   S01194
     C                     SETON                     U7U8LR               S01194
     C                     Z-ADD9         DBASE            ** DBASE 09 ** S01194
     C                     MOVE 'SDCUSTPD'DBFILE                          S01194
     C                     MOVE CKEY      DBKEY                           S01194
     C                     GOTO CHKEND                                    S01194
     C                     END                                            S01194
     C***06******CSID      COMP ' '                  5555   55=SWIFT MBR. S01117
     C********** GSFM      COMP 'Y'                  5555   55=SWIFTS01194LN1039
     C           GSFM      COMP 'Y'                      55 55=SWIFT MBR. LN1039
     C**********           TESTB'3'       TLXR           56               S01194
     C           BBCMTI    COMP 'Y'                      56               S01194
     C   55 56   PRSW      COMP PRTX                 5655
     C*
     C**N06*****           SETON                     U7U8LR               S01194
     C**N06*****           MOVE '09'      DBASE            ** DBASE 09    S01194
     C**N06*****           MOVELCUSKEY    DBKEY                           S01194
     C**N06*****           MOVE 'CLINT'   DBFILE                          S01194
     C*
     C**  SWIFT message not appropriate for method 01                     128095
     C***    (whatever GSFM is)                                           128095
     C           SETTLE    IFEQ 01                                        128095
     C                     MOVE '0'       *IN55                           128095
     C                     ENDIF                                          128095
     C**                                                                  128095
     C*    SET INDICATOR TO AVOID REPEATING OURAG CHECK IN PROCEE SR.
     C                     SETON                     37
     C*
     C           CHKEND    TAG                             ** CHKEND TAG *
     C*
     C                     ENDSR
     C*
     C********************************************************************
     C********************************************************************
     C* VALIDATION OF INSTRUCTIONS  * LEP1068-EE *
     C*       I/P  OURAG - OUR AGENT A/C
     C*            THRAG - THEIR AGENT A/C
     C*
     C*       O/P  PAYREC - WILL BE SET TO 'C' IF NECCESSARY
     C*            IND.50 - INSTRUCTIONS VALID
     C*
     C*    PROCEE IS CALLED BY - CREATE
     C*
     C*              CALLS*-*TABCHN*                                      S01194
     C*
     C********************************************************************
     C           PROCEE    BEGSR                           *** PROCEE ***
     C*
     C**    OMIT OUR AGENT VALIDATION IF ALREADY
     C**    CHECKED IN CHKSW SR.
     C*
     C   37                GOTO THRTAG
     C*
     C                     SETOF                     50
     C**
     C**   OUR AGENT VALIDATION
     C           OURAG     COMP ' '                  5050
     C  N50                GOTO ENDEE
     C**
     C**   NOT BLANK - DOES NOSTRO EXIST
     C                     MOVELOURAG     NOSN
     C***********          MOVE CURREN    CCY                             137920
     C                     MOVE CURREN    AONCCY           Set Key Ccy    137920
     C**********           Z-ADD70        RECT                            S01194
     C**********           EXSR TABCHN                                    S01194
     C                     CALL 'AONOSTR0'PLIST2                          S01194
     C           @RTCD     IFNE *BLANKS                                   S01194
     C                     SETOF                     50                   S01194
     C                     SETON                     U7U8LR               S01194
     C                     Z-ADD10        DBASE            ** DBASE 10 ** S01194
     C                     MOVE 'SDNOSTPD'DBFILE                          S01194
     C                     MOVELNOSN      DBKEY                           S01194
     C***********          MOVE CCY       DBKEY                     S01194156523
     C                     MOVE CURREN    DBKEY                           156523
     C                     GOTO ENDEE                                     S01194
     C                     END                                            S01194
     C*
     C***99*****           SETOF                     50                   S01194
     C***99*****           SETON                     U7U8LR               S01194
     C***99*****           MOVE '10'      DBASE            ** DBASE 10 ** S01194
     C***99*****           MOVELZTABKY    DBKEY                           S01194
     C***99*****           MOVE 'TABLE'   DBFILE                          S01194
     C***99*****           GOTO ENDEE                                     S01194
     C**
     C           THRTAG    TAG                             *** THRTAG ***
     C*
     C**
     C**   THEIR AGENT VALIDATION
     C           THRAG     COMP ' '                  5050
     C  N50                GOTO ENDEE
0774 C***********IFCUST    COMP '000001'             42                                       CSD027
0775 C***42******IFCUST    COMP '999999'               42                                     CSD027
     C                     MOVELIFCUST    CKEY                                                CSD027
     C                     CALL 'AOCUSTR0'PLIST3                                              CSD027
     C           @RTCD     IFNE '*CNUM  '                                                     CSD027
     C                     SETOF                     42                                       CSD027
     C                     ELSE                                                               CSD027
     C                     SETON                     42                                       CSD027
     C                     END                                                                CSD027
     C                     SETOF                     42                                       CSD027
     C                     CALL 'AOCUSTR0'                                                    CSD027
     C                     PARM '*BLANKS' @RTCD   7                                           CSD027
     C                     PARM '*KEY   ' @OPTN   7                                           CSD027
     C                     PARM IFCUST    @AENB  10                                           CSD027
     C                     PARM *BLANKS   @KYST   7                                           CSD027
     C           SDCUST    PARM SDCUST    DSSDY                                               CSD027
      *                                                                                       CSD027
     C**
     C**   NOT A CUSTOMER NUMBER - BYPASS
     C**N42******          GOTO ENDEE                                                         CSD027
     C           @RTCD     IFNE *BLANKS                                                       CSD027
     C           @KYST     ORNE '*CNUM  '                                                     CSD027
     C                     GOTO ENDEE                                                         CSD027
     C                     END                                                                CSD027
     C**
     C**   SHOULD CREDIT TELEX BE SENT
     C           PAYREC    COMP 'P'                      42
     C                     MOVE CUST      CUSTA   6                       S01194
     C   42      CNUMTL    COMP CUSTA                    42               S01194
     C***42***** CNUMTL    COMP CUST                     42               S01194
     C   42                MOVE 'C'       PAYREC
     C*
     C           ENDEE     ENDSR                           ** ENDEE TAG **
     C********************************************************************
     C/SPACE 3
     C********************************************************************
     C* S E T U P   A N D   W R I T E   O U T P U T   R E C O R D
     C*
     C*    OUTPUT IS CALLED BY - OLETX1;OLETX2;OLETX3
     C*                        - OLEPXT
     C*
     C********************************************************************
     C           OUTPUT    BEGSR                           *** OUTPUT ***
      *                                                                   CEU004
      ** If feature CEU004 is on, clear output fields.                    CEU004
      *                                                                   CEU004
     C           CEU004    IFEQ 'Y'                        If Feature On  CEU004
      *                                                                   CEU004
     C                     Z-ADD0         OTAM   130        Reset OtAmt   CEU004
     C                     MOVE *BLANKS   OTCY    3         Clr OthCcy    CEU004
      *                                                                   CEU004
     C                     ENDIF                           End If         CEU004
      *                                                                   CEU004
     C**
     C**   SET UP OUT PUT FIELDS FOR LOANS FIRST
     C  N48                GOTO ELSE01
      *                                                                   128093
      * If processing loan value date pay/rec                             128093
     C           VORM      IFEQ 'V'                                       128093
     C                     Z-ADDVDAT      VDATPH  50
      *                                                                   128093
      * else processing maturity date pay/rec                             128093
     C                     ELSE                                           128093
     C                     Z-ADDMDAT      VDATPH  50                      128093
     C                     ENDIF                                          128093
     C***********          Z-ADDCNUM      CNUMPH                                              CSD027
     C                     MOVE CNUM      CNUMPH                                              CSD027
     C**********           Z-ADDLNRF      LNRFPH                                              CLE148
     C                     MOVELLNRF      LNRFPH                                              CLE148
      *                                                                                       CLE038
     C           CLE038    IFEQ 'Y'                                                           CLE038
     C           CLE031    ANDEQ'Y'                                                           CLE038
     C           WKPROC    ANDEQ'Y'                                                           CLE038
     C           WPYREC    ANDEQ'P'                                                           CLE038
     C           PYBASA    ANDEQ'A'                                                           CLE038
     C           CLE038    OREQ 'Y'                                                           CLE038
     C           CLE031    ANDEQ'Y'                                                           CLE038
     C           WKPROC    ANDEQ'Y'                                                           CLE038
     C           WPYREC    ANDEQ'R'                                                           CLE038
     C           RCBASA    ANDEQ'A'                                                           CLE038
      *                                                                                       CLE038
     C                     EXSR SRCL38                                                        CLE038
      *                                                                                       CLE038
     C                     ELSE                                                               CLE038
      *                                                                                       CLE038
     C***********CPAM      SUB  TOTI      EAMT   130                      128093
      *                                                                   CLE031
     C           CLE031    IFEQ 'Y'                                       CLE031
     C           VORM      ANDEQ'R'                                       CLE031
     C                     Z-ADDRLDT      VDATPH                          CLE031
     C                     ELSE                                           CLE031
      *                                                                   128093
      * Calculate event amount. Depends on whether value/maturity         128093
      * date event, processing type and whereabouts in the lifetime       128093
      * of the loan we are                                                128093
     C                     EXSR CALAMT                                    128093
     C                     ENDIF                                          CLE031
      *                                                                                       CLE034
     C           CLE034    IFEQ 'Y'                                                           CLE034
     C           WKPROC    ANDEQ'Y'                                                           CLE034
     C                     EXSR SR34B                                                         CLE034
     C                     ENDIF                                                              CLE034
      *                                                                   CEU004
      ** If feature CEU004 is on,                                         CEU004
      ** If the Settlement currency *NE transaction Ccy, convert amount   CEU004
      *                                                                   CEU004
     C           CEU004    IFEQ 'Y'                        If Feature On  CEU004
     C           CLE031    OREQ 'Y'                                       CLE031
      *                                                                   CEU004
     C***********          MOVE CCY       CCYSV   3         Set Cc CEU004 135378
     C***********          MOVE EAMT      AMTSV  130        Set Am CEU004 135378
      *                                                                   148104
      ** Save the EAMT while it is still in transaction currency for      148104
      ** output to field OTAM.                                            148104
      *                                                                   148104
     C                     Z-ADDEAMT      AMTSV                           148104
      *                                                                   CEU004
     C***********SCCY      IFNE *BLANKS               If StCcy # BlkCEU004CLE031
     C***********SCCY      ANDNECCY                         And Cc CEU004 135378
     C           CEU004    IFEQ 'Y'                                       CLE031
     C           SCCY      ANDNE*BLANKS                                   CLE031
     C           SCCY      ANDNECCYSV                       And Ccys # Eql135378
     C           CLE031    OREQ 'Y'                                       CLE031
     C           CURREN    ANDNECCYSV                                     CLE031
     C           CURREN    ANDNE*BLANKS                                   CLE031
     C           SCCY      ANDNE*BLANKS                                   CLE031
     C           CLE031    OREQ 'Y'                                       CLE031
     C           CURREN    ANDNECCYSV                                     CLE031
     C           CURREN    ANDNE*BLANKS                                   CLE031
     C           PSCY      ANDNE*BLANKS                                   CLE031
      *                                                                   CLE031
     C                     CALL 'AOCURRR0'             99                 CLE031
     C                     PARM '*MSG    '@RTCD   7                       CLE031
     C                     PARM '*KEY    '@OPTN   7                       CLE031
     C                     PARM CCYSV     CURKEY  3                       CLE031
     C           SDCURR    PARM SDCURR    DSSDY                           CLE031
      *                                                                   CLE031
     C           @RTCD     IFNE *BLANKS                                   CLE031
     C                     SETON                     U7U8LR               CLE031
     C                     Z-ADD22        DBASE                           CLE031
     C                     MOVE 'SDCURRPD'DBFILE                          CLE031
     C                     MOVELCCYSV     DBKEY                           CLE031
     C                     ENDIF                                          CLE031
      *                                                                   CLE031
     C                     MOVE A6INCY    LCCYIN                          CLE031
     C                     Z-ADDA6NBDP    LCCYDP  10                      CLE031
      *                                                                   CLE031
     C                     SELEC                                          CLE031
     C           CEU004    WHEQ 'Y'                                       CLE031
     C           SCCY      ANDNE*BLANKS                                   CLE031
     C           SCCY      ANDNECCYSV                                     CLE031
     C                     MOVE SCCY      CURKEY                          CLE031
     C           CLE031    WHEQ 'Y'                                       CLE031
     C           CURREN    ANDNECCYSV                                     CLE031
     C           CURREN    ANDNE*BLANKS                                   CLE031
     C                     MOVE CURREN    CURKEY                          CLE031
     C                     ENDSL                                          CLE031
      *                                                                   CLE031
     C                     CALL 'AOCURRR0'             99                 CLE031
     C                     PARM '*MSG    '@RTCD   7                       CLE031
     C                     PARM '*KEY    '@OPTN   7                       CLE031
     C                     PARM           CURKEY  3                       CLE031
     C           SDCURR    PARM SDCURR    DSSDY                           CLE031
      *                                                                   CLE031
     C           @RTCD     IFNE *BLANKS                                   CLE031
     C                     SETON                     U7U8LR               CLE031
     C                     Z-ADD23        DBASE                           CLE031
     C                     MOVE 'SDCURRPD'DBFILE                          CLE031
     C                     MOVELCURKEY    DBKEY                           CLE031
     C                     ENDIF                                          CLE031
      *                                                                   CLE031
     C                     MOVE A6INCY    SCCYIN                          CLE031
     C                     Z-ADDA6NBDP    SCCYDP  10                      CLE031
      *                                                                   CLE031
     C           LCCYIN    IFEQ 'Y'                                       CLE031
     C           SCCYIN    OREQ 'Y'                                       CLE031
      *                                                                   CEU004
     C***********          MOVE EAMT      P@FRAM     -Set Amnt ParmCEU004 148104
     C                     Z-ADDEAMT      P@FRAM            -Set Amnt Parm148104
     C***********          MOVE CCY       P@FRCY            -Set F CEU004 135378
     C                     MOVE CCYSV     P@FRCY            -Set FrCcy Prm135378
     C*********************MOVE SCCY      P@TOCY      -Set ToCcy PrmCEU004CLE031
     C                     MOVE CURKEY    P@TOCY                          CLE031
      *                                                                   CEU004
     C                     EXSR XCAMT                        Cvrt Amount  CEU004
     C                     MOVE P@OUTA    EAMT               Set Cvrt Amt CEU004
     C                     ELSE                                           CLE031
      *                                                                   CLE031
     C                     Z-ADDEAMT      ZAMTCI                          CLE031
     C                     Z-ADDWEXR      ZEXCH                           CLE031
     C                     MOVE WEXI      ZMD                             CLE031
     C                     MOVE CCYSV     ZCCYI                           CLE031
     C                     MOVE CURKEY    ZCCYO                           CLE031
     C                     Z-ADDLCCYDP    ZCDPI                           CLE031
     C                     Z-ADDSCCYDP    ZCDPO                           CLE031
      *                                                                   CLE031
     C                     CALL 'ZCONVZ1'                                 CLE031
     C                     PARM           ZAMTCI 150                      CLE031
     C                     PARM           ZEXCH  138                      CLE031
     C                     PARM           ZMD     1                       CLE031
     C                     PARM           ZCCYI   3                       CLE031
     C                     PARM           ZCCYO   3                       CLE031
     C                     PARM           ZCDPI   10                      CLE031
     C                     PARM           ZCDPO   10                      CLE031
     C                     PARM           ZAMTCO 150                      CLE031
      *                                                                   CLE031
     C                     Z-ADDZAMTCO    EAMT                            CLE031
      *                                                                   CLE031
     C                     ENDIF                                          CLE031
     C                     ENDIF                            End If        CEU004
      *                                                                   CEU004
      ** For Payments, populate the other amount/currency fields          CEU004
      ** according to whether the 'In' Ccy is equal to the transaction ccyCEU004
      *                                                                   CEU004
     C           PAYREC    IFEQ 'P'                         If a Payment  CEU004
      *                                                                   CEU004
     C           ICCY      IFNE *BLANKS                      If InCcy # BlCEU004
      *                                                                   CEU004
     C           ICCY      IFEQ CCYSV                         If Ccys # EqCEU004
      *                                                                   CEU004
     C                     MOVE CCYSV     OTCY                 Set OthCcy CEU004
     C                     MOVE AMTSV     OTAM                 Set OthAmt CEU004
      *                                                                   CEU004
     C                     ELSE                               Else If     CEU004
      *                                                                   CEU004
     C***********          MOVE AMTSV     P@FRAM       -Set Amt Pm CEU004 148104
     C                     Z-ADDAMTSV     P@FRAM              -Set Amt Pm 148104
     C                     MOVE CCYSV     P@FRCY              -Set FCy Pm CEU004
     C                     MOVE ICCY      P@TOCY              -Set TCy Pm CEU004
      *                                                                   CEU004
     C                     EXSR XCAMT                          Cvrt AmountCEU004
     C                     MOVE P@OUTA    OTAM                 Set Cvt AmtCEU004
     C                     MOVE ICCY      OTCY                 Set Cvt CcyCEU004
      *                                                                   CEU004
     C                     ENDIF                              End If      CEU004
      *                                                                   CEU004
     C                     ENDIF                             End If       CEU004
      *                                                                   CEU004
     C                     ENDIF                            End If        CEU004
      *                                                                   CEU004
     C                     ENDIF                           End If         CEU004
      *                                                                   CEU004
     C                     ENDIF                                                              CLE038
      *                                                                                       CLE038
     C                     MOVE 'L'       RCDT
     C                     MOVE '  '      AMTPPH
     C   U4                MOVE 'ST'      AMTPPQ  2
     C                     Z-ADD0         LASNPH
     C           PAYREC    COMP 'R'                      42
     C   42                MOVE BLNK10    OTFACO
     C   42                MOVE BLNK90    OTSPI
     C  N42                MOVE FACO      OTFACO
     C  N42                MOVE SPI       OTSPI
     C*                                                                   S01518
     C** If Lending Swift feature is switched ON and settlement type is   S01518
     C** 01 or 08                                                         S01518
     C*                                                                   S01518
     C           *IN30     IFEQ '1'                                       S01518
     C           SETTLE    ANDEQ01                                        S01518
     C           *IN30     OREQ '1'                                       S01518
     C           SETTLE    ANDEQ08                                        S01518
     C*                                                                   S01518
     C** Set up ordering customer/bank for PF/LEPXTAB                     S01518
     C*                                                                   S01518
     C           PAYREC    IFNE 'R'                                       S01518
     C*                                                                   S01518
     C** If beneficiary is a bank, 'CNUMPH' is ordering bank, otherwise   S01518
     C** ordering customer                                                S01518
     C*                                                                   S01518
     C***********POBN      IFEQ 0                                         S01518              CSD027
     C           POBN      IFEQ *BLANKS                                                       CSD027
     C***********POCN      ANDEQ0                                         S01518              CSD027
     C           POCN      ANDEQ*BLANKS                                                       CSD027
     C                     MOVELCNUM      CNUMPH                          S01518
     C                     ELSE                                           S01518
     C***********          Z-ADDCNUM      LFCN                                         230521 CSD027
     C                     MOVE CNUM      LFCN                                                CSD027
     C***********POBN      IFNE 0                                         S01518              CSD027
     C           POBN      IFNE *BLANKS                                                       CSD027
     C                     MOVELPOBN      CNUMPH                          S01518
     C                     ELSE                                           S01518
     C                     MOVELPOCN      CNUMPH                          S01518
     C                     END                                            S01518
     C                     END                                            S01518
     C                     END                                            S01518
     C*                                                                   S01518
     C           PAYREC    IFEQ 'R'                                       S01518
     C*                                                                   S01518
     C** If beneficiary is a bank, 'CNUMPH' is ordering bank, otherwise   S01518
     C** ordering customer                                                S01518
     C*                                                                   S01518
     C***********ROBN      IFEQ 0                                         S01518              CSD027
     C           ROBN      IFEQ *BLANKS                                                       CSD027
     C***********ROCN      ANDEQ0                                         S01518              CSD027
     C           ROCN      ANDEQ*BLANKS                                                       CSD027
     C                     MOVELCNUM      CNUMPH                          S01518
     C                     ELSE                                           S01518
     C***********          Z-ADDCNUM      LFCN                                         230521 CSD027
     C                     MOVE CNUM      LFCN                                                CSD027
     C***********ROBN      IFNE 0                                         S01518              CSD027
     C           ROBN      IFNE *BLANKS                                                       CSD027
     C                     MOVELROBN      CNUMPH                          S01518
     C                     ELSE                                           S01518
     C                     MOVELROCN      CNUMPH                          S01518
     C                     END                                            S01518
     C                     END                                            S01518
     C                     END                                            S01518
     C*                                                                   S01518
     C** If MT202 part of MT100 / supplementary MT202 message being       S01518
     C** produced, set up details as below                                S01518
     C*                                                                   S01518
     C           CVMI      IFEQ 'P'                                       S01518
     C           CVMR      ANDEQ'Y'                                       S01518
     C           PAYREC    ANDNE'R'                                       S01518
     C                     MOVE *BLANKS   OTFACO                          S01518
     C                     MOVE *BLANKS   THRAG                           S01518
     C                     MOVELRVNO      OTFACO                          S01518
     C                     MOVELRCRN      THRAG                           S01518
     C                     MOVE *BLANKS   OURAG                           S01518
     C                     MOVELPONS      OURAG                           S01518
     C                     MOVE 'S'       CVMI                            S01518
     C                     END                                            S01518
     C*                                                                   S01518
     C** If MT100 part of MT100 / supplementary MT202 message being       S01518
     C** produced, set up details as below                                S01518
     C*                                                                   S01518
     C           CVMI      IFEQ ' '                                       S01518
     C           CVMR      ANDEQ'Y'                                       S01518
     C           PAYREC    ANDNE'R'                                       S01518
     C                     MOVE *BLANKS   OURAG                           S01518
     C                     MOVELRVNO      OURAG                           S01518
     C                     MOVE 'P'       CVMI                            S01518
     C                     END                                            S01518
     C*                                                                   S01518
     C                     END                                            S01518
     C**
     C**   SET UP FIELDS FOR LOAN AMENDMENTS
     C           ELSE01    TAG                             ** ELSE01 TAG**
     C  N49                GOTO ENDO
     C                     Z-ADDVDATDK    VDATPH
     C***********          Z-ADDCNUMDK    CNUMPH                                              CSD027
     C                     MOVE CNUMDK    CNUMPH                                              CSD027
     C**********           Z-ADDLNRFDK    LNRFPH                                              CLE148
     C                     MOVELLNRFDK    LNRFPH                                              CLE148
     C                     Z-ADDTAMTDK    EAMT
      *                                                                                       CLE038
     C           CLE038    IFEQ 'Y'                                                           CLE038
     C           CLE031    ANDEQ'Y'                                                           CLE038
     C           WKPROC    ANDEQ'Y'                                                           CLE038
     C           WPYREC    ANDEQ'P'                                                           CLE038
     C           PYBASA    ANDEQ'A'                                                           CLE038
     C           CLE038    OREQ 'Y'                                                           CLE038
     C           CLE031    ANDEQ'Y'                                                           CLE038
     C           WKPROC    ANDEQ'Y'                                                           CLE038
     C           WPYREC    ANDEQ'R'                                                           CLE038
     C           RCBASA    ANDEQ'A'                                                           CLE038
      *                                                                                       CLE038
     C                     EXSR SRCL38                                                        CLE038
      *                                                                                       CLE038
     C                     ELSE                                                               CLE038
      *                                                                   CEU004
      ** If feature CEU004 is on,                                         CEU004
      ** If the Settlement currency *NE transaction Ccy, convert amount   CEU004
      *                                                                   CEU004
     C           CEU004    IFEQ 'Y'                        If Feature On  CEU004
     C           CLE031    OREQ 'Y'                                       CLE031
      *                                                                   CEU004
     C***********          MOVE CCY       CCYSV   3         Set Cc CEU004 135378
     C***********          MOVE EAMT      AMTSV  130        Set Am CEU004 135378
      *                                                                   CEU004
     C***********SCCY      IFNE *BLANKS               If StCcy # BlkCEU004CLE031
     C***********SCCY      ANDNECCYDK                       And Cc CEU004 135378
     C           CEU004    IFEQ 'Y'                                       CLE031
     C           SCCY      ANDNE*BLANKS                                   CLE031
     C           SCCY      ANDNECCYSV                       And Ccys # Eql135378
     C           CLE031    OREQ 'Y'                                       CLE031
     C           CURREN    ANDNECCYSV                                     CLE031
     C           CURREN    ANDNE*BLANKS                                   CLE031
     C           SCCY      ANDNE*BLANKS                                   CLE031
     C           CLE031    OREQ 'Y'                                       CLE031
     C           CURREN    ANDNECCYSV                                     CLE031
     C           CURREN    ANDNE*BLANKS                                   CLE031
     C           PSCYDK    ANDNE*BLANKS                                   CLE031
      *                                                                   CLE031
     C                     CALL 'AOCURRR0'             99                 CLE031
     C                     PARM '*MSG    '@RTCD   7                       CLE031
     C                     PARM '*KEY    '@OPTN   7                       CLE031
     C                     PARM CCYSV     CURKEY  3                       CLE031
     C           SDCURR    PARM SDCURR    DSSDY                           CLE031
      *                                                                   CLE031
     C           @RTCD     IFNE *BLANKS                                   CLE031
     C                     SETON                     U7U8LR               CLE031
     C                     Z-ADD25        DBASE                           CLE031
     C                     MOVE 'SDCURRPD'DBFILE                          CLE031
     C                     MOVELCCYSV     DBKEY                           CLE031
     C                     ENDIF                                          CLE031
      *                                                                   CLE031
     C                     MOVE A6INCY    LCCYIN                          CLE031
     C                     Z-ADDA6NBDP    LCCYDP  10                      CLE031
      *                                                                   CLE031
     C                     SELEC                                          CLE031
     C           CEU004    WHEQ 'Y'                                       CLE031
     C           SCCY      ANDNE*BLANKS                                   CLE031
     C           SCCY      ANDNECCYSV                                     CLE031
     C                     MOVE SCCY      CURKEY                          CLE031
     C           CLE031    WHEQ 'Y'                                       CLE031
     C           CURREN    ANDNECCYSV                                     CLE031
     C           CURREN    ANDNE*BLANKS                                   CLE031
     C                     MOVE CURREN    CURKEY                          CLE031
     C                     ENDSL                                          CLE031
      *                                                                   CLE031
     C                     CALL 'AOCURRR0'             99                 CLE031
     C                     PARM '*MSG    '@RTCD   7                       CLE031
     C                     PARM '*KEY    '@OPTN   7                       CLE031
     C                     PARM           CURKEY  3                       CLE031
     C           SDCURR    PARM SDCURR    DSSDY                           CLE031
      *                                                                   CLE031
     C           @RTCD     IFNE *BLANKS                                   CLE031
     C                     SETON                     U7U8LR               CLE031
     C                     Z-ADD26        DBASE                           CLE031
     C                     MOVE 'SDCURRPD'DBFILE                          CLE031
     C                     MOVELCURKEY    DBKEY                           CLE031
     C                     ENDIF                                          CLE031
      *                                                                   CLE031
     C                     MOVE A6INCY    SCCYIN                          CLE031
     C                     Z-ADDA6NBDP    SCCYDP  10                      CLE031
      *                                                                   CLE031
     C           LCCYIN    IFEQ 'Y'                                       CLE031
     C           SCCYIN    OREQ 'Y'                                       CLE031
      *                                                                   CEU004
     C***********          MOVE EAMT      P@FRAM     -Set Amnt ParmCEU004 148104
     C                     Z-ADDEAMT      P@FRAM            -Set Amnt Parm148104
     C***********          MOVE CCYDK     P@FRCY            -Set F CEU004 135378
     C                     MOVE CCYSV     P@FRCY            -Set FrCcy Prm135378
     C******************   MOVE SCCY      P@TOCY      -Set ToCcy PrmCEU004CLE031
     C                     MOVE CURKEY    P@TOCY                          CLE031
      *                                                                   CEU004
     C                     EXSR XCAMT                        Cvrt Amount  CEU004
     C                     MOVE P@OUTA    EAMT               Set Cvrt Amt CEU004
     C                     ELSE                                           CLE031
      *                                                                   CLE031
     C                     Z-ADDEAMT      ZAMTCI                          CLE031
     C                     Z-ADDWEXR      ZEXCH                           CLE031
     C                     MOVE WEXI      ZMD                             CLE031
     C                     MOVE CCYSV     ZCCYI                           CLE031
     C                     MOVE CURKEY    ZCCYO                           CLE031
     C                     Z-ADDLCCYDP    ZCDPI                           CLE031
     C                     Z-ADDSCCYDP    ZCDPO                           CLE031
      *                                                                   CLE031
     C                     CALL 'ZCONVZ1'                                 CLE031
     C                     PARM           ZAMTCI 150                      CLE031
     C                     PARM           ZEXCH  138                      CLE031
     C                     PARM           ZMD     1                       CLE031
     C                     PARM           ZCCYI   3                       CLE031
     C                     PARM           ZCCYO   3                       CLE031
     C                     PARM           ZCDPI   10                      CLE031
     C                     PARM           ZCDPO   10                      CLE031
     C                     PARM           ZAMTCO 150                      CLE031
      *                                                                   CLE031
     C                     Z-ADDZAMTCO    EAMT                            CLE031
      *                                                                   CLE031
     C                     ENDIF                                          CLE031
     C                     ENDIF                            End If        CEU004
      *                                                                   CEU004
      ** For Payments, populate the other amount/currency fields          CEU004
      ** according to whether the 'In' Ccy is equal to the transaction ccyCEU004
      *                                                                   CEU004
     C           PAYREC    IFEQ 'P'                         If a Payment  CEU004
      *                                                                   CEU004
     C           ICCY      IFNE *BLANKS                      If InCcy # BlCEU004
      *                                                                   CEU004
     C           ICCY      IFEQ CCYSV                         If Ccys # EqCEU004
      *                                                                   CEU004
     C                     MOVE CCYSV     OTCY                 Set OthCcy CEU004
     C                     MOVE AMTSV     OTAM                 Set OthAmt CEU004
      *                                                                   CEU004
     C                     ELSE                               Else If     CEU004
      *                                                                   CEU004
     C***********          MOVE AMTSV     P@FRAM       -Set Amt Pm CEU004 148104
     C                     Z-ADDAMTSV     P@FRAM              -Set Amt Pm 148104
     C                     MOVE CCYSV     P@FRCY              -Set FCy Pm CEU004
     C                     MOVE ICCY      P@TOCY              -Set TCy Pm CEU004
      *                                                                   CEU004
     C                     EXSR XCAMT                          Cvrt AmountCEU004
     C                     MOVE P@OUTA    OTAM                 Set Cvt AmtCEU004
     C                     MOVE ICCY      OTCY                 Set Cvt CcyCEU004
      *                                                                   CEU004
     C                     ENDIF                              End If      CEU004
      *                                                                   CEU004
     C                     ENDIF                             End If       CEU004
      *                                                                   CEU004
     C                     ENDIF                            End If        CEU004
      *                                                                   CEU004
     C                     ENDIF                           End If         CEU004
      *                                                                   CEU004
     C                     ENDIF                                                              CLE038
      *                                                                                       CLE038
     C                     MOVE 'A'       RCDT
     C                     MOVE AMTPDK    AMTPPH
     C                     Z-ADDLASNDK    LASNPH
     C           PAYREC    COMP 'R'                      42
     C   42                MOVE BLNK10    OTFACO
     C   42                MOVE BLNK90    OTSPI
     C  N42                MOVE FACODK    OTFACO
     C  N42                MOVE SPIDK     OTSPI
     C                     MOVE LTYPDK    LTYP
     C                     MOVE SUTPDK    SUTP
     C                     MOVE CLASDK    CLAS                                                CLE042
     C                     MOVE PTYPDK    PTYP
     C***********          MOVE BRCDDK    BRCD                            S01117
     C                     MOVE BRCDDK    BRCA                            S01117
     C*                                                                   S01518
     C** If Lending Swift feature is switched ON and settlement type is   S01518
     C** 01 or 08                                                         S01518
     C*                                                                   S01518
     C           *IN30     IFEQ '1'                                       S01518
     C           SETTLE    ANDEQ01                                        S01518
     C           *IN30     OREQ '1'                                       S01518
     C           SETTLE    ANDEQ08                                        S01518
     C*                                                                   S01518
     C** Set up ordering customer/bank for PF/LEPXTAB                     S01518
     C*                                                                   S01518
     C           PAYREC    IFNE 'R'                                       S01518
     C*                                                                   S01518
     C** If beneficiary is a bank, 'CNUMPH' is ordering bank, otherwise   S01518
     C** ordering customer                                                S01518
     C*                                                                   S01518
     C***********POBNDK    IFEQ 0                                         S01518              CSD027
     C           POBNDK    IFEQ *BLANKS                                                       CSD027
     C***********POCNDK    ANDEQ0                                         S01518              CSD027
     C           POCNDK    ANDEQ*BLANKS                                                       CSD027
     C                     MOVELCNUMDK    CNUMPH                          S01518
     C                     ELSE                                           S01518
     C***********          Z-ADDCNUMDK    LFCN                                         230521 CSD027
     C                     MOVE CNUMDK    LFCN                                                CSD027
     C***********POBNDK    IFNE 0                                         S01518              CSD027
     C           POBNDK    IFNE *BLANKS                                                       CSD027
     C                     MOVELPOBNDK    CNUMPH                          S01518
     C                     ELSE                                           S01518
     C                     MOVELPOCNDK    CNUMPH                          S01518
     C                     END                                            S01518
     C                     END                                            S01518
     C                     END                                            S01518
     C*                                                                   S01518
     C           PAYREC    IFEQ 'R'                                       S01518
     C*                                                                   S01518
     C** If beneficiary is a bank, 'CNUMPH' is ordering bank, otherwise   S01518
     C** ordering customer                                                S01518
     C*                                                                   S01518
     C***********ROBNDK    IFEQ 0                                         S01518              CSD027
     C           ROBNDK    IFEQ *BLANKS                                                       CSD027
     C***********ROCNDK    ANDEQ0                                         S01518              CSD027
     C           ROCNDK    ANDEQ*BLANKS                                                       CSD027
     C                     MOVELCNUMDK    CNUMPH                          S01518
     C                     ELSE                                           S01518
     C***********          Z-ADDCNUMDK    LFCN                                         230521 CSD027
     C                     MOVE CNUMDK    LFCN                                                CSD027
     C***********ROBNDK    IFNE 0                                         S01518              CSD027
     C           ROBNDK    IFNE *BLANKS                                                       CSD027
     C                     MOVELROBNDK    CNUMPH                          S01518
     C                     ELSE                                           S01518
     C                     MOVELROCNDK    CNUMPH                          S01518
     C                     END                                            S01518
     C                     END                                            S01518
     C                     END                                            S01518
     C*                                                                   S01518
     C** If MT202 part of MT100 / supplementary MT202 message being       S01518
     C** produced, set up details as below                                S01518
     C*                                                                   S01518
     C           CVMI      IFEQ 'P'                                       S01518
     C           CVMRDK    ANDEQ'Y'                                       S01518
     C           PAYREC    ANDNE'R'                                       S01518
     C                     MOVE *BLANKS   OTFACO                          S01518
     C                     MOVE *BLANKS   THRAG                           S01518
     C                     MOVELRVNODK    OTFACO                          S01518
     C                     MOVELRCRNDK    THRAG                           S01518
     C                     MOVE *BLANKS   OURAG                           S01518
     C                     MOVELPONSDK    OURAG                           S01518
     C                     MOVE 'S'       CVMI                            S01518
     C                     END                                            S01518
     C*                                                                   S01518
     C** If MT100 part of MT100 / supplementary MT202 message being       S01518
     C** produced, set up details as below                                S01518
     C*                                                                   S01518
     C           CVMI      IFEQ ' '                                       S01518
     C           CVMRDK    ANDEQ'Y'                                       S01518
     C           PAYREC    ANDNE'R'                                       S01518
     C                     MOVE *BLANKS   OURAG                           S01518
     C                     MOVELRVNODK    OURAG                           S01518
     C                     MOVE 'P'       CVMI                            S01518
     C                     END                                            S01518
     C*                                                                   S01518
     C                     END                                            S01518
     C**
     C**   COMMON PROCESSING
     C           ENDO      TAG                             ** ENDO TAG  **
     C                     MOVE '1000'    PINDS
      *                                                                   128093
      * If processing loan maturity pay/rec set up pay/rec inds           128093
      * accordingly                                                       128093
     C           *IN48     IFEQ '1'                                       128093
     C           VORM      ANDEQ'M'                                       128093
     C                     MOVE '0100'    PINDS                           128093
     C                     ENDIF                                          128093
      *                                                                   128093
     C   45                Z-ADD1         TINDPH
     C   47                Z-ADD2         TINDPH
     C   46                Z-ADD3         TINDPH
     C                     MOVE 'N'       INTCPH
     C**
     C*****DEFAULT*BRANCH*BLANK,USE*BRANCH*ON*CLOAN/LOAMS*TO ACCESS TABLE S01194
     C*    DEFAULT BRANCH BLANK,USE BRANCH ON CLOAN/LOAMS TO ACCESS A/O   S01194
     C***44*48****         MOVE BRCD      BRKEY                           S01117
     C***44*49**           MOVE BRCDDK    BRKEY                           S01194
     C***44***** BRKEY     CHAINTABLE                41                   S01194
     C           *IN44     IFEQ '1'                                       S01194
     C      48             MOVE BRCA      BRCKEY                          S01194
     C      49             MOVE BRCDDK    BRCKEY                          S01194
     C**********           CALL 'AOBRCHR0'PLIST1                                       S01194 CGL029
     C                     CALL 'AOBRCHR1'PLIST1                                              CGL029
     C           @RTCD     IFNE *BLANKS                                   S01194
     C                     SETON                     LRU7U8               S01194
     C                     SETON                     41                   S01194
     C                     Z-ADD11        DBASE                        ** S01194
     C                     MOVELBRCKEY    DBKEY            ** DBASE 11 ** S01194
     C                     MOVEL'SDBRCHPD'DBFILE                       ** S01194
     C                     END                                            S01194
     C                     MOVE A8BICN    BICN                            S01194
     C*                                                                   S01194
     C                     END                                            S01194
     C***41*****           SETON                     LRU7U8               S01194
     C***41*****           MOVE '11'      DBASE            ** DBASE 11 ** S01194
     C***41*****           MOVE 'TABLE'   DBFILE                          S01194
     C***41*****           MOVELBRKEY     DBKEY                           S01194
     C  N44
     CORN41                SETON                     34
     C   34                EXCPT
     C*
     C                     ENDSR
      *****************************************************************                       CLE034
      *                                                               *                       CLE034
      *  SR34A - Initial set-up for CLE034 processing                 *                       CLE034
      *                                                               *                       CLE034
      *****************************************************************                       CLE034
     C           SR34A     BEGSR                                                              CLE034
      *                                                                                       CLE034
     C                     Z-ADD*ZERO     WTOTAL                                              CLE034
     C                     Z-ADD*ZERO     WKAMNT                                              CLE034
     C                     MOVE *BLANK    WFIELD                                              CLE034
      *                                                                                       CLE034
     C           RCDT      IFEQ 'A'                                                           CLE034
     C                     Z-ADDSETPDK    WSETPK  20                                          227719
     C                     MOVE OSACDK    WOSACK 12                                           227719
     C**********           MOVE PONSDK    WPONSK 12                                    CLE034 CGL029
     C                     MOVE PONSDK    WPONSK 18                                           CGL029
     C                     Z-ADDPSTMDK    WPSTMK  20                                          CLE034
     C                     Z-ADDRSTMDK    WRSTMK  20                                          CLE034
     C**********           MOVE RONSDK    WRONSK 12                                    CLE034 CGL029
     C                     MOVE RONSDK    WRONSK 18                                           CGL029
     C                     MOVE @OSBR     W@OSBR  3                                           CLE034
     C                     MOVE SCCY      WSCCY   3                                           CLE034
     C                     Z-ADDREXRDK    WREXRK 138                                          CLE034
     C                     MOVE REXIDK    WREXIK  1                                           CLE034
     C***********          Z-ADDROBNDK    WROBNK  60                                   CLE034 CSD027
     C                     MOVE ROBNDK    WROBNK  6                                           CSD027
     C***********          Z-ADDROCNDK    WROCNK  60                                   CLE034 CSD027
     C                     MOVE ROCNDK    WROCNK  6                                           CSD027
     C                     MOVE RIBNDK    WRIBNK  8                                           CLE034
     C                     MOVE RIBADK    WRIBAK 35                                           CLE034
     C                     MOVE PSCYDK    WPSCYK  3                                           CLE034
     C                     Z-ADDPEXRDK    WPEXRK 138                                          CLE034
     C                     MOVE PEXIDK    WPEXIK  1                                           CLE034
     C***********          Z-ADDPOBNDK    WPOBNK  60                                   CLE034 CSD027
     C                     MOVE POBNDK    WPOBNK  6                                           CSD027
     C***********          Z-ADDPOCNDK    WPOCNK  60                                   CLE034 CSD027
     C                     MOVE POCNDK    WPOCNK  6                                           CSD027
     C                     MOVE PIBNDK    WPIBNK  8                                           CLE034
     C                     MOVE PIBADK    WPIBAK 35                                           CLE034
     C                     MOVE RVNODK    WRVNOK  8                                           CLE034
     C                     MOVE CVMRDK    WCVMRK  1                                           CLE034
     C                     MOVE RCRNDK    WRCRNK  8                                           CLE034
     C                     MOVE RCRADK    WRCRAK 35                                           CLE034
     C                     MOVEL'LA'      PTYPE   4                                           CLE034
     C                     MOVE AMTPDK    PTYPE                                               CLE034
     C                     MOVE LNRFDK    PLNRF                                               CLE034
     C                     MOVE VDATDK    PVDAT                                               CLE034
     C                     MOVE LASNDK    PLASN                                               CLE034
      *                                                                                       CLE034
     C                     CALL 'AOSTALR2'                                                    CLE034
     C                     PARM *BLANKS   PRTCD   7                                           CLE034
     C                     PARM '*FIRST ' POPTN   7                                           CLE034
     C                     PARM           PTYPE                                               CLE034
     C                     PARM           PLNRF   6                                           CLE034
     C                     PARM           PVDAT   5                                           CLE034
     C                     PARM           PLASN   3                                           CLE034
     C                     PARM *BLANKS   PCNUM   6                                           CLE034
     C                     PARM *BLANKS   PFACL   5                                           CLE034
     C                     PARM *BLANKS   PFESQ   2                                           CLE034
     C                     PARM WPYREC    PPYREC  1                                           CLE034
     C           LESTAL    PARM LESTAL    DSSDY                                               CLE034
      *                                                                                       CLE034
     C                     ELSE                                                               CLE034
      *                                                                                       CLE034
     C**********           MOVE PONS      WPONS  12                                    CLE034 CGL029
     C                     MOVE PONS      WPONS  18                                           CGL029
     C                     Z-ADDPSTM      WPSTM   20                                          CLE034
     C                     Z-ADDRSTM      WRSTM   20                                          CLE034
     C**********           MOVE RONS      WRONS  12                                    CLE034 CGL029
     C                     MOVE RONS      WRONS  18                                           CGL029
     C                     MOVE @OSBR     W@OSBR  3                                           CLE034
     C                     MOVE SCCY      WSCCY   3                                           CLE034
     C                     Z-ADDREXR      WREXR  138                                          CLE034
     C                     MOVE REXI      WREXI   1                                           CLE034
     C***********          Z-ADDROBN      WROBN   60                                   CLE034 CSD027
     C                     MOVE ROBN      WROBN   6                                           CSD027
     C***********          Z-ADDROCN      WROCN   60                                   CLE034 CSD027
     C                     MOVE ROCN      WROCN   6                                           CSD027
     C                     MOVE RIBN      WRIBN   8                                           CLE034
     C                     MOVE RIBA      WRIBA  35                                           CLE034
     C                     MOVE PSCY      WPSCY   3                                           CLE034
     C                     Z-ADDPEXR      WPEXR  138                                          CLE034
     C                     MOVE PEXI      WPEXI   1                                           CLE034
     C***********          Z-ADDPOBN      WPOBN   60                                   CLE034 CSD027
     C                     MOVE POBN      WPOBN   6                                           CSD027
     C***********          Z-ADDPOCN      WPOCN   60                                   CLE034 CSD027
     C                     MOVE POCN      WPOCN   6                                           CSD027
     C                     MOVE PIBN      WPIBN   8                                           CLE034
     C                     MOVE PIBA      WPIBA  35                                           CLE034
     C                     MOVE RVNO      WRVNO   8                                           CLE034
     C                     MOVE CVMR      WCVMR   1                                           CLE034
     C                     MOVE RCRN      WRCRN   8                                           CLE034
     C                     MOVE RCRA      WRCRA  35                                           CLE034
     C                     MOVE LNRF      PLNRF                                               CLE034
      *                                                                                       CLE034
     C                     CALL 'AOSTALR2'                                                    CLE034
     C                     PARM *BLANKS   PRTCD                                               CLE034
     C                     PARM '*FIRST ' POPTN                                               CLE034
     C                     PARM 'LOAN'    PTYPE                                               CLE034
     C                     PARM           PLNRF                                               CLE034
     C                     PARM *BLANKS   PVDAT                                               CLE034
     C                     PARM *BLANKS   PLASN                                               CLE034
     C                     PARM *BLANKS   PCNUM                                               CLE034
     C                     PARM *BLANKS   PFACL                                               CLE034
     C                     PARM *BLANKS   PFESQ                                               CLE034
     C                     PARM WPYREC    PPYREC                                              CLE034
     C           LESTAL    PARM LESTAL    DSSDY                                               CLE034
     C                     ENDIF                                                              CLE034
      *                                                                                       CLE034
     C           PRTCD     IFNE *BLANKS                                                       CLE034
     C                     MOVEL'LESTALPD'DBFILE                                              CLE034
     C                     MOVEL'*FIRST  'DBKEY                                               CLE034
     C                     Z-ADD28        DBASE                                               CLE034
     C                     SETON                     U7U8LR                                   CLE034
     C                     EXSR *PSSR                                                         CLE034
     C                     ENDIF                                                              CLE034
      *                                                                                       CLE034
     C                     ENDSR                                                              CLE034
      *****************************************************************                       CLE034
      *                                                               *                       CLE034
      *  SR34B - Processing to calculate amount for settlement        *                       CLE034
      *          allocation                                           *                       CLE034
      *                                                               *                       CLE034
      *****************************************************************                       CLE034
     C           SR34B     BEGSR                                                              CLE034
      *                                                                                       CLE034
     C                     Z-ADDEAMT      WSAMNT 130                                          CLE034
      *                                                                                       CLE034
     C           WPYREC    IFEQ 'P'                                                           CLE034
     C           PYPCSA    DIV  100       WPYPC  119H                                         CLE034
     C           WSAMNT    MULT WPYPC     WKAMNT 249                                          CLE034
     C                     ELSE                                                               CLE034
     C           RCPCSA    DIV  100       WRCPC  119H                                         CLE034
     C           WSAMNT    MULT WRCPC     WKAMNT                                              CLE034
     C                     ENDIF                                                              CLE034
      *                                                                                       CLE034
     C                     ADD  WKAMNT    WTOTAL 249                                          CLE034
      *                                                                                       CLE034
     C           WFIELD    IFEQ 'Y'                                                           CLE034
     C           WTOTAL    ANDNEWSAMNT                                                        CLE034
     C           WSAMNT    SUB  WTOTAL    WDIFF  139                                          CLE034
     C                     ADD  WDIFF     WKAMNT                                              CLE034
     C                     ENDIF                                                              CLE034
      *                                                                                       CLE034
     C                     Z-ADDWKAMNT    EAMT                                                CLE034
     C                     EXSR SR34D                                                         CLE034
      *                                                                                       CLE034
     C                     ENDSR                                                              CLE034
      *****************************************************************                       CLE034
      *                                                               *                       CLE034
      *  SR34C - Processing to get next settlement allocation         *                       CLE034
      *                                                               *                       CLE034
      *****************************************************************                       CLE034
     C           SR34C     BEGSR                                                              CLE034
      *                                                                                       CLE034
     C           WFIELD    IFEQ 'Y'                                                           CLE034
     C                     MOVE *BLANK    WFIELD                                              CLE034
     C                     ELSE                                                               CLE034
      *                                                                                       CLE034
     C           RCDT      IFEQ 'A'                                                           CLE034
     C                     MOVEL'LA'      PTYPE   4                                           CLE034
     C                     MOVE AMTPDK    PTYPE                                               CLE034
     C                     MOVE LNRFDK    PLNRF                                               CLE034
     C                     MOVE VDATDK    PVDAT                                               CLE034
     C                     MOVE LASNDK    PLASN                                               CLE034
      *                                                                                       CLE034
     C                     CALL 'AOSTALR2'                                                    CLE034
     C                     PARM *BLANKS   PRTCD                                               CLE034
     C                     PARM '*NEXT  ' POPTN                                               CLE034
     C                     PARM           PTYPE                                               CLE034
     C                     PARM           PLNRF                                               CLE034
     C                     PARM           PVDAT                                               CLE034
     C                     PARM           PLASN                                               CLE034
     C                     PARM *BLANKS   PCNUM                                               CLE034
     C                     PARM *BLANKS   PFACL                                               CLE034
     C                     PARM *BLANKS   PFESQ                                               CLE034
     C                     PARM WPYREC    PPYREC                                              CLE034
     C           LESTAL    PARM LESTAL    DSSDY                                               CLE034
      *                                                                                       CLE034
     C                     ELSE                                                               CLE034
     C                     MOVE LNRF      PLNRF                                               CLE034
      *                                                                                       CLE034
     C                     CALL 'AOSTALR2'                                                    CLE034
     C                     PARM *BLANKS   PRTCD                                               CLE034
     C                     PARM '*NEXT  ' POPTN                                               CLE034
     C                     PARM 'LOAN'    PTYPE                                               CLE034
     C                     PARM           PLNRF                                               CLE034
     C                     PARM *BLANKS   PVDAT                                               CLE034
     C                     PARM *BLANKS   PLASN                                               CLE034
     C                     PARM *BLANKS   PCNUM                                               CLE034
     C                     PARM *BLANKS   PFACL                                               CLE034
     C                     PARM *BLANKS   PFESQ                                               CLE034
     C                     PARM WPYREC    PPYREC                                              CLE034
     C           LESTAL    PARM LESTAL    DSSDY                                               CLE034
     C                     ENDIF                                                              CLE034
      *                                                                                       CLE034
     C           PRTCD     IFEQ '*EOF   '                                                     CLE034
     C                     MOVE 'Y'       WFIELD                                              CLE034
     C                     ENDIF                                                              CLE034
      *                                                                                       CLE034
     C                     ENDIF                                                              CLE034
      *                                                                                       CLE034
     C                     ENDSR                                                              CLE034
      *****************************************************************                       CLE034
      *                                                               *                       CLE034
      *  SR34D - Set up fields from settlement allocation             *                       CLE034
      *                                                               *                       CLE034
      *****************************************************************                       CLE034
     C           SR34D     BEGSR                                                              CLE034
      *                                                                                       CLE034
     C           RCDT      IFEQ 'A'                                                           CLE034
      *                                                                                       CLE034
     C           WPYREC    IFEQ 'P'                                                           CLE034
     C                     MOVE PSTMSA    SETPDK                                              CLE034
     C                     MOVE PONSSA    OSACDK                                              227719
     C                     MOVE POBRSA    @OSBR                                               CLE034
     C**********           MOVE RSCYSA    SCCY                                         CLE034 227719
     C                     MOVE PSCYSA    SCCY                                                227719
     C                     ELSE                                                               CLE034
     C                     MOVE RSTMSA    SETPDK                                              CLE034
     C                     MOVE RONSSA    OSACDK                                              227719
     C                     MOVE ROBRSA    @OSBR                                               CLE034
     C**********           MOVE PSCYSA    SCCY                                         CLE034 227719
     C                     MOVE RSCYSA    SCCY                                                227719
     C                     ENDIF                                                              CLE034
      *                                                                                       CLE034
     C                     Z-ADDSETPDK    SETTLE                                              CLE034
     C                     MOVE OSACDK    OURAG                                               227719
     C                     MOVE PONSSA    PONSDK                                              CLE034
     C                     MOVE PSTMSA    PSTMDK                                              CLE034
     C                     MOVE RSTMSA    RSTMDK                                              CLE034
     C                     MOVE RONSSA    RONSDK                                              CLE034
     C                     Z-ADDREXRSA    REXRDK                                              CLE034
     C                     MOVE REXISA    REXIDK                                              CLE034
     C***********          Z-ADDROBNSA    ROBNDK                                       CLE034 CSD027
     C                     MOVE ROBNSA    ROBNDK                                              CSD027
     C***********          Z-ADDROCNSA    ROCNDK                                       CLE034 CSD027
     C                     MOVE ROCNSA    ROCNDK                                              CSD027
     C                     MOVE RIBNSA    RIBNDK                                              CLE034
     C                     MOVE RIBASA    RIBADK                                              CLE034
     C                     MOVE PSCYSA    PSCYDK                                              CLE034
     C                     Z-ADDPEXRSA    PEXRDK                                              CLE034
     C                     MOVE PEXISA    PEXIDK                                              CLE034
     C***********          Z-ADDPOBNSA    POBNDK                                       CLE034 CSD027
     C                     MOVE POBNSA    POBNDK                                              CSD027
     C***********          Z-ADDPOCNSA    POCNDK                                       CLE034 CSD027
     C                     MOVE POCNSA    POCNDK                                              CSD027
     C                     MOVE PIBNSA    PIBNDK                                              CLE034
     C                     MOVE PIBASA    PIBADK                                              CLE034
     C                     MOVE RVNOSA    RVNODK                                              CLE034
     C                     MOVE CVMRSA    CVMRDK                                              CLE034
     C                     MOVE RCRNSA    RCRNDK                                              CLE034
     C                     MOVE RCRASA    RCRADK                                              CLE034
      *                                                                                       CLE034
     C                     ELSE                                                               CLE034
      *                                                                                       CLE034
     C           WPYREC    IFEQ 'P'                                                           CLE034
     C                     MOVE POBRSA    @OSBR                                               CLE034
     C**********           MOVE PSCYSA    SCCY                                         CLE034 227719
     C                     ELSE                                                               CLE034
     C                     MOVE ROBRSA    @OSBR                                               CLE034
     C**********           MOVE RSCYSA    SCCY                                         CLE034 227719
     C                     ENDIF                                                              CLE034
      *                                                                                       CLE034
     C**********           Z-ADDSETPDK    SETTLE                                       CLE034 227719
     C**********           MOVE PONSSA    PONSDK                                       CLE034 227719
     C**********           MOVE PSTMSA    PSTMDK                                       CLE034 227719
     C**********           MOVE RSTMSA    RSTMDK                                       CLE034 227719
     C**********           MOVE RONSSA    RONSDK                                       CLE034 227719
     C**********           Z-ADDREXRSA    REXRDK                                       CLE034 227719
     C**********           MOVE REXISA    REXIDK                                       CLE034 227719
     C**********           Z-ADDROBNSA    ROBNDK                                       CLE034 227719
     C**********           Z-ADDROCNSA    ROCNDK                                       CLE034 227719
     C**********           MOVE RIBNSA    RIBNDK                                       CLE034 227719
     C**********           MOVE RIBASA    RIBADK                                       CLE034 227719
     C**********           MOVE PSCYSA    PSCYDK                                       CLE034 227719
     C**********           Z-ADDPEXRSA    PEXRDK                                       CLE034 227719
     C**********           MOVE PEXISA    PEXIDK                                       CLE034 227719
     C**********           Z-ADDPOBNSA    POBNDK                                       CLE034 227719
     C**********           Z-ADDPOCNSA    POCNDK                                       CLE034 227719
     C**********           MOVE PIBNSA    PIBNDK                                       CLE034 227719
     C**********           MOVE PIBASA    PIBADK                                       CLE034 227719
     C**********           MOVE RVNOSA    RVNODK                                       CLE034 227719
     C**********           MOVE CVMRSA    CVMRDK                                       CLE034 227719
     C**********           MOVE RCRNSA    RCRNDK                                       CLE034 227719
     C**********           MOVE RCRASA    RCRADK                                       CLE034 227719
     C                     MOVE PONSSA    PONS                                                227719
     C                     MOVE PSTMSA    PSTM                                                227719
     C                     MOVE RSTMSA    RSTM                                                227719
     C                     MOVE RONSSA    RONS                                                227719
     C                     Z-ADDREXRSA    REXR                                                227719
     C                     MOVE REXISA    REXI                                                227719
     C***********          Z-ADDROBNSA    ROBNDK                                       CLE034 CSD027
     C                     MOVE ROBNSA    ROBNDK                                              CSD027
     C***********          Z-ADDROCNSA    ROCNDK                                       CLE034 CSD027
     C                     MOVE ROCNSA    ROCNDK                                              CSD027
     C                     MOVE RIBNSA    RIBN                                                227719
     C                     MOVE RIBASA    RIBA                                                227719
     C                     MOVE PSCYSA    PSCY                                                227719
     C                     MOVE RSCYSA    SCCY                                                227719
     C                     Z-ADDPEXRSA    PEXR                                                227719
     C                     MOVE PEXISA    PEXI                                                227719
     C***********          Z-ADDPOBNSA    POBNDK                                       CLE034 CSD027
     C                     MOVE POBNSA    POBNDK                                              CSD027
     C***********          Z-ADDPOCNSA    POCNDK                                       CLE034 CSD027
     C                     MOVE POCNSA    POCNDK                                              CSD027
     C                     MOVE PIBNSA    PIBN                                                227719
     C                     MOVE PIBASA    PIBA                                                227719
     C                     MOVE RVNOSA    RVNO                                                227719
     C                     MOVE CVMRSA    CVMR                                                227719
     C                     MOVE RCRNSA    RCRN                                                227719
     C                     MOVE RCRASA    RCRA                                                227719
      *                                                                                       CLE034
     C                     ENDIF                                                              CLE034
      *                                                                                       CLE034
     C                     ENDSR                                                              CLE034
      *****************************************************************                       CLE034
      *                                                               *                       CLE034
      *  SR34E - Restore saved values                                 *                       CLE034
      *                                                               *                       CLE034
      *****************************************************************                       CLE034
     C           SR34E     BEGSR                                                              CLE034
      *                                                                                       CLE034
     C           RCDT      IFEQ 'A'                                                           CLE034
      *                                                                                       CLE034
     C                     Z-ADDWSETPK    SETPDK                                              227719
     C                     MOVE WOSACK    OSACDK                                              227719
     C                     MOVE WPONSK    PONSDK                                              CLE034
     C                     Z-ADDWPSTMK    PSTMDK                                              CLE034
     C                     Z-ADDWRSTMK    RSTMDK                                              CLE034
     C                     MOVE WRONSK    RONSDK                                              CLE034
     C                     MOVE W@OSBR    @OSBR                                               CLE034
     C                     MOVE WSCCY     SCCY                                                CLE034
     C                     Z-ADDWREXRK    REXRDK                                              CLE034
     C                     MOVE WREXIK    REXIDK                                              CLE034
     C***********          Z-ADDWROBNK    ROBNDK                                       CLE034 CSD027
     C                     MOVE WROBNK    ROBNDK                                              CSD027
     C***********          Z-ADDWROCNK    ROCNDK                                       CLE034 CSD027
     C                     MOVE WROCNK    ROCNDK                                              CSD027
     C                     MOVE WRIBNK    RIBNDK                                              CLE034
     C                     MOVE WRIBAK    RIBADK                                              CLE034
     C                     MOVE WPSCYK    PSCYDK                                              CLE034
     C                     Z-ADDWPEXRK    PEXRDK                                              CLE034
     C                     MOVE WPEXIK    PEXIDK                                              CLE034
     C***********          Z-ADDWPOBNK    POBNDK                                       CLE034 CSD027
     C                     MOVE WPOBNK    POBNDK                                              CSD027
     C***********          Z-ADDWPOCNK    POCNDK                                       CLE034 CSD027
     C                     MOVE WPOCNK    POCNDK                                              CSD027
     C                     MOVE WPIBNK    PIBNDK                                              CLE034
     C                     MOVE WPIBAK    PIBADK                                              CLE034
     C                     MOVE WRVNOK    RVNODK                                              CLE034
     C                     MOVE WCVMRK    CVMRDK                                              CLE034
     C                     MOVE WRCRNK    RCRNDK                                              CLE034
     C                     MOVE WRCRAK    RCRADK                                              CLE034
      *                                                                                       CLE034
     C                     ELSE                                                               CLE034
      *                                                                                       CLE034
     C                     MOVE WPONS     PONS                                                CLE034
     C                     Z-ADDWPSTM     PSTM                                                CLE034
     C                     Z-ADDWRSTM     RSTM                                                CLE034
     C                     MOVE WRONS     RONS                                                CLE034
     C                     MOVE W@OSBR    @OSBR                                               CLE034
     C                     MOVE WSCCY     SCCY                                                CLE034
     C                     Z-ADDWREXR     REXR                                                CLE034
     C                     MOVE WREXI     REXI                                                CLE034
     C***********          Z-ADDWROBN     ROBN                                         CLE034 CSD027
     C                     MOVE WROBN     ROBN                                                CSD027
     C***********          Z-ADDWROCN     ROCN                                         CLE034 CSD027
     C                     MOVE WROCN     ROCN                                                CSD027
     C                     MOVE WRIBN     RIBN                                                CLE034
     C                     MOVE WRIBA     RIBA                                                CLE034
     C                     MOVE WPSCY     PSCY                                                CLE034
     C                     Z-ADDWPEXR     PEXR                                                CLE034
     C                     MOVE WPEXI     PEXI                                                CLE034
     C***********          Z-ADDWPOBN     POBN                                         CLE034 CSD027
     C                     MOVE WPOBN     POBN                                                CSD027
     C***********          Z-ADDWPOCN     POCN                                         CLE034 CSD027
     C                     MOVE WPOCN     POCN                                                CSD027
     C                     MOVE WPIBN     PIBN                                                CLE034
     C                     MOVE WPIBA     PIBA                                                CLE034
     C                     MOVE WRVNO     RVNO                                                CLE034
     C                     MOVE WCVMR     CVMR                                                CLE034
     C                     MOVE WRCRN     RCRN                                                CLE034
     C                     MOVE WRCRA     RCRA                                                CLE034
      *                                                                                       CLE034
     C                     ENDIF                                                              CLE034
      *                                                                                       CLE034
     C                     ENDSR                                                              CLE034
     C********************************************************************128093
     C* CALAMT/SR - Calculate event amount for loan messages              128093
     C*                                                                   128093
     C* Called from - OUTPUT                                              128093
     C* Calls - GLINTC                                                    128093
     C********************************************************************128093
     C           CALAMT    BEGSR                                          128093
      *                                                                   128093
      * If a value date event                                             128093
     C           VORM      IFEQ 'V'                                       128093
      *                                                                   128093
      * If not a discounted loan, event amount is principal               128093
     C           PTYP      IFEQ 61                                        128093
     C           PTYP      OREQ 62                                        128093
     C           PTYP      OREQ 64                                        128093
     C           PTYP      OREQ 66                                        128093
     C           PTYP      OREQ 70                                        128093
     C           PTYP      OREQ 80                                                            CLE028
     C           CLE028    ANDEQ'Y'                                                           CLE028
     C                     Z-ADDCPAM      EAMT   130                      128093
      *                                                                   128093
      * else loan is discounted, event amount is principal less           128093
      * discount. Calculate discount amount                               128093
     C                     ELSE                                           128093
     C                     Z-ADDVDAT      ZIBEG                           128093
     C                     Z-ADDMDAT      ZIEND                           128093
     C                     Z-ADDINTR      ZIRATE                          128093
     C                     Z-ADDCPAM      ZIAMT                           128093
     C                     Z-ADDICBS      ZICALC                          128093
     C/COPY WNCPYSRC,LE1067C013
     C                     EXSR GLINTC                                    128093
     C/COPY WNCPYSRC,LE1067C014
     C           RDFC      IFEQ 'Y'                                       128093
     C           CPAM      SUB  ZINTR     EAMT                            128093
     C                     ELSE                                           128093
     C           CPAM      SUB  ZINTR     EAMT      H                     128093
     C                     ENDIF                                          128093
     C                     ENDIF                                          128093
      *                                                                   128093
      * else if a maturity date event                                     128093
     C                     ELSE                                           128093
      *                                                                   128093
      * If loan is discounted, event amount is principal                  128093
     C           PTYP      IFEQ 63                                        128093
     C           PTYP      OREQ 65                                        128093
     C           PTYP      OREQ 67                                        128093
     C                     Z-ADDCPAM      EAMT                            128093
      *                                                                   128093
      * else loan is term or demand loan. If loan has not started         128093
      * yet, calculate total interest based on current interest rate.     128093
     C                     ELSE                                           128093
     C           RUND      IFLE VDAT                                      128093
     C                     Z-ADDVDAT      ZIBEG                           128093
     C                     Z-ADDMDAT      ZIEND                           128093
     C                     Z-ADDINTR      ZIRATE                          128093
     C                     Z-ADDCPAM      ZIAMT                           128093
     C                     Z-ADDICBS      ZICALC                          128093
     C/COPY WNCPYSRC,LE1067C015
     C           CLE028    IFEQ 'Y'                                                           CLE028
     C           PTYP      ANDEQ80                                                            CLE028
     C                     EXSR SROSIN                                                        CLE028
     C                     ELSE                                                               CLE028
     C/COPY WNCPYSRC,LEH01323
     C                     EXSR GLINTC                                    128093
     C                     ENDIF                                                              CLE028
     C/COPY WNCPYSRC,LE1067C016
     C           RDFC      IFEQ 'Y'                                       128093
     C           PTYP      ANDNE80                                                            CLE028
     C           CPAM      ADD  ZINTR     EAMT                            128093
     C                     ELSE                                           128093
     C           CPAM      ADD  ZINTR     EAMT      H                     128093
     C                     ENDIF                                          128093
      *                                                                                       CLE028
      ** For Flat rate personal loans, also add the charge amount                             CLE028
      ** if Add on charges is 'Y'                                                             CLE028
      *                                                                                       CLE028
     C           CLE028    IFEQ 'Y'                                                           CLE028
     C           PTYP      ANDEQ80                                                            CLE028
     C           ADCF      ANDEQ'Y'                                                           CLE028
     C                     ADD  CHGA      EAMT                                                CLE028
     C                     ENDIF                                                              CLE028
      *                                                                   128093
      * else loan has started, calculate interest to accrue up to         128093
      * maturity date (N.B. this is making the assumption that there      128093
      * are no actions on the loan due between now and maturity date      128093
      * - per BHF NY)                                                     128093
     C                     ELSE                                           128093
     C***********          Z-ADDRUND      ZIBEG                    128093 142406
     C                     Z-ADDIACD      ZIBEG                           142406
     C                     Z-ADDMDAT      ZIEND                           128093
     C                     Z-ADDINTR      ZIRATE                          128093
     C                     Z-ADDCPAM      ZIAMT                           128093
     C                     Z-ADDICBS      ZICALC                          128093
     C/COPY WNCPYSRC,LE1067C017
     C           CLE028    IFEQ 'Y'                                                           CLE028
     C           PTYP      ANDEQ80                                                            CLE028
     C                     EXSR SROSIN                                                        CLE028
     C                     ELSE                                                               CLE028
     C/COPY WNCPYSRC,LEH01324
     C                     EXSR GLINTC                                    128093
     C                     ENDIF                                                              CLE028
     C/COPY WNCPYSRC,LE1067C018
      *                                                                   128093
      * Add the current outstanding interest to that just calculated      128093
     C           RDFC      IFEQ 'Y'                                       128093
     C           ZINTR     ADD  AITC      ZINTR                           142406
     C***********ZINTR     ADD  AIPD      ZINTR                    128093 142406
     C           ZINTR     ADD  AIAP      ZINTR                           128093
     C           ZINTR     ADD  AIMN      ZINTR                           128093
     C           ZINTR     SUB  ICTD      ZINTR                           128093
      *                                                                                       CLE028
     C           CLE028    IFEQ 'N'                                                           CLE028
     C           CLE028    OREQ 'Y'                                                           CLE028
     C           PTYP      ANDNE80                                                            CLE028
     C           CLE028    OREQ 'Y'                                                           CLE028
     C           PTYP      ANDEQ80                                                            CLE028
     C           ADIF      ANDNE'Y'                                                           CLE028
      *                                                                                       CLE028
     C           ZINTR     SUB  IPRD      ZINTR                           128093
     C                     ENDIF                                                              CLE028
     C           ZINTR     SUB  IWOD      ZINTR                           142406
      *                                                                   128093
      * Add this to principal for final event amount                      128093
     C           CPAM      ADD  ZINTR     EAMT                            128093
     C                     ELSE                                           128093
     C           ZINTR     ADD  AITC      ZINTR     H                     142406
     C***********ZINTR     ADD  AIPD      ZINTR     H              128093 142406
     C           ZINTR     ADD  AIAP      ZINTR     H                     128093
     C           ZINTR     ADD  AIMN      ZINTR     H                     128093
     C           ZINTR     SUB  ICTD      ZINTR     H                     128093
      *                                                                                       CLE028
     C           CLE028    IFEQ 'N'                                                           CLE028
     C           CLE028    OREQ 'Y'                                                           CLE028
     C           PTYP      ANDNE80                                                            CLE028
     C           CLE028    OREQ 'Y'                                                           CLE028
     C           PTYP      ANDEQ80                                                            CLE028
     C           ADIF      ANDNE'Y'                                                           CLE028
      *                                                                                       CLE028
     C           ZINTR     SUB  IPRD      ZINTR     H                     128093
     C                     ENDIF                                                              CLE028
     C           ZINTR     SUB  IWOD      ZINTR     H                     142406
      *                                                                   128093
      * Add this to principal for final event amount                      128093
     C           CPAM      ADD  ZINTR     EAMT      H                     128093
     C                     ENDIF                                          128093
      *                                                                                       CLE028
      ** For Flat rate personal loans, compute the charge amount                              CLE028
      ** due for the period and add to the final event amount,                                CLE028
      ** if Add on charges is 'Y'                                                             CLE028
      *                                                                                       CLE028
     C           CLE028    IFEQ 'Y'                                                           CLE028
     C           PTYP      ANDEQ80                                                            CLE028
     C           ADCF      ANDEQ'Y'                                                           CLE028
     C           CHGA      DIV  W78NPY    WCHPD  309                                          CLE028
     C                     MULT W78PRD    WCHPD                                               CLE028
     C                     ADD  WCHPD     EAMT      H                                         CLE028
     C                     ENDIF                                                              CLE028
      *                                                                                       CLE028
     C                     ENDIF                                          128093
     C                     ENDIF                                          128093
      *                                                                   128093
     C                     ENDIF                                          128093
      *                                                                   128093
     C                     ENDSR                                          128093
     C********************************************************************
     C* O U T P U T   R O U T I N E S
     C/SPACE 2
     C********************************************************************
     C**   SUBROUTINE TO CREATE LETX1 RECORD
     C**
     C**   OLETX1 IS CALLED BY - CREATE
     C**
     C**             CALLS - OUTPUT;HASH
     C**
     C********************************************************************
     C           OLETX1    BEGSR                           *** OLETX1 ***
     C                     Z-ADD1         X       10
     C                     SETON                     51
     C                     SETOF                     34
     C                     EXSR OUTPUT
     C                     SETOF                     51
     C   34                EXSR HASH
     C/COPY WNCPYSRC,LE1067C006
     C                     SETOF                     34
     C                     ENDSR
     C********************************************************************
     C/SPACE 2
     C********************************************************************
     C**   SUBROUTINE TO CREATE LETX2 RECORD
     C**
     C**   OLETX2 IS CALLED BY - CREATE
     C**
     C**             CALLS - OUTPUT;HASH
     C**
     C********************************************************************
     C           OLETX2    BEGSR                           *** OLETX2 ***
     C                     Z-ADD2         X
     C                     SETON                     52
     C                     SETOF                     34
     C                     EXSR OUTPUT
     C                     SETOF                     52
     C   34                EXSR HASH
     C/COPY WNCPYSRC,LE1067C007
     C                     SETOF                     34
     C                     ENDSR
     C********************************************************************
     C/SPACE 2
     C********************************************************************
     C**   SUBROUTINE TO CREATE LETX3 RECORD
     C**
     C**   OLETX3 IS CALLED BY - CREATE
     C**
     C**             CALLS - OUTPUT;HASH
     C**
     C********************************************************************
     C           OLETX3    BEGSR                           *** OLETX3 ***
     C                     Z-ADD3         X
     C                     SETON                     53
     C                     SETOF                     34
     C                     EXSR OUTPUT
      *                                                                   157863
      ** Do not execute hash if EAMT = 0.                                 157863
      *                                                                   157863
     C           EAMT      IFNE 0                                         157863
     C   34                EXSR HASH
     C                     ENDIF                                          157863
      *                                                                   157863
     C/COPY WNCPYSRC,LE1067C008
     C                     SETOF                     34
     C           OLTGX3    ENDSR
     C********************************************************************
     C**
     C**     SUBROUTINE TO CREATE LEPXT RECORD
     C**
     C**     OLEPXT IS CALLED BY - CREATE
     C**                   CALLS - OUTPUT,HASH
     C**
     C********************************************************************
     C           OLEPXT    BEGSR                           *** OLEPXT ***
     C                     Z-ADD4         X
     C                     SETON                     55
     C                     SETOF                     34
     C                     EXSR OUTPUT
     C   34                EXSR HASH
     C                     SETOF                     34
     C                     ENDSR
     C********************************************************************
     C********************************************************************
     C*****SUBROUTINE*TO*CHAIN*TO*TABLE*FILE                              S01194
     C**********                                                          S01194
     C*****TABCHN*IS*CALLED*BY***MAIN*PROCESSING,CHKSW,PROCEE*            S01194
     C**********                                                          S01194
     C********************************************************************
     C********** TABCHN    BEGSR                           *** TABCHN *** S01194
     C**********           SETOF                     99                   S01194
     C********** ZTABKY    CHAINTABLE                41                   S01194
     C***41*****           SETON                     99                   S01194
     C**N41***** RECI      COMP 'D'                  9999                 S01194
     C**********           ENDSR                                          S01194
     C********************************************************************
     C/SPACE 3
     C********************************************************************
     C*    SUBROUTINE TO MAINTAIN HASH TOTALS
     C*
     C*    HASH IS CALLED BY - OLETX1;OLETX2;OLETX3
     C*                      - OLEPXT
     C*
     C*            CALLS - GLZADD
     C*
     C********************************************************************
     C           HASH      BEGSR                           ***  HASH  ***
     C                     Z-ADDINT,X     ZZTOTI
     C                     Z-ADDDEC,X     ZZTOTD
     C           EAMT      DIV  1000      ZZAMT
     C********** EAMT      IFLT 0                                                      157903 245691
     C**********           Z-SUBZZAMT     ZZAMT                                        157903 245691
     C**********           END                                                         157903 245691
     C                     EXSR GLZADD
     C                     Z-ADDZZTOTI    INT,X
     C                     Z-ADDZZTOTD    DEC,X
     C*
     C           ROP,X     ADD  1         ROP,X
     C                     ENDSR
     C********************************************************************
     C********************************************************************
     C* SUBROUTINE TO ADD AN AMOUNT (ZZAMT) TO THE TOTAL (ZZTOTI,ZZTOTD)
     C*   IND '99' IS SET BY AN OVERFLOW ERROR
     C*
     CSR         GLZADD    BEGSR                           *** GLZADD ****
     C*
     CSR                   Z-ADDZZAMT     ZZAMT  153     91-DEFINE ZZAMT
     CSR 91                GOTO ZZAEND                     AMT = 0.BYPASS
     C*
     C* SPLIT ZZAMT INTO INTEGER AND DECIMAL FIELDS
     CSR                   Z-ADDZZAMT     ZZAMTI 150       INTEGER FIELD
     CSR                   MOVE ZZAMT     ZZAMTD  30       DECIMAL FIELD
     C* BOTH ZZAMTI AND ZZAMTD CONTAIN A 'SIGN' ZONE NOW
     C*
     CSR                   EXSR GLZSUM
     CSR         ZZAEND    ENDSR                           ** ZZAEND TAG *
     C*
     C********************************************************************
     C* SUBROUTINE TO CARRY OUT THE ADDITION FOR SUBROUTINES -
     C*                        GLZADD, GLZSUB, GLZCMP.
     C*          PARAMETERS PASSED -
     C*                     I/P ZZAMTI ZZAMTD
     C*                     O/P ZZTOTI ZZTOTD ZZNEGD IND 96 IND 99.
     C*
     CSR         GLZSUM    BEGSR                           *** GLZSUM ****
     C*
     CSR                   Z-ADDZZTOTI    ZZTOTI 150       DEFINE ZZTOTI
     CSR                   Z-ADDZZTOTD    ZZTOTD  30       DEFINE ZZTOTD
     CSR                   SETOF                     919293
     CSR                   SETOF                     949599
     C*
     C*    DETERMINE SIGN OF ZZAMTI & D,   92 IF NEG
     CSR         ZZAMTI    COMP 0                      9293
     CSR 93      ZZAMTD    COMP 0                      9293
     CSR 93                GOTO ZZSEND                     ZERO BYPASS
     C*
     C*    DETERMINE SIGN OF ZZTOTI & D, 91 IF NEG.
     CSR         ZZTOTI    COMP 0                      9193
     CSR 93      ZZTOTD    COMP 0                      9193
     C*
     C*    IF ZZTOTAL IS ZERO, RETURN ZZAMOUNT.
     CSR 93                Z-ADDZZAMTI    ZZTOTI
     CSR 93                Z-ADDZZAMTD    ZZTOTD
     CSR 93                GOTO ZZSEND                     ZERO BYPASS
     C*    IF SIGNS DIFFER BYPASS OVERFLOW CHECKS.
     CSR 91N92
     CORN91 92             GOTO ZZOFPS
     C*
     CSR         ZZAMTD    ADD  ZZTOTD    ZZWK2   40
     CSR         ZZWK2     COMP 999                  93    '93' = CARRY
     CSRN93      ZZWK2     COMP -999                   93    INTO INTEGER.
     C*
     CSR 93N92   ZZAMTI    ADD  1         ZZWK3  150       ADD 'CARRY' +VE
     CSR    93 92ZZAMTI    SUB  1         ZZWK3            SUB 'CARRY' -VE
     CSR 93      ZZTOTI    ADD  ZZWK3     ZZWK3
     CSRN93      ZZTOTI    ADD  ZZAMTI    ZZWK3
     C*
     C* IF THE MODULUS OF ZZWK3 IS LT MOD. ZZTOTI THEN O/F HAS OCCURED
     CSRN92      ZZWK3     COMP ZZTOTI                 99  -92 MEANS NOS.
     CSR 92      ZZWK3     COMP ZZTOTI               99     NEGATIVE
     CSRN99                Z-ADDZZWK2     ZZTOTD
     CSRN99                Z-ADDZZWK3     ZZTOTI
     C*
     C* IF O/F ZEROIZE ZZAMT , IND '99' SET AND ZZTOT FIELDS LEFT INTACT.
     CSR 99                Z-ADD0         ZZAMT  153
     CSR                   GOTO ZZSEND
     C*
     C* THE 'SIGNS' ARE DIFFERENT
     CSR         ZZOFPS    TAG                             ** ZZOFPS TAG**
     C* IF ZZAMT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZTOT
     C*
     CSR 92                Z-SUBZZAMTI    ZZAMTI 150
     CSR 92                Z-SUBZZAMTD    ZZAMTD  30
     C*
     C* IF ZZTOT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZAMT.
     C*
     CSR 91                Z-SUBZZTOTI    ZZTOTI
     CSR 91                Z-SUBZZTOTD    ZZTOTD
     C* BOTH ZZAMT AND ZZTOT ARE NOW POSITIVE.
     C*
     CSR         ZZTOTI    COMP ZZAMTI               93  95
     CSR 95      ZZTOTD    COMP ZZAMTD               93  95
     C*
     C* IF ZZTOT EQ. ZZAMT RETURN ZERO.
     CSR 95                Z-ADD0         ZZTOTI
     CSR 95                Z-ADD0         ZZTOTD
     CSR 95                GOTO ZZSEND
     C*
     C* IF ZZTOT GT. ZZAMT.
     CSR 93      ZZAMTD    COMP ZZTOTD               94
     CSR 93 94   ZZTOTI    SUB  1         ZZTOTI
     CSR 93 94   ZZTOTD    ADD  1000      ZZWK2
     CSR 93      ZZTOTI    SUB  ZZAMTI    ZZTOTI
     CSR 93 94   ZZWK2     SUB  ZZAMTD    ZZTOTD
     CSR 93N94   ZZTOTD    SUB  ZZAMTD    ZZTOTD
     C*
     C*
     C* IF ZZAMT GT. ZZTOT.
     CSRN93      ZZTOTD    COMP ZZAMTD               94
     CSRN93 94   ZZAMTI    SUB  1         ZZWK3  150
     CSRN93 94   ZZAMTD    ADD  1000      ZZWK2
     CSRN93 94   ZZWK3     SUB  ZZTOTI    ZZTOTI
     CSRN93N94   ZZAMTI    SUB  ZZTOTI    ZZTOTI
     CSRN93 94   ZZWK2     SUB  ZZTOTD    ZZTOTD
     CSRN93N94   ZZAMTD    SUB  ZZTOTD    ZZTOTD
     C*
     C* REVERSE SIGN OF ZZTOT IF LARGER I/P FIELDS WERE NEGATIVE
     CSR                   SETOF                     94
     CSR 93 91
     CORN93 92             SETON                     94
     CSR 94                Z-SUBZZTOTI    ZZTOTI
     CSR 94                Z-SUBZZTOTD    ZZTOTD
     C**
     C**   RESTORE SIGN OF ZZAMTI & ZZAMTD IF IT WAS REVERSED.
     CSR 92                Z-SUBZZAMTI    ZZAMTI
     CSR 92                Z-SUBZZAMTD    ZZAMTD
     CSR         ZZSEND    TAG                             ** ZZSEND TAG *
     C**
     C**   IF ZZTOTD IS ZERO, AND ZZTOTI IS NEG. SET UP ZZNEGD.
     CSR                   SETOF                     96
     CSR         ZZTOTD    COMP 0                        91
     CSR 91      ZZTOTI    COMP 0                      96
     CSR 96                MOVE '.000-'   ZZNEGD  5
     CSR                   ENDSR                             ** ENDSR **
     C********************************************************************
     C********************************************************************
     C* CONTROL CHECK ON S/LTRIN
     C*
     C*   TTRANS IS CALLED BY - MAIN PROCESSING
     C*
     C********************************************************************
     C           TTRANS    BEGSR                           *** TTRANS ***
     C* FOR 'H' AND 'T'
     C           COUNT     ADD  2         COUNT
     C  N43      COUNT     COMP NORL                 4343
     C   43                SETON                     U8
     C                     ENDSR
     C********************************************************************
     C********************************************************************
     C**
0469 C*****ZSYSTM*SR.*TO*CHAIN TO THE INSTALLATION CONTROL DATA RECORD.   S01194
0470 C**********                                                          S01194
0471 C********** ZSYSTM    BEGSR                           *** ZSYSTM *** S01194
0472 C**********                                                          S01194
0473 C*****SET*UP*KEY*FOR*INSTALLATION CONTROL RECORD.                    S01194
0474 C**********           MOVEL'01      'ZTABKY 12                       S01194
0475 C**********           MOVE '  10'    ZTABKY                          S01194
0476 C**********                                                          S01194
0477 C********** ZTABKY    CHAINTABLE                99    ON NOT THERE   S01194
0478 C**N99***** RECI      COMP 'D'                  9999  ON, IS DELETED S01194
0479 C**********                                                          S01194
0480 C*****CHECK*SYSTEM*DATE FORMAT, DDMMYY OR MMDDYY.                    S01194
0481 C********** DATF      COMP 'M'                      98MMDDYY, 98 ON  S01194
0482 C**********                                                          S01194
0483 C**********           ENDSR                                          S01194
     C**
1100 C********************************************************************S11117
     C*                                                                   S11117
     C* *PSSR  --- SUBROUTINE TO HANDLE ABNORMAL ERROR CONDITIONS         S11117
     C*                                                                   S11117
     C* CALLED FROM: AFTER ABNORNAL OPERATION OCCURS                      S11117
     C*                                                                   S11117
     C* CALLS: NOTHING                                                    S11117
     C*                                                                   S11117
     C*****************************************************************   S11117
     C*                                                                   S11117
     C           *PSSR     BEGSR                           ** *PSSR **    S11117
     C*                                                                   S11117
     C           @RUN      IFEQ *BLANKS                                   S11117
     C                     MOVE 'Y'       @RUN    1                       S11117
     C*                                                                   S11117
     C                     DUMP                                           S11117
     C                     END                                            S11117
     C*                                                                   S11117
     C                     ENDSR                           ** *PSSR **    S11117
     C********************************************************************
     C/EJECT                                                              CEU004
     C           XCAMT     BEGSR                                          CEU004
      *===================================================================CEU004
      * XCAMT: Convert Amount.                                            CEU004
      *                                                                   CEU004
      *-------------------------------------------------------------------CEU004
      ** Convert Transaction Amount into Settlement Amount.               CEU004
      *                                                                   CEU004
     C                     CALL 'EU0200'                                  CEU004
      *                                                    Input:         CEU004
     C                     PARM *BLANKS   P@RTCD  7        -Return Code   CEU004
     C                     PARM           P@FRAM 183       -FROM Ccy Amt  CEU004
     C                     PARM           P@FRCY  3        -FROM Currency CEU004
     C                     PARM           P@TOCY  3        -TO Currency   CEU004
      *                                                    Output:        CEU004
     C                     PARM           P@OUTA 150       -Outright Amt  CEU004
     C                     PARM           P@INTA 183       -Interim Amt   CEU004
     C                     PARM           P@EXRT 159       -Exchange Rate CEU004
     C                     PARM           P@MDIN  1        -Mult/Div Ind. CEU004
      *                                                                   CEU004
     C           P@RTCD    IFNE *BLANK                     If Error       CEU004
      *                                                                   CEU004
     C                     MOVEL'EU0200  'DBFILE            Set File      CEU004
     C                     MOVELCCY       DBKEY             Set Key       CEU004
     C                     Z-ADD10        DBASE             Set Ref       CEU004
     C                     SETON                     U7U8LR Set Inds      CEU004
     C                     ENDIF                           End If         CEU004
      *                                                                   CEU004
      *===================================================================CEU004
     C                     ENDSR                                          CEU004
      *****************************************************************                       CLE028
      /EJECT                                                                                  CLE028
      *****************************************************************                       CLE028
      *  SROSIN - Compute for outstanding interest                    *                       CLE028
      *           if Add on Interest is 'Y'                           *                       CLE028
      *****************************************************************                       CLE028
     C           SROSIN    BEGSR                                                              CLE028
      *                                                                                       CLE028
     C           ADIF      IFNE 'Y'                                                           CLE028
     C                     Z-ADD*ZERO     ZINTR                                               CLE028
      *                                                                                       CLE028
     C                     ELSE                                                               CLE028
     C                     Z-ADDVDAT      W78VDT                                              CLE028
     C                     Z-ADDMDAT      W78MDT                                              CLE028
     C                     Z-ADDFLTI      W78FLT                                              CLE028
     C                     MOVE RFRQ      W78RPF                                              CLE028
     C                     Z-ADDFRPD      W78FRD                                              CLE028
     C                     Z-ADDRDYN      W78RPM                                              CLE028
     C                     MOVE CCY       W78CCY                                              CLE028
     C                     MOVE *BLANKS   W78LCN                                              CLE028
     C                     Z-ADDZIBEG     W78BEG                                              CLE028
     C                     Z-ADDZIEND     W78END                                              CLE028
     C                     MOVE 'A'       W78ROA                                              CLE028
     C                     EXSR RULE78                                                        CLE028
     C                     Z-ADDW78INT    ZINTR                                               CLE028
     C                     ENDIF                                                              CLE028
      *                                                                                       CLE028
     C                     ENDSR                                                              CLE028
      *****************************************************************                       CLE028
      /EJECT                                                                                  CLE028
      *****************************************************************                       CLE038
      /EJECT                                                                                  CLE038
      *****************************************************************                       CLE038
      *                                                               *                       CLE038
      * SRCL38 -  Calculate amount in loan ccy for settlement         *                       CLE038
      *           allocation by amount                                *                       CLE038
      *                                                               *                       CLE038
      *****************************************************************                       CLE038
     C           SRCL38    BEGSR                                                              CLE038
      *                                                                                       CLE038
     C           WPYREC    IFEQ 'P'                                                           CLE038
     C                     Z-ADDPYAMSA    EAMT                                                CLE038
     C                     ELSE                                                               CLE038
     C                     Z-ADDRCAMSA    EAMT                                                CLE038
     C                     ENDIF                                                              CLE038
      *                                                                                       CLE038
     C                     Z-ADDEAMT      AMTSV                                               CLE038
     C                     Z-ADDEAMT      WSAMNT                                              CLE038
      *                                                                                       CLE038
     C           WPYREC    IFEQ 'P'                                                           CLE038
     C           PSCYSA    ANDNECCYSV                                                         CLE038
     C           PSCYSA    ANDNE' '                                                           CLE038
     C           WPYREC    OREQ 'R'                                                           CLE038
     C           RSCYSA    ANDNECCYSV                                                         CLE038
     C           RSCYSA    ANDNE' '                                                           CLE038
      *                                                                                       CLE038
     C                     MOVE CCYSV     CURKEY                                              CLE038
      *                                                                                       CLE038
     C                     CALL 'AOCURRR0'             99                                     CLE038
     C                     PARM '*MSG    '@RTCD                                               CLE038
     C                     PARM '*KEY    '@OPTN                                               CLE038
     C                     PARM           CURKEY                                              CLE038
     C           SDCURR    PARM SDCURR    DSSDY                                               CLE038
      *                                                                                       CLE038
     C           @RTCD     IFNE *BLANKS                                                       CLE038
     C                     MOVE *ON       *INU7                                               CLE038
     C                     MOVE *ON       *INU8                                               CLE038
     C                     MOVE *ON       *INLR                                               CLE038
     C                     Z-ADD30        DBASE                                               CLE038
     C                     MOVE 'SDCURRPD'DBFILE                                              CLE038
     C                     MOVELCURKEY    DBKEY                                               CLE038
     C                     GOTO END                                                           CLE038
     C                     ENDIF                                                              CLE038
      *                                                                                       CLE038
     C                     MOVE A6INCY    LCCYIN                                              CLE038
     C                     Z-ADDA6NBDP    LCCYDP                                              CLE038
      *                                                                                       CLE038
     C           WPYREC    IFEQ 'P'                                                           CLE038
     C                     MOVE PSCYSA    CURKEY                                              CLE038
     C                     ELSE                                                               CLE038
     C                     MOVE RSCYSA    CURKEY                                              CLE038
     C                     ENDIF                                                              CLE038
      *                                                                                       CLE038
     C                     CALL 'AOCURRR0'             99                                     CLE038
     C                     PARM '*MSG    '@RTCD                                               CLE038
     C                     PARM '*KEY    '@OPTN                                               CLE038
     C                     PARM           CURKEY                                              CLE038
     C           SDCURR    PARM SDCURR    DSSDY                                               CLE038
      *                                                                                       CLE038
     C           @RTCD     IFNE *BLANKS                                                       CLE038
     C                     MOVE *ON       *INU7                                               CLE038
     C                     MOVE *ON       *INU8                                               CLE038
     C                     MOVE *ON       *INLR                                               CLE038
     C                     Z-ADD31        DBASE                                               CLE038
     C                     MOVE 'SDCURRPD'DBFILE                                              CLE038
     C                     MOVELCURKEY    DBKEY                                               CLE038
     C                     GOTO END                                                           CLE038
     C                     ENDIF                                                              CLE038
      *                                                                                       CLE038
     C                     MOVE A6INCY    SCCYIN                                              CLE038
     C                     Z-ADDA6NBDP    SCCYDP                                              CLE038
      *                                                                                       CLE038
     C           LCCYIN    IFEQ 'Y'                                                           CLE038
     C           SCCYIN    OREQ 'Y'                                                           CLE038
      *                                                                                       CLE038
     C                     Z-ADDEAMT      P@FRAM                                              CLE038
     C                     MOVE CURKEY    P@FRCY                                              CLE038
     C                     MOVE CCYSV     P@TOCY                                              CLE038
     C                     EXSR XCAMT                                                         CLE038
     C                     MOVE P@OUTA    AMTSV                                               CLE038
     C                     Z-ADDAMTSV     WSAMNT                                              CLE038
      *                                                                                       CLE038
     C                     ELSE                                                               CLE038
      *                                                                                       CLE038
     C           *IN45     IFEQ *ON                                                           CLE038
     C                     Z-ADDPEXR      WEXR                                                CLE038
     C           PEXI      IFEQ 'M'                                                           CLE038
     C                     MOVE 'D'       WEXI                                                CLE038
     C                     ELSE                                                               CLE038
     C                     MOVE 'M'       WEXI                                                CLE038
     C                     ENDIF                                                              CLE038
     C                     ENDIF                                                              CLE038
      *                                                                                       CLE038
     C           *IN46     IFEQ *ON                                                           CLE038
     C                     Z-ADDREXR      WEXR                                                CLE038
     C           REXI      IFEQ 'M'                                                           CLE038
     C                     MOVE 'D'       WEXI                                                CLE038
     C                     ELSE                                                               CLE038
     C                     MOVE 'M'       WEXI                                                CLE038
     C                     ENDIF                                                              CLE038
     C                     ENDIF                                                              CLE038
      *                                                                                       CLE038
     C                     Z-ADDEAMT      ZAMTCI                                              CLE038
     C                     Z-ADDWEXR      ZEXCH                                               CLE038
     C                     MOVE WEXI      ZMD                                                 CLE038
     C                     MOVE CURKEY    ZCCYI                                               CLE038
     C                     MOVE CCYSV     ZCCYO                                               CLE038
     C                     Z-ADDSCCYDP    ZCDPI                                               CLE038
     C                     Z-ADDLCCYDP    ZCDPO                                               CLE038
      *                                                                                       CLE038
     C                     CALL 'ZCONVZ1'                                                     CLE038
     C                     PARM           ZAMTCI                                              CLE038
     C                     PARM           ZEXCH                                               CLE038
     C                     PARM           ZMD                                                 CLE038
     C                     PARM           ZCCYI                                               CLE038
     C                     PARM           ZCCYO                                               CLE038
     C                     PARM           ZCDPI                                               CLE038
     C                     PARM           ZCDPO                                               CLE038
     C                     PARM           ZAMTCO                                              CLE038
      *                                                                                       CLE038
     C                     Z-ADDZAMTCO    AMTSV                                               CLE038
     C                     Z-ADDAMTSV     WSAMNT                                              CLE038
      *                                                                                       CLE038
     C                     ENDIF                                                              CLE038
      *                                                                                       CLE038
     C           WPYREC    IFEQ 'P'                                                           CLE038
     C           ICCY      IFNE *BLANKS                                                       CLE038
      *                                                                                       CLE038
     C           ICCY      IFEQ CCYSV                                                         CLE038
     C                     MOVE CCYSV     OTCY                                                CLE038
     C                     Z-ADDAMTSV     OTAM                                                CLE038
     C                     ELSE                                                               CLE038
     C                     Z-ADDAMTSV     P@FRAM                                              CLE038
     C                     MOVE CCYSV     P@FRCY                                              CLE038
     C                     MOVE ICCY      P@TOCY                                              CLE038
     C                     EXSR XCAMT                                                         CLE038
     C                     MOVE ICCY      OTCY                                                CLE038
     C                     MOVE P@OUTA    AMTSV                                               CLE038
     C                     Z-ADDAMTSV     OTAM                                                CLE038
     C                     ENDIF                                                              CLE038
      *                                                                                       CLE038
     C                     ENDIF                                                              CLE038
     C                     ENDIF                                                              CLE038
      *                                                                                       CLE038
     C                     ENDIF                                                              CLE038
      *                                                                                       CLE038
     C                     ENDSR                                                              CLE038
      *****************************************************************                       CLE038
      *****************************************************************                       CLE028
     C/COPY ZSRSRC,ZINTDYZ2                                               128092
     C/COPY ZSRSRC,ZDATE9Z3                                               128092
     C/COPY ZSRSRC,GLINTCZ1                                               128092
     C/COPY ZSRSRC,ZDAT10Z2                                               128092
     C/COPY ZSRSRC,ZFREQBZ2                                                                   CLE028
     C/COPY ZSRSRC,ZDATE1Z2                                                                   CLE028
     C/COPY ZSRSRC,ZDATE2Z2                                                                   CLE028
     C/COPY ZSRSRC,ZACCH                                                                      CLE028
     C/COPY ZSRSRC,ZCHKH                                                                      CLE028
     C/COPY ZSRSRC,RULE78Z1                                                                   CLE028
     C/COPY WNCPYSRC,LE1067C009
     O*                  C O N T R O L   R E P O R T
     OLE1067AUT  203   LR
     O***********                        22 'REFERENCE LE1067'            S01117
     O                                   22 'REFERENCE LE1067AU'          S01117
     O                         TITL      89
     O                                  122 'DATE              PAGE'
     O                         RUNA     112
     O                                  130 '1'
     O        T  1     LR
     O***********                        63 'PAY/RECEIVE EXTRACT - FI'    S01117
     O***********                        80 'LE CONTROL REPORT'           S01117
     O                                   63 'PAY/RECEIVE EXTRACT - RU'    S01117
     O                                   80 'N  CONTROL REPORT'           S01117
     O        T  3     LR
     O                                   63 '------------------------'
     O                                   80 '-----------------'
     O        T  1     LR
     O                                   28 'S/LTRIN - RUN CONTROLS'
     O                                   59 'NUMBER'
     O                                   84 'VALUE'
     O        T  2     LR
     O                                   28 '----------------------'
     O                                   59 'OF RECORDS'
     O                                   84 'OF RECORDS'
     O        T  2     LR
     O                                   29 'TOTAL RECORDS ON FILE'
     O                         NORL  3   59
     O        T  3     LR
     O                                   32 'TOTAL RECORDS ON FILE - '
     O                                   42 'CALCULATED'
     O                         COUNT 3   59
     O                    U8NU7         111 '***   DIFFERENCE   ***'
     O        T  1     LR
     O                                   28 'S/LETX1 - RUN CONTROLS'
     O        T  2     LR
     O                                   28 '----------------------'
     O        T  3     LR
     O                                   29 'TOTAL RECORDS ON FILE'
     O                         ROP,1 3   59
     O                         INT,1 Z   81
     O                         DEC,1     84
     O        T  1     LR
     O                                   28 'S/LETX2 - RUN CONTROLS'
     O        T  2     LR
     O                                   28 '----------------------'
     O        T  3     LR
     O                                   29 'TOTAL RECORDS ON FILE'
     O                         ROP,2 3   59
     O                         INT,2 Z   81
     O                         DEC,2     84
     O        T  1     LR
     O                                   28 'S/LETX3 - RUN CONTROLS'
     O        T  2     LR
     O                                   28 '----------------------'
     O        T  3     LR
     O                                   28 'TOTAL RECORDS ON FILE'
     O                         ROP,3 3   59
     O                         INT,3 Z   81
     O                         DEC,3     84
     O        T  1     LR U4
     O                                   28 'S/LEPXT - RUN CONTROLS'
     O        T  2     LR U4
     O                                   28 '----------------------'
     O        T  3     LR U4
     O                                   28 'TOTAL RECORDS ON FILE'
     O                         ROP,4 3   59
     O                         INT,4 Z   81
     O                         DEC,4     84
     O/COPY WNCPYSRC,LE1067O001
     O********T*00     LRNU7                                              S01117
     O***********                        71 '*** END OF REPORT ***'       S01117
     O* IF DATABASE ERROR
     O        T 32     LR U7 U8
     O                                   40 '*** REFERENCE'
     O                         DBPGM     51
     O                                   71 '- DATABASE ERROR AT'
     O                         DBASE     76
     O        T  1     LR U7 U8
     O                                   37 'FILENAME'
     O***********              DBFILE    43                               S11117
     O***********                        48 'KEY'                         S11117
     O***********              DBKEY     78                               S11117
     O                         DBFILE    46                               S11117
     O                                   51 'KEY'                         S11117
     O                         DBKEY     81                               S11117
     O* O U T P U T   E X T R A C T S
     OLETX1HH H        1P
     O                                    1 'H'
     OLETX1ZZ T        LR
     O                                    1 'T'
     O                         ROP,1      4P
     O                         INT,1     12P
     O                         DEC,1     14P
     OLETX1PR E        51
     O***********              LETX     180                               S01117
     O***********              LETX     181                        S01117 CEU004
     O**********               LETX     210                                            CEU004 CGL029
     O*************************LETX     228                                            CGL029 CLE042
     O                         LETX     232                                                   CLE042
     O                         VDATPH    22P
     O                         EAMT      51P
     O                         OTAM     207P                              CEU004
     OLETX2HH H        1P
     O                                    1 'H'
     OLETX2ZZ T        LR
     O                                    1 'T'
     O                         ROP,2      4P
     O                         INT,2     12P
     O                         DEC,2     14P
     OLETX2PR E        52
     O***********              LETX     180                               S01117
     O***********              LETX     181                        S01117 CEU004
     O**********               LETX     210                                            CEU004 CGL029
     O*************************LETX     228                                            CGL029 CLE042
     O                         LETX     232                                                   CLE042
     O                         VDATPH    22P
     O                         EAMT      51P
     O                         OTAM     207P                              CEU004
     OLETX3HH H        1P
     O                                    1 'H'
     OLETX3ZZ T        LR
     O                                    1 'T'
     O                         ROP,3      4P
     O                         INT,3     12P
     O                         DEC,3     14P
     OLETX3PR E        53
     O***********              LETX     180                               S01117
     O***********              LETX     181                        S01117 CEU004
     O**********               LETX     210                                            CEU004 CGL029
     O*************************LETX     228                                            CGL029 CLE042
     O                         LETX     232                                                   CLE042
     O                         VDATPH    22P
     O                         EAMT      51P
     O                         OTAM     207P                              CEU004
     O*
     OLEPXTAA H        1P
     O                                    1 'H'
     OLEPXTAC T        LR
     O                                    1 'T'
     O                         ROP,4      4P
     O                         INT,4     12P
     O                         DEC,4     14P
     OLEPXTAB E        55
     O                                    1 'D'
     O                         LNRFPH     7
     O                         VDATPH    10P
     O                         LASNPH    13
     O                         LTYP      16
     O                         SUTP      18
     O                         PTYP      20
     O                         AMTPPQ    22
     O                         CURREN    35
     O                         EAMT      70P
     O***********              BRCD      73                               S01117
     O                         BRCA      73                               S01117
     O                         CNUMPH    79
     O                         @OSBR     82                               LN1040
     O                         SETTLE    84
     O**********               OURAG     96                                                   CGL029
     O                         THRAG    106
     O                         OTFACO   116
     O                         OTSPI    206
     O                         RCDT     217
     O                         PAYREC   249
     O                         INTCPH   251
     O                         CSID     265
     O                         PINDS    269
     O                         TINDPH   270
     O                         BICN     276
     O                         CVMI     277                               S01518
     O                         OTAM     353P                              CEU004
     O                         OTCY     356                               CEU004
     O                         OURAG    374                                                   CGL029
     O                         LFCN     398                                                   230521
     O                         CLAS     402                                                   CLE042
     O/COPY WNCPYSRC,LE1067O002
     O*
**  CPY@
(c) Finastra International Limited 2001
** IPSET - I/P CYCLE SETTLEMENT TYPES
0102070812
** TABTP1 - 'PAY' PROCESSING TYPES
61626364656880                                                                         155570 CLE028
** TABTP2 - 'RECEIVE' PROCESSING TYPES
666769                                                                    155570
** TABTP3 - PTYPS 64 65
646568                                                                    155570
     X/COPY ZSRSRC,ZDATE9Z4
**  ZFMD - NUMBER OF DAYS IN THE MONTH                                                        CLE028
312831303130313130313031                                                                      CLE028
**  ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN                                           CLE028
0366073110961461                                                                              CLE028
**  ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR                                             CLE028
000031059090120151181212243273304334365                                                       CLE028
**   ZMNM - MONTHS SHORT NAMES                                                                CLE028
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC                                                          CLE028
