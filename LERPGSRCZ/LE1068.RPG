0001 H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas Create Pay/Rec. Extract Files S2659')            *
0004 F*                                                                  *
0002 F*****************************************************************
     F*  Midas - Customer Lending Module
0004 F*                                                               *
0005 F*  LE1068  -  CREATE PAY/RECEIVE EXTRACT FILES                  *
0006 F*                                                               *
      *  (c) Finastra International Limited 2001                      *
      *                                                               *
      *  Last Amend No. CSD103             Date 10Aug20               *
      *  Prev Amend No. CLE071             Date 18Jul18               *
      *                 MD046248           Date 27Oct17               *
      *                 CLE141             Date 08Feb16               *
      *                 CLE134             Date 01Aug12               *
      *                 CLE148             Date 23Jul12               *
      *                 CER059             Date 19Jul10               *
      *                 CER020             Date 19May08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CSD031             Date 10Apr06               *
      *                 CSD027             Date 16Mar06               *
      *                 CLE042             Date 06Sep05               *
      *                 CLE038             Date 11May04               *
      *                 CLE036             Date 22Sep03               *
      *                 CSW037A            Date 02May05               *
      *                 CAS011             Date 16May05               *
      *                 230521             Date 28Oct04               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 CLE025             Date 20Oct03               *
      *                 CGL029             Date 01Sep03               *
      *                 CAP075             Date 16Sep03               *
      *                 CAP074             Date 16Sep03               *
      *                 CLE034             Date 05May03               *
      *                 CLE031             Date 17Feb03               *
      *                 CLE028             Date 27Jun02               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.05 -----------------------------------------------*
      *                 CLE011             Date 07Nov00               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 157863             Date 06Apr99               *
      *                 158956 (BD5315)    Date 04Jul97               *
      *                 155570             Date 25Feb99               *
     F*                 137920             Date 29Jun98               *
     F*                 135378             Date 18May98               *
     F*                 CEU004             Date 02Feb98               *
     F*                 CLE002             Date 02Dec96               *
     F*                 E45727             Date 23Nov92               *
     F*                 S01392             DATE 14SEP92               *
     F*                 S01220             DATE 15MAR91               *
0010 F*                 S2659              DATE 12JUN90               *
     F*                 S01194             DATE 19JAN90               *
     F*                 S01117             DATE 28MAY89               *
0008 F*                                                               *
     F*---------------------------------------------------------------*
      *                                                               *
      *  CSD103 - LIBOR Deregulation - Common Layer/Standing Data     *
      *  CLE071 - Value Dating of Rate Changes to Fees (Recompile)    *
      *  MD046248 - Finastra Rebranding                               *
      *  CLE141 - Currency and Location Business Day Convention       *
      *           (Recompile)                                         *
      *  CLE134 - Past Due Call Loan Processing                       *
      *  CLE148 - Alpha Loan Reference                                *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  CER020 - Enhanced Rollover Window: Upgrade FGE089 to         *
      *           Midas Plus                                          *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CLE042 - Extended Loan Sub Type                              *
      *  CLE038 - Lending Enhancement for Nordea: Allocation by Amount*
      *  CLE036 - Lending Enhancements for Nordea Phase 1 Priority 2: *
      *           Allow repayments in facility currency               *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  CAS011 - EIR/AC Accounting Upgrade to MP1                    *
      *  230521 - Initialise new field added on PF/LEPXTAB.           *
      *           Recompile over changes in physical file LEPXTAB     *
      *           Applied fix 215643.                                 *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  CLE025 - Credit Lines (Recompile)                            *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  CAP075 - Lending API enhancements - Loan Amendments Input    *
      *  CAP074 - Lending API enhancements - Loans input.             *
      *  CLE034 - Lending Enhancements Phase 1 Priority 1A            *
      *  CLE031 - Lending Enhancements.                               *
      *  CLE028 - Flat Rate Personal Loans (Rule of 78s)              *
      *  CLE011 - Rate Fixing Days for Lending Rollover Processing    *
      *           Recompile                                           *
      *  157863 - LE0520, FOOB caused by fix to take out 0 payments   *
     F*  158956 - SWIFT messages erroneously produced for settlement  *
     F*           type 01  (install fix from GEMS passim)             *
      *  155570 - Program should include new processing types         *
      *           introduced in Customer Lending Enhancements.        *
     F*  137920 - EMU Additional Fixes for Le Settlement Currency     *
     F*           Conversion                                          *
     F*  135378 - Additional Lending EMU Fixes                        *
      *  CEU004 - LE Settlement Ccy Conversion Upgrade to DBA R2.0    *
     F*  CLE002 - Customer Lending Enhancements - Authorisation       *
     F*  E45727 - Recompile as fee sequence added to LETX3PR.         *
     F*  S01392 - Japanese sub module enhancements                    *
     F*  S01220 - Amended for Strategic Risk management               *
     F*           Release 10 to allow the input of a book             *
     F*           code against a loan.                                *
     F*  S2659  - Midas/CHIPS diskette                                *
     F*****************************************************************
     F*                                                               *
     F*  S01194 - New Standing Data                                   *
     F*  S01117 - Multibranching                                      *
     F*           Sset up branch code on the SWIFT msg file           *
     F*                                                               *
0010 F*****************************************************************
0008 F*                                                                  *
0011 F* TRANSACTION FILES
     F*  C R E A T I O N     P A R A M E T E R S                      *
     F*                                                               *
     F*                                                               *
     F*****************************************************************
0012 FLTRIN   IP  F      40 20AI     1 DISK
0013 F* MASTER FILES
0014 F*CLOAN***IF**F*****400  7AI     2 DISK                              S01220
     F***CLOAN***IF  F     436  7AI     2 DISK                     S01220 CLE002
     F***CLOAN***IF  F    1275  7AI     2 DISK                     CLE002 CEU004
     F*CLOAN***IF**F    1290  7AI     2 DISK                       CEU004 CLE011
     F*CLOAN***IF**F    1310  7AI     2 DISK                                           CLE011 CLE028
     F*CLOAN***IF**F    1389  7AI     2 DISK                                           CLE028 CLE031
     F***CLOAN** IF  F    1492  7AI     2 DISK                                         CLE031 CLE034
     F***CLOAN   IF  F    1493  7AI     2 DISK                                         CLE034 CAP074
     F***CLOAN** IF  F    1560  7AI     2 DISK                                         CAP074 CGL029
     F*CLOAN***IF**F****1632  7AI     2 DISK                                           CGL029 CLE042
     F***CLOAN** IF  F    1773  7AI     2 DISK                                         CLE042 CER020
     F***CLOAN** IF  F    1782  7AI     2 DISK                                         CER020 CLE134
     FCLOAN   IF  F    1874  7AI     2 DISK                                                   CLE134
0015 F***LOAMS***IF  F     320 14AI     2 DISK                            CLE002
     F***LOAMS***IF  F    1051 14AI     2 DISK                     CLE002 CEU004
     F***LOAMS***IF  F    1066 14AI     2 DISK                                         CEU004 CLE028
     F***LOAMS***IF  F    1075 14AI     2 DISK                                         CLE028 CLE031
     F***LOAMS** IF  F    1108 14AI     2 DISK                                         CLE031 CLE034
     F***LOAMS** IF  F    1109 14AI     2 DISK                                         CLE034 CAP075
     F***LOAMS** IF  F    1176 14AI     2 DISK                                         CAP075 CGL029
     F***LOAMS** IF  F    1230 14AI     2 DISK                                         CGL029 CLE036
     F*LOAMS***IF**F****1268 14AI     2 DISK                                           CLE036 CLE042
     FLOAMS   IF  F    1291 14AI     2 DISK                                                   CLE042
0016 F*TABLE***IF  F      96 12AI     2 DISK                              S01194
     F*CLINT***IF  F     256  7AI     2 DISK                              S01194
     F/COPY WNCPYSRC,LE1068F001
0017 F* OUTPUT FILES
0018 FLETX1HH O   F     180            DISK
0018 F*ETX1PR O   F     180            DISK                               S01117
     F***LETX1PR*O   F     200            DISK                     S01117 CEU004
     F***LETX1PR O   F     210            DISK                                         CEU004 CGL029
     F*LETX1PR*O***F*****228            DISK                                           CGL029 CLE042
     FLETX1PR O   F     232            DISK                                                   CLE042
0018 FLETX1ZZ O   F     180            DISK
0019 FLETX2HH O   F     180            DISK
0019 F*ETX2PR O   F     180            DISK                               S01117
     F***LETX2PR*O   F     200            DISK                     S01117 CEU004
     F***LETX2PR O   F     210            DISK                                         CEU004 CGL029
     F*LETX2PR*O***F*****228            DISK                                           CGL029 CLE042
     FLETX2PR O   F     232            DISK                                                   CLE042
0019 FLETX2ZZ O   F     180            DISK
0020 FLETX3HH O   F     180            DISK
0020 F*ETX3PR O   F     180            DISK                               S01117
     F***LETX3PR*O   F     200            DISK                     S01117 CEU004
     F***LETX3PR O   F     210            DISK                                         CEU004 CGL029
     F*LETX3PR*O***F*****228            DISK                                           CGL029 CLE042
     FLETX3PR O   F     232            DISK                                                   CLE042
0020 FLETX3ZZ O   F     180            DISK
     FLEPXTAA O   F     320            DISK                           U4
     F***LEPXTAB*O   F     320            DISK                        U4  CEU004
     F***LEPXTAB O   F     356            DISK                           U4            CEU004 CGL029
     F***LEPXTAB O   F     392            DISK                           U4            CGL029 230521
     F*LEPXTAB*O***F*****398            DISK                           U4              230521 CLE042
     FLEPXTAB O   F     402            DISK                           U4                      CLE042
     FLEPXTAC O   F     320            DISK                           U4
0020 FLETX6HH O   F     180            DISK                           U1  S2659
0020 F***LETX6PR*O   F     200            DISK                   U1 S2659 CEU004
0020 F***LETX6PR O   F     210            DISK                           U1            CEU004 CGL029
     F*LETX6PR*O***F*****228            DISK                           U1              CGL029 CLE042
     FLETX6PR O   F     232            DISK                           U1                      CLE042
0020 FLETX6ZZ O   F     180            DISK                           U1  S2659
0021 F*E1068P1O** F     132            PRINTER                            S11117
     FLE1068AUO   F     132     OB     PRINTER                            S01117
     F*
0022 F* ID F  C  H  L    FUNCTION OF INDICATORS
0023 F*
0024 F* 01            LTRIN FILE - HEADER RECORD
0025 F* 02                       - DETAIL
0026 F* 03                       - TRAILER
0027 F* 04            LOAMS FILE - LIVE DETAIL RECORD
0028 F* 05                       - REVERSED
     F**06*****       CLINT FILE - DETAIL RECORD 'A'                      S01194
0029 F*    20         DEFAULT BRANCH CODE BLANK (I.C.D.R.1)
0030 F*    21         PAY/RECEIVE INDICATOR NOT ZERO (LTRIN)
     F*       22      WORK (IN PROC1)
0031 F*       34      OUTPUT A RECORD
     F*       37      WORK (CHKSW & PROCEE SUBROUTINES)
0032 F*       40      FIRST CYCLE INDICATOR
0033 F*       41      CHAIN FAILURE
0034 F*       42      WORK
0035 F*       43      LTRIN OUT OF BALANCE
0036 F*       44      DEFAULT BRANCH CODE ZERO
0037 F********45******RELATED*LOAN*PROCESSING*TYPE*61,62,63,64,65*OR*70***155570
0038 F********46***********************************66,67******************155570
0039 F********47***********************************64,65******************155570
0037 F*       45      RELATED LOAN PROCESSING TYPE 61,62,63,64,65,68      155570
0038 F*       46                                   66,67,69               155570
0039 F*       47                                   64,65,68               155570
0040 F*       48      LTRIN RECORD RELATES TO-A LOAN
0041 F*       49                             -A LOAN AMENDMENT
0042 F*       50      INSTRUCTIONS VALID
0043 F*       51      OUTPUT A RECORD TO - LETX1
0044 F*       52                           LETX2
0045 F*       53                           LETX3
0046 F*       54      LOCAL CCY NOSTRO-TELEX OR BANK AUTHORISATION = B
     F*       55      OUTPUT A RECORD TO LEPXT
0055 F*       56      O/P TO LETX6, SETTLEMENT TYPE 07 & CHIPS PAYMENT.   S2659
0056 F*       57      SETTLEMENT TYPE 07 - CHIPS.                         S2659
0057 F*          U1   CUSTOMER LENDING CHIPS INTERFACE PRESENT            S2659
     F*          U4   SWIFT INTERFACE EXISTS
     F*       U7+U8   DATABASE ERROR
     F*          U8   LTRIN OUT OF BALANCE
     F*
0047 E***                 INT         4 15 0             RECORDS O/P      S2659
0048 E***                 DEC         4  3 0             RECORDS O/P      S2659
0049 E***                 ROP         4  5 0             NO.RECORDS O/P   S2659
0050 E*
0065 E                    INT         5 15 0             RECORDS O/P      S2659
0066 E                    DEC         5  3 0             RECORDS O/P      S2659
0067 E                    ROP         5  5 0             NO.RECORDS O/P   S2659
0068 E*                                                                   S2659
0051 E                    IPSET   5   5  2 0             I/P CYC.SET.TYPES
0052 E********************TABTP1  5   5  2 0             DEPT. DEAL TYPES 155570
0053 E********************TABTP2  2   2  2 0             DEPT DL.AMD. TYPE155570
0054 E********************TABTP3  2   2  2 0                              155570
0052 E**********          TABTP1  6   6  2 0                                           155570 CLE028
0052 E                    TABTP1  7   7  2 0                                                  CLE028
0053 E                    TABTP2  3   3  2 0                              155570
0054 E                    TABTP3  3   3  2 0                              155570
     E                    CPY@    1   1 80
0055 E**
0056 I*    LOAN TRANSACTIONS INDEX FILE - HEADER RECORD.
0057 I*
0058 ILTRIN   NS  01   1 CH
0059 I                                        1   1 RECI
0060 I                                        2   2 RCDT
0061 I**********                              3   80LNRF                                      CLE148
     I                                        3   8 LNRF                                      CLE148
0062 I                                    P   9  110NORE
0063 I                                    P  12  140FLSZ
0064 I                                    P  15  170RRLC
0065 I                                    P  18  200RRNA
0066 I                                    P  21  230RRLX
0067 I                                    P  24  260RRXP
0068 I                                    P  27  290NLNR
0069 I                                    P  30  320NLAR
0070 I                                       33  330STPI
0071 I                                    P  38  400TNLU
0072 I*
0073 I*
0074 I*    LOAN TRANSACTIONS INDEX FILE - DETAIL RECORD.
0075 I*
0076 I        NS  02   1 CD   2 CA
0077 I       OR        1 CD   2 CL
     I       OR        1 CD   2 CR                                        S01392
0078 I                                        1   1 RECI
0079 I                                        2   2 RCDT
0080 I**********                              3   80LNRF                                      CLE148
     I                                        3   8 LNRF                                      CLE148
0081 I                                        9  130VDATLN
0082 I                                       14  160LASNLN
0083 I                                       17  17 CHTP
0084 I                                       18  18 CNRQ
0085 I                                       19  19 CNPR
0086 I                                       20  20 REPR
0087 I                                       21  250RRLA
0088 I                                       26  26 LADI
0089 I                                       27  270PRI1        2121
0090 I                                    P  35  370RRNT
0091 I                                    P  38  400TNLU
0092 I*
0093 I*
0094 I*    LOAN INDEX FILE - TRAILER RECORD.
0095 I*
0096 I        NS  03   1 CT
0097 I                                        1   1 RECI
0098 I                                        2   60NORL
0099 I                                    P  14  160NLNR
0100 I                                    P  17  190NLAR
0101 I*
0102 I*
0103 I* CATCHALL
0104 I        NS
0105 I*
0106 I*    CLOAN FILE - DETAIL
0107 I*
0108 ICLOAN   NS       1 C*   8 CA
0109 I       OR        1 CD   8 CA
0110 I       OR        1 CM   8 CA
0111 I       OR        1 CR   8 CA
0112 I                                        1   1 RECI
0113 I**********                              2   70LNRF                                      CLE148
     I                                        2   7 LNRF                                      CLE148
0114 I                                        8   8 RCDTZ
0115 I                                        9   90MRIN
0116 I                                       10  110PTYP
0117 I***********                            12  170CNUM                                      CSD027
     I                                       12  17 CNUM                                      CSD027
0118 I***********                            18  200BRCD                  S01117
     I                                       18  20 BRCA                  S01117
0119 I                                       21  22 LTYP
0120 I                                       23  24 SUTP
0121 I                                    P  25  270DDAT
0122 I                                    P  28  300VDAT
0123 I                                    P  31  330MDAT
0124 I                                       34  350LASQ
0125 I**********                             36  410FCUS                                      CSD027
0125 I                                       36  41 FCUS                                      CSD027
0126 I                                       42  440FTYP
0127 I                                       45  460FSEQ
0128 I                                       47  49 CCY
0129 I                                    P  50  560CPAM
0130 I                                       57  57 INTC
0131 I                                    P  58  637INTR
0132 I**********                             64  650BRTT                                      CSD103
0132 I                                       64  65 BRTT                                      CSD103
0133 I                                    P  66  717BRTE
0134 I                                    P  72  777RTSP
0135 I                                    P  78  815MARG
0136 I                                       82  82 SPIN
0137 I                                       83  83 CHIN
0138 I                                    P  84  897WTRT
0139 I                                       90  90 WTIN
0140 I                                       91  91 REPT
0141 I                                    P  92  980RAMT
0142 I                                    P  99 1010NRPD
0143 I                                      102 102 RFRQ
0144 I                                      103 1040RDYN
0145 I                                      105 107 FCCY
0146 I                                      108 1100LIND
0147 I                                      111 112 CRSK
0148 I                                      113 114 ACOF
0149 I                                      115 115 NACD
0150 I                                      116 116 RELI
0151 I                                      117 117 AUTO
0152 I                                    P 118 1240PSAM
0153 I                                    P 125 1318BCXR
0154 I                                    P 132 1388FCXR
0155 I                                      139 1400SDST
0156 I**********                            141 152 OSDA                                      CGL029
     I                                      141 152 QQOSDA                                    CGL029
0157 I                                      153 162 TSTN
0158 I                                      163 1640MDST
0159 I**********                            165 176 OMDA                                      CGL029
     I                                      165 176 QQOMDA                                    CGL029
0160 I                                      177 186 TMAN
0161 I                                      187 196 FACO
0162 I                                    P 197 1990RLDT
0163 I                                    P 200 2020NROD
0164 I                                      203 203 RLFQ
0165 I                                      204 2050RLDY
0166 I**********                            207 2080NBRA                                      CSD103
0166 I                                      207 208 NBRA                                      CSD103
0167 I                                    P 209 2147NRTS
0168 I                                      215 215 NSIN
0169 I                                      216 2160NCAC
0170 I                                    P 217 2230AWTP
0171 I                                    P 224 2300WTRD
0172 I                                    P 231 2370WTWD
0173 I                                    P 238 2440IWOD
0174 I                                    P 245 2510PWOD
0175 I                                      252 252 BMDI
0176 I                                      253 253 FMDI
0177 I                                    P 254 2600PDIN
     I                                      265 267 OSDB                  S01117
     I                                      268 270 OMDB                  S01117
0178 I                                      287 287 BTIN
0179 I                                      288 2890BLDY
0180 I***********                           290 2950OLNO                                      CSD027
     I                                      290 295 OLNO                                      CSD027
0181 I                                      296 296 RCSI
0182 I                                      297 2970ICBS
0183 I                                      298 298 IPFR
0184 I                                    P 299 3050TOTI
0185 I                                    P 306 3080NIDT
0186 I                                    P 309 3110IBDT
0187 I                                    P 312 3140SLID
0188 I                                    P 315 3210AIPD
0189 I                                    P 322 3240DLRC
0190 I                                    P 325 3270IACD
0191 I                                    P 328 3340AITC
0192 I                                    P 335 3410TFEP
0193 I                                    P 342 3480AIAP
0194 I                                    P 349 3550IPRD
0195 I                                    P 356 3620IPRM
0196 I                                    P 363 3690ICTD
0197 I                                    P 370 3760AIMN
0198 I                                    P 377 3790RBDT
0199 I                                      384 3850IFDY
0200 I                                      386 386 LONI
0201 I                                      387 387 CNFI
0202 I                                      388 388 ACEI
0203 I                                      389 389 TLXI
0204 I                                      390 390 CBLI
0205 I                                    P 391 3930ORED
0206 I                                    P 394 3960LCD
0207 I                                      397 397 CHTP
0208 I                                    P 398 4000TNLU
     I                                      435 436 BOKC                  S01220
     I                                      459 4600RSTM                                      CLE034
     I**********                            461 472 RONS                               CLE034 CGL029
     I                                      461 472 RONSQQ                                    CGL029
     I                                      473 480 RIBN                                      CLE034
     I                                      481 515 RIBA                                      CLE034
     I***********                           516 5210ROBN                               CLE034 CSD027
     I                                      516 521 ROBN                                      CSD027
     I***********                           522 5270ROCN                               CLE034 CSD027
     I                                      522 527 ROCN                                      CSD027
     I                                      528 5290PSTM                                      CLE034
     I**********                            530 541 PONS                               CLE034 CGL029
     I                                      530 541 PONSQQ                                    CGL029
     I                                      542 549 PIBN                                      CLE034
     I                                      550 584 PIBA                                      CLE034
     I***********                           585 5900POBN                               CLE034 CSD027
     I                                      585 590 POBN                                      CSD027
     I***********                           591 5960POCN                               CLE034 CSD027
     I                                      591 596 POCN                                      CSD027
     I                                      597 604 RCRN                                      CLE034
     I                                      605 639 RCRA                                      CLE034
     I                                      640 647 RVNO                                      CLE034
     I                                     10871087 CVMR                                      CLE034
     I                                     12161216 LSTS                  CLE002
     I                                     12851287 SCCY                  CEU004
     I                                     12881290 ICCY                  CEU004
     I                                     13491349 ADIF                                      CLE028
     I                                     13501350 ADCF                                      CLE028
     I                                    P135113570CHGA                                      CLE028
     I                                     13581358 ICIF                                      CLE028
     I                                    P135913650FLTI                                      CLE028
     I                                    P136613680FRPD                                      CLE028
     I                                    P136913750ACCH                                      CLE028
     I                                    P147414808REXR                  CLE031
     I                                     14811481 REXI                  CLE031
     I                                     14821484 PSCY                  CLE031
     I                                    P148514918PEXR                  CLE031
     I                                     14921492 PEXI                  CLE031
     I                                     14931493 STAL                                      CLE034
     I                                     14941513 FRNT                                      CAP074
     I                                     15141533 AFRT                                      CAP074
     I                                     15341534 REPA                                      CAP074
     I                                     15351560 TMST                                      CAP074
     I                                     15611578 OSDA                                      CGL029
     I                                     15791596 OMDA                                      CGL029
     I                                     15971614 RONS                                      CGL029
     I                                     16151632 PONS                                      CGL029
     I                                     17621765 CLAS                                      CLE042
     I                                     17661769 DFCL                                      CER020
     I                                     17701773 SLCL                                      CER020
     I                                    P177417760ISDT                                      CER020
     I                                    P177717790FMDT                                      CER020
     I                                     17801782 LOIC                                      CER020
      *                                                                                       CLE134
     I                                     18301830 FAMU                                      CLE134
     I                                     18311831 FPNR                                      CLE134
     I                                    P183218340RIDT                                      CLE134
     I                                    P183518360RIDC                                      CLE134
     I                                     183718370RCAT                                      CLE134
     I                                    P183818390RCAC                                      CLE134
     I                                    P184018420RCSD                                      CLE134
     I                                    P184318440RCDY                                      CLE134
     I                                    P184518460RCCY                                      CLE134
      *                                                                                       CLE134
     I                                    P184718490BIDT                                      CLE134
     I                                    P185018510BIDC                                      CLE134
     I                                     185218520BCAT                                      CLE134
     I                                    P185318540BCAC                                      CLE134
     I                                    P185518570BCSD                                      CLE134
     I                                    P185818590BCDY                                      CLE134
     I                                    P186018610BICC                                      CLE134
      *                                                                                       CLE134
     I                                     18621864 XRFI                                      CLE134
     I                                     186518740XRFN                                      CLE134
      *                                                                                       CLE134
0209 I**
0210 I**   CLOAN FILE - DETAIL 2
0211 I**
0212 I        NS       1 CD   8 CB
0213 I       OR        1 CM   8 CB
0214 I       OR        1 CR   8 CB
0215 I                                        1   1 RECI
0216 I**********                              2   70LNRF                                      CLE148
     I                                        2   7 LNRF                                      CLE148
0217 I                                        8   8 RCDTZ
0218 I                                        9   90MRIN
0219 I                                       10  44 NAR1
0220 I                                       45  79 NAR2
0221 I                                       80 114 NAR3
0222 I                                      115 149 NAR4
0223 I                                    P 150 1560OPAM
0224 I                                      157 1610FRBC
0225 I                                    P 162 1680YPLN
0226 I                                    P 169 1750YFLN
0227 I                                    P 176 1820YWLN
0228 I                                    P 183 1890ABLN
0229 I                                    P 190 1960YPLC
0230 I                                    P 197 2030YFLC
0231 I                                    P 204 2100YWLC
0232 I                                    P 211 2170ABLC
0233 I                                    P 218 2240WWLN
0234 I                                    P 225 2310IWLN
0235 I                                    P 232 2380PWLN
0236 I                                      245 274 SPI1
0237 I                                      275 304 SPI2
0238 I                                      305 334 SPI3
0239 I                                      245 334 SPI             24
0240 I                                    P 335 3410YILN
0241 I                                    P 391 3930ORED
0242 I                                    P 394 3960LCD
0243 I                                      397 397 CHTP
0244 I                                    P 398 4000TNLU
     I                                     11121114 RRSC                  CEU004
     I                                     11151117 RPSC                  CEU004
     I                                     11181120 RICY                  CEU004
     I                                     11211121 ECIN                  CLE031
     I                                     112211230RPSM                  CLE031
     I**********                           11241135 RPOS                               CLE031 CGL029
     I                                     11241135 RPOSQQ                                    CGL029
     I                                     11361145 RPTS                  CLE031
     I                                     11461148 RPSB                  CLE031
     I                                     11491158 RFAO                  CLE031
     I                                     11591163 FSFYLB                CLE031
     I                                    P116411708RRSR                  CLE031
     I                                     11711171 RRSI                  CLE031
     I                                    P117211788RPSR                  CLE031
     I                                     11791179 RPSI                  CLE031
     I                                     11801180 RSTA                                      CLE034
     I                                     13021319 RPOS                                      CGL029
0245 I*
0246 I*
0247 I*    CLOAN FILE - CATCHALL
0248 I*
0249 I        NS
0250 I                                        1   1 RECI
0251 I*
0252 I*    LOAMS AMENDMENT FILE - DETAIL RECORD.
0253 I*
0254 ILOAMS   NS  04   1 CD
0255 I       OR   05   1 CR
0256 I                                        1   1 RECIDK
0257 I**********                              2   70LNRFDK                                    CLE148
     I                                        2   7 LNRFDK                                    CLE148
0258 I                                        8  120VDATDK
0259 I                                       13  150LASNDK
0260 I                                       17  18 LTYPDK
0261 I                                       19  20 SUTPDK
0262 I                                       21  220PTYPDK
0263 I                                       23  24 AMTPDK
0264 I                                       35  37 CCYDK
0265 I                                    P  38  440PRAMDK
0266 I                                    P  45  510INTADK
0267 I                                    P  52  580WTXADK
0268 I                                    P  59  650FEAMDK
0269 I                                    P  66  720TAMTDK
0270 I***********                            73  750BRCDDK                S11117
0214 I                                       73  75 BRCDDK                S01117
0271 I***********                            76  810CNUMDK                                    CSD027
     I                                       76  81 CNUMDK                                    CSD027
0272 I                                       85  860SETPDK
0273 I**********                             87  98 OSACDK                                    CGL029
     I                                       87  98 QQOSAC                                    CGL029
0274 I                                       99 108 TSENDK
0275 I                                      109 118 FACODK
0276 I                                      119 208 SPIDK
0277 I                                      209 209 LAIN
     I                                      261 263 OSBR                  S01117
0278 I                                    P 314 3160LCDDK
0279 I                                      317 317 CHTPDK
0280 I                                    P 318 3200TNLU
     I                                      321 3220RSTMDK                                    CLE034
     I                                      323 334 RONSDK                                    CLE034
     I                                      335 342 RIBNDK                                    CLE034
     I                                      343 377 RIBADK                                    CLE034
     I***********                           378 3830ROBNDK                             CLE034 CSD027
     I                                      378 383 ROBNDK                                    CSD027
     I***********                           384 3890ROCNDK                             CLE034 CSD027
     I                                      384 389 ROCNDK                                    CSD027
     I                                      390 3910PSTMDK                                    CLE034
     I                                      392 403 PONSDK                                    CLE034
     I                                      404 411 PIBNDK                                    CLE034
     I                                      412 446 PIBADK                                    CLE034
     I**********                            447 4520POBNDK                             CLE034 CSD027
     I**********                            453 4580POCNDK                             CLE034 CSD027
     I                                      447 452 POBNDK                                    CSD027
     I                                      453 458 POCNDK                                    CSD027
     I                                      459 466 RCRNDK                                    CLE034
     I                                      467 501 RCRADK                                    CLE034
     I                                      502 509 RVNODK                                    CLE034
     I                                      949 949 CVMRDK                                    CLE034
     I                                     10061006 ASTSDK                CLE002
     I                                     10611063 SCCY                  CEU004
     I                                     10641066 ICCY                  CEU004
     I                                     10671067 ECIN                                      CLE028
     I                                     10681068 REPI                                      CLE028
     I                                    P106910750CHDU                                      CLE028
     I                                    P109010968REXRDK                CLE031
     I                                     10971097 REXIDK                CLE031
     I                                     10981100 PSCYDK                CLE031
     I                                    P110111078PEXRDK                CLE031
     I                                     11081108 PEXIDK                CLE031
     I                                     11091109 STALDK                                    CLE034
     I                                     11101129 FRNTDK                                    CAP075
     I                                     11301149 AFRTDK                                    CAP075
     I                                     11501150 REPADK                                    CAP075
     I                                     11511176 TMSTDK                                    CAP075
     I                                     11771194 OSACDK                                    CGL029
     I                                     12801283 CLASDK                                    CLE042
0281 I**
0282 I**   LOAMS FILE CATCHALL
0283 I        NS
0284 I                                        1   1 RECI
0285 I*
0286 I*****TABLE*FILE***INSTALLATION*CONTROL*DATA*RECORD*1.               S01194
0287 I**********                                                          S01194
0288 I*TABLE***NS       2 C0   3 C1  12 C1                                S01194
0289 I*******AND      13 C0                                               S01194
     I**********                              1   1 RECI                  S01194
0291 I**********                              2   30RECT                  S01194
0292 I**********                             12  130RCDE                  S01194
0293 I**********                             14  66 TITL                  S01194
0294 I**********                             67  67 DATF                  S01194
0295 I***********                            68  700DFBR            20    S01194
0296 I**********                             74  74 MODI1                 S01194
0297 I**********                             75  75 MODI2                 S01194
0298 I**********                             76  76 MODI3                 S01194
0299 I**********                          P  77  790RUND                  S01194
0300 I**********                             80  86 RUNA                  S01194
0301 I**********                             87  870SFLG                  S01194
0302 I**********                          P  90  920LCD                   S01194
0303 I**********                             93  93 CHTP                  S01194
0304 I**********                          P  94  960TNLU                  S01194
0305 I**********                                                          S01194
0306 I**********                                                          S01194
0307 I*****TABLE*FILE***INSTALLATION*CONTROL*DATA*RECORD*2.               S01194
0308 I**********                                                          S01194
0309 I*TABLE***NS              2 C0   3 C1                                S01194
0310 I*******AND      12 C1  13 C1                                        S01194
0311 I**********                              1   1 RECI                  S01194
0312 I**********                              2   30RECT                  S01194
0313 I**********                             12  130RCDE                  S01194
0314 I**********                             14  16 BCCY                  S01194
0315 I**********                             17  19 BCYL                  S01194
0316 I**********                             20  22 HOCY                  S01194
0317 I**********                             23  280HEAD                  S01194
0318 I**********                          P  29  310APDA                  S01194
0319 I**********                             35  35 APFQ                  S01194
0320 I**********                          P  36  380LOGS                  S01194
0321 I**********                             39  40 CUZR                  S01194
0322 I**********                          P  41  430DNWD                  S01194
0323 I**********                             44  460BVLP                  S01194
0324 I**********                             47  49 LOCY                  S01194
0325 I**********                             50  510FDAY                  S01194
0326 I**********                             52  52 ACLD                  S01194
0327 I**********                             86  86 ISAV                  S01194
0328 I**********                          P  87  890LLOG                  S01194
0329 I**********                          P  90  920LCD                   S01194
0330 I**********                             93  93 CHTP                  S01194
0331 I**********                          P  94  960TNLU                  S01194
0332 I**********                                                          S01194
0333 I*****TABLE*FILE***INSTALLATION*CONTROL*DATA*RECORD*5.               S01194
0334 I**********                                                          S01194
0335 I*TABLE***NS              2 C0   3 C1                                S01194
0336 I*******AND      12 C4  13 C0                                        S01194
0337 I**********                              1   1 RECI                  S01194
0338 I**********                              2   30RECT                  S01194
0339 I**********                             12  130RCDE                  S01194
0340 I**********                             18  210CSAC                  S01194
0341 I**********                             22  22 TLII                  S01194
0342 I**********                             23  23 MCRI                  S01194
0343 I**********                          P  24  250MCEP                  S01194
0344 I**********                             26  270MCLP                  S01194
0345 I**********                             28  28 FRDI                  S01194
0346 I**********                             29  29 BRCF                  S01194
0347 I**********                             30  350PSCN                  S01194
0348 I***********                            36  380DLBR                  S01194
0349 I**********                             39  420FRPA                  S01194
0350 I**********                             43  460FRPC                  S01194
0351 I**********                             47  49 USCY                  S01194
0352 I**********                             50  52 STCY                  S01194
0353 I**********                          P  53  553MBGE                  S01194
0354 I**********                             56  56 PRID                  S01194
0355 I**********                             57  57 FFNY                  S01194
0356 I**********                             58  58 OURC                  S01194
0357 I**********                             59  59 BRNC                  S01194
0358 I**********                             60  60 LCYN                  S01194
0354 I**********                             78  78 PRSW                  S01194
0355 I**********                             79  79 PRCI                  S01194
0356 I**********                             80  80 PRCA                  S01194
0357 I**********                             81  81 PRTX                  S01194
0358 I**********                             82  82 PRFW                  S01194
0358 I**********                             83  83 PRBW                  S01194
0359 I**********                          P  90  920LCD                   S01194
0360 I**********                             93  93 CHTP                  S01194
0361 I**********                          P  94  960TNLU                  S01194
0362 I**********                                                          S01194
0363 I*****TABLE*FILE***BRANCH*CODES*RECORD.                              S01194
0364 I**********                                                          S01194
0365 I*TABLE***NS              2 C1   3 C0                                S01194
0366 I**********                              1   1 RECI                  S01194
0367 I**********                              2   30RECT                  S01194
0368 I***********                            11  130BRCD                  S01194
0369 I**********                             14  43 BRNM                  S01194
0370 I**********                             44  490BICN                  S01194
0371 I**********                             50  51 LOCC                  S01194
0372 I***********                            52  53 CMPY                  S01194
0373 I**********                          P  90  920LCD                   S01194
0374 I**********                             93  93 CHTP                  S01194
0375 I**********                          P  94  960TNLU                  S01194
0376 I**********                                                          S01194
0377 I**********                                                          S01194
0378 I*****TABLE*FILE***NOSTROS*RECORD.                                   S01194
0379 I**********                                                          S01194
0380 I*TABLE***NS              2 C7   3 C0                                S01194
0381 I**********                              1   1 RECI                  S01194
0382 I**********                              2   30RECT                  S01194
0383 I**********                              9  11 CCY                   S01194
0384 I**********                             12  130NOSN                  S01194
0385 I**********                             16  29 ONAC                  S01194
0386 I**********                             30  350CNUMTL                S01194
0387 I**********                             36  370ACSQ                  S01194
0388 I**********                             38  410ACOD                  S01194
0389 I**********                          P  90  920LCD                   S01194
0390 I**********                             93  93 CHTP                  S01194
0391 I**********                          P  94  960TNLU                  S01194
0392 I**********                                                          S01194
0393 I**CATCHALL                                                          S01194
0394 I********NS                                                          S01194
0395 I**********                              1   1 RECI                  S01194
     I*****CLIENT*FILE***CUSTOMER*STANDING*DATA*RECORD.                   S01194
     I**********                                                          S01194
     I*CLINT***NS  06   1 CD   8 CA                                       S01194
     I**********                              1   1 RECI                  S01194
     I**********                              2   70CNUMCL                S01194
     I**********                              8   8 RCDTCL                S01194
     I**********                              9  28 CRNM                  S01194
     I**********                             29  38 CTWN                  S01194
     I**********                             39  48 CSNM                  S01194
     I**********                             49  56 CASK                  S01194
     I**********                             57  68 TELX                  S01194
     I**********                                                          S01194
     I**********                             69  80 CSID                  S01194
     I**********                             81  82 ACOC                  S01194
     I**********                             83  83 CBSI                  S01194
     I**********                             84  85 CCTZ                  S01194
     I**********                             86  87 CLOC                  S01194
     I**********                             88  930CPAR                  S01194
     I**********                             94  960BRCDCL                S01194
     I**********                             97  980LINS                  S01194
     I**********                             99 1010LINDCL                S01194
     I**********                          P 102 1040DASU                  S01194
     I**********                          P 105 1070CDIC                  S01194
     I**********                          P 108 1100DADE                  S01194
     I**********                            111 111 CMIN                  S01194
     I**********                            112 112 CTYP                  S01194
     I**********                            113 124 TELF                  S01194
     I**********                            125 133 CHID                  S01194
     I**********                            134 136 CHAB                  S01194
     I**********                            245 245 TLXR                  S01194
     I**********                          P 250 2520LCD                   S01194
     I**********                            253 253 CHTP                  S01194
     I**********                          P 254 2560TNLU                  S01194
     I**********                                                          S01194
     I******CATCHALL                                                      S01194
     I**********                                                          S01194
     I********NS                                                          S01194
     I**********                              1   1 RECI                  S01194
0396 I* D A T A   S T R U C T U R E S
0397 I***   LOCAL DATA AREA
0398 ILDA        UDS                            256
0232 I*******                               134 138 DBFILE                S01117
0233 I*******                               139 167 DBKEY                 S01117
0234 I*******                               168 175 DBPGM                 S01117
0235 I*******                               176 1770DBASE                 S01117
0232 I                                      134 141 DBFILE                S01117
0233 I                                      142 170 DBKEY                 S01117
0234 I                                      171 180 DBPGM                 S01117
0235 I                                      181 1830DBASE                 S01117
     ILESTAL    E DSLESTALPD                                                                  CLE034
      ** External DS for Settlement Allocation Details                                        CLE034
     I              LNRF                            STLNRF                                    CLE034
     I              PONS                            STPONS                                    CLE034
     I              PSTM                            STPSTM                                    CLE034
     I              RSTM                            STRSTM                                    CLE034
     I              RONS                            STRONS                                    CLE034
     I              ROBR                            STROBR                                    CLE034
     I              POBR                            STPOBR                                    CLE034
     I              RSCY                            STSCCY                                    CLE034
     I              REXR                            STREXR                                    CLE034
     I              REXI                            STREXI                                    CLE034
     I              ROBN                            STROBN                                    CLE034
     I              ROCN                            STROCN                                    CLE034
     I              RIBN                            STRIBN                                    CLE034
     I              RIBA                            STRIBA                                    CLE034
     I              PSCY                            STPSCY                                    CLE034
     I              PEXR                            STPEXR                                    CLE034
     I              PEXI                            STPEXI                                    CLE034
     I              POBN                            STPOBN                                    CLE034
     I              POCN                            STPOCN                                    CLE034
     I              PIBN                            STPIBN                                    CLE034
     I              PIBA                            STPIBA                                    CLE034
     I              RVNO                            STRVNO                                    CLE034
     I              CVMR                            STCVMR                                    CLE034
     I              RCRN                            STRCRN                                    CLE034
     I              RCRA                            STRCRA                                    CLE034
     I              LASQ                            STLASQ                                    CLE034
     I              PYBA                            STPYBA                                    CLE038
     I              PYAM                            STPYAM                                    CLE038
     I              RCBA                            STRCBA                                    CLE038
     I              RCAM                            STRCAM                                    CLE038
     I              CCY                             STCCY                                     CLE038
      *                                                                                       CLE034
0403 I* KEY FIELDS ON TRANS/DAIND FOR DUPLICATE KEY TEST
0404 I            DS
0405 I                                        1  14 KEY
0406 I**********                              1   60LNRF                                      CLE148
     I                                        1   6 LNRF                                      CLE148
0407 I                                        7  110VDATLN
0408 I                                       12  140LASNLN
0409 I**S/TABLE*KEY                                                       S01194
0410 I**********  DS                                                      S01194
0411 I**********                              1  12 ZTABKY                S01194
0412 I**********                              1   20RECT                  S01194
0413 I**********                              8  10 CCY                   S01194
0414 I**********                             11  120NOSN                  S01194
0415 I* BLANK AREA FOR INITIALISING
0416 I            DS
0417 I                                        1  90 BLNK90
0418 I                                        1  10 BLNK10
0419 I**THEIR*SETTLEMENT*A/C****START/PURCHASE*                           S01194
0420 I*********** DS                                                      S01194
0421 I***********                             1  10 TSET1                 S01194
0422 I***********                             1  10 TSEN                  S01194
0423 I**TO*CHANGE*SHORT-NAME*TO*CUSTOMER*NUMBER IF APPLICABLE             S01194
0424 I*********** DS                                                      S01194
0425 I***********                             1  10 SNCUST                S01194
0426 I***********                             1   60CNUMCD                S01194
0427 I**SETTLEMENT*TYPE*AT*START/PURCHASE*                                S01194
0428 I*********** DS                                                      S01194
0429 I***********                             1   20SET1                  S01194
0430 I***********                             1   20SDST                  S01194
0431 I* D A T A   S T R U C T U R E   F O R   O U T P U T   R E C O R D
     I*    TO LETX1-3
0432 I            DS
0433 I***********                             1 180 LETX                  S01117
     I***********                             1 181 LETX           S01117 CEU004
     I**********                              1 210 LETX                               CEU004 CGL029
     I****************************************1 228 LETX                               CGL029 CLE042
     I                                        1 232 LETX                                      CLE042
0434 I                                        1   1 RECIPH
0435 I                                        2   2 PAYREC
0436 I                                        3   40SETTLE
0437 I                                        5   7 CURREN
0438 I**********                              8  19 OURAG                                     CGL029
     I                                        8  19 QQOUR                                     CGL029
0439 I* VALUE DATE WILL BE WRITTEN HERE
0440 I                                       23  32 THRAG
0441 I                                       23  32 IFCUST
0442 I***********                            23  280CUST                                      CSD027
     I                                       23  28 CUST                                      CSD027
0443 I***********                            33  380CNUMPH                                    CSD027
     I                                       33  38 CNUMPH                                    CSD027
0444 I**********                             39  440LNRFPH                                    CLE148
     I                                       39  44 LNRFPH                                    CLE148
0445 I* EVENT AMOUNT WILL BE WRITTEN HERE
0446 I                                       52  52 RCDT
0447 I                                       53  54 AMTPPH
0448 I                                       55  570LASNPH
0449 I                                       58  67 OTFACO
0450 I                                       68 157 OTSPI
0451 I                                      158 161 PINDS
0452 I***********                           162 1670BICN                                      CSD027
     I                                      162 167 BICN                                      CSD027
0453 I                                      168 169 LTYP
0454 I                                      170 171 SUTP
0455 I                                      172 1730PTYP
0456 I                                      174 1740TINDPH
0457 I***********                           175 1770BRCD                  S01117
     I                                      175 177 BRCA                  S01117
0458 I                                      178 178 INTCPH
     I                                      179 181 BRCDTX                S01117
     I* Original transaction amount wull be written here                  CEU004
     I                                      208 210 OTCY                  CEU004
     I                                      211 228 OURAG                                     CGL029
     I                                      229 232 CLAS                                      CLE042
     I/EJECT                                                              S11117
     I**
     ISDBANK    E DSSDBANKPD                                              S01194
      **  EXTERNAL DS FOR BANK DETAILS                                    S01194
     I              BJURPT                          TITL                  S01194
     I              BJLCCY                          LOCY                  S01194
     I              BJMRDT                          RUNA                  S01194
     I              BJSBRC                          DFBM                  S01194
     ISDGELR    E DSSDGELRPD                                              S01194
      **  EXTERNAL DS FOR GENERAL LEDGER DETAILS                          S01194
     ISDTRAD    E DSSDTRADPD                                              S01194
      **  EXTERNAL DS FOR GENERAL LEDGER DETAILS                          S01194
     I              BLSWPY                          PRSW                  S01194
     I              BLTXPY                          PRTX                  S01194
     I              BLLCTB                          LCYN                  S01194
     I              QQACCD                          QQACC1                                    CGL029
     ISDNOST    E DSSDNOSTPD                                              S01194
      **  EXTERNAL DS FOR NOSTRO DETAILS                                  S01194
     I              A7CUST                          CNUMTL                S01194
     I              QQACCD                          QQACC2                                    CGL029
     ISDCUST    E DSSDCUSTPD                                              S01194
      **  EXTERNAL DS FOR CUSTOMER DETAILS                                S01194
     I              BBGSFM                          GSFM                  S01194
     I              BBCSID                          CSID                  S01194
     ISDBRCH    E DSSDBRCHPD                                              S01194
     I              QQDFAC                          QQDFC1                                    CGL029
     I**                                                                  S01194
     ISCSARD    E DSSCSARDPD                                              CLE002
     I**  External data structure for SAR Details                         CLE002
     I**                                                                  CLE002
     ISDCLND    E DSSDCLNDPD                                              CLE002
     I**  External data structure for Customer Lending ICD                CLE002
     I**                                                                  CLE002
     ISDCURR    E DSSDCURRPD                                              CLE031
      ** Currency Type                                                    CLE031
      *                                                                   CLE031
     IDSFDY     E DSDSFDY                                                 S01194
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01194
     I*                                                                   S01194
     IDSSDY     E DSDSSDY                                                 S01194
     I* SECOND DS FOR ACCESS PROGRAMS, LONG DATA STRUCTURE                S01194
     I*                                                                   S01194
     C** PARAMETER LIST FOR PROGRAM 'AOBANKR0'                            S01194
     C           PLISTA    PLIST                                          S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDBANK    PARM SDBANK    DSFDY                           S01194
     C** PARAMETER LIST FOR PROGRAM 'AOGELRR0'                            S01194
     C*                                                                   S01194
     C           PLISTB    PLIST                                          S01194
     C                     PARM '*MSG   ' @RTCD                           S01194
     C                     PARM '*FIRST ' @OPTN                           S01194
     C********** SDGELR    PARM SDGELR    DSFDY                           S01194       S01194 CAS011
     C           SDGELR    PARM SDGELR    DSSDY                                               CAS011
     C*                                                                   S01194
     C** PARAMETER LIST FOR PROGRAM 'AOTRADR0'                            S01194
     C*                                                                   S01194
     C           PLISTC    PLIST                                          S01194
     C                     PARM '*MSG   ' @RTCD                           S01194
     C                     PARM '*FIRST ' @OPTN                           S01194
     C           SDTRAD    PARM SDTRAD    DSFDY                           S01194
     C*                                                                   S01194
     C** PARAMETER LIST FOR PROGRAM 'AOBRCHR0'                            S01194
     C           PLIST1    PLIST                                          S01194
     C                     PARM '*MSG   ' @RTCD                           S01194
     C                     PARM '*KEY   ' @OPTN                           S01194
     C                     PARM           BRCKEY  3                       S01194
     C           SDBRCH    PARM SDBRCH    DSFDY                           S01194
     C** PARAMETER LIST FOR PROGRAM 'AONOSTR0'                            S01194
     C*                                                                   S01194
     C           PLIST2    PLIST                                          S01194
     C                     PARM '*MSG   ' @RTCD                           S01194
     C                     PARM '*KEY   ' @OPTN                           S01194
     C                     PARM           KEYA    6                    A  S01194
     C***********          PARM           CCY     3                S01194 137920
     C                     PARM           AONCCY  3        -Key Ccy    B  137920
     C**********           PARM           KEYC    4                    C               S01194 CGL029
     C                     PARM           KEYC   10                                           CGL029
     C                     PARM           KEYD    2                    D  S01194
     C                     PARM           NOSN    2                    E  S01194
     C                     PARM           KEYF    3                    F  S01194
     C                     PARM           KEYG   10                    G  S01194
     C                     PARM           KEYH    1                    H  S01194
     C           SDNOST    PARM SDNOST    DSFDY                           S01194
     C*                                                                   S01194
     C** PARAMETER LIST FOR PROGRAM 'AOCUSTR0'                            S01194
     C           PLIST3    PLIST                                          S01194
     C                     PARM '*MSG   ' @RTCD                           S01194
     C                     PARM '*KEY   ' @OPTN                           S01194
     C                     PARM           CKEY   10                       S01194
     C                     PARM '*CNUM  ' KEYSTS  7                       S01194
     C           SDCUST    PARM SDCUST    DSSDY                           S01194
     C                     MOVEACPY@      BIS@   80
0459 C* 1 S T   C Y C L E   P R O C E S S I N G
0460 C   40                GOTO START
0461 C                     SETON                     40
     C           *NAMVAR   DEFN           LDA                             S01194
0462 C**
0463 C**   RECORD PROGRAM NAME IN CASE OF DBERR
0464 C                     MOVE 'LE1068'  DBPGM
0465 C                     MOVE 'D'       RECIPH
0466 C                     MOVEL'10'      BRKEY  12
0467 C**
0468 C**   ACCESS I.C.D.R. 1
     C**********           EXSR ZSYSTM                                    S01194
     C***99*****           SETON                     LRU7U8               S01194
     C***99*****           MOVE '01'      DBASE            ** DBASE 01 ** S01194
     C***99*****           GOTO DBERR                                     S01194
     C                     CALL 'AOBANKR0'PLISTA                          S01194
     C           @RTCD     IFNE *BLANKS                                   S01194
0199 C                     SETON                     U7U8LR**DATABASE 01**S01194
0200 C                     Z-ADD1         DBASE                           S01194
0202 C                     MOVE 'SDBANKPD'DBFILE                          S01194
     C                     GOTO END                                       S01194
     C                     END                                            S01194
      *                                                                   CLE002
      ** Check if SAR CLE002 is present                                   CLE002
      *                                                                   CLE002
     C                     CALL 'AOSARDR0'                                CLE002
     C                     PARM *BLANKS   P@RTCD  7                       CLE002
     C                     PARM '*KEY   ' P@OPTN  7                       CLE002
     C                     PARM 'CLE002'  P@SARD  6                       CLE002
     C           SCSARD    PARM SCSARD    DSFDY                           CLE002
      *                                                                   CLE002
     C           P@RTCD    IFEQ *BLANKS                                   CLE002
     C                     MOVE *ON       CLE002  1                       CLE002
     C                     ELSE                                           CLE002
      *                                                                   CLE002
      ** Handle Database Error                                            CLE002
      *                                                                   CLE002
     C           P@RTCD    IFNE '*NRF    '                                CLE002
     C                     MOVEL'SCSARDPD'DBFILE           ************   CLE002
     C                     Z-ADD13        DBASE            * DBERR 13 *   CLE002
     C                     MOVEL'CLE002'  DBKEY     P      ************   CLE002
     C                     MOVE *ON       *INLR                           CLE002
     C                     MOVE *ON       *INU7                           CLE002
     C                     MOVE *ON       *INU8                           CLE002
     C                     GOTO END                                       CLE002
     C                     ENDIF                                          CLE002
      *                                                                   CLE002
     C                     ENDIF                                          CLE002
      *                                                                   CLE002
      ** If CLE002 is present, Access ICD                                 CLE002
      *                                                                   CLE002
     C           CLE002    IFEQ *ON                                       CLE002
      *                                                                   CLE002
     C                     CALL 'AOCLNDR0'                                CLE002
     C                     PARM *BLANKS   P@RTCD  7                       CLE002
     C                     PARM '*FIRST ' P@OPTN  7                       CLE002
     C********** SDCLND    PARM SDCLND    DSFDY                                        CLE002 CLE134
     C           SDCLND    PARM SDCLND    DSSDY                                               CLE134
      *                                                                   CLE002
      ** Handle Database Error                                            CLE002
      *                                                                   CLE002
     C           P@RTCD    IFNE *BLANKS                                   CLE002
     C                     MOVEL'SDCLNDPD'DBFILE           ************   CLE002
     C                     Z-ADD14        DBASE            * DBERR 14 *   CLE002
     C                     MOVEL'*FIRST'  DBKEY     P      ************   CLE002
     C                     MOVE *ON       *INLR                           CLE002
     C                     MOVE *ON       *INU7                           CLE002
     C                     MOVE *ON       *INU8                           CLE002
     C                     GOTO END                                       CLE002
     C                     ENDIF                                          CLE002
      *                                                                   CLE002
     C                     ENDIF                                          CLE002
      *                                                                                       CLE028
      ** Check if Flat Rate Personal Loans (Rule of 78s) is installed                         CLE028
      *                                                                                       CLE028
     C                     CALL 'AOSARDR0'                                                    CLE028
     C                     PARM *BLANKS   PRTCD   7                                           CLE028
     C                     PARM '*VERIFY' POPTN   7                                           CLE028
     C                     PARM 'CLE028'  PSARD   6                                           CLE028
     C           SCSARD    PARM SCSARD    DSFDY                                               CLE028
      *                                                                                       CLE028
     C           PRTCD     IFNE *BLANKS                                                       CLE028
     C           PRTCD     ANDNE'*NRF   '                                                     CLE028
     C                     MOVEL'SCSARDPD'DBFILE                                              CLE028
     C                     Z-ADD016       DBASE                                               CLE028
     C                     MOVELPSARD     DBKEY                                               CLE028
     C                     MOVE *ON       *INU7                                               CLE028
     C                     MOVE *ON       *INU8                                               CLE028
     C                     MOVE *ON       *INLR                                               CLE028
     C                     GOTO END                                                           CLE028
     C                     ENDIF                                                              CLE028
      *                                                                                       CLE028
     C           PRTCD     IFEQ *BLANKS                                                       CLE028
     C                     MOVE 'Y'       CLE028  1                                           CLE028
     C                     ELSE                                                               CLE028
     C                     MOVE 'N'       CLE028                                              CLE028
     C                     ENDIF                                                              CLE028
0474 C**                                                                  S01194
0475 C**   DEFAULT BRANCH CODE BLANK                                      S01194
0476 C***20*****           SETON                     44                   S01194
     C           DFBM      COMP *BLANKS                  44               S01194
0477 C**                                                                  S01194
0478 C**   ACCESS I.C.D.R. 2                                              S01194
     C**********           MOVE ' 11'     ZTABKY                          S01194
     C**********           EXSR TABCHN                                    S01194
     C**********           CALL 'AOGELRR0'PLISTB                                       S01194 CGL029
     C                     CALL 'AOGELRR1'PLISTB                                              CGL029
     C           @RTCD     IFNE *BLANKS                                   S01194
     C                     SETON                     LRU7U8               S01194
     C                     Z-ADD2         DBASE            ** DBASE 02 ** S01194
     C                     MOVE 'SDGELRPD'DBFILE                          S01194
     C                     GOTO END                                       S01194
     C                     END                                            S01194
     C***99*****           SETON                     LRU7U8               S01194
     C***99*****           MOVE '02'      DBASE            ** DBASE 02 ** S01194
     C***99*****           GOTO DBERR                                     S01194
0485 C**
0486 C**   ACCESS I.C.D.R. 5
     C**********           MOVE ' 40'     ZTABKY                          S01194
     C**********           EXSR TABCHN                                    S01194
     C                     CALL 'AOTRADR0'PLISTC                          S01194
     C           @RTCD     IFNE *BLANKS                                   S01194
     C                     SETON                     LRU7U8               S01194
     C                     Z-ADD3         DBASE            ** DBASE 03 ** S01194
     C                     MOVE 'SDTRADPD'DBFILE                          S01194
     C                     GOTO END                                       S01194
     C                     END                                            S01194
     C***99*****           SETON                     LRU7U8               S01194
     C***99*****           MOVE '03'      DBASE            ** DBASE 03 ** S01194
     C***99*****           GOTO DBERR                                     S01194
0493 C**
0494 C**   IS LOCAL CCY NOSTRO-TELEX OR BANK AUTHORISATION
0495 C           LCYN      COMP 'B'                      54
0496 C**IF*SINGLE*BRANCH*INSTALL'N*BYPASS,ELSE*ACCESS*BRANCH*CODES TABLE  S01194
0496 C* IF SINGLE BRANCH INSTALL'N BYPASS,ELSE ACCESS BRANCH CODES A/O    S01194
0497 C   44                GOTO END
0498 C***********          MOVE DFBR      ZTABKY                          S01117
0498 C**********           MOVE DFBM      ZTABKY                          S01117
     C**********           MOVEL'10'      ZTABKY                          S01194
     C**N42*****           EXSR TABCHN                                    S01194
     C                     MOVE DFBM      BRCKEY                          S01194
     C**********           CALL 'AOBRCHR0'PLIST1                                       S01194 CGL029
     C                     CALL 'AOBRCHR1'PLIST1                                              CGL029
     C           @RTCD     IFNE *BLANKS                                   S01194
     C                     SETON                     LRU7U8               S01194
     C                     Z-ADD4         DBASE                        ** S01194
     C                     MOVELBRCKEY    DBKEY            ** DBASE 04 ** S01194
     C                     MOVEL'SDBRCHPD'DBFILE                       ** S01194
     C                     GOTO END                                       S01194
     C                     END                                            S01194
     C                     MOVE A8BICN    BICN                            S01194
      *                                                                   CEU004
      ** Access SAR details file to see if CEU004 is installed            CEU004
      *                                                                   CEU004
     C                     MOVE 'N'       CEU004  1        Set SAR Flag   CEU004
      *                                                                   CEU004
     C                     CALL 'AOSARDR0'                 Rtv SAR Dtls   CEU004
      *                                                    Input:         CEU004
     C                     PARM *BLANKS   P@RTCD  7        -Return Code   CEU004
     C                     PARM '*VERIFY' P@OPTN  7        -Option        CEU004
     C                     PARM 'CEU004'  P@SARD  6        -SAR No        CEU004
      *                                                    Output:        CEU004
     C           SCSARD    PARM SCSARD    DSFDY            -Format        CEU004
      *                                                                   CEU004
     C           P@RTCD    IFEQ *BLANKS                    If Found       CEU004
     C                     MOVE 'Y'       CEU004            Set SAR Flag  CEU004
      *                                                                   CEU004
     C                     ELSE                            Else           CEU004
     C           P@RTCD    IFNE '*NRF   '                   If # NoRecFnd CEU004
     C                     MOVEL'SCSARDPD'DBFILE             Set File     CEU004
     C                     MOVEL'*VERIFY' DBKEY              Set Key      CEU004
     C                     Z-ADD15        DBASE              Set DBase RefCEU004
     C                     SETON                     U7U8LR  Set Ind      CEU004
     C                     GOTO END                          Bypass       CEU004
     C                     ENDIF                            End If        CEU004
     C                     ENDIF                           End If         CEU004
      *                                                                   CLE031
      ** Access SAR details file to see if CLE031 is installed            CLE031
      *                                                                   CLE031
     C                     MOVE 'N'       CLE031  1                       CLE031
      *                                                                   CLE031
     C                     CALL 'AOSARDR0'                                CLE031
      *                                                                   CLE031
     C                     PARM *BLANKS   P@RTCD                          CLE031
     C                     PARM '*VERIFY' P@OPTN                          CLE031
     C                     PARM 'CLE031'  P@SARD                          CLE031
     C           SCSARD    PARM SCSARD    DSFDY                           CLE031
      *                                                                   CLE031
     C           P@RTCD    IFEQ *BLANKS                                   CLE031
     C                     MOVE 'Y'       CLE031                          CLE031
     C                     ELSE                                           CLE031
     C           P@RTCD    IFNE '*NRF   '                                 CLE031
     C                     MOVEL'SCSARDPD'DBFILE                          CLE031
     C                     MOVEL'*VERIFY' DBKEY                           CLE031
     C                     Z-ADD16        DBASE                           CLE031
     C                     SETON                     U7U8LR               CLE031
     C                     GOTO END                                       CLE031
     C                     ENDIF                                          CLE031
     C                     ENDIF                                          CLE031
      *                                                                                       CLE034
      **  Check if CLE034 - Lending Enhancements Phase 1                                      CLE034
      **  Priority 1A is installed.                                                           CLE034
      *                                                                                       CLE034
     C                     MOVE 'N'       CLE034  1                                           CLE034
      *                                                                                       CLE034
     C                     CALL 'AOSARDR0'                                                    CLE034
      *                                                                                       CLE034
     C                     PARM *BLANKS   P@RTCD                                              CLE034
     C                     PARM '*VERIFY' P@OPTN                                              CLE034
     C                     PARM 'CLE034'  P@SARD                                              CLE034
     C           SCSARD    PARM SCSARD    DSFDY                                               CLE034
      *                                                                                       CLE034
     C           P@RTCD    IFEQ *BLANKS                                                       CLE034
     C                     MOVE 'Y'       CLE034                                              CLE034
     C                     ELSE                                                               CLE034
     C           P@RTCD    IFNE '*NRF   '                                                     CLE034
     C                     MOVEL'SCSARDPD'DBFILE                                              CLE034
     C                     MOVEL'CLE034 ' DBKEY                                               CLE034
     C                     Z-ADD31        DBASE                                               CLE034
     C                     MOVE *ON       *INLR                                               CLE034
     C                     MOVE *ON       *INU7                                               CLE034
     C                     MOVE *ON       *INU8                                               CLE034
     C                     GOTO END                                                           CLE034
     C                     ENDIF                                                              CLE034
     C                     ENDIF                                                              CLE034
      *                                                                                       CLE038
      ** Check if CLE038 is on                                                                CLE038
      *                                                                                       CLE038
     C                     MOVE 'N'       CLE038  1                                           CLE038
      *                                                                                       CLE038
     C                     CALL 'AOSARDR0'                                                    CLE038
      *                                                                                       CLE038
     C                     PARM *BLANKS   P@RTCD                                              CLE038
     C                     PARM '*VERIFY' P@OPTN                                              CLE038
     C                     PARM 'CLE038'  P@SARD                                              CLE038
     C           SCSARD    PARM SCSARD    DSFDY                                               CLE038
      *                                                                                       CLE038
     C           P@RTCD    IFEQ *BLANKS                                                       CLE038
     C                     MOVE 'Y'       CLE038                                              CLE038
     C                     ELSE                                                               CLE038
     C           P@RTCD    IFNE '*NRF   '                                                     CLE038
     C                     MOVEL'SCSARDPD'DBFILE                                              CLE038
     C                     MOVEL'CLE038 ' DBKEY                                               CLE038
     C                     Z-ADD32        DBASE                                               CLE038
     C                     MOVE *ON       *INLR                                               CLE038
     C                     MOVE *ON       *INU7                                               CLE038
     C                     MOVE *ON       *INU8                                               CLE038
     C                     GOTO END                                                           CLE038
     C                     ENDIF                                                              CLE038
     C                     ENDIF                                                              CLE038
     C/COPY WNCPYSRC,LE1068C001
      *                                                                   CEU004
     C***99*****           SETON                     LRU7U8               S01194
     C***99*****           MOVE '04'      DBASE            ** DBASE 04 ** S01194
     C**N99*****           GOTO END                                       S01194
     C********** DBERR     TAG                             ** DBERR TAG **S01194
     C**********           MOVE 'TABLE'   DBFILE                          S01194
     C**********           MOVELZTABKY    DBKEY                           S01194
     C**********           GOTO END                                       S01194
0507 C           START     TAG                             ** START TAG **
0508 C* RESET INDS.
0509 C                     SETOF                     4849
      *                                                                                       230521
      ** Initialise field.                                                                    230521
      *                                                                                       230521
     C                     Z-ADD0         LFCN    60                                          230521
      *                                                                                       230521
0510 C* M A I N L I N E   O F   P R O C E S S I N G
0511 C**
0512 C**   LTRIN DETAIL
0513 C   02                EXSR PROC5
0514 C**
0515 C**   LTRIN TRAILER
0516 C   03                EXSR TTRANS                     CONTROLS
0517 C           END       TAG                             **  END TAG  **
0518 C* E N D   O F   M A I N L I N E
0519 C* FOR CONTROLS ON S/LETX TRAILERS
      *                                                                   S01117
0520 CLR         ROP,1     ADD  2         ROP,1
0521 CLR         ROP,2     ADD  2         ROP,2
0522 CLR         ROP,3     ADD  2         ROP,3
0522 CLR         ROP,4     ADD  2         ROP,4
0566 CLR U1      ROP,5     ADD  2         ROP,5                           S2659
      *                                                                   S01117
     CLR U7 U8             EXSR *PSSR                                     S01117
0523 C********************************************************************
0524 C* P R O C E S S  .5.      - S / L T R I N
0525 C*
0526 C*    PROC5 IS CALLED BY - MAIN PROCESSING
0527 C*
0528 C*             CALLS - PROC1;PROC2
0529 C*
0530 C********************************************************************
0531 C           PROC5     BEGSR                           ***  PROC5  ***
0532 C* I/P CONTROLS
0533 C           COUNT     ADD  1         COUNT   50
0534 C*
0533 C**
     **    DO NOT PROCESS S/LTRIN RECORDS CREATED BY REPRINT CONFS.
0536 C           RRLA      COMP 0                        42
0537 C   42                GOTO P5END
0533 C**
0535 C* THIS KEY EQ. LAST KEY - IF SO GOTO END.
0536 C           KEY       COMP PREKEY                   42
0537 C   42                GOTO P5END
0538 C                     MOVE KEY       PREKEY 14        SAVE KEY FIELD
0539 C           CHTP      COMP 'A'                      42
0540 C  N42      CHTP      COMP 'I'                      42
0541 C*  42 SET IF ACTION CODE EQ 'A' OR 'I'
0542 C* IF ANY PAY/RECEIVE IND SET AND '42' THEN CONTINUE - ELSE END
0543 C*
0544 C  N21
0545 CORN42                GOTO P5END                      ELSE OPTION
0546 C**
0547 C**   DOES LTRIN REFER TO LOAN OR AMENDMENT - PROCESS ACCORDINGLY
0548 C           RCDT      COMP 'L'                      42
     C  N42      RCDT      COMP 'R'                      42               S01392
0549 C   42                EXSR PROC1                      DO LOAN
0550 C           RCDT      COMP 'A'                      42
0551 C   42                EXSR PROC2                      DO AMENDMENT
0552 C*
0553 C           P5END     ENDSR                           ** P5END TAG **
0554 C********************************************************************
0555 C* P R O C E S S  .1.      - L O A N S
0556 C*
0557 C*    PROC1 IS CALLED BY - PROC5
0558 C*
0559 C*             CALLS - PROCAA
0560 C*
0561 C********************************************************************
0562 C           PROC1     BEGSR                           ***  PROC1  ***
0563 C*    ACCESS S/CLOAN - 'A' & 'B' RECORDS
0564 C                     SETOF                     22
0565 C                     MOVELLNRF      CLKEY   7
0566 C                     MOVE 'B'       CLKEY
0567 C           AGAIN     TAG                             ** AGAIN TAG **
0568 C           CLKEY     CHAINCLOAN                41
0569 C   41                SETON                     LRU7U8
0570 C   41                MOVE '05'      DBASE            ** DBASE 05 **
0571 C   41                MOVE 'CLOAN'   DBFILE
0572 C   41                MOVELCLKEY     DBKEY
0573 C           RECI      COMP 'D'                      42
0574 C   22                GOTO OUT
0575 C   42N41             MOVE 'A'       CLKEY
0576 C   42N41             SETON                     22
0577 C   22                GOTO AGAIN
0578 C           OUT       TAG                             **  OUT TAG  **
0579 C   41
0580 CORN42                GOTO P1END
      *                                                                   CLE002
      ** If SAR CLE002 is present                                         CLE002
      *                                                                   CLE002
     C           CLE002    IFEQ *ON                                       CLE002
      *                                                                   CLE002
      ** If Authorization is *ON                                          CLE002
      *                                                                   CLE002
     C           BPLOAU    IFEQ 'Y'                                       CLE002
     C           BPPPAU    OREQ 'Y'                                       CLE002
     C           BPPSAU    OREQ 'Y'                                       CLE002
      *                                                                   CLE002
      ** If not Authorized                                                CLE002
      *                                                                   CLE002
     C           LSTS      IFNE 'A'                                       CLE002
     C                     GOTO P1END                                     CLE002
     C                     ENDIF                                          CLE002
      *                                                                   CLE002
     C                     ENDIF                                          CLE002
      *                                                                   CLE002
     C                     ENDIF                                          CLE002
     C/COPY WNCPYSRC,LE1068C002
0581 C*
0582 C* 'CASE' ON TYPE OF CLOAN
0583 C*
0584 C           PTYP      LOKUPTABTP1                   45
0585 C           PTYP      LOKUPTABTP2                   46
0586 C           PTYP      LOKUPTABTP3                   47
0587 C   45
0588 COR 46                EXSR PROCAA
0589 C* A N Y   O T H E R S
0590 C* NULL
0591 C*
0592 C           P1END     ENDSR                           ** P1END TAG **
0593 C********************************************************************
0594 C* P R O C E S S  .2.      - L O A N   A M E N D M E N T S
0595 C*
0596 C*    PROC2 IS CALLED BY - PROC5
0597 C*
0598 C*             CALLS - PROCCC
0599 C*
0600 C********************************************************************
0601 C           PROC2     BEGSR                           ***  PROC2  ***
0602 C*    ACCESS LOAMS
0603 C           KEY       CHAINLOAMS                41
0604 C   41                SETON                     LRU7U8
0605 C   41                MOVE '06'      DBASE            ** DBASE 06
0606 C   41                MOVE 'LOAMS'   DBFILE
0607 C   41                MOVELKEY       DBKEY
0608 C   41                GOTO P2END
0609 C* TEST IF TELEX BIT ON OR OFF
0610 C                     TESTB'1'       LAIN           42-IF ON
0611 C  N42      AMTPDK    COMP 'PI'                 4242
0612 C  N04
0613 COR 42                GOTO P2END
0614 C**
0615 C**   ACCESS CLOAN 'A' RECORD
0616 C                     MOVELLNRF      CLKEY
0617 C                     MOVE 'A'       CLKEY
0618 C           CLKEY     CHAINCLOAN                41
0619 C   41                SETON                     LRU7U8
0620 C   41                MOVE '07'      DBASE            ** DBASE 07 **
0621 C   41                MOVE 'CLOAN'   DBFILE
0622 C   41                MOVELCLKEY     DBKEY
0623 C   41                GOTO P2END
0624 C           RECI      COMP 'D'                      42
0625 C  N42                GOTO P2END
      *                                                                   CLE002
      ** If SAR CLE002 is present                                         CLE002
      *                                                                   CLE002
     C           CLE002    IFEQ *ON                                       CLE002
      *                                                                   CLE002
      ** If Authorization is *ON                                          CLE002
      *                                                                   CLE002
     C           BPLMAU    IFEQ 'Y'                                       CLE002
     C           BPMRAU    OREQ 'Y'                                       CLE002
     C           BPREAU    OREQ 'Y'                                       CLE002
     C           BPTPAU    OREQ 'Y'                                       CLE002
      *                                                                   CLE002
      ** If not Authorized                                                CLE002
      *                                                                   CLE002
     C           ASTSDK    IFNE 'A'                                       CLE002
     C                     GOTO P2END                                     CLE002
     C                     ENDIF                                          CLE002
      *                                                                   CLE002
     C                     ENDIF                                          CLE002
      *                                                                   CLE002
     C                     ENDIF                                          CLE002
     C/COPY WNCPYSRC,LE1068C003
0626 C**
0627 C**  'CASE' ON TYPE OF RELATED CLOAN
0628 C           PTYP      LOKUPTABTP1                   45
0629 C           PTYP      LOKUPTABTP2                   46
0630 C           PTYP      LOKUPTABTP3                   47
0631 C   45
0632 COR 46                EXSR PROCCC
0633 C*
0634 C           P2END     ENDSR                           ** P2END TAG **
0635 C********************************************************************
0636 C********************************************************************
0637 C*            L  O  A  N  S
0638 C*                                                    * LEP1068-AA  *
0639 C*    PROCAA IS CALLED BY - PROC1
0640 C*
0641 C*             CALLS - CREATE
0642 C*
0643 C********************************************************************
0644 C           PROCAA    BEGSR                           *** PROCAA ***
0645 C                     SETON                     48
0646 C**
0647 C**   START DATE TELEX INDICATOR MUST BE OFF,PAY/REC.INDIC MUST = 1
0648 C                     TESTB'0'       TLXI           42
0649 C   42
0650 CORN21                GOTO ENDAA
0651 C                     MOVE SDST      SETTLE
0652 C   45                MOVE 'P'       PAYREC
0653 C   46                MOVE 'R'       PAYREC
      *                                                                                       CLE034
      ** If CLE034 is on..                                                                    CLE034
      *                                                                                       CLE034
     C           CLE034    IFEQ 'Y'                                                           CLE034
     C           RCDT      ANDEQ'L'                                                           CLE034
     C           STAL      ANDEQ'Y'                                                           CLE034
     C           CLE034    OREQ 'Y'                                                           CLE034
     C           RCDT      ANDEQ'R'                                                           CLE034
     C           STAL      ANDEQ'Y'                                                           CLE034
     C                     MOVE PAYREC    WKPYRC  1                                           CLE034
     C           *IN45     IFEQ *ON                                                           CLE034
     C           *IN46     OREQ *ON                                                           CLE034
     C                     MOVE 'Y'       WKPROC  1                                           CLE034
     C                     EXSR SR34A                                                         CLE034
     C                     ELSE                                                               CLE034
     C                     MOVE *BLANKS   WKFLD   1                                           CLE034
     C                     ENDIF                                                              CLE034
     C                     ELSE                                                               CLE034
     C                     MOVE 'Y'       WKFLD                                               CLE034
     C                     MOVE '*EOF   ' PRETCD                                              CLE034
     C                     ENDIF                                                              CLE034
      *                                                                                       CLE034
     C           WKFLD     DOWEQ'Y'                                                           CLE034
     C           PRETCD    OREQ *BLANK                                                        CLE034
      *                                                                                       CLE034
     C           CLE034    IFEQ 'Y'                                                           CLE034
     C           WKPROC    ANDEQ'Y'                                                           CLE034
     C                     EXSR SR34D                                                         CLE034
      *                                                                                       CLE034
0654 C                     MOVE OSDA      OURAG
     C                     MOVE OSDB      BRCDTX                          S01117
0655 C                     MOVE TSTN      THRAG
0656 C                     MOVE CCY       CURREN
      *                                                                   CEU004
      ** If feature CEU004 is on,                                         CEU004
      ** If the Settlement Ccy *NE transaction Ccy, set field CURREN.     CEU004
      *                                                                   CEU004
     C           CEU004    IFEQ 'Y'                        If Feature On  CEU004
     C           CLE031    OREQ 'Y'                                       CLE031
      *                                                                   CEU004
     C*********  SCCY      IFNE CCY                   If Ccys # Eql CEU004CLE031
     C           CEU004    IFEQ 'Y'                                       CLE031
     C           SCCY      ANDNECCY                                       CLE031
     C           SCCY      ANDNE*BLANKS                     And Set # Blk 137920
     C           CLE031    OREQ 'Y'                                       CLE031
     C           PSCY      ANDNECCY                                       CLE031
     C           PSCY      ANDNE*BLANKS                                   CLE031
     C           *IN45     ANDEQ*ON                                       CLE031
     C           CLE031    OREQ 'Y'                                       CLE031
     C           SCCY      ANDNECCY                                       CLE031
     C           SCCY      ANDNE*BLANKS                                   CLE031
     C           *IN46     ANDEQ*ON                                       CLE031
      *                                                                   CLE031
     C                     CALL 'AOCURRR0'             99                 CLE031
     C                     PARM '*MSG    '@RTCD   7                       CLE031
     C                     PARM '*KEY    '@OPTN   7                       CLE031
     C                     PARM CCY       CURKEY  3                       CLE031
     C           SDCURR    PARM SDCURR    DSSDY                           CLE031
      *                                                                   CLE031
     C           @RTCD     IFNE *BLANKS                                   CLE031
     C                     SETON                     U7U8LR               CLE031
     C                     Z-ADD17        DBASE                           CLE031
     C                     MOVE 'SDCURRPD'DBFILE                          CLE031
     C                     MOVELCCY       DBKEY                           CLE031
     C                     GOTO ENDAA                                     CLE031
     C                     ENDIF                                          CLE031
      *                                                                   CLE031
     C                     MOVE A6INCY    LCCYIN  1                       CLE031
      *                                                                   CLE031
     C           *IN45     IFEQ *ON                                       CLE031
     C           PSCY      ANDNE*BLANKS                                   CLE031
     C                     MOVE PSCY      CURKEY                          CLE031
     C                     ENDIF                                          CLE031
      *                                                                   CLE031
     C           *IN46     IFEQ *ON                                       CLE031
     C           SCCY      ANDNE*BLANKS                                   CLE031
     C                     MOVE SCCY      CURKEY                          CLE031
     C                     ENDIF                                          CLE031
      *                                                                   CLE031
     C                     CALL 'AOCURRR0'             99                 CLE031
     C                     PARM '*MSG    '@RTCD   7                       CLE031
     C                     PARM '*KEY    '@OPTN   7                       CLE031
     C                     PARM           CURKEY  3                       CLE031
     C           SDCURR    PARM SDCURR    DSSDY                           CLE031
      *                                                                   CLE031
     C           @RTCD     IFNE *BLANKS                                   CLE031
     C                     SETON                     U7U8LR               CLE031
     C                     Z-ADD18        DBASE                           CLE031
     C                     MOVE 'SDCURRPD'DBFILE                          CLE031
     C                     MOVELCURKEY    DBKEY                           CLE031
     C                     GOTO ENDAA                                     CLE031
     C                     ENDIF                                          CLE031
      *                                                                   CLE031
     C                     MOVE A6INCY    SCCYIN  1                       CLE031
      *                                                                   CLE031
     C           LCCYIN    IFEQ 'Y'                                       CLE031
     C           SCCYIN    OREQ 'Y'                                       CLE031
     C***********          MOVE SCCY      CURREN             Set CcCEU004 CLE031
     C                     MOVE CURKEY    CURREN             Set Ccy Fld  CLE031
     C                     MOVE CCY       CCYSV   3         Set Ccy sv fld135378
     C                     MOVE EAMT      AMTSV  130        Set Amt sv fld135378
     C                     ELSE                                           CLE031
     C           *IN45     IFEQ *ON                                       CLE031
     C           PSCY      ANDNE*BLANKS                                   CLE031
     C                     MOVE PSCY      CURREN                          CLE031
     C                     MOVE CCY       CCYSV                           CLE031
     C                     Z-ADDPEXR      WEXR   138                      CLE031
     C                     MOVE PEXI      WEXI    1                       CLE031
     C                     ENDIF                                          CLE031
     C           *IN46     IFEQ *ON                                       CLE031
     C           SCCY      ANDNE*BLANKS                                   CLE031
     C                     MOVE SCCY      CURREN                          CLE031
     C                     MOVE CCY       CCYSV                           CLE031
     C                     Z-ADDREXR      WEXR                            CLE031
     C                     MOVE REXI      WEXI                            CLE031
     C                     ENDIF                                          CLE031
     C                     ENDIF                                          CLE031
     C                     ENDIF                            End If        CEU004
      *                                                                   CEU004
     C                     ENDIF                           End If         CEU004
      *                                                                   CEU004
0657 C**
0658 C**   SET UP & WRITE OUTPUT RECORDS
0659 C                     EXSR CREATE
     C                     ENDIF                                                              CLE034
      *                                                                                       CLE034
     C           CLE034    IFEQ *ON                                                           CLE034
     C           WKPROC    ANDEQ'Y'                                                           CLE034
     C                     EXSR SR34C                                                         CLE034
     C                     ELSE                                                               CLE034
     C                     MOVE *BLANKS   WKFLD                                               CLE034
     C                     ENDIF                                                              CLE034
     C                     ENDDO                                                              CLE034
      *                                                                                       CLE034
     C           CLE034    IFEQ *ON                                                           CLE034
     C           WKPROC    ANDEQ'Y'                                                           CLE034
     C                     EXSR SR34E                                                         CLE034
     C                     ENDIF                                                              CLE034
0660 C*
0661 C           ENDAA     ENDSR
0662 C********************************************************************
0663 C*          L O A N     A M E N D M E N T S
0664 C*                                                    * LEP1068-CC  *
0665 C*    PROCCC IS CALLED BY - PROC2
0666 C*
0667 C*              CALLS - CREATE
0668 C*
0669 C********************************************************************
0670 C           PROCCC    BEGSR                           * PROCCC BEGSR*
0671 C                     SETON                     49
0672 C**
0673 C**   PAY/REC. INDICATOR MUST EQUAL 1
0674 C  N21                GOTO ENDCC
0675 C                     MOVE SETPDK    SETTLE
0676 C   45                MOVE 'P'       PAYREC
0677 C   46                MOVE 'R'       PAYREC
      *                                                                                       CLE034
      ** If CLE034 is on..                                                                    CLE034
      *                                                                                       CLE034
     C           CLE034    IFEQ 'Y'                                                           CLE034
     C           STALDK    ANDEQ'Y'                                                           CLE034
     C                     MOVE PAYREC    WKPYRC                                              CLE034
     C                     MOVE 'Y'       WKPROC                                              CLE034
     C                     EXSR SR34A                                                         CLE034
     C                     ELSE                                                               CLE034
     C                     MOVE 'Y'       WKFLD                                               CLE034
     C                     MOVE '*EOF   ' PRETCD                                              CLE034
     C                     ENDIF                                                              CLE034
      *                                                                                       CLE034
     C           WKFLD     DOWEQ'Y'                                                           CLE034
     C           PRETCD    OREQ *BLANK                                                        CLE034
      *                                                                                       CLE034
     C           CLE034    IFEQ 'Y'                                                           CLE034
     C           WKPROC    ANDEQ'Y'                                                           CLE034
     C                     EXSR SR34D                                                         CLE034
      *                                                                                       CLE034
0678 C                     MOVE OSACDK    OURAG
     C                     MOVE OSBR      BRCDTX                          S01117
0679 C                     MOVE TSENDK    THRAG
0680 C                     MOVE CCYDK     CURREN
      *                                                                   CEU004
      ** If feature CEU004 is on,                                         CEU004
      ** If the Settlement Ccy *NE transaction Ccy, set field CURREN.     CEU004
      *                                                                   CEU004
     C           CEU004    IFEQ 'Y'                        If Feature On  CEU004
     C           CLE031    OREQ 'Y'                                       CLE031
      *                                                                   CEU004
     C***********SCCY      IFNE CCYDK                 If Ccys # Eql CEU004CLE031
     C           CEU004    IFEQ 'Y'                                       CLE031
     C           SCCY      ANDNECCYDK                                     CLE031
     C           SCCY      ANDNE*BLANKS                     And Set # Blk 137920
     C           CLE031    OREQ 'Y'                                       CLE031
     C           PSCYDK    ANDNECCYDK                                     CLE031
     C           PSCYDK    ANDNE*BLANKS                                   CLE031
     C           *IN45     ANDEQ*ON                                       CLE031
     C           CLE031    OREQ 'Y'                                       CLE031
     C           SCCY      ANDNECCYDK                                     CLE031
     C           SCCY      ANDNE*BLANKS                                   CLE031
     C           *IN46     ANDEQ*ON                                       CLE031
      *                                                                   CLE031
     C                     CALL 'AOCURRR0'             99                 CLE031
     C                     PARM '*MSG    '@RTCD   7                       CLE031
     C                     PARM '*KEY    '@OPTN   7                       CLE031
     C                     PARM CCYDK     CURKEY  3                       CLE031
     C           SDCURR    PARM SDCURR    DSSDY                           CLE031
      *                                                                   CLE031
     C           @RTCD     IFNE *BLANKS                                   CLE031
     C                     SETON                     U7U8LR               CLE031
     C                     Z-ADD19        DBASE                           CLE031
     C                     MOVE 'SDCURRPD'DBFILE                          CLE031
     C                     MOVELCCYDK     DBKEY                           CLE031
     C                     GOTO ENDCC                                     CLE031
     C                     ENDIF                                          CLE031
      *                                                                   CLE031
     C                     MOVE A6INCY    LCCYIN                          CLE031
      *                                                                   CLE031
     C           *IN45     IFEQ *ON                                       CLE031
     C           PSCYDK    ANDNE*BLANKS                                   CLE031
     C                     MOVE PSCYDK    CURKEY                          CLE031
     C                     ENDIF                                          CLE031
      *                                                                   CLE031
     C           *IN46     IFEQ *ON                                       CLE031
     C           SCCY      ANDNE*BLANKS                                   CLE031
     C                     MOVE SCCY      CURKEY                          CLE031
     C                     ENDIF                                          CLE031
      *                                                                   CLE031
     C                     CALL 'AOCURRR0'             99                 CLE031
     C                     PARM '*MSG    '@RTCD   7                       CLE031
     C                     PARM '*KEY    '@OPTN   7                       CLE031
     C                     PARM           CURKEY  3                       CLE031
     C           SDCURR    PARM SDCURR    DSSDY                           CLE031
      *                                                                   CLE031
     C           @RTCD     IFNE *BLANKS                                   CLE031
     C                     SETON                     U7U8LR               CLE031
     C                     Z-ADD20        DBASE                           CLE031
     C                     MOVE 'SDCURRPD'DBFILE                          CLE031
     C                     MOVELCURKEY    DBKEY                           CLE031
     C                     GOTO ENDCC                                     CLE031
     C                     ENDIF                                          CLE031
      *                                                                   CLE031
     C                     MOVE A6INCY    SCCYIN                          CLE031
      *                                                                   CLE031
     C           LCCYIN    IFEQ 'Y'                                       CLE031
     C           SCCYIN    OREQ 'Y'                                       CLE031
     C***********          MOVE SCCY      CURREN             Set CcCEU004 CLE031
     C                     MOVE CURKEY    CURREN             Set Ccy Fld  CLE031
     C                     MOVE CCYDK     CCYSV   3                       CLE031
     C                     MOVE EAMT      AMTSV  130                      CLE031
     C                     ELSE                                           CLE031
     C           *IN45     IFEQ *ON                                       CLE031
     C           PSCYDK    ANDNE*BLANKS                                   CLE031
     C                     MOVE PSCYDK    CURREN                          CLE031
     C                     MOVE CCYDK     CCYSV                           CLE031
     C                     Z-ADDPEXRDK    WEXR                            CLE031
     C                     MOVE PEXIDK    WEXI                            CLE031
     C                     ENDIF                                          CLE031
     C           *IN46     IFEQ *ON                                       CLE031
     C           SCCY      ANDNE*BLANKS                                   CLE031
     C                     MOVE SCCY      CURREN                          CLE031
     C                     MOVE CCYDK     CCYSV                           CLE031
     C                     Z-ADDREXRDK    WEXR                            CLE031
     C                     MOVE REXIDK    WEXI                            CLE031
     C                     ENDIF                                          CLE031
     C                     ENDIF                                          CLE031
     C                     ENDIF                            End If        CEU004
      *                                                                   CEU004
     C                     ENDIF                           End If         CEU004
      *                                                                   CEU004
0681 C**
0682 C**   SET UP & WRITE OUTPUT RECORDS
0683 C                     EXSR CREATE
     C                     ENDIF                                                              CLE034
      *                                                                                       CLE034
     C           CLE034    IFEQ *ON                                                           CLE034
     C           WKPROC    ANDEQ'Y'                                                           CLE034
     C                     EXSR SR34C                                                         CLE034
     C                     ELSE                                                               CLE034
     C                     MOVE *BLANKS   WKFLD                                               CLE034
     C                     ENDIF                                                              CLE034
     C                     ENDDO                                                              CLE034
      *                                                                                       CLE034
     C           CLE034    IFEQ *ON                                                           CLE034
     C           WKPROC    ANDEQ'Y'                                                           CLE034
     C                     EXSR SR34E                                                         CLE034
     C                     ENDIF                                                              CLE034
0684 C*
0685 C           ENDCC     ENDSR
0686 C********************************************************************
0687 C* S U B R O U T I N E   T O   D E T E R M I N E   W H I C H
0688 C*
0689 C* R E C O R D S   T O   C R E A T E
0690 C*       I/P PARMS - SETTLE - SETTLEMENT TYPE
0691 C*                 - CURREN - CURRENCY
0692 C*                 - PAYREC - PAY/RECEIVE IND.
0693 C*                 - OURAG  - OUR AGENT
0694 C*                 - THRAG  - THEIR AGENT
0695 C*
0696 C*    CREATE IS CALLED BY - PROCAA;PROCCC
0697 C*
     C*
0698 C*              CALLS - CHKSW PROCEE OLETX1 OLETX2 OLETX3 OLEPXT
0754 C*                      &     OLETX6                                 S2659
0699 C*
0700 C********************************************************************
0701 C           CREATE    BEGSR                           *** CREATE ***
0702 C**
0703 C**   SETTLEMENT TYPE MUST BE 01,02,07,08,OR 12
0704 C           SETTLE    LOKUPIPSET                    42
0705 C  N42                GOTO ENDCRE
     C*
     C**   IF NOSTRO MISSING, SET SETTLEMENT BRANCH TO BOOKING BRANCH     S01117
     C*                                                                   S01117
     C           OURAG     IFEQ *BLANKS                                   S01117
     C                     MOVE BRCA      BRCDTX                          S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C                     SETOF                     375355
0764 C                     SETOF                     5657                 S2659
0706 C**
0707 C** OUTPUT RECORD DEPENDS ON SETTLEMENT TYPE
     C*
     C**    IF SETTLEMENT TYPE = 08, U4 ON, AND NOSTRO IS SWIFT MEMBER,
     C**    OUTPUT TO LEPXT
     C           SETTLE    COMP 08                       42
     C   42 U4             EXSR CHKSW
     C   U7 U8 LR          GOTO ENDCRE
     C   42 55             EXSR OLEPXT
     C   42 55             GOTO ENDCRE
     C*
0778 C*    CHIPS INTERFACE PRESENT, SETTLEMENT TYPE 07                    S2659
0779 C*    & PAYMENT, OUTPUT TO S/LETX6.                                  S2659
0780 C*                                                                   S2659
0781 C   U1      SETTLE    COMP 07                       57               S2659
0782 C   U1 57   PAYREC    COMP 'P'                      56               S2659
0783 C   U1 56             EXSR OLETX6                                    S2659
0784 C   U1 56             GOTO ENDCRE                                    S2659
0785 C*                                                                   S2659
     C**   IF SETTLE = 08 BUT NOT SATISFY ABOVE, OR SETTLE = 07,
     C**   CALCULATE IF COMPLETE OR INCOMPLETE AND OUTPUT TO LETX1/2
     C  N42      SETTLE    COMP 07                       42
0710 C  N42                GOTO SELSE1
0711 C**
0712 C**   VALIDATE INSTRUCTIONS
0713 C                     EXSR PROCEE
0714 C   50                EXSR OLETX1
0715 C  N50                EXSR OLETX2
0716 C                     GOTO ENDCRE
     C*
     C**    IF SETTLEMENT TYPE = 01 :-
0717 C           SELSE1    TAG                             ** SELSE1 TAG**
0718 C           SETTLE    COMP 01                       42
0719 C  N42                GOTO SELSE2
     C*
     C**    AND IF CCY = LOCAL CCY, AND LCYN = 'B'
0720 C           CURREN    COMP LOCY                     42
     C   42 54             EXSR OLETX3
     C   53                GOTO ENDCRE
0723 C**
     C**    IF SETTLE = 01, LOCAL CCY BUT LCYN = 'T', OR NOT LOCAL CCY:-
     C**    IF U4 AND NOSTRO IS SWIFT MEMBER, USE LEPXT.  ELSE USE LETX1/2
     C   U4                EXSR CHKSW
     C   U7 U8 LR          GOTO ENDCRE
     C   55                EXSR OLEPXT
     C   55                GOTO ENDCRE
     C*
0725 C                     EXSR PROCEE
0726 C   50                EXSR OLETX1
0727 C  N50                EXSR OLETX2
0733 C**   ENDIF
0734 C                     GOTO ENDCRE
0735 C           SELSE2    TAG                             ** SELSE2 TAG**
0736 C           SETTLE    COMP 02                       42
0737 C  N42      SETTLE    COMP 12                       42
0738 C   42                EXSR OLETX3
0739 C*
0740 C           ENDCRE    ENDSR
0741 C*
0742 C********************************************************************
     C********************************************************************
     C*
     C*         SUBROUTINE TO CHECK IF NOSTRO IS SWIFT MEMBER
     C*
     C*         I/P PARMS - OURAG  - OUR AGENT  \  FROM PROCAA
     C*                     CURREN - CURRENCY   /  OR PROCCC
     C*
     C*         CHKSW IS CALLED BY - CREATE
     C*
     C***********************CALLS***TABCHN                               S01194
     C*                      CALLS - NOTHING                              S01194
     C*
     C********************************************************************
     C*
     C*
     C           CHKSW     BEGSR                           *** CHKSW ***
     C*
     C*
     C**    OUR AGENT VALIDATION
     C           OURAG     COMP ' '                  5050
     C  N50                GOTO CHKEND
     C**
     C**    NOT BLANK - CHECK NOSTRO EXISTS/GET NOSTRO'S CUST.NO.
     C                     MOVELOURAG     NOSN
     C***********          MOVE CURREN    CCY                             137920
     C                     MOVE CURREN    AONCCY           Set Key Ccy    137920
     C**********           Z-ADD70        RECT                            S01194
     C                     CALL 'AONOSTR0'PLIST2                          S01194
     C           @RTCD     IFNE *BLANKS                                   S01194
     C                     SETON                     U7U8LR               S01194
     C                     Z-ADD8         DBASE            ** DBASE 08 ** S01194
     C                     MOVE 'SDNOSTPD'DBFILE                          S01194
     C                     MOVELNOSN      DBKEY                           S01194
     C                     MOVE CCY       DBKEY                           S01194
     C                     GOTO CHKEND                                    S01194
     C                     END                                            S01194
     C**********           EXSR TABCHN                                    S01194
     C***99*****           SETOF                     50                   S01194
     C**                                                                  S01194
     C***99*****           SETON                     U7U8LR               S01194
     C***99*****           MOVE '08'      DBASE            ** DBASE 08 ** S01194
     C***99*****           MOVELZTABKY    DBKEY                           S01194
     C***99*****           MOVE 'TABLE'   DBFILE                          S01194
     C***99*****           GOTO CHKEND                                    S01194
     C*                                                                   S01194
     C*    USE NOSTRO'S CUST. NO. TO CHAIN TO CLIENT FILE FOR SWIFT ID
     C*
     C**********           SETOF                     06                   S01194
     C**********           MOVELCNUMTL    CUSKEY  7                       S01194
     C**********           MOVE 'A'       CUSKEY                          S01194
     C********** CUSKEY    CHAINCLINT                41                   S01194
     C                     MOVELCNUMTL    CKEY                            S01194
     C                     CALL 'AOCUSTR0'PLIST3                          S01194
     C           @RTCD     IFNE *BLANKS                                   S01194
     C                     SETON                     U7U8LR               S01194
     C                     Z-ADD9         DBASE            ** DBASE 09 ** S01194
     C                     MOVE 'SDCUSTPD'DBFILE                          S01194
     C                     MOVE CKEY      DBKEY                           S01194
     C                     GOTO CHKEND                                    S01194
     C                     ELSE                                           S01194
     C           CSID      COMP ' '                  5555                 S01194
     C                     END                                            S01194
     C**N06**              SETON                     U7U8LR               S01194
     C**N06**              MOVE '09'      DBASE                           S01194
     C**N06**              MOVELCUSKEY    DBKEY                           S01194
     C**N06**              MOVE 'CLINT'   DBFILE                          S01194
     C***06******CSID******COMP ' '                  5555   55=SWIFT MBR. S01194
     C**********           TESTB'3'       TLXR           56               S01194
     C           BBCMTI    COMP 'Y'                      56               S01194
     C   55 56   PRSW      COMP PRTX                 5655
     C*
     C**  SWIFT message not appropriate for method 01                     158956
     C***    (whatever GSFM is)                                           158956
     C           SETTLE    IFEQ 01                                        158956
     C                     MOVE '0'       *IN55                           158956
     C                     END                                            158956
     C*
     C*    SET INDICATOR TO AVOID REPEATING OURAG CHECK IN PROCEE SR.
     C                     SETON                     37
     C*
     C           CHKEND    TAG                             ** CHKEND TAG *
     C*
     C                     ENDSR
     C*
     C********************************************************************
0743 C********************************************************************
0744 C* VALIDATION OF INSTRUCTIONS  * LEP1068-EE *
0745 C*       I/P  OURAG - OUR AGENT A/C
0746 C*            THRAG - THEIR AGENT A/C
0747 C*
0748 C*       O/P  PAYREC - WILL BE SET TO 'C' IF NECCESSARY
0749 C*            IND.50 - INSTRUCTIONS VALID
0750 C*
0751 C*    PROCEE IS CALLED BY - CREATE
0752 C*
0753 C***************CALLS***TABCHN                                       S01194
0753 C*              CALLS - NOTHING                                      S01194
0754 C*
0755 C********************************************************************
0756 C           PROCEE    BEGSR                           *** PROCEE ***
     C*
     C**    OMIT OUR AGENT VALIDATION IF ALREADY
     C**    CHECKED IN CHKSW SR.
     C*
     C   37                GOTO THRTAG
     C*
0757 C                     SETOF                     50
0758 C**
0759 C**   OUR AGENT VALIDATION
0760 C           OURAG     COMP ' '                  5050
0761 C  N50                GOTO ENDEE
0762 C**
0763 C**   NOT BLANK - DOES NOSTRO EXIST
0764 C                     MOVELOURAG     NOSN
0765 C***********          MOVE CURREN    CCY                             137920
     C                     MOVE CURREN    AONCCY           Set Key Ccy    137920
0766 C**********           Z-ADD70        RECT                            S01194
     C**********           EXSR TABCHN                                    S01194
     C                     CALL 'AONOSTR0'PLIST2                          S01194
     C           @RTCD     IFNE *BLANKS                                   S01194
     C                     SETOF                     50                   S01194
     C                     SETON                     U7U8LR               S01194
     C                     Z-ADD10        DBASE            ** DBASE 10 ** S01194
     C                     MOVE 'SDNOSTPD'DBFILE                          S01194
     C                     MOVELNOSN      DBKEY                           S01194
     C                     MOVE CCY       DBKEY                           S01194
     C                     GOTO ENDEE                                     S01194
     C                     END                                            S01194
     C*                                                                   S01194
     C***99*****           SETOF                     50                   S01194
     C***99*****           SETON                     U7U8LR               S01194
     C***99*****           MOVE '10'      DBASE            ** DBASE 10 ** S01194
     C***99*****           MOVELZTABKY    DBKEY                           S01194
     C***99*****           MOVE 'TABLE'   DBFILE                          S01194
     C***99*****           GOTO ENDEE                                     S01194
     C**
     C           THRTAG    TAG                             *** THRTAG ***
     C*
0770 C**
0771 C**   THEIR AGENT VALIDATION
0772 C           THRAG     COMP ' '                  5050
0773 C  N50                GOTO ENDEE
0774 C***********IFCUST    COMP '000001'             42                                       CSD027
0775 C***42******IFCUST    COMP '999999'               42                                     CSD027
     C                     MOVELIFCUST    CKEY                                                CSD027
     C                     CALL 'AOCUSTR0'PLIST3                                              CSD027
     C           @RTCD     IFNE '*CNUM  '                                                     CSD027
     C                     SETOF                     42                                       CSD027
     C                     ELSE                                                               CSD027
     C                     SETON                     42                                       CSD027
     C                     END                                                                CSD027
     C                     CALL 'AOCUSTR0'                                                    CSD027
     C                     PARM '*BLANKS' @RTCD   7                                           CSD027
     C                     PARM '*KEY   ' @OPTN   7                                           CSD027
     C                     PARM IFCUST    @AENB  10                                           CSD027
     C                     PARM *BLANKS   @KYST   7                                           CSD027
     C           SDCUST    PARM SDCUST    DSSDY                                               CSD027
      *                                                                                       CSD027
0776 C**
0777 C**   NOT A CUSTOMER NUMBER - BYPASS
0778 C**N42******          GOTO ENDEE                                                         CSD027
     C           @RTCD     IFNE *BLANKS                                                       CSD027
     C           @KYST     ORNE '*CNUM  '                                                     CSD027
     C                     GOTO ENDEE                                                         CSD027
     C                     END                                                                CSD027
0779 C**
0780 C**   SHOULD CREDIT TELEX BE SENT
0781 C           PAYREC    COMP 'P'                      42
     C                     MOVE CUST      CUSTA   6                       S01194
0782 C***42***** CNUMTL    COMP CUST                     42               S01194
0782 C   42      CNUMTL    COMP CUSTA                    42               S01194
0783 C   42                MOVE 'C'       PAYREC
0784 C*
0785 C           ENDEE     ENDSR                           ** ENDEE TAG **
0786 C********************************************************************
0787 C/SPACE 3
0788 C********************************************************************
0789 C* S E T U P   A N D   W R I T E   O U T P U T   R E C O R D
0790 C*
0791 C*    OUTPUT IS CALLED BY - OLETX1;OLETX2;OLETX3
     C*                        - OLEPXT
0954 C*                        - OLETX6                                   S2659
0792 C*
0793 C********************************************************************
0794 C           OUTPUT    BEGSR                           *** OUTPUT ***
      *                                                                   CEU004
      *  If feature CEU004 is on, clear output fields.                    CEU004
      *                                                                   CEU004
     C           CEU004    IFEQ 'Y'                        If Feature On  CEU004
      *                                                                   CEU004
     C                     Z-ADD0         OTAM   130        Reset OtAmt   CEU004
     C                     MOVE *BLANKS   OTCY    3         Clr OthCcy    CEU004
      *                                                                   CEU004
     C                     ENDIF                           End If         CEU004
      *                                                                   CEU004
0795 C**
0796 C**   SET UP OUT PUT FIELDS FOR LOANS FIRST
0797 C  N48                GOTO ELSE01
0798 C                     Z-ADDVDAT      VDATPH  50
0799 C***********          Z-ADDCNUM      CNUMPH                                              CSD027
     C                     MOVE CNUM      CNUMPH                                              CSD027
0800 C**********           Z-ADDLNRF      LNRFPH                                              CLE148
     C                     MOVELLNRF      LNRFPH                                              CLE148
      *                                                                                       CLE038
     C           CLE038    IFEQ 'Y'                                                           CLE038
     C           CLE031    ANDEQ'Y'                                                           CLE038
     C           WKPROC    ANDEQ'Y'                                                           CLE038
     C           WKPYRC    ANDEQ'P'                                                           CLE038
     C           STPYBA    ANDEQ'A'                                                           CLE038
     C           CLE038    OREQ 'Y'                                                           CLE038
     C           CLE031    ANDEQ'Y'                                                           CLE038
     C           WKPROC    ANDEQ'Y'                                                           CLE038
     C           WKPYRC    ANDEQ'R'                                                           CLE038
     C           STRCBA    ANDEQ'A'                                                           CLE038
      *                                                                                       CLE038
     C                     EXSR SRCL38                                                        CLE038
      *                                                                                       CLE038
     C                     ELSE                                                               CLE038
      *                                                                                       CLE038
0801 C           CPAM      SUB  TOTI      EAMT   130
      *                                                                                       CLE028
      ** For Flat rate personal loans:                                                        CLE028
      **   Add the flat rate interest if Add on interest is 'Y'                               CLE028
      **   Add the charge amount if Add on charges is 'Y'                                     CLE028
      *                                                                                       CLE028
     C           CLE028    IFEQ 'Y'                                                           CLE028
     C           PTYP      ANDEQ80                                                            CLE028
     C           ADIF      IFEQ 'Y'                                                           CLE028
     C                     ADD  FLTI      EAMT                                                CLE028
     C                     ENDIF                                                              CLE028
     C           ADCF      IFEQ 'Y'                                                           CLE028
     C                     ADD  CHGA      EAMT                                                CLE028
     C                     ENDIF                                                              CLE028
     C                     ENDIF                                                              CLE028
      *                                                                                       CLE034
      ** If CLE034 is on..                                                                    CLE034
      *                                                                                       CLE034
     C           CLE034    IFEQ *ON                                                           CLE034
     C           WKPROC    ANDEQ'Y'                                                           CLE034
     C                     EXSR SR34B                                                         CLE034
     C                     ENDIF                                                              CLE034
      *                                                                   CEU004
      ** If feature CEU004 is on,                                         CEU004
      ** If the Settlement currency *NE transaction Ccy, convert amount   CEU004
      *                                                                   CEU004
     C           CEU004    IFEQ 'Y'                        If Feature On  CEU004
     C           CLE031    OREQ 'Y'                                       CLE031
      *                                                                   CEU004
     C***********          MOVE CCY       CCYSV   3         Set Cc CEU004 135378
     C***********          MOVE EAMT      AMTSV  130        Set Am CEU004 135378
      *                                                                   CEU004
     C***********SCCY      IFNE *BLANKS               If StCcy # BlkCEU004CLE031
     C***********SCCY      ANDNECCY                         And Cc CEU004 135378
     C           CEU004    IFEQ 'Y'                                       CLE031
     C           SCCY      ANDNE*BLANKS                                   CLE031
     C           SCCY      ANDNECCYSV                       And Ccys # Eql135378
     C           CLE031    OREQ 'Y'                                       CLE031
     C           CURREN    ANDNECCYSV                                     CLE031
     C           CURREN    ANDNE*BLANKS                                   CLE031
     C           SCCY      ANDNE*BLANKS                                   CLE031
     C           CLE031    OREQ 'Y'                                       CLE031
     C           CURREN    ANDNECCYSV                                     CLE031
     C           CURREN    ANDNE*BLANKS                                   CLE031
     C           PSCY      ANDNE*BLANKS                                   CLE031
      *                                                                   CLE031
     C                     CALL 'AOCURRR0'             99                 CLE031
     C                     PARM '*MSG    '@RTCD   7                       CLE031
     C                     PARM '*KEY    '@OPTN   7                       CLE031
     C                     PARM CCYSV     CURKEY  3                       CLE031
     C           SDCURR    PARM SDCURR    DSSDY                           CLE031
      *                                                                   CLE031
     C           @RTCD     IFNE *BLANKS                                   CLE031
     C                     SETON                     U7U8LR               CLE031
     C                     Z-ADD21        DBASE                           CLE031
     C                     MOVE 'SDCURRPD'DBFILE                          CLE031
     C                     MOVELCCYSV     DBKEY                           CLE031
     C                     ENDIF                                          CLE031
      *                                                                   CLE031
     C                     MOVE A6INCY    LCCYIN                          CLE031
     C                     Z-ADDA6NBDP    LCCYDP  10                      CLE031
      *                                                                   CLE031
     C                     SELEC                                          CLE031
     C           CEU004    WHEQ 'Y'                                       CLE031
     C           SCCY      ANDNE*BLANKS                                   CLE031
     C           SCCY      ANDNECCYSV                                     CLE031
     C                     MOVE SCCY      CURKEY                          CLE031
     C           CLE031    WHEQ 'Y'                                       CLE031
     C           CURREN    ANDNECCYSV                                     CLE031
     C           CURREN    ANDNE*BLANKS                                   CLE031
     C                     MOVE CURREN    CURKEY                          CLE031
     C                     ENDSL                                          CLE031
      *                                                                   CLE031
     C                     CALL 'AOCURRR0'             99                 CLE031
     C                     PARM '*MSG    '@RTCD   7                       CLE031
     C                     PARM '*KEY    '@OPTN   7                       CLE031
     C                     PARM           CURKEY  3                       CLE031
     C           SDCURR    PARM SDCURR    DSSDY                           CLE031
      *                                                                   CLE031
     C           @RTCD     IFNE *BLANKS                                   CLE031
     C                     SETON                     U7U8LR               CLE031
     C                     Z-ADD22        DBASE                           CLE031
     C                     MOVE 'SDCURRPD'DBFILE                          CLE031
     C                     MOVELCURKEY    DBKEY                           CLE031
     C                     ENDIF                                          CLE031
      *                                                                   CLE031
     C                     MOVE A6INCY    SCCYIN                          CLE031
     C                     Z-ADDA6NBDP    SCCYDP  10                      CLE031
      *                                                                   CLE031
     C           LCCYIN    IFEQ 'Y'                                       CLE031
     C           SCCYIN    OREQ 'Y'                                       CLE031
      *                                                                   CEU004
     C                     MOVE EAMT      P@FRAM            -Set Amnt ParmCEU004
     C***********          MOVE CCY       P@FRCY            -Set F CEU004 135378
     C                     MOVE CCYSV     P@FRCY            -Set FrCcy Prm135378
     C*******************  MOVE SCCY      P@TOCY      -Set ToCcy PrmCEU004CLE031
     C                     MOVE CURKEY    P@TOCY                          CLE031
      *                                                                   CEU004
     C                     EXSR XCAMT                        Cvrt Amount  CEU004
     C                     MOVE P@OUTA    EAMT               Set Cvrt Amt CEU004
     C                     ELSE                                           CLE031
      *                                                                   CLE031
     C                     Z-ADDEAMT      ZAMTCI                          CLE031
     C                     Z-ADDWEXR      ZEXCH                           CLE031
     C                     MOVE WEXI      ZMD                             CLE031
     C                     MOVE CCYSV     ZCCYI                           CLE031
     C                     MOVE CURKEY    ZCCYO                           CLE031
     C                     Z-ADDLCCYDP    ZCDPI                           CLE031
     C                     Z-ADDSCCYDP    ZCDPO                           CLE031
      *                                                                   CLE031
     C                     CALL 'ZCONVZ1'                                 CLE031
     C                     PARM           ZAMTCI 150                      CLE031
     C                     PARM           ZEXCH  138                      CLE031
     C                     PARM           ZMD     1                       CLE031
     C                     PARM           ZCCYI   3                       CLE031
     C                     PARM           ZCCYO   3                       CLE031
     C                     PARM           ZCDPI   10                      CLE031
     C                     PARM           ZCDPO   10                      CLE031
     C                     PARM           ZAMTCO 150                      CLE031
      *                                                                   CLE031
     C                     Z-ADDZAMTCO    EAMT                            CLE031
      *                                                                   CLE031
     C                     ENDIF                                          CLE031
     C                     ENDIF                            End If        CEU004
      *                                                                   CEU004
      * For Payments, populate the other amount/currency fields           CEU004
      * according to whether the 'In' Ccy is equal to the transaction ccy.CEU004
      *                                                                   CEU004
     C           PAYREC    IFEQ 'P'                         If a Payment  CEU004
      *                                                                   CEU004
     C           ICCY      IFNE *BLANKS                      If InCcy # BlCEU004
      *                                                                   CEU004
     C           ICCY      IFEQ CCYSV                         If Ccys # EqCEU004
      *                                                                   CEU004
     C                     MOVE CCYSV     OTCY                 Set OthCcy CEU004
     C                     MOVE AMTSV     OTAM                 Set OthAmt CEU004
      *                                                                   CEU004
     C                     ELSE                               Else If     CEU004
      *                                                                   CEU004
     C                     MOVE AMTSV     P@FRAM              -Set Amt Pm CEU004
     C                     MOVE CCYSV     P@FRCY              -Set FCy Pm CEU004
     C                     MOVE ICCY      P@TOCY              -Set TCy Pm CEU004
      *                                                                   CEU004
     C                     EXSR XCAMT                          Cvrt AmountCEU004
     C                     MOVE P@OUTA    OTAM                 Set Cvt AmtCEU004
     C                     MOVE ICCY      OTCY                 Set Cvt CcyCEU004
      *                                                                   CEU004
     C                     ENDIF                              End If      CEU004
      *                                                                   CEU004
     C                     ENDIF                             End If       CEU004
      *                                                                   CEU004
     C                     ENDIF                            End If        CEU004
      *                                                                   CEU004
     C                     ENDIF                           End If         CEU004
      *                                                                   CEU004
     C                     ENDIF                                                              CLE038
      *                                                                                       CLE038
0802 C                     MOVE 'L'       RCDT
0803 C                     MOVE '  '      AMTPPH
     C   U4                MOVE 'ST'      AMTPPQ  2
0804 C                     Z-ADD0         LASNPH
0805 C           PAYREC    COMP 'R'                      42
0806 C   42                MOVE BLNK10    OTFACO
0807 C   42                MOVE BLNK90    OTSPI
0808 C  N42                MOVE FACO      OTFACO
0809 C  N42                MOVE SPI       OTSPI
0810 C**
0811 C**   SET UP FIELDS FOR LOAN AMENDMENTS
0812 C           ELSE01    TAG                             ** ELSE01 TAG**
0813 C  N49                GOTO ENDO
0814 C                     Z-ADDVDATDK    VDATPH
0815 C***********          Z-ADDCNUMDK    CNUMPH                                              CSD027
     C                     MOVE CNUMDK    CNUMPH                                              CSD027
0816 C**********           Z-ADDLNRFDK    LNRFPH                                              CLE148
     C                     MOVELLNRFDK    LNRFPH                                              CLE148
0817 C                     Z-ADDTAMTDK    EAMT
      *                                                                                       CLE038
     C           CLE038    IFEQ 'Y'                                                           CLE038
     C           CLE031    ANDEQ'Y'                                                           CLE038
     C           WKPROC    ANDEQ'Y'                                                           CLE038
     C           WKPYRC    ANDEQ'P'                                                           CLE038
     C           STPYBA    ANDEQ'A'                                                           CLE038
     C           CLE038    OREQ 'Y'                                                           CLE038
     C           CLE031    ANDEQ'Y'                                                           CLE038
     C           WKPROC    ANDEQ'Y'                                                           CLE038
     C           WKPYRC    ANDEQ'R'                                                           CLE038
     C           STRCBA    ANDEQ'A'                                                           CLE038
      *                                                                                       CLE038
     C                     EXSR SRCL38                                                        CLE038
      *                                                                                       CLE038
     C                     ELSE                                                               CLE038
      *                                                                   CEU004
      ** If feature CEU004 is on,                                         CEU004
      ** If the Settlement currency *NE transaction Ccy, convert amount   CEU004
      *                                                                   CEU004
     C           CEU004    IFEQ 'Y'                        If Feature On  CEU004
     C           CLE031    OREQ 'Y'                                       CLE031
      *                                                                   CEU004
     C***********          MOVE CCY       CCYSV   3         Set Cc CEU004 135378
     C***********          MOVE EAMT      AMTSV  130        Set Am CEU004 135378
      *                                                                   CEU004
     C***********SCCY      IFNE *BLANKS               If StCcy # BlkCEU004CLE031
     C***********SCCY      ANDNECCYDK                       And Cc CEU004 135378
     C           CEU004    IFEQ 'Y'                                       CLE031
     C           SCCY      ANDNE*BLANKS                                   CLE031
     C           SCCY      ANDNECCYSV                       And Ccys # Eql135378
     C           CLE031    OREQ 'Y'                                       CLE031
     C           CURREN    ANDNECCYSV                                     CLE031
     C           CURREN    ANDNE*BLANKS                                   CLE031
     C           SCCY      ANDNE*BLANKS                                   CLE031
     C           CLE031    OREQ 'Y'                                       CLE031
     C           CURREN    ANDNECCYSV                                     CLE031
     C           CURREN    ANDNE*BLANKS                                   CLE031
     C           PSCYDK    ANDNE*BLANKS                                   CLE031
      *                                                                   CLE031
     C                     CALL 'AOCURRR0'             99                 CLE031
     C                     PARM '*MSG    '@RTCD   7                       CLE031
     C                     PARM '*KEY    '@OPTN   7                       CLE031
     C                     PARM CCYSV     CURKEY  3                       CLE031
     C           SDCURR    PARM SDCURR    DSSDY                           CLE031
      *                                                                   CLE031
     C           @RTCD     IFNE *BLANKS                                   CLE031
     C                     SETON                     U7U8LR               CLE031
     C                     Z-ADD25        DBASE                           CLE031
     C                     MOVE 'SDCURRPD'DBFILE                          CLE031
     C                     MOVELCCYSV     DBKEY                           CLE031
     C                     ENDIF                                          CLE031
      *                                                                   CLE031
     C                     MOVE A6INCY    LCCYIN                          CLE031
     C                     Z-ADDA6NBDP    LCCYDP  10                      CLE031
      *                                                                   CLE031
     C                     SELEC                                          CLE031
     C           CEU004    WHEQ 'Y'                                       CLE031
     C           SCCY      ANDNE*BLANKS                                   CLE031
     C           SCCY      ANDNECCYSV                                     CLE031
     C                     MOVE SCCY      CURKEY                          CLE031
     C           CLE031    WHEQ 'Y'                                       CLE031
     C           CURREN    ANDNECCYSV                                     CLE031
     C           CURREN    ANDNE*BLANKS                                   CLE031
     C                     MOVE CURREN    CURKEY                          CLE031
     C                     ENDSL                                          CLE031
      *                                                                   CLE031
     C                     CALL 'AOCURRR0'             99                 CLE031
     C                     PARM '*MSG    '@RTCD   7                       CLE031
     C                     PARM '*KEY    '@OPTN   7                       CLE031
     C                     PARM           CURKEY  3                       CLE031
     C           SDCURR    PARM SDCURR    DSSDY                           CLE031
      *                                                                   CLE031
     C           @RTCD     IFNE *BLANKS                                   CLE031
     C                     SETON                     U7U8LR               CLE031
     C                     Z-ADD26        DBASE                           CLE031
     C                     MOVE 'SDCURRPD'DBFILE                          CLE031
     C                     MOVELCURKEY    DBKEY                           CLE031
     C                     ENDIF                                          CLE031
      *                                                                   CLE031
     C                     MOVE A6INCY    SCCYIN                          CLE031
     C                     Z-ADDA6NBDP    SCCYDP  10                      CLE031
      *                                                                   CLE031
     C           LCCYIN    IFEQ 'Y'                                       CLE031
     C           SCCYIN    OREQ 'Y'                                       CLE031
      *                                                                   CEU004
     C                     MOVE EAMT      P@FRAM            -Set Amnt ParmCEU004
     C***********          MOVE CCYDK     P@FRCY            -Set F CEU004 135378
     C                     MOVE CCYSV     P@FRCY            -Set FrCcy Prm135378
     C******************** MOVE SCCY      P@TOCY      -Set ToCcy PrmCEU004CLE031
     C                     MOVE CURKEY    P@TOCY            -Set ToCcy PrmCLE031
      *                                                                   CEU004
     C                     EXSR XCAMT                        Cvrt Amount  CEU004
     C                     MOVE P@OUTA    EAMT               Set Cvrt Amt CEU004
     C                     ELSE                                           CLE031
      *                                                                   CLE031
     C                     Z-ADDEAMT      ZAMTCI                          CLE031
     C                     Z-ADDWEXR      ZEXCH                           CLE031
     C                     MOVE WEXI      ZMD                             CLE031
     C                     MOVE CCYSV     ZCCYI                           CLE031
     C                     MOVE CURKEY    ZCCYO                           CLE031
     C                     Z-ADDLCCYDP    ZCDPI                           CLE031
     C                     Z-ADDSCCYDP    ZCDPO                           CLE031
      *                                                                   CLE031
     C                     CALL 'ZCONVZ1'                                 CLE031
     C                     PARM           ZAMTCI 150                      CLE031
     C                     PARM           ZEXCH  138                      CLE031
     C                     PARM           ZMD     1                       CLE031
     C                     PARM           ZCCYI   3                       CLE031
     C                     PARM           ZCCYO   3                       CLE031
     C                     PARM           ZCDPI   10                      CLE031
     C                     PARM           ZCDPO   10                      CLE031
     C                     PARM           ZAMTCO 150                      CLE031
      *                                                                   CLE031
     C                     Z-ADDZAMTCO    EAMT                            CLE031
      *                                                                   CLE031
     C                     ENDIF                                          CLE031
     C                     ENDIF                            End If        CEU004
      *                                                                   CEU004
      ** For Payments, populate the other amount/currency fields          CEU004
      ** according to whether the 'In' Ccy is equal to the transaction ccyCEU004
      *                                                                   CEU004
     C           PAYREC    IFEQ 'P'                         If a Payment  CEU004
      *                                                                   CEU004
     C           ICCY      IFNE *BLANKS                      If InCcy # BlCEU004
      *                                                                   CEU004
     C           ICCY      IFEQ CCYSV                         If Ccys # EqCEU004
      *                                                                   CEU004
     C                     MOVE CCYSV     OTCY                 Set OthCcy CEU004
     C                     MOVE AMTSV     OTAM                 Set OthAmt CEU004
      *                                                                   CEU004
     C                     ELSE                               Else If     CEU004
      *                                                                   CEU004
     C                     MOVE AMTSV     P@FRAM              -Set Amt Pm CEU004
     C                     MOVE CCYSV     P@FRCY              -Set FCy Pm CEU004
     C                     MOVE ICCY      P@TOCY              -Set TCy Pm CEU004
      *                                                                   CEU004
     C                     EXSR XCAMT                          Cvrt AmountCEU004
     C                     MOVE P@OUTA    OTAM                 Set Cvt AmtCEU004
     C                     MOVE ICCY      OTCY                 Set Cvt CcyCEU004
      *                                                                   CEU004
     C                     ENDIF                              End If      CEU004
      *                                                                   CEU004
     C                     ENDIF                             End If       CEU004
      *                                                                   CEU004
     C                     ENDIF                            End If        CEU004
      *                                                                   CEU004
     C                     ENDIF                           End If         CEU004
      *                                                                   CEU004
     C                     ENDIF                                                              CLE038
      *                                                                                       CLE038
0818 C                     MOVE 'A'       RCDT
0819 C                     MOVE AMTPDK    AMTPPH
0820 C                     Z-ADDLASNDK    LASNPH
0821 C           PAYREC    COMP 'R'                      42
0822 C   42                MOVE BLNK10    OTFACO
0823 C   42                MOVE BLNK90    OTSPI
0824 C  N42                MOVE FACODK    OTFACO
0825 C  N42                MOVE SPIDK     OTSPI
0826 C                     MOVE LTYPDK    LTYP
0827 C                     MOVE SUTPDK    SUTP
     C                     MOVE CLASDK    CLAS                                                CLE042
0828 C                     MOVE PTYPDK    PTYP
0829 C***********          MOVE BRCDDK    BRCD                            S01117
0829 C                     MOVE BRCDDK    BRCA                            S01117
0830 C**
0831 C**   COMMON PROCESSING
0832 C           ENDO      TAG                             ** ENDO TAG  **
0833 C                     MOVE '1000'    PINDS
0834 C   45                Z-ADD1         TINDPH
0835 C   47                Z-ADD2         TINDPH
0836 C   46                Z-ADD3         TINDPH
0837 C                     MOVE 'N'       INTCPH
0838 C**
0839 C*****DEFAULT*BRANCH*BLANK,USE*BRANCH*ON*CLOAN/LOAMS*TO ACCESS TABLE S01194
0839 C**   DEFAULT BRANCH BLANK,USE BRANCH ON CLOAN/LOAMS TO ACCESS A/O   S01194
0840 C***44*48***          MOVE BRCD      BRKEY                           S01117
     C***44*49**           MOVE BRCDDK    BRKEY                           S01194
     C***44***** BRKEY     CHAINTABLE                41                   S01194
     C           *IN44     IFEQ '1'                                       S01194
     C      48             MOVE BRCA      BRCKEY                          S01194
     C      49             MOVE BRCDDK    BRCKEY                          S01194
     C**********           CALL 'AOBRCHR0'PLIST1                                       S01194 CGL029
     C                     CALL 'AOBRCHR1'PLIST1                                              CGL029
     C           @RTCD     IFNE *BLANKS                                   S01194
     C                     SETON                     LRU7U8               S01194
     C                     SETON                     41                   S01194
     C                     Z-ADD11        DBASE                        ** S01194
     C                     MOVELBRCKEY    DBKEY            ** DBASE 11 ** S01194
     C                     MOVEL'SDBRCHPD'DBFILE                       ** S01194
     C                     END                                            S01194
     C                     MOVE A8BICN    BICN                            S01194
     C*                                                                   S01194
     C                     END                                            S01194
     C***41*****           SETON                     LRU7U8               S01194
     C***41*****           MOVE '11'      DBASE            ** DBASE 11 ** S01194
     C***41*****           MOVE 'TABLE'   DBFILE                          S01194
     C***41*****           MOVELBRKEY     DBKEY                           S01194
0847 C  N44
0848 CORN41                SETON                     34
0849 C   34                EXCPT
0850 C*
0851 C                     ENDSR
0852 C********************************************************************
0853 C* O U T P U T   R O U T I N E S
0854 C/SPACE 2
0855 C********************************************************************
0856 C**   SUBROUTINE TO CREATE LETX1 RECORD
0857 C**
0858 C**   OLETX1 IS CALLED BY - CREATE
0859 C**
0860 C**             CALLS - OUTPUT;HASH
0861 C**
0862 C********************************************************************
0863 C           OLETX1    BEGSR                           *** OLETX1 ***
0864 C                     Z-ADD1         X       10
0865 C                     SETON                     51
0866 C                     SETOF                     34
0867 C                     EXSR OUTPUT
0868 C                     SETOF                     51
0869 C   34                EXSR HASH
0870 C                     SETOF                     34
0871 C                     ENDSR
0872 C********************************************************************
0873 C/SPACE 2
0874 C********************************************************************
0875 C**   SUBROUTINE TO CREATE LETX2 RECORD
0876 C**
0877 C**   OLETX2 IS CALLED BY - CREATE
0878 C**
0879 C**             CALLS - OUTPUT;HASH
0880 C**
0881 C********************************************************************
0882 C           OLETX2    BEGSR                           *** OLETX2 ***
0883 C                     Z-ADD2         X
0884 C                     SETON                     52
0885 C                     SETOF                     34
0886 C                     EXSR OUTPUT
      *                                                                   157863
      ** Do not execute hash if EAMT = 0.                                 157863
      *                                                                   157863
     C           EAMT      IFNE 0                                         157863
0887 C                     SETOF                     52
0888 C   34                EXSR HASH
     C                     ENDIF                                          157863
      *                                                                   157863
0889 C                     SETOF                     34
0890 C                     ENDSR
0891 C********************************************************************
0892 C/SPACE 2
0893 C********************************************************************
0894 C**   SUBROUTINE TO CREATE LETX3 RECORD
0895 C**
0896 C**   OLETX3 IS CALLED BY - CREATE
0897 C**
0898 C**             CALLS - OUTPUT;HASH
0899 C**
0900 C********************************************************************
0901 C           OLETX3    BEGSR                           *** OLETX3 ***
0902 C                     Z-ADD3         X
0903 C                     SETON                     53
0904 C                     SETOF                     34
0905 C                     EXSR OUTPUT
0907 C   34                EXSR HASH
0908 C                     SETOF                     34
0909 C                     ENDSR
0910 C********************************************************************
     C**
     C**     SUBROUTINE TO CREATE LEPXT RECORD
     C**
     C**     OLEPXT IS CALLED BY - CREATE
     C**                   CALLS - OUTPUT,HASH
     C**
     C********************************************************************
     C           OLEPXT    BEGSR                           *** OLEPXT ***
     C                     Z-ADD4         X
     C                     SETON                     55
     C                     SETOF                     34
     C                     EXSR OUTPUT
     C   34                EXSR HASH
     C                     SETOF                     34
     C                     ENDSR
     C********************************************************************
1094 C**   SUBROUTINE TO CREATE LETX6 RECORD                              S2659
1095 C**                                                                  S2659
1096 C**   OLETX6 IS CALLED BY - CREATE                                   S2659
1097 C**                                                                  S2659
1098 C**             CALLS - OUTPUT;HASH                                  S2659
1099 C**                                                                  S2659
1100 C********************************************************************S2659
1101 C           OLETX6    BEGSR                           *** OLETX6 *** S2659
1102 C                     Z-ADD5         X                               S2659
1103 C                     SETOF                     34                   S2659
1104 C                     EXSR OUTPUT                                    S2659
1105 C   34                EXSR HASH                                      S2659
1106 C                     SETOF                     34                   S2659
1107 C                     ENDSR                                          S2659
0911 C********************************************************************
     C*****SUBROUTINE*TO*CHAIN*TO*TABLE*FILE                              S01194
     C**********                                                          S01194
     C*****TABCHN*IS*CALLED*BY***MAIN*PROCESSING,CHKSW,PROCEE*            S01194
     C**********                                                          S01194
     C********************************************************************
     C********** TABCHN    BEGSR                           *** TABCHN *** S01194
     C**********           SETOF                     99                   S01194
     C********** ZTABKY    CHAINTABLE                41                   S01194
     C***41*****           SETON                     99                   S01194
     C**N41***** RECI      COMP 'D'                  9999                 S01194
     C**********           ENDSR                                          S01194
0923 C********************************************************************
0924 C/SPACE 3
0925 C********************************************************************
0926 C*    SUBROUTINE TO MAINTAIN HASH TOTALS
0927 C*
0928 C*    HASH IS CALLED BY - OLETX1;OLETX2;OLETX3
     C*                      - OLEPXT
1128 C*                      - OLETX6                                     S2659
0929 C*
0930 C*            CALLS - GLZADD
0931 C*
0932 C********************************************************************
0933 C           HASH      BEGSR                           ***  HASH  ***
0934 C                     Z-ADDINT,X     ZZTOTI
0935 C                     Z-ADDDEC,X     ZZTOTD
0936 C           EAMT      DIV  1000      ZZAMT
0937 C                     EXSR GLZADD
0938 C                     Z-ADDZZTOTI    INT,X
0939 C                     Z-ADDZZTOTD    DEC,X
0940 C*
0941 C           ROP,X     ADD  1         ROP,X
0942 C                     ENDSR
0943 C********************************************************************
0944 C********************************************************************
0945 C* SUBROUTINE TO ADD AN AMOUNT (ZZAMT) TO THE TOTAL (ZZTOTI,ZZTOTD)
0946 C*   IND '99' IS SET BY AN OVERFLOW ERROR
0947 C*
0948 CSR         GLZADD    BEGSR                           *** GLZADD ****
0949 C*
0950 CSR                   Z-ADDZZAMT     ZZAMT  153     91-DEFINE ZZAMT
0951 CSR 91                GOTO ZZAEND                     AMT = 0.BYPASS
0952 C*
0953 C* SPLIT ZZAMT INTO INTEGER AND DECIMAL FIELDS
0954 CSR                   Z-ADDZZAMT     ZZAMTI 150       INTEGER FIELD
0955 CSR                   MOVE ZZAMT     ZZAMTD  30       DECIMAL FIELD
0956 C* BOTH ZZAMTI AND ZZAMTD CONTAIN A 'SIGN' ZONE NOW
0957 C*
0958 CSR                   EXSR GLZSUM
0959 CSR         ZZAEND    ENDSR                           ** ZZAEND TAG *
0960 C*
0961 C********************************************************************
0962 C* SUBROUTINE TO CARRY OUT THE ADDITION FOR SUBROUTINES -
0963 C*                        GLZADD, GLZSUB, GLZCMP.
0964 C*          PARAMETERS PASSED -
0965 C*                     I/P ZZAMTI ZZAMTD
0966 C*                     O/P ZZTOTI ZZTOTD ZZNEGD IND 96 IND 99.
0967 C*
0968 CSR         GLZSUM    BEGSR                           *** GLZSUM ****
0969 C*
0970 CSR                   Z-ADDZZTOTI    ZZTOTI 150       DEFINE ZZTOTI
0971 CSR                   Z-ADDZZTOTD    ZZTOTD  30       DEFINE ZZTOTD
0972 CSR                   SETOF                     919293
0973 CSR                   SETOF                     949599
0974 C*
0975 C*    DETERMINE SIGN OF ZZAMTI & D,   92 IF NEG
0976 CSR         ZZAMTI    COMP 0                      9293
0977 CSR 93      ZZAMTD    COMP 0                      9293
0978 CSR 93                GOTO ZZSEND                     ZERO BYPASS
0979 C*
0980 C*    DETERMINE SIGN OF ZZTOTI & D, 91 IF NEG.
0981 CSR         ZZTOTI    COMP 0                      9193
0982 CSR 93      ZZTOTD    COMP 0                      9193
0983 C*
0984 C*    IF ZZTOTAL IS ZERO, RETURN ZZAMOUNT.
0985 CSR 93                Z-ADDZZAMTI    ZZTOTI
0986 CSR 93                Z-ADDZZAMTD    ZZTOTD
0987 CSR 93                GOTO ZZSEND                     ZERO BYPASS
0988 C*    IF SIGNS DIFFER BYPASS OVERFLOW CHECKS.
0989 CSR 91N92
0990 CORN91 92             GOTO ZZOFPS
0991 C*
0992 CSR         ZZAMTD    ADD  ZZTOTD    ZZWK2   40
0993 CSR         ZZWK2     COMP 999                  93    '93' = CARRY
0994 CSRN93      ZZWK2     COMP -999                   93    INTO INTEGER.
0995 C*
0996 CSR 93N92   ZZAMTI    ADD  1         ZZWK3  150       ADD 'CARRY' +VE
0997 CSR    93 92ZZAMTI    SUB  1         ZZWK3            SUB 'CARRY' -VE
0998 CSR 93      ZZTOTI    ADD  ZZWK3     ZZWK3
0999 CSRN93      ZZTOTI    ADD  ZZAMTI    ZZWK3
1000 C*
1001 C* IF THE MODULUS OF ZZWK3 IS LT MOD. ZZTOTI THEN O/F HAS OCCURED
1002 CSRN92      ZZWK3     COMP ZZTOTI                 99  -92 MEANS NOS.
1003 CSR 92      ZZWK3     COMP ZZTOTI               99     NEGATIVE
1004 CSRN99                Z-ADDZZWK2     ZZTOTD
1005 CSRN99                Z-ADDZZWK3     ZZTOTI
1006 C*
1007 C* IF O/F ZEROIZE ZZAMT , IND '99' SET AND ZZTOT FIELDS LEFT INTACT.
1008 CSR 99                Z-ADD0         ZZAMT  153
1009 CSR                   GOTO ZZSEND
1010 C*
1011 C* THE 'SIGNS' ARE DIFFERENT
1012 CSR         ZZOFPS    TAG                             ** ZZOFPS TAG**
1013 C* IF ZZAMT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZTOT
1014 C*
1015 CSR 92                Z-SUBZZAMTI    ZZAMTI 150
1016 CSR 92                Z-SUBZZAMTD    ZZAMTD  30
1017 C*
1018 C* IF ZZTOT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZAMT.
1019 C*
1020 CSR 91                Z-SUBZZTOTI    ZZTOTI
1021 CSR 91                Z-SUBZZTOTD    ZZTOTD
1022 C* BOTH ZZAMT AND ZZTOT ARE NOW POSITIVE.
1023 C*
1024 CSR         ZZTOTI    COMP ZZAMTI               93  95
1025 CSR 95      ZZTOTD    COMP ZZAMTD               93  95
1026 C*
1027 C* IF ZZTOT EQ. ZZAMT RETURN ZERO.
1028 CSR 95                Z-ADD0         ZZTOTI
1029 CSR 95                Z-ADD0         ZZTOTD
1030 CSR 95                GOTO ZZSEND
1031 C*
1032 C* IF ZZTOT GT. ZZAMT.
1033 CSR 93      ZZAMTD    COMP ZZTOTD               94
1034 CSR 93 94   ZZTOTI    SUB  1         ZZTOTI
1035 CSR 93 94   ZZTOTD    ADD  1000      ZZWK2
1036 CSR 93      ZZTOTI    SUB  ZZAMTI    ZZTOTI
1037 CSR 93 94   ZZWK2     SUB  ZZAMTD    ZZTOTD
1038 CSR 93N94   ZZTOTD    SUB  ZZAMTD    ZZTOTD
1039 C*
1040 C*
1041 C* IF ZZAMT GT. ZZTOT.
1042 CSRN93      ZZTOTD    COMP ZZAMTD               94
1043 CSRN93 94   ZZAMTI    SUB  1         ZZWK3  150
1044 CSRN93 94   ZZAMTD    ADD  1000      ZZWK2
1045 CSRN93 94   ZZWK3     SUB  ZZTOTI    ZZTOTI
1046 CSRN93N94   ZZAMTI    SUB  ZZTOTI    ZZTOTI
1047 CSRN93 94   ZZWK2     SUB  ZZTOTD    ZZTOTD
1048 CSRN93N94   ZZAMTD    SUB  ZZTOTD    ZZTOTD
1049 C*
1050 C* REVERSE SIGN OF ZZTOT IF LARGER I/P FIELDS WERE NEGATIVE
1051 CSR                   SETOF                     94
1052 CSR 93 91
1053 CORN93 92             SETON                     94
1054 CSR 94                Z-SUBZZTOTI    ZZTOTI
1055 CSR 94                Z-SUBZZTOTD    ZZTOTD
1056 C**
1057 C**   RESTORE SIGN OF ZZAMTI & ZZAMTD IF IT WAS REVERSED.
1058 CSR 92                Z-SUBZZAMTI    ZZAMTI
1059 CSR 92                Z-SUBZZAMTD    ZZAMTD
1060 CSR         ZZSEND    TAG                             ** ZZSEND TAG *
1061 C**
1062 C**   IF ZZTOTD IS ZERO, AND ZZTOTI IS NEG. SET UP ZZNEGD.
1063 CSR                   SETOF                     96
1064 CSR         ZZTOTD    COMP 0                        91
1065 CSR 91      ZZTOTI    COMP 0                      96
1066 CSR 96                MOVE '.000-'   ZZNEGD  5
1067 CSR                   ENDSR                             ** ENDSR **
1068 C********************************************************************
1069 C********************************************************************
1070 C* CONTROL CHECK ON S/LTRIN
1071 C*
1072 C*   TTRANS IS CALLED BY - MAIN PROCESSING
1073 C*
1074 C********************************************************************
1075 C           TTRANS    BEGSR                           *** TTRANS ***
1076 C* FOR 'H' AND 'T'
1077 C           COUNT     ADD  2         COUNT
1078 C  N43      COUNT     COMP NORL                 4343
1079 C   43                SETON                     U8
1080 C                     ENDSR
1081 C********************************************************************
1082 C********************************************************************
1083 C**
0469 C*****ZSYSTM*SR.*TO*CHAIN TO THE INSTALLATION CONTROL DATA RECORD.   S01194
0470 C**********                                                          S01194
0471 C********** ZSYSTM    BEGSR                           *** ZSYSTM *** S01194
0472 C**********                                                          S01194
0473 C*****SET*UP*KEY*FOR*INSTALLATION CONTROL RECORD.                    S01194
0474 C**********           MOVEL'01      'ZTABKY 12                       S01194
0475 C**********           MOVE '  10'    ZTABKY                          S01194
0476 C**********                                                          S01194
0477 C********** ZTABKY    CHAINTABLE                99    ON NOT THERE   S01194
0478 C**N99***** RECI      COMP 'D'                  9999  ON, IS DELETED S01194
0479 C**********                                                          S01194
0480 C*****CHECK*SYSTEM*DATE FORMAT, DDMMYY OR MMDDYY.                    S01194
0481 C********** DATF      COMP 'M'                      98MMDDYY, 98 ON  S01194
0482 C**********                                                          S01194
0483 C**********           ENDSR                                          S01194
      *****************************************************************                       CLE034
      *                                                               *                       CLE034
      * SR34A       :  Initial set up for CLE034 Processing           *                       CLE034
      *                                                               *                       CLE034
      *****************************************************************                       CLE034
     C           SR34A     BEGSR                                                              CLE034
      *                                                                                       CLE034
     C                     Z-ADD*ZERO     WTOTAL 130                                          CLE034
     C                     Z-ADD*ZERO     WKAMT  130                                          CLE034
     C                     MOVE *BLANKS   WKFLD                                               CLE034
      *                                                                                       CLE034
     C           RCDT      IFEQ 'A'                                                           CLE034
     C**********           MOVE PONSDK    W1PONS 12                                    CLE034 CGL029
     C                     MOVE PONSDK    W1PONS 18                                           CGL029
     C                     Z-ADDPSTMDK    W1PSTM  20                                          CLE034
     C                     Z-ADDRSTMDK    W1RSTM  20                                          CLE034
     C**********           MOVE RONSDK    W1RONS 12                                    CLE034 CGL029
     C                     MOVE RONSDK    W1RONS 18                                           CGL029
     C                     MOVE OSBR      W1OSBR  3                                           CLE034
     C                     MOVE SCCY      W1SCCY  3                                           CLE034
     C                     Z-ADDREXRDK    W1REXR 138                                          CLE034
     C                     MOVE REXIDK    W1REXI  1                                           CLE034
     C***********          Z-ADDROBNDK    W1ROBN  60                                   CLE034 CSD027
     C                     MOVE ROBNDK    W1ROBN  6                                           CSD027
     C***********          Z-ADDROCNDK    W1ROCN  60                                   CLE034 CSD027
     C                     MOVE ROCNDK    W1ROCN  6                                           CSD027
     C                     MOVE RIBNDK    W1RIBN  8                                           CLE034
     C                     MOVE RIBADK    W1RIBA 35                                           CLE034
     C                     MOVE PSCYDK    W1PSCY  3                                           CLE034
     C                     Z-ADDPEXRDK    W1PEXR 138                                          CLE034
     C                     MOVE PEXIDK    W1PEXI  1                                           CLE034
     C***********          Z-ADDPOBNDK    W1POBN  60                                   CLE034 CSD027
     C                     MOVE POBNDK    W1POBN  6                                           CSD027
     C***********          Z-ADDPOCNDK    W1POCN  60                                   CLE034 CSD027
     C                     MOVE POCNDK    W1POCN  6                                           CSD027
     C                     MOVE PIBNDK    W1PIBN  8                                           CLE034
     C                     MOVE PIBADK    W1PIBA 35                                           CLE034
     C                     MOVE RVNODK    W1RVNO  8                                           CLE034
     C                     MOVE CVMRDK    W1CVMR  1                                           CLE034
     C                     MOVE RCRNDK    W1RCRN  8                                           CLE034
     C                     MOVE RCRADK    W1RCRA 35                                           CLE034
      *                                                                                       CLE034
     C                     MOVE LNRFDK    PLNRF                                               CLE034
     C                     MOVE VDATDK    PLAVD                                               CLE034
     C                     MOVE LASNDK    PLASQ                                               CLE034
     C                     MOVEL'LA'      PTYPE   4                                           CLE034
     C                     MOVE AMTPDK    PTYPE                                               CLE034
     C                     CALL 'AOSTALR2'                                                    CLE034
     C                     PARM *BLANKS   PRETCD  7                                           CLE034
     C                     PARM '*FIRST ' POPTN   7                                           CLE034
     C                     PARM           PTYPE                                               CLE034
     C                     PARM           PLNRF   6                                           CLE034
     C                     PARM           PLAVD   5                                           CLE034
     C                     PARM           PLASQ   3                                           CLE034
     C                     PARM *BLANKS   PCFEE   6                                           CLE034
     C                     PARM *BLANKS   PFFEE   5                                           CLE034
     C                     PARM *BLANKS   PFSEQ   2                                           CLE034
     C                     PARM WKPYRC    PPYRC   1                                           CLE034
     C           LESTAL    PARM *BLANKS   DSSDY                                               CLE034
     C                     ELSE                                                               CLE034
     C                     MOVE PONS      W1PONS                                              CLE034
     C                     Z-ADDPSTM      W1PSTM                                              CLE034
     C                     Z-ADDRSTM      W1RSTM                                              CLE034
     C                     MOVE RONS      W1RONS                                              CLE034
     C                     MOVE OSDB      W1OSBR                                              CLE034
     C                     MOVE SCCY      W1SCCY                                              CLE034
     C                     Z-ADDREXR      W1REXR                                              CLE034
     C                     MOVE REXI      W1REXI                                              CLE034
     C***********          Z-ADDROBN      W1ROBN                                       CLE034 CSD027
     C                     MOVE ROBN      W1ROBN                                              CSD027
     C***********          Z-ADDROCN      W1ROCN                                       CLE034 CSD027
     C                     MOVE ROCN      W1ROCN                                              CSD027
     C                     MOVE RIBN      W1RIBN                                              CLE034
     C                     MOVE RIBA      W1RIBA                                              CLE034
     C                     MOVE PSCY      W1PSCY                                              CLE034
     C                     Z-ADDPEXR      W1PEXR                                              CLE034
     C                     MOVE PEXI      W1PEXI                                              CLE034
     C***********          Z-ADDPOBN      W1POBN                                       CLE034 CSD027
     C                     MOVE POBN      W1POBN                                              CSD027
     C***********          Z-ADDPOCN      W1POCN                                       CLE034 CSD027
     C                     MOVE POCN      W1POCN                                              CSD027
     C                     MOVE PIBN      W1PIBN                                              CLE034
     C                     MOVE PIBA      W1PIBA                                              CLE034
     C                     MOVE RVNO      W1RVNO                                              CLE034
     C                     MOVE CVMR      W1CVMR                                              CLE034
     C                     MOVE RCRN      W1RCRN                                              CLE034
     C                     MOVE RCRA      W1RCRA                                              CLE034
      *                                                                                       CLE034
     C                     MOVE LNRF      PLNRF                                               CLE034
     C                     CALL 'AOSTALR2'                                                    CLE034
     C                     PARM *BLANKS   PRETCD                                              CLE034
     C                     PARM '*FIRST ' POPTN                                               CLE034
     C                     PARM 'LOAN'    PTYPE                                               CLE034
     C                     PARM           PLNRF                                               CLE034
     C                     PARM *BLANKS   PLAVD                                               CLE034
     C                     PARM *BLANKS   PLASQ                                               CLE034
     C                     PARM *BLANKS   PCFEE                                               CLE034
     C                     PARM *BLANKS   PFFEE                                               CLE034
     C                     PARM *BLANKS   PFSEQ                                               CLE034
     C                     PARM WKPYRC    PPYRC                                               CLE034
     C           LESTAL    PARM *BLANKS   DSSDY                                               CLE034
     C                     ENDIF                                                              CLE034
      *                                                                                       CLE034
     C           PRETCD    IFEQ *BLANKS                                                       CLE034
     C                     MOVEL'AOSTALR2'DBPGM                                               CLE034
     C                     MOVEL'LESTALPD'DBFILE                                              CLE034
     C                     MOVELLNRF      DBKEY                                               CLE034
     C                     Z-ADD30        DBASE                                               CLE034
     C                     MOVE *ON       *INLR                                               CLE034
     C                     MOVE *ON       *INU7                                               CLE034
     C                     MOVE *ON       *INU8                                               CLE034
     C                     ENDIF                                                              CLE034
      *                                                                                       CLE034
     C                     ENDSR                                                              CLE034
      *****************************************************************                       CLE034
      *                                                               *                       CLE034
      * SR34B       :  Processing to calculate amount for settlement  *                       CLE034
      *                allocation                                     *                       CLE034
      *                                                               *                       CLE034
      *****************************************************************                       CLE034
     C           SR34B     BEGSR                                                              CLE034
      *                                                                                       CLE034
     C                     Z-ADDEAMT      WSAMT  130                                          CLE034
      *                                                                                       CLE034
     C                     Z-ADD*ZERO     WKPYPC 139                                          CLE034
     C           WKPYRC    IFEQ 'P'                                                           CLE034
     C           PYPC      DIV  100       WKPYPC                                              CLE034
     C           WSAMT     MULT WKPYPC    WKAMT     H                                         CLE034
     C                     ELSE                                                               CLE034
     C           RCPC      DIV  100       WKPYPC                                              CLE034
     C           WSAMT     MULT WKPYPC    WKAMT     H                                         CLE034
     C                     ENDIF                                                              CLE034
      *                                                                                       CLE034
     C                     ADD  WKAMT     WTOTAL                                              CLE034
      *                                                                                       CLE034
     C           WKFLD     IFEQ 'Y'                                                           CLE034
     C           WTOTAL    ANDNEWSAMT                                                         CLE034
     C           WSAMT     SUB  WTOTAL    WDIFF  150                                          CLE034
     C                     ADD  WDIFF     WKAMT                                               CLE034
     C                     ENDIF                                                              CLE034
      *                                                                                       CLE034
     C                     Z-ADDWKAMT     EAMT                                                CLE034
      *                                                                                       CLE034
     C                     EXSR SR34D                                                         CLE034
      *                                                                                       CLE034
     C                     ENDSR                                                              CLE034
      *****************************************************************                       CLE034
      *                                                               *                       CLE034
      * SR34C       :  Processing to get next settlement allocation   *                       CLE034
      *                                                               *                       CLE034
      *****************************************************************                       CLE034
     C           SR34C     BEGSR                                                              CLE034
      *                                                                                       CLE034
     C           WKFLD     IFEQ 'Y'                                                           CLE034
     C                     MOVE *BLANKS   WKFLD                                               CLE034
     C                     ELSE                                                               CLE034
      *                                                                                       CLE034
     C           RCDT      IFEQ 'A'                                                           CLE034
     C                     MOVE LNRFDK    PLNRF                                               CLE034
     C                     MOVE VDATDK    PLAVD                                               CLE034
     C                     MOVE LASNDK    PLASQ                                               CLE034
     C                     MOVEL'LA'      PTYPE                                               CLE034
     C                     MOVE AMTPDK    PTYPE                                               CLE034
     C                     CALL 'AOSTALR2'                                                    CLE034
     C                     PARM *BLANKS   PRETCD                                              CLE034
     C                     PARM '*NEXT  ' POPTN                                               CLE034
     C                     PARM           PTYPE                                               CLE034
     C                     PARM           PLNRF                                               CLE034
     C                     PARM           PLAVD                                               CLE034
     C                     PARM           PLASQ                                               CLE034
     C                     PARM *BLANKS   PCFEE                                               CLE034
     C                     PARM *BLANKS   PFFEE                                               CLE034
     C                     PARM *BLANKS   PFSEQ                                               CLE034
     C                     PARM WKPYRC    PPYRC                                               CLE034
     C           LESTAL    PARM *BLANKS   DSSDY                                               CLE034
     C                     ELSE                                                               CLE034
     C                     MOVE LNRF      PLNRF                                               CLE034
     C                     CALL 'AOSTALR2'                                                    CLE034
     C                     PARM *BLANKS   PRETCD                                              CLE034
     C                     PARM '*NEXT  ' POPTN                                               CLE034
     C                     PARM 'LOAN'    PTYPE                                               CLE034
     C                     PARM           PLNRF                                               CLE034
     C                     PARM *BLANKS   PLAVD                                               CLE034
     C                     PARM *BLANKS   PLASQ                                               CLE034
     C                     PARM *BLANKS   PCFEE                                               CLE034
     C                     PARM *BLANKS   PFFEE                                               CLE034
     C                     PARM *BLANKS   PFSEQ                                               CLE034
     C                     PARM WKPYRC    PPYRC                                               CLE034
     C           LESTAL    PARM *BLANKS   DSSDY                                               CLE034
     C                     ENDIF                                                              CLE034
      *                                                                                       CLE034
     C           PRETCD    IFEQ '*EOF'                                                        CLE034
     C                     MOVE 'Y'       WKFLD                                               CLE034
     C                     ENDIF                                                              CLE034
     C                     ENDIF                                                              CLE034
      *                                                                                       CLE034
     C                     ENDSR                                                              CLE034
      *****************************************************************                       CLE034
      *                                                               *                       CLE034
      * SR34D       :  Set up fields from settlement allocation       *                       CLE034
      *                                                               *                       CLE034
      *****************************************************************                       CLE034
     C           SR34D     BEGSR                                                              CLE034
      *                                                                                       CLE034
     C           RCDT      IFEQ 'A'                                                           CLE034
     C           WKPYRC    IFEQ 'P'                                                           CLE034
     C                     MOVE STPSTM    SETPDK                                              CLE034
     C                     MOVE STPOBR    OSBR                                                CLE034
     C                     ELSE                                                               CLE034
     C                     MOVE STRSTM    SETPDK                                              CLE034
     C                     MOVE STROBR    OSBR                                                CLE034
     C                     ENDIF                                                              CLE034
      *                                                                                       CLE034
     C                     MOVE SETPDK    SETTLE                                              CLE034
     C                     MOVE STPONS    PONSDK                                              CLE034
     C                     MOVE STPSTM    PSTMDK                                              CLE034
     C                     MOVE STRSTM    RSTMDK                                              CLE034
     C                     MOVE STRONS    RONSDK                                              CLE034
     C                     MOVE STSCCY    SCCY                                                CLE034
     C                     Z-ADDSTREXR    REXRDK                                              CLE034
     C                     MOVE STREXI    REXIDK                                              CLE034
     C***********          Z-ADDSTROBN    ROBNDK                                       CLE034 CSD027
     C                     MOVE STROBN    ROBNDK                                              CSD027
     C***********          Z-ADDSTROCN    ROCNDK                                       CLE034 CSD027
     C                     MOVE STROCN    ROCNDK                                              CSD027
     C                     MOVE STRIBN    RIBNDK                                              CLE034
     C                     MOVE STRIBA    RIBADK                                              CLE034
     C                     MOVE STPSCY    PSCYDK                                              CLE034
     C                     Z-ADDSTPEXR    PEXRDK                                              CLE034
     C                     MOVE STPEXI    PEXIDK                                              CLE034
     C***********          Z-ADDSTPOBN    POBNDK                                       CLE034 CSD027
     C                     MOVE STPOBN    POBNDK                                              CSD027
     C***********          Z-ADDSTPOCN    POCNDK                                       CLE034 CSD027
     C                     MOVE STPOCN    POCNDK                                              CSD027
     C                     MOVE STPIBN    PIBNDK                                              CLE034
     C                     MOVE STPIBA    PIBADK                                              CLE034
     C                     MOVE STRVNO    RVNODK                                              CLE034
     C                     MOVE STCVMR    CVMRDK                                              CLE034
     C                     MOVE STRCRN    RCRNDK                                              CLE034
     C                     MOVE STRCRA    RCRADK                                              CLE034
      *                                                                                       CLE034
     C                     ELSE                                                               CLE034
     C           WKPYRC    IFEQ 'P'                                                           CLE034
     C                     MOVE STPSTM    SDST                                                CLE034
     C                     MOVE STPOBR    OSDB                                                CLE034
     C                     ELSE                                                               CLE034
     C                     MOVE STRSTM    SDST                                                CLE034
     C                     MOVE STROBR    OSDB                                                CLE034
     C                     ENDIF                                                              CLE034
      *                                                                                       CLE034
     C                     MOVE SDST      SETTLE                                              CLE034
     C                     MOVE STPONS    PONS                                                CLE034
     C                     MOVE STPSTM    PSTM                                                CLE034
     C                     MOVE STRSTM    RSTM                                                CLE034
     C                     MOVE STRONS    RONS                                                CLE034
     C                     MOVE STSCCY    SCCY                                                CLE034
     C                     Z-ADDSTREXR    REXR                                                CLE034
     C                     MOVE STREXI    REXI                                                CLE034
     C***********          Z-ADDSTROBN    ROBN                                         CLE034 CSD027
     C                     MOVE STROBN    ROBN                                                CSD027
     C***********          Z-ADDSTROCN    ROCN                                         CLE034 CSD027
     C                     MOVE STROCN    ROCN                                                CSD027
     C                     MOVE STRIBN    RIBN                                                CLE034
     C                     MOVE STRIBA    RIBA                                                CLE034
     C                     MOVE STPSCY    PSCY                                                CLE034
     C                     Z-ADDSTPEXR    PEXR                                                CLE034
     C                     MOVE STPEXI    PEXI                                                CLE034
     C***********          Z-ADDSTPOBN    POBN                                         CLE034 CSD027
     C                     MOVE STPOBN    POBN                                                CSD027
     C***********          Z-ADDSTPOCN    POCN                                         CLE034 CSD027
     C                     MOVE STPOCN    POCN                                                CSD027
     C                     MOVE STPIBN    PIBN                                                CLE034
     C                     MOVE STPIBA    PIBA                                                CLE034
     C                     MOVE STRVNO    RVNO                                                CLE034
     C                     MOVE STCVMR    CVMR                                                CLE034
     C                     MOVE STRCRN    RCRN                                                CLE034
     C                     MOVE STRCRA    RCRA                                                CLE034
     C                     ENDIF                                                              CLE034
      *                                                                                       CLE034
     C                     ENDSR                                                              CLE034
      *****************************************************************                       CLE034
      *                                                               *                       CLE034
      * SR34E       :  Restore saved fields                           *                       CLE034
      *                                                               *                       CLE034
      *****************************************************************                       CLE034
     C           SR34E     BEGSR                                                              CLE034
      *                                                                                       CLE034
     C           RCDT      IFEQ 'A'                                                           CLE034
     C                     MOVE W1PONS    PONSDK                                              CLE034
     C                     Z-ADDW1PSTM    PSTMDK                                              CLE034
     C                     Z-ADDW1RSTM    RSTMDK                                              CLE034
     C                     MOVE W1RONS    RONSDK                                              CLE034
     C                     MOVE W1OSBR    OSBR                                                CLE034
     C                     MOVE W1SCCY    SCCY                                                CLE034
     C                     Z-ADDW1REXR    REXRDK                                              CLE034
     C                     MOVE W1REXI    REXIDK                                              CLE034
     C***********          Z-ADDW1ROBN    ROBNDK                                       CLE034 CSD027
     C                     MOVE W1ROBN    ROBNDK                                              CSD027
     C***********          Z-ADDW1ROCN    ROCNDK                                       CLE034 CSD027
     C                     MOVE W1ROCN    ROCNDK                                              CSD027
     C                     MOVE W1RIBN    RIBNDK                                              CLE034
     C                     MOVE W1RIBA    RIBADK                                              CLE034
     C                     MOVE W1PSCY    PSCYDK                                              CLE034
     C                     Z-ADDW1PEXR    PEXRDK                                              CLE034
     C                     MOVE W1PEXI    PEXIDK                                              CLE034
     C***********          Z-ADDW1POBN    POBNDK                                       CLE034 CSD027
     C                     MOVE W1POBN    POBNDK                                              CSD027
     C***********          Z-ADDW1POCN    POCNDK                                       CLE034 CSD027
     C                     MOVE W1POCN    POCNDK                                              CSD027
     C                     MOVE W1PIBN    PIBNDK                                              CLE034
     C                     MOVE W1PIBA    PIBADK                                              CLE034
     C                     MOVE W1RVNO    RVNODK                                              CLE034
     C                     MOVE W1CVMR    CVMRDK                                              CLE034
     C                     MOVE W1RCRN    RCRNDK                                              CLE034
     C                     MOVE W1RCRA    RCRADK                                              CLE034
     C                     ELSE                                                               CLE034
     C                     MOVE W1PONS    PONS                                                CLE034
     C                     Z-ADDW1PSTM    PSTM                                                CLE034
     C                     Z-ADDW1RSTM    RSTM                                                CLE034
     C                     MOVE W1RONS    RONS                                                CLE034
     C                     MOVE W1OSBR    OSDB                                                CLE034
     C                     MOVE W1SCCY    SCCY                                                CLE034
     C                     Z-ADDW1REXR    REXR                                                CLE034
     C                     MOVE W1REXI    REXI                                                CLE034
     C***********          Z-ADDW1ROBN    ROBN                                         CLE034 CSD027
     C                     MOVE W1ROBN    ROBN                                                CSD027
     C***********          Z-ADDW1ROCN    ROCN                                         CLE034 CSD027
     C                     MOVE W1ROCN    ROCN                                                CSD027
     C                     MOVE W1RIBN    RIBN                                                CLE034
     C                     MOVE W1RIBA    RIBA                                                CLE034
     C                     MOVE W1PSCY    PSCY                                                CLE034
     C                     Z-ADDW1PEXR    PEXR                                                CLE034
     C                     MOVE W1PEXI    PEXI                                                CLE034
     C***********          Z-ADDW1POBN    POBN                                         CLE034 CSD027
     C                     MOVE W1POBN    POBN                                                CSD027
     C***********          Z-ADDW1POCN    POCN                                         CLE034 CSD027
     C                     MOVE W1POCN    POCN                                                CSD027
     C                     MOVE W1PIBN    PIBN                                                CLE034
     C                     MOVE W1PIBA    PIBA                                                CLE034
     C                     MOVE W1RVNO    RVNO                                                CLE034
     C                     MOVE W1CVMR    CVMR                                                CLE034
     C                     MOVE W1RCRN    RCRN                                                CLE034
     C                     MOVE W1RCRA    RCRA                                                CLE034
     C                     ENDIF                                                              CLE034
      *                                                                                       CLE034
     C                     ENDSR                                                              CLE034
1099 C**
1100 C********************************************************************
     C*                                                                   S11117
     C* *PSSR  --- SUBROUTINE TO HANDLE ABNORMAL ERROR CONDITIONS         S11117
     C*                                                                   S11117
     C* CALLED FROM: AFTER ABNORNAL OPERATION OCCURS                      S11117
     C*                                                                   S11117
     C* CALLS: NOTHING                                                    S11117
     C*                                                                   S11117
     C*****************************************************************   S11117
     C*                                                                   S11117
     C           *PSSR     BEGSR                           ** *PSSR **    S11117
     C*                                                                   S11117
     C           @RUN      IFEQ *BLANKS                                   S11117
     C                     MOVE 'Y'       @RUN    1                       S11117
     C*                                                                   S11117
     C                     DUMP                                           S11117
     C                     END                                            S11117
     C*                                                                   S11117
     C                     ENDSR                           ** *PSSR **    S11117
     C/EJECT                                                              CEU004
     C           XCAMT     BEGSR                                          CEU004
      *===================================================================CEU004
      * XCAMT: Convert Amount.                                            CEU004
      *                                                                   CEU004
      *-------------------------------------------------------------------CEU004
      ** Convert Transaction Amount into Settlement Amount.               CEU004
      *                                                                   CEU004
     C                     CALL 'EU0200'                                  CEU004
      *                                                    Input:         CEU004
     C                     PARM *BLANKS   P@RTCD  7        -Return Code   CEU004
     C                     PARM           P@FRAM 183       -FROM Ccy Amt  CEU004
     C                     PARM           P@FRCY  3        -FROM Currency CEU004
     C                     PARM           P@TOCY  3        -TO Currency   CEU004
      *                                                    Output:        CEU004
     C                     PARM           P@OUTA 150       -Outright Amt  CEU004
     C                     PARM           P@INTA 183       -Interim Amt   CEU004
     C                     PARM           P@EXRT 159       -Exchange Rate CEU004
     C                     PARM           P@MDIN  1        -Mult/Div Ind. CEU004
      *                                                                   CEU004
     C           P@RTCD    IFNE *BLANK                     If Error       CEU004
      *                                                                   CEU004
     C                     MOVEL'EU0200  'DBFILE            Set File      CEU004
     C                     MOVELCCY       DBKEY             Set Key       CEU004
     C                     Z-ADD10        DBASE             Set Ref       CEU004
     C                     SETON                     U7U8LR Set Inds      CEU004
     C                     ENDIF                           End If         CEU004
      *                                                                   CEU004
      *===================================================================CEU004
     C                     ENDSR                                          CEU004
      *****************************************************************                       CLE038
      /EJECT                                                                                  CLE038
      *****************************************************************                       CLE038
      *                                                               *                       CLE038
      * SRCL38 -  Calculate amount in loan ccy for settlement         *                       CLE038
      *           allocation by amount                                *                       CLE038
      *                                                               *                       CLE038
      *****************************************************************                       CLE038
     C           SRCL38    BEGSR                                                              CLE038
      *                                                                                       CLE038
     C           WKPYRC    IFEQ 'P'                                                           CLE038
     C                     Z-ADDSTPYAM    EAMT                                                CLE038
     C                     ELSE                                                               CLE038
     C                     Z-ADDSTRCAM    EAMT                                                CLE038
     C                     ENDIF                                                              CLE038
      *                                                                                       CLE038
     C                     Z-ADDEAMT      AMTSV                                               CLE038
     C                     Z-ADDEAMT      WSAMT                                               CLE038
      *                                                                                       CLE038
     C           WKPYRC    IFEQ 'P'                                                           CLE038
     C           STPSCY    ANDNECCYSV                                                         CLE038
     C           STPSCY    ANDNE' '                                                           CLE038
     C           WKPYRC    OREQ 'R'                                                           CLE038
     C           STSCCY    ANDNECCYSV                                                         CLE038
     C           STSCCY    ANDNE' '                                                           CLE038
      *                                                                                       CLE038
     C                     MOVE CCYSV     CURKEY                                              CLE038
      *                                                                                       CLE038
     C                     CALL 'AOCURRR0'             99                                     CLE038
     C                     PARM '*MSG    '@RTCD                                               CLE038
     C                     PARM '*KEY    '@OPTN                                               CLE038
     C                     PARM           CURKEY                                              CLE038
     C           SDCURR    PARM SDCURR    DSSDY                                               CLE038
      *                                                                                       CLE038
     C           @RTCD     IFNE *BLANKS                                                       CLE038
     C                     MOVE *ON       *INU7                                               CLE038
     C                     MOVE *ON       *INU8                                               CLE038
     C                     MOVE *ON       *INLR                                               CLE038
     C                     Z-ADD30        DBASE                                               CLE038
     C                     MOVE 'SDCURRPD'DBFILE                                              CLE038
     C                     MOVELCURKEY    DBKEY                                               CLE038
     C                     GOTO END                                                           CLE038
     C                     ENDIF                                                              CLE038
      *                                                                                       CLE038
     C                     MOVE A6INCY    LCCYIN                                              CLE038
     C                     Z-ADDA6NBDP    LCCYDP                                              CLE038
      *                                                                                       CLE038
     C           WKPYRC    IFEQ 'P'                                                           CLE038
     C                     MOVE STPSCY    CURKEY                                              CLE038
     C                     ELSE                                                               CLE038
     C                     MOVE STSCCY    CURKEY                                              CLE038
     C                     ENDIF                                                              CLE038
      *                                                                                       CLE038
     C                     CALL 'AOCURRR0'             99                                     CLE038
     C                     PARM '*MSG    '@RTCD                                               CLE038
     C                     PARM '*KEY    '@OPTN                                               CLE038
     C                     PARM           CURKEY                                              CLE038
     C           SDCURR    PARM SDCURR    DSSDY                                               CLE038
      *                                                                                       CLE038
     C           @RTCD     IFNE *BLANKS                                                       CLE038
     C                     MOVE *ON       *INU7                                               CLE038
     C                     MOVE *ON       *INU8                                               CLE038
     C                     MOVE *ON       *INLR                                               CLE038
     C                     Z-ADD31        DBASE                                               CLE038
     C                     MOVE 'SDCURRPD'DBFILE                                              CLE038
     C                     MOVELCURKEY    DBKEY                                               CLE038
     C                     GOTO END                                                           CLE038
     C                     ENDIF                                                              CLE038
      *                                                                                       CLE038
     C                     MOVE A6INCY    SCCYIN                                              CLE038
     C                     Z-ADDA6NBDP    SCCYDP                                              CLE038
      *                                                                                       CLE038
     C           LCCYIN    IFEQ 'Y'                                                           CLE038
     C           SCCYIN    OREQ 'Y'                                                           CLE038
      *                                                                                       CLE038
     C                     Z-ADDEAMT      P@FRAM                                              CLE038
     C                     MOVE CURKEY    P@FRCY                                              CLE038
     C                     MOVE CCYSV     P@TOCY                                              CLE038
     C                     EXSR XCAMT                                                         CLE038
     C                     MOVE P@OUTA    AMTSV                                               CLE038
     C                     Z-ADDAMTSV     WSAMT                                               CLE038
      *                                                                                       CLE038
     C                     ELSE                                                               CLE038
      *                                                                                       CLE038
     C           *IN45     IFEQ *ON                                                           CLE038
     C                     Z-ADDPEXR      WEXR                                                CLE038
     C           PEXI      IFEQ 'M'                                                           CLE038
     C                     MOVE 'D'       WEXI                                                CLE038
     C                     ELSE                                                               CLE038
     C                     MOVE 'M'       WEXI                                                CLE038
     C                     ENDIF                                                              CLE038
     C                     ENDIF                                                              CLE038
      *                                                                                       CLE038
     C           *IN46     IFEQ *ON                                                           CLE038
     C                     Z-ADDREXR      WEXR                                                CLE038
     C           REXI      IFEQ 'M'                                                           CLE038
     C                     MOVE 'D'       WEXI                                                CLE038
     C                     ELSE                                                               CLE038
     C                     MOVE 'M'       WEXI                                                CLE038
     C                     ENDIF                                                              CLE038
     C                     ENDIF                                                              CLE038
      *                                                                                       CLE038
     C                     Z-ADDEAMT      ZAMTCI                                              CLE038
     C                     Z-ADDWEXR      ZEXCH                                               CLE038
     C                     MOVE WEXI      ZMD                                                 CLE038
     C                     MOVE CURKEY    ZCCYI                                               CLE038
     C                     MOVE CCYSV     ZCCYO                                               CLE038
     C                     Z-ADDSCCYDP    ZCDPI                                               CLE038
     C                     Z-ADDLCCYDP    ZCDPO                                               CLE038
      *                                                                                       CLE038
     C                     CALL 'ZCONVZ1'                                                     CLE038
     C                     PARM           ZAMTCI                                              CLE038
     C                     PARM           ZEXCH                                               CLE038
     C                     PARM           ZMD                                                 CLE038
     C                     PARM           ZCCYI                                               CLE038
     C                     PARM           ZCCYO                                               CLE038
     C                     PARM           ZCDPI                                               CLE038
     C                     PARM           ZCDPO                                               CLE038
     C                     PARM           ZAMTCO                                              CLE038
      *                                                                                       CLE038
     C                     Z-ADDZAMTCO    AMTSV                                               CLE038
     C                     Z-ADDAMTSV     WSAMT                                               CLE038
      *                                                                                       CLE038
     C                     ENDIF                                                              CLE038
      *                                                                                       CLE038
     C           WKPYRC    IFEQ 'P'                                                           CLE038
     C           ICCY      IFNE *BLANKS                                                       CLE038
      *                                                                                       CLE038
     C           ICCY      IFEQ CCYSV                                                         CLE038
     C                     MOVE CCYSV     OTCY                                                CLE038
     C                     Z-ADDAMTSV     OTAM                                                CLE038
     C                     ELSE                                                               CLE038
     C                     Z-ADDAMTSV     P@FRAM                                              CLE038
     C                     MOVE CCYSV     P@FRCY                                              CLE038
     C                     MOVE ICCY      P@TOCY                                              CLE038
     C                     EXSR XCAMT                                                         CLE038
     C                     MOVE ICCY      OTCY                                                CLE038
     C                     MOVE P@OUTA    AMTSV                                               CLE038
     C                     Z-ADDAMTSV     OTAM                                                CLE038
     C                     ENDIF                                                              CLE038
      *                                                                                       CLE038
     C                     ENDIF                                                              CLE038
     C                     ENDIF                                                              CLE038
      *                                                                                       CLE038
     C                     ENDIF                                                              CLE038
      *                                                                                       CLE038
     C                     ENDSR                                                              CLE038
     C********************************************************************S11117
1101 O*                  C O N T R O L   R E P O R T
1102 O*E1068P1T  203   LR                                                 S11117
     OLE1068AUT  203   LR                                                 S01117
1103 O                                   22 'REFERENCE LE1068'
1103 O                                   22 'REFERENCE LE1068AU'          S01117
1104 O                         TITL      89
1105 O                                  122 'DATE              PAGE'
1106 O                         RUNA     112
1107 O                                  130 '1'
1108 O        T  1     LR
1109 O                                   63 'PAY/RECEIVE EXTRACT - FI'
1110 O                                   80 'LE CONTROL REPORT'
1111 O        T  3     LR
1112 O                                   63 '------------------------'
1113 O                                   80 '-----------------'
1114 O        T  1     LR
1115 O                                   28 'S/LTRIN - RUN CONTROLS'
1116 O                                   59 'NUMBER'
1117 O                                   84 'VALUE'
1118 O        T  2     LR
1119 O                                   28 '----------------------'
1120 O                                   59 'OF RECORDS'
1121 O                                   84 'OF RECORDS'
1122 O        T  2     LR
1123 O                                   29 'TOTAL RECORDS ON FILE'
1124 O                         NORL  3   59
1125 O        T  3     LR
1126 O                                   32 'TOTAL RECORDS ON FILE - '
1127 O                                   42 'CALCULATED'
1128 O                         COUNT 3   59
1129 O                    U8NU7         111 '***   DIFFERENCE   ***'
1130 O        T  1     LR
1131 O                                   28 'S/LETX1 - RUN CONTROLS'
1132 O        T  2     LR
1133 O                                   28 '----------------------'
1134 O        T  3     LR
1135 O                                   29 'TOTAL RECORDS ON FILE'
1136 O                         ROP,1 3   59
1137 O                         INT,1 Z   81
1138 O                         DEC,1     84
1139 O        T  1     LR
1140 O                                   28 'S/LETX2 - RUN CONTROLS'
1141 O        T  2     LR
1142 O                                   28 '----------------------'
1143 O        T  3     LR
1144 O                                   29 'TOTAL RECORDS ON FILE'
1145 O                         ROP,2 3   59
1146 O                         INT,2 Z   81
1147 O                         DEC,2     84
1148 O        T  1     LR
1149 O                                   28 'S/LETX3 - RUN CONTROLS'
1150 O        T  2     LR
1151 O                                   28 '----------------------'
1152 O        T  3     LR
1153 O                                   28 'TOTAL RECORDS ON FILE'
1154 O                         ROP,3 3   59
1155 O                         INT,3 Z   81
1156 O                         DEC,3     84
1148 O        T  1     LR U4
1149 O                                   28 'S/LEPXT - RUN CONTROLS'
1150 O        T  2     LR U4
1151 O                                   28 '----------------------'
1152 O        T  3     LR U4
1153 O                                   28 'TOTAL RECORDS ON FILE'
1154 O                         ROP,4 3   59
1155 O                         INT,4 Z   81
1156 O                         DEC,4     84
1367 O        T  1     LR U1                                              S2659
1368 O                                   28 'S/LETX6 - RUN CONTROLS'      S2659
1369 O        T  2     LR U1                                              S2659
1370 O                                   28 '----------------------'      S2659
1371 O        T  3     LR U1                                              S2659
1372 O                                   28 'TOTAL RECORDS ON FILE'       S2659
1373 O                         ROP,5 3   59                               S2659
1374 O                         INT,5 Z   81                               S2659
1375 O                         DEC,5     84                               S2659
1157 O********T*00     LRNU7                                              S01117
1158 O***********                        71 '*** END OF REPORT ***'       S01117
1159 O* IF DATABASE ERROR
1160 O********T**203   LR U7 U8                                           S01117
     O        T  1     LR U7 U8                                           S01117
1161 O***********                        42 '*** REFERENCE'               S01117
     O                                   39 '*** REFERENCE'               S01117
1162 O                         DBPGM     51
1163 O                                   71 '- DATABASE ERROR AT'
1164 O***********              DBASE     74                               S01117
     O                         DBASE     76                               S01117
1165 O        T  1     LR U7 U8
1166 O***********                        37 'FILENAME'                    S01117
1167 O***********              DBFILE    43                               S01117
1168 O***********                        48 'KEY'                         S01117
1169 O***********              DBKEY     78                               S01117
     O                                   39 'FILENAME'                    S01117
     O                         DBFILE    48                               S01117
     O                                   52 'KEY'                         S01117
     O                         DBKEY     82                               S01117
1170 O* O U T P U T   E X T R A C T S
1171 OLETX1HH H        1P
1172 O                                    1 'H'
1173 OLETX1ZZ T        LR
1174 O                                    1 'T'
1175 O                         ROP,1      4P
1176 O                         INT,1     12P
1177 O                         DEC,1     14P
1178 OLETX1PR E        51
1179 O***********              LETX     180                               S01117
     O***********              LETX     181                        S01117 CEU004
     O**********               LETX     210                                            CEU004 CGL029
     O*************************LETX     228                                            CGL029 CLE042
     O                         LETX     232                                                   CLE042
1180 O                         VDATPH    22P
1181 O                         EAMT      51P
     O                         OTAM     207P                              CEU004
1182 OLETX2HH H        1P
1183 O                                    1 'H'
1184 OLETX2ZZ T        LR
1185 O                                    1 'T'
1186 O                         ROP,2      4P
1187 O                         INT,2     12P
1188 O                         DEC,2     14P
1189 OLETX2PR E        52
1190 O***********              LETX     180                               S01117
     O***********              LETX     181                        S01117 CEU004
     O**********               LETX     210                                            CEU004 CGL029
     O*************************LETX     228                                            CGL029 CLE042
     O                         LETX     232                                                   CLE042
1191 O                         VDATPH    22P
1192 O                         EAMT      51P
     O                         OTAM     207P                              CEU004
1193 OLETX3HH H        1P
1194 O                                    1 'H'
1195 OLETX3ZZ T        LR
1196 O                                    1 'T'
1197 O                         ROP,3      4P
1198 O                         INT,3     12P
1199 O                         DEC,3     14P
1200 OLETX3PR E        53
1201 O***********              LETX     180                               S01117
     O***********              LETX     181                        S01117 CEU004
     O**********               LETX     210                                            CEU004 CGL029
     O*************************LETX     228                                            CGL029 CLE042
     O                         LETX     232                                                   CLE042
1202 O                         VDATPH    22P
1203 O                         EAMT      51P
     O                         OTAM     207P                              CEU004
     O*
     OLEPXTAA H        1P
     O                                    1 'H'
     OLEPXTAC T        LR
1185 O                                    1 'T'
1186 O                         ROP,4      4P
1187 O                         INT,4     12P
1188 O                         DEC,4     14P
     OLEPXTAB E        55
     O                                    1 'D'
     O                         LNRFPH     7
     O                         VDATPH    10P
     O                         LASNPH    13
     O                         LTYP      16
     O                         SUTP      18
     O                         PTYP      20
     O                         AMTPPQ    22
     O*                                                                   S01117
     O************             BRCDTX    25                               S01117
     O                         BRCDTX    82                               S01117
     O*                                                                   S01117
     O                         CURREN    35
     O                         EAMT      70P
     O***********              BRCD      73                               S01117
     O                         BRCA      73                               S01117
     O                         CNUMPH    79
     O                         SETTLE    84
     O**********               OURAG     96                                                   CGL029
     O                         THRAG    106
     O                         OTFACO   116
     O                         OTSPI    206
     O                         RCDT     217
     O                         PAYREC   249
     O                         INTCPH   251
     O                         CSID     265
     O                         PINDS    269
     O                         TINDPH   270
     O                         BICN     276
     O                         OTAM     353P                              CEU004
     O                         OTCY     356                               CEU004
     O                         OURAG    374                                                   CGL029
     O                         CLAS     402                                                   CLE042
1461 OLETX6HH H        1P U1                                              S2659
1462 O                                    1 'H'                           S2659
1463 OLETX6ZZ T        LR U1                                              S2659
1464 O                                    1 'T'                           S2659
1465 O                         ROP,5      4P                              S2659
1466 O                         INT,5     12P                              S2659
1467 O                         DEC,5     14P                              S2659
1468 OLETX6PR E        56                                                 S2659
1469 O***********              LETX     181                         S2659 CEU004
     O**********               LETX     210                                            CEU004 CGL029
     O*************************LETX     228                                            CGL029 CLE042
     O                         LETX     232                                                   CLE042
1470 O                         VDATPH    22P                              S2659
1471 O                         EAMT      51P                              S2659
1472 O                                  174 ' '                           S2659
1473 O*                                                                   S2659
     O*
** IPSET - I/P CYCLE SETTLEMENT TYPES
0102070812
** TABTP1 - 'PAY' PROCESSING TYPES
61626364656880                                                                         155570 CLE028
** TABTP2 - 'RECEIVE' PROCESSING TYPES
666769                                                                    155570
** TABTP3 - PTYPS 64 65
646568                                                                    155570
** CPY@   **      OBJECT COPYRIGHT
(c) Finastra International Limited 2001
