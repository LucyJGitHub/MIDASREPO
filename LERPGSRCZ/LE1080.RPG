0001 H        1                                                           S01117
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas LE Update p/r indicators')                       *
0002 F*****************************************************************
0004 F*                                                               *
     F*  Midas Customer Lending Module
0004 F*                                                               *
0005 F*  LE1080  -  UPDATE PAY/RECEIVE INDS. ON CUSTOMER LENDING      *
0006 F*             LOANS AND LOAN AMENDMENTS FILES.                  *
0007 F*                                                               *
      *  (c) Finastra International Limited 2001                      *
0009  *                                                               *
      *  Last Amend No. CER050             Date 16Jun19               *
      *  Prev Amend No. MD046248           Date 27Oct17               *
      *                 CLE141             Date 08Feb16               *
      *                 CLE134             Date 01Aug12               *
      *                 AR322732           Date 23Jul12               *
      *                 CLE148             Date 23Jul12               *
      *                 CRE073             Date 06Dec10               *
      *                 CLE143             Date 06Dec10               *
      *                 CER059             Date 19Jul10               *
      *                 CER020             Date 19May08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CSD031             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 CLE042             Date 06Sep05               *
      *                 219063             Date 22Oct03               *
      *                 CLE036             Date 22Sep03               *
      *                 CAS009             Date 16May05               *
      *                 BUG4488            Date 18Oct04               *
      *                 CGL029             Date 01Sep03               *
      *                 CAP075             Date 08Aug02               *
      *                 CAP074             Date 08Aug02               *
      *                 CAS005             Date 16Dec02               *
      *                 CLE028             Date 27Jun02               *
      *                 CAS004             Date 26Jun02               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.05 -----------------------------------------------*
      *                 CLE011             Date 07Nov00               *
      * Midas DBA 3.02 -----------------------------------------------*
      *                 CLE009             Date 21Jun99               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 144915             Date 28Oct98               *
      *                 E45727             Date 23Nov92               *
      *                 S01392             Date 05Oct92               *
     F*                 S01270             DATE 21MAR91               *
     F*                 S01220             DATE 15MAR91               *
     F*                 S01194             DATE 15JAN90               *
 010 F*                 S01117             DATE 19/07/89              *
 010 F*                 E49673             DATE 06/11/86              *
0010 F*                                                               *
0010 F*---------------------------------------------------------------*
0010  *                                                               *
      *  CER050 - Annualised Percentage Rate (Recompile)              *
      *  MD046248 - Finastra Rebranding                               *
      *  CLE141 - Currency and Location Business Day Convention       *
      *           (Recompile)                                         *
      *  CLE134 - Past Due Call Loan Processing                       *
      *  AR322732 - LEC0212A and APISERVER locks LTRIX file.          *
      *           - Prevent LTRIX RRN 1 from being locked.            *
      *  CLE148 - Alpha Loan Reference                                *
      *  CRE073 - Interest Rate Rounding (Recompile)                  *
      *  CLE143 - Original Loan Contract Date & Effective Interest    *
      *           Rate (Recompile)                                    *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  CER020 - Enhanced Rollover Window: Upgrade FGE089 to         *
      *           Midas Plus                                          *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CLE042 - Extended Loan Sub Type                              *
      *  219063 - Allow File Control Amounts to be negative.          *
      *  CLE036 - LE Enh for Nordea Phase 1 Pty 2- Specific Base Rate *
      *           (Recompile)                                         *
      *  CAS009 - EIR/AC Accounting (Recompile)                       *
      *  BUG4488- Loop in APCONFS when an LECONF is sent to data queue*
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  CAP075 - Lending API enhancements - Loan Amendment.          *
      *           (amendment in common with CAP079)                   *
      *  CAP074 - Lending API enhancements - Loans input.             *
      *  CAS005 - Enhancements to CAS001, CAS002 and CAS004           *
      *           (Recompile)                                         *
      *  CLE028 - Flat Rate Personal Loans (Rule of 78s)              *
      *  CAS004 - Hedge Accounting Phase A                            *
      *  CLE011 - Rate Fixing Days for Lending Rollover Processing    *
      *           Recompile                                           *
      *  CLE009 - LE I/C Swift Msg Generation for Fees
      *  144915 - Recompiled due to changes in LF/CLOAN.              *
     F*  E45727 - Recompile for addition of fee seq in LETX3PR.       *
     F*  S01392 - Japanese sub module enhancements                    *
     F*  S01270 - Amended for customer lending changes                *
     F*  S01220 - Amended for Strategic Risk Management               *
     F*           Release 10 to allow the input of a book             *
     F*           code against a loan.                                *
     F*  S01194 - New standing data                                   *
0010 F*  S01117 - Multibranching                                      *
0010 F*  E49673 - Inserts were incorrectly overwritten with 'A'       *
0010 F*                                                               *
0011 F*****************************************************************
0009 F*                                                               *
     F*  C R E A T I O N     P A R A M E T E R S                      *
     F*                                                               *
     F*                                                               *
     F*****************************************************************
0009 F*                                                                  *
0012 F/SPACE 3
     F*
0013 F***PRTXS** IP  F     180 16AI     1 DISK                                                CGL029
     F*PRTXS***IP**F*****228 16AI     1 DISK                                           CGL029 CLE042
     FPRTXS   IP  F     232 16AI     1 DISK                                                   CLE042
0014 F*ABLE***IF* F      96 12AI     2 DISK                               S01194
0017 F*CLOAN***UF**F*****400  7AI     2 DISK                              S01220
0017 F*CLOAN***UF**F     436  7AI     2 DISK                       S01220 CLE011
0017 F*CLOAN***UF**F    1310  7AI     2 DISK                                           CLE011 CLE028
     F*CLOAN***UF**F    1375  7AI     2 DISK                                           CLE028 CAS004
     F*CLOAN***UF**F    1389  7AI     2 DISK                                           CAS004 CAP074
     F***CLOAN** UF  F    1389  7AI     2 DISK                                         CAP074 CGL029
     F*CLOAN***UF**F****1632  7AI     2 DISK                                           CGL029 CLE042
     F***CLOAN** UF  F    1773  7AI     2 DISK                                         CLE042 CER020
     F***CLOAN** UF  F    1782  7AI     2 DISK                                         CER020 CLE134
     FCLOAN   UF  F    1874  7AI     2 DISK                                                   CLE134
0017 F                                              KCOMIT
0018 F***LOAMS** UF  F     320 14AI     2 DISK                                                CGL029
     F*LOAMS***UF**F****1230 14AI     2 DISK                                           CGL029 CLE042
     FLOAMS   UF  F    1291 14AI     2 DISK                                                   CLE042
0017 F                                              KCOMIT
0019 FLTRIX   UF  F      40            DISK
0017 F                                              KCOMIT
0020 F*E1080P1O** F     132     OF     PRINTER                  S01124    S01117
0020 FLE1080P1O   F     132     OF     PRINTER      KINFDS SPOOL      UC  S01117
     FLE1080AUO   F     132     OV     PRINTER      KINFDS SPOOLU         S01117
0021 F/SPACE 3
     F*
0022 F* ID F  C  H  L    FUNCTION OF INDICATORS
0023 F* 01            S/PRTXS - DETAIL
0024 F* 02                    - TRAILER
0028 F* 06            S/CLOAN - NON '*' DETAIL
0029 F* 07            S/LOAMS - NON '*' DETAIL
0030 F*    20         AMOUNT NEGATIVE
0031 F*    21         PAY/RECEIVE IND 1 SET
0032 F*       40      1ST CYCLE IND.
0033 F*       41      GENERAL
0034 F*       42      CHAIN FAILURE
0035 F*       43      GROUP ON CLOAN FILE
0036 F*       44      UNMATCHED S/PRTXS RECORD
0037 F*       45      RELEASE S/LOAMS
0038 F*       46      RELEASE S/CLOAN
0040 F*       50      DEC. PLACES - 0
0041 F*       51                    1
0042 F*       52                    2
0043 F*       53                    3
0044 F*       54      RECORD REFERS TO A LOAN AMENDMENT
     F*       55      RECORD REFERS TO A FEE                              CLE009
0029 F*       60      MULTIBRANCHING                                      S01117
0029 F*       69      NO DETAILS TO REPORT FOR THE BRANCH                 S01117
0029 F*       70      NO DETAILS TO REPORT                                S01117
0050 F*       71      UPDATE S/CLOAN
0051 F*       72      UPDATE S/LOAMS
0052 F*       73      UPDATE S/LTRIX
0054 F*       85      AT LEAST 1 UNMATCHED RECORD
0054 F*       L1      CHANGE OF BRANCH                                    S01117
     E                    CPY@    1   1 80
     E/COPY ZSRSRC,ZDATE2Z1                                               S01392
0058 I* S/PRTXS DETAIL RECORD
0059 IPRTXS   NS  01   1 CD
0060 I                                        2   2 PYRC
0061 I                                        3   40SETP
0062 I                                        5   7 CCY
0063 I**********                              8  19 OSAC                                      CGL029
     I                                        8  19 OSACQQ                                    CGL029
0064 I                                    P  20  220VDAT
0065 I                                       23  32 TSEN
0066 I**********                             33  380CNUM                                      CSD027
0066 I                                       33  38 CNUM                                      CSD027
0067 I**********                             39  440FCLN                                      CLE148
     I                                       39  44 FCLN                                      CLE148
0068 I                                    P  45  510EAMT          20
0069 I                                       52  52 RCDT
0070 I                                       53  54 AMTP
0071 I                                       55  570LASN
0072 I                                       58  67 FACO
0073 I                                       68 157 SPI
0074 I                                      158 1580PRI1        2121
0075 I                                      159 1590PRI2
0076 I                                      160 1600PRI3
0077 I                                      161 1610PRI4
0078 I**********                            162 1670BICN                                      CSD027
0078 I                                      162 167 BICN                                      CSD027
0079 I                                      168 169 LTYP
0080 I                                      170 171 SUTP
0081 I                                      172 1730PTYP
0082 I                                      174 1740TIND
0083 I***********                           175 1770BRCD                  S01117
0083 I                                      175 177 BRCA  L1              S01117
0084 I                                      178 178 INTC
     I                                      211 228 OSAC                                      CGL029
     I                                      229 232 CLAS                                      CLE042
0085 I*
0086 I* TRAILER
0087 I        NS  02   1 CT
0088 I                                    P   2   40NORE
0089 I                                    P   5  120HRWN
0090 I                                    P  13  140HRDC
0091 I*
0058 I* S/PRTXS AMENDED RECORD                                            CLE009
0059 IPRTXS   NS  03   1 CR                                               CLE009
0068 I                                    P  45  510EAMT          20      CLE009
0092 I* CATCHALL
0093 I        NS
0094 I*
0095 I* LOOK-AHEAD FOR LOAN NUMBER
0096 I        NS  **
     I**********                             39  440NXLNRF                                    CLE148
     I                                       39  44 NXLNRF                                    CLE148
     I                                       55  570NXLASN
0099 I**********                                                          S01194
0100 I*****TABLE FILE - INSTALLATION CONTROL DATA RECORD 1.               S01194
0101 I**********                                                          S01194
0102 I*ABLE***NS       2 C0   3 C1  12 C1                                 S01194
0103 I*******AND      13 C0                                               S01194
0104 I**********                              1   1 RECI                  S01194
0105 I**********                              2   30RECT                  S01194
0106 I**********                             12  130RCDE                  S01194
0107 I**********                             14  66 TITL                  S01194
0108 I***********                            67  67 DATF                  S01194
0109 I***********                            68  700DFBR                  S01194
0110 I**********                             74  74 MODI1                 S01194
0111 I**********                             75  75 MODI2                 S01194
0112 I**********                             76  76 MODI3                 S01194
0113 I***********                         P  77  790RUND                  S01194
0114 I***********                            80  86 RUNA                  S01194
0115 I**********                             87  870SFLG                  S01194
0116 I**********                          P  90  920LCD                   S01194
0117 I**********                             93  93 CHTP                  S01194
0118 I**********                          P  94  960TNLU                  S01194
0119 I**********                                                          S01194
0120 I*****TABLE FILE - CURRENCIES RECORD 1.                              S01194
0121 I**********                                                          S01194
0122 I*ABLE***NS              2 C2   3 C0                                 S01194
0123 I*******AND      13 C1                                               S01194
0124 I**********                              1   1 RECI                  S01194
0125 I**********                              2   30RECT                  S01194
0126 I**********                             10  12 CCY                   S01194
0127 I**********                             13  130SREC                  S01194
0128 I**********                             14  27 CCNM                  S01194
0129 I**********                          P  28  348SPOT                  S01194
0130 I**********                             35  37 CCYS                  S01194
0131 I**********                             38  380CDP                   S01194
0132 I**********                             39  390TNOT                  S01194
0133 I**********                             40  40 DCCY                  S01194
0134 I**********                             41  44 SRC1                  S01194
0135 I**********                             45  48 SRC2                  S01194
0136 I**********                             49  520TACC                  S01194
0137 I**********                             53  560TEQV                  S01194
0138 I**********                             57  600SWQV                  S01194
0139 I**********                             61  640TAC4                  S01194
0140 I**********                             65  680TAC5                  S01194
0141 I**********                             69  69 HIND                  S01194
0142 I**********                          P  70  768PART                  S01194
0143 I**********                             77  780SSNO                  S01194
0144 I**********                          P  79  858ERLC                  S01194
0145 I**********                          P  90  920LCD                   S01194
0146 I**********                             93  93 CHTP                  S01194
0147 I**********                          P  94  960TNLU                  S01194
     I**********                                                          S01194
0148 I**CATCHALL                                                          S01194
0149 I********NS                                                          S01194
0150 I*
0176 I**   LOANS FILE - DETAIL 1
0177 I**
0178 ICLOAN   NS  06   1 CD   8 CA
0179 I                                        1   1 RECI
0180 I**********                              2   70LNRF                                      CLE148
     I                                        2   7 LNRF                                      CLE148
0181 I                                        8   8 RCDT
0182 I                                        9   90MRIN
0183 I                                       10  110PTYP
0184 I**********                             12  170CNUM                                      CSD027
0184 I                                       12  17 CNUM                                      CSD027
0185 I***********                            18  200BRCD                  S01117
0185 I                                       18  20 BRCA                  S01117
0186 I                                       21  22 LTYP
0187 I                                       23  24 SUTP
0188 I                                    P  25  270DDAT
0189 I                                    P  28  300VDAT
0190 I                                    P  31  330MDAT
0191 I                                       34  350LASQ
0192 I**********                             36  410FCUS                                      CSD027
0192 I                                       36  41 FCUS                                      CSD027
0193 I                                       42  440FTYP
0194 I                                       45  460FSEQ
0195 I                                       47  49 CCY
0196 I                                    P  50  560CPAM
0197 I                                       57  57 INTC
0198 I                                    P  58  637INTR
0199 I                                       64  650BRTT
0200 I                                    P  66  717BRTE
0201 I                                    P  72  777RTSP
0202 I                                    P  78  815MARG
0203 I                                       82  82 SPIN
0204 I                                       83  83 CHIN
0205 I                                    P  84  897WTRT
0206 I                                       90  90 WTIN
0207 I                                       91  910REPT
0208 I                                    P  92  980RAMT
0209 I                                    P  99 1010NRPD
0210 I                                      102 102 RFRQ
0211 I                                      103 1040RDYN
0212 I                                      105 107 FCCY
0213 I                                      108 1100LIND
0214 I                                      111 112 CRSK
0215 I                                      113 114 ACOF
0216 I                                      115 115 NACD
0217 I                                      116 116 RELI
0218 I                                      117 117 AUTO
0219 I                                    P 118 1240PSAM
0220 I                                    P 125 1318BCXR
0221 I                                    P 132 1388FCXR
0222 I                                      139 1400SDST
0223 I**********                            141 152 OSDA                                      CGL029
     I                                      141 152 OSDAQQ                                    CGL029
0224 I                                      153 162 TSTN
0225 I                                      163 1640MDST
0226 I**********                            165 176 OMDA                                      CGL029
     I                                      165 176 OMDAQQ                                    CGL029
0227 I                                      177 186 TMAN
0228 I                                      187 196 FACO
0229 I                                    P 197 1990RLDT
0230 I                                    P 200 2020NROD
0231 I                                      203 203 RLFQ
0232 I                                      204 2050RLDY
0233 I                                      207 2080NBRA
0234 I                                    P 209 2147NRTS
0235 I                                      215 215 NSIN
0236 I                                      216 2160NCAC
0237 I                                    P 217 2230AWTP
0238 I                                    P 224 2300WTRD
0239 I                                    P 231 2370WTWD
0240 I                                    P 238 2440IWOD
0241 I                                    P 245 2510PWOD
0242 I                                      252 252 BMDI
0243 I                                      253 253 FMDI
0244 I                                    P 254 2600PDIN
0245 I                                      287 287 BTIN
0246 I                                      288 2890BLDY
0247 I**********                            290 2950OLNO                                      CLE148
     I                                      290 295 OLNO                                      CLE148
0248 I                                      296 296 RCSI
0249 I                                      297 2970ICBS
0250 I                                      298 298 IPFR
0251 I                                    P 299 3050TOTI
0252 I                                    P 306 3080NIDT
0253 I                                    P 309 3110IBDT
0254 I                                    P 312 3140SLID
0255 I                                    P 315 3210AIPD
0256 I                                    P 322 3240DLRC
0257 I                                    P 325 3270IACD
0258 I                                    P 328 3340AITC
0259 I                                    P 335 3410TFEP
0260 I                                    P 342 3480AIAP
0261 I                                    P 349 3550IPRD
0262 I                                    P 356 3620IPRM
0263 I                                    P 363 3690ICTD
0264 I                                    P 370 3760AIMN
0265 I                                    P 377 3790RBDT
0266 I                                      384 3850IFDY
0267 I                                      386 386 LONI
0268 I                                      387 387 CNFI
0269 I                                      388 388 ACEI
0270 I                                      389 389 TLXI
0271 I                                      390 390 CBLI
0272 I                                    P 391 3930ORED
0273 I                                    P 394 3960LCD
0274 I                                      397 397 CHTP
0275 I                                    P 398 4000TNLU
     I                                      435 436 BOKC                  S01220
     I                                     15611578 OSDA                                      CGL029
     I                                     15791596 OMDA                                      CGL029
     I                                     17621765 CLAS                                      CLE042
     I                                     17661769 DFCL                                      CER020
     I                                     17701773 SLCL                                      CER020
     I                                    P177417760ISDT                                      CER020
     I                                    P177717790FMDT                                      CER020
     I                                     17801782 LOIC                                      CER020
0276 I*
0277 I                                        1 200 BRS1
0278 I**************************************201 400 BRS2                  S01270
0278 I**************************************201 434 BRS2            S01270S01220
0278 I**********                            201 436 BRS2                               S01220 CGL029
     I                                      2011632 BRS2                                      CGL029
0322 I**
0323 I**   CATCH ALL
0324 I**
0325 I        NS
0326 I                                        1   1 RECI
0279 I*
0280 I*    LOAN AMENDMENTS FILE - DETAIL RECORD.
0281 I*
0282 ILOAMS   NS  07   1 CD
0283 I                                        1   1 RECI
0284 I**********                              2   70LNRF                                      CLE148
     I                                        2   7 LNRF                                      CLE148
0285 I                                        8  120VDAT
0286 I                                       13  150LASN
0287 I                                       16  160MRIN
0288 I                                       17  18 LTYP
0289 I                                       19  20 SUTP
0290 I                                       21  220PTYP
0291 I                                       23  24 AMTP
0292 I                                       25  260PRSQ
0293 I                                       27  280BRTT
0294 I                                    P  29  347RTSP
0295 I                                       35  37 CCY
0296 I                                    P  38  440PRAM
0297 I                                    P  45  510INTA
0298 I                                    P  52  580WTXA
0299 I                                    P  59  650FEAM
0300 I                                    P  66  720TAMT
0301 I***********                            73  750BRCD                  S01117
0301 I                                       73  75 BRCA                  S01117
0302 I**********                             76  810CNUM                                      CSD027
0302 I                                       76  81 CNUM                                      CSD027
0303 I                                       82  820REPT
0304 I                                       83  83 AUTD
0305 I                                       84  84 STAT
0306 I                                       85  860SETP
0307 I**********                             87  98 OSAC                                      CGL029
     I                                       87  98 OSACQQ                                    CGL029
0308 I                                       99 108 TSEN
0309 I                                      109 118 FACO
0310 I                                      119 148 SPI1
0311 I                                      149 178 SPI2
0312 I                                      179 208 SPI3
0313 I                                      209 209 LAIN
0314 I                                      235 2370FTYP
0315 I                                      238 2390FSEQ
0316 I                                    P 314 3160LCD
0317 I                                      317 317 CHTP
0318 I                                    P 318 3200TNLU
     I                                     11771194 OSAC                                      CGL029
     I                                     12801283 CLAS                                      CLE042
0319 I*
0320 I                                        1 160 LOTL1
0321 I**********                            161 320 LOTL2                                     CGL029
     I                                      1611230 LOTL2                                     CGL029
0322 I**
0323 I**   CATCH ALL
0324 I**
0325 I        NS
0326 I                                        1   1 RECI
0327 I*
0328 I*    LOAN TRANSACTIONS INDEX FILE - HEADER RECORD.
0329 I*
0330 ILTRIX   NS       1 CH
0331 I                                        1   1 RECI
0332 I                                        2   2 RCDT
0333 I**********                              3   80LNRF                                      CLE148
     I                                        3   8 LNRF                                      CLE148
0334 I                                    P   9  110NORE
0335 I                                    P  12  140FLSZ
0336 I                                    P  15  170RRLC
0337 I                                    P  18  200RRNA
0338 I                                    P  21  230RRLX
0339 I                                    P  24  260RRXP
0340 I                                    P  27  290NLNR
0341 I                                    P  30  320NLAR
0342 I                                       33  330STPI
0343 I                                    P  38  400TNLU
0344 I                                        1  40 LOTLTR
0345 I*
0348 I/SPACE 3
0349 I* D A T A   S T R U C T U R E S
0350 I*
0377 I*
      **                                                                  S01194
     ISDCURR    E DSSDCURRPD                                              S01194
      **   CURRENCY                                                       S01194
     I              A6NBDP                          CDP                   S01194
     I              A6TXND                          TNOT                  S01194
     I              A6DLCI                          DCCY                  S01194
     I              A6SPRT                          SPOT                  S01194
     I              A6MDIN                          MDIN                  S01194
      **                                                                  S01194
     ISDBANK    E DSSDBANKPD                                              S01194
      ** BANK DETAILS                                                     S01194
     I              BJURPT                          TITL                  S01194
     I              BJCYCD                          BCCY                  S01194
     I              BJDNWD                          DNWD                  S01194
     ISDBRCH    E DSSDBRCHPD                                              S01117
      **  EXTERNAL DS FOR BRANCH CODE DETAILS                             S01117
     I              A8BRNM                          BRNM                  S01117
0351 I*     LOCAL DATA AREA
0352 ILDA        UDS                            256
0353 I***********                           134 138 DBFILE                S01117
0354 I***********                           139 167 DBKEY                 S01117
0355 I***********                           168 175 DBPGM                 S01117
0356 I***********                           176 177 DBASE                 S01117
0353 I                                      134 141 DBFILE                S01117
0354 I                                      142 170 DBKEY                 S01117
0355 I                                      171 180 DBPGM                 S01117
0356 I                                      181 1830DBASE                 S01117
0357 I*
0358 I**************                        134 177 DBINF                 S01194
     I                                      134 183 DBINF                 S01194
0359 I            DS
0360 I                                        1  14 KEY
0361 I**********                              1   60FCLN                                      CLE148
     I                                        1   6 FCLN                                      CLE148
0362 I                                        7  110VDAT
0363 I                                       12  140LASN
0364 I**S/TABLE*KEY*
0365 I**********  DS                                                      S01194
0366 I**********                              1  12 ZTABKY                S01194
0367 I**********                              9  11 CCY                   S01194
0368 I**********                             12  12 SUBTYP                S01194
     I*
     I/COPY ZSRSRC,ZTNLU1Z1                                               S01392
     I*                                                                   S01194
     IDSFDY     E DSDSFDY                                                 S01194
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01194
     I*                                                                   S01194
     IDSSDY     E DSDSSDY                                                 S01194
     I* SECOND DS FOR ACCESS PROGRAMS, LONG DATA STRUCTURE                S01194
     I*                                                                   S01194
     IRUNDT       DS                                                      S01117
      **  DATA AREA RUNDAT                                                S01117
     I                                        1   7 RUNA                  S01117
     I                                    P   8  100RUND                  S01117
     I                                       11  11 SSF                   S01117
     I                                       12  12 DATF                  S01117
     I                                       13  13 MBIN                  S01117
     I**                                                                  S01117
     I**   FILE INFORMATION DATA STRUCTURE - P1                           S01117
     I**                                                                  S01117
     ISPOOL       DS                                                      S01117
     I                                       83  92 SFILE                 S01117
     I                                    B 123 1240SFNUM                 S01117
     I**                                                                  S01117
     I**   FILE INFORMATION DATA STRUCTURE - AU                           S01117
     I**                                                                  S01117
     ISPOOLU      DS                                                      S01117
     I                                       83  92 SFILEU                S01117
     I                                    B 123 1240SFNUMU                S01117
     I**                                                                  S01117
0369 C* 1 S T   C Y C L E   P R O C E S S I N G
     C**                                                                  S01117
0370 C   40                GOTO START
     C                     MOVEACPY@      BIS@   80
     C**                                                                  S01117
     C**   IN THE DATAAREA RUNDAT                                         S01117
     C**                                                                  S01117
     C           *NAMVAR   DEFN RUNDAT    RUNDT                           S01117
     C                     IN   RUNDT                                     S01117
     C           *NAMVAR   DEFN           LDA                             S01194
     C           *LOCK     IN   LDA                                       S01194
     C**                                                                  S01117
     C*     IF MBIN=Y, SET ON *IN60                                       S01117
     C**                                                                  S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C                     SETON                     60                   S01117
     C                     END                                            S01117
0371 C**
0372 C**   CLEAR DATABASE ERROR FIELDS
0373 C                     MOVE ' '       BLANKS 44
0374 C                     MOVE BLANKS    DBINF
0375 C***********          SETON                     40OF                 S01117
0375 C                     SETON                     40                   S01117
0375 C                     SETOF                     70                   S01117
0376 C**
0377 C**   STORE PROGRAM NAME IN CASE OF D/B ERROR
0378 C                     MOVE 'LE1080'  DBPGM
0379 C*
0380 C                     Z-ADD0         ZERO5   50
     C                     Z-ADD0         TCOUNT  50
0381 C                     Z-ADD0         RECIN   50
     C                     Z-ADD0         PRNORE  50
0382 C                     EXSR ZSYSTM
0383 C***99*****           MOVE '01'      DBKEY            ***************S01194
     C   99                Z-ADD1         DBASE                           S01194
0384 C   99                MOVE 'SDBANKPD'DBFILE           ***   01    ***S01194
0385 C***99*****           MOVE ZTABKY    DBKEY            ***************S01194
0386 C   99                SETON                     U7U8LR
0387 C***99*****           GOTO END                                       S01194
0388 C**********           MOVE '1'       SUBTYP                          S01194
0389 C**********           MOVEL'20'      ZTABKY                          S01194
0390 C                     GOTO END
0391 C/SPACE 3
0392 C* M A I N   P R O C E S S I N G
0393 C           START     TAG                             ** START TAG **
0394 C                     SETOF                     444546
0395 C**
0396 C**   NOT DETAIL RECORD - GO TO END
0397 C  N01                GOTO END
     C*                                                                   S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C           *INL1     IFEQ '1'                                       S01117
     C                     SETON                     OF                   S01117
     C                     SETOF                     85                   S01117
     C                     CLOSELE1080P1                                  S01117
     C**                                                                  S01117
     C*       IF MBIN=YES, AND A LEVEL BREAK,                             S01117
     C*       OPEN LE1080P1                                               S01117
     C**                                                                  S01117
     C                     SETON                       69                 S01117
     C                     MOVE 'Y'       P1OP    1                       S01117
     C                     OPEN LE1080P1                                  S01117
     C                     Z-ADD0         PAGE                            S01117
     C**                                                                  S01117
     C*       ENSURE REPORT SPOOL FILE RECORDED BY RCF                    S01117
     C**                                                                  S01117
     C                     Z-ADDSFNUM     ZSNUM                           S01117
     C                     OUT  LDA                                       S01194
      *                                                                   S01117
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           SEQ     5                       S01117
     C                     PARM BRCA      SENTY   3                       S01117
     C                     PARM           SFILE                           S01117
     C                     PARM           ZSNUM   60                      S01117
     C                     PARM           ZSERR   1                       S01117
     C           *LOCK     IN   LDA                                       S01194
      *                                                                   S01117
     C           ZSERR     IFEQ 'Y'                                       S01117
      ** ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM        S01117
     C                     SETON                     U7U8LR               S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C**                                                                  S01117
     C** To get Branch Name(in BRNM) :                                    S01117
     C**                                                                  S01117
     C**********           CALL 'AOBRCHR0'                                             S01117 CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       S01117
     C                     PARM '*KEY   ' @OPTN   7                       S01117
     C                     PARM BRCA      @DSNB   3                       S01117
     C********** SDBRCH    PARM SDBRCH    DSFDY                                        S01117 CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANKS                                   S01117
     C                     MOVEL@DSNB     DBKEY            ***************S01117
     C                     MOVEL'SDBRCHPD'DBFILE           * DBERROR 04  *S01117
     C                     Z-ADD4         DBASE            ***************S01117
     C                     SETON                     U7U8LR               S01117
     C                     GOTO END                                       S01117
     C                     END                                            S01117
     C**                                                                  S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C**                                                                  S01117
     C                     ELSE                                           S01117
     C**                                                                  S01117
     C*       IF MBIN='N' AND FIRST CYCLE,                                S01117
     C*       OPEN 1080P1                                                 S01117
     C**                                                                  S01117
     C           P1OP      IFNE 'Y'                                       S01117
     C                     SETON                       OF69               S01117
     C                     MOVE 'Y'       P1OP    1                       S01117
     C                     OPEN LE1080P1                                  S01117
     C                     Z-ADD0         PAGE                            S01117
     C**                                                                  S01117
     C*       ENSURE REPORT SPOOL FILE RECORDED BY RCF                    S01117
     C**                                                                  S01117
     C                     Z-ADDSFNUM     ZSNUM                           S01117
     C                     OUT  LDA                                       S01194
      *                                                                   S01117
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           SEQ                             S01117
     C                     PARM *BLANKS   SENTY   3                       S01117
     C                     PARM           SFILE                           S01117
     C                     PARM           ZSNUM   60                      S01117
     C                     PARM           ZSERR   1                       S01117
     C           *LOCK     IN   LDA                                       S01194
      *                                                                   S01117
     C           ZSERR     IFEQ 'Y'                                       S01117
      ** ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM        S01117
     C                     SETON                     U7U8LR               S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
      *                                                                   S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C**                                                                  S01117
0398 C                     EXSR HASH
      *                                                                   CLE009
     C           RCDT      COMP 'F'                      55               CLE009
     C   55                GOTO END                                       CLE009
0399 C**
0400 C**   IF NOT LOAN AMENDMENT - BYPASS
0401 C           RCDT      COMP 'A'                      54
0402 C  N54                GOTO LGROUP
0403 C           KEY       CHAINLOAMS                42
0404 C  N42N07             SETON                     45
0405 C  N07                GOTO NPRESA
0406 C                     BITON'1'       LAIN
0407 C**
0408 C**   UPDATE LOAMS FILE
0409 C                     EXSR UPDATE
0410 C                     GOTO END
0411 C           NPRESA    TAG                              * NPRESA TAG**
0412 C                     EXSR UNMAT
0413 C                     GOTO END
0414 C*
0415 C           LGROUP    TAG                             ** LGROUP TAG**
0416 C**   IS THIS A NEW LOAN NUMBER
0417 C           FCLN      COMP LNRFST                   41
0418 C   41                GOTO OLDGRP
0419 C**********           MOVE FCLN      LNRFST  60                                          CLE148
     C                     MOVE FCLN      LNRFST  6                                           CLE148
0420 C                     MOVELFCLN      CLKEY   7
0421 C                     MOVE 'A'       CLKEY
0422 C           CLKEY     CHAINCLOAN                42
0423 C  N42N06             SETON                     46
0424 C                     SETOF                     43
0425 C   06                SETON                     43
0426 C           OLDGRP    TAG                             ** OLDGRP TAG**
0427 C**   RESET REC-ID FOR LOAN - NOT ACCESSED YET THIS CYCLE
0428 C   43                SETON                     06
0429 C**
0430 C  N43                EXSR UNMAT
0431 C   U7
0432 CORN43                GOTO END
0433 C**   'TLXI' CAN BE UPDATED AS THE CLOAN REC. IS NOT RELEASED UNTIL
0434 C**   ALL TRANSACTIONS FOR THAT LOAN HAVE BEEN PROCESSED
0435 C   21                BITON'0'       TLXI
0436 C**   IS IT THE LAST LOAN IN THE GROUP
0437 C           FCLN      COMP NXLNRF               4141
0438 C**   UPDATE IF NEXT REC. IS LOAN AMENDMENT
0439 C  N41      NXLASN    COMP 0                    41
0440 C**
0441 C**   UPDATE CLOAN FILE
0442 C   41                EXSR UPDATE
0443 C*
0444 C           END       TAG                             **  END TAG  **
0445 C* C O N T R O L S
0446 C** TRAILER READ.
     C   02                ADD  2         RECIN
     C   02                ADD  2         TCOUNT           NO OF HEADERS
     C*                                                    AND TRAILERS
0447 C   02                ADD  NORE      PRNORE
     C   02                EXSR TRAIL
     C*                                                                   CLE009
     C   03                EXSR HASH                                      CLE009
0451 C/SPACE 3
0452 C**
     CLR                   SUB  2         TCOUNT
     CLR         PRNORE    SUB  TCOUNT    PRNORE
     CLR         RECIN     SUB  TCOUNT    RECIN
0453 C**   UPDATE LTRIX FILE
     C**                                                                  S01117
0448 CLRNU7      PRNORE    COMP RECIN                U8U8
0449 CLRNU7NU8   HRWNT     COMP RRTOTI               U8U8
0450 CLRNU7NU8   HRDCT     COMP RRTOTD               U8U8
0454 CLRNU7NU8             EXSR UPDATE
0455 CLR         ENDLR     TAG                             ** ENDLR TAG **
     C**                                                                  S01117
     C*  LAST RECORD PROCESSING                                           S01117
     C*     ENSURE TOTALS SPOOL FILE RECORDED BY RCF                      S01117
     C**                                                                  S01117
     CLR                   Z-ADDSFNUMU    ZSNUMU                          S01117
     CLR                   OUT  LDA                                       S01194
      *                                                                   S01117
     CLR                   CALL 'ZSFILE'                                  S01117
     CLR                   PARM           SEQ                             S01117
     CLR                   PARM *BLANKS   SENTY   3                       S01117
     CLR                   PARM           SFILEU                          S01117
     CLR                   PARM           ZSNUMU  60                      S01117
     CLR                   PARM           ZSERR   1                       S01117
     CLR         *LOCK     IN   LDA                                       S01194
      *                                                                   S01117
     CLR         ZSERR     IFEQ 'Y'                                       S01117
      ** ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM        S01117
     CLR                   SETON                     U7U8                 S01117
     CLR                   RETRN                                          S01117
     CLR                   END                                            S01117
      *                                                                   S01117
     CLR U7 U8             EXSR *PSSR                                     S01117
     C*                                                                   S01117
     C**    WHEN LR INDICATOR SET ON WITHOUT EXECUTING THE FIRST          S01117
     C**    CYCLE                                                         S01117
     C*                                                                   S01117
     CLR         P1OP      IFNE 'Y'                                       S01117
     CLR                   EXSR #ZZ                                       S01117
     CLR                   END                                            S01117
0364 C*
0456 C********************************************************************
0457 C* S U B R O U T I N E S
0458 C*
0459 C********************************************************************
0460 C*    SUBROUTINE TO MAINTAIN HASH TOTALS
0461 C*
0462 C*    HASH IS CALLED BY - MAIN PROCESSING
0463 C*
0464 C*            CALLS - GLZADD
0465 C***********
0466 C           HASH      BEGSR                           ***  HASH  ***
0467 C           EAMT      DIV  1000      ZZAMT
0468 C***20*****           Z-SUBZZAMT     ZZAMT                                               219063
     C                     Z-ADDRRTOTI    ZZTOTI
     C                     Z-ADDRRTOTD    ZZTOTD
0469 C                     EXSR GLZADD
     C                     Z-ADDZZTOTI    RRTOTI 150
     C                     Z-ADDZZTOTD    RRTOTD  30
0470 C           RECIN     ADD  1         RECIN
0471 C                     ENDSR
0472 C********************************************************************
     C/SPACE 3
     C********************************************************************
     C*     SUBROUTINE TO ACCUMULATE HASH TOTALS FROM TRAILERS
     C*
     C*     TRAIL IS CALLED BY - MAIN PROCESSING
     C*
     C*              CALLS - GLZSUM
     C***********
     C           TRAIL     BEGSR                           ***  TRAIL  ***
     C                     Z-ADDHRWN      ZZAMTI
     C                     Z-ADDHRDC      ZZAMTD
     C                     Z-ADDHRWNT     ZZTOTI
     C                     Z-ADDHRDCT     ZZTOTD
     C                     EXSR GLZSUM
     C                     Z-ADDZZTOTI    HRWNT  150
     C                     Z-ADDZZTOTD    HRDCT   30
     C                     ENDSR
     C********************************************************************
0473 C/SPACE 3
0474 C********************************************************************
0475 C* SUBROUTINE TO ADD AN AMOUNT (ZZAMT) TO THE TOTAL (ZZTOTI,ZZTOTD)
0476 C*   IND '99' IS SET BY AN OVERFLOW ERROR
0477 C*
0478 CSR         GLZADD    BEGSR                           *** GLZADD ****
0479 C*
0480 CSR                   Z-ADDZZAMT     ZZAMT  153     91-DEFINE ZZAMT
0481 CSR 91                GOTO ZZAEND                     AMT = 0.BYPASS
0482 C*
0483 C* SPLIT ZZAMT INTO INTEGER AND DECIMAL FIELDS
0484 CSR                   Z-ADDZZAMT     ZZAMTI 150       INTEGER FIELD
0485 CSR                   MOVE ZZAMT     ZZAMTD  30       DECIMAL FIELD
0486 C* BOTH ZZAMTI AND ZZAMTD CONTAIN A 'SIGN' ZONE NOW
0487 C*
0488 CSR                   EXSR GLZSUM
0489 CSR         ZZAEND    ENDSR                           ** ZZAEND TAG *
0490 C*
0491 C********************************************************************
0492 C* SUBROUTINE TO CARRY OUT THE ADDITION FOR SUBROUTINES -
0493 C*                        GLZADD, GLZSUB, GLZCMP.
0494 C*          PARAMETERS PASSED -
0495 C*                     I/P ZZAMTI ZZAMTD
0496 C*                     O/P ZZTOTI ZZTOTD ZZNEGD IND 96 IND 99.
0497 C*
0498 CSR         GLZSUM    BEGSR                           *** GLZSUM ****
0499 C*
0500 CSR                   Z-ADDZZTOTI    ZZTOTI 150       DEFINE ZZTOTI
0501 CSR                   Z-ADDZZTOTD    ZZTOTD  30       DEFINE ZZTOTD
0502 CSR                   SETOF                     919293
0503 CSR                   SETOF                     949599
0504 C*
0505 C*    DETERMINE SIGN OF ZZAMTI & D,   92 IF NEG
0506 CSR         ZZAMTI    COMP 0                      9293
0507 CSR 93      ZZAMTD    COMP 0                      9293
0508 CSR 93                GOTO ZZSEND                     ZERO BYPASS
0509 C*
0510 C*    DETERMINE SIGN OF ZZTOTI & D, 91 IF NEG.
0511 CSR         ZZTOTI    COMP 0                      9193
0512 CSR 93      ZZTOTD    COMP 0                      9193
0513 C*
0514 C*    IF ZZTOTAL IS ZERO, RETURN ZZAMOUNT.
0515 CSR 93                Z-ADDZZAMTI    ZZTOTI
0516 CSR 93                Z-ADDZZAMTD    ZZTOTD
0517 CSR 93                GOTO ZZSEND                     ZERO BYPASS
0518 C*    IF SIGNS DIFFER BYPASS OVERFLOW CHECKS.
0519 CSR 91N92
0520 CORN91 92             GOTO ZZOFPS
0521 C*
0522 CSR         ZZAMTD    ADD  ZZTOTD    ZZWK2   40
0523 CSR         ZZWK2     COMP 999                  93    '93' = CARRY
0524 CSRN93      ZZWK2     COMP -999                   93    INTO INTEGER.
0525 C*
0526 CSR 93N92   ZZAMTI    ADD  1         ZZWK3  150       ADD 'CARRY' +VE
0527 CSR    93 92ZZAMTI    SUB  1         ZZWK3            SUB 'CARRY' -VE
0528 CSR 93      ZZTOTI    ADD  ZZWK3     ZZWK3
0529 CSRN93      ZZTOTI    ADD  ZZAMTI    ZZWK3
0530 C*
0531 C* IF THE MODULUS OF ZZWK3 IS LT MOD. ZZTOTI THEN O/F HAS OCCURED
0532 CSRN92      ZZWK3     COMP ZZTOTI                 99  -92 MEANS NOS.
0533 CSR 92      ZZWK3     COMP ZZTOTI               99     NEGATIVE
0534 CSRN99                Z-ADDZZWK2     ZZTOTD
0535 CSRN99                Z-ADDZZWK3     ZZTOTI
0536 C*
0537 C* IF O/F ZEROIZE ZZAMT , IND '99' SET AND ZZTOT FIELDS LEFT INTACT.
0538 CSR 99                Z-ADD0         ZZAMT  153
0539 CSR                   GOTO ZZSEND
0540 C*
0541 C* THE 'SIGNS' ARE DIFFERENT
0542 CSR         ZZOFPS    TAG                             ** ZZOFPS TAG**
0543 C* IF ZZAMT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZTOT
0544 C*
0545 CSR 92                Z-SUBZZAMTI    ZZAMTI 150
0546 CSR 92                Z-SUBZZAMTD    ZZAMTD  30
0547 C*
0548 C* IF ZZTOT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZAMT.
0549 C*
0550 CSR 91                Z-SUBZZTOTI    ZZTOTI
0551 CSR 91                Z-SUBZZTOTD    ZZTOTD
0552 C* BOTH ZZAMT AND ZZTOT ARE NOW POSITIVE.
0553 C*
0554 CSR         ZZTOTI    COMP ZZAMTI               93  95
0555 CSR 95      ZZTOTD    COMP ZZAMTD               93  95
0556 C*
0557 C* IF ZZTOT EQ. ZZAMT RETURN ZERO.
0558 CSR 95                Z-ADD0         ZZTOTI
0559 CSR 95                Z-ADD0         ZZTOTD
0560 CSR 95                GOTO ZZSEND
0561 C*
0562 C* IF ZZTOT GT. ZZAMT.
0563 CSR 93      ZZAMTD    COMP ZZTOTD               94
0564 CSR 93 94   ZZTOTI    SUB  1         ZZTOTI
0565 CSR 93 94   ZZTOTD    ADD  1000      ZZWK2
0566 CSR 93      ZZTOTI    SUB  ZZAMTI    ZZTOTI
0567 CSR 93 94   ZZWK2     SUB  ZZAMTD    ZZTOTD
0568 CSR 93N94   ZZTOTD    SUB  ZZAMTD    ZZTOTD
0570 C*
0571 C* IF ZZAMT GT. ZZTOT.
0572 CSRN93      ZZTOTD    COMP ZZAMTD               94
0573 CSRN93 94   ZZAMTI    SUB  1         ZZWK3  150
0574 CSRN93 94   ZZAMTD    ADD  1000      ZZWK2
0575 CSRN93 94   ZZWK3     SUB  ZZTOTI    ZZTOTI
0576 CSRN93N94   ZZAMTI    SUB  ZZTOTI    ZZTOTI
0577 CSRN93 94   ZZWK2     SUB  ZZTOTD    ZZTOTD
0578 CSRN93N94   ZZAMTD    SUB  ZZTOTD    ZZTOTD
0579 C*
0580 C* REVERSE SIGN OF ZZTOT IF LARGER I/P FIELDS WERE NEGATIVE
0581 CSR                   SETOF                     94
0582 CSR 93 91
0583 CORN93 92             SETON                     94
0584 CSR 94                Z-SUBZZTOTI    ZZTOTI
0585 CSR 94                Z-SUBZZTOTD    ZZTOTD
0586 C**
0587 C**   RESTORE SIGN OF ZZAMTI & ZZAMTD IF IT WAS REVERSED.
0588 CSR 92                Z-SUBZZAMTI    ZZAMTI
0589 CSR 92                Z-SUBZZAMTD    ZZAMTD
0590 CSR         ZZSEND    TAG                             ** ZZSEND TAG *
0591 C**
0592 C**   IF ZZTOTD IS ZERO, AND ZZTOTI IS NEG. SET UP ZZNEGD.
0593 CSR                   SETOF                     96
0594 CSR         ZZTOTD    COMP 0                        91
0595 CSR 91      ZZTOTI    COMP 0                      96
0596 CSR 96                MOVE '.000-'   ZZNEGD  5
0597 CSR                   ENDSR                             ** ENDSR **
0598 C********************************************************************
0599 C/SPACE 3
0600 C********************************************************************
0601 C**   UNMAT SR TO GET LOAN FIELDS TO PRINT 'ITEMS TO BE
0602 C**   INVESTIGATED' REPORT.
0603 C*
0604 C*    UNMAT IS CALLED BY - MAIN PROCESSING
0605 C*
0606 C*             CALLS - ZDATE2
0607 C***********
0608 C           UNMAT     BEGSR                           ***  UNMAT  ***
0609 C                     SETON                     4485                 S01117
     **                                                                   S01117
     C   69                SETOF                     6970                 S01117
0610 C* CONVERT VALUE DATE
0611 C                     Z-ADDVDAT      ZDAYNO
0612 C                     EXSR ZDATE2
0613 C* GET NO. DECIMAL PLACES
0614 C                     Z-ADD0         CDP
0615 C********** ZTABKY    CHAINTABLE                42
     C                     CALL 'AOCURRR0'                                S01194
     C                     PARM '*MSG   ' @RTCD                           S01194
     C                     PARM '*KEY   ' @OPTN                           S01194
     C                     PARM CCY       K101    3                    A  S01194
     C           SDCURR    PARM SDCURR    DSSDY                        B  S01194
     C           @RTCD     IFNE *BLANK                                    S01194
0768 C                     SETON                     U7U8LR               S01194
0768 C                     SETON                     42                   S01194
0766 C                     MOVE 'SDCURRPD'DBFILE                          S01194
0616 C                     Z-ADD2         DBASE            **** 02 ****** S01194
     C                     ELSE                                           S01194
      *
0616 C***42******          MOVE '02'      DBASE            ***************S01194
0617 C***42******          MOVE 'TABLE'   DBFILE           ***   02    ***S01194
0618 C***42******          MOVE ZTABKY    DBKEY            ***************S01194
0620 C***42******          GOTO UNMEND                                    S01194
      *
0621 C           CDP       COMP 1                    525051
0622 C   52      CDP       COMP 2                    53  52
     C                     END                                            S01194
      *
0623 C           UNMEND    ENDSR                           ** UNMEND TAG**
0624 C********************************************************************
0625 C/EJECT
0626 C********************************************************************
 627 C*    SUBROUTINE TO UPDATE FILES
0628 C*
0629 C*    UPDATE IS CALLED BY - MAIN PROCESSING
0630 C*
0631 C*              CALLS - EXCPT
0632 C***********
0633 C           UPDATE    BEGSR                           ***  UPDATE ***
0634 C**
0637 C**   IF S/CLOAN OR S/LOAMS RECORD ALREADY READ
0638 C**   BUT IF S/LTRIX GET RECORD
 156 C*  LOCK HDR BY READ & DUMMY UPDATE
2156 C***LR*****           EXSR HDRCHN                                                      AR322732
0640 C   42                MOVE '03'      DBASE            ***************
0641 C   42                MOVE 'LTRIX'   DBFILE           ***   03    ***
0642 C   42                MOVE '1'       DBKEY            ***************
0643 C   42                SETON                     U7U8LR
0644 C   42                GOTO ENDLOG
     C**
     C**  OBTAIN LAST TRANSACTION NUMBER  AND SET UP STANDARD OUTPUT
     C**  INFORMATION
      ** Suppress update of TNLU field as this is of no use, only                            BUG4488
      ** causes trigger of LTRIX to send blank 'LECONF' data                                 BUG4488
     C**********           EXSR ZTNLU1                                                       BUG4488
     C                     MOVE 'LE'      MDID    2
     C                     MOVEL'LE1080'  PGMN    8
     C                     TIME           MTIME   60
0693 C**   UPDATE CLOAN FILE
0694 C   06                SETON                     71
0695 C   06      1         ADD  UPLOAN    UPLOAN  50
0696 C**   UPDATE LOAN AMENDMENTS FILE
0697 C   07                SETON                     72
0698 C   07      1         ADD  UPLOAM    UPLOAM  50
0699 C**   UPDATE LTRIX FILE
0700 C   LR                SETON                     73
0701 C**********           EXSR EXCPT                                                       AR322732
0702 C                     SETOF                     717273
     C**   END COMMITMENT CYCLE
     C**
     C                     COMIT
     C**
0720 C           ENDLOG    ENDSR                           ** ENDLOG TAG**
0721 C*
0722 C********************************************************************
0723 C/SPACE 3
0724 C********************************************************************
0725 C*    SUBR. TO DO EXCEPTION TIME OUTPUT
0726 C*
0727 C*    EXCPT IS CALLED BY - UPDATE
0728 C***********
0729 C           EXCPT     BEGSR                           ***  EXCPT  ***
0730 C                     TIME           TIME    60
0731 C                     EXCPT
0732 C                     ENDSR
0733 C********************************************************************
0734 C/SPACE 3
0826 C********************************************************************
0827 C**
0828 C**   ZSYSTM SR. TO CHAIN TO THE INSTALLATION CONTROL DATA RECORD.
0829 C**
0830 C           ZSYSTM    BEGSR                           *** ZSYSTM ***
0831 C**
0832 C**   SET UP KEY FOR INSTALLATION CONTROL RECORD.
0833 C**********           MOVEL'01      'ZTABKY 12                       S01194
0834 C**********           MOVE '  10'    ZTABKY                          S01194
0835 C**********                                                          S01194
0836 C********** ZTABKY    CHAINTABLE                99    ON NOT THERE   S01194
0837 C**N99***** RECI      COMP 'D'                  9999  ON, IS DELETED S01194
0838 C**
     C                     CALL 'AOBANKR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDBANK    PARM SDBANK    DSFDY                           S01194
     C           @RTCD     IFNE *BLANK                                    S01194
0254 C                     SETON                     99                   S01194
     C                     END                                            S01194
0912 C*                                                                   S01194
0839 C**   CHECK SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.
0840 C***********DATF      COMP 'M'                      98MMDDYY, 98 ON  S01194
     C           BJDFIN    COMP 'M'                      98MMDDYY, 98 ON  S01194
0841 C**
0842 C                     ENDSR
0844 C**
 252 C*
 253 C*    ROUTINE TO ACCESS LTRIX RELATIVE FILE HEADER RECORD AND
 242 C*    DUMMY UPDATE/LOCK TO PREVENT EXTERNAL UPDATE.
 254 C*
3255 C           HDRCHN    BEGSR                           *** HDRCHN ***
 256 C*
3259 C********** 1         CHAINLTRIX                42                                     AR322732
3248 C  N42                EXCPTRECLCK
 245 C*
3247 C**N42***** 1         CHAINLTRIX                42                                     AR322732
     C                     READ LTRIX                    LR                                 AR322732
 260 C*
3261 C                     ENDSR
 262 C*
0339 C*****************************************************************   S01117
0825 C/SPACE 3                                                            S01117
0339 C*****************************************************************   S01117
     C*                                                                   S01117
     C* SUBROUTINE : #ZZ                                                  S01117
     C*                                                                   S01117
     C* CALLED BY MAIN PROCESSING DURING TOTAL TIME CALCULATIONS IF       S01117
     C* THE P1 FILES HAVE NOT ALREADY BEEN OPENED (IE, IF THERE ARE       S01117
     C* NO RECORDS READ AND THEREFORE FILES OPENING NOT PERFORMED)        S01117
     C*                                                                   S01117
     C           #ZZ       BEGSR                                          S01117
     C*                                                                   S01117
     C** OPEN P1 SPOOL FILE                                               S01117
     C*                                                                   S01117
     C                     OPEN LE1080P1                                  S01117
     C                     SETON                     70                   S01117
     C*                                                                   S01117
     C** ENSURE REPORT SPOOL FILE RECORDED BY RCF                         S01117
     C                     Z-ADDSFNUM     ZSNUM                           S01117
     C                     OUT  LDA                                       S01194
     C*                                                                   S01117
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           SEQ                             S01117
     C                     PARM *BLANKS   SENTY   3                       S01117
     C                     PARM           SFILE                           S01117
     C                     PARM           ZSNUM   60                      S01117
     C                     PARM           ZSERR   1                       S01117
     C           *LOCK     IN   LDA                                       S01194
      *                                                                   S01117
     C           ZSERR     IFEQ 'Y'                                       S01117
      ** ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM        S01117
     C                     SETON                     U7U8LR               S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C*   EXCEPT 'NO ITEMS TO BE INVESTIGATED' IN P1                      S01117
     C*                                                                   S01117
     C                     EXCPTNODTL                                     S01117
     C*                                                                   S01117
     C           #ZZ9      ENDSR                                          S01117
     C*                                                                   S01117
0340 C**                                                                  LE0930
     C********************************************************************S01117
0825 C/SPACE 3                                                            S01117
     C********************************************************************S01117
     C*                                                                   S01117
     C*  *PSSR --- SUBROUTINE TO HANDLE ABNORMAL ERROR CONDITIONS         S01117
     C*                                                                   S01117
     C*  CALLED FROM: AFTER ABNORMAL OPERATION OCCURS                     S01117
     C*                                                                   S01117
     C*  CALLS: NOTHING                                                   S01117
     C*                                                                   S01117
     C********************************************************************S01117
     C*                                                                   S01117
     C           *PSSR     BEGSR                           ** *PSSR **    S01117
     C*                                                                   S01117
     C           @RUN      IFEQ *BLANKS                                   S01117
     C                     MOVE 'Y'       @RUN    1                       S01117
     C                     DUMP                                           S01117
     C                     END                                            S01117
     C                     ENDSR                           ** *PSSR **    S01117
     C*                                                                   S01117
     C********************************************************************S01117
     C/COPY ZSRSRC,ZDATE2Z4                                               S01392
     C/COPY ZSRSRC,ZTNLU1Z2                                               S01392
     O*****************************************************************
0846 O* P R I N T O U T
0847 O*E1080P1H**203   OF                                       S01124    S01117
0847 OLE1080P1H  203   60 L1                                              S01117
0847 O       OR        OF 60NL1                                           S01117
     O       OR        OFN60                                              S01117
0848 O***********                        22 'REFERENCE LE1080'            S01117
0848 O                                   24 'REFERENCE LE1080P1'          S01117
0849 O                         TITL      89
0850 O                                  122 'DATE              PAGE'
0851 O                         RUNA     112
0852 O                         PAGE  Z  127
0853 O********H**1     OF                                                 S01117
0853 O        H  1     60 L1                                              S01117
0847 O       OR        OF 60NL1                                           S01117
     O       OR        OFN60                                              S01117
0854 O***********                        62 'UPDATE PAY/RECEIVE INDIC'    S01117
0855 O***********                        86 'ATORS - ITEMS TO BE INVE'    S01117
0856 O***********                        94 'STIGATED'                    S01117
0854 O                                   56 'UPDATE PAY/RECEIVE INDIC'    S01117
0855 O                                   80 'ATORS - ITEMS TO BE INVE'    S01117
0856 O                                   88 'STIGATED'                    S01117
     O                   N70 60          96 'BRANCH'                      S01117
     O                   N70 60BRCA     100                               S01117
     O                   N70 60         101 '-'                           S01117
     O                   N70 60BRNM     131                               S01117
0857 O********H**2     OF                                                 S01117
0857 O        H  2     60 L1                                              S01117
0847 O       OR        OF 60NL1                                           S01117
     O       OR        OFN60                                              S01117
0858 O***********                        62 '------------------------'    S01117
0859 O***********                        86 '------------------------'    S01117
0860 O***********                        94 '--------'                    S01117
0858 O                                   56 '------------------------'    S01117
0859 O                                   80 '------------------------'    S01117
0860 O                                   88 '--------'                    S01117
0861 O********H**1     OF                                                 S01117
0861 O        H  1     60 L1                                              S01117
0847 O       OR        OF 60NL1                                           S01117
     O       OR        OFN60                                              S01117
0862 O                                   17 'RECORD      LOAN'
0863 O                                   48 'START    SEQ    LOAN-TYP'
0864 O                                   60 'E     SETTLE'
0865 O********H**2     OF                                                 S01117
0865 O        H  2     60 L1                                              S01117
0847 O       OR        OF 60NL1                                           S01117
     O       OR        OFN60                                              S01117
0866 O                                   18 'TYPE      NUMBER'
0867 O                                   49 'DATE    NO.    /SUB-TYPE'
0868 O**********                         73 'TYPE     OUR AGENT'                              CGL029
0869 O**********                         97 'THEIR AGENT    CCY'                              CGL029
0870 O**********                        115 'AMOUNT'                                          CGL029
     O                                   59 'TYPE'                                            CGL029
     O                                   82 'OUR AGENT'                                       CGL029
     O                                  103 'THEIR AGENT    CCY'                              CGL029
     O                                  121 'AMOUNT'                                          CGL029
0871 O        DF 2     44
0872 O                   N54              6 'LOAN'
0873 O                    54              7 'AMEND'
0874 O                         FCLN      18
0875 O                         ZADATE    30
0876 O                         LASN      36
0877 O                         LTYP      44
0878 O                                   45 '-'
0879 O                         SUTP      47
     O                         CLAS      51                                                   CLE042
0880 O                         SETP      58
0881 O**********               OSAC      76                                                   CGL029
0882 O**********               TSEN      90                                                   CGL029
0883 O**********               CCY       97                                                   CGL029
0884 O**********          50   EAMT     118 ' ,   ,   ,   , 0 -'                              CGL029
0885 O**********          51   EAMT     118 '   ,   ,   , 0 . -'                              CGL029
0886 O**********          52   EAMT     118 '  ,   ,   , 0 .  -'                              CGL029
0887 O**********          53   EAMT     118 ' ,   ,   , 0 .   -'                              CGL029
     O                         OSAC      82                                                   CGL029
     O                         TSEN      96                                                   CGL029
     O                         CCY      103                                                   CGL029
     O                    50   EAMT     124 ' ,   ,   ,   , 0 -'                              CGL029
     O                    51   EAMT     124 '   ,   ,   , 0 . -'                              CGL029
     O                    52   EAMT     124 '  ,   ,   , 0 .  -'                              CGL029
     O                    53   EAMT     124 ' ,   ,   , 0 .   -'                              CGL029
0888 O*                                                                   S01117
0865 O        T 3      L1 69                                              S01117
0890 O                                   62 'THERE ARE NO ITEMS TO BE'    S01117
0891 O                                   75 'INVESTIGATED'                S01117
0888 O*                                                                   S01117
0888 O*                                                                   S01117
0847 O        E  203           NODTL                                      S01117
0848 O                                   24 'REFERENCE LE1080P1'          S01117
0849 O                         TITL      89                               S01117
0850 O                                  122 'DATE              PAGE'      S01117
0851 O                         RUNA     112                               S01117
0852 O                         PAGE  Z  127                               S01117
0853 O        E  1             NODTL                                      S01117
0854 O                                   56 'UPDATE PAY/RECEIVE INDIC'    S01117
0855 O                                   80 'ATORS - ITEMS TO BE INVE'    S01117
0856 O                                   88 'STIGATED'                    S01117
     O                   N70 60          96 'BRANCH'                      S01117
     O                   N70 60BRCA     100                               S01117
     O                   N70 60         101 '-'                           S01117
     O                   N70 60BRNM     131                               S01117
0857 O        E  1             NODTL                                      S01117
0858 O                                   56 '------------------------'    S01117
0859 O                                   80 '------------------------'    S01117
0860 O                                   88 '--------'                    S01117
0861 O        E  1             NODTL                                      S01117
0862 O                                   17 'RECORD      LOAN'            S01117
0863 O                                   48 'START    SEQ    LOAN-TYP'    S01117
0864 O                                   60 'E     SETTLE'                S01117
0865 O        E  2             NODTL                                      S01117
0866 O                                   18 'TYPE      NUMBER'            S01117
0867 O                                   49 'DATE    NO.    /SUB-TYPE'    S01117
0868 O**********                         73 'TYPE     OUR AGENT'                       S01117 CGL029
0869 O**********                         97 'THEIR AGENT    CCY'                       S01117 CGL029
0870 O**********                        115 'AMOUNT'                                   S01117 CGL029
     O                                   59 'TYPE'                                            CGL029
     O                                   82 'OUR AGENT'                                       CGL029
     O                                  103 'THEIR AGENT    CCY'                              CGL029
     O                                  121 'AMOUNT'                                          CGL029
0889 O********T*3      LRN85NU7                                           S01117
0865 O        E 3              NODTL                                      S01117
0890 O                                   62 'THERE ARE NO ITEMS TO BE'
0891 O                                   75 'INVESTIGATED'
0892 O        T 32     LR U7
0421 O                                   39 '*** REFERENCE'               S01117
0422 O                         DBPGM     51                               S01117
0893 O***********                        71 '- DATABASE ERROR AT'         S01117
0423 O                                   72 'DATABASE ERROR ***'          S01117
0894 O***********              DBASE     74                               S01117
0895 O********T**1     LR U7                                              S01117
0896 O***********                        37 'FILENAME'                    S01117
0897 O***********              DBFILE    43                               S01117
0898 O***********                        48 'KEY'                         S01117
0899 O***********              DBKEY     78                               S01117
     O        T 3      L1 60                                              S01117
     O                   N70             66 '*** END OF REPORT FOR'       S01117
     O                   N70             74 ' BRANCH '                    S01117
     O                   N70   BRCA      77                               S01117
     O                   N70             81 ' ***'                        S01117
     O                    70             76 '*** END OF REPORT ***'       S01117
     O        T 3      LRN60                                              S01117
     O                                   76 '*** END OF REPORT ***'       S01117
0900 O********T**203   LR                                                 S01117
0900 OLE1080AUT  203   LR                                                 S01117
0901 O***********                        22 'REFERENCE LE1080'            S01117
0901 O                                   24 'REFERENCE LE1080AU'          S01117
0902 O                         TITL      89
0903 O                                  122 'DATE              PAGE'
0904 O                         RUNA     112
0905 O***********              PAGE  Z  127                               S01117
0905 O                         PAGE1 Z  127                               S01117
0906 O        T  1     LR
0907 O                                   62 'UPDATE PAY/RECEIVE INDIC'
0908 O                                   86 'ATORS - FILE CONTROL REP'
0909 O                                   89 'ORT'
0910 O        T  3     LR
0911 O                                   62 '------------------------'
0912 O                                   86 '------------------------'
0913 O                                   89 '---'
0914 O        T  1     LR
0915 O                                   28 'S/PRTXS - RUN CONTROLS'
0916 O                                   59 'NUMBER'
0917 O                                   84 'VALUE'
0918 O        T  2     LR
0919 O                                   28 '----------------------'
0920 O                                   59 'OF RECORDS'
0921 O                                   84 'OF RECORDS'
0922 O        T  2     LR
0923 O                                   29 'TOTAL RECORDS ON FILE'
0924 O                         PRNORE3   59
0925 O                         HRWNT Z   81
0926 O**********               HRDCT     84                                                   219063
     O                         HRDCT L   85                                                   219063
0927 O        T  3     LR
0928 O                                   32 'TOTAL RECORDS ON FILE - '
0929 O                                   42 'CALCULATED'
0930 O                         RECIN 3   59
0931 O                         RRTOTIZ   81
0932 O**********               RRTOTD    84                                                   219063
     O                         RRTOTDL   85                                                   219063
     O                    U8NU7         111 '***   DIFFERENCE   ***'
0934 O        T  1     LR
0935 O                                   28 'S/CLOAN - RUN CONTROLS'
0936 O        T  2     LR
0937 O                                   28 '----------------------'
0938 O        T  3     LR
0939 O                                   29 'TOTAL RECORDS UPDATED'
0940 O                         UPLOAN3   59
0941 O        T  1     LR
0942 O                                   28 'S/LOAMS - RUN CONTROLS'
0943 O        T  2     LR
0944 O                                   28 '----------------------'
0945 O        T  3     LR
0946 O                                   29 'TOTAL RECORDS UPDATED'
0947 O                         UPLOAM3   59
0892 O        T 32     LR U7                                              S01117
0421 O                                   39 '*** REFERENCE'               S01117
0422 O                         DBPGM     51                               S01117
0423 O                                   71 'DATABASE ERROR AT'           S01117
0894 O                         DBASE     76                               S01117
0895 O        T  1     LR U7                                              S01117
0896 O                                   39 'FILENAME'                    S01117
0897 O                         DBFILE    48                               S01117
0898 O                                   52 'KEY'                         S01117
0899 O                         DBKEY     82                               S01117
0865 O        T 3      LR 70                                              S01117
0890 O                                   62 'THERE ARE NO ITEMS TO BE'    S01117
0891 O                                   75 'INVESTIGATED'                S01117
0948 O********T*00*    LR                                                 S01117
0949 O*************                      71 '*** END OF REPORT ***'       S01117
1034 O/SPACE 3
1035 O* S / C L O A N
1036 OCLOAN   E        71
1037 O                         TLXI     389
1038 O                         RUND     396P
1039 O***                               397 'A'                           E49673
1040 O                         NATN     400P
1041 O        D        46
1042 O/SPACE 3
1043 O* S / L O A M S
1044 OLOAMS   E        72
1045 O                         LAIN     209
1046 O                         RUND     316P
1047 O                                  317 'A'
1048 O                         NATN     320P
1049 O        D        45
1050 O/SPACE 3
1051 O* S / L T R I X
1052 OLTRIX   E        73
1053 O                         RRXP      23P
1054 O                         NATN      40P
 943 O*
 944 O*    DUMMY UPDATE FROM SUBRTN HDRCHN
4945 O        E                RECLCK
4942 O                         RECI
 943 O*
1055 O/SPACE 3
** CPY@   **      OBJECT COPYRIGHT
(c) Finastra International Limited 2001
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
