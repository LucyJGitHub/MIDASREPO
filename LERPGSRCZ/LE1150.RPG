     H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas LE Input cycle confirmations print')             *
/*OVRF*: OVRDBF FILE(CLOAN2) TOFILE(CLOAN) SHARE(*NO)               : *
     F*****************************************************************
     F*                                                               *
     F*  Midas - Customer Lending Module                              *
     F*                                                               *
     F*  LE1150 - Input Cycle Confirmations Print                     *
     F*                                                               *
     F*  Function:  This program is called if switchable feature      *
     F*    (I/C)    S01465 is switched ON.  It will print the customer*
     F*             confirmation details if entered.  It calculates   *
     F*             interest and running period dates based on the    *
     F*             loan repayment schedule if entered for the loan.  *
     F*             This program is based on LE0130.                  *
     F*                                                               *
     F*  Called by: LEC0212A - I/C Confirmations Print                *
     F*             LEC0212B - I/C Confirmations Reprint All          *
     F*             LEC0212C - I/C Confirmations Reprint Request      *
     F*             LEC0401  - I/C Term Confirmations Print           *
     F*                                                               *
      *  (c) Finastra International Limited 2001                      *
      *                                                               *
      *  Last Amend No. LUC136             Date 10Feb20               *  
      *  Prev Amend No. CLE172             Date 01Oct20               *
      *                 CSD103             Date 10Aug20               *
      *                 MD056750           Date 04Nov20               *
      *                 AR847806           Date 12Jan15               *
      *                 262869             Date 13Jan16               *
      *                 AR826418           Date 30Aug13               *
      *                 CER050             Date 16Jun19               *
      *                 AR997089           Date 24Jan19               *
      *                 252771A            Date 04Sep19               *
      *                 252771             Date 04Sep19               *
      *                 MD053295           Date 13Apr19               *
      *                 CLE071             Date 18Jul18               *
      *                 MD046248           Date 27Oct17               *
      *                 MD047993           Date 23Sep17               *
      *                 MD035545           Date 11Sep15               *
      *                 CLE141             Date 08Feb16               *
      *                 AR833482           Date 09Mar15               *
      *                 AR996895           Date 25Nov12               *
      *                 CLE134             Date 01Aug12               *
      *                 AR650589           Date 23Jul12               *
      *                 AR322732           Date 23Jul12               *
      *                 CLE148             Date 23Jul12               *
      *                 CRE073             Date 06Dec10               *
      *                 CLE143             Date 06Dec10               *
      *                 CLE064             Date 06Dec10               *
      *                 263666             Date 01Feb10               *
      *                 CER059             Date 19Jul10               *
      *                 CER016A            Date 19May08               *
      *                 CER020             Date 19May08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      *                 BUG22218           Date 23Jan09               *
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *                 CPK028             Date 24Jan08               *
      *                 246141             Date 26Mar07               *
      *                 245082             Date 30Jan07               *
      *                 164847             Date 30Nov06               *
      *                 CRE026             Date 19Feb07               *
      *                 BUG12990           Date 05Jan07               *
      *                 BUG12997           Date 22Dec06               *
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 242286             Date 25Sep06               *
      *                 240062             Date 08Jun06               *
      *                 CSD031             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 CLE042             Date 06Sep05               *
      *                 CLE036             Date 22Sep03               *
      *                 CAS009             Date 16May05               *
      *                 CSW037A            Date 02May05               *
      *                 CIR013             Date 25Apr05               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 BUG4488            Date 18Oct04               *
      *                 CLE025             Date 20Oct03               *
      *                 CGL029             Date 01Sep03               *
      *                 222373             Date 28Oct03               *
      *                 CAP074             Date 16Sep03               *
      *                 218782             Date 25Jun03               *
      *                 CLE033             Date 02Apr03               *
      *                 CLE031             Date 03Feb03               *
      *                 CAS005             Date 16Dec02               *
      *                 219242             Date 01Jul03               *
      *                 219241             Date 01Jul03               *
      *                 CLE028             Date 27Jun02               *
      *                 CAS004             Date 26Jun02               *
      * Midas Release 4.01.03 ----------------------------------------*
      *                 207469             Date 09Jan03               *
      * Midas Release 4.01.02 ----------------------------------------*
      *                 209887             Date 26Sep02               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.05 -----------------------------------------------*
      *                 CSD006             Date 15May01               *
      *                 CLE011             Date 07Nov00               *
      * Midas DBA 3.03 -----------------------------------------------*
      *                 CIR004             Date 20Jan00               *
      * Midas DBA 3.02 -----------------------------------------------*
      *                 150995             Date 08Oct99
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 159259             Date 09Jun99               *
      *                 148729             Date 04Mar99               *
      *                 138866             Date 04Mar99               *
      *                 144915             Date 28Oct98               *
      *                 CEU004             Date 02Feb98               *
      *                 128142             Date 05Jun98               *
     F*                 133683             Date 03Jun96               *
     F*                 121768             DATE 19FEB98               *
     F*                 110911             DATE 03FEB98               *
     F*                 110641             DATE 03FEB98               *
     F*                 126453             DATE 01DEC97               *
     F*                 126017             DATE 18NOV97               *
     F*                 CLE005             Date 22May97               *
     F*                 CLE004             Date 02Dec96               *
     F*                 097885             Date 31Jan97               *
     F*                 100663             DATE 11MAR96               *
     F*                 S01408             DATE 07MAR96               *
     F*                 095244             DATE 01NOV95               *
     F*                 095238             DATE 31OCT95               *
     F*                 088913             DATE 22JUN95               *
     F*                 088809             DATE 22JUN95               *
     F*                 S01518             DATE 03OCT94               *
     F*                 070515             DATE 10MAY94               *
     F*                 S01465 *CREATE     DATE 22MAR94               *
     F*                                                               *
     F*---------------------------------------------------------------*
      *                                                               *
      *  LUC136 - Loan Confirmation Address Change                    *
      *           Hooks used: LE1150CCP1, LE1150O001, LE1150O002,     *
      *                       LE1150O003                              * 
      *  CLE172 - LIBOR Deregulation - Lending (Recompile)            *
      *  CSD103 - LIBOR Deregulation - Common Layer/Standing Data     *
      *  MD056750 - Customer Lending Input Cycle/Reprint All          *
      *             Confirmations did not generate reprints           *
      *           - use the CFPF Conf Process Flag to reprint the Conf*
      *  AR847806 - Missing maturity date on guarantee confirmation.  *
      *             Show TDATE properly for loans other than PTYP 61, *
      *             62, 64 and 66.                                    *
      *           - Applied for MD31071.                              *
      *  262869 - Confirmation shows Amendment for newly inserted     *
      *           loan. Codes were added to ensure that confirmation  *
      *           will not be printed as "Amendment" for newly        *
      *           inserted loan amended in WIP.                       *
      *         - Applied for MD-31947                                *
      *  AR826418 - Loan confirmation is up to next repayment date.   *
      *             Move the non-zero lowest date to ZIEND for        *
      *             correct interest calculation.                     *
      *           - Applied for MD-13549                              *
      *  CER050 - Annualised Percentage Rate (Recompile)              *
      *  AR997089 - Added changes on alignment. Applied for MD034449  *
      *           - Applied for MD052515                              *
      *  252771A - Align customer address to the left if customer 1   *
      *            customer 2 are the same.                           *
      *          - Applied fix for MD054047.                          *
      *  252771 - Align name to the left and if customer 1 and        *
      *           customer 2 are the same, print only one.  Partially *
      *         - Applied fix for MD054047.                           *
      *  MD053295 - Lending loan with Interest Calculation Basis      *
      *             method 3 (30/360) has wrong interest payment      *
      *             amount for month of March (Recompile)             *
      *  CLE071 - Value Dating of Rate Changes to Fees (Recompile)    *
      *  MD046248 - Finastra Rebranding                               *
      *  MD047993 - Modified MD035545. Removed dependency on Accrue   *
      *             on Last Day indicator.                            *
      *  MD035545 - LE: Interest Calculation in Leap year. Consider   *
      *             Accrue on Last Day Indicator for method 6.        *
      *  CLE141 - Currency and Location Business Day Convention       *
      *           (Recompile)                                         *
      *  AR833482 - Amended program to ensure that negative sign for  *
      *             calculated interest is properly shown in LE1150P1 *
      *             when base rate used is negative. (Child: AR833483)*
      *           - Applied for MD033488                              *
      *  AR996895 - Incorrect acrrual interest calculation            *
      *             (Child: AR996897) (Recompile)                     *
      *  CLE134 - Past Due Call Loan Processing                       *
      *  AR650589 - LEC0212A in MSGW due to LTRIX is in use by another*
      *             job. Trap record in use status so as not to halt  *
      *             program execution. (Child: AR651039)              *
      *  AR322732 - LEC0212A and APISERVER locks LTRIX file.          *
      *           - Prevent LTRIX RRN 1 from being locked.            *
      *  CLE148 - Alpha Loan Reference                                *
      *  CRE073 - Interest Rate Rounding (Recompile)                  *
      *  CLE143 - Original Loan Contract Date & Effective Interest    *
      *           Rate (Recompile)                                    *
      *  CLE064 - Enhancement of Lending Frequencies                  *
      *  263666 - Recompiled due to changes in ZINTDYZ2               *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  CER016A - German Interest Calculation: Upgarde of FGE059     *
      *            to Midas Plus (Recompile)                          *
      *  CER020 - Enhanced Rollover Window: Upgrade FGE089 to         *
      *           Midas Plus                                          *
      *  BUG22218 - Applied fix 255752                                *
      *  255752   - Missing loan confirmations. If UDC is present,    *
      *             only print confirmations with CNPR = 'S' (set by  *
      *             CG6000)                                           *
      *  CPK028 - Customer numbers should be alphanumeric.            *
      *  246141 - Recompiled due to changes in ZINTDYZ2               *
      *  245082 - Loans with first and last day accrual should be     *
      *           treated as first day accruals until maturity        *
      *           date.  Then add one day on the maturity date.       *
      *           Applied fix 235784 from Release 4.                  *
      *  164847 - Recompile over changes in /COPY ZINTDYZ2.           *
      *  CRE026 - Consumer Banking                                    *
      *  BUG12990 - Recompiled due to changes in ZINTDYZ2/ZINTDYZ2LE  *
      *  BUG12997 - Adjust details in P1 report to fit the standard   *
      *             confirmation report page size                     *
      *  242286 - Recompile over changes in /COPY ZINTDYZ2.           *
      *  240062 - Print "CALL" under column "TO" of LE1150P1          *
      *           for call loans and maturity date equals zero.       *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CLE042 - Extended Loan Sub Type                              *
      *  CLE036 - LE Enh for Nordea Phase 1 Pty 2 - Specific Base Rate*
      *  CAS009 - EIR/AC Accounting (Recompile)                       *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  CIR013 - Additional Calculation Method for FRA/IRS/CCF       *
      *           Recompile over GLINTC and ZINTDY.                   *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  BUG4488- Loop in APCONFS when an LECONF is sent to data queue*
      *  CLE025 - Credit Lines (Recompile)                            *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  222373 - Parameter Mismatch                                  *
      *  CAP074 - Lending API enhancements - Loans input.             *
      *  218782 - Check system value Settlement09Postings to decide   *
      *           whether to use Settlement or Transaction Ccy.       *
      *  CLE033 - Settlement method 09                                *
      *  CLE031 - Lending Enhancements.                               *
      *  CAS005 - Enhancements to CAS001, CAS002 and CAS004           *
      *           (Recompile)                                         *
      *  219242 - Not possible to create MT103+ payment msg from      *
      *           non-FT transaction (Recompile)                      *
      *  219241 - Defaulting of "Details of Charges" assign a         *
      *           system value (Recompile)                            *
      *  CLE028 - Flat Rate Personal Loans (Rule of 78s)              *
      *  CAS004 - Hedge Accounting Phase A                            *
      *  207469 - Condition confirmation generation with ENFFCR and   *
      *           with the confirmation's network.                    *
      *  209887 - Lending confirmations not produced. Produce confs   *
      *           for loans inserted and amended on the same day, and *
      *           always on authorisation of the loan.                *
      *  CSD006 - Use long DS with SDBSRTPD.                          *
      *  CLE011 - Rate Fixing Days for Lending Rollover Processing    *
      *           Recompile                                           *
      *  CIR004 - Dealing Calculation Method Change.                  *
      *         - Recompiled due to GLINTC and ZINTDY changes         *
     F*  150995 - Interest amount and total interest amount gets the  *
     F*           value of the previous loan when repay types 1 or 3. *
      *  159259 - Confirmations are to be printed even with zero      *
      *           principal                                           *
     F*  148729 - Confirmations not produced when loan is entered     *
     F*           via Loan Manager. Remove use of 'manual/system      *
     F*           generated' flag.                                    *
      *  138866 - Confirmation from principal transfer loan should    *
      *           have amounts of principal and interest.             *
      *  144915 - Recompiled due to changes in LF/CLOAN.              *
      *  CEU004 - LE Settlement Ccy Conversion Upgrade to DBA R2.0    *
      *  128142 - Counterparty nostro town is not printed and is not  *
     F*           on the swift if 'Account with Bank' is a            *
     F*           Counterparty Nostro.                                *
      *  133683 - Addition of missing SWIFT 1996 changes.             *
     F*  121768 - Recompile over changed GLINTCZ1                     *
     F*  110911 - Output 'For A/c of' correctly on confirmation.      *
     F*  110641 - Prevent first line of Special Instructions from     *
     F*           being output twice. (caused by error in 088913).    *
     F*  126453 - When "to" date is roll date, not maturity date,
     F*           narrrative s/b "at rollover", not "at maturity"
     F*  126017 - Correction to interest calculation for calculation  *
     F*           basis 6 in SR/GLINTC. Add SR/ZDAT10                 *
     F*  CLE005 - Customer Lending Enhancements - Others (T3)         *
     F*  CLE004 - Customer Lending Enhancements - Syndications.       *
     F*  097885 - Recompiled for wrong calculation of number of day   *
     F*           interest (ZINTDYZ2).                                *
     F*  100663 - Unable to change form length of spool file output   *
     F*           by changing printer file - remove Line specs.       *
     F*  S01408 - Addition of core hook LE1150FFP1                    *
     F*         - Addition of core hook LE1150IIP1                    *
     F*         - Addition of core hook LE1150IIP2                    *
     F*         - Addition of core hook LE1150OOP1                    *
     F*         - Addition of core hook LE1150OOP2                    *
     F*         - Addition of core hook LE1150CCP1                    *
     F*         - Addition of core hook LE1150CCP2                    *
     F*         - Addition of core hook LE1150CCP3                    *
     F*         - Addition of core hook LE1150CCP4                    *
     F*         - Addition of core hook LE1150CCP5                    *
     F*         - Addition of core hook LE1150CCP6                    *
     F*  095244 - Recompiled for Calculation method 3                 *
     F*  095238 - Recompiled for Calculation method 3                 *
     F*  088913 - Special Instructions mis-aligned and not all of the *
     F*           instructions are included in the 3 line text.       *
     F*  088809 - 'PAYMENT TO' on confirmation is wrong.  S01518      *
     F*           has mistakenly copied some criteria processing from *
     F*           DL conf. which is not applicable for this pgm.      *
     F*  S01518 - BLI Lending Swift Enhancement.                      *
     F*  070515 - Guarantees Issued.  Print receiver of the guarantee *
     F*           if guarantees issued is active in lending ICD       *
     F*  S01465 - BLI Lending Enhancements                            *
     F*                                                               *
     F*****************************************************************
     F*                                                               *
     F*  C R E A T I O N     P A R A M E T E R S                      *
     F*                                                               *
     F*                                                               *
     F*****************************************************************
     F*
     F***LTRIX***UF  F      40            DISK                           U1                 AR322732
     FLTRIX   UF  F      45            DISK                           U1                    AR322732
     F                                              KCOMIT
     F                                              KINFDS SLTRX                            AR650589
     F*SLTIX***IF  F      40  1AI     1 DISK                           U2                   AR322732
     FSLTIX   IF  F      45  1AI     1 DISK                           U2                    AR322732
     FLELOANL4IF  E           K        DISK                                                   262869
     F***CLOAN***UF  F     458  7AI     2 DISK                            S01518
     F***CLOAN   UF  F    1087  7AI     2 DISK                     S01518 CLE004
     F***CLOAN***UF  F    1284  7AI     2 DISK                     CLE004 CEU004
     F*CLOAN***UF**F    1290  7AI     2 DISK                       CEU004 CLE011
     F*CLOAN***UF**F    1310  7AI     2 DISK                                           CLE011 CLE028
     F*CLOAN***UF**F    1375  7AI     2 DISK                                           CLE028 CAS004
     F***CLOAN***UF  F    1389  7AI     2 DISK                                         CAS004 CLE031
     F***CLOAN***UF  F    1560  7AI     2 DISK                                         CLE031 CGL029
     F***CLOAN** UF  F    1632  7AI     2 DISK                                         CGL029 CLE036
     F*CLOAN***UF**F****1644  7AI     2 DISK                                           CLE036 CLE042
     F***CLOAN** UF  F    1773  7AI     2 DISK                                         CLE042 CER020
     F***CLOAN** UF  F    1773  7AI     2 DISK                                         CLE042 CLE134
     FCLOAN   UF  F    1874  7AI     2 DISK                                                   CLE134
     F                                              KCOMIT
     F***CLOAN2**IF  F     458  7AI     2 DISK                            S01518
     F***CLOAN2  IF  F    1087  7AI     2 DISK                     S01518 CLE004
     F***CLOAN2**IF  F    1284  7AI     2 DISK                     CLE004 CEU004
     F*CLOAN2**IF**F    1290  7AI     2 DISK                       CEU004 CLE011
     F*CLOAN2**IF**F    1310  7AI     2 DISK                                           CLE011 CLE028
     F*CLOAN2**IF**F    1375  7AI     2 DISK                                           CLE028 CAS004
     F***CLOAN2**IF  F    1389  7AI     2 DISK                                         CAS004 CLE031
     F***CLOAN2**UF  F    1560  7AI     2 DISK                                         CLE031 CGL029
     F***CLOAN2**IF  F    1632  7AI     2 DISK                                         CGL029 CLE036
     F*CLOAN2**IF**F****1644  7AI     2 DISK                                           CLE036 CLE042
     F***CLOAN2* IF  F    1773  7AI     2 DISK                                         CLE042 CLE134
     FCLOAN2  IF  F    1874  7AI     2 DISK                                                   CLE134
     F***LOAMS   IF  F     320 14AI     2 DISK                            S01518
     F***LOAMS***IF  F     949 14AI     2 DISK                     S01518 CEU004
     F***LOAMS***IF  F    1066 14AI     2 DISK                                         CEU004 CLE031
     F***LOAMS***IF  F    1176 14AI     2 DISK                                         CLE031 CGL029
     F***LOAMS** IF  F    1230 14AI     2 DISK                                         CGL029 CLE036
     F*LOAMS***IF**F****1268 14AI     2 DISK                                           CLE036 CLE042
     FLOAMS   IF  F    1291 14AI     2 DISK                                                   CLE036
     F*                                                                   S01408
     F/COPY WNCPYSRC,LE1150FFP1                                           S01408
     F*                                                                   S01408
     FLEEXTAA O   F      40            DISK                           U4
     FLEEXTAB O   F      40            DISK                           U4
     FLEEXTAC O   F      40            DISK                           U4
     F*E1150P1O***F     132           LPRINTER      KINFDS SPOOL      UC  100663
     FLE1150P1O   F     132            PRINTER      KINFDS SPOOL      UC  100663
     FLE1150AUO   F     132            PRINTER      KINFDS SPOOLU     UC
     F*
      /TITLE FUNCTION OF INDICATORS
     F*****************************************************************
     F*                                                               *
     F*     F U N C T I O N   O F   I N D I C A T O R S               *
     F*                                                               *
     F*   01  -  LTRIX/SLTIX Header                                   *
     F*   02  -              Detail                                   *
     F*   03  -  CLOAN File Detail                                    *
     F*   04  -  Decimal places for 1st set ccy = 0                   *                       CLE031
     F*   05  -  Guarantees Issued ind. in lending ICD is active      *   070515
     F*   06  -  Print receiver of the guarantee                      *   070515
     F*   09  -  Decimal places for 1st set ccy = 1                   *                       CLE031
     F*   10  -  Decimal places for 1st set ccy = 2                   *                       CLE031
     F*   11  -  MBIN = 'Y'                                           *
     F****12**-* Input File has at Least One Detail Record            *                       CLE031
     F*   12  -  Decimal places for 1st set ccy = 3                   *                       CLE031
     F****13**-* Suppress the Control Total for Output                *                       CLE031
     F*   13  -  Decimal places for 2nd set ccy = 0                   *                       CLE031
     F*   14  -  Decimal places for 2nd set ccy = 1                   *                       CLE031
     F*   15  -  Decimal places for 2nd set ccy = 2                   *                       CLE031
     F*   16  -  Branch Name to be Printed on Confirmations           *
     F*   17  -  Narrative from SDNOSTPD Rel. to be Printed           *
     F*   18  -  Print Name and Report Town - Not Oourselves          *
     F*   19  -  First Cycle                                          *
     F*   20  -  Repayment Day No. Non-zero  - CLOAN                  *
     F*   21  -  Interest Freq.Day No. Non-zero  - CLOAN              *
     F*   21  -  If 1st set of sett detls is to be printed            *                       CLE031
     F*   22  -  PTYP 61,62 or 64                                     *
     F*   23  -  For Account of Blank - CLOAN                         *
     F*   24  -  Special Instructions Blank - CLOAN 'B'               *
     F*   25  -  Output Beneficiary Bank Details                      *
     F*   26  -  Decimal places for 2nd set ccy = 3                   *                       CLE031
     F*   27  -  Stop Confirmation Indicator ON                       *
     F*   28  -  Interest Payment Freq. Blank - CLOAN                 *
     F*   29  -  Next Interest Date Zero  - CLOAN                     *
     F*   30  -  Next Repayment Date Non-zero - CLOAN                 *
     F*   31  -  Repayment Freq. Blank - CLOAN                        *
     F*   32  -  Processing Type of CLOAN = 61                        *
     F*   33  -                           = 62                        *
     F*   34  -                           = 63                        *
     F*   35  -                           = 64                        *
     F*   36  -                           = 65                        *
     F*   37  -                           = 66                        *
     F*   38  -                           = 67                        *
     F*   39  -                           = 70                        *
     F*   40  -  Decimal Places for CCY =0                            *
     F*   41  -                         =1                            *
     F*   42  -                         =2                            *
     F*   43  -                         =3                            *
     F*   44  -  PTYP 63,65 or 67                                     *
     F*   45  -       61,62,64 or 66                                  *
     F*   46  -  45 ON and Repayment Type 1                           *
     F*   47  -  Repayment Type 2                                     *
     F*   48  -  45 ON and Repayment Type 3                           *
     F*   49  -  Pay is Receive and Vice-versa                        *
     F*   50  -  Settlement Type 00                                   *
     F*   51  -                  01,07, or 08                         *
     F*   52  -                  02                                   *
     F*   53  -                  03 or 06                             *
     F*   54  -                  04                                   *
     F*   55  -                  05                                   *
     F*   56  -                  12                                   *
     F*   57  -                  14                                   *
     F*   58  -  Only Access CLOAN File 'A' Record                    *
     F*   59  -  Saves Indicator Info. Through CONF Subr              *
     F*   60  -  Work                                                 *
     F*   61  -  Work                                                 *
     F*   62  -  Alternate N+A not Found - Default to B               *
     F*   63  -  Confirmation is a Copy                               *
     F*   64  -                    Cancellation                       *
     F*   65  -                    Amendment                          *
     F*   66  -  Print Successful                                     *
     F*   67  -  No Nostro Code Present for Sett.Types 01,07,08       *
     F*   68  -  Do Not Update CLOAN Record                           *
     F*   69  -  Print Confirmation                                   *
     F*   70  -  If 2nd set of sett detls is to be printed            *                       218782
     F*   71  -  Multibranching Output Indicator                      *
     F*   72  -  CLOAN Update                                         *
     F*   73  -  Update LTRIX                                         *
     F*   75  -  Release LTRIX File                                   *
     F****76**-**If*2nd*set*of*sett*detls*is*to*be*printed*************                CLE031 218782
     F*   77  -  Release CLOAN File                                   *
     F*   78  -  Work Indicator                                       *
     F*   79  -  Rollover LTRIX Record                                *
     F*   81  -  ON If LEEXT Record is to be produced                 *
     F*   82  -  Allows Output of one LEEXT Header                    *
     F*   83  -  Zero Maturity Date                                   *
     F*   85  -  Telex Number for Telex Customer                      *
     F*   88  -  Amendment Type = 'RE'                                *
     F*   89  -  Rollover Date Non-Zero - CLOAN                       *
     F*   96  -  "DO NOT SEND" Text                                   *
     F*   U1  -  Mode 1 - After CLOAN Input,or Reprint One            *
     F*   U2  -  Mode 2 - Reprint All                                 *
     F*   U3  -  Mode 3 - Input Cycle Termination                     *
     F*   U4  -  Mode 1 - Normal Printing & Output to LEEXT           *
     F*                                                               *
     F*****************************************************************
      /EJECT
      /TITLE SUBROUTINE INDEX
     F*****************************************************************
     F*                                                               *
     F*  S U B R O U T I N E   I N D E X                              *
     F*                                                               *
     F*  MBRT    - Test multibranch output                            *
     F*  CONF    - Print confirmations                                *
     F*  QNOSTR  - Get OUR nostro details                             *
     F*  CPNOS   - Get THEIR nostro and FOR A/C OF details            *
     F*  SETTYP  - Get indicators for settlement type                 *
     F*  MOVEA   - Insert words in narrative at variable position     *
     F*            and keep count of next positions                   *
     F*  INFOSR  - Store information about processing and repayment   *
     F*            type for CLOAN records                             *
     F*  INTCAL  - Calculate interest and total amounts for SP        *
     F*  UPDATE  - Update LTRIX and CLOAN files                       *
     F*  HDRCHN  - Access LTRIX relative file header record and dummy *
     F*            update/lock to prevent external update             *
     F*  LTRCHN  - Chain to LTRIX file                                *
     F*  CLCHN   - Chain to CLOAN file                                *
     F*  LOCHN   - Chain to LF/LOAMS                                  *
      *  SRLOAM  - Chain to LF/LOAMS                                  *   138866
     F*  EXCPT   - Handle exception time output                       *
     F*  TIME    - Obtain time                                        *
     F*  GETBR   - Added for 150987 JSM08.  It accesses the correct   *
     F*            base rate of the rollover discount loan.           *
     F*  ROUT    - Determine message routing                          *
     F*  NWAD    - Determine default network addresses                *
     F*  PRAD    - Determine priority network addresses               *
     F*  TXROUT  - Attempt priority routing to STTX/Telex, if not     *
     F*            already routed                                     *
     F*  SWROUT  - Attempt priority routing to SWIFT if not already   *
     F*            routed                                             *
     F*  ZSYSTM  - Chain to the installation control data record      *
     F*  *PSSR   - Handle abnormal error conditions                   *
     F*  ZDATE2  - Convert a day number to date formats               *
     F*  ZFLAC   - Calculate end date                                 *
     F*  GLINTC  - Calculate interest between any 2 day numbers       *
     F*  ZTNLU1  - Lock the transaction number data area.  Access     *
     F*            the next available transaction number, then update *
     F*            and release the data area                          *
     F*                                                               *
     F*****************************************************************
      /EJECT
     E*****************************************************************
     E***********         TABTYP  1   8  2 0 TABNO   5   Loan Types & Key CLE005
     E**********          TABTYP  1  13  2 0 TABNO   5   LOAN TYPES & KEY              CLE005 CLE028
     E                    TABTYP  1  14  2 0 TABNO   5   LOAN TYPES & KEY                     CLE028
     E                    NAME    1   3 28   START   2   Confirmn. Names
     E                    TITL12  1   2 68               OUR Nostro Consts
     E                    TITL5   1   1 35                                                    CLE031
     E                    NAME12  1   3 50               In Title & Name
     E                    NAME34  1   1 50               THEIR Nos.Consts.
     E**********          TABF    1   7  1   TABFRQ 11   Interest Freqs.                      CLE064
     E                    TABF    1  20  1   TABFRQ 15   Interest Freqs.                      CLE064
     E                    AR         72  1               Narrative Set Up
     E                    DEDIT  31  31  2               Date Edit Array
      /COPY ZSRSRC,ZDATE2Z1
     E                    CPY@    1   1 80
      **  Array of System Values                                                              218782
     E                    SVAL    1   1 20                                                    218782
     E/COPY ZSRSRC,ZDATE9Z1
     E/COPY ZSRSRC,ZPOWERZ1                                                                   CLE031
     L*LE1150P1*42FL*42OL**                                               100663
      /EJECT
     I*
     I** Loan transactions index file - HEADER Record
     I*
     ILTRIX   NS  01   1 CH
     I                                        1   1 RECI
     I                                        2   2 RCDT
     I**********                              3   80LNRF                                      CLE148
     I                                        3   8 LNRF                                      CLE148
     I                                    P   9  110NORE
     I                                    P  12  140FLSZ
     I                                    P  15  170RRLC
     I                                    P  18  200RRNA
     I                                    P  21  230RRLX
     I                                    P  24  260RRXP
     I                                    P  27  290NLNR
     I                                    P  30  320NLAR
     I                                       33  330STPI        27
     I                                    P  38  400TNLU
     I*
     I** LOT used for logging
     I*
     I                                        1  40 LOT
     I*
     I** Loan transactions index file - DETAIL Record
     I*
     ILTRIX   NS  02   1 CD   2 CL
     I       OR        1 CD   2 CR
     I                                        1   1 RECI
     I                                        2   2 RCDT
     I**********                              3   80LNRF                                      CLE148
     I                                        3   8 LNRF                                      CLE148
     I                                        9  130VDAT
     I                                       14  160LASN
     I                                       17  17 CHTP
     I                                       18  18 CNRQ
     I                                       19  19 CNPR
     I                                       20  20 REPR
     I                                       21  250RRLA
     I                                       26  26 LADI
     I                                       27  270PRI1
     I                                       32  34 BRCA
     I                                    P  35  370RRNT
     I                                    P  38  400TNLU
     I                                       41  410PRI2                                    AR322732
     I                                       42  420PRI3                                    AR322732
     I                                       43  430PRI4                                    AR322732
     I                                       44  44 CFPF                                    AR322732
     I                                       45  45 PRPF                                    AR322732
     I*
     I** 'LOT' used for logging
     I*
     I                                        1  40 LOT
     I*
     I        NS
     I                                        1  40 LOT
     I*
     I** Loan transactions index file - HEADER Record
     I*
     ISLTIX   NS  01   1 CH
     I                                        1   1 RECI
     I                                        2   2 RCDT
     I**********                              3   80LNRF                                      CLE148
     I                                        3   8 LNRF                                      CLE148
     I                                    P   9  110NORE
     I                                    P  12  140FLSZ
     I                                    P  15  170RRLC
     I                                    P  18  200RRNA
     I                                    P  21  230RRLX
     I                                    P  24  260RRXP
     I                                    P  27  290NDLR
     I                                    P  30  320NDAR
     I                                       33  330STPI        27
     I                                    P  38  400TNLU
     I*
     I** Loan transactions index file - DETAIL Record
     I*
     I        NS  02   1 CD   2 CL
     I       OR        1 CD   2 CR
     I                                        1   1 RECI
     I                                        2   2 RCDT
     I**********                              3   80LNRF                                      CLE148
     I                                        3   8 LNRF                                      CLE148
     I                                        9  130VDAT
     I                                       14  160LASN
     I                                       17  17 CHTP
     I                                       18  18 CNRQ
     I                                       19  19 CNPR
     I                                       20  20 REPR
     I                                       21  250RRLA
     I                                       26  26 LADI
     I                                       27  270PRI1
     I                                       32  34 BRCA
     I                                    P  35  370RRNT
     I                                    P  38  400TNLU
     I                                       41  410PRI2                                    AR322732
     I                                       42  420PRI3                                    AR322732
     I                                       43  430PRI4                                    AR322732
     I                                       44  44 CFPF                                    AR322732
     I                                       45  45 PRPF                                    AR322732
     I        NS
     I*
     I** Customer lending loans file - HEADER Record
     I*
     ICLOAN   NS       1 CH
     I                                        1   1 RECI
     I**********                              2   70LNRF                                      CLE148
     I                                        2   7 LNRF                                      CLE148
     I                                        8   8 RCDT
     I*
     I** Loans file - DETAIL 1
     I*
     I        NS  03   1 CD   8 CA
     I       OR        1 CM   8 CA
     I       OR        1 CR   8 CA
     I                                        1   1 RECI
     I**********                              2   70LNRF                                      CLE148
     I                                        2   7 LNRF                                      CLE148
     I                                        8   8 RCDT
     I                                        9   90MRIN
     I                                       10  110PTYP
     I**********                             12  170CNUM                                      CSD027
     I                                       12  17 CNUM                                      CSD027
     I                                       18  20 BRCA
     I                                       21  22 LTYP
     I                                       23  24 SUTP
     I                                    P  25  270DDAT
     I                                    P  28  300VDAT
     I                                    P  31  330MDAT
     I*                                                                   S01408
     I/COPY WNCPYSRC,LE1150IIP1                                           S01408
     I*                                                                   S01408
     I                                       34  350LASQ
     I**********                             36  410FCUS                                      CSD027
     I                                       36  41 FCUS                                      CSD027
     I                                       42  440FTYP
     I                                       45  460FSEQ
     I                                       47  49 CCY
     I                                    P  50  560CPAM
     I                                       57  57 INTC
     I                                    P  58  637INTR
     I**********                             64  650BRTT                                      CSD103
     I                                       64  65 BRTT                                      CSD103
     I                                    P  66  717BRTE
     I                                    P  72  777RTSP
     I                                    P  78  815MARG
     I                                       82  82 SPIN
     I                                       83  83 CHIN
     I                                    P  84  897WTRT
     I                                       90  90 WTIN
     I                                       91  91 REPT
     I                                    P  92  980RAMT
     I                                    P  99 1010NRPD        30
     I                                      102 102 RFRQ            31
     I                                      103 1040RDYN        20
     I                                      105 107 FCCY
     I                                      108 1100LIND
     I                                      111 112 CRSK
     I                                      113 114 ACOF
     I                                      115 115 NACD
     I                                      116 116 RELI
     I                                      117 117 AUTO
     I                                    P 118 1240PSAM
     I                                    P 125 1318BCXR
     I                                    P 132 1388FCXR
     I                                      139 1400SDST
     I**********                            141 152 OSDA                                      CGL029
     I                                      141 152 QQOSDA                                    CGL029
     I                                      153 162 TSTN
     I                                      163 1640MDST
     I**********                            165 176 OMDA                                      CGL029
     I                                      165 176 QQOMDA                                    CGL029
     I                                      177 186 TMAN
     I                                      187 196 FACO            23
     I                                    P 197 1990RLDT            89
     I                                    P 200 2020NROD
     I                                      203 203 RLFQ
     I                                      204 2050RLDY
     I                                      206 206 RDFC
     I**********                            207 2080NBRA                                      CSD103
     I                                      207 208 NBRA                                      CSD103
     I                                    P 209 2147NRTS
     I                                      215 215 NSIN
     I                                      216 2160NCAC
     I                                    P 217 2230AWTP
     I                                    P 224 2300WTRD
     I                                    P 231 2370WTWD
     I                                    P 238 2440IWOD
     I                                    P 245 2510PWOD
     I                                      252 252 BMDI
     I                                      253 253 FMDI
     I                                    P 254 2600PDIN
     I                                      265 267 OSDB
     I                                      268 270 OMDB
     I                                      287 287 BTIN
     I                                      288 2890BLDY
     I**********                            290 2950OLNO                                      CSD027
     I                                      290 295 OLNO                                      CSD027
     I                                      296 296 RCSI
     I                                      297 2970ICBS
     I                                      298 298 IPFR            28
     I                                    P 299 3050TOTI
     I                                    P 306 3080NIDT            29
     I                                    P 309 3110IBDT
     I                                    P 312 3140SLID
     I                                    P 315 3210AIPD
     I                                    P 322 3240DLRC
     I                                    P 325 3270IACD
     I                                    P 328 3340AITC
     I                                    P 335 3410TFEP
     I                                    P 342 3480AIAP
     I                                    P 349 3550IPRD
     I                                    P 356 3620IPRM
     I                                    P 363 3690ICTD
     I                                    P 370 3760AIMN
     I                                    P 377 3790RBDT
     I                                    P 380 3810NOPS
     I*
     I                                      384 3850IFDY        21
     I                                      386 386 LONI
     I                                      387 387 CNFI
     I                                      388 388 ACEI
     I                                      389 389 TLXI
     I                                      390 390 CBLI
     I                                    P 391 3930ORED
     I                                    P 394 3960LCD
     I                                      397 397 CHTP
     I                                    P 398 4000TNLU
     I                                      401 401 ADDI
     I*
     I** Book code addition for exposure management
     I*
     I                                      435 436 BOKC
     I*
     I** Customer confirmation
     I*
     I**********                            437 4420COCU                                      CSD027
     I                                      437 442 COCU                                      CSD027
     I*                                                                   070515
     I** Receiver of the guarantee                                        070515
     I*                                                                   070515
     I**********                            443 4480RECE                               070515 CSD027
     I                                      443 448 RECE                                      CSD027
     I                                      459 4600RSTM                  S01518
     I**********                            461 472 RONS                               S01518 CGL029
     I                                      461 472 QQRONS                                    CGL029
     I                                      473 480 RIBN                  S01518
     I                                      481 515 RIBA                  S01518
     I**********                            516 5210ROBN                               S01518 CSD027
     I**********                            522 5270ROCN                               S01518 CSD027
     I                                      516 521 ROBN                                      CSD027
     I                                      522 527 ROCN                                      CSD027
     I                                      528 5290PSTM                  S01518
     I**********                            530 541 PONS                               S01518 CGL029
     I                                      530 541 QQPONS                                    CGL029
     I                                      542 549 PIBN                  S01518
     I                                      550 584 PIBA                  S01518
     I**********                            585 5900POBN                               S01518 CSD027
     I**********                            591 5960POCN                               S01518 CSD027
     I                                      585 590 POBN                                      CSD027
     I                                      591 596 POCN                                      CSD027
     I                                      597 604 RCRN                  S01518
     I                                      605 639 RCRA                  S01518
     I                                      640 647 RVNO                  S01518
     I                                      648 655 AWBN                  S01518
     I                                      656 690 AWBA                  S01518
     I                                      691 698 BENN                  S01518
     I                                      699 733 BENA                  S01518
     I                                      734 768 DTP1                  S01518
     I                                      769 803 DTP2                  S01518
     I                                      804 838 DTP3                  S01518
     I                                      839 873 DTP4                  S01518
     I                                      874 876 DCHG                  S01518
     I                                      877 911 BTB1                  S01518
     I                                      912 946 BTB2                  S01518
     I                                      947 981 BTB3                  S01518
     I                                      9821016 BTB4                  S01518
     I                                     10171051 BTB5                  S01518
     I                                     10521086 BTB6                  S01518
     I                                     10871087 CVMR                  S01518
     I**************                       12071207 MNSG            CLE004148729
     I                                     12851287 SCCY                  CEU004
     I                                     12881290 ICCY                  CEU004
     I                                     13491349 ADIF                                      CLE028
     I                                     13501350 ADCF                                      CLE028
     I                                    P135113570CHGA                                      CLE028
     I                                     13581358 ICIF                                      CLE028
     I                                    P135913650FLTI                                      CLE028
     I                                    P136613680FRPD                                      CLE028
     I                                    P136913750ACCH                                      CLE028
     I                                    P147414808REXR                                      CLE031
     I                                     14811481 REXI                                      CLE031
     I                                     14821484 PSCY                                      CLE031
     I                                    P148514918PEXR                                      CLE031
     I                                     14921492 PEXI                                      CLE031
     I                                     14931493 STAL                                      CLE034
     I                                     14941513 FRNT                                      CAP074
     I                                     15141533 AFRT                                      CAP074
     I                                     15341534 REPA                                      CAP074
     I                                     15351560 TMST                                      CAP074
     I                                     15611578 OSDA                                      CGL029
     I                                     15791596 OMDA                                      CGL029
     I                                     15971614 RONS                                      CGL029
     I                                     16151632 PONS                                      CGL029
     I                                     17621765 CLAS                                      CLE042
     I                                     17661769 DFCL                                      CER020
     I                                     17701773 SLCL                                      CER020
     I                                    P177417760ISDT                                      CER020
     I                                    P177717790FMDT                                      CER020
     I                                     17801782 LOIC                                      CER020
      *                                                                                       CLE134
     I                                     18301830 FAMU                                      CLE134
     I                                     18311831 FPNR                                      CLE134
     I                                    P183218340RIDT                                      CLE134
     I                                    P183518360RIDC                                      CLE134
     I                                     183718370RCAT                                      CLE134
     I                                    P183818390RCAC                                      CLE134
     I                                    P184018420RCSD                                      CLE134
     I                                    P184318440RCDY                                      CLE134
     I                                    P184518460RCCY                                      CLE134
      *                                                                                       CLE134
     I                                    P184718490BIDT                                      CLE134
     I                                    P185018510BIDC                                      CLE134
     I                                     185218520BCAT                                      CLE134
     I                                    P185318540BCAC                                      CLE134
     I                                    P185518570BCSD                                      CLE134
     I                                    P185818590BCDY                                      CLE134
     I                                    P186018610BICC                                      CLE134
      *                                                                                       CLE134
     I                                     18621864 XRFI                                      CLE134
     I                                     186518740XRFN                                      CLE134
     I*
     I** 'LOTL1' & 'LOTL2' used for logging
     I*
     I                                        1 250 LOTL1
     I**************************************251 442 LOTL2                 070515
     I                                      251 448 LOTL2                 070515
     I*
     I** Loans file - DETAIL 2
     I*
     I        NS  03   1 CD   8 CB
     I       OR        1 CM   8 CB
     I       OR        1 CR   8 CB
     I                                        1   1 RECI
     I**********                              2   70LNRF                                      CLE148
     I                                        2   7 LNRF                                      CLE148
     I                                        8   8 RCDT
     I                                        9   90MRIN
     I                                       10  44 NAR1
     I                                       45  79 NAR2
     I                                       80 114 NAR3
     I                                      115 149 NAR4
     I                                    P 150 1560OPAM
     I                                      157 1610FRBC
     I                                    P 162 1680YPLN
     I                                    P 169 1750YFLN
     I                                    P 176 1820YWLN
     I                                    P 183 1890ABLN
     I                                    P 190 1960YPLC
     I                                    P 197 2030YFLC
     I                                    P 204 2100YWLC
     I                                    P 211 2170ABLC
     I                                    P 218 2240WWLN
     I                                    P 225 2310IWLN
     I                                    P 232 2380PWLN
     I                                      243 2440RDST
     I                                      245 274 SPI1
     I                                      275 304 SPI2
     I                                      305 334 SPI3
     I                                      245 334 SPI             24
     I                                    P 335 3410YILN
     I**********                            343 354 ORVD                                      CGL029
     I                                      343 354 QQORVD                                    CGL029
     I                                      355 364 THRN
     I                                    P 365 3710NPRAM
     I                                    P 372 3780NDAM
     I                                      379 381 RLBR
     I                                    P 391 3930ORED
     I                                    P 394 3960LCD
     I                                      397 397 CHTP
     I                                    P 398 4000TNLU
     I                                      401 4020RRST                  S01518
     I**********                            403 414 RRON                               S01518 CGL029
     I                                      403 414 QQRRON                                    CGL029
     I                                      415 422 RRIB                  S01518
     I                                      423 457 RRBA                  S01518
     I**********                            458 4630RROB                               S01518 CSD027
     I**********                            464 4690RROC                               S01518 CSD027
     I                                      458 463 RROB                                      CSD027
     I                                      464 469 RROC                                      CSD027
     I                                     11121114 RRSC                  CEU004
     I                                     11151117 RPSC                  CEU004
     I                                     11181120 RICY                  CEU004
     I                                     12481265 ORVD                                      CGL029
     I                                     12661283 RRON                                      CGL029
     I*
     I** Catch all
     I*
     I        NS
     I                                        1   1 RECI
     I*
     I                                       38  380CDP
     I*
     ICLOAN2  NS       1 CD   8 CA
     I       OR        1 CM   8 CA
     I       OR        1 CR   8 CA
     I**********                             12  170CNUM2                                     CSD027
     I                                       12  17 CNUM2                                     CSD027
     I        NS
     I*
     I** Loan amendments file - DETAIL Record
     I*
     ILOAMS   NS       1 CD
     I                                        8  120VDATLO
     I                                       23  24 AMTP
     I                                    P  38  440PRAM                  138866
     I                                      977 977 NRLI                  138866
      *                                                                   CEU004
     I                                     10611063 SCCY                  CEU004
     I                                     10641066 ICCY                  CEU004
     I                                     10981100 PSCY                  CLE031
     I        NS
     I*
     I*
     I**   D A T A   S T R U C T U R E S
     I**
     I** In case of database errors
     I*
     ILDA        UDS                            256
     I                                      134 141 DBFILE
     I                                      142 170 DBKEY
     I                                      171 180 DBPGM
     I                                      181 1830DBASE
     I                                      134 183 DBINF
     I*                                                                   133683
     IP@IN        DS                            256                       133683
     I                                        1   3 I@SNBR                133683
     I                                        4   9 I@DSCN                133683
     I                                       10  12 I@MTPY                133683
     I                                       13  140I@SETT                133683
     I                                       15  15 I@CONC                133683
     I                                       16  16 I@FTCS                133683
     I                                       17  18 I@MMOD                133683
      ** Data structure for input parameter                               133683
      *                                                                   133683
     IP@OUT       DS                            256                       133683
     I**********                              1   60O@CNSN                             133683 CPK028
     I                                        1   6 O@CNSN                                    CPK028
     I                                        7  18 O@SWSN                133683
     I                                       19  38 O@NWSN                133683
     I                                       39  49 O@SWDS                133683
     I                                       46  46 W@96CN                133683
     I                                       47  49 W@BIC                 133683
     I                                       50  69 O@NWDS                133683
     I                                       70  75 O@NWRK                133683
     I                                       76  76 O@MGSG                133683
     I                                       77  80 O@MGST                133683
      ** Data structure for ouput parameter                               133683
      *                                                                   133683
     I*
     I** Equivalent fields from different record types on DEALS file
     I*
     I            DS
     I                                        1   3 CCY
     I                                        1   3 PUCY
     I*
     I                                        4  160AMT1
     I                                        4  160PUAM
     I                                        4  160PCPL
     I                                        4  160FVAL
     I*
     I                                       17  290AMT2
     I                                       17  290SLAM
     I                                       17  290PUPR
     I                                       17  290SAPRX
     I*
     I                                       30  340MDAT
     I                                       30  340OTDT
     I*
     I                                       35  40 PCUSA
     I                                       35  400PCUS
     I*
     I                                       41  46 CNUMA
     I**********                             41  460CNUM                                      CSD027
     I**********                             41  460ISCN                                      CSD027
     I                                       41  46 CNUM                                      CSD027
     I                                       41  46 ISCN                                      CSD027
     I*
     I** Settlement details
     I*
     I            DS
     I**********                              1  27 SETTLR                                    CGL029
     I                                        1  33 SETTLR                                    CGL029
     I                                        1   20PCST
     I                                        1   20SETP
     I**********                              3  14 OPCA                                      CGL029
     I**********                              3  14 OSAC                                      CGL029
     I**********                             15  24 TSCN                                      CGL029
     I**********                             15  24 TSEN                                      CGL029
     I**********                             25  27 OPSB                                      CGL029
     I**********                             25  27 OSBR                                      CGL029
     I                                        3  20 OPCA                                      CGL029
     I                                        3  20 OSAC                                      CGL029
     I                                       21  30 TSCN                                      CGL029
     I                                       21  30 TSEN                                      CGL029
     I                                       31  33 OPSB                                      CGL029
     I                                       31  33 OSBR                                      CGL029
     I*
     I**********                             28  54 SETTLP                                    CGL029
     I**********                             28  290SCST                                      CGL029
     I**********                             28  290MDST                                      CGL029
     I**********                             30  41 OSCA                                      CGL029
     I**********                             30  41 OMDA                                      CGL029
     I**********                             42  51 TPCN                                      CGL029
     I**********                             42  51 TMAN                                      CGL029
     I**********                             52  54 OSSB                                      CGL029
     I**********                             52  54 OMDB                                      CGL029
     I                                       34  66 SETTLP                                    CGL029
     I                                       34  350SCST                                      CGL029
     I                                       34  350MDST                                      CGL029
     I                                       36  53 OSCA                                      CGL029
     I                                       36  53 OMDA                                      CGL029
     I                                       54  63 TPCN                                      CGL029
     I                                       54  63 TMAN                                      CGL029
     I                                       64  66 OSSB                                      CGL029
     I                                       64  66 OMDB                                      CGL029
     I*
     I**********                             55  81 SETTL1                                    CGL029
     I**********                             55  560SDST                                      CGL029
     I**********                             57  68 OSDA                                      CGL029
     I**********                             69  78 TSTN                                      CGL029
     I**********                             79  81 OSDB                                      CGL029
     I                                       67  99 SETTL1                                    CGL029
     I                                       67  680SDST                                      CGL029
     I                                       69  86 OSDA                                      CGL029
     I                                       87  96 TSTN                                      CGL029
     I                                       97  99 OSDB                                      CGL029
     I*
     I**********                             82 108 SETTL2                                    CGL029
     I**********                             82  830RDST                                      CGL029
     I**********                             84  95 ORVD                                      CGL029
     I**********                             96 105 THRN                                      CGL029
     I**********                            106 108 RLBR                                      CGL029
     I                                      100 132 SETTL2                                    CGL029
     I                                      100 1010RDST                                      CGL029
     I                                      102 119 ORVD                                      CGL029
     I                                      120 129 THRN                                      CGL029
     I                                      130 132 RLBR                                      CGL029
     I*
     I            DS
     I                                        1 136 TITL12
     I                                        1  12 PAYAT
     I                                       13  24 VALDAT
     I                                       25  39 MATDAT
     I                                       40  54 TOURAC
     I                                       55  68 FEEDUE
     I                                       69  83 ROLDAT
     I*
     I            DS
     I                                        1 150 NAME12
     I                                        1  26 INSADV
     I                                       27  50 CRTOAC
     I                                       28  50 DRTOAC
     I                                       51  62 SEND
     I                                       63  86 WAITR
     I                                       64  86 SENDR
     I                                       87  93 ASPER
     I                                       87 110 PERYOR
     I                                       88 110 PEROUR
     I                                      111 138 YOUCOL
     I                                      112 138 WECOL
     I                                      139 148 YERSEL
     I                                      140 148 OURSEL
     I*
     I** Fields used for beneficiary bank details
     I*
     I            DS
     I                                        1  30 SPI1
     I                                        1   3 SPEC3
     I                                        1   5 SPEC5
     I                                        6   8 SPEC8
     I                                        1   8 SPEC9
     I                                        6  12 SPEC12
     I                                        9  14 SPEC14
     I                                        9  17 SPEC17
     I                                       10  18 SPEC18
     I                                        5  29 SPEC29
     I                                        6  30 SPEC30
     I*
     I            DS
     I                                        1  50 NAME34
     I                                        1  10 PAY
     I                                       11  30 AWAITA
     I                                       31  50 SPINST
     I*
     I** Fields used in CONF subroutine
     I*
     I            DS
     I                                        1   5 KEYDS
     I                                        1   1 TYPE
     I                                        2   30N
     I                                        4   40P
     I                                        5   5 PAYREC
     I*
     I** Fields used in MOVEA subroutine
     I*
     I            DS
     I                                        1  72 AR
     I                                        1  72 ARRAY
     I                                       73 141 ADDDS
     I                                       73  740LENGTH
     I                                       75 141 ADD
     I                                      142 142 BLK1
     I                                      142 151 BLK10
     I                                      142 167 BLK25
     I                                      142 210 BLANK
     I*
     I** Fields used in NOSTRO and CPNOS subroutines
     I*
     I            DS
     I**********                              1  12 NOSTRO                                    CGL029
     I                                        1  18 NOSTRO                                    CGL029
     I                                        1   2 NOS
     I                                        1   6 CUSTNO
     I                                        1   8 CPSH
     I                                        1  10 RETAC
     I**********                              7  10 AC                                        CGL029
     I**********                             11  12 SEQ                                       CGL029
     I**********                             13  15 BRC                                       CGL029
     I**********                             16  35 CPTN                                      CGL029
     I**********                             20  20 DASH                                      CGL029
     I**********                             21  22 SEQX                                      CGL029
     I**********                             23  23 DASH2                                     CGL029
     I**********                             24  26 BRCX                                      CGL029
     I                                        7  16 AC                                        CGL029
     I                                       17  18 SEQ                                       CGL029
     I                                       19  21 BRC                                       CGL029
     I                                       22  41 CPTN                                      CGL029
     I                                       32  32 DASH                                      CGL029
     I                                       33  34 SEQX                                      CGL029
     I                                       35  35 DASH2                                     CGL029
     I                                       36  38 BRCX                                      CGL029
      /COPY ZSRSRC,ZTNLU1Z1
      *                                                                                     AR650589
      ** Data structure for file status of LTRIX.                                           AR650589
      *                                                                                     AR650589
     ISLTRX       DS                                                                        AR650589
     I                                     *STATUS  WLXSTS                                  AR650589
     I*
     I** File information data structure
     I*
     ISPOOL       DS
     I                                       83  92 SFILE
     I                                    B 123 1240SFNUM
     I                                    B 152 1530SFLIN
     I*
     ISPOOLU      DS
     I                                       83  92 SFILEU
     I                                    B 123 1240SFNUMU
     ISDBRCH    E DSSDBRCHPD
     I** External DS for branch code details
     I              A8BRNM                          BRNM
     IRUNDT       DS
     I                                        1   7 RUNA
     I                                    P   8  100RUND
     I                                       11  11 SSF
     I                                       12  12 DATF
     I                                       13  13 MBIN
     ISDCURR    E DSSDCURRPD
     I** Currency
     I              A6NBDP                          CDP
     ISDBANK    E DSSDBANKPD
     I** Bank details
     I              BJLCCY                          LOCY
     I              BJURPT                          TITL
     ISDGELR    E DSSDGELRPD
     I**
     ISDMMOD    E DSSDMMODPD
     I**
     ISDTRAD    E DSSDTRADPD
     I**
     I              BLBNOC                          BRNC
     I              BLONOC                          OURC
     I              QQACCD                          QQACC1                                    CGL029
     I**
     ISDCNST    E DSSDCNSTPD
     I** Counterparty nostro code
     I              AWCPNM                          CPNM
     I**
     ISDNOST    E DSSDNOSTPD
     I** Nostro records
     I              A7ORAC                          ORAC
     I              A7CUST                          CNUMN
     I              QQACCD                          QQACC2                                    CGL029
     I**
     ISDCUST    E DSSDCUSTPD
     I** Customer details
     I              BBCRNM                          CRNM
     I              BBCSID                          CSID
     I              BBCRTN                          CTWN
     I              BBTXA1                          TELX
     I              BBGSFM                          GSFM
     I              BBSTFG                          SWTX
     I              QQDFAC                          QQDFC1                                    CGL029
     I**
     ISDALTN    E DSSDALTNPD
     I** Customer
     I              BCCNA1                          CNA1
     I              BCCNA2                          CNA2
     I              BCCNA3                          CNA3
     I              BCCNA4                          CNA4
     I**
     I@MGME     E DSSDMGMEPD
     I** Dummy record format for message details
     I*                                                                   070515
     ISDCLND    E DSSDCLNDPD                                              070515
     I** External DS for customer lending details                         070515
     I*
     I*SDSVAL***E DSSDSVALPD                                                           218782 222373
      ****EXTERNAL DS FOR SYSTEM VALUES                                                218782 222373
      **********                                                                       218782 222373
     IDSFDY     E DSDSFDY
     I** First DS for access programs, short data structure
     I*
     IDSSDY     E DSDSSDY
     I** Second DS for access programs, long data structure
     I*
     ISDBSRT    E DSSDBSRTPD
     I** Base rate
     I*
     ISCSARD    E DSSCSARDPD                                              S01518
     I** SAR Details                                                      S01518
     I              LCD                             LCDX                  S01518
     I*                                                                   S01408
     I/COPY WNCPYSRC,LE1150IIP2                                           S01408
     I*                                                                   S01408
     I              'Through Account'     C         THRACC                CLE033
      * 'Through account' constant  for CLE033                            CLE033
     I*                                                                   S01518
     I              'LECalcBasis6LeapYear'C         WPARML                                  MD035545
     I/COPY ZSRSRC,ZINTDYZ1
     I/COPY ZSRSRC,ZDATE9Z2
     I/COPY ZSRSRC,ZDAT10Z1                                               126017
      /EJECT
     C*
     C** Copyright Statement
     C*
     C                     MOVEACPY@      BIS@   80
     C*
     C** Field definitions
     C*
     C           *LIKE     DEFN CTWN      SVCTWN
     C           *LIKE     DEFN CNA1      SVCNA1
     C           *LIKE     DEFN CNA2      SVCNA2
     C           *LIKE     DEFN CNA3      SVCNA3
     C           *LIKE     DEFN CNA4      SVCNA4
     C           *LIKE     DEFN CNA1      ONA1
     C           *LIKE     DEFN CNA2      ONA2
     C*
     C** Entry parameters
     C*
     C           *ENTRY    PLIST
     C                     PARM           SEQ1    5
     C                     PARM           BRNCH   3         BRANCH OR ALL
     C*
     C** Parameter list for program 'AOBANKR0'
     C*
     C           PLISTA    PLIST
     C                     PARM '*MSG   ' @RTCD   7
     C                     PARM '*FIRST ' @OPTN   7
     C           SDBANK    PARM SDBANK    DSFDY
     C*
     C** Parameter list for program 'AOCURRR0'
     C*
     C           PLISTB    PLIST
     C                     PARM '*MSG   ' @RTCD   7
     C                     PARM '*KEY   ' @OPTN
     C                     PARM           K101    3                    A
     C           SDCURR    PARM SDCURR    DSSDY                        B
     C*
     C** Parameter list for program 'AONOSTR0'
     C*
     C           PLISTC    PLIST
     C                     PARM '*MSG   ' @RTCD
     C                     PARM '*KEY   ' @OPTN
     C                     PARM           KEYA    6                    A
     C                     PARM           KEYB    3                    B
     C**********           PARM           KEYC    4                    C                      CGL029
     C                     PARM           KEYC   10                    C                      CGL029
     C                     PARM           KEYD    2                    D
     C                     PARM           KEYE    2                    E
     C                     PARM           KEYF    3                    F
     C                     PARM           KEYG   10                    G
     C                     PARM           KEYH    1                    H
     C           SDNOST    PARM SDNOST    DSFDY
     C*
     C** Parameter list for program 'AOGELRR0'
     C*
     C           PLISTD    PLIST
     C                     PARM '*MSG   ' @RTCD   7
     C                     PARM '*FIRST ' @OPTN
     C********** SDGELR    PARM SDGELR    DSFDY                                               CGL029
     C           SDGELR    PARM SDGELR    DSSDY                                               CGL029
     C*
     C** Parameter list for program 'AOTRADR0'
     C*
     C           PLISTE    PLIST
     C                     PARM '*MSG   ' @RTCD   7
     C                     PARM '*FIRST ' @OPTN
     C           SDTRAD    PARM SDTRAD    DSFDY
     C*
     C** Parameter list for program 'AOMMODR0'
     C*
     C           PLISTG    PLIST
     C                     PARM '*MSG   ' @RTCD   7
     C                     PARM '*FIRST ' @OPTN   7
     C           SDMMOD    PARM SDMMOD    DSFDY
     C*
     C** Parameter list for program 'AOCNSTR0'
     C*
     C           PLISTF    PLIST
     C                     PARM '*MSG   ' @RTCD   7
     C                     PARM '*KEY   ' @OPTN
     C                     PARM           ARCD    8
     C           SDCNST    PARM SDCNST    DSFDY
     C*
     C** Parameter list for program 'AOCUSTR0'
     C*
     C           PLIST1    PLIST
     C                     PARM '*MSG   ' @RTCD
     C                     PARM '*KEY   ' @OPTN
     C                     PARM           CKEY   10
     C                     PARM           KEYSTS  7
     C           SDCUST    PARM SDCUST    DSSDY
     C*
     C** Parameter list for program 'AOALTNR0'
     C*
     C           PLIST2    PLIST
     C                     PARM '*BLANKS' @RTCD
     C                     PARM '*KEY   ' @OPTN
     C                     PARM           AENB    6
     C                     PARM           AZCD    1
     C           SDALTN    PARM SDALTN    DSFDY
     C*
     C** Parameter list for program 'AOBSRTR0'
     C*
     C           PLIST3    PLIST
     C                     PARM '*BLANKS' @RTCD
     C                     PARM '*KEY   ' @OPTN
     C                     PARM           BKEY1   3
     C                     PARM           BKEY2   2
     C********** SDBSRT    PARM SDBSRT    DSFDY                           CSD006
     C           SDBSRT    PARM SDBSRT    DSSDY                           CSD006
     C*                                                                   070515
     C** Parameter list for program 'AOCLNDR0'                            070515
     C*                                                                   070515
     C           PLISTH    PLIST                                          070515
     C                     PARM '*DBERR ' @RTCD   7                       070515
     C                     PARM '*FIRST ' @OPTN   7                       070515
     C********** SDCLND    PARM SDCLND    DSFDY                                        070515 CLE134
     C           SDCLND    PARM SDCLND    DSSDY                                               CLE134
     C*
     C** First cycle
     C*
     C   19                GOTO MODE2
     C   U2                SETON                     19
     C*
     C** IN the data area RUNDAT
     C*
     C           *NAMVAR   DEFN RUNDAT    RUNDT
     C                     IN   RUNDT
     C*
     C** Define LDA
     C*
     C           *NAMVAR   DEFN           LDA
     C           *LOCK     IN   LDA
     C*
     C** Seton indicator for no printing, if multibranching = NO
     C*
     C           MBIN      IFEQ 'Y'
     C                     SETON                     11
     C                     END
     C*
     C** Save program name in case of database error
     C*
     C                     MOVE BLANK     DBINF
     C                     MOVE 'LE1150'  DBPGM
     C*
     C                     EXSR ZSYSTM
     C   99                Z-ADD01        DBASE            ************
     C   99                MOVEL'SDBANKPD'DBFILE           * DBERR 01 *
     C   99                SETON                     U7U8LR************
     C   99                GOTO END
     C*
     C**********           CALL 'AOGELRR0'PLISTD                                              CGL029
     C                     CALL 'AOGELRR1'PLISTD                                              CGL029
     C           @RTCD     COMP *BLANKS                  07
     C  N07                Z-ADD02        DBASE            ************
     C  N07                MOVEL'SDGELRPD'DBFILE           * DBERR 02 *
     C  N07                SETON                     U7U8LR************
     C  N07                GOTO END
     C*                                                                   070515
     C** Access customer lending data                                     070515
     C*                                                                   070515
     C                     CALL 'AOCLNDR0'PLISTH                          070515
     C                     MOVE '0'       *IN05                           070515
     C           @RTCD     IFNE *BLANK                                    070515
     C                     MOVEL'SDCLNDPD'DBFILE           ************   070515
     C                     MOVEL@OPTN     DBKEY            * DBERR 18 *   070515
     C                     Z-ADD18        DBASE            ************   070515
     C                     SETON                     U7U8LR               070515
     C                     GOTO END                                       070515
     C                     ELSE                                           070515
     C           BPGIAV    IFEQ 'Y'                                       070515
     C                     MOVE '1'       *IN05                           070515
     C                     END                                            070515
     C                     END                                            070515
     C*                                                                   S01518
     C**  Access SAR details file to see if S01518 is installed           S01518
     C*                                                                   S01518
     C                     CALL 'AOSARDR0'                                S01518
     C                     PARM '       ' @RTCD   7                       S01518
     C                     PARM '*VERIFY' @OPTN   7                       S01518
     C                     PARM 'S01518'  @SARD   6                       S01518
     C           SCSARD    PARM SCSARD    DSFDY                           S01518
     C*                                                                   S01518
     C           @RTCD     IFEQ *BLANKS                                   S01518
     C                     MOVE 'Y'       S01518  1                       S01518
     C                     ELSE                                           S01518
     C           @RTCD     IFNE '*NRF   '                                 S01518
     C                     MOVEL'SCSARDPD'DBFILE           ************   S01518
     C                     MOVEL'*VERIFY' DBKEY            * DBERR 23 *   S01518
     C                     Z-ADD23        DBASE            ************   S01518
     C                     SETON                     U7U8LR               S01518
     C                     GOTO END                                       S01518
     C                     END                                            S01518
     C                     END                                            S01518
     C*                                                                   CLE004
     C**  Access SAR details file to see if CLE004 is installed           CLE004
     C*                                                                   CLE004
     C                     CALL 'AOSARDR0'                                CLE004
     C                     PARM '       ' @RTCD   7                       CLE004
     C                     PARM '*VERIFY' @OPTN   7                       CLE004
     C                     PARM 'CLE004'  @SARD   6                       CLE004
     C           SCSARD    PARM SCSARD    DSFDY                           CLE004
     C*                                                                   CLE004
     C           @RTCD     IFEQ *BLANKS                                   CLE004
     C                     MOVE 'Y'       CLE004  1                       CLE004
     C                     ELSE                                           CLE004
     C                     MOVE 'N'       CLE004                          CLE004
     C           @RTCD     IFNE '*NRF   '                                 CLE004
     C                     MOVEL'SCSARDPD'DBFILE           ************   CLE004
     C                     MOVEL'CLE004 ' DBKEY            * DBERR 24 *   CLE004
     C                     Z-ADD24        DBASE            ************   CLE004
     C                     SETON                     U7U8LR               CLE004
     C                     GOTO END                                       CLE004
     C                     ENDIF                                          CLE004
     C                     ENDIF                                          CLE004
     C*                                                                   CLE005
     C**  Access SAR details file to see if CLE005 is installed           CLE005
     C*                                                                   CLE005
     C                     CALL 'AOSARDR0'                                CLE005
     C                     PARM '       ' @RTCD   7                       CLE005
     C                     PARM '*VERIFY' @OPTN   7                       CLE005
     C                     PARM 'CLE005'  @SARD   6                       CLE005
     C           SCSARD    PARM SCSARD    DSFDY                           CLE005
     C*                                                                   CLE005
     C           @RTCD     IFEQ *BLANKS                                   CLE005
     C                     MOVE 'Y'       CLE005  1                       CLE005
     C                     ELSE                                           CLE005
     C                     MOVE 'N'       CLE005                          CLE005
     C           @RTCD     IFNE '*NRF   '                                 CLE005
     C                     MOVEL'SCSARDPD'DBFILE           ************   CLE005
     C                     MOVEL'CLE005 ' DBKEY            * DBERR 25 *   CLE005
     C                     Z-ADD25        DBASE            ************   CLE005
     C                     SETON                     U7U8LR               CLE005
     C                     GOTO END                                       CLE005
     C                     ENDIF                                          CLE005
     C                     ENDIF                                          CLE005
      *                                                                                       CLE028
      ** Check if Flat Rate Personal Loans (Rule of 78s) is installed                         CLE028
      *                                                                                       CLE028
     C                     CALL 'AOSARDR0'                                                    CLE028
     C                     PARM *BLANKS   PRTCD   7                                           CLE028
     C                     PARM '*VERIFY' POPTN   7                                           CLE028
     C                     PARM 'CLE028'  PSARD   6                                           CLE028
     C           SCSARD    PARM SCSARD    DSFDY                                               CLE028
      *                                                                                       CLE028
     C           PRTCD     IFNE *BLANKS                                                       CLE028
     C           PRTCD     ANDNE'*NRF   '                                                     CLE028
     C                     MOVEL'SCSARDPD'DBFILE                                              CLE028
     C                     Z-ADD027       DBASE                                               CLE028
     C                     MOVELPSARD     DBKEY                                               CLE028
     C                     MOVE *ON       *INU7                                               CLE028
     C                     MOVE *ON       *INU8                                               CLE028
     C                     MOVE *ON       *INLR                                               CLE028
     C                     GOTO END                                                           CLE028
     C                     ENDIF                                                              CLE028
      *                                                                                       CLE028
     C           PRTCD     IFEQ *BLANKS                                                       CLE028
     C                     MOVE 'Y'       CLE028  1                                           CLE028
     C                     ELSE                                                               CLE028
     C                     MOVE 'N'       CLE028                                              CLE028
     C                     ENDIF                                                              CLE028
     C*                                                                                       CLE031
     C**  Access SAR details file to see if CLE031 is installed                               CLE031
     C*                                                                                       CLE031
     C                     CALL 'AOSARDR0'                                                    CLE031
     C                     PARM '       ' @RTCD   7                                           CLE031
     C                     PARM '*VERIFY' @OPTN   7                                           CLE031
     C                     PARM 'CLE031'  @SARD   6                                           CLE031
     C           SCSARD    PARM SCSARD    DSFDY                                               CLE031
     C*                                                                                       CLE031
     C           @RTCD     IFEQ *BLANKS                                                       CLE031
     C                     MOVE 'Y'       CLE031  1                                           CLE031
     C                     ELSE                                                               CLE031
     C                     MOVE 'N'       CLE031                                              CLE031
     C           @RTCD     IFNE '*NRF   '                                                     CLE031
     C                     MOVEL'SCSARDPD'DBFILE                                              CLE031
     C                     MOVEL'CLE031 ' DBKEY                                               CLE031
     C                     Z-ADD27        DBASE                                               CLE031
     C                     SETON                     U7U8LR                                   CLE031
     C                     GOTO END                                                           CLE031
     C                     ENDIF                                                              CLE031
     C                     ENDIF                                                              CLE031
     C*                                                                   CLE033
     C**  Access SAR details file to see if CLE033 is installed           CLE033
     C*                                                                   CLE033
     C                     CALL 'AOSARDR0'                                CLE033
     C                     PARM '       ' @RTCD                           CLE033
     C                     PARM '*VERIFY' @OPTN                           CLE033
     C                     PARM 'CLE033'  @SARD                           CLE033
     C           SCSARD    PARM SCSARD    DSFDY                           CLE033
     C*                                                                   CLE033
     C           @RTCD     IFEQ *BLANKS                                   CLE033
     C                     MOVE 'Y'       CLE033  1                       CLE033
      * If CLE033 is on, check system value for settlement currency:                          218782
     C                     CALL 'AOSVALR0'                                                    218782
     C                     PARM *BLANKS   P@RTCD                                              218782
     C                     PARM SVAL,1    P@OP01 20                                           218782
     C                     PARM *BLANKS   P@VL01200                                           218782
     C                     PARM *BLANKS   P@OP02 20                                           218782
     C                     PARM *BLANKS   P@VL02200                                           218782
     C                     PARM *BLANKS   P@OP03 20                                           218782
     C                     PARM *BLANKS   P@VL03200                                           218782
     C                     PARM *BLANKS   P@OP04 20                                           218782
     C                     PARM *BLANKS   P@VL04200                                           218782
     C                     PARM *BLANKS   P@OP05 20                                           218782
     C                     PARM *BLANKS   P@VL05200                                           218782
     C                     PARM *BLANKS   P@OP06 20                                           218782
     C                     PARM *BLANKS   P@VL06200                                           218782
     C                     PARM *BLANKS   P@OP07 20                                           218782
     C                     PARM *BLANKS   P@VL07200                                           218782
     C                     PARM *BLANKS   P@OP08 20                                           218782
     C                     PARM *BLANKS   P@VL08200                                           218782
     C                     PARM *BLANKS   P@OP09 20                                           218782
     C                     PARM *BLANKS   P@VL09200                                           218782
     C                     PARM *BLANKS   P@OP10 20                                           218782
     C                     PARM *BLANKS   P@VL10200                                           218782
     C********** SDSVAL    PARM SDSVAL    DSSDY                                        218782 222373
      *                                                                                       218782
     C           P@RTCD    IFNE *BLANKS                                                       218782
     C                     MOVEL'LE1150  'DBPGM     P                                         218782
     C                     MOVEL'SDSVALPD'DBFILE           ************                       218782
     C                     MOVELSVAL,1    DBKEY            * DBERR 32 *                       218782
     C                     Z-ADD32        DBASE            ************                       218782
     C                     SETON                     U7U8LR  Set Ind                          218782
     C                     GOTO END                                                           218782
     C                     ELSE                                                               218782
      *                                                                                       218782
      ** Save value of Settlement09Postings in a one character field                          218782
     C                     MOVELP@VL01    SET09   1                                           218782
     C                     ENDIF                                                              218782
     C                     ELSE                                           CLE033
     C                     MOVE 'N'       CLE033                          CLE033
     C           @RTCD     IFNE '*NRF   '                                 CLE033
     C                     MOVEL'SCSARDPD'DBFILE           ************   CLE033
     C                     MOVEL'CLE033 ' DBKEY            * DBERR 28 *   CLE033
     C                     Z-ADD28        DBASE            ************   CLE033
     C                     SETON                     U7U8LR               CLE033
     C                     GOTO END                                       CLE033
     C                     ENDIF                                          CLE033
     C                     ENDIF                                          CLE033
      *                                                                                     MD035545
      ** Retrieve system value setting.                                                     MD035545
      *                                                                                     MD035545
     C                     MOVELWPARML    P@OP01                                            MD035545
     C                     CALL 'AOSVALR0'                                                  MD035545
     C                     PARM *BLANKS   @RTCD                                             MD035545
     C                     PARM           P@OP01                                            MD035545
     C                     PARM           P@VL01                                            MD035545
     C                     PARM           P@OP02                                            MD035545
     C                     PARM           P@VL02                                            MD035545
     C                     PARM           P@OP03                                            MD035545
     C                     PARM           P@VL03                                            MD035545
     C                     PARM           P@OP04                                            MD035545
     C                     PARM           P@VL04                                            MD035545
     C                     PARM           P@OP05                                            MD035545
     C                     PARM           P@VL05                                            MD035545
     C                     PARM           P@OP06                                            MD035545
     C                     PARM           P@VL06                                            MD035545
     C                     PARM           P@OP07                                            MD035545
     C                     PARM           P@VL07                                            MD035545
     C                     PARM           P@OP08                                            MD035545
     C                     PARM           P@VL08                                            MD035545
     C                     PARM           P@OP09                                            MD035545
     C                     PARM           P@VL09                                            MD035545
     C                     PARM           P@OP10                                            MD035545
     C                     PARM           P@VL10                                            MD035545
      *                                                                                     MD035545
      ** If system value is not found then default value to 'N'.                            MD035545
      *                                                                                     MD035545
     C           @RTCD     IFNE '       '                                                   MD035545
     C                     MOVE 'N'       WCALC6                                            MD035545
     C                     ELSE                                                             MD035545
     C                     MOVELP@VL01    WCALC6                                            MD035545
     C********** WCALC6    IFEQ 'Y'                                                MD035545 MD047993
     C********** BKALDI    ANDEQ'Y'                                                MD035545 MD047993
     C**********           MOVE 'Y'       WCALC6                                   MD035545 MD047993
     C**********           ELSE                                                    MD035545 MD047993
     C**********           MOVE 'N'       WCALC6                                   MD035545 MD047993
     C**********           ENDIF                                                   MD035545 MD047993
     C                     ENDIF                                                            MD035545
     C*                                                                   S01408
     C/COPY WNCPYSRC,LE1150CCP1                                           S01408
     C*                                                                   S01408
     C*
     C** Access midas module details
     C*
     C                     CALL 'AOMMODR0'PLISTG
     C           @RTCD     IFNE *BLANKS
     C                     MOVEL'SDMMODPD'DBFILE           ************
     C                     Z-ADD10        DBASE            * DBERR 10 *
     C                     MOVEL@OPTN     DBKEY            ************
     C                     SETON                     U7U8LR
     C                     GOTO END
     C                     END
     C*
     C                     CALL 'AOTRADR0'PLISTE
     C           @RTCD     COMP *BLANKS                  07
     C  N07                Z-ADD03        DBASE            ************
     C  N07                MOVEL'SDTRADPD'DBFILE           * DBERR 03 *
     C  N07                SETON                     U7U8LR************
     C  N07                GOTO END
     C*
     C** Test ourselves or nostro, and branch name on confirmation in DS
     C*
     C           OURC      COMP 'O'                  1818
     C           BRNC      COMP 'Y'                      16
     C                     MOVE 'A'       CLIKEY  7
     C                     MOVEL'D'       DLRCDT  2
     C                     Z-ADD0         ZERO5   50
     C                     MOVE ' '       BLNKS 150
     C                     MOVEL'NOT FOUN'ERM1    9
     C                     MOVE 'D'       ERM1
     C                     MOVE ERM1      ERM    16
     C   U2                GOTO MODE2
     C*
     C** M O D E   1 & 3   C O N F I R M A T I O N S   - one cycle only
     C*
     C                     Z-ADD1         COUNT   50
     C                     Z-ADD2         NORET   50
     C*
     C** To allow output of LEEXT header if U4 is ON
     C*
     C   U4                SETON                     82
     C*
     C**  Read LTRIX header.  If last record read or in mode 1 stop
     C**  print ind. on, finish.  Otherwise release.
     C*
     C           AGAIN1    TAG                             ***  AGAIN1 ***
     C*
     C                     SETOF                     8178
     C                     Z-ADD1         RRN     50
     C*
     C** Lock hdr by read & dummy update
     C*
     C                     EXSR HDRCHN
     C**N01*****           Z-ADD04        DBASE            ************                     AR322732
     C**N01*****           MOVEL'LTRIX   'DBFILE           * DBERR 04 *                     AR322732
     C**N01*****           MOVELRRN       DBKEY            ************                     AR322732
     C**N01*****           SETON                     U7U8LR                                 AR322732
     C**N01*****           GOTO END                                                         AR322732
     C*
     C**NU3N19**           Z-ADDRRLC      COUNT                                             AR322732
     C*
     C** Release LTRIX header
     C*
     C                     SETON                     75
     C**********           EXSR EXCPT                                                       AR322732
     C                     SETON                     19
     C*
     C           AGAIN3    TAG                             ***  AGAIN3 ***
     C                     SETOF                     78
     C********** COUNT     ADD  1         COUNT                                             AR322732
     C********** COUNT     COMP RRNA                   60                                   AR322732
     C*NU3*27**                                                                             AR322732
     C*ORN60****           GOTO FINISH                                                      AR322732
     C*
     C** Get and release LTRIX detail and find if conf. to be printed
     C*
     C**********           Z-ADDCOUNT     RRN                                               AR322732
     C                     EXSR LTRCHN
     C   LR                GOTO FINISH                                                      AR322732
      *                                                                                     AR322732
      ** If already processed by confirmation job read next one.                            AR322732
      *                                                                                     AR322732
     C           CFPF      IFEQ 'Y'                                                         AR322732
     C                     GOTO AGAIN3                                                      AR322732
     C                     ENDIF                                                            AR322732
      *                                                                                     AR322732
     C                     SETON                     75
     C**********           EXSR EXCPT                                                       AR322732
     C           RCDT      COMP 'R'                      79  ROLLOVER REC
     C  N02 U3             GOTO AGAIN3
     C  N02                GOTO AGAIN1
     C*                                                                   S01408
     C/COPY WNCPYSRC,LE1150CCP2                                           S01408
     C*                                                                   S01408
     C*
     C           CNRQ      COMP 'R'                      68
     C   68NU3   CNPR      COMP 'Y'                  6868
     C   68NU3             GOTO LOAN
     C           CNRQ      COMP 'Y'                      60
     C  N60NU3             GOTO AGAIN1
     C  N60      CHTP      COMP 'I'                      60
     C  N60 79   CHTP      COMP 'A'                      60 ROLLOVER CONF
     C  N60 U3   CHTP      COMP 'R'                      60
     C   60      CNPR      COMP 'Y'                  6060
      *                                                                                       255752
      ** If UDC present, ensure this record has been processed by UDC                         255752
      *                                                                                       255752
     C           BGN1ST    IFEQ 'Y'                                                           255752
     C           *IN60     ANDEQ'1'                                                           255752
     C           CNPR      ANDNE'S'                                                           255752
     C                     MOVE '0'       *IN60                                               255752
     C                     ENDIF                                                              255752
      *                                                                                       255752
     C  N60                EXSR EXCPT                                                       AR322732
     C  N60                GOTO AGAIN3
     C*
     C** Print confirmation and update files
     C*
     C           LOAN      TAG                             ***  LOAN   ***
     C                     EXSR CLCHN
     C*                                                                   S01408
     C/COPY WNCPYSRC,LE1150CCP3                                           S01408
     C*                                                                   S01408
     C  NLR                SETON                     77
     C  NLR                EXSR EXCPT                      RELEASE CLOAN
     C  NLR                EXSR INFOSR
     C           *INLR     IFEQ '1'                                       CLE005
     C           *IN62     ANDEQ'1'                                       CLE005
     C                     GOTO END                                       CLE005
     C                     ENDIF                                          CLE005
      *                                                                   CLE005
     C  NLR                EXSR LOCHN
      *                                                                   138866
      ** If Principal amount is zero, default to the transfer amount.     138866
     C           CPAM      IFEQ 0                                         138866
     C           *INLR     ANDEQ*OFF                                      138866
     C                     EXSR SRLOAM                                    138866
      *                                                                   138866
      ** If no record found, skip this loan.                              138866
      ** only for non-paricipations                                       159259
      *                                                                   159259
     C           CPAM      IFEQ 0                                         138866
     C           WFLG      ANDEQ*BLANKS                                   159259
     C           *INU3     IFEQ *ON                                       138866
     C                     GOTO AGAIN3                                    138866
     C                     ELSE                                           138866
     C                     GOTO AGAIN1                                    138866
     C                     ENDIF                                          138866
     C                     ENDIF                                          138866
     C                     ENDIF                                          138866
     C  NLR 45             MOVE *ZEROS    TOTINT                          150995
     C  NLR 45             MOVE *ZEROS    TOTAL                           150995
     C  NLR 45             EXSR INTCAL
     C   LR                Z-ADD05        DBASE            ************
     C   LR                MOVEL'CLOAN   'DBFILE           * DBERR 05 *
     C   LR                MOVELCLKEY     DBKEY            ************
     C  NLR                MOVE RCDT      DLRCDT
     C*
     C           *INLR     IFNE '1'
     C                     EXSR MBRT
     C                     END
     C   78                GOTO END
     C  NLR                EXSR CONF
     C   78                GOTO END
     C   66NU7             EXSR UPDATE
     C  NLR U3             GOTO AGAIN3
     C  NLR                GOTO AGAIN1
     C                     GOTO END
     C*
     C** Set off stop print ind. & update RRN of last conf. processed
     C*
     C           FINISH    TAG                             ***  FINISH ***
     C                     SETON                     LR
     C                     Z-ADD1         RRN
     C**********           EXSR LTRCHN                                                      AR322732
     C*
     C**N60*****           SETON                     75                                     AR322732
     C**N60*****           EXSR EXCPT                                                       AR322732
     C*
     C**N01*****           Z-ADD06        DBASE            ************                     AR322732
     C**N01*****           MOVEL'LTRIX   'DBFILE           * DBERR 06 *                     AR322732
     C**N01*****           MOVELRRN       DBKEY            ************                     AR322732
     C**N01*****           SETON                     U7U8LR                                 AR322732
     C********** COUNT     SUB  1         COUNT                                             AR322732
     C  NU7                EXSR UPDATE
     C                     GOTO END
     C*
     C** M O D E   2   C O N F I R M A T I O N S
     C*
     C           MODE2     TAG                             ***  MODE2  ***
     C                     READ SLTIX                    LR
     C   LR
     CORN02                GOTO END
     C           RCDT      COMP 'R'                      79  ROLLOVER REC
     C*
     C           CNRQ      COMP 'R'                      60
     C**N60***** CNPR      COMP 'Y'                  6060                                   MD056750
     C  N60      CFPF      COMP 'Y'                  6060                                   MD056750
     C   60                GOTO END
     C*
     C                     EXSR CLCHN
     C   LR                Z-ADD07        DBASE            ************
     C   LR                MOVEL'CLOAN   'DBFILE           * DBERR 07 *
     C   LR                MOVELCLKEY     DBKEY            ************
     C   LR                GOTO END
     C                     SETON                     77
     C                     EXSR EXCPT
     C                     EXSR INFOSR
     C           *INLR     IFEQ '1'                                       CLE005
     C           *IN62     ANDEQ'1'                                       CLE005
     C                     GOTO END                                       CLE005
     C                     ENDIF                                          CLE005
     C                     EXSR LOCHN
      *                                                                   138866
      ** If Principal amount is zero, default to the transfer amount.     138866
     C           CPAM      IFEQ 0                                         138866
     C                     EXSR SRLOAM                                    138866
      *                                                                   138866
      ** If no record found, skip this loan.                              138866
      ** only for non-paricipations                                       159259
      *                                                                   159259
     C           CPAM      IFEQ 0                                         138866
     C           WFLG      ANDEQ*BLANKS                                   159259
     C                     GOTO END                                       138866
     C                     ENDIF                                          138866
     C                     ENDIF                                          138866
     C  NLR 45             MOVE *ZEROS    TOTINT                          150995
     C  NLR 45             MOVE *ZEROS    TOTAL                           150995
     C   45                EXSR INTCAL
     C*
     C           LNRF      COMP LASTLN                   61
     C           CHTP      COMP 'R'                      60
     C   60      ORED      COMP RUND                 6060
     C                     SETOF                     59
     C   60
     CORN61                SETON                     59
     C*
     C** Call multibranch subroutine
     C*
     C           *IN59     IFEQ '1'
     C                     EXSR MBRT
     C                     END
     C   78                GOTO END
     C*
     C   60
     CORN61                EXSR CONF
     C   78                GOTO END
     C***59*****           Z-ADDLNRF      LASTLN  60                                          CLE148
     C   59                MOVELLNRF      LASTLN  6                                           CLE148
     C*
     C           END       TAG                             ***  END    ***
     C*
     C           *INLR     IFEQ '1'
     C           *INU7     ANDEQ'1'
     C                     OPEN LE1150AU
     C                     END
     C*
     CLR                   SETOF                     U2
     C*
     C** Ensure totals spool file recorded by RCF only if error
     C*
     CLR         *INU7     IFEQ '1'
     CLR         *INU8     ANDEQ'1'
     CLR                   Z-ADDSFNUMU    ZSNUMU  60
     CLR                   OUT  LDA
     C*
     CLR                   CALL 'ZSFILE'
     CLR                   PARM           SEQ1
     CLR                   PARM *BLANKS   SENTY
     CLR                   PARM           SFILEU
     CLR                   PARM           ZSNUMU
     CLR                   PARM           ZSERR   1
     C*
     C           *LOCK     IN   LDA
     CLR         ZSERR     IFEQ 'Y'
     C*
     C** Error during ZSFILE processing, return to calling program
     C*
     CLR                   SETON                     U7U8
     CLR                   RETRN
     CLR                   END
     CLR                   END
     C*
     C** Execute error routine if database error exists
     C*
     CLR U7 U8             EXSR *PSSR
     C*
     C*****************************************************************
     C*                                                               *
     C*  MBRT   - Subroutine to test multibranch output               *
     C*                                                               *
     C*  Called by: Main processing                                   *
     C*  Calls    : None                                              *
     C*                                                               *
     C*****************************************************************
     C           MBRT      BEGSR                           ***  MBRT  ***
     C*
     C                     SETOF                     78
     C           MBIN      IFEQ 'Y'
     C*
     C** If BRCA is less than the required branch, skip the calculation
     C*
     C           BRNCH     IFNE BRCA
     C           BRNCH     ANDNE'ALL'
     C                     SETOF                     71
     C                     SETON                     78
     C                     GOTO ENDM
     C                     END
     C*
     C           BRCA      IFNE STRBRC
     C                     MOVE BRCA      STRBRC  3
     C                     CLOSELE1150P1
     C*
     C** If MBIN=YES, and a required branch and a lever break, open
     C** LE1150P1
     C*
     C           BRNCH     IFEQ 'ALL'
     C           BRNCH     OREQ BRCA
     C                     SETON                     71    Allow output
     C                     OPEN LE1150P1
     C                     Z-ADD0         PAGE
     C*
     C** Ensure totals spool file recorded by RCF
     C*
     C                     Z-ADDSFNUM     ZSNUM   60
     C                     OUT  LDA
     C*
     C                     CALL 'ZSFILE'
     C                     PARM           SEQ1
     C                     PARM BRCA      SENTY
     C                     PARM           SFILE
     C                     PARM           ZSNUM
     C                     PARM           ZSERR   1
     C*
     C           *LOCK     IN   LDA
     C           ZSERR     IFEQ 'Y'
     C*
     C** Error during ZSFILE processing, return to calling program
     C*
     C                     SETON                     U7U8LR
     C                     RETRN
     C                     END
     C*
     C                     ELSE
     C*
     C** If BRCA is greater than the required branch, end the program
     C*
     C           BRNCH     IFLT BRCA
     C           BRNCH     ANDNE'ALL'
     C                     SETON                     LR78
     C                     SETOF                     71
     C                     GOTO ENDM
     C                     END
     C                     END
     C                     END
     C*
     C                     ELSE
     C*
     C** If MBIN='N' and first cycle, open LE1150P1
     C*
     C           P1OP      IFNE 'Y'
     C                     SETON                     71    Allow output
     C                     MOVE 'Y'       P1OP    1
     C                     OPEN LE1150P1
     C                     Z-ADD0         PAGE
     C*
     C** Ensure report spool file recorded by RCF
     C*
     C                     Z-ADDSFNUM     ZSNUM
     C                     OUT  LDA
     C*
     C                     CALL 'ZSFILE'
     C                     PARM           SEQ1
     C                     PARM BRCA      SENTY   3
     C                     PARM           SFILE
     C                     PARM           ZSNUM
     C                     PARM           ZSERR   1
     C*
     C           *LOCK     IN   LDA
     C           ZSERR     IFEQ 'Y'
     C*
     C** Error during ZSFILE processing, return to calling program
     C*
     C                     SETON                     U7U8LR
     C                     RETRN
     C                     END
     C                     END
     C                     END
     C           ENDM      ENDSR                           ***  ENDM  ***
     C*
     C*****************************************************************
     C*                                                               *
     C*  CONF   - Subroutine to print confirmations                   *
     C*                                                               *
     C*  Called by: Main processing                                   *
     C*  Calls    : MOVEA, TABCHN, ZDATE2, SETTYP, NOSTRO, CPNOS,     *
     C*             CLICHN, EXCPT                                     *
     C*                                                               *
     C*****************************************************************
     C           CONF      BEGSR                           ***  CONF  ***
     C*
     C                     SETOF                     78
     C                     MOVE BLANK     CNA1
     C*
     C** Check type of confirmation
     C*
     C           CHTP      COMP 'R'                      64Cancellation
     C*
     C** Bypass to REPRT for reprint of confirmations
     C*
     C*                                                                   S01408
     C/COPY WNCPYSRC,LE1150CCP4                                           S01408
     C*                                                                   S01408
     C   68
     COR U2                GOTO REPRT
     C   64                TESTB'1'       CNFI           66
     C  N64      RECI      COMP 'R'                  6666
     C  N66                GOTO ENDCON
     C           CHTP      COMP 'A'                      60Amend
     C  N60      CHTP      COMP 'R'                      60Reversal
     C   U3
     COR 60                TESTB'0'       CNFI       66
     C  N66 79             TESTB'2'       CNFI       66
     C   U3N66
     COR 60N66             GOTO ENDCON
     C           REPRT     TAG                             ***  REPRT  ***
     C                     SETOF                     6365
     C   68
     COR U2                SETON                     63    Copy
     C  N64      ORED      COMP RUND                 6565  Amendment
     C           *IN65     IFEQ '0'                                                           209887
     C           CHTP      ANDEQ'A'                                                           209887
      *                                                                                       262869
     C           KEY1      KLIST                                                              262869
     C                     KFLD           BRCA                                                262869
     C                     KFLD           CNUM                                                262869
     C                     KFLD           LNRF                                                262869
     C           KEY1      SETLLLELOANL4                                                      262869
     C           KEY1      READELELOANL4                 91                                   262869
     C           *IN91     DOWEQ'0'                                                           262869
     C           CNPR      IFEQ 'Y'                                                           262869
     C                     MOVE '1'       *IN92                                               262869
     C                     LEAVE                                                              262869
     C                     ENDIF                                                              262869
     C           KEY1      READELELOANL4                 91                                   262869
     C                     ENDDO                                                              262869
      *                                                                                       262869
     C           *IN92     IFEQ '1'                                                           262869
     C                     MOVE '1'       *IN65                                               209887
     C                     MOVE '0'       *IN92                                               262869
     C                     ENDIF                                                              262869
      *                                                                                       262869
     C                     ENDIF                                                              209887
     C*
     C** Set up confirmation name
     C*
     C           PTYP      LOKUPTABTYP    TABNO          60
     C                     MOVE TABNO     KEYDS
     C*
     C** Set up confirmation name for rollover
     C*
     C   79                MOVE '  15 '   KEYDS
     C*
     C                     MOVEABLANK     AR
     C                     MOVE START,N   A       20
     C                     MOVELNAME,N    ADDDS
     C                     EXSR MOVEA
     C                     MOVELARRAY     CNAME  26
     C*
     C** Get branch name if required on output
     C*
     C           MBIN      IFEQ 'Y'
     C*
     C** Get branch name, only when MBIN = YES
     C*
     C           *IN16     ANDEQ'1'
     C**********           CALL 'AOBRCHR0'                                                    CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7
     C                     PARM '*KEY   ' @OPTN   7
     C                     PARM BRCA      @DSNB   3
     C********** SDBRCH    PARM SDBRCH    DSFDY                                               CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANKS
     C                     MOVEL@DSNB     DBKEY            ************
     C                     MOVEL'SDBRCHPD'DBFILE           * DBERR 16 *
     C                     Z-ADD16        DBASE            ************
     C                     SETON                     78
     C                     SETON                     U7U8LR
     C                     EXSR *PSSR
     C                     GOTO ENDCON
     C                     END
     C                     END
     C*
     C** Set up 'FROM' date narrative
     C*
     C                     MOVE '       ' FDATE   7
     C   45                Z-ADDZIBEG     ZDAYNO
     C  N45                Z-ADDVDAT      ZDAYNO
     C   79                Z-ADDRLDT      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    FDATE
     C*
     C** Set up 'TO' date narrative
     C*
     C                     MOVE '       ' TDATE   7
     C   45                Z-ADDZIEND     ZDAYNO
     C  N45                Z-ADDMDAT      ZDAYNO
     C   79                Z-ADDNROD      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    TDATE
     C*
     C** Get repayment and frequency
     C*
     C                     Z-ADDNRPD      ZDAYNO
     C*
     C                     EXSR ZDATE2
     C*
     C                     MOVE ZADATE    RDATE   7
     C/COPY WNCPYSRC,LE1150C005
     C           RFRQ      LOKUPTABF      TABFRQ         60
     C**********           MOVE TABFRQ    TABFQ2 11                                           CLE064
     C                     MOVE TABFRQ    TABFQ2 15                                           CLE064
     C*
     C** Set up editing for repayment freq. day no., if present
     C*
     C   20                Z-ADDRDYN      X       20
     C   20                MOVELRDYN      RDAY    4
     C   20                MOVE DEDIT,X   RDAY
     C   20      RDYN      COMP 09                     6060
     C   20 60             MOVELBLK1      RDAY
     C*
     C** For discounts calculate total
     C*
     C   44      CPAM      SUB  TOTI      TOTAL  130
     C   79      NPRAM     SUB  NDAM      TOTAL
     C*
     C** For rollover discount loan calculate discount rate
     C*
     C***79***** NBRA      COMP 0                    6060  Next base rate                     CSD103
     C   79      NBRA      COMP *BLANKS              6060  Next base rate                     CSD103
     C   79N60             Z-ADD0         BASER  117
     C   79N60             GOTO JUMP
     C   79 60             EXSR GETBR                      Get base rate
     C   79N07             GOTO ENDCON
     C*
     C           JUMP      TAG                             ** JUMP TAG  **
     C   79      NSIN      COMP 'A'                      60Spread ind.
     C   79 60   BASER     ADD  NRTS      DSCRTE 117       Discount rate
     C   79 60             GOTO ENDRTE
     C   79      NSIN      COMP 'S'                      60
     C   79 60   BASER     SUB  NRTS      DSCRTE           Discount rate
     C   79 60             GOTO ENDRTE
     C   79      NRTS      DIV  100       WRK139 139
     C   79      WRK139    MULT BASER     DSCRTE
     C*
     C** Output old rate if discount rate calculated is zero.
     C*
     C   79      DSCRTE    IFEQ 0
     C                     Z-ADDINTR      DSCRTE
     C                     END                             END IF
     C*
     C           ENDRTE    TAG                             *** ENDRTE ***
     C*
     C** Get currency decimal places
     C*
     C                     MOVE CCY       K101
     C                     CALL 'AOCURRR0'PLISTB
     C           @RTCD     IFNE *BLANKS
     C                     Z-ADD09        DBASE            ************
     C                     MOVEL'SDCURRPD'DBFILE           * DBERR 09 *
     C                     SETON                     U7U8LR************
     C                     GOTO ENDCON
     C                     END
     C/COPY WNCPYSRC,LE1150C001
     C           CDP       COMP 1                      4041
     C           CDP       COMP 2                    43  42
     C*
     C** Move settlement fields for loan/dep or N.A.Purch into
     C** receipt/payment groups - see data structures
     C*
     C                     SETOF                     49
     C  N37N38             SETON                     49
     C   49                MOVE SETTLP    SETTLR
     C   49                MOVE SETTL1    SETTLP
     C  N49                MOVE SETTL1    SETTLR
     C   79                MOVE SETTL2    SETTLR
     C*
     C** Set indicators for receipt settlement type
     C*
     C                     EXSR SETTYP
     C*
     C** Set up OUR receipt nostro fields
     C*
     C                     SETOF                     6117
     C                     MOVE OPCA      NOSTRO
     C                     MOVE OPSB      BRC
     C                     EXSR QNOSTR
     C                     MOVELARRAY     TITL1  40
      *                                                                   CLE033
     C                     MOVE 'N'       REC09   1                                           218782
     C           CLE033    IFEQ 'Y'                                       CLE033
     C           PCST      ANDEQ09                                        CLE033
     C                     MOVE 'Y'       REC09   1                                           218782
     C                     MOVELTHRACC    NAME1                           CLE033
     C           OPSB      CAT  OPCA      TOWN1                           CLE033
     C                     ELSE                                           CLE033
     C                     MOVE CPNM      NAME1  35
     C*********************MOVELCPTN      TOWN1  10                       CLE033
     C                     MOVELCPTN      TOWN1  15                       CLE033
     C                     ENDIF                                          CLE033
     C*
     C** Set up THEIR payment nostro fields
     C*
     C                     MOVELTSCN      NOSTRO
     C                     EXSR CPNOS
     C                     MOVELARRAY     TITL3  10
     C                     MOVE CPNM      NAME3  35
     C                     MOVE CPTN      TOWN3  20
     C   79                SETON                     39
     C   39N24             MOVE SPINST    TITL6            Risk loan spi.
     C   39                GOTO PRINT
     C*
     C** Set indicators for payment settlement type
     C*
     C                     Z-ADDSCST      PCST
     C                     EXSR SETTYP
     C*
     C** Set up OUR payment nostro fields
     C*
     C                     SETON                     61
     C***********                                                  S01518 088809
     C***********S01518    IFEQ 'Y'                        B1      S01518 088809
     C***********                                                  S01518 088809
     C***USE*FOLLOWING RULES TO SET UP A/C WITH BANK               S01518 088809
     C***PT*SOLD* SUP MT202  A/C WITH BANK  RCVR CORR  A/C W BK DETS01518 088809
     C***----------------------------------------------------------S01518 088809
     C*******N***      N      ENTERED        N/A         A/C WITH BS01518 088809
     C*******N***      N      BLANK          N/A         OUR PAY NOS01518 088809
     C*******Y***      Y      N/A            ENTERED     RECEIVERS S01518 088809
     C*******Y***      Y      N/A            BLANK       OUR PAY NOS01518 088809
     C***********                                                  S01518 088809
     C***********          MOVE *BLANKS   NOSTRO                   S01518 088809
     C***********PCST      IFEQ 01                         B2      S01518 088809
     C***********PCST      OREQ 07                                 S01518 088809
     C***********PCST      OREQ 08                                 S01518 088809
     C***********CVMR      IFNE 'Y'                        B3      S01518 088809
     C***********TPCN      IFNE *BLANKS                    B4      S01518 088809
     C***********          MOVELTPCN      NOSTRO                   S01518 088809
     C***********          ELSE                            X4      S01518 088809
     C***********          MOVELOSCA      NOSTRO                   S01518 088809
     C***********          END                             E4      S01518 088809
     C***********          ELSE                            X3      S01518 088809
     C***********RCRN      IFNE *BLANKS                    B4      S01518 088809
     C***********          MOVELRCRN      NOSTRO                   S01518 088809
     C***********          ELSE                            X4      S01518 088809
     C***********          MOVELOSCA      NOSTRO                   S01518 088809
     C***********          END                             E4      S01518 088809
     C***********          END                             E3      S01518 088809
     C***********          MOVE OSSB      BRC                      S01518 088809
     C***********          EXSR CPNOS                              S01518 088809
     C***********                                                  S01518 088809
     C***IF*'NOSTRO' CONTAINS A NOSTRO NUMBER PERFORM SRNOST TO    S01518 088809
     C***OBTAIN*NOSTRO DETAILS                                     S01518 088809
     C***********                                                  S01518 088809
     C************IN07     IFEQ '0'                        B3      S01518 088809
     C************IN08     ANDEQ'0'                                S01518 088809
     C***********          MOVE *BLANKS   ERM                      S01518 088809
     C***********          MOVE *BLANKS   CPNM                     S01518 088809
     C***********          EXSR QNOSTR                             S01518 088809
     C***********          MOVELARRAY     TITL2                    S01518 088809
     C***********          MOVE CPNM      NAME2                    S01518 088809
     C***********          MOVELCPTN      TOWN2                    S01518 088809
     C***********          ELSE                            X3      S01518 088809
     C***********          MOVELARRAY     TITL2                    S01518 088809
     C***********          MOVE CPNM      NAME2                    S01518 088809
     C***********          MOVELCPTN      TOWN2                    S01518 088809
     C***********          END                             E3      S01518 088809
     C***********                                                  S01518 088809
     C***********          ELSE                            X2      S01518 088809
     C***********                                                  S01518 088809
     C***********          MOVE OSCA      NOSTRO                   S01518 088809
     C***********          MOVE OSSB      BRC                      S01518 088809
     C***********          EXSR QNOSTR                             S01518 088809
     C***********          MOVELARRAY     TITL2                    S01518 088809
     C***********          MOVE CPNM      NAME2                    S01518 088809
     C***********          MOVELCPTN      TOWN2                    S01518 088809
     C***********          END                             E2      S01518 088809
     C***********                                                  S01518 088809
     C***********          ELSE                            X1      S01518 088809
     C                     MOVE OSCA      NOSTRO
     C                     MOVE OSSB      BRC
     C                     EXSR QNOSTR
     C                     MOVELARRAY     TITL2  27
      *                                                                   CLE033
     C                     MOVE 'N'       PAY09   1                                           218782
     C           CLE033    IFEQ 'Y'                                       CLE033
     C           PCST      ANDEQ09                                        CLE033
     C                     MOVE 'Y'       PAY09   1                                           218782
     C                     MOVELTHRACC    NAME2                           CLE033
     C           OSSB      CAT  OSCA      TOWN2                           CLE033
     C                     ELSE                                           CLE033
     C                     MOVE CPNM      NAME2  35
     C*********************MOVELCPTN      TOWN2  10                       CLE033
     C                     MOVELCPTN      TOWN2  15                       CLE033
     C                     ENDIF                                          CLE033
     C***********          END                             E1      S01518 088809
     C*
     C** Special instructions
     C*
     C  N51N52N54
     CANN57                SETON                     24
     C  N24                MOVE SPINST    TITL6  20
     C*
     C** Ignore blank special instructions
     C*
     C   24                GOTO BENEND
     C*
     C** Check for beneficiary bank details
     C*
     C           SPEC5     COMP '/BEN/'              606025
     C   60                GOTO BENEND
     C*
     C** Check for chips number
     C*
     C           SPEC8     COMP '/CH'                    60
     C   60                MOVE SPEC14    WORK6   6
     C   60                MOVE *BLANKS   SPI1
     C   60                MOVE 'CHIPS'   SPEC5
     C   60                MOVE WORK6     SPEC12
     C   60                GOTO BENEND
     C*
     C** Check for fed. wire number
     C*
     C           SPEC8     COMP '/FW'                    60
     C   60                MOVE SPEC17    WORK9   9
     C   60                MOVE *BLANKS   SPI1
     C   60                MOVE 'FED.WIRE'SPEC9
     C   60                MOVE WORK9     SPEC18
     C   60                GOTO BENEND
     C*
     C** Must now be 'ACCOUNT'
     C*
     C                     MOVE SPEC30    WORK25 25
     C                     MOVE *BLANKS   SPI1
     C                     MOVE 'A/C'     SPEC3
     C                     MOVE WORK25    SPEC29
     C*
     C           BENEND    TAG                             * BENEND TAG *
     C*
     C** Set up their receipt nostro fields
     C*
     C                     MOVELTPCN      NOSTRO
     C                     EXSR CPNOS
     C                     MOVELARRAY     TITL4  10
     C                     MOVE CPNM      NAME4  35
     C                     MOVE CPTN      TOWN4  20
     C*
     C** Get for A/C of
     C*
     C                     MOVELFACO      NOSTRO
     C   51N23             EXSR CPNOS
     C*
     C** Get name and address lines and print confirmation
     C*
     C           PRINT     TAG                             ***  PRINT  ***
     C                     MOVELCNUM      AENB
     C                     MOVELCNUM      CKEY
     C*
     C                     CALL 'AOCUSTR0'PLIST1
     C*
     C** Remove old routing
     C*
     C                     SETOF                     8581
     C*
     C** If swift address BIC code do not output to LEEXTAB
     C** Insert new MG routing
     C*
     C                     MOVE CSID      @BIC    4
     C                     MOVELBRCA      @DSNB   3
     C                     MOVELCNUM      @CUST   6
     C***********          EXSR ROUT                                      133683
     C                     EXSR SRROUT                                    133683
     C*
     C** LEEXT rec is produced if lending message flag is ON
     C** Message network can be changed via message management
     C*
     C           BGSWCL    IFEQ 'Y'
     C*
     C           *INU1     IFEQ '1'
     C                     SETON                     81
     C                     END
     C*
     C                     ELSE
     C                     SETOF                     81
     C                     END
     C*
     C** If network is 'PAPER' and non-ISO confs are to be produced
     C** set off 96
     C** tp suppress auto-transmission text on printout
     C*
     C           BGSWCL    IFEQ 'Y'
     C                     CALL 'AOMGMER0'
     C                     PARM '*MSG    '@RTCD
     C                     PARM '*FIRST  '@OPTN
     C           @MGME     PARM @MGME     DSFDY
     C*
     C           @RTCD     IFNE *BLANK
     C                     MOVEL'SDMGMEPD'DBFILE            *************
     C                     Z-ADD12        DBASE             * DBERR 12 **
     C                     SETON                     U7U8LR *************
     C                     EXSR *PSSR
     C                     END
     C*
     C           @NWRK     IFEQ 'PAPER'
     C           ENFFCR    ANDEQ'Y'
     C                     SETOF                     96
      ** - Don't output to LEEXT if ENFFCR is 'Y' & network is 'PAPER'                        207469
     C                     MOVE *OFF      *IN81                                               207469
     C                     ELSE
     C                     SETON                     96
     C                     END
     C*
     C                     ELSE
     C                     SETOF                     96
     C                     END
     C*
     C   U4 81 39          SETOF                     81
     C*                                                                   S01408
     C/COPY WNCPYSRC,LE1150CCP5                                           S01408
     C*                                                                   S01408
     C*
     C** If eq 'B' bypass alternate name & address validation
     C*
     C           NACD      IFNE 'B'
     C                     MOVE NACD      AZCD
     C                     CALL 'AOALTNR0'PLIST2
     C                     END
     C*
     C** If alternate name and address not found default to name and
     C** address on SDCUSTPD
     C*
     C           @RTCD     IFNE *BLANKS
     C           NACD      OREQ 'B'
     C                     MOVE BBCNA1    CNA1
     C                     MOVE BBCNA2    CNA2
     C                     MOVE BBCNA3    CNA3
     C                     MOVE BBCNA4    CNA4
     C                     END
     C*
     C** If customer confirmation field is not blank, and not a
     C** participations purchased, then access customer confirmation
     C** details and print name and address instead of loan customer
     C** name and address
     C*
     C********** COCU      IFNE *ZERO                                                         CSD027
     C           COCU      IFNE *BLANKS                                                       CSD027
     C           *IN35     ANDEQ'0'
     C           *IN36     ANDEQ'0'
     C                     MOVE CNA1      ONA1
     C                     MOVE CNA2      ONA2
     C                     MOVE CTWN      SVCTWN
     C                     MOVELCOCU      CKEY
     C*
     C** Call program to access customer details
     C*
     C                     CALL 'AOCUSTR0'PLIST1
     C*
     C** Database error if no record found
     C*
     C           @RTCD     IFNE *BLANKS
     C                     MOVEL'SDCUSTPD'DBFILE           ************
     C                     MOVELCKEY      DBKEY            * DBERR 08 *
     C                     Z-ADD08        DBASE            ************
     C                     SETON                     U7U8LR
     C                     EXSR *PSSR
     C                     GOTO ENDCON
     C                     ELSE
     C*
     C** Move file fields into output fields
     C*
     C                     MOVELBBCNA1    CNA1
     C                     MOVELBBCNA2    CNA2
     C                     MOVELBBCNA3    CNA3
     C                     MOVELBBCNA4    CNA4
     C                     MOVE SVCTWN    CTWN
     C                     END
     C                     ELSE
     C                     MOVE *BLANKS   ONA1
     C                     MOVE *BLANKS   ONA2
     C           *IN37     IFNE '1'
     C           *IN38     ANDNE'1'
     C                     MOVE CNA1      ONA1
     C                     MOVE CNA2      ONA2
     C                     END
     C                     END
     C*                                                                   070515
     C** If guarantees issued is active AND receiver of the guarantee     070515
     C** is not equal to zeros AND processing type is 70, print the       070515
     C** corresponding report name and town of the receiver of the        070515
     C** guarantee                                                        070515
     C*                                                                   070515
     C           *IN05     IFEQ '1'                                       070515
     C           *IN39     ANDEQ'1'                                       070515
     C********** RECE      ANDNE*ZEROS                                                 070515 CSD027
     C           RECE      ANDNE*BLANKS                                                       CSD027
     C                     MOVEL*BLANKS   CKEY                            070515
     C                     MOVE CTWN      SVCTWN                          070515
     C                     MOVELRECE      CKEY                            070515
     C*                                                                   070515
     C** Call program to access customer details                          070515
     C*                                                                   070515
     C                     CALL 'AOCUSTR0'PLIST1                          070515
     C*                                                                   070515
     C** Database error if no record found                                070515
     C*                                                                   070515
     C           @RTCD     IFNE *BLANKS                                   070515
     C                     MOVEL'SDCUSTPD'DBFILE           ************   070515
     C                     MOVELCKEY      DBKEY            * DBERR 20 *   070515
     C                     Z-ADD20        DBASE            ************   070515
     C                     SETON                     U7U8LR               070515
     C                     EXSR *PSSR                                     070515
     C                     GOTO ENDCON                                    070515
     C                     ELSE                                           070515
     C                     SETON                     06                   070515
     C***********          MOVELCRNM      RCRN   20                 070515S01518
     C                     MOVELCRNM      RCRN2  20                       S01518
     C                     MOVELCTWN      RCTW   10                       070515
     C                     MOVE SVCTWN    CTWN                            070515
     C                     END                                            070515
     C                     END                                            070515
     C*
     C** If participations purchased, access name and address of the
     C** original borrower
     C*
     C           *IN35     IFEQ '1'
     C           *IN36     OREQ '1'
     C                     MOVE CTWN      SVCTWN
     C                     MOVELOLNO      CKEY
     C*
     C** Call program to access customer details
     C*
     C                     CALL 'AOCUSTR0'PLIST1
     C*
     C** Database error if no record found
     C*
     C           @RTCD     IFNE *BLANKS
     C                     MOVEL'SDCUSTPD'DBFILE           ************
     C                     MOVELCKEY      DBKEY            * DBERR 17 *
     C                     Z-ADD17        DBASE            ************
     C                     SETON                     U7U8LR
     C                     EXSR *PSSR
     C                     GOTO ENDCON
     C                     ELSE
     C                     MOVE SVCTWN    CTWN
     C                     MOVE BBCNA1    CNA1
     C                     MOVE BBCNA2    CNA2
     C                     MOVE BBCNA3    CNA3
     C                     MOVE BBCNA4    CNA4
     C                     END
     C                     END
     C*
     C** If participations sold, access customer details for the name
     C** of the borrower
     C*
     C           *IN37     IFEQ '1'
     C           *IN38     OREQ '1'
     C                     MOVE CNA1      SVCNA1
     C                     MOVE CNA2      SVCNA2
     C                     MOVE CNA3      SVCNA3
     C                     MOVE CNA4      SVCNA4
     C                     MOVE CTWN      SVCTWN
     C                     MOVE 'A'       CLKEY2  7
     C                     MOVELOLNO      CLKEY2
     C*
     C** Chain to CLOAN using OLNO field
     C*
     C           CLKEY2    CHAINCLOAN2               99
     C*
     C** Database error if no record found
     C*
     C           *IN99     IFEQ '1'
     C                     MOVEL'CLOAN2  'DBFILE           ************
     C                     MOVELCLKEY2    DBKEY            * DBERR 13 *
     C                     Z-ADD13        DBASE            ************
     C                     SETON                     U7U8LR
     C                     EXSR *PSSR
     C                     GOTO ENDCON
     C                     ELSE
     C                     MOVELCNUM2     CKEY
     C*
     C** Call program to access customer details
     C*
     C                     CALL 'AOCUSTR0'PLIST1
     C*
     C** Database error if no record found
     C*
     C           @RTCD     IFNE *BLANKS
     C                     MOVEL'SDCUSTPD'DBFILE           ************
     C                     MOVELCKEY      DBKEY            * DBERR 17 *
     C                     Z-ADD17        DBASE            ************
     C                     SETON                     U7U8LR
     C                     EXSR *PSSR
     C                     GOTO ENDCON
     C                     ELSE
     C                     MOVE SVCTWN    CTWN
     C                     MOVE BBCNA1    ONA1
     C                     MOVE BBCNA2    ONA2
     C                     MOVE SVCNA1    CNA1
     C                     MOVE SVCNA2    CNA2
     C                     MOVE SVCNA3    CNA3
     C                     MOVE SVCNA4    CNA4
     C                     END
     C                     END
     C                     END
      *                                                                                       252771
      **  Prevent duplicate names on confo, no logic as to why two                            252771
      **  same customer names shd come out. Note that ONA1 & ONA2                             252771
      **  is set up for Parts Sold and Purchased and when customer                            252771
      **  confo is inserted                                                                   252771
      *                                                                                       252771
     C           CNA1      IFEQ ONA1                                                          252771
     C           CNA2      ANDEQONA2                                                          252771
     C                     MOVE *BLANKS   ONA1                                                252771
     C                     MOVE *BLANKS   ONA2                                                252771
     C                     END                                                                252771
     C*
     C   U4 81             ADD  1         NORET
      *                                                                   CLE004
      ** If CLE004 is ON, print confirmation only if consolidated         CLE004
      ** confirmation is 'Y' and non-system generated                     CLE004
      *                                                                   CLE004
     C           CLE004    IFEQ 'Y'                                       CLE004
     C           BPCONR    IFEQ 'N'                                       CLE004
     C***********MNSG      ANDEQ'M'                                 CLE004148729
     C                     MOVE '1'       *IN69                           CLE004
     C                     ELSE                                           CLE004
     C                     MOVE '0'       *IN69                           CLE004
     C                     ENDIF                                          CLE004
     C                     ELSE                                           CLE004
     C                     SETON                     69
     C                     ENDIF                                          CLE004
     C                     SETOF                     61
     C                     MOVE *OFF      *IN70                                               218782
     C                     MOVE *OFF      *IN21                                               218782
      *                                                                                       218782
      ** Do not convert amounts to settlement currency if Receipt Settl                       218782
      *  Method is 09 and System Value = 'T' for transaction ccy                              218782
     C           CLE033    IFNE 'Y'                                                           218782
     C           SET09     ORNE 'T'                                                           218782
     C           REC09     ORNE 'Y'                                                           218782
      *                                                                                       CLE031
      ** If CLE031 is on, format fields.                                                      CLE031
      *                                                                                       CLE031
     C           CLE031    IFEQ 'Y'                                                           CLE031
     C           *IN79     ANDEQ*OFF                                                          CLE031
     C           CCY       ANDNESCCY                                                          CLE031
     C           SCCY      ANDNE*BLANK                                                        CLE031
     C           CLE031    OREQ 'Y'                                                           CLE031
     C           *IN79     ANDEQ*OFF                                                          CLE031
     C           CCY       ANDNEPSCY                                                          CLE031
     C           PSCY      ANDNE*BLANK                                                        CLE031
      *                                                                                       CLE031
      ** Determine if receipt settlement currency is an In Currency.                          CLE031
      *                                                                                       CLE031
     C                     MOVE *OFF      *IN21                                               CLE031
     C           SCCY      IFNE *BLANKS                                                       CLE031
     C                     MOVE SCCY      K101                                                CLE031
     C                     CALL 'AOCURRR0'PLISTB                                              CLE031
     C           @RTCD     IFNE *BLANKS                                                       CLE031
     C                     Z-ADD28        DBASE                                               CLE031
     C                     MOVE 'SDCURRPD'DBFILE                                              CLE031
     C                     SETON                     U7U8LR                                   CLE031
     C                     EXSR *PSSR                                                         CLE031
     C                     GOTO ENDCON                                                        CLE031
     C                     ELSE                                                               CLE031
     C                     MOVE A6INCY    WRINC   1                                           CLE031
     C                     Z-ADDCDP       WRNDP   10                                          CLE031
     C                     MOVE SCCY      WCCY1   3                                           CLE031
     C           CDP       COMP 1                      0409                                   CLE031
     C           CDP       COMP 2                    12  10                                   CLE031
     C                     MOVE *ON       *IN21                                               CLE031
     C                     ENDIF                                                              CLE031
     C                     ENDIF                                                              CLE031
     C                     ENDIF                                                              218782
      *                                                                                       218782
      ** Do not convert amounts to settlement currency if Payment Settl                       218782
      *  Method is 09 and System Value = 'T' for transaction ccy                              218782
     C           CLE033    IFNE 'Y'                                                           218782
     C           SET09     ORNE 'T'                                                           218782
     C           PAY09     ORNE 'Y'                                                           218782
      *                                                                                       CLE031
      ** Determine if payment settlement currency is an In Currency.                          CLE031
      *                                                                                       CLE031
     C                     MOVE *OFF      *IN70                                               CLE031
     C           PSCY      IFNE *BLANKS                                                       CLE031
     C                     MOVE PSCY      K101                                                CLE031
     C                     CALL 'AOCURRR0'PLISTB                                              CLE031
     C           @RTCD     IFNE *BLANKS                                                       CLE031
     C                     Z-ADD29        DBASE                                               CLE031
     C                     MOVE 'SDCURRPD'DBFILE                                              CLE031
     C                     SETON                     U7U8LR                                   CLE031
     C                     EXSR *PSSR                                                         CLE031
     C                     GOTO ENDCON                                                        CLE031
     C                     ELSE                                                               CLE031
     C                     MOVE A6INCY    WPINC   1                                           CLE031
     C                     Z-ADDCDP       WPNDP   10                                          CLE031
     C                     MOVE PSCY      WCCY2   3                                           CLE031
     C           CDP       COMP 1                      1314                                   CLE031
     C           CDP       COMP 2                    26  15                                   CLE031
     C                     MOVE *ON       *IN70                                               CLE031
     C                     ENDIF                                                              CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
      ** Determine if loan currency is an In Currency.                                        CLE031
      *                                                                                       CLE031
     C                     MOVE CCY       K101                                                CLE031
     C                     CALL 'AOCURRR0'PLISTB                                              CLE031
     C           @RTCD     IFNE *BLANKS                                                       CLE031
     C                     Z-ADD30        DBASE                                               CLE031
     C                     MOVE 'SDCURRPD'DBFILE                                              CLE031
     C                     SETON                     U7U8LR                                   CLE031
     C                     EXSR *PSSR                                                         CLE031
     C                     GOTO ENDCON                                                        CLE031
     C                     ELSE                                                               CLE031
     C                     MOVE A6INCY    WLINC   1                                           CLE031
     C                     Z-ADDCDP       WLNDP   10                                          CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
      ** If processing a parts sold                                                           CLE031
      *                                                                                       CLE031
     C           PTYP      IFEQ 66                                                            CLE031
     C           PTYP      OREQ 67                                                            CLE031
     C           PTYP      OREQ 69                                                            CLE031
     C           PTYP      OREQ 72                                                            CLE031
      *                                                                                       CLE031
      ** Format first set of fields                                                           CLE031
      *                                                                                       CLE031
     C           CCY       IFNE PSCY                                                          CLE031
     C           PSCY      ANDNE*BLANK                                                        CLE031
      *                                                                                       CLE031
      ** If either loan or payment settlement currency is an In                               CLE031
      ** Currency, convert total amount by calling EU0200.                                    CLE031
      *                                                                                       CLE031
     C           WLINC     IFEQ 'Y'                                                           CLE031
     C           WPINC     OREQ 'Y'                                                           CLE031
     C                     Z-ADDTOTAL     PFRAM                                               CLE031
     C                     MOVE CCY       PFRCY                                               CLE031
     C                     MOVE PSCY      PTOCY                                               CLE031
      *                                                                                       CLE031
     C                     EXSR SRCONV                                                        CLE031
      *                                                                                       CLE031
     C                     Z-ADDPOUTA     WCAMT1 130                                          CLE031
     C                     ELSE                                                               CLE031
      *                                                                                       CLE031
      ** else, convert total amount to payment currency using                                 CLE031
      ** the payment settlement exchange rate.                                                CLE031
      *                                                                                       CLE031
     C                     Z-ADDTOTAL     ZAMTCI                                              CLE031
     C                     Z-ADDPEXR      ZEXCH                                               CLE031
     C                     MOVE CCY       ZCCYI                                               CLE031
     C                     MOVE PSCY      ZCCYO                                               CLE031
     C                     MOVE WLNDP     ZCDPI                                               CLE031
     C                     MOVE WPNDP     ZCDPO                                               CLE031
     C                     MOVE PEXI      ZMD                                                 CLE031
      *                                                                                       CLE031
     C                     EXSR ZCONV                                                         CLE031
      *                                                                                       CLE031
     C                     Z-ADDZAMTCO    WCAMT1                                              CLE031
     C                     ENDIF                                                              CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
      ** Format second set of fields                                                          CLE031
      *                                                                                       CLE031
     C           CCY       IFNE SCCY                                                          CLE031
     C           SCCY      ANDNE*BLANK                                                        CLE031
      *                                                                                       CLE031
      ** If either loan or receipt settlement currency is an In                               CLE031
      ** Currency, convert principal (or discount principal) by                               CLE031
      ** calling EU0200.                                                                      CLE031
      *                                                                                       CLE031
     C           WLINC     IFEQ 'Y'                                                           CLE031
     C           WRINC     OREQ 'Y'                                                           CLE031
     C                     Z-ADDCPAM      PFRAM                                               CLE031
     C                     MOVE CCY       PFRCY                                               CLE031
     C                     MOVE SCCY      PTOCY                                               CLE031
      *                                                                                       CLE031
     C                     EXSR SRCONV                                                        CLE031
      *                                                                                       CLE031
     C                     Z-ADDPOUTA     WCAMT2 130                                          CLE031
     C                     ELSE                                                               CLE031
      *                                                                                       CLE031
      ** else, convert principal (or discount principal) to                                   CLE031
      ** settlement currency using the receipt exchange rate.                                 CLE031
      *                                                                                       CLE031
     C                     Z-ADDCPAM      ZAMTCI                                              CLE031
     C                     Z-ADDREXR      ZEXCH                                               CLE031
     C                     MOVE CCY       ZCCYI                                               CLE031
     C                     MOVE SCCY      ZCCYO                                               CLE031
     C                     MOVE WLNDP     ZCDPI                                               CLE031
     C                     MOVE WRNDP     ZCDPO                                               CLE031
     C                     MOVE REXI      ZMD                                                 CLE031
      *                                                                                       CLE031
     C                     EXSR ZCONV                                                         CLE031
      *                                                                                       CLE031
     C                     Z-ADDZAMTCO    WCAMT2                                              CLE031
     C                     ENDIF                                                              CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
      ** Since 1st set of fields are of payment settlement details,                           CLE031
      ** and 2nd set are of Receipt, swap indicators.                                         CLE031
      *                                                                                       CLE031
     C                     MOVE PSCY      WCCY1                                               CLE031
     C                     MOVE SCCY      WCCY2                                               CLE031
     C                     MOVE *IN21     WIND0   1                                           CLE031
     C                     MOVE *IN70     *IN21                                               CLE031
     C                     MOVE WIND0     *IN70                                               CLE031
      *                                                                                       CLE031
     C                     MOVE *IN04     WIND0                                               CLE031
     C                     MOVE *IN09     WIND1   1                                           CLE031
     C                     MOVE *IN10     WIND2   1                                           CLE031
     C                     MOVE *IN12     WIND3   1                                           CLE031
      *                                                                                       CLE031
     C                     MOVE *IN13     *IN04                                               CLE031
     C                     MOVE *IN14     *IN09                                               CLE031
     C                     MOVE *IN15     *IN10                                               CLE031
     C                     MOVE *IN26     *IN12                                               CLE031
      *                                                                                       CLE031
     C                     MOVE WIND0     *IN13                                               CLE031
     C                     MOVE WIND1     *IN14                                               CLE031
     C                     MOVE WIND2     *IN15                                               CLE031
     C                     MOVE WIND3     *IN26                                               CLE031
      *                                                                                       CLE031
      ** Else if processing a non-parts sold                                                  CLE031
      *                                                                                       CLE031
     C                     ELSE                                                               CLE031
      *                                                                                       CLE031
      ** Format first set of fields                                                           CLE031
      *                                                                                       CLE031
     C           CCY       IFNE SCCY                                                          CLE031
     C           SCCY      ANDNE*BLANK                                                        CLE031
      *                                                                                       CLE031
      ** If either loan or receipt settlement currency is an In                               CLE031
      ** Currency, convert total amount by calling EU0200.                                    CLE031
      *                                                                                       CLE031
     C           WLINC     IFEQ 'Y'                                                           CLE031
     C           WRINC     OREQ 'Y'                                                           CLE031
     C                     Z-ADDTOTAL     PFRAM                                               CLE031
     C                     MOVE CCY       PFRCY                                               CLE031
     C                     MOVE SCCY      PTOCY                                               CLE031
      *                                                                                       CLE031
     C                     EXSR SRCONV                                                        CLE031
      *                                                                                       CLE031
     C                     Z-ADDPOUTA     WCAMT1                                              CLE031
     C                     ELSE                                                               CLE031
      *                                                                                       CLE031
      ** else, convert total amount to receipt currency using                                 CLE031
      ** the receipt settlement exchange rate.                                                CLE031
      *                                                                                       CLE031
     C                     Z-ADDTOTAL     ZAMTCI                                              CLE031
     C                     Z-ADDREXR      ZEXCH                                               CLE031
     C                     MOVE CCY       ZCCYI                                               CLE031
     C                     MOVE SCCY      ZCCYO                                               CLE031
     C                     MOVE WLNDP     ZCDPI                                               CLE031
     C                     MOVE WRNDP     ZCDPO                                               CLE031
     C                     MOVE REXI      ZMD                                                 CLE031
      *                                                                                       CLE031
     C                     EXSR ZCONV                                                         CLE031
      *                                                                                       CLE031
     C                     Z-ADDZAMTCO    WCAMT1                                              CLE031
     C                     ENDIF                                                              CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
      ** Format second set of fields                                                          CLE031
      *                                                                                       CLE031
     C           CCY       IFNE PSCY                                                          CLE031
     C           PSCY      ANDNE*BLANK                                                        CLE031
      *                                                                                       CLE031
      ** If either loan or pay settlement currency is an In Currency,                         CLE031
      ** convert the principal (or discount principal) by calling                             CLE031
      ** EU0200.                                                                              CLE031
      *                                                                                       CLE031
     C           WLINC     IFEQ 'Y'                                                           CLE031
     C           WPINC     OREQ 'Y'                                                           CLE031
     C                     Z-ADDCPAM      PFRAM                                               CLE031
     C                     MOVE CCY       PFRCY                                               CLE031
     C                     MOVE PSCY      PTOCY                                               CLE031
      *                                                                                       CLE031
     C                     EXSR SRCONV                                                        CLE031
      *                                                                                       CLE031
     C                     Z-ADDPOUTA     WCAMT2                                              CLE031
     C                     ELSE                                                               CLE031
      *                                                                                       CLE031
      ** else, convert principal (or discount principal) to                                   CLE031
      ** settlement currency using the pay exchange rate.                                     CLE031
      *                                                                                       CLE031
     C                     Z-ADDCPAM      ZAMTCI                                              CLE031
     C                     Z-ADDPEXR      ZEXCH                                               CLE031
     C                     MOVE CCY       ZCCYI                                               CLE031
     C                     MOVE PSCY      ZCCYO                                               CLE031
     C                     MOVE WLNDP     ZCDPI                                               CLE031
     C                     MOVE WPNDP     ZCDPO                                               CLE031
     C                     MOVE PEXI      ZMD                                                 CLE031
      *                                                                                       CLE031
     C                     EXSR ZCONV                                                         CLE031
      *                                                                                       CLE031
     C                     Z-ADDZAMTCO    WCAMT2                                              CLE031
     C                     ENDIF                                                              CLE031
     C                     ENDIF                                                              CLE031
     C                     ENDIF                                                              CLE031
     C                     ENDIF                                                              CLE031
     C                     ENDIF                                                              218782
     C*
     C                     EXSR EXCPT
     C                     SETOF                     25
     C                     SETOF                     06                   070515
     C*
     C           ENDCON    ENDSR                           ***  ENDCON  ***
     C*
      *****************************************************************                       CLE031
      *                                                               *                       CLE031
      *  SRCONV - Convert amounts to Euro ccy equivalent.             *                       CLE031
      *                                                               *                       CLE031
      *****************************************************************                       CLE031
      *                                                                                       CLE031
     C           SRCONV    BEGSR                                                              CLE031
      *                                                                                       CLE031
     C                     CALL 'EU0200'                                                      CLE031
     C                     PARM *BLANKS   PRTCD   7                                           CLE031
     C                     PARM           PFRAM  183                                          CLE031
     C                     PARM           PFRCY   3                                           CLE031
     C                     PARM           PTOCY   3                                           CLE031
     C                     PARM           POUTA  150                                          CLE031
     C                     PARM           PINTA  183                                          CLE031
     C                     PARM           PEXRT  159                                          CLE031
     C                     PARM           PMDIN   1                                           CLE031
      *                                                                                       CLE031
      ** Handle Error                                                                         CLE031
      *                                                                                       CLE031
     C           PRTCD     IFNE *BLANKS                                                       CLE031
     C                     MOVEL'EU0200  'DBFILE                                              CLE031
     C                     MOVEL'*CALL   'DBKEY                                               CLE031
     C                     Z-ADD31        DBASE                                               CLE031
     C                     SETON                     U7U8LR                                   CLE031
     C                     EXSR *PSSR                                                         CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
     C                     ENDSR                                                              CLE031
      /EJECT                                                                                  CLE031
     C*****************************************************************
     C*                                                               *
     C*  QNOSTR - Subroutine to get OUR nostro details                *
     C*                                                               *
     C*  Called by: CONF                                              *
     C*  Calls    : MOVEA, TABCHN, CLICHN                             *
     C*                                                               *
     C*****************************************************************
     C           QNOSTR    BEGSR                           ***  QNOSTR  ***
     C*
     C                     MOVE BLANK     CPNM
     C                     MOVE BLANK     CPTN
     C                     MOVE *BLANKS   CPORAC 25
     C*
     C** Set up title
     C*
     C                     Z-ADD1         A
     C                     MOVELPAYAT     ADDDS
     C                     EXSR MOVEA
     C*
     C  N39                MOVELVALDAT    ADDDS
     C   49N61N39
     CORN49 61             MOVELMATDAT    ADDDS
     C   39                MOVELFEEDUE    ADDDS
     C   79                MOVELROLDAT    ADDDS
     C  N89                MOVELROLDAT    ADDDS                           126453
     C                     EXSR MOVEA
     C*
     C  N61 51             MOVELTOURAC    ADD
     C   50 61
     COR 51 61
     COR 54
     COR 57                MOVEL'BY'      ADD
     C   50N61             MOVEL'TO'      ADD
     C                     EXSR MOVEA
     C*
     C** Set up narrative or name and town fields
     C** Settle. type 01 - get name & town from nostro & CLINT record  S
     C*
     C  N51                GOTO NONAME
     C*
     C** Is either CCY local and OURSELVES or nostro ind
     C** ON I.C.D. 2 blank
     C*
     C           CCY       COMP LOCY                     60
     C   18                SETOF                     60
     C   60                MOVELOURSEL    CPNM
     C   60                GOTO NONAME
     C*
     C** Is nostro code present
     C*
     C   51      NOS       COMP '  '                     67
     C   51N67   NOS       COMP '00'                     67
     C*
     C** If the settlement details field for OUR nostros is blank
     C** suppress the write to LEEXTAB.  Hence no message will be
     C** produced.
     C*
     C           *IN67     IFEQ '1'
     C           *IN51     ANDEQ'1'
     C                     MOVE '0'       *IN81
     C                     END
     C*
     C   51 67             GOTO NONAME
     C*
      *                                                                   CLE031
     C           CLE031    IFEQ 'N'                                       CLE031
      *                                                                   CEU004
     C           CEU004    IFEQ 'Y'                        If SAR On      CEU004
     C           SCCY      ANDNE*BLANKS                    And Stl Ccy    CEU004
     C                     MOVE SCCY      WKCCY   3         Set Ccy       CEU004
      *                                                                   CEU004
     C                     ELSE                            Else           CEU004
     C                     MOVE CCY       WKCCY             Set Ccy       CEU004
     C                     ENDIF                           End If         CEU004
      *                                                                   CEU004
     C                     ELSE                                           CLE031
      *                                                                   CLE031
     C                     MOVE CCY       WKCCY                           CLE031
     C           *IN61     IFEQ *OFF                                      CLE031
     C           SCCY      IFNE *BLANKS                                   CLE031
     C                     MOVE SCCY      WKCCY                           CLE031
     C                     ENDIF                                          CLE031
     C                     ELSE                                           CLE031
     C           PSCY      IFNE *BLANKS                                   CLE031
     C                     MOVE PSCY      WKCCY                           CLE031
     C                     ENDIF                                          CLE031
     C                     ENDIF                                          CLE031
      *                                                                   CLE031
      ** Set up currency for Loan Amendments                              CLE031
      *                                                                   CLE031
     C           *IN84     IFEQ *ON                                       CLE031
      *                                                                   CLE031
     C           AMTP      IFEQ 'PI'                                      CLE031
      *                                                                   CLE031
     C           PTYP      IFNE 66                                        CLE031
     C           PTYP      ANDNE67                                        CLE031
     C           PTYP      ANDNE69                                        CLE031
     C           PTYP      ANDNE72                                        CLE031
     C           PSCY      IFNE *BLANKS                                   CLE031
     C                     MOVE PSCY      WKCCY                           CLE031
     C                     ENDIF                                          CLE031
     C                     ELSE                                           CLE031
     C           SCCY      IFNE *BLANKS                                   CLE031
     C                     MOVE SCCY      WKCCY                           CLE031
     C                     ENDIF                                          CLE031
     C                     ENDIF                                          CLE031
      *                                                                   CLE031
     C                     ELSE                                           CLE031
      *                                                                   CLE031
     C           PTYP      IFNE 66                                        CLE031
     C           PTYP      ANDNE67                                        CLE031
     C           PTYP      ANDNE69                                        CLE031
     C           PTYP      ANDNE72                                        CLE031
     C           SCCY      IFNE *BLANKS                                   CLE031
     C                     MOVE SCCY      WKCCY                           CLE031
     C                     ENDIF                                          CLE031
     C                     ELSE                                           CLE031
     C           PSCY      IFNE *BLANKS                                   CLE031
     C                     MOVE PSCY      WKCCY                           CLE031
     C                     ENDIF                                          CLE031
     C                     ENDIF                                          CLE031
      *                                                                   CLE031
     C                     ENDIF                                          CLE031
      *                                                                   CLE031
     C                     ENDIF                                          CLE031
      *                                                                   CLE031
     C                     ENDIF                                          CLE031
      *                                                                   CLE031
     C** Access SDNOSTPD
     C*
     C***********          MOVE CCY       KEYB                            CEU004
     C                     MOVE WKCCY     KEYB             Set Key B      CEU004
     C                     MOVE NOS       KEYE
     C                     CALL 'AONOSTR0'PLISTC
     C           @RTCD     COMP *BLANKS                  07
     C  N07                MOVEL'NOSTRO'  ERM
     C  N07                MOVELERM       CPNM
     C  N07                GOTO ENDNOS
     C  N61      ORAC      COMP BLK25                1717
     C*
     C** Get client record.
     C*
     C           QCLINT    TAG                             ***  QCLINT ***
     C                     MOVELCNUMN     CKEY
     C   51                CALL 'AOCUSTR0'PLIST1
     C           @RTCD     COMP *BLANKS                  08
     C  N08                MOVEL'NOSTRO'  ERM
     C  N08                MOVELERM       CPNM
     C   08                MOVELCRNM      CPNM
     C   08                MOVELCTWN      CPTN
     C   08                MOVELORAC      CPORAC
     C*
     C           NONAME    TAG                             ***  NONAME ***
     C*
     C** Blank out 'OUR A/C WITH' if 'INSTRS.TO BE ADVISED' or
     C** 'OURSELVES' to be printed.
     C*
     C   51 60N61A         ADD  3         A
     C   51 60N61
     COR 51 67N61          EXSR MOVEA
     C*
     C   51 67
     COR 50                MOVELINSADV    CPNM
     C   50
     COR 51                GOTO ENDNOS
     C*
     C** Set up pay and receipt narratives
     C*
     C   54                MOVELAC        CPTN
     C   54                MOVE '-'       DASH
     C   54                MOVE SEQ       SEQX
     C   54                MOVE '-'       DASH2
     C   54                MOVE BRC       BRCX
     C   57                MOVELRETAC     CPTN
     C   61                GOTO QPAY
     C*
     C** Receipt narrative
     C*
     C           REC       TAG                             ***  REC    ***
     C   52                MOVELWAITR     CPNM
     C   55
     COR 53                MOVELPEROUR    CPNM
     C   55
     COR 53                MOVELASPER     CPNM
     C   54
     COR 57                MOVELDRTOAC    CPNM
     C   56                MOVELWECOL     CPNM
     C                     GOTO ENDNOS
     C*
     C** Pay narrative
     C*
     C           QPAY      TAG                             ***  QPAY   ***
     C   52                MOVELSENDR     CPNM
     C   52                MOVELSEND      CPNM
     C   55
     COR 53                MOVELPERYOR    CPNM
     C   54
     COR 57                MOVELCRTOAC    CPNM
     C   54
     COR 57                MOVEL'CRED'    CPNM
     C   56                MOVELYOUCOL    CPNM
     C   56                MOVEL'YOU'     CPNM
     C*
     C           ENDNOS    ENDSR                           ***  ENDNOS  ***
     C*
     C*****************************************************************
     C*                                                               *
     C*  CPNOS  - Subroutine to get THEIR nostro and FOR A/C OF       *
     C*           details                                             *
     C*                                                               *
     C*  Called by: CONF                                              *
     C*  Calls    : MOVEA, TABCHN, CLICHN                             *
     C*                                                               *
     C*****************************************************************
     C           CPNOS     BEGSR                           ***  CPNOS  ***
     C*
     C                     MOVE BLANK     CPNM
     C                     MOVE BLANK     CPTN
     C                     MOVE BLANK     ARRAY
     C*
     C** Set up title
     C*
     C                     Z-ADD1         A
     C                     MOVE 'BY'      PAY
     C   61                MOVE 'TO'      PAY
     C   50
     COR 51                MOVELPAY       ADD
     C                     EXSR MOVEA
     C*
     C** Set up name
     C*
     C           RETAC     COMP BLANK                    60
     C   50
     COR 51 60             MOVELAWAITA    CPNM
     C  N51
     COR 60                GOTO ENDCPN
     C*
     C** Settlement types 01,07,08 and nostro non-blank - get name
     C** and town from counterparty shortname or customer no.
     C** If the settlement field details field for their nostro
     C** is blank suppress the write to LEEXTAB.  Hence no message
     C** is produced
     C*
     C           CUSTNO    IFEQ *BLANKS
     C           *IN51     ANDEQ'1'
     C                     MOVE '0'       *IN81
     C                     END
     C*
     C           CUSTNO    COMP CNUMA                    60
     C   60                MOVELYERSEL    CPNM
     C   60                GOTO ENDCPN
     C                     MOVELCUSTNO    CKEY
     C                     CALL 'AOCUSTR0'PLIST1
     C           @RTCD     COMP *BLANKS                  08
     C   08                MOVELCRNM      CPNM
     C   08                MOVELCTWN      CPTN
     C  N08                MOVE CPSH      ARCD
     C  N08                CALL 'AOCNSTR0'PLISTF
     C  N08      @RTCD     COMP *BLANKS                  07
     C   07N08             MOVELAWCNTN    CPTN                          128142
     C  N07N08             MOVEL'NOSTRO'  ERM
     C  N07N08             MOVELERM       CPNM
     C*
     C           ENDCPN    ENDSR                           ***  ENDCPN  ***
     C*
     C*****************************************************************
     C*                                                               *
     C*  SETTYP - Subroutine to set indicators for settlement type    *
     C*                                                               *
     C*  Called by: CONF                                              *
     C*  Calls    : None                                              *
     C*                                                               *
     C*****************************************************************
     C           SETTYP    BEGSR                           ***  SETTYP  ***
     C                     SETOF                     5657
     C                     SETOF                     535455
     C           PCST      COMP 01                   525051
     C   52      PCST      COMP 03                   545253
     C   54      PCST      COMP 05                   535455
     C   53      PCST      COMP 07                     5351
     C  N51      PCST      COMP 08                   56  51
     C   56      PCST      COMP 14                     5657
      *                                                                   CLE033
      ** If CLE033 is on and Settle method is '09', do same processing    CLE033
      ** as Settle method '08'                                            CLE033
      *                                                                   CLE033
     C           CLE033    IFEQ 'Y'                                       CLE033
     C           PCST      ANDEQ09                                        CLE033
     C  N51      PCST      COMP 09                   56  51               CLE033
     C                     ENDIF                                          CLE033
      *                                                                   CLE033
     C                     ENDSR
     C*
     C*****************************************************************
     C*                                                               *
     C*  MOVEA  - Subroutine to insert words in narrative at variable *
     C*           position and keep count of next position.  See data *
     C*           structures                                          *
     C*                                                               *
     C*  Called by: CONF, NOSTRO, CPNOS                               *
     C*  Calls    : None                                              *
     C*                                                               *
     C*****************************************************************
     C           MOVEA     BEGSR                           ***  MOVEA  ***
     C                     MOVEAADD       AR,A
     C           A         ADD  LENGTH    A
     C                     MOVE BLANK     ADDDS
     C                     Z-ADD0         LENGTH
     C                     ENDSR
     C*
     C*****************************************************************
     C*                                                               *
     C*  INFOSR - Subroutine to store information about processing    *
     C*           and repayment type for CLOAN records                *
     C*                                                               *
     C*  Called by: Main processing                                   *
     C*  Calls    : None                                              *
     C*                                                               *
     C*****************************************************************
     C           INFOSR    BEGSR                           ***  INFOSR  ***
     C                     MOVE *BLANKS   WFLG    1                       159259
     C           PTYP      COMP 62                     3233
     C           PTYP      COMP 63                       34
     C           PTYP      COMP 64                       35
     C           PTYP      COMP 65                       36
     C           PTYP      COMP 66                       37
     C***********PTYP      COMP 67                   39  38               CLE005
     C           PTYP      COMP 67                       38               CLE005
     C           PTYP      COMP 70                       39               CLE005
      *                                                                                       CLE028
      ** For flat rate personal loans, processing and layout of report                        CLE028
      ** will be similar to term loans                                                        CLE028
      *                                                                                       CLE028
     C           CLE028    IFEQ 'Y'                                                           CLE028
     C           PTYP      ANDEQ80                                                            CLE028
     C                     MOVE *ON       *IN33                                               CLE028
     C                     ENDIF                                                              CLE028
      *                                                                                       CLE028
     C                     SETOF                     444546
     C                     SETOF                     4748
     C                     SETOF                     2283
      *                                                                   159259
     C           *IN35     IFEQ *ON                                       159259
     C           *IN36     OREQ *ON                                       159259
     C           *IN37     OREQ *ON                                       159259
     C           *IN38     OREQ *ON                                       159259
     C                     MOVE 'Y'       WFLG                            159259
     C                     ENDIF                                          159259
      *                                                                   CLE005
     C           CLE005    IFEQ 'Y'                                       CLE005
     C           PTYP      IFEQ 72                                        CLE005
     C                     MOVE PTYP      SPTYP   20                      CLE005
     C                     MOVE 'A'       CLKEY2                          CLE005
     C                     MOVELOLNO      CLKEY2                          CLE005
     C           CLKEY2    CHAINCLOAN2               62                   CLE005
     C           *IN62     IFEQ '1'                                       CLE005
     C                     MOVELOLNO      DBKEY            ***************CLE005
     C                     Z-ADD26        DBASE            * DB ERROR 23 *CLE005
     C                     MOVE 'CLOAN   'DBFILE           ***************CLE005
     C                     SETON                     U7U8LR               CLE005
     C                     GOTO ENDINF                                    CLE005
     C                     ENDIF                                          CLE005
      *                                                                   CLE005
     C           PTYP      IFEQ 70                                        CLE005
     C                     Z-ADD99        SPTYP                           CLE005
     C                     ENDIF                                          CLE005
     C                     MOVE SPTYP     PTYP                            CLE005
     C                     ENDIF                                          CLE005
      *                                                                   CLE005
     C                     MOVE '0'       *IN74                           CLE005
     C                     MOVE '0'       *IN76                           CLE005
      *                                                                   CLE005
     C           PTYP      IFEQ 71                                        CLE005
     C           PTYP      OREQ 72                                        CLE005
     C           PTYP      OREQ 99                                        CLE005
     C                     MOVE '1'       *IN39                           CLE005
     C                     MOVE '1'       *IN76                           CLE005
     C                     ENDIF                                          CLE005
      *                                                                   CLE005
     C           PTYP      IFEQ 68                                        CLE005
     C           PTYP      OREQ 69                                        CLE005
     C                     MOVE '1'       *IN45                           CLE005
     C                     MOVE '1'       *IN22                           CLE005
     C                     MOVE 'Y'       WFLG                            159259
     C                     ENDIF                                          CLE005
      *                                                                   CLE005
     C           PTYP      IFEQ 68                                        CLE005
     C                     MOVE '1'       *IN35                           CLE005
     C                     ENDIF                                          CLE005
      *                                                                   CLE005
     C           PTYP      IFEQ 69                                        CLE005
     C                     MOVE '1'       *IN37                           CLE005
     C                     MOVE '1'       *IN74                           CLE005
     C                     ENDIF                                          CLE005
      *                                                                   159259
     C           PTYP      IFEQ 71                                        159259
     C           PTYP      OREQ 72                                        159259
     C                     MOVE 'Y'       WFLG                            159259
     C                     ENDIF                                          159259
     C                     ENDIF                                          CLE005
      *                                                                   CLE005
     C   34N79
     COR 36
     COR 38                SETON                     44
     C   32
     COR 33
     COR 35
     COR 37                SETON                     45
     C   32
     COR 33
     COR 35                SETON                     22
     C*
     C** Set off ind. 22 if maturity date of CALL/DEMAND LOAN = 0.
     C*
     C   22      MDAT      IFLE 0
     C                     SETOF                     22
     C                     END                             END IF
     C*
     C** Store repayment type information
     C*
     C   45      REPT      COMP '1'                  47  46
     C   45 47   REPT      COMP '3'                    4748
     C***46******                                                         150995
     C*OR*48*****          SETOF                     45                   150995
     C***********          ENDSR                                          CLE005
     C           ENDINF    ENDSR                                          CLE005
     C*
     C*****************************************************************
     C*                                                               *
     C*  INTCAL - Subroutine to calculate interest and total amounts  *
     C*           for SP                                              *
     C*                                                               *
     C*  Called by: Main processing                                   *
     C*  Calls    : GLINTC                                            *
     C*                                                               *
     C*****************************************************************
     C           INTCAL    BEGSR                           ***  INTCAL  ***
     C*
     C                     Z-ADDVDAT      ZIBEG
     C                     Z-ADDICBS      ZICALC
     C                     Z-ADDCPAM      ZIAMT
     C                     Z-ADDINTR      ZIRATE
     C**********           Z-ADDVDAT      ZVDAT                                               245082
     C                     Z-ADDMDAT      ZMDAT                                               245082
     C/COPY WNCPYSRC,LEH01326
     C*****************************************************************                     AR826418
     C***If*a*repayment*schedule*exists*for*the*loan,*use*the*repayment                     AR826418
     C***value*date****************************************************                     AR826418
     C*****************************************************************                     AR826418
     C********** *IN88     IFEQ '1'                                                         AR826418
     C**********           Z-ADDRPDATE    ZIEND                                             AR826418
     C**********           SETOF                     88                                     AR826418
     C*****************************************************************                     AR826418
     C***else,*if*rollover*date*is*not*zero,*use*rollover*date*********                     AR826418
     C*****************************************************************                     AR826418
     C**********           ELSE                                                             AR826418
     C********** *IN89     IFNE '1'                                                         AR826418
     C**********           Z-ADDRLDT      ZIEND                                             AR826418
     C**********           ELSE                                                             AR826418
     C***else,*if*interest*pay*date*is*not*zero,*use*interest*pay*date                      AR826418
     C*****************************************************************                     AR826418
     C********** *IN29     IFNE '1'                                                         AR826418
     C**********           Z-ADDNIDT      ZIEND                                             AR826418
     C**********           ELSE                                                             AR826418
     C*****************************************************************                     AR826418
     C***else,*use*maturity*date***************************************                     AR826418
     C*****************************************************************                     AR826418
     C**********           Z-ADDMDAT      ZIEND                                             AR826418
     C**********           END                                                              AR826418
     C**********           END                                                              AR826418
     C**********           END                                                              AR826418
     C*
     C                     Z-ADDSLID      ZIBEG                                             AR826418
     C                     Z-ADD999999    WDATE   60                                        AR826418
      *                                                                                     AR826418
     C           MDAT      IFLE WDATE                                                       AR826418
     C           MDAT      ANDNE*ZEROS                                                      AR826418
     C                     Z-ADDMDAT      WDATE                                             AR826418
     C                     ENDIF                                                            AR826418
      *                                                                                     AR826418
     C           RPDATE    IFLE WDATE                                                       AR826418
     C           RPDATE    ANDNE*ZEROS                                                      AR826418
     C                     Z-ADDRPDATE    WDATE                                             AR826418
     C                     ENDIF                                                            AR826418
      *                                                                                     AR826418
     C           RLDT      IFLE WDATE                                                       AR826418
     C           RLDT      ANDNE*ZEROS                                                      AR826418
     C                     Z-ADDRLDT      WDATE                                             AR826418
     C                     ENDIF                                                            AR826418
      *                                                                                     AR826418
     C           NIDT      IFLE WDATE                                                       AR826418
     C           NIDT      ANDNE*ZEROS                                                      AR826418
     C                     Z-ADDNIDT      WDATE                                             AR826418
     C                     ENDIF                                                            AR826418
      *                                                                                     AR826418
     C           NRPD      IFLE WDATE                                                       AR826418
     C           NRPD      ANDNE*ZEROS                                                      AR826418
     C                     Z-ADDNRPD      WDATE                                             AR826418
     C                     ENDIF                                                            AR826418
      *                                                                                     AR826418
     C           WDATE     IFNE 999999                                                      AR826418
     C                     Z-ADDWDATE     ZIEND                                             AR826418
     C                     ENDIF                                                            AR826418
      *                                                                                     AR826418
     C                     SETOF                     88                                     AR826418
      *                                                                                     AR826418
     C********** ZIEND     IFLE 0                                                             240062
     C           MDAT      IFEQ 0                                                             240062
     C                     SETON                     83
     C                     END
     C*
     C                     EXSR ZFLAC
     C/COPY WNCPYSRC,LE1150C003
     C           CLE028    IFEQ 'Y'                                                           CLE028
     C           PTYP      ANDEQ80                                                            CLE028
     C                     Z-ADDFLTI      ZINTR                                               CLE028
     C                     ELSE                                                               CLE028
     C/COPY WNCPYSRC,LEH01402
     C                     EXSR GLINTC
     C                     ENDIF                                                              CLE028
     C/COPY WNCPYSRC,LE1150C004
      *                                                                                       CLE028
      ** For Flat rate personal loans, add the charge amount to the                           CLE028
      ** principal if Add on charges flag is 'Y'                                              CLE028
      *                                                                                       CLE028
     C           CLE028    IFEQ 'Y'                                                           CLE028
     C           PTYP      ANDEQ80                                                            CLE028
     C           ADCF      ANDEQ'Y'                                                           CLE028
     C                     ADD  CHGA      CPAM                                                CLE028
     C                     ENDIF                                                              CLE028
     C*
     C** Round down interest if required
     C*
     C           RDFC      COMP 'Y'                      60
     C           CLE028    IFEQ 'Y'                                                           CLE028
     C           PTYP      ANDEQ80                                                            CLE028
     C                     MOVE *OFF      *IN60                                               CLE028
     C                     ENDIF                                                              CLE028
     C  N60                Z-ADDZINTR     TOTINT 130H
     C   60                Z-ADDZINTR     TOTINT
     C           CPAM      ADD  TOTINT    TOTAL
     C*
     C                     ENDSR
     C*
     C*****************************************************************
     C*                                                               *
     C*  UPDATE - Subroutine to update LTRIX and CLOAN files          *
     C*                                                               *
     C*  Called by: Main processing                                   *
     C*  Calls    : TIME, EXCPT, CLCHN, LTRCHN                        *
     C*                                                               *
     C*****************************************************************
     C           UPDATE    BEGSR                           ***  UPDATE  ***
     C*
      ** Suppress update of TNLU field as this is of no use, only                            BUG4488
      ** causes trigger of LTRIX to send blank 'LECONF' data                                 BUG4488
     C**********           EXSR ZTNLU1                                                       BUG4488
     C*                                                                   S01408
     C/COPY WNCPYSRC,LE1150CCP6                                           S01408
     C*                                                                   S01408
     C   68NU3NLR          GOTO DTDET
     C   LR                GOTO DTHEAD
     C*
     C** Get CLOAN record
     C*
     C                     SETON                     58
     C                     EXSR CLCHN
     C   LR                Z-ADD11        DBASE            ************
     C   LR                MOVEL'CLOAN   'DBFILE           * DBERR 11 *
     C   LR                MOVELCLKEY     DBKEY            ************
     C   LR                GOTO ENDLOG
     C*
     C** CLOAN record update
     C*
     C                     BITON'01'      CNFI
     C   79                BITON'2'       CNFI
     C                     SETON                     72
     C                     EXSR TIME
     C                     EXSR EXCPT
     C           DTDET     TAG                             ***  DTDET  ***
     C*
     C** Get LTRIX detail record for update
     C*
     C**********           EXSR LTRCHN                                                      AR322732
     C  N02                SETON                     U7U8LR
     C  N02                Z-ADD14        DBASE            ************
     C  N02                MOVELRRN       DBKEY            * DBERR 14 *
     C  N02                MOVEL'LTRIX   'DBFILE           ************
     C  N02                GOTO ENDLOG
     C   68NU3NLR          GOTO DTHEAD
     C*
     C           DTHEAD    TAG                             ***  DTHEAD ***
     C***LR*****           Z-ADD1         RRN                                               AR322732
     C***LR*****           EXSR LTRCHN                                                      AR322732
     C                     SETON                     01                                     AR322732
     C  N01 LR             Z-ADD15        DBASE            ************
     C  N01 LR             MOVEL'LTRIX   'DBFILE           * DBERR 15 *
     C  N01 LR             MOVELRRN       DBKEY            ************
     C  N01 LR             GOTO ENDLOG
     C*
     C** LTRIX record update
     C*
     C**********           SETON                     73                                     AR322732
     C      LR             SETOF                     75                                     AR322732
     C                     EXSR TIME
     C                     EXSR EXCPT
     C*
     C** End COMIT cycle
     C*
     C                     COMIT
     C           ENDLOG    ENDSR                           ***  ENDLOG  ***
     C*
     C*****************************************************************
     C*                                                               *
     C*  HDRCHN - Subroutine to access LTRIX relative file header     *
     C*           record and dummy update/lock to prevent external    *
     C*           update                                              *
     C*                                                               *
     C*  Called by: Main processing                                   *
     C*  Calls    : None                                              *
     C*                                                               *
     C*****************************************************************
     C           HDRCHN    BEGSR                           ***  HDRCHN  ***
     C*
     C                     SETOF                     010260
     C********** RRN       CHAINLTRIX                60                                     AR322732
     C**N60*****           EXCPTRECLCK                                                      AR322732
     C*
     C  N60                SETOF                     010260
     C**N60***** RRN       CHAINLTRIX                60                                     AR322732
     C*
     C                     ENDSR
     C*
     C*****************************************************************
     C*                                                               *
     C*  LTRCHN - Subroutine to chain to LTRIX file                   *
     C*                                                               *
     C*  Called by: Main processing, UPDATE                           *
     C*  Calls    : None                                              *
     C*                                                               *
     C*****************************************************************
     C           LTRCHN    BEGSR                           ***  LTRCHN  ***
     C                     SETOF                     010260
     C********** RRN       CHAINLTRIX                60                                     AR322732
     C**********           READ LTRIX                    LR                        AR322732 AR650589
     C                     READ LTRIX                  28LR                                 AR650589
     C           *IN28     IFEQ '1'                                                         AR650589
     C           WLXSTS    ANDEQ01218                                                       AR650589
     C                     SETON                     LR                                     AR650589
     C                     ENDIF                                                            AR650589
     C                     ENDSR
     C*
     C*****************************************************************
     C*                                                               *
     C*  CLCHN  - Subroutine to chain to CLOAN file                   *
     C*                                                               *
     C*  Called by: Main processing, UPDATE                           *
     C*  Calls    : None                                              *
     C*                                                               *
     C*****************************************************************
     C           CLCHN     BEGSR                           ***  CLCHN  ***
     C                     SETOF                     606103
     C*
     C** Set up CLOAN key
     C*
     C                     MOVELLNRF      CLKEY   7
     C                     MOVE 'A'       CLKEY
     C           CHAIN     TAG                             ***  CHAIN  ***
     C           CLKEY     CHAINCLOAN                60
     C   58
     COR 61                GOTO ENDCHN
     C   03                MOVE 'B'       CLKEY
     C   03                SETON                     61
     C   03                GOTO CHAIN
     C           ENDCHN    TAG                             ***  ENDCHN  ***
     C  N03                SETON                     U7U8LR
     C                     SETOF                     58
     C                     ENDSR
     C*
     C*****************************************************************
     C*                                                               *
     C*  LOCHN -  Subroutine to chain to LF/LOAMS if there is a       *
     C*           corresponding record for the loan being processed   *
     C*                                                               *
     C*  Called by: Main processing                                   *
     C*  Calls    : None                                              *
     C*                                                               *
     C*****************************************************************
     C           LOCHN     BEGSR                           ***  LOCHN  ***
     C*
     C                     SETOF                     87
     C*
     C           LNRF      SETLLLOAMS                    84
     C*
     C** If an equal loan reference has been read, check if amendment
     C** type is 'RE'.   If it is, store the repayment value date to be
     C** used later in the calculation.
     C*
     C           *IN84     IFEQ '1'
     C           LNRF      READELOAMS                    86
     C           *IN86     DOWEQ'0'
     C           *IN87     ANDEQ'0'
     C           AMTP      IFEQ 'RE'
     C                     SETON                     8887
     C                     Z-ADDVDATLO    RPDATE  50
     C                     END
     C           LNRF      READELOAMS                    86
     C                     END
     C                     END
     C*
     C                     ENDSR
      *                                                                   138866
      *****************************************************************   138866
      *                                                               *   138866
      *  SRLOAM - Subroutine to chain to LF/LOAMS if there is a       *   138866
      *           corresponding record for the loan being processed   *   138866
      *                                                               *   138866
      *  Called by: Main processing                                   *   138866
      *  Calls    : None                                              *   138866
      *                                                               *   138866
      *****************************************************************   138866
     C           SRLOAM    BEGSR                                          138866
      *                                                                   138866
     C                     MOVE *OFF      *IN87                           138866
      *                                                                   138866
     C           LNRF      SETLLLOAMS                    84               138866
      *                                                                   138866
      ** If an equal loan reference has been read, check if amendment     138866
      ** type is 'PT' and value date match with the start date of the     138866
      ** original loan.  Store the principal amount of the loan amendment 138866
      ** to the current principal amount of the loan, if it is zero.      138866
      *                                                                   138866
     C           *IN84     IFEQ *ON                                       138866
     C           LNRF      READELOAMS                    86               138866
     C           *IN86     DOWEQ*OFF                                      138866
     C           *IN87     ANDEQ*OFF                                      138866
     C           AMTP      IFEQ 'PT'                                      138866
     C           VDATLO    ANDEQSLID                                      138866
     C           NRLI      ANDEQ'Y'                                       138866
     C                     Z-ADDPRAM      CPAM                            138866
     C                     MOVE *ON       *IN87                           138866
     C                     ENDIF                                          138866
     C           LNRF      READELOAMS                    86               138866
     C                     END                                            138866
     C                     END                                            138866
      *                                                                   138866
     C                     ENDSR                                          138866
     C*
     C*****************************************************************
     C*                                                               *
     C*  EXCPT  - Subroutine to handle exception time output          *
     C*                                                               *
     C*  Called by: Main processing, UPDATE, CONF                     *
     C*  Calls    : None                                              *
     C*                                                               *
     C*****************************************************************
     C           EXCPT     BEGSR                           ***  EXCPT  ***
     C/COPY WNCPYSRC,LE1150C006
     C                     EXCPT
     C/COPY WNCPYSRC,LE1150C007
     C                     SETOF                     69
     C                     SETOF                     7273
     C                     SETOF                     7577
     C   U4 82             SETOF                     82
     C                     ENDSR
     C*
     C*****************************************************************
     C*                                                               *
     C*  TIME   - Subroutine to obtain time                           *
     C*                                                               *
     C*  Called by: UPDATE                                            *
     C*  Calls    : None                                              *
     C*                                                               *
     C*****************************************************************
     C           TIME      BEGSR                           ***  TIME   ***
     C                     TIME           MTIME   60
     C                     ENDSR
     C*
     C*****************************************************************
     C*                                                               *
     C*  GETBR  - Subroutine added for 150987 JSM08.  It accesses the *
     C*           the correct base rate of the rollover discount loan *
     C*                                                               *
     C*  Called by: CONF                                              *
     C*  Calls    : None                                              *
     C*                                                               *
     C*****************************************************************
     C           GETBR     BEGSR                           ***  GETBR  ***
     C*
     C                     MOVE CCY       BKEY1
     C                     MOVE NBRA      BKEY2
     C                     CALL 'AOBSRTR0'PLIST3
     C*
     C           @RTCD     COMP *BLANKS                  07
     C  N07                SETON                     U7U8LR
     C  N07                MOVEL'SDBSRTPD'DBFILE           ************
     C  N07                Z-ADD19        DBASE            * DBERR 19 *
     C  N07                MOVELBKEY1     WRK5    5        ************
     C  N07                MOVE BKEY2     WRK5
     C  N07                MOVELWRK5      DBKEY
     C  N07                GOTO ENDBR
     C*
     C** Set up relevant base rate
     C*
     C           BAVDNR    COMP RLDT                   6060
     C   60                Z-ADDBANBRT    BASER            NEXT BASE RATE
     C  N60                Z-ADDBACBSR    BASER            CUR. BASE RATE
     C*
     C           ENDBR     ENDSR                           ***  ENDBR  ***
     C*
     C/EJECT                                                              133683
     C*****************************************************************   133683
     C***********                                                     *   133683
     C***ROUT***- Subroutine to determine message routing             *   133683
     C***********                                                     *   133683
     C***Called*by: Main processing                                   *   133683
     C***Calls*** : NWAD, PRAD                                        *   133683
     C***********                                                     *   133683
     C*****************************************************************   133683
     C***********ROUT      BEGSR                                          133683
     C***********                                                         133683
     C***Access*branch details with Branch code of sender                 133683
     C***********                                                         133683
     C***********          CALL 'AOBRCHR0'                                133683
     C***********          PARM '*MSG   ' @RTCD                           133683
     C***********          PARM '*KEY   ' @OPTN                           133683
     C***********          PARM @DSNB     @BRCD   3                       133683
     C***********SDBRCH    PARM SDBRCH    DSSDY                           133683
     C***********                                                         133683
     C***Branch*record not found - Error                                  133683
     C***********                                                         133683
     C***********@RTCD     IFNE *BLANKS                                   133683
     C***********          Z-ADD31        DBASE            ************   133683
     C***********          MOVEL@DSNB     DBKEY            * DBERR 31 *   133683
     C***********          MOVEL'SDBRCHPD'DBFILE           ************   133683
     C***********          EXSR *PSSR                                     133683
     C***********          END                                            133683
     C***********                                                         133683
     C***Save*branch internal customer number & SWIFT TID addres          133683
     C***********                                                         133683
     C***********          MOVELA8BICN    SECN    60                      133683
     C***********          MOVE A8BTID    SCSID  12                       133683
     C***********                                                         133683
     C*** Access*SDCUSTPD using branch internal customer number           133683
     C***********                                                         133683
     C***********          MOVE *BLANKS   @KEY1                           133683
     C***********          MOVELSECN      @KEY1                           133683
     C***********          CALL 'AOCUSTR0'                                133683
     C***********          PARM '*MSG   ' @RTCD                           133683
     C***********          PARM '*KEY   ' @OPTN                           133683
     C***********          PARM           @KEY1  10                       133683
     C***********          PARM *BLANKS   @KYST   7                       133683
     C***********@CUST     PARM @CUST     DSSDY                           133683
     C***********                                                         133683
     C***Customer record not found - Error                                133683
     C***********                                                         133683
     C***********@RTCD     IFNE *BLANKS                                   133683
     C***********          Z-ADD32        DBASE            ************   133683
     C***********          MOVEL@KEY1     DBKEY            * DBERR 32 *   133683
     C***********          MOVEL'SDCUSTPD'DBFILE           ************   133683
     C***********          EXSR *PSSR                                     133683
     C***********          END                                            133683
     C***********                                                         133683
     C***Save*sender's addresses & parent customer number                 133683
     C***********                                                         133683
     C***********          MOVE TELX      @TELX  12                       133683
     C***********          MOVE BBSTAD    @STTX  12                       133683
     C***********                                                         133683
     C***Access*SDCUSTPD using destination customer number                133683
     C***********                                                         133683
     C***********          MOVE *BLANKS   @KEY1                           133683
     C***********          MOVEL@CUST     @KEY1                           133683
     C***********          CALL 'AOCUSTR0'                                133683
     C***********          PARM '*MSG   ' @RTCD                           133683
     C***********          PARM '*KEY   ' @OPTN                           133683
     C***********          PARM           @KEY1  10                       133683
     C***********          PARM *BLANKS   @KYST   7                       133683
     C***********@CUST     PARM @CUST     DSSDY                           133683
     C***********                                                         133683
     C***Determine the routing to the destination customer.               133683
     C***********                                                         133683
     C***********BBDNW3    IFNE *BLANKS                                   133683
     C***********          EXSR NWAD                                      133683
     C***********          ELSE                                           133683
     C***********          EXSR PRAD                                      133683
     C***********          END                                            133683
     C***********                                                         133683
     C***********          ENDSR                                          133683
     C***********                                                         133683
     C/EJECT                                                              133683
      *****************************************************************   133683
      *   SRROUT - determine message routing                          *   133683
      *   Called by - CONF                                            *   133683
      *   Calls -                                                     *   133683
      *****************************************************************   133683
      *                                                                   133683
     C           SRROUT    BEGSR                                          133683
      *                                                                   133683
     C                     MOVELBRCA      I@SNBR                          133683
     C                     MOVELCNUM      I@DSCN                          133683
     C                     MOVEL*BLANKS   I@MTPY                          133683
     C                     Z-ADD0         I@SETT                          133683
     C                     MOVEL'Y'       I@CONC                          133683
     C                     MOVEL*BLANK    I@FTCS                          133683
     C                     MOVEL'LE'      I@MMOD                          133683
      *                                                                   133683
     C                     CALL 'MG9900'                                  133683
     C                     PARM *BLANKS   @RTCD                           133683
     C                     PARM           P@IN                            133683
     C                     PARM *BLANKS   P@OUT                           133683
     C                     PARM           P@ZZ  256                       133683
      *                                                                   133683
     C           @RTCD     IFNE *BLANKS                                   133683
     C                     MOVEL'MG9900  'DBFILE           ************   133683
     C                     MOVEL'*CALL'   DBKEY            * DBERR 92 *   133683
     C                     Z-ADD92        DBASE            ************   133683
     C                     SETON                     U7U8LR               133683
     C                     EXSR *PSSR                                     133683
     C                     ELSE                                           133683
     C**********           Z-ADDO@CNSN    SECN    60                                   133683 CPK028
     C                     MOVELO@SWSN    SCSID  12                       133683
     C                     MOVELO@NWRK    @NWRK   6                       133683
     C                     END                                            133683
      *                                                                   133683
     C                     ENDSR                                          133683
     C/EJECT                                                              133683
     C*****************************************************************   133683
     C***********                                                     *   133683
     C***NWAD***- Subroutine to determine default network addresses   *   133683
     C***********                                                     *   133683
     C***Called*by: ROUT                                              *   133683
     C***Calls*** : None                                              *   133683
     C***********                                                     *   133683
     C*****************************************************************   133683
     C***********NWAD      BEGSR                           ***  NWAD  *** 133683
     C***********                                                         133683
     C***Default*is SWIFT                                                 133683
     C***********                                                         133683
     C***********BBDNW3    IFEQ 'SWIFT'                                   133683
     C***********CSID      ANDNE*BLANKS                                   133683
     C***********@BIC      ANDNE'BIC'                                     133683
     C***********BGMSDL    ANDEQ'Y'                                       133683
     C***********          MOVELBBDNW3    @NWRK   6                       133683
     C***********          END                                            133683
     C***********                                                         133683
     C***Default*is TELEX                                                 133683
     C***********                                                         133683
     C***********BBDNW3    IFEQ 'TELEX'                                   133683
     C***********TELX      ANDNE*BLANKS                                   133683
     C***********BGMTMI    ANDEQ'Y'                                       133683
     C***********          MOVE BBDNW3    @NWRK                           133683
     C***********          END                                            133683
     C***********                                                         133683
     C***Default*is STTX                                                  133683
     C***********                                                         133683
     C***********BBDNW3    IFEQ 'STTX'                                    133683
     C***********BBSTAD    ANDNE*BLANKS                                   133683
     C***********BGMSDL    ANDEQ'Y'                                       133683
     C***********          MOVE BBDNW3    @NWRK                           133683
     C***********          END                                            133683
     C***********                                                         133683
     C***Default*is PAPER                                                 133683
     C***********                                                         133683
     C***********BBDNW3    IFEQ 'PAPER'                                   133683
     C***********          MOVE BBDNW3    @NWRK                           133683
     C***********          END                                            133683
     C***********                                                         133683
     C***Found*to be unroutable                                           133683
     C***********                                                         133683
     C***********@NWRK     IFEQ *BLANKS                                   133683
     C***********          MOVEL'UNROUT'  @NWRK                           133683
     C***********          END                                            133683
     C***********                                                         133683
     C***********          ENDSR                                          133683
     C***********                                                         133683
     C*****************************************************************   133683
     C***********                                                     *   133683
     C***PRAD***- Subroutine to determine priority network addresses  *   133683
     C***********                                                     *   133683
     C***Called*by: ROUT                                              *   133683
     C***Calls*** : TXROUT, SWROUT                                    *   133683
     C***********                                                     *   133683
     C*****************************************************************   133683
     C***********PRAD      BEGSR                           ***  PRAD  *** 133683
     C***********                                                         133683
     C***If*STTX/Telex has higher priority than SWIFT attempt             133683
     C***STTX/Telex routing first, followed by SWIFT. (nb. 'Higher'       133683
     C***priority is numerically lower ie. '1' is higher than '2')        133683
     C***********BLTXPY    IFLT BLSWPY                                    133683
     C***********          EXSR TXROUT                                    133683
     C***********          EXSR SWROUT                                    133683
     C***********                                                         133683
     C***otherwise attempt SWIFT routing first                            133683
     C***********                                                         133683
     C***********          ELSE                                           133683
     C***********          EXSR SWROUT                                    133683
     C***********          EXSR TXROUT                                    133683
     C***********          END                                            133683
     C***********                                                         133683
     C***If*failed to route to electronic network, produce paper          133683
     C***********                                                         133683
     C***********@NWRK     IFEQ *BLANKS                                   133683
     C***********          MOVEL'PAPER'   @NWRK                           133683
     C***********          END                                            133683
     C***********                                                         133683
     C***********          ENDSR                                          133683
     C***********                                                         133683
     C*****************************************************************   133683
     C***********                                                     *   133683
     C***TXROUT*- Subroutine to attempt priority routing to STTX/     *   133683
     C*********** Telex, if not already routed                        *   133683
     C***********                                                     *   133683
     C***Called*by: PRAD                                              *   133683
     C***Calls**  : None                                              *   133683
     C***********                                                     *   133683
     C*****************************************************************   133683
     C***********TXROUT    BEGSR                           ***  TXROUT  **133683
     C***********                                                         133683
     C***If*not*already routed, attempt STTX/Telex routing                133683
     C***********                                                         133683
     C***********@NWRK     IFEQ *BLANKS                                   133683
     C***********                                                         133683
     C***Note*that STTX and Telex are mutually exclusive - try both       133683
     C***********                                                         133683
     C***********BGMSDL    IFEQ 'Y'                                       133683
     C***********BBSTAD    ANDNE*BLANKS                                   133683
     C***********@STTX     ANDNE*BLANKS                                   133683
     C***********          MOVEL'STTX'    @NWRK                           133683
     C***********          END                                            133683
     C***********                                                         133683
     C***********BGMTMI    IFEQ 'Y'                                       133683
     C***********TELX      ANDNE*BLANKS                                   133683
     C***********@TELX     ANDNE*BLANKS                                   133683
     C***********          MOVEL'TELEX'   @NWRK                           133683
     C***********          END                                            133683
     C***********                                                         133683
     C***********          END                                            133683
     C***********                                                         133683
     C***********          ENDSR                                          133683
     C***********                                                         133683
     C*****************************************************************   133683
     C***********                                                     *   133683
     C***SWROUT*- Subroutine to attempt priority routing to SWIFT     *   133683
     C*********** if not already routed                               *   133683
     C***********                                                     *   133683
     C***Called*by: PRAD                                              *   133683
     C***Calls*** : None                                              *   133683
     C***********                                                     *   133683
     C*****************************************************************   133683
     C***********SWROUT    BEGSR                           ***  SWROUT  **133683
     C***********                                                         133683
     C***If*not*already routed, attempt SWIFT routing                     133683
     C***********                                                         133683
     C***********@NWRK     IFEQ *BLANKS                                   133683
     C***********BGMSDL    ANDEQ'Y'                                       133683
     C***********CSID      ANDNE*BLANKS                                   133683
     C***********SCSID     ANDNE*BLANKS                                   133683
     C***********@BIC      ANDNE'BIC'                                     133683
     C***********          MOVEL'SWIFT'   @NWRK                           133683
     C***********          END                                            133683
     C***********                                                         133683
     C***********          ENDSR                                          133683
     C*
     C/EJECT
      /COPY ZSRSRC,ZDATE2Z4
      /COPY ZSRSRC,ZFLACZ2
     C*****************************************************************
     C*                                                               *
     C*  ZSYSTM - Subroutine to chain to the installation control     *
     C*           data record                                         *
     C*                                                               *
     C*  Called by: Main processing                                   *
     C*  Calls    : None                                              *
     C*                                                               *
     C*****************************************************************
     C           ZSYSTM    BEGSR                           ***  ZSYSTM  ***
     C*
     C** Access bank details
     C*
     C                     CALL 'AOBANKR0'PLISTA
     C           @RTCD     COMP *BLANKS              9999
     C*
     C** Check system date format, DDMMYY or MMDDYY.
     C*
     C           BJDFIN    COMP 'M'                      98MMDDYY, 98 ON
      *                                                                   CEU004
      ** Access SAR details file to see if CEU004 is installed            CEU004
      *                                                                   CEU004
     C                     MOVE 'N'       CEU004           Set SAR Flag   CEU004
      *                                                                   CEU004
     C                     CALL 'AOSARDR0'                 Rtv SAR Dtls   CEU004
      *                                                    Input:         CEU004
     C                     PARM '       ' P@RTCD  7        -Return Code   CEU004
     C                     PARM '*VERIFY' P@OPTN  7        -Option        CEU004
     C                     PARM 'CEU004'  P@SARD  6        -SAR No        CEU004
      *                                                    Output:        CEU004
     C           SCSARD    PARM SCSARD    DSFDY            -Format        CEU004
      *                                                                   CEU004
     C           P@RTCD    IFEQ *BLANK                     If Found       CEU004
     C                     MOVE 'Y'       CEU004  1         Set SAR Flag  CEU004
      *                                                                   CEU004
     C                     ELSE                            Else           CEU004
     C           P@RTCD    IFNE '*NRF   '                   If # NoRecFnd CEU004
     C                     MOVEL'SCSARDPD'DBFILE             Set File     CEU004
     C                     MOVEL'*VERIFY' DBKEY              Set Key      CEU004
     C                     Z-ADD40        DBASE              Set DBase RefCEU004
     C                     SETON                     U7U8LR  Set Ind      CEU004
     C                     SETON                     99      Set Ind      CEU004
     C                     EXSR *PSSR                        Dump         CEU004
     C                     ENDIF                            End If        CEU004
     C                     ENDIF                           End If         CEU004
      *                                                                   CEU004
     C                     ENDSR
     C*
     C********************************************************************
      /COPY ZSRSRC,ZTNLU1Z2
      /COPY ZSRSRC,GLINTCZ1
      /COPY ZSRSRC,ZSAVEZ1
      /COPY ZSRSRC,ZRSTORZ1
     C*****************************************************************
     C*                                                               *
     C* *PSSR   - Subroutine to handle abnormal error conditions      *
     C*                                                               *
     C* CALLED by: After abnormal operation occurs                    *
     C* CALLS    : None                                               *
     C*                                                               *
     C*****************************************************************
     C           *PSSR     BEGSR                           ***  PSSR  ***
     C*
     C           @RUN      IFEQ *BLANKS
     C                     MOVE 'Y'       @RUN    1
     C                     DUMP
     C                     END
     C*
     C                     ENDSR
     C*
     C/COPY WNCPYSRC,LE1150C002
     C********************************************************************
      /EJECT
     C/COPY ZSRSRC,ZINTDYZ2
      /EJECT
     C/COPY ZSRSRC,ZDATE9Z3
     C/COPY ZSRSRC,ZDAT10Z2                                               126017
     C/EJECT
     C/COPY ZSRSRC,ZCONVZ1                                                                    CLE031
     C/EJECT                                                                                  CLE031
     O*
     O** Confirmations Report
     O** Print branch name if required
     O*
     O*                                                                   S01408
     O/COPY WNCPYSRC,LE1150OOP1                                           S01408
     O*                                                                   S01408
     OLE1150P1E  202   69 16 71
     O       AND       11
     O                         BRNM   B  62
     O*
     O** Confirmation name and type
     O*
     O/COPY WNCPYSRC,LE1150O016
     O********E**2     69 71                                                                  252771
     O************             CNAME     72                                                   252771
     O************        79             92 'ROLLOVER'                                        252771
     O************        64             92 '- CANCELLATION'                                  252771
     O************        65N79          89 '- AMENDMENT'                                     252771
     O************        63            102 'COPY'                                            252771
     O        E  2     69 71 11                                                               252771
     O                         CNAME     72                                                   252771
     O                    79             92 'ROLLOVER'                                        252771
     O                    64             92 '- CANCELLATION'                                  252771
     O                    65N79          89 '- AMENDMENT'                                     252771
     O                    63            102 'COPY'                                            252771
     O        E  202   69 71N11                                                               252771
     O                         CNAME     72                                                   252771
     O                    79             92 'ROLLOVER'                                        252771
     O                    64             92 '- CANCELLATION'                                  252771
     O                    65N79          89 '- AMENDMENT'                                     252771
     O                    63            102 'COPY'                                            252771
     O*
     O** Rundate
     O*
     O        E  1     69 71
     O                                   69 'DATE'
     O                         RUNA      78
     O/COPY WNCPYSRC,LE1150O004
     O*
     O** Loan reference
     O*
     O        E  2     69 71
     O                                   69 'REF.'
     O                         LNRF      77
     O                                   78 '-'
     O                         CNUM      84
     O*
     O** Print customer name and address
     O/COPY WNCPYSRC,LE1150O002
     O*
     O        E  1     69 71
     O***********              CNA1      85                                                   252771
     O                         CNA1      46                                                   252771
     O********E**2     69 71                                                                  252771
     O***********              CNA2      85                                                   252771
     O        E  1     69 71                                                                  252771
     O                         CNA2      46                                                   252771
     O        E  1     69 71
     O***********              ONA1      46                                                  252771A
     O***********              CNA3      85                                                  252771A
     O                         CNA3      46                                                  252771A
     O                         ONA1      85                                                  252771A
     O        E  2     69 71
     O***********              ONA2      46                                                  252771A
     O***********              CNA4      85                                                  252771A
     O                         CNA4      46                                                  252771A
     O                         ONA2      85                                                  252771A
     O/COPY WNCPYSRC,LE1150O003
     O*
     O** Detail line 1
     O*
     O        E  2     69 71
     O                                   14 'CCY'
     O                    32             29 'PRINCIPAL'
     O                    33             29 'PRINCIPAL'
     O                    35             29 'PRINCIPAL'
     O                    44N38          29 'PRINCIPAL'
     O                    79             29 'PRINCIPAL'
     O                    37             32 'PRINCIPAL SOLD'
     O                    38             32 'PRINCIPAL SOLD'
     O***********         39N79          36 'AMOUNT OF GUARANTEE'         CLE005
     O                N76 39N79          36 'AMOUNT OF GUARANTEE'         CLE005
     O                 76 39N79          36 'PARTICIPATION AMOUNT'        CLE005
     O                    44             41 'FROM'
     O                    45             41 'FROM'
     O                    39N79          41 'FROM'
     O                    44             48 'TO'
     O                    45N83          48 'TO'
     O                    45 83          48 'AT'
     O                    39N79          48 'TO'
     O                    45             68 'INTEREST RATE'
     O                    46             68 'INTEREST RATE'
     O                    48             68 'INTEREST RATE'
     O                    44             68 'DISCOUNT RATE'
     O                    44             82 'DISCOUNT'
     O                    39N79          66 'FEE RATE'
     O                    79             68 'DISCOUNT RATE'
     O                    79             82 'DISCOUNT'
     O                    22             86 'INTEREST'
     O***********      37                89 'TOTAL INTEREST'              CLE005
     O**********       37N74             89 'TOTAL INTEREST'                         CLE005 BUG12997
     O                 37N74             87 'TOTAL INTEREST'                                BUG12997
     O*
     O** Detail line 2
     O*
     O        E  2     69 71
     O/COPY WNCPYSRC,LE1150O005
     O                         CCY       14
     O/COPY WNCPYSRC,LE1150O012
     O                    40   CPAM      35 ' ,   ,   ,   , * '
     O                    41   CPAM      35 '   ,   ,   , * . '
     O                    42   CPAM      35 '  ,   ,   , * .  '
     O                    43   CPAM      35 ' ,   ,   , * .   '
     O                    40 79NPRAM     35 ' ,   ,   ,   , * '
     O                    41 79NPRAM     35 '   ,   ,   , * . '
     O                    42 79NPRAM     35 '  ,   ,   , * .  '
     O                    43 79NPRAM     35 ' ,   ,   , * .   '
     O                         FDATE     44
     O**********               TDATE     53                                                   240062
     O                    44   TDATE     53                                                 AR847806
     O                   N83 45TDATE     53                                                   240062
     O                    83 45          50 'CALL'
     O                    39N79TDATE     53                                                 AR847806
     O                    45   INTR      68 '  * .       -'
     O                    46   INTR      68 '  * .       -'
     O                    48   INTR      68 '  * .       -'
     O                    39N79INTR      68 '  * .       -'
     O                    44   INTR      68 '  * .       -'
     O**********          40 44TOTI      88 ' ,   ,   ,   , * '                             AR833482
     O**********          41 44TOTI      88 '   ,   ,   , * . '                             AR833482
     O**********          42 44TOTI      88 '  ,   ,   , * .  '                             AR833482
     O**********          43 44TOTI      88 ' ,   ,   , * .   '                             AR833482
     O                    40 44TOTI      89 ' ,   ,   ,   , * -'                            AR833482
     O                    41 44TOTI      89 '   ,   ,   , * . -'                            AR833482
     O                    42 44TOTI      89 '  ,   ,   , * .  -'                            AR833482
     O                    43 44TOTI      89 ' ,   ,   , * .   -'                            AR833482
     O                    79   DSCRTE    68 '  * .       -'
     O                    40 79NDAM      87 ' ,   ,   ,   , * '
     O                    41 79NDAM      87 '   ,   ,   , * . '
     O                    42 79NDAM      87 '  ,   ,   , * .  '
     O                    43 79NDAM      87 ' ,   ,   , * .   '
     O**********          40 22TOTINT    88 ' ,   ,   ,   , * '                             AR833482
     O**********          41 22TOTINT    88 '   ,   ,   , * . '                             AR833482
     O**********          42 22TOTINT    88 '  ,   ,   , * .  '                             AR833482
     O**********          43 22TOTINT    88 ' ,   ,   , * .   '                             AR833482
     O                    40 22TOTINT    89 ' ,   ,   ,   , * -'                            AR833482
     O                    41 22TOTINT    89 '   ,   ,   , * . -'                            AR833482
     O                    42 22TOTINT    89 '  ,   ,   , * .  -'                            AR833482
     O                    43 22TOTINT    89 ' ,   ,   , * .   -'                            AR833482
     O***********      37 40   TOTINT    92 ' ,   ,   ,   , * '           CLE005
     O***********      37 41   TOTINT    92 '   ,   ,   , * . '           CLE005
     O***********      37 42   TOTINT    92 '  ,   ,   , * .  '           CLE005
     O***********      37 43   TOTINT    92 ' ,   ,   , * .   '           CLE005
     O**********       37 40N74TOTINT    92 ' ,   ,   ,   , * '                      CLE005 BUG12997
     O**********       37 41N74TOTINT    92 '   ,   ,   , * . '                      CLE005 BUG12997
     O**********       37 42N74TOTINT    92 '  ,   ,   , * .  '                      CLE005 BUG12997
     O**********       37 43N74TOTINT    92 ' ,   ,   , * .   '                      CLE005 BUG12997
     O**********       37 40N74TOTINT    90 ' ,   ,   ,   , * '                    BUG12997 AR833482
     O**********       37 41N74TOTINT    90 '   ,   ,   , * . '                    BUG12997 AR833482
     O**********       37 42N74TOTINT    90 '  ,   ,   , * .  '                    BUG12997 AR833482
     O**********       37 43N74TOTINT    90 ' ,   ,   , * .   '                    BUG12997 AR833482
     O**********       37 40N74TOTINT    93 ' ,   ,   ,   , * -'                   AR833482 AR997089
     O**********       37 41N74TOTINT    93 '   ,   ,   , * . -'                   AR833482 AR997089
     O**********       37 42N74TOTINT    93 '  ,   ,   , * .  -'                   AR833482 AR997089
     O**********       37 43N74TOTINT    93 ' ,   ,   , * .   -'                   AR833482 AR997089
     O                 37 40N74TOTINT    89 ' ,   ,   ,   , * -'                            AR997089
     O                 37 41N74TOTINT    89 '   ,   ,   , * . -'                            AR997089
     O                 37 42N74TOTINT    89 '  ,   ,   , * .  -'                            AR997089
     O                 37 43N74TOTINT    89 ' ,   ,   , * .   -'                            AR997089
     O/COPY WNCPYSRC,LE1150O006
     O*
     O** Totals
     O*
     O        E  2     69 71
     O                   N39N83          60 'TOTAL'
     O                    34N79          67 'NET PROCEEDS'
     O                    79N34          67 'NET PROCEEDS'
     O/COPY WNCPYSRC,LE1150O013
     O                    40 44TOTAL     88 ' ,   ,   ,   , * '
     O                    41 44TOTAL     88 '   ,   ,   , * . '
     O                    42 44TOTAL     88 '  ,   ,   , * .  '
     O                    43 44TOTAL     88 ' ,   ,   , * .   '
     O                N34 40 79TOTAL     88 ' ,   ,   ,   , * '
     O                N34 41 79TOTAL     88 '   ,   ,   , * . '
     O                N34 42 79TOTAL     88 '  ,   ,   , * .  '
     O                N34 43 79TOTAL     88 ' ,   ,   , * .   '
     O                    40 22TOTAL     88 ' ,   ,   ,   , * '
     O                    41 22TOTAL     88 '   ,   ,   , * . '
     O                    42 22TOTAL     88 '  ,   ,   , * .  '
     O                    43 22TOTAL     88 ' ,   ,   , * .   '
     O***********         40 37TOTAL     92 ' ,   ,   ,   , * '           CLE005
     O***********         41 37TOTAL     92 '   ,   ,   , * . '           CLE005
     O***********         42 37TOTAL     92 '  ,   ,   , * .  '           CLE005
     O***********         43 37TOTAL     92 ' ,   ,   , * .   '           CLE005
     O**********      N74 40 37TOTAL     92 ' ,   ,   ,   , * '                      CLE005 BUG12997
     O**********      N74 41 37TOTAL     92 '   ,   ,   , * . '                      CLE005 BUG12997
     O**********      N74 42 37TOTAL     92 '  ,   ,   , * .  '                      CLE005 BUG12997
     O**********      N74 43 37TOTAL     92 ' ,   ,   , * .   '                      CLE005 BUG12997
     O**********      N74 40 37TOTAL     90 ' ,   ,   ,   , * '                    BUG12997 AR997089
     O**********      N74 41 37TOTAL     90 '   ,   ,   , * . '                    BUG12997 AR997089
     O**********      N74 42 37TOTAL     90 '  ,   ,   , * .  '                    BUG12997 AR997089
     O**********      N74 43 37TOTAL     90 ' ,   ,   , * .   '                    BUG12997 AR997089
     O                N74 40 37TOTAL     88 ' ,   ,   ,   , * '                             AR997089
     O                N74 41 37TOTAL     88 '   ,   ,   , * . '                             AR997089
     O                N74 42 37TOTAL     88 '  ,   ,   , * .  '                             AR997089
     O                N74 43 37TOTAL     88 ' ,   ,   , * .   '                             AR997089
     O/COPY WNCPYSRC,LE1150O014
     O*                                                                   070515
     O        E  2     69 06 71                                           070515
     O                                   34 'RECEIVER OF GUARANTEE  '     070515
     O***********              RCRN   B  54                         070515S01518
     O                         RCRN2  B  54                               S01518
     O                                   56 '  '                          070515
     O                         RCTW   B  66                               070515
     O*
     O        E  1     69 46 71
     O       OR        69 48 71
     O                    30             29 'WITH REPAYMENTS OF'
     O/COPY WNCPYSRC,LE1150O015
     O                    30 40RAMT      47 ' ,   ,   ,   , * '
     O                    30 41RAMT      47 '   ,   ,   , * . '
     O                    30 42RAMT      47 '  ,   ,   , * .  '
     O                    30 43RAMT      47 ' ,   ,   , * .   '
     O                    30 46          69 'PLUS ALL OUTSTANDING '
     O                    30 46          85 'ACCRUED INTEREST'
     O                    30 48          54 'DUE ON'
     O                    30 48RDATE     62
     O/COPY WNCPYSRC,LE1150O007
     O*
     O        E  1     69 47 71
     O/COPY WNCPYSRC,LE1150O008
     O                    30             24 'REPAYMENTS OF'
     O                    30 40RAMT      42 ' ,   ,   ,   , * '
     O                    30 41RAMT      42 '   ,   ,   , * . '
     O                    30 42RAMT      42 '  ,   ,   , * .  '
     O                    30 43RAMT      42 ' ,   ,   , * .   '
     O                    30             49 'DUE ON'
     O                    30   RDATE     57
     O                      N31          66 'AND THEN'
     O**********            N31TABFQ2    78                                                   CLE064
     O**********             20          85 'ON THE'                                          CLE064
     O**********             20RDAY      90                                                   CLE064
     O                      N31TABFQ2    82                                                   CLE064
     O                       20          89 'ON THE'                                          CLE064
     O                       20RDAY      94                                                   CLE064
     O/COPY WNCPYSRC,LE1150O009
     O*
     O        E  1     69 46 71
     O/COPY WNCPYSRC,LE1150O010
     O                    30             17 'DUE ON'
     O                    30   RDATE     25
     O                      N31          34 'AND THEN'
     O**********            N31TABFQ2    46                                                   CLE064
     O**********             20          53 'ON THE'                                          CLE064
     O**********             20RDAY      58                                                   CLE064
     O                      N31TABFQ2    50                                                   CLE064
     O                       20          57 'ON THE'                                          CLE064
     O                       20RDAY      62                                                   CLE064
     O/COPY WNCPYSRC,LE1150O011
     O*
     O        E  1     69 48 71
     O                      N31          19 'AND THEN'
     O**********            N31TABFQ2    31                                                   CLE064
     O**********             20          38 'ON THE'                                          CLE064
     O**********             20RDAY      43                                                   CLE064
     O                      N31TABFQ2    35                                                   CLE064
     O                       20          42 'ON THE'                                          CLE064
     O                       20RDAY      47                                                   CLE064
     O*
     O/COPY WNCPYSRC,LE1150O017
     O        E 11     69 71
     O                         TITL1  B  51
     O                   N39   TITL2  B  80
     O        E  1     69 71
     O                         NAME1  B  49
     O                   N39   NAME2  B  91
     O        E  1     69 71
     O***********              TOWN1  B  24                               CLE033
     O***********           N39TOWN2  B  66                               CLE033
     O                         TOWN1  B  29                               CLE033
     O                      N39TOWN2  B  71                               CLE033
     O        E  1     69 71 21                                                               CLE031
     O       OR        69 71 70                                                               CLE031
     O                    21   TITL5     46                                                   CLE031
     O                    70   TITL5     88                                                   CLE031
     O        E  1     69 71 21                                                               CLE031
     O       OR        69 71 70                                                               CLE031
     O                 21      WCCY1     17                                                   CLE031
     O                 21 04   WCAMT1    37 ' ,   ,   ,   , * '                               CLE031
     O                 21 09   WCAMT1    37 '   ,   ,   , * . '                               CLE031
     O                 21 10   WCAMT1    37 '  ,   ,   , * .  '                               CLE031
     O                 21 12   WCAMT1    37 ' ,   ,   , * .   '                               CLE031
     O                 70      WCCY2     59                                                   CLE031
     O                 70 13   WCAMT2    79 ' ,   ,   ,   , * '                               CLE031
     O                 70 14   WCAMT2    79 '   ,   ,   , * . '                               CLE031
     O                 70 15   WCAMT2    79 '  ,   ,   , * .  '                               CLE031
     O                 70 26   WCAMT2    79 ' ,   ,   , * .   '                               CLE031
     O        E  1     69 71                                              110911
     O                 17 51N39          21 'FOR A/C OF'                  110911
     O                 17 51N39CPORAC    48                               110911
     O        E  1     69 71
     O                         TITL3  B  21
     O                   N39   TITL4  B  63
     O        E  1     69 71
     O                         NAME3  B  49
     O                   N39   NAME4  B  91
     O        E  2     69 71
     O                         TOWN3  B  34
     O                   N39   TOWN4  B  76
     O*
     O        E  1     69 71
     O                N23 51N39          63 'FOR A/C OF'
     O        E  1     69 71
     O                N23 51N39CPNM      91
     O********E  1     69 71                                              110911
     O        E  2     69 71                                              110911
     O                N23 51N39CPTN      76
     O*
     O********E  2     69 71                                              110911
     O********        N23 51N39CPORAC    48                               110911
     O/COPY WNCPYSRC,LE1150O001
     O*
     O        E  1     69 71
     O                   N24   TITL6  B  73
     O        E  1    N25 69 71
     O***********        N24   SPI1      86                               088913
     O                   N24   BTB1      91                               088913
     O        E  1     69 71
     O***********        N24   SPI2      86                               088913
     O                   N24   BTB2      91                               088913
     O        E  1     69 71
     O***********        N24   SPI3      86                               088913
     O                   N24   BTB3      91                               088913
     O        E  1     69 71
     O                 25                69 'BENIFICIARY BANK'
     O        E        69 71
     O***********      25      SPI1      86                               088913
     O***********              BTB1      91                         088913110641
     O                 25      BTB1      91                               110641
     O                 U4 96             78 '** AUTO TRANSMISSION -'
     O                 U4 96             93 'DO NOT SEND **'
     O*                                                                   S01408
     O/COPY WNCPYSRC,LE1150OOP2                                           S01408
     O*                                                                   S01408
     O*
     O        T 32     U8 LR 71
     O                                   50 '*** REFERENCE'
     O                         DBPGM     61
     O                                   82 '- DATABASE ERROR -'
     OLE1150AUT 32     U8 LR
2001 O                                   24 'REFERENCE LE1150AU'
2002 O                         TITL      90
2003 O                                  104 'DATE'
2004 O                         RUNA     112
2005 O                                  122 'PAGE'
2006 O                         PAGE     127
     O        T 32     U8 LR
     O                                   42 '*** REFERENCE'
     O                         DBPGM     53
     O                                   74 '- DATABASE ERROR AT'
     O                         DBASE     80
     O        T        U8 LR
     O                                   37 'FILENAME'
     O                         DBFILE    47
     O                                   55 'KEY'
     O                         DBKEY     85
     O*
     O** DTRIX file output
     O** Update header or detail record
     O*
     OLTRIX   E        73
     O                    LR   COUNT     17P
     O                   NLR             19 'Y'
     O                    LR             33 '0'
     O                         NATN      40P
     O                                   44 'Y'                                             AR322732
     O*
     O** LTRIX file - Release
      *
      ** LTRIX file - Update 'Confirmation Processed Flag'                                  AR322732
     O*
     O*
     O        E        75
     O                   NLR             44 'Y'                                             AR322732
     O*
     O** Dummy update from subroutine HDRCHN
     O*
     O********E*               RECLCK                                                       AR322732
     O**********               RECI                                                         AR322732
     O*
     O** CLOAN file output
     O*
     OCLOAN   E        72
     O                         CNFI     387
     O                         RUND     396P
     O                         NATN     400P
     O*
     O** CLOAN file - Release
     O*
     O        E        77
     O*
     O** LEEXT file
     O*
     OLEEXTAA E        U4 82
     O                                    1 'H'
     O                         BRCA       4
     OLEEXTAB E        U4 81 69
     O                                    1 'D'
     O                         BRCA       4
     O                         LNRF      10
     O                                   11 'C'
     O                    85   TELX      23
     O                   N85   CSID      23
     O                         TOTI      30P
     OLEEXTAC T        U4 LR
     O                                    1 'T'
     O                         BRCA       4
     O                         NORET      9
     O*****************************************************************
      *                                                                                       CLE064
      ** Elements of Array TABF/TABFRQ were amended by removing TBI-MONTHLY and               CLE064
      ** XSIX MONTHLY, and added more elements                                                CLE064
      *                                                                                       CLE064
**    TABTYP/TABNO  -  LOAN TYPES AND KEY TO ASSOCIATED PRINT DATA
61  11
62  11
63  11
64  22
65  22
66  23
67  23
70  34
68  22                                                                    CLE005
69  23                                                                    CLE005
71  26                                                                    CLE005
72  27                                                                    CLE005
99  28                                                                    CLE005
80  11                                                                                        CLE028
**   NAME/START  - CONFIRMATION NAMES AND START POSITION IN SET-UP ARRAY
18LOAN CONFIRMATION         10
27PARTICIPATION CONFIRMATION 1
23GUARANTEE CONFIRMATION     5
**   TITL12  -  CONSTANT FIELDS USED IN OUR NOSTRO TITLES - SEE DATA STRUC
11PAYMENT AT11VALUE DATE14MATURITY DATETO OUR A/C WITH13FEE DUE DATE
14ROLLOVER DATE
**   TITL5   -  CONSTANT TEXT FOR SETTLEMENT DETAILS                                          CLE031
PAYMENT IN SETTLE CCY AMOUNTING TO                                                            CLE031
**   NAME12  -  CONSTANT FIELDS USED IN OUR NOSTRO NAME - SEE DATA STRUCTU
INSTRUCTIONS TO BE ADVISED DEBIT TO A/C NUMBER
WE WILL SENDWE AWAIT YOUR REMITTANCEAS PER YOUR IN
STRUCTIONS WE SHALL COLLECT REMITTANCEYOURSELVES
**   NAME34  -  CONSTANT FIELDS USED IN THEIR NOSTRO, SET UP IN DATA STRUC
PAYMENT   WE AWAIT YOUR ADVICESPECIAL INSTRUCTIONS
**   TABF/TABFRQ  -  INTEREST PAYMENT FREQUENCIES
WWEEKLY
MMONTHLY
FFORTNIGHTLY
TTWO MONTHLY                                                                                  CLE064
QQUARTERLY
XHALF YEARLY                                                                                  CLE064
YYEARLY
DDAILY                                                                                        CLE064
4FOUR MONTHLY                                                                                 CLE064
5FIVE MONTHLY                                                                                 CLE064
7SEVEN MONTHLY                                                                                CLE064
8EIGHT MONTHLY                                                                                CLE064
9NINE MONTHLY                                                                                 CLE064
VTEN MONTHLY                                                                                  CLE064
EELEVEN MONTHLY                                                                               CLE064
CTWO YEARLY                                                                                   CLE064
ITHREE YEARLY                                                                                 CLE064
JFOUR YEARLY                                                                                  CLE064
NFIVE YEARLY                                                                                  CLE064
UTEN YEARLY                                                                                   CLE064
**   DEDIT - ARRAY OF DAY NUMBER EDITS
STNDRDTHTHTHTHTHTHTHTHTHTHTHTHTHTHTHTHTHSTNDRDTHTHTHTHTHTHTHST
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
** CPY@   **      OBJECT COPYRIGHT
(c) Finastra International Limited 2001
**   SVAL  -  SYSTEM VALUES ARRAY                                                             218782
Settlement09Postings                                                                          218782
** @YD  USED BY SR. ZDATE9 - YEARS, IN DAYS, CUMULATIVE IN 4 YEAR SPAN
00366007310109601461
** @MD  USED BY SR. ZDATE9 - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
00000000310005900090001200015100181002120024300273003040033400365
**  POWER - ARRAY OF POWERS FOR CURRENCY CONVERSION                                           CLE031
0000001                                                                                       CLE031
0000010                                                                                       CLE031
0000100                                                                                       CLE031
0001000                                                                                       CLE031
0010000                                                                                       CLE031
0100000                                                                                       CLE031
1000000                                                                                       CLE031
