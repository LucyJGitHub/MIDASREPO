     H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas LE Print end of day confirmations')              *
     F*****************************************************************
     F*                                                               *
     F*  Midas - Customer Lending Module                              *
     F*                                                               *
     F*  LE1160 - PRINT END OF DAY CONFIRMATIONS                      *
     F*                                                               *
     F*  Function: This program will print the customer confirmation  *
     F*    (COB)   details if entered and the receiver of the guaran- *
     F*            tee for processing type 70, if switchable feature  *
     F*            S01465 is switched on.  This program is based on   *
     F*            LE0420.                                            *
     F*                                                               *
     F*  Called by: LEC0702 - COB Confirmations Print                 *
     F*                                                               *
      *  (c) Misys International Banking Systems Ltd. 2001            *
     F*                                                               *
      *  Last Amend No. MD020304           Date 07May13               *
      *  Prev Amend No. CLE075BO           Date 06Aug12               *
      *                 CLE134             Date 01Aug12               *
      *                 CLE148             Date 23Jul12               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *                 CRE026             Date 24May06               *
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 BUG11784           Date 27Jul06               *
      *                 CSD031             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 CLE042             Date 06Sep05               *
      *                 CSW037A            Date 02May05               *
      *                 CSD025             Date 11Jan05               *
      *                 CLE025             Date 20Oct03               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 CGL029             Date 01Sep03               *
      *                 222373             Date 28Oct03               *
      *                 CAP075             Date 16Sep03               *
      *                 CAP074             Date 16Sep03               *
      *                 219250             Date 30Jun03               *
      *                 218782             Date 25Jun03               *
      *                 CLE033             Date 02Apr03               *
      *                 CLE031             Date 04Feb03               *
      *                 CAS006             Date 21Jan03               *
      *                 CAS005             Date 16Dec02               *
      *                 219242             Date 01Jul03               *
      *                 219241             Date 01Jul03               *
      * Midas Release 4.01.03 ----------------------------------------*
      *                 207045             Date 11Dec02               *
      * Midas Release 4.01.02 ----------------------------------------*
      *                 205248             Date 10Jun02               *
      *                 202628             Date 25Apr02               *
      * Midas Release 4.01 -------------------------------------------*
      *                 190430             Date 28Sep01               *
      *                 182229             Date 19Sep01               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.05 -----------------------------------------------*
      *                 CLE011             Date 07Nov00               *
      * Midas DBA 3.03 -----------------------------------------------*
      *                 166111             Date 31May00               *
      *                 153784             Date 20Apr00               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 157056             Date 19Mar99               *
      *                 CEU004             Date 02Feb98               *
      *                 CLE005             Date 22May97               *
     F*                 119889             Date 01Jul97               *
     F*                 100663             DATE 11MAR96               *
     F*                 CCG008             DATE 30OCT95               *
     F*                 088913             DATE 22JUN95               *
     F*                 S01465 *CREATE     DATE 22MAR94               *
     F*                                                               *
     F*---------------------------------------------------------------*
     F*                                                               *
      *  MD020304 - CLKY not updated when there is a cache hit in     *
      *             nostro                                            *
      *  CLE075BO - COB Restructure - LE COB Optimisation Phase 1     *
      *  CLE134 - Past Due Call Loan Processing                       *
      *  CLE148 - Alpha Loan Reference                                *
      *  CRE026 - Consumer Banking                                    *
      *  BUG11784 - Customer field COCUCL should not equal to         *
      *             '000000' to avoid database error.                 *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CLE042 - Extended Loan Sub Type                              *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  CLE025 - Credit Lines (Recompile)                            *
      *  CGL029 - Increase Account Code to 10 digits                  *
     F*  222373 - Parameter Mismatch                                  *
      *  CAP075 - Lending API Enhancements - Loan Amendments Input    *
      *  CAP074 - Lending API Enhancements - Loans Input              *
      *  219250 - Amendment to CLE031 & CLE034 - correct overprinting *
      *           on LE1160P1 report.                                 *
      *  218782 - Check system value Settlement09Postings to decide   *
      *           whether to use Settlement or Transaction Ccy.       *
      *  CLE033 - Settlement method 09                                *
      *  CLE031 - Lending Enhancements.                               *
      *  CAS006 - Hedge Accounting Phase B (Recompile)                *
      *  CAS005 - Enahancements to CAS001, CAS002 and CAS004          *
      *           (Recompile)                                         *
      *  219242 - Not possible to create MT103+ payment msg from      *
      *           non-FT transaction (Recompile)                      *
      *  219241 - Defaulting of "Details of Charges" assign a         *
      *           system value (Recompile)                            *
      *  207045 - DBASE 011 CLOAN KEY 000000A                         *
      *  205248 - Add RCVNG LOAN/CUSTOMER and ORGTNG LOAN/CUSTOMER    *
      *           to 'Principal Transfer From' and 'Principal Transfer*
      *           To' confirmations.                                  *
      *  202628 - If the only confirmations to be printed are for     *
      *           Principal Transfers, WRITE to unopened LE1160P1.    *
      *           Use *IN35 instead of *IN33 for Principal Transfers. *
      *  190430 - Incorrect amount and currency shown in repayment    *
      *           confirmation for 'In Currency' with settlement      *
      *           currency equal to EUR.                              *
      *  182229 - Dont suppress swift if RE and their nostro blank    *
      *  CLE011 - Rate Fixing Days for Lending Rollover Processing    *
      *           Recompile                                           *
     F*  166111 - Access MLOAN if record not found in CLOAN           *
     F*  153784 - Do not convert to Euro currency amounts if ccy      *
      *         - is not an 'IN' ccy and if 'to' and 'from' ccys      *
      *         - are identical. Make sure wrk ccy fields reset on    *
      *         - change of loan number.                              *
      *  157056 - Principal Transfer Confirmation should display      *
      *           customer no., interest rate and amount correctly.   *
      *           Data structure of CONFS changed for correct field   *
      *           positions.                                          *
      *  CEU004 - LE Settlement Ccy Conversion Upgrade to DBA R2.0    *
     F*  CLE005 - Customer Lending Enhancements - Others (T3)         *
     F*  119889 - Customer Lending Enhancements - Syndications.       *
     F*  100663 - Unable to change form length of spool file output   *
     F*           by changing printer file - remove Line specs.       *
     F*  CCG008 - User Defined Correspondence - Lending               *
     F*  088913 - SPI printing in confirmation is mis-aligned and not *
     F*           all of the instructions are included in the 3 line  *
     F*           text                                                *
     F*  S01465 - BLI Lending and Guarantees Issued Enhancements.     *
     F*                                                               *
     F*****************************************************************
     F*                                                               *
     F*  C R E A T I O N     P A R A M E T E R S                      *
     F*                                                               *
     F*                                                               *
     F*****************************************************************
     F*
     F*CONFS   IPE F     320 14AI     8 DISK                              119889
     F***CONFS***IPE F    1051 14AI     8 DISK                     119889 CEU004
     F***CONFS***IPE F    1066 14AI     8 DISK                                         CEU004 CLE031
     F***CONFS   IPE F    1087 14AI     8 DISK                                         CLE031 CAP075
     F***CONFS***IPE F    1176 14AI     8 DISK                                         CAP075 CGL029
     F***CONFS***IPE F    1230 14AI     8 DISK                                         CGL029 CLE042
     FCONFS   IPE F    1291 14AI     8 DISK                                                   CLE042
     F*CLOAN***IF**F     458  7AI     2 DISK                              088913
     F*CLOAN***IF**F    1087  7AI     2 DISK                       088913 CLE011
     F*CLOAN***IF  F    1310  7AI     2 DISK                                           CLE011 CAP074
     F***CLOAN***IF  F    1560  7AI     2 DISK                                         CAP074 CGL029
     FCLOAN   IF  F    1632  7AI     2 DISK                                                   CGL029
     F*MLOAN***IF**F    1089  6AI     2 DISK                       166111 CLE011
     F*MLOAN***IF  F    1310  6AI     2 DISK                                           CLE011 CAP074
     F***MLOAN***IF  F    1560  6AI     2 DISK                                         CAP074 CGL029
     FMLOAN   IF  F    1565  6AI     2 DISK                                                   CGL029
     FSDCURRL1IF  E           K        DISK                                                 CLE075BO
     FSDBRCHL1IF  E           K        DISK                                                 CLE075BO
     FLENXTAA O   F     320            DISK                           U4
     F***LENXTAB O   F     320            DISK                           U4                   CGL029
     FLENXTAB O   F    1003            DISK                           U4                      CGL029
     FLENXTAC O   F     320            DISK                           U4
     F*E1160P1O***F     132     OF    LPRINTER      KINFDS SPOOL1     UC  100663
     FLE1160P1O   F     132     OF     PRINTER      KINFDS SPOOL1     UC  100663
     FLE1160P2O   F     132     OV     PRINTER      KINFDS SPOOL2     UC  119889
     FLE1160AUO   F     132            PRINTER      KINFDS SPOOLU
     F/COPY WNCPYSRC,LE1160F001
     F*
     F*****************************************************************
     F*
     F*     F U N C T I O N   O F   I N D I C A T O R S
     F*
     F*     01        S/CONFS HEADER
     F*     03        S/CONFS DETAIL (REC TYPE D)
     F*     05        S/CONFS DETAIL (REC TYPE R)
     F*     07        S/CONFS TRAILER
     F*     09        S/CONFS CATCHALL
     F*     10        RECORD FORM CLOAN READ
      *     12        Full cache indicator                                                  CLE075BO
     F*     13        Amendment Type = PT or PF                           119889
     F*     14        For Principal Transfer, customers are the same      119889
     F*     16        Amendment Type = PT                                 119889
     F*     17        Amendment Type = PF                                 119889
     F*     18        REPAYMENT TYPE 3
     F*     19        REPAYMENT TYPE 1
     F*     20        AMENDMENT TYPE = PI
     F*     21        AMENDMENT TYPE = RE
     F*     22        'OURS' BLANK
     F*     23        'THEIRS' BLANK
     F*     24        03 OR 05 IS ON
     F*     25        VALUE DATE OUTSIDE EXTRACT PERIOD
     F*     26        'FOR A/C' BLANK
     F*     27        WORK INDICATOR FOR BENIFICIARY BANK DETAILS
     F*     28        FIRST LINE OF SPECIAL INSTRUCTIONS IS BLANK
     F*     29        BENIFICIARY BANK DETAILS EXIST ON FIRST LINE OF SPI
     F*     30        PROCESSING TYPE = 66 FOR PI
     F*     32        PROCESSING TYPE = 61 OR 62
     F*     33        RE.TO PRINT
     F*     34        PROCESSING TYPE = 64
     F*     35        Principal Transfer to print                                             202628
     F*     36        PROCESSING TYPE = 66
     F*     37        CONFIRMATION CONTROL INDICATOR BIT ON
     F*     38        COUNTERPARTY IS A SWIFT MEMBER
     F*     39        OUTPUT TO LENXTAB
     F*     40        CURRENCY DECIMAL PLACES = 0
     F*     41        CURRENCY DECIMAL PLACES = 1
     F*     42        CURRENCY DECIMAL PLACES = 2
     F*     43        CURRENCY DECIMAL PLACES = 3
     F*     44        INTEREST ON RE. NEGATIVE
     F*     45        TOTAL REPAYMENT NEGATIVE
     F*     46        WORK
      ******47********Cache*Hit*For*Currency*Codes*********************             CLE075BO TEMPFIX
      *     66        Cache Hit for Currency Codes                                           TEMPFIX
     F*     48        PROCESSING TYPE = 62 FOR PI
     F*     49        SETTLEMENT TYPE = 09                                                    219250
     F*     50        SETTLEMENT TYPE = 00
     F*     51        SETTLEMENT TYPE = 01,07,08
     F*     52        SETTLEMENT TYPE = 02
     F*     53        SETTLEMENT TYPE = 03,06
     F*     54        SETTLEMENT TYPE = 04
     F*     55        SETTLEMENT TYPE = 05
      *     56        Cache Hit for Branch Codes                                            CLE075BO
     F*     57        SETTLEMENT TYPE = 12
     F*     58        SETTLEMENT TYPE = 14
     F*     59        SETTLEMENT TYPE = 01
     F*     60        SETTLEMENT CURRENCY                                                     219250
     F*     61        INDICATOR FOR GUARANTEES ISSUED IS SWITCHED ON
     F*     62        PRTF LE1160P1 open                                  119889
     F*     63        PRTF LE1160P2 open                                  119889
     F*     70        BRANCH NAMES TO BE PRINTED
     F*     71        DIFFERENCE IN FILE CONTROLS
     F*     72        AT LEAST ONE TELEX GENERATED
     F*     73        PARTICIPATION SOLD TYPE OF A LOAN
     F*     74        PARTICIPATION PURCHASED TYPE OF A LOAN
     F*     75        INPUT FILE HAS AT LEAST ONE RECORD
      *     76        Cache hit for Nostro array                                            CLE075BO
     F*     88        MBIN = 'Y'
     F*     96        "DO NOT SEND" TEXT
     F*     U4        CUSTOMER LENDING SWIFT EXISTS
     F*     U7 U8     DATA BASE ERROR - PROGRAM HALTS
     F**
     E/EJECT
      **  Array containing Copyright statement                                                CLE031
     E                    CPY@    1   1 80
      **  Array of powers for currency conversion                                             CLE031
     E                    POWER   1   7  7 3                                                  CLE031
      **  Array of System Values for Settlement Method 09                                     218782
     E                    SVAL    1   1 20                                                    218782
      *                                                                                     CLE075BO
      ** Caches Arrays                                                                      CLE075BO
      *                                                                                     CLE075BO
     E                    #CCY      250  3                                                  CLE075BO
     E                    #BCH      900  3                                                  CLE075BO
     E                    #NOS      200 13 0             Nostro Array                       CLE075BO
     E                    #NSS      200 13 0             Nostro Sorted                      CLE075BO
     E                    #NSK      200  5               Nostro Cache Key                   CLE075BO
      /COPY ZSRSRC,ZDATE2Z1
     L/EJECT
     L*LE1160P1*42FL*42OL***                                              100663
     I/EJECT
     ICONFS   NS  01   1 CH
     I** Confirmation file header
     I                                        1   1 RECI
     ICONFS   NS  03   1 CD
     I       OR   05   1 CR
     I** Confirmation detail
     I                                        1   1 RECI
     I**********                              2   70LNRF                                      CLE148
     I                                        2   7 LNRF                                      CLE148
     I                                        8  120VDAT
     I                                       13  150LASN
     I                                       16  160MRIN
     I                                       17  18 LTYP
     I                                       19  20 SUTP
     I                                       21  220PTYP
     I                                       23  24 AMTP
     I                                       25  260PRSQ
     I                                       27  28 BRTT
     I                                    P  29  340RTSP
     I                                       35  37 CCY
     I                                    P  38  440PRAM
     I                                    P  45  510INTA
     I                                    P  52  580WTXA
     I                                    P  59  650FEAM
     I                                    P  66  720TAMT
     I                                       73  75 BRCA  L1
     I**********                             76  810CNUM                                      CSD027
     I                                       76  81 CNUM                                      CSD027
     I                                       82  820REPT
     I                                       83  83 AUTD
     I                                       84  84 STAI
     I                                       85  86 SETP
     I**********                             87  98 OSAC            22                        CGL029
     I                                       87  98 OSACQQ                                    CGL029
     I                                       99 108 TSEN            23
     I                                      109 118 FACO            26
     I                                      119 148 SPI1            28
     I                                      149 178 SPI2
     I                                      179 208 SPI3
     I*
     I** Whole of special and settlement instructions
     I                                      119 208 SPINST
     I                                       85 208 INSTR
     I                                      209 209 LAIN
     I                                    P 210 2150BRTE
     I                                      216 216 SPIN
     I                                      217 2170CALC
     I                                      218 218 WTIN
     I                                      219 219 LLAG
     I                                      220 220 LWDI
     I                                      221 2250XAVD
     I                                      226 2280XASQ
     I**********                            229 2340FCUS                                      CSD027
     I                                      229 234 FCUS                                      CSD027
     I                                      235 2370FTYP
     I                                      238 2390FSEQ
     I**********                            240 2450RLON                                      CSD027
     I                                      240 245 RLON                                      CSD027
     I                                      246 2470FECD
     I                                      248 248 PDNI
     I                                      249 249 ACTI
     I                                      250 250 CNFY
     I                                      251 251 TLXY
     I                                      252 252 CBLY
     I                                      253 253 INTC
     I                                      254 254 NACD
     I                                      261 263 OSBR
     I                                    P 311 3130ORED
     I                                    P 314 3160LCD
     I                                      317 317 CHTP
     I*
     I** N.B. next filed is extract date -- not TNLU
     I                                    P 318 3200EXTD
     I                                      970 971 DFTP                  157056
     I                                      972 973 DFST                  157056
     I                                      974 974 MNSG                  157056
     I                                      975 975 GASS                  157056
     I                                      976 976 GPRT                  157056
     I                                      977 977 NRLI                  157056
     I**********                            978 9830ROLN                               157056 CLE148
     I                                      978 983 ROLN                                      CLE148
     I                                      984 9860ROSN                  157056
     I                                      987 989 ROBR                  157056
     I**********                            990 9950RORC                               157056 CSD027
     I                                      990 995 RORC                                      CSD027
     I                                      996 996 PDGN                  157056
     I                                      997 997 GRIN                  157056
     I                                      9981000 RLCY                  157056
     I                                    P100110070PNAM                  157056
     I                                     10081008 PAST                  157056
     I                                     10091009 ASTS                  157056
     I                                     10101019 IUSR                  157056
     I                                     10201029 AUSR                  157056
     I                                     10301039 XUSR                  157056
     I                                     10401054 PCRF                  157056
     I                                     10551057 PCOB                  157056
     I                                     10581058 MTPD                  157056
     I                                     10591059 PDDI                  157056
     I                                     10601060 PTDI                  157056
      *                                                                   CEU004
     I                                     10611063 SCCY                  CEU004
     I                                     10641066 ICCY                  CEU004
     I                                    P109010968REXR                                      CLE031
     I                                     11081108 REXI                                      CLE031
     I                                     10981100 PSCY                                      CLE031
     I                                    P110111078PEXR                                      CLE031
     I                                     11081108 PEXI                                      CLE031
     I                                     11101129 FRNT                                      CAP075
     I                                     11301149 AFRT                                      CAP075
     I                                     11501150 REPA                                      CAP075
     I                                     11511176 TMST                                      CAP075
     I                                     11771194 OSAC            22                        CGL029
     I                                     12801283 CLAS                                      CLE042
     I                                     12841287 DFCL                                      CLE042
     I*
     I** Lot, for output to LENXTAB
     I                                        1 250 LOT1
     I                                      251 320 LOT2
     I*
     ICONFS   NS  07   1 CT
     I** Confirmations trailer
     I                                        1   1 RECI
     I                                    P  17  190NORE
     I                                    P  20  220FLSZ
     I                                    P  23  250NLRB
     I                                    P  26  280NINS
     I                                    P  29  310NDEL
     I                                    P  32  340NLRA
     I                                    P  35  420VLBF
     I                                    P  43  440VLBL
     I                                    P  45  520VRIF
     I                                    P  53  540VRIL
     I                                    P  55  620VRDF
     I                                    P  63  640VRDL
     I                                    P  65  720VRAF
     I                                    P  73  740VRAL
     I                                    P  75  820VRRF
     I                                    P  83  840VRRL
     I                                    P 314 3160LCD
     I                                      317 317 CHTP
     I                                    P 318 3200TNLU
     I*
     ICONFS   NS  09
     I** Confirmations catchall
     I                                        1   1 RECI
     I*
     ICLOAN   NS  10   1 CD   8 CA
     I** Loans file - detail 1
     I       OR        1 CM   8 CA
     I       OR        1 CR   8 CA
     I**********                             12  170CNUMCL                                    CSD027
     I**********                            290 2950OLNOCL                                    CSD027
     I**********                            437 4420COCUCL                                    CSD027
     I**********                            443 4480RECECL                                    CSD027
     I                                       12  17 CNUMCL                                    CSD027
     I                                      290 295 OLNOCL                                    CSD027
     I                                      437 442 COCUCL                                    CSD027
     I                                      443 448 RECECL                                    CSD027
     I                                      877 911 BTB1                  088913
     I                                      912 946 BTB2                  088913
     I                                      947 981 BTB3                  088913
     I                                      9821016 BTB4                  088913
     I                                     10171051 BTB5                  088913
     I                                     10521086 BTB6                  088913
     I                                     10871087 CVMR                  088913
     I***********                           970 971 DFTP           119889 157056
     I***********                           972 973 DFST           119889 157056
     I***********                           974 974 MNSG           119889 157056
     I***********                           975 975 GASS           119889 157056
     I***********                           976 976 GPRT           119889 157056
     I***********                           977 977 NRLI           119889 157056
     I***********                           978 9830ROLN           119889 157056
     I***********                           984 9860ROSN           119889 157056
     I***********                           987 9920RORC           119889 157056
     I***********                           993 993 PDGN           119889 157056
     I***********                           994 994 GRIN           119889 157056
     I***********                           995 997 RLCY           119889 157056
     I***********                           99810040PNAM           119889 157056
     I***********                          10051005 PAST           119889 157056
     I***********                          10061006 ASTS           119889 157056
     I***********                          10071016 IUSR           119889 157056
     I***********                          10171026 AUSR           119889 157056
     I***********                          10271036 XUSR           119889 157056
     I***********                          10371051 PCRF           119889 157056
     I*                                                                   166111
     IMLOAN   NS  11   1 CD                                               166111
     I       OR        1 CM                                               166111
     I                                        1   1 RECIX                 166111
     I**********                              2   70LNRFX                              166111 CLE148
     I                                        2   7 LNRFX                                     CLE148
     I**********                             12  170XCNUM                              207045 CSD027
     I                                       12  17 XCNUM                                     CSD027
     I**********                            290 2950XOLNO                              207045 CLE148
     I                                      290 295 XOLNO                                     CLE148
     I*
     I            DS
     I** Fields used for beneficiary bank details
     I                                        1  30 SPI1
     I                                        1   3 SPEC3
     I                                        1   5 SPEC5
     I                                        6   8 SPEC8
     I                                        1   8 SPEC9
     I                                        6  12 SPEC12
     I                                        9  14 SPEC14
     I                                        9  17 SPEC17
     I                                       10  18 SPEC18
     I                                        5  29 SPEC29
     I                                        6  30 SPEC30
     I*
     ILDA         DS                            256
     I** Data base errors
     I                                      134 141 DBFILE
     I                                      142 170 DBKEY
     I                                      171 180 DBPGM
     I                                      181 1830DBASE
     I*
     ISPOOL1      DS
     I** File information data structure - detail report
     I                                       83  92 SFILE1
     I                                    B 123 1240SFNUM1
     ISPOOL2      DS                                                      119889
     I                                       83  92 SFILE2                119889
     I                                    B 123 1240SFNUM2                119889
     I*
     ISPOOLU      DS
     I** File information data structure - audit report
     I                                       83  92 SFILEU
     I                                    B 123 1240SFNUMU
     I*
     ISDALTN    E DSSDALTNPD
     I** External DS for alternate name and address
     I              BCCNA1                          CNA1
     I              BCCNA2                          CNA2
     I              BCCNA3                          CNA3
     I              BCCNA4                          CNA4
     I*
     ISDBANK    E DSSDBANKPD
     I** External DS for bank details
     I              BJURPT                          TITL
     I*
     ISDCLND    E DSSDCLNDPD
     I** External DS for customer lending details
     I*
     I***SDBRCH*   E DSSDBRCHPD                                                             CLE075BO
     ISDBRCH    E DSSDBRCHPD                900                                             CLE075BO
     I** External DS for branch code details
     I              A8BRNM                          BRNM
     I*
     ISDCNST    E DSSDCNSTPD
     I** External DS for counterparty nostro details
     I              AWCPNM                          CPNM
     I              AWCNTN                          CPTN
     I*
     I***SDCURR*   E DSSDCURRPD                                                             CLE075BO
     ISDCURR    E DSSDCURRPD                250                                             CLE075BO
     I** External DS for currency details
     I              A6NBDP                          CDP
     I              A6INCY                          INCY                  153784
     I*
     ISDCUST    E DSSDCUSTPD
     I** External DS for customer details
     I              BBCSID                          CSID
     I              BBCRTN                          CTWN
     I              BBCMTI                          TLXR
     I              BBGSFM                          GSFM
     I              BBSTFG                          SWTX
     I              BBTXA1                          TELX
     I              QQDFAC                          QQDFC1                                    CGL029
     I*
     ISDGELR    E DSSDGELRPD
     I** External DS for general ledger details
     I*
     ISDMMOD    E DSSDMMODPD
     I** External DS for midas modules details
     I              BGMTMI                          TLXM
     I*
     I***SDNOST*   E DSSDNOSTPD                                                             CLE075BO
     ISDNOST    E DSSDNOSTPD                200                                             CLE075BO
     I** External DS for nostro details
     I*
     I              QQACCD                          QQACC1                                    CGL029
     ISDTRAD    E DSSDTRADPD
     I** External DS for trading details
     I              BLBNOC                          BRNC
     I              QQACCD                          QQACC2                                    CGL029
     I*
     ISDMGME    E DSSDMGMEPD
     I** External DS for message details
     I*                                                                   119889
     ISCSARD    E DSSCSARDPD                                              119889
     I*  SAR Details                                                      119889
     I*
     I*SDSVAL***E DSSDSVALPD                                                           218782 222373
      ****EXTERNAL DS FOR SYSTEM VALUES                                                218782 222373
      **********                                                                       218782 222373
     IDSFDY     E DSDSFDY
     I** First DS for access programs, short data structure
     I*
     IDSSDY     E DSDSSDY
     I** Second DS for access programs, long data structure
     I*
     IRUNDT       DS
     I** System rundate
     I                                        1   7 RUNA
     I                                    P   8  100RUND
     I                                       11  11 SSF
     I                                       12  12 DATF
     I                                       13  13 MBIN
     I*                                                                   119889
     IP@IN        DS                            256                       119889
     I                                        1   3 I@SNBR                119889
     I                                        4   9 I@DSCN                119889
     I                                       10  12 I@MTPY                119889
     I                                       13  140I@SETT                119889
     I                                       15  15 I@CONC                119889
     I                                       16  16 I@FTCS                119889
      ** Data structure for input parameter                               119889
      *                                                                   119889
     IP@OUT       DS                            256                       119889
     I**********                              1   60O@CNSN                             119889 CSD027
     I                                        1   6 O@CNSN                                    CSD027
     I                                        7  18 O@SWSN                119889
     I                                       19  38 O@NWSN                119889
     I                                       39  49 O@SWDS                119889
     I                                       46  46 W@96CN                119889
     I                                       47  49 W@BIC                 119889
     I                                       50  69 O@NWDS                119889
     I                                       70  75 O@NWRK                119889
     I                                       76  76 O@MGSG                119889
     I                                       77  80 O@MGST                119889
     C/EJECT
     C                     MOVEACPY@      BIS@   80
     C*
     C** Bypass if not first cycle
     C*  (*IN01 is on if confirmations header record read)
     C     N01             GOTO BY01
     C*
     C** Define RUNDAT
     C*
     C           *NAMVAR   DEFN RUNDAT    RUNDT
     C                     IN   RUNDT
     C*
     C** Define LDA
     C*
     C           *NAMVAR   DEFN           LDA
     C*
     C** Determine if for multibranching
     C*
     C           MBIN      IFEQ 'Y'
     C                     SETON                     88
     C                     END
     C*
     C** Setup LDA for data base errors
     C*
     C                     MOVEL'     '   DBKEY
     C*
      *                                                                   CEU004
      ** Access SAR details file to see if CEU004 is installed            CEU004
      *                                                                   CEU004
     C                     MOVE 'N'       CEU004           Set SAR Flag   CEU004
      *                                                                   CEU004
     C                     CALL 'AOSARDR0'                 Rtv SAR Dtls   CEU004
      *                                                    Input:         CEU004
     C                     PARM '       ' P@RTCD  7        -Return Code   CEU004
     C                     PARM '*VERIFY' P@OPTN  7        -Option        CEU004
     C                     PARM 'CEU004'  P@SARD  6        -SAR No        CEU004
      *                                                    Output:        CEU004
     C           SCSARD    PARM SCSARD    DSFDY            -Format        CEU004
      *                                                                   CEU004
     C           P@RTCD    IFEQ *BLANK                     If Found       CEU004
     C                     MOVE 'Y'       CEU004  1         Set SAR Flag  CEU004
      *                                                                   CEU004
     C                     ELSE                            Else           CEU004
     C           P@RTCD    IFNE '*NRF   '                   If # NoRecFnd CEU004
     C                     MOVEL'SCSARDPD'DBFILE             Set File     CEU004
     C                     MOVEL'*VERIFY' DBKEY              Set Key      CEU004
     C                     Z-ADD22        DBASE              Set DBase RefCEU004
     C                     SETON                     U7U8LR  Set Ind      CEU004
     C                     SETON                     99      Set Ind      CEU004
     C                     EXSR *PSSR                        Dump         CEU004
     C                     ENDIF                            End If        CEU004
     C                     ENDIF                           End If         CEU004
      *                                                                   CEU004
     C** Access bank details
     C*
     C                     CALL 'AOBANKR0'
     C                     PARM '*MSG   ' @RTCD   7
     C                     PARM '*FIRST ' @OPTN   7
     C           SDBANK    PARM SDBANK    DSFDY
     C*
     C           @RTCD     IFNE *BLANK
     C           *LOCK     IN   LDA
     C                     MOVEL'LE1160  'DBPGM
     C                     MOVEL'SDBANKPD'DBFILE           ************
     C                     MOVEL@OPTN     DBKEY            * DBERR 01 *
     C                     Z-ADD1         DBASE            ************
     C                     OUT  LDA
     C                     SETON                     U7U8
     C                     GOTO END
     C                     ELSE
     C*
     C** Check system date format, DDMMYY OR MMDDYY.
     C*
     C           BJDFIN    COMP 'M'                      98MMDDYY, 98 ON
     C                     END
      *                                                                   119889
      ** Check if CLE004 is switched on                                   119889
      *                                                                   119889
     C                     CALL 'AOSARDR0'                                119889
     C                     PARM *BLANKS   @RTCD                           119889
     C                     PARM '*KEY   ' @OPTN                           119889
     C                     PARM 'CLE004'  PSARD   6                       119889
     C           SCSARD    PARM SCSARD    DSFDY                           119889
     C*                                                                   119889
     C** Error Processing                                                 119889
     C*                                                                   119889
     C           @RTCD     IFEQ *BLANKS                                   119889
     C                     MOVE 'Y'       CLE004  1                       119889
     C                     ELSE                                           119889
     C                     MOVE 'N'       CLE004                          119889
     C           @RTCD     IFNE '*NRF    '                                119889
     C                     SETON                     U7U8LR               119889
     C                     MOVEL'SCSARDPD'DBFILE           ************   119889
     C                     MOVEL'CLE004'  DBKEY            * DBERR 20 *   119889
     C                     Z-ADD20        DBASE            ************   119889
     C                     EXSR *PSSR                                     119889
     C                     ENDIF                                          119889
     C                     ENDIF                                          119889
      *                                                                   119889
     C                     MOVE *BLANK    WOPN1                           119889
     C                     MOVE *BLANK    WOPN2                           119889
     C*
     C** Access customer lending data
     C*
     C                     CALL 'AOCLNDR0'
     C                     PARM '*DBERR ' @RTCD   7
     C                     PARM '*FIRST ' @OPTN   7
     C********** SDCLND    PARM SDCLND    DSFDY                                               CLE134
     C           SDCLND    PARM SDCLND    DSSDY                                               CLE134
     C*
     C                     MOVE '0'       *IN61
     C           @RTCD     IFNE *BLANK
     C           *LOCK     IN   LDA
     C                     MOVEL'LE1160  'DBPGM
     C                     MOVEL'SDCLNDPD'DBFILE           ************
     C                     MOVEL@OPTN     DBKEY            * DBERR 23 *
     C                     Z-ADD23        DBASE            ************
     C                     OUT  LDA
     C                     SETON                     U7U8
     C                     GOTO END
     C                     ELSE
     C           BPGIAV    IFEQ 'Y'
     C                     MOVE '1'       *IN61
     C                     END
     C                     END
     C*
     C** Access general ledger details
     C*
     C**********           CALL 'AOGELRR0'                                                    CGL029
     C                     CALL 'AOGELRR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7
     C                     PARM '*FIRST ' @OPTN   7
     C********** SDGELR    PARM SDGELR    DSFDY                                               CGL029
     C           SDGELR    PARM SDGELR    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANKS
     C                     SETON                     31
     C                     END
     C   31      *LOCK     IN   LDA
     C   31                MOVEL'LE1160  'DBPGM
     C   31                MOVEL'SDGELRPD'DBFILE
     C   31                MOVEL@OPTN     DBKEY
     C   31                Z-ADD2         DBASE
     C   31                OUT  LDA                        ************
     C   31                SETON                     U7U8  * DBERR 02 *
     C   31                GOTO END                        ************
     C*
     C** Acces trading data
     C*
     C                     CALL 'AOTRADR0'
     C                     PARM '*MSG   ' @RTCD   7
     C                     PARM '*FIRST ' @OPTN   7
     C           SDTRAD    PARM SDTRAD    DSFDY
     C           @RTCD     IFNE *BLANK
     C                     SETON                     31
     C                     END
     C   31      *LOCK     IN   LDA
     C   31                MOVEL'LE1160  'DBPGM
     C   31                MOVEL'SDTRADPD'DBFILE
     C   31                MOVEL@OPTN     DBKEY
     C   31                Z-ADD3         DBASE
     C   31                OUT  LDA                        ************
     C   31                SETON                     U7U8  * DBERR 03 *
     C   31                GOTO END                        ************
     C*
     C** Access midas module details
     C*
     C                     CALL 'AOMMODR0'
     C                     PARM '*MSG   ' @RTCD   7
     C                     PARM '*FIRST ' @OPTN   7
     C           SDMMOD    PARM SDMMOD    DSFDY
     C           @RTCD     IFNE *BLANK
     C                     SETON                     31
     C                     END
     C   31      *LOCK     IN   LDA
     C   31                MOVEL'LE1160  'DBPGM
     C   31                MOVEL'SDMMODPD'DBFILE
     C   31                MOVEL@OPTN     DBKEY
     C   31                Z-ADD4         DBASE
     C   31                OUT  LDA                        ************
     C   31                SETON                     U7U8  * DBERR 04 *
     C   31                GOTO END                        ************
      *                                                                                     CLE075BO
      ** Access SD Message Management                                                       CLE075BO
      *                                                                                     CLE075BO
     C                     CALL 'AOMGMER0'                                                  CLE075BO
     C                     PARM '*MSG    '@RTCD                                             CLE075BO
     C                     PARM '*FIRST  '@OPTN                                             CLE075BO
     C           SDMGME    PARM SDMGME    DSFDY                                             CLE075BO
      *                                                                                     CLE075BO
     C           @RTCD     IFNE *BLANK                                                      CLE075BO
     C           *LOCK     IN   LDA                                                         CLE075BO
     C                     MOVEL'LE1160  'DBPGM                                             CLE075BO
     C                     MOVEL'SDMGMEPD'DBFILE                                            CLE075BO
     C                     Z-ADD7         DBASE                                             CLE075BO
     C                     OUT  LDA                                                         CLE075BO
     C                     SETON                     U7U8LR                                 CLE075BO
     C                     EXSR *PSSR                                                       CLE075BO
     C                     END                                                              CLE075BO
      *                                                                   CLE005
      ** Check if CLE005 is switched on                                   CLE005
      *                                                                   CLE005
     C                     CALL 'AOSARDR0'                                CLE005
     C                     PARM *BLANKS   @RTCD                           CLE005
     C                     PARM '*KEY   ' @OPTN                           CLE005
     C                     PARM 'CLE005'  PSARD   6                       CLE005
     C           SCSARD    PARM SCSARD    DSFDY                           CLE005
     C*                                                                   CLE005
     C** Error Processing                                                 CLE005
     C*                                                                   CLE005
     C           @RTCD     IFEQ *BLANKS                                   CLE005
     C                     MOVE 'Y'       CLE005  1                       CLE005
     C                     ELSE                                           CLE005
     C                     MOVE 'N'       CLE005                          CLE005
     C           @RTCD     IFNE '*NRF    '                                CLE005
     C           *LOCK     IN   LDA                                       CLE005
     C                     MOVEL'SCSARDPD'DBFILE           ************   CLE005
     C                     MOVEL'CLE005'  DBKEY            * DBERR 24 *   CLE005
     C                     Z-ADD24        DBASE            ************   CLE005
     C                     MOVEL'LE1160  'DBPGM                           CLE005
     C                     OUT  LDA                                       CLE005
     C                     SETON                     U7U8LR               CLE005
     C                     GOTO END                                       CLE005
     C                     ENDIF                                          CLE005
     C                     ENDIF                                          CLE005
      *                                                                   CEU020              CLE031
      ** Check if CLE031 is on                                                                CLE031
      *                                                                                       CLE031
     C                     MOVE 'N'       CLE031  1                                           CLE031
     C**********           MOVE '0'       *IN49                                        CLE031 219250
     C                     CALL 'AOSARDR0'                                                    CLE031
     C                     PARM *BLANKS   @RTCD                                               CLE031
     C                     PARM '*KEY   ' @OPTN                                               CLE031
     C                     PARM 'CLE031'  PSARD                                               CLE031
     C           SCSARD    PARM SCSARD    DSFDY                                               CLE031
     C           @RTCD     IFEQ *BLANKS                                                       CLE031
     C                     MOVE 'Y'       CLE031                                              CLE031
     C**********           MOVE '1'       *IN49                                        CLE031 219250
     C                     ELSE                                                               CLE031
     C           @RTCD     IFNE '*NRF    '                                                    CLE031
     C                     MOVEL'SCSARDPD'DBFILE                                              CLE031
     C                     Z-ADD28        DBASE                                               CLE031
     C                     MOVEL'CEU020'  DBKEY                                               CLE031
     C                     SETON                     U7U8LR                                   CLE031
     C                     SETON                     99                                       CLE031
     C                     EXSR *PSSR                                                         CLE031
     C                     GOTO END                                                           CLE031
     C                     ENDIF                                                              CLE031
     C                     ENDIF                                                              CLE031
      *                                                                   CLE033
      ** Check if CLE033 is switched on                                   CLE033
      *                                                                   CLE033
     C                     CALL 'AOSARDR0'                                CLE033
     C                     PARM *BLANKS   @RTCD                           CLE033
     C                     PARM '*KEY   ' @OPTN                           CLE033
     C                     PARM 'CLE033'  PSARD   6                       CLE033
     C           SCSARD    PARM SCSARD    DSFDY                           CLE033
     C*                                                                   CLE033
     C** Error Processing                                                 CLE033
     C*                                                                   CLE033
     C           @RTCD     IFEQ *BLANKS                                   CLE033
     C                     MOVE 'Y'       CLE033  1                       CLE033
      * If CLE033 is on, check system value for settlement currency:                          218782
     C                     CALL 'AOSVALR0'                                                    218782
     C                     PARM *BLANKS   @RTCD                                               218782
     C                     PARM SVAL,1    P@OP01 20                                           218782
     C                     PARM *BLANKS   P@VL01200                                           218782
     C                     PARM *BLANKS   P@OP02 20                                           218782
     C                     PARM *BLANKS   P@VL02200                                           218782
     C                     PARM *BLANKS   P@OP03 20                                           218782
     C                     PARM *BLANKS   P@VL03200                                           218782
     C                     PARM *BLANKS   P@OP04 20                                           218782
     C                     PARM *BLANKS   P@VL04200                                           218782
     C                     PARM *BLANKS   P@OP05 20                                           218782
     C                     PARM *BLANKS   P@VL05200                                           218782
     C                     PARM *BLANKS   P@OP06 20                                           218782
     C                     PARM *BLANKS   P@VL06200                                           218782
     C                     PARM *BLANKS   P@OP07 20                                           218782
     C                     PARM *BLANKS   P@VL07200                                           218782
     C                     PARM *BLANKS   P@OP08 20                                           218782
     C                     PARM *BLANKS   P@VL08200                                           218782
     C                     PARM *BLANKS   P@OP09 20                                           218782
     C                     PARM *BLANKS   P@VL09200                                           218782
     C                     PARM *BLANKS   P@OP10 20                                           218782
     C                     PARM *BLANKS   P@VL10200                                           218782
     C********** SDSVAL    PARM SDSVAL    DSSDY                                        218782 222373
      *                                                                                       218782
     C           @RTCD     IFNE *BLANKS                                                       218782
     C           *LOCK     IN   LDA                                                           218782
     C                     MOVEL'LE1160  'DBPGM     P                                         218782
     C                     MOVEL'SDSVALPD'DBFILE           ************                       218782
     C                     MOVELSVAL,1    DBKEY            * DBERR 26 *                       218782
     C                     Z-ADD26        DBASE            ************                       218782
     C                     OUT  LDA                                                           218782
     C                     SETON                     U7U8LR  Set Ind                          218782
     C                     GOTO END                                                           218782
     C                     ELSE                                                               218782
      *                                                                                       218782
      ** Save value of Settlement09Postings in a one character field                          218782
     C                     MOVELP@VL01    SET09   1                                           218782
     C                     ENDIF                                                              218782
     C                     ELSE                                           CLE033
     C                     MOVE 'N'       CLE033                          CLE033
     C           @RTCD     IFNE '*NRF    '                                CLE033
     C           *LOCK     IN   LDA                                       CLE033
     C                     MOVEL'SCSARDPD'DBFILE           ************   CLE033
     C                     MOVEL'CLE033'  DBKEY            * DBERR 25 *   CLE033
     C                     Z-ADD25        DBASE            ************   CLE033
     C                     MOVEL'LE1160  'DBPGM                           CLE033
     C                     OUT  LDA                                       CLE033
     C                     SETON                     U7U8LR               CLE033
     C                     GOTO END                                       CLE033
     C                     ENDIF                                          CLE033
     C                     ENDIF                                          CLE033
     C/COPY WNCPYSRC,LE1160C009
     C*
     C** Define work fields
     C*
     C           *LIKE     DEFN CNA1      ONA1
     C           *LIKE     DEFN CNA2      ONA2
     C*
     C** Counter for number of telexed
     C*
     C                     Z-ADD0         TOTLX   30
     C*
     C** Check if branch names are to be printed
     C*
     C           BRNC      COMP 'Y'                      70
     C*
     C** Initialise count for records output to LENXT
     C*
     C   U4                Z-ADD2         RECXTO  50
     C/COPY WNCPYSRC,LE1160C001
      *                                                                                     CLE075BO
      ** Full Cache SDCURRPD                                                                CLE075BO
      *                                                                                     CLE075BO
     C           *LOVAL    SETLLSDCURRL1                                                    CLE075BO
     C                     Z-ADD250       A       30                                        CLE075BO
     C           A         OCUR SDCURR                                                      CLE075BO
     C                     READ SDCURRL1                 12                                 CLE075BO
     C                     MOVE A6CYCD    #CCY,A                                            CLE075BO
     C                     MOVE A6NBDP    CDP                                               CLE075BO
     C                     MOVE A6INCY    INCY                                              CLE075BO
     C           *IN12     DOWEQ'0'                                                         CLE075BO
     C           A         ANDGT0                                                           CLE075BO
     C                     SUB  1         A                                                 CLE075BO
     C           A         OCUR SDCURR                                                      CLE075BO
     C                     READ SDCURRL1                 12                                 CLE075BO
     C                     MOVE A6CYCD    #CCY,A                                            CLE075BO
     C                     MOVE A6NBDP    CDP                                               CLE075BO
     C                     MOVE A6INCY    INCY                                              CLE075BO
     C                     ENDDO                                                            CLE075BO
     C           A         IFEQ 0                                                           CLE075BO
     C                     MOVEL'SDCURRPD'DBFILE                                            CLE075BO
     C                     MOVEL'OVRFLOW' DBKEY                                             CLE075BO
     C                     SETON                     U7U8LR                                 CLE075BO
     C                     EXSR *PSSR                                                       CLE075BO
     C                     ENDIF                                                            CLE075BO
     C                     Z-ADDA         CURARR  30                                        CLE075BO
      *                                                                                     CLE075BO
      ** Full Cache SDBRCHPD                                                                CLE075BO
      *                                                                                     CLE075BO
     C           *LOVAL    SETLLSDBRCHL1                                                    CLE075BO
     C                     Z-ADD900       B       30                                        CLE075BO
     C           B         OCUR SDBRCH                                                      CLE075BO
     C                     READ SDBRCHL1                 12                                 CLE075BO
     C                     MOVE A8BRCD    #BCH,B                                            CLE075BO
     C                     MOVE A8BRNM    BRNM                                              CLE075BO
     C           *IN12     DOWEQ'0'                                                         CLE075BO
     C           B         ANDGT0                                                           CLE075BO
     C                     SUB  1         B                                                 CLE075BO
     C           B         OCUR SDBRCH                                                      CLE075BO
     C                     READ SDBRCHL1                 12                                 CLE075BO
     C                     MOVE A8BRCD    #BCH,B                                            CLE075BO
     C                     MOVE A8BRNM    BRNM                                              CLE075BO
     C                     ENDDO                                                            CLE075BO
     C           B         IFEQ 0                                                           CLE075BO
     C                     MOVEL'SDBRCHPD'DBFILE                                            CLE075BO
     C                     MOVEL'OVRFLOW' DBKEY                                             CLE075BO
     C                     SETON                     U7U8LR                                 CLE075BO
     C                     EXSR *PSSR                                                       CLE075BO
     C                     ENDIF                                                            CLE075BO
     C                     Z-ADDB         BCHARR  30                                        CLE075BO
      *                                                                                     CLE075BO
      ** LRU element key and record arrival sequence                                        CLE075BO
      *                                                                                     CLE075BO
     C                     Z-ADD0         NOSKEY 130                                        CLE075BO
     C           *LIKE     DEFN NOSKEY    NOSSEQ                                            CLE075BO
      *                                                                                     CLE075BO
      ** Set start index to upper limit of LRU Caching arrays                               CLE075BO
      *                                                                                     CLE075BO
     C                     Z-ADD200       NOSIDX  40                                        CLE075BO
     C           *LIKE     DEFN NOSIDX    NOSPRV                                            CLE075BO
     C           *LIKE     DEFN NOSIDX    F                                                 CLE075BO
      *                                                                                     CLE075BO
      ** Initialize work fields of LRU array routines                                       CLE075BO
      *                                                                                     CLE075BO
     C                     MOVE *BLANK    NOSIC   1                                         CLE075BO
     C                     MOVE *BLANKS   KEYNOS  5                                         CLE075BO
     C                     Z-ADD200       NOSPRV                                            CLE075BO
     C                     Z-ADD200       F                                                 CLE075BO
     C*
     C           BY01      TAG
     C*
     C** Ignore the following processing if not a detail record
     C*
     C  N03N05             GOTO ENDMB
     C*
     C** Processing is multibranching
     C*
     C           *IN88     IFEQ '1'
     C*
     C** On a level break, close previous file then open another one
     C*
     C           *INL1     IFEQ '1'
     C                     CLOSELE1160P1
     C                     CLOSELE1160P2                                  119889
      *                                                                   119889
      ** Initialise open printer file flags                               119889
      *                                                                   119889
     C                     MOVE '0'       *IN62                           119889
     C                     MOVE '0'       *IN63                           119889
     C                     MOVE *BLANK    WOPN1   1                       119889
     C                     MOVE *BLANK    WOPN2   1                       119889
     C*
     C                     SETON                       75  ALLOW OUTPUT
     C***********          OPEN LE1160P1                                  119889
     C                     Z-ADD0         PAGE
     C                     Z-ADD0         PAGE1
     C*
     C** Ensure totals spool file is recorded by RCF
     C*
     C           AMTP      IFEQ 'PT'                                      119889
     C           AMTP      OREQ 'PF'                                      119889
     C                     OPEN LE1160P2                                  119889
     C                     Z-ADDSFNUM2    ZSNUM   60                      119889
     C                     MOVELSFILE2    SFILE  10                       119889
     C                     MOVE 'Y'       WOPN2                           119889
     C                     MOVE '1'       *IN63                           119889
     C                     ELSE                                           119889
     C                     OPEN LE1160P1                                  119889
     C                     Z-ADDSFNUM1    ZSNUM   60
     C                     MOVELSFILE1    SFILE  10                       119889
     C                     MOVE 'Y'       WOPN1                           119889
     C                     MOVE '1'       *IN62                           119889
     C                     ENDIF                                          119889
      *                                                                   119889
     C*
     C                     CALL 'ZSFILE'
     C                     PARM           SEQ     5
     C                     PARM BRCA      SENTY
     C***********          PARM           SFILE1                          119889
     C                     PARM           SFILE                           119889
     C                     PARM           ZSNUM
     C                     PARM           ZSERR   1
     C*
     C** Error duting ZSFILE processing, return to calling program
     C*
     C           ZSERR     IFEQ 'Y'
     C                     SETON                     U7U8LR
     C                     RETRN
     C                     END
     C*
     C** Retrieve settlement branch name
     C*
     C                     Z-ADDBCHARR    B                                                 CLE075BO
     C           BRCA      LOKUP#BCH,B                   56                                 CLE075BO
     C           *IN56     IFEQ '1'                                                         CLE075BO
     C           B         OCUR SDBRCH                                                      CLE075BO
     C                     MOVE *BLANKS   @RTCD                                             CLE075BO
     C                     ELSE                                                             CLE075BO
     C**********           CALL 'AOBRCHR0'                                                    CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7
     C                     PARM '*KEY   ' @OPTN   7
     C                     PARM BRCA      @DSNB   3
     C********** SDBRCH    PARM SDBRCH    DSFDY                                               CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANK
     C           *LOCK     IN   LDA
     C                     SETON                     U7U8LR
     C                     MOVEL'LE1160  'DBPGM
     C                     MOVEL'SDBRCHPD'DBFILE           ************
     C                     MOVEL@DSNB     DBKEY            * DBERR 05 *
     C                     Z-ADD5         DBASE            ************
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     END
     C                     ENDIF                                                            CLE075BO
     C   U7                GOTO END
     C                     ELSE                                           119889
      *                                                                   119889
      ** Check if printer file (P1 or P2) is already open, during         119889
      ** change of amendment types                                        119889
      *                                                                   119889
     C           AMTP      IFEQ 'PT'                                      119889
     C           WOPN2     ANDEQ*BLANK                                    119889
     C           AMTP      OREQ 'PF'                                      119889
     C           WOPN2     ANDEQ*BLANK                                    119889
     C           AMTP      OREQ 'PI'                                      119889
     C           WOPN1     ANDEQ*BLANK                                    119889
     C           AMTP      OREQ 'RE'                                      119889
     C           WOPN1     ANDEQ*BLANK                                    119889
      *                                                                   119889
     C                     MOVE '1'       *IN75                           119889
      *                                                                   119889
      **  ENSURE TOTALS SPOOL FILE RECORDED BY RCF                        119889
      *                                                                   119889
     C           AMTP      IFEQ 'PT'                                      119889
     C           AMTP      OREQ 'PF'                                      119889
     C                     OPEN LE1160P2                                  119889
     C                     Z-ADDSFNUM2    ZSNUM   60                      119889
     C                     MOVELSFILE2    SFILE  10                       119889
     C                     MOVE 'Y'       WOPN2                           119889
     C                     MOVE '1'       *IN63                           119889
     C                     ELSE                                           119889
     C                     OPEN LE1160P1                                  119889
     C                     Z-ADDSFNUM1    ZSNUM   60                      119889
     C                     MOVELSFILE1    SFILE  10                       119889
     C                     MOVE 'Y'       WOPN1                           119889
     C                     MOVE '1'       *IN62                           119889
     C                     ENDIF                                          119889
      *                                                                   119889
     C                     CALL 'ZSFILE'                                  119889
     C                     PARM           SEQ     5                       119889
     C                     PARM BRCA      SENTY                           119889
     C                     PARM           SFILE                           119889
     C                     PARM           ZSNUM                           119889
     C                     PARM           ZSERR   1                       119889
      *                                                                   119889
     C           *LOCK     IN   LDA                                       119889
     C           ZSERR     IFEQ 'Y'                                       119889
      ** ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM        119889
     C                     SETON                     U7U8LR               119889
     C                     RETRN                                          119889
     C                     ENDIF                                          119889
     C**                                                                  119889
     C** RETRIEVE SETTLEMENT BRANCH NAME                                  119889
     C                     Z-ADDBCHARR    B                                                 CLE075BO
     C           BRCA      LOKUP#BCH,B                   56                                 CLE075BO
     C           *IN56     IFEQ '1'                                                         CLE075BO
     C           B         OCUR SDBRCH                                                      CLE075BO
     C                     MOVE *BLANKS   @RTCD                                             CLE075BO
     C                     ELSE                                                             CLE075BO
     C**********           CALL 'AOBRCHR0'                                             119889 CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       119889
     C                     PARM '*KEY   ' @OPTN   7                       119889
     C                     PARM BRCA      @DSNB   3                       119889
     C********** SDBRCH    PARM SDBRCH    DSFDY                                        119889 CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANK                                    119889
     C                     SETON                     U7U8LR               119889
     C                     MOVEL'SDBRCHPD'DBFILE           ***************119889
     C                     MOVEL@DSNB     DBKEY            * DBERROR 21  *119889
     C                     Z-ADD21        DBASE            ***************119889
     C                     EXSR *PSSR                                     119889
     C                     END                                            119889
     C                     ENDIF                                                            CLE075BO
     C   U7                GOTO END                                       119889
     C                     ENDIF                                          119889
      *                                                                   119889
     C*
     C                     END
     C*
     C** Not multibranching
     C*
     C                     ELSE
     C                     SETON                     75
     C*
     C** First cycle
     C*
     C           P1OP      IFNE 'Y'
     C                     MOVE 'Y'       P1OP    1
     C***********          OPEN LE1160P1                                  119889
     C                     Z-ADD0         PAGE
     C                     Z-ADD0         PAGE1
     C*
     C** Ensure that report spool file is recorded by RCF
     C           AMTP      IFEQ 'PT'                                      119889
     C           AMTP      OREQ 'PF'                                      119889
     C                     OPEN LE1160P2                                  119889
     C                     Z-ADDSFNUM2    ZSNUM   60                      119889
     C                     MOVELSFILE2    SFILE  10                       119889
     C                     MOVE 'Y'       WOPN2                           119889
     C                     MOVE '1'       *IN62                           119889
     C                     ELSE                                           119889
     C                     OPEN LE1160P1                                  119889
     C*
     C                     Z-ADDSFNUM1    ZSNUM
     C                     MOVELSFILE1    SFILE  10                       119889
     C                     MOVE 'Y'       WOPN1                           119889
     C                     MOVE '1'       *IN61                           119889
     C                     ENDIF                                          119889
      *                                                                   119889
     C*
     C                     CALL 'ZSFILE'
     C                     PARM           SEQ
     C                     PARM BRCA      SENTY   3
     C***********          PARM           SFILE1                          119889
     C                     PARM           SFILE                           119889
     C                     PARM           ZSNUM
     C                     PARM           ZSERR   1
     C*
     C** Error during ZSFILE processing, return to calling program
     C*
     C           ZSERR     IFEQ 'Y'
     C                     SETON                     U7U8LR
     C                     RETRN
     C                     END
     C                     ELSE                                           119889
      *                                                                   119889
      ** Check if printer file (P1 or P2) is already open, during         119889
      ** change of amendment types                                        119889
      *                                                                   119889
     C           AMTP      IFEQ 'PT'                                      119889
     C           WOPN2     ANDEQ*BLANK                                    119889
     C           AMTP      OREQ 'PF'                                      119889
     C           WOPN2     ANDEQ*BLANK                                    119889
     C           AMTP      OREQ 'PI'                                      119889
     C           WOPN1     ANDEQ*BLANK                                    119889
     C           AMTP      OREQ 'RE'                                      119889
     C           WOPN1     ANDEQ*BLANK                                    119889
      *                                                                   119889
      ** Ensure report spool file recorded by RCF                         119889
      *                                                                   119889
     C           AMTP      IFEQ 'PT'                                      119889
     C           AMTP      OREQ 'PF'                                      119889
     C                     OPEN LE1160P2                                  119889
     C                     Z-ADDSFNUM2    ZSNUM   60                      119889
     C                     MOVELSFILE2    SFILE  10                       119889
     C                     MOVE 'Y'       WOPN2                           119889
     C                     MOVE '1'       *IN62                           119889
     C                     ELSE                                           119889
     C                     OPEN LE1160P1                                  119889
     C                     Z-ADDSFNUM1    ZSNUM                           119889
     C                     MOVELSFILE1    SFILE  10                       119889
     C                     MOVE 'Y'       WOPN1                           119889
     C                     MOVE '1'       *IN61                           119889
     C                     ENDIF                                          119889
      *                                                                   119889
     C                     OUT  LDA                                       119889
      *                                                                   119889
     C                     CALL 'ZSFILE'                                  119889
     C                     PARM           SEQ                             119889
     C                     PARM BRCA      SENTY   3                       119889
     C                     PARM           SFILE                           119889
     C                     PARM           ZSNUM                           119889
     C                     PARM           ZSERR   1                       119889
      *                                                                   119889
     C           *LOCK     IN   LDA                                       119889
     C           ZSERR     IFEQ 'Y'                                       119889
      ** ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM        119889
     C                     SETON                     U7U8LR               119889
     C                     RETRN                                          119889
     C                     ENDIF                                          119889
     C                     ENDIF                                          119889
      *                                                                   119889
     C                     END
     C                     END
      *                                                                   CEU004
     C           CEU004    IFEQ 'Y'                        If SAR On      CEU004
     C           SCCY      ANDNE*BLANKS                    And Stl Ccy    CEU004
     C           CLE031    ANDNE'Y'                                                           CLE031
     C                     MOVE SCCY      WKCCY   3         Set Ccy       CEU004
      *                                                                   CEU004
     C                     ELSE                            Else           CEU004
     C                     MOVE CCY       WKCCY             Set Ccy       CEU004
     C                     ENDIF                           End If         CEU004
      *                                                                   CEU004
     C*
     C           ENDMB     TAG
     C*
     C** Set up blank field for counterparty SWIFT ID
     C*
     C   U4                MOVE '        'CSWID  12
     C   U4                MOVEL'    '    CSWID
     C                     EXSR SETOF
     C      03             SETON                     24
     C      05             SETON                     24
     C*                                                                   CCG008
     C** Process only detail records with CNFY='Y'                        CCG008
     C           *IN24     IFEQ *ON                                       CCG008
     C           CNFY      ANDNE'Y'                                       CCG008
     C                     MOVE *OFF      *IN24                           CCG008
     C                     ENDIF                                          CCG008
     C*                                                                   CCG008
     C     N24             GOTO FIN
     C*
     C** Access SDCUSTPD record to generate telex for this customer
     C*
     C   U1 46             EXSR CLCHN
     C   U1 46N31TLXR      COMP 'Y'                      47
     C*
     C   47                ADD  1         TOTLX
     C*
     C** Database error on CLINT
     C*
     C   U1 46 31*LOCK     IN   LDA
     C   U1 46 31          MOVEL'LE1160  'DBPGM
     C   U1 46 31          MOVEL'SDCUSTPD'DBFILE
     C   U1 46 31          MOVELCLKY      DBKEY
     C   U1 46 31          Z-ADD6         DBASE
     C   U1 46 31          OUT  LDA                        ************
     C   U1 46 31          SETON                     U7U8  * DBERR 06 *
     C   U7                GOTO END                        ************
     C*
     C** Check amendment type
     C*
     C           AMTP      COMP 'PI'                     20
     C        N20AMTP      COMP 'RE'                     21
      *                                                                   119889
      ** Print confirmation for Principal Transfers                       119889
      *                                                                   119889
     C           CLE004    IFEQ 'Y'                                       119889
     C           AMTP      IFEQ 'PT'                                      119889
     C           AMTP      OREQ 'PF'                                      119889
     C                     MOVE '1'       *IN13                           119889
     C                     MOVE *BLANK    WEND    1                       119889
     C                     EXSR PRINTR                                    119889
      *                                                                   119889
     C           WEND      IFEQ *BLANK                                    119889
     C                     GOTO FIN                                       119889
     C                     ELSE                                           119889
     C                     GOTO END                                       119889
     C                     ENDIF                                          119889
     C                     ENDIF                                          119889
     C                     ENDIF                                          119889
     C   20
     COR 21                GOTO BY01A
     C                     GOTO FIN
     C*
     C** Processing type if 'RE'
     C*
     C           BY01A     TAG
     C      20             GOTO BY03
     C           PTYP      COMP 62                     3232
     C         32          GOTO BY02
     C           PTYP      COMP 64                       34
     C         34          GOTO BY02
     C           PTYP      COMP 66                       36
     C         36          GOTO BY02
      *                                                                   CLE005
     C           CLE005    IFEQ 'Y'                                       CLE005
     C           PTYP      IFEQ 68                                        CLE005
     C                     MOVE '1'       *IN34                           CLE005
     C                     GOTO BY02                                      CLE005
     C                     ENDIF                                          CLE005
     C           PTYP      IFEQ 69                                        CLE005
     C                     MOVE '1'       *IN36                           CLE005
     C                     GOTO BY02                                      CLE005
     C                     ENDIF                                          CLE005
     C                     ENDIF                                          CLE005
      *                                                                   CLE005
     C                     GOTO FIN
     C           BY02      TAG
     C                     SETON                     33
     C*
     C** Check repay type
     C*
     C           REPT      COMP 2                    1819
     C*
     C** Check value date against extract date
     C*
     C           VDAT      COMP EXTD                 25
     C           BY03      TAG
     C*
     C** Check if processing type is for PI
     C*
     C           PTYP      COMP 62                       48
     C           PTYP      COMP 66                       30
     C           PTYP      IFEQ 69                                        CLE005
     C           CLE005    ANDEQ'Y'                                       CLE005
     C                     MOVE '1'       *IN30                           CLE005
     C                     ENDIF                                          CLE005
     C*
     C** Determine amendment/cancellation narrative
     C*
     C   03                TESTB'7'       LAIN           37
     C   03 37             TESTB'2'       LAIN       37
     C*
     C** Check if counterparty is a SWIFT member
     C** and set on 39 if output to LENXTAB
     C*
     C   U4                EXSR CLCHN
     C                     MOVELCNUM      CLKY   10
     C*
     C** Remove old routing
     C*
     C   38 20 03
     COR 38 21 03          SETON                     39
     C   21 25 18
     COR 21 25 19          SETOF                     39
     C*
     C** Insert new MG routing
     C*
     C                     MOVE CSID      @BIC    4
     C                     MOVELBRCA      @DSNB   3
     C                     MOVELCNUM      @CUST   6
     C                     EXSR ROUT
     C*
     C** LEEXT record is produced if lending message flag is on
     C** - message can be rerouted via message management
     C*
     C           BGSWCL    IFEQ 'Y'
     C                     SETON                     39
     C                     ELSE
     C                     SETOF                     39
     C                     END
     C*
     C** If network is 'PAPER' and non-ISO confs are to be produced,
     C** set off 96 to suppress auto-transmission text on printout
     C*
     C           BGSWCL    IFEQ 'Y'
     C**********           CALL 'AOMGMER0'                                                  CLE075BO
     C**********           PARM '*MSG    '@RTCD                                             CLE075BO
     C**********           PARM '*FIRST  '@OPTN                                             CLE075BO
     C********** SDMGME    PARM SDMGME    DSFDY                                             CLE075BO
     C*****************************************************************                     CLE075BO
     C********** @RTCD     IFNE *BLANK                                                      CLE075BO
     C********** *LOCK     IN   LDA                                                         CLE075BO
     C**********           MOVEL'LE1160  'DBPGM                                             CLE075BO
     C**********           MOVEL'SDMGMEPD'DBFILE           ************                     CLE075BO
     C**********           Z-ADD7         DBASE            * DBERR 07 *                     CLE075BO
     C**********           OUT  LDA                        ************                     CLE075BO
     C**********           SETON                     U7U8LR                                 CLE075BO
     C**********           EXSR *PSSR                                                       CLE075BO
     C**********           END                                                              CLE075BO
     C*****************************************************************                     CLE075BO
     C           @NWRK     IFEQ 'PAPER'
     C           ENFFCR    ANDEQ'Y'
     C                     SETOF                     96
     C                     ELSE
     C                     SETON                     96
     C                     END
     C*
     C                     ELSE
     C                     SETOF                     96
     C                     END
     C*
     C** Check alternate name and address code if equal to 'B'
     C** If equal to 'B', bypass alt name and address validation
     C*
     C           NACD      IFNE 'B'
     C*
     C                     MOVELCNUM      CUST    6
     C                     MOVELNACD      ADCD    1
     C                     SETOF                     31
     C                     CALL 'AOALTNR0'
     C                     PARM '*MSG   ' @RTCD   7
     C                     PARM '*KEY   ' @OPTN   7
     C                     PARM           CUST
     C                     PARM           ADCD
     C           SDALTN    PARM SDALTN    DSFDY
     C*
     C                     END
     C*
     C** If no alternate name & address found, use the one in SDCUSTPD
     C*
     C           @RTCD     IFNE *BLANKS
     C           NACD      OREQ 'B'
     C                     MOVELCNUM      CLKY
     C                     EXSR CLCHN
     C           *IN31     IFNE '1'
     C                     MOVE BBCNA1    CNA1
     C                     MOVE BBCNA2    CNA2
     C                     MOVE BBCNA3    CNA3
     C                     MOVE BBCNA4    CNA4
     C                     ELSE
     C           *LOCK     IN   LDA
     C                     MOVEL'LE1160  'DBPGM
     C                     MOVEL'SDCUSTPD'DBFILE           ************
     C                     MOVELCNUM      DBKEY            * DBERR 08 *
     C                     Z-ADD8         DBASE            ************
     C                     OUT  LDA
     C                     SETON                     U7U8LR
     C                     GOTO END
     C                     END
     C*
     C** If alternate name and address found, use that town
     C*
     C                     ELSE
     C                     MOVELBCCRTN    CTWN
     C                     END
     C*
     C** Access CLOAN to get the corresponding customer confirmation
     C** field for the loan
     C*
     C                     SETOF                     7374
     C                     MOVELLNRF      CLKEY1  7
     C                     MOVE 'A'       CLKEY1
     C           CLKEY1    CHAINCLOAN                99
     C*
     C** Access MLOAN if no record found                                  166111
     C*                                                                   166111
     C           *IN99     IFEQ '1'                                       166111
     C                     MOVE '0'       *IN99                           166111
     C           *LIKE     DEFN LNRF      LNRFO                           166111
     C**********           Z-ADDLNRF      LNRFO                                        166111 CLE148
     C********** LNRFO     CHAINMLOAN                99                                166111 CLE148
     C           LNRF      CHAINMLOAN                99                                       CLE148
      * Move MCLONCL field value into CLOANCL                                                 207045
     C                     MOVE XOLNO     OLNOCL                                              207045
     C                     ENDIF                                          166111
     C*
     C** Database error if no record found
     C*
     C           *IN99     IFEQ '1'
     C           *LOCK     IN   LDA
     C                     MOVEL'LE1160  'DBPGM
     C                     MOVEL'CLOAN   'DBFILE           ************
     C                     MOVELCLKEY1    DBKEY            * DBERR 09 *
     C                     Z-ADD9         DBASE            ************
     C                     OUT  LDA
     C                     SETON                     U7U8LR
     C                     GOTO END
     C*
     C** Check processing type, if for participations sold or purchased
     C*
     C                     ELSE
     C/COPY WNCPYSRC,LE1160C010
     C           PTYP      IFEQ 66
     C           PTYP      OREQ 67
     C                     MOVE '1'       *IN73
     C                     END
     C*
     C           PTYP      IFEQ 64
     C           PTYP      OREQ 65
     C                     MOVE '1'       *IN74
     C                     END
      *                                                                   CLE005
     C           PTYP      IFEQ 69                                        CLE005
     C           CLE005    ANDEQ'Y'                                       CLE005
     C                     MOVE '1'       *IN73                           CLE005
     C                     ENDIF                                          CLE005
      *                                                                   CLE005
     C           PTYP      IFEQ 68                                        CLE005
     C           CLE005    ANDEQ'Y'                                       CLE005
     C                     MOVE '1'       *IN74                           CLE005
     C                     ENDIF                                          CLE005
     C*
     C** If customer confirmation field is not blank, then loan
     C** customer's name and address is printed first
     C*
     C                     MOVE CNA1      ONA1
     C                     MOVE CNA2      ONA2
     C********** COCUCL    IFNE *ZEROS                                                        CSD027
     C           COCUCL    IFNE *BLANKS                                                       CSD027
     C           COCUCL    ANDNE'000000'                                                    BUG11784
     C                     MOVE *BLANKS   CLKY
     C                     MOVELCOCUCL    CLKY
     C                     EXSR CLCHN
     C*
     C** Database error occured
     C*
     C           *IN31     IFEQ '1'
     C           *LOCK     IN   LDA
     C                     MOVEL'LE1160  'DBPGM
     C                     MOVEL'SDCUSTPD'DBFILE           ************
     C                     MOVELCOCUCL    DBKEY            * DBERR 10 *
     C                     Z-ADD10        DBASE            ************
     C                     OUT  LDA
     C                     SETON                     U7U8LR
     C                     GOTO END
     C*
     C** Move file fields into output fields
     C*
     C                     ELSE
     C                     MOVELBBCNA1    CNA1
     C                     MOVELBBCNA2    CNA2
     C                     MOVELBBCNA3    CNA3
     C                     MOVELBBCNA4    CNA4
     C                     END
     C                     END
     C*
     C** If participations sold, access customer details for the name
     C** of the borrower
     C*
     C           *IN73     IFEQ '1'
     C                     MOVELOLNOCL    CLKEY2
     C                     MOVE 'A'       CLKEY2  7
     C*
     C** Chain to CLOAN using the original borrower (OLNO)
     C*
     C           CLKEY2    CHAINCLOAN                99
     C*                                                                                       207045
     C** Access MLOAN if no record found                                                      207045
     C*                                                                                       207045
     C           *IN99     IFEQ '1'                                                           207045
     C                     MOVE '0'       *IN99                                               207045
     C***********          Z-ADDOLNOCL    LNRFO                                         207045CSD027
     C**********           MOVE OLNOCL    LNRFO                                        CSD027 CLE148
     C********** LNRFO     CHAINMLOAN                99                                207045 CLE148
     C           LNRF      CHAINMLOAN                99                                       CLE148
     C                     MOVELXCNUM     CNUMCL                                              207045
     C                     ENDIF                                                              207045
     C*
     C** Database error if no record found
     C*
     C           *IN99     IFEQ '1'
     C           *LOCK     IN   LDA
     C                     MOVEL'LE1160  'DBPGM
     C                     MOVEL'CLOAN   'DBFILE           ************
     C                     MOVELCLKEY2    DBKEY            * DBERR 11 *
     C                     Z-ADD11        DBASE            ************
     C                     OUT  LDA
     C                     SETON                     U7U8LR
     C                     GOTO END
     C                     ELSE
     C                     MOVE *BLANKS   CLKY
     C                     MOVELCNUMCL    CLKY
     C                     EXSR CLCHN
     C*
     C** Database error occured
     C*
     C           *IN31     IFEQ '1'
     C           *LOCK     IN   LDA
     C                     MOVEL'LE1160  'DBPGM
     C                     MOVEL'SDCUSTPD'DBFILE           ************
     C                     MOVELCNUMCL    DBKEY            * DBERR 12 *
     C                     Z-ADD12        DBASE            ************
     C                     OUT  LDA
     C                     SETON                     U7U8
     C                     GOTO END
     C                     END
     C*
     C** If participations sold, write name and address of the original
     C** loan's customer before that of the loan's customer
     C*
     C                     MOVE BBCNA1    ONA1
     C                     MOVE BBCNA2    ONA2
     C*
     C                     END
     C                     END
     C*
     C** If participations purchased, the original borrower's name and
     C** address is written after the loan customer's name and address
     C*
     C           *IN74     IFEQ '1'
     C                     MOVE *BLANKS   CLKY
     C                     MOVELOLNOCL    CLKY
     C                     EXSR CLCHN
     C*
     C** Database error occured
     C*
     C           *IN31     IFEQ '1'
     C           *LOCK     IN   LDA
     C                     MOVEL'LE1160  'DBPGM
     C                     MOVEL'SDCUSTPD'DBFILE           ************
     C                     MOVELOLNOCL    DBKEY            * DBERR 23 *
     C                     Z-ADD23        DBASE            ************
     C                     OUT  LDA
     C                     SETON                     U7U8LR
     C                     GOTO END
     C*
     C** Move file fields into output fields
     C*
     C                     ELSE
     C                     MOVELBBCNA1    CNA1
     C                     MOVELBBCNA2    CNA2
     C                     MOVELBBCNA3    CNA3
     C                     MOVELBBCNA4    CNA4
     C                     END
     C                     END
     C*
     C                     END
     C*
     C** Pick up branck name if required
     C*
     C     N70             GOTO BY04
     C*
     C** Access branch codes
     C*
     C                     Z-ADDBCHARR    B                                                 CLE075BO
     C           BRCA      LOKUP#BCH,B                   56                                 CLE075BO
     C           *IN56     IFEQ '1'                                                         CLE075BO
     C           B         OCUR SDBRCH                                                      CLE075BO
     C                     MOVE *BLANKS   @RTCD                                             CLE075BO
     C                     ELSE                                                             CLE075BO
     C**********           CALL 'AOBRCHR0'                                                    CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7
     C                     PARM '*KEY   ' @OPTN   7
     C                     PARM BRCA      @DSNB   3
     C********** SDBRCH    PARM SDBRCH    DSFDY                                               CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C*
     C           @RTCD     IFNE *BLANKS
     C                     SETON                     31
     C                     END
     C   31      *LOCK     IN   LDA
     C   31                MOVEL'LE1160  'DBPGM
     C   31                MOVEL'SDBRCHPD'DBFILE
     C   31                MOVEL@DSNB     DBKEY
     C   31                Z-ADD13        DBASE
     C   31                OUT  LDA                        ************
     C   31                SETON                     U7U8  * DBERR 13 *
     C   31                GOTO END                        ************
     C                     ENDIF                                                            CLE075BO
     C*
     C           BY04      TAG
     C*
     C** Use CCY to access SDCURRPD for its decimal places
     C*
     C                     Z-ADDCURARR    A                                                 CLE075BO
     C********** WKCCY     LOKUP#CCY,A                   47                        CLE075BO MD020304
     C           WKCCY     LOKUP#CCY,A                   66                                 MD020304
     C           *IN47     IFEQ '1'                                                         CLE075BO
     C           A         OCUR SDCURR                                                      CLE075BO
     C                     ELSE                                                             CLE075BO
     C                     CALL 'AOCURRR0'
     C                     PARM '*MSG   ' @RTCD   7
     C                     PARM '*KEY   ' @OPTN   7
     C***********          PARM CCY       TKEY    3                       CEU004
     C                     PARM WKCCY     TKEY    3        -Currency      CEU004
     C           SDCURR    PARM SDCURR    DSSDY
     C           @RTCD     IFNE *BLANK
     C                     SETON                     31
     C                     END
     C   31      *LOCK     IN   LDA
     C   31                MOVEL'LE1160  'DBPGM
     C   31                MOVE 'SDCURRPD'DBFILE
     C   31                MOVELCCY       DBKEY
     C   31                Z-ADD14        DBASE
     C   31                OUT  LDA                        ************
     C   31                SETON                     U7U8  * DBERR 14 *
     C/COPY WNCPYSRC,LE1160C002
     C   31                GOTO END                        ************
     C                     ENDIF                                                            CLE075BO
     C/COPY WNCPYSRC,LE1160C004
     C*                                                                   153784
     C                     MOVE SCCY      P@TOCY            Set To Ccy    153784
     C                     MOVE CCY       P@FRCY            Set From Ccy  153784
      *                                                                   153784
      *   Do not call Euro conversion program if Settlement currency      153784
      *   is not 'IN' or if 'to' and 'from' currencies are identical.     153784
      *                                                                   153784
     C           P@TOCY    IFNE *BLANKS                                   153784
     C                     SETOF                         99               153784
     C                     Z-ADDCURARR    A                                                 CLE075BO
     C********** P@TOCY    LOKUP#CCY,A                   47                        CLE075BO MD020304
     C           P@TOCY    LOKUP#CCY,A                   66                                 MD020304
     C           *IN47     IFEQ '1'                                                         CLE075BO
     C           A         OCUR SDCURR                                                      CLE075BO
     C                     ELSE                                                             CLE075BO
     C                     CALL 'AOCURRR0'                                153784
     C                     PARM '*MSG   ' @RTCD   7                       153784
     C                     PARM '*KEY   ' @OPTN   7                       153784
     C                     PARM P@TOCY    TKEY    3                       153784
     C           SDCURR    PARM SDCURR    DSSDY                           153784
     C           @RTCD     IFNE *BLANK                                    153784
     C                     SETON                     99                   153784
     C           *LOCK     IN   LDA                                       153784
     C                     MOVEL'LE1160  'DBPGM                           153784
     C                     MOVE 'SDCURRPD'DBFILE                          153784
     C                     MOVELP@TOCY    DBKEY            ************   153784
     C                     Z-ADD88        DBASE            *  DBASE 88*   153784
     C                     SETON                     U7U8LR************   153784
     C                     OUT  LDA                        ************   153784
     C                     GOTO END                                       153784
     C                     END                                            153784
     C                     ENDIF                                                            CLE075BO
     C                     ENDIF                                          153784
      *                                                                   CEU004
     C           CEU004    IFEQ 'Y'                        If SAR On      CEU004
     C           SCCY      ANDNE*BLANKS                    And Stl Ccy    CEU004
     C           INCY      ANDEQ'Y'                                       153784
     C           SCCY      ANDNECCY                                       153784
     C           CLE031    ANDNE'Y'                                                           CLE031
      *                                                                                       190430
     C           CEU004    OREQ 'Y'                                                           190430
     C           SCCY      ANDNE*BLANKS                                                       190430
     C           SCCY      ANDEQBKEURO                                                        190430
     C           SCCY      ANDNECCY                                                           190430
     C           CLE031    ANDNE'Y'                                                           CLE031
     C*                                                                   153784
     C                     MOVE '000'     DECX    3                                           190430
     C                     MOVELPRAM      PRAMX  16                                           190430
     C                     MOVE DECX      PRAMX                                               190430
     C                     MOVELINTA      INTAX  16                                           190430
     C                     MOVE DECX      INTAX                                               190430
     C                     MOVELTAMT      TAMTX  16                                           190430
     C                     MOVE DECX      TAMTX                                               190430
      *                                                                                       190430
     C**********           MOVE PRAM      P@FRAM            Set From Amt               CEU004 190430
     C                     MOVE PRAMX     P@FRAM                                              190430
     C                     EXSR XCAMT                       Cvrt Amount   CEU004
     C                     MOVE WKAMT     WKPRAM 130        Set Prncpl AmtCEU004
      *                                                                   CEU004
     C**********           MOVE INTA      P@FRAM            Set From Amt               CEU004 190430
     C                     MOVE INTAX     P@FRAM                                              190430
     C                     EXSR XCAMT                       Cvrt Amount   CEU004
     C                     MOVE WKAMT     WKINTA 130        Set Intrst AmtCEU004
      *                                                                   CEU004
     C**********           MOVE TAMT      P@FRAM            Set From Amt               CEU004 190430
     C                     MOVE TAMTX     P@FRAM                                              190430
     C                     EXSR XCAMT                       Cvrt Amount   CEU004
     C                     MOVE WKAMT     WKTAMT 130        Set Total Amt CEU004
      *                                                                   CEU004
     C/COPY WNCPYSRC,LE1160C007
     C                     ELSE                            Else           CEU004
     C                     MOVE PRAM      WKPRAM            Set Prncpl AmtCEU004
     C                     MOVE INTA      WKINTA            Set Intrst AmtCEU004
     C                     MOVE TAMT      WKTAMT            Set Total Amt CEU004
     C/COPY WNCPYSRC,LE1160C008
     C                     ENDIF                           End If         CEU004
      *                                                                   CEU004
     C*
     C           CDP       COMP 1                      4041
     C           CDP       COMP 2                    43  42
      *                                                                                       CLE031
      ** Convert principal amount to settlement currency                                      CLE031
      ** if the transaction currency is different from                                        CLE031
      ** the settlement currency                                                              CLE031
      ** However, do not convert to settlement currency if the                                218782
      ** system value Settlement09Postings = 'T' for 'Transaction                             218782
      ** Currency' and Settlement type is 09.                                                 218782
     C           CLE033    IFNE 'Y'                                                           218782
     C           SET09     ORNE 'T'                                                           218782
     C           SETP      ORNE '09'                                                          218782
      *                                                                                       CLE031
     C           CLE031    IFEQ 'Y'                                                           CLE031
     C           SCCY      IFNE *BLANK                                                        CLE031
     C           SCCY      ANDNECCY                                                           CLE031
     C           PSCY      ORNE *BLANK                                                        CLE031
     C           PSCY      ANDNECCY                                                           CLE031
      *                                                                                       CLE031
      ** Initialise settlement printer fields                                                 CLE031
      *                                                                                       CLE031
     C                     MOVE *ON       *IN60                                               219250
     C                     MOVE *BLANK    WPCCY   3                                           CLE031
     C                     MOVE *BLANK    WRCCY   3                                           CLE031
     C                     Z-ADD0         WPSAMT 130                                          CLE031
     C                     Z-ADD0         WRSAMT 130                                          CLE031
      *                                                                                       CLE031
      ** Check if loan is a parts sold                                                        CLE031
      *                                                                                       CLE031
     C                     MOVE 'N'       WPARTS  1                                           CLE031
     C           PTYP      IFEQ 66                                                            CLE031
     C           CLE005    OREQ 'Y'                                                           CLE031
     C           PTYP      ANDEQ69                                                            CLE031
     C                     MOVE 'Y'       WPARTS                                              CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
      ** Access currency details file to get the in currency indicator                        CLE031
      ** and number of decimal places of the transaction currency                             CLE031
      ** receipt and payment currency                                                         CLE031
      *                                                                                       CLE031
     C                     MOVE CCY       WCURR   3                                           CLE031
     C                     EXSR SRCURR                                                        CLE031
      *                                                                                       CLE031
     C           *INU7     IFEQ *ON                                                           CLE031
     C           *INU8     OREQ *ON                                                           CLE031
     C                     GOTO END                                                           CLE031
     C                     ELSE                                                               CLE031
     C                     Z-ADDWNBDP     WTNBDP  20                                          CLE031
     C                     MOVE WINCY     WTINCY  1                                           CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
     C           SCCY      IFNE *BLANK                                                        CLE031
     C                     MOVE SCCY      WCURR                                               CLE031
     C                     EXSR SRCURR                                                        CLE031
      *                                                                                       CLE031
     C           *INU7     IFEQ *ON                                                           CLE031
     C           *INU8     OREQ *ON                                                           CLE031
     C                     GOTO END                                                           CLE031
     C                     ELSE                                                               CLE031
     C                     Z-ADDWNBDP     WRNBDP  20                                          CLE031
     C                     MOVE WINCY     WRINCY  1                                           CLE031
     C           WRNBDP    COMP 1                      8081                                   CLE031
     C           WRNBDP    COMP 2                    83  82                                   CLE031
     C                     ENDIF                                                              CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
     C           PSCY      IFNE *BLANK                                                        CLE031
     C                     MOVE PSCY      WCURR                                               CLE031
     C                     EXSR SRCURR                                                        CLE031
      *                                                                                       CLE031
     C           *INU7     IFEQ *ON                                                           CLE031
     C           *INU8     OREQ *ON                                                           CLE031
     C                     GOTO END                                                           CLE031
     C                     ELSE                                                               CLE031
     C                     Z-ADDWNBDP     WPNBDP  20                                          CLE031
     C                     MOVE WINCY     WPINCY  1                                           CLE031
     C           WPNBDP    COMP 1                      8485                                   CLE031
     C           WPNBDP    COMP 2                    87  86                                   CLE031
     C                     ENDIF                                                              CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
     C                     SELEC                                                              CLE031
      *                                                                                       CLE031
      ** Principal Increase                                                                   CLE031
      *                                                                                       CLE031
     C           AMTP      WHEQ 'PI'                                                          CLE031
      *                                                                                       CLE031
     C                     Z-ADDPRAM      WPRAM  130                                          CLE031
      *                                                                                       CLE031
      ** If loan is not a parts sold, convert principal                                       CLE031
      ** amount to pay settlement currency                                                    CLE031
      *                                                                                       CLE031
     C           WPARTS    IFEQ 'N'                                                           CLE031
      *                                                                                       CLE031
      ** If either from the transaction currency and settlement currency                      CLE031
      ** is an In currency, convert using EU0200 otherwise use ZCONV                          CLE031
      *                                                                                       CLE031
     C           WTINCY    IFEQ 'Y'                                                           CLE031
     C           WPINCY    OREQ 'Y'                                                           CLE031
     C                     MOVE 'PE'      WCONV   2                                           CLE031
     C                     EXSR SRCONV                                                        CLE031
     C           *INU7     IFEQ *ON                                                           CLE031
     C           *INU8     OREQ *ON                                                           CLE031
     C                     GOTO END                                                           CLE031
     C                     ENDIF                                                              CLE031
     C                     ELSE                                                               CLE031
     C                     MOVE 'PS'      WCONV                                               CLE031
     C                     EXSR SRCONV                                                        CLE031
     C           *INU7     IFEQ *ON                                                           CLE031
     C           *INU8     OREQ *ON                                                           CLE031
     C                     GOTO END                                                           CLE031
     C                     ENDIF                                                              CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
     C                     MOVE PSCY      WPSCY   3                                           CLE031
     C                     Z-ADDWSAMT     WPSAMT 130                                          CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
      ** If loan is a parts sold, convert principal                                           CLE031
      ** amount to receive settlement currency                                                CLE031
      *                                                                                       CLE031
     C           WPARTS    IFEQ 'Y'                                                           CLE031
      *                                                                                       CLE031
      ** If either from the transaction currency and settlement currency                      CLE031
      ** is an In currency, convert using EU0200 otherwise use ZCONV                          CLE031
      *                                                                                       CLE031
     C           WTINCY    IFEQ 'Y'                                                           CLE031
     C           WRINCY    OREQ 'Y'                                                           CLE031
     C                     MOVE 'RE'      WCONV                                               CLE031
     C                     EXSR SRCONV                                                        CLE031
     C           *INU7     IFEQ *ON                                                           CLE031
     C           *INU8     OREQ *ON                                                           CLE031
     C                     GOTO END                                                           CLE031
     C                     ENDIF                                                              CLE031
     C                     ELSE                                                               CLE031
     C                     MOVE 'RS'      WCONV                                               CLE031
     C                     EXSR SRCONV                                                        CLE031
     C           *INU7     IFEQ *ON                                                           CLE031
     C           *INU8     OREQ *ON                                                           CLE031
     C                     GOTO END                                                           CLE031
     C                     ENDIF                                                              CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
     C                     MOVE SCCY      WRSCY   3                                           CLE031
     C                     Z-ADDWSAMT     WRSAMT 130                                          CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
      ** Principal Repayment                                                                  CLE031
      *                                                                                       CLE031
     C           AMTP      WHEQ 'RE'                                                          CLE031
      *                                                                                       CLE031
     C                     Z-ADDTAMT      WPRAM                                               CLE031
      *                                                                                       CLE031
      ** If loan is not a parts sold, convert total                                           CLE031
      ** amount to receive settlement currency                                                CLE031
      *                                                                                       CLE031
     C           WPARTS    IFEQ 'N'                                                           CLE031
      *                                                                                       CLE031
      ** If either from the transaction currency and settlement currency                      CLE031
      ** is an In currency, convert using EU0200 otherwise use ZCONV                          CLE031
      *                                                                                       CLE031
     C           WTINCY    IFEQ 'Y'                                                           CLE031
     C           WRINCY    OREQ 'Y'                                                           CLE031
     C                     MOVE 'RE'      WCONV   2                                           CLE031
     C                     EXSR SRCONV                                                        CLE031
     C           *INU7     IFEQ *ON                                                           CLE031
     C           *INU8     OREQ *ON                                                           CLE031
     C                     GOTO END                                                           CLE031
     C                     ENDIF                                                              CLE031
     C                     ELSE                                                               CLE031
     C                     MOVE 'RS'      WCONV                                               CLE031
     C                     EXSR SRCONV                                                        CLE031
     C           *INU7     IFEQ *ON                                                           CLE031
     C           *INU8     OREQ *ON                                                           CLE031
     C                     GOTO END                                                           CLE031
     C                     ENDIF                                                              CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
     C                     MOVE SCCY      WRSCY                                               CLE031
     C                     Z-ADDWSAMT     WRSAMT                                              CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
      ** If loan is a parts sold, convert total                                               CLE031
      ** amount to pay settlement currency                                                    CLE031
      *                                                                                       CLE031
     C           WPARTS    IFEQ 'Y'                                                           CLE031
      *                                                                                       CLE031
      ** If either from the transaction currency and settlement currency                      CLE031
      ** is an In currency, convert using EU0200 otherwise use ZCONV                          CLE031
      *                                                                                       CLE031
     C           WTINCY    IFEQ 'Y'                                                           CLE031
     C           WPINCY    OREQ 'Y'                                                           CLE031
     C                     MOVE 'PE'      WCONV                                               CLE031
     C                     EXSR SRCONV                                                        CLE031
     C           *INU7     IFEQ *ON                                                           CLE031
     C           *INU8     OREQ *ON                                                           CLE031
     C                     GOTO END                                                           CLE031
     C                     ENDIF                                                              CLE031
     C                     ELSE                                                               CLE031
     C                     MOVE 'PS'      WCONV                                               CLE031
     C                     EXSR SRCONV                                                        CLE031
     C           *INU7     IFEQ *ON                                                           CLE031
     C           *INU8     OREQ *ON                                                           CLE031
     C                     GOTO END                                                           CLE031
     C                     ENDIF                                                              CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
     C                     MOVE PSCY      WPSCY                                               CLE031
     C                     Z-ADDWSAMT     WPSAMT                                              CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
     C                     ENDSL                                                              CLE031
     C                     ENDIF                                                              CLE031
     C                     ENDIF                                                              CLE031
     C                     ENDIF                                                              218782
     C*
     C** Set required indicators for settlement instructions, and
     C** access required customer details
     C*
     C                     EXSR SETINS
     C   U7 U8             GOTO END
     C*
     C** Use ZDATE2 to convert value number into date format
     C*
     C                     MOVE VDAT      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    OVDAT   7
     C/COPY WNCPYSRC,LE1160C006
     C*
     C** Arrange dates into DDMMYY format for output to telex file
     C*
     C                     MOVE ZYEAR     ZWRK4
     C                     MOVELZMTH      ZWRK4
     C                     MOVE ZWRK4     TXDATE  60
     C                     MOVELZDAY      TXDATE
     C*
     C** Check for negatives on RE.
     C*
     C        N21          GOTO FIN
     C           INTA      COMP 0                      44
     C           TAMT      COMP 0                      45
     C           FIN       TAG
     C*
     C** Maintain file controls
     C*
     C           RECTOT    ADD  1         RECTOT  60
     C   U4 39   RECXTO    ADD  1         RECXTO
     C*
     C           END       TAG
     C      U7 U8          SETON                     LR
     C*
     CLR U7 U8             GOTO LREND
     C*
     C** Check controls
     C*
     CLR         RECTOT    COMP NORE                 7171
     CLR 71                SETON                     U8
     CLR         TOTLX     COMP 0                    72
     CLR         LREND     TAG
     C*
     C** Ensure that report spool file is recorded by RCF
     C*
     CLR                   Z-ADDSFNUMU    ZSNUMU  60
     C*
     CLR                   CALL 'ZSFILE'
     CLR                   PARM           SEQ
     CLR                   PARM *BLANKS   SENTY
     CLR                   PARM           SFILEU
     CLR                   PARM           ZSNUMU
     CLR                   PARM           ZSERR   1
     C*
     C** Error occurred while doing ZSFILE processing, return to
     C** calling program
     C*
     CLR         ZSERR     IFEQ 'Y'
     CLR                   SETON                     U7U8
     CLR                   RETRN
     CLR                   END
     C*
     C** Execute error subroutine if database erro exists
     C*
     CLR U7 U8             EXSR *PSSR
      /EJECT                                                                                  CLE031
      *****************************************************************                       CLE031
      *                                                               *                       CLE031
      *  SRCURR - Access Currency Details File                        *                       CLE031
      *                                                               *                       CLE031
      *****************************************************************                       CLE031
      *                                                                                       CLE031
     C           SRCURR    BEGSR                                                              CLE031
      *                                                                                       CLE031
     C                     Z-ADD0         WNBDP   20                                          CLE031
     C                     MOVE *BLANK    WINCY   1                                           CLE031
      *                                                                                       CLE031
     C                     Z-ADDCURARR    A                                                 CLE075BO
     C********** WCURR     LOKUP#CCY,A                   47                        CLE075BO MD020304
     C           WCURR     LOKUP#CCY,A                   66                                 MD020304
     C           *IN47     IFEQ '1'                                                         CLE075BO
     C           A         OCUR SDCURR                                                      CLE075BO
     C                     ELSE                                                             CLE075BO
     C                     CALL 'AOCURRR0'                                                    CLE031
     C                     PARM *BLANK    @RTCD                                               CLE031
     C                     PARM '*KEY   ' @OPTN                                               CLE031
     C                     PARM WCURR     PCURR   3                                           CLE031
     C           SDCURR    PARM SDCURR    DSSDY                                               CLE031
      *                                                                                       CLE031
     C           @RTCD     IFNE *BLANK                                                        CLE031
     C                     MOVE *ON       *INU7                                               CLE031
     C                     MOVE *ON       *INU8                                               CLE031
     C                     MOVEL'SDCURRPD'DBFILE                                              CLE031
     C                     MOVELPCURR     DBKEY                                               CLE031
     C                     Z-ADD26        DBASE                                               CLE031
     C                     EXSR *PSSR                                                         CLE031
     C                     ENDIF                                                              CLE031
     C                     ENDIF                                                            CLE075BO
      *                                                                                       CLE031
     C                     Z-ADDCDP       WNBDP                                               CLE031
     C                     MOVE INCY      WINCY                                               CLE031
      *                                                                                       CLE031
     C                     ENDSR                                                              CLE031
      *****************************************************************                       CLE031
      /EJECT                                                                                  CLE031
      *****************************************************************                       CLE031
      *                                                               *                       CLE031
      *  SRCONV - Convert to setttlement currency                     *                       CLE031
      *                                                               *                       CLE031
      *****************************************************************                       CLE031
      *                                                                                       CLE031
     C           SRCONV    BEGSR                                                              CLE031
      *                                                                                       CLE031
     C                     Z-ADD0         WSAMT  150                                          CLE031
     C                     Z-ADD0         ZAMTCO 150                                          CLE031
      *                                                                                       CLE031
     C                     SELEC                                                              CLE031
      *                                                                                       CLE031
     C           WCONV     WHEQ 'RS'                                                          CLE031
     C           WCONV     OREQ 'PS'                                                          CLE031
     C                     Z-ADDWPRAM     ZAMTCI 150                                          CLE031
     C                     MOVE CCY       ZCCYI   3                                           CLE031
     C                     Z-ADDWTNBDP    ZCDPI   10                                          CLE031
     C           WCONV     IFEQ 'PS'                                                          CLE031
     C                     Z-ADDPEXR      ZEXCH  138                                          CLE031
     C                     MOVE PEXI      ZMD     1                                           CLE031
     C                     MOVE PSCY      ZCCYO   3                                           CLE031
     C                     Z-ADDWPNBDP    ZCDPO   10                                          CLE031
     C                     ELSE                                                               CLE031
     C                     Z-ADDREXR      ZEXCH                                               CLE031
     C                     MOVE REXI      ZMD                                                 CLE031
     C                     MOVE SCCY      ZCCYO                                               CLE031
     C                     Z-ADDWRNBDP    ZCDPO                                               CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
     C                     EXSR ZCONV                                                         CLE031
      *                                                                                       CLE031
     C                     Z-ADDZAMTCO    WSAMT                                               CLE031
      *                                                                                       CLE031
     C           WCONV     WHEQ 'RE'                                                          CLE031
     C           WCONV     OREQ 'PE'                                                          CLE031
     C                     Z-ADD0         P@FRAM                                              CLE031
     C                     MOVE WPRAM     P@FRAM                                              CLE031
     C                     MOVE CCY       P@FRCY                                              CLE031
     C           WCONV     IFEQ 'PE'                                                          CLE031
     C                     MOVE PSCY      P@TOCY                                              CLE031
     C                     ELSE                                                               CLE031
     C                     MOVE SCCY      P@TOCY                                              CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
     C                     CALL 'EU0200'                                                      CLE031
     C                     PARM *BLANK    P@RTCD                                              CLE031
     C                     PARM           P@FRAM                                              CLE031
     C                     PARM           P@FRCY                                              CLE031
     C                     PARM           P@TOCY                                              CLE031
     C                     PARM           P@OUTA                                              CLE031
     C                     PARM           P@INTA                                              CLE031
     C                     PARM           P@EXRT                                              CLE031
     C                     PARM           P@MDIN                                              CLE031
      *                                                                                       CLE031
     C           P@RTCD    IFNE *BLANK                                                        CLE031
     C                     MOVE *ON       *INU7                                               CLE031
     C                     MOVE *ON       *INU8                                               CLE031
     C                     MOVEL'EU0200  'DBFILE                                              CLE031
     C                     MOVELCCY       DBKEY                                               CLE031
     C                     Z-ADD27        DBASE                                               CLE031
     C                     EXSR *PSSR                                                         CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
     C                     ENDSL                                                              CLE031
      *                                                                                       CLE031
     C                     ENDSR                                                              CLE031
     C/EJECT
     C*****************************************************************
     C* CLCHN  - Access CLINT file and detect data base errors.       *
     C* Called by: Main cycle                                         *
     C* Calls    : None                                               *
     C*****************************************************************
     C*
     C           CLCHN     BEGSR
     C*
     C                     SETOF                     31
     C                     CALL 'AOCUSTR0'
     C                     PARM '*MSG   ' @RTCD
     C                     PARM '*KEY   ' @OPTN
     C                     PARM           CLKY
     C                     PARM *BLANKS   KEYSTS  7
     C           SDCUST    PARM SDCUST    DSSDY
     C           @RTCD     IFNE *BLANKS
     C                     SETON                     31
     C                     END
     C*
     C                     ENDSR
     C/EJECT
     C*****************************************************************
     C*  SETOF  - Sets off all resulting indicators at the start of   *
     C*           the main cycle processing.                          *
     C*  Called by: Main cycle                                        *
     C*  Calls    : None                                              *
     C*****************************************************************
     C*
     C           SETOF     BEGSR
     C*
     C                     SETOF                     202133
     C                     SETOF                     323436
     C                     SETOF                     375051
     C                     SETOF                     525354
     C                     SETOF                     555725
     C                     SETOF                     585944
     C                     SETOF                     4524
     C                     SETOF                     47
     C                     SETOF                     1819
     C   U4                SETOF                     3839
     C                     SETOF                     2729
     C                     SETOF                     1314                 119889
     C                     SETOF                     1617                 119889
     C                     SETOF                     35                                       202628
     C                     SETOF                     4960                                     219250
     C*
     C                     ENDSR
     C/EJECT
     C*****************************************************************
     C*  SETINS - Checks settlement instruction for output            *
     C*  Called by: Main cycle                                        *
     C*  Calls    : None                                              *
     C*****************************************************************
     C*
     C           SETINS    BEGSR
     C*
     C           SETP      COMP '  '                     50
     C      50             MOVE '00'      SETP
     C      50             GOTO SETEND
     C           SETP      COMP '00'                     50
     C         50          GOTO SETEND
     C           SETP      COMP '02'                     52
     C         52          GOTO SETEND
     C           SETP      COMP '03'                     53
     C         53          GOTO SETEND
     C           SETP      COMP '05'                     55
     C         55          GOTO SETEND
     C           SETP      COMP '06'                     53
     C         53          GOTO SETEND
     C           SETP      COMP '12'                     57
     C         57          GOTO SETEND
     C           SETP      COMP '14'                     58
     C         58          GOTO SETEND
     C           SETP      COMP '04'                     54
     C         54          GOTO SET04
      *                                                                   CLE033
     C           CLE033    IFEQ 'Y'                                       CLE033
     C           SETP      ANDEQ'09'                                      CLE033
     C                     MOVE *ON       *IN49                           CLE033
     C                     GOTO SETEND                                    CLE033
     C**********           ELSE                                                        CLE033 219250
     C**********           MOVE *OFF      *IN49                                        CLE033 219250
     C                     ENDIF                                          CLE033
      *                                                                   CLE033
     C                     SETON                         51
     C*
     C** 51 On, therefore settlement = 01,07,08
     C*
     C      50             GOTO SETEND
     C*
     C** Pick up our nostro details
     C*
     C** If the settlement details filed for our nostro is blank,
     C** suppress the write to LENXTAB, hence, no message wil be produced
     C*
     C           *IN22     IFEQ '1'
     C           AMTP      ANDNE'RE'                                                          182229
     C                     MOVE '0'       *IN39
     C                     END
     C*
     C      22             GOTO THRS
     C                     MOVELOSAC      OUR     2
      *                                                                                       CLE031
     C           CLE031    IFEQ 'Y'                                                           CLE031
     C                     SELEC                                                              CLE031
     C           WPARTS    WHEQ 'N'                                                           CLE031
     C           AMTP      ANDEQ'PI'                                                          CLE031
     C           PSCY      ANDNE*BLANK                                                        CLE031
     C                     MOVE PSCY      WKCCY2  3                                           CLE031
     C           WPARTS    WHEQ 'Y'                                                           CLE031
     C           AMTP      ANDEQ'PI'                                                          CLE031
     C           SCCY      ANDNE*BLANK                                                        CLE031
     C                     MOVE SCCY      WKCCY2                                              CLE031
     C           WPARTS    WHEQ 'N'                                                           CLE031
     C           AMTP      ANDEQ'RE'                                                          CLE031
     C           SCCY      ANDNE*BLANK                                                        CLE031
     C                     MOVE SCCY      WKCCY2                                              CLE031
     C           WPARTS    WHEQ 'Y'                                                           CLE031
     C           AMTP      ANDEQ'RE'                                                          CLE031
     C           PSCY      ANDNE*BLANK                                                        CLE031
     C                     MOVE PSCY      WKCCY2                                              CLE031
     C                     OTHER                                                              CLE031
     C                     MOVE CCY       WKCCY2                                              CLE031
     C                     ENDSL                                                              CLE031
     C                     ELSE                                                               CLE031
     C                     MOVE CCY       WKCCY2                                              CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
     C                     MOVELWKCCY2    KEYNOS                                            CLE075BO
     C                     MOVE OUR       KEYNOS                                            CLE075BO
     C                     ADD  1         NOSSEQ                                            CLE075BO
     C                     EXSR CHKNOS                                                      CLE075BO
      *                                                                                     CLE075BO
      ** Use details from array if KEYNOS is found, otherwise,                              CLE075BO
      ** retrieve details from program call                                                 CLE075BO
      *                                                                                     CLE075BO
     C           NOSIC     IFEQ 'Y'                                                         CLE075BO
      *                                                                                     CLE075BO
      ** Set occurence to index found from #NSK array                                       CLE075BO
      *                                                                                     CLE075BO
     C           F         OCUR SDNOST                                                      CLE075BO
      *                                                                                     CLE075BO
     C                     ELSE                                                             CLE075BO
      *                                                                                     CLE075BO
     C           NOSIDX    IFNE 0                                                           CLE075BO
     C                     Z-ADDNOSIDX    F                                                 CLE075BO
     C                     ELSE                                                             CLE075BO
     C                     Z-ADD1         F                                                 CLE075BO
     C                     MOVEA#NOS      #NSS                                              CLE075BO
     C                     SORTA#NSS                                                        CLE075BO
     C                     Z-ADD#NSS,1    NOSKEY                                            CLE075BO
     C           NOSKEY    LOKUP#NOS,F                   76                                 CLE075BO
     C                     ENDIF                                                            CLE075BO
      *                                                                                     CLE075BO
     C           F         OCUR SDNOST                                                      CLE075BO
     C                     CALL 'AONOSTR0'
     C                     PARM '*MSG   ' @RTCD   7
     C                     PARM '*KEY   ' @OPTN   7
     C                     PARM *BLANKS   @KEYA   6
     C***********          PARM CCY       @KEYB   3                       CEU004
     C**********           PARM WKCCY     @KEYB   3        -Currency                   CEU004 CLE031
     C                     PARM WKCCY2    @KEYB   3                                           CLE031
     C**********           PARM *BLANKS   @KEYC   4                                           CGL029
     C                     PARM *BLANKS   @KEYC  10                                           CGL029
     C                     PARM *BLANKS   @KEYD   2
     C                     PARM OUR       @KEYE   2
     C                     PARM *BLANKS   @BRCD   3
     C                     PARM *BLANKS   @CSSN  10
     C                     PARM *BLANKS   @PNOI   1
     C           SDNOST    PARM SDNOST    DSFDY
     C           @RTCD     IFNE *BLANKS
     C                     SETON                     31
     C                     END
     C         31*LOCK     IN   LDA
     C         31          MOVEL'LE1160  'DBPGM
     C         31          MOVE 'SDNOSTPD'DBFILE
     C         31          MOVELCCY       WK2     5
     C         31          MOVE OUR       WK2
     C         31          MOVELWK2       DBKEY
     C         31          Z-ADD15        DBASE
     C         31          OUT  LDA                        ************
     C         31          SETON                     U7U8  * DBERR 15 *
     C         31          GOTO SETEND                     ************
     C*
     C** Use customer number from nostro rec to access SDCUSTPD
     C*
     C**********           MOVELA7CUST    CLKY                                              MD020304
     C                     EXSR ADDNOS                                                      CLE075BO
     C                     ENDIF                                                            CLE075BO
     C                     MOVELA7CUST    CLKY                                              MD020304
     C                     EXSR CLCHN
     C         31*LOCK     IN   LDA
     C         31          MOVEL'LE1160  'DBPGM
     C         31          MOVELCLKY      DBKEY
     C         31          MOVEL'SDCUSTPD'DBFILE           ************
     C         31          Z-ADD16        DBASE            * DBERR 16 *
     C         31          OUT  LDA                        ************
     C         31          SETON                     U7U8
     C         31          GOTO SETEND
     C*
     C** Store name
     C*
     C                     MOVELBBCNA1    CN2    35
     C                     MOVELCTWN      CT2    20
     C           THRS      TAG
     C*
     C** If the settlement details field for their nostro is blank,
     C** suppress the write to LENXTAB, hence, no message will be
     C** produced
     C*
     C           *IN23     IFEQ '1'
     C           AMTP      ANDNE'RE'                                                          182229
     C                     MOVE '0'       *IN39
     C                     END
     C*
     C      23             GOTO SBY1
     C*
     C** Determine if 'THEIRS' is a counterparty nostro or cust. no.
     C*
     C                     MOVE TSEN      WRK4    4
     C           WRK4      COMP '    '               4646
     C*
     C** If last 4 characters is blank, check if first 6 numeric
     C*
     C**N46******          MOVELTSEN      WRK6    6                                           CSD027
     C**N46******          MOVE WRK6      NUM6    60                                          CSD027
     C**N46******          MOVE NUM6      WRK6X   6                                           CSD027
     C**N46******WRK6      COMP WRK6X                4646                                     CSD027
     C           *IN46     IFEQ *OFF                                                          CSD027
     C                     MOVELTSEN      WRK6    6                                           CSD027
     C                     CALL 'AOCUSTR0'                                                    CSD027
     C                     PARM '*MSG   ' @RTCD                                               CSD027
     C                     PARM '*KEY   ' @OPTN                                               CSD027
     C                     PARM           WRK6                                                CSD027
     C                     PARM *BLANKS   KEYSTS  7                                           CSD027
     C           SDCUST    PARM SDCUST    DSSDY                                               CSD027
     C           @RTCD     IFNE '*CNUM  '                                                     CSD027
     C                     SETON                     46                                       CSD027
     C                     END                                                                CSD027
     C                     END                                                                CSD027
     C*
     C** If last 4 chats non-blank, or first 6 non-numeric, cpty nostroO
     C*
     C      46             GOTO CPNS1
     C                     MOVELWRK6      CLKY
     C                     EXSR CLCHN
     C        N31          MOVELBBCNA1    CN3    35
     C        N31          MOVELCTWN      CT3    20
     C        N31          GOTO SBY1
     C           CPNS1     TAG
     C           SETP      COMP '01'                     59
     C        N59          GOTO SBY1
     C                     MOVELTSEN      WRK8    8
     C                     CALL 'AOCNSTR0'
     C                     PARM '*MSG   ' @RTCD
     C                     PARM '*KEY   ' @OPTN
     C                     PARM WRK8      ARCD    8
     C           SDCNST    PARM SDCNST    DSFDY
     C           @RTCD     IFNE *BLANKS
     C                     SETON                     31
     C                     END
     C        N31          MOVELCPNM      CN3    35
     C        N31          MOVELCPTN      CT3    20
     C      31   *LOCK     IN   LDA
     C      31             MOVEL'LE1160  'DBPGM
     C      31             MOVELWRK8      DBKEY            ************
     C      31             MOVEL'SDCNSTPD'DBFILE           * DBERR 17 *
     C      31             Z-ADD17        DBASE            ************
     C      31             OUT  LDA
     C      31             SETON                     U7U8
     C      31             GOTO SETEND
     C*
     C           SBY1      TAG
     C*
     C** Check beneficiary bank details
     C** Ignore if first line of special instructions is blank
     C*
     C   28                GOTO BENEND
     C*
     C           SPEC5     COMP '/BEN/'              272729
     C   27                GOTO BENEND
     C*
     C** Check for CHIPS number
     C*
     C           SPEC8     COMP '/CH'                    27
     C   27                MOVE SPEC14    WORK6   6
     C   27                MOVE *BLANKS   SPI1
     C   27                MOVE 'CHIPS'   SPEC5
     C   27                MOVE WORK6     SPEC12
     C   27                GOTO BENEND
     C*
     C** Check for fed. wire number
     C*
     C           SPEC8     COMP '/FW'                    27
     C   27                MOVE SPEC17    WORK9   9
     C   27                MOVE *BLANKS   SPI1
     C   27                MOVE 'FED.WIRE'SPEC9
     C   27                MOVE WORK9     SPEC18
     C   27                GOTO BENEND
     C*
     C** Must now be 'ACCOUNT'
     C*
     C                     MOVE SPEC30    WORK25 25
     C                     MOVE *BLANKS   SPI1
     C                     MOVE 'A/C'     SPEC3
     C                     MOVE WORK25    SPEC29
     C*
     C           BENEND    TAG
     C*
     C      26             GOTO SETEND
     C*
     C** If payment pick up for account details
     C*
     C   32
     COR 34                GOTO SETEND
     C                     MOVE FACO      WRK4
     C           WRK4      COMP '    '               4646
     C      46             GOTO CPNS2
     C                     MOVELFACO      WRK6
     C                     MOVELWRK6      CLKY
     C                     EXSR CLCHN
     C     N31             MOVELBBCNA1    CN4    35
     C     N31             MOVELCTWN      CT4    20
     C     N31             GOTO SETEND
     C      31   *LOCK     IN   LDA
     C      31             MOVEL'LE1160  'DBPGM
     C      31             MOVELCLKY      DBKEY            ************
     C      31             MOVEL'SDCUSTPD'DBFILE           * DBERR 18 *
     C      31             Z-ADD18        DBASE            ************
     C      31             OUT  LDA
     C      31             SETON                     U7U8
     C      31             GOTO SETEND
     C           CPNS2     TAG
     C           SETP      COMP '01'                     59
     C     N59             GOTO SETEND
     C                     MOVELFACO      WRK8
     C                     CALL 'AOCNSTR0'
     C                     PARM '*MSG   ' @RTCD
     C                     PARM '*KEY   ' @OPTN
     C                     PARM WRK8      ARCD
     C           SDCNST    PARM SDCNST    DSFDY
     C           @RTCD     IFNE *BLANKS
     C                     SETON                     31
     C                     END
     C        N31          MOVELCPNM      CN4    35
     C        N31          MOVELCPTN      CT4    20
     C      31   *LOCK     IN   LDA
     C      31             MOVEL'LE1160  'DBPGM
     C      31             MOVELWRK8      DBKEY            ************
     C      31             MOVEL'SDCNSTPD'DBFILE           * DBERR 19 *
     C      31             Z-ADD19        DBASE            ************
     C      31             OUT  LDA
     C      31             SETON                     U7U8
     C                     GOTO SETEND
     C           SET04     TAG
     C**********           MOVE OSAC      OUT04   60                                          CGL029
     C                     MOVE OSAC      OUT04  120                                          CGL029
     C*
     C           SETEND    TAG
     C*
     C                     ENDSR
     C/EJECT
     C*****************************************************************
     C*  ROUT   - Determines message routing                          *
     C*  Called by: Main cycle                                        *
     C*  Calls    : NWAD - Determines default network addresses       *
     C*             PRAD - Determines priority network addresses      *
     C*****************************************************************
     C*
     C           ROUT      BEGSR
     C*
     C** Access branch details with Branch code of sender.
     C*
     C                     Z-ADDBCHARR    B                                                 CLE075BO
     C           BRCA      LOKUP#BCH,B                   56                                 CLE075BO
     C           *IN56     IFEQ '1'                                                         CLE075BO
     C           B         OCUR SDBRCH                                                      CLE075BO
     C                     MOVE *BLANKS   @RTCD                                             CLE075BO
     C                     ELSE                                                             CLE075BO
     C**********           CALL 'AOBRCHR0'                                                    CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD
     C                     PARM '*KEY   ' @OPTN
     C                     PARM @DSNB     @BRCD   3
     C           SDBRCH    PARM SDBRCH    DSSDY
     C*
     C** Branch record not found - Error
     C*
     C           @RTCD     IFNE *BLANKS
     C           *LOCK     IN   LDA
     C                     MOVEL'LE1160  'DBPGM
     C                     Z-ADD20        DBASE            **********
     C                     MOVEL@DSNB     DBKEY            * DBERR 20
     C                     MOVEL'SDBRCHPD'DBFILE           **********
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     END
     C                     ENDIF                                                            CLE075BO
     C*
     C** Ssave branch internal customer number & SWIFT TID address
     C*
     C**********           MOVELA8BICN    SECN    60                                          CSD027
     C                     MOVELA8BICN    SECN    6                                           CSD027
     C                     MOVE A8BTID    SCSID  12
     C*
     C** Access SDCUSTPD using branch internal customer number
     C*
     C                     MOVE *BLANKS   @KEY1
     C                     MOVELSECN      @KEY1
     C                     CALL 'AOCUSTR0'
     C                     PARM '*MSG   ' @RTCD
     C                     PARM '*KEY   ' @OPTN
     C                     PARM           @KEY1  10
     C                     PARM *BLANKS   @KYST   7
     C           @CUST     PARM @CUST     DSSDY
     C*
     C** Customer record not found - Error
     C*
     C           @RTCD     IFNE *BLANKS
     C           *LOCK     IN   LDA
     C                     MOVEL'LE1160  'DBPGM
     C                     Z-ADD21        DBASE            ************
     C                     MOVEL@KEY1     DBKEY            * DBERR 21 *
     C                     MOVEL'SDCUSTPD'DBFILE           ************
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     END
     C*
     C** Save sender's addresses & parent customer number
     C*
     C                     MOVE TELX      @TELX  12
     C                     MOVE BBSTAD    @STTX  12
     C*
     C** Access SDCUSTPD using destination customer number
     C*
     C                     MOVE *BLANKS   @KEY1
     C                     MOVEL@CUST     @KEY1
     C                     CALL 'AOCUSTR0'
     C                     PARM '*MSG   ' @RTCD
     C                     PARM '*KEY   ' @OPTN
     C                     PARM           @KEY1  10
     C                     PARM *BLANKS   @KYST   7
     C           @CUST     PARM @CUST     DSSDY
     C*
     C** Determine the routing to the destination customer.
     C*
     C           BBDNW3    IFNE *BLANKS
     C                     EXSR NWAD
     C                     ELSE
     C                     EXSR PRAD
     C                     END
     C*
     C/COPY WNCPYSRC,LE1160C003
     C                     ENDSR
     C/COPY WNCPYSRC,LE1160C005
     C/EJECT
     C*****************************************************************
     C*  NWAD   - Determines default network addresses                *
     C*  Called by: ROUT - Deterimes message routing                  *
     C*  Calls    : None                                              *
     C*****************************************************************
     C*
     C           NWAD      BEGSR
     C*
     C**  Default is SWIFT
     C*
     C           BBDNW3    IFEQ 'SWIFT'
     C           CSID      ANDNE*BLANKS
     C           @BIC      ANDNE'BIC'
     C           BGMSDL    ANDEQ'Y'
     C                     MOVELBBDNW3    @NWRK   6
     C                     END
     C*
     C**  Default is TELEX
     C*
     C           BBDNW3    IFEQ 'TELEX'
     C           TELX      ANDNE*BLANKS
     C           TLXM      ANDEQ'Y'
     C                     MOVE BBDNW3    @NWRK
     C                     END
     C*
     C**  Default is STTX
     C*
     C           BBDNW3    IFEQ 'STTX'
     C           BBSTAD    ANDNE*BLANKS
     C           BGMSDL    ANDEQ'Y'
     C                     MOVE BBDNW3    @NWRK
     C                     END
     C*
     C**  Default is PAPER
     C*
     C           BBDNW3    IFEQ 'PAPER'
     C                     MOVE BBDNW3    @NWRK
     C                     END
     C*
     C**  Found to be unroutable
     C*
     C           @NWRK     IFEQ *BLANKS
     C                     MOVEL'UNROUT'  @NWRK
     C                     END
     C*
     C                     ENDSR
     C/EJECT
     C*****************************************************************
     C*  PRAD     - Determines priotity network addresses             *
     C*  Called by: ROUT   - Determines message routing               *
     C*  Calls    : TXROUT - Priority routing to STTX/Telex           *
     C*             SWROUT - Priority routing to SWIFT                *
     C*****************************************************************
     C*
     C           PRAD      BEGSR
     C*
     C**  If STTX/Telex has higher priority than SWIFT attempt
     C**  STTX/Telex routing first, followed by SWIFT. (nb. 'Higher'
     C**  priority is numerically lower ie. '1' is higher than '2')
     C*
     C           BLTXPY    IFLT BLSWPY
     C                     EXSR TXROUT
     C                     EXSR SWROUT
     C*
     C**  otherwise attempt SWIFT routing first
     C*
     C                     ELSE
     C                     EXSR SWROUT
     C                     EXSR TXROUT
     C                     END
     C*
     C**  If failed to route to electronic network, produce paper
     C*
     C           @NWRK     IFEQ *BLANKS
     C                     MOVEL'PAPER'   @NWRK
     C                     END
     C*
     C                     ENDSR
     C/EJECT
     C*****************************************************************
     C*  TXROUT   - Attempts priority routing to STTX/Telex, if not   *
     C*             already routed                                    *
     C*  Called by: PRAD   -                                          *
     C*  Calls    : None                                              *
     C*****************************************************************
     C*
     C           TXROUT    BEGSR
     C*
     C**  If not already routed, attempt STTX/Telex routing
     C*
     C           @NWRK     IFEQ *BLANKS
     C*
     C**  Note that STTX and Telex are mutually exclusive - try both
     C*
     C           BGMSDL    IFEQ 'Y'
     C           BBSTAD    ANDNE*BLANKS
     C           @STTX     ANDNE*BLANKS
     C                     MOVEL'STTX'    @NWRK
     C                     END
     C*
     C           TLXM      IFEQ 'Y'
     C           TELX      ANDNE*BLANKS
     C           @TELX     ANDNE*BLANKS
     C                     MOVEL'TELEX'   @NWRK
     C                     END
     C*
     C                     END
     C*
     C                     ENDSR
     C/EJECT
     C*****************************************************************
     C*  SWROUT   - Attempts priority routing to SWIFT if not already *
     C*             routed                                            *
     C*  Called by: PRAD   -                                          *
     C*  Calls    : None                                              *
     C*****************************************************************
     C*
     C           SWROUT    BEGSR
     C*
     C**  If not already routed, attempt SWIFT routing
     C*
     C           @NWRK     IFEQ *BLANKS
     C           BGMSDL    ANDEQ'Y'
     C           CSID      ANDNE*BLANKS
     C           SCSID     ANDNE*BLANKS
     C           @BIC      ANDNE'BIC'
     C                     MOVEL'SWIFT'   @NWRK
     C                     END
     C*
     C                     ENDSR
     C/EJECT
     C           XCAMT     BEGSR                                          CEU004
      *===================================================================CEU004
      * XCAMT: Convert Amount.                                            CEU004
      *                                                                   CEU004
      *-------------------------------------------------------------------CEU004
      ** Convert Transaction Amount into Settlement Amount.               CEU004
      *                                                                   CEU004
     C                     MOVE *BLANKS   WKAMT  150       Clr Input      CEU004
      *                                                                   CEU004
     C                     CALL 'EU0200'                   Cvrt Amount    CEU004
      *                                                    Input:         CEU004
     C                     PARM *BLANKS   P@RTCD  7        -Return Code   CEU004
     C                     PARM           P@FRAM 183       -FROM Ccy Amt  CEU004
     C                     PARM CCY       P@FRCY  3        -FROM Currency CEU004
     C                     PARM SCCY      P@TOCY  3        -TO Currency   CEU004
      *                                                    Output:        CEU004
     C           WKAMT     PARM           P@OUTA 150       -Outright Amt  CEU004
     C                     PARM           P@INTA 183       -Interim AmountCEU004
     C                     PARM           P@EXRT 159       -Exchange Rate CEU004
     C                     PARM           P@MDIN  1        -Mult/Div Ind. CEU004
      *                                                                   CEU004
     C           P@RTCD    IFNE *BLANKS                    If Error       CEU004
     C                     MOVE 'EU0200  'DBFILE            Set File      CEU004
     C                     MOVELCCY       DBKEY     P       Set Key       CEU004
     C                     Z-ADD090       DBASE             Set Ref       CEU004
     C                     SETON                     U7U8   Set Inds      CEU004
     C                     GOTO END                         Bypass to End CEU004
     C                     ENDIF                           End If         CEU004
      *===================================================================CEU004
     C                     ENDSR                                          CEU004
     C** Copy member ZDATE2Z4 for the date conversion subroutine
     C/COPY ZSRSRC,ZDATE2Z4
     C/EJECT
     C*****************************************************************
     C*  *PSSR    - Handles abnormal error conditions                 *
     C*  Called by: All abnormation operations                        *
     C*  Calls    : None                                              *
     C*****************************************************************
     C*
     C           *PSSR     BEGSR
     C*
     C           @RUN      IFEQ *BLANKS
     C                     MOVE 'Y'       @RUN    1
     C                     DUMP
     C                     END
     C*
     C                     ENDSR
      *****************************************************************   119889
      *                                                               *   119889
      * PRINTR - Print Confirmation for PT and PF (LE1160P2)          *   119889
      * CALLED FROM: Main                                             *   119889
      * CALLS:                                                        *   119889
      *                                                               *   119889
      *****************************************************************   119889
     C           PRINTR    BEGSR                                          119889
      *                                                                   119889
     C           AMTP      IFEQ 'PT'                                      119889
     C                     MOVE '1'       *IN16                           119889
     C                     ENDIF                                          119889
      *                                                                   119889
     C           AMTP      IFEQ 'PF'                                      119889
     C                     MOVE '1'       *IN17                           119889
     C                     ENDIF                                          119889
      *                                                                   157056
      ** Calculate effective interest rate                                157056
      *                                                                   157056
     C                     Z-ADD0         W#RATE                          157056
     C                     SELEC                                          157056
     C           SPIN      WHEQ 'A'                                       157056
     C           BRTE      ADD  RTSP      W#RATE 110                      157056
     C           SPIN      WHEQ 'S'                                       157056
     C           BRTE      SUB  RTSP      W#RATE                          157056
     C           SPIN      WHEQ 'P'                                       157056
     C           RTSP      DIV  100       WRK132 132                      157056
     C           WRK132    MULT BRTE      W#RATE    H                     157056
     C                     ENDSL                                          157056
      *                                                                   119889
      ** Processing type if 'PF'                                          119889
      *                                                                   119889
     C           AMTP      IFEQ 'PF'                                      119889
     C           PTYP      COMP 62                     3232               119889
     C           PTYP      COMP 64                       34               119889
     C           PTYP      COMP 66                       36               119889
     C  N32N34N36          GOTO EXPRT                                     119889
     C**********           SETON                     33                   119889              202628
     C                     SETON                     35                                       202628
      *                                                                   119889
      ** Check value date against extract date                            119889
      *                                                                   119889
     C           VDAT      COMP EXTD                 25                   119889
     C                     ENDIF                                          119889
      *                                                                   119889
     C           AMTP      IFEQ 'PT'                                      119889
     C           PTYP      COMP 62                       48               119889
     C           PTYP      COMP 66                       30               119889
     C                     ENDIF                                          119889
      *                                                                   119889
      ** Determine amendment/cancellation narrative                       119889
      *                                                                   119889
     C   03                TESTB'7'       LAIN           37               119889
     C   03 37             TESTB'2'       LAIN       37                   119889
      *                                                                   119889
      ** Check if counterparty is a SWIFT member                          119889
      ** and set on 39 if output to LENXTAB                               119889
      *                                                                   119889
     C                     MOVELCNUM      CLKY   10                       119889
     C   U4                EXSR CLCHN                                     119889
      *                                                                   119889
     C   38 16 03                                                         119889
     COR 38 17 03          SETON                     39                   119889
     C   17 25             SETOF                     39                   119889
      *                                                                   119889
      ** Insert new MG Routing                                            119889
      *                                                                   119889
     C                     MOVE CSID      @BIC    4                       119889
     C                     MOVELBRCA      @DSNB   3                       119889
     C                     MOVELCNUM      @CUST   6                       119889
     C                     EXSR SRROUT                                    119889
      *                                                                   119889
      ** LEEXT rec is produced if lending message flag is ON              119889
      ** - Message can be rerouted via message management -               119889
      *                                                                   119889
     C           BGSWCL    IFEQ 'Y'                                       119889
     C                     SETON                     39                   119889
     C                     ELSE                                           119889
     C                     SETOF                     39                   119889
     C                     ENDIF                                          119889
      *                                                                   119889
      ** If network is 'PAPER' and non-ISO confs are to be produced       119889
      ** - set OFF 96 -                                                   119889
      ** To supress auto-transmission text on printout                    119889
      *                                                                   119889
     C           BGSWCL    IFEQ 'Y'                                       119889
     C**********           CALL 'AOMGMER0'                                           119889 CLE075BO
     C**********           PARM '*MSG    '@RTCD                                      119889 CLE075BO
     C**********           PARM '*FIRST  '@OPTN                                      119889 CLE075BO
     C********** SDMGME    PARM SDMGME    DSFDY                                      119889 CLE075BO
      *****************************************************************              119889 CLE075BO
     C********** @RTCD     IFNE *BLANK                                               119889 CLE075BO
     C**********           MOVEL'SDMGMEPD'DBFILE            * * * * * * *            119889 CLE075BO
     C**********           MOVEL'15'      DBASE             *DBERROR 15 *            119889 CLE075BO
     C**********           SETON                     U7U8LR * * * * * * *            119889 CLE075BO
     C**********           EXSR *PSSR                                                119889 CLE075BO
     C**********           ENDIF                                                     119889 CLE075BO
      *****************************************************************              119889 CLE075BO
     C           @NWRK     IFEQ 'PAPER'                                   119889
     C           ENFFCR    ANDEQ'Y'                                       119889
     C                     SETOF                     96                   119889
     C                     ELSE                                           119889
     C                     SETON                     96                   119889
     C                     ENDIF                                          119889
      *                                                                   119889
     C                     ELSE                                           119889
     C                     SETOF                     96                   119889
     C                     ENDIF                                          119889
      *                                                                   119889
      ** Obtain customer name/address details                             119889
      ** Check alternate name & address code not equal to 'B'             119889
      ** IFEQ 'B' Bypass ALT NAME & ADDRESS Validation                    119889
      *                                                                   119889
     C           NACD      IFNE 'B'                                       119889
     C                     MOVELCNUM      CUST    6                       119889
     C                     MOVELNACD      ADCD    1                       119889
     C                     SETOF                     31                   119889
     C                     CALL 'AOALTNR0'                                119889
     C                     PARM '*MSG   ' @RTCD   7                       119889
     C                     PARM '*KEY   ' @OPTN   7                       119889
     C                     PARM           CUST                            119889
     C                     PARM           ADCD                            119889
     C           SDALTN    PARM SDALTN    DSFDY                           119889
      *                                                                   119889
     C                     ENDIF                                          119889
      *                                                                   119889
      ** If no alternate N & A found, use SDCUSTPD N & A                  119889
      *                                                                   119889
     C           @RTCD     IFNE *BLANKS                                   119889
     C           NACD      OREQ 'B'                                       119889
     C                     MOVELCNUM      CLKY                            119889
     C                     EXSR CLCHN                                     119889
     C           *IN31     IFNE '1'                                       119889
     C                     MOVE BBCNA1    CNA1                            119889
     C                     MOVE BBCNA2    CNA2                            119889
     C                     MOVE BBCNA3    CNA3                            119889
     C                     MOVE BBCNA4    CNA4                            119889
     C                     ELSE                                           119889
     C                     MOVEL'SDCUSTPD'DBFILE                          119889
     C                     MOVELCNUM      DBKEY                           119889
     C                     MOVEL'16'      DBASE                           119889
     C                     SETON                     U7U8LR               119889
     C                     MOVE 'E'       WEND                            119889
     C                     GOTO EXPRT                                     119889
     C                     ENDIF                                          119889
      *                                                                   119889
      ** If alternate N & A found, Use that town                          119889
      *                                                                   119889
     C                     ELSE                                           119889
     C                     MOVELBCCRTN    CTWN                            119889
     C                     ENDIF                                          119889
      ** Store name                                                       119889
     C                     MOVE CNA1      CST1   35                       119889
     C                     MOVE CNA2      CST2   35                       119889
     C                     MOVE CNA3      CST3   35                       119889
     C                     MOVE CNA4      CST4   35                       119889
     C                     MOVE CTWN      CTW1   10                       119889
     C                     MOVE CNUM      TELNUM  6                       119889
      *                                                                   119889
      ** Pick up brance name if required                                  119889
      *                                                                   119889
     C     N70             GOTO BT04                                      119889
      *                                                                   119889
      ** Access Branch codes                                              119889
      *                                                                   119889
     C                     Z-ADDBCHARR    B                                                 CLE075BO
     C           BRCA      LOKUP#BCH,B                   56                                 CLE075BO
     C           *IN56     IFEQ '1'                                                         CLE075BO
     C           B         OCUR SDBRCH                                                      CLE075BO
     C                     MOVE *BLANKS   @RTCD                                             CLE075BO
     C                     ELSE                                                             CLE075BO
     C**********           CALL 'AOBRCHR0'                                             119889 CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       119889
     C                     PARM '*KEY   ' @OPTN   7                       119889
     C                     PARM BRCA      @DSNB   3                       119889
     C********** SDBRCH    PARM SDBRCH    DSFDY                                        119889 CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
      *                                                                   119889
     C           @RTCD     IFNE *BLANKS                                   119889
     C                     SETON                     31                   119889
     C                     END                                            119889
     C         31          MOVEL'SDBRCHPD'DBFILE                          119889
     C         31          MOVEL@DSNB     DBKEY                           119889
     C         31          MOVEL'17'      DBASE            ***************119889
     C         31          SETON                     U7U8  *  DBASE  17  *119889
     C         31          MOVE 'E'       WEND             ***************119889
     C         31          GOTO EXPRT                                     119889
     C                     ENDIF                                                            CLE075BO
      *                                                                   119889
     C           BT04      TAG                             ** BT04 TAG ** 119889
      *                                                                   119889
     C                     Z-ADDCURARR    A                                                 CLE075BO
     C********** CCY       LOKUP#CCY,A                   47                        CLE075BO MD020304
     C           CCY       LOKUP#CCY,A                   66                                 MD020304
     C           *IN47     IFEQ '1'                                                         CLE075BO
     C           A         OCUR SDCURR                                                      CLE075BO
     C                     ELSE                                                             CLE075BO
     C                     CALL 'AOCURRR0'                                119889
     C                     PARM '*MSG   ' @RTCD   7                       119889
     C                     PARM '*KEY   ' @OPTN   7                       119889
     C                     PARM CCY       TKEY    3                    A  119889
     C           SDCURR    PARM SDCURR    DSSDY                        B  119889
     C           @RTCD     IFNE *BLANK                                    119889
     C                     SETON                     31                   119889
     C                     END                                            119889
     C      31             MOVE 'SDCURRPD'DBFILE                          119889
     C      31             MOVELCCY       DBKEY                           119889
     C      31             MOVEL'18'      DBASE            ***************119889
     C      31             SETON                     U7U8  *  DBASE  18  *119889
     C      31             MOVE 'E'       WEND             ***************119889
     C      31             GOTO EXPRT                                     119889
     C                     ENDIF                                                            CLE075BO
      *                                                                   119889
     C           CDP       COMP 1                      4041               119889
     C           CDP       COMP 2                    43  42               119889
      *                                                                   119889
      ** Set required indicators for settlement insturctions              119889
      ** also access required customer details                            119889
      *                                                                   119889
     C                     EXSR SETINS                                    119889
     C   U7 U8             MOVE 'E'       WEND                            119889
     C   U7 U8             GOTO EXPRT                                     119889
      *                                                                   119889
      ** Use ZDATE2 to convert value DAYNO to date format                 119889
      *                                                                   119889
     C                     MOVE VDAT      ZDAYNO                          119889
     C                     EXSR ZDATE2                                    119889
     C                     MOVE ZADATE    OVDAT   7                       119889
      *                                                                   119889
      ** Arrange dates into DDMMYY format for output to TELEX file        119889
      *                                                                   119889
     C                     MOVE ZYEAR     ZWRK4                           119889
     C                     MOVELZMTH      ZWRK4                           119889
     C                     MOVE ZWRK4     TXDATE  60                      119889
     C                     MOVELZDAY      TXDATE                          119889
      *                                                                   119889
      ** Check for negaitves on RE                                        119889
      *                                                                   119889
     C           AMTP      IFEQ 'PF'                                      119889
     C           INTA      COMP 0                      44                 119889
     C           TAMT      COMP 0                      45                 119889
     C                     ENDIF                                          119889
      *                                                                   119889
      ** Check if customer is the same as the receiving/originating cust. 119889
      *                                                                   119889
     C           RORC      IFEQ CNUM                                      119889
     C                     MOVE '1'       *IN14                           119889
     C                     ENDIF                                          119889
      *                                                                   119889
     C           EXPRT     ENDSR                                          119889
     C/EJECT                                                              119889
      *****************************************************************   119889
      *   SRROUT - determine message routing                          *   119889
      *   Called by - CONF                                            *   119889
      *   Calls -                                                     *   119889
      *****************************************************************   119889
      *                                                                   119889
     C           SRROUT    BEGSR                                          119889
      *                                                                   119889
     C                     MOVELBRCA      I@SNBR                          119889
     C                     MOVELCNUM      I@DSCN                          119889
     C                     MOVEL*BLANKS   I@MTPY                          119889
     C                     Z-ADD0         I@SETT                          119889
     C                     MOVEL'Y'       I@CONC                          119889
     C                     MOVEL*BLANK    I@FTCS                          119889
      *                                                                   119889
     C                     CALL 'MG9900'                                  119889
     C                     PARM *BLANKS   @RTCD                           119889
     C                     PARM           P@IN                            119889
     C                     PARM *BLANKS   P@OUT                           119889
     C                     PARM           P@ZZ  256                       119889
      *                                                                   119889
     C           @RTCD     IFNE *BLANKS                                   119889
     C                     MOVEL'MG9900  'DBFILE           ***************119889
     C                     MOVEL'*CALL'   DBKEY            * DBERROR 92  *119889
     C                     MOVEL'092'     DBASE            ***************119889
     C                     SETON                     U7U8LR               119889
     C                     EXSR *PSSR                                     119889
     C                     ELSE                                           119889
     C**********           Z-ADDO@CNSN    SECN    60                                   119889 CSD027
     C                     MOVE O@CNSN    SECN    6                                           CSD027
     C                     MOVELO@SWSN    SCSID  12                       119889
     C                     MOVELO@NWRK    @NWRK   6                       119889
     C                     END                                            119889
      *                                                                   119889
     C                     ENDSR                                          119889
      *                                                                   119889
      *****************************************************************                     CLE075BO
      *                                                               *                     CLE075BO
      *  CHKNOS - Check Nostro details in array                       *                     CLE075BO
      *                                                               *                     CLE075BO
      *****************************************************************                     CLE075BO
     C           CHKNOS    BEGSR                                                            CLE075BO
      *                                                                                     CLE075BO
      ** Reinitialize work fields                                                           CLE075BO
      *                                                                                     CLE075BO
     C                     MOVEL*BLANK    NOSIC                                             CLE075BO
     C                     MOVE *OFF      *IN76                                             CLE075BO
     C           KEYNOS    IFNE *BLANKS                                                     CLE075BO
      *                                                                                     CLE075BO
      ** Check previous base rate details if it's                                           CLE075BO
      ** same with current details                                                          CLE075BO
      *                                                                                     CLE075BO
     C                     Z-ADDNOSPRV    F                                                 CLE075BO
      *                                                                                     CLE075BO
      ** Defend against index being 0                                                       CLE075BO
      ** Set current index to starting index                                                CLE075BO
      *                                                                                     CLE075BO
     C           F         IFEQ 0                                                           CLE075BO
     C                     Z-ADDNOSIDX    F                                                 CLE075BO
     C                     ENDIF                                                            CLE075BO
      *                                                                                     CLE075BO
      ** If the KEYNOS being checked is the same then use the index                         CLE075BO
      ** of the current detail rather than doing a LOKUP                                    CLE075BO
      *                                                                                     CLE075BO
     C           KEYNOS    IFEQ #NSK,F                                                      CLE075BO
     C                     MOVE *ON       *IN76                                             CLE075BO
     C                     ELSE                                                             CLE075BO
      *                                                                                     CLE075BO
     C           NOSIDX    IFEQ 0                                                           CLE075BO
     C                     Z-ADD1         F                                                 CLE075BO
     C                     ELSE                                                             CLE075BO
     C                     Z-ADDNOSIDX    F                                                 CLE075BO
     C                     ENDIF                                                            CLE075BO
      *                                                                                     CLE075BO
     C           KEYNOS    LOKUP#NSK,F                   76                                 CLE075BO
     C                     ENDIF                                                            CLE075BO
      *                                                                                     CLE075BO
      ** Save the last accessed detail to NOSPRV                                            CLE075BO
      ** Set the indicator to show the data was found                                       CLE075BO
      *                                                                                     CLE075BO
     C           *IN76     IFEQ *ON                                                         CLE075BO
     C                     MOVE NOSSEQ    #NOS,F                                            CLE075BO
     C                     Z-ADDF         NOSPRV                                            CLE075BO
     C                     MOVEL'Y'       NOSIC                                             CLE075BO
     C                     ENDIF                                                            CLE075BO
      *                                                                                     CLE075BO
     C                     ENDIF                                                            CLE075BO
     C                     ENDSR                                                            CLE075BO
      *****************************************************************                     CLE075BO
      *                                                               *                     CLE075BO
      *  ADDNOS - Add Nostro details to array                         *                     CLE075BO
      *                                                               *                     CLE075BO
      *****************************************************************                     CLE075BO
     C           ADDNOS    BEGSR                                                            CLE075BO
      *                                                                                     CLE075BO
      ** If there is still room in the array then add the details                           CLE075BO
      *                                                                                     CLE075BO
     C           NOSIDX    IFNE 0                                                           CLE075BO
     C                     SUB  1         NOSIDX                                            CLE075BO
     C                     ENDIF                                                            CLE075BO
      *                                                                                     CLE075BO
     C                     MOVELKEYNOS    #NSK,F                                            CLE075BO
     C                     ADD  NOSSEQ    #NOS,F                                            CLE075BO
      *                                                                                     CLE075BO
      ** Set last accessed detail to NOSPRV So that CHKNOS checks this                      CLE075BO
      ** latest detail first                                                                CLE075BO
      *                                                                                     CLE075BO
     C                     Z-ADDF         NOSPRV                                            CLE075BO
      *                                                                                     CLE075BO
     C                     ENDSR                                                            CLE075BO
      /EJECT                                                                                  CLE031
     C/COPY ZSRSRC,ZCONVZ1                                                                    CLE031
     O/EJECT
     OLENXTAA D        U4 01
     O                                    1 'H'
     OLENXTAB D        U4 39
     O                         LOT1     250
     O                         LOT2     320
     O                         CSWID    267
     O                         OSBR     270
     O                         OSAC     967                                                   CGL029
     OLENXTAC T        LR U4
     O                                    1 'T'
     O                         RECXTO     6
     O*
     O** Confirmations print
     O** Standard output
     O*
     O** Branch name if required
     O*
     O***LE1160P1D  202      20                                           119889
     O***    OR  202      33                                              119889
     OLE1160P1D  202  N13 20                                              119889
     O       OR  202  N13 33                                              119889
     O                       70BRNM      63
     O*
     O** Heading line. Confirmation name and type
     O*
     O/COPY WNCPYSRC,LE1160O009
     O********D  2        20                                              119889
     O*******OR  2        33                                              119889
     O        D  2    N13 20                                              119889
     O       OR  2    N13 33                                              119889
     O                       20          65 'PRINCIPAL INCREASE CONFI'
     O                       20          72 'RMATION'
     O                       21          60 'REPAYMENT CONFIRMATION'
     O                    03 37          71 'AMENDMENT'
     O                    05             72 'CANCELLATION'
     O*
     O** Rundate
     O*
     O********D  1        20                                              119889
     O*******OR  1        33                                              119889
     O        D  1    N13 20                                              119889
     O       OR  1    N13 33                                              119889
     O                                   69 'DATE'
     O                         RUNA      79
     O/COPY WNCPYSRC,LE1160O001
     O*
     O** Loan reference
     O*
     O********D  2        20                                              119889
     O*******OR  2        33                                              119889
     O        D  2    N13 20                                              119889
     O       OR  2    N13 33                                              119889
     O                                   69 'REF.'
     O                         LNRF      78
     O                                   79 '-'
     O                         CNUM      85
     O*
     O** Print customer name and address
     O*
     O/COPY WNCPYSRC,LE1160O010
     O        D  1        20
     O       OR  1        33
     O                         CNA1      85
     O*
     O        D  2        20
     O       OR  2        33
     O                         CNA2      85
     O*
     O        D  1        20
     O       OR  1        33
     O                         ONA1      46
     O                         CNA3      85
     O*
     O        D  2        20
     O       OR  2        33
     O                         ONA2      46
     O                         CNA4      85
     O/COPY WNCPYSRC,LE1160O011
     O*
     O** Details of confirmation
     O*
     O********D  2        20                                              119889
     O*******OR  2        33                                              119889
     O        D  2    N13 20                                              119889
     O       OR  2    N13 33                                              119889
     O                    20             33 'CCY AMOUNT OF INCREASE'
     O                    20             42 'VALUE'
     O                 20N48N30          48 'AT'
     O                    21             26 'CCY      AMOUNT'
     O                    21             43 'DUE DATE'
     O                    21             80 'INTEREST'
     O/COPY WNCPYSRC,LE1160O002
     O*
     O********D  2        20                                              119889
     O*******OR  2        33                                              119889
     O        D  2    N13 20                                              119889
     O       OR  2    N13 33                                              119889
     O/COPY WNCPYSRC,LE1160O003
     O***********              CCY       14                               CEU004
     O**********               WKCCY      8                                            CEU004 219250
     O                         WKCCY     14                                                   219250
     O***********         40   PRAM      32 ' ,   ,   ,   ,*  '           CEU004
     O***********         41   PRAM      32 '   ,   ,   , * . '           CEU004
     O***********         42   PRAM      32 '  ,   ,   , * .  '           CEU004
     O***********         43   PRAM      32 ' ,   ,   , * .   '           CEU004
     O/COPY WNCPYSRC,LE1160O005
     O                    40   WKPRAM    32 ' ,   ,   ,   ,*  '           CEU004
     O                    41   WKPRAM    32 '   ,   ,   , * . '           CEU004
     O                    42   WKPRAM    32 '  ,   ,   , * .  '           CEU004
     O                    43   WKPRAM    32 ' ,   ,   , * .   '           CEU004
     O                         OVDAT     43
     O                N48N30 20          49 'CALL'
     O***********         40 21INTA      85 ' ,   ,   ,   ,*  '           CEU004
     O***********         41 21INTA      85 '   ,   ,   , * . '           CEU004
     O***********         42 21INTA      85 '  ,   ,   , * .  '           CEU004
     O***********         43 21INTA      85 ' ,   ,   , * .   '           CEU004
     O                    40 21WKINTA    85 ' ,   ,   ,   ,*  '           CEU004
     O                    41 21WKINTA    85 '   ,   ,   , * . '           CEU004
     O                    42 21WKINTA    85 '  ,   ,   , * .  '           CEU004
     O                    43 21WKINTA    85 ' ,   ,   , * .   '           CEU004
     O/COPY WNCPYSRC,LE1160O004
     O*
     O        D  2        33
     O                                   61 'TOTAL REPAYMENT'
     O***********         40   TAMT      85 ' ,   ,   ,   ,*  '           CEU004
     O***********         41   TAMT      85 '   ,   ,   , * . '           CEU004
     O***********         42   TAMT      85 '  ,   ,   , * .  '           CEU004
     O***********         43   TAMT      85 ' ,   ,   , * .   '           CEU004
     O                    40 21WKTAMT    85 ' ,   ,   ,   ,*  '           CEU004
     O                    41 21WKTAMT    85 '   ,   ,   , * . '           CEU004
     O                    42 21WKTAMT    85 '  ,   ,   , * .  '           CEU004
     O                    43 21WKTAMT    85 ' ,   ,   , * .   '           CEU004
     O/COPY WNCPYSRC,LE1160O006
     O*
     O** Output now splits according to whether payment or receipt
     O** for settlement instructions. First *** RECEIPTS ***
     O*
     O********D 1      32                                                 119889
     O*******OR 1      34                                                 119889
     O        D 1      32N13                                              119889
     O       OR 1      34N13                                              119889
     O                                   24 'PAYMENT AT VALUE DATE'
     O                       51          40 'TO OUR A/C WITH'
     O                       54          27 'BY'
     O                       58          27 'BY'
     O                       50          27 'TO'
     O********D 1      32                                                 119889
     O*******OR 1      34                                                 119889
     O        D 1      32N13                                              119889
     O       OR 1      34N13                                              119889
     O                       50          30 'INSTRUCTIONS TO BE ADVIS'
     O                       50          32 'ED'
     O                       51CN2    B  40
     O                    51 22          30 'INSTRUCTIONS TO BE ADVIS'
     O                    51 22          40 'ED        '
     O                       52          30 'WE AWAIT YOUR REMITTANCE'
     O                       53          29 'AS PER OUR INSTRUCTIONS'
     O                       54          29 'DEBIT TO ACCOUNT NUMBER'
     O                       55          29 'AS PER OUR INSTRUCTIONS'
     O                       57          29 'WE SHALL COLLECT REMITT'
     O                       57          33 'ANCE'
     O                       58          29 'DEBIT TO ACCOUNT NUMBER'
     O**********             49          29 'THROUGH ACCOUNT'                          CLE033 219250
     O                       49          21 'THROUGH ACCOUNT'                                 219250
     O********D 11     32                                                 119889
     O*******OR 11     34                                                 119889
     O        D 11     32N13                                              119889
     O       OR 11     34N13                                              119889
     O                       51CT2    B  25
     O                    51 22          25 '                    '
     O**********             54OUT04  B  12 '    -  '                                         CGL029
     O**********             54          13 '-'                                               CGL029
     O**********             54OSBR   B  16                                                   CGL029
     O**********             58OSAC      15                                                   CGL029
     O**********             49OSBR   B   4                                            CLE033 219250
     O                       54OUT04  B  18 '          -  '                                   CGL029
     O                       54          19 '-'                                               CGL029
     O                       54OSBR   B  22                                                   CGL029
     O                       58OSAC      21                                                   CGL029
     O**********             49OSBR   B   4                                            CLE033 219250
     O**********             49           5 '-'                                        CLE033 219250
     O**********             49OSAC      17                                            CLE033 219250
     O                       49OSBR   B   9                                                   219250
     O                       49          10 '-'                                               219250
     O**********             49OSAC      22                                            219250 CGL029
     O                       49OSAC      28                                                   CGL029
     O********D*11     32N13 49                                                        CLE031 219250
     O*******OR*11     34N13 49                                                        CLE031 219250
     O        D 11     32N13 60                                                               219250
     O       OR 11     34N13 60                                                               219250
     O                                   24 'PAYMENT IN SETTLE CCY'                           CLE031
     O                                   37 'AMOUNTING TO'                                    CLE031
     O********D*1      32N13 49                                                        CLE031 219250
     O*******OR*1      34N13 49                                                        CLE031 219250
     O        D 1      32N13 60                                                               219250
     O       OR 1      34N13 60                                                               219250
     O                         WRSCY      8                                                   CLE031
     O                    80   WRSAMT    28 ' ,   ,   ,   ,*  '                               CLE031
     O                    81   WRSAMT    28 '   ,   ,   , * . '                               CLE031
     O                    82   WRSAMT    28 '  ,   ,   , * .  '                               CLE031
     O                    83   WRSAMT    28 ' ,   ,   , * .   '                               CLE031
     O********D 1      32                                                 119889
     O*******OR 1      34                                                 119889
     O        D 1      32N13                                              119889
     O       OR 1      34N13                                              119889
     O                       51          13 'PAYMENT BY'
     O                       49          13 'PAYMENT BY'                  CLE033
     O                       50          13 'PAYMENT BY'
     O********D 1      32                                                 119889
     O*******OR 1      34                                                 119889
     O        D 1      32N13                                              119889
     O       OR 1      34N13                                              119889
     O                       51CN3    B  40
     O                    51 23          26 'WE AWAIT YOUR ADVICE'
     O                    51 23          40 '              '
     O                       50          26 'WE AWAIT YOUR ADVICE'
     O                       49CN3    B  40                               CLE033
     O                    49 23          26 'WE AWAIT YOUR ADVICE'        CLE033
     O                    49 23          40 '              '              CLE033
     O********D 13        32                                              119889
     O*******OR 13     34                                                 119889
     O        D 13    N13 32                                              119889
     O       OR 13     34N13                                              119889
     O                       51CT3    B  25
     O                    51 23          25 '                    '
     O                       49CT3    B  25                               CLE033
     O                    49 23          25 '                    '        CLE033
     O*
     O** Second. *** PAYMENTS ***
     O*
     O********D 1      20                                                 119889
     O*******OR 1      36                                                 119889
     O        D 1      20N13                                              119889
     O       OR 1      36N13                                              119889
     O                                   65 'PAYMENT AT VALUE DATE'
     O                       51          68 'BY'
     O                       54          68 'BY'
     O                       58          68 'BY'
     O                       50          68 'BY'
     O********D 1      20                                                 119889
     O*******OR 1      36                                                 119889
     O        D 1      20N13                                              119889
     O       OR 1      36N13                                              119889
     O                       50          71 'INSTRUCTIONS TO BE ADVIS'
     O                       50          73 'ED'
     O                       51CN2    B  82
     O                    51 22          71 'INSTRUCTIONS TO BE ADVIS'
     O                    51 22          82 'ED         '
     O                       52          70 'WE WILL SEND REMITTANCE'
     O                       53          71 'AS PER YOUR INSTRUCTIONS'
     O                       54          71 'CREDIT TO ACCOUNT NO'
     O                       55          71 'AS PER YOUR INSTRUCTIONS'
     O                       57          71 'YOU SHALL COLLECT REMITT'
     O                       57          75 'ANCE'
     O                       58          71 'CREDIT TO ACCOUNT NUMBER'
     O**********             49          71 'THROUGH ACCOUNT'                          CLE033 219250
     O                       49          63 'THROUGH ACCOUNT'                                 219250
     O********D 11     20                                                 119889
     O*******OR 11     36                                                 119889
     O        D 11     20N13                                              119889
     O       OR 11     36N13                                              119889
     O                       51CT2    B  67
     O                    51 22          67 '                    '
     O**********             54OUT04  B  54 '    -  '                                         CGL029
     O**********             54          55 '-'                                               CGL029
     O**********             54OSBR   B  58                                                   CGL029
     O**********             58OSAC      54                                                   CGL029
     O                       54OUT04  B  60 '          -  '                                   CGL029
     O                       54          61 '-'                                               CGL029
     O                       54OSBR   B  64                                                   CGL029
     O                       58OSAC      60                                                   CGL029
     O**********             49OSBR   B   4                                            CLE033 219250
     O**********             49           5 '-'                                        CLE033 219250
     O**********             49OSAC      17                                            CLE033 219250
     O                       49OSBR   B  51                                                   219250
     O                       49          52 '-'                                               219250
     O**********             49OSAC      64                                            219250 CGL029
     O                       49OSAC      70                                                   CGL029
     O********D*11     20N13 49                                                        CLE031 219250
     O*******OR*11     36N13 49                                                        CLE031 219250
     O        D 11     20N13 60                                                               219250
     O       OR 11     36N13 60                                                               219250
     O                                   65 'PAYMENT IN SETTLE CCY'                           CLE031
     O                                   78 'AMOUNTING TO'                                    CLE031
     O**********1      20N13 49                                                        CLE031 219250
     O*******OR*1      36N13 49                                                        CLE031 219250
     O        D 1      20N13 60                                                               219250
     O       OR 1      36N13 60                                                               219250
     O**********               WPSCY     44                                            CLE031 219250
     O                         WPSCY     47                                                   219250
     O                    84   WPSAMT    64 ' ,   ,   ,   ,*  '                               CLE031
     O                    85   WPSAMT    64 '   ,   ,   , * . '                               CLE031
     O                    86   WPSAMT    64 '  ,   ,   , * .  '                               CLE031
     O                    87   WPSAMT    64 ' ,   ,   , * .   '                               CLE031
     O********D 1      20                                                 119889
     O*******OR 1      36                                                 119889
     O        D 1      20N13                                              119889
     O       OR 1      36N13                                              119889
     O                       50          54 'PAYMENT TO'
     O                       49          54 'PAYMENT TO'                  CLE033
     O                       51          54 'PAYMENT TO'
     O********D 1      20                                                 119889
     O*******OR 1      36                                                 119889
     O        D 1      20N13                                              119889
     O       OR 1      36N13                                              119889
     O                       51CN3    B  82
     O                    51 23          68 'WE AWAIT YOUR ADVICE'
     O                    51 23          82 '              '
     O                       49CN3    B  82                               CLE033
     O                    49 23          68 'WE AWAIT YOUR ADVICE'        CLE033
     O                    49 23          82 '              '              CLE033
     O                       50          68 'WE AWAIT YOUR ADVICE'
     O********D 11     20                                                 119889
     O*******OR 11     36                                                 119889
     O        D 11     20N13                                              119889
     O       OR 11     36N13                                              119889
     O                       51CT3    B  67
     O                    51 23          25 '                    '
     O                       49CT3    B  67                               CLE033
     O                    49 23          25 '                    '        CLE033
     O********D 1      20                                                 119889
     O*******OR 1      36                                                 119889
     O        D 1      20N13                                              119889
     O       OR 1      36N13                                              119889
     O                       51          54 'FOR A/C OF'
     O                       49          54 'FOR A/C OF'                  CLE033
     O********D 1      20                                                 119889
     O*******OR 1      36                                                 119889
     O        D 1      20N13                                              119889
     O       OR 1      36N13                                              119889
     O                       51CN4    B  82
     O                       49CN4    B  82                               CLE033
     O********D 11     20                                                 119889
     O*******OR 11     36                                                 119889
     O        D 11     20N13                                              119889
     O       OR 11     36N13                                              119889
     O                       51CT4    B  67
     O********D 1      20                                                 119889
     O*******OR 1      36                                                 119889
     O        D 1      20N13                                              119889
     O       OR 1      36N13                                              119889
     O                       51          64 'SPECIAL INSTRUCTIONS'
     O                       49          64 'SPECIAL INSTRUCTIONS'        CLE033
     O                       52          64 'SPECIAL INSTRUCTIONS'
     O                       54          64 'SPECIAL INSTRUCTIONS'
     O                       58          64 'SPECIAL INSTRUCTIONS'
     O********D 1      20N29                                              119889
     O*******OR 1      36N29                                              119889
     O        D 1      20N29N13                                           119889
     O       OR 1      36N29N13                                           119889
     O***********            51SPI1      77                               088913
     O***********            52SPI1      77                               088913
     O***********            54SPI1      77                               088913
     O***********            58SPI1      77                               088913
     O                       51BTB1      82                               088913
     O                       49BTB1      82                               CLE033
     O                       52BTB1      82                               088913
     O                       54BTB1      82                               088913
     O                       58BTB1      82                               088913
     O********D 1      20                                                 119889
     O*******OR 1      36                                                 119889
     O*******OR 1      33                                                 119889
     O        D 1      20N13                                              119889
     O       OR 1      36N13                                              119889
     O       OR 1      33N13                                              119889
     O***********            51SPI2      77                               088913
     O***********            52SPI2      77                               088913
     O***********            54SPI2      77                               088913
     O***********            58SPI2      77                               088913
     O                       51BTB2      82                               088913
     O                       49BTB2      82                               CLE033
     O                       52BTB2      82                               088913
     O                       54BTB2      82                               088913
     O                       58BTB2      82                               088913
     O********D 1      20                                                 119889
     O*******OR 1      36                                                 119889
     O*******OR 1      33                                                 119889
     O        D 1      20N13                                              119889
     O       OR 1      36N13                                              119889
     O       OR 1      33N13                                              119889
     O***********            51SPI3      77                               088913
     O***********            52SPI3      77                               088913
     O***********            54SPI3      77                               088913
     O***********            58SPI3      77                               088913
     O                       51BTB3      82                               088913
     O                       49BTB3      82                               CLE033
     O                       52BTB3      82                               088913
     O                       54BTB3      82                               088913
     O                       58BTB3      82                               088913
     O/COPY WNCPYSRC,LE1160O012
     O********D 1      20                                                 119889
     O*******OR 1      33                                                 119889
     O        D 1      20N13                                              119889
     O       OR 1      33N13                                              119889
     O                 29                60 'BENEFICIARY BANK'
     O********D 1      20                                                 119889
     O*******OR 1      33                                                 119889
     O        D 1      20N13                                              119889
     O       OR 1      33N13                                              119889
     O***********      29      SPI1      77                               088913
     O                 29      BTB1      82                               088913
     O                 U1 47             80 '** TELEX GENERATED **'
     O********D 1      20                                                 119889
     O*******OR 1      33                                                 119889
     O        D 1      20N13                                              119889
     O       OR 1      33N13                                              119889
     O        D 2      20
     O       OR 2      33
     O                    U4 96          70 '** AUTO TRANSMISSION -'
     O                    U4 96          85 'DO NOT SEND **'
     O/COPY WNCPYSRC,LE1160O013
     O*
     O** Output this line only if there are recors on file (*IN75 on)
     O*
     O        T 3 12   L1 88 75
     O       AND          62                                              119889
     O                                   64 '*** END OF REPORT'
     O                                   75 'FOR BRANCH'
     O                         BRCA      79
     O                                   83 '***'
     O*
     O** Output this line only if there are records on file (*IN75 ON)
     O*
     O        T 3 12   LRN88 75
     O       AND          62                                              119889
     O                                   76 '*** END OF REPORT ***'
     O*
     O** Control report
     OLE1160P2D  309   13 16                                              119889
     O       OR  309   13 17                                              119889
     O                       70BRNM      61                               119889
     O*  HEADING LINE. CONFIRMATION NAME & TYPE                           119889
     O        D  1     13 16                                              119889
     O       OR  1     13 17                                              119889
     O                                   44 'PRINCIPAL TRANSFER CONFI'    119889
     O                                   51 'RMATION'                     119889
     O                    03 37          66 'AMENDMENT'                   119889
     O                    05             69 'CANCELLATION'                119889
     O        D  1     13 16                                              119889
     O       OR  1     13 17                                              119889
     O                                   48 'DATE'                        119889
     O                         RUNA      58                               119889
     O        D  1     13 16                                              119889
     O       OR  1     13 17                                              119889
     O                                   48 'REF.'                        119889
     O                         LNRF      57                               119889
     O                                   58 '-'                           119889
     O                         CNUM      64                               119889
     O        D 11     13 16                                              119889
     O       OR 11     13 17                                              119889
     O                                   26 'WE CONFIRM TRANSFER OF '     119889
     O                    17             45 'PRINCIPAL FROM LOAN'         119889
     O                    16             43 'PRINCIPAL TO LOAN'           119889
     O                    17   LNRF      52                               119889
     O                    16   LNRF      50                               119889
     O                    17             76 'WITH THE FOLLOWING DETA'     119889
     O                    17             80 'ILS:'                        119889
     O                    16             74 'WITH THE FOLLOWING DETA'     119889
     O                    16             78 'ILS:'                        119889
     O        D 11     13 16                                              119889
     O       OR 11     13 17                                              119889
     O***********                         8 'CCY'                  119889 157056
     O***********                        23 'PRINCIPAL'            119889 157056
     O***********                        41 'DUE DATE'             119889 157056
     O***********                        58 'INTEREST RATE'        119889 157056
     O***********      17N14             80 'RECEIVING CUSTOMER'   119889 157056
     O***********      16N14             82 'ORIGINATING CUSTOMER' 119889 157056
     O                                    5 'CCY'                         157056
     O                                   19 'PRINCIPAL'                   157056
     O                                   37 'INTEREST'                    157056
     O                                   51 'DUE DATE'                    157056
     O                                   66 'INTEREST RATE'               157056
     O**********       17N14             86 'RECEIVING CUSTOMER'          157056              205248
     O**********       16N14             88 'ORIGINATING CUSTOMER'        157056              205248
     O                 17                88 'RCVING LOAN/CUSTOMER'                            205248
     O                 16                88 'ORGTNG LOAN/CUSTOMER'                            205248
     O        D  3     13 16                                              119889
     O       OR  3     13 17                                              119889
     O***********              CCY        8                        119889 157056
     O***********         40   PRAM      29 ' ,   ,   ,   ,*  '    119889 157056
     O***********         41   PRAM      29 '   ,   ,   , * . '    119889 157056
     O***********         42   PRAM      29 '  ,   ,   , * .  '    119889 157056
     O***********         43   PRAM      29 ' ,   ,   , * .   '    119889 157056
     O***********              OVDAT     40                        119889 157056
     O***********              RTSP      57 '  * .       -'        119889 157056
     O***********      17N14   RORC      73                        119889 157056
     O***********      16N14   RORC      75                        119889 157056
     O                         CCY        5                               157056
     O/COPY WNCPYSRC,LE1160O007
     O                    40   PRAM      23 ' ,   ,   ,   ,*  '           157056
     O                    41   PRAM      23 '   ,   ,   , * . '           157056
     O                    42   PRAM      23 '  ,   ,   , * .  '           157056
     O                    43   PRAM      23 ' ,   ,   , * .   '           157056
     O/COPY WNCPYSRC,LE1160O008
     O                    40   INTA      42 ' ,   ,   ,   ,*  '           157056
     O                    41   INTA      42 '   ,   ,   , * . '           157056
     O                    42   INTA      42 '  ,   ,   , * .  '           157056
     O                    43   INTA      42 ' ,   ,   , * .   '           157056
     O                         OVDAT     51                               157056
     O                         W#RATE    67 '  * .       -'               157056
     O**********       17N14   RORC      79                               157056              205248
     O**********       16N14   RORC      81                               157056              205248
     O                 17      ROLN      79                                                   205248
     O                 17      RORC      87                                                   205248
     O                 16      ROLN      79                                                   205248
     O                 16      RORC      87                                                   205248
      *                                                                   119889
0896  *  FOR SETTLEMENT INSTRUCTIONS. FIRST *** RECEIPTS ***              119889
0897 O        D 1      32 13                                              119889
0898 O       OR 1      34 13                                              119889
0899 O                                   24 'PAYMENT AT VALUE DATE'       119889
0900 O                       51          40 'TO OUR A/C WITH'             119889
0901 O                       54          27 'BY'                          119889
0902 O                       58          27 'BY'                          119889
0903 O                       50          27 'TO'                          119889
0904 O        D 1      32 13                                              119889
0905 O       OR 1      34 13                                              119889
0906 O                       50          30 'INSTRUCTIONS TO BE ADVIS'    119889
0907 O                       50          32 'ED'                          119889
0908 O                       51CN2    B  40                               119889
0909 O                    51 22          30 'INSTRUCTIONS TO BE ADVIS'    119889
0910 O                    51 22          40 'ED        '                  119889
0911 O                       52          30 'WE AWAIT YOUR REMITTANCE'    119889
0912 O                       53          29 'AS PER OUR INSTRUCTIONS'     119889
0913 O                       54          29 'DEBIT TO ACCOUNT NUMBER'     119889
0914 O                       55          29 'AS PER OUR INSTRUCTIONS'     119889
0915 O                       57          29 'WE SHALL COLLECT REMITT'     119889
0916 O                       57          33 'ANCE'                        119889
0917 O                       58          29 'DEBIT TO ACCOUNT NUMBER'     119889
     O**********             49          29 'THROUGH ACCOUNT'                          CLE033 219250
     O                       49          21 'THROUGH ACCOUNT'                                 219250
0918 O        D 11     32 13                                              119889
0919 O       OR 11     34 13                                              119889
0920 O                       51CT2    B  25                               119889
0921 O                    51 22          25 '                    '        119889
0922 O**********             54OUT04  B  12 '    -  '                                  119889 CGL029
     O**********             54          13 '-'                                        119889 CGL029
     O**********             54OSBR   B  16                                            119889 CGL029
0923 O**********             58OSAC      15                                            119889 CGL029
     O                       54OUT04  B  18 '          -  '                                   CGL029
     O                       54          19 '-'                                               CGL029
     O                       54OSBR   B  22                                                   CGL029
     O                       58OSAC      21                                                   CGL029
     O**********             49OSBR   B   4                                            CLE033 219250
     O**********             49           5 '-'                                        CLE033 219250
     O**********             49OSAC      17                                            CLE033 219250
     O                       49OSBR   B   9                                                   219250
     O                       49          10 '-'                                               219250
     O**********             49OSAC      22                                            219250 CGL029
     O                       49OSAC      28                                                   CGL029
0924 O        D 1      32 13                                              119889
0925 O       OR 1      34 13                                              119889
0926 O                       51          13 'PAYMENT BY'                  119889
     O                       49          13 'PAYMENT BY'                  CLE033
0927 O                       50          13 'PAYMENT BY'                  119889
0928 O        D 1      32 13                                              119889
0929 O       OR 1      34 13                                              119889
0930 O                       51CN3    B  40                               119889
0931 O                    51 23          26 'WE AWAIT YOUR ADVICE'        119889
0932 O                    51 23          40 '              '              119889
0933 O                       50          26 'WE AWAIT YOUR ADVICE'        119889
     O                       49CN3    B  40                               CLE033
     O                    49 23          26 'WE AWAIT YOUR ADVICE'        CLE033
     O                    49 23          40 '              '              CLE033
0934 O        D 13     13 32                                              119889
0935 O       OR 13     34 13                                              119889
0936 O                       51CT3    B  25                               119889
0937 O                    51 23          25 '                    '        119889
     O                       49CT3    B  25                               CLE033
     O                    49 23          25 '                    '        CLE033
0939  *                                                                   119889
0943  **** PAYMENTS ****                                                  119889
0939  *                                                                   119889
0944 O        D 1      16 13                                              119889
0945 O       OR 1      36 13                                              119889
0946 O                                   65 'PAYMENT AT VALUE DATE'       119889
0947 O                       51          68 'BY'                          119889
0948 O                       54          68 'BY'                          119889
0949 O                       58          68 'BY'                          119889
0950 O                       50          68 'BY'                          119889
0951 O        D 1      16 13                                              119889
0952 O       OR 1      36 13                                              119889
0953 O                       50          71 'INSTRUCTIONS TO BE ADVIS'    119889
0954 O                       50          73 'ED'                          119889
0955 O                       51CN2    B  82                               119889
0956 O                    51 22          71 'INSTRUCTIONS TO BE ADVIS'    119889
0957 O                    51 22          82 'ED         '                 119889
0958 O                       52          70 'WE WILL SEND REMITTANCE'     119889
0959 O                       53          71 'AS PER YOUR INSTRUCTIONS'    119889
0960 O                       54          71 'CREDIT TO ACCOUNT NO'        119889
0961 O                       55          71 'AS PER YOUR INSTRUCTIONS'    119889
0962 O                       57          71 'YOU SHALL COLLECT REMITT'    119889
0963 O                       57          75 'ANCE'                        119889
0964 O                       58          71 'CREDIT TO ACCOUNT NUMBER'    119889
     O**********             49          71 'THROUGH ACCOUNT'                          CLE033 219250
     O                       49          63 'THROUGH ACCOUNT'                                 219250
0965 O        D 11     16 13                                              119889
0966 O       OR 11     36 13                                              119889
0967 O                       51CT2    B  67                               119889
0968 O                    51 22          67 '                    '        119889
0969 O**********             54OUT04  B  54 '    -  '                                  119889 CGL029
     O**********             54          55 '-'                                        119889 CGL029
     O**********             54OSBR   B  58                                            119889 CGL029
0970 O**********             58OSAC      54                                            119889 CGL029
     O                       54OUT04  B  60 '          -  '                                   CGL029
     O                       54          61 '-'                                               CGL029
     O                       54OSBR   B  64                                                   CGL029
     O                       58OSAC      60                                                   CGL029
     O**********             49OSBR   B   4                                            CLE033 219250
     O**********             49           5 '-'                                        CLE033 219250
     O**********             49OSAC      17                                            CLE033 219250
     O                       49OSBR   B  51                                                   219250
     O                       49          52 '-'                                               219250
     O**********             49OSAC      64                                            219250 CGL029
     O                       49OSAC      70                                                   CGL029
0971 O        D 1      16 13                                              119889
0972 O       OR 1      36 13                                              119889
0973 O                       50          54 'PAYMENT TO'                  119889
     O                       49          54 'PAYMENT TO'                  CLE033
0974 O                       51          54 'PAYMENT TO'                  119889
0975 O        D 1      16 13                                              119889
0976 O       OR 1      36 13                                              119889
0977 O                       51CN3    B  82                               119889
0978 O                    51 23          68 'WE AWAIT YOUR ADVICE'        119889
0979 O                    51 23          82 '              '              119889
     O                       49CN3    B  82                               CLE033
     O                    49 23          68 'WE AWAIT YOUR ADVICE'        CLE033
     O                    49 23          82 '              '              CLE033
0980 O                       50          68 'WE AWAIT YOUR ADVICE'        119889
0981 O        D 11     16 13                                              119889
0982 O       OR 11     36 13                                              119889
0983 O                       51CT3    B  67                               119889
0984 O                    51 23          25 '                    '        119889
     O                       49CT3    B  67                               CLE033
     O                    49 23          25 '                    '        CLE033
0985 O        D 1      16 13                                              119889
0986 O       OR 1      36 13                                              119889
0987 O                       51          54 'FOR A/C OF'                  119889
     O                       49          54 'FOR A/C OF'                  CLE033
0988 O        D 1      16 13                                              119889
0989 O       OR 1      36 13                                              119889
0990 O                       51CN4    B  82                               119889
     O                       49CN4    B  82                               CLE033
0991 O        D 11     16 13                                              119889
0992 O       OR 11     36 13                                              119889
0993 O                       51CT4    B  67                               119889
     O                       49CT4    B  67                               CLE033
0994 O        D 1      16 13                                              119889
0995 O       OR 1      36 13                                              119889
0996 O                       51          64 'SPECIAL INSTRUCTIONS'        119889
     O                       49          64 'SPECIAL INSTRUCTIONS'        CLE033
0997 O                       52          64 'SPECIAL INSTRUCTIONS'        119889
0998 O                       54          64 'SPECIAL INSTRUCTIONS'        119889
0999 O                       58          64 'SPECIAL INSTRUCTIONS'        119889
     O        D 1      16N29 13                                           119889
     O       OR 1      36N29 13                                           119889
1002 O                       51SPI1      77                               119889
     O                       49SPI1      77                               CLE033
1003 O                       52SPI1      77                               119889
1004 O                       54SPI1      77                               119889
1005 O                       58SPI1      77                               119889
1006 O        D 1      16 13                                              119889
1007 O       OR 1      36 13                                              119889
     O*******OR*1      33 13                                              119889              202628
     O       OR 1      35 13                                                                  202628
1022 O                         CST1   B  42                               119889
1008 O                       51SPI2      77                               119889
     O                       49SPI2      77                               CLE033
1009 O                       52SPI2      77                               119889
1010 O                       54SPI2      77                               119889
1011 O                       58SPI2      77                               119889
1012 O        D 1      16 13                                              119889
1013 O       OR 1      36 13                                              119889
     O*******OR*1      33 13                                              119889              202628
     O       OR 1      35 13                                                                  202628
1022 O                         CST2   B  42                               119889
1014 O                       51SPI3      77                               119889
     O                       49SPI3      77                               CLE033
1015 O                       52SPI3      77                               119889
1016 O                       54SPI3      77                               119889
1017 O                       58SPI3      77                               119889
1018 O**  PRINT CUSTOMER NAME AND ADDRESS FOR ALL RECORDS                 119889
1019 O*                                                                   119889
1020 O        D 1      16 13                                              119889
1021 O*******OR*1      33 13                                              119889              202628
     O       OR 1      35 13                                                                  202628
1022 O                         CST3   B  42                               119889
1020 O        D 1      16 13                                              119889
1021 O*******OR*1      33 13                                              119889              202628
     O       OR 1      35 13                                                                  202628
1022 O                         CST4   B  42                               119889
     O                 29                60 'BENIFICIARY BANK'            119889
1023 O        D 1      16 13                                              119889
1024 O*******OR*1      33 13                                              119889              202628
     O       OR 1      35 13                                                                  202628
     O                 29      SPI1      77                               119889
     O                 U1 47             80 '** TELEX GENERATED **'       119889
1026 O        D 1      16 13                                              119889
1027 O*******OR*1      33 13                                              119889              202628
     O       OR 1      35 13                                                                  202628
1029 O        D 2      16 13                                              119889
1030 O*******OR*2      33 13                                              119889              202628
     O       OR 2      35 13                                                                  202628
     O                    U4 96          70 '** AUTO TRANSMISSION -'      119889
     O                    U4 96          85 'DO NOT SEND **'              119889
     O**                                                                  119889
     O**  OUTPUT THIS LINE ONLY IF THERE ARE RECORDS ON FILE (*IN75 ON)   119889
     O        T 3 12   L1 88 75                                           119889
     O       AND          63                                              119889
     O                                   64 '*** END OF REPORT'           119889
     O                                   75 'FOR BRANCH'                  119889
     O                         BRCA      79                               119889
     O                                   83 '***'                         119889
     O**  OUTPUT THIS LINE ONLY IF THERE ARE RECORDS ON FILE (*IN75 ON)   119889
     O        T 3 12   LRN88 75                                           119889
     O       AND          63                                              119889
     O                                   76 '*** END OF REPORT ***'       119889
      *                                                                   119889
     O*
     OLE1160AUT   06   LR
     O                                   24 'REFERENCE LE1160AU'
     O                         TITL      89
     O                                  104 'DATE'
     O                         RUNA     112
     O                                  122 'PAGE'
     O                         PAGE  Z  127
     O        T 2      LR
     O                                   55 '    PRINT END OF DAY'
     O                                   69 'CONFIRMATIONS'
     O                                   90 ' - FILE CONTROLS     '
     O        T 13     LR
     O                                   55 '    ----------------'
     O                                   69 '--------------'
     O                                   90 '----------------     '
     O*
     O** Report any data base errors
     O*
     O        T 3      LR U7 U8
     O                                   42 '*** REFERENCE'
     O                         DBPGM     55
     O                                   76 '-DATA BASE ERROR AT'
     O                         DBASE     81
     O        T 1      LR U7 U8
     O                                   37 'FILE NAME'
     O                         DBFILE    48
     O                                   55 'KEY'
     O                         DBKEY     88
     O*
     O        T 1      LR
     O                                   26 'S/CONFS - RUN CONTROLS'
     O                                   58 'NUMBER'
     O        T 11     LR
     O                                   26 '----------------------'
     O                                   58 'OF RECORDS'
     O        T 11     LR
     O                                   28 'TOTAL RECORDS ON FILE'
     O                      NU7NORE  3   58
     O        T 11     LR
     O                                   30 'TOTAL RECORDS ON FILE -'
     O                                   40 'CALCULATED'
     O                         RECTOT3   58
     O                       71          82 '***  DIFFERENCE  ***'
     O        T 11     LR 72
     O                                   26 'TOTAL TELEX RECORDS'
     O                         TOTLX 3   58
     O        T 1      LR U4
     O                                   11 'S/LENXT'
     O        T 11     LR U4
     O                                   11 '-------'
     O        T 11     LR U4
     O                                   28 'TOTAL RECORDS ON FILE'
     O                         RECXTO3   58
** CPY@   **      OBJECT COPYRIGHT
(c) Misys International Banking Systems Ltd. 2001
**  POWER - Array of powers for currency conversion                                           CLE031
0000001                                                                                       CLE031
0000010                                                                                       CLE031
0000100                                                                                       CLE031
0001000                                                                                       CLE031
0010000                                                                                       CLE031
0100000                                                                                       CLE031
1000000                                                                                       CLE031
**   SVAL  -  SYSTEM VALUES ARRAY                                                             218782
Settlement09Postings                                                                          218782
**   ZYDY - YEARS IN DAYS CUMULATIVE IN FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM  -  MONTHS SHORTNAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
