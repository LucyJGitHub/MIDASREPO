0001 H
      ****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas LE Interest accruals extract')                   *
0003 F*                                                               *
0002 F*****************************************************************
0003 F*                                                               *
0004 F*  Midas  CUSTOMER LENDING MODULE                               *
0005 F*                                                               *
0006 F*  LE3000 - INTEREST ACCRUALS EXTRACT                           *
0007 F*                                                               *
      *  (c) Finastra International Limited 2001                      *
      *                                                               *
      *  Last Amend No. MD058815           Date 28Sep21               *
      *  Prev Amend No. CLE172             Date 01Oct20               *
      *                 CSD103             Date 10Aug20               *
      *                 MD055733           Date 03Jul20               *
      *                 MD053295           Date 13Apr19               *
      *                 MD050139           Date 23Mar18               *
      *                 MD046248           Date 27Oct17               *
      *                 MD047993           Date 23Sep17               *
      *                 MD035545           Date 11Sep15               *
      *                 CGL184             Date 07Dec16               *
      *                 CLE141             Date 08Feb16               *
      *                 AR830785           Date 07May13               *
      *                 AR996895           Date 25Nov12               *
      *                 CLE134             Date 01Aug12               *
      *                 CLE148             Date 23Jul12               *
      *                 CLE064             Date 06Dec10               *
      *                 263666             Date 01Feb10               *
      *                 CER059             Date 19Jul10               *
      *                 CER016A            Date 19May08               *
      *                 CER020             Date 19May08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *                 246141             Date 26Mar07               *
      *                 164847             Date 30Nov06               *
      *                 BUG12990           Date 05Jan07               *
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 242286             Date 25Sep06               *
      *                 CSD027             Date 09Dec05               *
      *                 CLE042             Date 06Sep05               *
      *                 CIR013             Date 25Apr05               *
      *                 CGL029             Date 01Sep03               *
      *                 CLE028             Date 27Jun02               *
      * Midas Release 4 --------------- Base -------------------------*
      *                 142199             Date 25May01               *
      * Midas DBA 3.05 -----------------------------------------------*
      *                 CLE011             Date 07Nov00               *
      * Midas DBA 3.03 -----------------------------------------------*
      *                 CIR004             Date 20Jan00               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 121768             Date 19Feb98               *
      *                 126017             Date 18Nov97               *
      *                 CLE005             Date 22May97               *
      *                 097885             Date 31Jan97               *
      *                 095244             Date 01Nov95               *
      *                 095238             DATE 31OCT95               *
      *                 066550             DATE 04FEB94               *
      *                                                               *
      *****************************************************************
      *                                                               *
      *  MD058815 - Dealing interest Calculation type 6 have different*
      *             interest amount for Calculation type 1 for non-   *
      *             leap year interest period with same parameters.   *
      *             Based from MD052690. (Recompile)                  *
      *  CLE172 - LIBOR Deregulation - Lending (Recompile)            *
      *  CSD103 - LIBOR Deregulation - Common Layer/Standing Data     *
      *  MD055733 - COB: Multiple UTCHOBJEX calls in LEC06A           *
      *             components.                                       *
      *           - Redeliver of MD050139.                            *
      *  MD053295 - Lending loan with Interest Calculation Basis      *
      *             method 3 (30/360) has wrong interest payment      *
      *             amount for month of March (Recompile)             *
      *  MD050139- AOSARDR0 called every time causing performance     *
      *            issue. Recompile due to changes in /COPY           *
      *            ZFREQ/ZFRQ*.                                       *
      *  MD046248 - Finastra Rebranding                               *
      *  MD047993 - Modified MD035545. Removed dependency on Accrue   *
      *             on Last Day indicator.                            *
      *  MD035545 - LE: Interest Calculation in Leap year. Consider   *
      *             Accrue on Last Day Indicator for method 6.        *
      *  CGL184 - New Frequencies for Account Statements (Recompile)  *
      *  CLE141 - Currency and Location Business Day Convention       *
      *           (Recompile)                                         *
      *  AR830785 - Recompiled due to changes in core hook RULE78Z1.  *
      *             (Child: AR830786)                                 *
      *  AR996895 - Incorrect accrual interest calculation.           *
      *             (Child:AR996897) (Recompile)                      *
      *  CLE134 - Past Due Call Loan Processing                       *
      *  CLE148 - Alpha Loan Reference                                *
      *  CLE064 - Enhancement of Lending Frequencies (Recompile)      *
      *  263666 - Recompiled due to changes in ZINTDYZ2               *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  CER016A - German Interest Calculation: Upgarde of FGE059     *
      *            to Midas Plus (Recompile)                          *
      *  CER020 - Enhanced Rollover Window: Upgrade FGE089 to         *
      *           Midas Plus                                          *
      *  246141 - Recompiled due to changes in ZINTDYZ2               *
      *  164847 - Recompile over changes in /COPY ZINTDYZ2.           *
      *  BUG12990 - Recompiled due to changes in ZINTDYZ2/ZINTDYZ2LE  *
      *  242286 - Recompile over changes in /COPY ZINTDYZ2.           *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CLE042 - Extended Loan Sub Type                              *
      *  CIR013 - Additional Calculation Method for FRA/IRS/CCF       *
      *           Recompile over GLINTC and ZINTDY.                   *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  CLE028 - Flat Rate Personal Loans (Rule of 78s)              *
      *  142199 - Incorrect 'PERIOD TO' field in LE1120P1 rpt for     *
      *           repayment type 1 or 3.                              *
      *  CLE011 - Rate Fixing Days for Lending Rollover Processing    *
      *           Recompile                                           *
      *  CIR004 - Dealing Calculation Method Change.                  *
      *         - Recompiled due to GLINTC and ZINTDY changes         *
     F*  121768 - Recompile over changed GLINTCZ1                     *
     F*  126017 - Correction to interest calculation for calculation  *
     F*           basis 6 in SR/GLINTC. Add SR/ZDAT10                 *
     F*  CLE005 - Customer Lending Enhancements - Others (T3)         *
     F*  097885 - Recompiled for wrong calculation of number of day   *
     F*           interest (ZINTDYZ2).                                *
     F*  095244 - Recompiled for Calculation method 3                 *
     F*  095238 - Recompiled for Calculation method 3                 *
     F*    066550 - GLINTC has had historical problems and inaccuracies  *
     F*             and is now externaly descibed and changed to use     *
     F*             ZINTDYZ1. See document atached to error no on GEMS   *
0012 F********************************************************************LE3000
0011 F*                                                                  *LE3000
     F*  C R E A T I O N     P A R A M E T E R S                      *
     F*                                                               *
     F*                                                               *
     F*****************************************************************
     F/COPY WNCPYSRC,LE3000F002
0013 F*CLOAN***IP**F     400  7AI     2 DISK                       LE3000 CLE011
0013 F***CLOAN** IP  F    1310  7AI     2 DISK                                         CLE011 CLE028
     F***CLOAN** IP  F    1375  7AI     2 DISK                                         CLE028 CGL029
     F*CLOAN***IP**F****1461  7AI     2 DISK                                           CGL029 CLE042
     F***CLOAN** IP  F    1773  7AI     2 DISK                                         CLE042 CER020
     F***CLOAN** IP  F    1782  7AI     2 DISK                                         CER020 CLE134
     FCLOAN   IP  F    1874  7AI     2 DISK                                                   CLE134
     F/COPY WNCPYSRC,LE3000F003
0014 FTABLE   IF  F      96 12AI     2 DISK                               LE3000
0015 F*CLOANC**IF**F*****400  7AI     2 DISK                                           LE3000 CLE042
     F***CLOANC* IF  F    1773  7AI     2 DISK                                         CLE042 CLE134
     FCLOANC  IF  F    1874  7AI     2 DISK                                                   CLE134
0016 FLEACXHH O   F     128            DISK                               LE3000
0016 F*LEACXAC*O***F*****128            DISK                                           LE3000 CLE042
     FLEACXAC O   F     132            DISK                               LE3000              CLE042
0016 FLEACXZZ O   F     128            DISK                               LE3000
0017 FLE3000P1O   F     132            PRINTER                            S01124
     F/COPY WNCPYSRC,LE3000F001
0018 F* ID F  C  H  L    FUNCTION OF INDICATORS                           LE3000
0019 F* 01            CLOAN LIVE RECORD 'A'                               LE3000
0020 F* 02            CLOAN MATURED RECORD 'A'                            LE3000
0021 F*       34      USED IN WTAX SUBROUTINE                             LE3000
0022 F*       35      WORK INDICATOR                                      LE3000
0023 F*       36      WORK INDICATOR                                      LE3000
0024 F*       37      WORK INDICATOR                                      LE3000
0025 F*       38      LOAN NOT YET STARTED                                LE3000
0026 F*       39      PART. SOLD                                          LE3000
0027 F*       40      FIRST CYCLE                                         LE3000
0028 F*       41      CURRENT PRINCIPAL NEGATIVE                          LE3000
0029 F*       45      ACCRUAL DATE BEFORE NEXT WORKING DAY                LE3000
0030 F*       46      DETAIL OUTPUT TO LEACX                              LE3000
0031 F*       58      ACCRUE ON LAST DAY                                  LE3000
0032 F*       60      EXCPT OUTPUT HEADER TO LEACX                        LE3000
0033 F*       90-99   STANDARD SUBROUTINES                                LE3000
0034 F*       U7,U8   STANDARD MIDAS USAGE                                LE3000
0035 E                    ZYDY    4   4  4 0             ZDATE1/2 SR.ARRAYLE3000
0036 E                    ZMDY   13  13  3 0             ZDATE1/2 SR.ARRAYLE3000
0037 E                    ZMNM   12  12  3               ZDATE2 SR. ARRAY LE3000
     E/COPY ZSRSRC,ZDATE9Z1                                               066550
     E/COPY ZSRSRC,ZFREQBZ1                                                                   CLE028
     E/COPY ZSRSRC,ZHOLE                                                                      CLE028
0038 I**                                                                  LE3000
0039 I**   CLOAN FILE 'A' RECORD                                          LE3000
0040 I**                                                                  LE3000
0041 ICLOAN   NS  01   1 CD   8 CA                                        LE3000
0042 I       OR   02   1 CM   8 CA                                        LE3000
0043 I                                        1   1 RECI                  LE3000
0044 I**********                              2   70LNRF                               LE3000 CLE148
     I                                        2   7 LNRF                                      CLE148
0045 I                                        8   8 RCDT                  LE3000
0046 I                                        9   90MRIN                  LE3000
0047 I                                       10  110PTYP                  LE3000
0048 I**********                             12  170CNUM                               LE3000 CSD027
0048 I                                       12  17 CNUM                                      CSD027
0049 I                                       18  200BRCD                  LE3000
0050 I                                       21  22 LTYP                  LE3000
0051 I                                       23  24 SUTP                  LE3000
0052 I                                    P  25  270DDAT                  LE3000
0053 I                                    P  28  300VDAT                  LE3000
0054 I                                    P  31  330MDAT                  LE3000
0055 I                                       34  350LASQ                  LE3000
0056 I**********                             36  410FCUS                               LE3000 CSD027
0056 I                                       36  41 FCUS                                      CSD027
0057 I                                       42  440FTYP                  LE3000
0058 I                                       45  460FSEQ                  LE3000
0059 I                                       47  49 CCY                   LE3000
0060 I                                    P  50  560CPAM          41      LE3000
0061 I                                       57  57 INTC                  LE3000
0062 I                                    P  58  637INTR                  LE3000
0063 I**********                             64  650BRTT                               LE3000 CSD103
0063 I                                       64  65 BRTT                                      CSD103
0064 I                                    P  66  717BRTE                  LE3000
0065 I                                    P  72  777RTSP                  LE3000
0066 I                                    P  78  815MARG                  LE3000
0067 I                                       82  82 SPIN                  LE3000
0068 I                                       83  83 CHIN                  LE3000
0069 I                                    P  84  897WTRT                  LE3000
0070 I                                       90  90 WTIN                  LE3000
0071 I                                       91  910REPT                  LE3000
0072 I                                    P  92  980RAMT                  LE3000
0073 I                                    P  99 1010NRPD                  LE3000
0074 I                                      102 102 RFRQ                  LE3000
0075 I                                      103 1040RDYN                  LE3000
0076 I                                      105 107 FCCY                  LE3000
0077 I                                      108 1100LIND                  LE3000
0078 I                                      111 112 CRSK                  LE3000
0079 I                                      113 114 ACOF                  LE3000
0080 I                                      115 115 NACD                  LE3000
0081 I                                      116 116 RELI                  LE3000
0082 I                                      117 117 AUTO                  LE3000
0083 I                                    P 118 1240PSAM                  LE3000
0084 I                                    P 125 1318BCXR                  LE3000
0085 I                                    P 132 1388FCXR                  LE3000
0086 I                                      139 1400SDST                  LE3000
0087 I**********                            141 152 OSDA                               LE3000 CGL029
     I                                      141 152 OSDAQQ                                    CGL029
0088 I                                      153 162 TSTN                  LE3000
0089 I                                      163 1640MDST                  LE3000
0090 I**********                            165 176 OMDA                               LE3000 CGL029
     I                                      165 176 OMDAQQ                                    CGL029
0091 I                                      177 186 TMAN                  LE3000
0092 I                                      187 196 FACO                  LE3000
0093 I                                    P 197 1990RLDT                  LE3000
0094 I                                    P 200 2020NROD                  LE3000
0095 I                                      203 203 RLFQ                  LE3000
0096 I                                      204 2050RLDY                  LE3000
0097 I**********                            207 2080NBRA                               LE3000 CSD103
0097 I                                      207 208 NBRA                                      CSD103
0098 I                                    P 209 2147NRTS                  LE3000
0099 I                                      215 215 NSIN                  LE3000
0100 I                                      216 2160NCAC                  LE3000
0101 I                                    P 217 2230AWTP                  LE3000
0102 I                                    P 224 2300WTRD                  LE3000
0103 I                                    P 231 2370WTWD                  LE3000
0104 I                                    P 238 2440IWOD                  LE3000
0105 I                                    P 245 2510PWOD                  LE3000
0106 I                                      287 287 BTIN                  LE3000
0107 I                                      288 2890BLDY                  LE3000
0108 I**********                            290 2950OLNO                               LE3000 CSD027
     I                                      290 295 OLNO                                      CSD027
0109 I                                      296 296 RCSI                  LE3000
0110 I                                      297 2970ICBS                  LE3000
0111 I                                      298 298 IPFR                  LE3000
0112 I                                    P 299 3050TOTI                  LE3000
0113 I                                    P 306 3080NIDT                  LE3000
0114 I                                    P 309 3110IBDT                  LE3000
0115 I                                    P 312 3140SLID                  LE3000
0116 I                                    P 315 3210AIPD                  LE3000
0117 I                                    P 322 3240DLRC                  LE3000
0118 I                                    P 325 3270IACD                  LE3000
0119 I                                    P 328 3340AITC                  LE3000
0120 I                                    P 335 3410TFEP                  LE3000
0121 I                                    P 342 3480AIAP                  LE3000
0122 I                                    P 349 3550IPRD                  LE3000
0123 I                                    P 356 3620IPRM                  LE3000
0124 I                                    P 363 3690ICTD                  LE3000
0125 I                                    P 370 3760AIMN                  LE3000
0126 I                                    P 377 3790RBDT                  LE3000
0127 I                                      384 3850IFDY                  LE3000
0128 I                                      386 386 LONI                  LE3000
0129 I                                      387 387 CNFI                  LE3000
0130 I                                      388 388 ACEI                  LE3000
0131 I                                      389 389 TLXI                  LE3000
0132 I                                      390 390 CBLI                  LE3000
0133 I                                    P 391 3930ORED                  LE3000
0134 I                                    P 394 3960LCD                   LE3000
0135 I                                      397 397 CHTP                  LE3000
0136 I                                    P 398 4000TNLU                  LE3000
     I                                     13491349 ADIF                                      CLE028
     I                                     13501350 ADCF                                      CLE028
     I                                    P135113570CHGA                                      CLE028
     I                                     13581358 ICIF                                      CLE028
     I                                    P135913650FLTI                                      CLE028
     I                                    P136613680FRPD                                      CLE028
     I                                    P136913750ACCH                                      CLE028
     I*************************************13901407 OSDA                               CGL029 CLE042
     I*************************************14081425 OMDA                               CGL029 CLE042
     I                                     15611578 OSDA                                      CLE042
     I                                     15791596 OMDA                                      CLE042
     I                                     17621765 CLAS                                      CLE042
     I                                     17661769 DFCL                                      CER020
     I                                     17701773 SLCL                                      CER020
     I                                    P177417760ISDT                                      CER020
     I                                    P177717790FMDT                                      CER020
     I                                     17801782 LOIC                                      CER020
      *                                                                                       CLE134
     I                                     18301830 FAMU                                      CLE134
     I                                     18311831 FPNR                                      CLE134
     I                                    P183218340RIDT                                      CLE134
     I                                    P183518360RIDC                                      CLE134
     I                                     183718370RCAT                                      CLE134
     I                                    P183818390RCAC                                      CLE134
     I                                    P184018420RCSD                                      CLE134
     I                                    P184318440RCDY                                      CLE134
     I                                    P184518460RCCY                                      CLE134
      *                                                                                       CLE134
     I                                    P184718490BIDT                                      CLE134
     I                                    P185018510BIDC                                      CLE134
     I                                     185218520BCAT                                      CLE134
     I                                    P185318540BCAC                                      CLE134
     I                                    P185518570BCSD                                      CLE134
     I                                    P185818590BCDY                                      CLE134
     I                                    P186018610BICC                                      CLE134
      *                                                                                       CLE134
     I                                     18621864 XRFI                                      CLE134
     I                                     186518740XRFN                                      CLE134
      *                                                                                       CLE134
     I/COPY WNCPYSRC,LE3000I001
0137 I*                                                                   LE3000
0138 I*    LOANS FILE - TRAILER                                           LE3000
0139 I*                                                                   LE3000
0140 I        NS       1 CT                                               LE3000
0141 I                                        1   1 RECI                  LE3000
0142 I**********                              2   70LNRF                               LE3000 CLE148
     I                                        2   7 LNRF                                      CLE148
0143 I                                        8   8 RCDT                  LE3000
0144 I                                    P  17  190NORE                  LE3000
0145 I                                    P  20  220FLSZ                  LE3000
0146 I                                    P  23  250NLRB                  LE3000
0147 I                                    P  26  280NINS                  LE3000
0148 I                                    P  29  310NDEL                  LE3000
0149 I                                    P  32  340NLRA                  LE3000
0150 I                                    P  35  420VLBF                  LE3000
0151 I                                    P  43  440VLBL                  LE3000
0152 I                                    P  45  520VRIF                  LE3000
0153 I                                    P  53  540VRIL                  LE3000
0154 I                                    P  55  620VRDF                  LE3000
0155 I                                    P  63  640VRDL                  LE3000
0156 I                                    P  65  720VLAF                  LE3000
0157 I                                    P  73  740VLAL                  LE3000
0158 I                                    P  75  770DTMR                  LE3000
0159 I                                    P  78  800ITMR                  LE3000
0160 I                                    P 394 3960LCD                   LE3000
0161 I                                      397 397 CHTP                  LE3000
0162 I                                    P 398 4000TNLU                  LE3000
0163 I*                                                                   LE3000
0164 I* CATCHALL                                                          LE3000
0165 I        NS                                                          LE3000
0166 I**                                                                  LE3000
0167 I**                                                                  LE3000
0168 I**   TABLE FILE - INSTALLATION CONTROL DATA RECORD 1.               LE3000
0169 I**                                                                  LE3000
0170 ITABLE   NS       2 C0   3 C1  12 C1                                 LE3000
0171 I       AND      13 C0                                               LE3000
0172 I                                        1   1 RECI                  LE3000
0173 I                                        2   30RECT                  LE3000
0174 I                                       12  130RCDE                  LE3000
0175 I                                       14  66 TITL                  LE3000
0176 I                                       67  67 DATF                  LE3000
0177 I                                       68  700DFBR                  LE3000
0178 I                                       74  74 MODI1                 LE3000
0179 I                                       75  75 MODI2                 LE3000
0180 I                                       76  76 MODI3                 LE3000
0181 I                                    P  77  790RUND                  LE3000
0182 I                                       80  86 RUNA                  LE3000
0183 I                                       87  870SFLG                  LE3000
0184 I                                    P  90  920LCD                   LE3000
0185 I                                       93  93 CHTP                  LE3000
0186 I                                    P  94  960TNLU                  LE3000
0187 I*                                                                   LE3000
0188 I*                                                                   LE3000
0189 I*    TABLE FILE - INSTALLATION CONTROL DATA RECORD 2.               LE3000
0190 I*                                                                   LE3000
0191 I        NS       1 CD   2 C0   3 C1                                 LE3000
0192 I       AND      12 C1  13 C1                                        LE3000
0193 I                                        1   1 RECI                  LE3000
0194 I                                        2   30RECT                  LE3000
0195 I                                       12  130RCDE                  LE3000
0196 I                                       14  16 BCCY                  LE3000
0197 I                                       17  19 BCYL                  LE3000
0198 I                                       20  22 HOCY                  LE3000
0199 I**********                             23  280HEAD                               LE3000 CSD027
0199 I                                       23  28 HEAD                                      CSD027
0200 I                                    P  29  310APDA                  LE3000
0201 I                                       35  35 APFQ                  LE3000
0202 I                                    P  36  380LOGS                  LE3000
0203 I                                       39  40 CUZR                  LE3000
0204 I                                    P  41  430DNWD                  LE3000
0205 I                                       44  460BVLP                  LE3000
0206 I                                       47  49 LOCY                  LE3000
0207 I                                       50  510FDAY                  LE3000
0208 I                                       52  52 ACLD                  LE3000
0209 I                                       53  53 MBIN                  LE3000
0210 I                                       86  86 ISAV                  LE3000
0211 I                                    P  87  890LLOG                  LE3000
0212 I                                    P  90  920LCD                   LE3000
0213 I                                       93  93 CHTP                  LE3000
0214 I                                    P  94  960TNLU                  LE3000
0215 I        NS                                                          LE3000
0216 I                                        1   1 RECI                  LE3000
0217 I**                                                                  LE3000
0218 I**   CLOAN FILE REDEFINED FOR CHAINING                              LE3000
0219 I**                                                                  LE3000
0220 ICLOANC  NS       1 CD   8 CA                                        LE3000
0221 I                                        1   1 RECI                  LE3000
0222 I**********                             12  170CNUM                               LE3000 CSD027
0222 I                                       12  17 CNUM                                      CSD027
0223 I                                       21  22 LTYP                  LE3000
0224 I                                       23  24 SUTP                  LE3000
     I                                     17621765 CLAS                                      CLE042
      *                                                                                       CLE134
     I                                     18301830 FAMU                                      CLE134
     I                                     18311831 FPNR                                      CLE134
     I                                    P183218340RIDT                                      CLE134
     I                                    P183518360RIDC                                      CLE134
     I                                     183718370RCAT                                      CLE134
     I                                    P183818390RCAC                                      CLE134
     I                                    P184018420RCSD                                      CLE134
     I                                    P184318440RCDY                                      CLE134
     I                                    P184518460RCCY                                      CLE134
      *                                                                                       CLE134
     I                                    P184718490BIDT                                      CLE134
     I                                    P185018510BIDC                                      CLE134
     I                                     185218520BCAT                                      CLE134
     I                                    P185318540BCAC                                      CLE134
     I                                    P185518570BCSD                                      CLE134
     I                                    P185818590BCDY                                      CLE134
     I                                    P186018610BICC                                      CLE134
      *                                                                                       CLE134
     I                                     18621864 XRFI                                      CLE134
     I                                     186518740XRFN                                      CLE134
      *                                                                                       CLE134
0225 I        NS                                                          LE3000
0226 I                                        1   1 RECI                  LE3000
0227 I**                                                                  LE3000
0228 I**   DATA STRUCTURES                                                LE3000
0229 I**                                                                  LE3000
0230 I**   LDA FOR DATABASE ERROR IDENTIFICATION                          LE3000
0231 ILDA        UDS                            256                       LE3000
0232 I                                      134 138 DBFILE                LE3000
0233 I                                      139 167 DBKEY                 LE3000
0234 I                                      168 175 DBPGM                 LE3000
0235 I                                      176 1770DBASE                 LE3000
     I              'LECalcBasis6LeapYear'C         WPARML                                  MD035545
     I/COPY ZSRSRC,ZINTDYZ1                                               066550
     I/COPY ZSRSRC,ZDATE9Z2                                               066550
     I/COPY ZSRSRC,ZDAT10Z1                                               126017
     I/COPY ZSRSRC,ZAOZ1                                                                      CLE028
     I/COPY ZSRSRC,ZAOZ2                                                                      CLE028
     I/COPY ZSRSRC,ZHOLI                                                                      CLE028
     I/COPY ZSRSRC,ZHOLDS                                                                     CLE028
0236 C**                                                                  LE3000
0237 C**   FIRST CYCLE CALCS                                              LE3000
0238 C**                                                                  LE3000
0239 C   40                GOTO ENDFC                                     LE3000
0240 C                     SETON                     40                   LE3000
0241 C**                                                                  LE3000
0242 C                     EXSR ZSYSTM                                    LE3000
0243 C   99                MOVE 'TABLE'   DBFILE                          LE3000
0244 C   99                MOVELZTABKY    DBKEY                           LE3000
0245 C   99                Z-ADD1         DBASE            DBASE 1        LE3000
0246 C   99                SETON                     U7U8LR               LE3000
0247 C   99                GOTO END                                       LE3000
0248 C**                                                                  LE3000
0249 C**   ACCESS ICDR 2                                                  LE3000
0250 C**                                                                  LE3000
0251 C                     MOVE '11'      ZTABKY                          LE3000
0252 C           ZTABKY    CHAINTABLE                99                   LE3000
0253 C  N99      RECI      COMP 'D'                  9999                 LE3000
0254 C   99                MOVE 'TABLE'   DBFILE                          LE3000
0255 C   99                MOVELZTABKY    DBKEY                           LE3000
0256 C   99                Z-ADD2         DBASE            DBASE 2        LE3000
0257 C   99                SETON                     U7U8LR               LE3000
0258 C   99                GOTO END                                       LE3000
0259 C**                                                                  LE3000
0260 C**   CALCULATE TITLE DATE AND REPORT CONTROL DATE                   LE3000
0261 C**                                                                  LE3000
0262 C           ACLD      COMP 'Y'                      58               LE3000
0263 C           APDA      COMP DNWD                   45                 LE3000
0264 C**                                                                  LE3000
0265 C                     Z-ADDDNWD      TDAT    50                      LE3000
0266 C   45                Z-ADDAPDA      TDAT    50                      LE3000
0267 C   45      TDAT      ADD  1         TDAT                            LE3000
0268 C**                                                                  LE3000
0269 C                     Z-ADDDNWD      REPCD   50                      LE3000
0270 C   58      DNWD      SUB  1         REPCD                           LE3000
0271 C   45      APDA      ADD  1         REPCD                           LE3000
0272 C   45 58             Z-ADDAPDA      REPCD                           LE3000
      *                                                                                       CLE028
      ** Store Original Report Control Date.                                                  CLE028
      *                                                                                       CLE028
     C                     Z-ADDREPCD     WSTRRP  50                                          CLE028
0273 C**                                                                  LE3000
0274 C                     Z-ADD1         CONTIN  50                      LE3000
0275 C                     Z-ADD1         CNTOUT  50                      LE3000
0276 C**                                                                  LE3000
0277 C                     MOVE 'A'       CLOKEY  7                       LE3000
0278 C**                                                                  LE3000
0279 C**   OUTPUT HEADER TO EXTRACT FILE                                  LE3000
0280 C**                                                                  LE3000
0281 C                     SETON                     60                   LE3000
0282 C                     EXCPT                                          LE3000
0283 C                     SETOF                     60                   LE3000
      *                                                                                     MD035545
      ** Retrieve system value setting.                                                     MD035545
      *                                                                                     MD035545
     C                     MOVELWPARML    P@OP01                                            MD035545
     C                     CALL 'AOSVALR0'                                                  MD035545
     C                     PARM *BLANKS   @RTCD                                             MD035545
     C                     PARM           P@OP01 20                                         MD035545
     C                     PARM           P@VL01200                                         MD035545
     C                     PARM           P@OP02 20                                         MD035545
     C                     PARM           P@VL02200                                         MD035545
     C                     PARM           P@OP03 20                                         MD035545
     C                     PARM           P@VL03200                                         MD035545
     C                     PARM           P@OP04 20                                         MD035545
     C                     PARM           P@VL04200                                         MD035545
     C                     PARM           P@OP05 20                                         MD035545
     C                     PARM           P@VL05200                                         MD035545
     C                     PARM           P@OP06 20                                         MD035545
     C                     PARM           P@VL06200                                         MD035545
     C                     PARM           P@OP07 20                                         MD035545
     C                     PARM           P@VL07200                                         MD035545
     C                     PARM           P@OP08 20                                         MD035545
     C                     PARM           P@VL08200                                         MD035545
     C                     PARM           P@OP09 20                                         MD035545
     C                     PARM           P@VL09200                                         MD035545
     C                     PARM           P@OP10 20                                         MD035545
     C                     PARM           P@VL10200                                         MD035545
      *                                                                                     MD035545
      ** If system value is not found then default value to 'N'.                            MD035545
      *                                                                                     MD035545
     C           @RTCD     IFNE '       '                                                   MD035545
     C                     MOVE 'N'       WCALC6                                            MD035545
     C                     ELSE                                                             MD035545
     C                     MOVELP@VL01    WCALC6                                            MD035545
     C********** WCALC6    IFEQ 'Y'                                                MD035545 MD047993
     C********** BKALDI    ANDEQ'Y'                                                MD035545 MD047993
     C**********           MOVE 'Y'       WCALC6                                   MD035545 MD047993
     C**********           ELSE                                                    MD035545 MD047993
     C**********           MOVE 'N'       WCALC6                                   MD035545 MD047993
     C**********           ENDIF                                                   MD035545 MD047993
     C                     ENDIF                                                            MD035545
     C/COPY WNCPYSRC,LE3000C001
0284 C**                                                                  LE3000
0285 C           ENDFC     TAG                             ** ENDFC TAG **LE3000
0286 C**                                                                  LE3000
0287 C** MAIN PROCESSING                                                  LE3000
0288 C**                                                                  LE3000
0289 C                     SETOF                     46                   LE3000
0290 C  N01N02             GOTO END                                       LE3000
0291 C**                                                                  LE3000
0292 C**   ACCUMULATE HASH TOTALS FOR RECORDS READ IN                     LE3000
0293 C**                                                                  LE3000
0294 C                     Z-ADDINWN      ZZTOTI                          LE3000
0295 C                     Z-ADDINDC      ZZTOTD                          LE3000
0296 C                     MOVE CPAM      ZZAMT                           LE3000
0297 C   41                Z-SUBZZAMT     ZZAMT                           LE3000
0298 C                     EXSR GLZADD                                    LE3000
0299 C                     Z-ADDZZTOTI    INWN   150                      LE3000
0300 C                     Z-ADDZZTOTD    INDC    30                      LE3000
0301 C           CONTIN    ADD  2         CONTIN                          LE3000
0302 C**                                                                  LE3000
0303 C   02                GOTO END                                       LE3000
     C/COPY WNCPYSRC,LE3000C002
0304 C**                                                                  LE3000
0305 C**   CHECK FOR CONDITIONS TO SKIP INTEREST CALCS                    LE3000
      *                                                                                       CLE028
      ** If Flat Rate Personal Loans (Rule of 78s) is installed,                              CLE028
      ** adjustment of end date above does not apply to flat rate                             CLE028
      ** personal loans.                                                                      CLE028
      *                                                                                       CLE028
     C           CLE028    IFEQ 'Y'                                                           CLE028
     C           PTYP      ANDEQ80                                                            CLE028
     C           *IN45     IFEQ *ON                                                           CLE028
     C                     Z-ADDAPDA      REPCD                                               CLE028
     C                     ELSE                                                               CLE028
     C           DNWD      SUB  1         REPCD                                               CLE028
     C                     ENDIF                                                              CLE028
     C                     ELSE                                                               CLE028
     C                     Z-ADDWSTRRP    REPCD                                               CLE028
     C                     ENDIF                                                              CLE028
0306 C**                                                                  LE3000
0307 C**   - LOAN NOT STARTED                                             LE3000
0308 C           SLID      COMP RUND                 38                   LE3000
0309 C   38                Z-ADD0         AMAD   130                      LE3000
0310 C   38                Z-ADD0         WTAD   130                      LE3000
0311 C   38                GOTO TAG10                                     LE3000
0312 C**   - PRINCIPAL LE 0                                               LE3000
0313 C   41                Z-ADD0         ZINTR                           LE3000
0314 C   41                GOTO TAG05                                     LE3000
0315 C**   - INTEREST RATE 0                                              LE3000
0316 C           INTR      COMP 0                        35               LE3000
0317 C   35                GOTO END                                       LE3000
0318 C**                                                                  LE3000
0319 C**   CALCULATE INTEREST FROM CONTROL DATE                           LE3000
0320 C**                                                                  LE3000
0321 C           MDAT      COMP REPCD                  35                 LE3000
0322 C           MDAT      COMP 0                    36                   LE3000
0323 C**                                                                  LE3000
     C           CLE028    IFEQ 'Y'                                                           CLE028
     C           PTYP      ANDEQ80                                                            CLE028
     C                     Z-ADDVDAT      ZIBEG                                               CLE028
     C                     ELSE                                                               CLE028
0324 C                     Z-ADDIACD      ZIBEG                           LE3000
     C                     ENDIF                                                              CLE028
0325 C                     Z-ADDREPCD     ZIEND                           LE3000
0326 C   35 36             Z-ADDMDAT      ZIEND                           LE3000
      *                                                                                       CLE028
      ** If Flat Rate Personal Loans (Rule of 78s) is installed,                              CLE028
      ** derive the outstanding interest of flat rate personal                                CLE028
      ** loans using the Rule of 78s.                                                         CLE028
      *                                                                                       CLE028
     C           CLE028    IFEQ 'Y'                                                           CLE028
     C           PTYP      ANDEQ80                                                            CLE028
      *                                                                                       CLE028
     C                     EXSR SRIN78                                                        CLE028
      *                                                                                       CLE028
     C                     ELSE                                                               CLE028
0327 C                     MOVE ICBS      ZICALC                          LE3000
0328 C                     Z-ADDCPAM      ZIAMT                           LE3000
0329 C                     Z-ADDINTR      ZIRATE                          LE3000
     C/COPY WNCPYSRC,LE3000C003
0330 C                     EXSR GLINTC                                    LE3000
     C/COPY WNCPYSRC,LE3000C004
     C                     ENDIF                                                              CLE028
      *                                                                                       CLE028
0331 C           TAG05     TAG                             ** TAG05 TAG **LE3000
0332 C**                                                                  LE3000
0333 C**   ACCUMULATE TOTAL INTEREST TO DATE                              LE3000
0334 C**                                                                  LE3000
     C           CLE028    IFEQ 'Y'                                                           CLE028
     C           PTYP      ANDEQ80                                                            CLE028
     C           *IN41     ANDEQ*OFF                                                          CLE028
     C                     Z-ADDZINTR     TOTINT    H                                         CLE028
     C                     ELSE                                                               CLE028
0335 C           ZINTR     ADD  AITC      TOTINT 130H                     LE3000
     C                     ENDIF                                                              CLE028
      *                                                                                       CLE028
0336 C           TOTINT    ADD  AIMN      TOTINT                          LE3000
0337 C           TOTINT    ADD  AIAP      TOTINT                          LE3000
0338 C**                                                                  LE3000
0339 C**   CALCULATE INTEREST ACCRUED                                     LE3000
0340 C**                                                                  LE3000
      *                                                                                       CLE028
     C           CLE028    IFEQ 'N'                                                           CLE028
     C           CLE028    OREQ 'Y'                                                           CLE028
     C           PTYP      ANDNE80                                                            CLE028
     C           CLE028    OREQ 'Y'                                                           CLE028
     C           PTYP      ANDEQ80                                                            CLE028
     C           ADIF      ANDNE'Y'                                                           CLE028
0341 C           TOTINT    SUB  IPRD      AMAD   130                      LE3000
     C                     ELSE                                                               CLE028
0341 C                     Z-ADDTOTINT    AMAD                                                CLE028
     C                     ENDIF                                                              CLE028
0342 C           AMAD      SUB  ICTD      AMAD                            LE3000
0343 C           AMAD      SUB  IWOD      AMAD                            LE3000
0344 C**                                                                  LE3000
0345 C                     SETON                     46                   LE3000
0346 C**                                                                  LE3000
0347 C**   CHECK FOR W/T TYPE AND CALCULATE AMOUNT IF NECESSARY           LE3000
0348 C**                                                                  LE3000
0349 C           WTIN      COMP ' '                  3535                 LE3000
0350 C   35                Z-ADDAMAD      INTAMT 130                      LE3000
0351 C   35                EXSR WTAX                                      LE3000
0352 C   35                Z-ADDWTAMT     WTAD   130                      LE3000
0353 C  N35                Z-ADD0         WTAD                            LE3000
0354 C           TAG10     TAG                             ** TAG10 TAG **LE3000
0355 C**                                                                  LE3000
0356 C**   DETERMINE WHETHER INTEREST IS TO BE ACCRUED TO END OF          LE3000
0357 C**   PERIOD AND SET UP TO DATE IF REQUIRED                          LE3000
0358 C**                                                                  LE3000
0359 C   41                Z-ADD0         AMTA                            LE3000
0360 C   41                Z-ADD0         WTTA                            LE3000
0361 C   41                GOTO END                                       LE3000
0362 C**                                                                  LE3000
0363 C           NIDT      COMP REPCD                35                   LE3000
0364 C           MDAT      COMP 0                    36                   LE3000
0365 C           MDAT      COMP REPCD                  3737               LE3000
0366 C***35******          Z-ADDNIDT      TODAT   50                      142199
0367 C**N35*36***          Z-ADDMDAT      TODAT                           142199
0368 C**N35N36***          Z-ADD0         TODAT                           142199
     C*                                                                   142199
     C           REPT      IFEQ 1                                         142199
     C           REPT      OREQ 3                                         142199
     C           NRPD      IFEQ 0                                         142199
     C           PTYP      OREQ 80                                                            CLE028
     C           CLE028    ANDEQ'Y'                                                           CLE028
     C           ADIF      ANDEQ'Y'                                                           CLE028
     C                     Z-ADDMDAT      TODAT   50                      142199
     C                     ELSE                                           142199
     C                     Z-ADDNRPD      TODAT                           142199
     C                     END                                            142199
     C                     ELSE                                           142199
     C           NIDT      IFEQ 0                                         142199
     C                     Z-ADDMDAT      TODAT                           142199
     C                     ELSE                                           142199
     C           NIDT      IFLT MDAT                                      142199
     C                     Z-ADDNIDT      TODAT                           142199
     C                     ELSE                                           142199
     C                     Z-ADDMDAT      TODAT                           142199
     C                     END                                            142199
     C                     END                                            142199
     C                     END                                            142199
     C*                                                                   142199
0369 C  N35 37             Z-ADD0         AMTA   130                      LE3000
0370 C  N35 37             Z-ADD0         WTTA   130                      LE3000
0371 C  N35 37             GOTO END                                       LE3000
0372 C**                                                                  LE3000
0373 C                     SETON                     46                   LE3000
0374 C**                                                                  LE3000
0375 C**   CALCULATE INTEREST TO ACCRUE                                   LE3000
0376 C**                                                                  LE3000
      ** If Flat Rate Personal Loans (Rule of 78s) is installed,                              CLE028
      ** add 1 to REPCD when processing a flat rate personal loan.                            CLE028
      ** This is done since the ZIBEG for the computation of the                              CLE028
      ** AMOUNT TO ACCRUE must be the day after the END DATE used                             CLE028
      ** in the computation of ACCRUED INTEREST TO DATE.                                      CLE028
      *                                                                                       CLE028
     C           CLE028    IFEQ 'Y'                                                           CLE028
     C           PTYP      ANDEQ80                                                            CLE028
     C           REPCD     ADD  1         ZIBEG                                               CLE028
     C                     ELSE                                                               CLE028
0377 C                     Z-ADDREPCD     ZIBEG                           LE3000
     C                     ENDIF                                                              CLE028
      *                                                                                       CLE028
0378 C   38                Z-ADDSLID      ZIBEG                           LE3000
0379 C                     Z-ADDTODAT     ZIEND                           LE3000
      *                                                                                       CLE028
      ** If Flat Rate Personal Loans (Rule of 78s) is installed,                              CLE028
      ** derive the AMOUNT OF INTEREST TO ACCRUE of a flat rate                               CLE028
      ** personal loan using the Rule of 78s.                                                 CLE028
      *                                                                                       CLE028
     C           CLE028    IFEQ 'Y'                                                           CLE028
     C           PTYP      ANDEQ80                                                            CLE028
     C                     EXSR SRIN78                                                        CLE028
     C                     ELSE                                                               CLE028
0380 C                     MOVE ICBS      ZICALC                          LE3000
0381 C                     Z-ADDCPAM      ZIAMT                           LE3000
0382 C                     Z-ADDINTR      ZIRATE                          LE3000
     C/COPY WNCPYSRC,LE3000C005
0383 C                     EXSR GLINTC                                    LE3000
     C/COPY WNCPYSRC,LE3000C006
     C                     ENDIF                                                              CLE028
      *                                                                                       CLE028
     C           CLE028    IFEQ 'Y'                                                           CLE028
     C           PTYP      ANDEQ80                                                            CLE028
     C                     Z-ADDZINTR     AMTA      H                                         CLE028
     C                     ELSE                                                               CLE028
0384 C                     Z-ADDZINTR     AMTA                            LE3000
     C                     ENDIF                                                              CLE028
0385 C**                                                                  LE3000
0386 C**   CHECK FOR W/T TYPE AND CALCULATE AMOUNT IF NECESSARY           LE3000
0387 C**                                                                  LE3000
0388 C           WTIN      COMP ' '                  3535                 LE3000
0389 C   35                Z-ADDAMTA      INTAMT                          LE3000
0390 C   35                EXSR WTAX                                      LE3000
0391 C   35                Z-ADDWTAMT     WTTA   130                      LE3000
0392 C  N35                Z-ADD0         WTTA                            LE3000
0393 C           END       TAG                             ** END TAG ****LE3000
0394 C**                                                                  LE3000
0395 C**   COUNT RECORDS OUTPUT                                           LE3000
0396 C**                                                                  LE3000
0397 C   46      CNTOUT    ADD  1         CNTOUT                          LE3000
0398 C**                                                                  LE3000
0399 C**   DETERMINE WHETHER PART. SOLD                                   LE3000
0400 C**                                                                  LE3000
0401 C                     SETOF                     39                   LE3000
0402 C   46      PTYP      COMP 66                       39               LE3000
0403 C   46N39   PTYP      COMP 67                       39               LE3000
      *                                                                   CLE005
      ** Check for Processing Types 69 or 72                              CLE005
      *                                                                   CLE005
     C           CLE005    IFEQ 'Y'                                       CLE005
     C           *IN46     IFEQ *ON                                       CLE005
     C           *IN39     ANDEQ*OFF                                      CLE005
      *                                                                   CLE005
     C           PTYP      IFEQ 69                                        CLE005
     C           PTYP      OREQ 72                                        CLE005
     C                     MOVE *ON       *IN39                           CLE005
     C                     ENDIF                                          CLE005
      *                                                                   CLE005
     C                     ENDIF                                          CLE005
     C                     ENDIF                                          CLE005
      *                                                                   CLE005
0404 C**                                                                  LE3000
0405 C**   IF PART. SOLD CHAIN FOR ORIG. DETS.                            LE3000
0406 C**                                                                  LE3000
0407 C   39                MOVELOLNO      CLOKEY                          LE3000
0408 C   39      CLOKEY    CHAINCLOANC               99                   LE3000
0409 C   39N99   RECI      COMP 'D'                  9999                 LE3000
0410 C   39 99             SETON                     LRU7U8               LE3000
0411 C   39 99             MOVE 'CLOAN'   DBFILE                          LE3000
0412 C   39 99             MOVELCLOKEY    DBKEY                           LE3000
0413 C   39 99             Z-ADD3         DBASE            DBASE 3        LE3000
0414 C   39 99             GOTO END                                       LE3000
0415 C**                                                                  LE3000
0416 C**                                                                  LE3000
0417 C**   LAST RECORD CALCS                                              LE3000
0418 C**                                                                  LE3000
0419 CLR         CONTIN    ADD  1         CONTIN                          LE3000
0420 CLR         CNTOUT    ADD  1         CNTOUT                          LE3000
0421 CLR U7                MOVE 'LE3000'  DBPGM                           LE3000
0422 CLRNU8      CONTIN    COMP NORE                 U8U8                 LE3000
0423 CLRNU8      INWN      COMP VLAF                 U8U8                 LE3000
0424 CLRNU8      INDC      COMP VLAL                 U8U8                 LE3000
0425 C********************************************************************LE3000
0426 C*                                                                  *LE3000
0427 C*    WTAX SR. TO CALCULATE WITHHOLDING TAX AMOUNT                  *LE3000
0428 C*                                                                  *LE3000
0429 C           WTAX      BEGSR                           ** WTAX BEGSR *LE3000
0430 C**                                                                  LE3000
0431 C           WTIN      COMP 'N'                  3434                 LE3000
0432 C   34                GOTO NOTN                                      LE3000
0433 C**                                                                  LE3000
0434 C**   WITHHOLDING TAX NET                                            LE3000
0435 C**                                                                  LE3000
0436 C           100       SUB  WTRT      WRK1   117                      LE3000
0437 C           INTAMT    MULT WTRT      WRK2   130H                     LE3000
0438 C           WRK2      DIV  WRK1      WTAMT  130H                     LE3000
0439 C                     GOTO WTEND                                     LE3000
0440 C**                                                                  LE3000
0441 C**   WITTHOLDING TAX GROSS OR RECEIVABLE                            LE3000
0442 C**                                                                  LE3000
0443 C           NOTN      TAG                             ** NOTN TAG ***LE3000
0444 C           INTAMT    MULT WTRT      WRK2      H                     LE3000
0445 C           WRK2      DIV  100       WTAMT     H                     LE3000
0446 C**                                                                  LE3000
0447 C           WTEND     ENDSR                           ** WTEND ENDSR LE3000
0448 C*                                                                  *LE3000
0449 C*************************************************************LE3000 066550
0450 C***********                                                  LE3000 066550
0451 C*****GLINTC SR. TO CALCULATE INTEREST BETWEEN ANY TWO DAY NU LE3000 066550
0452 C***********                                                  LE3000 066550
0453 C*****THIS*VERSION REPLACES THE ORIGINAL GLINTC SR. NOW NAMED LE3000 066550
0454 C*****GLINTO.                                                 LE3000 066550
0455 C***********                                                  LE3000 066550
0456 C*****CALCULATION METHODS ARE -                               LE3000 066550
0457 C*****1**ACTUAL/365                                           LE3000 066550
0458 C*****2**ACTUAL/360                                           LE3000 066550
0459 C*****3**360/360 (SOMETIMES CALLED 30/360)                    LE3000 066550
0460 C*****4**365/365 (EXCLUDING 29/02)                            LE3000 066550
0461 C*****5**365/360 (EXCLUDING 29/02)                            LE3000 066550
0462 C*****6**ACTUAL/366                                           LE3000 066550
0463 C***********                                                  LE3000 066550
0464 C*****REQUIRES SUBRS. - ZDATE2, ZSAVE, & ZRSTOR.              LE3000 066550
0465 C***********                                                  LE3000 066550
0466 C***********                                                  LE3000 066550
0467 C*R*********GLINTC    BEGSR                           ** GLINTLE3000 066550
0468 C***********                                                  LE3000 066550
0469 C*****CALCULATIONS TO DEFINE INPUT FIELDS.                    LE3000 066550
0470 C*R*********          Z-ADDZIBEG     ZIBEG   50       STARTINGLE3000 066550
0471 C*R*********          Z-ADDZIEND     ZIEND   50       FINISHINLE3000 066550
0472 C*R*********          Z-ADDZICALC    ZICALC  10       CALC. BALE3000 066550
0473 C*R*********          Z-ADDZIAMT     ZIAMT  150       PRINCIPALE3000 066550
0474 C*R*********          Z-ADDZIRATE    ZIRATE 117       RATE OF LE3000 066550
0475 C***********                                                  LE3000 066550
0476 C****TO*DETERMINE NUMBER OF DAYS INTEREST TO BE CALCULATED    LE3000 066550
0477 C*R*********ZIEND     SUB  ZIBEG     ZDAYN1  50               LE3000 066550
0478 C***********                                                  LE3000 066550
0479 C****CHECK*FOR INTEREST CALCULATION BASIS                     LE3000 066550
0480 C*****USE*OF INDICATRS                                        LE3000 066550
0481 C*****1,92**2,90  3,91  4,97  5,96  6,95                      LE3000 066550
0482 C***********          SETOF                     959697        LE3000 066550
0483 C*R*********ZICALC    COMP 2                    919290        LE3000 066550
0484 C**N91******          GOTO ZICAL                              LE3000 066550
0485 C***********ZICALC    COMP 5                    959796        LE3000 066550
0486 C***97******ZICALC    COMP 3                    97  91        LE3000 066550
0487 C***95******                                                  LE3000 066550
0488 C*R*96******          SETOF                     91            LE3000 066550
0489 C**N91******          GOTO ZILPCK                             LE3000 066550
0490 C***********                                                  LE3000 066550
0491 C*****THIS*CODING WILL CALCULATE THE NUMBER OF DAYS TO USE WHELE3000 066550
0492 C*****USING*THE 30/360 BASIS - METHOD 3.                      LE3000 066550
0493 C***********          EXSR ZSAVE                              LE3000 066550
0494 C***********          Z-ADDZIBEG     ZDAYNO                   LE3000 066550
0495 C***********          EXSR ZDATE2                             LE3000 066550
0496 C***********          MOVE ZDAY      ZISD    20               LE3000 066550
0497 C***********          MOVE ZMTH      ZISM    20               LE3000 066550
0498 C***********          MOVE ZYEAR     ZISY    20               LE3000 066550
0499 C***********          Z-ADDZIEND     ZDAYNO                   LE3000 066550
0500 C***********          EXSR ZDATE2                             LE3000 066550
0501 C***********          MOVE ZDAY      ZIFD    20               LE3000 066550
0502 C***********          MOVE ZMTH      ZIFM    20               LE3000 066550
0503 C***********          MOVE ZYEAR     ZIFY    20               LE3000 066550
0504 C***********          EXSR ZRSTOR                             LE3000 066550
0505 C***********          SETOF                     93            LE3000 066550
0506 C***********30        SUB  ZISD      ZID1    50   93          LE3000 066550
0507 C***93******          Z-ADD0         ZID1                     LE3000 066550
0508 C***********ZISM      COMP 12                       93        LE3000 066550
0509 C***93******          Z-ADD0         ZISM                     LE3000 066550
0510 C***93******ZISY      ADD  1         ZISY                     LE3000 066550
0511 C***********ZIFD      COMP 31                       93        LE3000 066550
0512 C***93******ZID1      ADD  30        ZID1                     LE3000 066550
0513 C**N93******ZID1      ADD  ZIFD      ZID1                     LE3000 066550
0514 C***********ZIFM      SUB  1         ZIFM                     LE3000 066550
0515 C***********ZIFM      COMP ZIFY                     93        LE3000 066550
0516 C***93******ZIFM      SUB  ZISM      ZINOM   30               LE3000 066550
0517 C***93******          GOTO ZIOUT                              LE3000 066550
0518 C***********12        SUB  ZISM      ZIM1    20               LE3000 066550
0519 C***********          Z-ADD1         ZISM                     LE3000 066550
0520 C***********ZISY      ADD  1         ZISY                     LE3000 066550
0521 C***********ZIFY      SUB  ZISY      ZIY1    20               LE3000 066550
0522 C***********ZIY1      MULT 12        ZIM2    30               LE3000 066550
0523 C***********ZIM2      ADD  ZIFM      ZIM2                     LE3000 066550
0524 C***********ZIM1      ADD  ZIM2      ZINOM                    LE3000 066550
0525 C***********ZIOUT     TAG                             * ZIOUT LE3000 066550
0526 C***********ZINOM     MULT 30        ZID2    50               LE3000 066550
0527 C***********ZID2      ADD  ZID1      ZDAYN1                   LE3000 066550
0528 C***********          SETOF                     93            LE3000 066550
0529 C***********ZILPCK    TAG                             * ZILPCKLE3000 066550
0530 C**N96N97***          GOTO ZICAL                              LE3000 066550
0531 C*****THE*FOLLOWING CODING APPLIES FOR METHODS 4 AND 5 ONLY.  LE3000 066550
0532 C*****1*DAY*IS SUBTRACTED FROM ZDAYN1 FOR EACH OCCURANCE OF 29LE3000 066550
0533 C*****IN*THE INTEREST CALCULATION PERIOD INCLUSIVE OF ZIBEG, &LE3000 066550
0534 C***********                                                  LE3000 066550
0535 C*****FIND*NO OF 4 YEAR PERIODS BETWEEN DATES                 LE3000 066550
0536 C***********ZDAYN1    DIV  1461      ZIMAN   20               LE3000 066550
0537 C***********          MVR            ZIREM   50               LE3000 066550
0538 C*****FIND*NEXT 29 FEB DAY NO. ON OR AFTER ZIBEG.             LE3000 066550
0539 C***********ZIBEG     SUB  60        ZIBW1   50               LE3000 066550
0540 C***********ZIBW1     DIV  1461      ZIDW1   20               LE3000 066550
0541 C***********          MVR            ZIDREM  50               LE3000 066550
0542 C***********ZIDREM    COMP 0                        94        LE3000 066550
0543 C***94******          Z-ADDZIBEG     ZIDW2   50               LE3000 066550
0544 C***94******          GOTO ZILP1                              LE3000 066550
0545 C*****ROUND*UP RESULT                                         LE3000 066550
0546 C***********ZIDW1     ADD  1         ZIDW2                    LE3000 066550
0547 C*****CALCULATE NEXT 29 FEB.                                  LE3000 066550
0548 C***********ZIDW2     MULT 1461      ZIDW2                    LE3000 066550
0549 C***********ZIDW2     ADD  60        ZIDW2                    LE3000 066550
0550 C***********ZILP1     TAG                             * ZILP1 LE3000 066550
0551 C*****IF*THIS NEXT 29 FEB. DAYNO - ZIBEG IS GR. TH. OR EQ. TO LE3000 066550
0552 C*****ZIREM*THEN ADD 1 TO ZIMAN.                              LE3000 066550
0553 C***********ZIDW2     SUB  ZIBEG     ZILPCP  50               LE3000 066550
0554 C***********ZIREM     COMP ZILPCP               94  94        LE3000 066550
0555 C***94******ZIMAN     ADD  1         ZIMAN                    LE3000 066550
0556 C*****SUBTRACT ZIMAN FROM ZDAYN1 TO GIVE VALUE OF ZDAYN1      LE3000 066550
0557 C*****REQUIRED FOR THIS INTEREST CALCULATION.                 LE3000 066550
0558 C***********ZDAYN1    SUB  ZIMAN     ZDAYN1                   LE3000 066550
0559 C***********          SETOF                     94            LE3000 066550
0560 C***********ZICAL     TAG                             * ZICAL LE3000 066550
0561 C***********                                                  LE3000 066550
0562 C****CALCULATE INTEREST                                       LE3000 066550
0563 C***90******                                                  LE3000 066550
0564 C*R*91******                                                  LE3000 066550
0565 C*R*96******ZIAMT     DIV  36000     ZIWRK1 155H              LE3000 066550
0566 C***92******                                                  LE3000 066550
0567 C*R*97******ZIAMT     DIV  36500     ZIWRK1    H              LE3000 066550
0568 C***95******ZIAMT     DIV  36600     ZIWRK1    H              LE3000 066550
0569 C*R*********ZIWRK1    MULT ZIRATE    ZIWRK2 155H              LE3000 066550
0570 C*R*********ZIWRK2    MULT ZDAYN1    ZINTR  152H      AMT. OF LE3000 066550
0571 C***********                                                  LE3000 066550
0572 C***********          SETOF                     909192        LE3000 066550
0573 C***********          SETOF                     959697         LE3000066550
0574 C*R*********          ENDSR                                    LE3000066550
0575 C***********                                                   LE3000066550
0576 C**************************************************************LE3000066550
0577 C********************************************************************LE3000
0578 C**                                                                  LE3000
0579 C**   ZSAVE SR. TO MEMORISE THE SETTINGS AND TO SET OFF INDICATORS   LE3000
0580 C**              90 - 97 BEFORE EXECUTION OF A Z-SUBROUTINE.         LE3000
0581 C**                                                                  LE3000
0582 C**   THIS SR. IS REQUIRED ONLY IF INDICATORS                        LE3000
0583 C**   90 - 97 ARE USED ELSEWHERE IN A PROGRAM.                       LE3000
0584 C**                                                                  LE3000
0585 C           ZSAVE     BEGSR                           *** ZSAVE ***  LE3000
0586 C**                                                                  LE3000
0587 C                     BITOF'01234567'ZBITS   1                       LE3000
0588 C   90                BITON'0'       ZBITS                           LE3000
0589 C   91                BITON'1'       ZBITS                           LE3000
0590 C   92                BITON'2'       ZBITS                           LE3000
0591 C   93                BITON'3'       ZBITS                           LE3000
0592 C   94                BITON'4'       ZBITS                           LE3000
0593 C   95                BITON'5'       ZBITS                           LE3000
0594 C   96                BITON'6'       ZBITS                           LE3000
0595 C   97                BITON'7'       ZBITS                           LE3000
0596 C**                                                                  LE3000
0597 C                     SETOF                     909192               LE3000
0598 C                     SETOF                     939495               LE3000
0599 C                     SETOF                     9697                 LE3000
0600 C**                                                                  LE3000
0601 C                     ENDSR                                          LE3000
0602 C**                                                                  LE3000
0603 C**                                                                  LE3000
0604 C********************************************************************LE3000
0605 C********************************************************************LE3000
0606 C**                                                                  LE3000
0607 C**   ZRSTOR SR. TO RESTORE INDICATORS 90 - 97 TO THE SETTINGS       LE3000
0608 C**              THEY HAD BEFORE THE EXECUTION OF SR. ZSAVE.         LE3000
0609 C**                                                                  LE3000
0610 C           ZRSTOR    BEGSR                           *** ZRSTOR *** LE3000
0611 C**                                                                  LE3000
0612 C                     TESTB'0'       ZBITS          90               LE3000
0613 C                     TESTB'1'       ZBITS          91               LE3000
0614 C                     TESTB'2'       ZBITS          92               LE3000
0615 C                     TESTB'3'       ZBITS          93               LE3000
0616 C                     TESTB'4'       ZBITS          94               LE3000
0617 C                     TESTB'5'       ZBITS          95               LE3000
0618 C                     TESTB'6'       ZBITS          96               LE3000
0619 C                     TESTB'7'       ZBITS          97               LE3000
0620 C**                                                                  LE3000
0621 C                     ENDSR                                          LE3000
0622 C**                                                                  LE3000
0623 C**                                                                  LE3000
0624 C********************************************************************LE3000
0625 C********************************************************************LE3000
0626 C* SUBROUTINE TO ADD AN AMOUNT (ZZAMT) TO THE TOTAL (ZZTOTI,ZZTOTD)  LE3000
0627 C*   IND '99' IS SET BY AN OVERFLOW ERROR                            LE3000
0628 C*                                                                   LE3000
0629 CSR         GLZADD    BEGSR                           *** GLZADD ****LE3000
0630 C*                                                                   LE3000
0631 CSR                   Z-ADDZZAMT     ZZAMT  153     91-DEFINE ZZAMT  LE3000
0632 CSR 91                GOTO ZZAEND                     AMT = 0.BYPASS LE3000
0633 C*                                                                   LE3000
0634 C* SPLIT ZZAMT INTO INTEGER AND DECIMAL FIELDS                       LE3000
0635 CSR                   Z-ADDZZAMT     ZZAMTI 150       INTEGER FIELD  LE3000
0636 CSR                   MOVE ZZAMT     ZZAMTD  30       DECIMAL FIELD  LE3000
0637 C* BOTH ZZAMTI AND ZZAMTD CONTAIN A 'SIGN' ZONE NOW                  LE3000
0638 C*                                                                   LE3000
0639 CSR                   EXSR GLZSUM                                    LE3000
0640 CSR         ZZAEND    ENDSR                           ** ZZAEND TAG *LE3000
0641 C*                                                                   LE3000
0642 C********************************************************************LE3000
0643 C********************************************************************LE3000
0644 C* SUBROUTINE TO CARRY OUT THE ADDITION FOR SUBROUTINES -            LE3000
0645 C*                        GLZADD, GLZSUB, GLZCMP.                    LE3000
0646 C*          PARAMETERS PASSED -                                      LE3000
0647 C*                     I/P ZZAMTI ZZAMTD                             LE3000
0648 C*                     O/P ZZTOTI ZZTOTD ZZNEGD IND 96 IND 99.       LE3000
0649 C*                                                                   LE3000
0650 CSR         GLZSUM    BEGSR                           *** GLZSUM ****LE3000
0651 C*                                                                   LE3000
0652 CSR                   Z-ADDZZTOTI    ZZTOTI 150       DEFINE ZZTOTI  LE3000
0653 CSR                   Z-ADDZZTOTD    ZZTOTD  30       DEFINE ZZTOTD  LE3000
0654 CSR                   SETOF                     919293               LE3000
0655 CSR                   SETOF                     949599               LE3000
0656 C*                                                                   LE3000
0657 C*    DETERMINE SIGN OF ZZAMTI & D,   92 IF NEG                      LE3000
0658 CSR         ZZAMTI    COMP 0                      9293               LE3000
0659 CSR 93      ZZAMTD    COMP 0                      9293               LE3000
0660 CSR 93                GOTO ZZSEND                     ZERO BYPASS    LE3000
0661 C*                                                                   LE3000
0662 C*    DETERMINE SIGN OF ZZTOTI & D, 91 IF NEG.                       LE3000
0663 CSR         ZZTOTI    COMP 0                      9193               LE3000
0664 CSR 93      ZZTOTD    COMP 0                      9193               LE3000
0665 C*                                                                   LE3000
0666 C*    IF ZZTOTAL IS ZERO, RETURN ZZAMOUNT.                           LE3000
0667 CSR 93                Z-ADDZZAMTI    ZZTOTI                          LE3000
0668 CSR 93                Z-ADDZZAMTD    ZZTOTD                          LE3000
0669 CSR 93                GOTO ZZSEND                     ZERO BYPASS    LE3000
0670 C*    IF SIGNS DIFFER BYPASS OVERFLOW CHECKS.                        LE3000
0671 CSR 91N92                                                            LE3000
0672 CORN91 92             GOTO ZZOFPS                                    LE3000
0673 C*                                                                   LE3000
0674 CSR         ZZAMTD    ADD  ZZTOTD    ZZWK2   40                      LE3000
0675 CSR         ZZWK2     COMP 999                  93    '93' = CARRY   LE3000
0676 CSRN93      ZZWK2     COMP -999                   93    INTO INTEGER.LE3000
0677 C*                                                                   LE3000
0678 CSR 93N92   ZZAMTI    ADD  1         ZZWK3  150       ADD 'CARRY' +VELE3000
0679 CSR    93 92ZZAMTI    SUB  1         ZZWK3            SUB 'CARRY' -VELE3000
0680 CSR 93      ZZTOTI    ADD  ZZWK3     ZZWK3                           LE3000
0681 CSRN93      ZZTOTI    ADD  ZZAMTI    ZZWK3                           LE3000
0682 C*                                                                   LE3000
0683 C* IF THE MODULUS OF ZZWK3 IS LT MOD. ZZTOTI THEN O/F HAS OCCURED    LE3000
0684 CSRN92      ZZWK3     COMP ZZTOTI                 99  -92 MEANS NOS. LE3000
0685 CSR 92      ZZWK3     COMP ZZTOTI               99     NEGATIVE      LE3000
0686 CSRN99                Z-ADDZZWK2     ZZTOTD                          LE3000
0687 CSRN99                Z-ADDZZWK3     ZZTOTI                          LE3000
0688 C*                                                                   LE3000
0689 C* IF O/F ZEROIZE ZZAMT , IND '99' SET AND ZZTOT FIELDS LEFT INTACT. LE3000
0690 CSR 99                Z-ADD0         ZZAMT  153                      LE3000
0691 CSR                   GOTO ZZSEND                                    LE3000
0692 C*                                                                   LE3000
0693 C* THE 'SIGNS' ARE DIFFERENT                                         LE3000
0694 CSR         ZZOFPS    TAG                             ** ZZOFPS TAG**LE3000
0695 C* IF ZZAMT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZTOT            LE3000
0696 C*                                                                   LE3000
0697 CSR 92                Z-SUBZZAMTI    ZZAMTI 150                      LE3000
0698 CSR 92                Z-SUBZZAMTD    ZZAMTD  30                      LE3000
0699 C*                                                                   LE3000
0700 C* IF ZZTOT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZAMT.           LE3000
0701 C*                                                                   LE3000
0702 CSR 91                Z-SUBZZTOTI    ZZTOTI                          LE3000
0703 CSR 91                Z-SUBZZTOTD    ZZTOTD                          LE3000
0704 C* BOTH ZZAMT AND ZZTOT ARE NOW POSITIVE.                            LE3000
0705 C*                                                                   LE3000
0706 CSR         ZZTOTI    COMP ZZAMTI               93  95               LE3000
0707 CSR 95      ZZTOTD    COMP ZZAMTD               93  95               LE3000
0708 C*                                                                   LE3000
0709 C* IF ZZTOT EQ. ZZAMT RETURN ZERO.                                   LE3000
0710 CSR 95                Z-ADD0         ZZTOTI                          LE3000
0711 CSR 95                Z-ADD0         ZZTOTD                          LE3000
0712 CSR 95                GOTO ZZSEND                                    LE3000
0713 C*                                                                   LE3000
0714 C* IF ZZTOT GT. ZZAMT.                                               LE3000
0715 CSR 93      ZZAMTD    COMP ZZTOTD               94                   LE3000
0716 CSR 93 94   ZZTOTI    SUB  1         ZZTOTI                          LE3000
0717 CSR 93 94   ZZTOTD    ADD  1000      ZZWK2                           LE3000
0718 CSR 93      ZZTOTI    SUB  ZZAMTI    ZZTOTI                          LE3000
0719 CSR 93 94   ZZWK2     SUB  ZZAMTD    ZZTOTD                          LE3000
0720 CSR 93N94   ZZTOTD    SUB  ZZAMTD    ZZTOTD                          LE3000
0721 C*                                                                   LE3000
0722 C*                                                                   LE3000
0723 C* IF ZZAMT GT. ZZTOT.                                               LE3000
0724 CSRN93      ZZTOTD    COMP ZZAMTD               94                   LE3000
0725 CSRN93 94   ZZAMTI    SUB  1         ZZWK3  150                      LE3000
0726 CSRN93 94   ZZAMTD    ADD  1000      ZZWK2                           LE3000
0727 CSRN93 94   ZZWK3     SUB  ZZTOTI    ZZTOTI                          LE3000
0728 CSRN93N94   ZZAMTI    SUB  ZZTOTI    ZZTOTI                          LE3000
0729 CSRN93 94   ZZWK2     SUB  ZZTOTD    ZZTOTD                          LE3000
0730 CSRN93N94   ZZAMTD    SUB  ZZTOTD    ZZTOTD                          LE3000
0731 C*                                                                   LE3000
0732 C* REVERSE SIGN OF ZZTOT IF LARGER I/P FIELDS WERE NEGATIVE          LE3000
0733 CSR                   SETOF                     94                   LE3000
0734 CSR 93 91                                                            LE3000
0735 CORN93 92             SETON                     94                   LE3000
0736 CSR 94                Z-SUBZZTOTI    ZZTOTI                          LE3000
0737 CSR 94                Z-SUBZZTOTD    ZZTOTD                          LE3000
0738 C**                                                                  LE3000
0739 C**   RESTORE SIGN OF ZZAMTI & ZZAMTD IF IT WAS REVERSED.            LE3000
0740 CSR 92                Z-SUBZZAMTI    ZZAMTI                          LE3000
0741 CSR 92                Z-SUBZZAMTD    ZZAMTD                          LE3000
0742 CSR         ZZSEND    TAG                             ** ZZSEND TAG *LE3000
0743 C**                                                                  LE3000
0744 C**   IF ZZTOTD IS ZERO, AND ZZTOTI IS NEG. SET UP ZZNEGD.           LE3000
0745 CSR                   SETOF                     96                   LE3000
0746 CSR         ZZTOTD    COMP 0                        91               LE3000
0747 CSR 91      ZZTOTI    COMP 0                      96                 LE3000
0748 CSR 96                MOVE '.000-'   ZZNEGD  5                       LE3000
0749 CSR                   ENDSR                             ** ENDSR **  LE3000
0750 C********************************************************************LE3000
0751 C********************************************************************LE3000
0752 C** ZDATE2 SR. TO CONVERT A DAY NUMBER TO DATE FORMATS.              LE3000
0753 C**            THE YEAR 2000, BEING DIVISIBLE BY 400, IS A LEAP YEAR.LE3000
0754 C**                                                                  LE3000
0755 CSR         ZDATE2    BEGSR                           *** ZDATE2 *** LE3000
0756 C**                                                                  LE3000
0757 C**   CLEAR DATE FIELDS.                                             LE3000
0758 C                     Z-ADD0         ZDATE   60                      LE3000
0759 C                     MOVEL'       ' ZADATE  7                       LE3000
0760 C**                                                                  LE3000
0761 C**   CALCULATION TO DEFINE INPUT DAY NUMBER.                        LE3000
0762 C                     Z-ADDZDAYNO    ZDAYNO  50                      LE3000
0763 C**                                                                  LE3000
0764 C** DETERMINE YEAR NUMBER.                                           LE3000
0765 C**                                                                  LE3000
0766 C**   ADJUST DAY NUMBER IN CASE LAST DAY OF YEAR.                    LE3000
0767 C           ZDAYNO    SUB  1         ZDAYN1  50   99                 LE3000
0768 C   99                GOTO ZDEND2                                    LE3000
0769 C**                                                                  LE3000
0770 C**   CALCULATE NUMBER OF 4 YEAR SPANS SINCE 31/12/1971.             LE3000
0771 C           ZDAYN1    DIV  1461      ZLYR    20                      LE3000
0772 C                     MVR            ZDAYN1           SAVE REMAINING LE3000
0773 C**                                                    DAYS.         LE3000
0774 C**   CALCULATE NUMBER OF REMAINING YEARS.                           LE3000
0775 C                     Z-ADD1         ZWRK2   20                      LE3000
0776 C           ZDTAG1    TAG                             ** ZDTAG1 TAG *LE3000
0777 C           ZDAYN1    COMP ZYDY,ZWRK2             90                 LE3000
0778 C  N90      ZWRK2     ADD  1         ZWRK2                           LE3000
0779 C  N90                GOTO ZDTAG1                                    LE3000
0780 C           ZWRK2     SUB  1         ZWRK2          91-LEAP YEAR     LE3000
0781 C**                                                                  LE3000
0782 C**   DECREMENT DAY NO. BY DAYS IN REMAINING YEARS.                  LE3000
0783 C  N91      ZDAYN1    SUB  ZYDY,ZWRK2ZDAYN1                          LE3000
0784 C**                                                                  LE3000
0785 C**   CALCULATE ACTUAL YEAR NUMBER.                                  LE3000
0786 C           ZLYR      MULT 4         ZWRK3   30                      LE3000
0787 C           ZWRK3     ADD  72        ZWRK3            BASE IS 1972   LE3000
0788 C                     Z-ADDZWRK3     ZYEAR   20                      LE3000
0789 C           ZYEAR     ADD  ZWRK2     ZYEAR            YEAR           LE3000
0790 C**                                                                  LE3000
0791 C** DETERMINE MONTH NUMBER.                                          LE3000
0792 C**                                                                  LE3000
0793 C**   ADJUST DAY NO. IN CASE LAST DAY OF LEAP YEAR FEBRUARY.         LE3000
0794 C                     SETOF                     9293                 LE3000
0795 C   91      ZDAYN1    COMP 59                     9293               LE3000
0796 C   91N92   ZDAYN1    SUB  1         ZDAYN1                          LE3000
0797 C**                                                                  LE3000
0798 C**   CALCULATE MONTH NUMBER.                                        LE3000
0799 C                     Z-ADD2         ZWRK2                           LE3000
0800 C           ZDTAG2    TAG                             ** ZDTAG2 TAG *LE3000
0801 C           ZDAYN1    COMP ZMDY,ZWRK2             94                 LE3000
0802 C  N94      ZWRK2     ADD  1         ZWRK2                           LE3000
0803 C  N94                GOTO ZDTAG2                                    LE3000
0804 C           ZWRK2     SUB  1         ZWRK2                           LE3000
0805 C                     Z-ADDZWRK2     ZMTH    20       MONTH          LE3000
0806 C**                                                                  LE3000
0807 C** DETERMINE DAY OF MONTH.                                          LE3000
0808 C**                                                                  LE3000
0809 C**   ADD BACK LAST DAY OF YEAR ADJUSTMENT.                          LE3000
0810 C           ZDAYN1    ADD  1         ZDAYN1                          LE3000
0811 C**                                                                  LE3000
0812 C**   CALCULATE DAY OF MONTH.                                        LE3000
0813 C           ZDAYN1    SUB  ZMDY,ZWRK2ZDAY    20       DAY            LE3000
0814 C**                                                                  LE3000
0815 C**   ADD BACK LEAP YEAR 29TH FEBUARY ADJUSTMENT, IF REQUIRED.       LE3000
0816 C   93      ZDAY      ADD  1         ZDAY                            LE3000
0817 C**                                                                  LE3000
0818 C**   FORMAT DATE, DDMMYY OR MMDDYY.                                 LE3000
0819 C  N98                MOVELZDAY      ZWRK4   40                      LE3000
0820 C   98                MOVE ZDAY      ZWRK4                           LE3000
0821 C  N98                MOVE ZMTH      ZWRK4                           LE3000
0822 C   98                MOVELZMTH      ZWRK4                           LE3000
0823 C                     MOVELZWRK4     ZDATE                           LE3000
0824 C                     MOVE ZYEAR     ZDATE                           LE3000
0825 C**                                                                  LE3000
0826 C**   FORMAT ALPHA DATE, DDMMMYY.                                    LE3000
0827 C           ZDAY      COMP 10                     95                 LE3000
0828 C                     MOVELZDAY      ZWRK5   5                       LE3000
0829 C   95                MOVEL' '       ZWRK5                           LE3000
0830 C                     MOVE ZMNM,ZMTH ZWRK5                           LE3000
0831 C                     MOVELZWRK5     ZADATE                          LE3000
0832 C                     MOVE ZYEAR     ZADATE                          LE3000
0833 C**                                                                  LE3000
0834 CSR         ZDEND2    ENDSR                           * ZDEND2 ENDSR*LE3000
0835 C*                                                                   LE3000
0836 C********************************************************************LE3000
0837 C********************************************************************LE3000
0838 C**                                                                  LE3000
0839 C**   ZSYSTM SR. TO CHAIN TO THE INSTALLATION CONTROL DATA RECORD.   LE3000
0840 C**                                                                  LE3000
0841 C           ZSYSTM    BEGSR                           *** ZSYSTM *** LE3000
      *                                                                   CLE005
      **  Access Switchable SAR details for existence of CLE005           CLE005
      *                                                                   CLE005
     C                     CALL 'AOSARDR0'                                CLE005
     C                     PARM *BLANK    @RTCD   7                       CLE005
     C                     PARM '*VERIFY' @OPTN   7                       CLE005
     C                     PARM 'CLE005'  @SARD   6                       CLE005
      *                                                                   CLE005
     C           @RTCD     IFEQ *BLANK                                    CLE005
     C                     MOVE 'Y'       CLE005  1                       CLE005
     C                     ELSE                                           CLE005
     C                     MOVE 'N'       CLE005                          CLE005
     C                     ENDIF                                          CLE005
      *                                                                                       CLE028
      ** Check if Flat Rate Personal Loans (Rule of 78s) is installed.                        CLE028
      *                                                                                       CLE028
     C                     CALL 'AOSARDR0'                                                    CLE028
     C                     PARM *BLANKS   @RTCD                                               CLE028
     C                     PARM '*VERIFY' @OPTN                                               CLE028
     C                     PARM 'CLE028'  @SARD                                               CLE028
      *                                                                                       CLE028
     C           @RTCD     IFEQ *BLANKS                                                       CLE028
     C                     MOVE 'Y'       CLE028  1                                           CLE028
     C                     ELSE                                                               CLE028
     C                     MOVE 'N'       CLE028                                              CLE028
     C                     ENDIF                                                              CLE028
     C/COPY WNCPYSRC,LEH01327
0842 C**                                                                  LE3000
0843 C**   SET UP KEY FOR INSTALLATION CONTROL RECORD.                    LE3000
0844 C                     MOVEL'01      'ZTABKY 12                       LE3000
0845 C                     MOVE '  10'    ZTABKY                          LE3000
0846 C**                                                                  LE3000
0847 C           ZTABKY    CHAINTABLE                99    ON NOT THERE   LE3000
0848 C  N99      RECI      COMP 'D'                  9999  ON, IS DELETED LE3000
0849 C**                                                                  LE3000
0850 C**   CHECK SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.                    LE3000
0851 C           DATF      COMP 'M'                      98MMDDYY, 98 ON  LE3000
0852 C**                                                                  LE3000
0853 C                     ENDSR                                          LE3000
0854 C**                                                                  LE3000
0855 C**                                                                  LE3000
      *****************************************************************                       CLE028
      /EJECT                                                                                  CLE028
      *****************************************************************                       CLE028
      *                                                               *                       CLE028
      *  SRIN78 - Deriving Outstanding Interest Amount for a given    *                       CLE028
      *           period using the Rule of 78s                        *                       CLE028
      *                                                               *                       CLE028
      *  Called By : Main Processing                                  *                       CLE028
      *                                                               *                       CLE028
      *  Calls     : RULE78                                           *                       CLE028
      *                                                               *                       CLE028
      *****************************************************************                       CLE028
      *                                                                                       CLE028
     C           SRIN78    BEGSR                                                              CLE028
      *                                                                                       CLE028
      ** Set up the appropriate input fields.                                                 CLE028
      *                                                                                       CLE028
     C                     Z-ADDVDAT      W78VDT                                              CLE028
     C                     Z-ADDMDAT      W78MDT                                              CLE028
     C                     Z-ADDFLTI      W78FLT                                              CLE028
     C                     MOVE RFRQ      W78RPF                                              CLE028
     C                     Z-ADDFRPD      W78FRD                                              CLE028
     C                     Z-ADDRDYN      W78RPM                                              CLE028
     C                     MOVE CCY       W78CCY                                              CLE028
     C                     MOVE *BLANKS   W78LCN                                              CLE028
     C                     Z-ADDZIBEG     W78BEG                                              CLE028
     C                     Z-ADDZIEND     W78END                                              CLE028
     C                     MOVE 'A'       W78ROA                                              CLE028
      *                                                                                       CLE028
     C                     EXSR RULE78                                                        CLE028
      *                                                                                       CLE028
     C                     Z-ADDW78INT    ZINTR                                               CLE028
      *                                                                                       CLE028
     C                     ENDSR                                                              CLE028
      *****************************************************************                       CLE028
      /EJECT                                                                                  CLE028
0856 C********************************************************************LE3000
      /EJECT                                                              066550
     C/COPY ZSRSRC,ZINTDYZ2                                               066550
      /EJECT                                                              066550
     C/COPY ZSRSRC,ZDATE9Z3                                               066550
     C/COPY ZSRSRC,ZDAT10Z2                                               126017
      /EJECT                                                              066550
     C/COPY ZSRSRC,GLINTCZ1                                               066550
      /EJECT                                                              066550
     C/COPY ZSRSRC,RULE78Z1                                                                   CLE028
     C/COPY ZSRSRC,ZFREQBZ2                                                                   CLE028
     C/COPY ZSRSRC,ZDATE1Z2                                                                   CLE028
     C/COPY ZSRSRC,ZACCH                                                                      CLE028
     C/COPY ZSRSRC,ZCHKH                                                                      CLE028
     C/COPY WNCPYSRC,LE3000C007
0857 O**                                                                  LE3000
0858 O**   LEACX - CUSTOMER LENDING INTEREST ACCRUALS EXTRACT             LE3000
0859 O**                                                                  LE3000
0860 OLEACXHH E        60                                                 LE3000
0861 O                                    1 'H'                           LE3000
0862 O                         TDAT       8P                              LE3000
0863 O**                                                                  LE3000
0864 OLEACXAC D        46                                                 LE3000
0865 O                                    1 'D'                           LE3000
0866 O                         BRCD       4                               LE3000
0867 O                         CCY        7                               LE3000
0868 O                         LTYP       9                               LE3000
0869 O                         SUTP      11                               LE3000
0870 O                         PTYP      13                               LE3000
0871 O                         CNUM      19                               LE3000
0872 O                      N39LNRF      25                               LE3000
0873 O                       39OLNO      25                               LE3000
0874 O                         SLID      28P                              LE3000
0875 O                         TODAT     31P                              LE3000
0876 O                         INTR      37P                              LE3000
0877 O                         CPAM      44P                              LE3000
0878 O                         AMAD      51P                              LE3000
0879 O                         AMTA      58P                              LE3000
0880 O                         WTAD      65P                              LE3000
0881 O                         WTTA      72P                              LE3000
0882 O                       39LNRF      78                               LE3000
     O                         CLAS     132                                                   CLE042
0883 O**                                                                  LE3000
0884 OLEACXZZ T        LR                                                 LE3000
0885 O                                    1 'T'                           LE3000
0886 O                         CNTOUT     4P                              LE3000
0887 O**                                                                  LE3000
0888 O**   CONTROL REPORT                                                 LE3000
0889 O**                                                                  LE3000
0890 OLE3000P1T   03   LR                                                 S01124
0891 O                                   22 'REFERENCE LE3000'            LE3000
0892 O                         TITL      89                               LE3000
0893 O                                  104 'DATE'                        LE3000
0894 O                         RUNA     112                               LE3000
0895 O                                  127 'PAGE    1'                   LE3000
0896 O        T   05   LR                                                 LE3000
0897 O                                   69 'INTEREST ACCRUALS EXTRAC'    LE3000
0898 O                                   86 'T - FILE CONTROLS'           LE3000
0899 O        T   06   LR                                                 LE3000
0900 O                                   69 '------------------------'    LE3000
0901 O                                   86 '-----------------'           LE3000
0902 O        T 32     LR U7                                              LE3000
0903 O                                   51 '*** REFERENCE LE3000'        LE3000
0904 O                                   71 'DATABASE ERROR AT'           LE3000
0905 O                         DBASE     74                               LE3000
0906 O        T        LR U7                                              LE3000
0907 O                                   37 'FILENAME'                    LE3000
0908 O                         DBFILE    43                               LE3000
0909 O                                   48 'KEY'                         LE3000
0910 O                         DBKEY     78                               LE3000
0911 O        T 3      LR                                                 LE3000
0912 O                                   28 'S/CLOAN - RUN CONTROLS'      LE3000
0913 O                                   59 'NUMBER'                      LE3000
0914 O                                   84 'VALUE'                       LE3000
0915 O        T 1      LR                                                 LE3000
0916 O                                   28 '----------------------'      LE3000
0917 O                                   59 'OF RECORDS'                  LE3000
0918 O                                   84 'OF RECORDS'                  LE3000
0919 O        T 2      LR                                                 LE3000
0920 O                                   29 'TOTAL RECORDS ON FILE'       LE3000
0921 O                      NU7NORE  3   59                               LE3000
0922 O                      NU7VLAF  4   81                               LE3000
0923 O                      NU7VLAL      84                               LE3000
0924 O        T 2      LR                                                 LE3000
0925 O                                   29 'TOTAL RECORDS ON FILE'       LE3000
0926 O                                   42 '- CALCULATED'                LE3000
0927 O                         CONTIN3   59                               LE3000
0928 O                         INWN  4   81                               LE3000
0929 O                         INDC      84                               LE3000
0930 O                    U8NU7         111 '***   DIFFERENCE   ***'      LE3000
0931 O        T 3      LR                                                 LE3000
0932 O                                   28 'S/LEACX - RUN CONTROLS'      LE3000
0933 O        T 1      LR                                                 LE3000
0934 O                                   28 '----------------------'      LE3000
0935 O        T 2      LR                                                 LE3000
0936 O                                   29 'TOTAL RECORDS ON FILE'       LE3000
0937 O                         CNTOUT3   59                               LE3000
0938 O        T 3      LR                                                 LE3000
0939 O                                   76 '*** END OF REPORT ***'       LE3000
**  ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**  ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**  ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
** @YD  USED BY SR. ZDATE9 - YEARS, IN DAYS, CUMULATIVE IN 4 YEAR SPAN
00366007310109601461
** @MD  USED BY SR. ZDATE9 - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
00000000310005900090001200015100181002120024300273003040033400365
**   ZFMD  -  NUMBER OF DAYS IN THE MONTH                                                     CLE028
312831303130313130313031                                                                      CLE028
