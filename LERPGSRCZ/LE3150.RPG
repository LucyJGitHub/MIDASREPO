     H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas LE Participant facilities by prime facility')    *
      *****************************************************************
      *                                                               *
      *  Midas - Customer Lending Module                              *
      *                                                               *
      *  LE3150 - Participant Facilities by Prime Facility Report     *
      *                                                               *
      *  Function:  This new program will be available in CoB.  It    *
      *  (COB)      will show all participant faclities linked to the *
      *             Prime Facilities.                                 *
      *                                                               *
      *  Called By: LEC3150 - Participant Facilities by Prime Control *
      *                                                               *
      *  (c) Finastra International Limited 2001                      *
      *                                                               *
      *  Last Amend No. CSD103             Date 10Aug20               *
      *  Prev Amend No. MD046248           Date 27Oct17               *
      *                 AR787620           Date 10Jun11               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *                 247097             Date 17Apr07               *
      *                 245408A            Date 22Mar07               *
      *                 CPK027             Date 17Apr07               *
      * Midas Plus 1.4 Base ------------------------------------------*
      *                 245408             Date 24Jan07               *
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CSD031             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 CLE042             Date 06Sep05               *
      *                 CLE106             Date 04Mar05               *
      *                 CSW037A            Date 02May05               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 CLE040             Date 05Jul04               *
      *                 CLE025             Date 20Oct03               *
      *                 CGL029             Date 01Sep03               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.05 -----------------------------------------------*
      *                 CSD006             Date 15May01               *
      * Midas DBA 3.04 -----------------------------------------------*
      *                 CRT004             DATE 04May00               *
      * Midas DBA 3.03 -----------------------------------------------*
      *                 176443             Date 18Apr00               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 121783             Date 20AUG97               *
      *                 CLE004 *Create     Date 02Dec96               *
      *                                                               *
      *---------------------------------------------------------------*
      *                                                               *
      *  CSD103 - LIBOR Deregulation - Common Layer/Standing Data     *
      *           (Recompile)                                         *
      *  MD046248 - Finastra Rebranding                               *
      *  AR787620 - Hooks Incorporation                               *
      *             WNCPYSRC,LEH00192                                 *
      *             WNCPYSRC,LEH00193                                 *
      *             WNCPYSRC,LEH00194                                 *
      *             WNCPYSRC,LEH00195                                 *
      *             WNCPYSRC,LEH00196                                 *
      *             WNCPYSRC,LEH00197                                 *
      *  247097  - Exclude Risk and Sub Participants in the Total     *
      *            Amount. Participation Facility Indicator is        *
      *            displayed beside the facility.                     *
      *  245408A - Amended to correct the value of primary facility   *
      *            amount.  Changed the column from 'CURRENT EXPOSURE'*
      *            to 'LOANS OUTSTANDING'                             *
      *  CPK027 - Errors in compiling MP1_3_TTTS - change #PMFC to 6A.*
      *  245408 - Amended to include totals for facility amount,      *
      *           current exposure, current available for all         *
      *           participants, and total for primary participants.   *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CLE042 - Extended Loan Sub Type (Recompile)                  *
      *  CLE106 - Syndication Manager                                 *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  CLE040 - Collateralised Lending Phase 2                      *
      *  CLE025 - Credit Lines (Recompile)                            *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  CSD006 - Use long DS with SDCURRPD.                          *
      *  CRT004 - Cashier Midas TCP/IP interface.                     *
      *             Recompiled over SDBRCHPD Changes                  *
      *  176443 - Avoid MCH3601 to be sent.                           *
      *           Pass correct parameter to AOCUSTR0.                 *
      *  121783 - Call new access object AOBRCHR1 instead of AOBRCHR0 *
      *           (uses the long data structure DSSDY)                *
      *  CLE004 - Customer Lending Enhancements - Syndication         *
      *                                                               *
      *****************************************************************
     FLE3150AUO   E                    PRINTER
     F                                              KINFDS SPOOLU
     F***LE3150P1O   E                    PRINTER                        UC                   245408
     FLE3150P1O   E             97     PRINTER                        UC                      245408
     F                                              KINFDS SPOOL1
     F***LEFCLTL5IF**E           K        DISK                                                CLE106
     FLEFCLTLNIF  E           K        DISK                                                   CLE106
     FLEFCLTLGIF  E           K        DISK                                                   CLE040
      ** Facilities Extension File                                                            CLE040
     FFCLTY   IF  E           K        DISK
     F            FCLTYHHF                          KIGNORE
     F**********  FCLTYFMF                          KIGNORE                                   245408
     F            FCLTYFMF                          KRENAMEFCLTYFM                            245408
     F            FCLTYZZF                          KIGNORE
     F            FCLTYFNF                          KRENAMEFCLTYFN
      *****************************************************************
      *                                                               *
      *  F U N C T I O N   O F   I N D I C A T O R S                  *
      *                                                               *
      *   37  - Multibranching ON                                     *
      *                                                               *
      *   88  - End of File (FCLTY)                                   *
      *                                                               *
      ****89**-*End*of*File*(LEFCLTL5)*********************************                       CLE106
      *   89  - End of File (LEFCLTLN)                                *                       CLE106
      *                                                               *
      *   98  - Date Format: DDMMYY (off); MMDDYY (on)                *
      * 90-99 - Used by Standard Subroutines                          *
      *                                                               *
      * U7+U8 - Database Error                                        *
      *                                                               *
      *****************************************************************
      /SPACE 3
      *****************************************************************
      *                                                               *
      *  S U B R O U T I N E   I N D E X                              *
      *                                                               *
      *  INIT   - Program Initialisation                              *
      *  PROCES - Detail Processing                                   *
      *  REPORT - Process Report Lines                                *
      *                                                               *
      *  WP1REC - Format and Write a Detail Record to the Report      *
      *  WP1END - Write End of Report                                 *
      *                                                               *
      *  AUDIT  - Produce Audit Report and End Program                *
      *  *PSSR  - Program Error Processing Subroutine                 *
      *  RCFP1  - RCF Processing for P1 Report                        *
      *  RCFAU  - RCF Processing for Audit Report                     *
      *                                                               *
      *  ZDATE1 - Validate Date and Convert into Midas Day Number     *
      *  ZDATE2 - Convert Midas Day Number into Date (DDMMYY/MMDDYY)  *
      *  ZDAYS  - Calculation Number of Days between Two Dates        *
      *  ZSEDIT - Edit an Amount                                      *
      *                                                               *
      *  PRTOT  - Checks report file line number                      *                      245408A
      *  PRTPRI - Prints details of the primary facility              *                      245408A
      *  CHKLIN - Checks report file line number                      *                      245408A
      *  SRFAMT - Retrieves facility amount from FCLTYFM              *                      245408A
      *  SRCAMD - Retrieves current exposure (outstanding loan)       *                      245408A
      *           from FCLTYFN                                        *                      245408A
      *  SRCUSN - Validates customer number                           *                      245408A
      *  SRCUSD - Validates other customer details                    *                      245408A
      *****************************************************************
     E/EJECT
     E                    CPY@    1   1 80
      *
      ** Array containing Copyright statement
      *
     E/COPY ZSRSRC,ZFRPEDZ1
      /SPACE 3
     ILDA       E DSLDA                         256
      *
      ** Local data area for database error details
      ** *LOCK IN LDA immediately before and OUT LDA immediately
      ** after each database error handling.
      **
      **                                    134 141 DBFILE
      **       Defines:                     142 170 DBKEY
      **                                    171 180 DBPGM
      **                                    181 1830DBASE
      *
     IRUNDAT    E DSRUNDAT
      *
      ** Data Area giving Installation Control Details
      *
     IPSDS       SDS
      *
      ** Program Status Data Structure
      *
     I                                     *PROGRAM PGM
     I                                      244 253 WSID
     I                                      254 263 USER
     ISPOOL1      DS
      ***  File Information Data Structure for MMNNNNPY.
     I                                       83  92 SFILE1
     I                                    B 123 1240SFNUM1
     I**********                          B 188 1890OFLLN1                                    245408
     I**********                          B 367 3680PRTLN1                                    245408
      *
     ISPOOLU      DS
      ***  File Information Data Structure for MMNNNNAU.
     I                                       83  92 SFILEU
     I                                    B 123 1240SFNUMU
      **                                                                                      CLE040
     I            DS                                                                          CLE040
     I                                        1  14 WKFCLT                                    CLE040
     I                                        1   3 BRCA                                      CLE040
     I                                        4   9 KCNUM                                     CLE040
     I                                       10  12 KFTYP                                     CLE040
     I                                       13  14 KFCNO                                     CLE040
      *
      ***  Dummy Data Structures used by Access Programs.
      *
     ISDBANK    E DSSDBANKPD
      ***  External data structures for Bank Details
      *
     ISDBRCH    E DSSDBRCHPD
      ***  External data structures for Branch Details
      *
     ISDCUST    E DSSDCUSTPD
     I              QQDFAC                          QQDFA1                                    CGL029
      ***  External data structures for Customer Details
      *
     ISDCURR    E DSSDCURRPD
      ***  External data structures for Currency Details
      *
     ISCSARD    E DSSCSARDPD                                                                  CLE040
      ***  External data structures for Switchable Features                                   CLE040
      *                                                                                       CLE040
     IDSFDY     E DSDSFDY
      ***  Short data structures for Access Objects
      *                                                                   121783
     IDSSDY     E DSDSSDY                                                 121783
      ** Long data structure for access objects                           121783
      *                                                                   121783
     I/COPY ZSRSRC,ZFRPEDZ2
      /SPACE 3
     C/TITLE Main Processing
      *================================================================
      *  P R O G R A M   S T A R T                                    *
      *================================================================
      *
      ***  Perform Initialisation.
      *
     C                     EXSR INIT
      *
      ***  Perform Detail Processing.
      *
     C                     EXSR PROCES
      *
      ***  Output Audit Report and End Program.
      *
     C                     EXSR AUDIT
      *
      *================================================================
      *  P R O G R A M   E N D                                        *
      *================================================================
     C/EJECT
      *****************************************************************
      *                                                               *
      *  INIT   - Subroutine to do Program Initialisation.            *
      *                                                               *
      *  Called By: Main Processing                                   *
      *  Calls:                                                       *
      *  RCFAU  - RCF Processing for Audit Report                     *
      *  AOBANKR0 Access Program                                      *
      *                                                               *
      *****************************************************************
      *
     C           INIT      BEGSR                           ***  INIT  ***
      *
      ** Set up copyright parameter
      *
     C                     MOVEACPY@      ACT@   80
      *
      ***  Receive Parameter List.
      *
     C           *ENTRY    PLIST
     C                     PARM           PSEQ    5
     C                     PARM           PENTY   3
      *
      ***  Initialise LDA field.
      *
     C           *NAMVAR   DEFN           LDA
     C           *LOCK     IN   LDA
     C                     MOVEL'LE3150'  DBPGM
     C                     OUT  LDA
      *
      ***  Call Access Program for Bank Details - Title, Run Date and
      ***  Run Day Number.
      *
     C                     CALL 'AOBANKR0'
     C                     PARM '*MSG   ' WRTCD   7
     C                     PARM '*FIRST ' WOPTN   7
     C           SDBANK    PARM SDBANK    DSFDY
      *
      ***  Handle Database Error.
      *
     C           WRTCD     IFNE *BLANKS
     C           *LOCK     IN   LDA
     C                     MOVE 'SDBANKPD'DBFILE           ***************
     C                     Z-ADD001       DBASE            * DB ERROR 01 *
     C                     OUT  LDA                        ***************
     C                     EXSR *PSSR
     C                     ENDIF
      *
      ***  Check System Date Format, DDMMYY (*IN98 off)
      ***                            MMDDYY (*IN98 on).
      *
     C           BJDFIN    IFEQ 'M'
     C                     SETON                     98
     C                     ENDIF
      *
      **   Access RUNDAT for multibranching indicator
      *
     C           *NAMVAR   DEFN           RUNDAT
     C                     IN   RUNDAT
      *
     C           AGMBIN    IFEQ 'Y'
     C                     SETON                     37
     C                     END
      *                                                                                       CLE040
      ** Check if Collateralised Lending is available                                         CLE040
      *                                                                                       CLE040
     C                     MOVE 'N'       CLE024  1                                           CLE040
     C                     MOVE *OFF      *IN39                                               CLE040
     C                     CALL 'AOSARDR0'                                                    CLE040
     C                     PARM *BLANKS   PRTCD   7                                           CLE040
     C                     PARM '*VERIFY' POPTN   7                                           CLE040
     C                     PARM 'CLE024'  PSARD   6                                           CLE040
     C           SCSARD    PARM SCSARD    DSFDY                                               CLE040
      *                                                                                       CLE040
      ** Handle Database Error.                                                               CLE040
      *                                                                                       CLE040
     C           PRTCD     IFNE *BLANKS                                                       CLE040
     C           PRTCD     ANDNE'*NRF   '                                                     CLE040
     C           *LOCK     IN   LDA                                                           CLE040
     C                     MOVE 'SCSARDPD'DBFILE                                              CLE040
     C                     MOVELPOPTN     DBKEY                                               CLE040
     C                     Z-ADD006       DBASE                                               CLE040
     C                     OUT  LDA                                                           CLE040
     C                     EXSR *PSSR                                                         CLE040
     C                     ENDIF                                                              CLE040
      *                                                                                       CLE040
     C           PRTCD     IFEQ *BLANKS                                                       CLE040
     C                     MOVE 'Y'       CLE024                                              CLE040
     C                     MOVE *ON       *IN39                                               CLE040
     C                     ENDIF                                                              CLE040
      *                                                                                       CLE040
      ** Check if Credit Lines is available                                                   CLE040
      *                                                                                       CLE040
     C                     MOVE *OFF      *IN40                                               CLE040
     C                     MOVE 'N'       CLE025  1                                           CLE040
     C                     CALL 'AOSARDR0'                                                    CLE040
     C                     PARM *BLANKS   PRTCD                                               CLE040
     C                     PARM '*VERIFY' POPTN                                               CLE040
     C                     PARM 'CLE025'  PSARD                                               CLE040
     C           SCSARD    PARM SCSARD    DSFDY                                               CLE040
      *                                                                                       CLE040
      ** Handle Database Error.                                                               CLE040
      *                                                                                       CLE040
     C           PRTCD     IFNE *BLANKS                                                       CLE040
     C           PRTCD     ANDNE'*NRF   '                                                     CLE040
     C           *LOCK     IN   LDA                                                           CLE040
     C                     MOVE 'SCSARDPD'DBFILE                                              CLE040
     C                     MOVELPOPTN     DBKEY                                               CLE040
     C                     Z-ADD007       DBASE                                               CLE040
     C                     OUT  LDA                                                           CLE040
     C                     EXSR *PSSR                                                         CLE040
     C                     ENDIF                                                              CLE040
      *                                                                                       CLE040
     C           PRTCD     IFEQ *BLANKS                                                       CLE040
     C                     MOVE 'Y'       CLE025                                              CLE040
     C                     MOVE *ON       *IN40                                               CLE040
     C                     ENDIF                                                              CLE040
     C/COPY WNCPYSRC,LEH00192
      *
      ***  RCF Processing for Audit File.
      *
     C                     EXSR RCFAU
      *
      ***  Report Work fields.
      *
     C**********           Z-ADD0         RQDLN1  30                                          245408
     C**********           Z-ADD0         DIFLN1  30                                          245408
      *                                                                                      245408A
      ** work variables used for fix 245408A                                                 245408A
      *                                                                                      245408A
     C**********           Z-ADD0         #PMFC   60                                  245408A CPK027
     C                     MOVE *BLANKS   #PMFC   6                                           CPK027
     C                     Z-ADD0         #PMFT   30                                         245408A
     C                     Z-ADD0         #PMFN   20                                         245408A
      *                                                                                      245408A
     C**********           Z-ADD0         #PMFCS  60                                  245408A CPK027
     C                     MOVE *BLANKS   #PMFCS  6                                           CPK027
     C                     Z-ADD0         #PMFTS  30                                         245408A
     C                     Z-ADD0         #PMFNS  20                                         245408A
     C**********           Z-ADD0         #CNUMS  60                                  245408A CPK028
     C                     MOVE *BLANKS   #CNUMS  6                                           CPK028
     C                     Z-ADD0         #FACTS  30                                         245408A
     C                     Z-ADD0         #FCNOS  20                                         245408A
     C                     MOVE *BLANKS   #FCCYS  3                                          245408A
      *
      ** Totals                                                                               245408
      *                                                                                       245408
     C                     Z-ADD0         #RFAMT 200                                          245408
     C                     Z-ADD0         #RCUEX 200                                          245408
     C                     Z-ADD0         #RCUAV 200                                          245408
      *                                                                                       245408
     C                     Z-ADD0         #FAMT  130                                         245408A
     C                     Z-ADD0         #CAMD  130                                         245408A
     C                     Z-ADD0         #CAVL  130                                         245408A
      *                                                                                      245408A
     C                     MOVE *OFF      #REPRT  1                                          245408A
     C                     MOVE *OFF      #TFLAG  1                                          245408A
      *                                                                                      245408A
      ** Key list for FCLTYFM                                                                245408A
      *                                                                                      245408A
     C           K@FTYM    KLIST                                                             245408A
     C                     KFLD           @KCUSM                                             245408A
     C                     KFLD           @KFCTM                                             245408A
     C                     KFLD           @KFCNM                                             245408A
     C                     KFLD           @KRTYM                                             245408A
      *                                                                                      245408A
     C                     MOVE 'A'       @KRTYM                                             245408A
      *                                                                                      245408A
      ** Key list for FCLTYFN                                                                245408A
      *                                                                                      245408A
     C           K@FTYN    KLIST                                                             245408A
     C                     KFLD           @KCUSN                                             245408A
     C                     KFLD           @KFCTN                                             245408A
     C                     KFLD           @KFCNN                                             245408A
     C                     KFLD           @KRTYN                                             245408A
      *                                                                                      245408A
     C                     MOVE 'B'       @KRTYN                                             245408A
      *                                                                                      245408A
     C           *LIKE     DEFN PMFC      @KCUSM                                             245408A
     C           *LIKE     DEFN PMFN      @KFCNM                                             245408A
     C           *LIKE     DEFN PMFT      @KFCTM                                             245408A
     C           *LIKE     DEFN RCTP      @KRTYM                                             245408A
      *                                                                                      245408A
     C           *LIKE     DEFN PMFC      @KCUSN                                             245408A
     C           *LIKE     DEFN PMFN      @KFCNN                                             245408A
     C           *LIKE     DEFN PMFT      @KFCTN                                             245408A
     C           *LIKE     DEFN RCTP      @KRTYN                                             245408A
      *                                                                                      245408A
     C                     ENDSR
      *
      *****************************************************************
      /TITLE SR/PROCES
      *****************************************************************
      *                                                               *
      *  PROCES - Subroutine to do the Detail Processing.             *
      *                                                               *
      *  Called By: Main Processing                                   *
      *  Calls:                                                       *
      *  REPORT - Process Report Lines                                *
      *  WP1END - Write End of Report                                 *
      *  PRTPRI - Prints details of the primary facility              *
      *  WP1REC - Format and Write a Detail Record to the Report      *
      *  PRTOT  - Checks report file line number                      *
      *                                                               *
      *****************************************************************
      *
     C           PROCES    BEGSR                           *** PROCES ***
      *
      ***  Check If Only a Single Branch is to be Reported
      *
     C           PENTY     IFNE 'ALL'
     C           PENTY     ANDNE'   '
     C********** PENTY     SETLLLEFCLTL5                                                      CLE106
     C           PENTY     SETLLLEFCLTLN                                                      CLE106
     C                     ENDIF
      *
      ***  Read first record from File.
      *
     C**********           READ LEFCLTL5                 89                                   CLE106
     C                     READ LEFCLTLN                 89                                   CLE106
      *                                                                                      245408A
     C           *IN89     IFEQ *OFF                                                         245408A
     C                     MOVE *ON       #REPRT                                             245408A
     C                     ENDIF                                                             245408A
      *
      ***  Do While not End of File
      *
     C           *IN89     DOWEQ*OFF
     C           RECI      ANDEQ'D'                                                           245408
     C           PENTY     ANDNE'ALL'
     C           PENTY     ANDNE'   '
     C           PENTY     ANDEQBRCA
     C           *IN89     OREQ *OFF
     C           PENTY     ANDEQ'ALL'
     C           *IN89     OREQ *OFF
     C           PENTY     ANDEQ'   '
      *                                                                                       245408
     C********** PMFC      IFNE *ZEROS                                                245408 245408A
     C********** PMFT      ANDNE*ZEROS                                                245408 245408A
     C********** PMFN      ANDNE*ZEROS                                                245408 245408A
      *
      ***  Process Report Lines.
      *
     C           #REPRT    IFEQ *ON                                                          245408A
     C                     EXSR REPORT
     C                     MOVE *OFF      #REPRT                                             245408A
     C                     MOVE *OFF      #TFLAG                                             245408A
     C                     ENDIF                                                             245408A
      *                                                                                      245408A
     C           PMFC      IFNE *ZEROS                                                       245408A
     C           PMFT      ANDNE*ZEROS                                                       245408A
     C           PMFN      ANDNE*ZEROS                                                       245408A
     C           PMFC      IFNE #PMFC                                                        245408A
     C           PMFT      ORNE #PMFT                                                        245408A
     C           PMFN      ORNE #PMFN                                                        245408A
     C                     MOVELPMFC      #PMFCS                                             245408A
     C                     MOVELPMFT      #PMFTS                                             245408A
     C                     MOVELPMFN      #PMFNS                                             245408A
     C                     MOVELCNUM      #CNUMS                                             245408A
     C                     MOVELFACT      #FACTS                                             245408A
     C                     MOVELFCNO      #FCNOS                                             245408A
     C                     MOVELFCCY      #FCCYS                                             245408A
     C                     EXSR PRTPRI                                                        245408
     C                     ENDIF                                                             245408A
     C**********           EXSR PRTPAR                                                245408 245408A
      *                                                                                       245408
     C                     EXSR WP1REC                                                        245408
     C                     ENDIF                                                              245408
      *
      ***  Count records read.
      *
     C**********           ADD  1         RCOUNT                                              245408
      *
      ***  Read next record.
      *
     C**********           READ LEFCLTL5                 89                                   CLE106
     C                     READ LEFCLTLN                 89                                   CLE106
      *                                                                                       245408
     C                     MOVELCNUM      #CNUMS                                             245408A
     C                     MOVELFACT      #FACTS                                             245408A
     C                     MOVELFCNO      #FCNOS                                             245408A
      *                                                                                      245408A
     C           PMFC      IFNE #PMFC                                                         245408
     C           PMFT      ORNE #PMFT                                                         245408
     C           PMFN      ORNE #PMFN                                                         245408
     C           *IN89     OREQ *ON                                                           245408
     C********** OPEN      IFEQ *ON                                                   245408 245408A
     C           #TFLAG    IFEQ *ON                                                          245408A
     C                     EXSR PRTOT                                                         245408
     C                     ENDIF                                                              245408
     C                     ENDIF                                                              245408
      *
      ***  End of Do Until End of Valid Records.
     C                     ENDDO
      *
      ***  Write End of Report.
      *
     C           OPEN      IFEQ *ON
     C                     EXSR WP1END
     C                     ENDIF
      *
     C                     ENDSR
      *
      *****************************************************************                       CLE040
      /TITLE SR/SRRTVX                                                                        CLE040
      *****************************************************************                       CLE040
      *                                                               *                       CLE040
      *  SRRTVX - Subroutine that Retrieves Fields in Facilities      *                       CLE040
      *           Extension File                                      *                       CLE040
      *                                                               *                       CLE040
      *****************************************************************                       CLE040
      *                                                                                       CLE040
     C           SRRTVX    BEGSR                                                              CLE040
      *                                                                                       CLE040
     C                     MOVE CNUM      KCNUM   6                                           CLE040
     C                     MOVE FACT      KFTYP   3                                           CLE040
     C                     MOVE FCNO      KFCNO   2                                           CLE040
      *                                                                                       CLE040
     C           KLFEXT    KLIST                                                              CLE040
     C                     KFLD           BRCA                                                CLE040
     C                     KFLD           KCNUM                                               CLE040
     C                     KFLD           KFTYP                                               CLE040
     C                     KFLD           KFCNO                                               CLE040
      *                                                                                       CLE040
     C           KLFEXT    CHAINLEFCLTLG             38                                       CLE040
     C           *IN38     IFEQ *ON                                                           CLE040
     C           *LOCK     IN   LDA                                                           CLE040
     C                     MOVE 'LEFCLTQD'DBFILE                                              CLE040
     C                     MOVE *BLANKS   DBKEY                                               CLE040
     C                     MOVE WKFCLT    DBKEY                                               CLE040
     C                     Z-ADD008       DBASE                                               CLE040
     C                     OUT  LDA                                                           CLE040
     C                     EXSR *PSSR                                                         CLE040
     C                     ENDIF                                                              CLE040
      *                                                                                       CLE040
     C                     ENDSR                                                              CLE040
      *****************************************************************
      /TITLE SR/REPORT
      *****************************************************************
      *                                                               *
      *  REPORT - Process Report Lines.                               *
      *                                                               *
      *  Called By: PROCES                                            *
      *  Calls:                                                       *
      *  WP1REC - Format and Write a Detail Record to the Report      *
      *  CHKLIN - Checks report file line number                      *
      *                                                               *
      *****************************************************************
      *
     C           REPORT    BEGSR                           *** REPORT ***
      *
      ***  Branch Level Break
      *
     C           BRCA      IFNE A8BRCD
      *
     C           OPEN      IFEQ *ON
      *
      ***  Check that sufficient lines remain for the Format. If not,
      ***  write out the Main Headings on a new page.
      *
     C                     EXSR CHKLIN                                                        245408
      *                                                                                       245408
     C**********           Z-ADD4         RQDLN1                                              245408
     C********** OFLLN1    SUB  PRTLN1    DIFLN1                                              245408
     C********** DIFLN1    IFLE RQDLN1                                                        245408
     C**********           WRITEHEADP1                                                        245408
     C**********           ENDIF                                                              245408
      *
     C                     WRITETRAILP1
     C                     CLOSELE3150P1
      *
     C                     ENDIF
      *
      ***  Open LE3150P1 and register in RCF
      *
     C                     OPEN LE3150P1
     C                     MOVE *ON       OPEN    1
     C                     EXSR RCFP1
      *
     C                     MOVELBRCA      A8BRCD
     C**********           Z-ADD*ZERO     #PMFC                                               CSD027
     C                     MOVE *BLANKS   #PMFC                                               CSD027
     C                     Z-ADD*ZERO     #PMFT
     C                     Z-ADD*ZERO     #PMFN
      *
      ***  Call Access Program for Branch Details.
      *
     C***********          CALL 'AOBRCHR0'                                121783
     C                     CALL 'AOBRCHR1'                                121783
     C                     PARM *BLANKS   PRTCD   7
     C                     PARM '*KEY   ' POPTN   7
     C                     PARM BRCA      PBRCD   3
     C           SDBRCH    PARM SDBRCH    DSSDY                           121783
     C***********SDBRCH    PARM SDBRCH    DSFDY                           121783
      *
      ***  Handle Database Error.
      *
     C           PRTCD     IFNE *BLANKS
     C           *LOCK     IN   LDA
     C                     MOVE 'SDBRCHPD'DBFILE           ***************
     C                     MOVELBRCA      DBKEY     P      * DB ERROR 02 *
     C                     Z-ADD002       DBASE            ***************
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     ENDIF
      *
      ***  Write out the Header
      *
     C                     WRITEHEADP1
      *
     C                     ENDIF
      *****************************************************************                       245408
      *****Prime*Facility*Level*Break**********************************                       245408
      *****************************************************************                       245408
     C********** PMFC      IFNE #PMFC                                                         245408
     C********** PMFT      ORNE #PMFT                                                         245408
     C********** PMFN      ORNE #PMFN                                                         245408
      *****************************************************************                       245408
      *****Call*Access*Program*for*Customer*Details.*******************                       245408
      *****************************************************************                       245408
     C**********           MOVELPMFC      PKEY1  10                                           245408
     C**********           CALL 'AOCUSTR0'                                                    245408
     C**********           PARM *BLANKS   PRTCD   7                                           245408
     C**********           PARM '*KEY   ' POPTN   7                                           245408
     C**********           PARM           PKEY1                                               245408
     C**********           PARM           PKYST   7                                           245408
     C***********SDCUST    PARM SDCUST    DSFDY                           176443
     C********** SDCUST    PARM SDCUST    DSSDY                                         76443 245408
      *****************************************************************                       245408
      *****Handle*Database*Error.**************************************                       245408
      *****************************************************************                       245408
     C********** PRTCD     IFNE *BLANKS                                                       245408
     C********** *LOCK     IN   LDA                                                           245408
     C**********           MOVE 'SDCUSTPD'DBFILE           ***************                    245408
     C**********           MOVELPMFC      DBKEY     P      * DB ERROR 03 *                    245408
     C**********           Z-ADD003       DBASE            ***************                    245408
     C**********           OUT  LDA                                                           245408
     C**********           EXSR *PSSR                                                         245408
     C**********           ENDIF                                                              245408
      *****************************************************************                       245408
     C**********           MOVELBBCRNM    RPCRN                                               245408
     C**********           MOVELPMFC      RPMFC                                               245408
     C**********           MOVELPMFC      #PMFC   60                                          245408
     C**********           MOVELPMFT      #PMFT   30                                          245408
     C**********           MOVELPMFN      #PMFN   20                                          245408
      *****************************************************************                       245408
      *****Format*Prime*Facility***************************************                       245408
      *****************************************************************                       245408
     C**********           MOVELPMFT      RPMFT                                               245408
     C**********           MOVE '/  '     RPMFT                                               245408
     C**********           MOVE PMFN      RPMFT                                               245408
      *****************************************************************                       245408
     C**********           ENDIF                                                              245408
      *****************************************************************                       245408
      *****Call*Access*Program*for*Customer*Details.*******************                       245408
      *****************************************************************                       245408
     C**********           MOVELCNUM      PKEY1  10                                           245408
     C**********           CALL 'AOCUSTR0'                                                    245408
     C**********           PARM *BLANKS   PRTCD   7                                           245408
     C**********           PARM '*KEY   ' POPTN   7                                           245408
     C**********           PARM           PKEY1                                               245408
     C**********           PARM           PKYST   7                                           245408
     C***********SDCUST    PARM SDCUST    DSFDY                           176443
     C********** SDCUST    PARM SDCUST    DSSDY                                        176443 245408
      *****************************************************************                       245408
      *****Handle*Database*Error.**************************************                       245408
      *****************************************************************                       245408
     C********** PRTCD     IFNE *BLANKS                                                       245408
     C********** *LOCK     IN   LDA                                                           245408
     C**********           MOVE 'SDCUSTPD'DBFILE           ***************                    245408
     C**********           MOVELCNUM      DBKEY     P      * DB ERROR 04 *                    245408
     C**********           Z-ADD004       DBASE            ***************                    245408
     C**********           OUT  LDA                                                           245408
     C**********           EXSR *PSSR                                                         245408
     C**********           ENDIF                                                              245408
      *****************************************************************                       245408
     C**********           MOVELBBCRNM    RCRNM                                               245408
      *****************************************************************                       245408
      *****Call*Access*Program*for*Currency*Details.*******************                       245408
      *****************************************************************                       245408
     C**********           CALL 'AOCURRR0'                                                    245408
     C**********           PARM *BLANKS   PRTCD   7                                           245408
     C**********           PARM '*KEY   ' POPTN   7                                           245408
     C**********           PARM FCCY      PK101   3                                           245408
     C********** SDCURR    PARM SDCURR    DSFDY                                 CSD006
     C********** SDCURR    PARM SDCURR    DSSDY                                        CSD006 245408
      *****************************************************************                       245408
      *****Handle*Database*Error.**************************************                       245408
      *****************************************************************                       245408
     C********** PRTCD     IFNE *BLANKS                                                       245408
     C********** *LOCK     IN   LDA                                                           245408
     C**********           MOVE 'SDCURRPD'DBFILE           ***************                    245408
     C**********           MOVELFCCY      DBKEY     P      * DB ERROR 05 *                    245408
     C**********           Z-ADD005       DBASE            ***************                    245408
     C**********           OUT  LDA                                                           245408
     C**********           EXSR *PSSR                                                         245408
     C**********           ENDIF                                                              245408
      *****************************************************************                       245408
      *****Chain*FCLTY*to*Get*Other*Details****************************                       245408
      *****************************************************************                       245408
     C********** FCLTYK    KLIST                                                              245408
     C**********           KFLD           CNUM                                                245408
     C**********           KFLD           FACT                                                245408
     C**********           KFLD           FCNO                                                245408
     C**********           KFLD           RCTP                                                245408
      *****************************************************************                       245408
     C**********           MOVEL'B'       RCTP                                                245408
     C********** FCLTYK    CHAINFCLTY                88                                       245408
      *****************************************************************                       245408
     C********** *IN88     IFEQ *OFF                                                          245408
     C**********           Z-ADDFAMT      #FAMT  130                                          245408
     C**********           Z-ADDCAMD      #CAMD  130                                          245408
     C********** FAMT      SUB  OAM2      #CAVL  130                                          245408
      *****************************************************************                CLE040 245408
      ***If*either*Credit*Lines*or*Collateralised*Lending*is*available,                CLE040 245408
      ***access*Facilities*Extension*file******************************                CLE040 245408
      *****************************************************************                CLE040 245408
     C********** CLE024    IFEQ 'Y'                                                    CLE040 245408
     C********** CLE025    OREQ 'Y'                                                    CLE040 245408
     C**********           EXSR SRRTVX                                                 CLE040 245408
     C**********           Z-ADDFCXCOF    #OFFS  130                                   CLE040 245408
     C**********           Z-ADDFCXCV1    #CCLV  150                                   CLE040 245408
     C**********           MOVE FCXALV    RCLTV                                        CLE040 245408
     C**********           ENDIF                                                       CLE040 245408
      **********                                                                       CLE040 245408
     C**********           ENDIF                                                              245408
      *****************************************************************                       245408
      *****Write*out*the*record.***************************************                       245408
      *****************************************************************                       245408
     C**********           EXSR WP1REC                                                        245408
      *****************************************************************                       245408
      *****Initialize*Report*Fields************************************                       245408
      *****************************************************************                       245408
     C**********           MOVE *BLANK    RPCRN                                               245408
     C**********           MOVE *BLANK    RPMFC                                               245408
     C**********           MOVE *BLANK    RPMFT                                               245408
     C**********           MOVE *BLANK    RCRNM                                               245408
     C**********           MOVE *BLANK    RCNUM                                               245408
     C**********           MOVE *BLANK    RFACT                                               245408
     C**********           MOVE *BLANK    RFCCY                                               245408
     C**********           MOVE *BLANK    RFAMT                                               245408
     C**********           MOVE *BLANK    RCAMD                                               245408
     C**********           MOVE *BLANK    RCAVL                                               245408
     C**********           MOVE *BLANK    ROFFS                                        CLE040 245408
     C**********           MOVE *BLANK    RCLTV                                        CLE040 245408
     C**********           MOVE *BLANK    RCCLV                                        CLE040 245408
      *
     C                     ENDSR
      *
      *****************************************************************
      /TITLE SR/WP1REC
      *****************************************************************
      *                                                               *
      *  WP1REC - Subroutine to Write a Detail record to the Report.  *
      *                                                               *
      *  Called By: PROCES                                            *
      *  Calls:                                                       *
      *  SRCUSN - Validates customer number                           *
      *  SRCUSD - Validates other customer details                    *
      *  SRFAMT - Retrieves facility amount from FCLTYFM              *
      *  ZFRPED - Edits amount                                        *
      *  SRCAMD - Retrieves current exposure (outstanding loan)       *
      *           from FCLTYFN                                        *
      *  SRRTVX - Subroutine that Retrieves Fields in Facilities      *
      *           Extension File                                      *
      *  CHKLIN - Checks report file line number                      *
      *                                                               *
      *****************************************************************
      *
     C           WP1REC    BEGSR                           *** WP1REC ***
      *                                                                                      245408A
      ** Call Access Program for Customer Details.                                           245408A
      *                                                                                      245408A
     C                     MOVEL#CNUMS    PKEY1  10                                          245408A
     C                     EXSR SRCUSN                                                       245408A
      *                                                                                      245408A
      ** Participant Customer Name                                                           245408A
      *                                                                                      245408A
     C                     MOVELBBCRNM    R2CRNM                                             245408A
      *                                                                                      245408A
     C                     MOVE #FCCYS    #FCCY   3                                          245408A
     C                     MOVE #FCCY     PK101   3                                          245408A
     C                     EXSR SRCUSD                                                       245408A
      *
      ***  Move File Fields to Report Fields
      *
     C**********           MOVELCNUM      RCNUM                                               245408
     C**********           MOVELCNUM      R2CNUM                                      245408 245408A
     C                     MOVEL#CNUMS    R2CNUM                                             245408A
     C**********           MOVELFCCY      RFCCY                                               245408
     C                     MOVELFCCY      R2FCCY                                              245408
      *
      ***  Format Participant Facility
      *
     C**********           MOVELFACT      RFACT                                               245408
     C**********           MOVE '/  '     RFACT                                               245408
     C**********           MOVE FCNO      RFACT                                               245408
     C**********           MOVELFACT      R2FACT                                      245408 245408A
     C                     MOVEL#FACTS    R2FACT                                              245408
     C                     MOVE '/  '     R2FACT                                              245408
     C**********           MOVE FCNO      R2FACT                                      245408 245408A
     C                     MOVE #FCNOS    R2FACT                                              245408
      *
      ***  Format Amounts
      *
     C                     Z-ADDA6NBDP    ZDECS
      *
      ** Participant facility amount                                                         245408A
      *                                                                                      245408A
      ** populate key list for FCLTYFM                                                       245408A
      *                                                                                      245408A
     C                     MOVEL#CNUMS    @KCUSM                                             245408A
     C                     MOVEL#FACTS    @KFCTM                                             245408A
     C                     MOVEL#FCNOS    @KFCNM                                             245408A
      *                                                                                      245408A
     C                     EXSR SRFAMT                                                       245408A
      *                                                                                      245408A
     C                     Z-ADD#FAMT     ZFLD15
     C                     EXSR ZFRPED
     C                     MOVELZOUT25    #OUT23 23
     C**********           MOVE #OUT23    RFAMT                                               245408
     C                     MOVE #OUT23    R2FAMT                                              245408
     C           #PRTR     IFNE 'R'                                                           247097
     C           #PRTR     ANDNE'S'                                                           247097
     C                     ADD  #FAMT     #RFAMT                                              245408
     C                     ENDIF                                                              247097
      *                                                                                      245408A
      ** Participant current exposure (outstanding loan)                                     245408A
      *                                                                                      245408A
      ** populate key list for FCLTYFN                                                       245408A
      *                                                                                      245408A
     C                     MOVEL#CNUMS    @KCUSN                                             245408A
     C                     MOVEL#FACTS    @KFCTN                                             245408A
     C                     MOVEL#FCNOS    @KFCNN                                             245408A
      *                                                                                      245408A
     C                     EXSR SRCAMD                                                       245408A
     C/COPY WNCPYSRC,LEH00193
      *
     C                     Z-ADD#CAMD     ZFLD15
     C                     EXSR ZFRPED
     C                     MOVELZOUT25    #OUT23 23
     C**********           MOVE #OUT23    RCAMD                                               245408
     C                     MOVE #OUT23    R2CAMD                                              245408
     C           #PRTR     IFNE 'R'                                                           247097
     C           #PRTR     ANDNE'S'                                                           247097
     C                     ADD  #CAMD     #RCUEX                                              245408
     C                     ENDIF                                                              247097
      *                                                                                      245408A
      ** Participant current available                                                       245408A
      *                                                                                      245408A
      ** If either Credit Lines or Collateralised Lending is available,                      245408A
      ** access Facilities Extension file                                                    245408A
      *                                                                                      245408A
     C           CLE024    IFEQ 'Y'                                                          245408A
     C           CLE025    OREQ 'Y'                                                          245408A
     C                     EXSR SRRTVX                                                       245408A
     C                     Z-ADDFCXCOF    #OFFS  130                                         245408A
     C                     Z-ADDFCXCV1    #CCLV  150                                         245408A
     C                     MOVE FCXALV    RCLTV                                              245408A
     C                     ENDIF                                                             245408A
      *
     C           #FAMT     SUB  #CAMD     #CAVL  130                                         245408A
     C                     Z-ADD#CAVL     ZFLD15
     C                     EXSR ZFRPED
     C                     MOVELZOUT25    #OUT23 23
     C**********           MOVE #OUT23    RCAVL                                               245408
     C                     MOVE #OUT23    R2CAVL                                              245408
     C           #PRTR     IFNE 'R'                                                           247097
     C           #PRTR     ANDNE'S'                                                           247097
     C                     ADD  #CAVL     #RCUAV                                              245408
     C                     ENDIF                                                              247097
      *                                                                                       CLE040
     C           CLE025    IFEQ 'Y'                                                           CLE040
     C                     Z-ADD#OFFS     ZFLD15                                              CLE040
     C                     EXSR ZFRPED                                                        CLE040
     C                     MOVELZOUT25    #OUT23 23                                           CLE040
     C                     MOVE #OUT23    ROFFS                                               CLE040
     C                     ENDIF                                                              CLE040
      *                                                                                       CLE040
     C           CLE024    IFEQ 'Y'                                                           CLE040
     C                     Z-ADD#CCLV     ZFLD15                                              CLE040
     C                     EXSR ZFRPED                                                        CLE040
     C                     MOVELZOUT25    #OUT25 25                                           CLE040
     C                     MOVE #OUT25    RCCLV                                               CLE040
     C                     ENDIF                                                              CLE040
      *
      ***  Check that sufficient lines remain for the Format. If not,
      ***  write out the Main Headings on a new page.
      *
     C                     EXSR CHKLIN                                                        245408
      *                                                                                       245408
     C**********           Z-ADD1         RQDLN1                                              245408
     C********** OFLLN1    SUB  PRTLN1    DIFLN1                                              245408
     C********** DIFLN1    IFLE RQDLN1                                                        245408
     C**********           WRITEHEADP1                                                        245408
     C**********           ENDIF                                                              245408
      *
      ***  Write out Detail Record.
      *
     C**********           WRITEDETAIL                                                        245408
     C                     WRITEPARDET                                                        245408
     C                     ADD  1         RCOUNT                                              245408
      *                                                                                      245408A
      ** Reset Participant Customer Details                                                  245408A
      *                                                                                      245408A
     C                     MOVE *BLANK    R2CRNM                                             245408A
     C                     MOVE *BLANK    R2CNUM                                             245408A
     C                     MOVE *BLANK    R2FACT                                             245408A
     C                     MOVE *BLANK    R2FCCY                                             245408A
     C                     MOVE *BLANK    R2FAMT                                             245408A
     C                     MOVE *BLANK    R2CAMD                                             245408A
     C                     MOVE *BLANK    R2CAVL                                             245408A
      *                                                                                      245408A
     C                     MOVE *BLANK    ROFFS                                              245408A
     C                     MOVE *BLANK    RCLTV                                              245408A
     C                     MOVE *BLANK    RCCLV                                              245408A
     C/COPY WNCPYSRC,LEH00194
      *                                                                                      245408A
     C                     MOVE *ON       #TFLAG                                             245408A
      *
     C                     ENDSR
      *
      *****************************************************************
      /TITLE SR/WP1END
      *****************************************************************
      *                                                               *
      *  WP1END - Subroutine to Write End of Report.                  *
      *                                                               *
      *  Called By: PROCES                                            *
      *  Calls    : None                                              *
      *                                                               *
      *****************************************************************
      *
     C           WP1END    BEGSR                           *** WP1END ***
      *
      ***  Check that sufficient lines remain for the Format. If not,
      ***  write out the Main Headings on a new page.
      *
     C                     EXSR CHKLIN                                                        245408
      *                                                                                       245408
     C**********           Z-ADD4         RQDLN1                                              245408
     C********** OFLLN1    SUB  PRTLN1    DIFLN1                                              245408
     C********** DIFLN1    IFLE RQDLN1                                                        245408
     C**********           WRITEHEADP1                                                        245408
     C**********           ENDIF                                                              245408
      *
      ***  Write out Total Format.
      *
     C                     WRITETRAILP1
      *
     C                     ENDSR
      *
      *****************************************************************
      /TITLE SR/AUDIT
      *****************************************************************
      *                                                               *
      *  AUDIT  - Subroutine to Output Audit report and End Program.  *
      *                                                               *
      *  Called By: Main Processing, PROCES, *PSSR                    *
      *  Calls: None.                                                 *
      *                                                               *
      *****************************************************************
      *
     C           AUDIT     BEGSR                           *** AUDIT  ***
      *
      ***  Output Report Header and File Controls.
      *
     C                     WRITEHEADAU
     C                     WRITECONTROL
      *
      ***  If there is a DB Error, Output the DB Error Information.
      *
     C           *INU7     IFEQ *ON
     C                     WRITEDBERROR
     C                     ELSE
      *
      ***  Or, if no records read, Output "No Details" message.
      *
     C           RCOUNT    IFEQ 0
     C                     WRITENODTLS
     C                     ENDIF
     C                     ENDIF
      *
      ***  End Program and Return.
      *
     C                     SETON                     LR
     C                     RETRN
      *
     C                     ENDSR
      *
      *****************************************************************
      /TITLE SR/*PSSR
      *****************************************************************
      *                                                               *
      *  *PSSR  - Error control subroutine                            *
      *                                                               *
      *****************************************************************
      *
     C           *PSSR     BEGSR                           ** *PSSR **
      *
      ***  Check to see that *PSSR has not already been called.
      *
     C           WRUN      IFEQ *BLANK
     C                     MOVE 'Y'       WRUN    1
      *
     C                     SETON                     U7U8LR
     C                     DUMP
     C                     EXSR AUDIT
     C                     ENDIF
      *
      ***  If *PSSR already run, then just end the program here.
      *
     C                     SETON                     U7U8LR
     C                     RETRN
      *
     C                     ENDSR
      *
      *****************************************************************
      /TITLE SR/RCFP1
      *****************************************************************
      *                                                               *
      *  RCFP1  - Subroutine to register the P1 Printer File via RCF. *
      *                                                               *
      *****************************************************************
      *
     C           RCFP1     BEGSR                            *** RCFP1  ***
      *
      ***  Ensure Report Spool File recorded by RCF.
      *
     C                     Z-ADDSFNUM1    ZSNUM   60
      *
     C                     CALL 'ZSFILE'
     C                     PARM PSEQ      SEQ     5
     C                     PARM           SENTY   3
     C                     PARM           SFILE1
     C                     PARM           ZSNUM
     C                     PARM           ZSERR   1
      *
      ***  If Error occurs during ZSFILE processing, then return to the
      ***  Calling Program.
      *
     C           ZSERR     IFEQ 'Y'
     C                     SETON                     U7U8LR
     C                     RETRN
     C                     ENDIF
      *
     C                     ENDSR
      *
      *****************************************************************
      /TITLE SR/RCFAU
      *****************************************************************
      *                                                               *
      *  RCFAU  - Subroutine to register the AU Printer File via RCF. *
      *                                                               *
      *****************************************************************
      *
     C           RCFAU     BEGSR                            *** RCFAU  ***
      *
      ***  Ensure Audit Spool File recorded by RCF.
      *
     C                     Z-ADDSFNUMU    ZSNUMU  60
      *
     C                     CALL 'ZSFILE'
     C                     PARM PSEQ      SEQ
     C                     PARM *BLANKS   SENTY
     C                     PARM           SFILEU
     C                     PARM           ZSNUMU
     C                     PARM *BLANK    ZSERR
      *
      ***  If Error occurs during ZSFILE processing, then return to the
      ***  Calling Program.
      *
     C           ZSERR     IFEQ 'Y'
     C                     SETON                     U7U8LR
     C                     RETRN
     C                     ENDIF
      *
     C                     ENDSR
      *
      *****************************************************************
      /TITLE SR/PRTOT                                                                         245408
      *****************************************************************                       245408
      *                                                               *                       245408
      *  PRTOT   - Checks report file line number                     *                       245408
      *                                                               *                       245408
      *  Called By:                                                   *                       245408
      *  PROCES - Detail Processing                                   *                       245408
      *                                                               *                       245408
      *  Calls    :                                                   *                       245408
      *  ZFRPED - Edits amount                                        *                       245408
      *  CHKLIN - Checks report file line number                      *                       245408
      *                                                               *                       245408
      *****************************************************************                       245408
      *                                                                                       245408
      *                                                                                       245408
     C           PRTOT     BEGSR                                                              245408
      *                                                                                       245408
      ** Format Amounts                                                                       245408
      *                                                                                       245408
     C                     Z-ADDA6NBDP    ZDECS                                               245408
      *                                                                                       245408
      ** Participant Facility Amount                                                          245408
      *                                                                                       245408
     C                     Z-ADD#RFAMT    ZFLD15                                              245408
     C                     EXSR ZFRPED                                                        245408
     C                     MOVELZOUT25    #OUT23 23                                           245408
     C                     MOVE #OUT23    RTFAMT                                              245408
      *                                                                                       245408
      ** Participant Current Exposure (Loans Outstanding)                                     245408
      *                                                                                       245408
     C                     Z-ADD#RCUEX    ZFLD15                                              245408
     C                     EXSR ZFRPED                                                        245408
     C                     MOVELZOUT25    #OUT23 23                                           245408
     C                     MOVE #OUT23    RTCUEX                                              245408
      *                                                                                       245408
      ** Participant Current Available                                                        245408
      *                                                                                       245408
     C                     Z-ADD#RCUAV    ZFLD15                                              245408
     C                     EXSR ZFRPED                                                        245408
     C                     MOVELZOUT25    #OUT23 23                                           245408
     C                     MOVE #OUT23    RTCUAV                                              245408
      *                                                                                       245408
     C                     EXSR CHKLIN                                                        245408
     C                     WRITETOTALD                                                        245408
     C                     EXSR CHKLIN                                                        245408
     C                     WRITETOTALS                                                        245408
      *                                                                                       245408
      ** Totals                                                                               245408
      *                                                                                       245408
     C                     Z-ADD0         #RFAMT 200                                          245408
     C                     Z-ADD0         #RCUEX 200                                          245408
     C                     Z-ADD0         #RCUAV 200                                          245408
      *                                                                                       245408
     C                     ENDSR                                                              245408
      *                                                                                       245408
      *****************************************************************                       245408
      /EJECT                                                                                  245408
      *****************************************************************                       245408
      /TITLE SR/PRTPRI                                                                        245408
      *****************************************************************                       245408
      *                                                               *                       245408
      *  PRTPRI - Prints details of the primary facility              *                       245408
      *                                                               *                       245408
      *  Called By:                                                   *                       245408
      *  PROCES - Detail Processing                                   *                       245408
      *                                                               *                       245408
      *  Calls    :                                                   *                       245408
      *  SRCUSN - Validates customer number                           *                       245408
      *  SRCUSD - Validates other customer details                    *                       245408
      *  SRFAMT - Retrieves facility amount from FCLTYFM              *                       245408
      *  SRCAMD - Retrieves current exposure (outstanding loan)       *                       245408
      *           from FCLTYFN                                        *                       245408
      *  ZFRPED - Edits amount                                        *                       245408
      *                                                               *                       245408
      *****************************************************************                       245408
      *                                                                                       245408
     C           PRTPRI    BEGSR                                                              245408
      *                                                                                      245408A
     C********** PMFC      IFNE #PMFC                                                 245408 245408A
     C********** PMFT      ORNE #PMFT                                                 245408 245408A
     C********** PMFN      ORNE #PMFN                                                 245408 245408A
      *                                                                                       245408
     C**********           MOVELPMFC      #PMFC   60                                  245408A CPK027
     C                     MOVELPMFC      #PMFC   6                                           CPK027
     C                     MOVELPMFT      #PMFT   30                                         245408A
     C                     MOVELPMFN      #PMFN   20                                         245408A
      *                                                                                       245408
      ** Call Access Program for Customer Details.                                            245408
      *                                                                                       245408
     C                     MOVELPMFC      PKEY1  10                                           245408
     C                     EXSR SRCUSN                                                       245408A
     C**********           CALL 'AOCUSTR0'                                            245408 245408A
     C**********           PARM *BLANKS   PRTCD   7                                   245408 245408A
     C**********           PARM '*KEY   ' POPTN   7                                   245408 245408A
     C**********           PARM           PKEY1                                       245408 245408A
     C**********           PARM           PKYST   7                                   245408 245408A
     C********** SDCUST    PARM SDCUST    DSSDY                                       245408 245408A
      *****************************************************************               245408 245408A
      ***Handle*Database*Error.****************************************               245408 245408A
      *****************************************************************               245408 245408A
     C********** PRTCD     IFNE *BLANKS                                               245408 245408A
     C********** *LOCK     IN   LDA                                                   245408 245408A
     C**********           MOVE 'SDCUSTPD'DBFILE                                      245408 245408A
     C**********           MOVELPMFC      DBKEY     P                                 245408 245408A
     C**********           Z-ADD003       DBASE                                       245408 245408A
     C**********           OUT  LDA                                                   245408 245408A
     C**********           EXSR *PSSR                                                 245408 245408A
     C**********           ENDIF                                                      245408 245408A
      *                                                                                       245408
      ** Primary Customer Name                                                                245408
      *                                                                                       245408
     C                     MOVELBBCRNM    R1PCRN                                              245408
      *                                                                                      245408A
     C                     MOVE FCCY      #FCCY   3                                          245408A
     C                     MOVE #FCCY     PK101   3                                          245408A
     C                     EXSR SRCUSD                                                       245408A
      *****************************************************************               245408 245408A
      ***Call*Access*Program*for*Currency*Details.*********************               245408 245408A
      *****************************************************************               245408 245408A
     C**********           CALL 'AOCURRR0'                                            245408 245408A
     C**********           PARM *BLANKS   PRTCD   7                                   245408 245408A
     C**********           PARM '*KEY   ' POPTN   7                                   245408 245408A
     C**********           PARM FCCY      PK101   3                                   245408 245408A
     C********** SDCURR    PARM SDCURR    DSSDY                                       245408 245408A
      ****************************************************************                245408 245408A
      ***Handle*Database*Error.***************************************                245408 245408A
      ****************************************************************                245408 245408A
     C********** PRTCD     IFNE *BLANKS                                               245408 245408A
     C********** *LOCK     IN   LDA                                                   245408 245408A
     C**********           MOVE 'SDCURRPD'DBFILE                                      245408 245408A
     C**********           MOVELFCCY      DBKEY     P                                 245408 245408A
     C**********           Z-ADD005       DBASE                                       245408 245408A
     C**********           OUT  LDA                                                   245408 245408A
     C**********           EXSR *PSSR                                                 245408 245408A
     C**********           ENDIF                                                      245408 245408A
      *                                                                                       245408
      ** Primary Customer Number                                                              245408
      *                                                                                       245408
     C                     MOVELPMFC      R1PMFC                                              245408
     C**********           MOVELPMFC      #PMFC   60                                  245408 245408A
     C**********           MOVELPMFT      #PMFT   30                                  245408 245408A
     C**********           MOVELPMFN      #PMFN   20                                  245408 245408A
      *                                                                                       245408
      ** Format Prime Facility                                                                245408
      *                                                                                       245408
     C                     MOVELPMFT      R1PMFT                                              245408
     C                     MOVE '/  '     R1PMFT                                              245408
     C                     MOVE PMFN      R1PMFT                                              245408
      ****************************************************************                245408 245408A
      ****************************************************************                245408 245408A
      ***Get*amounts*for*Primary*Customer,*and*format*****************                245408 245408A
      ****************************************************************                245408 245408A
     C**********           MOVEL'A'       RCTP                                        245408 245408A
     C********** FCLTYK    CHAINFCLTYFM              99                               245408 245408A
     C********** *IN99     IFEQ *OFF                                                  245408 245408A
      *                                                                                       245408
      ** Primary Currency                                                                     245408
      *                                                                                       245408
     C                     MOVELFCCY      R1FCCY                                              245408
      *                                                                                      245408A
     C                     MOVELFCCY      #CCY    3                                          245408A
     C                     MOVEL#CCY      PK101   3                                          245408A
      *                                                                                       245408
      ** Get amounts for Primary Customer, and format                                         245408
      *                                                                                       245408
      ** Primary facility amount                                                              245408
      *                                                                                       245408
     C                     Z-ADDA6NBDP    ZDECS                                               245408
      *                                                                                      245408A
      ** populate key list for FCLTYFM                                                       245408A
      *                                                                                      245408A
     C                     MOVEL#PMFCS    @KCUSM                                             245408A
     C                     MOVEL#PMFTS    @KFCTM                                             245408A
     C                     MOVEL#PMFNS    @KFCNM                                             245408A
      *                                                                                      245408A
     C                     EXSR SRFAMT                                                       245408A
      *                                                                                      245408A
     C**********           Z-ADDFAMT      ZFLD15                                      245408 245408A
     C                     Z-ADD#FAMT     ZFLD15                                             245408A
     C                     EXSR ZFRPED                                                        245408
     C                     MOVELZOUT25    #OUT23 23                                           245408
     C                     MOVE #OUT23    R1FAMT                                              245408
      *                                                                                       245408
      ** Primary current exposure                                                             245408
      ** (or Loans Outstanding)                                                              245408A
      *                                                                                       245408
      ** populate key list for FCLTYFN                                                       245408A
      *                                                                                      245408A
     C                     MOVEL#PMFCS    @KCUSN                                             245408A
     C                     MOVEL#PMFTS    @KFCTN                                             245408A
     C                     MOVEL#PMFNS    @KFCNN                                             245408A
      *                                                                                      245408A
     C                     EXSR SRCAMD                                                       245408A
     C/COPY WNCPYSRC,LEH00195
      *                                                                                      245408A
     C**********           Z-ADDCAMD      ZFLD15                                      245408 245408A
     C                     Z-ADD#CAMD     ZFLD15                                              245408
     C                     EXSR ZFRPED                                                        245408
     C                     MOVELZOUT25    #OUT23 23                                           245408
     C                     MOVE #OUT23    R1CAMD                                              245408
      *                                                                                       245408
      ** Primary current available                                                            245408
      *                                                                                       245408
     C********** FAMT      SUB  CAMD      ##CAVL 130                                  245408 245408A
     C           #FAMT     SUB  #CAMD     ##CAVL 130                                          245408
     C                     Z-ADD##CAVL    ZFLD15                                              245408
     C                     EXSR ZFRPED                                                        245408
     C                     MOVELZOUT25    #OUT23 23                                           245408
     C                     MOVE #OUT23    R1CAVL                                              245408
      *                                                                                       245408
     C                     WRITEPRIDET                                                        245408
      *                                                                                       245408
     C**********           ENDIF                                                      245408 245408A
      *                                                                                       245408
      ** Primary Customer Details                                                             245408
      *                                                                                       245408
     C                     MOVE *BLANK    R1PCRN                                              245408
     C                     MOVE *BLANK    R1PMFC                                              245408
     C                     MOVE *BLANK    R1PMFT                                              245408
     C                     MOVE *BLANK    R1FCCY                                              245408
     C                     MOVE *BLANK    R1FAMT                                              245408
     C                     MOVE *BLANK    R1CAMD                                              245408
     C                     MOVE *BLANK    R1CAVL                                              245408
     C/COPY WNCPYSRC,LEH00196
      *                                                                                       245408
     C**********           ENDIF                                                      245408 245408A
      *                                                                                       245408
     C                     ENDSR                                                              245408
      *                                                                                       245408
      *****************************************************************               245408 245408A
      *TITLE*SR/PRTPAR*************************************************               245408 245408A
      *****************************************************************               245408 245408A
      *****************************************************************               245408 245408A
     C********** PRTPAR    BEGSR                                                      245408 245408A
      *****************************************************************               245408 245408A
      ***Call*Access*Program*for*Customer*Details.*********************               245408 245408A
      *****************************************************************               245408 245408A
     C**********           MOVELCNUM      PKEY1  10                                   245408 245408A
     C**********           CALL 'AOCUSTR0'                                            245408 245408A
     C**********           PARM *BLANKS   PRTCD   7                                   245408 245408A
     C**********           PARM '*KEY   ' POPTN   7                                   245408 245408A
     C**********           PARM           PKEY1                                       245408 245408A
     C**********           PARM           PKYST   7                                   245408 245408A
     C********** SDCUST    PARM SDCUST    DSSDY                                       245408 245408A
      *****************************************************************               245408 245408A
      ***Handle*Database*Error.****************************************               245408 245408A
      *****************************************************************               245408 245408A
     C********** PRTCD     IFNE *BLANKS                                               245408 245408A
     C********** *LOCK     IN   LDA                                                   245408 245408A
     C**********           MOVE 'SDCUSTPD'DBFILE                                      245408 245408A
     C**********           MOVELCNUM      DBKEY     P                                 245408 245408A
     C**********           Z-ADD004       DBASE                                       245408 245408A
     C**********           OUT  LDA                                                   245408 245408A
     C**********           EXSR *PSSR                                                 245408 245408A
     C**********           ENDIF                                                      245408 245408A
      *****************************************************************               245408 245408A
      ***Participant*Customer*Name*************************************               245408 245408A
      *****************************************************************               245408 245408A
     C**********           MOVELBBCRNM    R2CRNM                                      245408 245408A
      *****************************************************************               245408 245408A
      ***Call*Access*Program*for*Currency*Details.*********************               245408 245408A
      *****************************************************************               245408 245408A
     C**********           CALL 'AOCURRR0'                                            245408 245408A
     C**********           PARM *BLANKS   PRTCD   7                                   245408 245408A
     C**********           PARM '*KEY   ' POPTN   7                                   245408 245408A
     C**********           PARM FCCY      PK101   3                                   245408 245408A
     C********** SDCURR    PARM SDCURR    DSSDY                                       245408 245408A
      *****************************************************************               245408 245408A
      ***Handle*Database*Error.****************************************               245408 245408A
      *****************************************************************               245408 245408A
     C********** PRTCD     IFNE *BLANKS                                               245408 245408A
     C********** *LOCK     IN   LDA                                                   245408 245408A
     C**********           MOVE 'SDCURRPD'DBFILE                                      245408 245408A
     C**********           MOVELFCCY      DBKEY     P                                 245408 245408A
     C**********           Z-ADD009       DBASE                                       245408 245408A
     C**********           OUT  LDA                                                   245408 245408A
     C**********           EXSR *PSSR                                                 245408 245408A
     C**********           ENDIF                                                      245408 245408A
      *****************************************************************               245408 245408A
      ***Chain*FCLTY*to*Get*Other*Details******************************               245408 245408A
      *****************************************************************               245408 245408A
     C********** FCLTYK    KLIST                                                      245408 245408A
     C**********           KFLD           CNUM                                        245408 245408A
     C**********           KFLD           FACT                                        245408 245408A
     C**********           KFLD           FCNO                                        245408 245408A
     C**********           KFLD           RCTP                                        245408 245408A
      *****************************************************************               245408 245408A
     C**********           MOVEL'B'       RCTP                                        245408 245408A
     C********** FCLTYK    CHAINFCLTY                88                               245408 245408A
      *****************************************************************               245408 245408A
     C********** *IN88     IFEQ *OFF                                                  245408 245408A
     C**********           Z-ADDFAMT      #FAMT  130                                  245408 245408A
     C**********           Z-ADDCAMD      #CAMD  130                                  245408 245408A
     C********** FAMT      SUB  OAM2      #CAVL  130                                  245408 245408A
      *****************************************************************               245408 245408A
      ***Participant*Currency******************************************               245408 245408A
      *****************************************************************               245408 245408A
     C**********           MOVELFCCY      R2FCCY                                      245408 245408A
      *****************************************************************               245408 245408A
      ***If*either*Credit*Lines*or*Collateralised*Lending*is*available,               245408 245408A
      ***access*Facilities*Extension*file******************************               245408 245408A
      *****************************************************************               245408 245408A
     C********** CLE024    IFEQ 'Y'                                                   245408 245408A
     C********** CLE025    OREQ 'Y'                                                   245408 245408A
     C**********           EXSR SRRTVX                                                245408 245408A
     C**********           Z-ADDFCXCOF    #OFFS  130                                  245408 245408A
     C**********           Z-ADDFCXCV1    #CCLV  150                                  245408 245408A
     C**********           MOVE FCXALV    RCLTV                                       245408 245408A
     C**********           ENDIF                                                      245408 245408A
      *****************************************************************               245408 245408A
     C**********           ENDIF                                                      245408 245408A
      *****************************************************************               245408 245408A
      ***Write*out*the*record.*****************************************               245408 245408A
      *****************************************************************               245408 245408A
     C**********           EXSR WP1REC                                                245408 245408A
      *****************************************************************               245408 245408A
      ***Participant*Customer*Details**********************************               245408 245408A
      *****************************************************************               245408 245408A
     C**********           MOVE *BLANK    R2CRNM                                      245408 245408A
     C**********           MOVE *BLANK    R2CNUM                                      245408 245408A
     C**********           MOVE *BLANK    R2FACT                                      245408 245408A
     C**********           MOVE *BLANK    R2FCCY                                      245408 245408A
     C**********           MOVE *BLANK    R2FAMT                                      245408 245408A
     C**********           MOVE *BLANK    R2CAMD                                      245408 245408A
     C**********           MOVE *BLANK    R2CAVL                                      245408 245408A
      ****************************************************************                245408 245408A
     C**********           MOVE *BLANK    ROFFS                                       245408 245408A
     C**********           MOVE *BLANK    RCLTV                                       245408 245408A
     C**********           MOVE *BLANK    RCCLV                                       245408 245408A
      ****************************************************************                245408 245408A
     C**********           ENDSR                                                      245408 245408A
      ****************************************************************                245408 245408A
      *****************************************************************                       245408
      /TITLE SR/CHKLIN                                                                        245408
      *****************************************************************                       245408
      *                                                               *                       245408
      *  CHKLIN  - Checks report file line number                     *                       245408
      *                                                               *                       245408
      *  Called By:                                                   *                       245408
      *  REPORT - Process Report Lines                                *                       245408
      *  WP1REC - Format and Write a Detail Record to the Report      *                       245408
      *  WP1END - Write End of Report                                 *                       245408
      *  PRTOT  - Checks report file line number                      *                       245408
      *                                                               *                       245408
      *****************************************************************                       245408
      *                                                                                       245408
     C           CHKLIN    BEGSR                                                              245408
      *                                                                                       245408
      ** Check that sufficient lines remain for the Format. If not,                           245408
      ** write out the Main Headings on a new page.                                           245408
      *                                                                                       245408
     C           *IN97     IFEQ *ON                                                           245408
     C                     WRITEHEADP1                                                        245408
     C                     MOVE *OFF      *IN97                                               245408
     C                     ENDIF                                                              245408
      *                                                                                       245408
     C                     ENDSR                                                              245408
      *                                                                                       245408
      *****************************************************************                       245408
      /EJECT                                                                                 245408A
      *****************************************************************                      245408A
      /TITLE SR/SRFAMT                                                                       245408A
      *****************************************************************                      245408A
      *                                                               *                      245408A
      *  SRFAMT  - Retrieves facility amount from FCLTYFM             *                      245408A
      *                                                               *                      245408A
      *  Called By:                                                   *                      245408A
      *  WP1REC - Format and Write a Detail Record to the Report      *                      245408A
      *  PRTPRI - Prints details of the primary facility              *                      245408A
      *                                                               *                      245408A
      *****************************************************************                      245408A
      *                                                                                      245408A
     C           SRFAMT    BEGSR                                                             245408A
      *                                                                                      245408A
     C                     MOVEL*BLANKS   #PRTR                                               247097
     C           K@FTYM    CHAINFCLTYFM              94                                      245408A
     C           *IN94     IFEQ *OFF                                                         245408A
     C                     Z-ADDFAMT      #FAMT                                              245408A
     C                     MOVELPRTR      #PRTR   1                                           247097
     C                     MOVELPRTR      RPRTR                                               247097
     C                     ENDIF                                                             245408A
      *                                                                                      245408A
     C                     ENDSR                                                             245408A
      *                                                                                      245408A
      *****************************************************************                      245408A
      /EJECT                                                                                 245408A
      *****************************************************************                      245408A
      /TITLE SR/SRCAMD                                                                       245408A
      *****************************************************************                      245408A
      *                                                               *                      245408A
      *  SRCAMD  - Retrieves current exposure (outstanding loan)      *                      245408A
      *            from FCLTYFN                                       *                      245408A
      *                                                               *                      245408A
      *  Called By:                                                   *                      245408A
      *  WP1REC - Format and Write a Detail Record to the Report      *                      245408A
      *  PRTPRI - Prints details of the primary facility              *                      245408A
      *                                                               *                      245408A
      *****************************************************************                      245408A
      *                                                                                      245408A
     C           SRCAMD    BEGSR                                                             245408A
      *                                                                                      245408A
     C           K@FTYN    CHAINFCLTYFN              93                                      245408A
     C           *IN93     IFEQ *OFF                                                         245408A
     C                     Z-ADDCAMD      #CAMD                                              245408A
     C/COPY WNCPYSRC,LEH00197
     C                     ENDIF                                                             245408A
      *                                                                                      245408A
     C                     ENDSR                                                             245408A
      *                                                                                      245408A
      *****************************************************************                      245408A
      /EJECT                                                                                 245408A
      *****************************************************************                      245408A
      /TITLE SR/SRCUSN                                                                       245408A
      *****************************************************************                      245408A
      *                                                               *                      245408A
      *  SRCUSN - Validates customer number                           *                      245408A
      *                                                               *                      245408A
      *  Called By:                                                   *                      245408A
      *  WP1REC - Format and Write a Detail Record to the Report      *                      245408A
      *  PRTPRI - Prints details of the primary facility              *                      245408A
      *                                                               *                      245408A
      *  Calls    :                                                   *                      245408A
      *  *PSSR  - Program Error Processing Subroutine                 *                      245408A
      *                                                               *                      245408A
      *****************************************************************                      245408A
      *                                                                                      245408A
     C           SRCUSN    BEGSR                                                             245408A
      *                                                                                      245408A
      ** Call Access Program for Customer Details.                                           245408A
      *                                                                                      245408A
     C                     CALL 'AOCUSTR0'                                                   245408A
     C                     PARM *BLANKS   PRTCD   7                                          245408A
     C                     PARM '*KEY   ' POPTN   7                                          245408A
     C                     PARM           PKEY1                                              245408A
     C                     PARM           PKYST   7                                          245408A
     C           SDCUST    PARM SDCUST    DSSDY                                              245408A
      *                                                                                      245408A
      ** Handle Database Error.                                                              245408A
      *                                                                                      245408A
     C           PRTCD     IFNE *BLANKS                                                      245408A
     C           *LOCK     IN   LDA                                                          245408A
     C                     MOVE 'SDCUSTPD'DBFILE                                             245408A
     C                     MOVELPKEY1     DBKEY     P                                        245408A
     C                     Z-ADD004       DBASE                                              245408A
     C                     OUT  LDA                                                          245408A
     C                     EXSR *PSSR                                                        245408A
     C                     ENDIF                                                             245408A
      *                                                                                      245408A
     C                     ENDSR                                                             245408A
      *                                                                                      245408A
      *****************************************************************                      245408A
      /EJECT                                                                                 245408A
      *****************************************************************                      245408A
      /TITLE SR/SRCUSD                                                                       245408A
      *****************************************************************                      245408A
      *                                                               *                      245408A
      *  SRCUSD - Validates other customer details                    *                      245408A
      *                                                               *                      245408A
      *  Called By:                                                   *                      245408A
      *  WP1REC - Format and Write a Detail Record to the Report      *                      245408A
      *  PRTPRI - Prints details of the primary facility              *                      245408A
      *                                                               *                      245408A
      *  Calls    :                                                   *                      245408A
      *  *PSSR  - Program Error Processing Subroutine                 *                      245408A
      *                                                               *                      245408A
      *****************************************************************                      245408A
      *                                                                                      245408A
     C           SRCUSD    BEGSR                                                             245408A
      *                                                                                      245408A
      ** Call Access Program for Currency Details.                                           245408A
      *                                                                                      245408A
     C                     CALL 'AOCURRR0'                                                   245408A
     C                     PARM *BLANKS   PRTCD   7                                          245408A
     C                     PARM '*KEY   ' POPTN   7                                          245408A
     C                     PARM           PK101   3                                          245408A
     C           SDCURR    PARM SDCURR    DSSDY                                              245408A
      *                                                                                      245408A
      ** Handle Database Error.                                                              245408A
      *                                                                                      245408A
     C           PRTCD     IFNE *BLANKS                                                      245408A
     C           *LOCK     IN   LDA                                                          245408A
     C                     MOVE 'SDCURRPD'DBFILE                                             245408A
     C                     MOVEL#FCCY     DBKEY     P                                        245408A
     C                     Z-ADD005       DBASE                                              245408A
     C                     OUT  LDA                                                          245408A
     C                     EXSR *PSSR                                                        245408A
     C                     ENDIF                                                             245408A
      *                                                                                      245408A
     C                     ENDSR                                                             245408A
      *                                                                                      245408A
      *****************************************************************                      245408A
      /EJECT                                                                                 245408A
      *****************************************************************                      245408A
      /TITLE SR/ZFRPED
     C/COPY ZSRSRC,ZFRPEDZ3
**  CPY@
(c) Finastra International Limited 2001
