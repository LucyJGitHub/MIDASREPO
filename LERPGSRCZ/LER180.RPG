000100230706     H        1
000200230706      *****************************************************************
000300230706/*STD *  RPGBASE                                                      *
000400230706/*EXI *  TEXT('Midas LE Lending fee accrual reports')                 *
000500230706      *****************************************************************
000600230706      *                                                               *
000700230706      *  Midas Customer Lending Module                                *
000800230706      *                                                               *
000900230706      *  LER180 - Outstanding Fees                                    *
001000230706      *                                                               *
001100230706      *  Function: This program reports fees outstanding during the COB
001200230706      *                                                               *
001300230706      *  Called By: LERC15                                            *
001400230706      *                                                               *
001500230706      *  (COB)                                                        *
001600230706      *                                                               *
001700230706      *  (c) Finastra International Limited 2001                      *
001800230706      *                                                               *
001900230707      *  Last Amend No. 263718             Date 06Jul23               *
001901230706      *  Prev Amend No. MD060750           Date 18Jan23               *
002000230706      *                 MD060411           Date 15Nov22               *
002100230706      *                 MD060092           Date 01Aug22               *
002200230706      *                 CLE138             Date 02Nov21               *
002300230706      *                 MD058815           Date 28Sep21               *
002400230706      *                 CLE172             Date 01Oct20               *
002500230706      *                 CSD103             Date 10Aug20               *
002600230706      *                 MD055481           Date 04Sep20               *
002700230706      *                 249924             Date 03Mar20               *
002800230706      *                 AR674226           Date 04Dec19               *
002900230706      *                 CER050             Date 16Jun19               *
003000230706      *                 MD053295           Date 13Apr19               *
003100230706      *                 MD050457           Date 06Mar19               *
003200230706      *                 CLE071             Date 18Jul18               *
003300230706      *                 MD046248           Date 27Oct17               *
003400230706      *                 MD047993           Date 23Sep17               *
003500230706      *                 MD035545           Date 11Sep15               *
003600230706      *                 MD037658           Date 19Feb16               *
003700230706      *                 MD046351           Date 23Aug17               *
003800230706      *                 MD026385           Date 25Apr14               *
003900230706      *                 AR894146           Date 06Feb13               *
004000230706      *                 AR996895           Date 25Nov12               *
004100230706      *                 CLE134             Date 01Aug12               *
004200230706      *                 CLE148             Date 23Jul12               *
004300230706      *                 CLE073             Date 13May08               *
004400230706      *                 263666             Date 01Feb10               *
004500230706      *                 CER059             Date 19Jul10               *
004600230706      *                 CER016A            Date 19May08               *
004700230706      *                 CER047             Date 19May08               *
004800230706      *                 CER043             Date 19May08               *
004900230706      * Bank Fusion Midas 1.4 Base -----------------------------------*
005000230706      *                 CSC042             Date 16Feb09               *
005100230706      * Midas Plus 1.4 Base 04 ---------------------------------------*
005200230706      *                 CPK028             Date 25May07               *
005300230706      *                 246141             Date 26Mar07               *
005400230706      *                 246309             Date 09Mar07               *
005500230706      *                 246018             Date 26Feb07               *
005600230706      *                 164847             Date 30Nov06               *
005700230706      *                 BUG12990           Date 05Jan07               *
005800230706      * Midas Plus 1.3 ----------- Base ------------------------------*
005900230706      *                 242286             Date 26Sep06               *
006000230706      *                 212048             Date 06Jun06               *
006100230706      *                 CSD031             Date 10Apr06               *
006200230706      *                 CSD027             Date 09Dec05               *
006300230706      *                 CLE042             Date 06Sep05               *
006400230706      *                 CLE106             Date 27Apr05               *
006500230706      *                 CSW037A            Date 02May05               *
006600230706      *                 CIR013             Date 25Apr05               *
006700230706      *                 CSD025             Date 11Jan05               *
006800230706      *                 CSW037             Date 15Dec04               *
006900230706      *                 CSW036             Date 15Dec04               *
007000230706      *                 CLE025             Date 20Oct03               *
007100230706      *                 CGL029             Date 01Sep03               *
007200230706      *                 CAS006             Date 21Jan03               *
007300230706      *                 CAS005             Date 16Dec02               *
007400230706      * Midas Release 4.01.02 ----------------------------------------*
007500230706      *                 204452             Date 03May02               *
007600230706      * Midas Release 4.01 -------------------------------------------*
007700230706      *                 200289             Date 19Nov01               *
007800230706      *                 193475             Date 29Nov01               *
007900230706      * Midas Release 4 --------------- Base -------------------------*
008000230706      * Midas DBA 3.05 -----------------------------------------------*
008100230706      *                 CLE013             Date 11Dec00               *
008200230706      *                 CLE011             Date 07Nov00               *
008300230706      * Midas DBA 3.02 -----------------------------------------------*
008400230706      *                 CLE009             Date 26Apr99               *
008500230706      * Midas DBA 3.00 ---------------- Base -------------------------*
008600230706      *                 158687             Date 13Apr99               *
008700230706      *                 156582             Date 25Mar99               *
008800230706      *                 152166             Date 21Jan99               *
008900230706      *                 147894             Date 04Dec98               *
009000230706      *                 141453             Date 17Feb99               *
009100230706     F*                 140840             Date 18Sep98               *
009200230706     F*                 138165             DATE 29SEP98               *
009300230706     F*                 138421             DATE 28SEP98               *
009400230706     F*                 CLE005             Date 22May97               *
009500230706     F*                 S01408             Date 06Sep96               *
009600230706     F*                 103019             Date 22May96               *
009700230706     F*                 101322             DATE 22MAY96               *
009800230706     F*                 100657             DATE 22MAY96               *
009900230706     F*                 100658             DATE 22MAY96               *
010000230706     F*                 100431             DATE 22MAY96               *
010100230706     F*                 100515             DATE 22MAY96               *
010200230706     F*                 085910             DATE 29MAY95               *
010300230706     F*                 085915             DATE 08MAY95               *
010400230706     F*                 085914             DATE 08MAY95                  *
010500230706     F*                 S01408             DATE 27JUN95                  *
010600230706     F*                 085677             DATE 29MAR95                  *
010700230706     F*                 085309             DATE 28MAR95                  *
010800230706     F*                 052703             DATE 27APR93                  *
010900230706     F*                 BH3518             DATE 08SEP92                  *
011000230706     F*                 BHBC01             DATE 03SEP92                  *
011100230706     F*                                                                  *
011200230706      *---------------------------------------------------------------*
011300230706      *                                                               *
011301230706      *  263718 - Fee detail errors in reports LER180P1 and LER180P3. *
011302230720      *         - Upgrade client fix BF7069 to MP1.4.  Add fee past   *
011303230720      *           due amount to 'Accrued Amount' for LER180P1.        *
011304230706      *         - Reverse core fix 246309, this is to ensure correct  *
011305230706      *           format for all reports.                             *
011400230706      *  MD060750 - Duplicate record key in member LEFHSTLB during    *
011500230706      *             migration. (Recompile)                            *
011600230706      *  MD060411 - Correct the calculation of fee amount using       *
011700230706      *             calculation basis 6. Correction to MD058815       *
011800230706      *  MD060092 - Revert CLE138 Changes in SDFACTPD, AOFACTR0 and   *
011900230706      *             SD Facility Type Maintenance. Apply CLE138        *
012000230706      *             design of SDFACTX0 to store facility classes.     *
012100230706      *  CLE138 - Class Codes for Facilities                          *
012200230706      *  MD058815 - Dealing interest Calculation type 6 have different*
012300230706      *             interest amount for Calculation type 1 for non-   *
012400230706      *             leap year interest period with same parameters.   *
012500230706      *             Based from MD052690. (Recompile)                  *
012600230706      *  CLE172 - LIBOR Deregulation - Lending (Recompile)            *
012700230706      *  CSD103 - LIBOR Deregulation - Common Layer/Standing Data     *
012800230706      *           (Recompile)                                         *
012900230706      *  MD055481 - Show the original borrower on the report for loan *
013000230706      *             fees attached to a participation purchased if the *
013100230706      *             system value 'LoanCustOriginPurch' is equal to 'O'*
013200230706      *  249924 - Reversed part of 246309. Revert to previous design  *
013300230706      *           of the program. Sort by PCRF field too so           *
013400230706      *           syndications can be grouped together.               *
013500230706      *         - Applied for MD054918                                *
013600230706      *  AR674226 - Manual transaction reached 999. Increase the size *
013700230706      *             of utilisation sequence no. and transaction       *
013800230706      *             sequence. (Child: AR674227)                       *
013900230706      *           - Applied for MD054782.                             *
014000230706      *  CER050 - Annualised Percentage Rate (Recompile)              *
014100230706      *  MD053295 - Lending loan with Interest Calculation Basis      *
014200230706      *             method 3 (30/360) has wrong interest payment      *
014300230706      *             amount for month of March (Recompile)             *
014400230706      *  MD050457 - Do not process DBERR when customer is closed.     *
014500230706      *             Patterned fic from 263371.                        *
014600230706      *  CLE071 - Value Dating of Rate Changes to Fees                *
014700230706      *  MD046248 - Finastra Rebranding                               *
014800230706      *  MD047993 - Modified MD035545. Removed dependency on Accrue   *
014900230706      *             on Last Day indicator.                            *
015000230706      *  MD035545 - LE: Interest Calculation in Leap year. Consider   *
015100230706      *             Accrue on Last Day Indicator for method 6.        *
015200230706      *  MD037658 - Define NDAYS/WDAYS w/decimal to cater calc basis 6*
015300230706      *  MD046351 - Rounding and truncation in fee accrual            *
015400230706      *             calculations due to mult/div using 15,9 fields    *
015500230706      *             being placed into 13,0/15,0 result fields.        *
015600230706      *  MD026385 - Many fields with unknown data 99.999999999.       *
015700230706      *           - Accrued amount are incorrect.                     *
015800230706      *  AR894146 - An array index not valid error was encountered    *
015900230706      *             during COB run thus Component LERC18 00001 failed.*
016000230706      *             The length of index T and variable T2 is increased*
016100230706      *             from 2 to 4. Applied part of fix 246309A.         *
016200230706      *             (Child: AR894147)                                 *
016300230706      *  AR996895 - Incorrect acrrual interest calculation            *
016400230706      *             (Child: AR996897) (Recompile)                     *
016500230706      *  CLE134 - Past Due Call Loan Processing                       *
016600230706      *  CLE148 - Alpha Loan Reference (Recompile)                    *
016700230706      *  CLE073 - Calculated Loan Based Fees                          *
016800230706      *  263666 - Recompiled due to changes in ZINTDYZ2               *
016900230706      *  CER059 - German Feature Upgrade to Delhi                     *
017000230706      *  CER016A - German Interest Calculation: Upgarde of FGE059     *
017100230706      *            to Midas Plus (Recompile)                          *
017200230706      *  CER047 - German Features LF037-00 Reporting 24c             *
017300230706      *           (Recompile)                                         *
017400230706      *  CER043 - German Features LF041-00 New Fields and Defaulting  *
017500230706      *           (Recompile)                                         *
017600230706      *  CSC042 - COB Performance fix. Only access AOBRCHR0 on change of *
017700230706      *           branch rather than every record as input file sorted by*
017800230706      *           branch                                                 *
017900230706      *           Pgm sets up arrays of ccy details in first cycle and
018000230706      *           then ignores them and calls AOCURRR* >300K times
018100230706      *  CPK028 - @VCNUM field should be 6A                           *
018200230706      *  246141 - Recompiled due to changes in ZINTDYZ2               *
018300230706      *  246309 - Accruals should be grouped together for syndication.*
018400230706      *           Modified the sorting for LER180P1 :                 *
018500230706      *           1. Facility                                         *
018600230706      *           2. Fee Sequence                                     *
018700230706      *           3. Calculated Amount (Estimated Avg then Accrued)   *
018800230706      *           4. PTFI - Receivable, Internal, Payable             *
018900230706      *  246018 - Divide by zero error.                               *
019000230706      *  164847 - Recompile over changes in /COPY ZINTDYZ2.           *
019100230706      *  BUG12990 - Recompiled due to changes in ZINTDYZ2/ZINTDYZ2LE  *
019200230706      *  242286 - Recompile over changes in /COPY ZINTDYZ2.           *
019300230706      *  212048 - If calc method 6 then INT6DY contains the number    *
019400230706      *           of days from ZINTDY.                                *
019500230706      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
019600230706      *  CSD027 - Conversion Of Customer Number to Alpha              *
019700230706      *  CLE042 - Extended Loan Sub Type                              *
019800230706      *  CLE106 - Syndication Manager                                 *
019900230706      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
020000230706      *  CIR013 - Additional Calculation Method for FRA/IRS/CCF       *
020100230706      *           Recompile over ZINTDY.                              *
020200230706      *  CSD025 - Customer De-Activation                              *
020300230706      *  CSW037 - Additional Field Data on MT300/MT320                *
020400230706      *  CSW036 - Dual SWIFT BIC held on Client Details               *
020500230706      *  CLE025 - Credit Lines (Recompile)                            *
020600230706      *  CGL029 - Increase Account Code to 10 digits (Recompile)      *
020700230706      *  CAS006 - Hedge Accounting Phase B (Recompile)                *
020800230706      *  CAS005 - Enahancements to CAS001, CAS002 and CAS004          *
020900230706      *           (Recompile)                                         *
021000230706      *  204452 - Recompiled due to changed PF/LEFEED.                *
021100230706      *  200289 - Increase facility sequence number in FACHISA from   *
021200230706      *           2N to 3N.                                           *
021300230706      *  193475 - 'Receivable', 'Payable' or 'Internal' fee indicator *
021400230706      *           will only show on report if CLE006 is ON.           *
021500230706      *  CLE013 - Customer Lending Fees Enhancement - Phase 1         *
021600230706      *  CLE011 - Rate Fixing Days for Lending Rollover Processing    *
021700230706      *           Recompile                                           *
021800230706      *  CLE009 - LE I/C Swift Message Generation for Fees            *
021900230706      *           Recompiled due to changes in LEFEED                 *
022000230706      *  158687 - Header 'fee up to and including' should be 'fee and *
022100230706      *           past due up to and including' to be consistent with *
022200230706      *           the report details. Recompiled due to changes in    *
022300230706      *           LER180P1, P2, P3 and P4.                            *
022400230706      *  156582 - LER180, fee accrual report should subtract payables *
022500230706      *  152166 - Fees calculated as 2 days to next due date when it  *
022600230706      *           should be 1.                                        *
022700230706      *  147894 - LER180 Fee Currency is wrong                        *
022800230706      *           Recompiled due to changes in LER180P1               *
022900230706      *  141453 - Recompiled due to changes in PF/LEFEED              *
023000230706     F*  140840 - Payable Fees not deducted from accrued amount       *
023100230706     F*  138165 - Remove fix 101322.  Accrue on Last Day indicator    *
023200230706     F*           should not be considered in the computation of      *
023300230706     F*           payment due for average balance.  Applied fix       *
023400230706     F*           129834.                                             *
023500230706     F*  138421 - LER180P1 "From Date" should show FELPDT even if it  *
023600230706     F*           is equal to CODT.  Past Due amounts (FEAMTP and     *
023700230706     F*           FEPAMP) should not be included in the "Accrued      *
023800230706     F*           Amount" in LER180P1.                                *
023900230706     F*           This fix should always go together with fix 138165  *
024000230706     F*           and 123004(in LER135).                              *
024100230706     F*  CLE005 - Customer Lending Enhancements - Others (T3)         *
024200230706     F*  S01408 - Add hook LER180CCP2                                 *
024300230706     F*           Add hook LER180CCP3                                 *
024400230706     F*           Add hook LER180FFP1                                 *
024500230706     F*  103019 - If fee is due on next working day, use the          *
024600230706     F*           previous amounts in showing the accrued amount.     *
024700230706     F*           This is related to fix 100658.                      *
024800230706     F*  101322 - Take Accrue on Last Day indicator into account      *
024900230706     F*           when calculating the fee due amount.                *
025000230706     F*  100657 - Change the report format and text of LER180P1.      *
025100230706     F*           Change the narratives for the calculation types     *
025200230706     F*  100658 - Calculated amount and accrued amount are incorrect  *
025300230706     F*           for calculated fees.                                *
025400230706     F*  100431 - Fee currency name in headings getting corrupted     *
025500230706     F*           by subsequent chain to ccy file with facility ccy   *
025600230706     F*           Applied fix 092195.                                 *
025700230706     F*  100515 - Recompile program due to changes in LEFEED.         *
025800230706     F*  085910 - Correct printing of report to avoid overprinting.      *
025900230706     F*  085915 - Correct calculated/accrued amount printed in LER180    *
026000230706     F*           reports for amortised and accrued on fixed amount      *
026100230706     F*           fees.                                                  *
026200230706     F*  085914 - Suppress reporting of single payment (bullet) fees     *
026300230706     F*           in Loan Amortization report.                           *
026400230706     F*           Addition of core hook LER180CCP1                       *
026500230706     F*  S01408 - Addition of core hook LER180CCPG                       *
026600230706     F*  085677 - If there is no record found on CLOAN for a fee         *
026700230706     F*           attached to a Loan (not facility), because the loan    *
026800230706     F*           has matured; and historic retention period on LE ICD   *
026900230706     F*           is GT 0, chain to MLOAN instead.                       *
027000230706     F*  085309 - Set up 'P' before doing operation on array POWER       *
027100230706     F*  052703 - Fees due tomorrow not reported correctly               *
027200230706     F*  BH3518 - Formatting changes                                     *
027300230706     F*  BHBC01 - Fee narrative not picked up and pgm falls over         *
027400230706     F*                                                                  *
027500230706     F********************************************************************
027600230706      *------------------------------------------------------------------*
027700230706     FLEFEEAC IF  E           K        DISK
027800230706      * Lending Fees - by branch, currency, facility type, customer &
027900230706      * fee code
028000230706      *
028100230706     FFACHISH IF  E           K        DISK
028200230706     FFACHSAL1IF  E           K        DISK
028300230706     F***FEEKEY**IF**E           K        DISK                     052703 100658
028400230706     FFCLTY   IF  E           K        DISK
028500230706     F            FCLTYHHF                          KIGNORE
028600230706     F            FCLTYFNF                          KIGNORE
028700230706     F            FCLTYZZF                          KIGNORE
028800230706     FCLOAN   IF  E           K        DISK
028900230706     F            CLOANHHF                          KIGNORE
029000230706     F            CLOANCKF                          KIGNORE
029100230706     F            CLOANZ1F                          KIGNORE
029200230706     FMLOAN   IF  E           K        DISK                               085677
029300230706     F            CLOANCLF                          KRENAMEMLOANCLF       085677
029400230706     F***SDCURRPDIF  E           K        DISK                                                CSC042
029500230706     FSDCURRPDIF  E           K        DISK                           UC                      CSC042
029600230706      *                                                                                       CLE071
029700230706     FLEFHSTLBIF  E           K        DISK                                                   CLE071
029800230706      ** Lending Fees History for Rate Changes                                                CLE071
029900230706      *                                                                                       CLE071
030000230706     FLER180P1O   E             80     PRINTER      KINFDS SPOOL1     UC
030100230706      *
030200230706     FLER180P2O   E             81     PRINTER      KINFDS SPOOL2     UC
030300230706      *
030400230706     FLER180P3O   E             82     PRINTER      KINFDS SPOOL3     UC
030500230706      *
030600230706     FLER180P4O   E             83     PRINTER      KINFDS SPOOL4     UC
030700230706      *
030800230706     FLER180AUO   E                    PRINTER      KINFDS SPOOLU
030900230706      *
031000230706     F/COPY WNCPYSRC,LER180FFP1                                           S01408
031100230706      *****************************************************************
031200230706     F*
031300230706     F*   FUNCTION OF INDICATORS
031400230706     F*
031500230706     F* 01    First Cycle indicator
031600230706     F* 11    Output Fee rate rather than amount
031700230706     F* 12    Output Fee type rather than amount
031800230706     F* 13    Work indicator
031900230706     F* 14    Work indicator
032000230706     F* 16    Output Estimated Average amount                             100657
032100230706     F* 18    Read of FACHSAL1
032200230706      * 17    Read of LEFHSTLB                                                                CLE071
032300230706     F* 19    Last Payment Date = 0
032400230706     F* 20    Work indicator
032500230706     F* 24    Multi Branch system
032600230706     F* 25    Work indicator
032700230706     F* 30    Number of Decimal Places = 0
032800230706     F* 31    Number of Decimal Places = 1
032900230706     F* 32    Number of Decimal Places = 2
033000230706     F* 33    Number of Decimal Places = 3
033100230706     F* 34    Number of Decimal Places = 0
033200230706     F* 35    Number of Decimal Places = 1
033300230706     F* 36    Number of Decimal Places = 2
033400230706     F* 37    Number of Decimal Places = 3
033500230706     F* 50    Fee Payable/Fee Receivable indicator                        CLE005
033600230706     F* 51    Fee Payable/Fee Receivable indicator                        CLE005
033700230706     F* 52    Fee Payable/Fee Receivable indicator                        CLE005
033800230706     F* 70    Work indicator
033900230706     F* 71    Work indicator
034000230706     F* 80    Overflow indicator - LER180P1
034100230706     F* 81    Overflow indicator - LER180P2
034200230706     F* 82    Overflow indicator - LER180P3
034300230706     F* 83    Overflow indicator - LER180P4
034400230706     F* 98    American Date Format
034500230706     F* 99    Access object error
034600230706     F* U7&U8 Database error handling
034700230706     F*
034800230706     F*****************************************************************
034900230706     F*
035000230706     F*  Subroutine Index
035100230706     F*
035200230706     F* INIT   - Initialisation subroutine
035300230706     F* SRFACY - Facility Fee Processing
035400230706     F* SRLOAN - Loan Fee Processing
035500230706     F* CHANGE - Change of branch/currency/facility type processing
035600230706     F* AVCALC - Calculation of average amount based fees to date
035700230706     F* ACCRUE - Actual calculation of fee for average amount
035800230706     F* AUDIT  - Audit Report subroutine
035900230706     F* LSTRAT - Search of fee rates for appropriate one to use
036000230706     F* *PSSR  - Abnormal error conditions
036100230706     F* ZXRATE - Midas standard subroutine
036200230706     F* ZCONV  - Midas standard subroutine
036300230706      * PRCFRC - Calculation of average amount based fees for                                 CLE071
036400230706      *          Value Dating of Fee Rate Changes                                             CLE071
036500230706     F*
036600230706     F*****************************************************************
036700230706     F/EJECT
036800230706     E                    CPY@    1   1 80
036900230706     E                    POWER   1   7  7 3             POWER ARRAY
037000230706     E********************NARR    1   3 10               Fee Narratives   100657
037100230706     E                    NARR    1  17 10               Fee Narratives   100657
037200230706     E                    TABCAL  6   6  1 0 TABCBS  5 0 CALC.BASES
037300230706     E/COPY ZSRSRC,ZDATE2Z1
037400230706     E/COPY ZSRSRC,ZDATE9Z1                                               CLE013
037500230706     E                    FEAM        5 11 0A            FEE AMOUNTS
037600230706     E                    FAM         5 13 0A            FEE AMOUNTS
037700230706     E                    FRT         5  7 5A            FEE RATES
037800230706     E                    FPC         5  6 3A            FEE PERCENTAGE
037900230706     E                    CURR      150  3               ALL CCYS
038000230706     E                    CSPT      150 13 8             SPOT RATES/CCY
038100230706     E                    MTDV      150  1               M/D INDICATOR/CCY
038200230706     E                    CCDP      150  1 0             DEC PLACES/CCY
038300230706     E                    CCNO      150  2 0             SORT SEQ.NO/CCY
038400230706     E                    CYNM      150 14               Curr Name                            CSC042
038500230706     E                    AKY        10  1               A/C KEYS         052703
038600230706     E**********          ARAC     5000150               FEE ACCRUALS DETAILS          246309 249924
038700230706     E                    ##BR      999  3               Branch Codes                         CSC042
038800230706     E                    ##BN      999 30               Branch Names                         CSC042
038900230706     E                    WAM         5 11 0A            FEE AMOUNTS                          CLE071
039000230706     E                    WRT         5  7 5A            FEE RATES                            CLE071
039100230706     E                    HIAM        5 11 0A            FEE AMOUNTS                          CLE071
039200230706     E                    HIRT        5  7 5A            FEE RATES                            CLE071
039300230706      *
039400230706     E/EJECT
039500230706      *                                                                   CLE005
039600230706      ** Rename NLRA field in CLOANZ1F Format in file MLOAN               CLE005
039700230706     ICLOANZ1F                                                            CLE005
039800230706     I              NLRA                            NLRAZ                 CLE005
039900230706      *                                                                   CLE005
040000230706      *                                                                   CLE005
040100230706      ** Fee Accruals and Past Due Details                                             246309 249924
040200230706     I*DSFEAC****  DS                                                                  246309 249924
040300230706     I**********                              1   50DFACL                              246309 249924
040400230706     I**********                              1   30DFTYP                              246309 249924
040500230706     I**********                              4   50DFSEQ                              246309 249924
040600230706     I**********                              6   70DFESEQ                             246309 249924
040700230706     I**********                              8   8 DVAMT                              246309 249924
040800230706     I**********                              9   9 DLNAR                              246309 249924
040900230706     I**********                             10  150DCNUM                       246309 CPK028 249924
041000230706     I**********                             10  15 DCNUM                              CPK028 249924
041100230706     I**********                             16  35 DBCRNM                             246309 249924
041200230706     I**********                             36  37 DFCOD                              246309 249924
041300230706      * Amounts                                                                        246309 249924
041400230706     I**********                             38  50 DFAMTS                             246309 249924
041500230706     I**********                             51  63 DFEEAM                             246309 249924
041600230706     I**********                             64  76 DCALCD                             246309 249924
041700230706     I**********                             77  89 DPOSTD                             246309 249924
041800230706      * Indicators                                                                     246309 249924
041900230706     I**********                             90  99 DINDS                              246309 249924
042000230706     I**********                             90  90 DIN11                              246309 249924
042100230706     I**********                             91  91 DIN12                              246309 249924
042200230706     I**********                             92  92 DIN16                              246309 249924
042300230706     I**********                             93  93 DIN30                              246309 249924
042400230706     I**********                             94  94 DIN31                              246309 249924
042500230706     I**********                             95  95 DIN32                              246309 249924
042600230706     I**********                             96  96 DIN33                              246309 249924
042700230706     I**********                             97  97 DIN50                              246309 249924
042800230706     I**********                             98  98 DIN51                              246309 249924
042900230706     I**********                             99  99 DIN52                              246309 249924
043000230706     I**********                            100 100 DIN53                              246309 249924
043100230706      * Other Details                                                                  246309 249924
043200230706     I**********                            101 107 DBCRTN                             246309 249924
043300230706     I**********                            111 114 DFCCY                     246309 MD026385 249924
043400230706     I**********                            111 113 DFCCY                            MD026385 249924
043500230706     I**********                            114 120 DRDATE                             246309 249924
043600230706     I**********                            121 122 DECALT                             246309 249924
043700230706     I**********                            126 135 DECOMT                             246309 249924
043800230706     I**********                            136 142 DERATE                             246309 249924
043900230706      **********                                                                       246309 249924
044000230706     I            DS                                                      BHBC01
044100230706     I                                        1   20WKFCOD                BHBC01
044200230706     I                                        1   2 WKFCOA                BHBC01
044300230706     I            DS
044400230706     I                                        1  130FEEAM0
044500230706     I                                        1  131FEEAM1
044600230706     I                                        1  132FEEAM2
044700230706     I                                        1  133FEEAM3
044800230706     I            DS
044900230706      ** Fee amounts data structure
045000230706     I                                    P   1  300FEAM
045100230706     I                                    P   1   60FEAMT1
045200230706     I                                    P   7  120FEAMT2
045300230706     I                                    P  13  180FEAMT3
045400230706     I                                    P  19  240FEAMT4
045500230706     I                                    P  25  300FEAMT5
045600230706      *
045700230706     I            DS
045800230706      ** Fee rates data structure
045900230706     I                                    P   1  205FRT
046000230706     I                                    P   1   45FEFRT1
046100230706     I                                    P   5   85FEFRT2
046200230706     I                                    P   9  125FEFRT3
046300230706     I                                    P  13  165FEFRT4
046400230706     I                                    P  17  205FEFRT5
046500230706      *
046600230706     I            DS
046700230706      ** Amounts data structure
046800230706     I                                        1  150FCTOTA
046900230706     I                                        1  150FCTOA0
047000230706     I                                        1  151FCTOA1
047100230706     I                                        1  152FCTOA2
047200230706     I                                        1  153FCTOA3
047300230706      *
047400230706     I            DS
047500230706      ** Amounts data structure
047600230706     I                                        1  150FCTOTM
047700230706     I                                        1  150FCTOM0
047800230706     I                                        1  151FCTOM1
047900230706     I                                        1  152FCTOM2
048000230706     I                                        1  153FCTOM3
048100230706      *
048200230706     I            DS                                                      BH3518
048300230706     I** Amounts data structure                                           BH3518
048400230706     I                                        1  150FATOA0                BH3518
048500230706     I                                        1  151FATOA1                BH3518
048600230706     I                                        1  152FATOA2                BH3518
048700230706     I                                        1  153FATOA3                BH3518
048800230706     I*                                                                   BH3518
048900230706     I            DS                                                      BH3518
049000230706     I** Amounts data structure                                           BH3518
049100230706     I                                        1  150FATOM0                BH3518
049200230706     I                                        1  151FATOM1                BH3518
049300230706     I                                        1  152FATOM2                BH3518
049400230706     I                                        1  153FATOM3                BH3518
049500230706     I*                                                                   BH3518
049600230706     I            DS
049700230706      ** Amounts data structure
049800230706     I                                        1  150CFTOTA
049900230706     I                                        1  150CFTOA0
050000230706     I                                        1  151CFTOA1
050100230706     I                                        1  152CFTOA2
050200230706     I                                        1  153CFTOA3
050300230706      *
050400230706     I            DS
050500230706      ** Amounts data structure
050600230706     I                                        1  150CFTOTM
050700230706     I                                        1  150CFTOM0
050800230706     I                                        1  151CFTOM1
050900230706     I                                        1  152CFTOM2
051000230706     I                                        1  153CFTOM3
051100230706     I*                                                                   BH3518
051200230706     I            DS                                                      BH3518
051300230706     I** Amounts data structure                                           BH3518
051400230706     I                                        1  150CATOA0                BH3518
051500230706     I                                        1  151CATOA1                BH3518
051600230706     I                                        1  152CATOA2                BH3518
051700230706     I                                        1  153CATOA3                BH3518
051800230706     I*                                                                   BH3518
051900230706     I            DS                                                      BH3518
052000230706     I** Amounts data structure                                           BH3518
052100230706     I                                        1  150CATOM0                BH3518
052200230706     I                                        1  151CATOM1                BH3518
052300230706     I                                        1  152CATOM2                BH3518
052400230706     I                                        1  153CATOM3                BH3518
052500230706      *
052600230706     I            DS
052700230706      ** Amounts data structure
052800230706     I                                        1  150CLTOTA
052900230706     I                                        1  150CLTOA0
053000230706     I                                        1  151CLTOA1
053100230706     I                                        1  152CLTOA2
053200230706     I                                        1  153CLTOA3
053300230706      *
053400230706     I            DS
053500230706      ** Amounts data structure
053600230706     I                                        1  150CLTOTM
053700230706     I                                        1  150CLTOM0
053800230706     I                                        1  151CLTOM1
053900230706     I                                        1  152CLTOM2
054000230706     I                                        1  153CLTOM3
054100230706     I*                                                                   BH3518
054200230706     I            DS                                                      BH3518
054300230706     I** Amounts data structure                                           BH3518
054400230706     I                                        1  150CXTOA0                BH3518
054500230706     I                                        1  151CXTOA1                BH3518
054600230706     I                                        1  152CXTOA2                BH3518
054700230706     I                                        1  153CXTOA3                BH3518
054800230706     I*                                                                   BH3518
054900230706     I            DS                                                      BH3518
055000230706     I** Amounts data structure                                           BH3518
055100230706     I                                        1  150CXTOM0                BH3518
055200230706     I                                        1  151CXTOM1                BH3518
055300230706     I                                        1  152CXTOM2                BH3518
055400230706     I                                        1  153CXTOM3                BH3518
055500230706      *
055600230706     I            DS
055700230706     I                                        1  130FAMT0
055800230706     I                                        1  131FAMT1
055900230706     I                                        1  132FAMT2
056000230706     I                                        1  133FAMT3
056100230706     I/COPY WNCPYSRC,LER180I002
056200230706      *
056300230706     I            DS
056400230706     I                                        1  130LAMT0
056500230706     I                                        1  131LAMT1
056600230706     I                                        1  132LAMT2
056700230706     I                                        1  133LAMT3
056800230706      *
056900230706     I            DS
057000230706     I                                        1  130CALCD0
057100230706     I                                        1  131CALCD1
057200230706     I                                        1  132CALCD2
057300230706     I                                        1  133CALCD3
057400230706      *
057500230706     I            DS
057600230706     I                                        1  130POSTD0
057700230706     I                                        1  131POSTD1
057800230706     I                                        1  132POSTD2
057900230706     I                                        1  133POSTD3
058000230706      *
058100230706     I            DS
058200230706     I                                        1   50FEFACL
058300230706     I                                        1   5 FACNO
058400230706     I                                        1   30FTYP
058500230706     I                                        1   3 WFTYP                 052703
058600230706     I                                        4   50FSEQ
058700230706     I                                        6   70FEFCOD                052703
058800230706     I                                        6   7 WFCOD                 052703
058900230706      ** History Fee Amounts                                                                  CLE071
059000230706     I            DS                                                                          CLE071
059100230706     I                                    P   1   60HIAMT1                                    CLE071
059200230706     I                                    P   7  120HIAMT2                                    CLE071
059300230706     I                                    P  13  180HIAMT3                                    CLE071
059400230706     I                                    P  19  240HIAMT4                                    CLE071
059500230706     I                                    P  25  300HIAMT5                                    CLE071
059600230706     I                                        1  30 HIAMTX                                    CLE071
059700230706      ** History Fee Rates                                                                    CLE071
059800230706     I            DS                                                                          CLE071
059900230706     I                                    P   1   45HIFRT1                                    CLE071
060000230706     I                                    P   5   85HIFRT2                                    CLE071
060100230706     I                                    P   9  125HIFRT3                                    CLE071
060200230706     I                                    P  13  165HIFRT4                                    CLE071
060300230706     I                                    P  17  205HIFRT5                                    CLE071
060400230706     I                                        1  20 HIFRTX                                    CLE071
060500230706      *                                                                                       CLE071
060600230706     I            DS                                                                          CLE071
060700230706     I                                    P   1  300HIAM                                      CLE071
060800230706     I                                        1  30 PVAMTX                                    CLE071
060900230706      *                                                                                       CLE071
061000230706     I            DS                                                                          CLE071
061100230706     I                                    P   1  205HIRT                                      CLE071
061200230706     I                                        1  20 PVFRTX                                    CLE071
061300230706      *                                                                                       CLE071
061400230706     ISPOOL1      DS
061500230706      ** File information data structure
061600230706     I                                       83  92 SFILE1
061700230706     I                                    B 123 1240SFNUM1
061800230706     I                                    B 367 3680LINE1
061900230706     ISPOOL2      DS
062000230706      ** File information data structure
062100230706     I                                       83  92 SFILE2
062200230706     I                                    B 123 1240SFNUM2
062300230706     I                                    B 367 3680LINE2
062400230706     ISPOOL3      DS
062500230706      ** File information data structure
062600230706     I                                       83  92 SFILE3
062700230706     I                                    B 123 1240SFNUM3
062800230706     I                                    B 367 3680LINE3
062900230706     ISPOOL4      DS
063000230706      ** File information data structure
063100230706     I                                       83  92 SFILE4
063200230706     I                                    B 123 1240SFNUM4
063300230706     I                                    B 367 3680LINE4
063400230706      *
063500230706     ISPOOLU      DS
063600230706      ** File information data structure
063700230706     I                                       83  92 SFILEU
063800230706     I                                    B 123 1240SFNUMU
063900230706     IPSDS       SDS
064000230706     I** Program Status
064100230706     I                                      244 253 JOB
064200230706     I                                      254 263 USER
064300230706     ILDA       E DSLDA
064400230706      * Database error handling
064500230706      *
064600230706     ILESTAT    E DSLESTAT
064700230706      **  Data Structure to obtain control date
064800230706     I              FLSETUP                         SETUP
064900230706     I              HSTPROC                         HIST
065000230706      *
065100230706     IRUNDAT    E DSRUNDAT
065200230706      ** Data area RUNDAT
065300230706     I              AGMBIN                          MBIN
065400230706      *
065500230706     ISDBANK    E DSSDBANKPD
065600230706      ** Bank details
065700230706      *
065800230706     ISDFEE     E DSSDFEEPD
065900230706      ** External DS for fee code details
066000230706     I*
066100230706     ISDCURR    E DSSDCURRPD
066200230706      ** Currency Type
066300230706     I*
066400230706     ISDFACT    E DSSDFACTPD
066500230706      ** Facility Type
066600230706     I*
066700230706     ISDLOAN    E DSSDLOANPD
066800230706      ** Loan Type Sub types
066900230706      *
067000230706     ISDBRCH    E DSSDBRCHPD
067100230706      ** External DS for branch name details
067200230706     I              A8BRNM                          BRNM
067300230706      *
067400230706     ISDCUST    E DSSDCUSTPD
067500230706     I              QQDFAC                          #DFAC1                                    CGL029
067600230706     I** External DS for customer details
067700230706      *
067800230706     I***SDGELR****E*DSSDGELRPD*                                   101322 138165
067900230706     I***General*Ledger*Details*                                   101322 138165
068000230706     I**************************                                   101322 138165
068100230706     IDSFDY     E DSDSFDY
068200230706      ** First DS for access programs, short data structure
068300230706      *
068400230706     IDSSDY     E DSDSSDY
068500230706      ** Second DS for access programs, long data structure
068600230706      *
068700230706     ISDCLND    E DSSDCLNDPD                                              085677
068800230706      **  EXTERNAL DS FOR CUSTOMER LENDING DETAILS                        085677
068900230706     I/COPY WNCPYSRC,LER180I001
069000230706      *                                                                   CLE005
069100230706     ISCSARD    E DSSCSARDPD                                              CLE005
069200230706      ** Switchable Features File                                         CLE005
069300230706      *                                                                   CLE005
069400230706     I***SDGELR*   E DSSDGELRPD                                                    MD035545 MD047993
069500230706     I**********    QQACCD                          ACCDQQ                         MD035545 MD047993
069600230706      ***General*ledger*details****************************************            MD035545 MD047993
069700230706      *                                                                                     MD035545
069800230706     I              'LECalcBasis6LeapYear'C         WPARML                                  MD035545
069900230706     I              'LoanCustOriginPurch' C         WPARM                                   MD055481
070000230706     I/COPY ZSRSRC,ZINTDYZ1                                               CLE013
070100230706     I/COPY ZSRSRC,ZDATE9Z2                                               CLE013
070200230706     I/COPY ZSRSRC,ZDAT10Z1                                               CLE013
070300230706     F*****************************************************************
070400230706      *
070500230706     C/EJECT
070600230706      *
070700230706     C                     MOVE *BLANK    WKPIND  1                                           CLE071
070800230706     C                     MOVE *BLANK    PVPIND  1                                           CLE071
070900230706     C  N01                Z-ADD0         @REP1   50
071000230706     C  N01                Z-ADD0         @REP2   50
071100230706     C  N01                EXSR INIT
071200230706     C                     READ LEFEEAC                  70
071300230706     C           *IN70     DOWEQ'0'
071400230706     C/COPY WNCPYSRC,LER180C002
071500230706     C*
071600230706     C           FEPYON    IFNE ' '                                       085914
071700230706     C*
071800230706     C***  Only show active fees and past due fees
071900230706     C*
072000230706     C           FEPSTD    IFLE CODT
072100230706     C           FEPEND    ANDGECODT
072200230706     C           FERECI    ANDEQ'D'
072300230706     C           FEPSTD    ORLE CODT
072400230706     C           FEPEND    ANDEQ0
072500230706     C           FERECI    ANDEQ'D'
072600230706     C           FEPEND    ORLT CODT
072700230706     C           FEAMTP    ANDGT0
072800230706      *
072900230706      ***Save*Current*Facility Details for SR WRFEAC                                   246309 249924
073000230706      **********                                                                       246309 249924
073100230706     C**********           Z-ADDFTYP      @VFAC   30                                   246309 249924
073200230706     C**********           Z-ADDFSEQ      @VSEQ   20                                   246309 249924
073300230706     C**********           Z-ADDFECNUM    @VCNUM  60                            246309 CPK028 249924
073400230706     C**********           MOVE FECNUM    @VCNUM  6                                    CPK028 249924
073500230706     C**********           MOVE FEFSEQ    @VFSEQ  20                                 MD026385 249924
073600230706     C**********           MOVE FEFCOD    @VFCOD  20                                 MD026385 249924
073700230706     C**********           MOVELFECALT    @VCALT  2                                  MD026385 249924
073800230706     C*
073900230706     C*** Do totalling if branch, currency, or facility type changed
074000230706     C*
074100230706     C           SVBRC     IFNE FEBRCA
074200230706     C           SVCCY     ORNE FEFCCY
074300230706     C           SVFAC     ORNE FTYP
074400230706     C                     EXSR CHANGE
074500230706     C                     END
074600230706     C/COPY WNCPYSRC,LER180C006
074700230706     C*
074800230706     C           FEFACL    CASNE*ZEROS    SRFACY           Facility Fees
074900230706     C                     CAS            SRLOAN           Loan Fees
075000230706     C                     END
075100230706     C                     MOVE BRCA      SVBRC   3
075200230706     C                     MOVE FEFCCY    SVCCY   3
075300230706     C**********           Z-ADDFECNUM    SVNUM   60                                          CSD027
075400230706     C                     MOVE FECNUM    SVNUM   6                                           CSD027
075500230706     C                     Z-ADDFEFCOD    SVCOD   20
075600230706     C                     Z-ADDFTYP      SVFAC   30
075700230706     C                     MOVE FELTYP    SVLTYP  2
075800230706     C                     MOVE FESUTP    SVSUTP  2
075900230706     C                     MOVE FECLAS    SVCLAS  4                                           CLE042
076000230706     C*
076100230706     C                     END
076200230706     C*
076300230706     C                     END                                            085914
076400230706     C*
076500230706     C                     READ LEFEEAC                  70
076600230706     C*
076700230706     C                     END
076800230706     C*
076900230706     C                     Z-ADD0         FTYP
077000230706     C                     MOVE *BLANKS   FEFCCY
077100230706     C                     MOVE *BLANKS   FEBRCA
077200230706     C                     EXSR CHANGE
077300230706     C                     EXSR AUDIT
077400230706     C                     SETON                     LR
077500230706     C                     RETRN
077600230706      /EJECT                                                                                  CSC042
077700230706     C********************************************************************                    CSC042
077800230706     C*                                                                                       CSC042
077900230706     C*  ##CHKC  - Check the currency details                                                 CSC042
078000230706     C*                                                                                       CSC042
078100230706     C********************************************************************                    CSC042
078200230706     C           ##CHKC    BEGSR                                                              CSC042
078300230706      *                                                                                       CSC042
078400230706     C           *LIKE     DEFN BJCYCD    ##KC                                                CSC042
078500230706     C           *LIKE     DEFN Q         ##QSV                                               CSC042
078600230706      *                                                                                       CSC042
078700230706      * Set off the currency found indicator                                                  CSC042
078800230706     C                     MOVEL*BLANK    ##FIC   1                                           CSC042
078900230706      *                                                                                       CSC042
079000230706      * Save the state of indicator 87 so it can be reset at the end                          CSC042
079100230706      * of the SR as it may be used elsewhere in the code                                     CSC042
079200230706     C           *IN87     IFEQ *ON                                                           CSC042
079300230706     C                     MOVEL'Y'       #IN87   1                                           CSC042
079400230706     C                     ELSE                                                               CSC042
079500230706     C                     MOVEL'N'       #IN87                                               CSC042
079600230706     C                     END                                                                CSC042
079700230706      *                                                                                       CSC042
079800230706     C                     SETOF                         87                                   CSC042
079900230706      *                                                                                       CSC042
080000230706      * Restore Q from ##QSV in case Q is used elsewhere in the code                          CSC042
080100230706     C                     Z-ADD##QSV     Q       40                                          CSC042
080200230706      *                                                                                       CSC042
080300230706      * Are we looking for the same details as the last time this                             CSC042
080400230706      * subroutine was called i.e. is Q already set correctly?                                CSC042
080500230706      * If so then use the data rather than do another LOKUP                                  CSC042
080600230706      * First make sure that we don't reference the 0th array element                         CSC042
080700230706     C           Q         IFEQ 0                                                             CSC042
080800230706     C                     Z-ADD1         Q                                                   CSC042
080900230706     C                     END                                                                CSC042
081000230706      * Now see if this search is same as last one performed                                  CSC042
081100230706      * If we have a match then seton 87 so the code after this                               CSC042
081200230706      * subroutine knows it can use Q directly                                                CSC042
081300230706     C           ##KC      IFEQ CURR,Q                                                        CSC042
081400230706     C                     SETON                         87                                   CSC042
081500230706     C                     ELSE                                                               CSC042
081600230706      * Otherwise hunt in the array and seton 87 if found                                     CSC042
081700230706     C                     Z-ADD1         Q                                                   CSC042
081800230706     C           ##KC      LOKUPCURR,Q                   87                                   CSC042
081900230706     C                     END                                                                CSC042
082000230706      *                                                                                       CSC042
082100230706      * Save Q for next time                                                                  CSC042
082200230706     C           *IN87     IFEQ *ON                                                           CSC042
082300230706     C                     Z-ADDQ         ##QSV                                               CSC042
082400230706      * Set the indicator to show the data was found                                          CSC042
082500230706     C                     MOVEL'Y'       ##FIC                                               CSC042
082600230706     C                     END                                                                CSC042
082700230706      *                                                                                       CSC042
082800230706      * Reset the state of indicator 87.                                                      CSC042
082900230706     C           #IN87     IFEQ 'Y'                                                           CSC042
083000230706     C                     MOVEL*ON       *IN87                                               CSC042
083100230706     C                     ELSE                                                               CSC042
083200230706     C                     MOVEL*OFF      *IN87                                               CSC042
083300230706     C                     END                                                                CSC042
083400230706      *                                                                                       CSC042
083500230706     C                     ENDSR                                                              CSC042
083600230706      *                                                                                       CSC042
083700230706     C********************************************************************                    CSC042
083800230706      /EJECT                                                                                  CSC042
083900230706     C********************************************************************                    CSC042
084000230706     C*                                                                                       CSC042
084100230706     C*  ##SETC  - Set up the currency details from array                                     CSC042
084200230706     C*                                                                                       CSC042
084300230706     C********************************************************************                    CSC042
084400230706      *                                                                                       CSC042
084500230706     C           ##SETC    BEGSR                                                              CSC042
084600230706      *                                                                                       CSC042
084700230706     C                     MOVE CURR,Q    A6CYCD                                              CSC042
084800230706     C                     MOVELCYNM,Q    A6CYNM                                              CSC042
084900230706     C                     MOVELMTDV,Q    A6MDIN                                              CSC042
085000230706     C                     Z-ADDCSPT,Q    A6SPRT                                              CSC042
085100230706     C                     Z-ADDCCDP,Q    A6NBDP                                              CSC042
085200230706     C                     Z-ADDCCNO,Q    A6SSNB                                              CSC042
085300230706      *                                                                                       CSC042
085400230706     C                     ENDSR                                                              CSC042
085500230706     C********************************************************************                    CSC042
085600230706      /EJECT
085700230706     C********************************************************************
085800230706     C*
085900230706     C*  INIT  --- Initialisation Subroutine
086000230706     C*
086100230706     C*  CALLED FROM: Main Processing
086200230706     C*
086300230706     C*  CALLS: Nothing
086400230706     C*
086500230706     C********************************************************************
086600230706     C           INIT      BEGSR
086700230706      *
086800230706     C**********           MOVEA*ALL'9'   ARAC,1                                       246309 249924
086900230706     C                     MOVEACPY@      BIS@   80
087000230706     C                     Z-ADD0         LINE1
087100230706     C                     Z-ADD0         LINE2
087200230706     C                     Z-ADD0         LINE3
087300230706     C                     Z-ADD0         LINE4
087400230706     C                     Z-ADD0         ##BNDX  40                                          CSC042
087500230706     C           *LIKE     DEFN ##BNDX    B                                                   CSC042
087600230706     C           *LIKE     DEFN ##BNDX    ##BSV                                               CSC042
087700230706      *                                                                                       CSC042
087800230706      *
087900230706      ** Define LDA
088000230706     C           *NAMVAR   DEFN           LDA
088100230706      *
088200230706      ** Lock in dataarea RUNDAT
088300230706     C           *NAMVAR   DEFN           RUNDAT
088400230706     C                     IN   RUNDAT
088500230706      *
088600230706     C                     SETON                     01
088700230706     C                     Z-ADD0         FEEAM0
088800230706     C                     Z-ADD0         FAMT0
088900230706      *
089000230706      ** Access bank details
089100230706     C                     CALL 'AOBANKR0'
089200230706     C                     PARM '*MSG   ' @RTCD   7
089300230706     C                     PARM '*FIRST ' @OPTN   7
089400230706     C           SDBANK    PARM SDBANK    DSFDY
089500230706      *
089600230706     C           @RTCD     IFNE *BLANKS
089700230706     C           *LOCK     IN   LDA
089800230706     C                     MOVEL'LER180'  DBPGM            *************
089900230706     C                     Z-ADD1         DBASE            * DBERR  01 *
090000230706     C                     MOVEL'*FIRST  'DBKEY            *************
090100230706     C                     MOVEL'SDBANKPD'DBFILE
090200230706     C                     SETON                     U7U8
090300230706     C                     OUT  LDA
090400230706     C                     EXSR AUDIT
090500230706     C                     EXSR *PSSR
090600230706     C                     END
090700230706     C*                                                                   085677
090800230706     C***  ACCESS CUSTOMER LENDING DATA                                   085677
090900230706     C*                                                                   085677
091000230706     C                     CALL 'AOCLNDR0'                                085677
091100230706     C                     PARM '*MSG   ' @RTCD                           085677
091200230706     C                     PARM '*FIRST ' @OPTN                           085677
091300230706     C********** SDCLND    PARM SDCLND    DSFDY                                        085677 CLE134
091400230706     C           SDCLND    PARM SDCLND    DSSDY                                               CLE134
091500230706     C           @RTCD     IFNE *BLANK                                    085677
091600230706     C           *LOCK     IN   LDA                                       085677
091700230706     C                     MOVEL'LER180'  DBPGM            *************  085677
091800230706     C                     Z-ADD5         DBASE            * DBERR  05 *  085677
091900230706     C                     MOVEL'SDCLNDPD'DBFILE           *************  085677
092000230706     C                     SETON                     U7U8                 085677
092100230706     C                     OUT  LDA                                       085677
092200230706     C                     EXSR AUDIT                                     085677
092300230706     C                     EXSR *PSSR                                     085677
092400230706     C                     END                                            085677
092500230706     C****************************************************         101322 138165
092600230706     C***Access*SDGELRPD*for*Accrue*on*Last*Day*indicator*         101322 138165
092700230706     C****************************************************         101322 138165
092800230706     C***********          CALL 'AOGELRR0'                         101322 138165
092900230706     C***********          PARM '*MSG   ' @RTCD   7                101322 138165
093000230706     C***********          PARM '*FIRST ' @OPTN   7                101322 138165
093100230706     C***********SDGELR    PARM SDGELR    DSFDY                    101322 138165
093200230706     C***********@RTCD     IFNE *BLANKS                            101322 138165
093300230706     C************LOCK     IN   LDA                                101322 138165
093400230706     C***********          MOVEL'*READ   'DBKEY                    101322 138165
093500230706     C***********          MOVEL'LER180'  DBPGM            ********101322 138165
093600230706     C***********          MOVEL'SDGELRPD'DBFILE           * DBERR 101322 138165
093700230706     C***********          Z-ADD23        DBASE            ********101322 138165
093800230706     C***********          SETON                     U7U8          101322 138165
093900230706     C***********          OUT  LDA                                101322 138165
094000230706     C***********          EXSR *PSSR                              101322 138165
094100230706     C***********          END                                     101322 138165
094200230706     C/COPY WNCPYSRC,LEH00725
094300230706      *                                                                   CLE005
094400230706      ** Check if CLE005 is switched *ON.                                 CLE005
094500230706      *                                                                   CLE005
094600230706     C                     MOVE 'N'       CLE005  1                       CLE005
094700230706     C                     CALL 'AOSARDR0'                                CLE005
094800230706     C                     PARM *BLANKS   @RTCD   7                       CLE005
094900230706     C                     PARM '*VERIFY' @OPTN   7                       CLE005
095000230706     C                     PARM 'CLE005'  @SARD   6                       CLE005
095100230706     C           SCSARD    PARM SCSARD    DSFDY                           CLE005
095200230706      *                                                                   CLE005
095300230706     C           @RTCD     IFEQ *BLANKS                                   CLE005
095400230706     C                     MOVE 'Y'       CLE005                          CLE005
095500230706     C                     END                                            CLE005
095600230706      *                                                                   CLE005
095700230706     C           @RTCD     IFNE *BLANKS                                   CLE005
095800230706     C           @RTCD     ANDNE'*NRF  '                                  CLE005
095900230706     C           *LOCK     IN   LDA                                       CLE005
096000230706     C                     MOVEL'CLE005'  DBKEY                           CLE005
096100230706     C                     MOVEL'LER180'  DBPGM            ************   CLE005
096200230706     C                     MOVEL'SCSARDPD'DBFILE           * DBERR 19 *   CLE005
096300230706     C                     Z-ADD19        DBASE            ************   CLE005
096400230706     C                     SETON                     U7U8                 CLE005
096500230706     C                     OUT  LDA                                       CLE005
096600230706     C                     EXSR *PSSR                                     CLE005
096700230706     C                     END                                            CLE005
096800230706      *                                                                                       193475
096900230706      ** Check if CLE006 is switched *ON.                                                     193475
097000230706      *                                                                                       193475
097100230706     C                     MOVE 'N'       CLE006  1                                           193475
097200230706     C                     CALL 'AOSARDR0'                                                    193475
097300230706     C                     PARM *BLANKS   @RTCD   7                                           193475
097400230706     C                     PARM '*VERIFY' @OPTN   7                                           193475
097500230706     C                     PARM 'CLE006'  @SARD   6                                           193475
097600230706     C           SCSARD    PARM SCSARD    DSFDY                                               193475
097700230706      *                                                                                       193475
097800230706     C           @RTCD     IFEQ *BLANKS                                                       193475
097900230706     C                     MOVE 'Y'       CLE006                                              193475
098000230706     C                     END                                                                193475
098100230706      *                                                                                       193475
098200230706     C           @RTCD     IFNE *BLANKS                                                       193475
098300230706     C           @RTCD     ANDNE'*NRF  '                                                      193475
098400230706     C           *LOCK     IN   LDA                                                           193475
098500230706     C                     MOVEL'CLE006'  DBKEY                                               193475
098600230706     C                     MOVEL'LER180'  DBPGM            ************                       193475
098700230706     C                     MOVEL'SCSARDPD'DBFILE           * DBERR 24 *                       193475
098800230706     C                     Z-ADD24        DBASE            ************                       193475
098900230706     C                     SETON                     U7U8                                     193475
099000230706     C                     OUT  LDA                                                           193475
099100230706     C                     EXSR *PSSR                                                         193475
099200230706     C                     END                                                                193475
099300230706      *                                                                                       CLE073
099400230706      ** Check if CLE073 is switched *ON.                                                     CLE073
099500230706      *                                                                                       CLE073
099600230706     C                     MOVE 'N'       CLE073  1                                           CLE073
099700230706     C                     CALL 'AOSARDR0'                                                    CLE073
099800230706     C                     PARM *BLANKS   WRTCD   7                                           CLE073
099900230706     C                     PARM '*VERIFY' WOPTN   7                                           CLE073
100000230706     C                     PARM 'CLE073'  WSARD   6                                           CLE073
100100230706     C           SCSARD    PARM SCSARD    DSFDY                                               CLE073
100200230706      *                                                                                       CLE073
100300230706     C           WRTCD     IFEQ *BLANKS                                                       CLE073
100400230706     C                     MOVE 'Y'       CLE073                                              CLE073
100500230706     C                     ENDIF                                                              CLE073
100600230706      *                                                                                       CLE134
100700230706      ** Check if CLE134 is switched *ON.                                                     CLE134
100800230706      *                                                                                       CLE134
100900230706     C                     MOVE 'N'       CLE134  1                                           CLE134
101000230706     C                     CALL 'AOSARDR0'                                                    CLE134
101100230706     C                     PARM *BLANKS   WRTCD   7                                           CLE134
101200230706     C                     PARM '*VERIFY' WOPTN   7                                           CLE134
101300230706     C                     PARM 'CLE134'  WSARD   6                                           CLE134
101400230706     C           SCSARD    PARM SCSARD    DSFDY                                               CLE134
101500230706      *                                                                                       CLE134
101600230706     C           WRTCD     IFEQ *BLANKS                                                       CLE134
101700230706     C                     MOVE 'Y'       CLE134                                              CLE134
101800230706     C                     ENDIF                                                              CLE134
101900230706      *                                                                                       CLE071
102000230706      ** Check if CLE071 is Switched *ON                                                      CLE071
102100230706      *                                                                                       CLE071
102200230706     C                     MOVE 'N'       CLE071  1                                           CLE071
102300230706     C                     CALL 'AOSARDR0'                                                    CLE071
102400230706     C                     PARM *BLANKS   WRTCD   7                                           CLE071
102500230706     C                     PARM '*VERIFY' WOPTN   7                                           CLE071
102600230706     C                     PARM 'CLE071'  WSARD   6                                           CLE071
102700230706     C           SCSARD    PARM SCSARD    DSFDY                                               CLE071
102800230706      *                                                                                       CLE071
102900230706     C           WRTCD     IFEQ *BLANKS                                                       CLE071
103000230706     C                     MOVE 'Y'       CLE071                                              CLE071
103100230706     C                     ENDIF                                                              CLE071
103200230706      *****************************************************************            MD035545 MD047993
103300230706      ***Access*general*ledger*details.********************************            MD035545 MD047993
103400230706      *****************************************************************            MD035545 MD047993
103500230706     C**********           CALL 'AOGELRR1'                                         MD035545 MD047993
103600230706     C**********           PARM '*DBERR ' WRTCD                                    MD035545 MD047993
103700230706     C**********           PARM '*FIRST ' WOPTN                                    MD035545 MD047993
103800230706     C********** SDGELR    PARM SDGELR    DSSDY                                    MD035545 MD047993
103900230706      *                                                                                     MD035545
104000230706      ** Retrieve system value setting.                                                     MD035545
104100230706      *                                                                                     MD035545
104200230706     C                     MOVELWPARML    P@OP01                                            MD035545
104300230706     C                     CALL 'AOSVALR0'                                                  MD035545
104400230706     C                     PARM *BLANKS   @RTCD                                             MD035545
104500230706     C                     PARM           P@OP01 20                                         MD035545
104600230706     C                     PARM           P@VL01200                                         MD035545
104700230706     C                     PARM           P@OP02 20                                         MD035545
104800230706     C                     PARM           P@VL02200                                         MD035545
104900230706     C                     PARM           P@OP03 20                                         MD035545
105000230706     C                     PARM           P@VL03200                                         MD035545
105100230706     C                     PARM           P@OP04 20                                         MD035545
105200230706     C                     PARM           P@VL04200                                         MD035545
105300230706     C                     PARM           P@OP05 20                                         MD035545
105400230706     C                     PARM           P@VL05200                                         MD035545
105500230706     C                     PARM           P@OP06 20                                         MD035545
105600230706     C                     PARM           P@VL06200                                         MD035545
105700230706     C                     PARM           P@OP07 20                                         MD035545
105800230706     C                     PARM           P@VL07200                                         MD035545
105900230706     C                     PARM           P@OP08 20                                         MD035545
106000230706     C                     PARM           P@VL08200                                         MD035545
106100230706     C                     PARM           P@OP09 20                                         MD035545
106200230706     C                     PARM           P@VL09200                                         MD035545
106300230706     C                     PARM           P@OP10 20                                         MD035545
106400230706     C                     PARM           P@VL10200                                         MD035545
106500230706      *                                                                                     MD035545
106600230706      ** If system value is not found then default value to 'N'.                            MD035545
106700230706      *                                                                                     MD035545
106800230706     C           @RTCD     IFNE '       '                                                   MD035545
106900230706     C                     MOVE 'N'       WCALC6                                            MD035545
107000230706     C                     ELSE                                                             MD035545
107100230706     C                     MOVELP@VL01    WCALC6                                            MD035545
107200230706     C********** WCALC6    IFEQ 'Y'                                                MD035545 MD047993
107300230706     C********** BKALDI    ANDEQ'Y'                                                MD035545 MD047993
107400230706     C**********           MOVE 'Y'       WCALC6                                   MD035545 MD047993
107500230706     C**********           ELSE                                                    MD035545 MD047993
107600230706     C**********           MOVE 'N'       WCALC6                                   MD035545 MD047993
107700230706     C**********           ENDIF                                                   MD035545 MD047993
107800230706     C                     ENDIF                                                            MD035545
107900230706      *                                                                                     MD055481
108000230706      ** Check System Value: Use Original Borrower or Purchased From?                       MD055481
108100230706      ** Set up parameter so access object checks LoanCustOriginPurch                       MD055481
108200230706      *                                                                                     MD055481
108300230706     C                     MOVELWPARM     SVALK1                                            MD055481
108400230706      *                                                                                     MD055481
108500230706     C                     CALL 'AOSVALR0'                                                  MD055481
108600230706     C                     PARM           RTNCDE  7                                         MD055481
108700230706     C                     PARM           SVALK1 20                                         MD055481
108800230706     C                     PARM           SVAL1 200                                         MD055481
108900230706     C                     PARM           SVALK2 20                                         MD055481
109000230706     C                     PARM           SVAL2 200                                         MD055481
109100230706     C                     PARM           SVALK3 20                                         MD055481
109200230706     C                     PARM           SVAL3 200                                         MD055481
109300230706     C                     PARM           SVALK4 20                                         MD055481
109400230706     C                     PARM           SVAL4 200                                         MD055481
109500230706     C                     PARM           SVALK5 20                                         MD055481
109600230706     C                     PARM           SVAL5 200                                         MD055481
109700230706     C                     PARM           SVALK6 20                                         MD055481
109800230706     C                     PARM           SVAL6 200                                         MD055481
109900230706     C                     PARM           SVALK7 20                                         MD055481
110000230706     C                     PARM           SVAL7 200                                         MD055481
110100230706     C                     PARM           SVALK8 20                                         MD055481
110200230706     C                     PARM           SVAL8 200                                         MD055481
110300230706     C                     PARM           SVALK9 20                                         MD055481
110400230706     C                     PARM           SVAL9 200                                         MD055481
110500230706     C                     PARM           SVALK0 20                                         MD055481
110600230706     C                     PARM           SVAL10200                                         MD055481
110700230706      *                                                                                     MD055481
110800230706      ** If the system value is not found then default value to 'P'                         MD055481
110900230706      *                                                                                     MD055481
111000230706     C           RTNCDE    IFNE *BLANKS                                                     MD055481
111100230706     C                     MOVE 'P'       PPCUST                                            MD055481
111200230706     C                     ELSE                                                             MD055481
111300230706      *                                                                                     MD055481
111400230706      ** Isolate the first character of SVAL1 which = 'P' or 'O'.                           MD055481
111500230706      *                                                                                     MD055481
111600230706     C                     MOVELSVAL1     PPCUST  1                                         MD055481
111700230706     C                     ENDIF                                                            MD055481
111800230706      *
111900230706      ***  Set up currency arrays
112000230706      *
112100230706     C                     Z-ADD0         X       30
112200230706     C                     OPEN SDCURRPD                                                      CSC042
112300230706     C                     READ SDCURRPD                 15
112400230706      *
112500230706     C           *IN15     DOWEQ'0'
112600230706      *
112700230706     C           X         IFLE 150
112800230706     C           X         ADD  1         X
112900230706     C                     MOVE A6CYCD    CURR,X
113000230706     C                     Z-ADDA6SPRT    CSPT,X
113100230706     C                     MOVELA6MDIN    MTDV,X
113200230706     C                     Z-ADDA6NBDP    CCDP,X
113300230706     C                     Z-ADDA6SSNB    CCNO,X
113400230706     C                     MOVELA6CYNM    CYNM,X                                              CSC042
113500230706     C                     END
113600230706      *
113700230706     C                     READ SDCURRPD                 15
113800230706      *
113900230706     C                     END
114000230706     C                     CLOSESDCURRPD                                                      CSC042
114100230706     C*
114200230706     C** Set up the control date for the report
114300230706     C*
114400230706      ** Define lending customer data area which holds control date
114500230706     C           *NAMVAR   DEFN           LESTAT
114600230706     C                     IN   LESTAT
114700230706     C*
114800230706      *
114900230706      ** Set Date Format Indicator *IN98  on if date format is MMDDYY
115000230706      *
115100230706     C           AGDFF     IFEQ 'M'
115200230706     C                     SETON                     98
115300230706     C                     END
115400230706     C           LKEYF     KLIST                                          052703
115500230706     C                     KFLD           LKBRCA  3                       052703
115600230706     C                     KFLD           LKCCY   3                       052703
115700230706     C                     KFLD           LKAKEY 10                       052703
115800230706     C*
115900230706     C***  Set up Report To date                                          BH3518
116000230706     C*                                                                   BH3518
116100230706     C           CODT      ADD  1         ZDAYNO                          BH3518
116200230706     C                     EXSR ZDATE2                                    BH3518
116300230706     C                     MOVE ZADATE    TODATE                          BH3518
116400230706     C*                                                                   BH3518
116500230706     C**********           Z-ADD99        STFSEQ  20                                          200289
116600230706     C**********           Z-ADD999       STFSEQ  30                                 200289 AR674226
116700230706     C                     Z-ADD9999      STFSEQ  40                                        AR674226
116800230706     C/COPY WNCPYSRC,LER180C001
116900230706     C                     Z-ADD0         WOPCT   63
117000230706     C                     Z-ADD0         WOAMT  130
117100230706     C                     Z-ADD0         WFPC    63
117200230706     C                     Z-ADD0         WFAM   130
117300230706     C                     Z-ADD0         WTOT   130
117400230706     C                     Z-ADD0         WRK63   63
117500230706     C                     Z-ADD0         WRK15  150
117600230706     C                     Z-ADD0         WRK153 153
117700230706     C                     Z-ADD0         WRK155 155
117800230706     C                     Z-ADD0         FCTOTA
117900230706     C                     Z-ADD0         FCTOTM
118000230706     C                     Z-ADD0         CFTOTA
118100230706     C                     Z-ADD0         CFTOTM
118200230706     C                     Z-ADD0         CLTOTA
118300230706     C                     Z-ADD0         CLTOTM
118400230706     C                     Z-ADD0         FATOA0                          BH3518
118500230706     C                     Z-ADD0         FATOM0                          BH3518
118600230706     C                     Z-ADD0         CATOA0                          BH3518
118700230706     C                     Z-ADD0         CATOM0                          BH3518
118800230706     C                     Z-ADD0         CXTOA0                          BH3518
118900230706     C                     Z-ADD0         CXTOM0                          BH3518
119000230706     C                     Z-ADD0         POSTD0
119100230706     C                     Z-ADD0         CALCD0
119200230706     C                     Z-ADD0         LAMT0
119300230706     C*
119400230706     C** Set up KLIST for accessing Facility file
119500230706     C*
119600230706     C           FACKEY    KLIST
119700230706     C**********           KFLD           FECNUM  60                                          CSD027
119800230706     C                     KFLD           FECNUM  6                                           CSD027
119900230706     C                     KFLD           FTYP    30
120000230706     C                     KFLD           FSEQ    20
120100230706      *
120200230706      ** Define key list for read of FACHSAL1 file - full key.
120300230706      *
120400230706     C           HSAKY1    KLIST
120500230706     C                     KFLD           FECNUM
120600230706     C                     KFLD           FEFACL
120700230706     C                     KFLD           STDATE
120800230706     C                     KFLD           STFSEQ
120900230706      *
121000230706      ** Define key list for read of FACHSAL1 file - partial key.
121100230706      *
121200230706     C           HSAKY2    KLIST
121300230706     C                     KFLD           FECNUM
121400230706     C                     KFLD           FEFACL
121500230706      *                                                                                       CLE071
121600230706      ** Define key list for read of LEFHSTLB file - partial key.                             CLE071
121700230706      *                                                                                       CLE071
121800230706     C           FEHKY1    KLIST                                                              CLE071
121900230706     C                     KFLD           FEBRCA                                              CLE071
122000230706     C                     KFLD           FECNUM                                              CLE071
122100230706     C                     KFLD           FEFACL                                              CLE071
122200230706     C                     KFLD           FELOAN                                              CLE071
122300230706     C                     KFLD           FEFSEQ                                              CLE071
122400230706      *                                                                                       CLE071
122500230706      ** Define key list for read of LEFHSTLB file - Full key.                                CLE071
122600230706      *                                                                                       CLE071
122700230706     C           FEHKY2    KLIST                                                              CLE071
122800230706     C                     KFLD           FEBRCA                                              CLE071
122900230706     C                     KFLD           FECNUM                                              CLE071
123000230706     C                     KFLD           FEFACL                                              CLE071
123100230706     C                     KFLD           FELOAN                                              CLE071
123200230706     C                     KFLD           FEFSEQ                                              CLE071
123300230706     C                     KFLD           STDATE                                              CLE071
123400230706      *                                                                                       CLE071
123500230706     C/COPY WNCPYSRC,LER180CCP2                                           S01408
123600230706      *
123700230706     C                     ENDSR
123800230706     C/EJECT
123900230706     C********************************************************************
124000230706     C*
124100230706     C*  SRFACY -- Facility Fee Processing & reporting
124200230706     C*
124300230706     C*  CALLED FROM: Main Processing
124400230706     C*
124500230706     C*  CALLS: AVCALC
124600230706     C*
124700230706     C********************************************************************
124800230706     C           SRFACY    BEGSR
124900230706     C                     ADD  1         @REP1
125000230706     C*                                                                   S01408
125100230706     C/COPY WNCPYSRC,LER180CCPG                                           S01408
125200230706     C*                                                                   S01408
125300230706      *                                                                   CLE005
125400230706      ** Set off 'Fee Payable/Fee Receivable' print indicators.           CLE005
125500230706      *                                                                   CLE005
125600230706     C                     SETOF                     505152               CLE005
125700230706     C                     MOVE '0'       *IN53   1                       156582
125800230706     C*
125900230706     C** Chain to the facility file for the facility amount
126000230706     C*
126100230706     C           FACKEY    CHAINFCLTY                71
126200230706     C           *IN71     IFEQ '0'
126300230706     C                     Z-ADDFAMT      FAMT0
126400230706     C*
126500230706     C**********           CALL 'AOCURRR0'             99                                     CSC042
126600230706     C**********           PARM '*MSG    '@RTCD                                               CSC042
126700230706     C**********           PARM '*KEY    '@OPTN                                               CSC042
126800230706     C**********           PARM FCCY      CURKEY  3                                           CSC042
126900230706     C********** SDCURR    PARM SDCURR    DSSDY                                               CSC042
127000230706      *
127100230706     C********** @RTCD     IFNE *BLANKS                                                       CSC042
127200230706     C                     MOVELFCCY      ##KC                                                CSC042
127300230706     C                     EXSR ##CHKC                                                        CSC042
127400230706     C           ##FIC     IFEQ 'Y'                                                           CSC042
127500230706     C                     EXSR ##SETC                                                        CSC042
127600230706     C                     ELSE                                                               CSC042
127700230706     C           *LOCK     IN   LDA                        ***************
127800230706     C                     MOVELFCCY      DBKEY            *  DBERR 02   *
127900230706     C                     Z-ADD2         DBASE            ***************
128000230706     C                     MOVEL'LER180  'DBPGM                        ***
128100230706     C**********           MOVEL'SDCURRPD'DBFILE                                              CSC042
128200230706     C                     MOVEL'CURR,Q  'DBFILE                                              CSC042
128300230706     C                     SETON                     U7U8
128400230706     C                     OUT  LDA
128500230706     C                     EXSR AUDIT
128600230706     C                     EXSR *PSSR
128700230706     C                     END                             ** E001
128800230706      *
128900230706     C           A6NBDP    COMP 1                    363435
129000230706     C   36      A6NBDP    COMP 3                      3637
129100230706     C*
129200230706     C                     ELSE
129300230706     C* Database error processing
129400230706     C           *LOCK     IN   LDA                         ************
129500230706     C                     MOVELFECNUM    DBKEY             * DBERR 03 *
129600230706     C                     MOVE FACNO     DBKEY             ************
129700230706     C                     Z-ADD3         DBASE
129800230706     C                     MOVEL'LER180  'DBPGM
129900230706     C                     MOVEL'FCLTY   'DBFILE
130000230706     C                     SETON                     U7U8
130100230706     C                     OUT  LDA
130200230706     C                     EXSR AUDIT
130300230706     C                     EXSR *PSSR
130400230706     C                     END
130500230706     C*
130600230706     C***  Set up 'From' date
130700230706     C*
130800230706     C***********FELPDT    IFLT CODT                               052703 138421
130900230706     C           FELPDT    IFLE CODT                                      138421
131000230706     C/COPY WNCPYSRC,LER180C003
131100230706     C                     Z-ADDFELPDT    ZDAYNO
131200230706     C                     ELSE                                           052703
131300230706     C                     Z-ADDFEPLPD    ZDAYNO                          052703
131400230706     C                     END                                            052703
131500230706     C           ZDAYNO    IFEQ 0
131600230706     C                     Z-ADDFEPSTD    ZDAYNO
131700230706     C                     END
131800230706     C                     EXSR ZDATE2
131900230706     C                     MOVE ZADATE    FRDATE
132000230706     C*
132100230706     C                     SETOF                     1112
132200230706     C                     MOVE '0'       *IN16                           100657
132300230706     C                     Z-ADD0         FERATE
132400230706     C*
132500230706     C** Set up the fee amounts for reporting for the record just read
132600230706     C*
132700230706     C           FECALT    IFEQ '  '
132800230706     C*
132900230706     C** These are flat fees and should show the amount amortized/
133000230706     C** accrued to date and left to accrue
133100230706     C                     Z-ADDFEFAMT    FEEAM0
133200230706     C                     Z-ADDFEADAT    CALCD0
133300230706     C***********          ADD  FEAMTP    CALCD0                          085915
133400230706     C*                                                                   BH3518
133500230706     C***  Nothing goes in Accrued column if Bullet fee                   BH3518
133600230706     C*                                                                   BH3518
133700230706     C           FEPYON    IFEQ ' '                                       BH3518
133800230706     C                     Z-ADD0         POSTD0                          BH3518
133900230706     C                     ELSE                                           BH3518
134000230706     C                     Z-ADDFEADAT    POSTD0
134100230706     C***********          ADD  FEAMTP    POSTD0                          085915
134200230706     C                     END                                            BH3518
134300230706     C*
134400230706     C** Calculated fees wil be reported according to their calculation
134500230706     C** method
134600230706     C*
134700230706     C                     ELSE
134800230706     C***********FECALT    IFEQ '01'                                      100657
134900230706     C***********FECALT    OREQ '04'                                      100657
135000230706     C***********FECALT    OREQ '11'                                      100657
135100230706     C***********FECALT    OREQ '14'                                      100657
135200230706     C***********          MOVELNARR,1    FECOMT  9                       100657
135300230706     C***********          ELSE                                           100657
135400230706      ***********                                                         100657
135500230706     C***********FECALT    IFEQ '02'                                      100657
135600230706     C***********FECALT    OREQ '05'                                      100657
135700230706     C***********FECALT    OREQ '12'                                      100657
135800230706     C***********FECALT    OREQ '15'                                      100657
135900230706     C***********          MOVELNARR,2    FECOMT                          100657
136000230706     C***********          ELSE                                           100657
136100230706     C***********          MOVELNARR,3    FECOMT                          100657
136200230706     C***********          Z-ADDFEFRT1    FERATE                          100657
136300230706     C***********          SETON                     11                   100657
136400230706     C***********          END                                            100657
136500230706     C***********                                                         100657
136600230706     C***********          END                                            100657
136700230706     C*                                                                   100657
136800230706     C** Use new narrative for the calculated fee according to their      100657
136900230706     C** calculation type.                                                100657
137000230706     C*                                                                   100657
137100230706     C           FECALT    IFEQ '01'                                      100657
137200230706     C                     MOVELNARR,4    FECOMT 10                       100657
137300230706     C                     END                                            100657
137400230706     C           FECALT    IFEQ '02'                                      100657
137500230706     C                     MOVELNARR,5    FECOMT                          100657
137600230706     C                     END                                            100657
137700230706     C           FECALT    IFEQ '03'                                      100657
137800230706     C                     MOVELNARR,6    FECOMT                          100657
137900230706     C                     END                                            100657
138000230706     C           FECALT    IFEQ '04'                                      100657
138100230706     C                     MOVELNARR,7    FECOMT                          100657
138200230706     C                     END                                            100657
138300230706     C           FECALT    IFEQ '05'                                      100657
138400230706     C                     MOVELNARR,8    FECOMT                          100657
138500230706     C                     END                                            100657
138600230706     C           FECALT    IFEQ '06'                                      100657
138700230706     C                     MOVELNARR,9    FECOMT                          100657
138800230706     C                     END                                            100657
138900230706     C           FECALT    IFEQ '11'                                      100657
139000230706     C                     MOVELNARR,10   FECOMT                          100657
139100230706     C                     END                                            100657
139200230706     C           FECALT    IFEQ '12'                                      100657
139300230706     C                     MOVELNARR,11   FECOMT                          100657
139400230706     C                     END                                            100657
139500230706     C           FECALT    IFEQ '13'                                      100657
139600230706     C                     MOVELNARR,12   FECOMT                          100657
139700230706     C                     END                                            100657
139800230706     C           FECALT    IFEQ '14'                                      100657
139900230706     C                     MOVELNARR,13   FECOMT                          100657
140000230706     C                     END                                            100657
140100230706     C           FECALT    IFEQ '15'                                      100657
140200230706     C                     MOVELNARR,14   FECOMT                          100657
140300230706     C                     END                                            100657
140400230706     C           FECALT    IFEQ '16'                                      100657
140500230706     C                     MOVELNARR,15   FECOMT                          100657
140600230706     C                     END                                            100657
140700230706     C           FECALT    IFEQ '21'                                      100657
140800230706     C                     MOVELNARR,16   FECOMT                          100657
140900230706     C                     END                                            100657
141000230706     C           FECALT    IFEQ '22'                                      100657
141100230706     C                     MOVELNARR,17   FECOMT                          100657
141200230706     C                     END                                            100657
141300230706     C           FECALT    IFEQ '03'                                      100657
141400230706     C           FECALT    OREQ '06'                                      100657
141500230706     C           FECALT    OREQ '13'                                      100657
141600230706     C           FECALT    OREQ '16'                                      100657
141700230706     C           FECALT    OREQ '21'                                      100657
141800230706     C           FECALT    OREQ '22'                                      100657
141900230706     C                     Z-ADDFEFRT1    FERATE                          100657
142000230706     C                     MOVE '1'       *IN11                           100657
142100230706     C                     END                                            100657
142200230706     C*
142300230706     C                     SETON                     12
142400230706     C                     Z-ADD0         FEEAM0
142500230706     C*
142600230706     C** Calculate the fee amount to be reported for fees based on
142700230706     C** actual amounts
142800230706     C*
142900230706     C           FECALT    IFEQ '04'
143000230706     C           FECALT    OREQ '05'
143100230706     C           FECALT    OREQ '06'
143200230706     C           FECALT    OREQ '14'
143300230706     C           FECALT    OREQ '15'
143400230706     C           FECALT    OREQ '16'
143500230706     C           FECALT    OREQ '22'
143600230706     C***********          Z-ADDFEADAT    CALCD0                          052703
143700230706     C***********          ADD  FELPAM    CALCD0                          052703
143800230706     C***********          ADD  FEAMTP    CALCD0                          052703
143900230706     C***********          Z-ADDFEADAT    POSTD0                          052703
144000230706     C***********          ADD  FELPAM    POSTD0                          052703
144100230706     C***********          ADD  FEAMTP    POSTD0                          052703
144200230706     C***********FELPDT    IFGE CODT                               052703 100658
144300230706     C***********          MOVE 'A'       AKY,4                    052703 100658
144400230706     C***********          MOVEAWFTYP     AKY,1                    052703 100658
144500230706     C***********          MOVEAWFCOD     AKY,8                    052703 100658
144600230706     C***********          MOVE 'F'       AKY,10                   052703 100658
144700230706     C***********          MOVEA'   '     AKY,5                    052703 100658
144800230706     C***********          MOVE ' '       AKY,6                    052703 100658
144900230706      ***********                                                  052703 100658
145000230706     C***********          MOVE FEBRCA    LKBRCA                   052703 100658
145100230706     C***********          MOVE FEFCCY    LKCCY                    052703 100658
145200230706     C***********          MOVEAAKY       LKAKEY                   052703 100658
145300230706     C***********LKEYF     CHAINFEEKEY               99            052703 100658
145400230706     C***********          Z-ADDLKADAT    CALCD0                   052703 100658
145500230706     C***********          Z-ADDLKADAT    POSTD0                   052703 100658
145600230706     C***********          ELSE                                    052703 100658
145700230706     C                     Z-ADDFEADAT    CALCD0                          052703
145800230706     C                     ADD  FELPAM    CALCD0                          052703
145900230706     C                     ADD  FEAMTP    CALCD0                          052703
146000230706     C           FELPDT    IFGT CODT                                      103019
146100230706     C                     Z-ADDFEADBP    CALCD0                          103019
146200230706     C                     ADD  FEPAMP    CALCD0                          103019
146300230706     C                     END                                            103019
146400230706     C                     Z-ADDFEADAT    POSTD0                          052703
146500230706      ** If Fee is a payment then subtract fee amount                     140840
146600230706     C           *IN50     IFEQ *ON                                       140840
146700230706     C                     SUB  FELPAM    POSTD0                          140840
146800230706     C                     SUB  FEAMTP    POSTD0                          140840
146900230706     C                     ELSE                                           140840
147000230706     C                     ADD  FELPAM    POSTD0                          052703
147100230706     C/COPY WNCPYSRC,LER180C004
147200230706     C***********          ADD  FEAMTP    POSTD0                   052703 138421
147201230706     C                     ADD  FEAMTP    POSTD0                                              263718
147300230706     C                     ENDIF                                          140840
147400230706     C/COPY WNCPYSRC,LER180C005
147500230706     C           FELPDT    IFGT CODT                                      103019
147600230706     C                     Z-ADDFEADBP    POSTD0                          103019
147700230706      ** If Fee is a payment then subtract fee amount                     140840
147800230706     C           *IN50     IFEQ *ON                                       140840
147900230706     C                     SUB  FEPAMP    POSTD0                          140840
148000230706     C                     ELSE                                           140840
148100230706     C***********          ADD  FEPAMP    POSTD0                   103019 138421
148101230706     C                     ADD  FEPAMP    POSTD0                                              263718
148200230706     C                     ENDIF                                          140840
148300230706     C                     END                                            103019
148400230706     C***********          END                                     052703 100658
148500230706     C***********                                                  052703 100658
148600230706     C/COPY WNCPYSRC,LER180CCP3                                           S01408
148700230706     C                     ELSE
148800230706     C*
148900230706     C** For calculated fees based on averages need to calculate
149000230706     C** what the value would be if today was payment date
149100230706     C*
149200230706     C                     MOVE '1'       *IN16                           100657
149300230706     C                     EXSR SETP                                      085309
149400230706     C                     EXSR AVCALC
149500230706     C                     Z-ADDWFEE      CALCD0
149600230706     C                     ADD  FELPAM    CALCD0                          CLE005
149700230706     C           FELPDT    IFGT CODT                                      100658
149800230706     C           FELPDT    OREQ CODT                                      100658
149900230706     C           FEAUTO    ANDEQ'N'                                       100658
150000230706     C                     ADD  FEPAMP    CALCD0                          100658
150100230706     C                     ELSE                                           100658
150200230706     C                     ADD  FEAMTP    CALCD0
150300230706     C                     END                                            100658
150400230706     C                     Z-ADDFEADAT    POSTD0
150500230706      ** If Fee is a payment then subtract fee amount                     140840
150600230706     C           *IN50     IFEQ *ON                                       140840
150700230706     C                     SUB  FELPAM    POSTD0                          140840
150800230706     C                     ELSE                                           140840
150900230706     C                     ADD  FELPAM    POSTD0
151000230706     C                     ENDIF                                          140840
151100230706     C           FELPDT    IFGT CODT                                      100658
151200230706     C           FELPDT    OREQ CODT                                      100658
151300230706     C           FEAUTO    ANDEQ'N'                                       100658
151400230706      ** If Fee is a payment then subtract fee amount                     140840
151500230706     C           *IN50     IFEQ *ON                                       140840
151600230706     C                     SUB  FEPAMP    POSTD0                          140840
151700230706     C                     ELSE                                           140840
151800230706     C***********          ADD  FEPAMP    POSTD0                   100658 138421
151801230706     C                     ADD  FEPAMP    POSTD0                                              263718
151900230706     C                     ENDIF                                          140840
152000230706     C                     ELSE                                           100658
152100230706      ** If Fee is a payment then subtract fee amount                     140840
152200230706     C           *IN50     IFEQ *ON                                       140840
152300230706     C                     SUB  FEAMTP    POSTD0                          140840
152400230706     C                     ELSE                                           140840
152500230706     C***********          ADD  FEAMTP    POSTD0                          138421
152501230706     C                     ADD  FEAMTP    POSTD0                                              263718
152600230706     C                     ENDIF                                          140840
152700230706     C                     END                                            100658
152800230706     C                     END
152900230706     C                     END
153000230706      *                                                                   156582
153100230706      ** Participation Sold Fee Accruals should be negated and            156582
153200230706      ** subtracted from the total                                        156582
153300230706      *                                                                   156582
153400230706     C                     SELEC                                          156582
153500230706     C           PTFI      WHEQ 'P'                                       156582
153600230706     C           PTFI      OREQ 'S'                                                           CLE106
153700230706     C           PTFI      OREQ 'R'                                                           CLE106
153800230706     C                     Z-SUBPOSTD0    POSTD0                          156582
153900230706     C           PTFI      WHEQ 'I'                                       156582
154000230706     C                     MOVE '1'       *IN53                           156582
154100230706     C                     ENDSL                                          156582
154200230706      *
154300230706     C           SVBRC     IFNE FEBRCA
154400230706     C                     MOVELFEBRCA    ##KB                                                CSC042
154500230706     C                     EXSR ##CHKB                                                        CSC042
154600230706      * If branch is in the array then use the details                                        CSC042
154700230706     C           ##FIC     IFEQ 'Y'                        *** B10                            CSC042
154800230706     C                     EXSR ##SETB                                                        CSC042
154900230706     C                     ELSE                            *** X10                            CSC042
155000230706     C**********           CALL 'AOBRCHR0'             99                                     CGL029
155100230706     C                     CALL 'AOBRCHR1'             99                                     CGL029
155200230706     C                     PARM '*BLANKS' @RTCD
155300230706     C                     PARM '*KEY   ' @OPTN
155400230706     C                     PARM FEBRCA    @DSNB   3
155500230706     C********** SDBRCH    PARM SDBRCH    DSFDY                                               CGL029
155600230706     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
155700230706      *
155800230706     C           @RTCD     IFNE *BLANKS
155900230706     C           *LOCK     IN   LDA                                    *
156000230706     C                     MOVEL'LER180'  DBPGM             *************
156100230706     C                     MOVELFEBRCA    DBKEY             * DBERR 04 *
156200230706     C                     Z-ADD4         DBASE             ************
156300230706     C                     MOVEL'SDBRCHPD'DBFILE
156400230706     C                     SETON                     U7U8
156500230706     C                     OUT  LDA
156600230706     C                     EXSR AUDIT
156700230706     C                     EXSR *PSSR
156800230706     C                     ELSE                                                               CSC042
156900230706      * Details found on the DB so add them to the array                                      CSC042
157000230706      * if the array still has room                                                           CSC042
157100230706     C                     EXSR ##ADDB                                                        CSC042
157200230706     C                     END
157300230706     C                     END                             *** E10                            CSC042
157400230706     C                     END
157500230706     C*
157600230706     C** Access the facility type table to get narrative for next
157700230706     C** facility type
157800230706     C*
157900230706     C           SVFAC     IFNE FTYP
158000230706     C           SVBRC     ORNE FEBRCA
158100230706     C           SVCCY     ORNE FEFCCY
158200230706     C*
158300230706     C                     CALL 'AOFACTR0'             99
158400230706     C                     PARM '*MSG   ' @RTCD
158500230706     C                     PARM '*KEY   ' @OPTN
158600230706     C                     PARM           FTYP
158700230706     C**********           PARM           FECLAS                                     CLE138 MD060092
158800230706     C           SDFACT    PARM SDFACT    DSFDY
158900230706     C           @RTCD     IFNE *BLANKS                    B1
159000230706     C********** *LOCK     IN   LDA                         ************  BH3518
159100230706     C**********           MOVELFTYP      DBKEY             * DBERR 05 *  BH3518
159200230706     C**********           Z-ADD5         DBASE             ************  BH3518
159300230706     C**********           MOVEL'LER180  'DBPGM                           BH3518
159400230706     C**********           MOVEL'SDFACTPD'DBFILE                          BH3518
159500230706     C**********           SETON                     U7U8                 BH3518
159600230706     C**********           OUT  LDA                                       BH3518
159700230706     C**********           EXSR AUDIT                                     BH3518
159800230706     C**********           EXSR *PSSR                                     BH3518
159900230706     C*                                                                   BH3518
160000230706     C                     MOVE *ALL'*'   WFCNMO                          BH3518
160100230706     C                     MOVELFTYP      WFCNMO                          BH3518
160200230706     C                     ELSE                                           BH3518
160300230706     C                     MOVELAMFCNM    WFCNMO                          BH3518
160400230706     C                     END                             E1
160500230706     C                     END
160600230706     C*
160700230706     C                     EXSR SETP                                      085309
160800230706     C***********                                                         085309
160900230706     C***Check*the currency decimal places and name for the new ccy       085309
161000230706     C***********                                                         085309
161100230706     C***********SVCCY     IFNE FEFCCY                                    085309
161200230706     C***********SVBRC     ORNE FEBRCA                                    085309
161300230706     C***********                                                         085309
161400230706     C***********          CALL 'AOCURRR0'             99                 085309
161500230706     C***********          PARM '*MSG    '@RTCD                           085309
161600230706     C***********          PARM '*KEY    '@OPTN                           085309
161700230706     C***********          PARM FEFCCY    CURKEY  3                       085309
161800230706     C***********SDCURR    PARM SDCURR    DSSDY                           085309
161900230706      ***********                                                         085309
162000230706     C***********@RTCD     IFNE *BLANKS                                   085309
162100230706     C************LOCK     IN   LDA                        ***************085309
162200230706     C***********          MOVELFEFCCY    DBKEY            *  DBERR 06   *085309
162300230706     C***********          Z-ADD6         DBASE            ***************085309
162400230706     C***********          MOVEL'SDCURRPD'DBFILE                          085309
162500230706     C***********          MOVE 'LER180  'DBPGM                           085309
162600230706     C***********          SETON                     U7U8                 085309
162700230706     C***********          OUT  LDA                                       085309
162800230706     C***********          EXSR AUDIT                                     085309
162900230706     C***********          EXSR *PSSR                                     085309
163000230706     C***********          END                             ** E001        085309
163100230706      ***********                                                         085309
163200230706     C***********A6NBDP    COMP 1                    323031               085309
163300230706     C***32******A6NBDP    COMP 3                      3233               085309
163400230706     C***********          Z-ADDA6NBDP    DP      20                      085309
163500230706     C***********DP        ADD  4         P       10                      085309
163600230706     C***********                                                         085309
163700230706     C***********          END                                            085309
163800230706     C*
163900230706     C** Add the current fee amount into the currency running total and
164000230706     C** into the facility running total
164100230706     C*
164200230706     C           FEPYON    IFEQ 'N'
164300230706     C           FEPYON    OREQ 'E'
164400230706     C                     ADD  CALCD0    FCTOTA
164500230706     C                     ADD  CALCD0    CFTOTA
164600230706     C           PTFI      IFNE 'I'                                       156582
164700230706     C                     ADD  POSTD0    FATOA0                          BH3518
164800230706     C                     ADD  POSTD0    CATOA0                          BH3518
164900230706     C                     ENDIF                                          156582
165000230706     C                     ELSE
165100230706     C                     ADD  CALCD0    FCTOTM
165200230706     C                     ADD  CALCD0    CFTOTM
165300230706     C           PTFI      IFNE 'I'                                       156582
165400230706     C                     ADD  POSTD0    FATOM0                          BH3518
165500230706     C                     ADD  POSTD0    CATOM0                          BH3518
165600230706     C                     ENDIF                                          156582
165700230706     C                     END
165800230706      *
165900230706     C           SVNUM     IFNE FECNUM
166000230706     C                     MOVE FECNUM    @BBA    6
166100230706     C                     MOVELFECNUM    KEYC   10
166200230706      *
166300230706     C                     CALL 'AOCUSTR0'
166400230706     C                     PARM '*MSG   ' @RTCD
166500230706     C                     PARM '*KEY   ' @OPTN
166600230706     C                     PARM           KEYC
166700230706     C                     PARM           KEYSTS  7
166800230706     C           SDCUST    PARM SDCUST    DSSDY
166900230706      *
167000230706     C           @RTCD     IFNE *BLANKS                    B2
167100230706     C           @RTCD     ANDNE'*CUSCLS'                                                   MD050457
167200230706     C           *LOCK     IN   LDA                         ************
167300230706     C                     MOVELFECNUM    DBKEY             * DBERR 07 *
167400230706     C                     Z-ADD7         DBASE             ************
167500230706     C                     MOVEL'LER180  'DBPGM
167600230706     C                     MOVEL'SDCUSTPD'DBFILE
167700230706     C                     SETON                     U7U8
167800230706     C                     OUT  LDA
167900230706     C                     EXSR AUDIT
168000230706     C                     EXSR *PSSR
168100230706     C                     END                             E2
168200230706      *
168300230706     C                     END                             E1
168400230706     C*
168500230706     C** If the new fee code is different from the last get the new
168600230706     C** fee narrative
168700230706     C*
168800230706     C           SVCOD     IFNE FEFCOD
168900230706     C**********           MOVE FEFCOD    AUFECD           Name of        BHBC01
169000230706     C                     Z-ADDFEFCOD    WKFCOD                          BHBC01
169100230706     C                     CALL 'AOFEER0'              99
169200230706     C                     PARM '*MSG   ' @RTCD
169300230706     C                     PARM '*KEY   ' @OPTN
169400230706     C**********           PARM AUFECD    FKEY    2                       BHBC01
169500230706     C                     PARM WKFCOA    FKEY    2                       BHBC01
169600230706     C           SDFEE     PARM SDFEE     DSFDY
169700230706      *
169800230706     C           @RTCD     IFNE *BLANKS                    B1
169900230706     C                     MOVE *ALL'*'   AUFENV
170000230706     C********** *LOCK     IN   LDA                         ************  BHBC01
170100230706     C**********           MOVELFEFCOD    DBKEY             * DBERR 08 *  BHBC01
170200230706     C**********           Z-ADD8         DBASE             ************  BHBC01
170300230706     C**********           MOVEL'LER180  'DBPGM                           BHBC01
170400230706     C**********           MOVEL'SDFEEPD 'DBFILE                          BHBC01
170500230706     C**********           SETON                     U7U8                 BHBC01
170600230706     C**********           OUT  LDA                                       BHBC01
170700230706     C**********           EXSR AUDIT                                     BHBC01
170800230706     C**********           EXSR *PSSR                                     BHBC01
170900230706     C                     END                             E1
171000230706     C                     END
171100230706      *
171200230706      ***  Force page change
171300230706      *
171400230706     C********** LINE1     IFGE 57
171500230706     C**********           SETON                     80
171600230706     C**********           END
171700230706     C*
171800230706     C********** LINE3     IFGE 57
171900230706     C**********           SETON                     82
172000230706     C**********           END
172100230706      *                                                                   CLE005
172200230706      ***If*Switchable*feature*CLE005*is*on,*Set*On*corresponding*Ind.*                CLE005 193475
172300230706      ** If Switchable feature CLE006 is ON, set ON corresponding Ind.                        193475
172400230706      ** to print the 'Fee Payable/Fee Receivable' Indicator              CLE005
172500230706      *                                                                   CLE005
172600230706     C********** CLE005    IFEQ 'Y'                                                    CLE005 193475
172700230706     C           CLE006    IFEQ 'Y'                                                           193475
172800230706      *                                                                   CLE005
172900230706     C                     SELEC                                          CLE005
173000230706     C           PTFI      WHEQ 'P'                                       CLE005
173100230706     C           PTFI      OREQ 'S'                                                           CLE106
173200230706     C           PTFI      OREQ 'R'                                                           CLE106
173300230706     C                     SETON                     50                   CLE005
173400230706     C           PTFI      WHEQ 'I'                                       CLE005
173500230706     C                     SETON                     51                   CLE005
173600230706     C           PTFI      WHEQ ' '                                       CLE005
173700230706     C                     SETON                     52                   CLE005
173800230706     C                     ENDSL                                          CLE005
173900230706      *                                                                   CLE005
174000230706     C                     ENDIF                                          CLE005
174100230706      *                                                                                246309 249924
174200230706      ***Save*Details*of Fee Accruals and Past Due for Resorting                       246309 249924
174300230706      **********                                                                       246309 249924
174400230706     C********** FEPYON    IFEQ 'N'                                                    246309 249924
174500230706     C**********           CLEARDSFEAC                                                 246309 249924
174600230706     C**********           ADD  1         T       20                          246309 AR894146 249924
174700230706     C**********           ADD  1         T       40                                 AR894146 249924
174800230706     C**********           MOVELFEFACL    DFACL                                        246309 249924
174900230706     C**********           MOVELFEFSEQ    DFESEQ                                       246309 249924
175000230706     C**********           MOVELFCCY      DFCCY                                        246309 249924
175100230706     C**********           MOVELFRDATE    DRDATE                                       246309 249924
175200230706     C**********           MOVELFECALT    DECALT                                       246309 249924
175300230706     C**********           MOVELFERATE    DERATE                                       246309 249924
175400230706     C**********           MOVELFECOMT    DECOMT                                       246309 249924
175500230706     C**********           MOVELFECNUM    DCNUM                                        246309 249924
175600230706     C**********           MOVELBBCRNM    DBCRNM                                       246309 249924
175700230706     C**********           MOVELBBCRTN    DBCRTN                                       246309 249924
175800230706     C**********           MOVELFEFCOD    DFCOD                                        246309 249924
175900230706      **********                                                                       246309 249924
176000230706     C********** CALCD0    IFEQ 0                                                      246309 249924
176100230706     C********** CALCD1    OREQ 0                                                      246309 249924
176200230706     C********** CALCD2    OREQ 0                                                      246309 249924
176300230706     C********** CALCD3    OREQ 0                                                      246309 249924
176400230706     C**********           MOVEL'A'       DVAMT                                        246309 249924
176500230706     C**********           ELSE                                                        246309 249924
176600230706     C**********           MOVEL'B'       DVAMT                                        246309 249924
176700230706     C**********           ENDIF                                                       246309 249924
176800230706      **Amounts*                                                                       246309 249924
176900230706     C********** *IN30     IFEQ '1'                                                    246309 249924
177000230706     C**********           MOVELFAMT0     DFAMTS                                       246309 249924
177100230706     C**********           MOVELFEEAM0    DFEEAM                                       246309 249924
177200230706     C**********           MOVELCALCD0    DCALCD                                       246309 249924
177300230706     C**********           MOVELPOSTD0    DPOSTD                                       246309 249924
177400230706     C**********           MOVEL'1'       DIN30                                        246309 249924
177500230706     C**********           ENDIF                                                       246309 249924
177600230706     C********** *IN31     IFEQ '1'                                                    246309 249924
177700230706     C**********           MOVELFAMT1     DFAMTS                                       246309 249924
177800230706     C**********           MOVELFEEAM1    DFEEAM                                       246309 249924
177900230706     C**********           MOVELCALCD1    DCALCD                                       246309 249924
178000230706     C**********           MOVELPOSTD1    DPOSTD                                       246309 249924
178100230706     C**********           MOVEL'1'       DIN31                                        246309 249924
178200230706     C**********           ENDIF                                                       246309 249924
178300230706     C********** *IN32     IFEQ '1'                                                    246309 249924
178400230706     C**********           MOVELFAMT2     DFAMTS                                       246309 249924
178500230706     C**********           MOVELFEEAM2    DFEEAM                                       246309 249924
178600230706     C**********           MOVELCALCD2    DCALCD                                       246309 249924
178700230706     C**********           MOVELPOSTD2    DPOSTD                                       246309 249924
178800230706     C**********           MOVEL'1'       DIN32                                        246309 249924
178900230706     C**********           ENDIF                                                       246309 249924
179000230706     C********** *IN33     IFEQ '1'                                                    246309 249924
179100230706     C**********           MOVELFAMT3     DFAMTS                                       246309 249924
179200230706     C**********           MOVELFEEAM3    DFEEAM                                       246309 249924
179300230706     C**********           MOVELCALCD3    DCALCD                                       246309 249924
179400230706     C**********           MOVELPOSTD3    DPOSTD                                       246309 249924
179500230706     C**********           MOVEL'1'       DIN33                                        246309 249924
179600230706     C**********           ENDIF                                                       246309 249924
179700230706      **Indicators                                                                     246309 249924
179800230706     C**********           MOVEL*ALL'0'   DINDS                                        246309 249924
179900230706     C**********           MOVEL*IN11     DIN11                                        246309 249924
180000230706     C**********           MOVEL*IN12     DIN12                                        246309 249924
180100230706     C**********           MOVEL*IN16     DIN16                                        246309 249924
180200230706     C**********           MOVEL*IN30     DIN30                                             MD026385
180300230706     C**********           MOVEL*IN31     DIN31                                             MD026385
180400230706     C**********           MOVEL*IN32     DIN32                                             MD026385
180500230706     C**********           MOVEL*IN33     DIN33                                             MD026385
180600230706     C**********           MOVEL*IN50     DIN50                                        246309 249924
180700230706     C**********           MOVEL*IN51     DIN51                                        246309 249924
180800230706     C**********           MOVEL*IN52     DIN52                                        246309 249924
180900230706     C**********           MOVEL*IN53     DIN53                                        246309 249924
181000230706      **PTFIs***                                                                       246309 249924
181100230706      **Receivable                                                                     246309 249924
181200230706     C********** *IN52     IFEQ '1'                                                    246309 249924
181300230706     C**********           MOVEL'A'       DLNAR                                        246309 249924
181400230706     C**********           ENDIF                                                       246309 249924
181500230706      **Internal                                                                       246309 249924
181600230706     C********** *IN51     IFEQ '1'                                                    246309 249924
181700230706     C**********           MOVEL'B'       DLNAR                                        246309 249924
181800230706     C**********           ENDIF                                                       246309 249924
181900230706      **Payable                                                                        246309 249924
182000230706     C********** *IN50     IFEQ '1'                                                    246309 249924
182100230706     C**********           MOVEL'C'       DLNAR                                        246309 249924
182200230706     C**********           ENDIF                                                       246309 249924
182300230706      **********                                                                       246309 249924
182400230706      **Move*DS*to Array for later sorting                                             246309 249924
182500230706     C**********           MOVELDSFEAC    ARAC,T                                       246309 249924
182600230706     C**********           ENDIF                                                       246309 249924
182700230706      **********                                                                       246309 249924
182800230706     C**********           MOVELFEPYON    SVPYON  1                                    246309 249924
182900230706     C*
183000230706     C** When branch code changes open new spool file
183100230706     C*
183200230706     C           MBIN      IFEQ 'Y'
183300230706     C***********FEBRCA    ANDNESTRBRC                                    085910
183400230706     C                     MOVE FEBRCA    STRBRC  3
183500230706     C                     MOVE '1'       *IN24
183600230706     C***********          SETOF                     8082                 085910
183700230706     C           P1OP      IFEQ 'Y'
183800230706     C           FEBRCA    ANDNE@SBRP1                                    085910
183900230706     C                     MOVE '0'       *IN80                           085910
184000230706     C                     CLOSELER180P1
184100230706     C                     MOVE ' '       P1OP
184200230706     C                     END
184300230706     C           P3OP      IFEQ 'Y'
184400230706     C           FEBRCA    ANDNE@SBRP3                                    085910
184500230706     C                     MOVE '0'       *IN82                           085910
184600230706     C                     CLOSELER180P3
184700230706     C                     MOVE ' '       P3OP
184800230706     C                     END
184900230706     C*
185000230706     C** If system is multibranching obtain branch name for output
185100230706     C*
185200230706     C                     MOVELFEBRCA    ##KB                                                CSC042
185300230706     C                     EXSR ##CHKB                                                        CSC042
185400230706      * If branch is in the array then use the details                                        CSC042
185500230706     C           ##FIC     IFEQ 'Y'                        *** B10                            CSC042
185600230706     C                     EXSR ##SETB                                                        CSC042
185700230706     C                     ELSE                            *** X10                            CSC042
185800230706     C**********           CALL 'AOBRCHR0'             99                                     CGL029
185900230706     C                     CALL 'AOBRCHR1'             99                                     CGL029
186000230706     C                     PARM '*MSG   ' @RTCD   7
186100230706     C                     PARM '*KEY   ' @OPTN   7
186200230706     C                     PARM FEBRCA    @DSNB   3
186300230706     C********** SDBRCH    PARM SDBRCH    DSFDY                                               CGL029
186400230706     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
186500230706      *
186600230706     C           @RTCD     IFNE *BLANKS
186700230706     C           *LOCK     IN   LDA                        ***************
186800230706     C                     MOVELFEBRCA    DBKEY            ** DBERR  09 **
186900230706     C                     Z-ADD9         DBASE            ***************
187000230706     C                     MOVEL'LER180'  DBPGM
187100230706     C                     MOVEL'SDBRCHPD'DBFILE
187200230706     C                     SETON                     U7U8
187300230706     C                     OUT  LDA
187400230706     C                     EXSR AUDIT
187500230706     C                     EXSR *PSSR
187600230706     C                     ELSE                                                               CSC042
187700230706      * Details found on the DB so add them to the array                                      CSC042
187800230706      * if the array still has room                                                           CSC042
187900230706     C                     EXSR ##ADDB                                                        CSC042
188000230706     C                     END
188100230706     C                     END                             *** E10                            CSC042
188200230706     C*
188300230706     C                     END
188400230706     C*
188500230706     C***  Accruing Facility Fees
188600230706     C*
188700230706     C           MBIN      IFEQ 'Y'
188800230706     C*
188900230706     C           FEPYON    IFEQ 'N'
189000230706     C           FEPYON    OREQ 'E'
189100230706     C*
189200230706     C** File has been opened field
189300230706     C*
189400230706     C           P1OP      IFNE 'Y'
189500230706     C                     MOVE 'Y'       P1OP    1
189600230706     C                     OPEN LER180P1
189700230706     C                     MOVE FEBRCA    @SBRP1  3                       085910
189800230706     C                     Z-ADD0         PAGE
189900230706      *
190000230706      ** Ensure report spool file recorded by RCF
190100230706     C                     Z-ADDSFNUM1    ZSNUM
190200230706     C*
190300230706     C                     CALL 'ZSFILE'
190400230706     C                     PARM           SEQ     5
190500230706     C                     PARM FEBRCA    SENTY   3
190600230706     C                     PARM           SFILE1
190700230706     C                     PARM           ZSNUM   60
190800230706     C                     PARM           ZSERR   1
190900230706     C*
191000230706     C** If error during ZSFILE processing, return to calling program
191100230706     C*
191200230706     C           ZSERR     IFEQ 'Y'
191300230706     C                     SETON                     U7U8LR
191400230706     C                     RETRN
191500230706     C                     END
191600230706     C*
191700230706     C** Output header
191800230706     C*
191900230706     C                     WRITELER180A1
192000230706     C                     WRITELER180A2
192100230706     C*
192200230706     C                     END
192300230706     C*
192400230706     C                     ELSE
192500230706     C*
192600230706     C***  Amortising Facility Fees
192700230706     C*
192800230706     C** File has been opened field
192900230706     C*
193000230706     C           P3OP      IFNE 'Y'
193100230706     C                     MOVE 'Y'       P3OP    1
193200230706     C                     OPEN LER180P3
193300230706     C                     MOVE FEBRCA    @SBRP3  3                       085910
193400230706     C                     Z-ADD0         PAGE3
193500230706     C*
193600230706     C** Ensure report spool file recorded by RCF
193700230706     C*
193800230706     C                     Z-ADDSFNUM3    ZSNUM
193900230706     C*
194000230706     C                     CALL 'ZSFILE'
194100230706     C                     PARM           SEQ     5
194200230706     C                     PARM FEBRCA    SENTY   3
194300230706     C                     PARM           SFILE3
194400230706     C                     PARM           ZSNUM   60
194500230706     C                     PARM           ZSERR   1
194600230706     C*
194700230706     C** If error during ZSFILE processing, return to calling program
194800230706     C*
194900230706     C           ZSERR     IFEQ 'Y'
195000230706     C                     SETON                     U7U8LR
195100230706     C                     RETRN
195200230706     C                     END
195300230706     C*
195400230706     C** Output header
195500230706     C*
195600230706     C                     WRITELER180C1
195700230706     C                     WRITELER180C2
195800230706     C*
195900230706     C                     END
196000230706     C*
196100230706     C                     END
196200230706      *
196300230706      ** If system multibranching
196400230706     C                     END
196500230706      *
196600230706      ** If system is not multibranching set up single spool file
196700230706     C           MBIN      IFNE 'Y'
196800230706     C*
196900230706     C           P1OP      IFNE 'Y'
197000230706     C                     CLOSELER180P1
197100230706     C                     END
197200230706     C*
197300230706     C           P3OP      IFNE 'Y'
197400230706     C                     CLOSELER180P3
197500230706     C                     END
197600230706     C*
197700230706     C***  Accruing Facility Fees
197800230706     C*
197900230706     C           FEPYON    IFEQ 'N'
198000230706     C           FEPYON    OREQ 'E'
198100230706     C*
198200230706     C           P1OP      IFNE 'Y'
198300230706     C                     MOVE 'Y'       P1OP
198400230706     C                     SETOF                     80
198500230706     C                     OPEN LER180P1
198600230706     C                     Z-ADD0         PAGE
198700230706      *
198800230706      ** Ensure report spool file recorded by RCF
198900230706     C                     Z-ADDSFNUM1    ZSNUM
199000230706      *
199100230706     C                     CALL 'ZSFILE'
199200230706     C                     PARM           SEQ     5
199300230706     C                     PARM *BLANKS   SENTY   3
199400230706     C                     PARM           SFILE1
199500230706     C                     PARM           ZSNUM   60
199600230706     C                     PARM           ZSERR   1
199700230706      *
199800230706      ** If error during ZSFILE processing, return to calling program
199900230706     C           ZSERR     IFEQ 'Y'
200000230706     C                     SETON                     U7U8LR
200100230706     C                     RETRN
200200230706     C                     END
200300230706     C*
200400230706     C** Output header
200500230706     C*
200600230706     C                     WRITELER180A1
200700230706     C                     WRITELER180A2
200800230706     C*
200900230706     C                     END
201000230706     C*
201100230706     C                     ELSE
201200230706     C*
201300230706     C***  Amortising Facility Fees
201400230706     C*
201500230706     C           P3OP      IFNE 'Y'
201600230706     C                     MOVE 'Y'       P3OP
201700230706     C                     SETOF                     82
201800230706     C                     OPEN LER180P3
201900230706     C                     Z-ADD0         PAGE3
202000230706      *
202100230706      ** Ensure report spool file recorded by RCF
202200230706     C                     Z-ADDSFNUM3    ZSNUM
202300230706      *
202400230706     C                     CALL 'ZSFILE'
202500230706     C                     PARM           SEQ     5
202600230706     C                     PARM *BLANKS   SENTY   3
202700230706     C                     PARM           SFILE3
202800230706     C                     PARM           ZSNUM   60
202900230706     C                     PARM           ZSERR   1
203000230706      *
203100230706      ** If error during ZSFILE processing, return to calling program
203200230706     C           ZSERR     IFEQ 'Y'
203300230706     C                     SETON                     U7U8LR
203400230706     C                     RETRN
203500230706     C                     END
203600230706     C*
203700230706     C** Output header
203800230706     C*
203900230706     C                     WRITELER180C1
204000230706     C                     WRITELER180C2
204100230706     C*
204200230706     C                     END
204300230706     C*
204400230706     C                     END
204500230706     C*
204600230706     C** MBIN IFNE 'Y' end
204700230706     C*
204800230706     C                     END
204900230706     C*
205000230706     C** If overflow indicator on, output another header
205100230706     C*
205200230706     C           *IN80     IFEQ '1'                        Print
205300230706     C*                                                                   085910
205400230706     C** Perform overflow on P1 only if the record being processed        085910
205500230706     C** is an accruing facility fee.                                     085910
205600230706     C           FEPYON    IFEQ 'N'                                       085910
205700230706     C           FEPYON    OREQ 'E'                                       085910
205800230706     C                     WRITELER180A1                   Header
205900230706     C                     WRITELER180A2
206000230706     C                     SETOF                     80
206100230706     C                     END
206200230706     C*                                                                   085910
206300230706     C                     END                                            085910
206400230706     C*                                                                   085910
206500230706     C           *IN82     IFEQ '1'                        Print
206600230706     C*                                                                   085910
206700230706     C** Perform overflow on P3 only if the record being processed        085910
206800230706     C** is an amortising facility fee.                                   085910
206900230706     C           FEPYON    IFNE 'N'                                       085910
207000230706     C           FEPYON    ANDNE'E'                                       085910
207100230706     C                     WRITELER180C1                   Header
207200230706     C                     WRITELER180C2
207300230706     C                     SETOF                     82
207400230706     C                     END
207500230706     C*                                                                   085910
207600230706     C                     END                                            085910
207700230706     C*
207800230706     C***  Accruing Facility Fees
207900230706     C*
208000230706     C           FEPYON    IFEQ 'N'
208100230706     C           FEPYON    OREQ 'E'
208200230706     C*
208300230706     C***********SVFAC     IFNE FTYP                               BH3518 085910
208400230706     C***********SVBRC     ORNE FEBRCA                             BH3518 085910
208500230706     C***********SVCCY     ORNE FEFCCY                             BH3518 085910
208600230706     C           @FACP1    IFNE FTYP                                      085910
208700230706     C           @CCYP1    ORNE FEFCCY                                    085910
208800230706     C           @BRCP1    ORNE FEBRCA                                    085910
208900230706     C                     Z-ADDFTYP      @FACP1  30                      085910
209000230706     C                     MOVE FEFCCY    @CCYP1  3                       085910
209100230706     C                     MOVE FEBRCA    @BRCP1  3                       085910
209200230706     C                     WRITELER180A7                                  BH3518
209300230706     C                     END                                            BH3518
209400230706     C*                                                                   BH3518
209500230706     C**********           WRITELER180A3                                               246309 249924
209600230706     C                     WRITELER180A3                                                      249924
209700230706     C                     Z-ADD1         FCDET1
209800230706     C                     Z-ADD1         CYDET1
209900230706     C                     Z-ADD1         BRDET1
210000230706     C                     ELSE
210100230706     C*
210200230706     C***  Amortising Facility Fees
210300230706     C*
210400230706     C***********SVFAC     IFNE FTYP                               BH3518 085910
210500230706     C***********SVBRC     ORNE FEBRCA                             BH3518 085910
210600230706     C***********SVCCY     ORNE FEFCCY                             BH3518 085910
210700230706     C           @FACP3    IFNE FTYP                                      085910
210800230706     C           @CCYP3    ORNE FEFCCY                                    085910
210900230706     C           @BRCP3    ORNE FEBRCA                                    085910
211000230706     C                     Z-ADDFTYP      @FACP3  30                      085910
211100230706     C                     MOVE FEFCCY    @CCYP3  3                       085910
211200230706     C                     MOVE FEBRCA    @BRCP3  3                       085910
211300230706     C                     WRITELER180C7                                  BH3518
211400230706     C                     END                                            BH3518
211500230706     C*                                                                   BH3518
211600230706     C                     WRITELER180C3
211700230706     C                     Z-ADD1         FCDET3
211800230706     C                     Z-ADD1         CYDET3
211900230706     C                     Z-ADD1         BRDET3
212000230706     C                     END
212100230706     C*
212200230706     C           CEXIT     ENDSR
212300230706     C/EJECT
212400230706     C********************************************************************
212500230706     C*
212600230706     C*  SRLOAN -- Loan Fee Subroutine
212700230706     C*
212800230706     C*  CALLED FROM: Main Processing
212900230706     C*
213000230706     C*  CALLS: Nothing
213100230706     C*
213200230706     C********************************************************************
213300230706     C           SRLOAN    BEGSR
213400230706     C*
213500230706     C                     ADD  1         @REP2
213600230706      *                                                                   CLE005
213700230706      ** Set off 'Fee Payable/Fee Receivable' print indicators.           CLE005
213800230706      *                                                                   CLE005
213900230706     C                     SETOF                     505152               CLE005
214000230706     C                     MOVE '0'       *IN53                           156582
214100230706     C*
214200230706     C** Chain to the loan file for the loan amount
214300230706     C** If loan not found, and Historic Retention Period is not 0 (i.e.  085677
214400230706     C** loan is not dropped from the system at month end), check on      085677
214500230706     C** historic loans file, although the loan should not have been      085677
214600230706     C** matured if there are fees outstanding - this fix has been        085677
214700230706     C** applied in case there were any loans matured incorrectly         085677
214800230706     C** before fix 085677 was applied to LE0450.                         085677
214900230706     C*
215000230706     C           FELOAN    CHAINCLOAN                71
215100230706     C           *IN71     IFEQ '1'                                       085677
215200230706     C           BPHRPR    ANDGT0                                         085677
215300230706     C           FELOAN    CHAINMLOAN                71                   085677
215400230706     C                     ENDIF                                          085677
215500230706     C                     SETOF                     38                                     MD055481
215600230706     C           *IN71     IFEQ '0'
215700230706      *                                                                                     MD055481
215800230706     C           PPCUST    IFEQ 'O'                                                         MD055481
215900230706     C                     MOVE OLNO      WOLNO   6                                         MD055481
216000230706     C                     MOVE PTYP      WPTYP   20                                        MD055481
216100230706     C                     EXSR ORIGB                                                       MD055481
216200230706     C                     ENDIF                                                            MD055481
216300230706      *                                                                                     MD055481
216400230706     C                     Z-ADDCPAM      FAMT0
216500230706     C*
216600230706     C**********           CALL 'AOCURRR0'             99                                     CSC042
216700230706     C**********           PARM '*MSG    '@RTCD                                               CSC042
216800230706     C**********           PARM '*KEY    '@OPTN                                               CSC042
216900230706     C**********           PARM CCY       CURKEY  3                                           CSC042
217000230706     C********** SDCURR    PARM SDCURR    DSSDY                                               CSC042
217100230706      *
217200230706     C********** @RTCD     IFNE *BLANKS                                                       CSC042
217300230706     C                     MOVELCCY       ##KC                                                CSC042
217400230706     C                     EXSR ##CHKC                                                        CSC042
217500230706     C           ##FIC     IFEQ 'Y'                                                           CSC042
217600230706     C                     EXSR ##SETC                                                        CSC042
217700230706     C                     ELSE                                                               CSC042
217800230706     C           *LOCK     IN   LDA                        ***************
217900230706     C                     MOVELCCY       DBKEY            *  DBERR 21   *
218000230706     C                     Z-ADD21        DBASE            ***************
218100230706     C                     MOVEL'LER180  'DBPGM                        ***
218200230706     C**********           MOVEL'SDCURRPD'DBFILE                                              CSC042
218300230706     C                     MOVEL'CURR,Q  'DBFILE                                              CSC042
218400230706     C                     SETON                     U7U8
218500230706     C                     OUT  LDA
218600230706     C                     EXSR AUDIT
218700230706     C                     EXSR *PSSR
218800230706     C                     END                             ** E001
218900230706      *
219000230706     C           A6NBDP    COMP 1                    363435
219100230706     C   36      A6NBDP    COMP 3                      3637
219200230706     C*
219300230706     C                     ELSE
219400230706     C* Database error processing
219500230706     C           *LOCK     IN   LDA                         ************
219600230706     C                     MOVELFELOAN    DBKEY             * DBERR 10 *
219700230706     C                     Z-ADD10        DBASE             ***********
219800230706     C                     MOVEL'LER180  'DBPGM
219900230706     C**********           MOVEL'FCLTY   'DBFILE                          085677
220000230706     C                     MOVEL'CLOAN   'DBFILE                          085677
220100230706     C                     SETON                     U7U8
220200230706     C                     OUT  LDA
220300230706     C                     EXSR AUDIT
220400230706     C                     EXSR *PSSR
220500230706     C                     END
220600230706     C*
220700230706     C***  Set up 'From' date
220800230706     C*
220900230706     C           FELPDT    IFLT CODT                                      052703
221000230706     C                     Z-ADDFELPDT    ZDAYNO
221100230706     C                     ELSE                                           052703
221200230706     C                     Z-ADDFEPLPD    ZDAYNO                          052703
221300230706     C                     END                                            052703
221400230706     C           ZDAYNO    IFEQ 0
221500230706     C                     Z-ADDFEPSTD    ZDAYNO
221600230706     C                     END
221700230706     C                     EXSR ZDATE2
221800230706     C                     MOVE ZADATE    FRDATE
221900230706      *                                                                                       CLE073
222000230706     C/COPY WNCPYSRC,LEH00726
222100230706      ** Set up Calculation type                                                              CLE073
222200230706      *                                                                                       CLE073
222300230706     C                     MOVE FECALT    OFCALT                                              CLE073
222400230706     C           CLE073    IFNE 'Y'                                                           CLE073
222500230706     C                     CLEAROFCALT                                                        CLE073
222600230706     C                     ENDIF                                                              CLE073
222700230706      *                                                                                       CLE073
222800230706     C*
222900230706     C** Set up the fee amounts for reporting for the record just read
223000230706     C*
223100230706     C** Calculate the fee amount to be reported
223200230706     C*
223300230706     C                     Z-ADDCPAM      LAMT0
223400230706     C                     Z-ADDFEFAMT    FEEAM0
223500230706     C                     Z-ADDFEADAT    CALCD0
223600230706     C*                                                                   BH3518
223700230706     C***  Bullet fees should have nothing in accrued amount column       BH3518
223800230706     C*                                                                   BH3518
223900230706     C           FEPYON    IFEQ ' '                                       BH3518
224000230706     C                     Z-ADD0         POSTD0                          BH3518
224100230706     C                     ELSE                                           BH3518
224200230706     C                     Z-ADDFEADAT    POSTD0
224300230706     C                     END                                            BH3518
224400230706     C/COPY WNCPYSRC,LEH00727
224500230706      *                                                                                       CLE073
224600230706     C                     MOVE *OFF      *IN11                                               CLE073
224700230706     C                     Z-ADD0         FERATE                                              CLE073
224800230706      *                                                                                       CLE073
224900230706      ** Loans calculated fees                                                                CLE073
225000230706      *                                                                                       CLE073
225100230706     C********** CLE073    IFEQ 'Y'                                                    CLE073 CLE134
225200230706     C           FECALT    IFEQ '97'                                                          CLE073
225300230706     C           CLE073    ANDEQ'Y'                                                           CLE134
225400230706     C           FECALT    OREQ '98'                                                          CLE073
225500230706     C           CLE073    ANDEQ'Y'                                                           CLE134
225600230706     C           FECALT    OREQ '99'                                                          CLE073
225700230706     C           CLE073    ANDEQ'Y'                                                           CLE134
225800230706     C           FECALT    OREQ '90'                                                          CLE134
225900230706     C           CLE134    ANDEQ'Y'                                                           CLE134
226000230706      *                                                                                       CLE073
226100230706     C           FECALT    IFEQ '97'                                                          CLE073
226200230706     C           FECALT    OREQ '98'                                                          CLE073
226300230706     C                     Z-ADDFEFRT1    FERATE                                              CLE073
226400230706     C                     MOVE *ON       *IN11                                               CLE073
226500230706     C                     Z-ADD0         FEEAM0                                              CLE073
226600230706     C                     ENDIF                                                              CLE073
226700230706      *                                                                                       CLE073
226800230706      ** Set up CALCD0                                                                        CLE073
226900230706      *                                                                                       CLE073
227000230706     C                     ADD  FELPAM    CALCD0                                              CLE073
227100230706     C                     ADD  FEAMTP    CALCD0                                              CLE073
227200230706     C           FELPDT    IFGT CODT                                                          CLE073
227300230706     C                     Z-ADDFEADBP    CALCD0                                              CLE073
227400230706     C                     ADD  FEPAMP    CALCD0                                              CLE073
227500230706     C                     ENDIF                                                              CLE073
227600230706      *                                                                                       CLE073
227700230706      ** Set up POSTD0                                                                        CLE073
227800230706      *                                                                                       CLE073
227900230706     C           *IN50     IFEQ *ON                                                           CLE073
228000230706     C                     SUB  FELPAM    POSTD0                                              CLE073
228100230706     C                     SUB  FEAMTP    POSTD0                                              CLE073
228200230706     C                     ELSE                                                               CLE073
228300230706     C                     ADD  FELPAM    POSTD0                                              CLE073
228400230706     C                     ENDIF                                                              CLE073
228500230706      *                                                                                       CLE073
228600230706     C           FELPDT    IFGT CODT                                                          CLE073
228700230706     C                     Z-ADDFEADBP    POSTD0                                              CLE073
228800230706     C           *IN50     IFEQ *ON                                                           CLE073
228900230706     C                     SUB  FEPAMP    POSTD0                                              CLE073
229000230706     C                     ENDIF                                                              CLE073
229100230706     C                     ENDIF                                                              CLE073
229200230706      *                                                                                       CLE073
229300230706     C                     ENDIF                                                              CLE073
229400230706     C**********           ENDIF                                                       CLE073 CLE134
229500230706      *                                                                                       CLE073
229600230706      *                                                                   156582
229700230706      ** Participation Sold Fee Accruals should be negated and            156582
229800230706      ** subtracted from the total                                        156582
229900230706      *                                                                   156582
230000230706     C                     SELEC                                          156582
230100230706     C           PTFI      WHEQ 'P'                                       156582
230200230706     C           PTFI      OREQ 'S'                                                           CLE106
230300230706     C           PTFI      OREQ 'R'                                                           CLE106
230400230706     C                     Z-SUBPOSTD0    POSTD0                          156582
230500230706     C           PTFI      WHEQ 'I'                                       156582
230600230706     C                     MOVE '1'       *IN53                           156582
230700230706     C                     ENDSL                                          156582
230800230706     C*
230900230706     C           SVBRC     IFNE FEBRCA
231000230706     C                     MOVELFEBRCA    ##KB                                                CSC042
231100230706     C                     EXSR ##CHKB                                                        CSC042
231200230706      * If branch is in the array then use the details                                        CSC042
231300230706     C           ##FIC     IFEQ 'Y'                        *** B10                            CSC042
231400230706     C                     EXSR ##SETB                                                        CSC042
231500230706     C                     ELSE                            *** X10                            CSC042
231600230706     C**********           CALL 'AOBRCHR0'             99                                     CGL029
231700230706     C                     CALL 'AOBRCHR1'             99                                     CGL029
231800230706     C                     PARM '*BLANKS' @RTCD
231900230706     C                     PARM '*KEY   ' @OPTN
232000230706     C                     PARM FEBRCA    @DSNB   3
232100230706     C********** SDBRCH    PARM SDBRCH    DSFDY                                               CGL029
232200230706     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
232300230706      *
232400230706     C           @RTCD     IFNE *BLANKS
232500230706     C           *LOCK     IN   LDA                                    *
232600230706     C                     MOVEL'LER180'  DBPGM             *************
232700230706     C                     MOVELFEBRCA    DBKEY             * DBERR 11 *
232800230706     C                     Z-ADD11        DBASE             ************
232900230706     C                     MOVEL'SDBRCHPD'DBFILE
233000230706     C                     SETON                     U7U8
233100230706     C                     OUT  LDA
233200230706     C                     EXSR AUDIT
233300230706     C                     EXSR *PSSR
233400230706     C                     ELSE                                                               CSC042
233500230706      * Details found on the DB so add them to the array                                      CSC042
233600230706      * if the array still has room                                                           CSC042
233700230706     C                     EXSR ##ADDB                                                        CSC042
233800230706     C                     END
233900230706     C                     END                             *** E10                            CSC042
234000230706     C                     END
234100230706     C*
234200230706     C** Access the loan type sub type table to get narrative for next
234300230706     C** facility type
234400230706     C*
234500230706     C           SVLTYP    IFNE FELTYP
234600230706     C           SVSUTP    ORNE FESUTP
234700230706     C           SVCLAS    ORNE FECLAS                                                        CLE042
234800230706     C                     CALL 'AOLOANR0'             99
234900230706     C                     PARM '*MSG   ' @RTCD
235000230706     C                     PARM '*KEY   ' @OPTN
235100230706     C                     PARM           FELTYP
235200230706     C                     PARM           FESUTP
235300230706     C                     PARM           FECLAS                                              CLE042
235400230706     C           SDLOAN    PARM SDLOAN    DSFDY
235500230706     C           @RTCD     IFNE *BLANKS                    B1
235600230706     C           *LOCK     IN   LDA                         ************
235700230706     C                     MOVELFELTYP    DBKEY             * DBERR 12 *
235800230706     C                     CAT  FESUTP:1  DBKEY             ************                      CLE042
235900230706     C                     CAT  FECLAS:1  DBKEY                                               CLE042
236000230706     C*********************MOVE FESUTP    DBKEY             ************                      CLE042
236100230706     C                     Z-ADD12        DBASE
236200230706     C                     MOVEL'LER180  'DBPGM
236300230706     C                     MOVEL'SDLOANPD'DBFILE
236400230706     C                     SETON                     U7U8
236500230706     C                     OUT  LDA
236600230706     C                     EXSR AUDIT
236700230706     C                     EXSR *PSSR
236800230706     C                     END                             E1
236900230706     C                     END
237000230706      *
237100230706     C*
237200230706     C** Check the currency decimal places and name for the new ccy
237300230706     C*
237400230706     C           SVCCY     IFNE FEFCCY
237500230706     C           SVBRC     ORNE FEBRCA
237600230706     C*
237700230706     C**********           CALL 'AOCURRR0'             99                                     CSC042
237800230706     C**********           PARM '*MSG    '@RTCD                                               CSC042
237900230706     C**********           PARM '*KEY    '@OPTN                                               CSC042
238000230706     C**********           PARM FEFCCY    CURKEY  3                                           CSC042
238100230706     C********** SDCURR    PARM SDCURR    DSSDY                                               CSC042
238200230706      *
238300230706     C********** @RTCD     IFNE *BLANKS                                                       CSC042
238400230706     C                     MOVELFEFCCY    ##KC                                                CSC042
238500230706     C                     EXSR ##CHKC                                                        CSC042
238600230706     C           ##FIC     IFEQ 'Y'                                                           CSC042
238700230706     C                     EXSR ##SETC                                                        CSC042
238800230706     C                     ELSE                                                               CSC042
238900230706     C           *LOCK     IN   LDA                        ***************
239000230706     C                     MOVELFEFCCY    DBKEY            *  DBERR 13   *
239100230706     C                     Z-ADD13        DBASE            ***************
239200230706     C**********           MOVEL'SDCURRPD'DBFILE                                              CSC042
239300230706     C                     MOVEL'CURR,Q  'DBFILE                                              CSC042
239400230706     C                     MOVE 'LER180  'DBPGM
239500230706     C                     SETON                     U7U8
239600230706     C                     OUT  LDA
239700230706     C                     EXSR AUDIT
239800230706     C                     EXSR *PSSR
239900230706     C                     END                             ** E001
240000230706     C*
240100230706     C           A6NBDP    COMP 1                    323031
240200230706     C   32      A6NBDP    COMP 3                      3233
240300230706     C*                                                                   100431
240400230706     C** Store the fee ccy name for the report headings, to ensure that   100431
240500230706     C** it doesn't get corrupted by subsequent chains with               100431
240600230706     C** facility currency                                                100431
240700230706     C*                                                                   100431
240800230706     C                     MOVELA6CYCD    ULCYCD                                            MD026385
240900230706     C                     MOVELA6CYNM    ULCYNM                          100431
241000230706     C*
241100230706     C                     END
241200230706     C*
241300230706     C           FEPYON    IFEQ 'E'
241400230706     C                     ADD  CALCD0    CLTOTA
241500230706     C           PTFI      IFNE 'I'                                       156582
241600230706     C                     ADD  POSTD0    CXTOA0                          BH3518
241700230706     C                     ENDIF                                          156582
241800230706     C                     ELSE
241900230706     C                     ADD  CALCD0    CLTOTM
242000230706     C           PTFI      IFNE 'I'                                       156582
242100230706     C                     ADD  POSTD0    CXTOM0                          BH3518
242200230706     C                     ENDIF                                          156582
242300230706     C                     END
242400230706     C*
242500230706     C           SVNUM     IFNE FECNUM
242600230706     C                     MOVE FECNUM    @BBA    6
242700230706     C                     MOVELFECNUM    KEYC   10
242800230706     C*
242900230706     C                     CALL 'AOCUSTR0'
243000230706     C                     PARM '*MSG   ' @RTCD
243100230706     C                     PARM '*KEY   ' @OPTN
243200230706     C                     PARM           KEYC
243300230706     C                     PARM           KEYSTS  7
243400230706     C           SDCUST    PARM SDCUST    DSSDY
243500230706      *
243600230706     C           @RTCD     IFNE *BLANKS                    B2
243700230706     C           @RTCD     ANDNE'*CUSCLS'                                                   MD050457
243800230706     C           *LOCK     IN   LDA                         ************
243900230706     C                     MOVELFECNUM    DBKEY             * DBERR 14 *
244000230706     C                     Z-ADD14        DBASE             ************
244100230706     C                     MOVEL'LER180  'DBPGM
244200230706     C                     MOVEL'SDCUSTPD'DBFILE
244300230706     C                     SETON                     U7U8
244400230706     C                     OUT  LDA
244500230706     C                     EXSR AUDIT
244600230706     C                     EXSR *PSSR
244700230706     C                     END                             E2
244800230706      *
244900230706     C                     END                             E1
245000230706     C*
245100230706     C** If the new fee code is different from the last get the new
245200230706     C** fee narrative
245300230706     C*
245400230706     C           SVCOD     IFNE FEFCOD
245500230706     C**********           MOVE FEFCOD    AUFECD           Name of        BHBC01
245600230706     C                     Z-ADDFEFCOD    WKFCOD                          BHBC01
245700230706     C                     CALL 'AOFEER0'              99
245800230706     C                     PARM '*MSG   ' @RTCD
245900230706     C                     PARM '*KEY   ' @OPTN
246000230706     C**********           PARM AUFECD    FKEY    2                       BHBC01
246100230706     C                     PARM WKFCOA    FKEY    2                       BHBC01
246200230706     C           SDFEE     PARM SDFEE     DSFDY
246300230706      *
246400230706     C           @RTCD     IFNE *BLANKS                    B1
246500230706     C                     MOVE *ALL'*'   AUFENV
246600230706     C********** *LOCK     IN   LDA                         ************  BHBC01
246700230706     C**********           MOVELFEFCOD    DBKEY             * DBERR 15 *  BHBC01
246800230706     C**********           Z-ADD15        DBASE             ************  BHBC01
246900230706     C**********           MOVEL'LER180  'DBPGM                           BHBC01
247000230706     C**********           MOVEL'SDFEEPD 'DBFILE                          BHBC01
247100230706     C**********           SETON                     U7U8                 BHBC01
247200230706     C**********           OUT  LDA                                       BHBC01
247300230706     C**********           EXSR AUDIT                                     BHBC01
247400230706     C**********           EXSR *PSSR                                     BHBC01
247500230706     C                     END                             E1
247600230706     C                     END
247700230706     C*
247800230706     C***  Force page change
247900230706     C*
248000230706     C********** LINE2     IFGE 57
248100230706     C**********           SETON                     81
248200230706     C**********           END
248300230706     C*
248400230706     C********** LINE4     IFGE 57
248500230706     C**********           SETON                     83
248600230706     C**********           END
248700230706      *                                                                   CLE005
248800230706      ***If*Switchable*feature*CLE005*is*on,*Set*On*corresponding*Ind.*                CLE005 193475
248900230706      ** If Switchable feature CLE006 is ON, set ON corresponding Ind.                        193475
249000230706      ** to print the 'Fee Payable/Fee Receivable' Indicator              CLE005
249100230706      *                                                                   CLE005
249200230706     C********** CLE005    IFEQ 'Y'                                                    CLE005 193475
249300230706     C           CLE006    IFEQ 'Y'                                                           193475
249400230706      *                                                                   CLE005
249500230706     C                     SELEC                                          CLE005
249600230706     C           PTFI      WHEQ 'P'                                       CLE005
249700230706     C           PTFI      OREQ 'S'                                                           CLE106
249800230706     C           PTFI      OREQ 'R'                                                           CLE106
249900230706     C                     SETON                     50                   CLE005
250000230706     C           PTFI      WHEQ 'I'                                       CLE005
250100230706     C                     SETON                     51                   CLE005
250200230706     C           PTFI      WHEQ ' '                                       CLE005
250300230706     C                     SETON                     52                   CLE005
250400230706     C                     ENDSL                                          CLE005
250500230706      *                                                                   CLE005
250600230706     C                     ENDIF                                          CLE005
250700230706     C*
250800230706     C** When branch code changes open new spool file
250900230706     C*
251000230706     C           MBIN      IFEQ 'Y'
251100230706     C***********FEBRCA    ANDNESTRBRC                                    085910
251200230706     C                     MOVE FEBRCA    STRBRC  3
251300230706     C                     MOVE '1'       *IN24
251400230706     C***********          SETOF                     8183                 085910
251500230706     C           P2OP      IFEQ 'Y'
251600230706     C           FEBRCA    ANDNE@SBRP2                                    085910
251700230706     C                     MOVE '0'       *IN81                           085910
251800230706     C                     CLOSELER180P2
251900230706     C                     MOVE ' '       P2OP
252000230706     C                     END
252100230706     C           P4OP      IFEQ 'Y'
252200230706     C           FEBRCA    ANDNE@SBRP4                                    085910
252300230706     C                     MOVE '0'       *IN83                           085910
252400230706     C                     CLOSELER180P4
252500230706     C                     MOVE ' '       P4OP
252600230706     C                     END
252700230706     C*
252800230706     C** If system is multibranching obtain branch name for output
252900230706     C*
253000230706     C                     MOVELFEBRCA    ##KB                                                CSC042
253100230706     C                     EXSR ##CHKB                                                        CSC042
253200230706      * If branch is in the array then use the details                                        CSC042
253300230706     C           ##FIC     IFEQ 'Y'                        *** B10                            CSC042
253400230706     C                     EXSR ##SETB                                                        CSC042
253500230706     C                     ELSE                            *** X10                            CSC042
253600230706     C**********           CALL 'AOBRCHR0'             99                                     CGL029
253700230706     C                     CALL 'AOBRCHR1'             99                                     CGL029
253800230706     C                     PARM '*MSG   ' @RTCD   7
253900230706     C                     PARM '*KEY   ' @OPTN   7
254000230706     C                     PARM FEBRCA    @DSNB   3
254100230706     C********** SDBRCH    PARM SDBRCH    DSFDY                                               CGL029
254200230706     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
254300230706      *
254400230706     C           @RTCD     IFNE *BLANKS
254500230706     C           *LOCK     IN   LDA                        ***************
254600230706     C                     MOVELFEBRCA    DBKEY            ** DBERR  16 **
254700230706     C                     Z-ADD16        DBASE            ***************
254800230706     C                     MOVEL'LER180'  DBPGM
254900230706     C                     MOVEL'SDBRCHPD'DBFILE
255000230706     C                     SETON                     U7U8
255100230706     C                     OUT  LDA
255200230706     C                     EXSR AUDIT
255300230706     C                     EXSR *PSSR
255400230706     C                     ELSE                                                               CSC042
255500230706      * Details found on the DB so add them to the array                                      CSC042
255600230706      * if the array still has room                                                           CSC042
255700230706     C                     EXSR ##ADDB                                                        CSC042
255800230706     C                     END
255900230706     C                     END                             *** E10                            CSC042
256000230706     C*
256100230706     C                     END
256200230706     C*
256300230706     C***  Accruing Loan Fees
256400230706     C*
256500230706     C           MBIN      IFEQ 'Y'
256600230706     C*
256700230706     C           FEPYON    IFEQ 'E'
256800230706     C*
256900230706     C** File has been opened field
257000230706     C*
257100230706     C           P2OP      IFNE 'Y'
257200230706     C                     MOVE 'Y'       P2OP    1
257300230706     C                     OPEN LER180P2
257400230706     C                     MOVE FEBRCA    @SBRP2  3                       085910
257500230706     C                     Z-ADD0         PAGE2
257600230706      *
257700230706      ** Ensure report spool file recorded by RCF
257800230706     C                     Z-ADDSFNUM2    ZSNUM
257900230706     C*
258000230706     C                     CALL 'ZSFILE'
258100230706     C                     PARM           SEQ     5
258200230706     C                     PARM FEBRCA    SENTY   3
258300230706     C                     PARM           SFILE2
258400230706     C                     PARM           ZSNUM   60
258500230706     C                     PARM           ZSERR   1
258600230706     C*
258700230706     C** If error during ZSFILE processing, return to calling program
258800230706     C*
258900230706     C           ZSERR     IFEQ 'Y'
259000230706     C                     SETON                     U7U8LR
259100230706     C                     RETRN
259200230706     C                     END
259300230706     C*
259400230706     C** Output header
259500230706     C*
259600230706     C                     WRITELER180B1
259700230706     C                     WRITELER180B2
259800230706     C*
259900230706     C                     END
260000230706     C*
260100230706     C                     ELSE
260200230706     C*
260300230706     C***  Amortising Loan Fees
260400230706     C*
260500230706     C** File has been opened field
260600230706     C*
260700230706     C           P4OP      IFNE 'Y'
260800230706     C                     MOVE 'Y'       P4OP    1
260900230706     C                     OPEN LER180P4
261000230706     C                     MOVE FEBRCA    @SBRP4  3                       085910
261100230706     C                     Z-ADD0         PAGE4
261200230706     C*
261300230706     C** Ensure report spool file recorded by RCF
261400230706     C*
261500230706     C                     Z-ADDSFNUM4    ZSNUM
261600230706     C*
261700230706     C                     CALL 'ZSFILE'
261800230706     C                     PARM           SEQ     5
261900230706     C                     PARM FEBRCA    SENTY   3
262000230706     C                     PARM           SFILE4
262100230706     C                     PARM           ZSNUM   60
262200230706     C                     PARM           ZSERR   1
262300230706     C*
262400230706     C** If error during ZSFILE processing, return to calling program
262500230706     C*
262600230706     C           ZSERR     IFEQ 'Y'
262700230706     C                     SETON                     U7U8LR
262800230706     C                     RETRN
262900230706     C                     END
263000230706     C*
263100230706     C** Output header
263200230706     C*
263300230706     C                     WRITELER180D1
263400230706     C                     WRITELER180D2
263500230706     C*
263600230706     C                     END
263700230706     C*
263800230706     C                     END
263900230706      *
264000230706      ** If system multibranching
264100230706     C                     END
264200230706      *
264300230706      ** If system is not multibranching set up single spool file
264400230706     C           MBIN      IFNE 'Y'
264500230706     C*
264600230706     C           P2OP      IFNE 'Y'
264700230706     C                     CLOSELER180P2
264800230706     C                     END
264900230706     C*
265000230706     C           P4OP      IFNE 'Y'
265100230706     C                     CLOSELER180P4
265200230706     C                     END
265300230706     C*
265400230706     C***  Accruing Loan Fees
265500230706     C*
265600230706     C           FEPYON    IFEQ 'E'
265700230706     C*
265800230706     C           P2OP      IFNE 'Y'
265900230706     C                     MOVE 'Y'       P2OP
266000230706     C                     SETOF                     81
266100230706     C                     OPEN LER180P2
266200230706     C                     Z-ADD0         PAGE2
266300230706      *
266400230706      ** Ensure report spool file recorded by RCF
266500230706     C                     Z-ADDSFNUM2    ZSNUM
266600230706      *
266700230706     C                     CALL 'ZSFILE'
266800230706     C                     PARM           SEQ     5
266900230706     C                     PARM *BLANKS   SENTY   3
267000230706     C                     PARM           SFILE2
267100230706     C                     PARM           ZSNUM   60
267200230706     C                     PARM           ZSERR   1
267300230706      *
267400230706      ** If error during ZSFILE processing, return to calling program
267500230706     C           ZSERR     IFEQ 'Y'
267600230706     C                     SETON                     U7U8LR
267700230706     C                     RETRN
267800230706     C                     END
267900230706      *
268000230706      ** Output header
268100230706     C                     WRITELER180B1
268200230706     C                     WRITELER180B2
268300230706     C*
268400230706     C                     END
268500230706     C*
268600230706     C                     ELSE
268700230706     C*
268800230706     C***  Amortising Loan Fees
268900230706     C*
269000230706     C           P4OP      IFNE 'Y'
269100230706     C                     MOVE 'Y'       P4OP
269200230706     C                     SETOF                     83
269300230706     C                     OPEN LER180P4
269400230706     C                     Z-ADD0         PAGE4
269500230706      *
269600230706      ** Ensure report spool file recorded by RCF
269700230706     C                     Z-ADDSFNUM4    ZSNUM
269800230706      *
269900230706     C                     CALL 'ZSFILE'
270000230706     C                     PARM           SEQ     5
270100230706     C                     PARM *BLANKS   SENTY   3
270200230706     C                     PARM           SFILE4
270300230706     C                     PARM           ZSNUM   60
270400230706     C                     PARM           ZSERR   1
270500230706      *
270600230706      ** If error during ZSFILE processing, return to calling program
270700230706     C           ZSERR     IFEQ 'Y'
270800230706     C                     SETON                     U7U8LR
270900230706     C                     RETRN
271000230706     C                     END
271100230706      *
271200230706      ** Output header
271300230706     C                     WRITELER180D1
271400230706     C                     WRITELER180D2
271500230706      *
271600230706     C                     END
271700230706     C*
271800230706     C                     END
271900230706      *
272000230706      ** MBIN IFNE 'Y' end
272100230706     C                     END
272200230706     C*
272300230706     C** If overflow indicator on, output another header
272400230706     C*
272500230706     C           *IN81     IFEQ '1'                        Print
272600230706     C*                                                                   085910
272700230706     C** Perform overflow on P2 only if the record being processed        085910
272800230706     C** is an accruing loan fee.                                         085910
272900230706     C           FEPYON    IFEQ 'E'                                       085910
273000230706     C                     WRITELER180B1                   Header
273100230706     C                     WRITELER180B2
273200230706     C                     SETOF                     81
273300230706     C                     END
273400230706     C*                                                                   085910
273500230706     C                     END                                            085910
273600230706     C*                                                                   085910
273700230706     C           *IN83     IFEQ '1'                        Print
273800230706     C*                                                                   085910
273900230706     C** Perform overflow on P4 only if the record being processed        085910
274000230706     C** is an amortising loan fee.                                       085910
274100230706     C           FEPYON    IFNE 'E'                                       085910
274200230706     C                     WRITELER180D1                   Header
274300230706     C                     WRITELER180D2
274400230706     C                     SETOF                     83
274500230706     C                     END                                            085910
274600230706     C*                                                                   085910
274700230706     C                     END
274800230706     C*
274900230706     C***  Accruing Loan Fees
275000230706     C*
275100230706     C           FEPYON    IFEQ 'E'
275200230706     C*
275300230706     C                     WRITELER180B3
275400230706     C                     Z-ADD1         CYDET2
275500230706     C                     Z-ADD1         BRDET2
275600230706     C                     ELSE
275700230706     C*
275800230706     C***  Amortising Loan Fees
275900230706     C*
276000230706     C                     WRITELER180D3
276100230706     C                     Z-ADD1         CYDET4
276200230706     C                     Z-ADD1         BRDET4
276300230706     C                     END
276400230706     C*
276500230706     C                     ENDSR
276600230706     C*
276700230706     C/EJECT
276800230706      ********************************************************************                    CSC042
276900230706      *                                                                                       CSC042
277000230706      * ##CHKB - Subroutine to check the Branch in the arrays                                 CSC042
277100230706      *                                                                                       CSC042
277200230706     C           ##CHKB    BEGSR                                                              CSC042
277300230706      *                                                                                       CSC042
277400230706     C           *LIKE     DEFN A8BRCD    ##KB                                                CSC042
277500230706      *                                                                                       CSC042
277600230706      * Set off the branch found indicator                                                    CSC042
277700230706     C                     MOVEL*BLANK    ##FIC   1                                           CSC042
277800230706      *                                                                                       CSC042
277900230706      * Save the state of indicator 30 so it can be reset at the end                          CSC042
278000230706      * of the SR as it may be used elsewhere in the code                                     CSC042
278100230706     C           *IN30     IFEQ *ON                                                           CSC042
278200230706     C                     MOVEL'Y'       #IN30   1                                           CSC042
278300230706     C                     ELSE                                                               CSC042
278400230706     C                     MOVEL'N'       #IN30                                               CSC042
278500230706     C                     END                                                                CSC042
278600230706      *                                                                                       CSC042
278700230706     C                     SETOF                         30                                   CSC042
278800230706      *                                                                                       CSC042
278900230706      * Restore the saved Value of B                                                          CSC042
279000230706     C                     Z-ADD##BSV     B                                                   CSC042
279100230706      *                                                                                       CSC042
279200230706     C* Check whether details for Branch already in array                                     CSC042
279300230706      *                                                                                       CSC042
279400230706      * Is this the same as the last LOKUP, if so we can bypass                               CSC042
279500230706      * the LOKUP                                                                             CSC042
279600230706      * Defend against B being 0                                                              CSC042
279700230706     C           B         IFEQ 0                                                             CSC042
279800230706     C                     Z-ADD1         B                                                   CSC042
279900230706     C                     END                                                                CSC042
280000230706      *                                                                                       CSC042
280100230706      * If the branch being checked is the same then use these                                CSC042
280200230706      * details rather than doing a LOKUP                                                     CSC042
280300230706     C           ##KB      IFEQ ##BR,B                                                        CSC042
280400230706      * Found so seton 30                                                                     CSC042
280500230706     C                     SETON                         30                                   CSC042
280600230706     C                     ELSE                                                               CSC042
280700230706     C                     Z-ADD1         B                                                   CSC042
280800230706     C           ##KB      LOKUP##BR,B                   30                                   CSC042
280900230706     C                     END                                                                CSC042
281000230706      *                                                                                       CSC042
281100230706      * Save the last update to B                                                             CSC042
281200230706     C           *IN30     IFEQ *ON                                                           CSC042
281300230706     C                     Z-ADDB         ##BSV                                               CSC042
281400230706      * Set the indicator to show the data was found                                          CSC042
281500230706     C                     MOVEL'Y'       ##FIC                                               CSC042
281600230706     C                     END                                                                CSC042
281700230706      *                                                                                       CSC042
281800230706      * Reset the state of indicator 30.                                                      CSC042
281900230706     C           #IN30     IFEQ 'Y'                                                           CSC042
282000230706     C                     MOVEL*ON       *IN30                                               CSC042
282100230706     C                     ELSE                                                               CSC042
282200230706     C                     MOVEL*OFF      *IN30                                               CSC042
282300230706     C                     END                                                                CSC042
282400230706      *                                                                                       CSC042
282500230706     C                     ENDSR                                                              CSC042
282600230706      ********************************************************************                    CSC042
282700230706      /EJECT                                                                                  CSC042
282800230706      ********************************************************************                    CSC042
282900230706      *                                                                                       CSC042
283000230706      * ##SETB - Sets up the SDBRCHPD fields used in the code from the                        CSC042
283100230706      * arrays                                                                                CSC042
283200230706      *                                                                                       CSC042
283300230706     C           ##SETB    BEGSR                                                              CSC042
283400230706      *                                                                                       CSC042
283500230706     C                     MOVEL##BR,B    A8BRCD                                              CSC042
283600230706     C                     MOVEL##BN,B    BRNM                                                CSC042
283700230706      *                                                                                       CSC042
283800230706     C                     ENDSR                                                              CSC042
283900230706      *                                                                                       CSC042
284000230706      ********************************************************************                    CSC042
284100230706      /EJECT                                                                                  CSC042
284200230706      ********************************************************************                    CSC042
284300230706      *                                                                                       CSC042
284400230706      * ##ADDB - Adds the SDBRCHPD fields used in the code to the                             CSC042
284500230706      * arrays                                                                                CSC042
284600230706      *                                                                                       CSC042
284700230706     C           ##ADDB    BEGSR                                                              CSC042
284800230706      *                                                                                       CSC042
284900230706      * If there is still room in the array then add the details                              CSC042
285000230706     C           ##BNDX    IFLT 999                                                           CSC042
285100230706     C                     ADD  1         ##BNDX                                              CSC042
285200230706     C                     Z-ADD##BNDX    B                                                   CSC042
285300230706     C                     MOVELA8BRCD    ##BR,B                                              CSC042
285400230706     C                     MOVELBRNM      ##BN,B                                              CSC042
285500230706     C                     END                                                                CSC042
285600230706      *                                                                                       CSC042
285700230706      * Update ##BSV  so next call to ##CHKB checks this latest adddition                     CSC042
285800230706      * to the array firss                                                                    CSC042
285900230706     C                     Z-ADDB         ##BSV                                               CSC042
286000230706      *                                                                                       CSC042
286100230706     C                     ENDSR                                                              CSC042
286200230706      ********************************************************************                    CSC042
286300230706      /EJECT                                                                                  CSC042
286400230706     C********************************************************************
286500230706     C*
286600230706     C*  CHANGE -- Check for change of facility, branch, or currency
286700230706     C*
286800230706     C*  CALLED FROM: Main Processing
286900230706     C*
287000230706     C*  CALLS: NOTHING
287100230706     C*
287200230706     C********************************************************************
287300230706     C           CHANGE    BEGSR
287400230706     C*
287500230706     C***  Facility type changed, or currency changed, or branch chgd
287600230706     C*
287700230706     C           SVFAC     IFNE FTYP
287800230706     C********** SVFAC     ANDNE0                                                      246309 249924
287900230706     C           SVCCY     ORNE FEFCCY
288000230706     C********** SVCCY     ANDNE*BLANKS                                                246309 249924
288100230706     C           SVBRC     ORNE FEBRCA
288200230706     C********** SVBRC     ANDNE*BLANKS                                                246309 249924
288300230706      **********                                                                       246309 249924
288400230706     C**********           EXSR WRFEAC                                                 246309 249924
288500230706     C*
288600230706     C***  If details written to P1
288700230706     C*
288800230706     C           FCDET1    IFEQ 1
288900230706     C                     WRITELER180A5
289000230706     C                     Z-ADD0         FCDET1  20
289100230706     C                     Z-ADD0         FCTOTA 150
289200230706     C                     Z-ADD0         FATOA0 150                      BH3518
289300230706     C                     END
289400230706     C*
289500230706     C***  If details written to P3
289600230706     C*
289700230706     C           FCDET3    IFEQ 1
289800230706     C                     WRITELER180C5
289900230706     C                     Z-ADD0         FCDET3  20
290000230706     C                     Z-ADD0         FCTOTM 150
290100230706     C                     Z-ADD0         FATOM0 150                      BH3518
290200230706     C                     END
290300230706     C*
290400230706     C                     END
290500230706     C*
290600230706     C***  If currency changed, or branch changed
290700230706     C*
290800230706     C           SVCCY     IFNE FEFCCY
290900230706     C           SVBRC     ORNE FEBRCA
291000230706     C*
291100230706     C***  If details written to P1
291200230706     C*
291300230706     C           CYDET1    IFEQ 1
291400230706     C                     WRITELER180A6
291500230706     C                     Z-ADD0         CYDET1  20
291600230706     C                     ADD  CFTOTA    BRTOT  150
291700230706     C                     Z-ADD0         CFTOTA 150
291800230706     C                     Z-ADD0         CATOA0 150                      BH3518
291900230706     C*
292000230706     C***  For change of currency need new headers
292100230706     C*
292200230706     C           *IN70     IFEQ '0'
292300230706     C                     MOVE '1'       *IN80
292400230706     C                     END
292500230706     C*
292600230706     C                     END
292700230706     C*
292800230706     C***  If details written to P2
292900230706     C*
293000230706     C           CYDET2    IFEQ 1
293100230706     C                     WRITELER180B6
293200230706     C                     Z-ADD0         CYDET2  20
293300230706     C                     ADD  CLTOTA    BRTOT
293400230706     C                     Z-ADD0         CLTOTA 150
293500230706     C                     Z-ADD0         CXTOA0                          BH3518
293600230706     C*
293700230706     C***  For change of currency need new headers
293800230706     C*
293900230706     C           *IN70     IFEQ '0'
294000230706     C                     MOVE '1'       *IN81
294100230706     C                     END
294200230706     C*
294300230706     C                     END
294400230706     C*
294500230706     C***  If details written to P3
294600230706     C*
294700230706     C           CYDET3    IFEQ 1
294800230706     C                     WRITELER180C6
294900230706     C                     Z-ADD0         CYDET3  20
295000230706     C                     ADD  CFTOTM    BRTOT
295100230706     C                     Z-ADD0         CFTOTM 150
295200230706     C                     Z-ADD0         CATOM0 150                      BH3518
295300230706     C*
295400230706     C***  For change of currency need new headers
295500230706     C*
295600230706     C           *IN70     IFEQ '0'
295700230706     C                     MOVE '1'       *IN82
295800230706     C                     END
295900230706     C*
296000230706     C                     END
296100230706     C*
296200230706     C***  If details written to P4
296300230706     C*
296400230706     C           CYDET4    IFEQ 1
296500230706     C                     WRITELER180D6
296600230706     C                     Z-ADD0         CYDET4  20
296700230706     C                     ADD  CLTOTM    BRTOT
296800230706     C                     Z-ADD0         CLTOTM 150
296900230706     C                     Z-ADD0         CXTOM0                          BH3518
297000230706     C*
297100230706     C***  For change of currency need new headers
297200230706     C*
297300230706     C           *IN70     IFEQ '0'
297400230706     C                     MOVE '1'       *IN83
297500230706     C                     END
297600230706     C*
297700230706     C                     END
297800230706     C*
297900230706     C                     END
298000230706     C*
298100230706     C***  If branch changed
298200230706     C*
298300230706     C           SVBRC     IFNE FEBRCA
298400230706     C*
298500230706     C***  If details written to P1
298600230706     C*
298700230706     C           BRDET1    IFEQ 1
298800230706     C                     WRITELER180A4
298900230706     C                     Z-ADD0         BRDET1  20
299000230706     C                     END
299100230706     C*
299200230706     C***  If details written to P2
299300230706     C*
299400230706     C           BRDET2    IFEQ 1
299500230706     C                     WRITELER180B4
299600230706     C                     Z-ADD0         BRDET2  20
299700230706     C                     END
299800230706     C*
299900230706     C***  If details written to P3
300000230706     C*
300100230706     C           BRDET3    IFEQ 1
300200230706     C                     WRITELER180C4
300300230706     C                     Z-ADD0         BRDET3  20
300400230706     C                     END
300500230706     C*
300600230706     C***  If details written to P4
300700230706     C*
300800230706     C           BRDET4    IFEQ 1
300900230706     C                     WRITELER180D4
301000230706     C                     Z-ADD0         BRDET4  20
301100230706     C                     END
301200230706     C*
301300230706     C** Keep a branch total (in unconverted, mixed ccys) for no reason
301400230706     C*
301500230706     C                     ADD  BRTOT     ALLTOT 150
301600230706     C                     Z-ADD0         BRTOT
301700230706     C*
301800230706     C                     END
301900230706     C*
302000230706     C                     ENDSR
302100230706     C*
302200230706     C/EJECT
302300230706     C********************************************************************             246309 249924
302400230706     C**********                                                                       246309 249924
302500230706     C***WRFEAC*-- Write newly sorted details of LER180P1                              246309 249924
302600230706     C**********                                                                       246309 249924
302700230706     C***CALLED*FROM: CHANGE                                                           246309 249924
302800230706     C**********                                                                       246309 249924
302900230706     C***CALLS:*Nothing                                                                246309 249924
303000230706     C**********                                                                       246309 249924
303100230706     C********************************************************************             246309 249924
303200230706     C********** WRFEAC    BEGSR                                                       246309 249924
303300230706      **********                                                                       246309 249924
303400230706     C********** SVPYON    IFEQ 'N'                                                    246309 249924
303500230706     C**********           Z-ADD1         T2      20                                 246309 AR894146
303600230706     C**********           Z-ADD1         T2      40                                        AR894146
303700230706     C**********           SORTAARAC                                                   246309 249924
303800230706     C********** T2        DOUGTT                                                      246309 249924
303900230706     C**********           CLEARDSFEAC                                                 246309 249924
304000230706     C**********           MOVELARAC,T2   DSFEAC                                       246309 249924
304100230706      **********                                                                       246309 249924
304200230706     C**********           MOVELDIN11     *IN11                                        246309 249924
304300230706     C**********           MOVELDIN12     *IN12                                        246309 249924
304400230706     C**********           MOVELDIN16     *IN16                                        246309 249924
304500230706     C**********           MOVELDIN50     *IN50                                        246309 249924
304600230706     C**********           MOVELDIN51     *IN51                                        246309 249924
304700230706     C**********           MOVELDIN52     *IN52                                        246309 249924
304800230706     C**********           MOVELDIN53     *IN53                                        246309 249924
304900230706      **********                                                                       246309 249924
305000230706     C**********           MOVELDFTYP     FTYP                                         246309 249924
305100230706     C**********           MOVELDFSEQ     FSEQ                                         246309 249924
305200230706     C**********           MOVELDFESEQ    FEFSEQ                              246309 MD026385 249924
305300230706     C**********           MOVE @VFSEQ    FEFSEQ                              246309 MD026385 249924
305400230706     C**********           MOVELDCNUM     FECNUM                                       246309 249924
305500230706     C**********           MOVELDBCRNM    BBCRNM                                       246309 249924
305600230706     C**********           MOVELDBCRTN    BBCRTN                                       246309 249924
305700230706     C**********           MOVELDFCOD     FEFCOD                              246309 MD026385 249924
305800230706     C**********           MOVE @VFCOD    FEFCOD                                     MD026385 249924
305900230706     C**********           MOVELDFCCY     FCCY                                         246309 249924
306000230706     C**********           MOVELDRDATE    FRDATE                                       246309 249924
306100230706     C**********           MOVELDECALT    FECALT                              246309 MD026385 249924
306200230706     C**********           MOVEL@VCALT    FECALT                                     MD026385 249924
306300230706     C**********           MOVELDERATE    FERATE                                       246309 249924
306400230706     C**********           MOVELDECOMT    FECOMT                                       246309 249924
306500230706      **********                                                                       246309 249924
306600230706     C********** DIN30     IFEQ '1'                                                    246309 249924
306700230706     C**********           MOVELDFAMTS    FAMT0                                        246309 249924
306800230706     C**********           MOVELDFEEAM    FEEAM0                                       246309 249924
306900230706     C**********           MOVELDCALCD    CALCD0                                       246309 249924
307000230706     C**********           MOVELDPOSTD    POSTD0                                       246309 249924
307100230706     C**********           MOVEL'1'       *IN30                                        246309 249924
307200230706     C**********           ENDIF                                                       246309 249924
307300230706     C********** DIN31     IFEQ '1'                                                    246309 249924
307400230706     C**********           MOVELDFAMTS    FAMT1                                        246309 249924
307500230706     C**********           MOVELDFEEAM    FEEAM1                                       246309 249924
307600230706     C**********           MOVELDCALCD    CALCD1                                       246309 249924
307700230706     C**********           MOVELDPOSTD    POSTD1                                       246309 249924
307800230706     C**********           MOVEL'1'       *IN31                                        246309 249924
307900230706     C**********           ENDIF                                                       246309 249924
308000230706     C********** DIN32     IFEQ '1'                                                    246309 249924
308100230706     C**********           MOVELDFAMTS    FAMT2                                        246309 249924
308200230706     C**********           MOVELDFEEAM    FEEAM2                                       246309 249924
308300230706     C**********           MOVELDCALCD    CALCD2                                       246309 249924
308400230706     C**********           MOVELDPOSTD    POSTD2                                       246309 249924
308500230706     C**********           MOVEL'1'       *IN32                                        246309 249924
308600230706     C**********           ENDIF                                                       246309 249924
308700230706     C********** DIN33     IFEQ '1'                                                    246309 249924
308800230706     C**********           MOVELDFAMTS    FAMT3                                        246309 249924
308900230706     C**********           MOVELDFEEAM    FEEAM3                                       246309 249924
309000230706     C**********           MOVELDCALCD    CALCD3                                       246309 249924
309100230706     C**********           MOVELDPOSTD    POSTD3                                       246309 249924
309200230706     C**********           MOVEL'1'       DIN33                                        246309 249924
309300230706     C**********           ENDIF                                                       246309 249924
309400230706      **********                                                                       246309 249924
309500230706     C********** FECNUM    IFNE '999999'                                             MD026385 249924
309600230706     C********** DFCCY     ANDNE'999'                                                MD026385 249924
309700230706     C**********           WRITELER180A3                                               246309 249924
309800230706     C**********           MOVEL'1'       @PHDR   1                                    246309 249924
309900230706     C**********           MOVEL@VFAC     FTYP                                         246309 249924
310000230706     C**********           MOVEL@VSEQ     FSEQ                                         246309 249924
310100230706     C**********           ADD  1         T2                                           246309 249924
310200230706     C**********           ENDIF                                                     MD026385 249924
310300230706      **********                                                                       246309 249924
310400230706     C**********           MOVEL*BLANKS   BBCRNM                                       246309 249924
310500230706     C**********           MOVEL*BLANKS   BBCRTN                                       246309 249924
310600230706      **Check*Overflow                                                                 246309 249924
310700230706     C********** *IN80     IFEQ '1'                                                    246309 249924
310800230706     C**********           WRITELER180A1                                               246309 249924
310900230706     C**********           WRITELER180A2                                               246309 249924
311000230706     C**********           SETOF                     80                                246309 249924
311100230706     C**********           ENDIF                                                       246309 249924
311200230706      **********                                                                       246309 249924
311300230706     C**********           ENDDO                                                       246309 249924
311400230706      **********                                                                       246309 249924
311500230706     C**********           Z-ADD0         T                                            246309 249924
311600230706     C**********           MOVEA*ALL'9'   ARAC,1                                       246309 249924
311700230706     C**********           ENDIF                                                       246309 249924
311800230706      **********                                                                       246309 249924
311900230706     C**********           Z-ADD0         T                                            246309 249924
312000230706     C**********           Z-ADD0         T2                                           246309 249924
312100230706     C**********           MOVEA*ALL'9'   ARAC,1                                       246309 249924
312200230706     C**********           MOVEL@VCNUM    FECNUM                                       246309 249924
312300230706     C**********           MOVEL@VFAC     FTYP                                         246309 249924
312400230706     C**********           MOVEL@VSEQ     FSEQ                                         246309 249924
312500230706      **********                                                                       246309 249924
312600230706     C**********           ENDSR                                                       246309 249924
312700230706     C********************************************************************
312800230706     C*
312900230706     C*  AVCALC -- Calculation of fees based on average balances
313000230706     C*
313100230706     C*  CALLED FROM: Main Processing
313200230706     C*
313300230706     C*  CALLS: NOTHING
313400230706     C*
313500230706     C********************************************************************
313600230706     C           AVCALC    BEGSR
313700230706      *
313800230706      ** Obtain original facility details from facility history header.
313900230706      *
314000230706     C           FACKEY    CHAINFACHISH              20
314100230706      *
314200230706     C           *IN20     IFEQ '1'
314300230706     C           *LOCK     IN   LDA
314400230706     C                     MOVEL'LER180'  DBPGM
314500230706     C                     MOVELFECNUM    DBKEY
314600230706     C                     MOVE FEFACL    DBKEY
314700230706     C                     MOVEL'FACHISH' DBFILE           ************
314800230706     C                     Z-ADD17        DBASE            * DBERR 17 *
314900230706     C                     OUT  LDA                        ************
315000230706     C                     EXSR AUDIT
315100230706     C                     EXSR *PSSR
315200230706     C                     END
315300230706     C*
315400230706     C                     Z-ADD0         WAMT   130
315500230706     C                     Z-ADD0         WPCT    63
315600230706     C*
315700230706     C***  Set up Start and End dates
315800230706     C*
315900230706     C                     MOVE '0'       *IN19                           100658
316000230706     C           FELPDT    IFLT CODT                                      052703
316100230706     C                     Z-ADDFELPDT    STDATE  50     19
316200230706     C                     ELSE                                           052703
316300230706     C                     Z-ADDFEPLPD    STDATE                          052703
316400230706     C           STDATE    IFEQ 0                                         100658
316500230706     C                     MOVE '1'       *IN19                           100658
316600230706     C                     END                                            100658
316700230706     C                     END                                            052703
316800230706     C   19                Z-ADDFEPSTD    STDATE
316900230706     C                     Z-ADDCODT      ENDATE  50
317000230706     C           FEPEND    IFLE CODT
317100230706     C                     Z-ADDFEPEND    ENDATE
317200230706     C                     END
317300230706      *
317400230706      ** Obtain number of days to use.
317500230706      *
317600230706     C********** ENDATE    SUB  STDATE    WDAYS   50                      CLE013
317700230706     C                     Z-ADDSTDATE    ZZBEG                           CLE013
317800230706     C                     Z-ADDENDATE    ZZEND                           CLE013
317900230706     C                     MOVE FECALC    ZZCALC                          CLE013
318000230706     C                     EXSR ZINTDY                                    CLE013
318100230706     C           FECALC    IFEQ 6                                                             212048
318200230706     C           NLEAP     ADD  LEAP50    INT6DY                                            MD060411
318300230706     C           FECALT    IFEQ '01'                                                        MD060411
318400230706     C           FECALT    OREQ '02'                                                        MD060411
318500230706     C           FECALT    OREQ '03'                                                        MD060411
318600230706     C           FECALT    OREQ '11'                                                        MD060411
318700230706     C           FECALT    OREQ '12'                                                        MD060411
318800230706     C           FECALT    OREQ '13'                                                        MD060411
318900230706     C           FECALT    OREQ '21'                                                        MD060411
319000230706     C                     Z-ADDNLEAP     WNLEAP  50                                        MD060411
319100230706     C                     Z-ADDLEAP50    WLEAP5  50                                        MD060411
319200230706     C                     ENDIF                                                            MD060411
319300230706     C                     Z-ADDINT6DY    WDAYS                                               212048
319400230706     C                     ELSE                                                               212048
319500230706     C**********           Z-ADDZZINDY    WDAYS   50                                 CLE013 MD037658
319600230706     C                     Z-ADDZZINDY    WDAYS  159                                        MD037658
319700230706     C                     END                                                                212048
319800230706     C*
319900230706     C*************************************************************101322 138165
320000230706     C***Consider*the*Accrue*on*Last*Day*indicator*when*calculating101322 138165
320100230706     C***for the*due*amount****************************************101322 138165
320200230706     C*************************************************************101322 138165
320300230706     C***********FEPYON    IFEQ 'N'                                101322 138165
320400230706     C***********BKALDI    ANDNE'Y'                                101322 138165
320500230706     C***********FELPDT    IFEQ 0                                  101322 138165
320600230706     C***********FELPDT    ORGE CODT                               101322 138165
320700230706     C***********FEPLPD    ANDEQ0                                  101322 138165
320800230706     C***********          ADD  1         WDAYS                    101322 138165
320900230706     C***********          END                                     101322 138165
321000230706     C***********ENDATE    IFEQ FEPEND                             101322 138165
321100230706     C***********          SUB  1         WDAYS                    101322 138165
321200230706     C***********          END                                     101322 138165
321300230706     C***********          END                                     101322 138165
321400230706     C*
321500230706     C** Get starting amount from facility history file
321600230706     C*
321700230706     C           HSAKY1    SETGTFACHSAL1
321800230706     C                     READPFACHSAL1                 20
321900230706      *
322000230706      ** Set up current facility amount from file.
322100230706      *
322200230706      ** Set up amount for accrual according to calculation type.
322300230706      ** Calculation types 01 to 06 use available facility amount,
322400230706      ** types 11 to 16 use outstanding facility amount and
322500230706      ** types 21 and 22 use the current facility amount.
322600230706      *
322700230706     C           FECALT    IFEQ '01'
322800230706     C           FECALT    OREQ '02'
322900230706     C           FECALT    OREQ '03'
323000230706     C           FAUNDR    IFGE 0
323100230706     C                     Z-ADDFAUNDR    AAMT   130
323200230706     C                     ELSE
323300230706     C                     Z-ADD0         AAMT
323400230706     C                     END
323500230706     C                     ELSE
323600230706     C           FECALT    IFEQ '11'
323700230706     C           FECALT    OREQ '12'
323800230706     C           FECALT    OREQ '13'
323900230706     C                     Z-ADDFADRAM    AAMT
324000230706     C                     ELSE
324100230706     C           FECALT    IFEQ '21'
324200230706     C                     Z-ADDFACFAM    AAMT
324300230706     C                     END
324400230706     C                     END
324500230706     C                     END
324600230706      *
324700230706      ** Initialise work fee field.
324800230706      *
324900230706     C                     Z-ADD0         WFEE   130
325000230706      *                                                                                       CLE071
325100230706     C           CLE071    IFEQ 'Y'                                                           CLE071
325200230706      *                                                                                       CLE071
325300230706     C                     MOVE *BLANK    WRKFRC  1                                           CLE071
325400230706     C           FEHKY1    CHAINLEFHSTLB             75                                       CLE071
325500230706     C           *IN75     IFEQ *OFF                                                          CLE071
325600230706     C                     MOVE 'Y'       WRKFRC                                              CLE071
325700230706     C                     ELSE                                                               CLE071
325800230706     C                     MOVE 'N'       WRKFRC                                              CLE071
325900230706     C                     ENDIF                                                              CLE071
326000230706      *                                                                                       CLE071
326100230706     C                     ENDIF                                                              CLE071
326200230706      *                                                                                       CLE071
326300230706      ** If CLE071 switchable feature is OFF or CLE071 is ON and                              CLE071
326400230706      ** record with FEBRCA,FECNUM,FEFACL,FEFSEQ is not present                               CLE071
326500230706      ** in the history file then do the regular processing                                   CLE071
326600230706      *                                                                                       CLE071
326700230706     C           CLE071    IFEQ 'N'                                                           CLE071
326800230706     C           CLE071    OREQ 'Y'                                                           CLE071
326900230706     C           WRKFRC    ANDEQ'N'                                                           CLE071
327000230706      *
327100230706      ** Read file until date read is greater than date of end of
327200230706      ** this accrual period.
327300230706      ** NDAYS is the number of days in this accrual.
327400230706      *
327500230706     C                     MOVE '0'       *IN18
327600230706     C           *IN18     DOWEQ'0'
327700230706     C           HSAKY2    READEFACHSAL1                 18
327800230706      *
327900230706     C           *IN18     IFEQ '1'
328000230706     C           FADATE    ORGT ENDATE
328100230706     C                     Z-ADDENDATE    FADATE
328200230706     C                     MOVE '1'       *IN18
328300230706     C                     END
328400230706      *
328500230706     C********** FADATE    SUB  STDATE    NDAYS   50                      CLE013
328600230706     C                     Z-ADDSTDATE    ZZBEG                           CLE013
328700230706     C                     Z-ADDFADATE    ZZEND                           CLE013
328800230706     C                     MOVE FECALC    ZZCALC                          CLE013
328900230706     C                     EXSR ZINTDY                                    CLE013
329000230706     C           FECALC    IFEQ 6                                                             212048
329100230706     C           NLEAP     ADD  LEAP50    INT6DY                                            MD060411
329200230706     C                     Z-ADDINT6DY    NDAYS                                               212048
329300230706     C                     ELSE                                                               212048
329400230706     C**********           Z-ADDZZINDY    NDAYS   50                                 CLE013 MD037658
329500230706     C                     Z-ADDZZINDY    NDAYS  159                                        MD037658
329600230706     C                     END                                                                212048
329700230706      *
329800230706     C***********                                                  101322 138165
329900230706     C***********FADATE    IFEQ ENDATE                             101322 138165
330000230706     C************IN18     ANDEQ'1'                                101322 138165
330100230706     C*************************************************************101322 138165
330200230706     C***Consider*the*Accrue*on*Last*Day*indicator*when*calculating101322 138165
330300230706     C***for*the*due*amount****************************************101322 138165
330400230706     C*************************************************************101322 138165
330500230706     C***********FEPYON    IFEQ 'N'                                101322 138165
330600230706     C***********BKALDI    ANDNE'Y'                                101322 138165
330700230706     C***********FELPDT    IFEQ 0                                  101322 138165
330800230706     C***********FELPDT    ORGE CODT                               101322 138165
330900230706     C***********FEPLPD    ANDEQ0                                  101322 138165
331000230706     C***********          ADD  1         NDAYS                    101322 138165
331100230706     C***********          END                                     101322 138165
331200230706     C***********ENDATE    IFEQ FEPEND                             101322 138165
331300230706     C***********          SUB  1         NDAYS                    101322 138165
331400230706     C***********          END                                     101322 138165
331500230706     C***********          END                                     101322 138165
331600230706     C***********          END                                     101322 138165
331700230706      *
331800230706     C           NDAYS     IFGT 0
331900230706      *
332000230706      ** Average amount used (only does accrual once)
332100230706      *
332200230706     C                     MULT NDAYS     AAMT
332300230706     C                     DIV  WDAYS     AAMT      H
332400230706     C                     ADD  AAMT      WAMT
332500230706     C                     Z-ADDFADATE    STDATE
332600230706     C                     END
332700230706      *
332800230706      ** Reset amount to accrue - comes from next record on amounts
332900230706      ** file.
333000230706      *
333100230706     C           FECALT    IFEQ '01'
333200230706     C           FECALT    OREQ '02'
333300230706     C           FECALT    OREQ '03'
333400230706     C           FAUNDR    IFGE 0
333500230706     C                     Z-ADDFAUNDR    AAMT
333600230706     C                     ELSE
333700230706     C                     Z-ADD0         AAMT
333800230706     C                     END
333900230706     C                     ELSE
334000230706     C           FECALT    IFEQ '11'
334100230706     C           FECALT    OREQ '12'
334200230706     C           FECALT    OREQ '13'
334300230706     C                     Z-ADDFADRAM    AAMT
334400230706     C                     ELSE
334500230706     C           FECALT    IFEQ '21'
334600230706     C                     Z-ADDFACFAM    AAMT
334700230706     C                     END
334800230706     C                     END
334900230706     C                     END
335000230706     C                     END
335100230706     C*
335200230706     C                     MOVEAFEAM      WAM                                                 CLE071
335300230706     C                     MOVEAFRT       WRT                                                 CLE071
335400230706     C                     MOVE FEPIND    WKPIND                                              CLE071
335500230706      *                                                                                       CLE071
335600230706     C/COPY WNCPYSRC,LER180C007
335700230706     C           FECALC    IFEQ 6                                                           MD060411
335800230706     C           FECALT    IFEQ '01'                                                        MD060411
335900230706     C           FECALT    OREQ '02'                                                        MD060411
336000230706     C           FECALT    OREQ '03'                                                        MD060411
336100230706     C           FECALT    OREQ '11'                                                        MD060411
336200230706     C           FECALT    OREQ '12'                                                        MD060411
336300230706     C           FECALT    OREQ '13'                                                        MD060411
336400230706     C           FECALT    OREQ '21'                                                        MD060411
336500230706     C                     Z-ADDWNLEAP    NLEAP                                             MD060411
336600230706     C                     Z-ADDWLEAP5    LEAP50                                            MD060411
336700230706     C                     ENDIF                                                            MD060411
336800230706     C                     ENDIF                                                            MD060411
336900230706     C                     EXSR ACCRUE
337000230706     C                     Z-ADDWTOT      WFEE
337100230706      *                                                                                       CLE071
337200230706     C                     ENDIF                                                              CLE071
337300230706      *                                                                                       CLE071
337400230706      ** If the switchable feature CLE071 is ON then do the process                           CLE071
337500230706      ** according to the Value dating of Rate changes to Fees                                CLE071
337600230706      *                                                                                       CLE071
337700230706     C           CLE071    IFEQ 'Y'                                                           CLE071
337800230706     C           WRKFRC    ANDEQ'Y'                                                           CLE071
337900230706      *                                                                                       CLE071
338000230706     C                     MOVE '0'       *IN18                                               CLE071
338100230706     C           *IN18     DOWEQ'0'                                                           CLE071
338200230706     C           HSAKY2    READEFACHSAL1                 18                                   CLE071
338300230706      *                                                                                       CLE071
338400230706     C           *IN18     IFEQ '1'                                                           CLE071
338500230706     C           FADATE    ORGT ENDATE                                                        CLE071
338600230706     C                     Z-ADDENDATE    FADATE                                              CLE071
338700230706     C                     MOVE '1'       *IN18                                               CLE071
338800230706     C                     ENDIF                                                              CLE071
338900230706      *                                                                                       CLE071
339000230706     C           FECALC    IFEQ 6                                                           MD060411
339100230706     C           FECALT    IFEQ '01'                                                        MD060411
339200230706     C           FECALT    OREQ '02'                                                        MD060411
339300230706     C           FECALT    OREQ '03'                                                        MD060411
339400230706     C           FECALT    OREQ '11'                                                        MD060411
339500230706     C           FECALT    OREQ '12'                                                        MD060411
339600230706     C           FECALT    OREQ '13'                                                        MD060411
339700230706     C           FECALT    OREQ '21'                                                        MD060411
339800230706     C                     Z-ADDWNLEAP    NLEAP                                             MD060411
339900230706     C                     Z-ADDWLEAP5    LEAP50                                            MD060411
340000230706     C                     ENDIF                                                            MD060411
340100230706     C                     ENDIF                                                            MD060411
340200230706     C                     EXSR PRCFRC                                                        CLE071
340300230706      *                                                                                       CLE071
340400230706     C           FECALT    IFEQ '01'                                                          CLE071
340500230706     C           FECALT    OREQ '02'                                                          CLE071
340600230706     C           FECALT    OREQ '03'                                                          CLE071
340700230706      *                                                                                       CLE071
340800230706     C           FAUNDR    IFGE 0                                                             CLE071
340900230706     C                     Z-ADDFAUNDR    AAMT                                                CLE071
341000230706     C                     ELSE                                                               CLE071
341100230706     C                     Z-ADD0         AAMT                                                CLE071
341200230706     C                     ENDIF                                                              CLE071
341300230706      *                                                                                       CLE071
341400230706     C                     ENDIF                                                              CLE071
341500230706      *                                                                                       CLE071
341600230706     C           FECALT    IFEQ '11'                                                          CLE071
341700230706     C           FECALT    OREQ '12'                                                          CLE071
341800230706     C           FECALT    OREQ '13'                                                          CLE071
341900230706     C                     Z-ADDFADRAM    AAMT                                                CLE071
342000230706     C                     ENDIF                                                              CLE071
342100230706      *                                                                                       CLE071
342200230706     C           FECALT    IFEQ '21'                                                          CLE071
342300230706     C                     Z-ADDFACFAM    AAMT                                                CLE071
342400230706     C                     ENDIF                                                              CLE071
342500230706      *                                                                                       CLE071
342600230706     C                     ENDDO                                                              CLE071
342700230706      *                                                                                       CLE071
342800230706     C                     ENDIF                                                              CLE071
342900230706      *                                                                                       CLE071
343000230706     C                     ENDSR
343100230706     C/EJECT
343200230706      *****************************************************************
343300230706     C/TITLE SR/ACCRUE
343400230706      *****************************************************************
343500230706      *
343600230706      *  ACCRUE - SUBROUTINE TO CALCULATE ACCRUAL AMOUNT
343700230706      *
343800230706      *  CALLED FROM: AVCALC
343900230706      *
344000230706      *  CALLS: ZXRATE, ZCONV, LSTRAT, AOCURRR0
344100230706      *
344200230706      *****************************************************************
344300230706      *
344400230706     C           ACCRUE    BEGSR
344500230706      *
344600230706     C                     Z-ADD0         WTOT
344700230706      *
344800230706      ** Calculate percentage if required.
344900230706      ** Use original facility amount for average.
345000230706      *
345100230706     C********** FEPIND    IFNE 'A'                                                           CLE071
345200230706     C           WKPIND    IFNE 'A'                                                           CLE071
345300230706     C           FHOFAM    IFGT 0                                                             246018
345400230706     C           FHOFAM    IFNE 0                                                             246309
345500230706     C           WAMT      DIV  FHOFAM    WRK155    H
345600230706     C                     ELSE                                                               246309
345700230706     C                     Z-ADD0         WRK155                                              246309
345800230706     C                     ENDIF                                                              246309
345900230706     C                     ELSE                                                               246018
346000230706     C                     Z-ADD0         WRK155                                              246018
346100230706     C                     ENDIF                                                              246018
346200230706     C           WRK155    MULT 100       WPCT
346300230706     C                     Z-ADDFHOFAM    WAMT
346400230706     C           WPCT      IFGT 100
346500230706     C                     Z-ADD100       WPCT
346600230706     C                     END
346700230706     C                     END
346800230706      *
346900230706      ** Convert from facility to fee currency if required.
347000230706      ** If exchange rate field on fees master file is blank
347100230706      ** obtain cross-currency exchange rate for these
347200230706      ** two currencies from the standing data files otherwise use
347300230706      ** exchange rate on fees master file.
347400230706      *
347500230706     C           FHFCCY    IFNE FEFCCY
347600230706     C                     Z-ADDWAMT      CAMT   130
347700230706     C           FEERAT    IFEQ 0
347800230706     C                     MOVE FHFCCY    INCCY   3
347900230706     C                     MOVE FEFCCY    OUTCCY  3
348000230706     C                     Z-ADD1         X
348100230706     C           INCCY     LOKUPCURR,X                   13
348200230706     C           *IN13     IFEQ '1'
348300230706     C                     MOVE MTDV,X    ZMDI1   1
348400230706     C                     Z-ADDCSPT,X    ZRATE1 138
348500230706     C                     Z-ADDCCDP,X    ZNBDP1  10
348600230706     C                     END
348700230706      *
348800230706     C                     Z-ADD1         X
348900230706     C           OUTCCY    LOKUPCURR,X                   14
349000230706     C           *IN14     IFEQ '1'
349100230706     C                     MOVE MTDV,X    ZMDI2   1
349200230706     C                     Z-ADDCSPT,X    ZRATE2 138
349300230706     C                     Z-ADDCCDP,X    ZNBDP2  10
349400230706     C                     END
349500230706      *
349600230706      ** Obtain cross exchange rate & cross multiply/divide indicator.
349700230706      *
349800230706     C                     EXSR ZXRATE
349900230706     C*                                                                   S01408
350000230706     C/COPY WNCPYSRC,LER180CCP1                                           S01408
350100230706     C*                                                                   S01408
350200230706      *
350300230706      ** Set up input fields for conversion subroutine.
350400230706      *
350500230706     C                     Z-ADDZRATEX    ZEXCH  138
350600230706     C                     MOVE ZMDIX     ZMD     1
350700230706     C                     Z-ADDCAMT      ZAMTCI 150
350800230706     C                     MOVE INCCY     ZCCYI   3
350900230706     C                     MOVE OUTCCY    ZCCYO   3
351000230706     C                     Z-ADDZNBDP1    ZCDPI   10
351100230706     C                     Z-ADDZNBDP2    ZCDPO   10
351200230706      *
351300230706     C                     EXSR ZCONV
351400230706      *
351500230706     C                     Z-ADDZAMTCO    CAMT
351600230706      *
351700230706      ** Exchange rate not blank
351800230706      *
351900230706     C                     ELSE
352000230706      *
352100230706     C**********           CALL 'AOCURRR0'                                                    CSC042
352200230706     C**********           PARM '*MSG   ' WRTCD   7                                           CSC042
352300230706     C**********           PARM '*KEY   ' WOPTN   7                                           CSC042
352400230706     C**********           PARM FHFCCY    WAJCD   3                                           CSC042
352500230706     C********** SDCURR    PARM SDCURR    DSSDY                                               CSC042
352600230706     C********** WRTCD     IFNE *BLANKS                                                       CSC042
352700230706     C                     MOVELFHFCCY    ##KC                                                CSC042
352800230706     C                     EXSR ##CHKC                                                        CSC042
352900230706     C           ##FIC     IFEQ 'Y'                                                           CSC042
353000230706     C                     EXSR ##SETC                                                        CSC042
353100230706     C                     ELSE                                                               CSC042
353200230706     C           *LOCK     IN   LDA
353300230706     C                     MOVEL'LER180'  DBPGM
353400230706     C**********           MOVEL'SDCURRPD'DBFILE           ************                       CSC042
353500230706     C                     MOVEL'CURR,Q  'DBFILE           ************                       CSC042
353600230706     C                     Z-ADD18        DBASE            * DBERR 18 *
353700230706     C                     MOVELFHFCCY    DBKEY            ************
353800230706     C                     OUT  LDA
353900230706     C                     EXSR AUDIT
354000230706     C                     EXSR *PSSR
354100230706     C                     END
354200230706      *
354300230706      ** Set up currency decimal place power position.
354400230706      *
354500230706     C           A6NBDP    ADD  4         FD      10
354600230706      *
354700230706      ** Fee currency decimal places + 1.
354800230706      *
354900230706     C                     Z-ADDP         TD      10
355000230706      *
355100230706      ** Adjust incoming amount for from CCY decimal places.
355200230706      *
355300230706     C           CAMT      DIV  POWER,FD  WRK153
355400230706      *
355500230706      ** Exchange rate conversion.
355600230706      *
355700230706     C           FEMDIN    IFEQ 'M'
355800230706     C                     MULT FEERAT    WRK153
355900230706     C                     ELSE
356000230706     C                     DIV  FEERAT    WRK153    H
356100230706     C                     END
356200230706      *
356300230706      ** Adjust calculated amount for to currency decimal places.
356400230706      *
356500230706     C           WRK153    MULT POWER,TD  CAMT
356600230706      *
356700230706     C                     END
356800230706     C                     Z-ADDCAMT      WAMT
356900230706     C                     END
357000230706      *
357100230706      ** Look up factor for division corresponding to calc. basis
357200230706      *
357300230706     C                     MOVE '0'       *IN25
357400230706     C           FECALC    LOKUPTABCAL    TABCBS         25
357500230706     C                     MOVE TABCBS    WCBS    50
357600230706      *
357700230706      ** TIERED CALCULATION:
357800230706      ** ------------------
357900230706      *
358000230706     C           FECALT    IFEQ '01'
358100230706     C           FECALT    OREQ '11'
358200230706      *
358300230706      ** Amount (not percentage)
358400230706      *
358500230706     C********** FEPIND    IFEQ 'A'                                                           CLE071
358600230706     C           WKPIND    IFEQ 'A'                                                           CLE071
358700230706      *
358800230706      ** Convert limit amounts for fee decimal places.
358900230706      *
359000230706     C********** FEAM      MULT POWER,P   FAM                                                 CLE071
359100230706     C           WAM       MULT POWER,P   FAM                                                 CLE071
359200230706     C                     Z-ADD0         WFAM
359300230706     C                     Z-ADDWAMT      WOAMT
359400230706     C                     Z-ADD1         X
359500230706     C           WAMT      DOWGT0
359600230706     C           X         ANDLT6
359700230706      *
359800230706     C           WOAMT     IFLT FAM,X
359900230706     C           FAM,X     OREQ 0
360000230706     C********** WAMT      MULT FRT,X     WRK15                                               CLE071
360100230706     C           WAMT      MULT WRT,X     WRK15                                               CLE071
360200230706     C                     ELSE
360300230706     C           FAM,X     SUB  WFAM      WRK15
360400230706     C**********           MULT FRT,X     WRK15                                               CLE071
360500230706     C                     MULT WRT,X     WRK15                                               CLE071
360600230706     C                     END
360700230706     C                     ADD  WRK15     WTOT
360800230706     C                     SUB  FAM,X     WAMT
360900230706     C                     ADD  WFAM      WAMT
361000230706     C                     Z-ADDFAM,X     WFAM
361100230706      *
361200230706     C                     ADD  1         X
361300230706      *
361400230706     C                     END
361500230706      *                                                                   BH3451
361600230706      ** Calculate final accrual amount.                                  BH3451
361700230706      *                                                                   BH3451
361800230706     C**********           MULT WDAYS     WTOT                                       BH3451 MD046351
361900230706     C**********           DIV  WCBS      WTOT      H                                BH3451 MD046351
362000230706      *                                                                                     MD046351
362100230706     C           FECALC    IFEQ 6                                                           MD060411
362200230706     C           WTOT      MULT NLEAP     ZWK30A 309                                        MD060411
362300230706     C           WTOT      MULT LEAP50    ZWK30B 309                                        MD060411
362400230706     C           ZWK30A    DIV  36500     WTOT1  309                                        MD060411
362500230706     C           ZWK30B    DIV  36600     WTOT2  309                                        MD060411
362600230706     C           WTOT1     ADD  WTOT2     ZWK309    H                                       MD060411
362700230706     C                     ELSE                                                             MD060411
362800230706     C           WTOT      MULT WDAYS     ZWK309 309                                        MD046351
362900230706     C                     DIV  WCBS      ZWK309    H                                       MD046351
363000230706     C                     ENDIF                                                            MD060411
363100230706     C                     Z-ADDZWK309    WTOT      H                                       MD046351
363200230706      *
363300230706     C                     ELSE
363400230706      *
363500230706      ** - PERCENTAGE:
363600230706      *
363700230706     C********** FEAM      DIV  1000      FPC                                                 CLE071
363800230706     C           WAM       DIV  1000      FPC                                                 CLE071
363900230706      *
364000230706     C                     Z-ADD0         WFPC
364100230706     C                     Z-ADDWPCT      WOPCT
364200230706     C                     Z-ADD1         X
364300230706     C           WPCT      DOWGT0
364400230706     C           X         ANDLT6
364500230706      *
364600230706     C           WOPCT     IFLT FPC,X
364700230706     C           FPC,X     OREQ 0
364800230706     C           WAMT      MULT WPCT      WRK15
364900230706     C                     ELSE
365000230706     C           FPC,X     SUB  WFPC      WRK63
365100230706     C           WAMT      MULT WRK63     WRK15
365200230706     C                     END
365300230706     C**********           MULT FRT,X     WRK15                                               CLE071
365400230706     C                     MULT WRT,X     WRK15                                               CLE071
365500230706     C                     DIV  100       WRK15     H
365600230706     C                     ADD  WRK15     WTOT
365700230706     C                     SUB  FPC,X     WPCT
365800230706     C                     ADD  WFPC      WPCT
365900230706     C                     Z-ADDFPC,X     WFPC
366000230706      *
366100230706     C                     ADD  1         X
366200230706      *
366300230706     C                     END
366400230706      *                                                                   BH3451
366500230706      ** Calculate final accrual amount.                                  BH3451
366600230706      *                                                                   BH3451
366700230706     C**********           MULT WDAYS     WTOT                                       BH3451 MD046351
366800230706     C**********           DIV  WCBS      WTOT      H                                BH3451 MD046351
366900230706      *                                                                                     MD046351
367000230706     C           FECALC    IFEQ 6                                                           MD060411
367100230706     C           WTOT      MULT NLEAP     ZWK30A                                            MD060411
367200230706     C           WTOT      MULT LEAP50    ZWK30B                                            MD060411
367300230706     C           ZWK30A    DIV  36500     WTOT1                                             MD060411
367400230706     C           ZWK30B    DIV  36600     WTOT2                                             MD060411
367500230706     C           WTOT1     ADD  WTOT2     ZWK309    H                                       MD060411
367600230706     C                     ELSE                                                             MD060411
367700230706     C           WTOT      MULT WDAYS     ZWK309                                            MD046351
367800230706     C                     DIV  WCBS      ZWK309    H                                       MD046351
367900230706     C                     ENDIF                                                            MD060411
368000230706     C                     Z-ADDZWK309    WTOT      H                                       MD046351
368100230706      *
368200230706     C                     END
368300230706      *
368400230706     C                     END
368500230706      *
368600230706      ** THRESHOLD CALCULATION:
368700230706      ** ---------------------
368800230706      *
368900230706     C           FECALT    IFEQ '02'
369000230706     C           FECALT    OREQ '12'
369100230706      *
369200230706      ** - AMOUNT:
369300230706      *
369400230706     C********** FEPIND    IFEQ 'A'                                                           CLE071
369500230706     C           WKPIND    IFEQ 'A'                                                           CLE071
369600230706      *
369700230706      ** Convert limit amounts for fee decimal places.
369800230706      *
369900230706     C********** FEAM      MULT POWER,P   FAM                                                 CLE071
370000230706     C           WAM       MULT POWER,P   FAM                                                 CLE071
370100230706      *
370200230706      ** Search amount array to find value larger or equal.
370300230706      *
370400230706     C                     Z-ADD1         X
370500230706     C                     MOVE '0'       *IN25
370600230706      *
370700230706     C           WAMT      LOKUPFAM,X                25  25
370800230706     C           *IN25     IFEQ '0'
370900230706     C                     EXSR LSTRAT
371000230706     C                     END
371100230706      *
371200230706     C           *IN25     IFEQ '0'
371300230706     C           Y         ANDEQ0
371400230706     C                     MULT 0         WAMT
371500230706     C                     ELSE
371600230706     C**********           MULT FRT,X     WAMT                                                CLE071
371700230706     C                     MULT WRT,X     WAMT                                                CLE071
371800230706     C                     END
371900230706      *
372000230706     C********** WAMT      MULT WDAYS     WTOT                                              MD046351
372100230706     C**********           DIV  WCBS      WTOT      H                                       MD046351
372200230706      *                                                                                     MD046351
372300230706     C           FECALC    IFEQ 6                                                           MD060411
372400230706     C           WAMT      MULT NLEAP     ZWK30A                                            MD060411
372500230706     C           WAMT      MULT LEAP50    ZWK30B                                            MD060411
372600230706     C           ZWK30A    DIV  36500     WTOT1                                             MD060411
372700230706     C           ZWK30B    DIV  36600     WTOT2                                             MD060411
372800230706     C           WTOT1     ADD  WTOT2     ZWK309    H                                       MD060411
372900230706     C                     ELSE                                                             MD060411
373000230706     C           WAMT      MULT WDAYS     ZWK309                                            MD046351
373100230706     C                     DIV  WCBS      ZWK309    H                                       MD046351
373200230706     C                     ENDIF                                                            MD060411
373300230706     C                     Z-ADDZWK309    WTOT      H                                       MD046351
373400230706      *
373500230706     C                     ELSE
373600230706      *
373700230706      ** - PERCENTAGE:
373800230706      *
373900230706     C********** FEAM      DIV  1000      FPC                                                 CLE071
374000230706     C           WAM       DIV  1000      FPC                                                 CLE071
374100230706      *
374200230706      ** Search percentage array to find value larger or equal.
374300230706      *
374400230706     C                     Z-ADD1         X
374500230706     C                     MOVE '0'       *IN25
374600230706     C           WPCT      LOKUPFPC,X                25  25
374700230706     C           *IN25     IFEQ '0'
374800230706     C                     EXSR LSTRAT
374900230706     C                     END
375000230706     C                     MULT WPCT      WAMT
375100230706      *
375200230706     C           *IN25     IFEQ '0'
375300230706     C           Y         ANDEQ0
375400230706     C                     MULT 0         WAMT
375500230706     C                     ELSE
375600230706     C**********           MULT FRT,X     WAMT                                                CLE071
375700230706     C                     MULT WRT,X     WAMT                                                CLE071
375800230706     C                     END
375900230706      *
376000230706     C                     DIV  100       WAMT      H
376100230706     C********** WAMT      MULT WDAYS     WTOT                                              MD046351
376200230706     C**********           DIV  WCBS      WTOT      H                                       MD046351
376300230706      *                                                                                     MD046351
376400230706     C           FECALC    IFEQ 6                                                           MD060411
376500230706     C           WAMT      MULT NLEAP     ZWK30A                                            MD060411
376600230706     C           WAMT      MULT LEAP50    ZWK30B                                            MD060411
376700230706     C           ZWK30A    DIV  36500     WTOT1                                             MD060411
376800230706     C           ZWK30B    DIV  36600     WTOT2                                             MD060411
376900230706     C           WTOT1     ADD  WTOT2     ZWK309    H                                       MD060411
377000230706     C                     ELSE                                                             MD060411
377100230706     C           WAMT      MULT WDAYS     ZWK309                                            MD046351
377200230706     C                     DIV  WCBS      ZWK309    H                                       MD046351
377300230706     C                     ENDIF                                                            MD060411
377400230706     C                     Z-ADDZWK309    WTOT      H                                       MD046351
377500230706      *
377600230706     C                     END
377700230706      *
377800230706     C                     END
377900230706      *
378000230706      ** SINGLE CALCULATION:
378100230706      ** ------------------
378200230706      *
378300230706     C           FECALT    IFEQ '03'
378400230706     C           FECALT    OREQ '13'
378500230706     C           FECALT    OREQ '21'
378600230706      *
378700230706     C********** WAMT      MULT FRT,1     WTOT                                              MD046351
378800230706     C**********           MULT WDAYS     WTOT                                              MD046351
378900230706     C**********           DIV  WCBS      WTOT      H                                       MD046351
379000230706      *                                                                                     MD046351
379100230706     C********** WAMT      MULT FRT,1     ZWK309                                     MD046351 CLE071
379200230706     C           FECALC    IFEQ 6                                                           MD060411
379300230706     C           WAMT      MULT NLEAP     ZWK30A                                            MD060411
379400230706     C                     MULT WRT,1     ZWK30A                                            MD060411
379500230706     C           WAMT      MULT LEAP50    ZWK30B                                            MD060411
379600230706     C                     MULT WRT,1     ZWK30B                                            MD060411
379700230706     C           ZWK30A    DIV  36500     WTOT1                                             MD060411
379800230706     C           ZWK30B    DIV  36600     WTOT2                                             MD060411
379900230706     C           WTOT1     ADD  WTOT2     ZWK309    H                                       MD060411
380000230706     C                     ELSE                                                             MD060411
380100230706     C           WAMT      MULT WRT,1     ZWK309                                              CLE071
380200230706     C                     MULT WDAYS     ZWK309                                            MD046351
380300230706     C                     DIV  WCBS      ZWK309    H                                       MD046351
380400230706     C                     ENDIF                                                            MD060411
380500230706     C                     Z-ADDZWK309    WTOT      H                                       MD046351
380600230706     C                     END
380700230706      *
380800230706     C                     ENDSR
380900230706      *
381000230706     C********************************************************************
381100230706     C*  SETP  --- Set up counter P for array POWER                       085309
381200230706     C*                                                                   085309
381300230706     C*  CALLED FROM: SRFACY                                              085309
381400230706     C*                                                                   085309
381500230706     C*  CALLS: NOTHING                                                   085309
381600230706     C*                                                                   085309
381700230706     C********************************************************************085309
381800230706     C           SETP      BEGSR                                          085309
381900230706     C*                                                                   085309
382000230706     C** Check the currency decimal places and name for the new ccy       085309
382100230706     C*                                                                   085309
382200230706     C**********           CALL 'AOCURRR0'             99                              085309 CSC042
382300230706     C**********           PARM '*MSG    '@RTCD                                        085309 CSC042
382400230706     C**********           PARM '*KEY    '@OPTN                                        085309 CSC042
382500230706     C**********           PARM FEFCCY    CURKEY  3                                    085309 CSC042
382600230706     C********** SDCURR    PARM SDCURR    DSSDY                                        085309 CSC042
382700230706      *                                                                   085309
382800230706     C********** @RTCD     IFNE *BLANKS                                                085309 CSC042
382900230706     C                     MOVELFEFCCY    ##KC                                                CSC042
383000230706     C                     EXSR ##CHKC                                                        CSC042
383100230706     C           ##FIC     IFEQ 'Y'                                                           CSC042
383200230706     C                     EXSR ##SETC                                                        CSC042
383300230706     C                     ELSE                                                               CSC042
383400230706     C           *LOCK     IN   LDA                        ***************085309
383500230706     C                     MOVELFEFCCY    DBKEY            *  DBERR 06   *085309
383600230706     C                     Z-ADD6         DBASE            ***************085309
383700230706     C**********           MOVEL'SDCURRPD'DBFILE                                       085309 CSC042
383800230706     C                     MOVEL'CURR,Q  'DBFILE                                              CSC042
383900230706     C                     MOVE 'LER180  'DBPGM                           085309
384000230706     C                     SETON                     U7U8                 085309
384100230706     C                     OUT  LDA                                       085309
384200230706     C                     EXSR AUDIT                                     085309
384300230706     C                     EXSR *PSSR                                     085309
384400230706     C                     END                             ** E001        085309
384500230706      *                                                                   085309
384600230706     C           A6NBDP    COMP 1                    323031               085309
384700230706     C   32      A6NBDP    COMP 3                      3233               085309
384800230706     C                     Z-ADDA6NBDP    DP      20                      085309
384900230706     C           DP        ADD  4         P       10                      085309
385000230706     C*                                                                   100431
385100230706     C** Store the fee ccy name for the report headings, to ensure that   100431
385200230706     C** it doesn't get corrupted by subsequent chains with               100431
385300230706     C** facility currency                                                100431
385400230706     C*                                                                   100431
385500230706     C                     MOVELA6CYCD    ULCYCD                                            MD026385
385600230706     C                     MOVELA6CYNM    ULCYNM                          100431
385700230706     C*                                                                   085309
385800230706     C                     ENDSR                                          085309
385900230706     C*
386000230706     C********************************************************************
386100230706     C*  AUDIT --- End of Report Subroutine
386200230706     C*
386300230706     C*  CALLED FROM: Main Processing
386400230706     C*
386500230706     C*  CALLS: NOTHING
386600230706     C*
386700230706     C********************************************************************
386800230706     C           AUDIT     BEGSR
386900230706      *
387000230706     C                     Z-ADD0         PAGE5
387100230706     C           @REP1     ADD  @REP2     @REP
387200230706      *
387300230706      ** Ensure report spool file recorded by RCF
387400230706     C                     Z-ADDSFNUMU    ZSNUMU  60
387500230706     C                     CALL 'ZSFILE'
387600230706     C                     PARM           SEQ     5
387700230706     C                     PARM *BLANKS   SENTY   3
387800230706     C                     PARM           SFILEU
387900230706     C                     PARM           ZSNUMU
388000230706     C                     PARM           ZSERR
388100230706      *
388200230706     C           ZSERR     IFEQ 'Y'
388300230706      ** Error during ZSFILE processing, return to calling program
388400230706     C                     SETON                     U7U8LR
388500230706     C                     RETRN
388600230706     C                     END
388700230706      *
388800230706     C                     WRITELER180E1
388900230706      *
389000230706      ** If an error output database error format
389100230706      *
389200230706     C           *INU7     IFEQ '1'
389300230706     C                     WRITEDBFMT
389400230706     C                     ELSE
389500230706      *
389600230706     C           @REP1     IFEQ 0                          Nothing to
389700230706     C           @REP2     ANDEQ0
389800230706     C                     WRITELER180E3                   Report
389900230706     C                     ELSE
390000230706     C*
390100230706     C** Detail format
390200230706     C*
390300230706     C                     WRITELER180E2
390400230706     C                     END
390500230706     C                     END
390600230706      *
390700230706     C                     ENDSR
390800230706     C/EJECT
390900230706      *****************************************************************
391000230706      *
391100230706      *  LSTRAT SUBROUTINE TO FIND LAST RATE IN AMOUNT/%AGE ARRAY.
391200230706      *
391300230706      *  CALLED FROM:  ACCRUE
391400230706      *
391500230706      *  CALLS:  NOTHING
391600230706      *
391700230706      *****************************************************************
391800230706      *
391900230706     C           LSTRAT    BEGSR
392000230706      *
392100230706     C                     Z-ADD5         Y       20
392200230706     C           Y         DOWGT0
392300230706     C********** FEAM,Y    IFEQ 0                                                             CLE071
392400230706     C********** FRT,Y     ANDNE0                                                             CLE071
392500230706     C           WAM,Y     IFEQ 0                                                             CLE071
392600230706     C           WRT,Y     ANDNE0                                                             CLE071
392700230706     C                     Z-ADDY         X
392800230706     C                     Z-ADD0         Y
392900230706     C                     END
393000230706     C                     SUB  1         Y
393100230706     C                     END
393200230706      *
393300230706     C                     ENDSR
393400230706      *
393500230706      ********************************************************************                    CLE071
393600230706      *                                                                                       CLE071
393700230706      *  PRCFRC - Calculation of fees based on average balances                               CLE071
393800230706      *           for Value dating of Fee Rate changes.                                       CLE071
393900230706      *                                                                                       CLE071
394000230706      *  CALLED FROM:  AVCALC                                                                 CLE071
394100230706      *                                                                                       CLE071
394200230706      *  CALLS:  ZINTDY,ACCRUE                                                                CLE071
394300230706      *                                                                                       CLE071
394400230706      ********************************************************************                    CLE071
394500230706      *                                                                                       CLE071
394600230706     C           PRCFRC    BEGSR                                                              CLE071
394700230706      *                                                                                       CLE071
394800230706     C           FEHKY2    SETGTLEFHSTLB                                                      CLE071
394900230706     C           FEHKY1    REDPELEFHSTLB                 17                                   CLE071
395000230706     C           *IN17     IFEQ '0'                                                           CLE071
395100230706     C                     MOVE HIPIND    PVPIND                                              CLE071
395200230706     C                     MOVE HIAMTX    PVAMTX                                              CLE071
395300230706     C                     MOVE HIFRTX    PVFRTX                                              CLE071
395400230706     C                     ENDIF                                                              CLE071
395500230706      *                                                                                       CLE071
395600230706     C           FEHKY1    READELEFHSTLB                 17                                   CLE071
395700230706     C           *IN17     DOWEQ'0'                                                           CLE071
395800230706     C           HIRCVD    ANDLTFADATE                                                        CLE071
395900230706      *                                                                                       CLE071
396000230706     C                     Z-ADDSTDATE    ZZBEG                                               CLE071
396100230706     C                     Z-ADDHIRCVD    ZZEND                                               CLE071
396200230706     C                     MOVE FECALC    ZZCALC                                              CLE071
396300230706      *                                                                                       CLE071
396400230706     C                     EXSR ZINTDY                                                        CLE071
396500230706      *                                                                                       CLE071
396600230706     C           FECALC    IFEQ 6                                                           MD060411
396700230706     C           NLEAP     ADD  LEAP50    INT6DY                                            MD060411
396800230706     C                     Z-ADDINT6DY    NDAYS                                             MD060411
396900230706     C                     ELSE                                                             MD060411
397000230706     C                     Z-ADDZZINDY    NDAYS                                               CLE071
397100230706     C                     ENDIF                                                            MD060411
397200230706      *                                                                                       CLE071
397300230706     C           NDAYS     IFGT 0                                                             CLE071
397400230706     C                     MULT NDAYS     AAMT                                                CLE071
397500230706     C                     DIV  WDAYS     AAMT                                                CLE071
397600230706     C                     Z-ADDAAMT      WAMT                                                CLE071
397700230706     C                     Z-ADDHIRCVD    STDATE                                              CLE071
397800230706     C                     MOVEAHIAM      WAM                                                 CLE071
397900230706     C                     MOVEAHIRT      WRT                                                 CLE071
398000230706     C                     MOVE PVPIND    WKPIND                                              CLE071
398100230706      *                                                                                       CLE071
398200230706     C                     EXSR ACCRUE                                                        CLE071
398300230706      *                                                                                       CLE071
398400230706     C                     ADD  WTOT      WFEE                                                CLE071
398500230706     C                     ENDIF                                                              CLE071
398600230706      *                                                                                       CLE071
398700230706     C                     MOVE HIPIND    PVPIND                                              CLE071
398800230706     C                     MOVELHIAMTX    PVAMTX                                              CLE071
398900230706     C                     MOVELHIFRTX    PVFRTX                                              CLE071
399000230706      *                                                                                       CLE071
399100230706     C           FEHKY1    READELEFHSTLB                 17                                   CLE071
399200230706     C                     ENDDO                                                              CLE071
399300230706      *                                                                                       CLE071
399400230706     C           STDATE    IFLT FADATE                                                        CLE071
399500230706     C                     Z-ADDSTDATE    ZZBEG                                               CLE071
399600230706     C                     Z-ADDFADATE    ZZEND                                               CLE071
399700230706     C                     MOVE FECALC    ZZCALC                                              CLE071
399800230706      *                                                                                       CLE071
399900230706     C                     EXSR ZINTDY                                                        CLE071
400000230706      *                                                                                       CLE071
400100230706     C           FECALC    IFEQ 6                                                           MD060411
400200230706     C           NLEAP     ADD  LEAP50    INT6DY                                            MD060411
400300230706     C                     Z-ADDINT6DY    NDAYS                                             MD060411
400400230706     C                     ELSE                                                             MD060411
400500230706     C                     Z-ADDZZINDY    NDAYS                                               CLE071
400600230706     C                     ENDIF                                                            MD060411
400700230706      *                                                                                       CLE071
400800230706     C           NDAYS     IFGT 0                                                             CLE071
400900230706     C                     MULT NDAYS     AAMT                                                CLE071
401000230706     C                     DIV  WDAYS     AAMT                                                CLE071
401100230706     C                     Z-ADDAAMT      WAMT                                                CLE071
401200230706     C                     Z-ADDFADATE    STDATE                                              CLE071
401300230706     C                     MOVEAHIAM      WAM                                                 CLE071
401400230706     C                     MOVEAHIRT      WRT                                                 CLE071
401500230706     C                     MOVE PVPIND    WKPIND                                              CLE071
401600230706      *                                                                                       CLE071
401700230706     C                     EXSR ACCRUE                                                        CLE071
401800230706      *                                                                                       CLE071
401900230706     C                     ADD  WTOT      WFEE                                                CLE071
402000230706     C                     ENDIF                                                              CLE071
402100230706      *                                                                                       CLE071
402200230706     C                     ENDIF                                                              CLE071
402300230706      *                                                                                       CLE071
402400230706     C                     ENDSR                                                              CLE071
402500230706      *****************************************************************                     MD055481
402600230706      *  ORIGB - Display Original Borrower on report                  *                     MD055481
402700230706      *                                                               *                     MD055481
402800230706      *  Called by: SRLOAN                                            *                     MD055481
402900230706      *  Calls: None                                                  *                     MD055481
403000230706      *****************************************************************                     MD055481
403100230706     C           ORIGB     BEGSR                                                            MD055481
403200230706      *                                                                                     MD055481
403300230706      ** If participation purchased and system value is using Original                      MD055481
403400230706      ** Borrower.                                                                          MD055481
403500230706      *                                                                                     MD055481
403600230706     C                     MOVE *BLANKS   POLNO                                             MD055481
403700230706     C                     MOVELBBCRNM    WBCRNM 20                                         MD055481
403800230706     C                     MOVELBBCRTN    WBCRTN 10                                         MD055481
403900230706     C           WPTYP     IFEQ 64                                                          MD055481
404000230706     C           WPTYP     OREQ 65                                                          MD055481
404100230706     C           WPTYP     OREQ 68                                                          MD055481
404200230706     C           WPTYP     OREQ 71                                                          MD055481
404300230706     C                     MOVE '1'       *IN38                                             MD055481
404400230706     C                     MOVE WOLNO     POLNO                                             MD055481
404500230706     C                     MOVELPOLNO     KEYC   10                                         MD055481
404600230706      *                                                                                     MD055481
404700230706     C                     CALL 'AOCUSTR0'                                                  MD055481
404800230706     C                     PARM *BLANKS   @RTCD                                             MD055481
404900230706     C                     PARM '*KEY   ' @OPTN                                             MD055481
405000230706     C                     PARM           KEYC                                              MD055481
405100230706     C                     PARM           KEYSTS  7                                         MD055481
405200230706     C           SDCUST    PARM SDCUST    DSSDY                                             MD055481
405300230706      *                                                                                     MD055481
405400230706     C           @RTCD     IFEQ *BLANKS                                                     MD055481
405500230706     C           @RTCD     OREQ '*CUSCLS'                                                   MD055481
405600230706     C                     MOVE BBCRNM    OLNORN                                            MD055481
405700230706     C                     MOVE BBCRTN    OLNORT                                            MD055481
405800230706     C                     ELSE                                                             MD055481
405900230706     C                     MOVE *ALL'*'   OLNORN                                            MD055481
406000230706     C                     MOVE *ALL'*'   OLNORT                                            MD055481
406100230706     C           *LOCK     IN   LDA                         ************                    MD055481
406200230706     C                     MOVELPOLNO     DBKEY             * DBERR 25 *                    MD055481
406300230706     C                     Z-ADD25        DBASE             ************                    MD055481
406400230706     C                     MOVEL'LER180  'DBPGM                                             MD055481
406500230706     C                     MOVEL'SDCUSTPD'DBFILE                                            MD055481
406600230706     C                     SETON                     U7U8                                   MD055481
406700230706     C                     OUT  LDA                                                         MD055481
406800230706     C                     EXSR AUDIT                                                       MD055481
406900230706     C                     EXSR *PSSR                                                       MD055481
407000230706     C                     ENDIF                                                            MD055481
407100230706     C                     ENDIF                                                            MD055481
407200230706     C                     MOVELWBCRNM    BBCRNM                                            MD055481
407300230706     C                     MOVELWBCRTN    BBCRTN                                            MD055481
407400230706      *                                                                                     MD055481
407500230706     C                     ENDSR                                                            MD055481
407600230706     C********************************************************************
407700230706     C*
407800230706     C*  *PSSR --- SUBROUTINE TO HANDLE ABNORMAL ERROR CONDITIONS
407900230706     C*
408000230706     C*  CALLED FROM: AFTER ABNORMAL OPERATION OCCURS
408100230706     C*
408200230706     C*  CALLS: NOTHING
408300230706     C*
408400230706     C********************************************************************
408500230706     C*
408600230706     C           *PSSR     BEGSR                           ** *PSSR **
408700230706     C*
408800230706     C           @RUN      IFEQ *BLANKS
408900230706     C                     MOVE 'Y'       @RUN    1
409000230706     C                     DUMP
409100230706     C                     END
409200230706     C*
409300230706     C                     SETON                     U7U8LR
409400230706     C                     RETRN
409500230706     C*
409600230706     C                     ENDSR                           ** *PSSR **
409700230706     C*
409800230706     C********************************************************************
409900230706      *
410000230706     C/COPY ZSRSRC,ZXRATEZ1
410100230706      *
410200230706     C/COPY ZSRSRC,ZCONVZ1
410300230706      *
410400230706     C/COPY ZSRSRC,ZDATE2Z2
410500230706      *
410600230706     C/COPY ZSRSRC,ZINTDYZ2                                               CLE013
410700230706     C/COPY ZSRSRC,ZDATE9Z3                                               CLE013
410800230706     C/COPY ZSRSRC,ZDAT10Z2                                               CLE013
410900230706     C********************************************************************
411000230706** CPY@   **      OBJECT COPYRIGHT
411100230706(c) Finastra International Limited 2001
411200230706**  POWER - ARRAY OF POWERS FOR CURRENCY CONVERSION
4113002307060000001
4114002307060000010
4115002307060000100
4116002307060001000
4117002307060010000
4118002307060100000
4119002307061000000
412000230706** NARR   ** FEE NARRATIVE
412100230706TIERED
412200230706THRESHLD
412300230706SINGLE
412400230706AVL/AVE/TR
412500230706AVL/AVE/TH
412600230706AVL/AVE/SI
412700230706AVL/ACT/TR
412800230706AVL/ACT/TH
412900230706AVL/ACT/SI
413000230706OUT/AVE/TR
413100230706OUT/AVE/TH
413200230706OUT/AVE/SI
413300230706OUT/ACT/TR
413400230706OUT/ACT/TH
413500230706OUT/ACT/SI
413600230706FAC/AVE/SI
413700230706FAC/ACT/SI
413800230706**   TABCAL/TABCBS - CALCULATION BASES.
413900230706136500236000336000436500536000636600
414000230706**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
4141002307060366073110961461
414200230706**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
414300230706000031059090120151181212243273304334365
414400230706**   ZMNM - MONTHS SHORT NAMES
414500230706JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
414600230706** @YD  USED BY SR. ZDATE9 - YEARS, IN DAYS, CUMULATIVE IN 4 YEAR SPAN    CLE013
41470023070600366007310109601461                                                      CLE013
414800230706** @MD  USED BY SR. ZDATE9 - MONTHS IN DAYS CUMULATIVE THROUGH YEAR       CLE013
41490023070600000000310005900090001200015100181002120024300273003040033400365         CLE013
