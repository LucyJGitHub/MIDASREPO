/*******************************************************************************/
/*                                                                             */
/*       Midas - Customer Lending Module                                       */
/*                                                                             */
/*       V_LEFCAM1 - LE Facility Amendments Zonal                              */
/*                                                                             */
/*       (c) Misys International Banking Systems Ltd. 2013                     */
/*                                                                             */
/*       Last Amend No. AR787635 *CREATE   Date 10Jun13                        */
/*                                                                             */
/*-----------------------------------------------------------------------------*/
/*                                                                             */
/*       AR787635 - Redelivery of AR214066. Also amended CGZONE where clause   */
/*                  to prevent an SQL error when multiple records is           */
/*                  retrieved. (Child: AR787636)                               */
/*       AR214066 - UDF Files are not properly populated during migration.     */
/*                  Created SQL for use in T_GZFAMDEX population.              */
/*                                                                             */
/*******************************************************************************/
  CREATE VIEW                                                                   :
  **********/**********                                                         :
  (                                                                             :
  CGGLOB ,                                                                      :
  SFACT ,                                                                       :
  SFCNO ,                                                                       :
  FATP ,                                                                        :
  VLDT ,                                                                        :
  SSQNO )                                                                       :
  AS                                                                            :
  (SELECT                                                                       :
  CGGLOB,                                                                       :
  CONCAT(SUBSTRING('000',LENGTH(TRIM(FACT)) + 1), FACT) AS SFACT,               :
  CONCAT(SUBSTRING('00',LENGTH(TRIM(FCNO)) + 1), FCNO) AS SFCNO,                :
  FATP ,                                                                        :
  VLDT ,                                                                        :
  CONCAT(SUBSTRING('000',LENGTH(TRIM(SQNO)) + 1), SQNO)  AS SSQNO               :
  FROM LEFCAMPD                                                                 :
  LEFT JOIN GPGLCUSL                                                            :
  ON                                                                            :
  CNUM = CGCUST                                                                 :
  WHERE                                                                         :
  CGZONE IN (SELECT DISTINCT A8ZONE FROM SDBRCHPD)                              :
  ) ;                                                                           :
  LABEL ON COLUMN                                                               :
  **********/**********                                                         :
  (                                                                             :
  CGGLOB  IS 'Global Customer ID'         ,                                     :
  SFACT    IS 'Fac. Type'                 ,                                     :
  SFCNO    IS 'Fac. No.'                  ,                                     :
  FATP    IS 'Amendment type'             ,                                     :
  VLDT    IS 'Value Date'                 ,                                     :
  SSQNO    IS 'Sequence No.' );                                                 :
/*******************************************************************************/
 ;                                                                              :
  label on table     **********/**********                                      :
   is 'Midas LE Facility Amendments Zonal                ';                     :
                                                                                :
