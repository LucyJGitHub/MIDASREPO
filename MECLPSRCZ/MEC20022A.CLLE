000100220214/*********************************************************************/
000200220214/*STD    CLPBASEBND                                                  */
000300220214/*EXI *  TEXT('Midas ME Send prompt to MSMXIMM control')             */
000400220214/*********************************************************************/
000500220214/*                                                                   */
000600220214/*       Midas    - Message Management Module                        */
000700220214/*                                                                   */
000800220214/*       MEC20022A - Send Prompt to MSMXIMM control                  */
000900220214/*                                                                   */
001000220214/*       (c) Finastra International Limited 2021                     */
001100220214/*                                                                   */
001200220214/*       Last Amend No. CSW122 *CREATE     Date 04Oct21              */
001300220214/*                                                                   */
001400220214/*********************************************************************/
001500220214/*                                                                   */
001600220214/*       CSW122 - SWIFT ISO 20022                                    */
001700220214/*                                                                   */
001800220214/*********************************************************************/
001900220214
002000220214             PGM        PARM(&RTN_CODE)
002100220214
002200220214/** Declare variables */
002300220214             DCL        VAR(&RTN_CODE) TYPE(*CHAR) LEN(7)
002400220214             DCL        VAR(&DBPREFIX) TYPE(*CHAR) LEN(2)
002500220214             DCL        VAR(&FLDLEN) TYPE(*DEC) LEN(5 0) VALUE(50)
002600220214             DCL        VAR(&DATA) TYPE(*CHAR) LEN(50)
002700220214
002800220214             COPYRIGHT  TEXT('(c) Finastra International Limited 2021')
002900220214
003000220214/** Global Monitor Message */
003100220214             MONMSG     MSGID(CPF0000 RPG0000 MCH0000) +
003200220214                           EXEC(GOTO ABNORMAL)
003300220214
003400220214/** Send Message to MRUNQ */
003500220214             SNDPGMMSG  MSG('MEC20022A - Send Prompt to MS MX IMM +
003600220214                          Extraction Control') TOMSGQ(MRUNQ)
003700220214
003800220214             CHGVAR     VAR(&RTN_CODE) VALUE(' ')
003900220214
004000220214             ALCOBJ     OBJ((MSMXIMM *DTAQ *EXCL)) WAIT(0)
004100220214             MONMSG     MSGID(CPF1002) EXEC(DO)
004200220214             GOTO       CMDLBL(SEND)
004300220214             ENDDO
004400220214
004500220214/** Start process */
004600220214             CALL       PGM(MEC20022B) PARM(&RTN_CODE)
004700220214             IF         COND((&RTN_CODE *NE '       ')  *AND (&RTN_CODE *NE +
004800220214                          'MIN0619')) THEN(DO)
004900220214             GOTO       CMDLBL(ABNORMAL)
005000220214             ENDDO
005100220214
005200220214             DLCOBJ     OBJ((MSMXIMM *DTAQ *EXCL))
005300220214
005400220214/** Send data queue entry to prompt process */
005500220214 SEND:       CHGVAR     VAR(&DATA) VALUE(' ')
005600220214             CHGVAR     VAR(&DATA) VALUE('Prompt')
005700220214
005800220214             CALL       PGM(QSNDDTAQ) PARM('MSMXIMM' '*LIBL' &FLDLEN &DATA)
005900220214
006000220214             GOTO       CMDLBL(ENDCLPGM)
006100220214
006200220214/** Abnormal termination processing */
006300220214/** Terminate with escape message   */
006400220214ABNORMAL:
006500220214             CHGJOB     SWS(XXXXXX11)
006600220214             MONMSG     MSGID(CPF0000 RPG0000 MCH0000)
006700220214             DLCOBJ     OBJ((MSMXIMM *DTAQ *EXCL))
006800220214             MONMSG     MSGID(CPF0000 RPG0000 MCH0000)
006900220214
007000220214             SNDPGMMSG  MSG('Module MEC20022A ended abnormally') TOMSGQ(MOPERQ +
007100220214                          MRUNQ)
007200220214             MONMSG     MSGID(CPF0000 RPG0000 MCH0000)
007300220214             SNDPGMMSG  MSGID(CPF9898) MSGF(QCPFMSG) MSGDTA('Module MEC20022A +
007400220214                          ended abnormally') MSGTYPE(*ESCAPE)
007500220214             MONMSG     MSGID(CPF0000 RPG0000 MCH0000)
007600220214
007700220214 ENDCLPGM:
007800220214             ENDPGM
