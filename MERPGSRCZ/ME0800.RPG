     H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas ME Format message for printing')                 *
      *****************************************************************
      *                                                               *
      *  Midas - MESSAGE MANAGEMENT MODULE                            *
      *                                                               *
      *  ME0800 - OUTGOING MESSAGE DETAILS - PRINT FORMAT             *
      *                                                               *
      *  (c) Misys International Banking Systems Ltd. 2001            *
      *                                                               *
      *  Last Amend No. MD052485           Date 02Apr19               *
      *  Prev Amend No. MD022050           Date 11Sep13               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *                 BUG14915           Date 25Sep07               *
      *                 204225             Date 05Aug07               *
      *                 CSW207             Date 14Jun07               *
      * Midas Plus 1.4 Base ------------------------------------------*
      *                 121288             Date 15Dec06               *
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 223076             Date 18Sep06               *
      *                 CSD031             Date 10Apr06               *
      *                 204225             Date 02May06               *
      *                 206803             Date 10Jul02               *
      *                 CME001             Date 07Mar06               *
      *                 CSD027             Date 09Dec05               *
      *                 CSW037A            Date 02May05               *
      *                 BUG6198            Date 04Apr05               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 CLE025             Date 20Oct03               *
      *                 CGL029             Date 01Sep03               *
      *                 210868             Date 19Dec02               *
      *                 219242             Date 01Jul03               *
      *                 219241             Date 01Jul03               *
      * Midas Release 4.01.02 ----------------------------------------*
      *                 212173             Date 18Nov02               *
      * Midas Release 4.01 -------------------------------------------*
      *                 158656             Date 11Dec01               *
      * Midas Release 4 --------------- Base -------------------------*
      *                 196833             Date 16Aug01               *
      *                 183583             Date 08Jun01               *
      * Midas DBA 3.05 -----------------------------------------------*
      * Midas DBA 3.04 -----------------------------------------------*
      *                 186181             Date 10Nov00               *
      * Midas DBA 3.03 -----------------------------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 141572             Date 21Sep98               *
      *                 CMT001             DATE 02NOV98               *
      *                 140629             DATE 18SEP98               *
      *                 CSW098             DATE 24MAR98               *
      *                 113352             DATE 13FEB97               *
      *                 107503             DATE 11APR97               *
      *                 CSW097             DATE 26MAY97               *
      *                 S01408             DATE 14NOV96               *
      *                 099234             DATE 09JUL96               *
      *                 S01408             DATE 02AUG95               *
      *                 081561             DATE 12JAN95               *
      *                 081505             DATE 06DEC94               *
      *                 066991             DATE 12OCT94               *
      *                 S01435             DATE 10NOV93               *
      *                 043888             DATE 15SEP93               *
      *                 E43198             DATE 24OCT92               *
      *                 E42972             DATE 10JUL92               *
      *                 E32647             DATE 30APR92               *
      *                 E29588             DATE 31OCT91               *
      *                                                               *
      *****************************************************************
      *                                                               *
      *  MD052485 - MT202 F52A + F57A incorrect field data in SpA Ldn *
      *             printed report vs. MPM.                           *
      *  MD022050 - Various errors in MT360 for counterparty          *
      *  BUG14915 - Error in using Corporate BEI field                *
      *  204225 - Field tag :50: is incorrect on SWIFT MT103.         *
      *           CROSSMAR customers must be checked first before tag *
      *           :50A: or tag :50K: is written/shown on MT103.       *
      *  CSW207 - SWIFT 2007 Changes                                  *
      *  121288 - Print 'Deliverer of Securities' as text if second   *
      *           occurrence of field tag 87. (1st occurrence in an   *
      *           MT512 is always 'Receiver of Securities').          *
      *  223076 - Ensure that the correct record is accessed in       *
      *           MGOEXTPD for fields 5Na and 8Na for MT103s with     *
      *           field :119:. Applied fix 206803.                    *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  204225 - Field tag :50: is incorrect on SWIFT MT103.         *
      *           CROSSMAR customers must be checked first before tag *
      *           :50A: or tag :50K: is written/shown on MT103.       *
      *  206803 - Ensure that the correct record is accessed in       *
      *           MGOEXTPD for fields 5Na and 8Na for MT103s with     *
      *           field :119:.                                        *
      *  CME001 - Upgrade LBV042/LBV049 to Midas Plus.                *
      *           Amend so that reports ME0810P1, ME0820P1, ME0830P1, *
      *           ME0845P1, ME0880P1 and ME0890P1 do not show         *
      *           <NOT VERIFIED>.                                     *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  BUG6198- Cannot save new Details for CUSD (Recompile)        *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  CLE025 - Credit Lines (Recompile)                            *
      *  CGL029 - Increase Account Code to 10 digits (Recompile)      *
      *  210868 - In MT202, data replicated in field 57A:.            *
      *  219242 - Not possible to create MT103+ payment msg from      *
      *           non-FT transaction (Recompile)                      *
      *  219241 - Defaulting of "Details of Charges" assign a         *
      *           system value (Recompile)                            *
      *  212173 - Process validation fields for MT103s                *
      *  158656 - Fix 183583 made it mandatory to have a record in    *
      *           PF/MGOEXTPD to display the report name and town     *
      *           of the Swift Address of field tag :5nA:. Replace    *
      *           BIC customer parameter only if a record exists.     *
      *  196833 - Additional SWIFT Address for CLS Nostros            *
      *  183583 - Add extension file MGOEXTPD to store customer no.   *
      *           of field with SWIFT address.                        *
      *  141572 - Recompile over changes in MGOREFPD                  *
      *  CMT001 - Orion Telex 3.3 Implementation.                     *
      *           Addition of new Telex status codes.                 *
      *  140629 - Convert field 72 amount (, to .)                    *
      *  CSW098 - SWIFT 1998 changes.                                 *
      *           This program is changed to recognise MT515/518      *
      *           tags :98a: date/time format suffixed with a         *
      *           qualifier and/or type (:qual//type/yyymmddhhmmss).  *
      *           A new tag format 'DT' is introduced to format time  *
      *           to hh:mm:ss.  Also, :95P: (:qual//swiftid) should   *
      *           also be output with name and address as with :5nA:  *
      *           and :8nA: tags.                                     *
      *  113352 - Recompile over changes in MGOREFPD                  *
      *  107503 - If destination is from SWIFT BIC file, output name  *
      *           and city from this file                             *
      *  CSW097 - Swift changes 1997:                                 *
      *           The program was amended to recognise dates          *
      *           in CCYYMMDD format.                                 *
     F*           Also, display name and town for :8nA: fields        *
      *  S01408 - Addition of core hook ME0800EEP2                    *
      *         - Addition of core hook ME0800X001                    *
      *         - Addition of core hook ME0800CCP7                    *
      *         - Addition of core hook ME0800CCP6                    *
      *  099234 - Wrong field being checked for blanks in report      *
      *           town from counterparty nostro file (SDCNSTPD).      *
      *  S01408 - Addition of core hook ME0800EEP1                    *
      *                                 ME0800IIP1                    *
      *                                 ME0800IIP2                    *
      *                                 ME0800CCP1                    *
      *                                 ME0800CCP2                    *
      *                                 ME0800CCP3                    *
      *                                 ME0800CCP4                    *
      *                                 ME0800CCP5                    *
      *  081561 - Additional message status for supervisors added.    *
      *  081505 - Message status text changed (at end of pgm).        *
      *  066991 - Orion not passing Telex status back to Midas        *
      *  S01435 - Incoming Message Management                         *
      *  043888 - Report name and town not printed if a/c number      *
      *           in first line of address                            *
      *  E43198 - Always show TRNO for MT210'S                        *
      *  E42972 - Add report town to name and address fields.         *
      *  E32647 - Non-standard abbreviation for JULY.  Should be      *
      *           "JUL" instead of "JLY".  Amended element 7 of       *
      *           the array used to convert month numbers to text.    *
      *  E29588 - POST-COLLECTION SWIFT RATIONALISATION AMENDMENTS    *
      *           o Do not output SWIFT error line if it contains     *
      *             non-numeric data                                  *
      *           o Check that released-by-user is available before   *
      *             outputting it                                     *
      *           o Add text for Module MX or ME                      *
      *           o Text incorrect for TXT31                          *
      *                                                               *
      *****************************************************************
     FMGOREFL0IF  E           K        DISK
     FMGOMSGPDIF  E           K        DISK
     FMGOEXTLFIF  E           K        DISK                               183583
     FSDMTPYL0IF  E           K        DISK
     FSDMTAGL0IF  E           K        DISK
      * Customer and C/Party nostro files by network address
     FSDCUSTL7IF  E           K        DISK
     F            @CUSTGE                           KRENAMESDCUSTSW
     FSDCNSTL2IF  E           K        DISK
     F            @CNSTLD                           KRENAMESDCNSTSW
     FSDCUSTL9IF  E           K        DISK
     F            @CUSTLG                           KRENAMESDCUSTST
     FSDCNSTL3IF  E           K        DISK
     F            @CNSTLE                           KRENAMESDCNSTST
     FSDCUSTLAIF  E           K        DISK
     F            @CUSTLH                           KRENAMESDCUSTTX
     F/COPY WNCPYSRC,ME0800F001
     FSDCNSTL4IF  E           K        DISK
     F            @CNSTLF                           KRENAMESDCNSTTX
      *
     FSDCUSTLIIF  E           K        DISK                                                   204225
     F            SDCUSTD0                          KRENAMESDCUSTBE                           204225
      *
      *****************************************************************
      * ID C  F  H  L    Function of indicators                       *
      *    10            Check for multiple TRN tag. & check for      *
      *                  verification message type/field.             *
      *    81            USED IN SCAN FOR /OCMT/ AND /CHGS/           *   140629
      *    96            Chain to SDMTPYL1 fails                      *
      *    97            Chain to MGOREFL0 fails                      *
      *    98            Chain to SDMTAGL1 fails                      *
      *    99            Chain to MGOMSGPD fails                      *
      *   U7U8LR         DB error                                     *
      *****************************************************************
      *
      *                                                                   S01408
     E/COPY WNCPYSRC,ME0800EEP2                                           S01408
      *                                                                   S01408
     E                    CPY@    1   1 80
      ** Copyright statement
      *
     E                    TABMM   1  12  2   TABMON  3
      ** Months MM v Months MMM
      *
     E                    TG          5  1
      **  Message field tag
      *
     *********************TXT     1  40 32                                E29588
     E/COPY WNCPYSRC,ME0800E003
     E********************TXT     1  41 32                         E29588 121288
     E                    TXT     1  42 32                                121288
      **  Text to be printed on report
      *
     E/COPY WNCPYSRC,ME0800E001
     E************        VERFY   1   5  6                                                    212173
     E                    VERFY   1   6  6                                                    212173
      **  Message types/fields requiring verification
      *
     E                    TRNTG   1   2  7
      **  Message tag format
     E/COPY WNCPYSRC,ME0800E002
      *
     E******************* TABCD   1  22  4   TABNAR 35                    066991
     E******************* TABCD   1  41  4   TABNAR 35             066991 081561
     E******************* TABCD   1  42  4   TABNAR 35   status cod081561 CMT001
     E                    TABCD   1  49  4   TABNAR 35   status codes     CMT001
     E/COPY WNCPYSRC,ME0800E004
      **  Status code against narrative
      *
     E                    TAB1    1  10  2 0 TAB2   15
      **  Match status narrative
      *
     E                    AMAR       20  1
      **  Array for formatting amounts
      *
     E                    DTE         8  1
      **  Array for formatting dates
      *
     E                    FLD        50  1
      **  Array for formatting fields
      *
     E*                                                                   S01408
     E/COPY WNCPYSRC,ME0800EEP1                                           S01408
     E*                                                                   S01408
     I            DS
     I                                        1 125 SDTAQ
      ** Data structure to hold data queue contents
      *
     I                                        4  12 TEXT1
     I                                       14  15 SMODI
     I                                       34  54 TEXT2
     I                                       56  70 STRNM
     I                                       74  89 TEXT3
     I                                       91  92 STNTY
     I                                       96 103 TEXT4
     I                                      106 107 SSBTP
      ** Module id <X>   Midas transaction no. <X> ...
      **... Transaction type <X>  Sub-type <X>
      *
     I                                       34  48 TEXT5
     I                                       56  61 SXSYS
      ** Module id <X>    External system <X>
      *
     I                                       34  44 TXT35
     I**********                             47  64 SACCN                                     CGL029
     I                                       47  70 SACCN                                     CGL029
      ** Module id <X>    Account No. <X>
      *
     I                                       34  61 TXT41                 E29588
      ** Module id <X>    Input Via Message Management                    E29588
      *
     I                                        4   9 TEXT6
     I                                       11  30 SSADR
     I                                       34  45 TEXT7
     I                                       47  49 SMTPY
     I                                       51  85 SMTPD
      ** Sender <Network address>  Message type <X> <Msg descrip>
      *
     I                                        4  14 TEXT8
     I                                       16  35 SNWDS
     I                                       37  72 SREPN
     I                                       73  92 STOWN
      ** Destination <Network address> <Report name> <Town>
      *
     I                                        4  16 TEXT9
     I                                       18  32 SNWRK
     I                                       34  41 TXT10
     I                                       43  48 SMPRY
     I                                       51  63 TXT11
     I                                       65  71 SMGDE
     I                                       74  94 TXT12
     I                                       96  96 SDELC
     I                                      100 119 TXT13
     I                                      121 121 SDELW
      ** Network/paper <SWIFT> Priority <URGENT> Creation date <ddmmyy >..
      ** .. Delivery notification <Y> Non-delivery warning <Y>
      *
     I                                       74  87 TXT14
     I                                       89  94 STSKS
      ** Network/paper <TELEX> Priority <NORMAL> Creation date <ddmmyy>..
      ** ... Testkey status <TESTED>
      *
     I                                      106 117 TXT15
     I                                      106 117 TXT16
      ** Network/paper PAPER                    Creation date <ddmmmyy> ..
      ** ...                      *** COPY ***
      *
     I                                        4  17 TXT17
     I                                       19  53 SMGST
     I                                       55  70 TXT18
     I                                       72  78 SLADT
     I                                       81  84 TXT19
     I                                       86  93 SLATM
     I                                      102 106 TXT20
     I                                      109 111 SMSE1
     I************************************* 112 114 SELIN                 E29588
     I                                      113 115 SELIN                 E29588
      ** Message status <eg.NAK'ED BY SWIFT> Last action date <ddmmmyy>...
      ** ... time <hh:mm:ss>  Error <T95 003>
      *
     I                                        4  21 TXT21
     I                                       23  32 SRUSR
     I                                       35  45 TXT22
     I                                       47  56 SRWSN
     I                                       80 105 TXT23
      ** Released by - user <X>  workstation <X> *** POSSIBLE DUPLICATE ***
      *
     I/COPY WNCPYSRC,ME0800I002
     I                                        4  14 TXT24
     I                                       66  68 TXT25
     I                                       72  75 TXT26
      ** Description            Tag   Data
      *
     I                                        4  14 TXT27
     I                                       66  68 TXT28
     I                                       72  75 TXT29
      ** -----------            ---   ----
      *
     I                                        4  35 TXT30
     I                                       37  51 SCFCP
     I                                       61  86 TXT31
     I                                       88 102 SCFBR
      ** Counterparty confirmation status <XX> ...
      ** ... Broker confirmation status <XX>
      *
     I                                        4  63 SSWFD
     I                                       65  69 SMTAG
     I                                       71 123 SMFLD
      ** <narrative> <tag> <data>
      *
     I                                        4  16 SPTST
     I                                       19  34 TXT32
     I                                       36  50 SMTRN
     I                                       54  69 TXT3A
     I                                       71  72 STNTP
     I                                       76  83 TXT4A
     I                                       85  86 SSTYP
     I                                       90 101 TXT33
     I                                      103 104 SCFCY
     I                                      108 118 TXT34
     I                                      120 121 SCFBK
      ** <** DELETED **>  Midas trans. no. <X>  Transaction type <X> ..
      ** ... Sub-type <X>  C/party conf <X>  Broker conf <X>
      *
     I/COPY WNCPYSRC,ME0800I001
     I            DS
     I                                        1   6 DAT
     I                                        1   2 YY
     I                                        3   4 MM
     I                                        5   6 DD
      *
     I            DS
     I                                        1   7 DAT2
     I                                        1   2 DD2
     I                                        3   5 MM2
     I                                        6   7 YY2
     I*                                                                   S01408
     I/COPY WNCPYSRC,ME0800IIP1                                           S01408
     I*                                                                   S01408
      ** DS for splitting up date
      *
     ILDA         DS                            256
     I                                      134 141 DBFILE
     I                                      142 170 DBKEY
     I                                      171 180 DBPGM
     I                                      181 1830DBASE
      ** Data structure for DB error reporting
      *
     IDSRUN       DS                             13
     I                                        1   7 RUNA
     I                                       12  12 DATF
     I                                       13  13 MBIN
      **  RUNDAT data area
      *
     I            DS
     I                                        1   8 WRKDAT
     I                                        1   2 WRKDD
     I                                        4   5 WRKMM
     I                                        7   8 WRKYY
      *
      **  Data structure for rearranging date
      *
     I            DS
     I                                        1   8 CHGDAT
     I                                        1   5 @CHG5
     I I            '/'                       3   3 @1
     I I            '/'                       6   6 @@2
     I                                        7   8 CHGYY
      *                                                                   121288
      **                                                                  121288
     I            DS                                                      121288
     I                                        1   5 MTAG                  121288
     I                                        2   3 #TAG23                121288
      *                                                                   CSW097
      ** Data structure to accomodate dates in CCYYMMDD format.           CSW097
      *                                                                   CSW097
     I            DS                                                      CSW097
     I                                        1  10 WKDAT                 CSW097
     I                                        1   2 WKDD                  CSW097
     I                                        4   5 WKMM                  CSW097
     I                                        7  10 WKYY                  CSW097
      *                                                                   CSW097
      ** Data structure to hold date in CCYYMMDD format.                  CSW097
      *                                                                   CSW097
     I            DS                                                      CSW097
     I                                        1  10 CHDAT                 CSW097
     I                                        1   5 @CH5                  CSW097
     I I            '/'                       3   3 @3                    CSW097
     I I            '/'                       6   6 @@4                   CSW097
     I                                        7  10 CHYY                  CSW097
      *                                                                   CSW097
     I            DS                                                      CSW097
     I                                        1   8 DAT3                  CSW097
     I                                        1   4 YY3                   CSW097
     I                                        5   6 MM3                   CSW097
     I                                        7   8 DD3                   CSW097
      *                                                                   CSW097
      ** Data structure to hold defined constants.                        CSW097
      *                                                                   CSW097
     I              '0123456789'          C         DIGITS                CSW097
      *                                                                   CSW097
      ** Data structure MFLD2 to hold the first seven character of MFLD   CSW097
      *                                                                   CSW097
     I            DS                                                      CSW097
     I                                        1   7 MFLD2                 CSW097
     I                                        7   7 CHAR7                 CSW097
     I                                        4   4 CHAR44                186181
     I                                        2   4 CHAR24                186181
     I*                                                                   S01408
     I/COPY WNCPYSRC,ME0800IIP2                                           S01408
     I*                                                                   S01408
     ISCSARD    E DSSCSARDPD                                                                  CME001
      *                                                                   107503
      **  Data structure to split BIC address                             107503
      *                                                                   107503
     I            DS                                                      107503
     I                                        1  12 W01BIC                107503
     I                                        1   8 W01ICC                107503
     I                                        9  11 W01ICB                107503
      *
     ISDMGME    E DSSDMGMEPD
     I** Message Management details.
     I*
     I/COPY WNCPYSRC,ME0800I003
     ISDCUST    E DSSDCUSTPD                                              S01435
      *                                                                   S01435
      *  Calling parameter data structure for AOCUSTR0                    S01435
      *                                                                   S01435
     ISDCNST    E DSSDCNSTPD                                              S01435
      *                                                                   S01435
      *  Calling parameter data structure for ME1400                      S01435
      *                                                                   S01435
     IMEBICD    E DSMEBICDPD                                              S01435
      *                                                                   S01435
      *  Calling parameter data structure for ME1400                      S01435
      *                                                                   S01435
      *                                                                   S01435
      * Layout for BIC directory processing                               S01435
      *                                                                   S01435
     IBICLAY      DS                            125                       S01435
      * Format for Report                                                 S01435
     I                                       71 105 #RPT1                 S01435
     I                                      106 123 #RPT2                 S01435
      /EJECT                                                              S01435
     I/COPY WNCPYSRC,ME0800I004
     IDSFDY     E DSDSFDY
      **  Access object DS
      *
      **  Data structure for rearranging date
      *
     IDSLDY     E DSDSLDY                                                                     196833
      ** Long data structure for access objects                                               196833
      *                                                                                       196833
      *****************************************************************
      *               Index to subroutines                            *
      *               ~~~~~~~~~~~~~~~~~~~~                            *
      *  main process                                                 *
      *  REF     - Process message reference file                     *
      *  DETL    - Process message detail file                        *
      *  FLDPRC  - Process field                                      *
      *  MLTTRN  - Process multiple TRN field                         *
      *  HEADR   - Format message header                              *
      *  MIDHDR  - Output MIDAS details in message header             *
      *  EXTHDR  - Output external system details in message header   *
      *  DESTAD  - Format Msg tytpe/Destination/Sender                *
      *  NETSW   - SWIFT/STTX message details                         *
      *  NETTL   - Telex message details                              *
      *  NETUR   - 'UNable to ROUTe' details                          *
      *  MESST   - Output message status                              *
      *  CONFST  - Output confirmation status                         *
      *  HDDET   - Output header details                              *
      *  SWADDR  - Access Name/Town for SWIFT address                 *
      *  STADDR  - Access Name/Town for STTX address                  *
      *  TXADDR  - Access Name/Town for Telex address                 *
      *  PAPER   - Clear Name/Town fields for paper messages          *
      *  CASR    - Format CCY/AMOUNT subfield                         *
      *  ASR     - Format AMOUNT subfield                             *
      *  DSR     - Format DATE subfield                               *
      *  CATCH   - Catchall format for non-blank but unrecognised     *
      *            format code                                        *
      *  DCASR   - Format DATE/CCY/AMOUNT subfield                    *
      *  *PSSR   - error handling                                     *
      *****************************************************************
      *
     C/EJECT
      *****************************************************************
      *   main processs                                               *
      *   Calls - REF & DETL                                          *
      *****************************************************************
      *                                                                                       CSW207
      **  Declaring program variables                                                         CSW207
      *                                                                                       CSW207
     C                     MOVEL*BLANKS   @RTCD   7        Return Code                        CSW207
     C                     MOVEL*BLANKS   @OPTN   7        Option                             CSW207
     C                     MOVEL*BLANKS   @SARD   6        Switchable feature                 CSW207
     C                     MOVEL*BLANKS   CSW024  1                                           CSW207
     C                     MOVEL*BLANKS   CSW207  1                                           CSW207
     C                     MOVEL*BLANKS   TINO   25                                           CSW207
     C                     MOVEL*BLANKS   IDNO   15                                           CSW207
      *
      **  Access RUNDAT to find run date format
      *
     C           *NAMVAR   DEFN RUNDAT    DSRUN
     C           *LOCK     IN   DSRUN
     C                     OUT  DSRUN
      *
     C           *ENTRY    PLIST
     C                     PARM           PTRN   16
     C                     PARM           PMBI    1
     C                     PARM           PBGCFM  1
     C                     PARM           PERR    1
      *
      ** Set up copyright statement
     C                     MOVEACPY@      BIS@   80
      *
      ** Set up LDA for database errors
     C           *NAMVAR   DEFN           LDA
     C           *LOCK     IN   LDA
     C                     MOVEL'ME0800'  DBPGM
     C                     OUT  LDA
      *
      ** Set up key to MTAG file
     C           MGTAGK    KLIST
     C                     KFLD           MTAGK   5
     C                     KFLD           MTPYK   3
      *                                                                   CSW098
     C           KMTAG     KLIST                                          CSW098
     C                     KFLD           MTAGK                           CSW098
     C                     KFLD           MTPYK                           CSW098
     C                     KFLD           MSEQN   3                       CSW098
      *                                                                   183583
      ** Set up key for extension file.                                   183583
      *                                                                   183583
     C           KEXTN     KLIST                                          183583
     C                     KFLD           TRNO                            183583
     C                     KFLD           MTPY                            183583
     C                     KFLD           @V      20                      183583
      *
      ** Set up PLIST for ZM0100 Confirmation Matching program
     C           PCFM      PLIST
     C                     PARM           CFTRN  16
     C                     PARM *ZEROS    CFCPY   20
     C                     PARM *ZEROS    CFBRK   20
     C                     PARM *BLANKS   CFERR   1
      *
      ** Set up parameters for data queue
     C                     MOVEL'MEDTQPRT'DTAQ   10
     C                     MOVEL'QTEMP'   LIB    10
     C                     Z-ADD125       LEN     50
     C           DATA      PLIST
     C                     PARM           DTAQ
     C                     PARM           LIB
     C                     PARM           LEN
     C                     PARM           SDTAQ
      *
      ** Access SDMGMEPD for verification flag via the access program.
      *
     C                     CALL 'AOMGMER0'
     C                     PARM '*MSG    '@RTCD   7
     C                     PARM '*FIRST  '@OPTN   7
     C           SDMGME    PARM SDMGME    DSFDY
      *
     C           @RTCD     IFNE *BLANK
     C           *LOCK     IN   LDA
     C                     MOVE '01'      DBASE             ***********
     C                     MOVEL'SDMGMEPD'DBFILE            * DBERR 1 *
     C                     MOVEL@OPTN     DBKEY             ***********
     C                     MOVE '1'       PERR
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     END
      *                                                                   CSW098
      ** Check if (CSW098) SWIFT 1998 changes is on                       CSW098
      *                                                                   CSW098
     C                     CALL 'SWIFT98'              7676               CSW098
     C                     PARM *BLANKS   CSW098  7                       CSW098
      *                                                                   CSW098
     C           *IN76     IFEQ '1'                                       CSW098
     C           *LOCK     IN   LDA                                       CSW098
     C                     MOVE '006'     DBASE                           CSW098
     C                     MOVEL'SWIFT98 'KEY16                           CSW098
     C                     MOVE 'ERROR   'KEY16  16        * * * * * * * *CSW098
     C                     MOVELKEY16     DBKEY            *  DBERR 006  *CSW098
     C                     MOVEL*BLANKS   DBFILE           * * * * * * * *CSW098
     C                     MOVE '1'       PERR                            CSW098
     C                     OUT  LDA                                       CSW098
     C                     EXSR *PSSR                                     CSW098
     C                     END                                            CSW098
     C*                                                                   S01408
      ** Check if (CSW207) SWIFT 2007 changes is on                                           CSW207
      *                                                                                       CSW207
     C                     CALL 'SWIF2007'                                                    CSW207
     C                     PARM *BLANKS   @RTCD                                               CSW207
      *                                                                                       CSW207
     C           @RTCD     IFEQ 'CSW2007'                                                     CSW207
     C                     MOVEL'Y'       CSW207                                              CSW207
     C                     ELSE                                                               CSW207
     C                     MOVEL'N'       CSW207                                              CSW207
     C                     ENDIF                                                              CSW207
      **********                                                                     CSW207 BUG14915
      ****Check*if*CSW024*is*switched**ON                                            CSW207 BUG14915
      **********                                                                     CSW207 BUG14915
     C**********           CALL 'AOSARDR0'                                           CSW207 BUG14915
     C**********           PARM *BLANKS   @RTCD                                      CSW207 BUG14915
     C**********           PARM '*VERIFY' @OPTN                                      CSW207 BUG14915
     C**********           PARM 'CSW024'  @SARD                                      CSW207 BUG14915
      **********                                                                     CSW207 BUG14915
     C********** @RTCD     IFNE *BLANK                                               CSW207 BUG14915
     C********** @RTCD     ANDNE'*NRF'                                               CSW207 BUG14915
     C********** *LOCK     IN   LDA                                                  CSW207 BUG14915
     C**********           MOVE '008'     DBASE             ***********              CSW207 BUG14915
     C**********           MOVEL'SCSARDPD'DBFILE            * DBERR 8 *              CSW207 BUG14915
     C**********           MOVEL'CSW024'  DBKEY             ***********              CSW207 BUG14915
     C**********           MOVE '1'       PERR                                       CSW207 BUG14915
     C**********           OUT  LDA                                                  CSW207 BUG14915
     C**********           EXSR *PSSR                                                CSW207 BUG14915
     C**********           END                                                       CSW207 BUG14915
      **********                                                                     CSW207 BUG14915
     C********** @RTCD     IFEQ *BLANKS                                              CSW207 BUG14915
     C**********           MOVE 'Y'       CSW024                                     CSW207 BUG14915
     C**********           ELSE                                                      CSW207 BUG14915
     C**********           MOVE 'N'       CSW024                                     CSW207 BUG14915
     C**********           ENDIF                                                     CSW207 BUG14915
      **********                                                                     CSW207 BUG14915
     C/COPY WNCPYSRC,ME0800CCP1                                           S01408
     C*                                                                   S01408
      **  Access Switchable features file for CME001                                          CME001
     C                     CALL 'AOSARDR0'                                                    CME001
     C                     PARM *BLANKS   ULRTCD  7                                           CME001
     C                     PARM '*VERIFY' ULOPTN  7                                           CME001
     C                     PARM 'CME001'  ULSARD  6                                           CME001
      *                                                                                       CME001
     C           ULRTCD    IFEQ *BLANK                                                        CME001
     C                     MOVE 'Y'       CME001  1                                           CME001
     C                     ELSE                                                               CME001
     C                     MOVE 'N'       CME001                                              CME001
     C                     END                                                                CME001
      *
      ** Process message reference
     C                     EXSR REF
      *
      ** Process message detail
     C                     EXSR DETL
      *
      ** End
     C/COPY WNCPYSRC,ME0800C020
     C                     SETON                     LR
      *
     C/EJECT
      *****************************************************************
      *   REF - Process Message reference file                        *
      *   Called by - Main processing                                 *
      *   Calls - *PSSR & HEADR                                       *
      *****************************************************************
      *
     C           REF       BEGSR
      *
      ** Access message reference file for TRN passed in as parameter
     C           PTRN      CHAINMGOREFL0             97
      *
     C           *IN97     IFEQ '1'
     C           *LOCK     IN   LDA
     C                     MOVE '02'      DBASE             ***********
     C                     MOVE 'MGOREF'  DBFILE            * DBERR 2 *
     C                     MOVE PTRN      DBKEY             ***********
     C                     MOVE '1'       PERR
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     END
      *
      ** If multiple message go to first part
     C           TRNF      IFNE *BLANKS
      *
     C           TRNF      CHAINMGOREFL0             97
      *
     C           *IN97     IFEQ '1'
     C           *LOCK     IN   LDA
     C                     MOVE '03'      DBASE             ***********
     C                     MOVE 'MGOREF'  DBFILE            * DBERR 3 *
     C                     MOVE TRNF      DBKEY             ***********
     C                     MOVE '1'       PERR
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     END
     C                     END
      *
      ** Save status information for header
     C                     MOVELMGST      SAVSTS  4
     C                     MOVELMGSG      SAVGRP  1
      *
      ** Establish whether message is a multiple
     C           TRNM      IFNE *BLANKS
     C                     MOVEL'Y'       MULT    1
     C                     END
     C/COPY WNCPYSRC,ME0800C015
      *
      ** Format the message heading and output to DATAQ/MEDTQPRT
     C                     EXSR HEADR
      *
      ** Print a blank line
     C                     MOVE *BLANKS   SDTAQ
     C                     CALL 'QSNDDTAQ'DATA
      *
     C/COPY WNCPYSRC,ME0800C022
     C                     ENDSR
      *
     C/EJECT
      *****************************************************************
      *   DETL - Process message detail file                          *
      *   Called by - Main process                                    *
      *   Calls - *PSSR & FLDPRC                                      *
      *****************************************************************
      *
     C           DETL      BEGSR
      *
     C           TRNO      CHAINMGOMSGPD             99
      *
      ** DBASE error if no matching record or EOF
     C           *IN99     IFEQ '1'
     C           *LOCK     IN   LDA
     C                     MOVE '04'      DBASE             ***********
     C                     MOVE 'MGOMSG'  DBFILE            * DBERR 4 *
     C                     MOVE TRNO      DBKEY             ***********
     C                     MOVE '1'       PERR
     C                     OUT  LDA
     C                     EXSR *PSSR
      *
      ** Save TRN this message
     C                     ELSE
     C                     MOVELTRNO      TRNSAV 16
     C** Initialise field 87 flag.                                        121288
     C                     MOVE 'N'       WTAG87  1                       121288
     C/COPY WNCPYSRC,ME0800C002
      *
      ** Read remaining records
      *                                                                                       206803
     C           MTPY      IFEQ '103'                                                         206803
     C           MTAG      ANDEQ':119:'                                                       206803
     C           MTPY      OREQ '202'                                                       MD051910
     C           MTAG      ANDEQ':119:'                                                     MD051910
     C           MTPY      OREQ '103'                                                       MD051910
     C           MTAG      ANDEQ':121:'                                                     MD051910
     C           MTPY      OREQ '202'                                                       MD051910
     C           MTAG      ANDEQ':121:'                                                     MD051910
     C                     MOVE 'Y'       W#RSET  1                                           206803
     C                     ELSE                                                               206803
     C                     MOVE 'N'       W#RSET                                              206803
     C                     ENDIF                                                              206803
      *                                                                                       206803
     C                     MOVE 'N'       @MARK   1                                         MD052485
     C           MTPY      IFEQ '202'                                                       MD052485
     C           MTAG      ANDEQ':119:'                                                     MD052485
     C           MFLD      ANDEQ'COV'                                                       MD052485
     C                     MOVE 'Y'       @MARK                                             MD052485
     C                     ENDIF                                                            MD052485
      *                                                                                     MD052485
     C                     Z-ADD1         @V                              183583
     C           *IN99     DOWEQ'0'
      *
      ** Perform detail processing
     C                     EXSR FLDPRC
     C           TRNSAV    READEMGOMSGPD                 99
      *                                                                                       206803
     C           W#RSET    IFEQ 'Y'                                                           206803
     C                     Z-ADD1         @V                                                  206803
     C                     MOVE 'N'       W#RSET                                              206803
     C                     ELSE                                                               206803
     C                     ADD  1         @V                              183583
     C                     ENDIF                                                              206803
      *
     C           @MARK     IFEQ 'Y'                                                         MD052485
     C                     SUB  1         @V                                                MD052485
     C                     MOVE 'N'       @MARK                                             MD052485
     C                     ENDIF                                                            MD052485
      *                                                                                     MD052485
     C                     END
     C                     END
     C                     ENDSR
     C/EJECT
      *****************************************************************
      *   FLDPRC - Process Field                                      *
      *   Called by - DETL                                            *
      *   Calls - MLTTRN & QSNDDTAQ                                   *
      *****************************************************************
      *
     C           FLDPRC    BEGSR
      *
      ** Clear dataqueue DS
     C                     MOVE *BLANKS   SDTAQ
      *
      ** Initialise tag format field
     C                     MOVE *BLANKS   EFTAGF
     C***********          MOVE *BLANKS   SAVTAG                          043888
     C                     MOVE *BLANKS   SSWFD
     C                     MOVE *BLANKS   SMTAG
     C                     MOVE *BLANKS   SMFLD
      *
      ** If message tag is not blank
     C           MTAG      IFNE *BLANKS
      *
      ** Save MTAG
     C                     MOVELMTAG      SAVTAG  5
      *
      ** If multiple message and tag is TRN of part
     C           MULT      IFEQ 'Y'
      *
     C                     MOVELMTPY      TRNTGK  7
     C                     MOVELMTAG      CHAR4   4
     C                     MOVE CHAR4     TRNTGK
     C           TRNTGK    LOKUPTRNTG                    10
      *
     C           *IN10     IFEQ '1'
     C/COPY WNCPYSRC,ME0800C003
      *
      ** Process multiple TRN field tag
     C                     EXSR MLTTRN
     C/COPY WNCPYSRC,ME0800C004
     C                     END
      *
     C                     END
      *
      ** Clear dataqueue DS
     C                     MOVE *BLANKS   SDTAQ
      *
      ** Use message tag and message type to access field tag
      ** reference file
     C                     MOVELMTAG      MTAGK
     C                     MOVELMTPY      MTPYK
     C*                                                                   CSW098
     C** If SWIFT 1998 changes is installed, consider message sequence    CSW098
     C** as well                                                          CSW098
     C*                                                                   CSW098
     C           CSW098    IFEQ 'CSW098 '                                 CSW098
     C           MSEQ      ANDNE*BLANKS                                   CSW098
     C*  Search 1: type specific, sequence specific                       CSW098
     C                     MOVELMSEQ      MSEQN                           CSW098
     C           KMTAG     CHAINSDMTAGL0             98                   CSW098
     C*  Search 2: type specific, sequence generic (blank)                CSW098
     C           *IN98     IFEQ '1'                                       CSW098
     C                     MOVEL*BLANKS   MSEQN                           CSW098
     C           KMTAG     CHAINSDMTAGL0             98                   CSW098
     C                     ENDIF                                          CSW098
     C*  Search 3: type generic ('ALL'), sequence specific                CSW098
     C           *IN98     IFEQ '1'                                       CSW098
     C                     MOVEL'ALL'     MTPYK                           CSW098
     C                     MOVELMSEQ      MSEQN                           CSW098
     C           KMTAG     CHAINSDMTAGL0             98                   CSW098
     C                     ENDIF                                          CSW098
     C*  Search 4: type generic ('ALL'), sequence generic (blank)         CSW098
     C           *IN98     IFEQ '1'                                       CSW098
     C                     MOVEL*BLANKS   MSEQN                           CSW098
     C           KMTAG     CHAINSDMTAGL0             98                   CSW098
     C                     ENDIF                                          CSW098
     C*                                                                   CSW098
     C                     ELSE                                           CSW098
     C*                                                                   CSW098
     C           MGTAGK    CHAINSDMTAGL0             98
      *
      ** If no record found just use message tag to access field tag
      ** reference file
     C           *IN98     IFEQ '1'
     C                     MOVE 'ALL'     MTPYK
     C           MGTAGK    CHAINSDMTAGL0             98
     C                     ENDIF                                          CSW098
     C*                                                                   CSW098
     C                     ENDIF                                          CSW098
      *
      ** If no record found put <TAG DESCRIPTION NOT FOUND> into
      ** Message Tag Description part of data queue
     C           *IN98     IFEQ '1'
     C                     MOVELTXT,36    SSWFD
     C                     END
     C***********          END                                            CSW098
      *
      ** If record tag found move description into corresponding part
      ** of data queue
     C           *IN98     IFEQ '0'
     C                     MOVELEFRPFD    SSWFD
      ** If the second occurrence of field 87 in an MT512 then overide    121288
      ** the description to read 'Deliverer of Securities'.               121288
     C           MTPY      IFEQ '512'                                     121288
     C           #TAG23    IFEQ '87'                                      121288
     C           WTAG87    IFEQ 'Y'                                       121288
     C                     MOVE *BLANKS   SSWFD                           121288
     C                     MOVELTXT,42    SSWFD                           121288
     C                     ELSE                                           121288
     C                     MOVE 'Y'       WTAG87                          121288
     C                     END                                            121288
     C                     END                                            121288
     C                     END                                            121288
     C                     END
      *
      **  Move MTAG into corresponding part of data queue
     C                     MOVELMTAG      SMTAG
      *
     C                     END
      *                                                                   140629
      ** If /OCMT/ or /CHGS/ then change comma in amount to decimal       140629
      ** point.                                                           140629
      *                                                                   140629
     C           '/OCMT/'  SCAN MFLD:1                   81               140629
      *                                                                   140629
     C           *IN81     IFEQ *OFF                                      140629
     C           '/CHGS/'  SCAN MFLD:1                   81               140629
     C                     ENDIF                                          140629
      *                                                                   140629
     C           *IN81     IFEQ *ON                                       140629
      *                                                                   140629
      ** If ',' in amount change to '.'                                   140629
      *                                                                   140629
     C           ',':'.'   XLATEMFLD      MFLD                            140629
     C                     ENDIF                                          140629
      *                                                                   140629
      *
      ** Check for verification field
     C/COPY WNCPYSRC,ME0800C005
     C                     MOVELMTPY      VERFYK  6
     C                     MOVELSAVTAG    CHAR3   3
     C                     MOVE CHAR3     VERFYK
     C/COPY WNCPYSRC,ME0800C006
     C           VERFYK    LOKUPVERFY                    10
     C/COPY WNCPYSRC,ME0800C009
      * Always set off verification field indicator if CME001 is on.                          CME001
     C           CME001    IFEQ 'Y'                                                           CME001
     C                     SETOF                     10                                       CME001
     C                     ENDIF                                                              CME001
      *
      ** If verification is on AND field is verification field AND
      ** messsage is not released
     C           ENVPM     IFEQ 'Y'
     C           *IN10     ANDEQ'1'
     C           SAVGRP    ANDEQ'1'
      *
      ** Move <NOT VERIFIED> into message data field part of data queue
     C/COPY WNCPYSRC,ME0800C013
     C                     MOVELTXT,37    SMFLD
     C/COPY WNCPYSRC,ME0800C014
      *
      ** Otherwise print message data
     C                     ELSE
     C/COPY WNCPYSRC,ME0800C010
      *
     C           EFTAGF    IFNE *BLANKS
      *
      ** Call appropriate formatting subroutine if required
     C           EFTAGF    CASEQ'CA '     CASR
     C           EFTAGF    CASEQ'DCA'     DCASR
     C           EFTAGF    CASEQ'DT'      DTSR                            CSW098
     C           EFTAGF    CASEQ'A'       ASR
     C           EFTAGF    CASEQ'D'       DSR
     C                     CAS            CATCH
     C                     END
      *
     C                     ELSE
      *
      **  If saved field tag is an address and the first character
      **  is not a '/'
     C                     MOVEASAVTAG    TG
     C                     MOVELMFLD      CHAR1   1
     C           TG,2      IFEQ '5'
     C           TG,4      ANDEQ'A'
     C***********CHAR1     ANDNE'/'                                       183583
     C           CHAR1     ANDNE'/'                                                           210868
     C********** TG,2      OREQ '5'                                                  CSW207 BUG14915
     C********** TG,4      ANDEQ'F'                                                  CSW207 BUG14915
     C********** CHAR1     ANDNE'/'                                                  CSW207 BUG14915
     C           SAVTAG    OREQ ':50F:'                                                     BUG14915
     C           TG,2      OREQ '8'                                       CSW097
     C           TG,4      ANDEQ'A'                                       CSW097
     C           TG,2      OREQ '9'                                       CSW098
     C           TG,4      ANDEQ'P'                                       CSW098
     C           TG,2      OREQ '9'                                                         MD022050
     C           TG,4      ANDEQ'A'                                                         MD022050
     C           CHAR1     ANDNE'/'                                                         MD022050
      *                                                                                       204225
     C********** CSW207    IFEQ 'Y'                                                  CSW207 BUG14915
     C                     MOVE CHAR3     CHR3    1                                           204225
     C                     MOVE '1'       *IN05                                               204225
     C           TG,2      IFEQ '5'                                                           204225
     C           CHR3      ANDEQ'0'                                                           204225
     C           TG,4      ANDEQ'A'                                                           204225
     C********** TG,4      ANDEQ'F'                                                  CSW207 BUG14915
     C           TG,4      ANDEQ'A'                                                         BUG14915
     C********** CSW024    IFEQ 'Y'                                                  CSW207 BUG14915
     C           TG,2      OREQ '9'                                                         MD022050
     C           TG,4      ANDEQ'A'                                                         MD022050
     C                     MOVELMFLD      WBEI   11                                           204225
     C           WBEI      CHAINSDCUSTBE             05                                       204225
     C                     MOVE *BLANKS   ZCUST                                               204225
     C**********           ENDIF                                                     CSW207 BUG14915
     C**********           ENDIF                                                     CSW207 BUG14915
     C                     ENDIF                                                              CSW207
      *
      ** Execute S/R SWADDR to pick up name/town for this SWIFT address
      *                                                                   S01435
      *  Format as SWIFT device print remove SWADDR processing            S01435
      *                                                                   S01435
     C***************      MOVELMFLD      ZADDR                           S01435
     C***************      EXSR SWADDR                                    S01435
     C***************      MOVELMFLD      F5NA   50                       S01435
     C***************      MOVE ZNAME     F5NA                            S01435
     C***************      MOVELZTOWN     @WK10  10                 E42972S01435
     C***************      MOVE @WK10     F5NA                      E42972S01435
     C***************      MOVELF5NA      SMFLD                           S01435
      *                                                                   S01435
      *  Information now displayed on lines after BIC as per SWIFT        S01435
      *  Standard                                                         S01435
      *                                                                   S01435
     C                     MOVELMFLD      SMFLD                           S01435
     C           *IN05     IFEQ '1'                                                           204225
     C                     EXSR SEXTNR                                    183583
     C                     ENDIF                                                              204225
      *                                                                   S01435
      *  Send report line to Data queue                                   S01435
      *                                                                   S01435
     C                     CALL 'QSNDDTAQ'DATA                            S01435
      *                                                                   S01435
      *  Call Access object to validate identifier                        S01435
      *                                                                   S01435
     C                     MOVEL*BLANKS   SDTAQ                           S01435
     C           TG,4      IFEQ 'P'                                       CSW098
     C           8         SUBSTMFLD:8    W9BICC                          CSW098
     C           3         SUBSTMFLD:16   W9BICB                          CSW098
     C                     ELSE                                           CSW098
     C                     MOVELMFLD      W9BICC                          S01435
     C           3         SUBSTMFLD:9    W9BICB                          S01435
     C                     ENDIF                                          CSW098
      *                                                                   S01435
     C           TG,2      IFEQ '5'                                       183583
     C           TG,4      ANDEQ'A'                                       183583
     C********** TG,2      OREQ '5'                                                  CSW207 BUG14915
     C********** TG,4      ANDEQ'F'                                                  CSW207 BUG14915
     C********** CSW207    ANDEQ'Y'                                                  CSW207 BUG14915
     C           SAVTAG    OREQ ':50F:'                                                     BUG14915
     C           TG,2      OREQ '8'                                       183583
     C           TG,4      ANDEQ'A'                                       183583
     C           ZCUST     IFNE *BLANKS                                   158656
     C                     MOVE *BLANKS   W9BICC                          183583
     C                     MOVELZCUST     W9BICC                          183583
     C                     ENDIF                                          158656
     C                     ENDIF                                          183583
     C                     CALL 'ME1400'                                  S01435
     C                     PARM *BLANKS   W9RTN   7                       S01435
     C                     PARM           W9BICC  8                       S01435
     C                     PARM           W9BICB  3                       S01435
     C                     PARM           SDCUST                          S01435
     C                     PARM           SDCNST                          S01435
     C                     PARM           MEBICD                          S01435
     C                     PARM *BLANKS   W9CUST  1                       S01435
     C                     PARM *BLANKS   W9CNST  1                       S01435
     C                     PARM *BLANKS   W9BICD  1                       S01435
      *                                                                   S01435
     C                     SELEC                                          S01435
      *                                                                   S01435
      *  Record not found - S.W.I.F.T does not exist                      S01435
      *                                                                   S01435
     C           W9RTN     WHEQ 'Y2U0005'                                 S01435
      * No action                                                         S01435
      *                                                                   S01435
     C                     GOTO FLEXIT                                    S01435
      *                                                                   S01435
      *  Use data depending on file that the data exists on               S01435
      *                                                                   S01435
     C           W9BICD    WHEQ 'Y'                                       S01435
      *                                                                   S01435
      * Format First Line for screen                                      S01435
      *                                                                   S01435
     C                     MOVEL*BLANKS   BICLAY                          S01435
     C                     MOVELBDINS1    #RPT1                           S01435
      *                                                                   S01435
      *  Check fields not concatenated                                    S01435
      *                                                                   S01435
     C           1         SUBSTBDINS2:1  ##001   1                       S01435
     C           ##001     IFNE *BLANKS                                   S01435
     C                     MOVELBDINS2    #RPT2                           S01435
     C                     ELSE                                           S01435
     C           18        SUBSTBDINS2:2  #RPT2                           S01435
     C                     END                                            S01435
      *                                                                   S01435
      *  Send report line to Data queue                                   S01435
      *                                                                   S01435
     C                     MOVELBICLAY    SDTAQ                           S01435
     C                     CALL 'QSNDDTAQ'DATA                            S01435
     C                     MOVEL*BLANKS   SDTAQ                           S01435
      *                                                                   S01435
      * Format Second Line for screen                                     S01435
      *                                                                   S01435
     C                     MOVEL*BLANKS   BICLAY                          S01435
     C                     MOVELBDCITY    #RPT1                           S01435
      *                                                                   S01435
      *  Send report line to Data queue                                   S01435
      *                                                                   S01435
     C                     MOVELBICLAY    SDTAQ                           S01435
     C                     CALL 'QSNDDTAQ'DATA                            S01435
     C                     MOVEL*BLANKS   SDTAQ                           S01435
      *                                                                   S01435
      * Format Third Line for screen                                      S01435
      *                                                                   S01435
     C                     MOVEL*BLANKS   BICLAY                          S01435
     C           BDBRC1    IFNE *BLANKS                                   S01435
     C                     MOVELBDBRC1    #RPT1                           S01435
      *                                                                   S01435
      *  Send report line to Data queue                                   S01435
      *                                                                   S01435
     C                     MOVELBICLAY    SDTAQ                           S01435
     C                     CALL 'QSNDDTAQ'DATA                            S01435
     C                     MOVEL*BLANKS   SDTAQ                           S01435
     C                     END                                            S01435
      *                                                                   S01435
     C                     GOTO FLEXIT                                    S01435
      *                                                                   S01435
     C           W9CUST    WHEQ 'Y'                                       S01435
      *                                                                   S01435
      * Format Customer Name and Town                                     S01435
      *                                                                   S01435
     C                     MOVEL*BLANKS   BICLAY                          S01435
     C           BBCRNM    IFNE *BLANKS                                   S01435
     C                     MOVELBBCRNM    #RPT1                           S01435
      *                                                                   S01435
      *  Send report line to Data queue                                   S01435
      *                                                                   S01435
     C                     MOVELBICLAY    SDTAQ                           S01435
     C                     CALL 'QSNDDTAQ'DATA                            S01435
     C                     MOVEL*BLANKS   SDTAQ                           S01435
     C                     END                                            S01435
     C                     MOVEL*BLANKS   BICLAY                          S01435
     C           BBCRTN    IFNE *BLANKS                                   S01435
     C                     MOVELBBCRTN    #RPT1                           S01435
      *                                                                   S01435
      *  Send report line to Data queue                                   S01435
      *                                                                   S01435
     C                     MOVELBICLAY    SDTAQ                           S01435
     C                     CALL 'QSNDDTAQ'DATA                            S01435
     C                     MOVEL*BLANKS   SDTAQ                           S01435
     C                     END                                            S01435
      *                                                                   S01435
     C                     GOTO FLEXIT                                    S01435
      *                                                                   S01435
     C           W9CNST    WHEQ 'Y'                                       S01435
      *                                                                   S01435
      * Format Counterparty Name and Town                                 S01435
      *                                                                   S01435
     C                     MOVEL*BLANKS   BICLAY                          S01435
     C           AWCPNM    IFNE *BLANKS                                   S01435
     C                     MOVELAWCPNM    #RPT1                           S01435
      *                                                                   S01435
      *  Send report line to Data queue                                   S01435
      *                                                                   S01435
     C                     MOVELBICLAY    SDTAQ                           S01435
     C                     CALL 'QSNDDTAQ'DATA                            S01435
     C                     MOVEL*BLANKS   SDTAQ                           S01435
     C                     END                                            S01435
     C                     MOVEL*BLANKS   BICLAY                          S01435
     C***********BBCRNM    IFNE *BLANKS                            S01435 099234
     C           AWCNTN    IFNE *BLANKS                                   099234
     C                     MOVELAWCNTN    #RPT1                           S01435
      *                                                                   S01435
      *  Send report line to Data queue                                   S01435
      *                                                                   S01435
     C                     MOVELBICLAY    SDTAQ                           S01435
     C                     CALL 'QSNDDTAQ'DATA                            S01435
     C                     MOVEL*BLANKS   SDTAQ                           S01435
     C                     END                                            S01435
      *                                                                   S01435
     C                     GOTO FLEXIT                                    S01435
      *                                                                   S01435
     C                     ENDSL                                          S01435
      *
     C                     ELSE
      *
      ** If no formatting code and not an address move data to display
      ** field without further processing
     C                     MOVELMFLD      SMFLD
      *
     C                     END
      *
     C                     END
     C/COPY WNCPYSRC,ME0800C011
      *
     C                     END
     C/COPY WNCPYSRC,ME0800C012
      *
      ** Send report line to Data queue
     C                     CALL 'QSNDDTAQ'DATA
      *
     C           FLEXIT    TAG                                            S01435
     C                     ENDSR
     C/EJECT
      *****************************************************************
      *   MLTTRN - Process multiple TRN field                         *
      *   Called by - FLDPRC                                          *
      *   Calls - QSNDDTAQ, *PSSR                                     *
      *****************************************************************
      *
     C           MLTTRN    BEGSR
      *
      **  Access message reference file using transaction reference
      **  of next part (210) or contents of :20: (203)
     C           MTPY      IFEQ '210'
     C                     MOVELTRNM      MTKEY  16
     C                     ELSE
     C                     MOVELMFLD      MTKEY
     C                     END
     C/COPY WNCPYSRC,ME0800C007
     C           MTKEY     CHAINMGOREFL0             97
      *
     C           *IN97     IFEQ '1'
     C           *LOCK     IN   LDA
     C                     MOVE '05'      DBASE             ***********
     C                     MOVE 'MGOREF'  DBFILE            * DBERR 5 *
     C                     MOVE MTKEY     DBKEY             ***********
     C                     MOVE '1'       PERR
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     END
     C/COPY WNCPYSRC,ME0800C008
      *
      ** Initialise Dataqueue
     C                     MOVEL*BLANKS   SDTAQ
      *
      ** Send one blank line
     C                     CALL 'QSNDDTAQ'DATA
      *
      ** Check if part mult message is deleted
     C           PTST      IFEQ 'D'
     C                     MOVELTXT,38    SPTST
     C                     END
      *
      ** If Midas message output Midas transaction number
     C           SYTM      IFEQ *BLANKS
     C           SYTM      OREQ 'MIDAS'
     C                     MOVELTXT,32    TXT32
     C*                                                                   E43198
     C**  For MT210, output TRN, instead of Midas transaction number      E43198
     C*                                                                   E43198
     C           MTPY      IFEQ '210'                                     E43198
     C                     MOVELTRNO      SMTRN                           E43198
     C                     ELSE                                           E43198
     C                     MOVELMTRN      SMTRN
     C                     END                                            E43198
      *
      ** and Transaction type
     C                     MOVELTXT,3     TXT3A
     C                     MOVELTNTP      STNTP
      *
      ** and Sub-type
     C                     MOVELTXT,4     TXT4A
     C                     MOVELSBTP      SSTYP
     C                     END
      *
      ** If confirmation matching is on ...
     C           PBGCFM    IFEQ 'Y'
      *
      ** Call standard program ZM0100 with param of tag-data to obtain
      ** confirmation matching status for this part
     C                     MOVELMTKEY     CFTRN
     C                     CALL 'ZM0100'  PCFM
      *
     C           CFERR     IFEQ *BLANKS
     C                     MOVELTXT,33    TXT33
     C           CFCPY     IFEQ *ZEROS
     C                     MOVEL'?'       SCFCY
     C                     ELSE
     C                     MOVELCFCPY     SCFCY
     C                     END
     C                     MOVELTXT,34    TXT34
     C           CFBRK     IFEQ *ZEROS
     C                     MOVEL'?'       SCFBK
     C                     ELSE
     C                     MOVELCFBRK     SCFBK
     C                     END
     C                     END
      *
     C                     END
      *
     C                     CALL 'QSNDDTAQ'DATA
     C                     ENDSR
     C/EJECT
      *****************************************************************
      *   HEADR - Format  Message header                              *
      *   Called by - REF                                             *
      *   Calls - MIDHDR, EXTHDR, DESTAD, NETSW, NETTL, NETPP, NETUR  *
      *           MESST,CONFST, HDDET.                                *
      *****************************************************************
      *
     C           HEADR     BEGSR
     C/COPY WNCPYSRC,ME0800C016
      *
      ** If system field from MGOREF is blank output MIDAS message
      ** header
     C           SYTM      IFEQ *BLANKS
     C           SYTM      OREQ 'MIDAS'
     C                     EXSR MIDHDR
      *
      ** Else external system message
     C                     ELSE
     C                     EXSR EXTHDR
     C                     END
      *
      ** Execute DESTAD to format message type/Sender's address/
      ** Destination address
     C                     EXSR DESTAD
      *
      ** If network is SWIFT
     C           NWRK      IFEQ 'SWIFT'
     C           NWRK      OREQ 'STTX'
     C/COPY WNCPYSRC,ME0800C001
     C                     EXSR NETSW
     C                     END
      *
      ** If network is TELEX
     C           NWRK      IFEQ 'TELEX'
     C                     EXSR NETTL
     C                     END
      *
      ** If network is PAPER
     C           NWRK      IFEQ 'PAPER'
     C/COPY WNCPYSRC,ME0800C021
     C                     EXSR NETPP
     C                     END
      *
      ** If network is UNROUT (ie. UNable to ROUTe)
     C           NWRK      IFEQ 'UNROUT'
     C                     EXSR NETUR
     C                     END
      *
      ** Write message status
     C                     EXSR MESST
      *
      ** If confirmation matching present & not multiple message
     C           PBGCFM    IFEQ 'Y'
     C           MULT      ANDNE'Y'
      *
      ** Call standard program ZM0100 with TRNO to establish the
      ** confirmation status
     C                     MOVELPTRN      CFTRN
     C                     CALL 'ZM0100'  PCFM
      *
      ** Check for no errors
     C           CFERR     IFEQ *BLANKS
      *
      ** Write confirmation status
     C                     EXSR CONFST
     C                     END
      *
     C                     END
     C/COPY WNCPYSRC,ME0800C017
      *
      ** Print a blank line
     C                     MOVE *BLANKS   SDTAQ
     C                     CALL 'QSNDDTAQ'DATA
      *
      ** Write header for detail
     C                     EXSR HDDET
      *
     C                     ENDSR
      *
     C/EJECT
      *****************************************************************
      *   MIDHDR - Output MIDAS details in message header             *
      *   Called by - HEADR SR                                        *
      *   Calls -   QSNDDTAQ                                          *
      *****************************************************************
      *
     C           MIDHDR    BEGSR
      *
     C                     MOVEL*BLANKS   SDTAQ
     C                     MOVELTXT,1     TEXT1
     C                     MOVELMODI      SMODI
      *
      ** If message generated by Midas (ie. not input via Message
      ** Management) output transaction details
     C           MODI      IFNE 'ME'
     C           MODI      ANDNE'MX'                                      E29588
      *
      ** If message is GL statement
     C           MODI      IFEQ 'GL'
     C                     MOVELTXT,40    TXT35
     C                     MOVELSACN      SACCN
     C                     ELSE
      *
      ** If not multiple message
     C           MULT      IFNE 'Y'
     C                     MOVELTXT,2     TEXT2
     C                     MOVELMTRN      STRNM
     C                     MOVELTXT,3     TEXT3
     C                     MOVELTNTP      STNTY
     C                     MOVELTXT,4     TEXT4
     C                     MOVELSBTP      SSBTP
     C                     END
      *
     C                     END
      *
     C                     ELSE                                           E29588
     C                     MOVELTXT,41    TXT41                           E29588
     C                     END
      *
     C                     CALL 'QSNDDTAQ'DATA
      *
     C                     ENDSR
     C/EJECT
      *****************************************************************
      *   EXTHDR Process Message reference file                       *
      *   Called by - HEADR SR                                        *
      *   Calls -   QSNDDTAQ                                          *
      *****************************************************************
      *
     C           EXTHDR    BEGSR
      *
     C                     MOVEL*BLANKS   SDTAQ
     C                     MOVELTXT,1     TEXT1
     C                     MOVELMODI      SMODI
     C                     MOVELTXT,5     TEXT5
     C                     MOVELSYTM      SXSYS
     C                     CALL 'QSNDDTAQ'DATA
     C                     ENDSR
     C/EJECT
      *****************************************************************
      *   DESTAD Format Msg type/Sender/Destination                   *
      *   Called by - HEADR SR                                        *
      *   Calls -  SWADDR, STADDR, TXADDR, PAPER, QSNDDTAQ            *
      *****************************************************************
      *
     C           DESTAD    BEGSR
      *
     C                     MOVEL*BLANKS   SDTAQ
     C                     MOVELTXT,6     TEXT6
     C                     MOVELNWSN      SSADR
     C                     MOVELTXT,7     TEXT7
     C                     MOVELMTPY      SMTPY
      *
      ** Access message type description
     C           MTPY      CHAINSDMTPYL0             96
     C           *IN96     IFEQ '1'
      *
      ** If not found move <MSG DESC NOT FOUND> INTO DATA QUEUE
     C                     MOVELTXT,39    SMTPD
     C                     ELSE
     C                     MOVELEEMTPD    SMTPD
     C                     END
     C                     CALL 'QSNDDTAQ'DATA
      *
      ** Format destination address
     C                     MOVEL*BLANKS   SDTAQ
     C                     MOVELTXT,8     TEXT8
     C                     MOVELNWDS      SNWDS
      *
      * Access appropriate subroutine, according to network
     C                     MOVELNWDS      ZADDR
     C                     MOVELDECN      ZCUST   8                       183583
     C                     EXSR SRDEST                                                        196833
     C/COPY WNCPYSRC,ME0800C018
     C           NWRK      CASEQ'SWIFT'   SWADDR
     C           NWRK      CASEQ'STTX'    STADDR
     C           NWRK      CASEQ'TELEX'   TXADDR
     C                     CAS            PAPER
     C                     END
     C                     MOVELZNAME     SREPN
     C                     MOVELZTOWN     STOWN
     C                     CALL 'QSNDDTAQ'DATA
     C                     ENDSR
     C/EJECT
      *****************************************************************
      *   NETSW - SWIFT/STTX message details                          *
      *   Called by - HEADR SR                                        *
      *   Calls - QSNDDTAQ                                            *
      *****************************************************************
      *
     C           NETSW     BEGSR
      *
     C                     MOVEL*BLANKS   SDTAQ
     C                     MOVELTXT,9     TEXT9
     C                     MOVELNWRK      SNWRK
     C                     MOVELTXT,10    TXT10
     C           MPRY      IFEQ 'U'
     C                     MOVEL'URGENT'  SMPRY
     C                     END
     C           MPRY      IFEQ 'N'
     C                     MOVEL'NORMAL'  SMPRY
     C                     END
     C                     MOVELTXT,11    TXT11
      *
      ** Change date from YYMMDD to DDMMMYY
     C                     MOVELMGDE      DAT
     C                     MOVELDD        DD2
     C           MM        LOKUPTABMM     TABMON         50
     C                     MOVE TABMON    MM2
     C                     MOVELYY        YY2
     C                     MOVELDAT2      SMGDE
     C                     MOVELTXT,12    TXT12
     C                     MOVELTXT,13    TXT13
      *
      **  Check delivery notification
     C           DELC      IFEQ '2'
     C           DELC      OREQ '3'
     C                     MOVEL'Y'       SDELC
     C                     ELSE
     C                     MOVEL'N'       SDELC
     C                     END
      *
      **  Check non-delivery warning
     C           DELC      IFEQ '1'
     C           DELC      OREQ '3'
     C                     MOVEL'Y'       SDELW
     C                     ELSE
     C                     MOVEL'N'       SDELW
     C                     END
      *
     C                     CALL 'QSNDDTAQ'DATA
      *
     C                     ENDSR
     C/EJECT
      *****************************************************************
      *   NETTL - Telex message details                               *
      *   Called by - HEADR SR                                        *
      *   Calls -     QSNDDTAQ                                        *
      *****************************************************************
      *
     C           NETTL     BEGSR
      *
     C                     MOVEL*BLANKS   SDTAQ
     C                     MOVELTXT,9     TEXT9
     C                     MOVELNWRK      SNWRK
     C                     MOVELTXT,10    TXT10
     C           MPRY      IFEQ 'U'
     C                     MOVEL'URGENT'  SMPRY
     C                     END
     C           MPRY      IFEQ 'N'
     C                     MOVEL'NORMAL'  SMPRY
     C                     END
     C                     MOVELTXT,11    TXT11
      *
      ** Change date from YYMMDD to DDMMMYY
     C                     MOVELMGDE      DAT
     C                     MOVELDD        DD2
     C           MM        LOKUPTABMM     TABMON         50
     C                     MOVE TABMON    MM2
     C                     MOVELYY        YY2
     C                     MOVELDAT2      SMGDE
      *
      ** If message is unreleased print testkey required, yes or no.
     C                     MOVE *BLANKS   STSKS
     C                     MOVE *BLANKS   TXT14
     C           MGSG      IFEQ '1'
     C                     MOVELTXT,14    TXT14
     C           TSKS      IFEQ 'Y'
     C                     MOVEL'Yes'     STSKS
     C                     ELSE
     C                     MOVEL'No '     STSKS
     C                     END
     C                     END
      *
     C                     CALL 'QSNDDTAQ'DATA
      *
     C                     ENDSR
     C/EJECT
      *****************************************************************
      *   NETPP - Paper message details                               *
      *   Called by - HEADR SR                                        *
      *   Calls - QSNDDTAQ                                            *
      *****************************************************************
      *
     C           NETPP     BEGSR
      *
     C                     MOVEL*BLANKS   SDTAQ
     C                     MOVELTXT,9     TEXT9
     C                     MOVELNWRK      SNWRK
     C                     MOVELTXT,11    TXT11
      *
      ** Change date from YYMMDD to DDMMMYY
     C                     MOVELMGDE      DAT
     C                     MOVELDD        DD2
     C           MM        LOKUPTABMM     TABMON         50
     C                     MOVE TABMON    MM2
     C                     MOVELYY        YY2
     C                     MOVELDAT2      SMGDE
      *
      ** Paper info - identify all messages as copies (*** COPY ***)
     C                     MOVELTXT,16    TXT16
      *
     C                     CALL 'QSNDDTAQ'DATA
      *
     C                     ENDSR
     C/EJECT
      *****************************************************************
      *   NETUR - 'Unable to route' message details                   *
      *   Called by - HEADR SR                                        *
      *   Calls - QSNDDTAQ                                            *
      *****************************************************************
      *
     C           NETUR     BEGSR
      *
     C                     MOVEL*BLANKS   SDTAQ
     C                     MOVELTXT,9     TEXT9
     C                     MOVELNWRK      SNWRK
     C                     MOVELTXT,11    TXT11
      *
      ** Change date from YYMMDD to DDMMMYY
     C                     MOVELMGDE      DAT
     C                     MOVELDD        DD2
     C           MM        LOKUPTABMM     TABMON         50
     C                     MOVE TABMON    MM2
     C                     MOVELYY        YY2
     C                     MOVELDAT2      SMGDE
     C                     MOVELTXT,16    TXT16
      *
     C                     CALL 'QSNDDTAQ'DATA
      *
     C                     ENDSR
     C/EJECT
      *****************************************************************
      *   MESST - Output message status                               *
      *   Called by - HEADR SR                                        *
      *   Calls -  QSNDDTAQ                                           *
      *****************************************************************
      *
     C           MESST     BEGSR
      *
     C                     MOVEL*BLANKS   SDTAQ
     C                     MOVELTXT,17    TXT17
      *
      ** Use status code to look-up narrative. If entry found move
      ** narrative to report field, otherwise just report code.
     C           SAVSTS    LOKUPTABCD     TABNAR         50
     C           *IN50     IFEQ '1'
     C                     MOVELTABNAR    SMGST
     C                     ELSE
      *                                                                   S01408
     C/COPY WNCPYSRC,ME0800CCP6                                           S01408
      *                                                                   S01408
     C                     MOVELSAVSTS    SMGST
     C                     END
      *                                                                   S01408
     C/COPY WNCPYSRC,ME0800CCP7                                           S01408
      *                                                                   S01408
      *
     C                     MOVELTXT,18    TXT18
     C                     MOVELLADT      SLADT
     C                     MOVELTXT,19    TXT19
     C                     MOVELLATM      SLATM
      *
      **  If message negatively acknowledged print error code and line
     C           SAVGRP    IFEQ '4'
     C           SAVSTS    ANDNE'DLTD'
     C           MSE1      ANDNE*BLANKS                                   E29588
      *                                                                   E29588
      ** If ELIN does not contain numeric data it probably contains       E29588
      ** rubbish (ie. error is probably not in message text, so line      E29588
      ** number is not applicable). Output '---' instead.                 E29588
     C           ELIN      IFNE *BLANKS                                   E29588
     C                     TESTN          ELIN       75                   E29588
     C           *IN75     IFEQ '0'                                       E29588
     C                     MOVE '---'     ELIN                            E29588
     C                     END                                            E29588
     C                     END                                            E29588
      *
     C                     MOVELTXT,20    TXT20
     C                     MOVELMSE1      SMSE1
     C                     MOVELELIN      SELIN
     C                     END
      *
     C                     CALL 'QSNDDTAQ'DATA
      *
      ** If message released print user/workstation responsible
     C           SAVGRP    IFNE '1'
     C           RUSR      ANDNE*BLANKS                                   E29588
     C                     MOVEL*BLANKS   SDTAQ
     C                     MOVELTXT,21    TXT21
     C                     MOVELRUSR      SRUSR
     C                     MOVELTXT,22    TXT22
     C                     MOVELRWSN      SRWSN
      *
      ** If PDE on at time of release enable POSSIBLE DUPLICATE message
     C           MPDE      IFEQ 'Y'
     C                     MOVELTXT,23    TXT23
     C                     END
      *
     C                     CALL 'QSNDDTAQ'DATA
     C                     END
      *
     C                     ENDSR
     C/EJECT
      *****************************************************************
      *   CONFST - Output confirmation status                         *
      *   Called by - HEADR SR                                        *
      *   Calls - QSNDDTAQ                                            *
      *****************************************************************
      *
     C           CONFST    BEGSR
     C                     MOVEL*BLANKS   SDTAQ
     C                     MOVELTXT,30    TXT30
     C******************** MOVELTXT,30    TXT31                           E29588
     C                     MOVELTXT,31    TXT31                           E29588
      *
      **  Obtain narrative for CF match status - if status not found
      **  output code only
     C           CFCPY     LOKUPTAB1      TAB2           65
     C           *IN65     IFEQ '1'
     C                     MOVELTAB2      SCFCP
     C                     ELSE
     C                     MOVE *BLANKS   SCFCP
     C                     MOVELCFCPY     SCFCP
     C                     END
     C           CFBRK     LOKUPTAB1      TAB2           65
     C           *IN65     IFEQ '1'
     C                     MOVELTAB2      SCFBR
     C                     ELSE
     C                     MOVE *BLANKS   SCFBR
     C                     MOVELCFBRK     SCFBR
     C                     END
      *
     C                     CALL 'QSNDDTAQ'DATA
     C                     ENDSR
     C/EJECT
      *****************************************************************
      *   HDDET - Output Header Details                               *
      *   Called by - HEADR SR                                        *
      *   Calls -  QSNDDTAQ                                           *
      *****************************************************************
      *
     C           HDDET     BEGSR
     C                     MOVEL*BLANKS   SDTAQ
     C                     MOVELTXT,24    TXT24
     C                     MOVELTXT,25    TXT25
     C                     MOVELTXT,26    TXT26
     C                     CALL 'QSNDDTAQ'DATA
     C                     MOVEL*BLANKS   SDTAQ
     C                     MOVELTXT,27    TXT27
     C                     MOVELTXT,28    TXT28
     C                     MOVELTXT,29    TXT29
     C                     CALL 'QSNDDTAQ'DATA
     C                     ENDSR
      /EJECT                                                              183583
      *****************************************************************   183583
      *                                                               *   183583
      *   SEXTNR - Reads MGOEXTPD to get the SWIFT ID's cust. no.     *   183583
      *                                                               *   183583
      *   Called by: FLDPRC                                           *   183583
      *   Calls    : None                                             *   183583
      *                                                               *   183583
      *****************************************************************   183583
      *                                                                   183583
     C           SEXTNR    BEGSR                                          183583
      *                                                                   183583
     C                     MOVE *BLANKS   ZCUST                           183583
     C           KEXTN     CHAINMGOEXTLF             1616                 183583
     C           *IN16     IFEQ '0'                                       183583
     C                     MOVELMCSI      ZCUST                           183583
     C                     ENDIF                                          183583
      *                                                                   183583
     C           SEXTN9    ENDSR                                          183583
     C/EJECT
     C/COPY WNCPYSRC,ME0800C019
      *****************************************************************
      *   SWADDR - Format Name/Town from SWIFT address                *
      *   Called by - FLDPRC, DESTAD                                  *
      *   Standard input -  ZADDR, Address, 20A                       *
      *   Standard output - ZNAME, Customer/Countreparty name, 35A    *
      *                     ZTOWN, Customer/Counterparty town, 35A    *
      *                     *IN90 If ON implies no record found       *
      *****************************************************************
      *
     C           SWADDR    BEGSR
      *
      ** Define standard fields
     C                     MOVE ZADDR     ZADDR  20
     C                     MOVE *BLANKS   ZNAME  35
     C                     MOVE *BLANKS   ZTOWN  20
      *
      ** Move standard address to SWIFT address key
     C                     MOVELZADDR     SFWAD  12
      *
      ** First try customer file, SDCUST
     C           SFWAD     CHAINSDCUSTSW             90
     C           ZCUST     IFNE *BLANKS                                   183583
     C           *IN90     DOWEQ'0'                                       183583
     C           BBCUST    ANDNEZCUST                                     183583
     C           SFWAD     READESDCUSTSW                 90               183583
     C                     ENDDO                                          183583
     C                     ENDIF                                          183583
     C           *IN90     IFEQ '0'
     C                     MOVELBBCRNM    ZNAME
     C                     MOVELBBCRTN    ZTOWN
     C                     ELSE
      *
      ** If not found on customer file, try C/Party Nostro file SDCNST
     C           SFWAD     CHAINSDCNSTSW             90
      *                                                                   183583
      ** Check if correct Counterparty used is found.                     183583
      *                                                                   183583
     C           ZCUST     IFNE *BLANKS                                   183583
     C           *IN90     DOWEQ'0'                                       183583
     C           AWCPNC    ANDNEZCUST                                     183583
     C           SFWAD     READESDCNSTSW                 90               183583
     C                     ENDDO                                          183583
     C                     ENDIF                                          183583
     C           *IN90     IFEQ '0'
     C                     MOVELAWCPNM    ZNAME
     C                     MOVELAWCNTN    ZTOWN
     C                     ELSE                                      X2   107503
      *                                                                   107503
      *  Call ME1400 to access BIC address                                107503
      *                                                                   107503
     C                     MOVE SFWAD     W01BIC                          107503
     C                     MOVE W01ICC    W9BICC                          107503
     C                     MOVE W01ICB    W9BICB                          107503
      *                                                                   107503
     C                     CALL 'ME1400'                                  107503
     C                     PARM *BLANKS   W9RTN   7                       107503
     C                     PARM           W9BICC  8                       107503
     C                     PARM           W9BICB  3                       107503
     C                     PARM           SDCUST                          107503
     C                     PARM           SDCNST                          107503
     C                     PARM           MEBICD                          107503
     C                     PARM *BLANKS   W9CUST  1                       107503
     C                     PARM *BLANKS   W9CNST  1                       107503
     C                     PARM *BLANKS   W9BICD  1                       107503
      *                                                                   107503
      ** If record found on BIC file, use first line of name & city       107503
      *                                                                   107503
     C           W9BICD    IFEQ 'Y'                                   3   107503
     C                     MOVELBDINS1    ZNAME                           107503
     C                     MOVELBDCITY    ZTOWN                           107503
     C                     MOVE '0'       *IN90                           107503
     C                     END                                       E3   107503
     C                     END
     C                     END
      *
     C                     ENDSR                           SWADDR
     C/EJECT
      *****************************************************************
      *   STADDR - Format Name/Town from STTX address                 *
      *   Called by - DESTAD                                          *
      *   Standard input -  ZADDR, Address, 20A                       *
      *   Standard output - ZNAME, Customer/Countreparty name, 35A    *
      *                     ZTOWN, Customer/Counterparty town, 35A    *
      *                     *IN90 If ON implies no record found       *
      *****************************************************************
      *
     C           STADDR    BEGSR
      *
      ** Define standard fields
     C                     MOVE ZADDR     ZADDR  20
     C                     MOVE *BLANKS   ZNAME  35
     C                     MOVE *BLANKS   ZTOWN  20
      *
      ** Move standard address to STTX address key
     C                     MOVELZADDR     STXAD  12
      *
      ** First try customer file, SDCUST
     C           STXAD     CHAINSDCUSTST             90
     C           ZCUST     IFNE *BLANKS                                   183583
     C           *IN90     DOWEQ'0'                                       183583
     C           BBCUST    ANDNEZCUST                                     183583
     C           STXAD     READESDCUSTST                 90               183583
     C                     ENDDO                                          183583
     C                     ENDIF                                          183583
     C           *IN90     IFEQ '0'
     C                     MOVELBBCRNM    ZNAME
     C                     MOVELBBCRTN    ZTOWN
     C                     ELSE
      *
      ** If not found on customer file, try C/Party Nostro file SDCNST
     C           STXAD     CHAINSDCNSTST             90
      *                                                                   183583
      ** Check if correct Counterparty used is found.                     183583
      *                                                                   183583
     C           ZCUST     IFNE *BLANKS                                   183583
     C           *IN90     DOWEQ'0'                                       183583
     C           AWCPNC    ANDNEZCUST                                     183583
     C           STXAD     READESDCNSTST                 90               183583
     C                     ENDDO                                          183583
     C                     ENDIF                                          183583
     C           *IN90     IFEQ '0'
     C                     MOVELAWCPNM    ZNAME
     C                     MOVELAWCNTN    ZTOWN
     C                     END
     C                     END
      *
     C                     ENDSR                           STADDR
     C/EJECT
      *****************************************************************
      *   TXADDR - Format Name/Town from TELEX address                *
      *   Called by - DESTAD                                          *
      *   Standard input -  ZADDR, Address, 20A                       *
      *   Standard output - ZNAME, Customer/Countreparty name, 35A    *
      *                     ZTOWN, Customer/Counterparty town, 35A    *
      *                     *IN90 If ON implies no record found       *
      *****************************************************************
      *
     C           TXADDR    BEGSR
      *
      ** Define standard fields
     C                     MOVE ZADDR     ZADDR  20
     C                     MOVE *BLANKS   ZNAME  35
     C                     MOVE *BLANKS   ZTOWN  20
      *
      ** Move standard address to TELEX address key
     C                     MOVELZADDR     TLXAD  10
      *
      ** First try customer file, SDCUST
     C           TLXAD     CHAINSDCUSTTX             90
     C           ZCUST     IFNE *BLANKS                                   183583
     C           *IN90     DOWEQ'0'                                       183583
     C           BBCUST    ANDNEZCUST                                     183583
     C           TLXAD     READESDCUSTTX                 90               183583
     C                     ENDDO                                          183583
     C                     ENDIF                                          183583
     C           *IN90     IFEQ '0'
     C                     MOVELBBCRNM    ZNAME
     C                     MOVELBBCRTN    ZTOWN
     C                     ELSE
      *
      ** If not found on customer file, try C/Party Nostro file SDCNST
     C           TLXAD     CHAINSDCNSTTX             90
      *                                                                   183583
      ** Check if correct Counterparty used is found.                     183583
      *                                                                   183583
     C           ZCUST     IFNE *BLANKS                                   183583
     C           *IN90     DOWEQ'0'                                       183583
     C           AWCPNC    ANDNEZCUST                                     183583
     C           TLXAD     READESDCNSTTX                 90               183583
     C                     ENDDO                                          183583
     C                     ENDIF                                          183583
     C           *IN90     IFEQ '0'
     C                     MOVELAWCPNM    ZNAME
     C                     MOVELAWCNTN    ZTOWN
     C                     END
     C                     END
      *
     C                     ENDSR                           TXADDR
     C/EJECT
      *****************************************************************
      *   PAPER  - Clear Name/Town fields for paper messages          *
      *   Called by - DESTAD                                          *
      *   Standard output - ZNAME, *BLANKS, 35A                       *
      *                     ZTOWN, *BLANKS, 35A                       *
      *****************************************************************
      *
     C           PAPER     BEGSR
      *
     C                     MOVE *BLANKS   ZNAME  35
     C                     MOVE *BLANKS   ZTOWN  20
      *
     C                     ENDSR                           PAPER
     C/EJECT
      *****************************************************************
      *   CASR  - Format CURRENCY/AMOUNT subfield                     *
      *   Called by - FLDPRC                                          *
      *****************************************************************
      *
     C           CASR      BEGSR
      *
     C                     MOVEA*BLANKS   FLD
     C                     MOVELMFLD      WK1     1                       186181
     C                     MOVELMFLD      MFLD2                           186181
     C           DIGITS    CHECKCHAR44                   47               186181
     C           WK1       IFEQ 'N'                                       186181
     C           *IN47     ANDEQ'1'                                       186181
     C                     MOVE MFLD      WK46   46                       186181
     C                     MOVEAWK46      AMAR                            186181
     C                     ELSE                                           186181
     C                     MOVELMFLD      WK3     3
     C                     MOVE MFLD      WK47   47
     C                     MOVEAWK47      AMAR
     C                     END                                            186181
     C                     Z-ADD1         A       20
     C           ','       LOKUPAMAR,A                   40
     C           *IN40     IFEQ '1'
     C                     MOVE '.'       AMAR,A
     C                     END
     C           WK1       IFEQ 'N'                                       186181
     C           *IN47     ANDEQ'1'                                       186181
     C                     MOVEAWK1       FLD,1                           186181
     C                     MOVEACHAR24    FLD,3                           186181
     C                     MOVEAAMAR      FLD,7                           186181
     C                     ELSE                                           186181
     C                     MOVEAWK3       FLD,1
     C                     MOVEAAMAR      FLD,5
     C                     END                                            186181
     C*                                                                   S01408
     C/COPY WNCPYSRC,ME0800CCP2                                           S01408
     C*                                                                   S01408
      *
     C                     MOVEAFLD       SMFLD
      *
     C                     ENDSR                           CASR
     C/EJECT
      *****************************************************************
      *   DCASR - DATE/CCY/AMOUNT subfield                            *
      *   Called by - FLDPRC                                          *
      *****************************************************************
      *
     C           DCASR     BEGSR
      *
     C                     MOVEA*BLANKS   AMAR
     C                     MOVEAMFLD      FLD
     C                     MOVELMFLD      MFLD2                           CSW097
     C           DIGITS    CHECKCHAR7                    47               CSW097
     C           *IN47     IFEQ '1'                                       CSW097
     C                     MOVEAFLD,10    AMAR
     C                     ELSE                                           CSW097
     C                     MOVEAFLD,12    AMAR                            CSW097
     C                     ENDIF                                          CSW097
     C                     Z-ADD1         A
     C           ','       LOKUPAMAR,A                   40
     C           *IN40     IFEQ '1'
     C                     MOVE '.'       AMAR,A
     C                     END
     C           *IN47     IFEQ '1'                                       CSW097
     C                     MOVEAFLD,7     WK3
     C                     MOVELMFLD      DAT
      *
      ** By this stage, AMAR contains amount, WK3 contains currency
      ** and DAT (a DS - YY MM DD) contains date
     C                     MOVEA*BLANKS   FLD
     C                     MOVEADD        FLD,1
     C                     MOVEA'/'       FLD,3
     C                     MOVEAMM        FLD,4
     C                     MOVEA'/'       FLD,6
     C                     MOVEAYY        FLD,7
     C                     ELSE                                           CSW097
     C                     MOVEAFLD,9     WK3                             CSW097
     C                     MOVELMFLD      DAT3                            CSW097
     C                     MOVEA*BLANKS   FLD                             CSW097
     C                     MOVEADD3       FLD,1                           CSW097
     C                     MOVEA'/'       FLD,3                           CSW097
     C                     MOVEAMM3       FLD,4                           CSW097
     C                     MOVEA'/'       FLD,6                           CSW097
     C                     MOVEAYY3       FLD,7                           CSW097
     C                     ENDIF                                          CSW097
      *
     C           DATF      IFEQ 'M'
     C           *IN47     IFEQ '1'                                       CSW097
     C                     MOVEAFLD,1     WRKDAT
     C                     MOVELWRKMM     @CHG5
     C                     MOVE WRKDD     @CHG5
     C                     MOVE WRKYY     CHGYY
     C                     MOVEACHGDAT    FLD,1
     C                     ELSE                                           CSW097
     C                     MOVEAFLD,1     WKDAT                           CSW097
     C                     MOVELWKMM      @CH5                            CSW097
     C                     MOVE WKDD      @CH5                            CSW097
     C                     MOVE WKYY      CHYY                            CSW097
     C                     MOVEACHDAT     FLD,1                           CSW097
     C                     ENDIF                                          CSW097
     C                     END
      *
     C           *IN47     IFEQ '1'                                       CSW097
     C                     MOVEAWK3       FLD,10
     C                     MOVEAAMAR      FLD,14
     C                     ELSE                                           CSW097
     C                     MOVEAWK3       FLD,12                          CSW097
     C                     MOVEAAMAR      FLD,16                          CSW097
     C                     ENDIF                                          CSW097
     C*                                                                   S01408
     C/COPY WNCPYSRC,ME0800CCP3                                           S01408
     C*                                                                   S01408
      *
     C                     MOVEAFLD       SMFLD
      *
     C                     ENDSR                           DCASR
     C/EJECT
      *****************************************************************
      *   ASR - AMOUNT subfield                                       *
      *   Called by - FLDPRC                                          *
      *****************************************************************
      *
     C           ASR       BEGSR
      *
     C                     MOVEAMFLD      AMAR
     C                     Z-ADD1         A       20
     C           ','       LOKUPAMAR,A                   40
     C           *IN40     IFEQ '1'
     C                     MOVE '.'       AMAR,A
     C                     END
     C                     MOVEAAMAR      SMFLD
     C*                                                                   S01408
     C/COPY WNCPYSRC,ME0800CCP4                                           S01408
     C*                                                                   S01408
      *
     C                     ENDSR                           ASR
     C/EJECT
      *****************************************************************
      *   DSR - DATE subfield                                         *
      *   Called by - FLDPRC                                          *
      *****************************************************************
      *
     C           DSR       BEGSR
      *
     C                     MOVEA*BLANKS   FLD
      *
      ** Check for defined qualifiers, issuer codes or type in the form   CSW098
      **  MFLD = ':QUAL//TYPE/YYYYMMDD' whereby formatting should         CSW098
      ** only be done on the YYYYMMDD.                                    CSW098
      *                                                                   CSW098
     C                     MOVE *BLANKS   WMFLD  50                       CSW098
     C                     MOVE *BLANKS   WFLA   50                       CSW098
     C                     MOVE *BLANKS   WFLD   50                       CSW098
      *                                                                   CSW098
     C           1         SUBSTMFLD:1    @WM1    1                       CSW098
     C           @WM1      IFEQ ':'                        Qualifier StartCSW098
     C           '/'       SCAN MFLD:7    C       20       Issuer Code EndCSW098
      *                                                                   CSW098
     C           C         IFNE 0                                         CSW098
     C                     ADD  1         C                               CSW098
     C           '/'       SCAN MFLD:C    D       20       Type End       CSW098
     C           D         IFNE 0                                         CSW098
     C                     Z-ADDD         C                               CSW098
     C                     ELSE                                           CSW098
     C                     SUB  1         C                               CSW098
     C                     ENDIF                                          CSW098
     C           C         SUBSTMFLD      WMFLD                           CSW098
     C                     ADD  1         C                               CSW098
     C                     SUBSTMFLD:C    WFLA                            CSW098
     C                     ENDIF                                          CSW098
      *                                                                   CSW098
     C                     ELSE                                           CSW098
     C                     MOVELMFLD      WFLA                            CSW098
     C                     ENDIF                                          CSW098
      *                                                                   CSW098
     C***********          MOVELMFLD      MFLD2                    CSW097 CSW098
     C                     MOVELWFLA      MFLD2                           CSW098
     C           DIGITS    CHECKCHAR7                    47               CSW097
      *                                                                   CSW097
      ** The seventh character is not numeric.                            CSW097
      *                                                                   CSW097
     C           *IN47     IFEQ '1'                                       CSW097
     C***********          MOVELMFLD      DAT                             CSW098
     C                     MOVELWFLA      DAT                             CSW098
     C                     MOVEADD        FLD,1
     C                     MOVEA'/'       FLD,3
     C                     MOVEAMM        FLD,4
     C                     MOVEA'/'       FLD,6
     C                     MOVEAYY        FLD,7
     C                     ELSE                                           CSW097
     C***********          MOVELMFLD      DAT3                     CSW097 CSW098
     C                     MOVELWFLA      DAT3                            CSW098
     C                     MOVEADD3       FLD,1                           CSW097
     C                     MOVEA'/'       FLD,3                           CSW097
     C                     MOVEAMM3       FLD,4                           CSW097
     C                     MOVEA'/'       FLD,6                           CSW097
     C                     MOVEAYY3       FLD,7                           CSW097
     C                     ENDIF                                          CSW097
      *
     C           DATF      IFEQ 'M'
     C           *IN47     IFEQ '1'                                       CSW097
     C                     MOVEAFLD,1     WRKDAT
     C                     MOVELWRKMM     @CHG5
     C                     MOVE WRKDD     @CHG5
     C                     MOVE WRKYY     CHGYY
     C                     MOVEACHGDAT    FLD,1
     C                     ELSE                                           CSW097
     C                     MOVEAFLD,1     WKDAT                           CSW097
     C                     MOVELWKMM      @CH5                            CSW097
     C                     MOVE WKDD      @CH5                            CSW097
     C                     MOVE WKYY      CHYY                            CSW097
     C                     MOVEACHDAT     FLD,1                           CSW097
     C                     ENDIF                                          CSW097
     C                     END
      *
     C           WMFLD     IFNE *BLANKS                                   CSW098
     C                     MOVELWMFLD     SMFLD                           CSW098
     C                     MOVEAFLD       WFLD                            CSW098
     C                     CAT  WFLD:0    SMFLD                           CSW098
     C                     ELSE                                           CSW098
     C                     MOVEAFLD       SMFLD
     C                     ENDIF                                          CSW098
      *
     C                     ENDSR                           DSR
     C/EJECT
      *****************************************************************   CSW098
      *   DTSR - DATE/TIME field                                      *   CSW098
      *   Called by - FLDPRC                                          *   CSW098
      *****************************************************************   CSW098
      *                                                                   CSW098
     C           DTSR      BEGSR                                          CSW098
      *                                                                   CSW098
      **  Output date part                                                CSW098
      *                                                                   CSW098
     C                     EXSR DSR                                       CSW098
      *                                                                   CSW098
     C                     MOVE *BLANKS   WFLD                            CSW098
      *                                                                   CSW098
     C           *IN47     IFEQ '1'                                       CSW098
     C           2         SUBSTWFLA:7    @WL2    2                       CSW098
     C                     MOVEL@WL2      WFLD                            CSW098
     C                     CAT  ':':0     WFLD                            CSW098
     C           2         SUBSTWFLA:9    @WL2                            CSW098
     C                     CAT  @WL2:0    WFLD                            CSW098
     C                     CAT  ':':0     WFLD                            CSW098
     C           2         SUBSTWFLA:11   @WL2                            CSW098
     C                     CAT  @WL2:0    WFLD                            CSW098
     C                     ELSE                                           CSW098
     C           2         SUBSTWFLA:9    @WL2                            CSW098
     C                     MOVEL@WL2      WFLD                            CSW098
     C                     CAT  ':':0     WFLD                            CSW098
     C           2         SUBSTWFLA:11   @WL2                            CSW098
     C                     CAT  @WL2:0    WFLD                            CSW098
     C                     CAT  ':':0     WFLD                            CSW098
     C           2         SUBSTWFLA:13   @WL2                            CSW098
     C                     CAT  @WL2:0    WFLD                            CSW098
     C                     ENDIF                                          CSW098
      *                                                                   CSW098
     C                     CAT  WFLD:1    SMFLD                           CSW098
      *                                                                   CSW098
     C                     ENDSR                                          CSW098
     C/EJECT                                                              CSW098
      *****************************************************************
      *   CATCH - CATCHALL subfield format                            *
      *   Called by - FLDPRC                                          *
      *****************************************************************
      *
     C           CATCH     BEGSR
      *
     C                     MOVELMFLD      SMFLD
      *
     C                     ENDSR                           CATCH
     C/EJECT
      *****************************************************************                       196833
      *                                                               *                       196833
      *  SRDEST - Destination for CLS Pay/Receives                    *                       196833
      *           For CLS Pay/Receives, retrieve the SWIFT ID of the  *                       196833
      *           DECN field. This will display the correct Customer  *                       196833
      *           Report name and Town.                               *                       196833
      *                                                               *                       196833
      *****************************************************************                       196833
      *                                                                                       196833
     C           SRDEST    BEGSR                                                              196833
      *                                                                                       196833
     C           TNTP      IFEQ 'PC'                                                          196833
     C           TNTP      OREQ 'RC'                                                          196833
      *                                                                                       196833
     C                     MOVE *BLANKS   PCUST  10                                           196833
     C                     MOVELDECN      PCUST                                               196833
      *                                                                                       196833
     C                     CALL 'AOCUSTR1'                                                    196833
     C                     PARM *BLANKS   @RTCD                                               196833
     C                     PARM '*KEY   ' @OPTN                                               196833
     C                     PARM           PCUST                                               196833
     C                     PARM *BLANKS   PKYST   7                                           196833
     C           SDCUST    PARM SDCUST    DSLDY                                               196833
      *                                                                                       196833
     C           @RTCD     IFEQ *BLANKS                                                       196833
     C                     MOVELBBCSID    ZADDR                                               196833
     C                     ELSE                                                               196833
     C           *LOCK     IN   LDA                                                           196833
     C                     Z-ADD007       DBASE                                               196833
     C                     MOVEL'SDCUSTPD'DBFILE                                              196833
     C                     MOVELPCUST     DBKEY                                               196833
     C                     MOVE '1'       PERR                                                196833
     C                     OUT  LDA                                                           196833
     C                     EXSR *PSSR                                                         196833
     C                     ENDIF                                                              196833
      *                                                                                       196833
     C                     ENDIF                                                              196833
      *                                                                                       196833
     C                     ENDSR                                                              196833
      *                                                                                       196833
      *****************************************************************                       196833
      /EJECT                                                                                  196833
      *****************************************************************
      *   *PSSR - Error handling                                      *
      *   Called by - REF, DETL, MLTTRN                               *
      *****************************************************************
      *
     C           *PSSR     BEGSR
      *
     C                     SETON                     U7U8LR
     C                     DUMP
     C                     RETRN
      *
     C                     ENDSR
     C*                                                                   S01408
     C/COPY WNCPYSRC,ME0800CCP5                                           S01408
     C*                                                                   S01408
     X/COPY WNCPYSRC,ME0800X001                                           S01408
** CPY@   **      Object copyright
(c) Misys International Banking Systems Ltd. 2001
**  Months MM/MMM format (+E32647)
01JAN
02FEB
03MAR
04APR
05MAY
06JUN
07JUL
08AUG
09SEP
10OCT
11NOV
12DEC
** TEXT - Text for labels (+E29588)
Module id
Midas transaction no.
Transaction type
Sub-type
External system
Sender
Message type
Destination
Network/paper
Priority
Creation date
Delivery notification
Non-delivery warning
Testkey req/d?
*** ORIGINAL ***
*** COPY ***
Message status
Last action date
time
Error
Released by - user
workstation
*** POSSIBLE DUPLICATE ***
Description
Tag
Data
-----------
---
----
Counterparty confirmation status
Broker confirmation status
Midas trans. no.
C/party conf
Broker conf
<NOT AVAILABLE>
<TAG DESCRIPTION NOT FOUND>
<NOT VERIFIED>
***DELETED***
<MSG DESC NOT FOUND>
Account No.
Input Via Message Management
Deliverer of Security
** VERFY - Message types/fields requiring verification
100:32
202:32
203:19
203:30
203:32
103:32
** TRNTG - Multiple TRN Message types/fields
203:20:
210:21:
** TABCD/TABNAR - Table of Status/Narrative.
CRTDCreated
AMNDAmended
DLTDDeleted
RSNDReady to send
PENDPending Transmission
TRANTransmitted
EFMTFormat error
ELAULogical Authentication error
ESEQInput sequence number error
ETIDTerminal ID error
ELENMessage length error
EAUTS.W.I.F.T. authentication error
QRDQReady queue error
QVRQVerification queue error
LACKLogically acknowledged
NACKNegatively acknowledged
EBL1Error in basic header
EBL2Error in application header
EBL4Error in text
EBL5Error in trailer
PRTDPrinted (released)
RRTDRe-routed (released)
TSNTSent                                                                  081505
TOUTPending Transmission                                                  081505
TCANCancelled                                                             081505
TRTYIn retry                                                              081505
TACTActive                                                                081505
TSENSent                                                                  081505
THLEHeld - error                                                          081505
THLOHeld by Telex operator                                                066991
TBOXAt Telex box                                                          066991
TCNRCancel requested                                                      081505
TRELHeld on Telex queue                                                   081505
TWTGWaiting                                                               081505
TRTSReady to send                                                         081505
TDESIn despatch                                                           081505
TONQOn Telex queue                                                        066991
TCMPComplete                                                              081505
TUNKTelex status unknown                                                  066991
TRRTOn Telex re-route queue                                               066991
TDLTDeleted                                                               081505
TSPVSupervisor to authorise                                               081561
THORHeld by Originator                                                    CMT001
THTCHeld Time Constraints                                                 CMT001
THLOHeld by Tx/Fx Operator                                                CMT001
TCARAt Carrier                                                            CMT001
THOPHeld by Operator                                                      CMT001
TIRSItem Reset                                                            CMT001
TCNAComplete not accounted yet                                            CMT001
     X/COPY WNCPYSRC,ME0800X003
** TAB1 TAB2 (Counterparty and Broker status)
00NO FEEDBACK YET
01WAITING
02TIMED OUT
50PROPOSED PAIR
51PAIRED ERROR-O
52PAIRED ERROR-T
53PAIRED ERROR-B
54PROPOSED INVEST
97NONE EXPECTED
99PAIRED NO ERROR
     X/COPY WNCPYSRC,ME0800X002
