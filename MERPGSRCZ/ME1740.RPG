     H        1   Y
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas ME SWIFT ISO country codes maintenance')         *
      *****************************************************************
      *                                                               *
      *  Midas - Message Management Module                            *
      *                                                               *
      *  ME1740 - Midas ME SWIFT ISO Country Codes Maintenance        *
      *                                                               *
      *  Function:  This program displays Country Codes subfile       *
      *                                                               *
      *  (c) Finastra International Limited 2001                      *
      *                                                               *
      *  Last Amend No. MD046248           Date 27Oct17               *
      *  Prev Amend No. CFT051             Date 02Jun15               *
      *                 MD023040           Date 25Oct13               *
      *                 MD023517           Date 18Nov13               *
      *                 MD023261           Date 05Nov13               *
      *                 MD023086           Date 28Oct13               *
      *                 MD023471           Date 14Nov13               *
      *                 MD023458           Date 14Nov13               *
      *                 MD023358           Date 11Nov13               *
      *                 MD022957           Date 31Oct13               *
      *                 MD023077           Date 03Nov13               *
      *                 MD022942           Date 18Oct13               *
      *                 MD022777           Date 17Oct13               *
      *                 MD022749           Date 10Oct13               *
      *                 MD022592           Date 02Oct13               *
      *                 MD022401           Date 13Sep13               *
      *                 MD022005           Date 10Sep13               *
      *                 MD022293           Date 08Sep13               *
      *                 MD021957           Date 06Sep13               *
      *                 MD022295           Date 10Sep13               *
      *                 MD021995           Date 08Sep13               *
      *                 CSW213             Date 03Jun13               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      *                 CSW209             Date 01Apr09               *
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *                 255919             Date 06Aug08               *
      *                 BUG14933           Date 02Oct07               *
      *                 CSW207A            Date 24Jul07               *
      *                 CSW207             Date 07Jul07               *
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CFT032             Date 11Sep06               *
      * Midas Release 4.01 -------------------------------------------*
      *                 CFT017             Date 12Nov01               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.04 -----------------------------------------------*
      *                 CFT014  *CREATE    Date 25May00               *
      *                                                               *
      *-------------------------------------------------------------- *
      *                                                               *
      *  MD046248 - Finastra Rebranding                               *
      *  CFT051 - SWIFTRef Directories 2014                           *
      *  MD023040 - Any entry in BBAN Bank Length is only allowed if  *
      *             BBAN Length is greater than zero.                 *
      *  MD023517 - Validation for M3IBAR should only be mandatory if *
      *             IBAN Country Code is inputted.                    *
      *  MD023261 - IBAN Structure Fields when ISO ctry code and IBAN *
      *             ctry code and ISO ctry code are not the same are  *
      *             disabled but has underlines (Recompile)           *
      *  MD023086 - Incorrect screen title for enquired ISOM in       *
      *             enquiry menu.                                     *
      *  MD023471 - Delete is not working properly when done the 2nd  *
      *             time                                              *
      *  MD023458 - Account Number Length may only be input when the  *
      *             IBAN Country code is input but Account number     *
      *             length is disabled.                               *
      *  MD023358 - SWIFTRef Country Code Description should be       *
      *             extracted from MEBICCPD and not MEBIB3PD.         *
      *  MD022957 - Defaulting is not working when the value is zero. *
      *  MD023077 - No Error Message Generated                        *
      *  MD022942 - Changed indicator used for IBAN Required field.   *
      *  MD022777 - Field "IBAN Required in MT103+" should not be     *
      *             dependent on CFT050.
      *  MD022749 - No details shown for Enquiry ISOE                 *
      *  MD022592 - Error encountered but amend was accepted          *
      *  MD022401 - Inconsistent behavior, some fields default to '0' *
      *  MD022005 - IBAN Structure fields are amendable when ISO      *
      *             country code and IBAN country code are different  *
      *  MD022293 - No warning message displayed when ISO country code*
      *             is not in SWIFTRef Country code file.             *
      *  MD021957 - Incorrect error description in Branch Id Start    *
      *             Position field                                    *
      *  MD022295 - BBAN Length Error Message exists unexpectedly     *
      *  MD021995 - No validation on field Account Number Start       *
      *             Position when Account Number Length is 0 or blank *
      *  CSW213 - SWIFT Changes 2013                                  *
      *  CSW209 - SWIFT 2009 Changes                                  *
      *  255919 - Reversed checking of CSW207 on when sending error   *
      *           ME00003.  It is not possible to add new ISO country *
      *           code when CSW207 is ON.                             *
      *  BUG14933 - Error in checking switchable feature CSW207       *
      *  CSW207A - SWIFT 2007 Changes (Recompile)                     *
      *  CSW207 - SWIFT 2007 Standard Changes                         *
      *  CFT032 - Account line in field 50X in MT103                  *
      *  CFT017 - Multilateral Inter-bank Exchange Fee.               *
      *  CFT014 - Straight-through Processing Phase 2 MT103 Messages  *
      *           Generation for FT.                                  *
      *                                                               *
      *****************************************************************
      *
      ** Midas ME SWIFT ISO Country Codes display file
      *
     FME1740DFCF  E                    WORKSTN
     F                                        SRRN  KSFILE RSFLRCD
     F                                              KINFDS INFDS#
     F                                              KINFSR *PSSR
     F                                        SRRNB KSFILE RSFLRCDB                           CSW213
      *
      ** Midas ME SWIFT ISO Country Codes retrieval index
      *
     FMEISOCL1IF  E           K        DISK
     F                                              KINFSR *PSSR
      *                                                                                       CSW213
      ** Midas ME SWIFT ISO country codes with IBAN Country Code                              CSW213
      *                                                                                       CSW213
     FMEISOCL3IF  E           K        DISK                                                   CSW213
     F                                              KINFSR *PSSR                              CSW213
      *                                                                                       CSW213
      ** Midas ME BIC Countries file by country retrieval                                     CSW213
      *                                                                                       CSW213
     FMEBICCL1IF  E           K        DISK                                                   CSW213
     F                                              KINFSR *PSSR                              CSW213
      *                                                                                       CSW213
      ** Midas SWIFTRef IBAN Plus Structure                                                   CSW213
      *                                                                                       CSW213
     FMEIBNSL0IF  E           K        DISK                                                   CSW213
     F                                              KINFSR *PSSR                              CSW213
      *                                                                                       CSW213
      ** Midas SWIFTRef IBAN Plus Structure                                                   CSW213
      *                                                                                       CSW213
     F***MEBIB3L3IF  E           K        DISK                                       CSW213 MD023358
     F**********                                    KINFSR *PSSR                     CSW213 MD023358
      *
      ** Midas ME SWIFT ISO Country Codes update index
      *
     FMEISOCL0UF  E           K        DISK                      A
     F                                              KCOMIT
     F                                              KINFSR *PSSR
      *                                                                                       CSW213
      ** Midas SD Country codes update                                                        CSW213
      *                                                                                       CSW213
     FSDCTRYL2UF  E           K        DISK                                                   CSW213
     F                                              KCOMIT                                    CSW213
     F                                              KINFSR *PSSR                              CSW213
      *
      ** Copyright notice for inclusion in all programs
      *
     E                    CPY@    1   1 80
      /COPY ZSRSRC,ZDATE2Z1                                                                   CSW213
      /COPY ZSRSRC,ZALIGNZ1                                                                   CSW213
      *
      * Copyright array
      *
     IA@CPY       DS
     I                                        1  80 CPY@
      *
      ** Program data structure
      *
     IPGMDS     ESDSY2PGDSP
      *
      ** Display file information data structure
      *
     IINFDS#    E DSY2I#DSP
      *
      ** Local data area data structure
      *
     IWLDA      E DSLDA
      *
      ** Bank's data structure
      *
     ISDBANK    E DSSDBANKPD
      *
      ** Long data structure
      *
     ISCSARD    E DSSCSARDPD                                                                  CFT017
      ** SAR Details Accessed via access program                                              CFT017
      *                                                                                       CFT017
     IDSSDY     E DSDSSDY
      *
      ** Data structure for PF/MEISOCPD
      *
     IWDBRC     E DSMEISOCL0
      *
      ** Data structure used by access program
      *
     IDSFDY     E DSDSFDY
      *
     I              'ABCDEFGHIJKLMNOPQRST-C         ALPNUM
     I              'UVWXYZ1234567890'
      *                                                                                       CSW213
     I              'ABCDEFGHIJKLMNOPQRST-C         ALPONL                                    CSW213
     I              'UVWXYZ'                                                                  CSW213
      *
      ** Initialize
      *
      *****************************************************************
     C                     EXSR SRINIT
      *
     C           CSW213    IFEQ 'Y'                                                           CSW213
     C           CFT050    OREQ 'Y'                                                           CSW213
     C                     EXSR SMAINB                                                        CSW213
     C                     ELSE                                                               CSW213
      *                                                                                       CSW213
     C                     DO   *HIVAL
      *
      ** Initialise & load subfile page
      *
     C                     EXSR SRIZSF
     C                     MOVEL'N'       W0RSF   1
      *
      ** Display screen until reload requested
      *
     C           W0RSF     DOWEQ'N'
      *
      ** Display screen
      *
     C                     EXSR SRDSPS
      *
      ** Cancel & exit program
      *
     C   03                CAS            SREXIT
      *
      ** Request subfile reload
      *
     C   05                CAS            SRRQRL
      *
      ** Display next SFL page
      *
     C   27                CAS            SRLDSF
      *
      ** Process screen input
      *
     C                     CAS            SRPROC
     C                     END
      *
     C                     ENDDO
     C                     ENDDO
      *
     C                     ENDIF                                                              CSW213
      *                                                                                       CSW213
      ** Terminate program
      *
     C                     MOVE '1'       *INLR
      *****************************************************************
      /EJECT
     CSR         SRIZSF    BEGSR
      *================================================================
      ** Initialise and load subfile page
      *================================================================
      *
      ** Clear subfile
      *
     C                     SETON                     80
     C                     WRITERSFLCTL
     C                     SETOF                     80
      *
      ** Reset no of records in subfile
      *
     C                     Z-ADD*ZERO     WRRN    50 81
     C           WMODE     IFNE 'ADD'
     C********** *LIKE     DEFN SEISOC    WZISOC                                              CSW213
     C                     MOVE *BLANKS   WZISOC
     C                     MOVELSEISOC    WZISOC
      *
      ** Position DBF file
      *
     C********** KPOS      KLIST                                                              CSW213
     C**********           KFLD           M3ISOC                                              CSW213
      *
      ** Setup key
      *
     C                     MOVELSEISOC    M3ISOC
     C           KPOS      SETLLMEISOCL1
     C                     READ MEISOCL1               8782
     C                     ELSE
     C                     MOVE '0'       *IN82
     C                     ENDIF
     C                     EXSR SRLDSF
      *================================================================
     CSR         EXIZSF    ENDSR
      /EJECT
     CSR         SRLDSF    BEGSR
      *================================================================
      ** Load subfile page
      *================================================================
     C                     MOVE '0'       *IN84
      *
      ** Re-establish fields in read-ahead record
      *
     C           *IN27     IFEQ '1'
     C           WMODE     ANDNE'ADD'
     C  N82                READPMEISOCL1                 90
     C  N82                READ MEISOCL1                 90
     C                     ENDIF
      *
      ** Start at previous highest record in SFL
      *
     C                     Z-ADDWRRN      SRRN    50
     C                     Z-ADD0         WCTR    50
     C                     Z-ADD0         WCTR2   50
      *
      ** Set required pages based on *Set Cursor or *Subfile Pages
      *
     C           W0RR0     IFGT 0
     C           W0RR0     DIV  WSFPG     WSPG    30
     C                     MVR            WSLIN   30
     C           WSLIN     IFGT 0
     C                     ADD  1         WSPG
     C                     ENDIF
     C           W0SPG     IFGT WSPG
     C                     Z-ADDW0SPG     WSPG
     C                     ENDIF
     C                     ELSE
     C                     Z-ADDW0SPG     WSPG
     C                     ENDIF
      *
      ** Compute lines required based on pages
      *
     C           WSPG      MULT WSFPG     WSFLN
     C           WSFLN     IFGT 999
     C                     Z-ADD999       WSFLN
     C                     ENDIF
      *
      ** Load next SFL page until SFL page full, or
      ** Scan limit reached
      *
     C           *IN82     DOWEQ'0'
     C           WCTR      ANDLTWSFLN
     C           WCTR2     ANDLTW0SLM
      *
      ** Setof record error indicators
      *
     C                     MOVE *ALL'0'   WKIND0  4
     C                     MOVEAWKIND0    *IN,31
     C                     MOVE '0'       *IN36                                               CFT017
     C                     MOVE '0'       *IN38                                               CFT032
     C                     MOVE '0'       *IN20
     C                     MOVE '0'       *IN21
     C                     MOVE '0'       *IN40
     C                     MOVE '0'       *IN41                                               CSW207
     C                     MOVE '0'       *IN42                                               CSW209
     C                     MOVE '0'       *IN50
     C                     MOVE '0'       *IN51
      *
     C           PMMODE    IFEQ 'E'
     C                     MOVE '1'       *IN20
     C                     MOVE '1'       *IN40
     C                     MOVE '1'       *IN51
     C                     ELSE
     C           WMODE     IFEQ 'ADD'
     C                     MOVE '1'       *IN50
     C                     ENDIF
     C           WMODE     IFEQ 'CHG'
     C                     MOVE '1'       *IN21
     C                     ENDIF
     C                     ENDIF
      *
     C                     EXSR SRISFF
      *
     C           WMODE     IFNE 'ADD'
      *
      ** Load SFL fields
      *
     C                     EXSR SRLSFF
     C                     MOVELWDBRC     SDBRC
     C                     ENDIF
      *
      ** Output to subfile
      *
     C                     ADD  1         SRRN
     C                     ADD  1         WCTR       81
      *
     C                     WRITERSFLRCD
      *
      ** Increment scan check count
      *
     C                     ADD  1         WCTR2
     C           WMODE     IFNE 'ADD'
     C                     READ MEISOCL1                 82
     C                     ENDIF
     C                     ENDDO
      *
      ** Save highest SFL record load can continue at end point
      *
     C           SRRN      IFGT WRRN
      *
      ** Calculate top line
      *
     C           WCTR      DIV  WSFPG     WSPG
     C                     MVR            WSLIN
     C           WSLIN     IFGT 0
     C           SRRN      SUB  WSLIN     SSFRC
     C                     ELSE
     C           SRRN      SUB  WSFPG     SSFRC
     C                     ENDIF
     C                     ADD  1         SSFRC
     C                     Z-ADDSRRN      WRRN
     C                     ENDIF
      *
      ** If scan limit reached, display error message
      *
     C           WCTR2     IFGE W0SLM
      *
      ** Send message 'Scan limit reached'
      *
     C                     MOVEL'ME00010' ZAMSID
     C                     MOVEL'MEMSG'   ZAMSGF
     C                     EXSR ZASNMS
     C                     ELSE
     C                     Z-ADD0         WCTR
     C                     ENDIF
      *================================================================
     CSR         EXLDSF    ENDSR
      /EJECT
     CSR         SRDSPS    BEGSR
      *================================================================
      ** Display screen
      *================================================================
     C           *IN82     IFEQ '1'
     C           WRRN      ANDEQ0
      *
      ** Send message '*No data to display'
      *
     C                     MOVEL'ME00001' ZAMSID
     C                     MOVEL'MEMSG'   ZAMSGF
     C                     EXSR ZASNMS
     C                     ENDIF
     C                     WRITERMSGCTL
      *
     C           PMMODE    IFEQ 'M'
     C           WMODE     IFEQ 'CHG'
     C                     MOVELWTXTC     SCTX1
     C                     ELSE
     C                     MOVELWTXTA     SCTX1
     C                     ENDIF
     C                     ENDIF
      *
     C                     WRITERCMDTXT1
      *
      ** Update screen time
      *
     C                     TIME           STIME
      *
     C                     EXFMTRSFLCTL
      *
      ** Maintain subfile position where possible
      *
     C           @#SFRC    IFGT *ZERO
     C                     Z-ADD@#SFRC    SSFRC
     C                     ENDIF
      *
     C                     EXSR SRCLR
      *================================================================
     CSR         EXDSPS    ENDSR
      /EJECT
     CSR         SRPROC    BEGSR
      *================================================================
      ** Process screen input
      *================================================================
     C           WMODE     IFNE 'ADD'
     C           WZISOC    ANDNESEISOC
     C                     EXSR SRRQRL
     C           W0RSF     CABEQ'Y'       EXPROC
     C                     ENDIF
      *
     C           PMMODE    IFEQ 'E'
     C                     EXSR SRRQRL
     C           W0RSF     CABEQ'Y'       EXPROC
     C                     ENDIF
      *
     C                     MOVE *BLANK    WERR    1
     C                     MOVE 'Y'       WNULL   1
      *
     C           WRRN      IFNE 0
      *
     C           WMODE     IFEQ 'CHG'
     C                     EXSR SRPRS1
     C                     ENDIF
      *
     C           WERR      IFEQ *BLANK
     C           WNULL     ANDEQ'N'
     C           WMODE     OREQ 'ADD'
     C                     EXSR SRPRS2
     C                     ENDIF
      *
     C           WERR      IFEQ *BLANK
     C           WNULL     ANDEQ'N'
     C                     EXSR SRPRS3
     C                     ENDIF
      *
     C                     ENDIF
      *
     C           WERR      IFEQ *BLANK
     C           *IN09     ANDEQ'1'
     C           WMODE     IFEQ 'ADD'
     C                     MOVE 'CHG'     WMODE
     C                     ELSE
     C                     MOVE 'ADD'     WMODE
     C                     ENDIF
     C                     EXSR SRRQRL
     C                     ENDIF
      *
     C           WNULL     IFEQ 'Y'
     C                     EXSR SRRQRL
     C                     ENDIF
      *================================================================
     CSR         EXPROC    ENDSR
      /EJECT
     CSR         SRPRS1    BEGSR
      *================================================================
      ** Validate Option
      *================================================================
     C                     READCRSFLRCD                  92
      *
      ** Process subfile record
      *
     C           *IN92     DOWEQ'0'
      *
      ** Setof record error indicators
      *
     C                     MOVEL*ALL'0'   WKIND0
     C                     MOVEAWKIND0    *IN,31
     C                     MOVE '0'       *IN36                                               CFT017
     C                     MOVE '0'       *IN38                                               CFT032
     C                     MOVE '0'       *IN41                                               CSW207
     C                     MOVE '0'       *IN42                                               CSW209
     C                     MOVE 'N'       WNULL
     C                     MOVE '1'       *IN84
     C           SCSEL     IFNE 'D'
     C           SCSEL     ANDNE*BLANK
     C                     MOVE '1'       *IN34
     C           WERR      IFEQ *BLANK
     C                     MOVE 'Y'       WERR
     C                     Z-ADDSRRN      SSFRC
     C                     MOVEL'ME00002' ZAMSID
     C                     MOVEL'MEMSG'   ZAMSGF
     C                     EXSR ZASNMS
     C                     ENDIF
     C                     ENDIF
     C                     UPDATRSFLRCD
     C                     READCRSFLRCD                  92
     C                     ENDDO
      *================================================================
     CSR         EXPRS1    ENDSR
      /EJECT
     CSR         SRPRS2    BEGSR
      *================================================================
      ** Validate details
      *================================================================
     C                     READCRSFLRCD                  92
      *
      ** Process subfile record
      *
     C           *IN92     DOWEQ'0'
      *
      ** Setof record error indicators
      *
     C                     MOVEL*ALL'0'   WKIND0
     C                     MOVEAWKIND0    *IN,31
     C                     MOVE '0'       *IN36                                               CFT017
     C                     MOVE '0'       *IN38                                               CFT032
     C                     MOVE '0'       *IN41                                               CSW207
     C                     MOVE '0'       *IN42                                               CSW209
     C                     MOVE *BLANK    WERROR  1
     C                     MOVE '0'       *IN84
     C           WMODE     IFEQ 'CHG'
     C           SISOC     ORNE *BLANKS
     C           SISOD     ORNE *BLANKS
     C           SSCHT     ORNE *BLANKS
     C           SSEEA     ORNE *BLANKS                                                       CFT017
     C********** SFATF     ORNE *BLANKS                                                CFT032 CSW207
     C           CFT017    ANDEQ'Y'                                                           CFT017
     C           SFATF     ORNE *BLANKS                                                       CSW207
     C           SMFID     ORNE *BLANKS                                                       CSW207
     C           CSW207    ANDEQ'Y'                                                           CSW207
     C                     MOVE 'N'       WNULL
     C                     MOVE '1'       *IN84
     C           SCSEL     IFEQ *BLANK
     C                     EXSR SRVREC
     C           WERROR    IFEQ 'Y'
     C           WERR      ANDEQ*BLANK
     C                     MOVE 'Y'       WERR
     C                     Z-ADDSRRN      SSFRC
     C                     ENDIF
     C                     ENDIF
     C                     ENDIF
     C                     UPDATRSFLRCD
     C                     READCRSFLRCD                  92
     C                     ENDDO
      *================================================================
     CSR         EXPRS2    ENDSR
      /EJECT
     CSR         SRVREC    BEGSR
      *================================================================
      ** Validate details screen fields
      *================================================================
     C           WMODE     IFEQ 'ADD'
     C           WMODE     OREQ 'LST'                                                         CSW213
      *
     C           SISOC     IFEQ *BLANKS
     C           SISOD     ANDNE*BLANKS
     C           SISOC     OREQ *BLANKS
     C           SSCHT     ANDNE*BLANKS
     C           SISOC     OREQ *BLANKS                                                       CFT017
     C           SSEEA     ANDNE*BLANKS                                                       CFT017
     C********** SISOC     OREQ *BLANKS                                                CFT032 CSW207
     C********** SFATF     ANDNE*BLANKS                                                CFT032 CSW207
     C           CFT017    ANDEQ'Y'                                                           CFT017
     C           SISOC     OREQ *BLANKS                                                       CSW207
     C           SFATF     ANDNE*BLANKS                                                       CSW207
     C           SISOC     OREQ *BLANKS                                                       CSW207
     C           SMFID     ANDNE*BLANKS                                                       CSW207
     C********** CSW207    OREQ 'Y'                                                    CSW207 255919
     C                     MOVEL'ME00003' ZAMSID
     C                     MOVEL'MEMSG'   ZAMSGF
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN31
     C                     MOVE 'Y'       WERROR
     C                     ENDIF
      *
     C           SISOC     IFNE *BLANKS
     C                     MOVE *BLANKS   WFLDC
     C                     MOVELSISOC     WFLDC   2
     C                     MOVE '0'       *IN70
     C           ALPNUM    CHECKWFLDC                    70
     C           *IN70     IFEQ '1'
     C                     MOVEL'ME00004' ZAMSID
     C                     MOVEL'MEMSG'   ZAMSGF
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN31
     C                     MOVE 'Y'       WERROR
     C                     ENDIF
     C                     ENDIF
      *
     C                     ENDIF
      *
     C           SISOD     IFEQ *BLANKS
     C           SISOC     ANDNE*BLANKS
     C           SISOD     OREQ *BLANKS
     C           SSCHT     ANDNE*BLANKS
     C           SISOD     OREQ *BLANKS                                                       CFT017
     C           SSEEA     ANDNE*BLANKS                                                       CFT017
     C           SISOD     OREQ *BLANKS                                                       CFT032
     C           SFATF     ANDNE*BLANKS                                                       CFT032
     C           CFT017    ANDEQ'Y'                                                           CFT017
     C                     MOVEL'ME00005' ZAMSID
     C                     MOVEL'MEMSG'   ZAMSGF
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN32
     C                     MOVE 'Y'       WERROR
     C                     ENDIF
      *
     C           SSCHT     IFEQ *BLANK
     C           SISOC     ANDNE*BLANKS
     C           SSCHT     OREQ *BLANK
     C           SISOD     ANDNE*BLANKS
     C                     MOVE 'N'       SSCHT
     C                     ENDIF
      *                                                                                       CFT017
      ** If CFT017 is installed and required fields are filled in while EEA member flag       CFT017
      ** is blanks, default this to 'N'                                                       CFT017
      *                                                                                       CFT017
     C           CFT017    IFEQ 'Y'                                                           CFT017
      *                                                                                       CFT017
     C           SSEEA     IFEQ *BLANK                                                        CFT017
     C           SISOC     ANDNE*BLANKS                                                       CFT017
     C           SSEEA     OREQ *BLANK                                                        CFT017
     C           SISOD     ANDNE*BLANKS                                                       CFT017
     C                     MOVE 'N'       SSEEA                                               CFT017
     C                     ENDIF                                                              CFT017
      *                                                                                       CFT017
     C                     ENDIF                                                              CFT017
      *                                                                                       CFT032
     C           SFATF     IFEQ *BLANKS                                                       CFT032
     C           SISOC     ANDNE*BLANKS                                                       CFT032
     C           SFATF     OREQ *BLANKS                                                       CFT032
     C           SISOD     ANDNE*BLANKS                                                       CFT032
     C                     MOVE 'N'       SFATF                                               CFT032
     C           CSW207    IFEQ 'Y'                                                           CSW207
     C                     MOVE 'N'       SMFID                                               CSW207
     C                     ENDIF                                                              CSW207
     C                     ENDIF                                                              CFT032
      *
     C           SSCHT     IFNE *BLANK
     C           SSCHT     ANDNE'Y'
     C           SSCHT     ANDNE'N'
     C                     MOVEL'ME00006' ZAMSID
     C                     MOVEL'MEMSG'   ZAMSGF
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN33
     C                     MOVE 'Y'       WERROR
     C                     ENDIF
      *                                                                                       CFT017
      ** If EEA member flag is not blank, 'Y' nor 'N', send error message                     CFT017
      *                                                                                       CFT017
     C           SSEEA     IFNE *BLANK                                                        CFT017
     C           SSEEA     ANDNE'Y'                                                           CFT017
     C           SSEEA     ANDNE'N'                                                           CFT017
     C           CFT017    ANDEQ'Y'                                                           CFT017
     C                     MOVEL'ME00028' ZAMSID                                              CFT017
     C                     MOVEL'MEMSG'   ZAMSGF                                              CFT017
     C                     EXSR ZASNMS                                                        CFT017
     C                     MOVE '1'       *IN36                                               CFT017
     C                     MOVE 'Y'       WERROR                                              CFT017
     C                     ENDIF                                                              CFT017
      *                                                                                       CFT032
     C           SFATF     IFNE *BLANK                                                        CFT032
     C           SFATF     ANDNE'Y'                                                           CFT032
     C           SFATF     ANDNE'N'                                                           CFT032
     C                     MOVEL'ME21818' ZAMSID                                              CFT032
     C                     MOVEL'MEMSG'   ZAMSGF                                              CFT032
     C                     EXSR ZASNMS                                                        CFT032
     C                     MOVE '1'       *IN38                                               CFT032
     C                     MOVE 'Y'       WERROR                                              CFT032
     C                     ENDIF                                                              CFT032
      *                                                                                       CSW207
     C           SMFID     IFNE *BLANK                                                        CSW207
     C           SMFID     ANDNE'Y'                                                           CSW207
     C           SMFID     ANDNE'N'                                                           CSW207
     C                     MOVEL'ME00042' ZAMSID                                              CSW207
     C                     MOVEL'MEMSG'   ZAMSGF                                              CSW207
     C                     EXSR ZASNMS                                                        CSW207
     C                     MOVE '1'       *IN41                                               CSW207
     C                     MOVE 'Y'       WERROR                                              CSW207
     C                     ENDIF                                                              CSW207
      *                                                                                       CSW207
     C           CSW209    IFEQ 'Y'                                                           CSW209
     C           SM205     IFEQ *BLANK                                                        CSW209
     C                     MOVEL'N'       SM205                                               CSW209
     C                     ELSE                                                               CSW209
     C           SM205     IFNE 'Y'                                                           CSW209
     C           SM205     ANDNE'N'                                                           CSW209
     C                     MOVEL'ME21820' ZAMSID                                              CSW209
     C                     MOVEL'MEMSG'   ZAMSGF                                              CSW209
     C                     EXSR ZASNMS                                                        CSW209
     C                     MOVE '1'       *IN42                                               CSW209
     C                     MOVE 'Y'       WERROR                                              CSW209
     C                     ENDIF                                                              CSW209
     C                     ENDIF                                                              CSW209
     C                     ENDIF                                                              CSW209
      *================================================================
     CSR         EXVREC    ENDSR
      /EJECT
     CSR         SRPRS3    BEGSR
      *================================================================
      ** Update database
      *================================================================
     C           WMODE     IFEQ 'ADD'
     C                     EXSR SRRQRL
     C                     ELSE
     C                     MOVE 'N'       W0RSF
     C                     ENDIF
      *
     C                     READCRSFLRCD                  92
      *
      ** Process subfile record
      *
     C           *IN92     DOWEQ'0'
      *
      ** Setof record error indicators
      *
     C                     MOVEL*ALL'0'   WKIND0
     C                     MOVEAWKIND0    *IN,31
     C                     MOVE '0'       *IN36                                               CFT017
     C                     MOVE *BLANK    WERROR
     C                     MOVE '0'       *IN84
      *
     C           WMODE     IFEQ 'ADD'
     C                     EXSR SRADD
     C                     ELSE
     C           SCSEL     IFEQ 'D'
     C                     EXSR SRDEL
     C                     EXSR SRRQRL
     C                     ELSE
     C                     EXSR SRAMD
     C                     ENDIF
     C                     ENDIF
      *
     C           WERROR    IFEQ 'Y'
     C                     MOVE '1'       *IN84
     C                     MOVE '1'       *IN31
     C                     MOVE '1'       *IN32
     C                     MOVE '1'       *IN33
     C                     MOVE '1'       *IN36                                               CFT017
     C                     MOVE '1'       *IN38                                               CFT032
     C                     MOVE '1'       *IN41                                               CSW207
     C           CSW209    IFEQ 'Y'                                                           CSW209
     C                     MOVE '1'       *IN42                                               CSW209
     C                     ENDIF                                                              CSW209
     C           *IN50     IFEQ '0'
     C           *IN51     ANDEQ'0'
     C                     MOVE '1'       *IN34
     C                     ENDIF
      *
     C           WERR      IFEQ *BLANK
     C                     MOVE 'Y'       WERR
     C                     Z-ADDSRRN      SSFRC
     C                     ENDIF
      *
     C                     ROLBK
     C                     ELSE
     C                     COMIT
     C                     ENDIF
      *
     C                     MOVE *BLANK    SCSEL
     C                     UPDATRSFLRCD
     C                     READCRSFLRCD                  92
     C                     ENDDO
      *
     C           WERR      IFNE *BLANK
     C                     MOVE 'N'       W0RSF
     C                     ENDIF
      *================================================================
     CSR         EXPRS3    ENDSR
      /EJECT
     CSR         SRADD     BEGSR
      *================================================================
      ** Add record
      *================================================================
     C           SISOC     CHAIN@ISOCL0              60
     C           *IN60     IFEQ '0'
     C                     MOVEL'ME00007' ZAMSID
     C                     MOVEL'MEMSG'   ZAMSGF
     C                     EXSR ZASNMS
     C                     MOVE 'Y'       WERROR
     C                     GOTO EXADD
     C                     ENDIF
      *
     C                     MOVE SISOC     M3ISOC
     C                     MOVE SISOD     M3ISOD
     C                     MOVE SSCHT     M3SCHT
     C                     MOVE SSEEA     M3EEAM                                              CFT017
     C                     MOVE SFATF     M3FATF                                              CFT032
      *                                                                                       CSW207
     C           CSW207    IFEQ 'Y'                                                           CSW207
     C                     MOVE SMFID     M3MFID                                              CSW207
     C                     ENDIF                                                              CSW207
      *                                                                                       CSW207
     C           CSW209    IFEQ 'Y'                                                           CSW209
     C                     MOVE SM205     M3M205                                              CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C                     MOVE ##JOB     M3ACJN
     C                     MOVE ##USR     M3ACUN
     C                     MOVE STIME     M3ACTM
     C                     MOVE BJMRDT    M3ACDA
     C                     MOVE 'I'       M3ACTY
      *
     C                     WRITE@ISOCL0                91
      *
      ** Display error msg if file update not successful
      *
     C           *IN91     IFEQ '1'
     C                     MOVEL'ME00011' ZAMSID
     C                     MOVEL'MEMSG'   ZAMSGF
     C                     EXSR ZASNMS
     C                     MOVE 'Y'       WERROR
     C                     ENDIF
      *================================================================
     CSR         EXADD     ENDSR
      /EJECT
     CSR         SRDEL     BEGSR
      *================================================================
      ** Delete record
      *================================================================
     C           SISOC     CHAIN@ISOCL0              60
     C           *IN60     IFEQ '1'
     C                     MOVEL'ME00008' ZAMSID
     C                     MOVEL'MEMSG'   ZAMSGF
     C                     EXSR ZASNMS
     C                     MOVE 'Y'       WERROR
     C                     GOTO EXDEL
     C                     ENDIF
      *
     C           WDBRC     IFNE SDBRC
     C                     MOVEL'ME00009' ZAMSID
     C                     MOVEL'MEMSG'   ZAMSGF
     C                     EXSR ZASNMS
     C                     MOVE 'Y'       WERROR
     C                     EXSR SRLSFF
     C                     MOVELWDBRC     SDBRC
     C                     GOTO EXDEL
     C                     ENDIF
      *
     C                     DELET@ISOCL0                91
      *
      ** Display error msg if file update not successful
      *
     C           *IN91     IFEQ '1'
     C                     MOVEL'ME00011' ZAMSID
     C                     MOVEL'MEMSG'   ZAMSGF
     C                     EXSR ZASNMS
     C                     MOVE 'Y'       WERROR
     C                     ENDIF
      *================================================================
     CSR         EXDEL     ENDSR
      /EJECT
     CSR         SRAMD     BEGSR
      *================================================================
      ** Amend record
      *================================================================
     C           SISOC     CHAIN@ISOCL0              60
     C           *IN60     IFEQ '1'
     C                     MOVEL'ME00008' ZAMSID
     C                     MOVEL'MEMSG'   ZAMSGF
     C                     EXSR ZASNMS
     C                     MOVE 'Y'       WERROR
     C                     GOTO EXAMD
     C                     ENDIF
      *
     C           WDBRC     IFNE SDBRC
     C                     MOVEL'ME00009' ZAMSID
     C                     MOVEL'MEMSG'   ZAMSGF
     C                     EXSR ZASNMS
     C                     MOVE 'Y'       WERROR
     C                     EXSR SRLSFF
     C                     MOVELWDBRC     SDBRC
     C                     GOTO EXAMD
     C                     ENDIF
      *
     C                     MOVE SISOD     M3ISOD
     C                     MOVE SSCHT     M3SCHT
     C                     MOVE SSEEA     M3EEAM                                              CFT017
     C                     MOVE SFATF     M3FATF                                              CFT032
     C                     MOVE SMFID     M3MFID                                              CSW207
     C           CSW209    IFEQ 'Y'                                                           CSW209
     C                     MOVE SM205     M3M205                                              CSW209
     C                     ENDIF                                                              CSW209
     C                     MOVE ##JOB     M3ACJN
     C                     MOVE ##USR     M3ACUN
     C                     MOVE STIME     M3ACTM
     C                     MOVE BJMRDT    M3ACDA
     C                     MOVE 'A'       M3ACTY
      *
     C                     UPDAT@ISOCL0                91
      *
      ** Display error msg if file update not successful
      *
     C           *IN91     IFEQ '1'
     C                     MOVEL'ME00011' ZAMSID
     C                     MOVEL'MEMSG'   ZAMSGF
     C                     EXSR ZASNMS
     C                     MOVE 'Y'       WERROR
     C                     ELSE
     C                     MOVELWDBRC     SDBRC
     C                     ENDIF
      *================================================================
     CSR         EXAMD     ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      ** Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANKS
     C                     MOVEL##PGM     ZAPGMQ
     C                     ENDIF
      *
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA132        Message data
     C                     PARM           ZAMSTP  7        Message type
      *================================================================
     CSR         EXSNMS    ENDSR
      /EJECT
     CSR         SRCLR     BEGSR
      *================================================================
      ** Clear messages in program queue
      *================================================================
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      *================================================================
     CSR         EXCLR     ENDSR
      /EJECT
     CSR         SREXIT    BEGSR
      *================================================================
      ** Exit program processing
      *================================================================
     C                     SETON                     LR
     C                     RETRN
      *================================================================
     CSR         EXEXIT    ENDSR
      /EJECT
     CSR         SRRQRL    BEGSR
      *================================================================
      ** Request subfile reload
      *================================================================
     C                     MOVEL'Y'       W0RSF
      *================================================================
     CSR         EXRQRL    ENDSR
      /EJECT
     CSR         SRLSFF    BEGSR
      *================================================================
      ** Move MEISOCL1 fields to subfile
      *================================================================
     C                     MOVELM3ACJN    SACJN
     C                     MOVELM3ACUN    SACUN
     C                     MOVELM3ACTM    SACTM
     C                     MOVELM3ACDA    SACDA
     C                     MOVELM3ACTY    SACTY
     C                     MOVELM3ISOC    SISOC
     C                     MOVELM3ISOD    SISOD
     C                     MOVELM3SCHT    SSCHT
     C                     MOVELM3EEAM    SSEEA                                               CFT017
     C                     MOVELM3FATF    SFATF                                               CFT032
      *                                                                                     MD022592
      **When record has been updated by another workstation include fields                  MD022592
      **introduced by CSW213 in file MEISOCPD                                               MD022592
      *                                                                                     MD022592
     C                     MOVELM3IBAC    SIBAC                                             MD022592
     C                     MOVELM3SEPA    SSEPA                                             MD022592
     C                     MOVELM3IBAR    SIBAR                                             MD022592
     C                     MOVELM3CCSP    SCCSP                                             MD022592
     C                     MOVELM3CCLN    SCCLN                                             MD022592
     C                     MOVELM3ICSP    SICSP                                             MD022592
     C                     MOVELM3ICLN    SICLN                                             MD022592
     C                     MOVELM3BBSP    SBBSP                                             MD022592
     C                     MOVELM3BBLN    SBBLN                                             MD022592
     C                     MOVELM3BISP    SBISP                                             MD022592
     C                     MOVELM3BILN    SBILN                                             MD022592
     C                     MOVELM3BRSP    SBRSP                                             MD022592
     C                     MOVELM3BRLN    SBRLN                                             MD022592
     C                     MOVELM3INLN    SINLN                                             MD022592
     C                     MOVELM3ACSP    SACSP                                             MD022592
     C                     MOVELM3ACLN    SACLN                                             MD022592
     C                     MOVELM3TBLN    STBLN                                             MD022592
     C                     MOVELM3TILN    STILN                                             MD022592
      *                                                                                     MD022592
      ** Avoid '000000' value on Optional and Mandatory Commende date field to              MD022592
      ** block error message regarding invalid date.                                        MD022592
      *                                                                                     MD022592
     C           SOCDT     IFNE *BLANKS                                                     MD022592
     C           M3OCDT    IFEQ 0                                                           MD022592
     C                     MOVE *BLANKS   SOCDT                                             MD022592
     C                     ELSE                                                             MD022592
     C                     MOVELM3OCDT    SOCDT                                             MD022592
     C                     ENDIF                                                            MD022592
     C                     ENDIF                                                            MD022592
     C           SMCDT     IFNE *BLANKS                                                     MD022592
     C           M3MCDT    IFEQ 0                                                           MD022592
     C                     MOVE *BLANKS   SMCDT                                             MD022592
     C                     ELSE                                                             MD022592
     C                     MOVELM3MCDT    SMCDT                                             MD022592
     C                     ENDIF                                                            MD022592
     C                     ENDIF                                                            MD022592
     C                     EXSR SPOPDF                                                      MD022592
     C           CSW207    IFEQ 'Y'                                                           CSW207
     C                     MOVELM3MFID    SMFID                                               CSW207
     C                     ENDIF                                                              CSW207
      *                                                                                       CSW209
     C           CSW209    IFEQ 'Y'                                                           CSW209
     C                     MOVELM3M205    SM205                                               CSW209
     C                     ENDIF                                                              CSW209
      *================================================================
     CSR         EXLSFF    ENDSR
      /EJECT
     CSR         SRISFF    BEGSR
      *================================================================
      ** Initialise subfile fields
      *================================================================
     C                     MOVE *BLANKS   SDBRC
     C                     MOVE *BLANKS   SCSEL
     C                     MOVE *BLANKS   SACJN
     C                     MOVE *BLANKS   SACUN
     C                     MOVE *BLANKS   SACTM
     C                     MOVE *BLANKS   SACDA
     C                     MOVE *BLANKS   SACTY
     C                     MOVE *BLANKS   SISOC
     C                     MOVE *BLANKS   SISOD
     C                     MOVE *BLANKS   SSCHT
     C                     MOVE *BLANKS   SSEEA                                               CFT017
     C                     MOVE *BLANKS   SFATF                                               CFT032
     C           CSW207    IFEQ 'Y'                                                           CSW207
     C                     MOVE *BLANKS   SMFID                                               CSW207
     C                     ENDIF                                                              CSW207
     C           CSW209    IFEQ 'Y'                                                           CSW209
     C                     MOVE *BLANKS   SM205                                               CSW209
     C                     ENDIF                                                              CSW209
      *================================================================
     CSR         EXISFF    ENDSR
      /EJECT
     CSR         SMAINB    BEGSR                                                              CSW213
      *================================================================                       CSW213
      ** Main Processing B for CSW213                                                         CSW213
      *================================================================                       CSW213
      *                                                                                       CSW213
     C           PMMODE    IFEQ 'E'                                                           CSW213
     C           PMISOC    ANDNE*BLANKS                                                       CSW213
     C                     MOVE *ON       *IN20                                               CSW213
     C                     MOVELWTXTE     SCTX1                                               CSW213
     C                     EXSR SPROCB                                                        CSW213
     C                     ELSE                                                               CSW213
     C                     DO   *HIVAL                                                        CSW213
      *                                                                                       CSW213
      ** Initialise & load subfile page                                                       CSW213
      *                                                                                       CSW213
     C                     EXSR SRZSFB                                                        CSW213
     C                     MOVEL'N'       W0RSF   1                                           CSW213
      *                                                                                       CSW213
      ** Display screen until reload requested                                                CSW213
      *                                                                                       CSW213
     C           W0RSF     DOWEQ'N'                                                           CSW213
      *                                                                                       CSW213
      ** Display screen                                                                       CSW213
      *                                                                                       CSW213
     C                     EXSR SDSPSB                                                        CSW213
      *                                                                                       CSW213
      ** *IN03 Cancel & exit program, *IN05 Request subfile reload                            CSW213
      *                                                                                       CSW213
     C   03                CAS            SREXIT                                              CSW213
     C   05                CAS            SRRQRL                                              CSW213
     C   27                CAS            SLDSFB                                              CSW213
      *                                                                                       CSW213
      ** Process screen input/add new record                                                  CSW213
      *                                                                                       CSW213
     C                     CAS            SPROCB                                              CSW213
     C                     ENDCS                                                              CSW213
      *                                                                                       CSW213
     C                     ENDDO                                                              CSW213
     C                     ENDDO                                                              CSW213
      *                                                                                       CSW213
     C                     ENDIF                                                              CSW213
      *================================================================                       CSW213
     CSR         EXAINB    ENDSR                                                              CSW213
      /EJECT                                                                                  CSW213
     CSR         SRZSFB    BEGSR                                                              CSW213
      *================================================================                       CSW213
      ** Alternate SRIZSF routine                                                             CSW213
      *================================================================                       CSW213
      *                                                                                       CSW213
      ** Clear subfile                                                                        CSW213
      *                                                                                       CSW213
     C                     SETON                     80                                       CSW213
     C                     WRITERSFLCTLB                                                      CSW213
     C                     SETOF                     80                                       CSW213
      *                                                                                       CSW213
      ** Reset no of records in subfile                                                       CSW213
      *                                                                                       CSW213
     C                     Z-ADD*ZERO     WRRN    50 81                                       CSW213
     C           *IN05     IFEQ *ON                                                           CSW213
     C                     MOVE *BLANKS   SEISOC                                              CSW213
     C                     ENDIF                                                              CSW213
      *                                                                                       CSW213
     C           WMODE     IFNE 'ADD'                                                         CSW213
     C                     MOVE *BLANKS   WZISOC                                              CSW213
     C                     MOVELSEISOC    WZISOC                                              CSW213
      *                                                                                       CSW213
      ** Position DBF file                                                                    CSW213
      *                                                                                       CSW213
     C                     MOVELSEISOC    M3ISOC                                              CSW213
     C           KPOS      SETLLMEISOCL1                                                      CSW213
      *                                                                                       CSW213
     C           PMMODE    IFEQ 'E'                                                           CSW213
     C           PMMODE    OREQ 'M'                                                           CSW213
     C           PMISOC    IFEQ *BLANKS                                                       CSW213
     C                     MOVELWTXTE1    SCTX1                                               CSW213
     C                     READ MEISOCL1               8782                                   CSW213
     C                     ELSE                                                               CSW213
     C           PMISOC    READEMEISOCL1               8782                                   CSW213
     C                     ENDIF                                                              CSW213
     C                     ENDIF                                                              CSW213
      *                                                                                       CSW213
     C                     ELSE                                                               CSW213
     C                     MOVE '0'       *IN82                                               CSW213
     C                     ENDIF                                                              CSW213
     C                     EXSR SLDSFB                                                        CSW213
      *================================================================                       CSW213
     CSR         EXZSFB    ENDSR                                                              CSW213
      /EJECT                                                                                  CSW213
     CSR         SLDSFB    BEGSR                                                              CSW213
      *================================================================                       CSW213
      ** Alternate SRLDSF routine                                                             CSW213
      *================================================================                       CSW213
      ** Load subfile page                                                                    CSW213
      *================================================================                       CSW213
     C                     MOVE '0'       *IN84                                               CSW213
      *                                                                                       CSW213
      ** Re-establish fields in read-ahead record                                             CSW213
      *                                                                                       CSW213
     C           *IN27     IFEQ '1'                                                           CSW213
     C           WMODE     ANDNE'ADD'                                                         CSW213
      *                                                                                       CSW213
     C           PMMODE    IFEQ 'E'                                                           CSW213
     C           PMISOC    OREQ *BLANKS                                                       CSW213
     C  N82                READ MEISOCL1                 90                                   CSW213
     C  N82                READPMEISOCL1                 90                                   CSW213
     C                     ELSE                                                               CSW213
     C  N82      PMISOC    REDPEMEISOCL1                 90                                   CSW213
     C  N82                READEMEISOCL1                 90                                   CSW213
     C                     ENDIF                                                              CSW213
     C                     ENDIF                                                              CSW213
      *                                                                                       CSW213
      ** Start at previous highest record in SFL                                              CSW213
      *                                                                                       CSW213
     C                     Z-ADDWRRN      SRRNB   50                                          CSW213
     C                     Z-ADD0         WCTR    50                                          CSW213
     C                     Z-ADD0         WCTR2   50                                          CSW213
      *                                                                                       CSW213
      ** Set required pages based on *Set Cursor or *Subfile Pages                            CSW213
      *                                                                                       CSW213
     C           W0RR0     IFGT 0                                                             CSW213
     C           W0RR0     DIV  WSFPG     WSPG    30                                          CSW213
     C                     MVR            WSLIN   30                                          CSW213
     C           WSLIN     IFGT 0                                                             CSW213
     C                     ADD  1         WSPG                                                CSW213
     C                     ENDIF                                                              CSW213
     C           W0SPG     IFGT WSPG                                                          CSW213
     C                     Z-ADDW0SPG     WSPG                                                CSW213
     C                     ENDIF                                                              CSW213
     C                     ELSE                                                               CSW213
     C                     Z-ADDW0SPG     WSPG                                                CSW213
     C                     ENDIF                                                              CSW213
      *                                                                                       CSW213
      ** Compute lines required based on pages                                                CSW213
      *                                                                                       CSW213
     C           WSPG      MULT WSFPG     WSFLN                                               CSW213
     C           WSFLN     IFGT 999                                                           CSW213
     C                     Z-ADD999       WSFLN                                               CSW213
     C                     ENDIF                                                              CSW213
      *                                                                                       CSW213
      ** Load next SFL page until SFL page full, or                                           CSW213
      ** Scan limit reached                                                                   CSW213
      *                                                                                       CSW213
     C           *IN82     DOWEQ'0'                                                           CSW213
     C           WCTR      ANDLTWSFLN                                                         CSW213
     C           WCTR2     ANDLTW0SLM                                                         CSW213
      *                                                                                       CSW213
      ** Setof record error indicators                                                        CSW213
      *                                                                                       CSW213
     C                     MOVE *ALL'0'   WKIND0  4                                           CSW213
     C                     MOVEAWKIND0    *IN,31                                              CSW213
     C                     MOVE '0'       *IN36                                               CSW213
     C                     MOVE '0'       *IN38                                               CSW213
     C                     MOVE '0'       *IN20                                               CSW213
     C                     MOVE '0'       *IN21                                               CSW213
     C                     MOVE '0'       *IN40                                               CSW213
     C                     MOVE '0'       *IN41                                               CSW213
     C                     MOVE '0'       *IN42                                               CSW213
     C                     MOVE '0'       *IN50                                               CSW213
     C                     MOVE '0'       *IN51                                               CSW213
      *                                                                                       CSW213
     C           PMMODE    IFEQ 'E'                                                           CSW213
     C                     MOVE '1'       *IN20                                               CSW213
     C                     MOVE '1'       *IN40                                               CSW213
     C                     MOVE '1'       *IN76                                             MD023086
      *                                                                                       CSW213
     C                     ELSE                                                               CSW213
     C           WMODE     IFEQ 'ADD'                                                         CSW213
     C                     MOVE '1'       *IN50                                               CSW213
     C                     ENDIF                                                              CSW213
     C           WMODE     IFEQ 'LST'                                                         CSW213
     C                     MOVE '1'       *IN21                                               CSW213
     C                     ENDIF                                                              CSW213
     C                     ENDIF                                                              CSW213
      *                                                                                       CSW213
     C                     EXSR SISFFB                                                        CSW213
      *                                                                                       CSW213
     C           WMODE     IFNE 'ADD'                                                         CSW213
      *                                                                                       CSW213
      ** Load SFL fields                                                                      CSW213
      *                                                                                       CSW213
     C                     EXSR SLSFFB                                                        CSW213
     C                     MOVELWDBRC     SDBRC                                               CSW213
     C                     ENDIF                                                              CSW213
      *                                                                                       CSW213
      ** Output to subfile                                                                    CSW213
      *                                                                                       CSW213
     C                     ADD  1         SRRNB                                               CSW213
     C                     ADD  1         WCTR       81                                       CSW213
      *                                                                                       CSW213
     C                     WRITERSFLRCDB                                                      CSW213
      *                                                                                       CSW213
      ** Increment scan check count                                                           CSW213
      *                                                                                       CSW213
     C                     ADD  1         WCTR2                                               CSW213
     C           WMODE     IFNE 'ADD'                                                         CSW213
      *                                                                                       CSW213
     C           PMMODE    IFEQ 'E'                                                           CSW213
     C           PMISOC    OREQ *BLANKS                                                       CSW213
     C                     READ MEISOCL1                 82                                   CSW213
     C                     ELSE                                                               CSW213
     C           PMISOC    READEMEISOCL1                 82                                   CSW213
     C                     ENDIF                                                              CSW213
      *                                                                                       CSW213
     C                     ENDIF                                                              CSW213
     C                     ENDDO                                                              CSW213
      *                                                                                       CSW213
      ** Save highest SFL record load can continue at end point                               CSW213
      *                                                                                       CSW213
     C           SRRNB     IFGT WRRN                                                          CSW213
      *                                                                                       CSW213
      ** Calculate top line                                                                   CSW213
      *                                                                                       CSW213
     C           WCTR      DIV  WSFPG     WSPG                                                CSW213
     C                     MVR            WSLIN                                               CSW213
     C           WSLIN     IFGT 0                                                             CSW213
     C           SRRNB     SUB  WSLIN     SSFRC                                               CSW213
     C                     ELSE                                                               CSW213
     C           SRRNB     SUB  WSFPG     SSFRC                                               CSW213
     C                     ENDIF                                                              CSW213
     C                     ADD  1         SSFRC                                               CSW213
     C                     Z-ADDSRRNB     WRRN                                                CSW213
     C                     ENDIF                                                              CSW213
      *                                                                                       CSW213
      ** If scan limit reached, display error message                                         CSW213
      *                                                                                       CSW213
     C           WCTR2     IFGE W0SLM                                                         CSW213
      *                                                                                       CSW213
      ** Send message 'Scan limit reached'                                                    CSW213
      *                                                                                       CSW213
     C                     MOVEL'ME00010' ZAMSID                                              CSW213
     C                     MOVEL'MEMSG'   ZAMSGF                                              CSW213
     C                     EXSR ZASNMS                                                        CSW213
     C                     ELSE                                                               CSW213
     C                     Z-ADD0         WCTR                                                CSW213
     C                     ENDIF                                                              CSW213
      *================================================================                       CSW213
     CSR         EXDSFB    ENDSR                                                              CSW213
      /EJECT                                                                                  CSW213
      *================================================================                       CSW213
     CSR         SDSPSB    BEGSR                                                              CSW213
      *================================================================                       CSW213
      ** Alternate SRDSPS routine                                                             CSW213
      *================================================================                       CSW213
      ** Display screen                                                                       CSW213
      *================================================================                       CSW213
     C           *IN82     IFEQ '1'                                                           CSW213
     C           WRRN      ANDEQ0                                                             CSW213
      *                                                                                       CSW213
      ** Send message '*No data to display'                                                   CSW213
      *                                                                                       CSW213
     C                     MOVEL'ME00001' ZAMSID                                              CSW213
     C                     MOVEL'MEMSG'   ZAMSGF                                              CSW213
     C                     EXSR ZASNMS                                                        CSW213
     C                     ENDIF                                                              CSW213
     C                     WRITERMSGCTL                                                       CSW213
      *                                                                                       CSW213
     C           PMMODE    IFEQ 'M'                                                           CSW213
     C           WMODE     IFEQ 'LST'                                                         CSW213
     C                     MOVELWTXTC     SCTX1                                               CSW213
     C                     ENDIF                                                              CSW213
     C                     ENDIF                                                              CSW213
      *                                                                                       CSW213
     C           PMMODE    IFEQ 'E'                                                         MD022749
     C                     MOVELWTXTE1    SCTX1                                             MD022749
     C                     ENDIF                                                            MD022749
      *                                                                                     MD022749
     C                     WRITERCMDTXT1                                                      CSW213
      *                                                                                       CSW213
      ** Update screen time                                                                   CSW213
      *                                                                                       CSW213
     C                     TIME           STIME                                               CSW213
      *                                                                                       CSW213
     C                     EXFMTRSFLCTLB                                                      CSW213
      *                                                                                       CSW213
      ** Maintain subfile position where possible                                             CSW213
      *                                                                                       CSW213
     C           @#SFRC    IFGT *ZERO                                                         CSW213
     C                     Z-ADD@#SFRC    SSFRC                                               CSW213
     C                     ENDIF                                                              CSW213
      *                                                                                       CSW213
     C                     EXSR SRCLR                                                         CSW213
      *================================================================                       CSW213
     CSR         EXSPSB    ENDSR                                                              CSW213
      /EJECT                                                                                  CSW213
     CSR         SPROCB    BEGSR                                                              CSW213
      *================================================================                       CSW213
      ** Alternate SRPROC routine                                                             CSW213
      *================================================================                       CSW213
     C           WMODE     IFNE 'ADD'                                                         CSW213
     C           WZISOC    ANDNESEISOC                                                        CSW213
     C                     EXSR SRRQRL                                                        CSW213
     C           W0RSF     CABEQ'Y'       EXROCB                                              CSW213
     C                     ENDIF                                                              CSW213
      *                                                                                       CSW213
     C           PMMODE    IFEQ 'E'                                                           CSW213
     C********** PMISOC    IFNE *BLANKS                                              CSW213 MD022749
     C           PMISOC    ANDNE*BLANKS                                                     MD022749
     C                     MOVEL'E'       SCSEL                                               CSW213
     C                     MOVELPMISOC    SISOC                                               CSW213
     C                     EXSR SPROCR                                                        CSW213
     C**********           ENDIF                                                     CSW213 MD022749
     C                     EXSR SRRQRL                                                        CSW213
     C           W0RSF     CABEQ'Y'       EXROCB                                              CSW213
     C                     ENDIF                                                              CSW213
      *                                                                                       CSW213
     C                     READCRSFLRCDB                 92                                   CSW213
      *                                                                                       CSW213
     C           SCSEL     IFEQ ' '                                                           CSW213
     C           *IN09     ANDEQ*ON                                                           CSW213
     C                     MOVE *OFF      *IN12                                               CSW213
     C                     MOVE *OFF      *IN20                                               CSW213
     C                     MOVE *ON       *IN30                                               CSW213
     C                     EXSR SPROCC                                                        CSW213
     C                     ELSE                                                               CSW213
      *                                                                                       CSW213
     C                     MOVE *OFF      *IN30                                               CSW213
     C           *IN92     DOWEQ'0'                                                           CSW213
      *                                                                                       CSW213
     C                     MOVE *BLANKS   WERR                                                CSW213
      *                                                                                       CSW213
      ** Update screen time                                                                   CSW213
      *                                                                                       CSW213
     C                     TIME           STIME                                               CSW213
      *                                                                                       CSW213
      ** Process subfile record and validate options                                          CSW213
      *                                                                                       CSW213
     C           SCSEL     IFNE ' '                                                           CSW213
     C           SCSEL     ANDNE'E'                                                           CSW213
     C           SCSEL     ANDNE'A'                                                           CSW213
     C           SCSEL     ANDNE'D'                                                           CSW213
     C           WERR      ANDEQ*BLANK                                                        CSW213
     C           PMMODE    OREQ 'E'                                                         MD022749
     C           SCSEL     ANDNE' '                                                         MD022749
     C           SCSEL     ANDNE'E'                                                         MD022749
     C                     MOVE *ON       *IN34                                               CSW213
     C                     MOVE 'Y'       WERR                                                CSW213
     C                     Z-ADDSRRNB     SSFRC                                               CSW213
     C                     MOVEL'ME00002' ZAMSID                                              CSW213
     C                     MOVEL'MEMSG'   ZAMSGF                                              CSW213
     C                     EXSR ZASNMS                                                        CSW213
     C                     ELSE                                                               CSW213
     C                     MOVE *OFF      *IN34                                               CSW213
     C                     EXSR SRCLR                                                       MD022749
     C                     ENDIF                                                              CSW213
      *                                                                                       CSW213
     C           PMMODE    IFEQ 'M'                                                         MD022749
     C                     MOVE *BLANKS   SCTX1                                               CSW213
     C                     MOVELWTXTC     SCTX1                                               CSW213
     C                     ENDIF                                                            MD022749
      *                                                                                       CSW213
     C                     SELEC                                                              CSW213
     C           SCSEL     WHEQ 'E'                                                           CSW213
     C                     MOVE *ON       *IN20                                               CSW213
     C                     MOVELWTXTE     SCTX1                                               CSW213
     C                     EXSR SPROCR                                                        CSW213
     C           SCSEL     WHEQ 'A'                                                           CSW213
     C           PMMODE    ANDEQ'M'                                                         MD022749
     C                     MOVE *OFF      *IN20                                               CSW213
     C                     MOVE *ON       *IN28                                               CSW213
     C                     MOVELWTXTU     SCTX1                                               CSW213
     C                     EXSR SPROCU                                                        CSW213
     C           SCSEL     WHEQ 'D'                                                           CSW213
     C           PMMODE    ANDEQ'M'                                                         MD022749
     C                     EXSR SPROCD                                                        CSW213
     C                     ENDSL                                                              CSW213
      *                                                                                       CSW213
     C           WERR      IFEQ *BLANK                                                        CSW213
     C                     MOVE *BLANKS   SCSEL                                               CSW213
     C                     ENDIF                                                              CSW213
     C                     UPDATRSFLRCDB                                                      CSW213
     C           WERR      IFNE *BLANK                                                        CSW213
     C                     WRITERMSGCTL                                                       CSW213
     C                     WRITERCMDTXT1                                                      CSW213
     C                     EXSR SRCLR                                                         CSW213
     C                     ENDIF                                                              CSW213
      *                                                                                       CSW213
     C                     READCRSFLRCDB                 92                                   CSW213
      *                                                                                       CSW213
     C           *IN03     IFEQ *ON                                                           CSW213
     C                     MOVE *ON       *IN92                                               CSW213
     C                     ENDIF                                                              CSW213
      *                                                                                       CSW213
     C                     ENDDO                                                              CSW213
     C                     ENDIF                                                              CSW213
      *================================================================                       CSW213
     CSR         EXROCB    ENDSR                                                              CSW213
      /EJECT                                                                                  CSW213
     CSR         SPROCC    BEGSR                                                              CSW213
      *================================================================                       CSW213
      ** Add new ISO country code                                                             CSW213
      *================================================================                       CSW213
     C                     MOVE 'N'       WRUN    1                                         MD022957
     C                     EXSR SPCLDF                                                        CSW213
     C                     MOVELWTXTU     SCTX1                                               CSW213
     C                     MOVE 'N'       WSVAL   1                                           CSW213
     C                     Z-ADD0         WWARN   20                                          CSW213
      *                                                                                       CSW213
     C           WSVAL     DOWEQ'N'                                                           CSW213
     C           *IN12     ANDEQ*OFF                                                          CSW213
      *                                                                                       CSW213
      ** Refresh page                                                                         CSW213
      *                                                                                       CSW213
     C                     MOVE *OFF      *IN22                                             MD022005
     C           WREFR     IFEQ 'N'                                                         MD022005
     C           WERROR    ANDNE'Y'                                                         MD022005
     C                     MOVE *ON       *IN22                                             MD022005
     C                     ENDIF                                                            MD022005
      *                                                                                     MD022005
     C                     EXSR SDSPD1                                                        CSW213
     C           WSVAL     IFEQ 'N'                                                           CSW213
     C           *IN12     ANDEQ*OFF                                                          CSW213
     C                     MOVE 'N'       WSVAL                                               CSW213
     C                     MOVE 'N'       SPREL                                               CSW213
      *                                                                                     MD023517
      ** Clear IBAN Structure fields when IBAN country code is changed                      MD023517
      ** to blanks or from being a non-reference (ISO country code <>                       MD023517
      ** IBAN country code) to a reference record (ISO country code =                       MD023517
      ** IBAN country code).                                                                MD023517
      *                                                                                     MD023517
     C           W3IBAC    IFNE SIBAC                                                       MD023517
     C           SIBAC     IFEQ *BLANKS                                                     MD023517
     C           SIBAC     OREQ SISOC                                                       MD023517
     C                     EXSR CLIBAN                                                      MD023517
     C                     ENDIF                                                            MD023517
     C                     ENDIF                                                            MD023517
      *                                                                                     MD023517
     C                     EXSR VALADF                                                        CSW213
     C                     MOVE SIBAC     W3IBAC  2                                         MD023517
     C           WRUN      IFEQ 'N'                                                         MD022957
     C                     MOVE 'Y'       WRUN                                              MD022957
     C                     ENDIF                                                            MD022957
     C                     ENDIF                                                              CSW213
     C                     ENDDO                                                              CSW213
      *                                                                                       CSW213
     C           WSVAL     IFEQ 'Y'                                                           CSW213
     C           SIBAC     IFEQ SISOC                                                         CSW213
     C           SIBAC     ORNE SISOC                                                         CSW213
     C           SIBAC     ANDEQ*BLANKS                                                       CSW213
     C                     EXSR SPOPPD                                                        CSW213
     C                     ENDIF                                                              CSW213
     C                     EXSR SRADD                                                         CSW213
     C                     COMIT                                                              CSW213
     C                     EXSR SRSYNC                                                        CSW213
     C                     COMIT                                                              CSW213
     C                     EXSR SRRQRL                                                        CSW213
     C                     ELSE                                                               CSW213
     C                     ROLBK                                                              CSW213
     C                     ENDIF                                                              CSW213
      *                                                                                       CSW213
     C                     MOVE *OFF      *IN12                                               CSW213
     C                     MOVE *OFF      *IN03                                               CSW213
     C                     MOVE *OFF      *IN30                                               CSW213
     C                     EXSR SRCLR                                                         CSW213
      *================================================================                       CSW213
     CSR         EXROCC    ENDSR                                                              CSW213
      /EJECT                                                                                  CSW213
     CSR         SPROCR    BEGSR                                                              CSW213
      *================================================================                       CSW213
      ** Retrieve existing ISO country code record                                            CSW213
      *================================================================                       CSW213
     C                     MOVE 'N'       SPREL   1                                           CSW213
     C                     MOVELSISOC     WFLDC   2                                           CSW213
     C                     EXSR SPCLDF                                                        CSW213
     C                     MOVE *OFF      *IN60                                               CSW213
     C           WFLDC     CHAINMEISOCL1             60                                       CSW213
     C           *IN60     IFEQ *ON                                                           CSW213
     C                     MOVEL'ME00008' ZAMSID                                              CSW213
     C                     MOVEL'MEMSG'   ZAMSGF                                              CSW213
     C                     EXSR ZASNMS                                                        CSW213
     C                     MOVE 'Y'       WERROR                                              CSW213
     C                     GOTO EXROCR                                                        CSW213
     C                     ELSE                                                               CSW213
     C                     EXSR SRRCTY                                                        CSW213
     C                     EXSR SPOPDF                                                        CSW213
     C                     WRITERCMDTXT1                                                      CSW213
     C           SIBAC     IFNE *BLANKS                                                       CSW213
     C                     MOVE *ON       *IN72                                               CSW213
     C                     ENDIF                                                              CSW213
     C                     ENDIF                                                              CSW213
      *                                                                                       CSW213
     C           SCSEL     IFEQ 'E'                                                           CSW213
     C                     EXFMTME1740D1                                                      CSW213
     C           *IN03     IFEQ *ON                                                           CSW213
     C                     EXSR SREXIT                                                        CSW213
     C                     ENDIF                                                              CSW213
     C                     ENDIF                                                              CSW213
      *================================================================                       CSW213
     CSR         EXROCR    ENDSR                                                              CSW213
      /EJECT                                                                                  CSW213
     CSR         SPROCU    BEGSR                                                              CSW213
      *================================================================                       CSW213
      ** Amend existing ISO country code record                                               CSW213
      *================================================================                       CSW213
     C                     MOVE *OFF      *IN22                                             MD022005
     C                     MOVE SISOC     WISOC                                               CSW213
     C                     EXSR SPCLDF                                                        CSW213
     C                     MOVE WISOC     SISOC                                               CSW213
     C                     EXSR SPROCR                                                        CSW213
     C********** M3ISOC    IFEQ M3IBAC                                               CSW213 MD022005
     C           M3ISOC    IFEQ SIBAC                                                CSW213 MD022005
     C                     MOVE 'Y'       WREFR   1                                           CSW213
     C                     ELSE                                                               CSW213
     C                     MOVE 'N'       WREFR                                               CSW213
     C                     MOVE *ON       *IN22                                             MD022005
     C                     ENDIF                                                              CSW213
     C                     MOVE 'N'       WSVAL   1                                           CSW213
     C                     Z-ADD0         WWARN   20                                          CSW213
      *                                                                                       CSW213
      ** Validation                                                                           CSW213
      *                                                                                       CSW213
     C           WSVAL     DOWEQ'N'                                                           CSW213
     C           *IN12     ANDEQ*OFF                                                          CSW213
     C                     EXSR SDSPD1                                                        CSW213
     C           WSVAL     IFEQ 'N'                                                           CSW213
     C           *IN12     ANDEQ*OFF                                                          CSW213
     C                     MOVE 'N'       WSVAL                                               CSW213
      *                                                                                     MD023517
      ** Clear IBAN Structure fields when IBAN country code is changed                      MD023517
      ** to blanks or from being a non-reference (ISO country code <>                       MD023517
      ** IBAN country code) to a reference record (ISO country code =                       MD023517
      ** IBAN country code).                                                                MD023517
      *                                                                                     MD023517
     C           M3IBAC    IFNE *BLANKS                                                     MD023517
     C           M3IBAC    ANDNESIBAC                                                       MD023517
     C           SIBAC     IFEQ *BLANKS                                                     MD023517
     C           SIBAC     OREQ SISOC                                                       MD023517
     C           WRUN      ANDNE'Y'                                                         MD023517
     C                     EXSR CLIBAN                                                      MD023517
     C                     MOVE 'Y'       WRUN                                              MD023517
     C                     ENDIF                                                            MD023517
     C                     ENDIF                                                            MD023517
      *                                                                                     MD023517
     C                     EXSR VALADF                                                        CSW213
     C                     ENDIF                                                              CSW213
      *                                                                                       CSW213
     C           WSVAL     IFEQ 'Y'                                                           CSW213
     C           *IN12     ANDEQ*OFF                                                          CSW213
     C                     EXSR SRAMDB                                                        CSW213
     C           WERROR    IFNE 'Y'                                                           CSW213
     C                     COMIT                                                              CSW213
     C                     EXSR SRSYNC                                                        CSW213
     C                     COMIT                                                              CSW213
     C                     EXSR SRRQRL                                                        CSW213
     C                     ELSE                                                               CSW213
     C                     MOVE 'N'       WSVAL                                               CSW213
     C                     ROLBK                                                              CSW213
     C                     ENDIF                                                              CSW213
     C                     ELSE                                                               CSW213
     C                     ROLBK                                                              CSW213
     C                     ENDIF                                                              CSW213
      *                                                                                       CSW213
     C                     ENDDO                                                              CSW213
      *                                                                                       CSW213
     C                     MOVE *OFF      *IN12                                               CSW213
     C                     MOVE *OFF      *IN28                                               CSW213
     C                     EXSR SRCLR                                                         CSW213
      *================================================================                       CSW213
     CSR         EXROCU    ENDSR                                                              CSW213
      /EJECT                                                                                  CSW213
     CSR         SRAMDB    BEGSR                                                              CSW213
      *================================================================                       CSW213
      ** Alternate SRAMD routine                                                              CSW213
      *================================================================                       CSW213
     C           SISOC     CHAINMEISOCL0             60                                       CSW213
     C           *IN60     IFEQ '1'                                                           CSW213
     C                     MOVEL'ME00008' ZAMSID                                              CSW213
     C                     MOVEL'MEMSG'   ZAMSGF                                              CSW213
     C                     EXSR ZASNMS                                                        CSW213
     C                     MOVE 'Y'       WERROR                                              CSW213
     C                     GOTO EXAMDB                                                        CSW213
     C                     ENDIF                                                              CSW213
      *                                                                                       CSW213
     C           WDBRC     IFNE SDBRC                                                         CSW213
     C                     MOVEL'ME00009' ZAMSID                                              CSW213
     C                     MOVEL'MEMSG'   ZAMSGF                                              CSW213
     C                     EXSR ZASNMS                                                        CSW213
     C                     MOVE 'Y'       WERROR                                              CSW213
     C                     EXSR SRLSFF                                                        CSW213
     C                     MOVELWDBRC     SDBRC                                               CSW213
     C                     GOTO EXAMDB                                                        CSW213
     C                     ENDIF                                                              CSW213
      *                                                                                       CSW213
     C                     MOVE SISOD     M3ISOD                                              CSW213
     C                     MOVE SSCHT     M3SCHT                                              CSW213
     C                     MOVE SSEEA     M3EEAM                                              CSW213
     C                     MOVE SFATF     M3FATF                                              CSW213
     C                     MOVE SMFID     M3MFID                                              CSW213
     C           CSW209    IFEQ 'Y'                                                           CSW213
     C                     MOVE SM205     M3M205                                              CSW213
     C                     ENDIF                                                              CSW213
     C                     MOVE ##JOB     M3ACJN                                              CSW213
     C                     MOVE ##USR     M3ACUN                                              CSW213
     C                     MOVE STIME     M3ACTM                                              CSW213
     C                     MOVE BJMRDT    M3ACDA                                              CSW213
     C                     MOVE 'A'       M3ACTY                                              CSW213
     C                     EXSR SPOPPD                                                        CSW213
      *                                                                                       CSW213
     C                     UPDAT@ISOCL0                91                                     CSW213
      *                                                                                       CSW213
      ** Display error msg if file update not successful                                      CSW213
      *                                                                                       CSW213
     C           *IN91     IFEQ '1'                                                           CSW213
     C                     MOVEL'ME00011' ZAMSID                                              CSW213
     C                     MOVEL'MEMSG'   ZAMSGF                                              CSW213
     C                     EXSR ZASNMS                                                        CSW213
     C                     MOVE 'Y'       WERROR                                              CSW213
     C                     ELSE                                                               CSW213
     C                     MOVELWDBRC     SDBRC                                               CSW213
     C                     ENDIF                                                              CSW213
      *================================================================                       CSW213
     CSR         EXAMDB    ENDSR                                                              CSW213
      /EJECT                                                                                  CSW213
     CSR         SPROCD    BEGSR                                                              CSW213
      *================================================================                       CSW213
      ** Delete existing ISO country code record                                              CSW213
      *================================================================                       CSW213
     C                     MOVE *ON       *IN73                                               CSW213
     C                     MOVE *ON       *IN20                                               CSW213
     C                     MOVE *ON       *IN26                                               CSW213
     C                     MOVE *OFF      *IN12                                             MD023471
     C                     MOVELWTXTD     SCTX1                                               CSW213
     C                     EXSR SPROCR                                                        CSW213
      *                                                                                       CSW213
      ** Check for attached records if reference                                              CSW213
      *                                                                                       CSW213
     C           SISOC     IFEQ SIBAC                                                         CSW213
      *                                                                                       CSW213
     C                     MOVE SIBAC     WIBAC                                               CSW213
     C           *LOVAL    SETLLMEISOCL3                                                      CSW213
     C           KSYNC     SETLLMEISOCL3                                                      CSW213
     C           KSYNC     READEMEISOCL3                 60                                   CSW213
      *                                                                                       CSW213
     C           *IN60     DOWEQ*OFF                                                          CSW213
     C           *IN73     ANDEQ*ON                                                           CSW213
     C           M3ISOC    IFNE SISOC                                                         CSW213
     C                     MOVEL'ME21879' ZAMSID                                              CSW213
     C                     MOVEL'MEMSG'   ZAMSGF                                              CSW213
     C                     EXSR ZASNMS                                                        CSW213
     C                     MOVE *OFF      *IN73                                               CSW213
     C                     EXSR SIBSCE                                                        CSW213
     C                     WRITERMSGCTL                                                       CSW213
     C                     ENDIF                                                              CSW213
     C           KSYNC     READEMEISOCD0                 60                                   CSW213
     C                     ENDDO                                                              CSW213
      *                                                                                       CSW213
     C                     ENDIF                                                              CSW213
      *                                                                                       CSW213
     C           *IN10     DOWEQ*OFF                                                          CSW213
     C           *IN12     ANDEQ*OFF                                                          CSW213
     C                     EXFMTME1740D1                                                      CSW213
     C                     ENDDO                                                              CSW213
      *                                                                                       CSW213
     C           *IN10     IFEQ *ON                                                           CSW213
     C           *IN73     ANDEQ*ON                                                           CSW213
     C                     EXSR SRDEL                                                         CSW213
     C                     COMIT                                                              CSW213
     C                     EXSR SRRQRL                                                        CSW213
     C                     MOVE *OFF      *IN10                                             MD023471
     C                     ENDIF                                                              CSW213
      *                                                                                       CSW213
      *================================================================                       CSW213
     CSR         EXROCD    ENDSR                                                              CSW213
      /EJECT                                                                                  CSW213
     CSR         SDSPD1    BEGSR                                                              CSW213
      *================================================================                       CSW213
      ** Refresh ME1740D1                                                                     CSW213
      *================================================================                       CSW213
     C                     WRITERMSGCTL                                                       CSW213
     C                     WRITERCMDTXT1                                                      CSW213
     C                     EXFMTME1740D1                                                      CSW213
     C                     EXSR SRCLR                                                         CSW213
      *================================================================                       CSW213
     CSR         EXSPD1    ENDSR                                                              CSW213
      /EJECT                                                                                  CSW213
     C           CLIBAN    BEGSR                                                            MD023517
      *================================================================                     MD023517
      ** Clear IBAN Structure Information fields                                            MD023517
      *================================================================                     MD023517
     C                     MOVE *BLANKS   STILN                                             MD023517
     C                     MOVE *BLANKS   SBBSP                                             MD023517
     C                     MOVE *BLANKS   SBBLN                                             MD023517
     C                     MOVE *BLANKS   SCCSP                                             MD023517
     C                     MOVE *BLANKS   SCCLN                                             MD023517
     C                     MOVE *BLANKS   SICSP                                             MD023517
     C                     MOVE *BLANKS   SICLN                                             MD023517
     C                     MOVE *BLANKS   SBISP                                             MD023517
     C                     MOVE *BLANKS   SBILN                                             MD023517
     C                     MOVE *BLANKS   SBRSP                                             MD023517
     C                     MOVE *BLANKS   SBRLN                                             MD023517
     C                     MOVE *BLANKS   STBLN                                             MD023517
     C                     MOVE *BLANKS   SINLN                                             MD023517
     C                     MOVE *BLANKS   SACSP                                             MD023517
     C                     MOVE *BLANKS   SACLN                                             MD023517
     C                     MOVE *BLANKS   SOCDT                                             MD023517
     C                     MOVE *BLANKS   SMCDT                                             MD023517
      *================================================================                     MD023517
     C                     ENDSR                                                            MD023517
      /EJECT                                                                                MD023517
     CSR         SPOPPD    BEGSR                                                              CSW213
      *================================================================                       CSW213
      ** Moving to data to MEISOCL1                                                           CSW213
      *================================================================                       CSW213
      *                                                                                       CSW213
      ** Old field                                                                            CSW213
      *                                                                                       CSW213
     C                     MOVELSIBAC     M3IBAC                                              CSW213
      *                                                                                       CSW213
      ** New introduced                                                                       CSW213
      *                                                                                       CSW213
     C                     MOVELSSEPA     M3SEPA                                              CSW213
     C                     MOVELSIBAR     M3IBAR                                              CSW213
     C                     Z-ADDZTILN     M3TILN                                              CSW213
     C                     Z-ADDZBBSP     M3BBSP                                              CSW213
     C                     Z-ADDZBBLN     M3BBLN                                              CSW213
     C                     Z-ADDZCCSP     M3CCSP                                              CSW213
     C                     Z-ADDZCCLN     M3CCLN                                              CSW213
     C                     Z-ADDZICSP     M3ICSP                                              CSW213
     C                     Z-ADDZICLN     M3ICLN                                              CSW213
     C                     Z-ADDZBISP     M3BISP                                              CSW213
     C                     Z-ADDZBILN     M3BILN                                              CSW213
     C                     Z-ADDZBRSP     M3BRSP                                              CSW213
     C                     Z-ADDZBRLN     M3BRLN                                              CSW213
     C                     Z-ADDZTBLN     M3TBLN                                              CSW213
     C                     Z-ADDZINLN     M3INLN                                              CSW213
     C                     Z-ADDZACSP     M3ACSP                                              CSW213
     C                     Z-ADDZACLN     M3ACLN                                              CSW213
     C                     Z-ADDZOCDT     M3OCDT                                              CSW213
     C                     Z-ADDZMCDT     M3MCDT                                              CSW213
      *                                                                                       CSW213
      *================================================================                       CSW213
     CSR         EXOPPD    ENDSR                                                              CSW213
      /EJECT                                                                                  CSW213
     CSR         VALADF    BEGSR                                                              CSW213
      *================================================================                       CSW213
      ** Validate ME1740D1 screen as introduced in CSW213                                     CSW213
      *================================================================                       CSW213
     C           WWARN     IFGT 0                                                             CSW213
     C                     ADD  10        WWARN                                               CSW213
     C                     ENDIF                                                              CSW213
     C                     MOVE 'N'       WERROR                                              CSW213
     C                     EXSR SRSIND                                                        CSW213
      *                                                                                       CSW213
     C           *IN30     IFEQ *ON                                                           CSW213
     C           SISOC     IFEQ *BLANKS                                                       CSW213
     C                     MOVEL'ME00003' ZAMSID                                              CSW213
     C                     MOVEL'MEMSG'   ZAMSGF                                              CSW213
     C                     EXSR ZASNMS                                                        CSW213
     C                     MOVE 'Y'       WERROR                                              CSW213
     C                     MOVE *ON       *IN67                                               CSW213
      *                                                                                       CSW213
     C                     ELSE                                                               CSW213
     C                     MOVE *OFF      *IN70                                               CSW213
     C           ALPONL    CHECKSISOC                    70                                   CSW213
     C           *IN70     IFEQ *ON                                                           CSW213
     C                     MOVEL'ME00004' ZAMSID                                              CSW213
     C                     MOVEL'MEMSG'   ZAMSGF                                              CSW213
     C                     EXSR ZASNMS                                                        CSW213
     C                     MOVE 'Y'       WERROR                                              CSW213
     C                     MOVE *ON       *IN67                                               CSW213
     C                     ENDIF                                                              CSW213
     C                     ENDIF                                                              CSW213
      *                                                                                       CSW213
     C           SISOC     CHAINMEISOCL1             60                                       CSW213
     C           *IN60     IFEQ '0'                                                           CSW213
     C                     MOVEL'ME00007' ZAMSID                                              CSW213
     C                     MOVEL'MEMSG'   ZAMSGF                                              CSW213
     C                     EXSR ZASNMS                                                        CSW213
     C                     MOVE 'Y'       WERROR                                              CSW213
     C                     MOVE *ON       *IN67                                               CSW213
     C                     ENDIF                                                              CSW213
     C                     ENDIF                                                              CSW213
      *                                                                                       CSW213
     C                     MOVE SISOC     WFLDC                                               CSW213
     C                     EXSR SRRCTY                                                        CSW213
      *                                                                                       CSW213
      ** Check old fields                                                                     CSW213
      *                                                                                       CSW213
     C                     EXSR SRVREC                                                        CSW213
     C           WERROR    IFEQ 'Y'                                                           CSW213
     C                     MOVE 'N'       WSVAL                                               CSW213
     C                     ELSE                                                               CSW213
      *                                                                                       CSW213
      ** New fields introduced by CSW213                                                      CSW213
      *                                                                                       CSW213
      *                                                                                       CSW213
      ** SEPA                                                                                 CSW213
      *                                                                                       CSW213
     C           SSEPA     IFNE *BLANK                                                        CSW213
     C           SSEPA     ANDNE'Y'                                                           CSW213
     C           SSEPA     ANDNE'N'                                                           CSW213
     C                     MOVEL'ME21821' ZAMSID                                              CSW213
     C                     MOVEL'MEMSG'   ZAMSGF                                              CSW213
     C                     EXSR ZASNMS                                                        CSW213
     C                     MOVE 'Y'       WERROR                                              CSW213
     C                     MOVE *ON       *IN44                                               CSW213
     C                     ENDIF                                                              CSW213
      *                                                                                       CSW213
      ** IBAN Country Code                                                                    CSW213
      *                                                                                       CSW213
     C           CFT004    IFEQ 'Y'                                                           CSW213
     C                     EXSR SCHKBC                                                        CSW213
     C                     ENDIF                                                              CSW213
      *                                                                                       CSW213
      ** IBAN Required in MT103+/MT102+ and MT103+                                            CSW213
      *                                                                                       CSW213
     C           CFT004    IFEQ 'Y'                                                           CSW213
     C           CSW213    ANDEQ'Y'                                                         MD022942
     C           SIBAR     IFNE 'Y'                                                           CSW213
     C           SIBAR     ANDNE'N'                                                           CSW213
     C           SIBAC     ANDNE*BLANKS                                                     MD023517
     C                     MOVEL'ME21827' ZAMSID                                              CSW213
     C                     MOVEL'MEMSG'   ZAMSGF                                              CSW213
     C                     EXSR ZASNMS                                                        CSW213
     C                     MOVE 'Y'       WERROR                                              CSW213
     C                     MOVE *ON       *IN46                                               CSW213
     C                     ENDIF                                                              CSW213
      *                                                                                     MD023517
     C           SIBAR     IFNE *BLANKS                                                     MD023517
     C           SIBAC     ANDEQ*BLANKS                                                     MD023517
     C                     MOVEL'ME21828' ZAMSID                                            MD023517
     C                     MOVEL'MEMSG'   ZAMSGF                                            MD023517
     C                     EXSR ZASNMS                                                      MD023517
     C                     MOVE 'Y'       WERROR                                            MD023517
     C                     MOVE *ON       *IN46                                             MD023517
     C                     ENDIF                                                            MD023517
     C                     ENDIF                                                              CSW213
      *                                                                                       CSW213
      ** IBAN Structure Fields                                                                CSW213
      *                                                                                       CSW213
     C           SIBAC     IFNE *BLANK                                                      MD023517
     C           SIBAC     ANDEQSISOC                                                       MD023517
     C                     EXSR SRIBSC                                                        CSW213
     C                     ENDIF                                                            MD023517
      *                                                                                       CSW213
      ** Default non-reference values                                                         CSW213
      *                                                                                       CSW213
     C           WREFR     IFEQ 'N'                                                           CSW213
     C           WERROR    ANDEQ'N'                                                           CSW213
     C                     MOVE SIBAC     RFIBAC                                              CSW213
     C                     MOVE *BLANKS   NRISOC                                              CSW213
     C                     MOVE 'Y'       SPREL                                               CSW213
     C                     MOVE *ON       *IN22                                             MD022005
     C                     EXSR SRRIBS                                                        CSW213
     C                     EXSR SPOPDF                                                        CSW213
     C                     ENDIF                                                              CSW213
      *                                                                                       CSW213
      ** Error and screen handling                                                            CSW213
      *                                                                                       CSW213
     C           SCSEL     IFEQ 'A'                                                           CSW213
     C                     EXSR CHKCHG                                                        CSW213
     C           WCHG      IFEQ 'N'                                                           CSW213
     C                     ADD  9         WWARN                                               CSW213
     C                     ENDIF                                                              CSW213
     C                     ENDIF                                                              CSW213
      *                                                                                       CSW213
     C           WERROR    IFEQ 'Y'                                                           CSW213
     C                     Z-ADD0         WWARN                                               CSW213
     C                     ELSE                                                               CSW213
     C           WWARN     IFEQ 0                                                             CSW213
     C           WWARN     ORGE 10                                                            CSW213
     C                     MOVE 'Y'       WSVAL                                               CSW213
     C                     ENDIF                                                              CSW213
     C                     ENDIF                                                              CSW213
      *                                                                                       CSW213
     C                     ENDIF                                                              CSW213
      *================================================================                       CSW213
     CSR         EXLADF    ENDSR                                                              CSW213
      /EJECT                                                                                  CSW213
     CSR         SCHKBC    BEGSR                                                              CSW213
      *================================================================                       CSW213
      ** Validate SIBAC                                                                       CSW213
      *================================================================                       CSW213
     C                     MOVE 'N'       WIBNS                                               CSW213
     C                     MOVE 'N'       WREFR   1                                           CSW213
     C                     MOVE *OFF      *IN71                                               CSW213
      *                                                                                       CSW213
     C           SIBAC     IFEQ *BLANKS                                                       CSW213
     C           SIBAR     IFEQ 'Y'                                                           CSW213
     C           SBBLN     ORNE *BLANKS                                                       CSW213
     C                     MOVEL'ME21824' ZAMSID                                              CSW213
     C                     MOVEL'MEMSG'   ZAMSGF                                              CSW213
     C                     EXSR ZASNMS                                                        CSW213
     C                     MOVE 'Y'       WERROR                                              CSW213
     C                     MOVE *ON       *IN45                                               CSW213
     C                     GOTO EXHKBC                                                        CSW213
     C                     ELSE                                                               CSW213
     C                     ADD  9         WWARN                                               CSW213
     C                     ENDIF                                                              CSW213
     C                     ENDIF                                                              CSW213
      *                                                                                       CSW213
     C           SIBAC     IFNE *BLANKS                                                       CSW213
      *                                                                                       CSW213
     C                     MOVE *OFF      *IN70                                               CSW213
     C           ALPONL    CHECKSIBAC                    70                                   CSW213
     C           *IN70     IFEQ *ON                                                           CSW213
     C                     MOVEL'ME21822' ZAMSID                                              CSW213
     C                     MOVEL'MEMSG'   ZAMSGF                                              CSW213
     C                     EXSR ZASNMS                                                        CSW213
     C                     MOVE 'Y'       WERROR                                              CSW213
     C                     MOVE *ON       *IN45                                               CSW213
     C                     GOTO EXHKBC                                                        CSW213
     C                     ENDIF                                                              CSW213
      *                                                                                       CSW213
      ** Check whether reference or non-reference record                                      CSW213
      *                                                                                       CSW213
     C           SIBAC     IFEQ SISOC                                                         CSW213
     C                     MOVE 'Y'       WREFR                                               CSW213
     C                     MOVE 'N'       SPREL                                               CSW213
     C                     MOVE *ON       *IN71                                               CSW213
     C                     MOVE *OFF      *IN22                                             MD022005
     C                     ENDIF                                                              CSW213
      *                                                                                       CSW213
     C           WREFR     IFEQ 'N'                                                           CSW213
     C                     MOVE *OFF      *IN70                                               CSW213
     C           SIBAC     CHAINMEISOCL1             70                                       CSW213
     C           *IN70     IFEQ *ON                                                           CSW213
     C                     MOVEL'ME21823' ZAMSID                                              CSW213
     C                     MOVEL'MEMSG'   ZAMSGF                                              CSW213
     C                     EXSR ZASNMS                                                        CSW213
     C                     MOVE 'Y'       WERROR                                              CSW213
     C                     MOVE *ON       *IN45                                               CSW213
     C                     GOTO EXHKBC                                                        CSW213
     C                     ENDIF                                                              CSW213
      *                                                                                       CSW213
     C**********           MOVEL'ME21876' ZAMSID                                     CSW213 MD022005
     C**********           MOVEL'MEMSG'   ZAMSGF                                     CSW213 MD022005
     C**********           EXSR ZASNMS                                               CSW213 MD022005
      *                                                                                       CSW213
     C                     ENDIF                                                              CSW213
      *                                                                                       CSW213
     C           CFT050    IFEQ 'Y'                                                           CSW213
      *                                                                                       CSW213
     C                     MOVE *OFF      *IN70                                               CSW213
     C           SIBAC     CHAINMEBICCL1             70                                       CSW213
     C           *IN70     IFEQ *ON                                                           CSW213
     C                     MOVEL'ME21825' ZAMSID                                              CSW213
     C                     MOVEL'MEMSG'   ZAMSGF                                              CSW213
     C                     EXSR ZASNMS                                                        CSW213
     C                     ADD  1         WWARN                                               CSW213
     C                     ENDIF                                                              CSW213
      *                                                                                       CSW213
     C                     MOVE *OFF      *IN70                                               CSW213
     C           SIBAC     CHAINMEIBNSL0             70                                       CSW213
     C           *IN70     IFEQ *ON                                                           CSW213
     C                     MOVEL'ME21826' ZAMSID                                              CSW213
     C                     MOVEL'MEMSG'   ZAMSGF                                              CSW213
     C                     EXSR ZASNMS                                                        CSW213
     C                     ADD  1         WWARN                                               CSW213
     C                     ENDIF                                                              CSW213
      *                                                                                     MD022293
     C                     MOVE *OFF      *IN70                                             MD022293
     C           SISOC     CHAINMEBICCL1             70                                     MD022293
     C           *IN70     IFEQ *ON                                                         MD022293
     C                     MOVEL'ME21881' ZAMSID                                            MD022293
     C                     MOVEL'MEMSG'   ZAMSGF                                            MD022293
     C                     EXSR ZASNMS                                                      MD022293
     C                     ADD  1         WWARN                                             MD022293
     C                     ENDIF                                                            MD022293
      *                                                                                       CSW213
     C                     ENDIF                                                              CSW213
     C                     ENDIF                                                              CSW213
      *                                                                                       CSW213
     C           SIBAC     IFNE *BLANKS                                                       CSW213
     C                     MOVE *ON       *IN72                                               CSW213
     C                     ADD  1         WWARN                                               CSW213
     C                     ENDIF                                                              CSW213
      *                                                                                       CSW213
     C                     MOVE *OFF      *IN70                                               CSW213
     C                     MOVE 'Y'       WIBNS                                               CSW213
      *================================================================                       CSW213
     CSR         EXHKBC    ENDSR                                                              CSW213
      /EJECT                                                                                  CSW213
     CSR         SRIBSC    BEGSR                                                              CSW213
      *================================================================                       CSW213
      ** Check IBAN Structure fields for Reference Record Input                               CSW213
      *================================================================                       CSW213
      *                                                                                       CSW213
      ** BBAN Start Position                                                                  CSW213
      *                                                                                       CSW213
      *                                                                                       CSW213
      ***Defaulting****************************************************              CSW213 MD022957
      **********                                                                     CSW213 MD022957
     C********** SBBLN     IFNE *BLANK                                               CSW213 MD022957
     C********** SBBSP     ANDEQ*BLANK                                               CSW213 MD022957
     C**********           MOVE '5'       SBBSP                                      CSW213 MD022957
     C**********           ENDIF                                                     CSW213 MD022957
      **********                                                                     CSW213 MD022957
      **********                                                                     CSW213 MD022957
     C********** SBBSP     IFNE *BLANK                                               CSW213 MD022957
     C********** SBBSP     ANDNEWSBBSP                                               CSW213 MD022957
      **********                                                                     CSW213 MD022957
     C********** SISOC     IFNE SIBAC                                                CSW213 MD022957
     C**********           MOVEL'ME21874' ZAMSID                                     CSW213 MD022957
     C**********           MOVEL'MEMSG'   ZAMSGF                                     CSW213 MD022957
     C**********           EXSR ZASNMS                                               CSW213 MD022957
     C**********           MOVE *ON       *IN66                                      CSW213 MD022957
     C**********           EXSR SIBSCE                                               CSW213 MD022957
     C**********           ENDIF                                                     CSW213 MD022957
      *                                                                                       CSW213
     C                     MOVE *BLANKS   ZFIELD                                              CSW213
     C                     MOVE SBBSP     ZFIELD                                              CSW213
     C                     Z-ADD2         ZADIG                                               CSW213
     C                     Z-ADD0         ZADEC                                               CSW213
     C                     EXSR ZALIGN                                                        CSW213
     C           *IN99     IFEQ *ON                                                           CSW213
     C                     MOVEL'ME21873' ZAMSID                                              CSW213
     C                     MOVEL'MEMSG'   ZAMSGF                                              CSW213
     C                     EXSR ZASNMS                                                        CSW213
     C                     MOVE 'Y'       WERROR                                              CSW213
     C                     MOVE *ON       *IN66                                               CSW213
     C                     ELSE                                                               CSW213
     C                     MOVE ZFIELD    ZBBSP   20                                          CSW213
     C                     EXSR ZEDIT                                                       MD022957
     C           ZBBSP     IFEQ 0                                                           MD022957
     C                     MOVE *BLANKS   SBBSP                                             MD022957
     C                     ELSE                                                             MD022957
     C                     MOVE ZFIELD    SBBSP                                             MD022957
     C                     ENDIF                                                            MD022957
     C                     ENDIF                                                            MD022957
      *                                                                                     MD022957
     C           SBBSP     IFNE WSBBSP                                                      MD022957
     C           ZBBSP     IFNE 5                                                             CSW213
     C           ZBBSP     ANDNE0                                                           MD022957
     C                     MOVEL'ME21880' ZAMSID                                              CSW213
     C                     MOVEL'MEMSG'   ZAMSGF                                              CSW213
     C                     EXSR ZASNMS                                                        CSW213
     C                     MOVE 'Y'       WERROR                                              CSW213
     C                     MOVE *ON       *IN66                                               CSW213
     C                     ENDIF                                                              CSW213
     C**********           EXSR ZEDIT                                                CSW213 MD022957
     C**********           MOVE ZFIELD    SBBSP                                      CSW213 MD022957
     C**********           ENDIF                                                     CSW213 MD022957
      *                                                                                     MD022957
     C           SISOC     IFNE SIBAC                                                       MD022957
     C                     MOVEL'ME21874' ZAMSID                                            MD022957
     C                     MOVEL'MEMSG'   ZAMSGF                                            MD022957
     C                     EXSR ZASNMS                                                      MD022957
     C                     MOVE *ON       *IN66                                             MD022957
     C                     EXSR SIBSCE                                                      MD022957
     C                     ENDIF                                                            MD022957
      *                                                                                       CSW213
     C                     ENDIF                                                              CSW213
      *                                                                                       CSW213
      ** BBAN Length                                                                          CSW213
      *                                                                                       CSW213
     C********** SBBLN     IFEQ *BLANK                                               CSW213 MD022957
     C********** WREFR     ANDEQ'Y'                                                  CSW213 MD022957
     C********** WWARN     ANDGE10                                                   CSW213 MD022957
     C**********           MOVEL'ME21877' ZAMSID                                     CSW213 MD022957
     C**********           MOVEL'MEMSG'   ZAMSGF                                     CSW213 MD022957
     C**********           EXSR ZASNMS                                               CSW213 MD022957
     C**********           MOVE 'Y'       WERROR                                     CSW213 MD022957
     C**********           MOVE *ON       *IN55                                      CSW213 MD022957
     C**********           ENDIF                                                     CSW213 MD022957
      **********                                                                     CSW213 MD022957
     C********** SBBLN     IFNE *BLANK                                               CSW213 MD022957
     C********** SBBLN     ANDNEWSBBLN                                               CSW213 MD022957
      **********                                                                     CSW213 MD022957
     C********** SISOC     IFNE SIBAC                                                CSW213 MD022957
     C**********           MOVEL'ME21845' ZAMSID                                     CSW213 MD022957
     C**********           MOVEL'MEMSG'   ZAMSGF                                     CSW213 MD022957
     C**********           EXSR ZASNMS                                               CSW213 MD022957
     C**********           MOVE *ON       *IN55                                      CSW213 MD022957
     C**********           EXSR SIBSCE                                               CSW213 MD022957
     C**********           ENDIF                                                     CSW213 MD022957
      *                                                                                       CSW213
     C                     MOVE *BLANKS   ZFIELD                                              CSW213
     C                     MOVE SBBLN     ZFIELD                                              CSW213
     C                     Z-ADD2         ZADIG                                               CSW213
     C                     Z-ADD0         ZADEC                                               CSW213
     C                     EXSR ZALIGN                                                        CSW213
     C           *IN99     IFEQ *ON                                                           CSW213
     C                     MOVEL'USR3716' ZAMSID                                              CSW213
     C                     MOVEL'GB'      ZAMSGF                                              CSW213
     C                     MOVE 'SDUSRMSG'ZAMSGF                                              CSW213
     C                     EXSR ZASNMS                                                        CSW213
     C                     MOVE *BLANKS   ZAMSGF                                              CSW213
     C                     MOVE 'Y'       WERROR                                              CSW213
     C                     MOVE *ON       *IN55                                               CSW213
     C                     ELSE                                                               CSW213
     C                     MOVE ZFIELD    ZBBLN   20                                          CSW213
     C                     EXSR ZEDIT                                                         CSW213
     C           ZBBLN     IFEQ 0                                                           MD022957
     C                     MOVE *BLANKS   SBBLN                                             MD022957
     C                     ELSE                                                             MD022957
     C                     MOVE ZFIELD    SBBLN                                               CSW213
     C                     ENDIF                                                            MD022957
     C                     ENDIF                                                              CSW213
      *                                                                                       CSW213
     C           SBBLN     IFNE WSBBLN                                                      MD022957
     C           ZBBLN     IFLT 0                                                             CSW213
     C           ZBBLN     ORGT 30                                                            CSW213
     C                     MOVEL'USR3718' ZAMSID                                              CSW213
     C                     MOVEL'GB'      ZAMSGF                                              CSW213
     C                     MOVE 'SDUSRMSG'ZAMSGF                                              CSW213
     C                     EXSR ZASNMS                                                        CSW213
     C                     MOVE *BLANKS   ZAMSGF                                              CSW213
     C                     MOVE 'Y'       WERROR                                              CSW213
     C                     MOVE *ON       *IN55                                               CSW213
     C                     ENDIF                                                              CSW213
      *                                                                                       CSW213
     C           SISOC     IFNE SIBAC                                                       MD022957
     C                     MOVEL'ME21845' ZAMSID                                            MD022957
     C                     MOVEL'MEMSG'   ZAMSGF                                            MD022957
     C                     EXSR ZASNMS                                                      MD022957
     C                     MOVE *ON       *IN55                                             MD022957
     C                     EXSR SIBSCE                                                      MD022957
     C                     ENDIF                                                            MD022957
     C                     ENDIF                                                              CSW213
      **********                                                                     CSW213 MD022957
      ***Default*for*Total*IBAN*Length*on*input*of*BBAN*Length*********              CSW213 MD022957
      **********                                                                     CSW213 MD022957
     C********** ZBBLN     IFNE 0                                                    CSW213 MD022957
     C********** STILN     ANDEQ*BLANKS                                              CSW213 MD022957
     C********** WREFR     ANDEQ'Y'                                                  CSW213 MD022957
     C********** ZBBLN     ADD  4         ZTILN                                      CSW213 MD022957
     C**********           MOVE ZTILN     STILN                                      CSW213 MD022957
     C**********           ENDIF                                                     CSW213 MD022957
      *                                                                                       CSW213
      ** Total IBAN Length                                                                    CSW213
      *                                                                                       CSW213
     C********** STILN     IFNE *BLANK                                               CSW213 MD022957
     C********** STILN     ANDNEWSTILN                                               CSW213 MD022957
      **********                                                                     CSW213 MD022957
     C********** SISOC     IFNE SIBAC                                                CSW213 MD022957
     C**********           MOVEL'ME21871' ZAMSID                                     CSW213 MD022957
     C**********           MOVEL'MEMSG'   ZAMSGF                                     CSW213 MD022957
     C**********           EXSR ZASNMS                                               CSW213 MD022957
     C**********           MOVE *ON       *IN61                                      CSW213 MD022957
     C**********           EXSR SIBSCE                                               CSW213 MD022957
     C**********           ENDIF                                                     CSW213 MD022957
      *                                                                                       CSW213
     C                     MOVE *BLANKS   ZFIELD                                              CSW213
     C                     MOVE STILN     ZFIELD                                              CSW213
     C                     Z-ADD2         ZADIG                                               CSW213
     C                     Z-ADD0         ZADEC                                               CSW213
     C                     EXSR ZALIGN                                                        CSW213
     C           *IN99     IFEQ *ON                                                           CSW213
     C                     MOVEL'ME21870' ZAMSID                                              CSW213
     C                     MOVEL'MEMSG'   ZAMSGF                                              CSW213
     C                     EXSR ZASNMS                                                        CSW213
     C                     MOVE 'Y'       WERROR                                              CSW213
     C                     MOVE *ON       *IN61                                               CSW213
     C                     ELSE                                                               CSW213
     C                     MOVE ZFIELD    ZTILN   20                                          CSW213
     C                     EXSR ZEDIT                                                         CSW213
     C           ZTILN     IFEQ 0                                                           MD022957
     C                     MOVE *BLANKS   STILN                                             MD022957
     C                     ELSE                                                             MD022957
     C                     MOVE ZFIELD    STILN                                               CSW213
     C                     ENDIF                                                            MD022957
     C                     ENDIF                                                              CSW213
      *                                                                                       CSW213
     C           STILN     IFNE WSTILN                                                      MD022957
     C********** ZTILN     IFLT 0                                                    CSW213 MD022957
     C           ZTILN     IFLT 6                                                           MD022957
     C           ZTILN     ANDNE0                                                           MD022957
     C           ZTILN     ORGT 34                                                            CSW213
     C                     MOVEL'ME21872' ZAMSID                                              CSW213
     C                     MOVEL'MEMSG'   ZAMSGF                                              CSW213
     C                     EXSR ZASNMS                                                        CSW213
     C                     MOVE 'Y'       WERROR                                              CSW213
     C                     MOVE *ON       *IN61                                               CSW213
     C                     ENDIF                                                              CSW213
      *                                                                                       CSW213
     C           SISOC     IFNE SIBAC                                                       MD022957
     C                     MOVEL'ME21871' ZAMSID                                            MD022957
     C                     MOVEL'MEMSG'   ZAMSGF                                            MD022957
     C                     EXSR ZASNMS                                                      MD022957
     C                     MOVE *ON       *IN61                                             MD022957
     C                     EXSR SIBSCE                                                      MD022957
     C                     ENDIF                                                            MD022957
     C                     ENDIF                                                              CSW213
      **********                                                                     CSW213 MD022957
      ***BBAN*Length*and*Start*Position********************************              CSW213 MD022957
      **********                                                                     CSW213 MD022957
     C********** ZBBLN     IFNE 0                                                    CSW213 MD022957
     C********** ZBBSP     ANDNE0                                                    CSW213 MD022957
     C********** WREFR     ANDEQ'Y'                                                  CSW213 MD022957
      **********                                                                     CSW213 MD022957
     C********** ZTILN     ADD  1         TFCTR   30                                 CSW213 MD022957
     C********** TFCTR     SUB  ZBBSP     TFCTR                                      CSW213 MD022957
     C********** ZBBLN     IFNE TFCTR                                                CSW213 MD022957
     C**********           MOVEL'ME21860' ZAMSID                                     CSW213 MD022957
     C**********           MOVEL'MEMSG'   ZAMSGF                                     CSW213 MD022957
     C**********           EXSR ZASNMS                                               CSW213 MD022957
     C**********           MOVE 'Y'       WERROR                                     CSW213 MD022957
     C**********           MOVE *ON       *IN55                                      CSW213 MD022957
     C**********           ENDIF                                                     CSW213 MD022957
      **********                                                                     CSW213 MD022957
     C********** ZTILN     ADD  1         TFCTR   30                                 CSW213 MD022957
     C********** TFCTR     SUB  ZBBLN     TFCTR                                      CSW213 MD022957
     C********** ZBBSP     IFGT TFCTR                                                CSW213 MD022957
     C**********           MOVEL'ME21875' ZAMSID                                     CSW213 MD022957
     C**********           MOVEL'MEMSG'   ZAMSGF                                     CSW213 MD022957
     C**********           EXSR ZASNMS                                               CSW213 MD022957
     C**********           MOVE 'Y'       WERROR                                     CSW213 MD022957
     C**********           MOVE *ON       *IN66                                      CSW213 MD022957
     C**********           ENDIF                                                     CSW213 MD022957
      **********                                                                     CSW213 MD022957
     C**********           ENDIF                                                     CSW213 MD022957
      *                                                                                       CSW213
      ** Country Code Start Position                                                          CSW213
      *                                                                                       CSW213
     C********** SCCSP     IFEQ *BLANK                                               CSW213 MD022957
     C********** ZBBLN     ANDNE0                                                    CSW213 MD022957
     C********** WREFR     ANDEQ'Y'                                                  CSW213 MD022957
     C**********           MOVE '1'       SCCSP                                      CSW213 MD022957
     C**********           ENDIF                                                     CSW213 MD022957
      **********                                                                     CSW213 MD022957
     C********** SCCSP     IFNE *BLANK                                               CSW213 MD022957
     C********** SCCSP     ANDNEWSCCSP                                               CSW213 MD022957
      **********                                                                     CSW213 MD022957
     C********** SISOC     IFNE SIBAC                                                CSW213 MD022957
     C**********           MOVEL'ME21834' ZAMSID                                     CSW213 MD022957
     C**********           MOVEL'MEMSG'   ZAMSGF                                     CSW213 MD022957
     C**********           EXSR ZASNMS                                               CSW213 MD022957
     C**********           MOVE *ON       *IN49                                      CSW213 MD022957
     C**********           EXSR SIBSCE                                               CSW213 MD022957
     C**********           ENDIF                                                     CSW213 MD022957
     C                     MOVE *BLANKS   ZFIELD                                              CSW213
     C                     MOVE SCCSP     ZFIELD                                              CSW213
     C                     Z-ADD2         ZADIG                                               CSW213
     C                     Z-ADD0         ZADEC                                               CSW213
     C                     EXSR ZALIGN                                                        CSW213
     C           *IN99     IFEQ *ON                                                           CSW213
     C                     MOVEL'ME21833' ZAMSID                                              CSW213
     C                     MOVEL'MEMSG'   ZAMSGF                                              CSW213
     C                     EXSR ZASNMS                                                        CSW213
     C                     MOVE 'Y'       WERROR                                              CSW213
     C                     MOVE *ON       *IN49                                               CSW213
     C                     ELSE                                                               CSW213
     C                     MOVE ZFIELD    ZCCSP   20                                          CSW213
     C                     EXSR ZEDIT                                                         CSW213
     C           ZCCSP     IFEQ 0                                                           MD022957
     C                     MOVE *BLANKS   SCCSP                                             MD022957
     C                     ELSE                                                             MD022957
     C                     MOVE ZFIELD    SCCSP                                               CSW213
     C                     ENDIF                                                            MD022957
     C                     ENDIF                                                              CSW213
      *                                                                                     MD022957
     C           SCCSP     IFNE WSCCSP                                                      MD022957
     C           ZCCSP     IFNE 1                                                             CSW213
     C           ZCCSP     ANDNE0                                                           MD022957
     C                     MOVEL'ME21835' ZAMSID                                              CSW213
     C                     MOVEL'MEMSG'   ZAMSGF                                              CSW213
     C                     EXSR ZASNMS                                                        CSW213
     C                     MOVE 'Y'       WERROR                                              CSW213
     C                     MOVE *ON       *IN49                                               CSW213
     C                     ENDIF                                                              CSW213
      *                                                                                     MD022957
     C           SISOC     IFNE SIBAC                                                       MD022957
     C                     MOVEL'ME21834' ZAMSID                                            MD022957
     C                     MOVEL'MEMSG'   ZAMSGF                                            MD022957
     C                     EXSR ZASNMS                                                      MD022957
     C                     MOVE *ON       *IN49                                             MD022957
     C                     EXSR SIBSCE                                                      MD022957
     C                     ENDIF                                                            MD022957
     C                     ENDIF                                                              CSW213
      *                                                                                       CSW213
      ** Country Code Length                                                                  CSW213
      *                                                                                       CSW213
     C********** SCCLN     IFEQ *BLANK                                               CSW213 MD022957
     C********** ZBBLN     ANDNE0                                                    CSW213 MD022957
     C********** WREFR     ANDEQ'Y'                                                  CSW213 MD022957
     C**********           MOVE '2'       SCCLN                                      CSW213 MD022957
     C**********           ENDIF                                                     CSW213 MD022957
      **********                                                                     CSW213 MD022957
     C********** SCCLN     IFNE *BLANK                                               CSW213 MD022957
     C********** SCCLN     ANDNEWSCCLN                                               CSW213 MD022957
      **********                                                                     CSW213 MD022957
     C********** SISOC     IFNE SIBAC                                                CSW213 MD022957
     C**********           MOVEL'ME21837' ZAMSID                                     CSW213 MD022957
     C**********           MOVEL'MEMSG'   ZAMSGF                                     CSW213 MD022957
     C**********           EXSR ZASNMS                                               CSW213 MD022957
     C**********           MOVE *ON       *IN52                                      CSW213 MD022957
     C**********           EXSR SIBSCE                                               CSW213 MD022957
     C**********           ENDIF                                                     CSW213 MD022957
     C                     MOVE *BLANKS   ZFIELD                                              CSW213
     C                     MOVE SCCLN     ZFIELD                                              CSW213
     C                     Z-ADD1         ZADIG                                               CSW213
     C                     Z-ADD0         ZADEC                                               CSW213
     C                     EXSR ZALIGN                                                        CSW213
     C           *IN99     IFEQ *ON                                                           CSW213
     C                     MOVEL'ME21836' ZAMSID                                              CSW213
     C                     MOVEL'MEMSG'   ZAMSGF                                              CSW213
     C                     EXSR ZASNMS                                                        CSW213
     C                     MOVE 'Y'       WERROR                                              CSW213
     C                     MOVE *ON       *IN52                                               CSW213
     C                     ELSE                                                               CSW213
     C                     MOVE ZFIELD    ZCCLN   20                                          CSW213
     C                     EXSR ZEDIT                                                         CSW213
     C           ZCCLN     IFEQ 0                                                           MD022957
     C                     MOVE *BLANKS   SCCLN                                             MD022957
     C                     ELSE                                                             MD022957
     C                     MOVE ZFIELD    SCCLN                                               CSW213
     C                     ENDIF                                                            MD022957
     C                     ENDIF                                                              CSW213
      *                                                                                     MD022957
     C           SCCLN     IFNE WSCCLN                                                      MD022957
     C           ZCCLN     IFNE 2                                                             CSW213
     C           ZCCLN     ANDNE0                                                           MD022957
     C                     MOVEL'ME21838' ZAMSID                                              CSW213
     C                     MOVEL'MEMSG'   ZAMSGF                                              CSW213
     C                     EXSR ZASNMS                                                        CSW213
     C                     MOVE 'Y'       WERROR                                              CSW213
     C                     MOVE *ON       *IN52                                               CSW213
     C                     ENDIF                                                              CSW213
      *                                                                                     MD022957
     C           SISOC     IFNE SIBAC                                                       MD022957
     C                     MOVEL'ME21837' ZAMSID                                            MD022957
     C                     MOVEL'MEMSG'   ZAMSGF                                            MD022957
     C                     EXSR ZASNMS                                                      MD022957
     C                     MOVE *ON       *IN52                                             MD022957
     C                     EXSR SIBSCE                                                      MD022957
     C                     ENDIF                                                            MD022957
     C                     ENDIF                                                              CSW213
      *                                                                                       CSW213
      ** IBAN Check Digit Start Position                                                      CSW213
      *                                                                                       CSW213
     C********** SICSP     IFEQ *BLANK                                               CSW213 MD022957
     C********** ZBBLN     ANDNE0                                                    CSW213 MD022957
     C********** WREFR     ANDEQ'Y'                                                  CSW213 MD022957
     C**********           MOVE '3'       SICSP                                      CSW213 MD022957
     C**********           ENDIF                                                     CSW213 MD022957
      **********                                                                     CSW213 MD022957
     C********** SICSP     IFNE *BLANK                                               CSW213 MD022957
     C********** SICSP     ANDNEWSICSP                                               CSW213 MD022957
     C********** SISOC     IFNE SIBAC                                                CSW213 MD022957
     C**********           MOVEL'ME21840' ZAMSID                                     CSW213 MD022957
     C**********           MOVEL'MEMSG'   ZAMSGF                                     CSW213 MD022957
     C**********           EXSR ZASNMS                                               CSW213 MD022957
     C**********           MOVE *ON       *IN53                                      CSW213 MD022957
     C**********           EXSR SIBSCE                                               CSW213 MD022957
     C**********           ENDIF                                                     CSW213 MD022957
     C                     MOVE *BLANKS   ZFIELD                                              CSW213
     C                     MOVE SICSP     ZFIELD                                              CSW213
     C                     Z-ADD2         ZADIG                                               CSW213
     C                     Z-ADD0         ZADEC                                               CSW213
     C                     EXSR ZALIGN                                                        CSW213
     C           *IN99     IFEQ *ON                                                           CSW213
     C                     MOVEL'ME21839' ZAMSID                                              CSW213
     C                     MOVEL'MEMSG'   ZAMSGF                                              CSW213
     C                     EXSR ZASNMS                                                        CSW213
     C                     MOVE 'Y'       WERROR                                              CSW213
     C                     MOVE *ON       *IN53                                               CSW213
     C                     ELSE                                                               CSW213
     C                     MOVE ZFIELD    ZICSP   20                                          CSW213
     C                     EXSR ZEDIT                                                         CSW213
     C           ZICSP     IFEQ 0                                                           MD022957
     C                     MOVE *BLANKS   SICSP                                             MD022957
     C                     ELSE                                                             MD022957
     C                     MOVE ZFIELD    SICSP                                               CSW213
     C                     ENDIF                                                            MD022957
     C                     ENDIF                                                              CSW213
      *                                                                                     MD022957
     C           SICSP     IFNE WSICSP                                                      MD022957
     C           ZICSP     IFNE 3                                                             CSW213
     C           ZICSP     ANDNE0                                                           MD022957
     C                     MOVEL'ME21841' ZAMSID                                              CSW213
     C                     MOVEL'MEMSG'   ZAMSGF                                              CSW213
     C                     EXSR ZASNMS                                                        CSW213
     C                     MOVE 'Y'       WERROR                                              CSW213
     C                     MOVE *ON       *IN53                                               CSW213
     C                     ENDIF                                                              CSW213
      *                                                                                     MD022957
     C           SISOC     IFNE SIBAC                                                       MD022957
     C                     MOVEL'ME21840' ZAMSID                                            MD022957
     C                     MOVEL'MEMSG'   ZAMSGF                                            MD022957
     C                     EXSR ZASNMS                                                      MD022957
     C                     MOVE *ON       *IN53                                             MD022957
     C                     EXSR SIBSCE                                                      MD022957
     C                     ENDIF                                                            MD022957
     C                     ENDIF                                                              CSW213
      *                                                                                       CSW213
      ** IBAN Check Digit Length                                                              CSW213
      *                                                                                       CSW213
     C********** SICLN     IFEQ *BLANK                                               CSW213 MD022957
     C********** ZBBLN     ANDNE0                                                    CSW213 MD022957
     C********** WREFR     ANDEQ'Y'                                                  CSW213 MD022957
     C**********           MOVE '2'       SICLN                                      CSW213 MD022957
     C**********           ENDIF                                                     CSW213 MD022957
      **********                                                                     CSW213 MD022957
     C********** SICLN     IFNE *BLANK                                               CSW213 MD022957
     C********** SICLN     ANDNEWSICLN                                               CSW213 MD022957
      **********                                                                     CSW213 MD022957
     C********** SISOC     IFNE SIBAC                                                CSW213 MD022957
     C**********           MOVEL'ME21843' ZAMSID                                     CSW213 MD022957
     C**********           MOVEL'MEMSG'   ZAMSGF                                     CSW213 MD022957
     C**********           EXSR ZASNMS                                               CSW213 MD022957
     C**********           MOVE *ON       *IN54                                      CSW213 MD022957
     C**********           EXSR SIBSCE                                               CSW213 MD022957
     C**********           ENDIF                                                     CSW213 MD022957
     C                     MOVE *BLANKS   ZFIELD                                              CSW213
     C                     MOVE SICLN     ZFIELD                                              CSW213
     C                     Z-ADD2         ZADIG                                               CSW213
     C                     Z-ADD0         ZADEC                                               CSW213
     C                     EXSR ZALIGN                                                        CSW213
     C           *IN99     IFEQ *ON                                                           CSW213
     C                     MOVEL'ME21842' ZAMSID                                              CSW213
     C                     MOVEL'MEMSG'   ZAMSGF                                              CSW213
     C                     EXSR ZASNMS                                                        CSW213
     C                     MOVE 'Y'       WERROR                                              CSW213
     C                     MOVE *ON       *IN54                                               CSW213
     C                     ELSE                                                               CSW213
     C                     MOVE ZFIELD    ZICLN   20                                          CSW213
     C                     EXSR ZEDIT                                                         CSW213
     C           ZICLN     IFEQ 0                                                           MD022957
     C                     MOVE *BLANKS   SICLN                                             MD022957
     C                     ELSE                                                             MD022957
     C                     MOVE ZFIELD    SICLN                                               CSW213
     C                     ENDIF                                                            MD022957
     C                     ENDIF                                                              CSW213
      *                                                                                     MD022957
     C           SICLN     IFNE WSICLN                                                      MD022957
     C           ZICLN     IFNE 2                                                             CSW213
     C           ZICLN     ANDNE0                                                           MD022957
     C                     MOVEL'ME21844' ZAMSID                                              CSW213
     C                     MOVEL'MEMSG'   ZAMSGF                                              CSW213
     C                     EXSR ZASNMS                                                        CSW213
     C                     MOVE 'Y'       WERROR                                              CSW213
     C                     MOVE *ON       *IN54                                               CSW213
     C                     ENDIF                                                              CSW213
      *                                                                                     MD022957
     C           SISOC     IFNE SIBAC                                                       MD022957
     C                     MOVEL'ME21843' ZAMSID                                            MD022957
     C                     MOVEL'MEMSG'   ZAMSGF                                            MD022957
     C                     EXSR ZASNMS                                                      MD022957
     C                     MOVE *ON       *IN54                                             MD022957
     C                     EXSR SIBSCE                                                      MD022957
     C                     ENDIF                                                            MD022957
     C                     ENDIF                                                              CSW213
      *                                                                                     MD022957
      ** Default BBAN Length if IBAN Total Length is input                                  MD022957
      *                                                                                     MD022957
     C           ZTILN     IFGE 6                                                           MD022957
     C           ZTILN     ANDLE34                                                          MD022957
     C           ZBBLN     ANDEQ0                                                           MD022957
     C                     MOVE *BLANKS   ZFIELD                                            MD022957
     C           ZTILN     SUB  4         ZBBLN                                             MD022957
     C                     MOVE ZBBLN     ZFIELD                                            MD022957
     C                     EXSR ZEDIT                                                       MD022957
     C                     MOVE ZFIELD    SBBLN                                             MD022957
     C                     ENDIF                                                            MD022957
      *                                                                                     MD022957
     C           SBBLN     IFEQ *BLANK                                                      MD022957
     C           WREFR     ANDEQ'Y'                                                         MD022957
     C           WRUN      ANDEQ'Y'                                                         MD022957
     C                     MOVEL'ME21877' ZAMSID                                            MD022957
     C                     MOVEL'MEMSG'   ZAMSGF                                            MD022957
     C                     EXSR ZASNMS                                                      MD022957
     C                     MOVE 'Y'       WERROR                                            MD022957
     C                     MOVE *ON       *IN55                                             MD022957
     C                     ENDIF                                                            MD022957
      *                                                                                     MD022957
      ** Default BBAN Start Position to 5 if BBAN Length is input                           MD022957
      *                                                                                     MD022957
     C           ZBBLN     IFGT 0                                                           MD022957
     C           ZBBSP     ANDEQ0                                                           MD022957
     C                     MOVE '5'       SBBSP                                             MD022957
     C                     MOVE 5         ZBBSP                                             MD022957
     C                     ENDIF                                                            MD022957
      *                                                                                     MD022957
      ** Default IBAN Total Length if BBAN Length is input                                  MD022957
      *                                                                                     MD022957
     C           ZBBLN     IFGT 0                                                           MD022957
     C           ZTILN     ANDEQ0                                                           MD022957
     C           WREFR     ANDEQ'Y'                                                         MD022957
     C                     MOVE *BLANKS   ZFIELD                                            MD022957
     C           ZBBLN     ADD  4         ZTILN                                             MD022957
     C                     MOVE ZTILN     ZFIELD                                            MD022957
     C                     EXSR ZEDIT                                                       MD022957
     C                     MOVE ZFIELD    STILN                                             MD022957
     C                     ENDIF                                                            MD022957
      *                                                                                     MD022957
      ** BBAN Length and Start Position                                                     MD022957
      *                                                                                     MD022957
     C           ZBBLN     IFNE 0                                                           MD022957
     C           ZBBSP     ANDNE0                                                           MD022957
     C           WREFR     ANDEQ'Y'                                                         MD022957
      *                                                                                     MD022957
     C           ZTILN     ADD  1         TFCTR   30                                        MD022957
     C           TFCTR     SUB  ZBBSP     TFCTR                                             MD022957
     C           ZBBLN     IFNE TFCTR                                                       MD022957
     C                     MOVEL'ME21860' ZAMSID                                            MD022957
     C                     MOVEL'MEMSG'   ZAMSGF                                            MD022957
     C                     EXSR ZASNMS                                                      MD022957
     C                     MOVE 'Y'       WERROR                                            MD022957
     C                     MOVE *ON       *IN55                                             MD022957
     C                     ENDIF                                                            MD022957
      *                                                                                     MD022957
     C                     ENDIF                                                            MD022957
      *                                                                                     MD022957
      ** Default Country Code Start Position when BBAN Length is input                      MD022957
      *                                                                                     MD022957
     C           ZCCSP     IFEQ 0                                                           MD022957
     C           ZBBLN     ANDGT0                                                           MD022957
     C           WREFR     ANDEQ'Y'                                                         MD022957
     C                     MOVE '1'       SCCSP                                             MD022957
     C                     MOVE 1         ZCCSP                                             MD022957
     C                     ENDIF                                                            MD022957
      *                                                                                     MD022957
      ** Default Country Code Length if BBAN Length is input                                MD022957
      *                                                                                     MD022957
     C           ZCCLN     IFEQ 0                                                           MD022957
     C           ZBBLN     ANDGT0                                                           MD022957
     C           WREFR     ANDEQ'Y'                                                         MD022957
     C                     MOVE '2'       SCCLN                                             MD022957
     C                     MOVE 2         ZCCLN                                             MD022957
     C                     ENDIF                                                            MD022957
      *                                                                                     MD022957
      ** Default IBAN Check Digit Start Position if BBAN Length is input                    MD022957
      *                                                                                     MD022957
     C           ZICSP     IFEQ 0                                                           MD022957
     C           ZBBLN     ANDGT0                                                           MD022957
     C           WREFR     ANDEQ'Y'                                                         MD022957
     C                     MOVE '3'       SICSP                                             MD022957
     C                     MOVE 3         ZICSP                                             MD022957
     C                     ENDIF                                                            MD022957
      *                                                                                     MD022957
      ** Default IBAN Check Digit Length if BBAN Length is input                            MD022957
      *                                                                                     MD022957
     C           ZICLN     IFEQ 0                                                           MD022957
     C           ZBBLN     ANDGT0                                                           MD022957
     C           WREFR     ANDEQ'Y'                                                         MD022957
     C                     MOVE '2'       SICLN                                             MD022957
     C                     MOVE 2         ZICLN                                             MD022957
     C                     ENDIF                                                            MD022957
      *                                                                                       CSW213
      ** Bank ID Start Position                                                               CSW213
      *                                                                                       CSW213
     C********** SBISP     IFNE *BLANK                                               CSW213 MD022295
     C********** SBISP     ANDNEWSBISP                                               CSW213 MD022295
     C           SBISP     IFNE WSBISP                                                      MD022295
     C           SBISP     ORNE WZBISP                                                      MD022295
      *                                                                                       CSW213
     C********** SISOC     IFNE SIBAC                                                CSW213 MD023458
     C**********           MOVEL'ME21848' ZAMSID                                     CSW213 MD023458
     C**********           MOVEL'MEMSG'   ZAMSGF                                     CSW213 MD023458
     C**********           EXSR ZASNMS                                               CSW213 MD023458
     C**********           MOVE *ON       *IN56                                      CSW213 MD023458
     C**********           EXSR SIBSCE                                               CSW213 MD023458
     C**********           ENDIF                                                     CSW213 MD023458
      *                                                                                       CSW213
     C                     MOVE *BLANKS   ZFIELD                                              CSW213
     C                     MOVE SBISP     ZFIELD                                              CSW213
     C                     Z-ADD2         ZADIG                                               CSW213
     C                     Z-ADD0         ZADEC                                               CSW213
     C                     EXSR ZALIGN                                                        CSW213
     C           *IN99     IFEQ *ON                                                           CSW213
     C                     MOVEL'ME21847' ZAMSID                                              CSW213
     C                     MOVEL'MEMSG'   ZAMSGF                                              CSW213
     C                     EXSR ZASNMS                                                        CSW213
     C                     MOVE 'Y'       WERROR                                              CSW213
     C                     MOVE *ON       *IN56                                               CSW213
     C                     ELSE                                                               CSW213
     C                     MOVE ZFIELD    ZBISP   20                                          CSW213
     C                     EXSR ZEDIT                                                         CSW213
     C           SBISP     IFNE *BLANKS                                                     MD022295
     C                     MOVE ZFIELD    SBISP                                               CSW213
     C                     ENDIF                                                            MD022295
     C                     MOVE ZFIELD    WZBISP                                            MD022295
     C                     ENDIF                                                              CSW213
      *                                                                                       CSW213
     C                     ENDIF                                                              CSW213
      *                                                                                       CSW213
      ** Bank ID Length                                                                       CSW213
      *                                                                                       CSW213
     C********** SBILN     IFNE *BLANK                                               CSW213 MD022295
     C********** SBILN     ANDNEWSBILN                                               CSW213 MD022295
     C           SBILN     IFNE WSBILN                                                      MD022295
     C           SBILN     ORNE WZBILN                                                      MD022295
      *                                                                                       CSW213
     C********** SISOC     IFNE SIBAC                                                CSW213 MD023458
     C**********           MOVEL'ME21851' ZAMSID                                     CSW213 MD023458
     C**********           MOVEL'MEMSG'   ZAMSGF                                     CSW213 MD023458
     C**********           EXSR ZASNMS                                               CSW213 MD023458
     C**********           MOVE *ON       *IN57                                      CSW213 MD023458
     C**********           EXSR SIBSCE                                               CSW213 MD023458
     C**********           ENDIF                                                     CSW213 MD023458
      *                                                                                       CSW213
     C                     MOVE *BLANKS   ZFIELD                                              CSW213
     C                     MOVE SBILN     ZFIELD                                              CSW213
     C                     Z-ADD2         ZADIG                                               CSW213
     C                     Z-ADD0         ZADEC                                               CSW213
     C                     EXSR ZALIGN                                                        CSW213
     C           *IN99     IFEQ *ON                                                           CSW213
     C                     MOVEL'ME21850' ZAMSID                                              CSW213
     C                     MOVEL'MEMSG'   ZAMSGF                                              CSW213
     C                     EXSR ZASNMS                                                        CSW213
     C                     MOVE 'Y'       WERROR                                              CSW213
     C                     MOVE *ON       *IN57                                               CSW213
     C                     ELSE                                                               CSW213
     C                     MOVE ZFIELD    ZBILN   20                                          CSW213
     C                     EXSR ZEDIT                                                         CSW213
     C           SBILN     IFNE *BLANKS                                                     MD022295
     C                     MOVE ZFIELD    SBILN                                               CSW213
     C                     ENDIF                                                            MD022295
     C                     MOVE ZFIELD    WZBILN                                            MD022295
     C                     ENDIF                                                              CSW213
      *                                                                                       CSW213
     C                     ENDIF                                                              CSW213
      *                                                                                       CSW213
      ** Bank ID Length and Start Position                                                    CSW213
      *                                                                                       CSW213
     C           WREFR     IFEQ 'Y'                                                           CSW213
      *                                                                                       CSW213
     C           ZTILN     ADD  1         TFCTR   30                                          CSW213
     C           TFCTR     SUB  ZBILN     TFCTR                                               CSW213
     C           ZBISP     IFGT TFCTR                                                         CSW213
     C                     MOVEL'ME21849' ZAMSID                                              CSW213
     C                     MOVEL'MEMSG'   ZAMSGF                                              CSW213
     C                     EXSR ZASNMS                                                        CSW213
     C                     MOVE 'Y'       WERROR                                              CSW213
     C                     MOVE *ON       *IN56                                               CSW213
     C                     ENDIF                                                              CSW213
      *                                                                                       CSW213
     C           ZTILN     ADD  1         TFCTR   30                                          CSW213
     C           TFCTR     SUB  ZBISP     TFCTR                                               CSW213
     C           ZBILN     IFGT TFCTR                                                         CSW213
     C                     MOVEL'ME21852' ZAMSID                                              CSW213
     C                     MOVEL'MEMSG'   ZAMSGF                                              CSW213
     C                     EXSR ZASNMS                                                        CSW213
     C                     MOVE 'Y'       WERROR                                              CSW213
     C                     MOVE *ON       *IN57                                               CSW213
     C                     ENDIF                                                              CSW213
      *                                                                                       CSW213
     C                     ENDIF                                                              CSW213
      *                                                                                       CSW213
      ** Branch ID Start Position                                                             CSW213
      *                                                                                       CSW213
     C********** SBRSP     IFNE *BLANK                                               CSW213 MD022295
     C********** SBRSP     ANDNEWSBRSP                                               CSW213 MD022295
     C           SBRSP     IFNE WSBRSP                                                      MD022295
     C           SBRSP     ORNE WZBRSP                                                      MD022295
      *                                                                                       CSW213
     C********** SISOC     IFNE SIBAC                                                CSW213 MD023458
     C**********           MOVEL'ME21855' ZAMSID                                     CSW213 MD023458
     C**********           MOVEL'MEMSG'   ZAMSGF                                     CSW213 MD023458
     C**********           EXSR ZASNMS                                               CSW213 MD023458
     C**********           MOVE *ON       *IN59                                      CSW213 MD023458
     C**********           EXSR SIBSCE                                               CSW213 MD023458
     C**********           ENDIF                                                     CSW213 MD023458
     C                     MOVE *BLANKS   ZFIELD                                              CSW213
     C                     MOVE SBRSP     ZFIELD                                              CSW213
     C                     Z-ADD2         ZADIG                                               CSW213
     C                     Z-ADD0         ZADEC                                               CSW213
     C                     EXSR ZALIGN                                                        CSW213
     C           *IN99     IFEQ *ON                                                           CSW213
     C                     MOVEL'ME21854' ZAMSID                                              CSW213
     C                     MOVEL'MEMSG'   ZAMSGF                                              CSW213
     C                     EXSR ZASNMS                                                        CSW213
     C                     MOVE 'Y'       WERROR                                              CSW213
     C                     MOVE *ON       *IN59                                               CSW213
     C                     ELSE                                                               CSW213
     C                     MOVE ZFIELD    ZBRSP   20                                          CSW213
     C                     EXSR ZEDIT                                                         CSW213
     C           SBRSP     IFNE *BLANKS                                                     MD022295
     C                     MOVE ZFIELD    SBRSP                                               CSW213
     C                     ENDIF                                                            MD022295
     C                     MOVE ZFIELD    WZBRSP                                            MD022295
     C                     ENDIF                                                              CSW213
      *                                                                                       CSW213
     C                     ENDIF                                                              CSW213
      *                                                                                       CSW213
      ** Branch ID Length                                                                     CSW213
      *                                                                                       CSW213
     C********** SBRLN     IFNE *BLANK                                               CSW213 MD022295
     C********** SBRLN     ANDNEWSBRLN                                               CSW213 MD022295
     C           SBRLN     IFNE WSBRLN                                                      MD022295
     C           SBRLN     ORNE WZBRLN                                                      MD022295
      *                                                                                       CSW213
     C********** SISOC     IFNE SIBAC                                                CSW213 MD023458
     C**********           MOVEL'ME21858' ZAMSID                                     CSW213 MD023458
     C**********           MOVEL'MEMSG'   ZAMSGF                                     CSW213 MD023458
     C**********           EXSR ZASNMS                                               CSW213 MD023458
     C**********           MOVE *ON       *IN58                                      CSW213 MD023458
     C**********           EXSR SIBSCE                                               CSW213 MD023458
     C**********           ENDIF                                                     CSW213 MD023458
     C                     MOVE *BLANKS   ZFIELD                                              CSW213
     C                     MOVE SBRLN     ZFIELD                                              CSW213
     C**********           Z-ADD1         ZADIG                                      CSW213 MD021957
     C                     Z-ADD2         ZADIG                                             MD021957
     C                     Z-ADD0         ZADEC                                               CSW213
     C                     EXSR ZALIGN                                                        CSW213
     C           *IN99     IFEQ *ON                                                           CSW213
     C                     MOVEL'ME21857' ZAMSID                                              CSW213
     C                     MOVEL'MEMSG'   ZAMSGF                                              CSW213
     C                     EXSR ZASNMS                                                        CSW213
     C                     MOVE 'Y'       WERROR                                              CSW213
     C                     MOVE *ON       *IN58                                               CSW213
     C                     ELSE                                                               CSW213
     C                     MOVE ZFIELD    ZBRLN   20                                          CSW213
     C                     EXSR ZEDIT                                                         CSW213
     C           SBRLN     IFNE *BLANKS                                                     MD022295
     C                     MOVE ZFIELD    SBRLN                                               CSW213
     C                     ENDIF                                                            MD022295
     C                     MOVE ZFIELD    WZBRLN                                            MD022295
     C                     ENDIF                                                              CSW213
      *                                                                                       CSW213
     C                     ENDIF                                                              CSW213
      *                                                                                       CSW213
      ** Branch ID Length and Start Position                                                  CSW213
      *                                                                                       CSW213
     C           WREFR     IFEQ 'Y'                                                           CSW213
      *                                                                                       CSW213
     C           ZTILN     ADD  1         TFCTR   30                                          CSW213
     C           TFCTR     SUB  ZBRLN     TFCTR                                               CSW213
     C           ZBRSP     IFGT TFCTR                                                         CSW213
     C                     MOVEL'ME21856' ZAMSID                                              CSW213
     C                     MOVEL'MEMSG'   ZAMSGF                                              CSW213
     C                     EXSR ZASNMS                                                        CSW213
     C                     MOVE 'Y'       WERROR                                              CSW213
     C                     MOVE *ON       *IN59                                               CSW213
     C                     ENDIF                                                              CSW213
      *                                                                                       CSW213
     C           ZTILN     ADD  1         TFCTR   30                                          CSW213
     C           TFCTR     SUB  ZBRSP     TFCTR                                               CSW213
     C           ZBRLN     IFGT TFCTR                                                         CSW213
     C                     MOVEL'ME21859' ZAMSID                                              CSW213
     C                     MOVEL'MEMSG'   ZAMSGF                                              CSW213
     C                     EXSR ZASNMS                                                        CSW213
     C                     MOVE 'Y'       WERROR                                              CSW213
     C                     MOVE *ON       *IN58                                               CSW213
     C                     ENDIF                                                              CSW213
      *                                                                                       CSW213
     C                     ENDIF                                                              CSW213
      *                                                                                       CSW213
      ** BBAN Bank Length                                                                     CSW213
      *                                                                                       CSW213
     C********** STBLN     IFEQ *BLANK                                               CSW213 MD022957
     C********** WREFR     ANDEQ'Y'                                                  CSW213 MD022957
     C********** WWARN     ANDGE10                                                   CSW213 MD022957
     C**********           MOVEL'ME21878' ZAMSID                                     CSW213 MD022957
     C**********           MOVEL'MEMSG'   ZAMSGF                                     CSW213 MD022957
     C**********           EXSR ZASNMS                                               CSW213 MD022957
     C**********           MOVE *ON       *IN62                                      CSW213 MD022957
     C**********           MOVE 'Y'       WERROR                                     CSW213 MD022957
     C**********           ENDIF                                                     CSW213 MD022957
      **********                                                                     CSW213 MD022957
     C********** STBLN     IFNE *BLANK                                               CSW213 MD022957
     C********** STBLN     ANDNEWSTBLN                                               CSW213 MD022957
      **********                                                                     CSW213 MD022957
     C********** SISOC     IFNE SIBAC                                                CSW213 MD022957
     C**********           MOVEL'ME21853' ZAMSID                                     CSW213 MD022957
     C**********           MOVEL'MEMSG'   ZAMSGF                                     CSW213 MD022957
     C**********           EXSR ZASNMS                                               CSW213 MD022957
     C**********           MOVE *ON       *IN62                                      CSW213 MD022957
     C**********           EXSR SIBSCE                                               CSW213 MD022957
     C**********           ENDIF                                                     CSW213 MD022957
      *                                                                                       CSW213
     C                     MOVE *BLANKS   ZFIELD                                              CSW213
     C                     MOVE STBLN     ZFIELD                                              CSW213
     C                     Z-ADD2         ZADIG                                               CSW213
     C                     Z-ADD0         ZADEC                                               CSW213
     C                     EXSR ZALIGN                                                        CSW213
     C           *IN99     IFEQ *ON                                                           CSW213
     C                     MOVEL'USR3717' ZAMSID                                              CSW213
     C                     MOVEL'GB'      ZAMSGF                                              CSW213
     C                     MOVE 'SDUSRMSG'ZAMSGF                                              CSW213
     C                     EXSR ZASNMS                                                        CSW213
     C                     MOVE *BLANKS   ZAMSGF                                              CSW213
     C                     MOVE 'Y'       WERROR                                              CSW213
     C                     MOVE *ON       *IN62                                               CSW213
     C                     ELSE                                                               CSW213
     C                     MOVE ZFIELD    ZTBLN   20                                          CSW213
     C                     EXSR ZEDIT                                                         CSW213
     C           ZTBLN     IFEQ 0                                                           MD022957
     C                     MOVE *BLANKS   STBLN                                             MD022957
     C                     ELSE                                                             MD022957
     C                     MOVE ZFIELD    STBLN                                               CSW213
     C                     ENDIF                                                            MD022957
     C                     ENDIF                                                              CSW213
      *                                                                                       CSW213
     C           STBLN     IFEQ *BLANK                                                      MD022957
     C           WREFR     ANDEQ'Y'                                                         MD022957
     C           WRUN      ANDEQ'Y'                                                         MD022957
     C                     MOVEL'ME21878' ZAMSID                                            MD022957
     C                     MOVEL'MEMSG'   ZAMSGF                                            MD022957
     C                     EXSR ZASNMS                                                      MD022957
     C                     MOVE *ON       *IN62                                             MD022957
     C                     MOVE 'Y'       WERROR                                            MD022957
     C                     ENDIF                                                            MD022957
      *                                                                                     MD022957
     C                     MOVE *BLANKS   WTBLN   20                                        MD022957
     C           ZBILN     ADD  ZBRLN     WTBLN                                             MD022957
     C           ZTBLN     IFLT WTBLN                                                       MD022957
     C                     MOVEL'ME21884' ZAMSID                                            MD022957
     C                     MOVEL'MEMSG'   ZAMSGF                                            MD022957
     C                     EXSR ZASNMS                                                      MD022957
     C                     MOVE *BLANKS   ZAMSGF                                            MD022957
     C                     MOVE 'Y'       WERROR                                            MD022957
     C                     MOVE *ON       *IN62                                             MD022957
     C                     ENDIF                                                            MD022957
      *                                                                                     MD022957
     C           STBLN     IFNE WSTBLN                                                      MD022957
     C           SCSEL     ANDEQ'A'                                                         MD024472
     C           W2TBLN    ORNE WSTBLN                                                      MD024472
     C           SCSEL     ANDEQ*BLANKS                                                     MD024472
      *                                                                                       CFT051
     C           CFT051    IFEQ 'Y'                                                           CFT051
      *                                                                                       CFT051
     C           ZTBLN     IFLE 0                                                             CFT051
     C           W2TBLN    ANDNE*BLANKS                                                       CFT051
     C           ZTBLN     ORGT 15                                                            CFT051
     C           W2TBLN    ANDNE*BLANKS                                                       CFT051
     C                     MOVEL'USR0963' ZAMSID                                              CFT051
     C                     MOVEL'GB'      ZAMSGF                                              CFT051
     C                     MOVE 'SDUSRMSG'ZAMSGF                                              CFT051
     C                     EXSR ZASNMS                                                        CFT051
     C                     MOVE *BLANKS   ZAMSGF                                              CFT051
     C                     MOVE 'Y'       WERROR                                              CFT051
     C                     MOVE *ON       *IN62                                               CFT051
     C                     ENDIF                                                              CFT051
      *                                                                                       CFT051
     C                     ELSE                                                               CFT051
      *                                                                                       CFT051
     C********** ZTBLN     IFLT 0                                                    CSW213 MD022957
     C           ZTBLN     IFLE 0                                                           MD022957
     C           W2TBLN    ANDNE*BLANKS                                                       CFT051
     C           ZTBLN     ORGT 10                                                            CSW213
     C           W2TBLN    ANDNE*BLANKS                                                       CFT051
     C                     MOVEL'USR3720' ZAMSID                                              CSW213
     C                     MOVEL'GB'      ZAMSGF                                              CSW213
     C                     MOVE 'SDUSRMSG'ZAMSGF                                              CSW213
     C                     EXSR ZASNMS                                                        CSW213
     C                     MOVE *BLANKS   ZAMSGF                                              CSW213
     C                     MOVE 'Y'       WERROR                                              CSW213
     C                     MOVE *ON       *IN62                                               CSW213
     C                     ENDIF                                                              CSW213
      *                                                                                       CSW213
     C                     ENDIF                                                              CFT051
      *                                                                                       CFT051
     C           ZBBLN     IFEQ 0                                                             CSW213
     C********** ZTBLN     IFGT 0                                                    CSW213 MD023040
     C********** ZTBLN     IFGE 0                                                    MD023040 CFT051
     C           ZTBLN     IFGT 0                                                             CFT051
     C                     MOVEL'USR3719' ZAMSID                                              CSW213
     C                     MOVEL'GB'      ZAMSGF                                              CSW213
     C                     MOVE 'SDUSRMSG'ZAMSGF                                              CSW213
     C                     EXSR ZASNMS                                                        CSW213
     C                     MOVE *BLANKS   ZAMSGF                                              CSW213
     C                     MOVE 'Y'       WERROR                                              CSW213
     C                     MOVE *ON       *IN62                                               CSW213
     C                     ENDIF                                                              CSW213
      *                                                                                       CSW213
     C                     ELSE                                                               CSW213
     C           ZTBLN     IFGT ZBBLN                                                         CSW213
     C                     MOVEL'USR3721' ZAMSID                                              CSW213
     C                     MOVEL'GB'      ZAMSGF                                              CSW213
     C                     MOVE 'SDUSRMSG'ZAMSGF                                              CSW213
     C                     EXSR ZASNMS                                                        CSW213
     C                     MOVE *BLANKS   ZAMSGF                                              CSW213
     C                     MOVE 'Y'       WERROR                                              CSW213
     C                     MOVE *ON       *IN62                                               CSW213
     C                     ENDIF                                                              CSW213
     C                     ENDIF                                                              CSW213
      *                                                                                       CSW213
     C           SISOC     IFNE SIBAC                                                       MD022957
     C                     MOVEL'ME21853' ZAMSID                                            MD022957
     C                     MOVEL'MEMSG'   ZAMSGF                                            MD022957
     C                     EXSR ZASNMS                                                      MD022957
     C                     MOVE *ON       *IN62                                             MD022957
     C                     EXSR SIBSCE                                                      MD022957
     C                     ENDIF                                                            MD022957
     C                     ENDIF                                                              CSW213
      *                                                                                       CSW213
      ** IBAN National Id Length                                                              CSW213
      *                                                                                       CSW213
     C********** SINLN     IFNE *BLANK                                               CSW213 MD022295
     C********** SINLN     ANDNEWSINLN                                               CSW213 MD022295
     C           SINLN     IFNE WSINLN                                                      MD022295
     C           SINLN     ORNE WZINLN                                                      MD022295
      *                                                                                       CSW213
     C********** SISOC     IFNE SIBAC                                                CSW213 MD023458
     C**********           MOVEL'ME21862' ZAMSID                                     CSW213 MD023458
     C**********           MOVEL'MEMSG'   ZAMSGF                                     CSW213 MD023458
     C**********           EXSR ZASNMS                                               CSW213 MD023458
     C**********           MOVE *ON       *IN63                                      CSW213 MD023458
     C**********           EXSR SIBSCE                                               CSW213 MD023458
     C**********           ENDIF                                                     CSW213 MD023458
      *                                                                                       CSW213
     C                     MOVE *BLANKS   ZFIELD                                              CSW213
     C                     MOVE *BLANKS   W2TBLN                                              CFT051
     C                     MOVE SINLN     ZFIELD                                              CSW213
     C                     MOVE STBLN     W2TBLN  2                                           CFT051
     C                     Z-ADD2         ZADIG                                               CSW213
     C                     Z-ADD0         ZADEC                                               CSW213
     C                     EXSR ZALIGN                                                        CSW213
     C           *IN99     IFEQ *ON                                                           CSW213
     C                     MOVEL'ME21861' ZAMSID                                              CSW213
     C                     MOVEL'MEMSG'   ZAMSGF                                              CSW213
     C                     EXSR ZASNMS                                                        CSW213
     C                     MOVE 'Y'       WERROR                                              CSW213
     C                     MOVE *ON       *IN63                                               CSW213
     C                     ELSE                                                               CSW213
     C                     MOVE ZFIELD    ZINLN   20                                          CSW213
     C                     EXSR ZEDIT                                                         CSW213
     C           SINLN     IFNE *BLANKS                                                     MD022295
     C                     MOVE ZFIELD    SINLN                                               CSW213
     C                     ENDIF                                                            MD022295
     C                     MOVE ZFIELD    WZINLN                                            MD022295
     C                     ENDIF                                                              CSW213
      *                                                                                       CSW213
     C           ZINLN     IFGT ZTILN                                                         CSW213
     C                     MOVEL'ME21863' ZAMSID                                              CSW213
     C                     MOVEL'MEMSG'   ZAMSGF                                              CSW213
     C                     EXSR ZASNMS                                                        CSW213
     C                     MOVE 'Y'       WERROR                                              CSW213
     C                     MOVE *ON       *IN63                                               CSW213
     C                     ENDIF                                                              CSW213
      *                                                                                       CSW213
     C                     ENDIF                                                              CSW213
      *                                                                                       CSW213
      ** Account Number Start Position                                                        CSW213
      *                                                                                       CSW213
     C           SACSP     IFNE WSACSP                                                        CSW213
     C           SACSP     ORNE WZACSP                                                        CSW213
      *                                                                                       CSW213
     C           SISOC     IFNE SIBAC                                                         CSW213
     C                     MOVEL'ME21865' ZAMSID                                              CSW213
     C                     MOVEL'MEMSG'   ZAMSGF                                              CSW213
     C                     EXSR ZASNMS                                                        CSW213
     C                     MOVE *ON       *IN65                                               CSW213
     C                     EXSR SIBSCE                                                        CSW213
     C                     ENDIF                                                              CSW213
     C                     MOVE *BLANKS   ZFIELD                                              CSW213
     C                     MOVE SACSP     ZFIELD                                              CSW213
     C                     Z-ADD2         ZADIG                                               CSW213
     C                     Z-ADD0         ZADEC                                               CSW213
     C                     EXSR ZALIGN                                                        CSW213
     C           *IN99     IFEQ *ON                                                           CSW213
     C                     MOVEL'ME21864' ZAMSID                                              CSW213
     C                     MOVEL'MEMSG'   ZAMSGF                                              CSW213
     C                     EXSR ZASNMS                                                        CSW213
     C                     MOVE 'Y'       WERROR                                              CSW213
     C                     MOVE *ON       *IN65                                               CSW213
     C                     ELSE                                                               CSW213
     C                     MOVE ZFIELD    ZACSP   20                                          CSW213
     C                     EXSR ZEDIT                                                         CSW213
     C           SACSP     IFNE *BLANKS                                                       CSW213
     C                     MOVE ZFIELD    SACSP                                               CSW213
     C                     ENDIF                                                              CSW213
     C                     MOVE ZFIELD    WZACSP                                              CSW213
     C                     ENDIF                                                              CSW213
      *                                                                                       CSW213
     C                     ENDIF                                                              CSW213
      *                                                                                       CSW213
      ** Account Number Length                                                                CSW213
      *                                                                                       CSW213
     C********** SACLN     IFNE WSACLN                                               CSW213 MD022957
     C********** SACLN     ORNE WZACLN                                               CSW213 MD022957
      **********                                                                     CSW213 MD022957
     C********** SISOC     IFNE SIBAC                                                CSW213 MD022957
     C**********           MOVEL'ME21868' ZAMSID                                     CSW213 MD022957
     C**********           MOVEL'MEMSG'   ZAMSGF                                     CSW213 MD022957
     C**********           EXSR ZASNMS                                               CSW213 MD022957
     C**********           MOVE *ON       *IN64                                      CSW213 MD022957
     C**********           EXSR SIBSCE                                               CSW213 MD022957
     C**********           ENDIF                                                     CSW213 MD022957
     C                     MOVE *BLANKS   ZFIELD                                              CSW213
     C                     MOVE SACLN     ZFIELD                                              CSW213
     C                     Z-ADD2         ZADIG                                               CSW213
     C                     Z-ADD0         ZADEC                                               CSW213
     C                     EXSR ZALIGN                                                        CSW213
     C           *IN99     IFEQ *ON                                                           CSW213
     C                     MOVEL'ME21867' ZAMSID                                              CSW213
     C                     MOVEL'MEMSG'   ZAMSGF                                              CSW213
     C                     EXSR ZASNMS                                                        CSW213
     C                     MOVE 'Y'       WERROR                                              CSW213
     C                     MOVE *ON       *IN64                                               CSW213
     C                     ELSE                                                               CSW213
     C                     MOVE ZFIELD    ZACLN   20                                          CSW213
     C                     EXSR ZEDIT                                                         CSW213
     C           SACLN     IFNE *BLANKS                                                       CSW213
     C                     MOVE ZFIELD    SACLN                                               CSW213
     C                     ENDIF                                                              CSW213
     C                     MOVE ZFIELD    WZACLN                                              CSW213
     C                     ENDIF                                                              CSW213
      *                                                                                       CSW213
     C********** SACLN     IFNE WSACLN                                             MD022957 MD023458
     C********** SACLN     ORNE WZACLN                                             MD022957 MD023458
      **********                                                                   MD022957 MD023458
     C********** SISOC     IFNE SIBAC                                              MD022957 MD023458
     C**********           MOVEL'ME21868' ZAMSID                                   MD022957 MD023458
     C**********           MOVEL'MEMSG'   ZAMSGF                                   MD022957 MD023458
     C**********           EXSR ZASNMS                                             MD022957 MD023458
     C**********           MOVE *ON       *IN64                                    MD022957 MD023458
     C**********           EXSR SIBSCE                                             MD022957 MD023458
     C**********           ENDIF                                                   MD022957 MD023458
     C**********           ENDIF                                                     CSW213 MD023458
      *                                                                                       CSW213
      ** Account Number Length and Start Position                                             CSW213
      *                                                                                       CSW213
     C*********  ZACLN     IFNE 0                                                    CSW213 MD021995
     C*********  ZACSP     ANDNE0                                                    CSW213 MD021995
     C*********  WREFR     ANDEQ'Y'                                                  CSW213 MD021995
     C           WREFR     IFEQ 'Y'                                                         MD021995
      *                                                                                       CSW213
     C           ZTILN     ADD  1         TFCTR   30                                          CSW213
     C           TFCTR     SUB  ZACLN     TFCTR                                               CSW213
     C           ZACSP     IFGT TFCTR                                                         CSW213
     C                     MOVEL'ME21866' ZAMSID                                              CSW213
     C                     MOVEL'MEMSG'   ZAMSGF                                              CSW213
     C                     EXSR ZASNMS                                                        CSW213
     C                     MOVE 'Y'       WERROR                                              CSW213
     C                     MOVE *ON       *IN65                                               CSW213
     C                     ENDIF                                                              CSW213
      *                                                                                       CSW213
     C           ZTILN     ADD  1         TFCTR   30                                          CSW213
     C           TFCTR     SUB  ZACSP     TFCTR                                               CSW213
     C           ZACLN     IFGT TFCTR                                                         CSW213
     C                     MOVEL'ME21869' ZAMSID                                              CSW213
     C                     MOVEL'MEMSG'   ZAMSGF                                              CSW213
     C                     EXSR ZASNMS                                                        CSW213
     C                     MOVE 'Y'       WERROR                                              CSW213
     C                     MOVE *ON       *IN64                                               CSW213
     C                     ENDIF                                                              CSW213
      *                                                                                       CSW213
     C                     ENDIF                                                              CSW213
      *                                                                                     MD022957
     C           ZTILN     IFGT 0                                                           MD022957
     C           ZTBLN     ANDGT0                                                           MD022957
     C           ZACLN     ANDEQ0                                                           MD022957
     C           WREFR     ANDEQ'Y'                                                         MD023458
      *                                                                                     MD022957
      ** Default Account Number Length if IBAN Total Length and                             MD022957
      ** BBAN Bank Length are input                                                         MD022957
      *                                                                                     MD022957
     C           *IN61     IFEQ *OFF                                                        MD022957
     C           *IN62     ANDEQ*OFF                                                        MD022957
     C                     MOVE *BLANKS   ZFIELD                                            MD022957
     C           ZTILN     SUB  4         WACLN   20                                        MD022957
     C           WACLN     SUB  ZTBLN     ZACLN                                             MD022957
     C           ZACLN     IFGE 0                                                           MD022957
     C                     MOVE ZACLN     ZFIELD                                            MD022957
     C                     EXSR ZEDIT                                                       MD022957
     C                     MOVE ZFIELD    SACLN                                             MD022957
     C                     ENDIF                                                            MD022957
      *                                                                                     MD022957
     C                     ELSE                                                             MD022957
     C                     MOVEL'ME21882' ZAMSID                                            MD022957
     C                     MOVEL'MEMSG'   ZAMSGF                                            MD022957
     C                     EXSR ZASNMS                                                      MD022957
     C                     MOVE 'Y'       WERROR                                            MD022957
     C                     MOVE *ON       *IN64                                             MD022957
     C                     ENDIF                                                            MD022957
      *                                                                                     MD022957
     C                     ENDIF                                                            MD022957
      *                                                                                     MD022957
      ** IBAN Total Length must be greater than or equal to the sum                         MD022957
      ** of Country Code Length, IBAN Check Digit Length, BBAN Bank                         MD022957
      ** Length and Account Number Length                                                   MD022957
      *                                                                                     MD022957
     C           ZACLN     IFGT 0                                                           MD022957
      *                                                                                     MD022957
     C                     Z-ADD0         WTILN   20                                        MD022957
     C           ZCCLN     ADD  ZICLN     WTILN                                             MD022957
     C           WTILN     ADD  ZTBLN     WTILN                                             MD022957
     C           WTILN     ADD  ZACLN     WTILN                                             MD022957
      *                                                                                     MD022957
     C           ZTILN     IFLT WTILN                                                       MD022957
     C                     MOVEL'ME21883' ZAMSID                                            MD022957
     C                     MOVEL'MEMSG'   ZAMSGF                                            MD022957
     C                     EXSR ZASNMS                                                      MD022957
     C                     MOVE 'Y'       WERROR                                            MD022957
     C                     MOVE *ON       *IN61                                             MD022957
     C                     ENDIF                                                            MD022957
      *                                                                                     MD022957
     C                     ENDIF                                                            MD022957
      *                                                                                       CSW213
     C           ZBBLN     IFGT ZTILN                                                         CSW213
     C           ZBBLN     ORLT ZCCLN                                                         CSW213
     C           ZBBLN     ORLT ZICLN                                                         CSW213
     C           ZBBLN     ORLT ZBILN                                                         CSW213
     C           ZBBLN     ORLT ZBRLN                                                         CSW213
     C           ZBBLN     ORLT ZTBLN                                                         CSW213
     C           ZBBLN     ORLT ZINLN                                                         CSW213
     C           ZBBLN     ORLT ZACLN                                                         CSW213
     C                     MOVEL'USR0798' ZAMSID                                              CSW213
     C                     MOVEL'GB'      ZAMSGF                                              CSW213
     C                     MOVE 'SDUSRMSG'ZAMSGF                                              CSW213
     C                     EXSR ZASNMS                                                        CSW213
     C                     MOVE *BLANKS   ZAMSGF                                              CSW213
     C                     MOVE 'Y'       WERROR                                              CSW213
     C                     MOVE *ON       *IN55                                               CSW213
     C                     ENDIF                                                              CSW213
      *                                                                                       CSW213
      ** Optional Commence Date                                                               CSW213
      *                                                                                       CSW213
     C                     MOVE 'N'       WDERR   1                                           CSW213
     C           SOCDT     IFEQ *BLANKS                                                       CSW213
     C                     Z-ADD0         ZOCDT                                               CSW213
     C                     ENDIF                                                              CSW213
      *                                                                                       CSW213
     C           SOCDT     IFNE *BLANKS                                                       C3W213
     C           SOCDT     ANDNEWSOCDT                                                        CSW213
     C           SISOC     IFNE SIBAC                                                         CSW213
     C                     MOVEL'ME21830' ZAMSID                                              CSW213
     C                     MOVEL'MEMSG'   ZAMSGF                                              CSW213
     C                     EXSR ZASNMS                                                        CSW213
     C                     MOVE *ON       *IN47                                               CSW213
     C                     EXSR SIBSCE                                                        CSW213
     C                     ENDIF                                                              CSW213
      *                                                                                       CSW213
     C                     MOVE *BLANKS   ZFIELD                                              CSW213
     C                     MOVE SOCDT     ZFIELD                                              CSW213
     C                     Z-ADD6         ZADIG                                               CSW213
     C                     Z-ADD0         ZADEC                                               CSW213
     C                     EXSR ZALIGN                                                        CSW213
     C           *IN99     IFEQ *ON                                                           CSW213
     C                     MOVE 'Y'       WDERR                                               CSW213
     C                     ENDIF                                                              CSW213
      *                                                                                       CSW213
     C                     MOVE SOCDT     ZDATE                                               CSW213
     C                     EXSR ZDATE1                                                        CSW213
     C           *IN99     IFEQ *ON                                                           CSW213
     C           WDERR     OREQ 'Y'                                                           CSW213
     C                     MOVEL'ME21829' ZAMSID                                              CSW213
     C                     MOVEL'MEMSG'   ZAMSGF                                              CSW213
     C                     EXSR ZASNMS                                                        CSW213
     C                     MOVE 'Y'       WERROR                                              CSW213
     C                     MOVE *ON       *IN47                                               CSW213
     C                     ELSE                                                               CSW213
     C                     Z-ADDZDAYNO    ZOCDT   50                                          CSW213
     C                     ENDIF                                                              CSW213
     C                     ENDIF                                                              CSW213
      *                                                                                       CSW213
      ** Mandatory Commence Date                                                              CSW213
      *                                                                                       CSW213
     C                     MOVE 'N'       WDERR                                               CSW213
     C           SMCDT     IFEQ *BLANKS                                                       CSW213
     C                     Z-ADD0         ZMCDT                                               CSW213
     C                     ENDIF                                                              CSW213
      *                                                                                       CSW213
     C           SMCDT     IFNE *BLANKS                                                       CSW213
     C           SMCDT     ANDNEWSMCDT                                                        CSW213
     C           SISOC     IFNE SIBAC                                                         CSW213
     C                     MOVEL'ME21832' ZAMSID                                              CSW213
     C                     MOVEL'MEMSG'   ZAMSGF                                              CSW213
     C                     EXSR ZASNMS                                                        CSW213
     C                     MOVE *ON       *IN48                                               CSW213
     C                     EXSR SIBSCE                                                        CSW213
     C                     ENDIF                                                              CSW213
      *                                                                                       CSW213
     C                     MOVE *BLANKS   ZFIELD                                              CSW213
     C                     MOVE SOCDT     ZFIELD                                              CSW213
     C                     Z-ADD6         ZADIG                                               CSW213
     C                     Z-ADD0         ZADEC                                               CSW213
     C                     EXSR ZALIGN                                                        CSW213
     C           *IN99     IFEQ *ON                                                           CSW213
     C                     MOVE 'Y'       WDERR                                               CSW213
     C                     ENDIF                                                              CSW213
      *                                                                                       CSW213
     C                     MOVE *BLANKS   ZDATE                                               CSW213
     C                     MOVE SMCDT     ZDATE                                               CSW213
     C                     EXSR ZDATE1                                                        CSW213
     C           *IN99     IFEQ *ON                                                           CSW213
     C           WDERR     OREQ 'Y'                                                           CSW213
     C                     MOVEL'ME21831' ZAMSID                                              CSW213
     C                     MOVEL'MEMSG'   ZAMSGF                                              CSW213
     C                     EXSR ZASNMS                                                        CSW213
     C                     MOVE 'Y'       WERROR                                              CSW213
     C                     MOVE *ON       *IN48                                               CSW213
     C                     ELSE                                                               CSW213
     C                     Z-ADDZDAYNO    ZMCDT   50                                          CSW213
     C                     ENDIF                                                              CSW213
     C                     ENDIF                                                              CSW213
      *================================================================                       CSW213
     CSR         EXIBSC    ENDSR                                                              CSW213
      /EJECT                                                                                  CSW213
     CSR         SIBSCE    BEGSR                                                              CSW213
      *================================================================                       CSW213
      ** Invalidate Change IBAN Country Code for non-reference                                CSW213
      *================================================================                       CSW213
     C                     MOVE 'Y'       WERROR                                              CSW213
     C                     MOVE *ON       *IN45                                               CSW213
      *================================================================                       CSW213
     CSR         EXBSCE    ENDSR                                                              CSW213
      /EJECT                                                                                  CSW213
     CSR         SRSYNC    BEGSR                                                              CSW213
      *================================================================                       CSW213
      ** Synchronize BBAN Length and BBAN Bank Length for any attached                        CSW213
      *================================================================                       CSW213
     C           SIBAC     IFEQ SISOC                                                         CSW213
     C                     EXSR SSYNCO                                                        CSW213
     C                     ELSE                                                               CSW213
     C                     EXSR SSYNCS                                                        CSW213
     C                     ENDIF                                                              CSW213
      *================================================================                       CSW213
     CSR         EXSYNC    ENDSR                                                              CSW213
      /EJECT                                                                                  CSW213
     CSR         SSYNCO    BEGSR                                                              CSW213
      *================================================================                       CSW213
      ** Synchronize IBAN Structure to any attached ISO records and                           CSW213
      ** update BBAN Length and BBAN Bank Length in SDCTRYPD                                  CSW213
      *================================================================                       CSW213
     C                     MOVE *OFF      *IN60                                               CSW213
     C                     MOVE *BLANKS   WISOC                                               CSW213
     C                     MOVE M3IBAC    WIBAC                                               CSW213
     C                     MOVE M3IBAC    RFIBAC                                              CSW213
     C                     MOVE M3BBLN    RFBBLN                                              CSW213
     C                     MOVE M3TBLN    RFTBLN                                              CSW213
     C                     EXSR MOVREF                                                        CSW213
      *                                                                                       CSW213
     C           *LOVAL    SETLLMEISOCL3                                                      CSW213
     C           KSYNC     SETLLMEISOCL3                                                      CSW213
     C           KSYNC     READEMEISOCL3                 60                                   CSW213
      *                                                                                       CSW213
     C           *IN60     DOWEQ*OFF                                                          CSW213
     C                     MOVE M3ISOC    NRISOC                                              CSW213
      *                                                                                       CSW213
     C           M3ISOC    IFNE RFIBAC                                                        CSW213
     C           NRISOC    CHAINMEISOCL0             60                                       CSW213
     C           *IN60     IFEQ *OFF                                                          CSW213
     C                     EXSR RTVREF                                                        CSW213
     C                     UPDAT@ISOCL0                91                                     CSW213
      *                                                                                       CSW213
      ** Display error msg if file update not successful                                      CSW213
      *                                                                                       CSW213
     C           *IN91     IFEQ *ON                                                           CSW213
     C                     MOVEL'ME00011' ZAMSID                                              CSW213
     C                     MOVEL'MEMSG'   ZAMSGF                                              CSW213
     C                     EXSR ZASNMS                                                        CSW213
     C                     MOVE 'Y'       WERROR                                              CSW213
     C                     ELSE                                                               CSW213
     C                     MOVELWDBRC     SDBRC                                               CSW213
     C                     ENDIF                                                              CSW213
     C                     ENDIF                                                              CSW213
      *                                                                                       CSW213
     C                     ENDIF                                                              CSW213
      *                                                                                       CSW213
      ** Synchronize in A4BBAN and A4BBRL in SDCTRYPD                                         CSW213
      *                                                                                       CSW213
     C                     EXSR SSYNCC                                                        CSW213
      *                                                                                       CSW213
     C           KSYNC     READEMEISOCD0                 60                                   CSW213
     C                     ENDDO                                                              CSW213
      *================================================================                       CSW213
     CSR         EXYNCO    ENDSR                                                              CSW213
      /EJECT                                                                                  CSW213
     CSR         SSYNCS    BEGSR                                                              CSW213
      *================================================================                       CSW213
      ** Synchronize IBAN Structure on Reference                                              CSW213
      *================================================================                       CSW213
     C                     MOVE M3ISOC    NRISOC                                              CSW213
     C                     MOVE M3IBAC    WIBAC                                               CSW213
      *                                                                                       CSW213
     C           KSYNC     CHAINMEISOCL3             60                                       CSW213
      *                                                                                       CSW213
     C           *IN60     IFEQ *OFF                                                          CSW213
     C                     EXSR MOVREF                                                        CSW213
     C           NRISOC    CHAINMEISOCL0             60                                       CSW213
     C           *IN60     IFEQ *OFF                                                          CSW213
     C                     EXSR RTVREF                                                        CSW213
     C                     UPDAT@ISOCL0                91                                     CSW213
      *                                                                                       CSW213
      ** Display error msg if file update not successful                                      CSW213
      *                                                                                       CSW213
     C           *IN91     IFEQ *ON                                                           CSW213
     C                     MOVEL'ME00011' ZAMSID                                              CSW213
     C                     MOVEL'MEMSG'   ZAMSGF                                              CSW213
     C                     EXSR ZASNMS                                                        CSW213
     C                     MOVE 'Y'       WERROR                                              CSW213
     C                     ELSE                                                               CSW213
     C                     MOVELWDBRC     SDBRC                                               CSW213
     C                     ENDIF                                                              CSW213
      *                                                                                       CSW213
     C                     ENDIF                                                              CSW213
     C                     EXSR SSYNCC                                                        CSW213
     C                     ENDIF                                                              CSW213
      *================================================================                       CSW213
     CSR         EXYNCS    ENDSR                                                              CSW213
      /EJECT                                                                                  CSW213
     CSR         SSYNCC    BEGSR                                                              CSW213
      *================================================================                       CSW213
      ** Synchronize BBAN Length and BBAN Bank Length on SDCTRYPD                             CSW213
      *================================================================                       CSW213
     C           *LOVAL    SETLLSDCTRYL2                                                      CSW213
     C           NRISOC    SETLLSDCTRYL2                                                      CSW213
     C           NRISOC    READESDCTRYL2                 60                                   CSW213
      *                                                                                       CSW213
     C           *IN60     DOWEQ*OFF                                                          CSW213
     C                     Z-ADDRFBBLN    A4BBAN                                              CSW213
     C           CFT051    IFEQ 'Y'                                                           CFT051
     C                     Z-ADDRFINLN    A4BBRL                                              CFT051
     C                     ELSE                                                               CFT051
     C                     Z-ADDRFTBLN    A4BBRL                                              CSW213
     C                     ENDIF                                                              CFT051
     C                     UPDATSDCTRYD0                                                      CSW213
     C           NRISOC    READESDCTRYD0                 60                                   CSW213
     C                     ENDDO                                                              CSW213
      *                                                                                       CSW213
     C                     MOVE *OFF      *IN60                                               CSW213
      *================================================================                       CSW213
     CSR         EXYNCC    ENDSR                                                              CSW213
      /EJECT                                                                                  CSW213
     CSR         SRRIBS    BEGSR                                                              CSW213
      *================================================================                       CSW213
      ** Retrieve Reference IBAN Structure values                                             CSW213
      *================================================================                       CSW213
     C           RFIBAC    CHAINMEISOCL1             60                                       CSW213
     C           *IN60     IFEQ *OFF                                                          CSW213
     C           RFIBAC    IFEQ M3IBAC                                                        CSW213
     C                     EXSR MOVREF                                                        CSW213
     C                     ENDIF                                                              CSW213
     C                     ENDIF                                                              CSW213
     C                     MOVE *OFF      *IN60                                               CSW213
     C           NRISOC    IFNE *BLANKS                                                       CSW213
     C           NRISOC    CHAINMEISOCL1             60                                       CSW213
     C           *IN60     IFEQ *OFF                                                          CSW213
     C                     EXSR RTVREF                                                        CSW213
     C                     ENDIF                                                              CSW213
     C                     ENDIF                                                              CSW213
      *================================================================                       CSW213
     CSR         EXRIBS    ENDSR                                                              CSW213
      /EJECT                                                                                  CSW213
     CSR         SRRCTY    BEGSR                                                              CSW213
      *================================================================                       CSW213
      ** Retrieve SWIFTRef Country Code Description                                           CSW213
      *================================================================                       CSW213
     C                     MOVE *BLANKS   SBICD                                               CSW213
     C           CFT050    IFEQ 'Y'                                                           CSW213
     C********** WFLDC     CHAINMEBIB3L3             60                              CSW213 MD023358
     C           WFLDC     CHAINMEBICCL1             60                                     MD023358
     C           *IN60     IFEQ *OFF                                                          CSW213
     C**********           MOVELB3CNT1    SBICD                                      CSW213 MD023358
     C                     MOVELBCCNTY    SBICD                                             MD023358
     C                     ELSE                                                               CSW213
     C                     MOVELNFCNTY    SBICD                                               CSW213
     C                     ENDIF                                                              CSW213
     C                     ENDIF                                                              CSW213
      *================================================================                       CSW213
     CSR         EXRCTY    ENDSR                                                              CSW213
      /EJECT                                                                                  CSW213
     CSR         SPOPDF    BEGSR                                                              CSW213
      *================================================================                       CSW213
      ** Moving to data to ME1740D1 and work fields                                           CSW213
      *================================================================                       CSW213
     C           SPREL     IFEQ 'N'                                                           CSW213
     C                     EXSR SLSFFB                                                        CSW213
     C                     MOVELM3SEPA    SSEPA                                               CSW213
     C                     MOVELM3IBAR    SIBAR                                               CSW213
     C                     ENDIF                                                              CSW213
      *                                                                                       CSW213
     C           SIBAC     IFNE *BLANKS                                                       CSW213
     C                     MOVE *BLANKS   ZFIELD                                              CSW213
     C                     MOVE M3TILN    ZFIELD                                              CSW213
     C                     EXSR ZEDIT                                                         CSW213
     C                     MOVE ZFIELD    STILN                                               CSW213
     C                     MOVE ZFIELD    WSTILN                                              CSW213
     C                     Z-ADDM3TILN    ZTILN                                               CSW213
      *                                                                                       CSW213
     C                     MOVE *BLANKS   ZFIELD                                              CSW213
     C                     MOVE M3BBSP    ZFIELD                                              CSW213
     C                     EXSR ZEDIT                                                         CSW213
     C                     MOVE ZFIELD    SBBSP                                               CSW213
     C                     MOVE ZFIELD    WSBBSP                                              CSW213
     C                     Z-ADDM3BBSP    ZBBSP                                               CSW213
      *                                                                                       CSW213
     C                     MOVE *BLANKS   ZFIELD                                              CSW213
     C                     MOVE M3BBLN    ZFIELD                                              CSW213
     C                     EXSR ZEDIT                                                         CSW213
     C                     MOVE ZFIELD    SBBLN                                               CSW213
     C                     MOVE ZFIELD    WSBBLN                                              CSW213
     C                     Z-ADDM3BBLN    ZBBLN                                               CSW213
      *                                                                                       CSW213
     C                     MOVE *BLANKS   ZFIELD                                              CSW213
     C                     MOVE M3CCSP    ZFIELD                                              CSW213
     C                     EXSR ZEDIT                                                         CSW213
     C                     MOVE ZFIELD    SCCSP                                               CSW213
     C                     MOVE ZFIELD    WSCCSP                                              CSW213
     C                     Z-ADDM3CCSP    ZCCSP                                               CSW213
      *                                                                                       CSW213
     C                     MOVE *BLANKS   ZFIELD                                              CSW213
     C                     MOVE M3CCLN    ZFIELD                                              CSW213
     C                     EXSR ZEDIT                                                         CSW213
     C                     MOVE ZFIELD    SCCLN                                               CSW213
     C                     MOVE ZFIELD    WSCCLN                                              CSW213
     C                     Z-ADDM3CCLN    ZCCLN                                               CSW213
      *                                                                                       CSW213
     C                     MOVE *BLANKS   ZFIELD                                              CSW213
     C                     MOVE M3ICSP    ZFIELD                                              CSW213
     C                     EXSR ZEDIT                                                         CSW213
     C                     MOVE ZFIELD    SICSP                                               CSW213
     C                     MOVE ZFIELD    WSICSP                                              CSW213
     C                     Z-ADDM3ICSP    ZICSP                                               CSW213
      *                                                                                       CSW213
     C                     MOVE *BLANKS   ZFIELD                                              CSW213
     C                     MOVE M3ICLN    ZFIELD                                              CSW213
     C                     EXSR ZEDIT                                                         CSW213
     C                     MOVE ZFIELD    SICLN                                               CSW213
     C                     MOVE ZFIELD    WSICLN                                              CSW213
     C                     Z-ADDM3ICLN    ZICLN                                               CSW213
      *                                                                                       CSW213
     C********** M3BISP    IFNE 0                                                  MD022401 MD022957
     C                     MOVE *BLANKS   ZFIELD                                              CSW213
     C                     MOVE M3BISP    ZFIELD                                              CSW213
     C                     EXSR ZEDIT                                                         CSW213
     C           PMMODE    IFEQ 'M'                                                         MD022957
     C           SCSEL     ANDEQ'A'                                                         MD022957
     C           M3BISP    ANDEQ0                                                           MD022957
     C                     MOVE *BLANKS   SBISP                                             MD022957
     C                     MOVE *BLANKS   WSBISP                                            MD022957
     C                     ELSE                                                             MD022957
     C                     MOVE ZFIELD    SBISP                                               CSW213
     C                     MOVE ZFIELD    WSBISP                                              CSW213
     C                     ENDIF                                                            MD022957
     C                     Z-ADDM3BISP    ZBISP                                               CSW213
     C**********           ENDIF                                                   MD022401 MD022957
      *                                                                                       CSW213
     C********** M3BILN    IFNE 0                                                  MD022401 MD022957
     C                     MOVE *BLANKS   ZFIELD                                              CSW213
     C                     MOVE M3BILN    ZFIELD                                              CSW213
     C                     EXSR ZEDIT                                                         CSW213
     C           PMMODE    IFEQ 'M'                                                         MD022957
     C           SCSEL     ANDEQ'A'                                                         MD022957
     C           M3BILN    ANDEQ0                                                           MD022957
     C                     MOVE *BLANKS   SBILN                                             MD022957
     C                     MOVE *BLANKS   WSBILN                                            MD022957
     C                     ELSE                                                             MD022957
     C                     MOVE ZFIELD    SBILN                                               CSW213
     C                     MOVE ZFIELD    WSBILN                                              CSW213
     C                     ENDIF                                                            MD022957
     C                     Z-ADDM3BILN    ZBILN                                               CSW213
     C**********           ENDIF                                                   MD022401 MD022957
      *                                                                                       CSW213
     C********** M3BRSP    IFNE 0                                                    CSW213 MD022957
     C                     MOVE *BLANKS   ZFIELD                                              CSW213
     C                     MOVE M3BRSP    ZFIELD                                              CSW213
     C                     EXSR ZEDIT                                                         CSW213
     C           PMMODE    IFEQ 'M'                                                         MD022957
     C           SCSEL     ANDEQ'A'                                                         MD022957
     C           M3BRSP    ANDEQ0                                                           MD022957
     C                     MOVE *BLANKS   SBRSP                                             MD022957
     C                     MOVE *BLANKS   WSBRSP                                            MD022957
     C                     ELSE                                                             MD022957
     C                     MOVE ZFIELD    SBRSP                                               CSW213
     C                     MOVE ZFIELD    WSBRSP                                              CSW213
     C                     ENDIF                                                            MD022957
     C                     Z-ADDM3BRSP    ZBRSP                                               CSW213
     C**********           ENDIF                                                     CSW213 MD022957
     C********** M3BRLN    IFNE 0                                                    CSW213 MD022957
     C********** M3BRLN    OREQ 0                                                    CSW213 MD022957
     C********** M3INLN    ANDNE0                                                    CSW213 MD022957
     C                     MOVE *BLANKS   ZFIELD                                              CSW213
     C                     MOVE M3BRLN    ZFIELD                                              CSW213
     C                     EXSR ZEDIT                                                         CSW213
     C           PMMODE    IFEQ 'M'                                                         MD022957
     C           SCSEL     ANDEQ'A'                                                         MD022957
     C           M3BRLN    ANDEQ0                                                           MD022957
     C                     MOVE *BLANKS   SBRLN                                             MD022957
     C                     MOVE *BLANKS   WSBRLN                                            MD022957
     C                     ELSE                                                             MD022957
     C                     MOVE ZFIELD    SBRLN                                               CSW213
     C                     MOVE ZFIELD    WSBRLN                                              CSW213
     C                     ENDIF                                                            MD022957
     C                     Z-ADDM3BRLN    ZBRLN                                               CSW213
     C**********           ENDIF                                                     CSW213 MD022957
     C********** M3TBLN    IFNE 0                                                    CSW213 MD022957
     C                     MOVE *BLANKS   ZFIELD                                              CSW213
     C                     MOVE M3TBLN    ZFIELD                                              CSW213
     C                     EXSR ZEDIT                                                         CSW213
     C           PMMODE    IFEQ 'M'                                                         MD022957
     C           SCSEL     ANDEQ'A'                                                         MD022957
     C           M3TBLN    ANDEQ0                                                           MD022957
     C                     MOVE *BLANKS   STBLN                                             MD022957
     C                     MOVE *BLANKS   WSTBLN                                            MD022957
     C                     ELSE                                                             MD022957
     C                     MOVE ZFIELD    STBLN                                               CSW213
     C                     MOVE ZFIELD    WSTBLN                                              CSW213
     C                     ENDIF                                                            MD022957
     C                     Z-ADDM3TBLN    ZTBLN                                               CSW213
     C**********           ENDIF                                                     CSW213 MD022957
     C********** M3INLN    IFNE 0                                                    CSW213 MD022957
     C                     MOVE *BLANKS   ZFIELD                                              CSW213
     C                     MOVE M3INLN    ZFIELD                                              CSW213
     C                     EXSR ZEDIT                                                         CSW213
     C           PMMODE    IFEQ 'M'                                                         MD022957
     C           SCSEL     ANDEQ'A'                                                         MD022957
     C           M3INLN    ANDEQ0                                                           MD022957
     C                     MOVE *BLANKS   SINLN                                             MD022957
     C                     MOVE *BLANKS   WSINLN                                            MD022957
     C                     ELSE                                                             MD022957
     C                     MOVE ZFIELD    SINLN                                               CSW213
     C                     MOVE ZFIELD    WSINLN                                              CSW213
     C                     ENDIF                                                            MD022957
     C                     Z-ADDM3INLN    ZINLN                                               CSW213
     C**********           ENDIF                                                     CSW213 MD022957
      *                                                                                       CSW213
     C********** M3ACSP    IFNE 0                                                  MD022401 MD022957
     C                     MOVE *BLANKS   ZFIELD                                              CSW213
     C                     MOVE M3ACSP    ZFIELD                                              CSW213
     C                     EXSR ZEDIT                                                         CSW213
     C           PMMODE    IFEQ 'M'                                                         MD022957
     C           SCSEL     ANDEQ'A'                                                         MD022957
     C           M3ACSP    ANDEQ0                                                           MD022957
     C                     MOVE *BLANKS   SACSP                                             MD022957
     C                     MOVE *BLANKS   WSACSP                                            MD022957
     C                     MOVE *BLANKS   WZACSP                                            MD022957
     C                     ELSE                                                             MD022957
     C                     MOVE ZFIELD    SACSP                                               CSW213
     C                     MOVE ZFIELD    WSACSP                                              CSW213
     C                     MOVE ZFIELD    WZACSP                                            MD022005
     C                     ENDIF                                                            MD022957
     C                     Z-ADDM3ACSP    ZACSP                                               CSW213
     C**********           ENDIF                                                   MD022401 MD022957
      *                                                                                       CSW213
     C********** M3ACLN    IFNE 0                                                  MD022401 MD022957
     C                     MOVE *BLANKS   ZFIELD                                              CSW213
     C                     MOVE M3ACLN    ZFIELD                                              CSW213
     C                     EXSR ZEDIT                                                         CSW213
     C           PMMODE    IFEQ 'M'                                                         MD022957
     C           SCSEL     ANDEQ'A'                                                         MD022957
     C           M3ACLN    ANDEQ0                                                           MD022957
     C                     MOVE *BLANKS   SACLN                                             MD022957
     C                     MOVE *BLANKS   WSACLN                                            MD022957
     C                     MOVE *BLANKS   WZACLN                                            MD022957
     C                     ELSE                                                             MD022957
     C                     MOVE ZFIELD    SACLN                                               CSW213
     C                     MOVE ZFIELD    WSACLN                                              CSW213
     C                     MOVE ZFIELD    WZACLN                                            MD022005
     C                     ENDIF                                                            MD022957
     C                     Z-ADDM3ACLN    ZACLN                                               CSW213
     C**********           ENDIF                                                   MD022401 MD022957
      *                                                                                       CSW213
     C           M3OCDT    IFNE 0                                                             CSW213
     C                     Z-ADDM3OCDT    ZDAYNO                                              CSW213
     C                     EXSR ZDATE2                                                        CSW213
     C                     MOVE ZDATE     SOCDT                                               CSW213
     C                     MOVE ZDATE     WSOCDT                                              CSW213
     C                     Z-ADDM3OCDT    ZOCDT                                               CSW213
     C                     ELSE                                                             MD023517
     C                     MOVE *BLANKS   SOCDT                                             MD023517
     C                     ENDIF                                                              CSW213
     C           M3MCDT    IFNE 0                                                             CSW213
     C                     Z-ADDM3MCDT    ZDAYNO                                              CSW213
     C                     EXSR ZDATE2                                                        CSW213
     C                     MOVE ZDATE     SMCDT                                               CSW213
     C                     MOVE ZDATE     WSMCDT                                              CSW213
     C                     Z-ADDM3MCDT    ZMCDT                                               CSW213
     C                     ELSE                                                             MD023517
     C                     MOVE *BLANKS   SMCDT                                             MD023517
     C                     ENDIF                                                              CSW213
     C                     ENDIF                                                              CSW213
      *================================================================                       CSW213
     CSR         EXOPDF    ENDSR                                                              CSW213
      /EJECT                                                                                  CSW213
     CSR         MOVREF    BEGSR                                                              CSW213
      *================================================================                       CSW213
      ** Move to reference DS                                                                 CSW213
      *================================================================                       CSW213
     C                     Z-ADDM3OCDT    RFOCDT  50                                          CSW213
     C                     Z-ADDM3MCDT    RFMCDT  50                                          CSW213
     C                     Z-ADDM3CCSP    RFCCSP  20                                          CSW213
     C                     Z-ADDM3CCLN    RFCCLN  10                                          CSW213
     C                     Z-ADDM3ICSP    RFICSP  20                                          CSW213
     C                     Z-ADDM3ICLN    RFICLN  20                                          CSW213
     C                     Z-ADDM3BBSP    RFBBSP  20                                          CSW213
     C                     Z-ADDM3BBLN    RFBBLN  20                                          CSW213
     C                     Z-ADDM3BISP    RFBISP  20                                          CSW213
     C                     Z-ADDM3BILN    RFBILN  20                                          CSW213
     C                     Z-ADDM3BRSP    RFBRSP  20                                          CSW213
     C                     Z-ADDM3BRLN    RFBRLN  20                                          CSW213
     C                     Z-ADDM3INLN    RFINLN  20                                          CSW213
     C                     Z-ADDM3ACSP    RFACSP  20                                          CSW213
     C                     Z-ADDM3ACLN    RFACLN  20                                          CSW213
     C                     Z-ADDM3TBLN    RFTBLN  20                                          CSW213
     C                     Z-ADDM3TILN    RFTILN  20                                          CSW213
      *================================================================                       CSW213
     CSR         EXMREF    ENDSR                                                              CSW213
      /EJECT                                                                                  CSW213
     C           RTVREF    BEGSR                                                              CSW213
      *================================================================                       CSW213
      ** Move to MEISOCPD fields                                                              CSW213
      *================================================================                       CSW213
     C                     Z-ADDRFOCDT    M3OCDT                                              CSW213
     C                     Z-ADDRFMCDT    M3MCDT                                              CSW213
     C                     Z-ADDRFCCSP    M3CCSP                                              CSW213
     C                     Z-ADDRFCCLN    M3CCLN                                              CSW213
     C                     Z-ADDRFICSP    M3ICSP                                              CSW213
     C                     Z-ADDRFICLN    M3ICLN                                              CSW213
     C                     Z-ADDRFBBSP    M3BBSP                                              CSW213
     C                     Z-ADDRFBBLN    M3BBLN                                              CSW213
     C                     Z-ADDRFBISP    M3BISP                                              CSW213
     C                     Z-ADDRFBILN    M3BILN                                              CSW213
     C                     Z-ADDRFBRSP    M3BRSP                                              CSW213
     C                     Z-ADDRFBRLN    M3BRLN                                              CSW213
     C                     Z-ADDRFINLN    M3INLN                                              CSW213
     C                     Z-ADDRFACSP    M3ACSP                                              CSW213
     C                     Z-ADDRFACLN    M3ACLN                                              CSW213
     C                     Z-ADDRFTBLN    M3TBLN                                              CSW213
     C                     Z-ADDRFTILN    M3TILN                                              CSW213
      *================================================================                       CSW213
     C           EXRREF    ENDSR                                                              CSW213
      /EJECT                                                                                  CSW213
     CSR         SPCLDF    BEGSR                                                              CSW213
      *================================================================                       CSW213
      ** Reset ME1740D1 screen for use                                                        CSW213
      *================================================================                       CSW213
     C                     MOVE ##USR     WUSR   10                                           CSW213
     C                     MOVE SMRDT     WMRD    7                                           CSW213
     C                     MOVE ##JOB     WJOB   10                                           CSW213
     C                     MOVE STIME     WTIM    60                                          CSW213
     C                     CLEARME1740D1                                                      CSW213
     C                     CLEARWDBRC                                                         CSW213
     C                     MOVE WUSR      ##USR                                               CSW213
     C                     MOVE WMRD      SMRDT                                               CSW213
     C                     MOVE WJOB      ##JOB                                               CSW213
     C                     MOVE WTIM      STIME                                               CSW213
      *                                                                                       CSW213
     C                     EXSR SRSIND                                                        CSW213
      *                                                                                       CSW213
     C                     Z-ADD0         ZTILN                                               CSW213
     C                     Z-ADD0         ZBBSP                                               CSW213
     C                     Z-ADD0         ZBBLN                                               CSW213
     C                     Z-ADD0         ZCCSP                                               CSW213
     C                     Z-ADD0         ZCCLN                                               CSW213
     C                     Z-ADD0         ZICSP                                               CSW213
     C                     Z-ADD0         ZICLN                                               CSW213
     C                     Z-ADD0         ZBISP                                               CSW213
     C                     Z-ADD0         ZBILN                                               CSW213
     C                     Z-ADD0         ZBRSP                                               CSW213
     C                     Z-ADD0         ZBRLN                                               CSW213
     C                     Z-ADD0         ZTBLN                                               CSW213
     C                     Z-ADD0         ZINLN                                               CSW213
     C                     Z-ADD0         ZACSP                                               CSW213
     C                     Z-ADD0         ZACLN                                               CSW213
     C                     Z-ADD0         ZOCDT                                               CSW213
     C                     Z-ADD0         ZMCDT                                               CSW213
      *                                                                                       CSW213
     C                     MOVE *BLANKS   WSIBAR                                              CSW213
     C                     MOVE *BLANKS   WSOCDT                                              CSW213
     C                     MOVE *BLANKS   WSMCDT                                              CSW213
     C                     MOVE *BLANKS   WSCCSP                                              CSW213
     C                     MOVE *BLANKS   WSCCLN                                              CSW213
     C                     MOVE *BLANKS   WSICSP                                              CSW213
     C                     MOVE *BLANKS   WSICLN                                              CSW213
     C                     MOVE *BLANKS   WSBBSP                                              CSW213
     C                     MOVE *BLANKS   WSBBLN                                              CSW213
     C                     MOVE *BLANKS   WSBISP                                              CSW213
     C                     MOVE *BLANKS   WSBILN                                              CSW213
     C                     MOVE *BLANKS   WSBRSP                                              CSW213
     C                     MOVE *BLANKS   WSBRLN                                              CSW213
     C                     MOVE *BLANKS   WSINLN                                              CSW213
     C                     MOVE *BLANKS   WSACSP                                              CSW213
     C                     MOVE *BLANKS   WSACLN                                              CSW213
     C                     MOVE *BLANKS   WSTBLN                                              CSW213
     C                     MOVE *BLANKS   WSTILN                                              CSW213
     C                     MOVE *BLANKS   WZACSP                                              CSW213
     C                     MOVE *BLANKS   WZACLN                                              CSW213
     C                     MOVE *BLANKS   WZBISP                                            MD022295
     C                     MOVE *BLANKS   WZBILN                                            MD022295
     C                     MOVE *BLANKS   WZBRSP                                            MD022295
     C                     MOVE *BLANKS   WZBRLN                                            MD022295
     C                     MOVE *BLANKS   WZINLN                                            MD022295
      *================================================================                       CSW213
     CSR         EXCLDF    ENDSR                                                              CSW213
      /EJECT                                                                                  CSW213
     CSR         SRSIND    BEGSR                                                              CSW213
      *================================================================                       CSW213
      ** Reset indicators for ME1740D1                                                        CSW213
      *================================================================                       CSW213
     C                     MOVEA'00'      *IN,32                                              CSW213
     C**********           MOVEA'010'     *IN,36                                     CSW213 MD023077
     C                     MOVE '0'       *IN36                                             MD023077
     C                     MOVE '0'       *IN38                                             MD023077
     C                     MOVEA'00'      *IN,41                                              CSW213
     C                     MOVEA'000000'  *IN,44                                              CSW213
     C                     MOVEA'00000000'*IN,52                                              CSW213
     C                     MOVEA'00000000'*IN,61                                              CSW213
     C                     MOVE *OFF      *IN67                                               CSW213
     C                     MOVEA'00'      *IN,71                                              CSW213
      *================================================================                       CSW213
     CSR         EXSIND    ENDSR                                                              CSW213
      /EJECT                                                                                  CSW213
     CSR         SLSFFB    BEGSR                                                              CSW213
      *================================================================                       CSW213
      ** Alternate SRLSFF routine                                                             CSW213
      *================================================================                       CSW213
      ** Move MEISOCL1 fields to subfile                                                      CSW213
      *================================================================                       CSW213
     C                     MOVELM3ACJN    SACJN                                               CSW213
     C                     MOVELM3ACUN    SACUN                                               CSW213
     C                     MOVELM3ACTM    SACTM                                               CSW213
     C                     MOVELM3ACDA    SACDA                                               CSW213
     C                     MOVELM3ACTY    SACTY                                               CSW213
     C                     MOVELM3ISOC    SISOC                                               CSW213
     C                     MOVELM3ISOD    SISOD                                               CSW213
     C                     MOVELM3SCHT    SSCHT                                               CSW213
     C                     MOVELM3EEAM    SSEEA                                               CSW213
     C                     MOVELM3FATF    SFATF                                               CSW213
     C                     MOVELM3IBAC    SIBAC                                               CSW213
      *                                                                                       CSW213
     C           CSW207    IFEQ 'Y'                                                           CSW213
     C                     MOVELM3MFID    SMFID                                               CSW213
     C                     ENDIF                                                              CSW213
      *                                                                                       CSW213
     C           CSW209    IFEQ 'Y'                                                           CSW213
     C                     MOVELM3M205    SM205                                               CSW213
     C                     ENDIF                                                              CSW213
      *================================================================                       CSW213
     CSR         EXLSFB    ENDSR                                                              CSW213
      /EJECT                                                                                  CSW213
     CSR         SISFFB    BEGSR                                                              CSW213
      *================================================================                       CSW213
      ** Alternate SRISFF routine                                                             CSW213
      *================================================================                       CSW213
      ** Initialise subfile fields                                                            CSW213
      *================================================================                       CSW213
     C                     MOVE *BLANKS   SDBRC                                               CSW213
     C                     MOVE *BLANKS   SCSEL                                               CSW213
     C                     MOVE *BLANKS   SACJN                                               CSW213
     C                     MOVE *BLANKS   SACUN                                               CSW213
     C                     MOVE *BLANKS   SACTM                                               CSW213
     C                     MOVE *BLANKS   SACDA                                               CSW213
     C                     MOVE *BLANKS   SACTY                                               CSW213
     C                     MOVE *BLANKS   SISOC                                               CSW213
     C                     MOVE *BLANKS   SISOD                                               CSW213
     C                     MOVE *BLANKS   SSCHT                                               CSW213
     C                     MOVE *BLANKS   SSEEA                                               CSW213
     C                     MOVE *BLANKS   SFATF                                               CSW213
     C                     MOVE *BLANKS   SIBAC                                               CSW213
      *                                                                                       CSW213
     C           CSW207    IFEQ 'Y'                                                           CSW213
     C                     MOVE *BLANKS   SMFID                                               CSW213
     C                     ENDIF                                                              CSW213
     C           CSW209    IFEQ 'Y'                                                           CSW213
     C                     MOVE *BLANKS   SM205                                               CSW213
     C                     ENDIF                                                              CSW213
      *================================================================                       CSW213
     CSR         EXISFB    ENDSR                                                              CSW213
      /EJECT                                                                                  CSW213
     CSR         CHKCHG    BEGSR                                                              CSW213
      *================================================================                       CSW213
      ** Change for screen changes                                                            CSW213
      *================================================================                       CSW213
     C                     MOVE 'N'       WCHG    1                                           CSW213
     C           SOCDT     IFNE WSOCDT                                                        CSW213
     C           SMCDT     ORNE WSMCDT                                                        CSW213
     C           SCCSP     ORNE WSCCSP                                                        CSW213
     C           SCCLN     ORNE WSCCLN                                                        CSW213
     C           SICSP     ORNE WSICSP                                                        CSW213
     C           SICLN     ORNE WSICLN                                                        CSW213
     C           SBBSP     ORNE WSBBSP                                                        CSW213
     C           SBBLN     ORNE WSBBLN                                                        CSW213
     C           SBISP     ORNE WSBISP                                                        CSW213
     C           SBILN     ORNE WSBILN                                                        CSW213
     C           SBRSP     ORNE WSBRSP                                                        CSW213
     C           SBRLN     ORNE WSBRLN                                                        CSW213
     C           SINLN     ORNE WSINLN                                                        CSW213
     C           SACSP     ORNE WSACSP                                                        CSW213
     C           SACLN     ORNE WSACLN                                                        CSW213
     C           STBLN     ORNE WSTBLN                                                        CSW213
     C           STILN     ORNE WSTILN                                                        CSW213
     C                     MOVE 'Y'       WCHG                                                CSW213
     C                     ENDIF                                                              CSW213
      *================================================================                       CSW213
     CSR         EXKCHG    ENDSR                                                              CSW213
      /EJECT                                                                                  CSW213
     CSR         SRINIT    BEGSR
      *================================================================
      ** Initialisation
      *================================================================
     C                     MOVEACPY@      CPY2@  80
      *
      ** Entry parameters
      *
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C                     PARM           PMMODE  1
     C                     PARM           PMISOC  2                                           CSW213
      *
      ** Update LDA with initial values for DB error fields
      *
     C           *NAMVAR   DEFN LDA       WLDA
     C           *LOCK     IN   WLDA
     C                     MOVE *BLANKS   DBFILE
     C                     MOVE *BLANKS   DBKEY
     C                     MOVEL'ME1740'  DBPGM
     C                     OUT  WLDA
      *
      ** Update Screen Time
      *
     C                     TIME           STIME   60
      *
      ** Get Bank's Details
      *
     C                     CALL 'AOBANKR0'
     C                     PARM *BLANKS   P@RTCD  7
     C                     PARM '*FIRST  'P@OPTN  7
     C           SDBANK    PARM SDBANK    DSFDY
      *
      *  If return with an error (LR seton in called program) then
      *  process for database error.
      *
     C           P@RTCD    IFNE *BLANK
     C           *LOCK     IN   WLDA
     C                     MOVEL'*FIRST'  DBKEY
     C                     MOVEL'SDBANKPD'DBFILE
     C                     Z-ADD001       DBASE
     C                     OUT  WLDA
     C                     EXSR *PSSR
     C                     ENDIF
      *
      ** Get Midas Rundate
      *
     C                     MOVE BJMRDT    SMRDT   7
      *
     C                     Z-ADD14        WSFPG   30
     C                     Z-ADD1         SSFRC
      *
      ** Maximum record number
      *
     C                     Z-ADD*ZERO     WRRN
      *
      ** Scan limit
      *
     C                     Z-ADD500       W0SLM   50
      *
      ** Subfile pages
      *
     C                     Z-ADD1         W0SPG   30
     C                     Z-ADD0         W0RR0   40
     C                     EXSR SRCLR
     C                     Z-ADD14        WSFLN   50
     C           PMMODE    IFEQ 'E'
      *
      ** Setup header text:
      *
     C                     MOVEL'USR9103' PMSGID  7        Message Identifier
     C                     MOVEL'SDUSRMSG'PMSGF  10
     C                     MOVE *BLANKS   PMSGT  80
     C                     CALL 'SDRTVTXT'             90  Retrieve MSGF message
     C           PMSGID    PARM PMSGID    WQ0286  7        Message Identifier
     C           PMSGF     PARM PMSGF     WQ0287 10        Message File Name
     C           PMSGT     PARM PMSGT     WQ0288 80        Message Text
     C                     MOVELPMSGT     SURPT
      *
     C                     MOVE *BLANKS   PMSGT  80
     C                     MOVEL'USR3353' PMSGID  7        Message Identifier
     C                     CALL 'SDRTVTXT'             90  Retrieve MSGF message
     C           PMSGID    PARM PMSGID    KE0286  7        Message Identifier
     C           PMSGF     PARM PMSGF     KE0287 10        Message File Name
     C           PMSGT     PARM PMSGT     KE0288 80        Message Text
     C                     MOVELPMSGT     SCTX1
      *
     C                     MOVE *BLANKS   WTXTE  80                                           CSW213
     C                     MOVE *BLANKS   WTXTE1 80                                           CSW213
      *                                                                                       CSW213
     C                     MOVE *BLANKS   PMSGT  80                                           CSW213
     C                     MOVEL'USR2920' PMSGID                                              CSW213
      *                                                                                       CSW213
     C                     CALL 'SDRTVTXT'             90                                     CSW213
     C           PMSGID    PARM PMSGID    KE0286  7                                           CSW213
     C           PMSGF     PARM PMSGF     KE0287 10                                           CSW213
     C           PMSGT     PARM PMSGT     KE0288 80                                           CSW213
     C                     MOVELPMSGT     WTXTE                                               CSW213
      *                                                                                       CSW213
     C                     MOVE *BLANKS   PMSGT  80                                           CSW213
     C                     MOVEL'USR9020' PMSGID                                              CSW213
      *                                                                                       CSW213
     C                     CALL 'SDRTVTXT'             90                                     CSW213
     C           PMSGID    PARM PMSGID    KE0286  7                                           CSW213
     C           PMSGF     PARM PMSGF     KE0287 10                                           CSW213
     C           PMSGT     PARM PMSGT     KE0288 80                                           CSW213
     C                     MOVELPMSGT     WTXTE1                                              CSW213
      *                                                                                       CSW213
     C                     ELSE
      *
     C                     MOVEL'SDUSRMSG'PMSGF  10
     C                     MOVE *BLANKS   PMSGT  80
      *
     C                     MOVEL'USR9104' PMSGID  7        Message Identifier
     C                     CALL 'SDRTVTXT'             90  Retrieve MSGF message
     C           PMSGID    PARM PMSGID    WQ0286  7        Message Identifier
     C           PMSGF     PARM PMSGF     WQ0287 10        Message File Name
     C           PMSGT     PARM PMSGT     WQ0288 80        Message Text
     C                     MOVELPMSGT     SURPT
      *
     C                     MOVE *BLANKS   WTXTC  80
     C                     MOVE *BLANKS   WTXTA  80
     C                     MOVE *BLANKS   WTXTE  80                                           CSW213
     C                     MOVE *BLANKS   WTXTD  80                                           CSW213
     C                     MOVE *BLANKS   WTXTU  80                                           CSW213
     C                     MOVE *BLANKS   NFCNTY 80                                           CSW213
     C                     MOVE *BLANKS   PMSGT  80
     C                     MOVEL'USR3348' PMSGID           Message Identifier
      *
     C                     CALL 'SDRTVTXT'             90  Retrieve MSGF message
     C           PMSGID    PARM PMSGID    KE0286  7        Message Identifier
     C           PMSGF     PARM PMSGF     KE0287 10        Message File Name
     C           PMSGT     PARM PMSGT     KE0288 80        Message Text
     C                     MOVELPMSGT     WTXTC
      *
     C                     MOVE *BLANKS   PMSGT  80
     C                     MOVEL'USR9102' PMSGID           Message Identifier
      *
     C                     CALL 'SDRTVTXT'             90  Retrieve MSGF message
     C           PMSGID    PARM PMSGID    KE0286  7        Message Identifier
     C           PMSGF     PARM PMSGF     KE0287 10        Message File Name
     C           PMSGT     PARM PMSGT     KE0288 80        Message Text
     C                     MOVELPMSGT     WTXTA
      *                                                                                       CSW213
     C                     MOVE *BLANKS   PMSGT  80                                           CSW213
     C                     MOVEL'USR4330' PMSGID                                              CSW213
      *                                                                                       CSW213
     C                     CALL 'SDRTVTXT'             90                                     CSW213
     C           PMSGID    PARM PMSGID    KE0286  7                                           CSW213
     C           PMSGF     PARM PMSGF     KE0287 10                                           CSW213
     C           PMSGT     PARM PMSGT     KE0288 80                                           CSW213
     C                     MOVELPMSGT     WTXTD                                               CSW213
      *                                                                                       CSW213
     C                     MOVE *BLANKS   PMSGT  80                                           CSW213
     C                     MOVEL'USR2920' PMSGID                                              CSW213
      *                                                                                       CSW213
     C                     CALL 'SDRTVTXT'             90                                     CSW213
     C           PMSGID    PARM PMSGID    KE0286  7                                           CSW213
     C           PMSGF     PARM PMSGF     KE0287 10                                           CSW213
     C           PMSGT     PARM PMSGT     KE0288 80                                           CSW213
     C                     MOVELPMSGT     WTXTE                                               CSW213
      *                                                                                       CSW213
     C                     MOVE *BLANKS   PMSGT  80                                           CSW213
     C                     MOVEL'USR9020' PMSGID                                              CSW213
      *                                                                                       CSW213
     C                     CALL 'SDRTVTXT'             90                                     CSW213
     C           PMSGID    PARM PMSGID    KE0286  7                                           CSW213
     C           PMSGF     PARM PMSGF     KE0287 10                                           CSW213
     C           PMSGT     PARM PMSGT     KE0288 80                                           CSW213
     C                     MOVELPMSGT     WTXTE1                                              CSW213
      *                                                                                       CSW213
     C                     MOVE *BLANKS   PMSGT  80                                           CSW213
     C                     MOVEL'USR0640' PMSGID                                              CSW213
      *                                                                                       CSW213
     C                     CALL 'SDRTVTXT'             90                                     CSW213
     C           PMSGID    PARM PMSGID    KE0286  7                                           CSW213
     C           PMSGF     PARM PMSGF     KE0287 10                                           CSW213
     C           PMSGT     PARM PMSGT     KE0288 80                                           CSW213
     C                     MOVELPMSGT     NFCNTY                                              CSW213
      *                                                                                       CSW213
     C                     MOVE *BLANKS   PMSGT  80                                           CSW213
     C                     MOVEL'GBY2USR' PMSFT  10                                           CSW213
     C                     MOVE 'MSG'     PMSFT                                               CSW213
     C                     MOVEL'Y2U0406' PMSGID                                              CSW213
      *                                                                                       CSW213
     C                     CALL 'SDRTVTXT'             90                                     CSW213
     C           PMSGID    PARM PMSGID    KE0286  7                                           CSW213
     C           PMSFT     PARM PMSFT     KE0287 10                                           CSW213
     C           PMSGT     PARM PMSGT     KE0288 80                                           CSW213
     C                     MOVELPMSGT     WTXTU                                               CSW213
      *                                                                                       CSW213
     C                     ENDIF
      *                                                                                       CFT017
      ** Call access object to find out if switchable feature CFT017 is installed             CFT017
      *                                                                                       CFT017
     C                     MOVEL'N'       CFT017  1                                           CFT017
     C                     MOVEL*OFF      *IN37                                               CFT017
     C                     CALL 'AOSARDR0'                                                    CFT017
     C                     PARM *BLANKS   @RTCD   7                                           CFT017
     C                     PARM '*VERIFY' @OPTN   7                                           CFT017
     C                     PARM 'CFT017'  @SARD   6                                           CFT017
     C           SCSARD    PARM SCSARD    DSFDY                                               CFT017
      *                                                                                       CFT017
     C           @RTCD     IFNE *BLANKS                                                       CFT017
     C           @RTCD     ANDNE'*NRF'                                                        CFT017
     C           *LOCK     IN   WLDA                                                          CFT017
     C                     MOVEL'CFT017'  DBKEY                                               CFT017
     C                     MOVEL'SCSARDPD'DBFILE                                              CFT017
     C                     Z-ADD002       DBASE                                               CFT017
     C                     OUT  WLDA                                                          CFT017
     C                     EXSR *PSSR                                                         CFT017
     C                     ELSE                                                               CFT017
      *                                                                                       CFT017
     C           @RTCD     IFEQ *BLANKS                                                       CFT017
     C                     MOVEL'Y'       CFT017                                              CFT017
     C                     MOVE *ON       *IN37                                               CFT017
     C                     ENDIF                                                              CFT017
      *                                                                                       CFT017
     C                     ENDIF                                                              CFT017
      *                                                                                       CSW207
      ** Call SWIFT200 to find out if switchable feature CSW207 is installed                  CSW207
      *                                                                                       CSW207
     C                     CALL 'SWIF2007'                                                    CSW207
     C                     PARM *BLANKS   P@RTCD                                              CSW207
      *                                                                                       CSW207
     C           P@RTCD    IFEQ 'CSW2007'                                                     CSW207
     C                     MOVE 'Y'       CSW207  1                                           CSW207
     C                     MOVE *ON       *IN39                                               CSW207
     C                     ELSE                                                               CSW207
     C**********           MOVE 'Y'       CSW207                                     CSW207 BUG14933
     C                     MOVE 'N'       CSW207                                            BUG14933
     C                     MOVE *OFF      *IN39                                               CSW207
     C                     ENDIF                                                              CSW207
      ** Check if SWIFT 2009 is installed                                                     CSW209
      *                                                                                       CSW209
     C                     CALL 'SWIF2009'                                                    CSW209
     C                     PARM           P@RTCD                                              CSW209
     C           P@RTCD    IFEQ 'CSW2009'                                                     CSW209
     C                     MOVE 'Y'       CSW209  1                                           CSW209
     C                     MOVE *ON       *IN43                                               CSW209
     C                     ELSE                                                               CSW209
     C                     MOVE *OFF      *IN43                                               CSW209
     C                     ENDIF                                                              CSW209
      *
      ** Check if SWIFT 2013 is installed                                                     CSW213
      *                                                                                       CSW213
     C                     CALL 'SWIF2013'                                                    CSW213
     C                     PARM           P@RTCD                                              CSW213
     C           P@RTCD    IFEQ 'CSW2013'                                                     CSW213
     C                     MOVE 'Y'       CSW213  1                                           CSW213
     C                     ELSE                                                               CSW213
     C                     MOVE 'N'       CSW213  1                                           CSW213
     C                     ENDIF                                                              CSW213
      *                                                                                       CSW213
      ** Check if CFT004 is installed                                                         CSW213
      *                                                                                       CSW213
     C                     MOVEL'N'       CFT004  1                                           CSW213
     C                     CALL 'AOSARDR0'                                                    CSW213
     C                     PARM *BLANKS   @RTCD                                               CSW213
     C                     PARM '*VERIFY' @OPTN                                               CSW213
     C                     PARM 'CFT004'  @SARD                                               CSW213
     C           SCSARD    PARM SCSARD    DSFDY                                               CSW213
      *                                                                                       CSW213
     C           @RTCD     IFNE *BLANKS                                                       CSW213
     C           @RTCD     ANDNE'*NRF'                                                        CSW213
     C           *LOCK     IN   WLDA                                                          CSW213
     C                     MOVEL'CFT004'  DBKEY                                               CSW213
     C                     MOVEL'SCSARDPD'DBFILE                                              CSW213
     C                     Z-ADD002       DBASE                                               CSW213
     C                     OUT  WLDA                                                          CSW213
     C                     EXSR *PSSR                                                         CSW213
     C                     ELSE                                                               CSW213
      *                                                                                       CSW213
     C           @RTCD     IFEQ *BLANKS                                                       CSW213
     C                     MOVEL'Y'       CFT004                                              CSW213
     C                     ENDIF                                                              CSW213
      *                                                                                       CSW213
     C                     ENDIF                                                              CSW213
      *                                                                                       CSW213
      ** Check if CFT050 is installed                                                         CSW213
      *                                                                                       CSW213
     C                     MOVEL'N'       CFT050  1                                           CSW213
     C                     CALL 'AOSARDR0'                                                    CSW213
     C                     PARM *BLANKS   @RTCD                                               CSW213
     C                     PARM '*VERIFY' @OPTN                                               CSW213
     C                     PARM 'CFT050'  @SARD                                               CSW213
     C           SCSARD    PARM SCSARD    DSFDY                                               CSW213
      *                                                                                       CSW213
     C           @RTCD     IFNE *BLANKS                                                       CSW213
     C           @RTCD     ANDNE'*NRF'                                                        CSW213
     C           *LOCK     IN   WLDA                                                          CSW213
     C                     MOVEL'CFT050'  DBKEY                                               CSW213
     C                     MOVEL'SCSARDPD'DBFILE                                              CSW213
     C                     Z-ADD002       DBASE                                               CSW213
     C                     OUT  WLDA                                                          CSW213
     C                     EXSR *PSSR                                                         CSW213
     C                     ELSE                                                               CSW213
      *                                                                                       CSW213
     C           @RTCD     IFEQ *BLANKS                                                       CSW213
     C                     MOVEL'Y'       CFT050                                              CSW213
     C                     ENDIF                                                              CSW213
      *                                                                                       CSW213
     C                     ENDIF                                                              CSW213
      *                                                                                       CFT051
      ** Check if CFT051 is installed                                                         CFT051
      *                                                                                       CFT051
     C                     MOVEL'N'       CFT051  1                                           CFT051
     C                     CALL 'AOSARDR0'                                                    CFT051
     C                     PARM *BLANKS   @RTCD                                               CFT051
     C                     PARM '*VERIFY' @OPTN                                               CFT051
     C                     PARM 'CFT051'  @SARD                                               CFT051
     C           SCSARD    PARM SCSARD    DSFDY                                               CFT051
      *                                                                                       CFT051
     C           @RTCD     IFNE *BLANKS                                                       CFT051
     C           @RTCD     ANDNE'*NRF'                                                        CFT051
     C           *LOCK     IN   WLDA                                                          CFT051
     C                     MOVEL'CFT051'  DBKEY                                               CFT051
     C                     MOVEL'SCSARDPD'DBFILE                                              CFT051
     C                     Z-ADD003       DBASE                                               CFT051
     C                     OUT  WLDA                                                          CFT051
     C                     EXSR *PSSR                                                         CFT051
     C                     ELSE                                                               CFT051
      *                                                                                       CFT051
     C           @RTCD     IFEQ *BLANKS                                                       CFT051
     C                     MOVEL'Y'       CFT051                                              CFT051
     C                     ENDIF                                                              CFT051
      *                                                                                       CFT051
     C                     ENDIF                                                              CFT051
      *                                                                                       CSW213
      ** Check if CFT008 is installed                                                         CSW213
      *                                                                                       CSW213
     C                     MOVEL'N'       CFT008  1                                           CSW213
     C                     CALL 'AOSARDR0'                                                    CSW213
     C                     PARM *BLANKS   @RTCD                                               CSW213
     C                     PARM '*VERIFY' @OPTN                                               CSW213
     C                     PARM 'CFT008'  @SARD                                               CSW213
     C           SCSARD    PARM SCSARD    DSFDY                                               CSW213
      *                                                                                       CSW213
     C           @RTCD     IFNE *BLANKS                                                       CSW213
     C           @RTCD     ANDNE'*NRF'                                                        CSW213
     C           *LOCK     IN   WLDA                                                          CSW213
     C                     MOVEL'CFT008'  DBKEY                                               CSW213
     C                     MOVEL'SCSARDPD'DBFILE                                              CSW213
     C                     Z-ADD002       DBASE                                               CSW213
     C                     OUT  WLDA                                                          CSW213
     C                     EXSR *PSSR                                                         CSW213
     C                     ELSE                                                               CSW213
      *                                                                                       CSW213
     C           @RTCD     IFEQ *BLANKS                                                       CSW213
     C                     MOVEL'Y'       CFT008                                              CSW213
     C                     MOVE *ON       *IN74                                               CSW213
     C                     ENDIF                                                              CSW213
      *                                                                                       CSW213
     C                     ENDIF                                                              CSW213
      *                                                                                       CSW213
      ** Initialization definitions                                                           CSW213
      *                                                                                       CSW213
     C           KPOS      KLIST                                                              CSW213
     C                     KFLD           M3ISOC                                              CSW213
      *                                                                                       CSW213
     C           KSYNC     KLIST                                                              CSW213
     C                     KFLD           WIBAC                                               CSW213
      *                                                                                       CSW213
     C           *LIKE     DEFN SEISOC    WZISOC                                              CSW213
     C           *LIKE     DEFN M3ISOC    WISOC                                               CSW213
     C           *LIKE     DEFN M3ISOC    NRISOC                                              CSW213
     C           *LIKE     DEFN M3IBAC    WIBAC                                               CSW213
     C           *LIKE     DEFN M3IBAC    RFIBAC                                              CSW213
     C           *LIKE     DEFN SIBAR     WSIBAR                                              CSW213
     C           *LIKE     DEFN SOCDT     WSOCDT                                              CSW213
     C           *LIKE     DEFN SMCDT     WSMCDT                                              CSW213
     C           *LIKE     DEFN SCCSP     WSCCSP                                              CSW213
     C           *LIKE     DEFN SCCLN     WSCCLN                                              CSW213
     C           *LIKE     DEFN SICSP     WSICSP                                              CSW213
     C           *LIKE     DEFN SICLN     WSICLN                                              CSW213
     C           *LIKE     DEFN SBBSP     WSBBSP                                              CSW213
     C           *LIKE     DEFN SBBLN     WSBBLN                                              CSW213
     C           *LIKE     DEFN SBISP     WSBISP                                              CSW213
     C           *LIKE     DEFN SBILN     WSBILN                                              CSW213
     C           *LIKE     DEFN SBRSP     WSBRSP                                              CSW213
     C           *LIKE     DEFN SBRLN     WSBRLN                                              CSW213
     C           *LIKE     DEFN SINLN     WSINLN                                              CSW213
     C           *LIKE     DEFN SACSP     WSACSP                                              CSW213
     C           *LIKE     DEFN SACLN     WSACLN                                              CSW213
     C           *LIKE     DEFN STBLN     WSTBLN                                              CSW213
     C           *LIKE     DEFN STILN     WSTILN                                              CSW213
     C           *LIKE     DEFN SACSP     WZACSP                                              CSW213
     C           *LIKE     DEFN SACLN     WZACLN                                              CSW213
     C           *LIKE     DEFN SBISP     WZBISP                                            MD022295
     C           *LIKE     DEFN SBILN     WZBILN                                            MD022295
     C           *LIKE     DEFN SBRSP     WZBRSP                                            MD022295
     C           *LIKE     DEFN SBRLN     WZBRLN                                            MD022295
     C           *LIKE     DEFN SINLN     WZINLN                                            MD022295
      *                                                                                       CSW213
     C                     Z-ADD99999     W0SLM
     C                     MOVE *BLANKS   WMODE   3
     C           CSW213    IFNE 'Y'                                                           CSW213
     C           CFT050    ANDNE'Y'                                                           CSW213
     C                     MOVEL'CHG'     WMODE
     C                     ELSE                                                               CSW213
     C                     MOVE 'LST'     WMODE                                               CSW213
      *                                                                                       CSW213
      ** Allow IBAN Structure field to be displayed                                           CSW213
      *                                                                                       CSW213
     C           CFT004    IFEQ 'Y'                                                           CSW213
     C           CFT050    IFEQ 'Y'                                                           CSW213
     C           CSW213    OREQ 'Y'                                                           CSW213
     C                     MOVE 'Y'       WIBNS   1                                           CSW213
     C                     MOVE *ON       *IN69                                               CSW213
     C                     ELSE                                                               CSW213
     C                     MOVE *OFF      *IN69                                               CSW213
     C                     ENDIF                                                              CSW213
     C                     ENDIF                                                              CSW213
      *                                                                                     MD022777
      ** IBAN Required in MT102/MT103 field to be displayed                                 MD022777
      *                                                                                     MD022777
     C           CFT004    IFEQ 'Y'                                                         MD022777
     C           CSW213    ANDEQ'Y'                                                         MD022777
     C**********           MOVE *ON       *IN70                                    MD022777 MD022942
     C                     MOVE *ON       *IN75                                             MD022942
     C                     ELSE                                                             MD022777
     C**********           MOVE *OFF      *IN70                                    MD022777 MD022942
     C                     MOVE *OFF      *IN75                                             MD022942
     C                     ENDIF                                                            MD022777
      *                                                                                       CSW213
      ** Overwrite for WTXTC                                                                  CSW213
      *                                                                                       CSW213
     C                     MOVE *BLANKS   PMSGT  80                                           CSW213
     C                     MOVEL'USR0101' PMSGID                                              CSW213
      *                                                                                       CSW213
     C                     CALL 'SDRTVTXT'             90                                     CSW213
     C           PMSGID    PARM PMSGID    KE0286  7                                           CSW213
     C           PMSGF     PARM PMSGF     KE0287 10                                           CSW213
     C           PMSGT     PARM PMSGT     KE0288 80                                           CSW213
     C                     MOVELPMSGT     WTXTC                                               CSW213
      *                                                                                       CSW213
     C                     ENDIF                                                              CSW213
      *================================================================
     CSR         EXINIT    ENDSR
      /EJECT
     CSR         *PSSR     BEGSR
      *================================================================
      ** Standard db error processing
      *================================================================
      *
     C/COPY SDCPYSRC,SDPSSRINT
      *
      *================================================================
     CSR         EXPSSR    ENDSR
      /COPY ZSRSRC,ZDATE1Z2                                                                   CSW213
      /COPY ZSRSRC,ZDATE2Z2                                                                   CSW213
      /COPY ZSRSRC,ZALIGNZ2                                                                   CSW213
      /COPY ZSRSRC,ZEDITZ2                                                                    CSW213
** CPY@     : Copyright notice for inclusion in all programs
(c) Finastra International Limited 2001
**   ZYDY - YEARS IN DAYS CUMULATIVE IN FOUR YEAR SPAN                                        CSW213
0366073110961461                                                                              CSW213
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR                                            CSW213
000031059090120151181212243273304334365                                                       CSW213
**   ZMNM - MONTHS SHORT NAMES                                                                CSW213
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC                                                          CSW213
