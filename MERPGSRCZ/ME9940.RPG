     H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas ME Check settlements account line')              *
      *****************************************************************
      *                                                               *
      *  Midas - Message Management Module                            *
      *                                                               *
      *  ME9940 - Check Settlements Account Line                      *
      *                                                               *
      *  Function:  This program handles the validation of Clearing   *
      *             Systems used in settlement instructions           *
      *                                                               *
      *  Called By: SD2410 - Extended Settlement Instructions         *
      *                                                               *
      *  (c) Finastra International Limited 2001                      *
      *                                                               *
      *  Last Amend No. MD046248           Date 27Oct17               *
      *  Prev Amend No. MD035349           Date 06Aug15               *
      *                 MD034498           Date 25May15               *
      *                 CSW215             Date 06Apr15               *
      *                 MD031218           Date 05Nov14               *
      *                 261796             Date 19Aug14               *
      *                 MD023689           Date 21Nov13               *
      *                 MD022836           Date 13Oct13               *
      *                 CSW213             Date 03Jun13               *
      *                 AR589197           Date 11Aug10               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      *                 154474             Date 08Dec06               *
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CSW206A            Date 30Aug06               *
      *                 CSW206             Date 03Jul06               *
      *                 235725             Date 05Aug05               *
      *                 CSD031             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 CSW037A            Date 02May05               *
      *                 CSD025             Date 11Jan05               *
      *                 CSD024             Date 07Dec04               *
      *                 BUG5638            Date 03Dec04               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 CLE025             Date 20Oct03               *
      *                 CSC022             Date 24Feb04               *
      *                 CGL029             Date 01Sep03               *
      *                 222373             Date 27Oct03               *
      * Midas Release 4.01.02 ----------------------------------------*
      *                 195588             Date 23Sep02               *
      * Midas Release 4.01.01 ----------------------------------------*
      *                 CSW202             Date 20May02               *
      * Midas Release 4 --------------- Base -------------------------*
      *                 CSW201             Date 02May01               *
      * Midas DBA 3.04 -----------------------------------------------*
      *                 CFT014             Date 09Oct00               *
      *                 CFT013             Date 09Oct00               *
      * Midas DBA 3.03 -----------------------------------------------*
      *                 184361             DATE 29Sep00               *
      *                 183752             DATE 14Sep00               *
      *                 CSW200             DATE 21Aug00               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 142527             DATE 11SEP98               *
      *                 CSW098             DATE 08APR98               *
      *                 CSW097             Date 26May97               *
      *                 CSW096             Date 04Jun96               *
      *                                    Date ddmmmyy               *
      *                                                               *
      *---------------------------------------------------------------*
      *                                                               *
      *  MD046248 - Finastra Rebranding                               *
      *  MD035349 - BankFusion Midas Error occured upon completion    *
      *             when //RT//CN is entered in Intermediary and      *
      *             Account with Institution fields                   *
      *  MD034498 - Additional validation for //RT//CN allowing       *
      *             CNAPS clearing code for SWIFT 2015 changes        *
      *  CSW215 - SWIFT Changes 2015                                  *
      *  MD031218 - MM deal to Repair queue due Beneficiary a/c line  *
      *  261796 - Include MT103 Routing.                              *
      *  MD023689 - Clearing Identification (10.0) not accepted when  *
      *             Clearing System is IT                             *
      *  MD022836 - Clearing Identification for RU was accepted even  *
      *             though it did not meet the requirement            *
      *  CSW213 - SWIFT Changes 2013                                  *
      *  AR589197 - The input validation of //xx has been removed if  *
      *             ISO15022 is switched on, it should be reapplied   *
      *             as the code is still used                         *
      *  154474 - Include validation for //RT.                        *
      *  CSW206A - No validation for 8 numeric format for the clearing*
      *            code PL                                            *
      *  CSW206 - Swift 2006 Standard Changes                         *
      *  235725 - Dbase 2 AOCNSTR0. Set W9CUST = BLANK not DBASE err  *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  CSD025 - Customer De-Activation                              *
      *  CSD024 - Fedwire Code on Counterparty Maintenance            *
      *  BUG5638- Counterparty access errors                          *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  CLE025 - Credit Lines (Recompile)                            *
      *  CSC022 - Commitment Control Changes for MidasPlus            *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  222373 - Parameter Mismatch                                  *
      *  195588 - Remove the checking of //FW number for customer     *
      *           with Swift id.                                      *
      *  CSW202 - SWIFT 2002 Standards Update                         *
      *  CSW201 - SWIFT 2001 Standards Update                         *
      *  CFT014 - Straight-through processing Phase 2 MT103           *
      *           Messages Generation for FT.                         *
      *  CFT013 - Straight-through processing Phase 2 MT103           *
      *           Messages Generation for non-FT (joint change w/     *
      *           CFT014)                                             *
      *  184361 - Fix //RT call to ME1400                             *
      *  183752 - Fix NZ and ZA clearing code validations             *
      *  CSW200 - SWIFT 2000 Changes                                  *
      *  142527 - SWIFT98 fix - Accept //RT                           *
      *  CSW098 - SWIFT 98 changes.                                   *
      *           Issuer Code to be returned to calling program.      *
      *           Also fix a core error as dbase error is issued      *
      *           for a wrong condition on access to SDCUSTPD.        *
      *  CSW097 - SWIFT Changes November 1997                         *
      *           Add Austrian Clearing System Code '//AT'            *
      *           Add Australian Clearing System Code '//AU'          *
      *  CSW096 - SWIFT Changes November 1996                         *
      *                                                               *
      *****************************************************************
      *                                                               *
      *  Indicator usage                                              *
      *  ~~~~~~~~~~~~~~~                                              *
      *  90    General Error Indicator                                *
      *                                                               *
      *****************************************************************
      /EJECT
      * Initialise Program F-Spec
     F/COPY WNCPYSRC,ME9940DFPG
      /EJECT
     E                    CPY@    1   1 80
      *
      *  Array containing Copyright statement
      ***************** FIRST COMPILE TIME ARRAY *********************
      *
     E                    ERCD       50  3
      *
      *  Error codes array
      *
     E/COPY MECPYSRC,SRERRE
      * Initialise Program E-Spec
     E/COPY WNCPYSRC,ME9940DEPG
      *                                                                                       CSC022
      ** Array of Commitment Job Names                                                        CSC022
     E                    CMTJOB     10 10                                                    CSC022
      /EJECT
      * Initialise Program I-Spec
     I/COPY WNCPYSRC,ME9940DIPG
      * Data structures:
     IJBDTTM      DS
      * Job date/time
     I                                        1   60##JDT
     I                                        1   20##JYY
     I                                        3   40##JMM
     I                                        5   60##JDD
     I                                        7  120##JTM
     I                                        7   80##JHH
     I                                        9  100##JNN
     I                                       11  120##JSS
      *
      *  Copysource for error processing
      *
     I/COPY MECPYSRC,SRERRI
      *
     IRUNDTA    E DSRUNDAT
      *
      * Get Rundate - Rundate  *
      *
     IMMODDS    E DSSDMMODPD
      *
      * Modules Data Structure *
      *
     IDSCCSY    E DSSDCCSYPD
      *
      * Currency Clearing Systems *
      *
     ISDCUST    E DSSDCUSTPD
      *
      *  Calling parameter data structure for AOCUSTR0
      *
     ISDCNST    E DSSDCNSTPD
      *
      *  Calling parameter data structure for ME1400
      *
     IMEBICD    E DSMEBICDPD
      *
      *  Calling parameter data structure for ME1400
      *
     IDSFDY     E DSDSFDY
      *
      * Data Structures used by Access Programs
      *
     IDSSDY     E DSDSSDY
      *
      * Data Structures used by Access Programs
      *
     ISCSARD    E DSSCSARDPD                                                                  CSD024
      *
      * Input Parameters
      *
     I***I#PARM*     DS                            512                                        CGL029
     II#PARM      DS                            514                                           CGL029
      * Field to be validated
     I                                        1   5 I#VFLD
      * Pay/Receive Settlement (PAY/REC)
     I                                        6   8 I#PR
      * Customer/Counterparty Nostro /BIC indentified type
      *    C           X              S  X-> C'party Nostro or Customer
      * Customer/Counterparty/BIC indentified
     I                                        9   9 I#PRTT
     I                                       10  20 I#PRTY
      * Pay Currency
     I                                       21  23 I#PCCY
      * Receive Currency
     I                                       24  26 I#RCCY
      * Account Line
     I                                       27  61 I#ACLN
      * Account Line Character 1
     I                                       27  27 I#ACC1
      * Account Line Character 2
     I                                       28  28 I#ACC2
      * Account Line Character 3
     I                                       29  29 I#ACC3
      * Account Line first 4 characters
     I                                       27  30 I#ACCL
      * Account Line Clearing System
     I                                       29  30 I#ACCS
      * Account Line No account data
     I                                       31  61 I#SPC1
      * Account Line Second Clearing Code                                 CSW200
     I                                       31  34 I#ACSC                CSW200
      * Account Line Second Clearing System                               CSW200
     I                                       33  34 I#ACSS                CSW200
      * Account Line Character 5                                          CSW200
     I                                       31  31 I#ACC5                CSW200
      * Message Type
     I                                       62  64 I#MTYP
      * Intermediary Institution for Bank to Bank validation
     I                                       65  65 I#INBT
     I                                       66  76 I#INBK
      * Account with Institution for Bank to Bank validation
     I                                       77  77 I#AWBT
     I                                       78  88 I#AWBK
      * Beneficiary for Bank to Bank validation
     I                                       89  89 I#BENT
     I                                       90 100 I#BENF
      * Pay and Receive Settlement Methods
     I                                      101 102 I#RSTM
     I                                      103 104 I#PSTM
      * Field 53 and 54 Entered
     I                                      105 105 I#5354
      * Midas Module
     I                                      106 107 I#MMOD
      * Pay and Receive Settlement Accounts
     I**********                            108 125 I#PYAC                                    CGL029
     I**********                            126 143 I#RCAC                                    CGL029
      * Transaction Type
     I                                      144 145 I#TTYP
      * Bank to Bank Information
     I                                      257 466 I#BTB
     I                                      257 291 I#BTB1
     I                                      292 326 I#BTB2
     I                                      327 361 I#BTB3
     I                                      362 396 I#BTB4
     I                                      397 431 I#BTB5
     I                                      432 466 I#BTB6
      * Pay and Receive Settlement Accounts                                                   CGL029
     I                                      467 490 I#PYAC                                    CGL029
     I                                      491 514 I#RCAC                                    CGL029
     I/COPY WNCPYSRC,ME9940I001
      *
      * Output Parameters
      *
     I***O#PARM*     DS                            512                                        CGL029
     IO#PARM      DS                            514                                           CGL029
      * Account Line modified
     I                                        1  35 O#ACLN
     I/COPY WNCPYSRC,ME9940I002
      * Bank to Bank Information
     I                                      257 466 O#BTB
     I                                      257 291 O#BTB1
     I                                      292 326 O#BTB2
     I                                      327 361 O#BTB3
     I                                      362 396 O#BTB4
     I                                      397 431 O#BTB5
     I                                      432 466 O#BTB6
      *
      * Error Parameters
      *
     IE#PARM      DS                            256
      * Calling Program
     I                                        1  10 E#CPGM
      * Error message sent
     I                                       12  12 E#ERRM
      * Warning message sent
     I                                       13  13 E#WARN
      * Error index
     I                                       14  180E#INDX
      * Message text to prefix error message
     I                                       19  25 E#MSGD
     I                                       26  35 E#MSGF
      * Error codes array
     I                                       51 200 E#ERCD
     I                                       51 200 ERCD
     IDSMTR       DS
      *
      *  Define fields for message transalation
      *
     I                                        1 132 #MSDTA
     I                                      133 264 #MSTX1
     I#MSTX2      DS
     I                                        1 256 #MSTXA
     I                                      257 512 #MSTXB
      *
     ISCCMT       DS                            256                                           CSC022
     I                                        1   30CMTNUM                                    CSC022
     I                                        4 103 CMTARR                                    CSC022
      *  Defined Constants
      *
      *
     I              '0123456789'          C         DIGITS
      *
      * Named Constant used to determine if a field contains invalid
      * characters for Telex and S.W.I.F.T.
      *
     I              'ABCDEFGHIJKLMNOPQRST-C         ISO
     I              'UVWXYZ 1234567890/-?-
     I              '?:().,''+'
      * Extended ISO
     I              'ABCDEFGHIJKLMNOPQRST-C         ISOEX
     I              'UVWXYZ 1234567890/-?-
     I              '?:().,''+abcdefghijk-
     I              'lmnopqrstuvwxyz'
      * Extended ISO without space
     I              'ABCDEFGHIJKLMNOPQRST-C         ISOEXS
     I              'UVWXYZ1234567890/-?:-
     I              '().,''+abcdefghijklm-
     I              'nopqrstuvwxyz'
      *
      * Named Constant used to determine if a field is alphabetic
      *
     I              'ABCDEFGHIJKLMNOPQRST-C         ALPHAB
     I              'UVWXYZ'
      *
      * Named Constant used to determine if a field is alphabetic
      * with numbers
      *
     I              'ABCDEFGHIJKLMNOPQRST-C         ALPHAN
     I              'UVWXYZ0123456789'
      *
      *                                                                   CFT014
      ** Calling program                                                  CFT014
     I              'FTOPAY2VL'           C         WFTOPY                CFT014
     I              'SETSESVAL'           C         WTRAD                                   AR589197
     I              'SEDMES2VL'           C         WDPMV                                   AR589197
      *
      /EJECT
      *
      *****************************************************************
      *                                                               *
      *  List of Subroutines                                          *
      *                                                               *
      *  SRINBK   : Validate Intermediary Institution                 *
      *  SRAWBK   : Validate Account with Institution                 *
      *  SRBENF   : Validate Beneficiary                              *
      *  SROTHR   : Validate Other Details                            *
      *  SRCUST   : Get Customer/Counterparty Nostro/ Bic Information *
      *  SRDCIN   : Validate /C/ and /D/                              *
      *  SRCCSY   : Validate Currency Clearing System codes           *
      *  SRCHKC   : Check Currency Combination                        *
      *  SRBL     : Bankleitzahl Validation                           *
      *  SRCC     : Canadian Clearing Validation                      *
      *  SRCH     : CHIPS Universal id. Validation                    *
      *  SRCP     : CHIPS Participant Validation                      *
      *  SRES     : Spanish Domestic Validation                       *
      *  SRFW     : Fedwire Validation                                *
      *  SRIT     : Italian Domestic Validation                       *
      *  SRSC     : CHAPS Sort Code Validation                        *
      *  SRSW     : Swiss Clearing Code Validation                    *
      *  SRCEXT   : Currency Clearing Extension Validation            *
      *  SRSNMS   : Send Message to Calling program                   *
      *  SRINIT   : Initialise and define fields                      *
      *                                                               *
      *****************************************************************
      *
      *  Set up subroutine stack name
      *
     C                     ADD  1         Q
     C                     MOVEL'MAIN'    @STK,Q
      * Entry parameters
      *
     C           *ENTRY    PLIST
     C                     PARM           W0RTN   7
     C                     PARM           I#PARM           I Input Parms
     C                     PARM           O#PARM           O Output Parms
     C                     PARM           E#PARM           E Error Inform
     C                     PARM           Z#PARM256        B User Defined
      *
      *  Set up primary reference
      *
     C                     MOVELI#ACLN    W0PREF    P
      *
      * Initialise program
      *
     C           $FIRST    IFEQ *BLANKS
     C                     EXSR SRINIT
     C                     END
      *
      * Initialise return code etc
      *
     C                     MOVEL*BLANK    P#RTCD  7
     C                     MOVEL*BLANK    E#ERRM
     C                     MOVEL*BLANK    E#WARN
     C                     MOVEL*BLANK    E#ERCD
     C                     Z-ADD1         E       50
      *
     C                     MOVEL*BLANKS   W9CUST
     C                     MOVEL*BLANKS   W9CNST
     C                     MOVEL*BLANKS   W9BICD
      *
      *  Get Customer/Counterparty Nostro/BIC Information
      *
     C********** CSW213    IFNE 'Y'                                                  CSW213 MD031218
     C                     EXSR SRCUST
     C**********           ENDIF                                                     CSW213 MD031218
      * Main processing 1
     C/COPY WNCPYSRC,ME9940DMP1
      *
      ** Depending on field call relevant subroutine
      *
     C                     SELEC
      * Intermediary Institution
     C           I#VFLD    WHEQ 'INBK '
     C                     EXSR SRINBK
      * Account with Institution
     C           I#VFLD    WHEQ 'AWBK '
     C                     EXSR SRAWBK
      * Beneficiary Institution
     C           I#VFLD    WHEQ 'BENF '
     C                     EXSR SRBENF
      ** Customer                                                                             CSW213
     C           I#MMOD    WHEQ 'SD'                                                          CSW213
     C           CSW213    IFEQ 'Y'                                                           CSW213
     C                     EXSR SRCUSD                                                        CSW213
     C                     ENDIF                                                              CSW213
      * Catch all
     C                     OTHER
     C                     EXSR SROTHR
     C                     ENDSL
      *
      * Main processing 2
     C/COPY WNCPYSRC,ME9940DMP2
      *
      ** Set return depending errors found
     C           P#RTCD    IFNE *BLANKS
     C                     MOVELP#RTCD    W0RTN
     C                     ENDIF
     C           E         IFNE 0
     C                     Z-ADDE         E#INDX
     C                     ENDIF
     C                     MOVELI#ACLN    O#ACLN
      * Main processing 3
     C/COPY WNCPYSRC,ME9940DMP3
      *
      *
      *  Unwind subroutine stack name
      *
     C           EXMAIN    TAG
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     RETRN
      *
      ********************************************************************
     C/EJECT
      *****************************************************************
      *                                                               *
      *  SRINBK   : Validate Intermediary Institution                 *
      *                                                               *
      *  CALLED BY: Main processing                                   *
      *                                                               *
      *****************************************************************
     CSR         SRINBK    BEGSR
      *
      *  Set up subroutine stack name
      *
     C                     ADD  1         Q
     C                     MOVEL'SRINBK'  @STK,Q
     C                     MOVE 'N'       WRTFLG  1                                         MD035349
      *
      * Copy point for Intermediary Institution Validation
     C/COPY WNCPYSRC,ME9940INBK
      *
      * Validate /C/ and /D/ indicators
      *
     C                     MOVEL'925'     ##RER1  3
     C                     MOVEL'966'     ##PER1  3
     C                     MOVEL'200'     ##RER2  3
     C                     MOVEL'202'     ##PER2  3
     C                     EXSR SRDCIN
     C           E#ERRM    IFNE *BLANKS
     C                     GOTO EXINBK
     C                     ENDIF
      *
      * Validate Currency Clearing System codes
      *
     C                     MOVEL'896'     ##RER1
     C                     MOVEL'967'     ##PER1
     C                     MOVEL'927'     ##RER2
     C                     MOVEL'968'     ##PER2
     C                     EXSR SRCCSY
     C           E#ERRM    IFNE *BLANKS
     C                     GOTO EXINBK
     C                     ENDIF
     C/COPY WNCPYSRC,ME9940C001
      *
      * Bankleitzahl Validation
      *
     C                     MOVEL'928'     ##RER1
     C                     MOVEL'969'     ##PER1
     C           I#ACCL    IFEQ '//BL'
     C                     EXSR SRBL
     C                     ENDIF
      *
      * Canadian Clearing Validation
      *
     C                     MOVEL'928'     ##RER1
     C                     MOVEL'969'     ##PER1
     C           I#ACCL    IFEQ '//CC'
     C                     EXSR SRCC
     C                     ENDIF
      *
      * CHIPS Universal id. Validation
      *
     C                     MOVEL'928'     ##RER1
     C                     MOVEL'969'     ##PER1
     C           I#ACCL    IFEQ '//CH'
     C                     EXSR SRCH
     C                     ENDIF
      *
      * CHIPS Participant Validation
      *
     C                     MOVEL'928'     ##RER1
     C                     MOVEL'969'     ##PER1
     C           I#ACCL    IFEQ '//CP'
     C                     EXSR SRCP
     C                     ENDIF
      *
      * Spanish Domestic Validation
      *
     C                     MOVEL'928'     ##RER1
     C                     MOVEL'969'     ##PER1
     C           I#ACCL    IFEQ '//ES'
     C                     EXSR SRES
     C                     ENDIF
      *
      * Fedwire Validation
      *
     C                     MOVEL'928'     ##RER1
     C                     MOVEL'969'     ##PER1
     C           I#ACCL    IFEQ '//FW'
     C                     EXSR SRFW
     C                     ENDIF
      *
      *                                                                   154474
      * Real-time Gross Settlement Validation                             154474
      *                                                                   154474
     C                     MOVEL'928'     ##RER1                          154474
     C                     MOVEL'969'     ##PER1                          154474
     C           I#ACCL    IFEQ '//RT'                                    154474
     C                     EXSR SRRT                                      154474
     C                     MOVE 'Y'       WRTFLG                                            MD035349
     C                     ENDIF                                          154474
      *                                                                   154474
      * Italian Domestic id Validation
      *
     C                     MOVEL'928'     ##RER1
     C                     MOVEL'969'     ##PER1
     C           I#ACCL    IFEQ '//IT'
     C                     EXSR SRIT
     C                     ENDIF
      *
      * CHAPS Sort Code Validation
      *
     C                     MOVEL'928'     ##RER1
     C                     MOVEL'969'     ##PER1
     C           I#ACCL    IFEQ '//SC'
     C                     EXSR SRSC
     C                     ENDIF
      *
      * Swiss Clearing Validation
      *
     C                     MOVEL'928'     ##RER1
     C                     MOVEL'969'     ##PER1
     C           I#ACCL    IFEQ '//SW'
     C                     EXSR SRSW
     C                     ENDIF
      *
      * Austrian Bankleitzahl Validation                                  CSW097
      *                                                                   CSW097
     C                     MOVEL'928'     ##RER1                          CSW097
     C                     MOVEL'969'     ##PER1                          CSW097
     C           I#ACCL    IFEQ '//AT'                                    CSW097
     C                     EXSR SRAT                                      CSW097
     C                     ENDIF                                          CSW097
      *                                                                   CSW097
      * Australian Bank State Code Validation                             CSW097
      *                                                                   CSW097
     C                     MOVEL'928'     ##RER1                          CSW097
     C                     MOVEL'969'     ##PER1                          CSW097
     C           I#ACCL    IFEQ '//AU'                                    CSW097
     C                     EXSR SRAU                                      CSW097
     C                     ENDIF                                          CSW097
      *                                                                   CSW200
      * The following clearing codes are part of SWIFT 1999 changes       CSW200
      *                                                                   CSW200
     C           CSW200    IFEQ 'CSW200'                                  CSW200
      *                                                                   CSW200
      * Hong Kong Validation                                              CSW200
      *                                                                   CSW200
     C                     MOVEL'928'     ##RER1                          CSW200
     C                     MOVEL'969'     ##PER1                          CSW200
     C           I#ACCL    IFEQ '//HK'                                    CSW200
     C                     EXSR SRHK                                      CSW200
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
      * Irish National Clearing Validation                                CSW200
      *                                                                   CSW200
     C                     MOVEL'928'     ##RER1                          CSW200
     C                     MOVEL'969'     ##PER1                          CSW200
     C           I#ACCL    IFEQ '//IE'                                    CSW200
     C                     EXSR SRIE                                      CSW200
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
      * Portugal National Clearing Validation                             CSW200
      *                                                                   CSW200
     C                     MOVEL'928'     ##RER1                          CSW200
     C                     MOVEL'969'     ##PER1                          CSW200
     C           I#ACCL    IFEQ '//PT'                                    CSW200
     C                     EXSR SRPT                                      CSW200
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
      * Russian Central Bank Identification Code Validation               CSW200
      *                                                                   CSW200
     C                     MOVEL'928'     ##RER1                          CSW200
     C                     MOVEL'969'     ##PER1                          CSW200
     C           I#ACCL    IFEQ '//RU'                                    CSW200
      *                                                                   CSW200
      ** Check SWIFT BIC code, if one on file for this client, is valid   CSW200
      *                                                                   CSW200
     C                     SELEC                                          CSW200
      * When customer                                                     CSW200
     C           W9CUST    WHEQ 'Y'                                       CSW200
     C           I#PRTT    ANDNE'S'                                       CSW200
     C                     MOVELBBCSID    W9BICC                          CSW200
     C                     MOVE *BLANKS   W9BICB                          CSW200
      * When conterparty nostro                                           CSW200
     C           W9CNST    WHEQ 'Y'                                       CSW200
     C           I#PRTT    ANDNE'S'                                       CSW200
     C                     MOVELAWSWID    W9BICC                          CSW200
     C                     MOVE *BLANKS   W9BICB                          CSW200
      * Otherwise SWIFT BIC address                                       CSW200
     C                     OTHER                                          CSW200
     C                     MOVELI#PRTY    W9BICC                          CSW200
     C           3         SUBSTI#PRTY:9  W9BICB                          CSW200
     C                     ENDSL                                          CSW200
      *                                                                   CSW200
     C                     CALL 'ME1400'                                  CSW200
     C                     PARM *BLANKS   W9RTN                           CSW200
     C                     PARM           W9BICC                          CSW200
     C                     PARM           W9BICB                          CSW200
     C                     PARM           SDCUST                          CSW200
     C                     PARM           SDCNST                          CSW200
     C                     PARM           MEBICD                          CSW200
     C                     PARM *BLANKS   WKCUST                          CSW200
     C                     PARM *BLANKS   WKCNST                          CSW200
     C                     PARM *BLANKS   WKBICD                          CSW200
      *                                                                   CSW200
      *  If a SWIFT BIC has not been entered                              CSW200
      *                                                                   CSW200
     C           WKBICD    IFNE 'Y'                                       CSW200
     C           WKCUST    ANDNE'Y'                                       CSW200
     C           WKCNST    ANDNE'Y'                                       CSW200
      *                                                                   CSW200
     C                     EXSR SRRU                                      CSW200
      *                                                                   CSW200
      *  A SWIFT BIC has been entered                                     CSW200
     C                     ELSE                                           CSW200
      *                                                                   CSW200
     C           I#PR      IFEQ 'REC'                                     CSW200
     C                     MOVEL##RER1    ERCD,E                          CSW200
     C                     ELSE                                           CSW200
     C                     MOVEL##PER1    ERCD,E                          CSW200
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
     C                     ADD  1         E                               CSW200
     C                     MOVEL'Y'       E#ERRM                          CSW200
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
      * Send error message                                                CSW200
      *                                                                   CSW200
     C                     MOVEL'MEC0034' MEMSID                          CSW200
     C                     MOVEL'MEMSG'   MEMSGF                          CSW200
     C                     MOVEL*BLANKS   MEMSDT                          CSW200
     C                     EXSR SRSNMS                                    CSW200
     C                     GOTO EXINBK                                    CSW200
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
      * ZA Clearing Validation                                            CSW200
      *                                                                   CSW200
     C                     MOVEL'928'     ##RER1                          CSW200
     C                     MOVEL'969'     ##PER1                          CSW200
     C           I#ACCL    IFEQ '//ZA'                                    CSW200
     C           I#MTYP    IFEQ '202'                                     CSW200
     C           I#MTYP    OREQ '210'                                     CSW200
     C           I#MTYP    OREQ '103'                                                         261796
      *                                                                   CSW200
      ** Check SWIFT BIC code, if one on file for this client, is valid   CSW200
      *                                                                   CSW200
     C                     SELEC                                          CSW200
      * When customer                                                     CSW200
     C           W9CUST    WHEQ 'Y'                                       CSW200
     C           I#PRTT    ANDNE'S'                                       CSW200
     C                     MOVELBBCSID    W9BICC                          CSW200
     C                     MOVE *BLANKS   W9BICB                          CSW200
      * When conterparty nostro                                           CSW200
     C           W9CNST    WHEQ 'Y'                                       CSW200
     C           I#PRTT    ANDNE'S'                                       CSW200
     C                     MOVELAWSWID    W9BICC                          CSW200
     C                     MOVE *BLANKS   W9BICB                          CSW200
      * Otherwise SWIFT BIC address                                       CSW200
     C                     OTHER                                          CSW200
     C                     MOVELI#PRTY    W9BICC                          CSW200
     C           3         SUBSTI#PRTY:9  W9BICB                          CSW200
     C                     ENDSL                                          CSW200
      *                                                                   CSW200
     C                     CALL 'ME1400'                                  CSW200
     C                     PARM *BLANKS   W9RTN                           CSW200
     C                     PARM           W9BICC                          CSW200
     C                     PARM           W9BICB                          CSW200
     C                     PARM           SDCUST                          CSW200
     C                     PARM           SDCNST                          CSW200
     C                     PARM           MEBICD                          CSW200
     C                     PARM *BLANKS   WKCUST                          CSW200
     C                     PARM *BLANKS   WKCNST                          CSW200
     C                     PARM *BLANKS   WKBICD                          CSW200
      *                                                                   CSW200
      *  If a SWIFT BIC has not been entered                              CSW200
      *                                                                   CSW200
     C           WKBICD    IFNE 'Y'                                       CSW200
     C           WKCUST    ANDNE'Y'                                       CSW200
     C           WKCNST    ANDNE'Y'                                       CSW200
      *                                                                   CSW200
     C                     EXSR SRZA                                      CSW200
      *                                                                   CSW200
      *  A SWIFT BIC has been entered                                     CSW200
     C                     ELSE                                           CSW200
      *                                                                   CSW200
     C           I#PR      IFEQ 'REC'                                     CSW200
     C                     MOVEL##RER1    ERCD,E                          CSW200
     C                     ELSE                                           CSW200
     C                     MOVEL##PER1    ERCD,E                          CSW200
     C                     ENDIF                                          CSW200
     C                     ADD  1         E                               CSW200
     C                     MOVEL'Y'       E#ERRM                          CSW200
      *                                                                   CSW200
      * Send error message                                                CSW200
     C                     MOVEL'MEC0035' MEMSID                          CSW200
     C                     MOVEL'MEMSG'   MEMSGF                          CSW200
     C                     MOVEL*BLANKS   MEMSDT                          CSW200
     C                     EXSR SRSNMS                                    CSW200
     C                     GOTO EXINBK                                    CSW200
      *                                                                   CSW200
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
      * Message type is not 202 nor 210                                   CSW200
     C                     ELSE                                           CSW200
     C           I#PR      IFEQ 'REC'                                     CSW200
     C                     MOVEL##RER1    ERCD,E                          CSW200
     C                     ELSE                                           CSW200
     C                     MOVEL##PER1    ERCD,E                          CSW200
     C                     ENDIF                                          CSW200
     C                     ADD  1         E                               CSW200
     C                     MOVEL'Y'       E#ERRM                          CSW200
      * Send error message                                                CSW200
      *                                                                   CSW200
     C                     MOVEL'MEC0028' MEMSID                          CSW200
     C                     MOVEL'MEMSG'   MEMSGF                          CSW200
     C                     MOVEL*BLANKS   MEMSDT                          CSW200
     C                     EXSR SRSNMS                                    CSW200
     C                     GOTO EXINBK                                    CSW200
     C                     ENDIF                                          CSW200
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
      * Real Time Clearing System Validation                              CSW200
      *                                                                   CSW200
     C                     MOVEL'928'     ##RER1                          CSW200
     C                     MOVEL'969'     ##PER1                          CSW200
     C                     MOVEL'896'     ##RER3  3                       CSW200
     C                     MOVEL'967'     ##PER3  3                       CSW200
     C           I#ACCL    IFEQ '//RT'                                    CSW200
     C           WRTFLG    ANDNE'Y'                                                         MD035349
     C           I#MTYP    IFEQ '100'                                     CSW200
     C           I#MTYP    OREQ '103'                                     CFT014
     C           I#MTYP    OREQ '202'                                     CSW200
     C                     EXSR SRRT                                      CSW200
     C                     ELSE                                           CSW200
     C           I#PR      IFEQ 'REC'                                     CSW200
     C                     MOVEL##RER1    ERCD,E                          CSW200
     C                     ELSE                                           CSW200
     C                     MOVEL##PER1    ERCD,E                          CSW200
     C                     ENDIF                                          CSW200
     C                     ADD  1         E                               CSW200
     C                     MOVEL'Y'       E#ERRM                          CSW200
      * Send error message                                                CSW200
      *                                                                   CSW200
     C                     MOVEL'MEC0036' MEMSID                          CSW200
     C                     MOVEL'MEMSG'   MEMSGF                          CSW200
     C                     MOVEL*BLANKS   MEMSDT                          CSW200
     C                     EXSR SRSNMS                                    CSW200
     C                     GOTO EXINBK                                    CSW200
     C                     ENDIF                                          CSW200
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
      * New Zealand Code not permitted on "Intermediary Institution" fieldCSW200
      *                                                                   CSW200
     C           I#ACCL    IFEQ '//NZ'                                    CSW200
      *                                                                                       CSW201
      ** If SWIFT 2001 is installed, New Zealand code is allowed.                             CSW201
      *                                                                                       CSW201
     C           CSW201    IFEQ 'Y'                                                           CSW201
     C           I#PR      ANDEQ'PAY'                                                         CSW201
     C           I#MTYP    ANDEQ'100'                                                         CSW201
     C           CSW201    OREQ 'Y'                                                           CSW201
     C           I#PR      ANDEQ'PAY'                                                         CSW201
     C           I#MTYP    ANDEQ'103'                                                         CSW201
     C                     EXSR SRNZ                                                          CSW201
      *                                                                                       CSW201
     C                     ELSE                                                               CSW201
      *                                                                                       CSW201
     C           I#PR      IFEQ 'REC'                                     CSW200
     C                     MOVEL##RER1    ERCD,E                          CSW200
     C                     ELSE                                           CSW200
     C                     MOVEL##PER1    ERCD,E                          CSW200
     C                     ENDIF                                          CSW200
     C                     ADD  1         E                               CSW200
     C                     MOVEL'Y'       E#ERRM                          CSW200
      * Send error message                                                CSW200
      *                                                                   CSW200
     C                     MOVEL'MEC0029' MEMSID                          CSW200
     C                     MOVEL'MEMSG'   MEMSGF                          CSW200
     C                     MOVEL*BLANKS   MEMSDT                          CSW200
     C                     EXSR SRSNMS                                    CSW200
     C                     GOTO EXINBK                                    CSW200
     C                     ENDIF                                                              CSW201
      *                                                                                       CSW201
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
     C                     ENDIF                                          CSW200
      *                                                                                       CSW202
     C           CSW202    IFEQ 'Y'                                                           CSW202
      *                                                                                       CSW202
     C                     MOVEL'928'     ##RER1                                              CSW202
     C                     MOVEL'969'     ##PER1                                              CSW202
      *                                                                                       CSW202
      ** Validate the new clearing code //GR (HEBIC - Hellenic Bank                           CSW202
      ** Identifier Code                                                                      CSW202
      *                                                                                       CSW202
     C           I#ACCL    IFEQ '//GR'                                                        CSW202
     C                     EXSR SRGR                                                          CSW202
     C                     ENDIF                                                              CSW202
      *                                                                                       CSW202
      ** Validate the new clearing codes //IN (Indian Financial System Code)                  CSW202
      *                                                                                       CSW202
     C           I#ACCL    IFEQ '//IN'                                                        CSW202
     C                     EXSR SRIN                                                          CSW202
     C                     ENDIF                                                              CSW202
      *                                                                                       CSW202
     C                     ENDIF                                                              CSW202
      *                                                                                       CSW206
      ** If SWIFT 2006 is installed, Polish National Clearing code is allowed.                CSW206
      *                                                                                       CSW206
     C           CSW206    IFEQ 'Y'                                                           CSW206
      *                                                                                       CSW206
     C                     MOVEL'928'     ##RER1                                              CSW206
     C                     MOVEL'969'     ##PER1                                              CSW206
      *                                                                                       CSW206
      ** Validate the new clearing code //PL (Polish National code)                           CSW206
      *                                                                                       CSW206
     C           I#ACCL    IFEQ '//PL'                                                        CSW206
     C                     EXSR SRPL                                                          CSW206
     C                     ENDIF                                                              CSW206
     C                     ENDIF                                                              CSW206
      *                                                                                       CSW202
      ** If SWIFT 2015 is installed, //CN clearing code is allowed                            CSW215
      *                                                                                       CSW215
     C           CSW215    IFEQ 'Y'                                                           CSW215
      *                                                                                       CSW215
     C                     MOVEL'928'     ##RER1                                              CSW215
     C                     MOVEL'969'     ##PER1                                              CSW215
      *                                                                                       CSW215
      ** Validate the new clearing code //CN - China National                                 CSW215
      *  Advance Payment System (CNAPS) Code                                                  CSW215
      *                                                                                       CSW215
     C           I#ACCL    IFEQ '//CN'                                                        CSW215
     C                     EXSR SRCN                                                          CSW215
     C                     ENDIF                                                              CSW215
     C                     ENDIF                                                              CSW215
      *                                                                                       CSW215
     C/COPY WNCPYSRC,ME9940C005
      * If currency clearing extension validation then action
      *
     C           E#ERRM    IFEQ *BLANKS
     C           DPEXPM    ANDNE'*NONE'
     C           DPEXPM    ANDNE*BLANKS
     C                     EXSR SRCEXT
     C                     ENDIF
      *
      *  Unwind subroutine stack name
      *
     C           EXINBK    TAG
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     CSR                   ENDSR
      *****************************************************************
     C/EJECT
      *****************************************************************
      *                                                               *
      *  SRAWBK   : Validate Account with Institution                 *
      *                                                               *
      *  CALLED BY: Main processing                                   *
      *                                                               *
      *****************************************************************
     CSR         SRAWBK    BEGSR
      *
      *  Set up subroutine stack name
      *
     C                     ADD  1         Q
     C                     MOVEL'SRAWBK'  @STK,Q
     C                     MOVE 'N'       WRTFLG                                            MD035349
      *
      * Copy point for Account with Institution Validation
     C/COPY WNCPYSRC,ME9940ACBK
      *
      * Validate /C/ and /D/ indicators
      *
     C           I#MTYP    IFNE '5XX'                                                       AR589197
     C                     MOVEL'974'     ##PER1
     C                     MOVEL'203'     ##PER2
     C                     EXSR SRDCIN
     C           E#ERRM    IFNE *BLANKS
     C                     GOTO EXAWBK
     C                     ENDIF
     C                     ENDIF                                                            AR589197
      *
      * Validate Currency Clearing System codes
      *
     C                     MOVEL'975'     ##PER1
     C                     MOVEL'976'     ##PER2
     C                     EXSR SRCCSY
     C           E#ERRM    IFNE *BLANKS
     C                     GOTO EXAWBK
     C                     ENDIF
     C/COPY WNCPYSRC,ME9940C002
      *
      * Bankleitzahl Validation
      *
     C                     MOVEL'977'     ##PER1
     C           I#ACCL    IFEQ '//BL'
     C                     EXSR SRBL
     C                     ENDIF
      *
      * Canadian Clearing Validation
      *
     C                     MOVEL'977'     ##PER1
     C           I#ACCL    IFEQ '//CC'
     C                     EXSR SRCC
     C                     ENDIF
      *
      * CHIPS Universal id. Validation
      *
     C                     MOVEL'977'     ##PER1
     C           I#ACCL    IFEQ '//CH'
     C                     EXSR SRCH
     C                     ENDIF
      *
      * CHIPS Participant Validation
      *
     C                     MOVEL'977'     ##PER1
     C           I#ACCL    IFEQ '//CP'
     C                     EXSR SRCP
     C                     ENDIF
      *
      * Spanish Domestic Validation
      *
     C                     MOVEL'977'     ##PER1
     C           I#ACCL    IFEQ '//ES'
     C                     EXSR SRES
     C                     ENDIF
      *
      * Fedwire Validation
      *
     C                     MOVEL'977'     ##PER1
     C           I#ACCL    IFEQ '//FW'
     C                     EXSR SRFW
     C                     ENDIF
      *                                                                   154474
      * Real-Time Gross Settlement Validation                             154474
      *                                                                   154474
     C                     MOVEL'977'     ##PER1                          154474
     C           I#ACCL    IFEQ '//RT'                                    154474
     C                     EXSR SRRT                                      154474
     C                     MOVE 'Y'       WRTFLG                                            MD035349
     C                     ENDIF                                          154474
      *
      * Italian Domestic id Validation
      *
     C                     MOVEL'977'     ##PER1
     C           I#ACCL    IFEQ '//IT'
     C                     EXSR SRIT
     C                     ENDIF
      *
      * CHAPS Sort Code Validation
      *
     C                     MOVEL'977'     ##PER1
     C           I#ACCL    IFEQ '//SC'
     C                     EXSR SRSC
     C                     ENDIF
      *
      * Swiss Clearing Validation
      *
     C                     MOVEL'977'     ##PER1
     C           I#ACCL    IFEQ '//SW'
     C                     EXSR SRSW
     C                     ENDIF
      *
      * Austrian Bankleitzahl Validation                                  CSW097
      *                                                                   CSW097
     C                     MOVEL'977'     ##PER1                          CSW097
     C           I#ACCL    IFEQ '//AT'                                    CSW097
     C                     EXSR SRAT                                      CSW097
     C                     ENDIF                                          CSW097
     C/COPY WNCPYSRC,ME9940C006
      *                                                                   CSW097
      * Australian Bank State Code Validation                             CSW097
      *                                                                   CSW097
     C                     MOVEL'977'     ##PER1                          CSW097
     C           I#ACCL    IFEQ '//AU'                                    CSW097
     C                     EXSR SRAU                                      CSW097
     C                     ENDIF                                          CSW097
      *                                                                   CSW200
      * The following clearing codes are part of SWIFT 1999 changes       CSW200
      *                                                                   CSW200
     C           CSW200    IFEQ 'CSW200'                                  CSW200
      *                                                                   CSW097
      * Hong Kong Validation                                              CSW200
      *                                                                   CSW200
     C                     MOVEL'977'     ##PER1                          CSW200
     C           I#ACCL    IFEQ '//HK'                                    CSW200
     C                     EXSR SRHK                                      CSW200
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
      * Irish National Clearing Validation                                CSW200
      *                                                                   CSW200
     C                     MOVEL'977'     ##PER1                          CSW200
     C           I#ACCL    IFEQ '//IE'                                    CSW200
     C                     EXSR SRIE                                      CSW200
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
      * Portugal National Clearing Validation                             CSW200
      *                                                                   CSW200
     C                     MOVEL'977'     ##PER1                          CSW200
     C           I#ACCL    IFEQ '//PT'                                    CSW200
     C                     EXSR SRPT                                      CSW200
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
      * Russian Central Bank Identification Code Validation               CSW200
      *                                                                   CSW200
     C                     MOVEL'977'     ##PER1                          CSW200
     C           I#ACCL    IFEQ '//RU'                                    CSW200
      ** Check SWIFT BIC code, if one on file for this client, is valid   CSW200
      *                                                                   CSW200
     C                     SELEC                                          CSW200
      * When customer                                                     CSW200
     C           W9CUST    WHEQ 'Y'                                       CSW200
     C           I#PRTT    ANDNE'S'                                       CSW200
     C                     MOVELBBCSID    W9BICC                          CSW200
     C                     MOVE *BLANKS   W9BICB                          CSW200
      * When conterparty nostro                                           CSW200
     C           W9CNST    WHEQ 'Y'                                       CSW200
     C           I#PRTT    ANDNE'S'                                       CSW200
     C                     MOVELAWSWID    W9BICC                          CSW200
     C                     MOVE *BLANKS   W9BICB                          CSW200
      * Otherwise SWIFT BIC address                                       CSW200
     C                     OTHER                                          CSW200
     C                     MOVELI#PRTY    W9BICC                          CSW200
     C           3         SUBSTI#PRTY:9  W9BICB                          CSW200
     C                     ENDSL                                          CSW200
      *                                                                   CSW200
     C                     CALL 'ME1400'                                  CSW200
     C                     PARM *BLANKS   W9RTN                           CSW200
     C                     PARM           W9BICC                          CSW200
     C                     PARM           W9BICB                          CSW200
     C                     PARM           SDCUST                          CSW200
     C                     PARM           SDCNST                          CSW200
     C                     PARM           MEBICD                          CSW200
     C                     PARM *BLANKS   WKCUST                          CSW200
     C                     PARM *BLANKS   WKCNST                          CSW200
     C                     PARM *BLANKS   WKBICD                          CSW200
      *                                                                   CSW200
      *  If a SWIFT BIC has not been entered                              CSW200
      *                                                                   CSW200
     C           WKBICD    IFNE 'Y'                                       CSW200
     C           WKCUST    ANDNE'Y'                                       CSW200
     C           WKCNST    ANDNE'Y'                                       CSW200
      *                                                                   CSW200
     C                     EXSR SRRU                                      CSW200
      *                                                                   CSW200
      *  A SWIFT BIC has been entered                                     CSW200
     C                     ELSE                                           CSW200
      *                                                                   CSW200
     C                     MOVEL##PER1    ERCD,E                          CSW200
     C                     ADD  1         E                               CSW200
     C                     MOVEL'Y'       E#ERRM                          CSW200
      * Send error message                                                CSW200
      *                                                                   CSW200
     C                     MOVEL'MEC0037' MEMSID                          CSW200
     C                     MOVEL'MEMSG'   MEMSGF                          CSW200
     C                     MOVEL*BLANKS   MEMSDT                          CSW200
     C                     EXSR SRSNMS                                    CSW200
     C                     GOTO EXAWBK                                    CSW200
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
      * ZA Clearing Validation                                            CSW200
      *                                                                   CSW200
     C                     MOVEL'977'     ##PER1                          CSW200
     C           I#ACCL    IFEQ '//ZA'                                    CSW200
     C           I#MTYP    IFEQ '202'                                     CSW200
     C           I#MTYP    OREQ '100'                                     183752
     C           I#MTYP    OREQ '103'                                     CFT014
      *                                                                   CSW200
      ** Check SWIFT BIC code, if one on file for this client, is valid   CSW200
      *                                                                   CSW200
     C                     SELEC                                          CSW200
      * When customer                                                     CSW200
     C           W9CUST    WHEQ 'Y'                                       CSW200
     C           I#PRTT    ANDNE'S'                                       CSW200
     C                     MOVELBBCSID    W9BICC                          CSW200
     C                     MOVE *BLANKS   W9BICB                          CSW200
      * When conterparty nostro                                           CSW200
     C           W9CNST    WHEQ 'Y'                                       CSW200
     C           I#PRTT    ANDNE'S'                                       CSW200
     C                     MOVELAWSWID    W9BICC                          CSW200
     C                     MOVE *BLANKS   W9BICB                          CSW200
      * Otherwise SWIFT BIC address                                       CSW200
     C                     OTHER                                          CSW200
     C                     MOVELI#PRTY    W9BICC                          CSW200
     C           3         SUBSTI#PRTY:9  W9BICB                          CSW200
     C                     ENDSL                                          CSW200
      *                                                                   CSW200
     C                     CALL 'ME1400'                                  CSW200
     C                     PARM *BLANKS   W9RTN                           CSW200
     C                     PARM           W9BICC                          CSW200
     C                     PARM           W9BICB                          CSW200
     C                     PARM           SDCUST                          CSW200
     C                     PARM           SDCNST                          CSW200
     C                     PARM           MEBICD                          CSW200
     C                     PARM *BLANKS   WKCUST                          CSW200
     C                     PARM *BLANKS   WKCNST                          CSW200
     C                     PARM *BLANKS   WKBICD                          CSW200
      *                                                                   CSW200
      *  If a SWIFT BIC has not been entered                              CSW200
      *                                                                   CSW200
     C           WKBICD    IFNE 'Y'                                       CSW200
     C           WKCUST    ANDNE'Y'                                       CSW200
     C           WKCNST    ANDNE'Y'                                       CSW200
      *                                                                   CSW200
     C                     EXSR SRZA                                      CSW200
      *                                                                   CSW200
      *  A SWIFT BIC has been entered                                     CSW200
     C                     ELSE                                           CSW200
      *                                                                   CSW200
     C                     MOVEL##PER1    ERCD,E                          CSW200
     C                     ADD  1         E                               CSW200
     C                     MOVEL'Y'       E#ERRM                          CSW200
      * Send error message                                                CSW200
      *                                                                   CSW200
     C                     MOVEL'MEC0038' MEMSID                          CSW200
     C                     MOVEL'MEMSG'   MEMSGF                          CSW200
     C                     MOVEL*BLANKS   MEMSDT                          CSW200
     C                     EXSR SRSNMS                                    CSW200
     C                     GOTO EXAWBK                                    CSW200
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
      * Message type is not 202                                           CSW200
      * and is not 100                                                    183752
     C                     ELSE                                           CSW200
     C                     MOVEL##PER1    ERCD,E                          CSW200
     C                     ADD  1         E                               CSW200
     C                     MOVEL'Y'       E#ERRM                          CSW200
      * Send error message                                                CSW200
      *                                                                   CSW200
     C                     MOVEL'MEC0031' MEMSID                          CSW200
     C                     MOVEL'MEMSG'   MEMSGF                          CSW200
     C                     MOVEL*BLANKS   MEMSDT                          CSW200
     C                     EXSR SRSNMS                                    CSW200
     C                     GOTO EXAWBK                                    CSW200
     C                     ENDIF                                          CSW200
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
      * Real Time Clearing System Validation                              CSW200
      *                                                                   CSW200
     C                     MOVEL'977'     ##PER1                          CSW200
     C                     MOVEL'975'     ##PER3                          CSW200
     C           I#ACCL    IFEQ '//RT'                                    CSW200
     C           WRTFLG    ANDNE'Y'                                                         MD035349
     C                     EXSR SRRT                                      CSW200
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
      * New Zealand National Clearing Code Validation                     CSW200
      *                                                                   CSW200
     C                     MOVEL'977'     ##PER1                          CSW200
     C           I#ACCL    IFEQ '//NZ'                                    CSW200
     C           I#MTYP    IFEQ '202'                                     183752
     C                     MOVEL'977'     ERCD,E                          183752
     C                     ADD  1         E                               183752
     C                     MOVEL'Y'       E#ERRM                          183752
      * Send error message                                                183752
      *                                                                   183752
     C                     MOVEL'MEC0041' MEMSID                          183752
     C                     MOVEL'MEMSG'   MEMSGF                          183752
     C                     MOVEL*BLANKS   MEMSDT                          183752
     C                     EXSR SRSNMS                                    183752
     C                     GOTO EXAWBK                                    183752
     C                     ELSE                                           183752
      *                                                                   183752
     C                     EXSR SRNZ                                      CSW200
     C                     ENDIF                                          CSW200
     C                     ENDIF                                          183752
      *                                                                   CSW200
     C                     ENDIF                                          CSW200
      *                                                                                       CSW202
     C           CSW202    IFEQ 'Y'                                                           CSW202
     C                     MOVEL'977'     ##PER1                                              CSW202
      *                                                                                       CSW202
      ** Validate new clearing code //GR (Hellenic Bank Identifier Code)                      CSW202
      *                                                                                       CSW202
     C           I#ACCL    IFEQ '//GR'                                                        CSW202
     C                     EXSR SRGR                                                          CSW202
     C                     ENDIF                                                              CSW202
      *                                                                                       CSW202
      ** Validate new clearing code //IN (Indian Financial System Code)                       CSW202
      *                                                                                       CSW202
     C           I#ACCL    IFEQ '//IN'                                                        CSW202
     C                     EXSR SRIN                                                          CSW202
     C                     ENDIF                                                              CSW202
      *                                                                                       CSW202
     C                     ENDIF                                                              CSW202
      *                                                                                       CSW206
     C           CSW206    IFEQ 'Y'                                                           CSW206
     C                     MOVEL'977'     ##PER1                                              CSW206
      *                                                                                       CSW206
      ** Validate new clearing code //PL (Polish National code)                               CSW206
      *                                                                                       CSW206
     C           I#ACCL    IFEQ '//PL'                                                        CSW206
     C                     EXSR SRPL                                                          CSW206
     C                     ENDIF                                                              CSW206
     C                     ENDIF                                                              CSW206
      *                                                                                       CSW215
     C           CSW215    IFEQ 'Y'                                                           CSW215
     C                     MOVEL'977'     ##PER1                                              CSW215
      *                                                                                       CSW215
      ** Validate new clearing code //CN (China National Advance                              CSW215
      ** Payment System)                                                                      CSW215
      *                                                                                       CSW215
     C           I#ACCL    IFEQ '//CN'                                                        CSW215
     C                     EXSR SRCN                                                          CSW215
     C                     ENDIF                                                              CSW215
     C                     ENDIF                                                              CSW215
      *                                                                   CSW200
      * If currency clearing extension validation then action
      *
     C           E#ERRM    IFEQ *BLANKS
     C           DPEXPM    ANDNE'*NONE'
     C           DPEXPM    ANDNE*BLANKS
     C                     EXSR SRCEXT
     C                     ENDIF
      *
      *  Unwind subroutine stack name
      *
     C           EXAWBK    TAG
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     CSR                   ENDSR
      *****************************************************************
     C/EJECT
      *****************************************************************
      *                                                               *
      *  SRBENF   : Validate Beneficiary                              *
      *                                                               *
      *  CALLED BY: Main processing                                   *
      *                                                               *
      *****************************************************************
     CSR         SRBENF    BEGSR
      *
      *  Set up subroutine stack name
      *
     C                     ADD  1         Q
     C                     MOVEL'SRBENF'  @STK,Q
     C                     MOVE 'N'       WRTFLG                                            MD035349
      *
      * Copy point for Beneficiary Institution Validation
     C/COPY WNCPYSRC,ME9940BENF
      *
      * Validate /C/ and /D/ indicators
      *
     C           I#MTYP    IFNE '5XX'                                                       AR589197
     C                     MOVEL'981'     ##PER1
     C                     MOVEL'204'     ##PER2
     C                     EXSR SRDCIN
     C           E#ERRM    IFNE *BLANKS
     C                     GOTO EXBENF
     C                     ENDIF
     C                     ENDIF                                                            AR589197
      *
      ** If Second Character is also '/'
      ** then must be a bank or SWIFT Bic
      *
      * For Mt100, //CH is allowed => //CH is always allowed
      *                               //NZ is always allowed              183752
      *
     C           I#ACC2    IFEQ '/'
     C           I#ACCL    ANDNE'//CH'
     C           I#ACCL    ANDNE'//NZ'                                    183752
     C/COPY WNCPYSRC,ME9940C007
     C           W9CUST    IFEQ 'Y'
     C           BBBNBI    ANDNE'Y'
     C           I#PRTT    ANDNE'S'
     C           W9CUST    ORNE 'Y'
     C           I#PRTT    ANDNE'S'
     C                     MOVE '982'     ERCD,E
     C                     ADD  1         E
     C                     MOVEL'Y'       E#ERRM
      *
      * Send error message
      *
     C                     MOVEL'MEC0001' MEMSID
     C                     MOVEL'MEMSG'   MEMSGF
     C                     MOVEL*BLANKS   MEMSDT
     C                     EXSR SRSNMS
      *
      * Exit subroutine
      *
     C                     GOTO EXBENF
     C                     ENDIF
     C                     ENDIF
      *
      * Validate Currency Clearing System codes
      *
     C                     MOVEL'983'     ##PER1
     C                     MOVEL'984'     ##PER2
     C                     EXSR SRCCSY
     C           E#ERRM    IFNE *BLANKS
     C                     GOTO EXBENF
     C                     ENDIF
     C/COPY WNCPYSRC,ME9940C003
      *
      * Bankleitzahl Validation
      *
     C                     MOVEL'985'     ##PER1
     C           I#ACCL    IFEQ '//BL'
     C                     EXSR SRBL
     C                     ENDIF
      *
      * Canadian Clearing Validation
      *
     C                     MOVEL'985'     ##PER1
     C           I#ACCL    IFEQ '//CC'
     C                     EXSR SRCC
     C                     ENDIF
      *
      * CHIPS Universal id. Validation
      *
     C                     MOVEL'985'     ##PER1
     C           I#ACCL    IFEQ '//CH'
     C                     EXSR SRCH
     C                     ENDIF
      *
      * CHIPS Participant Validation
      *
     C                     MOVEL'985'     ##PER1
     C           I#ACCL    IFEQ '//CP'
     C                     EXSR SRCP
     C                     ENDIF
      *
      * Spanish Domestic Validation
      *
     C                     MOVEL'985'     ##PER1
     C           I#ACCL    IFEQ '//ES'
     C                     EXSR SRES
     C                     ENDIF
      *
      * Fedwire Validation
      *
     C                     MOVEL'985'     ##PER1
     C           I#ACCL    IFEQ '//FW'
     C                     EXSR SRFW
     C                     ENDIF
      *                                                                   154474
      * Real-Time Gross Settlement Validation                             154474
      *                                                                   154474
     C                     MOVEL'985'     ##PER1                          154474
     C           I#ACCL    IFEQ '//RT'                                    154474
     C                     EXSR SRRT                                      154474
     C                     MOVE 'Y'       WRTFLG                                            MD035349
     C                     ENDIF                                          154474
      *
      * Italian Domestic id Validation
      *
     C                     MOVEL'985'     ##PER1
     C           I#ACCL    IFEQ '//IT'
     C                     EXSR SRIT
     C                     ENDIF
      *
      * CHAPS Sort Code Validation
      *
     C                     MOVEL'985'     ##PER1
     C           I#ACCL    IFEQ '//SC'
     C                     EXSR SRSC
     C                     ENDIF
      *
      * Swiss Clearing Validation
      *
     C                     MOVEL'985'     ##PER1
     C           I#ACCL    IFEQ '//SW'
     C                     EXSR SRSW
     C                     ENDIF
      *
      * Austrian Bankleitzahl Validation                                  CSW097
      *                                                                   CSW097
     C                     MOVEL'985'     ##PER1                          CSW097
     C           I#ACCL    IFEQ '//AT'                                    CSW097
     C                     EXSR SRAT                                      CSW097
     C                     ENDIF                                          CSW097
     C/COPY WNCPYSRC,ME9940C008
      *                                                                   CSW097
      * Australian Bank State Code Validation                             CSW097
      *                                                                   CSW097
     C                     MOVEL'985'     ##PER1                          CSW097
     C           I#ACCL    IFEQ '//AU'                                    CSW097
     C                     EXSR SRAU                                      CSW097
     C                     ENDIF                                          CSW097
      *                                                                   CSW097
      * The following clearing codes are part of SWIFT 1999 changes       CSW200
      *                                                                   CSW200
     C           CSW200    IFEQ 'CSW200'                                  CSW200
     C           I#MTYP    IFEQ '202'                                     CSW200
      *                                                                   CSW200
      * Hong Kong Validation                                              CSW200
      *                                                                   CSW200
     C                     MOVEL'985'     ##PER1                          CSW200
     C           I#ACCL    IFEQ '//HK'                                    CSW200
     C                     EXSR SRHK                                      CSW200
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
      * Irish National Clearing Validation                                CSW200
      *                                                                   CSW200
     C                     MOVEL'985'     ##PER1                          CSW200
     C           I#ACCL    IFEQ '//IE'                                    CSW200
     C                     EXSR SRIE                                      CSW200
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
      * Portugal National Clearing Validation                             CSW200
      *                                                                   CSW200
     C                     MOVEL'985'     ##PER1                          CSW200
     C           I#ACCL    IFEQ '//PT'                                    CSW200
     C                     EXSR SRPT                                      CSW200
     C                     ENDIF                                          CSW200
      *                                                                                       CSW206
      ** Polish National Clearing Validation                                                  CSW206
      *                                                                                       CSW206
     C           CSW206    IFEQ 'Y'                                                           CSW206
     C                     MOVEL'985'     ##PER1                                              CSW206
     C           I#ACCL    IFEQ '//PL'                                                        CSW206
     C                     EXSR SRPL                                                          CSW206
     C                     ENDIF                                                              CSW206
     C                     ENDIF                                                              CSW206
      *                                                                   CSW200
      * Russian Central Bank Identification Code Validation               CSW200
      *                                                                   CSW200
     C                     MOVEL'985'     ##PER1                          CSW200
     C           I#ACCL    IFEQ '//RU'                                    CSW200
      *                                                                   CSW200
      ** Check SWIFT BIC code, if one on file for this client, is valid   CSW200
      *                                                                   CSW200
     C                     SELEC                                          CSW200
      * When customer                                                     CSW200
     C           W9CUST    WHEQ 'Y'                                       CSW200
     C           I#PRTT    ANDNE'S'                                       CSW200
     C                     MOVELBBCSID    W9BICC                          CSW200
     C                     MOVE *BLANKS   W9BICB                          CSW200
      * When conterparty nostro                                           CSW200
     C           W9CNST    WHEQ 'Y'                                       CSW200
     C           I#PRTT    ANDNE'S'                                       CSW200
     C                     MOVELAWSWID    W9BICC                          CSW200
     C                     MOVE *BLANKS   W9BICB                          CSW200
      * Otherwise SWIFT BIC address                                       CSW200
     C                     OTHER                                          CSW200
     C                     MOVELI#PRTY    W9BICC                          CSW200
     C           3         SUBSTI#PRTY:9  W9BICB                          CSW200
     C                     ENDSL                                          CSW200
      *                                                                   CSW200
     C                     CALL 'ME1400'                                  CSW200
     C                     PARM *BLANKS   W9RTN                           CSW200
     C                     PARM           W9BICC                          CSW200
     C                     PARM           W9BICB                          CSW200
     C                     PARM           SDCUST                          CSW200
     C                     PARM           SDCNST                          CSW200
     C                     PARM           MEBICD                          CSW200
     C                     PARM *BLANKS   WKCUST                          CSW200
     C                     PARM *BLANKS   WKCNST                          CSW200
     C                     PARM *BLANKS   WKBICD                          CSW200
      *                                                                   CSW200
      *  If a SWIFT BIC has not been entered                              CSW200
      *                                                                   CSW200
     C           WKBICD    IFNE 'Y'                                       CSW200
     C           WKCUST    ANDNE'Y'                                       CSW200
     C           WKCNST    ANDNE'Y'                                       CSW200
      *                                                                   CSW200
     C                     EXSR SRRU                                      CSW200
      *                                                                   CSW200
      *  A SWIFT BIC has been entered                                     CSW200
     C                     ELSE                                           CSW200
      *                                                                   CSW200
     C                     MOVEL##PER1    ERCD,E                          CSW200
     C                     ADD  1         E                               CSW200
     C                     MOVEL'Y'       E#ERRM                          CSW200
      * Send error message                                                CSW200
      *                                                                   CSW200
     C                     MOVEL'MEC0039' MEMSID                          CSW200
     C                     MOVEL'MEMSG'   MEMSGF                          CSW200
     C                     MOVEL*BLANKS   MEMSDT                          CSW200
     C                     EXSR SRSNMS                                    CSW200
     C                     GOTO EXBENF                                    CSW200
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
      * ZA Clearing Validation                                            CSW200
      *                                                                   CSW200
     C                     MOVEL'985'     ##PER1                          CSW200
     C           I#ACCL    IFEQ '//ZA'                                    CSW200
      *                                                                   CSW200
      ** Check SWIFT BIC code, if one on file for this client, is valid   CSW200
      *                                                                   CSW200
     C                     SELEC                                          CSW200
      * When customer                                                     CSW200
     C           W9CUST    WHEQ 'Y'                                       CSW200
     C           I#PRTT    ANDNE'S'                                       CSW200
     C                     MOVELBBCSID    W9BICC                          CSW200
     C                     MOVE *BLANKS   W9BICB                          CSW200
      * When conterparty nostro                                           CSW200
     C           W9CNST    WHEQ 'Y'                                       CSW200
     C           I#PRTT    ANDNE'S'                                       CSW200
     C                     MOVELAWSWID    W9BICC                          CSW200
     C                     MOVE *BLANKS   W9BICB                          CSW200
      * Otherwise SWIFT BIC address                                       CSW200
     C                     OTHER                                          CSW200
     C                     MOVELI#PRTY    W9BICC                          CSW200
     C           3         SUBSTI#PRTY:9  W9BICB                          CSW200
     C                     ENDSL                                          CSW200
      *                                                                   CSW200
     C                     CALL 'ME1400'                                  CSW200
     C                     PARM *BLANKS   W9RTN                           CSW200
     C                     PARM           W9BICC                          CSW200
     C                     PARM           W9BICB                          CSW200
     C                     PARM           SDCUST                          CSW200
     C                     PARM           SDCNST                          CSW200
     C                     PARM           MEBICD                          CSW200
     C                     PARM *BLANKS   WKCUST                          CSW200
     C                     PARM *BLANKS   WKCNST                          CSW200
     C                     PARM *BLANKS   WKBICD                          CSW200
      *                                                                   CSW200
      *  If a SWIFT BIC has not been entered                              CSW200
      *                                                                   CSW200
     C           WKBICD    IFNE 'Y'                                       CSW200
     C           WKCUST    ANDNE'Y'                                       CSW200
     C           WKCNST    ANDNE'Y'                                       CSW200
      *                                                                   CSW200
     C                     EXSR SRZA                                      CSW200
      *                                                                   CSW200
      *  A SWIFT BIC has been entered                                     CSW200
     C                     ELSE                                           CSW200
      *                                                                   CSW200
     C                     MOVEL##PER1    ERCD,E                          CSW200
     C                     ADD  1         E                               CSW200
     C                     MOVEL'Y'       E#ERRM                          CSW200
      * Send error message                                                CSW200
      *                                                                   CSW200
     C                     MOVEL'MEC0040' MEMSID                          CSW200
     C                     MOVEL'MEMSG'   MEMSGF                          CSW200
     C                     MOVEL*BLANKS   MEMSDT                          CSW200
     C                     EXSR SRSNMS                                    CSW200
     C                     GOTO EXBENF                                    CSW200
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
      * Real Time Clearing System Validation                              CSW200
      *                                                                   CSW200
     C                     MOVEL'985'     ##PER1                          CSW200
     C                     MOVEL'983'     ##PER3                          CSW200
     C           I#ACCL    IFEQ '//RT'                                    CSW200
     C           WRTFLG    ANDNE'Y'                                                         MD035349
     C                     EXSR SRRT                                      CSW200
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
      * New Zealand National Clearing Code ( not allowed for MT202)       CSW200
      *                                                                   CSW200
     C           I#ACCL    IFEQ '//NZ'                                    CSW200
     C                     MOVEL'985'     ERCD,E                          CSW200
     C                     ADD  1         E                               CSW200
     C                     MOVEL'Y'       E#ERRM                          CSW200
      * Send error message                                                CSW200
      *                                                                   CSW200
     C                     MOVEL'MEC0032' MEMSID                          CSW200
     C                     MOVEL'MEMSG'   MEMSGF                          CSW200
     C                     MOVEL*BLANKS   MEMSDT                          CSW200
     C                     EXSR SRSNMS                                    CSW200
     C                     GOTO EXBENF                                    CSW200
     C                     ENDIF                                          CSW200
      *                                                                                       CSW215
      ** China National Advanced Payment System (CNAPS) Code                                  CSW215
      *                                                                                       CSW215
     C           CSW215    IFEQ 'Y'                                                           CSW215
     C                     MOVEL'985'     ##PER1                                              CSW215
     C           I#ACCL    IFEQ '//CN'                                                        CSW215
     C                     EXSR SRCN                                                          CSW215
     C                     ENDIF                                                              CSW215
     C                     ENDIF                                                              CSW215
      *                                                                                       CSW202
     C           CSW202    IFEQ 'Y'                                                           CSW202
     C                     MOVEL'985'     ##PER1                                              CSW202
      *                                                                                       CSW202
      ** Validate new clearing code //GR (Hellenic Bank Identifier Code)                      CSW202
      *                                                                                       CSW202
     C           I#ACCL    IFEQ '//GR'                                                        CSW202
     C                     EXSR SRGR                                                          CSW202
     C                     ENDIF                                                              CSW202
      *                                                                                       CSW202
      ** //IN (Indian Financial System Code) when CSW202 is switched on                       CSW202
      *                                                                                       CSW202
     C           I#ACCL    IFEQ '//IN'                                                        CSW202
     C                     EXSR SRIN                                                          CSW202
     C                     ENDIF                                                              CSW202
      *                                                                                       CSW202
     C                     ENDIF                                                              CSW202
      *                                                                   CSW200
     C                     ELSE                                           CSW200
      *                                                                                       CSW202
      ** //GR or //IN not permitted if not MT202                                              CSW202
      *                                                                                       CSW202
     C           CSW202    IFEQ 'Y'                                                           CSW202
     C           I#ACCL    IFEQ '//GR'                                                        CSW202
     C           I#ACCL    OREQ '//IN'                                                        CSW202
     C                     MOVEL'846'     ERCD,E                                              CSW202
     C                     ADD  1         E                                                   CSW202
     C                     MOVEL'Y'       E#ERRM                                              CSW202
     C                     ENDIF                                                              CSW202
     C                     ENDIF                                                              CSW202
      *                                                                                       CSW202
     C           I#MTYP    IFEQ '100'                                     CSW200
     C           I#MTYP    OREQ '103'                                     CFT014
     C           I#ACCL    IFEQ '//HK'                                    CSW200
     C           I#ACCL    OREQ '//IE'                                    CSW200
     C           I#ACCL    OREQ '//PT'                                    CSW200
     C           I#ACCL    OREQ '//RU'                                    CSW200
     C           I#ACCL    OREQ '//ZA'                                    CSW200
     C           I#ACCL    OREQ '//RT'                                    CSW200
     C                     MOVEL'985'     ERCD,E                          CSW200
     C                     ADD  1         E                               CSW200
     C                     MOVEL'Y'       E#ERRM                          CSW200
      * Send error message                                                CSW200
      *                                                                   CSW200
     C                     MOVEL'MEC0033' MEMSID                          CSW200
     C                     MOVEL'MEMSG'   MEMSGF                          CSW200
     C                     MOVELI#ACCL    MEMSDT                          CSW200
     C                     EXSR SRSNMS                                    CSW200
     C                     GOTO EXBENF                                    CSW200
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
      * New Zealand National Clearing Code Validation                     CSW200
      *                                                                   CSW200
     C                     MOVEL'985'     ##PER1                          CSW200
     C           I#ACCL    IFEQ '//NZ'                                    CSW200
      *                                                                                       CSW201
     C           CSW201    IFEQ 'Y'                                                           CSW201
     C                     MOVEL##PER1    ERCD,E                                              CSW201
     C                     ADD  1         E                                                   CSW201
     C                     MOVEL'Y'       E#ERRM                                              CSW201
     C                     MOVEL'MEC0042' MEMSID                                              CSW201
     C                     MOVEL'MEMSG'   MEMSGF                                              CSW201
     C                     MOVEL*BLANKS   MEMSDT                                              CSW201
     C                     EXSR SRSNMS                                                        CSW201
     C                     GOTO EXBENF                                                        CSW201
     C                     ELSE                                                               CSW201
     C                     EXSR SRNZ                                      CSW200
     C                     ENDIF                                                              CSW201
      *                                                                                       CSW201
     C                     ENDIF                                          CSW200
      *                                                                                       CSW201
     C                     ELSE                                                               CSW201
      *                                                                                       CSW201
     C           I#ACCL    IFEQ '//NZ'                                                        CSW201
     C           CSW201    IFEQ 'Y'                                                           CSW201
     C                     MOVEL##PER1    ERCD,E                                              CSW201
     C                     ADD  1         E                                                   CSW201
     C                     MOVEL'Y'       E#ERRM                                              CSW201
     C                     MOVEL'MEC0042' MEMSID                                              CSW201
     C                     MOVEL'MEMSG'   MEMSGF                                              CSW201
     C                     MOVELI#ACCL    MEMSDT                                              CSW201
     C                     EXSR SRSNMS                                                        CSW201
     C                     GOTO EXBENF                                                        CSW201
     C                     ENDIF                                                              CSW201
     C                     ENDIF                                                              CSW201
      *                                                                                       CSW201
     C                     ENDIF                                          CSW200
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
      *                                                                   CSW200
      * If currency clearing extension validation then action
      *
     C           E#ERRM    IFEQ *BLANKS
     C           DPEXPM    ANDNE'*NONE'
     C           DPEXPM    ANDNE*BLANKS
     C                     EXSR SRCEXT
     C                     ENDIF
      *
      *  Unwind subroutine stack name
      *
     C           EXBENF    TAG
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     CSR                   ENDSR
      *****************************************************************
     C/EJECT
      *****************************************************************
      *                                                               *
      *  SROTHR   : Validate Other Details                            *
      *                                                               *
      *  CALLED BY: Main processing                                   *
      *                                                               *
      *****************************************************************
     CSR         SROTHR    BEGSR
      *
      *  Set up subroutine stack name
      *
     C                     ADD  1         Q
     C                     MOVEL'SROTHR'  @STK,Q
      *
      * Copy point for Other Institution Validation
     C/COPY WNCPYSRC,ME9940OTHR
      *
      *  Unwind subroutine stack name
      *
     C           EXOTHR    TAG
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     CSR                   ENDSR
      *****************************************************************
     C/EJECT
      *****************************************************************
      *                                                               *
      *  SRCUST   : Get Customer/Counterparty Nostro/ Bic Information *
      *                                                               *
      *  CALLED BY: Main processing                                   *
      *                                                               *
      *****************************************************************
     CSR         SRCUST    BEGSR
      *
      *  Set up subroutine stack name
      *
     C                     ADD  1         Q
     C                     MOVEL'SRCUST'  @STK,Q
      *
      * Copy point for Customer details
     C/COPY WNCPYSRC,ME9940CUST
      *
      * If a customer look up SDCUSTPD
     C           I#PRTT    IFEQ 'C'
     C           I#PRTT    OREQ 'X'
      *
      *  Call to access pgm for Customer details
      *
     C                     MOVELI#PRTY    P@CNUM
      *
     C                     CALL 'AOCUSTR0'             9090
     C                     PARM *BLANKS   P@RTCD  7
     C                     PARM '*KEY   ' P@OPTN  7
     C                     PARM           P@CNUM 10
     C                     PARM *BLANKS   P@KYST  7
     C           SDCUST    PARM *BLANKS   DSSDY
      *
     C           *IN90     IFEQ '1'
     C***********P@RTCD    OREQ *BLANKS                                   CSW098
     C           P@RTCD    ORNE *BLANKS                                   CSW098
     C           I#PRTT    ANDNE'X'
     C                     MOVEL'AOCUSTR0'W0FILE           ***************
     C                     MOVEL'*CALL'   W0KEY            * DB ERROR 01 *
     C                     Z-ADD1         W0ERNB           ***************
     C                     MOVEL'MEM5003' W0MSGD
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     ENDIF
      *
      * Need to check AOCNSTR0 if not successful in case it is a C/p N.                      BUG5638
     C           P@RTCD    IFEQ *BLANKS                                                      BUG5638
     C           *IN90     OREQ '1'                                                          BUG5638
     C           I#PRTT    ANDEQ'C'                                                          BUG5638
     C                     MOVEL'Y'       W9CUST
     C                     GOTO EXCUST
     C                     ENDIF                                                             BUG5638
      *
     C                     ENDIF
      *
      * If a customer or counterparty nostros look up SDCNSTPD
     C           I#PRTT    IFEQ 'X'
      *
      *  Call to access pgm for Counterpart Nostros
      *
     C                     MOVELI#PRTY    P@CNCD
      *
     C                     CALL 'AOCNSTR0'             9090
     C                     PARM *BLANKS   P@RTCD  7
     C                     PARM '*KEY   ' P@OPTN  7
     C                     PARM           P@CNCD  8
     C**********           PARM *BLANKS   P@KYST  7                       222373
     C********** SDCUST    PARM *BLANKS   DSSDY                                              BUG5638
     C           SDCNST    PARM *BLANKS   DSFDY                                              BUG5638
      *
     C           *IN90     IFEQ '1'
     C           P@RTCD    ORNE *BLANKS
     C**********           MOVEL'AOCNSTR0'W0FILE           ***************                    235725
     C**********           MOVEL'*CALL'   W0KEY            * DB ERROR 02 *                    235725
     C**********           Z-ADD2         W0ERNB           ***************                    235725
     C**********           MOVEL'MEM5003' W0MSGD                                              235725
     C**********           MOVEL'MIDAS  ' W0MSGF                                              235725
     C**********           EXSR SRERR                                                         235725
     C**********           ENDIF                                                              235725
     C                     MOVEL' '       W9CNST                                              235725
     C                     ELSE                                                               235725
      *
     C                     MOVEL'Y'       W9CNST
     C                     ENDIF                                                              235725
     C                     GOTO EXCUST
      *
     C                     ENDIF
      *
      * If a BIC use ME1400 to access information
     C           I#PRTT    IFEQ 'S'
      *
      *  Call Access object to validate identifier
      *
     C                     MOVELI#PRTY    W9BICC
     C           3         SUBSTI#PRTY:9  W9BICB
      *
     C                     CALL 'ME1400'
     C                     PARM *BLANKS   W9RTN   7
     C                     PARM           W9BICC  8
     C                     PARM           W9BICB  3
     C                     PARM           SDCUST
     C                     PARM           SDCNST
     C                     PARM           MEBICD
     C                     PARM *BLANKS   W9CUST  1
     C                     PARM *BLANKS   W9CNST  1
     C                     PARM *BLANKS   W9BICD  1
      *
     C                     SELEC
      *
      *  Record not found - S.W.I.F.T does not exist
      *
     C           W9RTN     WHEQ 'Y2U0005'
      * No action
      *
      *  Use data depending on file that the data exists on
      *
     C           W9BICD    WHEQ 'Y'
      *
     C           W9CUST    WHEQ 'Y'
      *
     C           W9CNST    WHEQ 'Y'
      *
     C                     ENDSL
      *
     C                     ENDIF
      *
      *  Unwind subroutine stack name
      *
     C           EXCUST    TAG
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     CSR                   ENDSR
      *****************************************************************
     C/EJECT
      *****************************************************************
      *                                                               *
      *  SRDCIN   : Validate /C/ and /D/                              *
      *                                                               *
      *  CALLED BY: SRINBK - Intermediary Institution                 *
      *             SRAWBK - Account with Institution                 *
      *             SRBENF - Beneficiary                              *
      *                                                               *
      *****************************************************************
     CSR         SRDCIN    BEGSR
      *
      *  Set up subroutine stack name
      *
     C                     ADD  1         Q
     C                     MOVEL'SRDCIN'  @STK,Q
      *
      * Copy point for /C/ and /D/ validation
     C/COPY WNCPYSRC,ME9940DCIN
      *
      ** First Character must be '/'
     C           I#ACC1    IFNE '/'
     C           I#PR      IFEQ 'REC'
     C                     MOVEL##RER1    ERCD,E
     C                     ELSE
     C                     MOVEL##PER1    ERCD,E
     C                     ENDIF
     C                     ADD  1         E
     C                     MOVEL'Y'       E#ERRM
      *
      * Send error message
      *
     C                     MOVEL'MEC0002' MEMSID
     C                     MOVEL'MEMSG'   MEMSGF
     C                     MOVEL*BLANKS   MEMSDT
     C                     EXSR SRSNMS
      *
      * Exit subroutine
      *
     C                     GOTO EXDCIN
     C                     ENDIF
      *
      ** If 1st & 3rd character are '/',
      ** then 2nd character must be 'C' or 'D'.
      *
     C           I#ACC1    IFEQ '/'
     C           I#ACC3    ANDEQ'/'
     C           I#ACC2    IFNE 'C'
     C           I#ACC2    ANDNE'D'
     C           I#PR      IFEQ 'REC'
     C                     MOVEL##RER2    ERCD,E
     C                     ELSE
     C                     MOVEL##PER2    ERCD,E
     C                     ENDIF
     C                     ADD  1         E
     C                     MOVEL'Y'       E#ERRM
      *
      * Send error message
      *
     C                     MOVEL'MEC0003' MEMSID
     C                     MOVEL'MEMSG'   MEMSGF
     C                     MOVEL*BLANKS   MEMSDT
     C                     EXSR SRSNMS
      *
      * Exit subroutine
      *
     C                     GOTO EXDCIN
     C                     END
     C                     END
      *
      *  Unwind subroutine stack name
      *
     C           EXDCIN    TAG
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     CSR                   ENDSR
      *****************************************************************
     C/EJECT
      *****************************************************************
      *                                                               *
      *  SRCCSY   : Validate Currency Clearing System codes           *
      *                                                               *
      *  CALLED BY: SRINBK - Intermediary Institution                 *
      *             SRAWBK - Account with Institution                 *
      *             SRBENF - Beneficiary                              *
      *                                                               *
      *****************************************************************
     CSR         SRCCSY    BEGSR
      *
      *  Set up subroutine stack name
      *
     C                     ADD  1         Q
     C                     MOVEL'SRCCSY'  @STK,Q
      *
      * Copy point for Currency Clearing System Validation
     C/COPY WNCPYSRC,ME9940CCSY
      *
      ** For CP, FW, BL and SW check currency is valid
     C           I#ACCL    IFEQ '//BL'
     C           I#ACCL    OREQ '//CC'
     C           I#ACCL    OREQ '//CH'
     C           I#ACCL    OREQ '//CP'
     C           I#ACCL    OREQ '//ES'
     C           CSW096    ANDEQ'CSW096'
     C           I#ACCL    OREQ '//FW'
     C           I#ACCL    OREQ '//IT'
     C           CSW096    ANDEQ'CSW096'
     C           I#ACCL    OREQ '//SC'
     C           I#ACCL    OREQ '//SW'
     C           I#ACCL    OREQ '//??'
     C           I#ACCL    OREQ '//AT'                                    CSW097
     C           CSW097    ANDEQ'CSW097'                                  CSW097
     C           I#ACCL    OREQ '//AU'                                    CSW097
     C           CSW097    ANDEQ'CSW097'                                  CSW097
     C           I#ACCL    OREQ '//RT'                                    142527
     C           CSW098    ANDEQ'CSW098'                                  142527
     C           I#ACCL    OREQ '//HK'                                    CSW200
     C           CSW200    ANDEQ'CSW200'                                  CSW200
     C           I#ACCL    OREQ '//IE'                                    CSW200
     C           CSW200    ANDEQ'CSW200'                                  CSW200
     C           I#ACCL    OREQ '//PT'                                    CSW200
     C           CSW200    ANDEQ'CSW200'                                  CSW200
     C           I#ACCL    OREQ '//RU'                                    CSW200
     C           CSW200    ANDEQ'CSW200'                                  CSW200
     C           I#ACCL    OREQ '//ZA'                                    CSW200
     C           CSW200    ANDEQ'CSW200'                                  CSW200
     C           I#ACCL    OREQ '//NZ'                                    CSW200
     C           CSW200    ANDEQ'CSW200'                                  CSW200
     C           I#ACCL    OREQ '//GR'                                                        CSW202
     C           CSW202    ANDEQ'Y'                                                           CSW202
     C           I#ACCL    OREQ '//IN'                                                        CSW202
     C           CSW202    ANDEQ'Y'                                                           CSW202
     C           I#ACCL    OREQ '//PL'                                                        CSW206
     C           CSW206    ANDEQ'Y'                                                           CSW206
     C           I#ACCL    OREQ '//CN'                                                        CSW215
     C           CSW215    ANDEQ'Y'                                                           CSW215
      *
      * Copy point for Currency Clearing System Validation
     C/COPY WNCPYSRC,ME9940CCS2
      *
      * Validate that Currency Combination exists
      *
      * If receive then use receive currency else pay currency
      *
     C                     MOVELI#PCCY    P@CYCD
     C           I#PR      IFEQ 'REC'
     C                     MOVELI#RCCY    P@CYCD  3
     C                     END
     C                     MOVELI#ACCS    P@CLSY  2
     C                     EXSR SRCHKC
      *
      * No reference exists therefore error
      *
     C           P@RTCD    IFNE *BLANKS
     C           I#PR      IFEQ 'REC'
     C                     MOVEL##RER2    ERCD,E
     C                     MOVELI#RCCY    MEMSDT    P
     C                     ELSE
     C                     MOVEL##PER2    ERCD,E
     C                     MOVELI#PCCY    MEMSDT    P
     C                     ENDIF
     C                     ADD  1         E
     C                     MOVEL'Y'       E#ERRM
      *
      * Send error message
      *
     C                     MOVEL'MEC0004' MEMSID
     C                     MOVEL'MEMSG'   MEMSGF
     C           I#ACCS    CAT  MEMSDT:0  MEMSDT
     C                     EXSR SRSNMS
      *                                                                                       CSW213
     C           CSW213    IFEQ 'Y'                                                           CSW213
     C                     MOVE 'Y'       E#WARN                                              CSW213
      ** Reset error field                                                                    CSW213
     C                     MOVEL'N'       E#ERRM                                              CSW213
     C                     ENDIF                                                              CSW213
      *
      * Exit subroutine
      *
     C                     GOTO EXCCSY
     C                     ENDIF
      *
      * If ?? then replace with selected record
      *
     C           I#ACCL    IFEQ '//??'
     C                     MOVELDPCLSY    I#ACCS
     C                     ENDIF
     C                     ENDIF
      *
      ** If Second Character is also '/'
      ** Must be Follwed by CP, FW, BL OR SW.
     C           I#ACC2    IFEQ '/'
     C           I#ACCL    IFNE '//BL'
     C           I#ACCL    ANDNE'//CC'
     C           I#ACCL    ANDNE'//CH'
     C           I#ACCL    ANDNE'//CP'
     C           I#ACCL    ANDNE'//ES'
     C           I#ACCL    ANDNE'//FW'
     C           I#ACCL    ANDNE'//IT'
     C           I#ACCL    ANDNE'//SC'
     C           I#ACCL    ANDNE'//SW'
     C           I#ACCL    ANDNE'//AT'                                    CSW097
     C           I#ACCL    ANDNE'//AU'                                    CSW097
     C           I#ACCL    ANDNE'//RT'                                    142527
     C           I#ACCL    ANDNE'//HK'                                    CSW200
     C           I#ACCL    ANDNE'//IE'                                    CSW200
     C           I#ACCL    ANDNE'//PT'                                    CSW200
     C           I#ACCL    ANDNE'//RU'                                    CSW200
     C           I#ACCL    ANDNE'//ZA'                                    CSW200
     C           I#ACCL    ANDNE'//NZ'                                    CSW200
     C           I#ACCL    ANDNE'//GR'                                                        CSW202
     C           I#ACCL    ANDNE'//IN'                                                        CSW202
     C           I#ACCL    ANDNE'//PL'                                                        CSW206
     C           I#ACCL    ANDNE'//CN'                                                        CSW215
     C           I#ACCL    OREQ '//IT'
     C           CSW096    ANDNE'CSW096'
     C           I#ACCL    OREQ '//ES'
     C           CSW096    ANDNE'CSW096'
     C           I#ACCL    OREQ '//AT'                                    CSW097
     C           CSW097    ANDNE'CSW097'                                  CSW097
     C           I#ACCL    OREQ '//AU'                                    CSW097
     C           CSW097    ANDNE'CSW097'                                  CSW097
     C           I#ACCL    OREQ '//RT'                                    142527
     C           CSW098    ANDNE'CSW098'                                  142527
     C           I#ACCL    OREQ '//HK'                                    CSW200
     C           CSW200    ANDNE'CSW200'                                  CSW200
     C           I#ACCL    OREQ '//IE'                                    CSW200
     C           CSW200    ANDNE'CSW200'                                  CSW200
     C           I#ACCL    OREQ '//PT'                                    CSW200
     C           CSW200    ANDNE'CSW200'                                  CSW200
     C           I#ACCL    OREQ '//RU'                                    CSW200
     C           CSW200    ANDNE'CSW200'                                  CSW200
     C           I#ACCL    OREQ '//ZA'                                    CSW200
     C           CSW200    ANDNE'CSW200'                                  CSW200
     C           I#ACCL    OREQ '//NZ'                                    CSW200
     C           CSW200    ANDNE'CSW200'                                  CSW200
     C           I#ACCL    OREQ '//GR'                                                        CSW202
     C           CSW202    ANDNE'Y'                                                           CSW202
     C           I#ACCL    OREQ '//IN'                                                        CSW202
     C           CSW202    ANDNE'Y'                                                           CSW202
     C           I#ACCL    OREQ '//PL'                                                        CSW206
     C           CSW206    ANDNE'Y'                                                           CSW206
     C           I#ACCL    OREQ '//CN'                                                        CSW215
     C           CSW215    ANDNE'Y'                                                           CSW215
      *
      * Copy point for Currency Clearing System Validation
     C/COPY WNCPYSRC,ME9940CCS3
     C                     MOVELI#PCCY    P@CYCD                                            AR589197
     C           I#PR      IFEQ 'REC'                                                       AR589197
     C                     MOVELI#RCCY    P@CYCD  3                                         AR589197
     C                     END                                                              AR589197
     C                     MOVELI#ACCS    P@CLSY  2                                         AR589197
     C                     EXSR SRCHKC                                                      AR589197
      *                                                                                     AR589197
      * No reference exists therefore error                                                 AR589197
      *                                                                                     AR589197
     C           P@RTCD    IFNE *BLANKS                                                     AR589197
     C           I#PR      IFEQ 'REC'
     C                     MOVEL##RER1    ERCD,E
     C                     ELSE
     C                     MOVEL##PER1    ERCD,E
     C                     ENDIF
     C                     ADD  1         E
     C                     MOVEL'Y'       E#ERRM
      *
      * Send error message
      *
     C                     MOVEL'MEC0005' MEMSID
     C                     MOVEL'MEMSG'   MEMSGF
     C                     MOVELI#ACCS    MEMSDT
     C                     EXSR SRSNMS
     C                     ENDIF                                                            AR589197
      *
      * Exit subroutine
      *
     C                     GOTO EXCCSY
     C                     END
     C/COPY WNCPYSRC,ME9940C004
     C                     END
      *
      *  Unwind subroutine stack name
      *
     C           EXCCSY    TAG
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     CSR                   ENDSR
     C/EJECT
      *****************************************************************
      *                                                               *
      *  SRCHKC   : Check Currency Combination                        *
      *                                                               *
      *  CALLED BY: SRINBK - Intermediary Institution                 *
      *             SRAWBK - Account with Institution                 *
      *             SRBENF - Beneficiary                              *
      *                                                               *
      *****************************************************************
     CSR         SRCHKC    BEGSR
      *
      *  Set up subroutine stack name
      *
     C                     ADD  1         Q
     C                     MOVEL'SRCHKC'  @STK,Q
      *
      * Copy point for Currency Clearing System Get Details
     C/COPY WNCPYSRC,ME9940CHKC
      *
      * Use access object to obtain details
      *
     C                     CALL 'AOCCSYR0'             9090
     C                     PARM *BLANKS   P@RTCD
     C                     PARM '*KEY    'P@OPTN
     C                     PARM           P@CYCD  3
     C                     PARM           P@CLSY  2
     C           DSCCSY    PARM *BLANKS   DSFDY
      *
      *  If return with an error (LR seton in called program) then
      *  process for database error.
      *
     C           *IN90     IFEQ '1'
     C           P@RTCD    OREQ '*ERROR*'
     C                     MOVEL'AOCCSYR0'W0FILE
     C                     MOVEL'*CALL'   W0KEY            ***************
     C                     Z-ADD3         W0ERNB           * DB ERROR 03 *
     C                     MOVEL'MEM5003' W0MSGD           ***************
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     END
      *                                                                   CSW098
     C           P@RTCD    IFEQ *BLANKS                                   CSW098
     C           CSW098    ANDEQ'CSW098 '                                 CSW098
     C                     MOVELDPISCD    Z#PARM                          CSW098
     C                     ENDIF                                          CSW098
      *
      *  Unwind subroutine stack name
      *
     C           EXCHKC    TAG
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     CSR                   ENDSR
      *****************************************************************
     C/EJECT
      *****************************************************************
      *                                                               *
      *  SRBL     : Bankleitzahl Validation                           *
      *                                                               *
      *  CALLED BY: SRINBK - Intermediary Institution                 *
      *             SRAWBK - Account with Institution                 *
      *             SRBENF - Beneficiary                              *
      *                                                               *
      *****************************************************************
     CSR         SRBL      BEGSR
      *
      *  Set up subroutine stack name
      *
     C                     ADD  1         Q
     C                     MOVEL'SRBL  '  @STK,Q
      *
      * Copy point for Bankleitzahl Validation
     C/COPY WNCPYSRC,ME9940BL
      *
      ** If BL and followed by blanks then default this to the
      ** customers Bankleitzahl only if customer details available
     C           W9CUST    IFEQ 'Y'
     C           I#SPC1    ANDEQ*BLANK
     C           BBBLCD    ANDNE*BLANKS
     C                     MOVELBBBLCD    I#SPC1
     C                     ENDIF
      *
      ** If //BL it must be followed by a 8 digit number. The number
      ** must be followed by blanks.
      *
      * Check if this is preceded by a real time clearing code            CSW200
      *                                                                   CSW200
     C           I#ACCL    IFEQ '//RT'                                    CSW200
     C                     MOVE *BLANKS   ##FLD                           CSW200
     C                     SUBSTI#ACLN:5  ##FLD                           CSW200
     C                     ELSE                                           CSW200
     C                     MOVELI#ACLN    ##FLD  35 P
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
     C           DIGITS    CHECK##FLD:5   Y#      50     90
      *
      *  If *IN90 if off i.e. field is completely filled set it on
      *
     C           *IN90     IFEQ *OFF
     C                     MOVEL*ON       *IN90
     C                     ENDIF
      *
      *  8 Numeric follwowed by blanks
      *
     C           *IN90     IFEQ *ON
     C           Y#        ANDEQ13
      *
     C           ' '       CHECK##FLD:13  Y#             90
      *
     C                     ENDIF
      *
      * Invalid if *IN90 on
      *
     C           *IN90     IFEQ *ON
     C           I#PR      IFEQ 'REC'
     C                     MOVEL##RER1    ERCD,E
     C                     ELSE
     C                     MOVEL##PER1    ERCD,E
     C                     ENDIF
     C                     ADD  1         E
     C                     MOVEL'Y'       E#ERRM
      *                                                                   CSW200
      ** adjust the error position                                        CSW200
      *                                                                   CSW200
     C           I#ACCL    IFEQ '//RT'                                    CSW200
     C                     ADD  4         Y#                              CSW200
     C                     ENDIF                                          CSW200
      *
      * Send error message
      *
     C                     MOVEL'MEC0006' MEMSID
     C                     MOVEL'MEMSG'   MEMSGF
     C                     MOVELY#        MEMSDT
     C                     EXSR SRSNMS
      *
      * Exit subroutine
      *
     C                     GOTO EXBL
     C                     ENDIF
      *
      *  Unwind subroutine stack name
      *
     C           EXBL      TAG
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     CSR                   ENDSR
      *****************************************************************
     C/EJECT
      *****************************************************************
      *                                                               *
      *  SRCC     : Canadian Clearing Validation                      *
      *                                                               *
      *  CALLED BY: SRINBK - Intermediary Institution                 *
      *             SRAWBK - Account with Institution                 *
      *             SRBENF - Beneficiary                              *
      *                                                               *
      *****************************************************************
     CSR         SRCC      BEGSR
      *
      *  Set up subroutine stack name
      *
     C                     ADD  1         Q
     C                     MOVEL'SRCC  '  @STK,Q
      *
      * Copy point for Canadian Domestic Clearing Validation
     C/COPY WNCPYSRC,ME9940CC
      *
      ** If //CC it must be followed by a 9 digit number. The number
      ** must be followed by blanks.
      *
      * Check if this is preceded by a real time clearing code            CSW200
      *                                                                   CSW200
     C           I#ACCL    IFEQ '//RT'                                    CSW200
     C                     MOVE *BLANKS   ##FLD                           CSW200
     C                     SUBSTI#ACLN:5  ##FLD                           CSW200
     C                     ELSE                                           CSW200
     C                     MOVELI#ACLN    ##FLD     P
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
     C           DIGITS    CHECK##FLD:5   Y#             90
      *
      *  If *IN90 if off i.e. field is completely filled set it on
      *
     C           *IN90     IFEQ *OFF
     C                     MOVEL*ON       *IN90
     C                     ENDIF
      *
      *  9 Numeric follwowed by blanks
      *
     C           *IN90     IFEQ *ON
     C           Y#        ANDEQ14
      *
     C           ' '       CHECK##FLD:14  Y#             90
      *
     C                     ENDIF
      *
      * Invalid if *IN90 on
      *
     C           *IN90     IFEQ *ON
     C           I#PR      IFEQ 'REC'
     C                     MOVEL##RER1    ERCD,E
     C                     ELSE
     C                     MOVEL##PER1    ERCD,E
     C                     ENDIF
     C                     ADD  1         E
     C                     MOVEL'Y'       E#ERRM
      *                                                                   CSW200
      ** adjust the error position                                        CSW200
      *                                                                   CSW200
     C           I#ACCL    IFEQ '//RT'                                    CSW200
     C                     ADD  4         Y#                              CSW200
     C                     ENDIF                                          CSW200
      *
      * Send error message
      *
     C                     MOVEL'MEC0007' MEMSID
     C                     MOVEL'MEMSG'   MEMSGF
     C                     MOVELY#        MEMSDT
     C                     EXSR SRSNMS
      *
      * Exit subroutine
      *
     C                     GOTO EXCC
     C                     ENDIF
      *
      *  Unwind subroutine stack name
      *
     C           EXCC      TAG
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     CSR                   ENDSR
      *****************************************************************
     C/EJECT                                                              CSW097
      *****************************************************************   CSW097
      *                                                               *   CSW097
      *  SRAT     : Validate Austrian Clearing Code                   *   CSW097
      *                                                               *   CSW097
      *  CALLED BY: SRINBK - Intermediary Institution                 *   CSW097
      *             SRAWBK - Account with Institution                 *   CSW097
      *             SRBENF - Beneficiary                              *   CSW097
      *                                                               *   CSW097
      *****************************************************************   CSW097
     CSR         SRAT      BEGSR                                          CSW097
      *                                                                   CSW097
      *  Set up subroutine stack name                                     CSW097
      *                                                                   CSW097
     C                     ADD  1         Q                               CSW097
     C                     MOVEL'SRAT  '  @STK,Q                          CSW097
      *                                                                   CSW097
      * Copy point for Austrian Bankleitzahl Validation                   CSW097
     C/COPY WNCPYSRC,ME9940AT                                             CSW097
      *                                                                   CSW097
      ** If //AT it must be followed by a 5 digit number. The number      CSW097
      ** must be followed by blanks.                                      CSW097
      *                                                                   CSW097
      * Check if this is preceded by a real time clearing code            CSW200
      *                                                                   CSW200
     C           I#ACCL    IFEQ '//RT'                                    CSW200
     C                     MOVE *BLANKS   ##FLD                           CSW200
     C                     SUBSTI#ACLN:5  ##FLD                           CSW200
     C                     ELSE                                           CSW200
     C                     MOVELI#ACLN    ##FLD     P                     CSW097
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
     C           DIGITS    CHECK##FLD:5   Y#             90               CSW097
      *                                                                   CSW097
      *  If *IN90 if off i.e. field is completely filled set it on        CSW097
      *                                                                   CSW097
     C           *IN90     IFEQ *OFF                                      CSW097
     C                     MOVEL*ON       *IN90                           CSW097
     C                     ENDIF                                          CSW097
      *                                                                   CSW097
      *  5 Numeric followed by blanks                                     CSW097
      *                                                                   CSW097
     C           *IN90     IFEQ *ON                                       CSW097
     C           Y#        ANDEQ10                                        CSW097
      *                                                                   CSW097
     C           ' '       CHECK##FLD:10  Y#             90               CSW097
      *                                                                   CSW097
     C                     ENDIF                                          CSW097
      *                                                                   CSW097
      * Invalid if *IN90 on                                               CSW097
      *                                                                   CSW097
     C           *IN90     IFEQ *ON                                       CSW097
     C           I#PR      IFEQ 'REC'                                     CSW097
     C                     MOVEL##RER1    ERCD,E                          CSW097
     C                     ELSE                                           CSW097
     C                     MOVEL##PER1    ERCD,E                          CSW097
     C                     ENDIF                                          CSW097
     C                     ADD  1         E                               CSW097
     C                     MOVEL'Y'       E#ERRM                          CSW097
      *                                                                   CSW200
      ** adjust the error position                                        CSW200
      *                                                                   CSW200
     C           I#ACCL    IFEQ '//RT'                                    CSW200
     C                     ADD  4         Y#                              CSW200
     C                     ENDIF                                          CSW200
      *                                                                   CSW097
      * Send error message                                                CSW097
      *                                                                   CSW097
     C                     MOVEL'MEC0300' MEMSID                          CSW097
     C                     MOVEL'MEMSG'   MEMSGF                          CSW097
     C                     MOVELY#        MEMSDT                          CSW097
     C                     EXSR SRSNMS                                    CSW097
      *                                                                   CSW097
      * Exit subroutine                                                   CSW097
      *                                                                   CSW097
     C                     GOTO EXAT                                      CSW097
     C                     ENDIF                                          CSW097
      *                                                                   CSW097
      *  Unwind subroutine stack name                                     CSW097
      *                                                                   CSW097
     C           EXAT      TAG                                            CSW097
     C                     MOVEA*BLANKS   @STK,Q                          CSW097
     C                     SUB  1         Q                               CSW097
      *                                                                   CSW097
     CSR                   ENDSR                                          CSW097
      *****************************************************************   CSW097
     C/EJECT                                                              CSW097
      *****************************************************************   CSW097
      *                                                               *   CSW097
      *  SRAU     : Validate Australian Clearing Code                 *   CSW097
      *                                                               *   CSW097
      *  CALLED BY: SRINBK - Intermediary Institution                 *   CSW097
      *             SRAWBK - Account with Institution                 *   CSW097
      *             SRBENF - Beneficiary                              *   CSW097
      *                                                               *   CSW097
      *****************************************************************   CSW097
     CSR         SRAU      BEGSR                                          CSW097
      *                                                                   CSW097
      *  Set up subroutine stack name                                     CSW097
      *                                                                   CSW097
     C                     ADD  1         Q                               CSW097
     C                     MOVEL'SRAU  '  @STK,Q                          CSW097
      *                                                                   CSW097
      * Copy point for Australian Bank State Code Validation              CSW097
     C/COPY WNCPYSRC,ME9940AU                                             CSW097
      *                                                                   CSW097
      ** If //AU it must be followed by a 6 digit number. The number      CSW097
      ** must be followed by blanks.                                      CSW097
      *                                                                   CSW097
      * Check if this is preceded by a real time clearing code            CSW200
      *                                                                   CSW200
     C           I#ACCL    IFEQ '//RT'                                    CSW200
     C                     MOVE *BLANKS   ##FLD                           CSW200
     C                     SUBSTI#ACLN:5  ##FLD                           CSW200
     C                     ELSE                                           CSW200
     C                     MOVELI#ACLN    ##FLD     P                     CSW097
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
     C           DIGITS    CHECK##FLD:5   Y#             90               CSW097
      *                                                                   CSW097
      *  If *IN90 if off i.e. field is completely filled set it on        CSW097
      *                                                                   CSW097
     C           *IN90     IFEQ *OFF                                      CSW097
     C                     MOVEL*ON       *IN90                           CSW097
     C                     ENDIF                                          CSW097
      *                                                                   CSW097
      *  6 Numeric followed by blanks                                     CSW097
      *                                                                   CSW097
     C           *IN90     IFEQ *ON                                       CSW097
     C           Y#        ANDEQ11                                        CSW097
      *                                                                   CSW097
     C           ' '       CHECK##FLD:11  Y#             90               CSW097
      *                                                                   CSW097
     C                     ENDIF                                          CSW097
      *                                                                   CSW097
      * Invalid if *IN90 on                                               CSW097
      *                                                                   CSW097
     C           *IN90     IFEQ *ON                                       CSW097
     C           I#PR      IFEQ 'REC'                                     CSW097
     C                     MOVEL##RER1    ERCD,E                          CSW097
     C                     ELSE                                           CSW097
     C                     MOVEL##PER1    ERCD,E                          CSW097
     C                     ENDIF                                          CSW097
     C                     ADD  1         E                               CSW097
     C                     MOVEL'Y'       E#ERRM                          CSW097
      *                                                                   CSW200
      ** adjust the error position                                        CSW200
      *                                                                   CSW200
     C           I#ACCL    IFEQ '//RT'                                    CSW200
     C                     ADD  4         Y#                              CSW200
     C                     ENDIF                                          CSW200
      *                                                                   CSW097
      * Send error message                                                CSW097
      *                                                                   CSW097
     C                     MOVEL'MEC0301' MEMSID                          CSW097
     C                     MOVEL'MEMSG'   MEMSGF                          CSW097
     C                     MOVELY#        MEMSDT                          CSW097
     C                     EXSR SRSNMS                                    CSW097
      *                                                                   CSW097
      * Exit subroutine                                                   CSW097
      *                                                                   CSW097
     C                     GOTO EXAU                                      CSW097
     C/COPY WNCPYSRC,ME9940C009
     C                     ENDIF                                          CSW097
      *                                                                   CSW097
      *  Unwind subroutine stack name                                     CSW097
      *                                                                   CSW097
     C           EXAU      TAG                                            CSW097
     C                     MOVEA*BLANKS   @STK,Q                          CSW097
     C                     SUB  1         Q                               CSW097
      *                                                                   CSW097
     CSR                   ENDSR                                          CSW097
      *****************************************************************   CSW097
     C/EJECT
      *****************************************************************
      *                                                               *
      *  SRCH     : CHIPS Universal id. Validation                    *
      *                                                               *
      *  CALLED BY: SRINBK - Intermediary Institution                 *
      *             SRAWBK - Account with Institution                 *
      *             SRBENF - Beneficiary                              *
      *                                                               *
      *****************************************************************
     CSR         SRCH      BEGSR
      *
      *  Set up subroutine stack name
      *
     C                     ADD  1         Q
     C                     MOVEL'SRCH  '  @STK,Q
      *
      * Copy point for CHIPS Universal id. Validation
     C/COPY WNCPYSRC,ME9940CH
      *
      ** If CH and followed by blanks then default this to the
      ** customers CHIPS Universal id only if customer details available
     C           W9CUST    IFEQ 'Y'
     C           I#SPC1    ANDEQ*BLANK
     C           BBCHID    ANDNE0
     C                     MOVELBBCHID    I#SPC1
     C                     ENDIF
      *
      ** If //CH it must be followed by a 6 digit number. The number
      ** must be followed by blanks.
      *
      * Check if this is preceded by a real time clearing code            CSW200
      *                                                                   CSW200
     C           I#ACCL    IFEQ '//RT'                                    CSW200
     C                     MOVE *BLANKS   ##FLD                           CSW200
     C                     SUBSTI#ACLN:5  ##FLD                           CSW200
     C                     ELSE                                           CSW200
     C                     MOVELI#ACLN    ##FLD     P
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
     C           DIGITS    CHECK##FLD:5   Y#             90
      *
      *  If *IN90 if off i.e. field is completely filled set it on
      *
     C           *IN90     IFEQ *OFF
     C                     MOVEL*ON       *IN90
     C                     ENDIF
      *
      *  6 Numeric follwowed by blanks
      *
     C           *IN90     IFEQ *ON
     C           Y#        ANDEQ11
      *
     C           ' '       CHECK##FLD:11  Y#             90
      *
     C                     ENDIF
      *
      * Invalid if *IN90 on
      *
     C           *IN90     IFEQ *ON
     C           I#PR      IFEQ 'REC'
     C                     MOVEL##RER1    ERCD,E
     C                     ELSE
     C                     MOVEL##PER1    ERCD,E
     C                     ENDIF
     C                     ADD  1         E
     C                     MOVEL'Y'       E#ERRM
      *                                                                   CSW200
      ** adjust the error position                                        CSW200
      *                                                                   CSW200
     C           I#ACCL    IFEQ '//RT'                                    CSW200
     C                     ADD  4         Y#                              CSW200
     C                     ENDIF                                          CSW200
      *
      * Send error message
      *
     C                     MOVEL'MEC0008' MEMSID
     C                     MOVEL'MEMSG'   MEMSGF
     C                     MOVELY#        MEMSDT
     C                     EXSR SRSNMS
      *
      * Exit subroutine
      *
     C                     GOTO EXCH
     C                     ENDIF
      *
      *  Unwind subroutine stack name
      *
     C           EXCH      TAG
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     CSR                   ENDSR
      *****************************************************************
     C/EJECT
      *****************************************************************
      *                                                               *
      *  SRCP     : CHIPS Participant Validation                      *
      *                                                               *
      *  CALLED BY: SRINBK - Intermediary Institution                 *
      *             SRAWBK - Account with Institution                 *
      *             SRBENF - Beneficiary                              *
      *                                                               *
      *****************************************************************
     CSR         SRCP      BEGSR
      *
      *  Set up subroutine stack name
      *
     C                     ADD  1         Q
     C                     MOVEL'SRCP  '  @STK,Q
      *
      * Copy point for CHIPS Participant Validation
     C/COPY WNCPYSRC,ME9940CP
      *
      ** If CP and followed by blanks then default this to the
      ** customers CHIPS Participant only if customer details available
     C           W9CUST    IFEQ 'Y'
     C           I#SPC1    ANDEQ*BLANK
     C           BBABA2    ANDNE0
     C                     MOVELBBABA2    I#SPC1
     C                     ENDIF
      *
      ** If //CP it must be followed by a 4 digit number. The number
      ** must be followed by blanks.
      *
      * Check if this is preceded by a real time clearing code            CSW200
      *                                                                   CSW200
     C           I#ACCL    IFEQ '//RT'                                    CSW200
     C                     MOVE *BLANKS   ##FLD                           CSW200
     C                     SUBSTI#ACLN:5  ##FLD                           CSW200
     C                     ELSE                                           CSW200
     C                     MOVELI#ACLN    ##FLD     P
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
     C           DIGITS    CHECK##FLD:5   Y#             90
      *
      *  If *IN90 if off i.e. field is completely filled set it on
      *
     C           *IN90     IFEQ *OFF
     C                     MOVEL*ON       *IN90
     C                     ENDIF
      *
      *  4 Numeric follwowed by blanks
      *
     C           *IN90     IFEQ *ON
     C           Y#        ANDEQ9
      *
     C           ' '       CHECK##FLD:9   Y#             90
      *
     C                     ENDIF
      *
      * Invalid if *IN90 on
      *
     C           *IN90     IFEQ *ON
     C           I#PR      IFEQ 'REC'
     C                     MOVEL##RER1    ERCD,E
     C                     ELSE
     C                     MOVEL##PER1    ERCD,E
     C                     ENDIF
     C                     ADD  1         E
     C                     MOVEL'Y'       E#ERRM
      *                                                                   CSW200
      ** adjust the error position                                        CSW200
      *                                                                   CSW200
     C           I#ACCL    IFEQ '//RT'                                    CSW200
     C                     ADD  4         Y#                              CSW200
     C                     ENDIF                                          CSW200
      *
      * Send error message
      *
     C                     MOVEL'MEC0009' MEMSID
     C                     MOVEL'MEMSG'   MEMSGF
     C                     MOVELY#        MEMSDT
     C                     EXSR SRSNMS
      *
      * Exit subroutine
      *
     C                     GOTO EXCP
     C                     ENDIF
      *
      *  Unwind subroutine stack name
      *
     C           EXCP      TAG
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     CSR                   ENDSR
      *****************************************************************
     C/EJECT
      *****************************************************************
      *                                                               *
      *  SRES     : Spanish Domestic Validation                       *
      *                                                               *
      *  CALLED BY: SRINBK - Intermediary Institution                 *
      *             SRAWBK - Account with Institution                 *
      *             SRBENF - Beneficiary                              *
      *                                                               *
      *****************************************************************
     CSR         SRES      BEGSR
      *
      *  Set up subroutine stack name
      *
     C                     ADD  1         Q
     C                     MOVEL'SRES  '  @STK,Q
      *
      * Copy point for Spanish Domestic Validation
     C/COPY WNCPYSRC,ME9940ES
      *
      ** If //ES it must be followed by a 8 digit number. The number
      ** must be followed by blanks with an optional check digit
      *
      * Check if this is preceded by a real time clearing code            CSW200
      *                                                                   CSW200
     C           I#ACCL    IFEQ '//RT'                                    CSW200
     C                     MOVE *BLANKS   ##FLD                           CSW200
     C                     SUBSTI#ACLN:5  ##FLD                           CSW200
     C                     ELSE                                           CSW200
     C                     MOVELI#ACLN    ##FLD     P
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
     C           DIGITS    CHECK##FLD:5   Y#             90
      *
      *  If *IN90 if off i.e. field is completely filled set it on
      *
     C           *IN90     IFEQ *OFF
     C                     MOVEL*ON       *IN90
     C                     ENDIF
      *
      *  8-9 Numeric follwowed by blanks
      *
     C           *IN90     IFEQ *ON
     C           Y#        ANDEQ13
     C           *IN90     OREQ *ON
     C           Y#        ANDEQ14
      *
     C                     SELEC
      * 8 numeric detected
     C           Y#        WHEQ 13
     C           ALPHAN    CHECK##FLD:13  Y#             90
      *
      * if 9th is valid
     C           *IN90     IFEQ *ON
     C           Y#        ANDEQ14
     C           ' '       CHECK##FLD:14  Y#             90
     C                     ENDIF
      *
      * if 9th is invalid test for blanks
     C           *IN90     IFEQ *ON
     C           Y#        ANDEQ13
     C           ' '       CHECK##FLD:13  Y#             90
     C                     ENDIF
      *
      * if 9th is valid test for blanks
     C           Y#        WHEQ 14
     C           ' '       CHECK##FLD:14  Y#             90
     C                     ENDSL
      *
     C                     ENDIF
      *
      * Invalid if *IN90 on
      *
     C           *IN90     IFEQ *ON
     C           I#PR      IFEQ 'REC'
     C                     MOVEL##RER1    ERCD,E
     C                     ELSE
     C                     MOVEL##PER1    ERCD,E
     C                     ENDIF
     C                     ADD  1         E
     C                     MOVEL'Y'       E#ERRM
      *                                                                   CSW200
      ** adjust the error position                                        CSW200
      *                                                                   CSW200
     C           I#ACCL    IFEQ '//RT'                                    CSW200
     C                     ADD  4         Y#                              CSW200
     C                     ENDIF                                          CSW200
      *
      * Send error message
      *
     C                     MOVEL'MEC0010' MEMSID
     C                     MOVEL'MEMSG'   MEMSGF
     C                     MOVELY#        MEMSDT
     C                     EXSR SRSNMS
      *
      * Exit subroutine
      *
     C                     GOTO EXES
     C                     ENDIF
      *
      *  Unwind subroutine stack name
      *
     C           EXES      TAG
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     CSR                   ENDSR
      *****************************************************************
     C/EJECT
      *****************************************************************
      *                                                               *
      *  SRFW     : Fedwire Validation                                *
      *                                                               *
      *  CALLED BY: SRINBK - Intermediary Institution                 *
      *             SRAWBK - Account with Institution                 *
      *             SRBENF - Beneficiary                              *
      *                                                               *
      *****************************************************************
     CSR         SRFW      BEGSR
      *
      *  Set up subroutine stack name
      *
     C                     ADD  1         Q
     C                     MOVEL'SRFW  '  @STK,Q
      *
      * If //FW in an :5nA: then no number allowed
      *
      **Only*check if post SWIFT changes Novemebr 96                                          195588
      **********                                                                              195588
     C********** CSW096    IFEQ 'CSW096'                                                      195588
      **********                                                                              195588
     C********** W9CUST    IFEQ 'Y'                                                           195588
     C********** I#SPC1    ANDNE*BLANK                                                        195588
     C********** BBCSID    ANDNE*BLANKS                                                       195588
     C********** W9CUST    OREQ 'Y'                                                           195588
     C********** AWSWID    ANDNE*BLANKS                                                       195588
     C********** I#SPC1    ANDNE*BLANK                                                        195588
     C********** I#PRTT    OREQ 'S'                                                           195588
     C********** I#SPC1    ANDNE*BLANK                                                        195588
      **********                                                                              195588
     C********** I#PR      IFEQ 'REC'                                                         195588
     C**********           MOVEL##RER1    ERCD,E                                              195588
     C**********           ELSE                                                               195588
     C**********           MOVEL##PER1    ERCD,E                                              195588
     C**********           ENDIF                                                              195588
     C**********           ADD  1         E                                                   195588
     C**********           MOVEL'Y'       E#ERRM                                              195588
      **********                                                                              195588
      **Send*error message                                                                    195588
      **********                                                                              195588
     C**********           MOVEL'MEC0020' MEMSID                                              195588
     C**********           MOVEL'MEMSG'   MEMSGF                                              195588
     C**********           MOVELY#        MEMSDT                                              195588
     C**********           EXSR SRSNMS                                                        195588
      **********                                                                              195588
      **Exit*subroutine                                                                       195588
      **********                                                                              195588
     C**********           GOTO EXFW                                                          195588
      **********                                                                              195588
     C**********           ENDIF                                                              195588
     C**********           ENDIF                                                              195588
      *
      * Copy point for Fedwire Validation
     C/COPY WNCPYSRC,ME9940FW
      *
      **No*action if //FW in an :5nA: with no number                                          195588
     C********** W9CUST    IFEQ 'Y'                                                           195588
     C********** I#SPC1    ANDEQ*BLANK                                                        195588
     C********** BBCSID    ANDNE*BLANKS                                                       195588
     C********** W9CUST    OREQ 'Y'                                                           195588
     C********** AWSWID    ANDNE*BLANKS                                                       195588
     C********** I#SPC1    ANDEQ*BLANK                                                        195588
     C********** I#PRTT    OREQ 'S'                                                           195588
     C********** I#SPC1    ANDEQ*BLANK                                                        195588
      **********                                                                              195588
     C**********           ELSE                                                               195588
      *
      ** If FW and followed by blanks then default this to the
      ** customers Fedwire only if customer details available
     C           W9CUST    IFEQ 'Y'
     C           I#SPC1    ANDEQ*BLANK
     C           BBFWCD    ANDNE0
     C                     MOVELBBFWCD    I#SPC1
     C                     ENDIF
      *                                                                                       CSD024
      ** If FW and followed by blanks then default this to                                    CSD024
      ** Fedwire Code from Counterparty Nostro File                                           CSD024
     C           CSD024    IFEQ 'Y'                                                           CSD024
     C           W9CNST    IFEQ 'Y'                                                           CSD024
     C           I#SPC1    ANDEQ*BLANK                                                        CSD024
     C           AWFWCD    ANDNE0                                                             CSD024
     C                     MOVELAWFWCD    I#SPC1                                              CSD024
     C                     ENDIF                                                              CSD024
     C                     ENDIF                                                              CSD024
      *
      ** If //FW it must be followed by a 9 digit number. The number
      ** must be followed by blanks.
      *
      * Check if this is preceded by a real time clearing code            CSW200
      *                                                                   CSW200
     C           I#ACCL    IFEQ '//RT'                                    CSW200
     C                     MOVE *BLANKS   ##FLD                           CSW200
     C                     SUBSTI#ACLN:5  ##FLD                           CSW200
     C                     ELSE                                           CSW200
     C                     MOVELI#ACLN    ##FLD     P
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
     C           DIGITS    CHECK##FLD:5   Y#             90
      *
      *  If *IN90 if off i.e. field is completely filled set it on
      *
     C           *IN90     IFEQ *OFF
     C                     MOVEL*ON       *IN90
     C                     ENDIF
      *
      *  9 Numeric follwowed by blanks
      *
     C           *IN90     IFEQ *ON
     C           Y#        ANDEQ14
      *
     C           ' '       CHECK##FLD:14  Y#             90
      *
     C                     ENDIF
      *
      * Invalid if *IN90 on
      *
     C           *IN90     IFEQ *ON
     C           I#PR      IFEQ 'REC'
     C                     MOVEL##RER1    ERCD,E
     C                     ELSE
     C                     MOVEL##PER1    ERCD,E
     C                     ENDIF
     C                     ADD  1         E
     C                     MOVEL'Y'       E#ERRM
      *                                                                   CSW200
      ** adjust the error position                                        CSW200
      *                                                                   CSW200
     C           I#ACCL    IFEQ '//RT'                                    CSW200
     C                     ADD  4         Y#                              CSW200
     C                     ENDIF                                          CSW200
      *
      * Send error message
      *
     C                     MOVEL'MEC0011' MEMSID
     C                     MOVEL'MEMSG'   MEMSGF
     C                     MOVELY#        MEMSDT
     C                     EXSR SRSNMS
      *
      * Exit subroutine
      *
     C                     GOTO EXFW
     C                     ENDIF
      *
     C**********           ENDIF                                                              195588
      *
      *  Unwind subroutine stack name
      *
     C           EXFW      TAG
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     CSR                   ENDSR
      *****************************************************************
     C/EJECT
      *****************************************************************
      *                                                               *
      *  SRIT     : Italian Domestic Validation                       *
      *                                                               *
      *  CALLED BY: SRINBK - Intermediary Institution                 *
      *             SRAWBK - Account with Institution                 *
      *             SRBENF - Beneficiary                              *
      *                                                               *
      *****************************************************************
     CSR         SRIT      BEGSR
      *
      *  Set up subroutine stack name
      *
     C                     ADD  1         Q
     C                     MOVEL'SRIT  '  @STK,Q
      *
      * Copy point for Italian Domestic Clearing Validation
     C/COPY WNCPYSRC,ME9940IT
      *
      ***If*//IT*it*must*be*followed*by*a*11-23*account.*The*numbe*****r*                   MD023689
      ***must*be*followed*by*blanks.                                                        MD023689
      ** If //IT it must be followed by a 10 account.                                       MD023689
      *
      *  ITBI format is:   1a = check digit
      *                    5n = bank code
      *                    5n = location code
      *                    up to 12x = account number
      *
      * Note that bank and location code must be fully specified
      *
      * Check if this is preceded by a real time clearing code            CSW200
      *                                                                   CSW200
     C           I#ACCL    IFEQ '//RT'                                    CSW200
     C                     MOVE *BLANKS   ##FLD                           CSW200
     C                     SUBSTI#ACLN:5  ##FLD                           CSW200
     C                     ELSE                                           CSW200
     C                     MOVELI#ACLN    ##FLD     P
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
     C********** ALPHAB    CHECK##FLD:5   Y#             90                                 MD023689
     C           DIGITS    CHECK##FLD:5   Y#      50     90                                 MD023689
      *
      *  If *IN90 if off i.e. field is completely filled set it on
      *
     C           *IN90     IFEQ *OFF
     C                     MOVEL*ON       *IN90
     C                     ENDIF
      *
     C********** *IN90     IFEQ *ON                                                         MD023689
     C********** Y#        ANDEQ6                                                           MD023689
      *
      **If*all*blanks*continue*at*end*continue***                                           MD023689
      *****and*blanks*start*before*29th*character***                                        MD023689
      *
     C********** ISOEXS    CHECK##FLD:6   Y#             90                                 MD023689
      *
      *  If *IN90 if off i.e. field is completely filled set it on
      *
     C********** *IN90     IFEQ *OFF                                                        MD023689
     C**********           MOVEL*ON       *IN90                                             MD023689
     C**********           ENDIF                                                            MD023689
      *
      ***11-23*Account*followed*by*blanks***                                                MD023689
      *
     C           *IN90     IFEQ *ON
     C********** Y#        ANDGE16                                                          MD023689
     C********** Y#        ANDLE28                                                          MD023689
      *
      **Save*ending*position***                                                             MD023689
      *
     C**********           Z-ADDY#        X#      50                                        MD023689
      *
      **Check*that*characters*2*to*11*are*numeric***                                        MD023689
      *                                                                                     MD023689
     C********** DIGITS    CHECK##FLD:6   Y#             90                                 MD023689
      *
     C********** *IN90     IFEQ *ON                                                         MD023689
     C********** Y#        ANDGE16                                                          MD023689
     C           Y#        ANDEQ15                                                          MD023689
     C********** ' '       CHECK##FLD:X#  Y#             90                                 MD023689
     C           ' '       CHECK##FLD:Y#  Y#             90                                 MD023689
     C                     ENDIF
     C**********           ENDIF                                                            MD023689
     C**********           ENDIF                                                            MD023689
      *
      * Invalid if *IN90 on
      *
     C           *IN90     IFEQ *ON
     C           I#PR      IFEQ 'REC'
     C                     MOVEL##RER1    ERCD,E
     C                     ELSE
     C                     MOVEL##PER1    ERCD,E
     C                     ENDIF
     C                     ADD  1         E
     C                     MOVEL'Y'       E#ERRM
      *                                                                   CSW200
      ** adjust the error position                                        CSW200
      *                                                                   CSW200
     C           I#ACCL    IFEQ '//RT'                                    CSW200
     C                     ADD  4         Y#                              CSW200
     C                     ENDIF                                          CSW200
      *
      * Send error message
      *
     C                     MOVEL'MEC0012' MEMSID
     C                     MOVEL'MEMSG'   MEMSGF
     C                     MOVELY#        MEMSDT
     C                     EXSR SRSNMS
      *
      * Exit subroutine
      *
     C                     GOTO EXIT
     C                     ENDIF
      *
      *  Unwind subroutine stack name
      *
     C           EXIT      TAG
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     CSR                   ENDSR
      *****************************************************************
     C/EJECT
      *****************************************************************
      *                                                               *
      *  SRSC     : CHAPS Sort Code Validation                        *
      *                                                               *
      *  CALLED BY: SRINBK - Intermediary Institution                 *
      *             SRAWBK - Account with Institution                 *
      *             SRBENF - Beneficiary                              *
      *                                                               *
      *****************************************************************
     CSR         SRSC      BEGSR
      *
      *  Set up subroutine stack name
      *
     C                     ADD  1         Q
     C                     MOVEL'SRSC  '  @STK,Q
      *
      * Copy point for CHAPS Sort Code Clearing Validation
     C/COPY WNCPYSRC,ME9940SC
      *
      ** If SC and followed by blanks then default this to the
      ** customers CHAPS Sort code only if customer details available
     C           W9CUST    IFEQ 'Y'
     C           I#SPC1    ANDEQ*BLANK
     C           BBCHSC    ANDNE0
     C                     MOVELBBCHSC    I#SPC1
     C                     ENDIF
      *
      ** If //SC it must be followed by a 6 digit number. The number
      ** must be followed by blanks.
      *
      * Check if this is preceded by a real time clearing code            CSW200
      *                                                                   CSW200
     C           I#ACCL    IFEQ '//RT'                                    CSW200
     C                     MOVE *BLANKS   ##FLD                           CSW200
     C                     SUBSTI#ACLN:5  ##FLD                           CSW200
     C                     ELSE                                           CSW200
     C                     MOVELI#ACLN    ##FLD     P
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
     C           DIGITS    CHECK##FLD:5   Y#             90
      *
      *  If *IN90 if off i.e. field is completely filled set it on
      *
     C           *IN90     IFEQ *OFF
     C                     MOVEL*ON       *IN90
     C                     ENDIF
      *
      *  6 Numeric follwowed by blanks
      *
     C           *IN90     IFEQ *ON
     C           Y#        ANDEQ11
      *
     C           ' '       CHECK##FLD:11  Y#             90
      *
     C                     ENDIF
      *
      * Invalid if *IN90 on
      *
     C           *IN90     IFEQ *ON
     C           I#PR      IFEQ 'REC'
     C                     MOVEL##RER1    ERCD,E
     C                     ELSE
     C                     MOVEL##PER1    ERCD,E
     C                     ENDIF
     C                     ADD  1         E
     C                     MOVEL'Y'       E#ERRM
      *                                                                   CSW200
      ** adjust the error position                                        CSW200
      *                                                                   CSW200
     C           I#ACCL    IFEQ '//RT'                                    CSW200
     C                     ADD  4         Y#                              CSW200
     C                     ENDIF                                          CSW200
      *
      * Send error message
      *
     C                     MOVEL'MEC0014' MEMSID
     C                     MOVEL'MEMSG'   MEMSGF
     C                     MOVELY#        MEMSDT
     C                     EXSR SRSNMS
      *
      * Exit subroutine
      *
     C                     GOTO EXSC
     C                     ENDIF
      *
      *  Unwind subroutine stack name
      *
     C           EXSC      TAG
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     CSR                   ENDSR
      *****************************************************************
     C/EJECT
      *****************************************************************
      *                                                               *
      *  SRSW     : Swiss Clearing Code Validation                    *
      *                                                               *
      *  CALLED BY: SRINBK - Intermediary Institution                 *
      *             SRAWBK - Account with Institution                 *
      *             SRBENF - Beneficiary                              *
      *                                                               *
      *****************************************************************
     CSR         SRSW      BEGSR
      *
      *  Set up subroutine stack name
      *
     C                     ADD  1         Q
     C                     MOVEL'SRSW  '  @STK,Q
      *
      * Copy point for SWISS Clearing Validation
     C/COPY WNCPYSRC,ME9940SW
      *
      ** If //SW it must be followed by a 3-6 digit number. The number
      ** must be followed by blanks.
      *
      *  3-5 numeric represents a BC code
      *    6 numeric represents a SIC code
      *
      * Check if this is preceded by a real time clearing code            CSW200
      *                                                                   CSW200
     C           I#ACCL    IFEQ '//RT'                                    CSW200
     C                     MOVE *BLANKS   ##FLD                           CSW200
     C                     SUBSTI#ACLN:5  ##FLD                           CSW200
     C                     ELSE                                           CSW200
     C                     MOVELI#ACLN    ##FLD     P
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
     C           DIGITS    CHECK##FLD:5   Y#             90
      *
      *  If *IN90 if off i.e. field is completely filled set it on
      *
     C           *IN90     IFEQ *OFF
     C                     MOVEL*ON       *IN90
     C                     ENDIF
      *
      *  3-6 Numeric follwowed by blanks
      *
     C           *IN90     IFEQ *ON
     C           Y#        ANDGE8
     C           Y#        ANDLE11
     C           CSW096    ANDEQ'CSW096'
     C           *IN90     OREQ *ON
     C           Y#        ANDEQ10
     C           CSW096    ANDNE'CSW096'
      *
      * Save ending position
      *
     C                     Z-ADDY#        X#      50
      *
     C           ' '       CHECK##FLD:X#  Y#             90
      *
     C                     ENDIF
      *
      * Invalid if *IN90 on
      *
     C           *IN90     IFEQ *ON
     C           I#PR      IFEQ 'REC'
     C                     MOVEL##RER1    ERCD,E
     C                     ELSE
     C                     MOVEL##PER1    ERCD,E
     C                     ENDIF
     C                     ADD  1         E
     C                     MOVEL'Y'       E#ERRM
      *                                                                   CSW200
      ** adjust the error position                                        CSW200
      *                                                                   CSW200
     C           I#ACCL    IFEQ '//RT'                                    CSW200
     C                     ADD  4         Y#                              CSW200
     C                     ENDIF                                          CSW200
      *
      * Send error message
      *
     C                     MOVEL'MEC0015' MEMSID
     C                     MOVEL'MEMSG'   MEMSGF
     C                     MOVELY#        MEMSDT
     C                     EXSR SRSNMS
      *
      * Exit subroutine
      *
     C                     GOTO EXSW
     C                     ENDIF
      *
      *  Unwind subroutine stack name
      *
     C           EXSW      TAG
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     CSR                   ENDSR
      *****************************************************************
     C/EJECT
      *****************************************************************
      *                                                               *
      *  SRCEXT   : Currency Clearing Extension Validation            *
      *                                                               *
      *  CALLED BY: Clearing System Vlaidation routines               *
      *                                                               *
      *****************************************************************
     CSR         SRCEXT    BEGSR
      *
      *  Set up subroutine stack name
      *
     C                     ADD  1         Q       50
     C                     MOVEL'SRCEXT'  @STK,Q
      *
      * Copy point for Extension Validation
     C/COPY WNCPYSRC,ME9940CEXT
      *
      *  Set up extra parameters
      *
     C                     Z-ADDE         E#INDX
      *
      * Call extension validation program
      *
     C                     CALL DPEXPM                 9090
     C                     PARM *BLANKS   P#RTCD
     C                     PARM           I#PARM           I Input Parms
     C                     PARM           O#PARM           O Output Parms
     C                     PARM           E#PARM           E Error Inform
     C                     PARM           Z#PARM256        B User Defined
      *
      *  If return with an error (LR seton in called program) then
      *  process for database error.
      *
     C           *IN90     IFEQ '1'
     C           P@RTCD    OREQ '*ERROR*'
     C                     MOVELDPEXPM    W0FILE
     C                     MOVEL'*CALL'   W0KEY            ***************
     C                     Z-ADD4         W0ERNB           * DB ERROR 04 *
     C                     MOVEL'MEM5003' W0MSGD           ***************
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     END
      *
      *  Return information
      *
     C                     Z-ADDE#INDX    E
      *
      *  Unwind subroutine stack name
      *
     C           EXCEXT    TAG
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     CSR                   ENDSR
      *****************************************************************
     C/EJECT
      *****************************************************************   CSW200
      *                                                               *   CSW200
      *  SRHK     : Hong Kong Validation                              *   CSW200
      *                                                               *   CSW200
      *  CALLED BY: SRINBK - Intermediary Institution                 *   CSW200
      *             SRAWBK - Account with Institution                 *   CSW200
      *             SRBENF - Beneficiary                              *   CSW200
      *                                                               *   CSW200
      *****************************************************************   CSW200
     CSR         SRHK      BEGSR                                          CSW200
      *                                                                   CSW200
      *  Set up subroutine stack name                                     CSW200
      *                                                                   CSW200
     C                     ADD  1         Q                               CSW200
     C                     MOVEL'SRHK  '  @STK,Q                          CSW200
      *                                                                   CSW200
      * Copy point for Hong Kong Validation                               CSW200
     C/COPY WNCPYSRC,ME9940HK                                             CSW200
      *                                                                   CSW200
      ** If //HK it must be followed by a 3 digit number. The number      CSW200
      ** must be followed by blanks.                                      CSW200
      *                                                                   CSW200
      * Check if this is preceded by a real time clearing code            CSW200
      *                                                                   CSW200
     C           I#ACCL    IFEQ '//RT'                                    CSW200
     C                     MOVE *BLANKS   ##FLD                           CSW200
     C                     SUBSTI#ACLN:5  ##FLD                           CSW200
     C                     ELSE                                           CSW200
     C                     MOVELI#ACLN    ##FLD  35 P                     CSW200
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
     C           DIGITS    CHECK##FLD:5   Y#      50     90               CSW200
      *                                                                   CSW200
      *  If *IN90 if off i.e. field is completely filled set it on        CSW200
      *                                                                   CSW200
     C           *IN90     IFEQ *OFF                                      CSW200
     C                     MOVEL*ON       *IN90                           CSW200
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
      *  3 Numeric followed by blanks                                     CSW200
      *                                                                   CSW200
     C           *IN90     IFEQ *ON                                       CSW200
     C           Y#        ANDEQ8                                         CSW200
      *                                                                   CSW200
     C           ' '       CHECK##FLD:8   Y#             90               CSW200
      *                                                                   CSW200
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
      * Invalid if *IN90 on                                               CSW200
      *                                                                   CSW200
     C           *IN90     IFEQ *ON                                       CSW200
     C           I#PR      IFEQ 'REC'                                     CSW200
     C                     MOVEL##RER1    ERCD,E                          CSW200
     C                     ELSE                                           CSW200
     C                     MOVEL##PER1    ERCD,E                          CSW200
     C                     ENDIF                                          CSW200
     C                     ADD  1         E                               CSW200
     C                     MOVEL'Y'       E#ERRM                          CSW200
      *                                                                   CSW200
      ** adjust the error position                                        CSW200
      *                                                                   CSW200
     C           I#ACCL    IFEQ '//RT'                                    CSW200
     C                     ADD  4         Y#                              CSW200
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
      * Send error message                                                CSW200
      *                                                                   CSW200
     C                     MOVEL'MEC0021' MEMSID                          CSW200
     C                     MOVEL'MEMSG'   MEMSGF                          CSW200
     C                     MOVELY#        MEMSDT                          CSW200
     C                     EXSR SRSNMS                                    CSW200
      *                                                                   CSW200
      * Exit subroutine                                                   CSW200
      *                                                                   CSW200
     C                     GOTO EXHK                                      CSW200
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
      *  Unwind subroutine stack name                                     CSW200
      *                                                                   CSW200
     C           EXHK      TAG                                            CSW200
     C                     MOVEA*BLANKS   @STK,Q                          CSW200
     C                     SUB  1         Q                               CSW200
      *                                                                   CSW200
      *                                                                   CSW200
     CSR                   ENDSR                                          CSW200
      *****************************************************************   CSW200
     C/EJECT                                                              CSW200
      *****************************************************************   CSW200
      *                                                               *   CSW200
      *  SRIE     : Irish National Clearing Validation                *   CSW200
      *                                                               *   CSW200
      *  CALLED BY: SRINBK - Intermediary Institution                 *   CSW200
      *             SRAWBK - Account with Institution                 *   CSW200
      *             SRBENF - Beneficiary                              *   CSW200
      *                                                               *   CSW200
      *****************************************************************   CSW200
     CSR         SRIE      BEGSR                                          CSW200
      *                                                                   CSW200
      *  Set up subroutine stack name                                     CSW200
      *                                                                   CSW200
     C                     ADD  1         Q                               CSW200
     C                     MOVEL'SRIE  '  @STK,Q                          CSW200
      *                                                                   CSW200
      * Copy point for Irish National Clearing Validation                 CSW200
     C/COPY WNCPYSRC,ME9940IE                                             CSW200
      *                                                                   CSW200
      ** If //IE it must be followed by a 6 digit number. The number      CSW200
      ** must be followed by blanks.                                      CSW200
      *                                                                   CSW200
      * Check if this is preceded by a real time clearing code            CSW200
      *                                                                   CSW200
     C           I#ACCL    IFEQ '//RT'                                    CSW200
     C                     MOVE *BLANKS   ##FLD                           CSW200
     C                     SUBSTI#ACLN:5  ##FLD                           CSW200
     C                     ELSE                                           CSW200
     C                     MOVELI#ACLN    ##FLD  35 P                     CSW200
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
     C           DIGITS    CHECK##FLD:5   Y#      50     90               CSW200
      *                                                                   CSW200
      *  If *IN90 if off i.e. field is completely filled set it on        CSW200
      *                                                                   CSW200
     C           *IN90     IFEQ *OFF                                      CSW200
     C                     MOVEL*ON       *IN90                           CSW200
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
      *  6 Numeric followed by blanks                                     CSW200
      *                                                                   CSW200
     C           *IN90     IFEQ *ON                                       CSW200
     C           Y#        ANDEQ11                                        CSW200
      *                                                                   CSW200
     C           ' '       CHECK##FLD:11  Y#             90               CSW200
      *                                                                   CSW200
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
      * Invalid if *IN90 on                                               CSW200
      *                                                                   CSW200
     C           *IN90     IFEQ *ON                                       CSW200
     C           I#PR      IFEQ 'REC'                                     CSW200
     C                     MOVEL##RER1    ERCD,E                          CSW200
     C                     ELSE                                           CSW200
     C                     MOVEL##PER1    ERCD,E                          CSW200
     C                     ENDIF                                          CSW200
     C                     ADD  1         E                               CSW200
     C                     MOVEL'Y'       E#ERRM                          CSW200
      *                                                                   CSW200
      ** adjust the error position                                        CSW200
      *                                                                   CSW200
     C           I#ACCL    IFEQ '//RT'                                    CSW200
     C                     ADD  4         Y#                              CSW200
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
      * Send error message                                                CSW200
      *                                                                   CSW200
     C                     MOVEL'MEC0022' MEMSID                          CSW200
     C                     MOVEL'MEMSG'   MEMSGF                          CSW200
     C                     MOVELY#        MEMSDT                          CSW200
     C                     EXSR SRSNMS                                    CSW200
      *                                                                   CSW200
      * Exit subroutine                                                   CSW200
      *                                                                   CSW200
     C                     GOTO EXIE                                      CSW200
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
      *  Unwind subroutine stack name                                     CSW200
      *                                                                   CSW200
     C           EXIE      TAG                                            CSW200
     C                     MOVEA*BLANKS   @STK,Q                          CSW200
     C                     SUB  1         Q                               CSW200
      *                                                                   CSW200
      *                                                                   CSW200
     CSR                   ENDSR                                          CSW200
      *****************************************************************   CSW200
     C/EJECT                                                              CSW200
      *****************************************************************   CSW200
      *                                                               *   CSW200
      *  SRNZ     : New Zealand National Clearing Validation          *   CSW200
      *                                                               *   CSW200
      *  CALLED BY: SRAWBK - Account with Institution                 *   CSW200
      *             SRBENF - Beneficiary                              *   CSW200
      *                                                               *   CSW200
      *****************************************************************   CSW200
     CSR         SRNZ      BEGSR                                          CSW200
      *                                                                   CSW200
      *  Set up subroutine stack name                                     CSW200
      *                                                                   CSW200
     C                     ADD  1         Q                               CSW200
     C                     MOVEL'SRNZ  '  @STK,Q                          CSW200
      *                                                                   CSW200
      * Copy point for New Zealand National Clearing Validation           CSW200
     C/COPY WNCPYSRC,ME9940NZ                                             CSW200
      *                                                                   CSW200
      ** If //NZ it must be followed by a 6 digit number. The number      CSW200
      ** must be followed by blanks.                                      CSW200
      *                                                                   CSW200
      * Check if this is preceded by a real time clearing code            CSW200
      *                                                                   CSW200
     C           I#ACCL    IFEQ '//RT'                                    CSW200
     C                     MOVE *BLANKS   ##FLD                           CSW200
     C                     SUBSTI#ACLN:5  ##FLD                           CSW200
     C                     ELSE                                           CSW200
     C                     MOVELI#ACLN    ##FLD  35 P                     CSW200
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
     C           DIGITS    CHECK##FLD:5   Y#      50     90               CSW200
      *                                                                   CSW200
      *  If *IN90 if off i.e. field is completely filled set it on        CSW200
      *                                                                   CSW200
     C           *IN90     IFEQ *OFF                                      CSW200
     C                     MOVEL*ON       *IN90                           CSW200
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
      *  6 Numeric followed by blanks                                     CSW200
      *                                                                   CSW200
     C           *IN90     IFEQ *ON                                       CSW200
     C           Y#        ANDEQ11                                        CSW200
      *                                                                   CSW200
     C           ' '       CHECK##FLD:11  Y#             90               CSW200
      *                                                                   CSW200
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
      * Invalid if *IN90 on                                               CSW200
      *                                                                   CSW200
     C           *IN90     IFEQ *ON                                       CSW200
     C           I#PR      IFEQ 'REC'                                     CSW200
     C                     MOVEL##RER1    ERCD,E                          CSW200
     C                     ELSE                                           CSW200
     C                     MOVEL##PER1    ERCD,E                          CSW200
     C                     ENDIF                                          CSW200
     C                     ADD  1         E                               CSW200
     C                     MOVEL'Y'       E#ERRM                          CSW200
      *                                                                   CSW200
      ** adjust the error position                                        CSW200
      *                                                                   CSW200
     C           I#ACCL    IFEQ '//RT'                                    CSW200
     C                     ADD  4         Y#                              CSW200
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
      * Send error message                                                CSW200
      *                                                                   CSW200
     C                     MOVEL'MEC0023' MEMSID                          CSW200
     C                     MOVEL'MEMSG'   MEMSGF                          CSW200
     C                     MOVELY#        MEMSDT                          CSW200
     C                     EXSR SRSNMS                                    CSW200
      *                                                                   CSW200
      * Exit subroutine                                                   CSW200
      *                                                                   CSW200
     C                     GOTO EXNZ                                      CSW200
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
      *  Unwind subroutine stack name                                     CSW200
      *                                                                   CSW200
     C           EXNZ      TAG                                            CSW200
     C                     MOVEA*BLANKS   @STK,Q                          CSW200
     C                     SUB  1         Q                               CSW200
      *                                                                   CSW200
      *                                                                   CSW200
     CSR                   ENDSR                                          CSW200
      *****************************************************************   CSW200
     C/EJECT                                                              CSW200
      *****************************************************************   CSW200
      *                                                               *   CSW200
      *  SRZA     : ZA Clearing Validation                            *   CSW200
      *                                                               *   CSW200
      *  CALLED BY: SRINBK - Intermediary Institution                 *   CSW200
      *             SRAWBK - Account with Institution                 *   CSW200
      *             SRBENF - Beneficiary                              *   CSW200
      *                                                               *   CSW200
      *****************************************************************   CSW200
     CSR         SRZA      BEGSR                                          CSW200
      *                                                                   CSW200
      *  Set up subroutine stack name                                     CSW200
      *                                                                   CSW200
     C                     ADD  1         Q                               CSW200
     C                     MOVEL'SRZA  '  @STK,Q                          CSW200
      *                                                                   CSW200
      * Copy point for ZA Clearing Validation                             CSW200
     C/COPY WNCPYSRC,ME9940ZA                                             CSW200
      *                                                                   CSW200
      ** If //ZA it must be followed by a 6 digit number. The number      CSW200
      ** must be followed by blanks.                                      CSW200
      *                                                                   CSW200
      * Check if this is preceded by a real time clearing code            CSW200
      *                                                                   CSW200
     C           I#ACCL    IFEQ '//RT'                                    CSW200
     C                     MOVE *BLANKS   ##FLD                           CSW200
     C                     SUBSTI#ACLN:5  ##FLD                           CSW200
     C                     ELSE                                           CSW200
     C                     MOVELI#ACLN    ##FLD  35 P                     CSW200
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
     C           DIGITS    CHECK##FLD:5   Y#      50     90               CSW200
      *                                                                   CSW200
      *  If *IN90 if off i.e. field is completely filled set it on        CSW200
      *                                                                   CSW200
     C           *IN90     IFEQ *OFF                                      CSW200
     C                     MOVEL*ON       *IN90                           CSW200
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
      *  6 Numeric followed by blanks                                     CSW200
      *                                                                   CSW200
     C           *IN90     IFEQ *ON                                       CSW200
     C           Y#        ANDEQ11                                        CSW200
      *                                                                   CSW200
     C           ' '       CHECK##FLD:11  Y#             90               CSW200
      *                                                                   CSW200
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
      * Invalid if *IN90 on                                               CSW200
      *                                                                   CSW200
     C           *IN90     IFEQ *ON                                       CSW200
     C           I#PR      IFEQ 'REC'                                     CSW200
     C                     MOVEL##RER1    ERCD,E                          CSW200
     C                     ELSE                                           CSW200
     C                     MOVEL##PER1    ERCD,E                          CSW200
     C                     ENDIF                                          CSW200
     C                     ADD  1         E                               CSW200
     C                     MOVEL'Y'       E#ERRM                          CSW200
      *                                                                   CSW200
      ** adjust the error position                                        CSW200
      *                                                                   CSW200
     C           I#ACCL    IFEQ '//RT'                                    CSW200
     C                     ADD  4         Y#                              CSW200
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
      * Send error message                                                CSW200
      *                                                                   CSW200
     C                     MOVEL'MEC0024' MEMSID                          CSW200
     C                     MOVEL'MEMSG'   MEMSGF                          CSW200
     C                     MOVELY#        MEMSDT                          CSW200
     C                     EXSR SRSNMS                                    CSW200
      *                                                                   CSW200
      * Exit subroutine                                                   CSW200
      *                                                                   CSW200
     C                     GOTO EXZA                                      CSW200
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
      *  Unwind subroutine stack name                                     CSW200
      *                                                                   CSW200
     C           EXZA      TAG                                            CSW200
     C                     MOVEA*BLANKS   @STK,Q                          CSW200
     C                     SUB  1         Q                               CSW200
      *                                                                   CSW200
      *                                                                   CSW200
     CSR                   ENDSR                                          CSW200
      *****************************************************************   CSW200
     C/EJECT                                                              CSW200
      *****************************************************************   CSW200
      *                                                               *   CSW200
      *  SRPT     : Portugal National Clearing Validation             *   CSW200
      *                                                               *   CSW200
      *  CALLED BY: SRINBK - Intermediary Institution                 *   CSW200
      *             SRAWBK - Account with Institution                 *   CSW200
      *             SRBENF - Beneficiary                              *   CSW200
      *                                                               *   CSW200
      *****************************************************************   CSW200
     CSR         SRPT      BEGSR                                          CSW200
      *                                                                   CSW200
      *  Set up subroutine stack name                                     CSW200
      *                                                                   CSW200
     C                     ADD  1         Q                               CSW200
     C                     MOVEL'SRPT  '  @STK,Q                          CSW200
      *                                                                   CSW200
      * Copy point for PT Clearing Validation                             CSW200
     C/COPY WNCPYSRC,ME9940PT                                             CSW200
      *                                                                   CSW200
      ** If //PT it must be followed by a 8 digit number. The number      CSW200
      ** must be followed by blanks.                                      CSW200
      *                                                                   CSW200
      * Check if this is preceded by a real time clearing code            CSW200
      *                                                                   CSW200
     C           I#ACCL    IFEQ '//RT'                                    CSW200
     C                     MOVE *BLANKS   ##FLD                           CSW200
     C                     SUBSTI#ACLN:5  ##FLD                           CSW200
     C                     ELSE                                           CSW200
     C                     MOVELI#ACLN    ##FLD  35 P                     CSW200
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
     C           DIGITS    CHECK##FLD:5   Y#      50     90               CSW200
      *                                                                   CSW200
      *  If *IN90 if off i.e. field is completely filled set it on        CSW200
      *                                                                   CSW200
     C           *IN90     IFEQ *OFF                                      CSW200
     C                     MOVEL*ON       *IN90                           CSW200
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
      *  8 Numeric followed by blanks                                     CSW200
      *                                                                   CSW200
     C           *IN90     IFEQ *ON                                       CSW200
     C           Y#        ANDEQ13                                        CSW200
      *                                                                   CSW200
     C           ' '       CHECK##FLD:13  Y#             90               CSW200
      *                                                                   CSW200
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
      * Invalid if *IN90 on                                               CSW200
      *                                                                   CSW200
     C           *IN90     IFEQ *ON                                       CSW200
     C           I#PR      IFEQ 'REC'                                     CSW200
     C                     MOVEL##RER1    ERCD,E                          CSW200
     C                     ELSE                                           CSW200
     C                     MOVEL##PER1    ERCD,E                          CSW200
     C                     ENDIF                                          CSW200
     C                     ADD  1         E                               CSW200
     C                     MOVEL'Y'       E#ERRM                          CSW200
      *                                                                   CSW200
      ** adjust the error position                                        CSW200
      *                                                                   CSW200
     C           I#ACCL    IFEQ '//RT'                                    CSW200
     C                     ADD  4         Y#                              CSW200
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
      * Send error message                                                CSW200
      *                                                                   CSW200
     C                     MOVEL'MEC0025' MEMSID                          CSW200
     C                     MOVEL'MEMSG'   MEMSGF                          CSW200
     C                     MOVELY#        MEMSDT                          CSW200
     C                     EXSR SRSNMS                                    CSW200
      *                                                                   CSW200
      * Exit subroutine                                                   CSW200
      *                                                                   CSW200
     C                     GOTO EXPT                                      CSW200
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
      *  Unwind subroutine stack name                                     CSW200
      *                                                                   CSW200
     C           EXPT      TAG                                            CSW200
     C                     MOVEA*BLANKS   @STK,Q                          CSW200
     C                     SUB  1         Q                               CSW200
      *                                                                   CSW200
      *                                                                   CSW200
     CSR                   ENDSR                                          CSW200
      *****************************************************************   CSW200
     C/EJECT                                                              CSW200
      *****************************************************************   CSW200
      *                                                               *   CSW200
      *  SRRU     : Russian Central Bank Identification Code Validat. *   CSW200
      *                                                               *   CSW200
      *  CALLED BY: SRINBK - Intermediary Institution                 *   CSW200
      *             SRAWBK - Account with Institution                 *   CSW200
      *             SRBENF - Beneficiary                              *   CSW200
      *                                                               *   CSW200
      *****************************************************************   CSW200
     CSR         SRRU      BEGSR                                          CSW200
      *                                                                   CSW200
      *  Set up subroutine stack name                                     CSW200
      *                                                                   CSW200
     C                     ADD  1         Q                               CSW200
     C                     MOVEL'SRRU  '  @STK,Q                          CSW200
      *                                                                   CSW200
      * Copy point for RU Clearing Validation                             CSW200
     C/COPY WNCPYSRC,ME9940RU                                             CSW200
      *                                                                   CSW200
      ** If //RU it must be followed by a 0 to 9 digit number.            CSW200
      ** The number must be followed by blanks.                           CSW200
      *                                                                   CSW200
      * Check if this is preceded by a real time clearing code            CSW200
      *                                                                   CSW200
     C           I#ACCL    IFEQ '//RT'                                    CSW200
     C                     MOVE *BLANKS   ##FLD                           CSW200
     C                     SUBSTI#ACLN:5  ##FLD                           CSW200
     C                     ELSE                                           CSW200
     C                     MOVELI#ACLN    ##FLD  35 P                     CSW200
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
     C           DIGITS    CHECK##FLD:5   Y#      50     90               CSW200
      *                                                                   CSW200
      *  If *IN90 if off i.e. field is completely filled set it on        CSW200
      *                                                                   CSW200
     C           *IN90     IFEQ *OFF                                      CSW200
     C                     MOVEL*ON       *IN90                           CSW200
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
      *  0 to 9 Numeric followed by blanks                                CSW200
      *                                                                   CSW200
     C           *IN90     IFEQ *ON                                       CSW200
     C********** Y#        ANDGE5                                                    CSW200 MD022836
     C********** Y#        ANDLE14                                                   CSW200 MD022836
     C           Y#        ANDEQ14                                                          MD022836
      *                                                                   CSW200
     C           ' '       CHECK##FLD:Y#  Y#             90               CSW200
      *                                                                   CSW200
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
      * Invalid if *IN90 on                                               CSW200
      *                                                                   CSW200
     C           *IN90     IFEQ *ON                                       CSW200
     C           I#PR      IFEQ 'REC'                                     CSW200
     C                     MOVEL##RER1    ERCD,E                          CSW200
     C                     ELSE                                           CSW200
     C                     MOVEL##PER1    ERCD,E                          CSW200
     C                     ENDIF                                          CSW200
     C                     ADD  1         E                               CSW200
     C                     MOVEL'Y'       E#ERRM                          CSW200
      *                                                                   CSW200
      ** adjust the error position                                        CSW200
      *                                                                   CSW200
     C           I#ACCL    IFEQ '//RT'                                    CSW200
     C                     ADD  4         Y#                              CSW200
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
      * Send error message                                                CSW200
      *                                                                   CSW200
     C                     MOVEL'MEC0026' MEMSID                          CSW200
     C                     MOVEL'MEMSG'   MEMSGF                          CSW200
     C                     MOVELY#        MEMSDT                          CSW200
     C                     EXSR SRSNMS                                    CSW200
      *                                                                   CSW200
      * Exit subroutine                                                   CSW200
      *                                                                   CSW200
     C                     GOTO EXRU                                      CSW200
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
      *  Unwind subroutine stack name                                     CSW200
      *                                                                   CSW200
     C           EXRU      TAG                                            CSW200
     C                     MOVEA*BLANKS   @STK,Q                          CSW200
     C                     SUB  1         Q                               CSW200
      *                                                                   CSW200
      *                                                                   CSW200
     CSR                   ENDSR                                          CSW200
      *****************************************************************   CSW200
     C/EJECT                                                              CSW200
      *****************************************************************   CSW200
      *                                                               *   CSW200
      *  SRRT     : Real Time Clearing Validation                     *   CSW200
      *                                                               *   CSW200
      *  CALLED BY: SRINBK - Intermediary Institution                 *   CSW200
      *             SRAWBK - Account with Institution                 *   CSW200
      *             SRBENF - Beneficiary                              *   CSW200
      *                                                               *   CSW200
      *****************************************************************   CSW200
     CSR         SRRT      BEGSR                                          CSW200
      *                                                                   CSW200
      *  Set up subroutine stack name                                     CSW200
      *                                                                   CSW200
     C                     ADD  1         Q                               CSW200
     C                     MOVEL'SRRT  '  @STK,Q                          CSW200
      *                                                                   CSW200
      * Copy point for RT Clearing Validation                             CSW200
     C/COPY WNCPYSRC,ME9940RT1                                            CSW200
      *                                                                   CSW200
      ** Check if a SWIFT BIC has been entered.                           CSW200
      *                                                                   CSW200
     C                     SELEC                                          184361
      * When customer                                                     184361
     C           W9CUST    WHEQ 'Y'                                       184361
     C           I#PRTT    ANDNE'S'                                       184361
     C                     MOVELBBCSID    W9BICC                          184361
     C                     MOVE *BLANKS   W9BICB                          184361
      * When conterparty nostro                                           184361
     C           W9CNST    WHEQ 'Y'                                       184361
     C           I#PRTT    ANDNE'S'                                       184361
     C                     MOVELAWSWID    W9BICC                          184361
     C                     MOVE *BLANKS   W9BICB                          184361
      * Otherwise SWIFT BIC address                                       184361
     C                     OTHER                                          184361
     C                     MOVELI#PRTY    W9BICC                          CSW200
     C           3         SUBSTI#PRTY:9  W9BICB                          CSW200
     C                     ENDSL                                          184361
      *                                                                   CSW200
     C                     CALL 'ME1400'                                  CSW200
     C                     PARM *BLANKS   W9RTN   7                       CSW200
     C                     PARM           W9BICC  8                       CSW200
     C                     PARM           W9BICB  3                       CSW200
     C                     PARM           SDCUST                          CSW200
     C                     PARM           SDCNST                          CSW200
     C                     PARM           MEBICD                          CSW200
     C                     PARM *BLANKS   WKCUST  1                       CSW200
     C                     PARM *BLANKS   WKCNST  1                       CSW200
     C                     PARM *BLANKS   WKBICD  1                       CSW200
      *                                                                   CSW200
      *  If a SWIFT BIC has not been entered                              CSW200
      *                                                                   CSW200
     C           WKBICD    IFNE 'Y'                                       CSW200
     C           WKCUST    ANDNE'Y'                                       CSW200
     C           WKCNST    ANDNE'Y'                                       CSW200
      *                                                                   CSW200
      ** If second clearing code is valid                                 CSW200
     C           I#ACSC    IFEQ '//BL'                                    CSW200
     C           I#ACSC    OREQ '//CC'                                    CSW200
     C           I#ACSC    OREQ '//CH'                                    CSW200
     C           I#ACSC    OREQ '//CP'                                    CSW200
     C           I#ACSC    OREQ '//ES'                                    CSW200
     C           CSW096    ANDEQ'CSW096'                                  CSW200
     C           I#ACSC    OREQ '//FW'                                    CSW200
     C           I#ACSC    OREQ '//IT'                                    CSW200
     C           CSW096    ANDEQ'CSW096'                                  CSW200
     C           I#ACSC    OREQ '//SC'                                    CSW200
     C           I#ACSC    OREQ '//SW'                                    CSW200
     C           I#ACSC    OREQ '//??'                                    CSW200
     C           I#ACSC    OREQ '//AT'                                    CSW200
     C           CSW097    ANDEQ'CSW097'                                  CSW200
     C           I#ACSC    OREQ '//AU'                                    CSW200
     C           CSW097    ANDEQ'CSW097'                                  CSW200
     C           I#ACSC    OREQ '//HK'                                    CSW200
     C           CSW200    ANDEQ'CSW200'                                  CSW200
     C           I#ACSC    OREQ '//IE'                                    CSW200
     C           CSW200    ANDEQ'CSW200'                                  CSW200
     C           I#ACSC    OREQ '//PT'                                    CSW200
     C           CSW200    ANDEQ'CSW200'                                  CSW200
     C           I#ACSC    OREQ '//RU'                                    CSW200
     C           CSW200    ANDEQ'CSW200'                                  CSW200
     C           I#ACSC    OREQ '//ZA'                                    CSW200
     C           CSW200    ANDEQ'CSW200'                                  CSW200
     C           I#ACSC    OREQ '//NZ'                                    CSW200
     C           CSW200    ANDEQ'CSW200'                                  CSW200
     C           I#ACCL    OREQ '//GR'                                                        CSW202
     C           CSW202    ANDEQ'Y'                                                           CSW202
     C           I#ACCL    OREQ '//IN'                                                        CSW202
     C           CSW202    ANDEQ'Y'                                                           CSW202
     C           I#ACSC    OREQ '//CN'                                                      MD034498
     C           CSW215    ANDEQ'Y'                                                         MD034498
      *                                                                   CSW200
      * Copy point for RT Clearing Validation                             CSW200
     C/COPY WNCPYSRC,ME9940RT2                                            CSW200
      *                                                                   CSW200
      * Validate that Currency Combination exists                         CSW200
      *                                                                   CSW200
      * If receive then use receive currency else pay currency            CSW200
      *                                                                   CSW200
     C                     MOVELI#PCCY    P@CYCD                          CSW200
     C           I#PR      IFEQ 'REC'                                     CSW200
     C                     MOVELI#RCCY    P@CYCD  3                       CSW200
     C                     END                                            CSW200
     C                     MOVELI#ACSS    P@CLSY  2                       CSW200
     C                     EXSR SRCHKC                                    CSW200
      *                                                                   CSW200
      * No reference exists therefore error                               CSW200
      *                                                                   CSW200
     C           P@RTCD    IFNE *BLANKS                                   CSW200
     C           I#PR      IFEQ 'REC'                                     CSW200
     C                     MOVEL##RER2    ERCD,E                          CSW200
     C                     MOVELI#RCCY    MEMSDT    P                     CSW200
     C                     ELSE                                           CSW200
     C                     MOVEL##PER2    ERCD,E                          CSW200
     C                     MOVELI#PCCY    MEMSDT    P                     CSW200
     C                     ENDIF                                          CSW200
     C                     ADD  1         E                               CSW200
     C                     MOVEL'Y'       E#ERRM                          CSW200
      *                                                                   CSW200
      * Send error message                                                CSW200
      *                                                                   CSW200
     C                     MOVEL'MEC0004' MEMSID                          CSW200
     C                     MOVEL'MEMSG'   MEMSGF                          CSW200
     C           I#ACSC    CAT  MEMSDT:0  MEMSDT                          CSW200
     C                     EXSR SRSNMS                                    CSW200
      *                                                                   CSW200
      * Exit subroutine                                                   CSW200
      *                                                                   CSW200
     C                     GOTO EXRT                                      CSW200
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
      * If ?? then replace with selected record                           CSW200
      *                                                                   CSW200
     C           I#ACSC    IFEQ '//??'                                    CSW200
     C                     MOVE DPCLSY    I#ACSC                          CSW200
     C                     ENDIF                                          CSW200
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
      ** Check second clearing code                                       CSW200
     C********** I#ACC5    IFNE ' '                                                  CSW200 MD034498
     C           I#ACSC    IFNE ' '                                                         MD034498
     C           I#ACSC    IFNE '//BL'                                    CSW200
     C           I#ACSC    ANDNE'//CC'                                    CSW200
     C           I#ACSC    ANDNE'//CH'                                    CSW200
     C           I#ACSC    ANDNE'//CP'                                    CSW200
     C           I#ACSC    ANDNE'//ES'                                    CSW200
     C           I#ACSC    ANDNE'//FW'                                    CSW200
     C           I#ACSC    ANDNE'//IT'                                    CSW200
     C           I#ACSC    ANDNE'//SC'                                    CSW200
     C           I#ACSC    ANDNE'//SW'                                    CSW200
     C           I#ACSC    ANDNE'//AT'                                    CSW200
     C           I#ACSC    ANDNE'//AU'                                    CSW200
     C           I#ACSC    ANDNE'//HK'                                    CSW200
     C           I#ACSC    ANDNE'//IE'                                    CSW200
     C           I#ACSC    ANDNE'//PT'                                    CSW200
     C           I#ACSC    ANDNE'//RU'                                    CSW200
     C           I#ACSC    ANDNE'//ZA'                                    CSW200
     C           I#ACSC    ANDNE'//NZ'                                    CSW200
     C           I#ACCL    ANDNE'//GR'                                                        CSW202
     C           I#ACCL    ANDNE'//IN'                                                        CSW202
     C           I#ACSC    ANDNE'//CN'                                                      MD034498
     C           I#ACSC    OREQ '//IT'                                    CSW200
     C           CSW096    ANDNE'CSW096'                                  CSW200
     C           I#ACSC    OREQ '//ES'                                    CSW200
     C           CSW096    ANDNE'CSW096'                                  CSW200
     C           I#ACSC    OREQ '//AT'                                    CSW200
     C           CSW097    ANDNE'CSW097'                                  CSW200
     C           I#ACSC    OREQ '//AU'                                    CSW200
     C           CSW097    ANDNE'CSW097'                                  CSW200
     C           I#ACSC    OREQ '//HK'                                    CSW200
     C           CSW200    ANDNE'CSW200'                                  CSW200
     C           I#ACSC    OREQ '//IE'                                    CSW200
     C           CSW200    ANDNE'CSW200'                                  CSW200
     C           I#ACSC    OREQ '//PT'                                    CSW200
     C           CSW200    ANDNE'CSW200'                                  CSW200
     C           I#ACSC    OREQ '//RU'                                    CSW200
     C           CSW200    ANDNE'CSW200'                                  CSW200
     C           I#ACSC    OREQ '//ZA'                                    CSW200
     C           CSW200    ANDNE'CSW200'                                  CSW200
     C           I#ACSC    OREQ '//NZ'                                    CSW200
     C           CSW200    ANDNE'CSW200'                                  CSW200
     C           I#ACCL    OREQ '//GR'                                                        CSW202
     C           CSW202    ANDNE'Y'                                                           CSW202
     C           I#ACCL    OREQ '//IN'                                                        CSW202
     C           CSW202    ANDNE'Y'                                                           CSW202
     C           I#ACSC    OREQ '//CN'                                                      MD034498
     C           CSW215    ANDNE'Y'                                                         MD034498
      *                                                                   CSW200
      * Copy point for RT Clearing Validation                             CSW200
     C/COPY WNCPYSRC,ME9940RT3                                            CSW200
     C           I#PR      IFEQ 'REC'                                     CSW200
     C                     MOVEL##RER3    ERCD,E                          CSW200
     C                     ELSE                                           CSW200
     C                     MOVEL##PER3    ERCD,E                          CSW200
     C                     ENDIF                                          CSW200
     C                     ADD  1         E                               CSW200
     C                     MOVEL'Y'       E#ERRM                          CSW200
      *                                                                   CSW200
      * Send error message                                                CSW200
      *                                                                   CSW200
     C                     MOVEL'MEC0005' MEMSID                          CSW200
     C                     MOVEL'MEMSG'   MEMSGF                          CSW200
     C                     MOVELI#ACSC    MEMSDT                          CSW200
     C                     EXSR SRSNMS                                    CSW200
      *                                                                   CSW200
      * Exit subroutine                                                   CSW200
      *                                                                   CSW200
     C                     GOTO EXRT                                      CSW200
      *                                                                   CSW200
      * Else validate the second clear code                               CSW200
      *                                                                   CSW200
     C                     ELSE                                           CSW200
      *                                                                   CSW200
      * Bankleitzahl Validation                                           CSW200
      *                                                                   CSW200
     C           I#ACSC    IFEQ '//BL'                                    CSW200
     C                     EXSR SRBL                                      CSW200
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
      * Canadian Clearing Validation                                      CSW200
      *                                                                   CSW200
     C           I#ACSC    IFEQ '//CC'                                    CSW200
     C                     EXSR SRCC                                      CSW200
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
      * CHIPS Universal id. Validation                                    CSW200
      *                                                                   CSW200
     C           I#ACSC    IFEQ '//CH'                                    CSW200
     C                     EXSR SRCH                                      CSW200
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
      * CHIPS Participant Validation                                      CSW200
      *                                                                   CSW200
     C           I#ACSC    IFEQ '//CP'                                    CSW200
     C                     EXSR SRCP                                      CSW200
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
      * Spanish Domestic Validation                                       CSW200
      *                                                                   CSW200
     C           I#ACSC    IFEQ '//ES'                                    CSW200
     C                     EXSR SRES                                      CSW200
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
      * Fedwire Validation                                                CSW200
      *                                                                   CSW200
     C           I#ACSC    IFEQ '//FW'                                    CSW200
     C                     EXSR SRFW                                      CSW200
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
      * Italian Domestic id Validation                                    CSW200
      *                                                                   CSW200
     C           I#ACSC    IFEQ '//IT'                                    CSW200
     C                     EXSR SRIT                                      CSW200
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
      * CHAPS Sort Code Validation                                        CSW200
      *                                                                   CSW200
     C           I#ACSC    IFEQ '//SC'                                    CSW200
     C                     EXSR SRSC                                      CSW200
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
      * Swiss Clearing Validation                                         CSW200
      *                                                                   CSW200
     C           I#ACSC    IFEQ '//SW'                                    CSW200
     C                     EXSR SRSW                                      CSW200
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
      * Austrian Bankleitzahl Validation                                  CSW200
      *                                                                   CSW200
     C           I#ACSC    IFEQ '//AT'                                    CSW200
     C                     EXSR SRAT                                      CSW200
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
      * Australian Bank State Code Validation                             CSW200
      *                                                                   CSW200
     C           I#ACSC    IFEQ '//AU'                                    CSW200
     C                     EXSR SRAU                                      CSW200
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
      * Hong Kong Validation                                              CSW200
      *                                                                   CSW200
     C           I#ACSC    IFEQ '//HK'                                    CSW200
     C                     EXSR SRHK                                      CSW200
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
      * Irish National Clearing Validation                                CSW200
      *                                                                   CSW200
     C           I#ACSC    IFEQ '//IE'                                    CSW200
     C                     EXSR SRIE                                      CSW200
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
      * Portugal National Clearing Validation                             CSW200
      *                                                                   CSW200
     C           I#ACSC    IFEQ '//PT'                                    CSW200
     C                     EXSR SRPT                                      CSW200
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
      * Russian Central Bank Identification Code Validation               CSW200
      *                                                                   CSW200
     C           I#ACSC    IFEQ '//RU'                                    CSW200
     C                     EXSR SRRU                                      CSW200
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
      * ZA Clearing Validation                                            CSW200
      *                                                                   CSW200
     C           I#ACSC    IFEQ '//ZA'                                    CSW200
     C           I#MTYP    IFEQ '202'                                     CSW200
     C           I#MTYP    OREQ '210'                                     CSW200
     C                     EXSR SRZA                                      CSW200
     C                     ELSE                                           CSW200
     C           I#PR      IFEQ 'REC'                                     CSW200
     C                     MOVEL##RER1    ERCD,E                          CSW200
     C                     ELSE                                           CSW200
     C                     MOVEL##PER1    ERCD,E                          CSW200
     C                     ENDIF                                          CSW200
     C                     ADD  1         E                               CSW200
     C                     MOVEL'Y'       E#ERRM                          CSW200
      * Send error message                                                CSW200
      *                                                                   CSW200
     C                     MOVEL'MEC0028' MEMSID                          CSW200
     C                     MOVEL'MEMSG'   MEMSGF                          CSW200
     C                     MOVEL*BLANKS   MEMSDT                          CSW200
     C                     EXSR SRSNMS                                    CSW200
     C                     GOTO EXRT                                      CSW200
     C                     ENDIF                                          CSW200
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
      * New Zealand Code validation                                       CSW200
      *                                                                   CSW200
     C           I#ACCL    IFEQ '//NZ'                                    CSW200
     C           I#VFLD    IFEQ 'AWBK'                                    CSW200
     C           I#MTYP    ANDEQ'100'                                     CSW200
     C           I#VFLD    OREQ 'AWBK'                                    CFT014
     C           I#MTYP    ANDEQ'103'                                     CFT014
     C                     EXSR SRNZ                                      CSW200
     C                     ELSE                                           CSW200
     C           I#PR      IFEQ 'REC'                                     CSW200
     C                     MOVEL##RER1    ERCD,E                          CSW200
     C                     ELSE                                           CSW200
     C                     MOVEL##PER1    ERCD,E                          CSW200
     C                     ENDIF                                          CSW200
     C                     ENDIF                                          CSW200
     C                     ADD  1         E                               CSW200
     C                     MOVEL'Y'       E#ERRM                          CSW200
      * Send error message                                                CSW200
      *                                                                   CSW200
     C                     MOVEL'MEC0029' MEMSID                          CSW200
     C                     MOVEL'MEMSG'   MEMSGF                          CSW200
     C                     MOVEL*BLANKS   MEMSDT                          CSW200
     C                     EXSR SRSNMS                                    CSW200
     C                     GOTO EXRT                                      CSW200
     C                     ENDIF                                          CSW200
      *                                                                                       CSW202
     C           I#ACCL    IFEQ '//GR'                                                        CSW202
     C           I#MTYP    ANDNE'202'                                                         CSW202
     C           I#VFLD    ANDEQ'BENF '                                                       CSW202
     C           I#ACCL    OREQ '//IN'                                                        CSW202
     C           I#MTYP    ANDNE'202'                                                         CSW202
     C           I#VFLD    ANDEQ'BENF '                                                       CSW202
     C                     MOVEL'846'     ERCD,E                                              CSW202
     C                     ADD  1         E                                                   CSW202
     C                     MOVEL'Y'       E#ERRM                                              CSW202
     C                     GOTO EXRT                                                          CSW202
     C                     ENDIF                                                              CSW202
      *                                                                                       CSW202
      ** //GR (Hellenic Bank Identifier Code) validation                                      CSW202
      *                                                                                       CSW202
     C           I#ACCL    IFEQ '//GR'                                                        CSW202
     C                     EXSR SRGR                                                          CSW202
     C                     ENDIF                                                              CSW202
      *                                                                                       CSW202
      ** //IN (Indian Financial System Code) validation                                       CSW202
      *                                                                                       CSW202
     C           I#ACCL    IFEQ '//IN'                                                        CSW202
     C                     EXSR SRIN                                                          CSW202
     C                     ENDIF                                                              CSW202
      *                                                                                     MD034498
      ** Validate the new clearing code //CN - China National                               MD034498
      *  Advance Payment System (CNAPS) Code                                                MD034498
      *                                                                                     MD034498
     C           I#ACSC    IFEQ '//CN'                                                      MD034498
     C                     EXSR SRCN                                                        MD034498
     C                     ENDIF                                                            MD034498
      *                                                                   CSW200
     C                     ENDIF                                          CSW200
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
      * If currency clearing extension validation then action             CSW200
     C           E#ERRM    IFEQ *BLANKS                                   CSW200
     C           DPEXPM    ANDNE'*NONE'                                   CSW200
     C           DPEXPM    ANDNE*BLANKS                                   CSW200
     C                     EXSR SRCEXT                                    CSW200
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
      *  If a SWIFT BIC has been entered                                  CSW200
     C                     ELSE                                           CSW200
      *                                                                   CSW200
      * Copy point for RT Clearing Validation                             CSW200
     C/COPY WNCPYSRC,ME9940RT4                                            CSW200
      *                                                                   CSW200
      ** //RT must be followed blanks only.                               CSW200
      *                                                                   CSW200
     C                     MOVELI#ACLN    ##FLD  35 P                     CSW200
     C           ' '       CHECK##FLD:5   Y#      50     90               CSW200
      *                                                                   CSW200
      *                                                                   CSW200
      * Invalid if *IN90 on                                               CSW200
      *                                                                   CSW200
     C           *IN90     IFEQ *ON                                       CSW200
     C           I#PR      IFEQ 'REC'                                     CSW200
     C                     MOVEL##RER1    ERCD,E                          CSW200
     C                     ELSE                                           CSW200
     C                     MOVEL##PER1    ERCD,E                          CSW200
     C                     ENDIF                                          CSW200
     C                     ADD  1         E                               CSW200
     C                     MOVEL'Y'       E#ERRM                          CSW200
      *                                                                   CSW200
      * Send error message                                                CSW200
      *                                                                   CSW200
     C                     MOVEL'MEC0027' MEMSID                          CSW200
     C                     MOVEL'MEMSG'   MEMSGF                          CSW200
     C                     MOVELY#        MEMSDT                          CSW200
     C                     EXSR SRSNMS                                    CSW200
      *                                                                   CSW200
      * Exit subroutine                                                   CSW200
      *                                                                   CSW200
     C                     GOTO EXRT                                      CSW200
     C                     ENDIF                                          CSW200
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
      *  Unwind subroutine stack name                                     CSW200
      *                                                                   CSW200
     C           EXRT      TAG                                            CSW200
     C                     MOVEA*BLANKS   @STK,Q                          CSW200
     C                     SUB  1         Q                               CSW200
      *                                                                   CSW200
      *                                                                   CSW200
     CSR                   ENDSR                                          CSW200
      *****************************************************************   CSW200
     C/EJECT                                                                                  CSW202
      *****************************************************************                       CSW202
      *                                                               *                       CSW202
      *  SRGR     : Validate Hellenic Bank Identifier Code            *                       CSW202
      *                                                               *                       CSW202
      *  Called By: SRINBK - Intermediary Institution                 *                       CSW202
      *             SRAWBK - Account with Institution                 *                       CSW202
      *             SRBENF - Beneficiary                              *                       CSW202
      *                                                               *                       CSW202
      *****************************************************************                       CSW202
     C           SRGR      BEGSR                                                              CSW202
      *                                                                                       CSW202
      ** Set up subroutine stack name                                                         CSW202
      *                                                                                       CSW202
     C                     ADD  1         Q                                                   CSW202
     C                     MOVEL'SRGR  '  @STK,Q                                              CSW202
      *                                                                                       CSW202
      ** Copy point for Hellenic Bank Identifier Code Validation                              CSW202
      *                                                                                       CSW202
     C/COPY WNCPYSRC,ME9940GR                                                                 CSW202
      *                                                                                       CSW202
      ** If //GR it must be followed by a 7 digit number. The number                          CSW202
      ** must be followed by blanks.                                                          CSW202
      *                                                                                       CSW202
      ** Check if this is preceded by a real time clearing code                               CSW202
      *                                                                                       CSW202
     C           I#ACCL    IFEQ '//RT'                                                        CSW202
     C                     MOVE *BLANKS   ##FLD                                               CSW202
     C                     SUBSTI#ACLN:5  ##FLD                                               CSW202
     C                     ELSE                                                               CSW202
     C                     MOVELI#ACLN    ##FLD     P                                         CSW202
     C                     ENDIF                                                              CSW202
      *                                                                                       CSW202
     C           DIGITS    CHECK##FLD:5   Y#             90                                   CSW202
      *                                                                                       CSW202
      **  If *IN90 if off i.e. field is completely filled set it on                           CSW202
      *                                                                                       CSW202
     C           *IN90     IFEQ *OFF                                                          CSW202
     C                     MOVEL*ON       *IN90                                               CSW202
     C                     ENDIF                                                              CSW202
      *                                                                                       CSW202
      ** 7 Numeric followed by blanks                                                         CSW202
      *                                                                                       CSW202
     C           *IN90     IFEQ *ON                                                           CSW202
     C           Y#        ANDEQ12                                                            CSW202
      *                                                                                       CSW202
     C           ' '       CHECK##FLD:12  Y#             90                                   CSW202
      *                                                                                       CSW202
     C                     ENDIF                                                              CSW202
      *                                                                                       CSW202
      ** Invalid if *IN90 on                                                                  CSW202
      *                                                                                       CSW202
     C           *IN90     IFEQ *ON                                                           CSW202
     C           I#PR      IFEQ 'REC'                                                         CSW202
     C                     MOVEL##RER1    ERCD,E                                              CSW202
     C                     ELSE                                                               CSW202
     C                     MOVEL##PER1    ERCD,E                                              CSW202
     C                     ENDIF                                                              CSW202
     C                     ADD  1         E                                                   CSW202
     C                     MOVEL'Y'       E#ERRM                                              CSW202
      *                                                                                       CSW202
      ** adjust the error position                                                            CSW202
      *                                                                                       CSW202
     C           I#ACCL    IFEQ '//RT'                                                        CSW202
     C                     ADD  4         Y#                                                  CSW202
     C                     ENDIF                                                              CSW202
      *                                                                                       CSW202
      ** Send error message                                                                   CSW202
      *                                                                                       CSW202
     C                     MOVEL'MEC0305' MEMSID                                              CSW202
     C                     MOVEL'MEMSG'   MEMSGF                                              CSW202
     C                     MOVELY#        MEMSDT                                              CSW202
     C                     EXSR SRSNMS                                                        CSW202
      *                                                                                       CSW202
      ** Exit subroutine                                                                      CSW202
      *                                                                                       CSW202
     C                     GOTO EXGR                                                          CSW202
     C/COPY WNCPYSRC,ME9940C010                                                               CSW202
     C                     ENDIF                                                              CSW202
      *                                                                                       CSW202
      ** Unwind subroutine stack name                                                         CSW202
      *                                                                                       CSW202
     C           EXGR      TAG                                                                CSW202
     C                     MOVEA*BLANKS   @STK,Q                                              CSW202
     C                     SUB  1         Q                                                   CSW202
      *                                                                                       CSW202
     C                     ENDSR                                                              CSW202
      *****************************************************************                       CSW202
     C/EJECT                                                                                  CSW202
      *****************************************************************                       CSW202
      *                                                               *                       CSW202
      *  SRIN     : Validate Indian Financial System Code             *                       CSW202
      *                                                               *                       CSW202
      *  Called By: SRINBK - Intermediary Institution                 *                       CSW202
      *             SRAWBK - Account with Institution                 *                       CSW202
      *             SRBENF - Beneficiary                              *                       CSW202
      *                                                               *                       CSW202
      *****************************************************************                       CSW202
     C           SRIN      BEGSR                                                              CSW202
      *                                                                                       CSW202
      ** Set up subroutine stack name                                                         CSW202
      *                                                                                       CSW202
     C                     ADD  1         Q                                                   CSW202
     C                     MOVEL'SRIN  '  @STK,Q                                              CSW202
      *                                                                                       CSW202
      ** Copy point for Indian Financial System Codee                                         CSW202
      *                                                                                       CSW202
     C/COPY WNCPYSRC,ME9940IN                                                                 CSW202
      *                                                                                       CSW202
      ** If //IN it must be followed by 11 alphanumeric. The number                           CSW202
      ** must be followed by blanks.                                                          CSW202
      *                                                                                       CSW202
      ** Check if this is preceded by a real time clearing code                               CSW202
      *                                                                                       CSW202
     C           I#ACCL    IFEQ '//RT'                                                        CSW202
     C                     MOVE *BLANKS   ##FLD                                               CSW202
     C                     SUBSTI#ACLN:5  ##FLD                                               CSW202
     C                     ELSE                                                               CSW202
     C                     MOVELI#ACLN    ##FLD     P                                         CSW202
     C                     ENDIF                                                              CSW202
      *                                                                                       CSW202
     C           ALPHAN    CHECK##FLD:5   Y#             90                                   CSW202
      *                                                                                       CSW202
      ** If *IN90 if off i.e. field is completely filled set it on                            CSW202
      *                                                                                       CSW202
     C           *IN90     IFEQ *OFF                                                          CSW202
     C                     MOVEL*ON       *IN90                                               CSW202
     C                     ENDIF                                                              CSW202
      *                                                                                       CSW202
      ** 11 Alphanumeric followed by blanks                                                   CSW202
      *                                                                                       CSW202
     C           *IN90     IFEQ *ON                                                           CSW202
     C           Y#        ANDEQ16                                                            CSW202
     C           ' '       CHECK##FLD:16  Y#             90                                   CSW202
     C                     ENDIF                                                              CSW202
      *                                                                                       CSW202
      ** Invalid if *IN90 on                                                                  CSW202
      *                                                                                       CSW202
     C           *IN90     IFEQ *ON                                                           CSW202
     C           I#PR      IFEQ 'REC'                                                         CSW202
     C                     MOVEL##RER1    ERCD,E                                              CSW202
     C                     ELSE                                                               CSW202
     C                     MOVEL##PER1    ERCD,E                                              CSW202
     C                     ENDIF                                                              CSW202
     C                     ADD  1         E                                                   CSW202
     C                     MOVEL'Y'       E#ERRM                                              CSW202
      *                                                                                       CSW202
      ** adjust the error position                                                            CSW202
      *                                                                                       CSW202
     C           I#ACCL    IFEQ '//RT'                                                        CSW202
     C                     ADD  4         Y#                                                  CSW202
     C                     ENDIF                                                              CSW202
      *                                                                                       CSW202
      ** Send error message                                                                   CSW202
      *                                                                                       CSW202
     C                     MOVEL'MEC0303' MEMSID                                              CSW202
     C                     MOVEL'MEMSG'   MEMSGF                                              CSW202
     C                     MOVELY#        MEMSDT                                              CSW202
     C                     EXSR SRSNMS                                                        CSW202
      *                                                                                       CSW202
      ** Exit subroutine                                                                      CSW202
      *                                                                                       CSW202
     C                     GOTO EXIN                                                          CSW202
     C/COPY WNCPYSRC,ME9940C011                                                               CSW202
     C                     ENDIF                                                              CSW202
      *                                                                                       CSW202
      ** Unwind subroutine stack name                                                         CSW202
      *                                                                                       CSW202
     C           EXIN      TAG                                                                CSW202
     C                     MOVEA*BLANKS   @STK,Q                                              CSW202
     C                     SUB  1         Q                                                   CSW202
      *                                                                                       CSW202
     C                     ENDSR                                                              CSW202
      *****************************************************************                       CSW202
     C/EJECT                                                                                  CSW206
      *****************************************************************                       CSW206
      *                                                               *                       CSW206
      *  SRPL     : Validate Polish National System Code              *                       CSW206
      *                                                               *                       CSW206
      *  Called By: SRINBK - Intermediary Institution                 *                       CSW206
      *             SRAWBK - Account with Institution                 *                       CSW206
      *             SRBENF - Beneficiary                              *                       CSW206
      *                                                               *                       CSW206
      *****************************************************************                       CSW206
     C           SRPL      BEGSR                                                              CSW206
      *                                                                                       CSW206
      ** Set up subroutine stack name                                                         CSW206
      *                                                                                       CSW206
     C                     ADD  1         Q                                                   CSW206
     C                     MOVEL'SRPL  '  @STK,Q                                              CSW206
      *                                                                                       CSW206
      ***Check*if*this*is*preceded*by*a*real*time*clearing*code**                     CSW206 CSW206A
      *                                                                                       CSW206
     C********** I#ACCL    IFEQ '//PL'                                                CSW206 CSW206A
     C                     MOVE *BLANKS   ##FLD                                               CSW206
     C**********           SUBSTI#ACLN:5  ##FLD                                       CSW206 CSW206A
     C**********           ELSE                                                       CSW206 CSW206A
     C                     MOVELI#ACLN    ##FLD     P                                         CSW206
     C**********           ENDIF                                                      CSW206 CSW206A
      *                                                                                       CSW206
     C           DIGITS    CHECK##FLD:5   Y#             90                                   CSW206
      *                                                                                       CSW206
      ** If *IN90 if off i.e. field is completely filled set it on                            CSW206
      *                                                                                       CSW206
     C           *IN90     IFEQ *OFF                                                          CSW206
     C                     MOVEL*ON       *IN90                                               CSW206
     C                     ENDIF                                                              CSW206
      *                                                                                       CSW206
      ** 8 Numeric followed by blanks                                                         CSW206
      *                                                                                       CSW206
     C           *IN90     IFEQ *ON                                                           CSW206
     C********** Y#        ANDEQ9                                                     CSW206 CSW206A
     C********** ' '       CHECK##FLD:9   Y#             90                           CSW206 CSW206A
     C           Y#        ANDEQ13                                                           CSW206A
     C           ' '       CHECK##FLD:13  Y#             90                                  CSW206A
     C                     ENDIF                                                             CSW206A
      *                                                                                       CSW206
      ** Invalid if *IN90 on                                                                  CSW206
      *                                                                                       CSW206
     C           *IN90     IFEQ *ON                                                           CSW206
     C           I#PR      IFEQ 'REC'                                                         CSW206
     C                     MOVEL##RER1    ERCD,E                                              CSW206
     C                     ELSE                                                               CSW206
     C                     MOVEL##PER1    ERCD,E                                              CSW206
     C                     ENDIF                                                              CSW206
     C                     ADD  1         E                                                   CSW206
     C                     MOVEL'Y'       E#ERRM                                              CSW206
      *                                                                                       CSW206
      ***adjust*the*error*position**                                                  CSW206 CSW206A
      *                                                                                       CSW206
     C********** I#ACCL    IFEQ '//PL'                                                CSW206 CSW206A
     C**********           ADD  4         Y#                                          CSW206 CSW206A
     C**********           ENDIF                                                      CSW206 CSW206A
      *                                                                                       CSW206
      ** Send error message                                                                   CSW206
      *                                                                                       CSW206
     C                     MOVEL'MEC0400' MEMSID                                              CSW206
     C                     MOVEL'MEMSG'   MEMSGF                                              CSW206
     C                     MOVELY#        MEMSDT                                              CSW206
     C                     EXSR SRSNMS                                                        CSW206
      *                                                                                       CSW206
      ** Exit subroutine                                                                      CSW206
      *                                                                                       CSW206
     C                     GOTO EXPL                                                          CSW206
     C                     ENDIF                                                              CSW206
      *                                                                                       CSW206
      ** Unwind subroutine stack name                                                         CSW206
      *                                                                                       CSW206
     C           EXPL      TAG                                                                CSW206
     C                     MOVEA*BLANKS   @STK,Q                                              CSW206
     C                     SUB  1         Q                                                   CSW206
      *                                                                                       CSW206
     C                     ENDSR                                                              CSW206
      *****************************************************************                       CSW215
     C/EJECT                                                                                  CSW215
      *****************************************************************                       CSW215
      *                                                               *                       CSW215
      *  SRCN     : Validate China National Advanced Payment System   *                       CSW215
      *             (CNAPS) Code                                      *                       CSW215
      *                                                               *                       CSW215
      *  Called By: SRINBK - Intermediary Institution                 *                       CSW215
      *             SRAWBK - Account with Institution                 *                       CSW215
      *                                                               *                       CSW215
      *****************************************************************                       CSW215
     C           SRCN      BEGSR                                                              CSW215
      *                                                                                       CSW215
      ** Set up subroutine stack name                                                         CSW215
      *                                                                                       CSW215
     C                     ADD  1         Q                                                   CSW215
     C                     MOVEL'SRCN  '  @STK,Q                                              CSW215
     C                     MOVE *BLANKS   ##FLD                                               CSW215
      *                                                                                     MD034498
      * Check if this is preceded by a real time clearing code                              MD034498
      *                                                                                     MD034498
     C           I#ACCL    IFEQ '//RT'                                                      MD034498
     C                     SUBSTI#ACLN:5  ##FLD                                             MD034498
     C                     ELSE                                                             MD034498
     C                     MOVELI#ACLN    ##FLD     P                                         CSW215
     C                     ENDIF                                                            MD034498
      *                                                                                       CSW215
     C           DIGITS    CHECK##FLD:5   Y#             90                                   CSW215
      *                                                                                       CSW215
      ** If *IN90 if off i.e. field is completely filled set it on                            CSW215
      *                                                                                       CSW215
     C           *IN90     IFEQ *OFF                                                          CSW215
     C                     MOVEL*ON       *IN90                                               CSW215
     C                     ENDIF                                                              CSW215
      *                                                                                       CSW215
      ** 12-14 Numeric followed by blanks                                                     CSW215
      *                                                                                       CSW215
     C           *IN90     IFEQ *ON                                                           CSW215
     C           Y#        ANDGE17                                                            CSW215
     C           Y#        ANDLE19                                                            CSW215
     C                     Z-ADDY#        X#                                                  CSW215
     C           ' '       CHECK##FLD:X#  Y#             90                                   CSW215
     C                     ENDIF                                                              CSW215
      *                                                                                       CSW215
      ** Invalid if *IN90 on                                                                  CSW215
      *                                                                                       CSW215
     C           *IN90     IFEQ *ON                                                           CSW215
     C           I#PR      IFEQ 'REC'                                                         CSW215
     C                     MOVEL##RER1    ERCD,E                                              CSW215
     C                     ELSE                                                               CSW215
     C                     MOVEL##PER1    ERCD,E                                              CSW215
     C                     ENDIF                                                              CSW215
     C                     ADD  1         E                                                   CSW215
     C                     MOVEL'Y'       E#ERRM                                              CSW215
      *                                                                                       CSW215
      ** Send error message                                                                   CSW215
      *                                                                                       CSW215
     C                     MOVEL'MEC0500' MEMSID                                              CSW215
     C                     MOVEL'MEMSG'   MEMSGF                                              CSW215
     C                     MOVEL*BLANKS   MEMSDT                                              CSW215
     C                     EXSR SRSNMS                                                        CSW215
      *                                                                                       CSW215
      ** Exit subroutine                                                                      CSW215
      *                                                                                       CSW215
     C                     GOTO EXCN                                                          CSW215
     C                     ENDIF                                                              CSW215
      *                                                                                       CSW215
      ** Unwind subroutine stack name                                                         CSW215
      *                                                                                       CSW215
     C           EXCN      TAG                                                                CSW215
     C                     MOVEA*BLANKS   @STK,Q                                              CSW215
     C                     SUB  1         Q                                                   CSW215
      *                                                                                       CSW215
     C                     ENDSR                                                              CSW215
      *****************************************************************                       CSW206
     C/EJECT
      *****************************************************************
      *                                                               *
      *  SRSNMS   : Send Message to Calling program                   *
      *                                                               *
      *  CALLED BY: *Any Error                                        *
      *                                                               *
      *****************************************************************
     CSR         SRSNMS    BEGSR
      *
      *  Set up subroutine stack name
      *
     C                     ADD  1         Q       50
     C                     MOVEL'SRSNMS'  @STK,Q
      *
      * Copy point for Send error message
     C/COPY WNCPYSRC,ME9940SNMS
      *
      * Obtain leading text for field
      *
     C           E#MSGD    IFNE *BLANKS
     C                     CALL 'MEC1150'              9090
     C                     PARM E#MSGD    #MSGID
     C                     PARM E#MSGF    #MSGF
     C                     PARM           #MSDTA
     C                     PARM *BLANKS   #MSTX1
     C                     PARM *BLANKS   #MSTX2
      *
     C           MEMSDT    CAT  #MSTX1:0  MEMSDT
     C                     END
      *                                                                   CFT014
      ** Save first the message Id/data to be used by any ILE (*Module)   CFT014
      ** calling program.                                                 CFT014
      *                                                                   CFT014
     C                     MOVELMEMSID    WMSGID  7                       CFT014
     C                     MOVELMEMSDT    WMSGDT256                       CFT014
      *
      * Send message
      *
     C                     MOVELE#CPGM    MEPGMQ
     C                     EXSR MESNMS
      *                                                                   CFT014
      ** After sending the message, set the error description parameter   CFT014
      ** field (E#MSGD) to the error message id.                          CFT014
      *                                                                   CFT014
     C           E#CPGM    IFEQ WFTOPY                                    CFT014
     C           E#CPGM    OREQ WTRAD                                                       AR589197
     C           E#CPGM    OREQ WDPMV                                                       AR589197
     C                     MOVELWMSGID    E#MSGD                          CFT014
     C                     MOVELWMSGDT    Z#PARM                          CFT014
     C                     ENDIF                                          CFT014
      *
      *  Unwind subroutine stack name
      *
     C           EXSNMS    TAG
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     CSR                   ENDSR
      *****************************************************************                       CSW213
     C/EJECT                                                                                  CSW213
      *****************************************************************                       CSW213
      *                                                               *                       CSW213
      *  SRCUSD   : Validate clearing identification for CUSD         *                       CSW213
      *                                                               *                       CSW213
      *  CALLED BY: Main processing                                   *                       CSW213
      *                                                               *                       CSW213
      *****************************************************************                       CSW213
     CSR         SRCUSD    BEGSR                                                              CSW213
      *                                                                                       CSW213
      ** Set up subroutine stack name                                                         CSW213
      *                                                                                       CSW213
     C                     ADD  1         Q                                                   CSW213
     C                     MOVEL'SRCUSD'  @STK,Q                                              CSW213
      *                                                                                       CSW213
     C                     MOVEL'975'     ##PER1                                              CSW213
     C                     MOVEL'976'     ##PER2                                              CSW213
     C                     EXSR SRCCSY                                                        CSW213
      *                                                                                       CSW213
     C                     SELEC                                                              CSW213
      *                                                                                       CSW213
     C           I#ACCL    WHEQ '//CC'                                                        CSW213
     C                     MOVEL'977'     ##PER1                                              CSW213
     C                     EXSR SRCC                                                          CSW213
      *                                                                                       CSW213
     C           I#ACCL    WHEQ '//ES'                                                        CSW213
     C                     MOVEL'977'     ##PER1                                              CSW213
     C                     EXSR SRES                                                          CSW213
      *                                                                                       CSW213
     C           I#ACCL    WHEQ '//RT'                                                        CSW213
     C                     MOVEL'977'     ##PER1                                              CSW213
     C                     MOVEL'975'     ##PER3                                              CSW213
     C                     EXSR SRRT                                                          CSW213
      *                                                                                       CSW213
     C           I#ACCL    WHEQ '//IT'                                                        CSW213
     C                     MOVEL'977'     ##PER1                                              CSW213
     C                     EXSR SRIT                                                          CSW213
      *                                                                                       CSW213
     C           I#ACCL    WHEQ '//SW'                                                        CSW213
     C                     MOVEL'977'     ##PER1                                              CSW213
     C                     EXSR SRSW                                                          CSW213
      *                                                                                       CSW213
     C           I#ACCL    WHEQ '//ES'                                                        CSW213
     C                     MOVEL'977'     ##PER1                                              CSW213
     C                     EXSR SRES                                                          CSW213
      *                                                                                       CSW213
     C           I#ACCL    WHEQ '//AT'                                                        CSW213
     C                     MOVEL'977'     ##PER1                                              CSW213
     C                     EXSR SRAT                                                          CSW213
      *                                                                                       CSW213
     C           I#ACCL    WHEQ '//AU'                                                        CSW213
     C                     MOVEL'977'     ##PER1                                              CSW213
     C                     EXSR SRAU                                                          CSW213
      *                                                                                       CSW213
     C           I#ACCL    WHEQ '//HK'                                                        CSW213
     C                     MOVEL'977'     ##PER1                                              CSW213
     C                     EXSR SRHK                                                          CSW213
      *                                                                                       CSW213
     C           I#ACCL    WHEQ '//IE'                                                        CSW213
     C                     MOVEL'977'     ##PER1                                              CSW213
     C                     EXSR SRIE                                                          CSW213
      *                                                                                       CSW213
     C           I#ACCL    WHEQ '//PT'                                                        CSW213
     C                     MOVEL'977'     ##PER1                                              CSW213
     C                     EXSR SRPT                                                          CSW213
      *                                                                                       CSW213
     C           I#ACCL    WHEQ '//RU'                                                        CSW213
     C                     MOVEL'977'     ##PER1                                              CSW213
     C                     EXSR SRRU                                                          CSW213
      *                                                                                       CSW213
     C           I#ACCL    WHEQ '//ZA'                                                        CSW213
     C                     MOVEL'977'     ##PER1                                              CSW213
      *                                                                                       CSW213
      ** Check SWIFT BIC code, if one on file for this client, is valid                       CSW213
      *                                                                                       CSW213
     C                     SELEC                                                              CSW213
      * When customer                                                                         CSW213
     C           W9CUST    WHEQ 'Y'                                                           CSW213
     C           I#PRTT    ANDNE'S'                                                           CSW213
     C                     MOVELBBCSID    W9BICC                                              CSW213
     C                     MOVE *BLANKS   W9BICB                                              CSW213
      * When conterparty nostro                                                               CSW213
     C           W9CNST    WHEQ 'Y'                                                           CSW213
     C           I#PRTT    ANDNE'S'                                                           CSW213
     C                     MOVELAWSWID    W9BICC                                              CSW213
     C                     MOVE *BLANKS   W9BICB                                              CSW213
      * Otherwise SWIFT BIC address                                                           CSW213
     C                     OTHER                                                              CSW213
     C                     MOVELI#PRTY    W9BICC                                              CSW213
     C           3         SUBSTI#PRTY:9  W9BICB                                              CSW213
     C                     ENDSL                                                              CSW213
      *                                                                                       CSW213
     C                     CALL 'ME1400'                                                      CSW213
     C                     PARM *BLANKS   W9RTN                                               CSW213
     C                     PARM           W9BICC                                              CSW213
     C                     PARM           W9BICB                                              CSW213
     C                     PARM           SDCUST                                              CSW213
     C                     PARM           SDCNST                                              CSW213
     C                     PARM           MEBICD                                              CSW213
     C                     PARM *BLANKS   WKCUST                                              CSW213
     C                     PARM *BLANKS   WKCNST                                              CSW213
     C                     PARM *BLANKS   WKBICD                                              CSW213
      *                                                                                       CSW213
      ** If a SWIFT BIC has not been entered                                                  CSW213
      *                                                                                       CSW213
     C           WKBICD    IFNE 'Y'                                                           CSW213
     C           WKCUST    ANDNE'Y'                                                           CSW213
     C           WKCNST    ANDNE'Y'                                                           CSW213
      *                                                                                       CSW213
     C                     EXSR SRZA                                                          CSW213
      *                                                                                       CSW213
      ** A SWIFT BIC has been entered                                                         CSW213
     C                     ELSE                                                               CSW213
      *                                                                                       CSW213
     C                     MOVEL##PER1    ERCD,E                                              CSW213
     C                     ADD  1         E                                                   CSW213
     C                     MOVEL'Y'       E#ERRM                                              CSW213
     C                     MOVEL'MEC0038' MEMSID                                              CSW213
     C                     MOVEL'MEMSG'   MEMSGF                                              CSW213
     C                     MOVEL*BLANKS   MEMSDT                                              CSW213
     C                     EXSR SRSNMS                                                        CSW213
     C                     ENDIF                                                              CSW213
      *                                                                                       CSW213
     C           I#ACCL    WHEQ '//NZ'                                                        CSW213
     C                     MOVEL'977'     ##PER1                                              CSW213
     C                     EXSR SRNZ                                                          CSW213
      *                                                                                       CSW213
     C           I#ACCL    WHEQ '//GR'                                                        CSW213
     C                     MOVEL'977'     ##PER1                                              CSW213
     C                     EXSR SRGR                                                          CSW213
      *                                                                                       CSW213
     C           I#ACCL    WHEQ '//IN'                                                        CSW213
     C                     MOVEL'977'     ##PER1                                              CSW213
     C                     EXSR SRIN                                                          CSW213
      *                                                                                       CSW213
     C           I#ACCL    WHEQ '//PL'                                                        CSW213
     C                     MOVEL'977'     ##PER1                                              CSW213
     C                     EXSR SRPL                                                          CSW213
      *                                                                                       CSW213
      ** Set error if                                                                         CSW213
      *                                                                                       CSW213
     C           I#ACCL    WHEQ '//BL'                                                        CSW213
     C           I#ACCL    WHEQ '//CH'                                                        CSW213
     C           I#ACCL    WHEQ '//CP'                                                        CSW213
     C           I#ACCL    WHEQ '//FW'                                                        CSW213
     C           I#ACCL    WHEQ '//SC'                                                        CSW213
     C           I#ACCL    WHEQ '//JP'                                                        CSW213
     C                     MOVEL'Y'       E#ERRM                                              CSW213
     C                     MOVEL'5046092' WMSGID                                              CSW213
     C                     ENDSL                                                              CSW213
      *                                                                                       CSW213
     C           E#ERRM    IFEQ 'Y'                                                           CSW213
     C           WMSGID    ANDNE*BLANKS                                                       CSW213
     C                     MOVELWMSGID    E#MSGD                                              CSW213
     C                     ENDIF                                                              CSW213
      *                                                                                       CSW213
      ** Unwind subroutine stack name                                                         CSW213
      *                                                                                       CSW213
     C                     MOVEA*BLANKS   @STK,Q                                              CSW213
     C                     SUB  1         Q                                                   CSW213
      *                                                                                       CSW213
     CSR                   ENDSR                                                              CSW213
      *****************************************************************
     C/EJECT
      *****************************************************************
      *                                                               *
      *  SRINIT   : Initialise and define fields                      *
      *                                                               *
      *  CALLED BY: Main processing                                   *
      *                                                               *
      *****************************************************************
     CSR         SRINIT    BEGSR
      *
      *  Set up copyright statement
      *
     C                     MOVEACPY@      CPY2@  80
      *
      *  Set up subroutine stack name
      *
     C                     ADD  1         Q       50
     C                     MOVEL'SRINIT'  @STK,Q
      *
      *  Indicate that set up is complete
      *
     C                     MOVEL'Y'       $FIRST  1
      *
      *  Get Rundate information
      *
     C           *NAMVAR   DEFN RUNDAT    RUNDTA
     C                     IN   RUNDTA
     C                     MOVE AGMRDT    WUMRDT  7        Midas Run date
     C                     MOVE AGRDNB    WURDNB  50       Run day number
     C                     MOVE AGSUC     WUSUC   1        Set up complete
     C                     MOVE AGDFF     WUDFF   1        Date Format
     C                     MOVE AGMBIN    WUMBIN  1        Multi Branched
      *
      * Get modules information
      *
     C                     CALL 'AOMMODR0'             9090
     C                     PARM *BLANKS   P@RTCD  7        B:Return code
     C                     PARM '*FIRST ' P@OPTN  7        I:Option
     C           MMODDS    PARM *BLANKS   DSFDY            O:Module Flg
      *
      *  If return with an error (LR seton in called program) then
      *  process for database error.
      *
     C           *IN90     IFEQ '1'
     C           P@RTCD    OREQ '*ERROR*'
     C                     MOVEL'AOMMODR0'W0FILE
     C                     MOVEL'*CALL'   W0KEY            ***************
     C                     Z-ADD5         W0ERNB           * DB ERROR 05 *
     C                     MOVEL'MEM5003' W0MSGD           ***************
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     END
      *
      * Check if SWIFT 96 active
      *
     C                     CALL 'SWIFT96'              9090
     C                     PARM *BLANKS   CSW096  7        B:Return code
      *
      *  If return with an error (LR seton in called program) then
      *  process for database error.
      *
     C           *IN90     IFEQ '1'
     C                     MOVEL'SWIFT96' W0FILE
     C                     MOVEL'*CALL'   W0KEY            ***************
     C                     Z-ADD6         W0ERNB           * DB ERROR 05 *
     C                     MOVEL'MEM5003' W0MSGD           ***************
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     END
      *
      * Check if SWIFT 97 active                                          CSW097
      *                                                                   CSW097
     C                     CALL 'SWIFT97'              9090               CSW097
     C                     PARM *BLANKS   CSW097  7        B:Return code  CSW097
      *                                                                   CSW097
      *  If return with an error (LR seton in called program) then        CSW097
      *  process for database error.                                      CSW097
      *                                                                   CSW097
     C           *IN90     IFEQ '1'                                       CSW097
     C                     MOVEL'SWIFT97' W0FILE                          CSW097
     C                     MOVEL'*CALL'   W0KEY            ***************CSW097
     C                     Z-ADD7         W0ERNB           * DB ERROR 07 *CSW097
     C                     MOVEL'MEM5003' W0MSGD           ***************CSW097
     C                     MOVEL'MIDAS  ' W0MSGF                          CSW097
     C                     EXSR SRERR                                     CSW097
     C                     END                                            CSW097
      *                                                                   CSW097
      *                                                                   CSW098
      * Check if SWIFT 98 active                                          CSW098
      *                                                                   CSW098
     C                     CALL 'SWIFT98'              9090               CSW098
     C                     PARM *BLANKS   CSW098  7        B:Return code  CSW098
      *                                                                   CSW098
      *  If return with an error (LR seton in called program) then        CSW098
      *  process for database error.                                      CSW098
      *                                                                   CSW098
     C           *IN90     IFEQ '1'                                       CSW098
     C                     MOVEL'SWIFT98' W0FILE                          CSW098
     C                     MOVEL'*CALL'   W0KEY            ***************CSW098
     C                     Z-ADD8         W0ERNB           * DB ERROR 08 *CSW098
     C                     MOVEL'MEM5003' W0MSGD           ***************CSW098
     C                     MOVEL'MIDAS  ' W0MSGF                          CSW098
     C                     EXSR SRERR                                     CSW098
     C                     END                                            CSW098
      *                                                                   CSW200
      *                                                                   CSW200
      * Check if SWIFT 2000 active                                        CSW200
      *                                                                   CSW200
     C                     CALL 'SWIF2000'             9090               CSW200
     C                     PARM *BLANKS   CSW200  7        B:Return code  CSW200
      *                                                                   CSW200
      *  If return with an error (LR seton in called program) then        CSW200
      *  process for database error.                                      CSW200
      *                                                                   CSW200
     C           *IN90     IFEQ '1'                                       CSW200
     C                     MOVEL'SWIF2000'W0FILE                          CSW200
     C                     MOVEL'*CALL'   W0KEY            ***************CSW200
     C                     Z-ADD9         W0ERNB           * DB ERROR 09 *CSW200
     C                     MOVEL'MEM5003' W0MSGD           ***************CSW200
     C                     MOVEL'MIDAS  ' W0MSGF                          CSW200
     C                     EXSR SRERR                                     CSW200
     C                     END                                            CSW200
      *                                                                   CSW098
      ** Check if SWIFT 2001 is installed                                                     CSW201
      *                                                                                       CSW201
     C                     CALL 'SWIF2001'             1212                                   CSW201
     C                     PARM *BLANKS   WRTNCD  7                                           CSW201
      *                                                                                       CSW201
     C           *IN12     IFEQ *ON                                                           CSW201
     C                     MOVEL'SWIF2001'W0FILE                                              CSW201
     C                     MOVEL'*CALL'   W0KEY                                               CSW201
     C                     Z-ADD10        W0ERNB                                              CSW201
     C                     MOVEL'MEM5003' W0MSGD                                              CSW201
     C                     MOVEL'MIDAS  ' W0MSGF                                              CSW201
     C                     EXSR SRERR                                                         CSW201
      *                                                                                       CSW201
     C                     ELSE                                                               CSW201
     C           WRTNCD    IFEQ 'CSW2001'                                                     CSW201
     C                     MOVE 'Y'       CSW201  1                                           CSW201
     C                     ELSE                                                               CSW201
     C                     MOVE 'N'       CSW201                                              CSW201
     C                     ENDIF                                                              CSW201
     C                     ENDIF                                                              CSW201
      *                                                                                       CSW201
      ** Check if SWIFT 2002 is installed                                                     CSW202
      *                                                                                       CSW202
     C                     CALL 'SWIF2002'             1212                                   CSW202
     C                     PARM *BLANKS   WRTNCD                                              CSW202
      *                                                                                       CSW202
     C           *IN12     IFEQ *ON                                                           CSW202
     C                     MOVEL'SWIF2002'W0FILE                                              CSW202
     C                     MOVEL'*CALL'   W0KEY                                               CSW202
     C                     Z-ADD11        W0ERNB                                              CSW202
     C                     MOVEL'MEM5003' W0MSGD                                              CSW202
     C                     MOVEL'MIDAS  ' W0MSGF                                              CSW202
     C                     EXSR SRERR                                                         CSW202
      *                                                                                       CSW202
     C                     ELSE                                                               CSW202
     C           WRTNCD    IFEQ 'CSW2002'                                                     CSW202
     C                     MOVE 'Y'       CSW202  1                                           CSW202
     C                     ELSE                                                               CSW202
     C                     MOVE 'N'       CSW202                                              CSW202
     C                     ENDIF                                                              CSW202
     C                     ENDIF                                                              CSW202
      *                                                                                       CSW202
      ** Check if SWIFT 2006 is installed                                                     CSW206
      *                                                                                       CSW206
     C                     CALL 'SWIF2006'             1313                                   CSW206
     C                     PARM *BLANKS   WRTNCD                                              CSW206
      *                                                                                       CSW206
     C           *IN13     IFEQ *ON                                                           CSW206
     C                     MOVEL'SWIF2006'W0FILE                                              CSW206
     C                     MOVEL'*CALL'   W0KEY                                               CSW206
     C                     Z-ADD12        W0ERNB                                              CSW206
     C                     MOVEL'MEM5003' W0MSGD                                              CSW206
     C                     MOVEL'MIDAS  ' W0MSGF                                              CSW206
     C                     EXSR SRERR                                                         CSW206
      *                                                                                       CSW206
     C                     ELSE                                                               CSW206
     C           WRTNCD    IFEQ 'CSW2006'                                                     CSW206
     C                     MOVE 'Y'       CSW206  1                                           CSW206
     C                     ELSE                                                               CSW206
     C                     MOVE 'N'       CSW206                                              CSW206
     C                     ENDIF                                                              CSW206
     C                     ENDIF                                                              CSW206
      *                                                                                       CSW206
      ** Check if switchable feature CSD024 is switched on                                    CSD024
      *                                                                                       CSD024
     C                     CALL 'AOSARDR0'                                                    CSD024
     C                     PARM *BLANKS   @RTCD   7                                           CSD024
     C                     PARM '*VERIFY '@OPTN   7                                           CSD024
     C                     PARM 'CSD024'  @SARD   6                                           CSD024
     C           SCSARD    PARM SCSARD    DSFDY                                               CSD024
      *                                                                                       CSD024
     C           @RTCD     IFEQ *BLANKS                                                       CSD024
     C                     MOVE 'Y'       CSD024  1                                           CSD024
     C                     ELSE                                                               CSD024
     C                     MOVE 'N'       CSD024                                              CSD024
     C                     ENDIF                                                              CSD024
      *                                                                                       CSW213
      ** Check if SWIFT 2013 is installed                                                     CSW213
      *                                                                                       CSW213
     C                     CALL 'SWIF2013'             1313                                   CSW213
     C                     PARM *BLANKS   WRTNCD                                              CSW213
      *                                                                                       CSW213
     C           *IN13     IFEQ *ON                                                           CSW213
     C                     MOVEL'SWIF2013'W0FILE                                              CSW213
     C                     MOVEL'*CALL'   W0KEY                                               CSW213
     C                     Z-ADD12        W0ERNB                                              CSW213
     C                     MOVEL'MEM5003' W0MSGD                                              CSW213
     C                     MOVEL'MIDAS  ' W0MSGF                                              CSW213
     C                     EXSR SRERR                                                         CSW213
      *                                                                                       CSW213
     C                     ELSE                                                               CSW213
     C           WRTNCD    IFEQ 'CSW2013'                                                     CSW213
     C                     MOVE 'Y'       CSW213  1                                           CSW213
     C                     ELSE                                                               CSW213
     C                     MOVE 'N'       CSW213                                              CSW213
     C                     ENDIF                                                              CSW213
     C                     ENDIF                                                              CSW213
      *
      ** Check if SWIFT 2015 is installed                                                     CSW215
      *                                                                                       CSW215
     C                     CALL 'SWIF2015'             1313                                   CSW215
     C                     PARM *BLANKS   WRTNCD                                              CSW215
      *                                                                                       CSW215
     C           *IN13     IFEQ *ON                                                           CSW215
     C                     MOVEL'SWIF2015'W0FILE                                              CSW215
     C                     MOVEL'*CALL'   W0KEY                                               CSW215
     C                     Z-ADD13        W0ERNB                                              CSW215
     C                     MOVEL'MEM5003' W0MSGD                                              CSW215
     C                     MOVEL'MIDAS  ' W0MSGF                                              CSW215
     C                     EXSR SRERR                                                         CSW215
      *                                                                                       CSW215
     C                     ELSE                                                               CSW215
     C           WRTNCD    IFEQ 'CSW2015'                                                     CSW215
     C                     MOVE 'Y'       CSW215  1                                           CSW215
     C                     ELSE                                                               CSW215
     C                     MOVE 'N'       CSW215                                              CSW215
     C                     ENDIF                                                              CSW215
     C                     ENDIF                                                              CSW215
      * Copy point for Initialisation
     C/COPY WNCPYSRC,ME9940INIT
      *
      *  Unwind subroutine stack name
      *
     C           EXINIT    TAG
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *                                                                                       CSC022
      ** Check if CSC022 is switched *ON.                                                     CSC022
      *                                                                                       CSC022
     C                     CALL 'AOSARDR0'                                                    CSC022
     C                     PARM *BLANKS   @RTCD   7                                           CSC022
     C                     PARM '*VERIFY' @OPTN   7                                           CSC022
     C                     PARM 'CSC022'  @SARD   6                                           CSC022
      *                                                                                       CSC022
     C           @RTCD     IFEQ *BLANKS                                                       CSC022
     C                     MOVE 'Y'       CSC022  1                                           CSC022
     C           *NAMVAR   DEFN SCCMTJOB  SCCMT                                               CSC022
     C                     IN   SCCMT                                                         CSC022
     C                     Z-ADD1         C       30                                          CSC022
     C                     MOVEL*BLANKS   WCMTSK  1                                           CSC022
     C                     MOVEACMTARR    CMTJOB                                              CSC022
     C           CMTNUM    IFGT 0                                                             CSC022
     C           C         DOWLECMTNUM                                                        CSC022
     C           ##JOB     IFEQ CMTJOB,C                                                      CSC022
     C                     MOVEL'Y'       WCMTSK                                              CSC022
     C                     ENDIF                                                              CSC022
     C                     ADD  1         C                                                   CSC022
     C                     ENDDO                                                              CSC022
     C                     ENDIF                                                              CSC022
     C                     ELSE                                                               CSC022
     C                     MOVE 'N'       CSC022                                              CSC022
     C                     ENDIF                                                              CSC022
      *
     CSR                   ENDSR
      *****************************************************************
     C/EJECT
     C/COPY WNCPYSRC,ME9940DCPG
      *
      *  /Copy point for Calculations
      *
     C/EJECT
      *
      *  File and Program Error Processing
      *
     C/COPY MECPYSRC,SRERRC
      * Standard send-program-message routine /COPY
     C/COPY MECPYSRC,SMESNMSC
     C/EJECT
     C/COPY WNCPYSRC,ME9940DOPG
      *
      *  /Copy point for Outputs
      *
**  CPY@
(c) Finastra International Limited 2001
