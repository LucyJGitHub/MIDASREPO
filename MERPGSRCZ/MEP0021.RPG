     H        1
     F*****************************************************************
/*STD *  RPGBASE                                                      *
/*OVRF*: OVRDBF (FILE IN PROGRAM) (FILE ON SYSTEM)                  : *
/*EXI *  TEXT('Midas ME Check field for SWIFT Authentication Key')    *
      *****************************************************************
      *                                                               *
      *  Midas - Message Management Module                            *
      *                                                               *
      *  MEP0021 - Check field for SWIFT Authentication Key           *
      *                                                               *
      *  Function:  This program places the customer in the field     *
      *  from a specified account                                     *
      *                                                               *
      *                                                               *
      *  (C) Copyrignt Misys International Banking Systems 2004       *
      *                                                               *
      *  Last Amend No. MD031937           Date 13Jan15               *
      *  Prev Amend No. AR856737           Date 15Jul2011             *
      *                 MKFX01             Date 23Jan06               *
      *                 EEE065             Date 19May2004             *
      * Midas Release 4.01--------------------------------------------*
      *                                                               *
      *---------------------------------------------------------------*
      *                                                               *
      *  MD031937 - Upgrade STP enhancements to BF Midas 2.1          *
      *  AR856737 - Upgrade STP enhancements to Midas Plus level.     *
      *  MKFX01 - Processing of field :24: added.                     *
      *           Changes in /copy SME1100P.                          *
      *  EEE065 - FT Payment Routing                                  *
      *                                                               *
      *****************************************************************
     F/EJECT
     E                    CPY@    1   1 80
      *
      *  Copyright table
      *
     ICPYR@#      DS
      *
      *  Data structure for compilation  - Copyright insertion
      *
     I                                        1  80 CPY@
     I                                        1  20 CPY@##
      *
      *  Copyright
      *
      /COPY MECPYSRC,SME1100P
      *
      *  Data Structures used by Access Objects
      *
     IPCRIT     E DSMEGNCRPD
      *
      *  Return Criteria Details to calling program
      *
     I            DS
      *
      *  Split the detail fields into field tag name and contents
      *
     I                                        1 256 WUFDDT
     I                                        1   5 WUMTAG
     I                                        6   6 WUFDIN
     I                                        6 256 WUTGCK
     I                                        7 256 WUTGVL
     ****
     I*****                                   7  24 WUACCO                                   MD31937
     I                                        7  30 WUACCO                                   MD31937
     I                                        7  120WUCNUM
     I                                        7  12 WUCNUA
     I                                       13  15 WUCURR
     I*****                                  16  190WUACCD                                   MD31937
     I*****                                  16  19 WUACCA                                   MD31937
     I*****                                  20  210WUACSQ                                   MD31937
     I*****                                  20  21 WUACSA                                   MD31937
     I*****                                  22  24 WUBRCA                                   MD31937
     I*****                                  25 256 WUORIG                                   MD31937
     I*****                                  25  25 SLASH                                    MD31937
     I                                       16  250WUACCD                                   MD31937
     I                                       16  25 WUACCA                                   MD31937
     I                                       26  270WUACSQ                                   MD31937
     I                                       26  27 WUACSA                                   MD31937
     I                                       28  30 WUBRCA                                   MD31937
     I                                       31 256 WUORIG                                   MD31937
     I                                       31  31 SLASH                                    MD31937
      * 6n followed by blanks
     I                                       26  31 CSTNBR
     I                                       32  59 CSTBLK
      * 7n followed by blanks
     I                                       26  26 CST000
     I                                       27  32 CSTNB2
     I                                       32  32 CSTP06
     I*****                                  25 256 WUO                                      MD31937
     I                                       31 256 WUO                                      MD31937
      ** For FONTIS tag 72 is bigger (no translation possible)
     I                                        7 246 F72
     I*****                                  25  35 WUSWFT                                   MD31937
     I*****                                  36 256 WUNSWF                                   MD31937
     I*****                                  60  70 WUSWF2                                   MD31937
     I*****                                  71 256 WUNSW2                                   MD31937
     I                                       31  41 WUSWFT                                   MD31937
     I                                       42 256 WUNSWF                                   MD31937
     I                                       66  76 WUSWF2                                   MD31937
     I                                       77 256 WUNSW2                                   MD31937
     IP@FMT     E DSDSSDY
      * External Data structure to hold the outgoing record format
      * of the file.
      * O : To FTP0700
      *
      *  Define data structure used to pass parameters
      *
     IO2PARM      DS                            256
      * Booking branch
     I                                        1   3 O2BRCA
      * Information type  (S=SWIFT C=Customer)
     I                                        4   4 O2TYPE
      * SWIFT BIC
     I                                        5  15 O2BIC
     I                                        5  12 O2BICC
     I                                       13  15 O2BICB
      * Customer
     I                                       16  21 O2CUST
      *
     I              '0123456789'          C         DIGITS
      *
      *  Set up copyright statement
      *
     C                     MOVEACPY@      BIS@   80
      *
     C           *LIKE     DEFN WUTGCK    P@IN
      *
     C           *ENTRY    PLIST
     C                     PARM           P#RETN  7
     C           WUFDDT    PARM           P@IN
     C                     PARM           P#PTTN 32
     C                     PARM           GDOPER  2
     C                     PARM           PHEAD            General Details
     C                     PARM           PDATA            Message Details
     C                     PARM           PDAT2            Message Details
     C                     PARM           PCRIT            Message Details
      * If true put T
     C                     MOVEL'F'       P#RETN
      *
      *  Set fields prior to call
      *
     C                     CLEARO2PARM
      *
     C                     MOVEL'MBB'     O2BRCA
     C                     MOVEL'S'       O2TYPE
      *  Check for specific routing for Pay Through
     C           SLASH     IFEQ '/'
     C           8         SUBSTWUORIG:36 O2BICC
     C           3         SUBSTWUORIG:44 O2BICB
     C                     ELSE
     C           8         SUBSTWUORIG:1  O2BICC
     C           3         SUBSTWUORIG:9  O2BICB
     C                     ENDIF
      *
     C                     CALL 'FTP0700'
     C                     PARM           O2RTN   7
     C                     PARM           O2PARM
      *
      *
      * If return blank then valid key
      *
     C           O2RTN     IFNE *BLANKS
     C                     MOVEL'T'       P#RETN
     C                     ENDIF
      *
      *  Exit program
      *
     C                     RETRN
**  CPY@ table
(C) Copyright Misys International Banking Systems Ltd. 2004
