     H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas MT5xx : To switch on feature S01401')
      *****************************************************************
      *                                                               *
      *    Midas SECURITIES TRADING                                   *
      *                                                               *
      *    RPG/DPTMVDX1 - DEPOT MOVEMENTS EXTENDED FILE GENERATION    *
      *                                                               *
      *  (c) Finastra International Limited 2001                      *
      *                                                               *
      *  Last Amend No. MD046248           Date 27Oct17               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *  Prev Amend No. CSD027             Date 09Dec05               *
      *                 222727             Date 05Nov03               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.02 -----------------------------------------------*
      *                 CSE015             Date 06Dec99               *
      *                 CSE017             Date 20Oct99               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 CAP003             Date 17May98               *
      *                 OA0071             Date 25May93               *
      *                   S01401             DATE 29MAR93             *
      *                                                               *
      *****************************************************************
      *                                                               *
      *  MD046248 - Finastra Rebranding                               *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  222727 - Release 5.0 errors  (Recompile)                     *
      *  CSE015 - Forward Valued Depot Movements (Recompiled)         *
      *  CSE017 - Cum/Ex Indicator on Depot Movements (Recompile)     *
      *  CAP003 - Conversion of SE inputs into modular structure to   *
      *           use as APIs. Recompiled to adopt changes in DPTMVD. *
      *    OA0071 - NEW FIELD SCMG
      *    S01401 - The generation of MT500 SWIFT Messages if the     *
      *             option is available.  NEW PROGRAM.                *
      *****************************************************************
      *
     FDPTMVDL1IF  E                    DISK
     FDPTMVDX1O   E                    DISK
      *****************************************************************
      /EJECT
      *****************************************************************
      *                                                               *
      *  F U N C T I O N   O F   I N D I C A T O R S                  *
      *                                                               *
      *    01     - Chain/Read end of file indicator                  *
      *    02     - Chain/Read fail indicator                         *
      *    U7-U8  -  Data base                                        *
      *    *INLR  -  End processing                                   *
      *                                                               *
      *****************************************************************
      /EJECT
      *****************************************************************
      *                                                               *
      *  S U B R O U T I N E   I N D E X                              *
      *                                                               *
      *  INIT   - Process Insert                                      *
      *                                                               *
      *****************************************************************
     E                    CPY@    1   1 80
      /EJECT
      *****************************************************************
     ILDA         DS                            256
      *
      * Data structure for data-bAse error processing.
      *
     I                                      134 141 DBFILE
     I                                      142 170 DBKEY
     I                                      171 180 DBPGM
     I                                      181 1830DBASE
      /EJECT
      *****************************************************************
      * Main processing
      *****************************************************************
      *
     C                     EXSR INIT
      *
     C           *IN01     DOWEQ*OFF
      *
     C                     MOVE DPSS      DPDPSS
     C                     MOVE DPRN      DPDPRN
     C                     Z-ADDLCD       DPLCD
     C                     MOVE 'N'       DPCONG
     C                     MOVE 'N'       DPRCDG
     C                     MOVE 'N'       DPGMEC
     C                     MOVE 'N'       DPGMES
     C                     MOVE 'N'       DPSCMG                          OA0071
      *
     C                     WRITEDPTMVDD1
     C                     READ DPTMVDL1                 01
     C                     ENDDO
      *
     C                     SETON                     LR
     C                     RETRN
      *****************************************************************
      *  INIT - Routine to handle initial processing.                 *
      *****************************************************************
     C           INIT      BEGSR
      **  Copyright Statement
     C                     MOVEACPY@      BIS@   80
      *
     C                     READ DPTMVDL1               0201
      **   Prepare LDA
     C           *NAMVAR   DEFN           LDA
      *
     C           *IN02     IFEQ *ON
     C           *LOCK     IN   LDA
     C                     MOVEL'DPTMVDX1'DBPGM
     C                     Z-ADD01        DBASE            ************
     C                     MOVEL'DPTMVDL1'DBFILE           * DBER 001 *
     C                     MOVEL'        'DBKEY            ************
     C                     OUT  LDA
     C                     SETON                     LRU7U8
     C                     RETRN
     C                     ENDIF
      *
     C                     ENDSR
      *****************************************************************
**  CPY@
(c) Finastra International Limited 2001
