     H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas MT5xx : To switch on feature S01401')
      *****************************************************************
      *                                                               *
      *    Midas SECURITIES TRADING                                   *
      *                                                               *
      *    RPG/POSETDX1 - POSITION SETTLEMENTS EXTENDED FILE GENER.   *
      *                                                               *
      *  (c) Misys International Banking Systems Ltd. 2001            *
      *                                                               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *  Last Amend No. CSD027             Date 09Dec05               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *  Prev Amend No. S01401             Date 29MAR93               *
      *                                                               *
      *****************************************************************
      *                                                               *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *    S01401 - The generation of MT500 SWIFT Messages if the     *
      *             option is available.  NEW PROGRAM.                *
      *****************************************************************
      *  C R E A T I O N     P A R A M E T E R S                      *
      *                                                               *
      *                                                               *
      *****************************************************************
     FPOSETD  IF  E                    DISK
     FPOSETDX1O   E                    DISK
      *****************************************************************
      /EJECT
      *****************************************************************
      *                                                               *
      *  F U N C T I O N   O F   I N D I C A T O R S                  *
      *                                                               *
      *    01     - Chain/Read end of file indicator                  *
      *    02     - Chain/Read fail indicator                         *
      *    U7-U8  -  Data base                                        *
      *    *INLR  -  End processing                                   *
      *                                                               *
      *****************************************************************
      /EJECT
      *****************************************************************
      *                                                               *
      *  S U B R O U T I N E   I N D E X                              *
      *                                                               *
      *  INIT   - Process Insert                                      *
      *                                                               *
      *****************************************************************
     E                    CPY@    1   1 80
      /EJECT
      *****************************************************************
     ILDA         DS                            256
      *
      * Data structure for data-bAse error processing.
      *
     I                                      134 141 DBFILE
     I                                      142 170 DBKEY
     I                                      171 180 DBPGM
     I                                      181 1830DBASE
      /EJECT
      *****************************************************************
      * Main processing                                               *
      *****************************************************************
      *
     C                     EXSR INIT
      *
     C           *IN01     DOWEQ*OFF
      *
     C                     MOVE PBCA      POPBCA
     C                     MOVE PSSH      POPSSH
     C                     MOVE PCPY      POPCPY
     C                     MOVE PDUD      POPDUD
     C                     MOVE PEVT      POPEVT
     C                     MOVE LCD       POLCD
     C                     MOVE 'N'       PORCDG
     C                     MOVE *ZEROS    POSEQN
     C                     MOVE 'N'       POGMES
      *
     C                     WRITEPOSETDD1
      *
     C                     READ POSETD                   01
     C                     ENDDO
      *
     C                     SETON                     LR
     C                     RETRN
      *****************************************************************
      *                                                               *
      *****************************************************************
     C           INIT      BEGSR
      *
      **  Copyright Statement
     C                     MOVEACPY@      BIS@   80
      **   Prepare LDA
     C           *NAMVAR   DEFN           LDA
      *
     C                     READ POSETD                 0201
      *
     C           *IN02     IFEQ *ON
     C           *LOCK     IN   LDA
     C                     MOVEL'POSETDX1'DBPGM
     C                     Z-ADD01        DBASE            ************
     C                     MOVEL'POSETD  'DBFILE           * DBER 001 *
     C                     MOVEL'        'DBKEY            ************
     C                     OUT  LDA
     C                     SETON                     LRU7U8
     C                     RETRN
     C                     ENDIF
      *
     C                     ENDSR
      *****************************************************************
**  CPY@
(c) Misys International Banking Systems Ltd. 2001
