     H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas MT5xx : To switch on feature S01401')
     F*****************************************************************
     F*                                                               *
     F*  Midas - Securities Trading Module
     F*                                                               *
     F*  SDCUSTXA - CUSTOMER DETAILS EXTENSION FILE GENERATION        *
     F*                                                               *
      *  (c) Misys International Banking Systems Ltd. 2001            *
     F*                                                               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *  Last Amend No. CSW037A            Date 02May05               *
      *  Prev Amend No. CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 S01401             Date 05May93               *
     F*                                                               *
     F*---------------------------------------------------------------*
     F*                                                               *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
     F*  S01401 - MT500 SWIFT Messages Feature: New program           *
     F*           Utility to generate records on Customer Extension   *
     F*           file - SDCUSTXA.                                    *
     F*                                                               *
     F*****************************************************************
     F*                                                               *
     F*  C R E A T I O N     P A R A M E T E R S                      *
     F*                                                               *
     F*                                                               *
     F*****************************************************************
     FSDCUSTPDIPE E                    DISK
     F                                              KINFSR *PSSR
     FSDCUSTXAIF  E           K        DISK                      A
     F                                              KINFSR *PSSR
      /TITLE FUNCTION OF INCICATORS
     F*****************************************************************
     F*                                                               *
     F*  F U N C T I O N   O F   I N D I C A T O R S                  *
     F*                                                               *
     F*  *IN01  -  First Cycle                                        *
     F*  *IN68  -  Output error indicator.                            *
     F*  *INLR  -  End processing                                     *
     F*                                                               *
     F*****************************************************************
     E/TITLE E-SPECIFICATIONS
     E                    CPY@    1   1 80
     E*
     I/TITLE I-SPECIFICATIONS
      *
     ILDA         DS                            256
      * Data structure for data-base error processing.
     I                                      134 141 DBFILE
     I                                      142 170 DBKEY
     I                                      171 180 DBPGM
     I                                      181 1830DBASE
     C/TITLE Main Processing
      *
      ***  Copyright Statement.
     C                     MOVEACPY@      BIS@   80
      *
      **  If a record for the Customer Number read off SDCUSTPD does
      **  not already exist on the extension file then initialise
      **  fields and write record
     C           BBCUST    CHAINSDCUSTDA             10
      *
     C           *IN10     IFEQ '1'
     C*
     C                     CLEARSDCUSTDA
     C                     MOVELBBCUST    IBCNUM
      *
      **   Write into Output file
     C                     WRITESDCUSTDA               68
      *
      **   If the Write fails, then it is a data base error
     C           *IN68     IFEQ '1'
     C                     Z-ADD1         DBASE            ************
     C                     MOVEL'SDCUSTXA'DBFILE           * DBER 001 *
     C                     MOVELBBCUST    DBKEY            ************
     C                     EXSR *PSSR
     C                     END
      *
     C                     END
      *
      *****************************************************************
      /TITLE SR/*PSSR
      *****************************************************************
      *                                                               *
      * *PSSR    - Data base Error Processing                         *
      *                                                               *
      *****************************************************************
     C           *PSSR     BEGSR
      *
      ***  Check to see that *PSSR has not already been called.
     C           WRUN      IFEQ *BLANK
     C                     MOVE 'Y'       WRUN    1
     C                     MOVEL'SDCUSTXA'DBPGM
     C                     SETON                     LRU7U8
     C                     DUMP
     C                     END
      *
      ** Exit program
     C                     RETRN
      *
     C                     ENDSR
      *****************************************************************
**  CPY@
(c) Misys International Banking Systems Ltd. 2001
