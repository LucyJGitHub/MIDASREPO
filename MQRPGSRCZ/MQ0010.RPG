      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas MQ Program to edit amount fields')
0002 F********************************************************************
0004 F*                                                                  *
     F*  Midas   Midas/Q MODULE
0004 F*                                                                  *
0005 F*    MQ0010 - AMOUNT EDITING 'SUBROUTINE'                          *
0006 F*                                                                  *
      *  (c) Misys International Banking Systems Ltd. 2001            *
0008 F*                                                                  *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.03 -----------------------------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
0009 F*    LAST AMEND NO 000000    DATE 17/03/88  - RE-WRITTEN           *
0010 F*                                                                  *
0011 F********************************************************************
     F*
     F* PARAMETERS PASSED: CCYIN - CURRENCY CODE FOR AMOUNT
     F*                    AMT   - AMOUNT FIELD
     F*
     F* THE EDITED AMOUNT IS PLACED IN 'AMT', A 15,2 FIELD
     F* CURRENCIES WITH LESS THAN TWO DECIMAL PLACES HAVE
     F* TRAILING ZEROS ADDED, CURRENCIES WITH THREE DECIMAL
     F* PLACES ARE TRUNCATED AND HALF ADJUSTED.
     F* IF THE CURRENCY CODE IS NOT FOUND ON THE TABLES FILE
     F* THE AMOUNT IS ASSUMED TO HAVE TWO DECIMAL PLACES.
     F*
     F*  C R E A T I O N     P A R A M E T E R S                      *
     F*                                                               *
     F*                                                               *
     F*****************************************************************
     FTABTG10 IF  E           K        DISK
     E                    CPY@    1   1 80
     I*  DATA STRUCTURE FOR COMPILATION  - COPYRIGHT INSERTION
     ICPYR@#      DS
     I                                        1  80 CPY@
     I                                        1  20 CPY@##
      *
      * Data structure used to store up to 20 file TABTG10  records in core
      *
     IF$DS01    E DSTABTG10                0020
     I              CCY                             F$0101
     I              CDP                             F$0102
     C           *ENTRY    PLIST
     C                     PARM           AMT    152
     C                     PARM           CCYIN   3
     C/COPY WNCPYSRC,MQ0010C001
     C* GET CURRENCY TABLE RECORD
     C           KL$001    KLIST
     C                     KFLD           CCYIN
      *
     C           F$IC01    IFGT 0
     C           1         DO   F$IC01    F$WK01  70
     C           F$WK01    OCUR F$DS01
      *
     C           CCYIN     IFEQ F$0101
     C                     MOVE F$0102    CDP
     C                     MOVE '0'       *IN70
     C                     GOTO F$EN01
     C                     END
      *
     C                     END
     C                     END
      *
     C           KL$001    CHAINTABTG10F             70
      *
     C           *IN70     IFEQ '0'
     C                     ADD  1         F$NP01  70
     C           F$NP01    IFGT 20
     C                     Z-ADD1         F$NP01
     C                     END
     C           F$NP01    IFGT F$IC01
     C                     Z-ADDF$NP01    F$IC01  70
     C                     END
     C           F$NP01    OCUR F$DS01
     C/COPY WNCPYSRC,MQ0010C002
     C                     MOVE CCY       F$0101
     C/COPY WNCPYSRC,MQ0010C004
     C                     MOVE CDP       F$0102
     C                     END
      *
     C           F$EN01    TAG
     C* NO FURTHER PROCESSING IF RECORD NOT FOUND OR
     C* CCY HAS 2 DP
     C/COPY WNCPYSRC,MQ0010C007
     C           *IN70     IFEQ '1'
     C           CDP       OREQ 2
     C                     RETRN
     C                     ELSE
     C* EDIT 0 DP
     C           CDP       IFEQ 0
     C           AMT       MULT 100       AMT
     C                     ELSE
     C* EDIT 3 DP
     C           CDP       IFEQ 3
     C           AMT       DIV  10        AMT       H
     C                     ELSE
     C* EDIT 1 DP
     C           AMT       MULT 10        AMT
     C                     END
     C                     END
     C/COPY WNCPYSRC,MQ0010C003
     C                     END
     C                     RETRN
     C/COPY WNCPYSRC,MQ0010C006
**  CPY@
(c) Misys International Banking Systems Ltd. 2001
