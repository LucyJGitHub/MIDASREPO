      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas MQ Prod'n init'n interface-shtname enq.')
     F********************************************************************
     F*                                                                  *
     F*  Midas  Midas/Q
     F*                                                                  *
     F*    MQ0040 - SHORTNAMES REVIEW & SELECTION                        *
     F*                                                                  *
      *  (c) Misys International Banking Systems Ltd. 2001            *
     F*                                                                  *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *  Last Amend No. CSD027             Date 09Dec05               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *  Prev Amend No. E21840             Date 08/03/90              *
     F*                 S01223             Date 11/09/89              *
     F*                                                                  *
     F*------------------------------------------------------------------*
     F*                                                                  *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
     F*     E21840 - SHOULD NOT TRY TO READ AN EMPTY SUB-FILE.           *
     F*     S01223 - BRING IN SYSTEM DEFINITION BLOCK USING /COPY.       *S01223
     F*                                                                  *
     F********************************************************************
     F* INDICATOR USAGE
     F* 01             ERROR ON DSPF OPEN
     F* 02             CLEAR SUBFILE
     F* 03             NO DETAILS INDICATOR
     F* 88             PARENT
     F* 89             END OF FILE
     F*  C R E A T I O N     P A R A M E T E R S                      *
     F*                                                               *
     F*                                                               *
     F*****************************************************************
     FMQ0040DFCF  E                    WORKSTN                        UC
     F                                        X     KSFILE MQ0040SF
     FSNAME   IF  E           K        DISK
     E                    CPY@    1   1 80
     I*  DATA STRUCTURE FOR COMPILATION  - COPYRIGHT INSERTION
     ICPYR@#      DS
     I                                        1  80 CPY@
     I                                        1  20 CPY@##
     I*
     I* MIDAS/Q SYSTEM DEFN DATA AREA
     I*
     IO#XA01      DS                           1000
      *
     I*******************************************                         S01223
     I**SYSTEM*DEF********BLOCK*-*PACKAGE*VERSION                         S01223
     I*******************************************                         S01223
     I*#SDBK      DS                           1000                       S01223
     I*************************************** 1  10 O#SPLB                S01223
     I***************************************11  20 O#SDLB                S01223
     I***************************************21  30 O#SMLB                S01223
     I***************************************31  331O#SRLS                S01223
     I***************************************34  53 O#SSIT                S01223
     I***************************************54  63 O#SCPU                S01223
     I***************************************64  73 O#SSOF                S01223
     I***************************************74  90 O#SACS                S01223
     I**************************************                              S01223
     I**************************************100 101 O#SCEX                S01223
     I**************************************100 1010CEX                   S01223
     I**************************************102 103 O#SCBY                S01223
     I**************************************102 1030CBY                   S01223
     I**************************************104 105 O#SCAD                S01223
     I**************************************104 1050CAD                   S01223
     I**************************************106 107 O#SCCH                S01223
     I**************************************106 1070CCH                   S01223
     I**************************************108 109 O#SCDL                S01223
     I**************************************108 1090CDL                   S01223
     I**************************************                              S01223
     I**************************************200 200 O#SU1E                S01223
     I**************************************201 202 O#SCU1                S01223
     I**************************************201 2020CU1                   S01223
     I**************************************203 299 O#SU1R                S01223
     I**************************************300 305 O#SDU1                S01223
     I**************************************                              S01223
     I**************************************500 500 O#SINT                S01223
     I**************************************501 501 O#SBCH                S01223
     I**************************************502 502 O#SNGT                S01223
     I**************************************                              S01223
     I**************************************503 503 O#SDV1                S01223
     I**************************************504 504 O#SDV2                S01223
     I**************************************505 505 O#SDV3                S01223
     I**************************************506 506 O#SDV4                S01223
     I**************************************507 507 O#SDV5                S01223
     I**************************************                              S01223
     I**************************************508 517 O#SDV6                S01223
     I**************************************518 527 O#SDV7                S01223
     I**************************************528 530 O#SDV8                S01223
     I**************************************531 533 O#SDV9                S01223
     I**************************************534 536 O#SDV0                S01223
     I**************************************537 539 O#SDVA                S01223
     I**************************************540 542 O#SDVB                S01223
     I**************************************543 543 O#SDVC                S01223
     I**************************************544 544 O#SDVD                S01223
     I**************************************                              S01223
     I**************************************546 555 O#SDVF                S01223
     I**************************************556 565 O#SDVG                S01223
     I**************************************566 575 O#SDVH                S01223
     I**************************************576 576 O#SDVI                S01223
     I**************************************577 580 O#SDVJ                S01223
     I**************************************                              S01223
     I**************************************581 583 O#SDVE                S01223
     I**************************************                              S01223
     I**************************************584 590 O#SP#N                S01223
     I**************************************591 600 O#SP#O                S01223
     I**************************************                              S01223
     I**************************************601 601 O#SDVK                S01223
      ** Bring in the system definition block                             S01223
      /COPY O#XP04,O#SDBLOCKP                                             S01223
      *                                                                   S01223
     C*
     C**  DEFINE PARM LIST
     C*
     C           *ENTRY    PLIST
     C                     PARM           CSNM   10
     C*
     C* RETRIEVE MIDAS/Q SYSTEM DEFINITION BLOCK
     C*
     C           *NAMVAR   DEFN           O#XA01
     C                     IN   O#XA01
     C                     MOVELO#XA01    O#SDBK
     C*
     C* OPEN DISPLAY FILE
     C                     OPEN MQ0040DF               01
     C           *IN01     IFEQ '0'
     C* MAIN PROCESSING
     C                     Z-ADD0         X
     C                     SETOF                       03
     C* (1) CLEAR SUBFILE
     C                     SETON                       02
     C                     WRITEMQ0040SC
     C                     SETOF                       02
     C*
     C* (2) FILL SUBFILE
     C           KKEY      KLIST
     C                     KFLD           CSNM
     C           CSNM      SETLLSNAME
     C                     READ SNAME                    89
     C           *IN89     DOWEQ'0'
     C*
     C* IGNORE PARENTS AND NON-LIVE RECORDS
     C           RECI      IFEQ 'D'
     C                     TESTB'2'       CMIN           88
     C           *IN88     IFEQ '0'
     C                     ADD  1         X       50
     C                     WRITEMQ0040SF
     C                     END
     C                     END
     C*
     C                     READ SNAME                    89
     C                     END
     C* (3) NO CUSTOMER SHORTNAME RECORDS FOUND
     C           X         IFEQ 0
     C                     SETON                     03    NO DETAIL
     C                     END
     C* (4) DISPLAY SUBFILE ONTO SCREEN
     C                     WRITEMQ0040TP
     C                     EXFMTMQ0040SC
     C* (5) CHECK RECORD SELECTION
     C                     MOVEL*BLANKS   CSNM
     C           READC     TAG
      *                                                                   E21840
      ** Read subfile changes only if subfile is not empty.               E21840
     C           X         IFGT 0                                         E21840
     C                     READCMQ0040SF                 99
     C           *IN99     IFEQ '0'
     C           ACTN      CABEQ*BLANK    READC
     C                     END
     C                     END                                            E21840
      *                                                                   E21840
     C                     END
     C                     SETON                     LR
     C                     RETRN
**  CPY@
(c) Misys International Banking Systems Ltd. 2001
