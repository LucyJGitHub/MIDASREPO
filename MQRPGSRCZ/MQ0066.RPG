      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas MQ Prod init interface for A/C Type slct')
     F********************************************************************
     F*                                                                  *
     F*  Midas  Midas/Q
     F*                                                                  *
     F*    MQ0066  - ACCOUNT TYPE REVIEW & SELECTION                     *
     F*                                                                  *
     F*     (c) Finastra International Limited 2001                      *
     F*                                                                  *
      *  Last Amend No. MD046248           Date 27Oct17               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
     F*  PREV AMEND NO. S01182                  DATE 03MAY90             *
     F*                                                                  *
     F********************************************************************
     F*                                                                  *
     F*  MD046248 - Finastra Rebranding                                  *
     F*  S01182  -  NEW PGM INTRODUCED FOR MIS                           *
     F*                                                                  *
     F********************************************************************
     F*  C R E A T I O N     P A R A M E T E R S                      *
     F*                                                               *
     F*                                                               *
     F*****************************************************************
     FMQ0066DFCF  E                    WORKSTN                        UC
     F                                        X     KSFILE MQ0066SF
      ** Copyright array
     E                    CPY@    1   1 80
      ** Valid Account Sections
     E                    @ACT    1   5  1   @ATDES 30
     F* INDICATOR USAGE
     F* 01             ERROR ON DSPF OPEN
     F* 02             CLEAR SUBFILE
     F* 03             NO DETAILS INDICATOR
     F* 90             ALL ACCOUNT TYPES PUT INTO SUBFILE
     F* 99             END OF FILE FOR DISPLAY FILE
     I*  DATA STRUCTURE FOR COMPILATION  - COPYRIGHT INSERTION
     ICPYR@#      DS
     I                                        1  80 CPY@
     I                                        1  20 CPY@##
     I*
     I* MIDAS/Q SYSTEM DEFN DATA AREA
     I*
     IO#XA01      DS                           1000
      *
      ** Bring in the system definition block
      /COPY O#XP04,O#SDBLOCKP
      *
     C*
     C**  DEFINE PARM LIST
     C*
     C           *ENTRY    PLIST
     C                     PARM           ACTYPE
     C*
     C* RETRIEVE MIDAS/Q SYSTEM DEFINITION BLOCK
     C*
     C           *NAMVAR   DEFN           O#XA01
     C                     IN   O#XA01
     C                     MOVELO#XA01    O#SDBK
     C*
     C* OPEN DISPLAY FILE
     C                     OPEN MQ0066DF               01
     C           *IN01     IFEQ '0'
     C* MAIN PROCESSING
      *
     C* (1) CLEAR SUBFILE
     C                     SETON                       02
     C                     WRITEMQ0066SC
     C                     SETOF                       02
     C*
     C* (2) FILL SUBFILE
     C                     Z-ADD1         X       20
     C           *IN90     DOUEQ'1'
     C                     MOVE @ACT,X    ACTYPE
     C                     MOVEL@ATDES,X  ATTEXT
     C                     WRITEMQ0066SF
     C           ACTYPE    IFEQ *BLANKS
     C                     MOVE '1'       *IN90
     C                     ELSE
     C                     ADD  1         X
     C                     END
     C*
     C           X         IFGT 5
     C                     MOVE '1'       *IN90
     C                     END
     C                     END
     C* (3) NO RECORDS FOUND
     C           X         IFEQ 1
     C                     SETON                     03    NO DETAIL
     C                     END
      *
     C* (4) DISPLAY SUBFILE ONTO SCREEN
     C                     WRITEMQ0066TP
     C                     EXFMTMQ0066SC
     C* (5) CHECK RECORD SELECTION IF RECORDS FOUND
     C                     MOVEL*BLANKS   ACTYPE
     C           *IN03     IFEQ '0'
     C           READC     TAG
     C                     READCMQ0066SF                 99
     C           *IN99     IFEQ '0'
     C           ACTN      CABEQ*BLANK    READC
     C                     END
     C                     END
     C                     END
     C                     SETON                     LR
     C                     RETRN
**  CPY@
(c) Finastra International Limited 2001
**  @ACT/@ATDES
CContingent & Suspense accounts
DCustomer A/C - Dealing Module
GGeneral Ledger Accounts
NNostro Accounts
RRetail Accounts
