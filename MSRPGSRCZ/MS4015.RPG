     H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas MS Message Transmission Closedown')
      *****************************************************************
      *                                                               *
      *  Midas - SWIFT Direct Link Module                             *
      *                                                               *
      *   MS4015 - MESSAGE TRANSMISSION CLOSEDOWN                     *
      *                                                               *
      *  (c) Misys International Banking Systems Ltd. 2001            *
      *                                                               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *  Last Amend No. CSD027             Date 09Dec05               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.04 -----------------------------------------------*
      *  Prev Amend No. CDL008             Date 02May00               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 141572             Date 21SEP98               *
      *                  113352            DATE 13FEB97               *
      *                  S01408            DATE 04DEC96               *
      *                  S01310            DATE 06DEC90               *
      *                                                               *
      *---------------------------------------------------------------*
      *                                                               *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *   CDL008 - Continuous Linked Settlement (Recompiled MGOREFPD) *
      *   141572 - Recompile over changes in MGOREFPD                 *
      *   113352 - Recompile over changes in MGOREFPD                 *
      *   S01408 - Addition of core hook MS4015FFP1                   *
      *            Addition of core hook MS4015FFP2                   *
      *            Addition of core hook MS4015CCP1                   *
      *            Addition of core hook MS4015OOP1                   *
      *   S01310 - RE WRITTEN FOR SWIFT RATIONALISATION               *
      *                                                               *
      *****************************************************************
      *                                                                   S01408
     F/COPY WNCPYSRC,MS4015FFP1                                           S01408
      *                                                                   S01408
     FMGOREFLHUF  E           K        DISK
      *
      * ID C  F  H  L    Function of indicators
      *    11            EOF MGOREFLH
      *
      *                                                                   S01408
     F/COPY WNCPYSRC,MS4015FFP2                                           S01408
      *                                                                   S01408
     E                    CPY@    1   1 80
      *
     ILDA         DS                            256
     I                                      134 141 DBFILE
     I                                      142 170 DBKEY
     I                                      171 180 DBPGM
     I                                      181 1830DBASE
      **  Local data area
      *
     IMSSTAT      DS                            256
     I                                       25  25 MTCIND
      **  MSSTAT datastructure
      *
      *****************************************************************
      *                   Index to subroutines                        *
      *   main process                                                *
      *   *PSSR  - error handling                                     *
      *****************************************************************
     C/EJECT
      *****************************************************************
      *   main process                                                *
      *****************************************************************
      *
      **  Reference Copyright Array
     C                     MOVEACPY@      CPY@@   1
      *                                                                   S01408
     C/COPY WNCPYSRC,MS4015CCP1                                           S01408
      *                                                                   S01408
      *
      **  Read pending outgoing SWIFT message
     C           *BLANKS   SETLLMGOREFLH
     C                     READ MGOREFLH                 11
      *
      **  Change status to ready to send
     C           *IN11     DOWEQ'0'
     C                     MOVE 'RSND'    MGST
     C                     EXCPT
      *
      **  Read pending outgoing SWIFT message
     C                     READ MGOREFLH                 11
     C                     END
      *
      **  Set off 'Message transmission closedown' flag
     C           *NAMVAR   DEFN           MSSTAT
     C           *LOCK     IN   MSSTAT
     C                     MOVE 'N'       MTCIND
     C                     OUT  MSSTAT
     C*
     C                     SETON                     LR
     C/EJECT
      ********************************************************************
      *
      **  Update message status on MGOREFLH
     OMGOREFD0E
     O                         MGST
      *                                                                   S01408
     O/COPY WNCPYSRC,MS4015OOP1                                           S01408
      *                                                                   S01408
**  CPY@
(c) Misys International Banking Systems Ltd. 2001
