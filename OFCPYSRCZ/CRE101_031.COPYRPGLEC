      *****************************************************************
      *                                                               *
      *  Midas - /COPY Member (RPGLE)                                 *
      *                                                               *
      *  CRE101_031 - Midas OF Interim Int Statement on a Frequency   *
      *                                                               *
      *  RPGLE/GLAMADUPD                                              *
      *                                                               *
      *  (c) Finastra International Limited 2014                      *
      *                                                               *
      *  Last Amend No. MD046248           Date 27Oct17               *
      *  Prev Amend No. CRE101  *CREATE    Date 27Aug14               *
      *                                                               *
      *---------------------------------------------------------------*
      *                                                               *
      *  MD046248 - Finastra Rebranding                               *
      *  CRE101 - Interim Interest Statement on a Frequency           *
      *                                                               *
      *****************************************************************
      *
     C                   IF        CRE101 = 'Y' and
     C                             AMATYP = 'R'
     C/Exec SQL
     C+                  Select * into :DSGLACMI1D
     C+                           from GLACMI1D
     C+                          where MICNUM  = :CustNum
     C+                          and   MICCY   = :Currency
     C+                          and   MIACOD  = :AccCode
     C+                          and   MIACSQ  = :AccSeq
     C+                          and   MIBRCA  = :Branch
     C+                          fetch first 1 row only
     C/End-Exec
     C                   If        SQLCOD <> 0
     C                   EVAL      MICNUM = AMCNUM
     C                   EVAL      MICCY = AMCCY
     C                   EVAL      MIACOD = AMACOD
     C                   EVAL      MIACSQ = AMACSQ
     C                   EVAL      MIBRCA = AMBRCA
     C                   EVAL      MISTMI = MVSTMI
     C                   EVAL      MINISD = MVNISD
     C                   EVAL      MIISFF = MVISFF
     C                   EVAL      MIISFM = MVISFM
     C                   EVAL      MILISD = 0
     C/exec SQL
     C+ insert into GLACMI1D
     C+ values(:DSGLACMI1D)
     C/end-exec
     C                   ELSE
     C/exec SQL
     C+ UPDATE GLACMI1D SET MISTMI = :MVSTMI, MINISD = :MVNISD
     C+  , MIISFF = :MVISFF, MIISFM = :MVISFM
     C+  where MICNUM = :CustNum
     C+  and   MICCY = :Currency
     C+  and   MIACOD = :AccCode
     C+  and   MIACSQ = :AccSeq
     C+  and   MIBRCA = :Branch
     C/end-exec
      *
     C                   ENDIF
     C                   ENDIF
      *
      *****************************************************************
      * End of /COPY CRE101_031                                       *
      *****************************************************************
