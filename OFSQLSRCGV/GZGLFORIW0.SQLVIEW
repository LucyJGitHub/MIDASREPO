/*******************************************************************************/
/*                                                                             */
/*       Midas - General Ledger Module                                         */
/*                                                                             */
/*       GZGLFORIW0 - Midas OF Individual Forecast View                        */
/*                                                                             */
/*       (c) Finastra International Limited 2013                               */
/*                                                                             */
/*       Last Amend No. CSD103             Date 10Aug20                        */
/*       Prev Amend No. MD052296           Date 26Nov18                        */
/*                      MD046248           Date 27Oct17                        */
/*                      CDL094             Date 30May14                        */
/*                      MD024003           Date 10Dec13                        */
/*                      MD023805           Date 27Nov13                        */
/*                      MD023432           Date 15Nov13                        */
/*                      CGL145B            Date 28Oct13                        */
/*                      CGL145A            Date 08Oct13                        */
/*                      CGL145   *CREATE   Date 10Jul13                        */
/*                                                                             */
/*-----------------------------------------------------------------------------*/
/*                                                                             */
/*       CSD103 - LIBOR Deregulation - Common Layer/Standing Data (Recompile)  */
/*       MD052296 - Problems caused by use of special characters               */
/*       MD046248 - Finastra Rebranding                                        */
/*       CDL094 - Enhance  Receive Settlement Instructions                     */
/*                (Recompile on GZSDNOSTPD changes)                            */
/*       MD024003 - Nostro Summary screen does not display any details.        */
/*       MD023805 - No transaction in the Forecast Totals is shown when All    */
/*                  or Active is selected in the List configuration            */
/*       MD023432 - Forecast input reflected twice on both Forecast            */
/*                   Individual and Forecast Totals (Recompile)                */
/*       CGL145B - Subsidiaries Daily Sweeping Forecast (Drop 3)               */
/*       CGL145A - Subsidiaries Daily Sweeping Forecast (Drop 2). Recompile    */
/*                 due to changes in GZGLFORITD.                               */
/*       CGL145 - Subsidiaries Daily Sweeping Forecast                         */
/*                                                                             */
/*******************************************************************************/
  CREATE VIEW                                                                   :
  **********/**********                                                         :
  AS                                                                            :
  /**********SELECT A.*, B.CGRNM AS IFRNM, B.CGRTN AS IFRTN, **********/        :            CGL145B
  SELECT A.*,                                                                   :            CGL145B
  CASE WHEN A.IFAMNT < 0 THEN 'D' ELSE 'C' END AS IFDRCR,                       :            CGL145B
  B.CGRNM AS IFRNM, B.CGRTN AS IFRTN,                                           :            CGL145B
  C.ANAM AS IFANAM, D.ANAM AS IFNNAM,C.BRCA AS IFBRCA,                          :
/*CASE*WHEN*A.IFACNO*!=*0*THEN*DIGITS(A.IFACNO)********************************/:           MD052296
  CASE WHEN A.IFACNO <> 0 THEN DIGITS(A.IFACNO)                                 :           MD052296
  ELSE C.BRCA CONCAT C.CNUM CONCAT C.CCY CONCAT DIGITS(C.ACOD)                  :
  CONCAT DIGITS(C.ACSQ) END AS ACCT                                             :
  FROM GZGLFORITD A LEFT OUTER JOIN GPGLCUSL B                                  :
  ON A.IFCUST = B.CGCUST AND A.IFZONE = B.CGZONE                                :
  LEFT OUTER JOIN GZACCNTAB C ON                                                :
  A.IFFACN = C.BRCA CONCAT C.CNUM CONCAT C.CCY CONCAT                           :
  DIGITS(C.ACOD) CONCAT DIGITS(C.ACSQ)                                          :
  LEFT OUTER JOIN GZSDNOSTW0 D ON A.IFNOSC = D.A7NONB AND                       :
  A.IFCCY = D.A7CYCD                                                            :
  /**********AND C.BRCA = D.A7BRCD **********/                                  :  MD023805 MD024003
  AND A.IFNBRC = D.A7BRCD                                                       :           MD024003
/*******************************************************************************/
 ;                                                                              :
  label on table     **********/**********                                      :
   is 'Midas OF Individual Forecast View                 ';                     :
                                                                                :
