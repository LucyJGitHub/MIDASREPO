     H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas PB Maintenance calling pgm to check window')
      *****************************************************************
      *                                                               *
      *  Midas - Private Banking Module                               *
      *                                                               *
      *  PB0005 - CALLS PB MAINTENANCE PROGRAMS AND CHECKS FOR        *
      *           WINDOW PROCESSING                                   *
      *                                                               *
      *  (c) Finastra International Limited 2001                      *
      *                                                               *
      *  Last Amend No. MD046248           Date 27Oct17               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *  Prev Amend No. CPK018             Date 19Mar05               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.02 -----------------------------------------------*
      *                 CPB001  *CREATE    Date 9JUn99                *
      *                                                               *
      *---------------------------------------------------------------*
      *                                                               *
      *  MD046248 - Finastra Rebranding                               *
      *  CPK018 - Change to make windows switchable. Replace use of   *
      *           - Replace use of SDMREFL1 with SDMREFJ0.            *
      *  CPB001 -  'Private Banking' Module                           *
      *                                                               *
      *****************************************************************
     FSDMMODPDIF  E                    DISK
     F*SDMREFL1IF*E*******    K        DISK                                                   CPK018
     FSDMREFJ0IF  E           K        DISK                                                   CPK018
     FSDOREFL1IF  E           K        DISK
     E                    CPY@    1   1 80
     E                    MSG     1   1 40
     I*  DATA STRUCTURE FOR COMPILATION  - COPYRIGHT INSERTION
     ICPYR@#      DS
     I                                        1  80 CPY@
     I                                        1  20 CPY@##
     C*
     C*  ENTRY PARAMETERS ARE PROGRAM NAMES
     C*
     C           *ENTRY    PLIST
     C                     PARM           PGM1    8
     C                     PARM           PGM2    8
     C                     PARM           PGMMD   1
     C                     PARM           PGM3    8
     C*
     C           PGM1      IFEQ *BLANKS
     C  N92                CALL PGM2                   90
     C                     PARM           WORTN   7
     C                     PARM           PGMMD
     C                     ELSE
     C*
     C*  IF NO ALTERNATIVE PROGRAM FOR WINDOWS (PGM2) CALL PGM1
     C*
     C           PGM2      IFEQ *BLANKS
     C*
     C                     CALL PGM1                   90
     C                     PARM           WORTN   7
     C*
     C                     ELSE
     C*
     C                     READ SDMMODPD                 91
     C*
     C*  CHECK MMOD FOR WINDOW PROCESSING FLAG 'YES'
     C*
     C           BGWDPR    IFEQ 'Y'
     C*
     C*  CHECK SDMREFPD TO SEE IF WINDOW PROCESSING DEFINED
     C*  AND CHECK SDOREFPD TO SEE IF WINDOW PROCESSING DEFINED
     C*
     C                     MOVELPGM3      WPGM3  10
     C********** WPGM3     CHAINSDMREFL1             92                                       CPK018
     C           WPGM3     CHAINSDMREFJ0             92                                       CPK018
     C           WPGM3     CHAINSDOREFL1             93
     C           *IN92     IFEQ '1'
     C           *IN93     ANDEQ'1'
     C                     CALL PGM1                   90
     C                     PARM           W0RTN   7
     C                     ELSE
     C                     CALL PGM2                   90
     C                     PARM           W0RTN   7
     C                     PARM           PGMMD
     C                     END
     C*
     C                     ELSE
     C                     CALL PGM1                   90
     C                     PARM           WORTN   7
     C                     END
     C                     END
     C                     END
     C*
     C*  SEND ERROR MESSAGE IF CALL OR READ OPERATIONS FAIL
     C*
     C   91
     COR 90      MSG,1     DSPLY'*EXT'    REPLY   1
     C*
     C                     SETON                     LR
     C                     RETRN
     C*
** CPY@   **      OBJECT COPYRIGHT
(c) Finastra International Limited 2001
**  MESSAGE TEXT
Transaction Failed, Enter to Continue
