     H
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas PM Installation process')                        *
     F*****************************************************************
     F*                                                               *
     F*  Midas - Portfolio Management                                 *
     F*                                                               *
     F*  PM0000 - PORTFOLIO MANAGEMENT INSTALLATION PROCESS           *
     F*                                                               *
      *  (c) Finastra International Limited 2001                      *
      *                                                               *
      *  Last Amend No. MD046248           Date 27Oct17               *
      *  Prev Amend No. CDL099             Date 06Oct17               *
      *                 CLE141             Date 08Feb16               *
      *                 CGL165             Date 15Feb17               *
      *                 CDL096             Date 22Sep14               *
      *                 CDL094             Date 11Jun14               *
      *                 CLE134             Date 01Aug12               *
      *                 CLE148             Date 23Jul12               *
      *                 CSW212             Date 03May12               *
      *                 CRE073             Date 06Dec10               *
      *                 CLE143             Date 06Dec10               *
      *                 CRE075             Date 06Dec10               *
      *                 CER059             Date 19Jul10               *
      *                 CER054             Date 07Apr09               *
      *                 CER048             Date 19May08               *
      *                 CER047             Date 19May08               *
      *                 CER020             Date 19May08               *
      *                 CER043             Date 19May08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 234300             Date 22Sep06               *
      *                 CDL049             Date 11Jul06               *
      *                 CSD027             Date 09Dec05               *
      *                 CLE042             Date 06Sep05               *
      *                 CAS009             Date 16May05               *
      *                 CDL038             Date 10May05               *
      *                 CGL014             Date 20Oct03               *
      *                 CDL020             Date 03Feb04               *
      *                 CDL019             Date 03Feb04               *
      *                 CDL018             Date 03Feb04               *
      *                 CDL017             Date 03Feb04               *
      *                 CDL016             Date 03Feb04               *
      *                 222727             Date 05Nov03               *
      *                 CAP074             Date 08Aug02               *
      *                 CAS006             Date 21Jan03               *
      *                 CAS005             Date 16Dec02               *
      *                 CLE028             Date 27Jun02               *
      *                 CDL010             Date 02Aug02               *
      *                 CAS004             Date 26Jun02               *
      * Midas Release 4.01.01 ----------------------------------------*
      *                 207006             Date 18Jun02               *
      * Midas Release 4.01 -------------------------------------------*
      *                 CAS002             Date 14Jan02               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.05 -----------------------------------------------*
      *                 CLE011             Date 07Nov00               *
      * Midas DBA 3.04 -----------------------------------------------*
      *                 CSE023             Date 12Jul00               *
      *                 CDL008             Date 02May00               *
      * Midas DBA 3.02 -----------------------------------------------*
      *                 CSE015             Date 06Dec99               *
      *                 CSE017             Date 20Oct99               *
      *                 CSE012             Date 16Aug99               *
      * Midas DBA 3.01 Patch E ---------------------------------------*
      *                 170520             Date 19Nov99               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 CAP003             Date 17May98               *
      *                 128494             Date 07Jan98               *
     F*                 CPM005             DATE 22AUG96               *
     F*                 CFF004             DATE 02OCT96               *
     F*                 103478             DATE 21MAY96               *
     F*                 CPM003             DATE 02MAY96               *
     F*                 S71062             DATE 21NOV94               *
     F*                 094367             DATE 21NOV94               *
     F*                 73957              DATE 21NOV94               *
     F*                 S01486             DATE 17JUN94               *
     F*                 049421             DATE 19JAN93               *
     F*                 044387             DATE 10SEP92               *
     F*                 S01355             DATE 28AUG92               *
     F*                                                               *
      *****************************************************************
      *                                                               *
      *  MD046248 - Finastra Rebranding                               *
      *  CDL099 - Split Value Date (Recompile)                        *
      *  CLE141 - Currency and Location Business Day Convention       *
      *           (Recompile)                                         *
      *  CGL165 - Dual Withholding Tax (Recompile)                    *
      *  CDL096 - Business Day Conventions on MM Deals                *
      *           (Recompile)                                         *
      *  CDL094 - Enhance  Receive Settlement Instructions            *
      *           (Recompiled)                                        *
      *  CLE134 - Past Due Call Loan Processing (Recompile)           *
      *  CLE148 - Alpha Loan Reference (Recompile)                    *
      *  CSW212 - SWIFT 2012 Changes (Recompile)                      *
      *  CRE073 - Interest Rate Rounding (Recompile)                  *
      *  CLE143 - Original Loan Contract Date & Effective Interest    *
      *           Rate (Recompile)                                    *
      *  CRE075 - Effective Date for Retail Accounts (Recompile)      *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  CER054 - German Features - Church Tax (Recompile)            *
      *  CER048 - German Features - Taxes (Recompile)                 *
      *  CER047 - German Features LF037-00 Reporting §24c KWG         *
      *           (Recompile)                                         *
      *  CER020 - Enhanced Rollover Window: Upgrade FGE089 to         *
      *           Midas Plus (Recompile)                              *
      *  CER043 - German Features LF041-00 New Fields and Defaulting  *
      *           (Recompile)                                         *
      *  234300 - Recompiled over changed in PF/HSTTRD.               *
      *  CDL049 - Addition of a Reference Rate field (recompile)      *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CLE042 - Extended Loan Sub Type (Recompile)                  *
      *  CAS009 - EIR/AC Accounting (Recompile)                       *
      *  CDL038 - Extended Deal Sub Type (Recompile)                  *
      *  CGL014 - Collaterals Processing (Recompile)                  *
      *  CDL020 - Apply Base Rate at Value Date (Recompile)           *
      *  CDL019 - Allow Base Rate Changes on Fixed Deposits/Loans     *
      *           (Recompile)                                         *
      *  CDL018 - Multiple Settlement Accounts on Loans/Deposits      *
      *           (Recompile)                                         *
      *  CDL017 - Penalty Fee & Early Maturity of Fixed Term Loan/Dep *
      *           (Recompile)                                         *
      *  CDL016 - Automatic rollover of Fixed Term Loans/Deposits     *
      *           (Recompile)                                         *
      *  222727 - Release 5.0 errors  (Recompile)                     *
      *  CAP074 - Lending API enhancements - Loans input.             *
      *  CAS006 - Hedge Accounting Phase B                            *
      *  CAS005 - Enhancements to CAS001, CAS002 and CAS004           *
      *           (Recompile)                                         *
      *  CLE028 - Flat Rate Personal Loans (Rule of 78s)              *
      *           (Recompile)                                         *
      *  CDL010 - Prevent last user that actioned the trade from      *
      *           authorising it.Recompile due to changes in          *
      *           FXDEALPP and MMDELDPP.                              *
      *  CAS004 - Hedge Accounting Phase A (Recompile)                *
      *  207006 - Add Counterparty & Market Centre to SSI (Recompile) *
      *  CAS002 - Hedge Strategy/Linkage (Recompile)                  *
      *  CLE011 - Rate Fixing Days for Lending Rollover Processing    *
      *           Recompile                                           *
      *  CSE023 - Treaty Withholding Tax.                             *
      *  CDL008 - Continuous Linked Settlement (Recompiled)           *
      *  CSE015 - Forward Valued Depot Movements (Recompile)          *
      *  CSE017 - Cum/Ex Indicator on Depot Movements (Recompile)     *
      *  CSE012 - SE Depot Movement Narratives (Recompiled).          *
      *  170520 - Recompile over changed TRANSD file                  *
     F*  CAP003 - Conversion of SE inputs into modular structure to   *
     F*           use as APIs. Recompiled to adopt changes in DPTMVD. *
     F*  128494 - Initialise PMFG new trailers                        *
     F*  CPM005 - Private Banking Phase 2                             *
     F*           Focus Group Changes upgraded to DBA                 *
     F*  CFF004 - Increase in size of Price Fields,(Recompiled Only)  *
     F*  103478 - Change Bulk to Trades format (Recompile)            *
     F*  CPM003 - FF/PM Interface upgrade to Release 10               *
     F*  S71062 - FF/PM interface                                     *
     F*         - Re-activate FF coding                               *
     F*         - Remove incorrect fix 094367; PTFR should be '9997'  *
     F*           only if customer of the transaction is a portfolio  *
     F*           customer (defined in PF/SDPLCSPD). As this PGM      *
     F*           runs only at the INSTALLATION of PM, there are no   *
     F*           customers defined as portfolio customers ... So,    *
     F*           Portfolio reference must be blanks |||              *
     F*           When a customer will be defined as portfolio, a     *
     F*           special processing (See RPG/PM1030) will setup      *
     F*           correctly the portfolio reference in the records    *
     F*           concerning this customer in the transaction files.  *
     F*  094367 - Correction to 073957.                               *
     F*           Field PTFR should be initialised with '9997'        *
     F*           NOT *blanks. Also, TRANSD doesn't possess a         *
     F*           PTFR field to be initialised!. Remove from pgm      *
     F*  73957  - Field PTFR set to blanks in existing files.         *
     F*  S01486 - Portfolio Management Incorporation                  *
     F*  049421 - HEADER BOX STANDARDISATION                          *
     F*  044387 - Spelling error + Field suppressed(P9GPPS).          *
     F*  S01355 - RELEASE 3 INCORPORATION                             *
     F*                                                               *
     F*****************************************************************
     F***SDMMODPDUF**E*          K        DISK         KINFSR *PSSR       S01486
     F***MMODF***UF**E*          K        DISK         KINFSR *PSSR       S01486
     F***PMBIPNZZO***E*                   DISK         KINFSR *PSSR       S01486
     F***PMCGCDZZO***E*                   DISK         KINFSR *PSSR       S01486
     F***PMDCOMZZO***E*                   DISK         KINFSR *PSSR       S01486
     F***PMDOCCZZO***E*                   DISK         KINFSR *PSSR       S01486
     F***PMDSPGZZO***E*                   DISK         KINFSR *PSSR       S01486
     F***PMPGHCZZO***E*                   DISK         KINFSR *PSSR       S01486
     F***PMPGHDZZO***E*                   DISK         KINFSR *PSSR       S01486
     F***PMPGHIZZO***E*                   DISK         KINFSR *PSSR       S01486
     F***PMPGHRZZO***E*                   DISK         KINFSR *PSSR       S01486
     F***PMPORTZZO***E*                   DISK         KINFSR *PSSR       S01486
     F***PMPTFTZZO***E*                   DISK         KINFSR *PSSR       S01486
     F***PMTRSFZZO***E*                   DISK         KINFSR *PSSR       S01486
     F***PMVLGHZZO***E*                   DISK         KINFSR *PSSR       S01486
     F***SDDTSTZZO***E*                   DISK         KINFSR *PSSR       S01486
     F***SDPLINZZO***E*                   DISK         KINFSR *PSSR       S01486
     F***PMCPOSZZO***E*                   DISK         KINFSR *PSSR       S01486
     F***PMPPTDZZO***E*                   DISK         KINFSR *PSSR S01355S01486
     F***SDFCTLL0UF**E*          K        DISK         KINFSR *PSSR A     S01486
     FPMBIPNPAO   E                    DISK         KINFSR *PSSR          S01486
     FPMCGCDPAO   E                    DISK         KINFSR *PSSR          S01486
     FPMDCOMPAO   E                    DISK         KINFSR *PSSR          S01486
     FPMDOCCPAO   E                    DISK         KINFSR *PSSR          S01486
     FPMDSPGPAO   E                    DISK         KINFSR *PSSR          S01486
     FPMPGHCPAO   E                    DISK         KINFSR *PSSR          S01486
     FPMPGHDPAO   E                    DISK         KINFSR *PSSR          S01486
     FPMPGHIPAO   E                    DISK         KINFSR *PSSR          S01486
     FPMPGHRPAO   E                    DISK         KINFSR *PSSR          S01486
     FPMPORTPAO   E                    DISK         KINFSR *PSSR          S01486
     FPMPTFTPAO   E                    DISK         KINFSR *PSSR          S01486
     FPMTRSFPAO   E                    DISK         KINFSR *PSSR          S01486
     FPMVLGHPAO   E                    DISK         KINFSR *PSSR          S01486
     FPMCPOSPAO   E                    DISK         KINFSR *PSSR          S01486
     FPMCNSDPAO   E                    DISK         KINFSR *PSSR          128494
     FPMPCBCPAO   E                    DISK         KINFSR *PSSR          128494
     FSDPLINPAO   E                    DISK         KINFSR *PSSR          S01486
     F*******PMPPTDPAO   E                    DISK         KINFSR *PSSR   S01486
     F***SDPORTPDUF**E*                   DISK         KINFSR *PSSR A     S01486
     FHSTTRD  UF  E                    DISK         KINFSR *PSSR      UC  73957
     FBULKTD  UF  E                    DISK         KINFSR *PSSR      UC  73957
     FTRADSD  UF  E                    DISK         KINFSR *PSSR      UC  73957
     FDPTMVD  UF  E                    DISK         KINFSR *PSSR      UC  73957
     FCAPRHD  UF  E                    DISK         KINFSR *PSSR      UC  73957
     FPOSETD  UF  E                    DISK         KINFSR *PSSR      UC  73957
     FFXDEALPPUF  E                    DISK         KINFSR *PSSR      UC  73957
     FMMDELDPPUF  E                    DISK         KINFSR *PSSR      UC  73957
     FDEALSDC UF  E                    DISK         KINFSR *PSSR      UC  73957
     FDEALSDB UF  E                    DISK         KINFSR *PSSR      UC  73957
     FCLOANCL UF  E                    DISK         KINFSR *PSSR      UC  73957
     FMCLONCL UF  E                    DISK         KINFSR *PSSR      UC  73957
     F            CLOANCLF                          KRENAMEMCLONCLF       73957
     FACCNTAB UF  E                    DISK         KINFSR *PSSR          73957
      **   TRANSD has no field PTFR. Do not initialise. Remove from pgm   094367
     F***TRANSD**UF**E*                   DISK         KINFSR *PSSR 73957 094367
     FTRANSD  UF  E                    DISK         KINFSR *PSSR      UC  S71062
     F/COPY WNCPYSRC,PM0000F001
     E*                                                                   S01486
     E                    CPY@    1   1 80                                S01486
     E                    TEXTA   1   2 50                                CPM005
      *                                                                                       CAS006
      ** Rename fields on TRADS                                                               CAS006
      *                                                                                       CAS006
     ITRADSDF                                                                                 CAS006
     I              CRSK                            SECRSK                                    CAS006
      *                                                                                       CAS006
      ** Rename fields on HSTTRD                                                              CAS006
      *                                                                                       CAS006
     IHSTTRDF                                                                                 CAS006
     I              CRSK                            SECRSK                                    CAS006
      *                                                                                       CAS006
      ** Rename fields on BULKTD                                                              CAS006
      *                                                                                       CAS006
     IBULKTDF                                                                                 CAS006
     I              CRSK                            SECRSK                                    CAS006
     I**  DATA STRUCTURE FOR COMPILATION  - COPYRIGHT INSERTION:          S01486
     ICPYR@#      DS                                                      S01486
     I                                        1  80 CPY@                  S01486
     I                                        1  20 CPY@##                S01486
     I*
     I** LOCAL DATA AREA FOR DATABASE ERROR DETAILS
     I*
     ILDA        UDS                            256
     I                                      132 141 DBFILE
     I                                      142 170 DBKEY
     I                                      171 180 DBPGM
     I                                      181 1830DBASE
     I*
     IDSFDY     E DSDSFDY                                                 S01486
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01486
     I******SDPORT    E DSSDPORTPD                                        S01486
     I** DUMMY RECORD FORMATS FOR ACCESS TO BANK DETAILS                  S01486
     I*
     ISDMMOD    E DSSDMMODPD                                              73957
     I**  Data structure for module details                               73957
     I*                                                                   73957
     ISDPORT    E DSSDPORTPD                                              CPM003
     I** Portfolio Management ICD                                         CPM003
     I*                                                                   CPM003
     ISCSARD    E DSSCSARDPD                                              CPM005
     I**  Data structure for Switchable Features details                  CPM005
     I*                                                                   CPM005
     I***MODULE*DATA*STRUCTURE*****************************************   S01486
     I***********                                                         S01486
     I***MMOD****   UDS                            256                    S01486
     I***********                            75  75 WWPFMG                S01486
     I***LZSTAT**    DS                            256             R3INCO S01486
     I***********                            35  35 WWPOOL         R3INCO S01486
     C****DEFINE*INPUT*PARAMETER:**************************************   S01486
     C************ENTRY    PLIST                                          S01486
     C***********          PARM           WWFAIL  1                       S01486
     C***********                                                         S01486
     C************NAMVAR   DEFN           LZSTAT                   R3INCO S01486
     C***********          IN   LZSTAT                             R3INCO S01486
     C*
     C*SET*ON*PORTFOLIO*MANAGEMENT*INDICATOR*ON*PF/SDMMODPD************   S01486
     C***********                                                         S01486
     C***********          READ SDMMODPD                 74               S01486
     C************IN74     IFEQ '1'                        ***************S01486
     C***********          MOVEL'001'     DBASE            **DB ERROR 01**S01486
     C***********          MOVEL'SDMMODPD'DBFILE           ***************S01486
     C***********          MOVE *BLANKS   DBKEY                           S01486
     C***********          EXSR *PSSR                                     S01486
     C***********          END                                            S01486
     C***********                                                         S01486
     C***********          MOVE 'Y'       BGPFMG                          S01486
     C***********          UPDATSDMMODD0                                  S01486
     C***********                                                         S01486
     C***SET*ON*PORTFOLIO MANAGEMENT INDICATOR ON DTAARA/MMOD*********    S01486
     C***********                                                         S01486
     C***********          MOVE 'Y'       WWPFMG                          S01486
     C***********                                                         S01486
     C***SET*ON*PORTFOLIO*MANAGEMENT*INDICATOR*ON*PF/SDMMODPD*********    S01486
     C***********                                                         S01486
     C***********          READ MMODF                    74               S01486
     C************IN74     IFEQ '1'                        ***************S01486
     C***********          MOVEL'002'     DBASE            **DB ERROR 01**S01486
     C***********          MOVEL'MMODF'   DBFILE           ***************S01486
     C***********          MOVE *BLANKS   DBKEY                           S01486
     C***********          EXSR *PSSR                                     S01486
     C***********          END                                            S01486
     C***********                                                         S01486
     C***********          MOVE 'Y'       PMFL                            S01486
     C***********          UPDATMMODFF                                    S01486
     C*                                                                   CPM005
     C** IF CPM005 IS SWITCHED OFF, SWITCH ON                             CPM005
     C*                                                                   CPM005
     C                     CALL 'AOSARDR0'                                CPM005
     C                     PARM *BLANKS   WLRTCD                          CPM005
     C                     PARM '*VERIFY' WLOPTN                          CPM005
     C                     PARM 'CPM005'  WLSARD  6                       CPM005
     C           SCSARD    PARM SCSARD    DSFDY                           CPM005
     C*                                                                   CPM005
     C           WLRTCD    IFNE *BLANKS                                   CPM005
     C                     MOVELTEXTA,1   TEXT   50                       CPM005
     C                     CALL 'SC3011X'                                 CPM005
     C                     PARM           P0RTN   7                       CPM005
     C                     PARM 'I'       PANCD   1                       CPM005
     C                     PARM 'CPM005'  PSARN   6                       CPM005
     C                     PARM TEXT      PSARD  50                       CPM005
     C                     PARM           PBSCD   6                       CPM005
     C*                                                                   CPM005
     C           PBSCD     IFNE *BLANKS                                   CPM005
     C                     Z-ADD7         DBASE                           CPM005
     C                     MOVE 'SCSARDPD'DBFILE                          CPM005
     C                     MOVELPSARN     DBKEY                           CPM005
     C                     EXSR *PSSR                                     CPM005
     C                     END                                            CPM005
     C                     END                                            CPM005
     C*                                                                   CPM005
     C** IF CSD001 IS SWITCHED OFF, SWITCH ON                             CPM005
     C*                                                                   CPM005
     C                     CALL 'AOSARDR0'                                CPM005
     C                     PARM *BLANKS   WLRTCD                          CPM005
     C                     PARM '*VERIFY' WLOPTN                          CPM005
     C                     PARM 'CSD001'  WLSARD  6                       CPM005
     C           SCSARD    PARM SCSARD    DSFDY                           CPM005
     C*                                                                   CPM005
     C           WLRTCD    IFNE *BLANKS                                   CPM005
     C                     MOVELTEXTA,2   TEXT                            CPM005
     C                     CALL 'SC3011X'                                 CPM005
     C                     PARM           P0RTN   7                       CPM005
     C                     PARM 'I'       PANCD   1                       CPM005
     C                     PARM 'CSD001'  PSARN   6                       CPM005
     C                     PARM TEXT      PSARD  50                       CPM005
     C                     PARM           PBSCD   6                       CPM005
     C*                                                                   CPM005
     C           PBSCD     IFNE *BLANKS                                   CPM005
     C                     Z-ADD8         DBASE                           CPM005
     C                     MOVE 'SCSARDPD'DBFILE                          CPM005
     C                     MOVELPSARN     DBKEY                           CPM005
     C                     EXSR *PSSR                                     CPM005
     C                     END                                            CPM005
     C                     END                                            CPM005
     C/COPY WNCPYSRC,PM0000C002
     C*
     C***INITIALISE*FILE*TRAILER*FOR*PMBIPNZZ**************************   S01486
     C** INITIALISE FILE TRAILER FOR PMBIPNPA                             S01486
     C*
     C                     MOVE 'Z'       PSRECI
     C                     WRITEPMBIPNZ0
     C*
     C***INITIALISE*FILE*TRAILER*FOR*PMCGCDZZ**************************   S01486
     C** INITIALISE FILE TRAILER FOR PMCGCDPA                             S01486
     C*
     C                     MOVE 'Z'       P5RECI
     C                     WRITEPMCGCDZ0
     C*
     C***INITIALISE*FILE*TRAILER*FOR*PMDCOMZZ**************************   S01486
     C** INITIALISE FILE TRAILER FOR PMDCOMPA                             S01486
     C*
     C                     MOVE 'Z'       P4RECI
     C                     WRITEPMDCOMZ0
     C*
     C***INITIALISE*FILE*TRAILER*FOR*PMDOCCZZ**************************   S01486
     C** INITIALISE FILE TRAILER FOR PMDOCCPA                             S01486
     C*
     C                     MOVE 'Z'       P3RECI
     C                     WRITEPMDOCCZ0
     C*
     C***INITIALISE*FILE*TRAILER*FOR*PMDSPGZZ**************************   S01486
     C** INITIALISE FILE TRAILER FOR PMDSPGPA                             S01486
     C*
     C                     MOVE 'Z'       PARECI
     C                     WRITEPMDSPGZ0
     C*
     C***INITIALISE*FILE*TRAILER*FOR*PMPGHCZZ**************************   S01486
     C** INITIALISE FILE TRAILER FOR PMPGHCPA                             S01486
     C*
     C                     MOVE 'Z'       PHRECI
     C                     WRITEPMPGHCZ0
     C*
     C***INITIALISE*FILE*TRAILER*FOR*PMPGHDZZ**************************   S01486
     C** INITIALISE FILE TRAILER FOR PMPGHDPA                             S01486
     C*
     C                     MOVE 'Z'       PLRECI
     C                     WRITEPMPGHDZ0
     C*
     C***INITIALISE*FILE*TRAILER*FOR*PMPGHIZZ**************************   S01486
     C** INITIALISE FILE TRAILER FOR PMPGHIPA                             S01486
     C*
     C                     MOVE 'Z'       PFRECI
     C                     WRITEPMPGHIZ0
     C*
     C***INITIALISE*FILE*TRAILER*FOR*PMPGHRZZ**************************   S01486
     C** INITIALISE FILE TRAILER FOR PMPGHRPA                             S01486
     C*
     C                     MOVE 'Z'       PJRECI
     C                     WRITEPMPGHRZ0
     C*
     C***INITIALISE*FILE*TRAILER*FOR*PMPORTZZ**************************   S01486
     C** INITIALISE FILE TRAILER FOR PMPORTPA                             S01486
     C*
     C                     MOVE 'Z'       PNRECI
     C                     WRITEPMPORTZ0
     C*
     C***INITIALISE*FILE*TRAILER*FOR*PMPTFTZZ**************************   S01486
     C** INITIALISE FILE TRAILER FOR PMPTFTPA                             S01486
     C*
     C                     MOVE 'Z'       PERECI
     C                     WRITEPMPTFTZ0
     C*
     C***INITIALISE*FILE*TRAILER*FOR*PMTRSFZZ**************************   S01486
     C** INITIALISE FILE TRAILER FOR PMTRSFPA                             S01486
     C*
     C                     MOVE 'Z'       P8RECI
     C                     WRITEPMTRSFZ0
     C*
     C***INITIALISE*FILE*TRAILER*FOR*PMVLGHZZ**************************   S01486
     C** INITIALISE FILE TRAILER FOR PMVLGHPA                             S01486
     C*
     C                     MOVE 'Z'       PBRECI
     C                     WRITEPMVLGHZ0
     C*
     C***INITIALISE*FILE*TRAILER*FOR*SDDTSTZZ**************************   S01486
     C***********                                                         S01486
     C***********          MOVE 'Z'       P7RECI                          S01486
     C***********          WRITESDDTSTZ0                                  S01486
     C*
     C***INITIALISE*FILE*TRAILER*FOR*SDPLINZZ**************************   S01486
     C**********                                                          S01486
     C**********           MOVE 'Z'       PDRECI                          S01486
     C**********           WRITESDPLINZ0                                  S01486
     C*  INITIALISE FILE TRAILER FOR SDPLINPA                             S01486
     C*                                                                   S01486
     C                     MOVE 'Z'       PDRECI                          S01486
     C                     WRITESDPLINZ0                                  S01486
     C*
     C***INITIALISE*FILE*TRAILER*FOR*PMCPOSZZ**************************   S01486
     C** INITIALISE FILE TRAILER FOR PMCPOSPA                             S01486
     C*
     C                     MOVE 'Z'       QARECI
     C                     WRITEPMCPOSZ0
     C/COPY WNCPYSRC,PM0000C001
     C*                                                                   128494
     C** INITIALISE FILE TRAILER FOR PMCNSDPA                             128494
     C*                                                                   128494
     C                     MOVE 'Z'       PNRECI                          128494
     C                     WRITEPMCNSDZ0                                  128494
     C*                                                                   128494
     C** INITIALISE FILE TRAILER FOR PMPCBCPA                             128494
     C*                                                                   128494
     C                     MOVE 'Z'       FMRECI                          128494
     C                     WRITEPMPCBCZ0                                  128494
     C*                                                                   S01486
     C****ACCESS*PORTFOLIO*MANAGEMENT*ICD*TO*RETRIEVE*POOL*PORTFOLIOS     S01486
     C****INDICATOR                                                       S01486
     C******************** CALL 'AOPORTR0'                                S01486
     C******************** PARM '*DBERR ' @RTCD   7                       S01486
     C******************** PARM '*FIRST ' @OPTN   7                       S01486
     C********** SDPORT    PARM SDPORT    DSFDY                           S01486
     C*
     C***INITIALISE*FILE*TRAILER*FOR*PMPPTDZZ*************************    S01486
     C***INITIALISE*FILE*TRAILER*FOR*PMPPTDPA*************************    S01486
     C*
     C***********WWPOOL    IFEQ 'Y'                               R3INCO  S01486
     C********** FCPPPR    IFEQ 'Y'                                       S01486
     C*********************MOVE 'Z'       QRRECI                  044387  S01486
     C******************** MOVE 'Z'       ORRECI                  044387  S01486
     C******************** WRITEPMPPTDZ0                                  S01486
     C******************** END                                    R3INCO  S01486
     C*
     C***INITIALISE*FILE*TRAILER*FOR*SDPLCSPD.*TRAILER*ON*SDFCTLPD*****   S01486
     C***********                                                         S01486
     C***********          MOVEL'SDPLCSPD'AHFLNM                          S01486
     C***********          Z-ADD0         AHNORC                          S01486
     C***********          Z-ADD0         AHNOIN                          S01486
     C***********          Z-ADD0         AHNOAM                          S01486
     C***********          Z-ADD0         AHNODL                          S01486
     C***********                                                         S01486
     C***Update*If*A*Record*Already*Exists*On*SDFCTLL0,*Otherwise*Write*ItS01486
     C***********WWFAIL    IFEQ 'Y'                                       S01486
     C***********AHFLNM    CHAIN@AHREAU              10                   S01486
     C***10******          DO                                             S01486
     C***********          MOVEL'03'      DBASE            **DB ERROR 03**S01486
     C***********          MOVEL'SDFCTLL0'DBFILE           ***************S01486
     C***********          MOVEL'SDPLCSPD'DBKEY                           S01486
     C***********          EXSR *PSSR                                     S01486
     C***********          END                                            S01486
     C***********          UPDAT@AHREAU                                   S01486
     C***********          ELSE                                           S01486
     C***********          WRITE@AHREAU                                   S01486
     C***********          END                                            S01486
     C***********                                                         S01486
     C***INITIALIZE*SDPORTPD*******************************************   S01486
     C***********                                                         S01486
     C***********          READ SDPORTPD                 80               S01486
     C************IN80     IFNE '0'                                       S01486
     C***********          MOVEL'PORT'    P9BACD                          S01486
     C***********          MOVE *BLANK    P9LIAB                          S01486
     C***********          MOVE *BLANK    P9HLVS                          S01486
     C***********          MOVE *BLANK    P9TVPS                          S01486
     C***********          MOVE *BLANK    P9DP97                          S01486
     C***********          MOVE *BLANK    P9R997                          S01486
     C***********          MOVE *BLANK    P9DP98                          S01486
     C***********          MOVE *BLANK    P9R998                          S01486
     C***********          MOVE *BLANK    P9N998                          S01486
     C***********          MOVE *BLANK    P9R999                          S01486
     C***********          MOVE *BLANK    P9N999                          S01486
     C***********          MOVE *BLANK    P9ADST                          S01486
     C***********          MOVE *BLANK    P9DINR                          S01486
     C*********************MOVE *BLANK    P9GPPS                          044387
     C***********          MOVE *BLANK    P9LICD                          S01486
     C***********          MOVE *BLANK    P9CNCD                          S01486
     C***********          MOVE *BLANK    P9N997                          S01486
     C***********          Z-ADD0         P9CDYB                          S01486
     C***********          Z-ADD0         P9CDVB                          S01486
     C***********          Z-ADD0         P9AAVA                          S01486
     C***********          WRITESDPORTD0                                  S01486
     C***********          END                                            S01486
     C***DUMMY*UPDATE*ON*SDPORTPD**************************************   S01486
     C***********          MOVE 'Y'       WWDUMM  1                       S01486
     C***********WWDUMM    IFEQ 'N'                                       S01486
     C***********          UPDATSDPORTD0                                  S01486
     C***********          END                                            S01486
     C*                                                                   73957
     C**  Get module details using access object                          73957
     C*                                                                   73957
     C                     CALL 'AOMMODR0'                                73957
     C                     PARM *BLANKS   WLRTCD  7                       73957
     C                     PARM '*FIRST ' WLOPTN  7                       73957
     C           SDMMOD    PARM SDMMOD    DSFDY                           73957
     C*                                                                   73957
     C**  Check if error occurred                                         73957
     C*                                                                   73957
     C           WLRTCD    IFNE *BLANK                                    73957
     C                     Z-ADD5         DBASE            ***************73957
     C                     MOVE 'SDMMODPD'DBFILE           * DB ERROR 05 *73957
     C                     MOVELWLOPTN    DBKEY            ***************73957
     C                     EXSR *PSSR                                     73957
     C                     END                                            73957
     C*                                                                   73957
     C****Set*field*PTFR*to*blanks*in*existing*files,*depending*on**73957 094367
     C****Set*field*PTFR*to*'9997'*in*existing*files,*depending*on**094367S71062
     C**  Set field PTFR to blanks in existing files, depending on        S71062
     C**  modules present                                                 73957
     C*                                                                   73957
     C           BGSECS    IFEQ 'Y'                                       73957
     C*                                                                   73957
     C                     OPEN HSTTRD                 01                 73957
     C                     READ HSTTRD                 0101               73957
     C           *IN01     DOWEQ*OFF                                      73957
     C*********************MOVE *BLANKS   PTFR                      73957 094367
     C***********PTFR      IFEQ *BLANKS                            094367 S71062
     C***********          MOVE '9997'    PTFR                     094367 S71062
     C***********          ENDIF                                   094367 S71062
     C                     MOVE *BLANKS   PTFR                            S71062
     C                     UPDATHSTTRDF                01                 73957
     C                     READ HSTTRD                 0101               73957
     C                     ENDDO                                          73957
     C                     CLOSEHSTTRD                 01                 73957
     C*                                                                   73957
     C                     OPEN BULKTD                 01                 73957
     C                     READ BULKTD                 0101               73957
     C           *IN01     DOWEQ*OFF                                      73957
     C*********************MOVE *BLANKS   PTFR                      73957 094367
     C***********PTFR      IFEQ *BLANKS                            094367 S71062
     C***********          MOVE '9997'    PTFR                     094367 S71062
     C***********          ENDIF                                   094367 S71062
     C                     MOVE *BLANKS   PTFR                            S71062
     C                     UPDATBULKTDF                01                 73957
     C                     READ BULKTD                 0101               73957
     C                     ENDDO                                          73957
     C                     CLOSEBULKTD                 01                 73957
     C*                                                                   73957
     C                     OPEN TRADSD                 01                 73957
     C                     READ TRADSD                 0101               73957
     C           *IN01     DOWEQ*OFF                                      73957
     C*********************MOVE *BLANKS   PTFR                      73957 094367
     C***********PTFR      IFEQ *BLANKS                            094367 S71062
     C***********          MOVE '9997'    PTFR                     094367 S71062
     C***********          ENDIF                                   094367 S71062
     C                     MOVE *BLANKS   PTFR                            S71062
     C                     UPDATTRADSDF                01                 73957
     C                     READ TRADSD                 0101               73957
     C                     ENDDO                                          73957
     C                     CLOSETRADSD                 01                 73957
     C*                                                                   73957
     C                     OPEN DPTMVD                 01                 73957
     C                     READ DPTMVD                 0101               73957
     C           *IN01     DOWEQ*OFF                                      73957
     C*********************MOVE *BLANKS   PTFR                      73957 094367
     C***********PTFR      IFEQ *BLANKS                            094367 S71062
     C***********          MOVE '9997'    PTFR                     094367 S71062
     C***********          ENDIF                                   094367 S71062
     C                     MOVE *BLANKS   PTFR                            S71062
     C                     UPDATDPTMVDF                01                 73957
     C                     READ DPTMVD                 0101               73957
     C                     ENDDO                                          73957
     C                     CLOSEDPTMVD                 01                 73957
     C*                                                                   73957
     C                     OPEN CAPRHD                 01                 73957
     C                     READ CAPRHD                 0101               73957
     C           *IN01     DOWEQ*OFF                                      73957
     C*********************MOVE *BLANKS   PTFR                      73957 094367
     C***********PTFR      IFEQ *BLANKS                            094367 S71062
     C***********          MOVE '9997'    PTFR                     094367 S71062
     C***********          ENDIF                                   094367 S71062
     C                     MOVE *BLANKS   PTFR                            S71062
     C                     UPDATCAPRHDF                01                 73957
     C                     READ CAPRHD                 0101               73957
     C                     ENDDO                                          73957
     C                     CLOSECAPRHD                 01                 73957
     C*                                                                   73957
     C                     OPEN POSETD                 01                 73957
     C                     READ POSETD                 0101               73957
     C           *IN01     DOWEQ*OFF                                      73957
     C*********************MOVE *BLANKS   PTFR                      73957 094367
     C***********PTFR      IFEQ *BLANKS                            094367 S71062
     C***********          MOVE '9997'    PTFR                     094367 S71062
     C***********          ENDIF                                   094367 S71062
     C                     MOVE *BLANKS   PTFR                            S71062
     C                     UPDATPOSETDF                01                 73957
     C                     READ POSETD                 0101               73957
     C                     ENDDO                                          73957
     C                     CLOSEPOSETD                 01                 73957
     C*                                                                   73957
     C                     ENDIF                                          73957
     C*                                                                   73957
     C           BGDLMM    IFEQ 'Y'                                       73957
     C*                                                                   73957
     C                     OPEN FXDEALPP               01                 73957
     C                     READ FXDEALPP               0101               73957
     C           *IN01     DOWEQ*OFF                                      73957
     C*********************MOVE *BLANKS   FHPTFR                    73957 094367
     C*********FHPTFR      IFEQ *BLANKS                            094367 S71062
     C***********          MOVE '9997'    FHPTFR                   094367 S71062
     C***********          ENDIF                                   094367 S71062
     C                     MOVE *BLANKS   FHPTFR                          S71062
     C                     UPDATFXDEALP0               01                 73957
     C                     READ FXDEALPP               0101               73957
     C                     ENDDO                                          73957
     C                     CLOSEFXDEALPP               01                 73957
     C*                                                                   73957
     C                     OPEN MMDELDPP               01                 73957
     C                     READ MMDELDPP               0101               73957
     C           *IN01     DOWEQ*OFF                                      73957
     C*********************MOVE *BLANKS   HKPTFR                    73957 094367
     C*********HKPTFR      IFEQ *BLANKS                            094367 S71062
     C***********          MOVE '9997'    HKPTFR                   094367 S71062
     C***********          ENDIF                                   094367 S71062
     C                     MOVE *BLANKS   HKPTFR                          S71062
     C                     UPDATMMDELDP0               01                 73957
     C                     READ MMDELDPP               0101               73957
     C                     ENDDO                                          73957
     C                     CLOSEMMDELDPP               01                 73957
     C*                                                                   73957
     C                     OPEN DEALSDC                01                 73957
     C                     READ DEALSDC                0101               73957
     C           *IN01     DOWEQ*OFF                                      73957
     C*********************MOVE *BLANKS   PTFR                      73957 094367
     C***********PTFR      IFEQ *BLANKS                            094367 S71062
     C***********          MOVE '9997'    PTFR                     094367 S71062
     C***********          ENDIF                                   094367 S71062
     C                     MOVE *BLANKS   PTFR                            S71062
     C                     UPDATDEALSDCF               01                 73957
     C                     READ DEALSDC                0101               73957
     C                     ENDDO                                          73957
     C                     CLOSEDEALSDC                01                 73957
     C*                                                                   73957
     C                     OPEN DEALSDB                01                 73957
     C                     READ DEALSDB                0101               73957
     C           *IN01     DOWEQ*OFF                                      73957
     C*********************MOVE *BLANKS   PTFR                      73957 094367
     C***********PTFR      IFEQ *BLANKS                            094367 S71062
     C***********          MOVE '9997'    PTFR                     094367 S71062
     C***********          ENDIF                                   094367 S71062
     C                     MOVE *BLANKS   PTFR                            S71062
     C                     UPDATDEALSDBF               01                 73957
     C                     READ DEALSDB                0101               73957
     C                     ENDDO                                          73957
     C                     CLOSEDEALSDB                01                 73957
     C*                                                                   73957
     C                     ENDIF                                          73957
     C*                                                                   73957
     C           BGCSLN    IFEQ 'Y'                                       73957
     C*                                                                   73957
     C                     OPEN CLOANCL                01                 73957
     C                     READ CLOANCL                0101               73957
     C           *IN01     DOWEQ*OFF                                      73957
     C*********************MOVE *BLANKS   PTFR                      73957 094367
     C***********PTFR      IFEQ *BLANKS                            094367 S71062
     C***********          MOVE '9997'    PTFR                     094367 S71062
     C***********          ENDIF                                   094367 S71062
     C                     MOVE *BLANKS   PTFR                            S71062
     C                     UPDATCLOANCLF               01                 73957
     C                     READ CLOANCL                0101               73957
     C                     ENDDO                                          73957
     C                     CLOSECLOANCL                01                 73957
     C*                                                                   73957
     C                     OPEN MCLONCL                01                 73957
     C                     READ MCLONCL                0101               73957
     C           *IN01     DOWEQ*OFF                                      73957
     C*********************MOVE *BLANKS   PTFR                      73957 094367
     C***********PTFR      IFEQ *BLANKS                            094367 S71062
     C***********          MOVE '9997'    PTFR                     094367 S71062
     C***********          ENDIF                                   094367 S71062
     C                     MOVE *BLANKS   PTFR                            S71062
     C                     UPDATMCLONCLF               01                 73957
     C                     READ MCLONCL                0101               73957
     C                     ENDDO                                          73957
     C                     CLOSEMCLONCL                01                 73957
     C*                                                                   73957
     C                     ENDIF                                          73957
     C*                                                                   73957
     C                     READ ACCNTAB                0101               73957
     C           *IN01     DOWEQ*OFF                                      73957
     C*********************MOVE *BLANKS   PTFR                      73957 094367
     C***********PTFR      IFEQ *BLANKS                            094367 S71062
     C***********          MOVE '9997'    PTFR                     094367 S71062
     C***********          ENDIF                                   094367 S71062
     C                     MOVE *BLANKS   PTFR                            S71062
     C                     UPDATACCNTABF               01                 73957
     C                     READ ACCNTAB                0101               73957
     C                     ENDDO                                          73957
     C*                                                                   73957
     C**   TRANSD has no field PTFR. Do not initialise.                   094367
     C*                                                             73957 094367
     C***********BGFDTR****IFEQ 'Y'                                 73957 094367
     C*********************                                         73957 094367
     C*********************OPEN TRANSD                 01           73957 094367
     C*********************READ TRANSD                 0101         73957 094367
     C************IN01*****DOWEQ*OFF                                73957 094367
     C*********************MOVE *BLANKS   PTFR                      73957 094367
     C*********************UPDATTRANSDF                01           73957 094367
     C*********************READ TRANSD                 0101         73957 094367
     C*********************ENDDO                                    73957 094367
     C*********************CLOSETRANSD                 01           73957 094367
     C*********************                                         73957 094367
     C*********************ENDIF                                    73957 094367
     C*                                                                   S71062
     C           BGFUOP    IFEQ 'Y'                                       CPM003
     C/COPY WNCPYSRC,PM0000C003
     C** Access PM ICD for FCPORS, Type of Portfolios supported           CPM003
     C                     CALL 'AOPORTR0'                                CPM003
     C                     PARM *BLANKS   WLRTCD                          CPM003
     C                     PARM '*FIRST ' WLOPTN                          CPM003
     C           SDPORT    PARM SDPORT    DSFDY                           CPM003
     C           WLRTCD    IFNE *BLANK                                    CPM003
     C                     MOVE *BLANKS   DBKEY            ***************CPM003
     C                     Z-ADD6         DBASE            * DB ERROR 06 *CPM003
     C                     MOVE 'SDPORTPD'DBFILE           ***************CPM003
     C                     EXSR *PSSR                                     CPM003
     C                     END                                            CPM003
     C                     END                                            CPM003
     C*                                                                   CPM003
     C           BGFUOP    IFEQ 'Y'                                       S71062
     C           FCPORS    ANDNE'B'                                       CPM003
     C/COPY WNCPYSRC,PM0000C004
     C** If Bank Portfolios are supported, treat as if FF off             CPM003
     C*                                                                   S71062
     C                     OPEN TRANSD                 01                 S71062
     C                     READ TRANSD                 0101               S71062
     C           *IN01     DOWEQ*OFF                                      S71062
     C                     MOVE *BLANKS   PTFR                            S71062
     C                     UPDATTRANSDF                01                 S71062
     C                     READ TRANSD                 0101               S71062
     C                     ENDDO                                          S71062
     C                     CLOSETRANSD                 01                 S71062
     C*                                                                   S71062
     C                     ENDIF                                          S71062
     C/COPY WNCPYSRC,PM0000C005
     C*
     C                     SETON                     LR
     C*********************
     C*****************************************************************
      /EJECT
     C*****************************************************************
     C**
     C**   FILE EXEPTION/ERROR HANDLING SUBROUTINE
     C**
     C*****************************************************************
     C           *PSSR     BEGSR
     C*
     C                     SETON                     U7U8LR
     C**
     C** ROLL BACK CHANGES, PRINT DUMP AND CANCEL PROGRAM
     C**
     C                     ROLBK
     C                     DUMP
     C                     RETRN
     C**
     C                     ENDSR
**  CPY@
(c) Finastra International Limited 2001
**  TEXTA                                                                 CPM005
Focus Group Changes
Related Customer Details
