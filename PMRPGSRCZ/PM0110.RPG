000100200529     H
000200200529      *****************************************************************
000300200529/*OVR *  OVRDBF FILE(PMPORTXX) TOFILE(PMPORTPD) SHARE(*NO)            *   S01486
000400200529/*OVR *  OVRDBF FILE(PMCHRGXX) TOFILE(PMCHRGPD) SHARE(*NO)            *   S01486
000500200529/*STD *  RPGBASE                                                      *
000600200529/*EXI *  TEXT('Midas PM Portfolio definition maintenance')            *
000700200529     F********************************************************************
000800200529     F*                                                                  *
000900200529     F*    Midas PORTFOLIO MANAGEMENT                                    *
001000200529     F*                                                                  *
001100200529     F*    PM0110  - PORTFOLIO DEFINITION MAINTENANCE                    *
001200200529     F*                                                                  *
001300200529      *  (c) Finastra International Limited 2001                      *
001400200529     F*                                                                  *S01486
001500200529     F*                                                                  *
001600200604     F*  Last Amend No. 250228             Date 22May20               *
001700200529      *  Prev Amend No. MD046248           Date 27Oct17               *
001800200529      *                 CLE148             Date 23Jul12               *
001900200529      *                 CLE064             Date 06Dec10               *
002000200529      * Bank Fusion Midas 1.4 Base -----------------------------------*
002100200529      * Midas Plus 1.4 Base 04 ---------------------------------------*
002200200529      * Midas Plus 1.4 Base ------------------------------------------*
002300200529      * Midas Plus 1.3 ----------- Base ------------------------------*
002400200529      *                 CSD031             Date 10Apr06               *
002500200529      *                 CSD027             Date 09Dec05               *
002600200529      *                 CSW037A            Date 02May05               *
002700200529      *                 CSD025             Date 11Jan05               *
002800200529      *                 CSW037             Date 15Dec04               *
002900200529      *                 CSW036             Date 15Dec04               *
003000200529      *                 CLE025             Date 20Oct03               *
003100200529      *                 CGL029             Date 01Sep03               *
003200200529      * Midas Release 4.01 -------------------------------------------*
003300200529      *                 CPK015             Date 01Jul02               *
003400200529      *                 177647             Date 29Aug01               *
003500200529      * Midas Release 4 --------------- Base -------------------------*
003600200529      * Midas DBA 3.03 -----------------------------------------------*
003700200529      * Midas DBA 3.02 -----------------------------------------------*
003800200529      *                 CPB001             Date 07Jul99               *
003900200529      *                 163634             Date 07Jul99                  *
004000200529      *                 146302             Date 29Oct98                  *
004100200529      *                 141883             Date 18Sep98                  *
004200200529      * Midas DBA 3.00 ---------------- Base -------------------------*
004300200529     F*                 120827             Date 06Jul97               *
004400200529     F*                 119507             Date 19JUN97                  *
004500200529     F*                 CAC003             Date 25Feb97                  *
004600200529     F*                 CPM005             Date 03Jul96                  *
004700200529     F*                 103080             Date 08Feb96                  *
004800200529     F*                 CPM003             Date 02May96               *
004900200529     F*                 S71062             DATE 24Nov95               *
005000200529     F*                 CPM004             DATE 08FEB96                  *S01486
005100200529     F*                 085799             DATE 08MAR95                  *S01486
005200200529     F*                 080674             DATE 03JAN95                  *S01486
005300200529     F*                 S01486             DATE 01AUG94                  *S01486
005400200529     F*                 051784      MF     DATE 08MAR93                  *S01486
005500200529     F*                 054002     GB      DATE 16APR93                  *S01486
005600200529     F*                 046909             DATE 10NOV92                  *
005700200529     F*                 046461             DATE 29OCT92                  *
005800200529     F*                 45330              DATE 05OCT92                  *
005900200529     F*                 SA9108     MLD     DATE 24AUG92                  *
006000200529     F*                 S01313             DATE 06MAY92                  *
006100200529     F*                 B9958              DATE 15NOV91                  *
006200200529     F*                 B08275             DATE 21OCT91                  *
006300200529     F*                 B08257             DATE 21OCT91                  *
006400200529     F*                 B8275              DATE 16OCT91                  *
006500200529     F*                 B08255             DATE 07OCT91                  *
006600200529     F*                 B08166             DATE 12AUG91                  *
006700200529     F*                 B07916             DATE 05JUN91                  *
006800200529     F*                 R05914             DATE 30APR91                  *
006900200529     F*                 B5862              DATE 22APR91                  *
007000200529     F*                 R5556              DATE 27FEB91                  *
007100200529     F*                 R5500              DATE 20FEB91                  *
007200200529     F*                 R0974      MDS     DATE 26NOV90                  *
007300200529     F*                 R00954             DATE 14NOV90                  *
007400200529     F*                 S01307             DATE 08OCT90                  *
007500200529     F*                 R10053             DATE 01OCT90                  *
007600200529     F*                 R00367             DATE 21AUG90                  *
007700200529     F*                 R00300             DATE 14AUG90                  *
007800200529     F*                                                                  *
007900200529     F********************************************************************
008000200529     F*                                                                  *
008100200529      *  250228 - Recompile due to field change in PMPSTMQ0.          *
008200200529      *  MD046248 - Finastra Rebranding                               *
008300200529      *  CLE148 - Alpha Loan Reference (Recompile)                    *
008400200529      *  CLE064 - Enhancement of Lending Frequencies (Recompile)      *
008500200529      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
008600200529      *  CSD027 - Conversion Of Customer Number to Alpha              *
008700200529      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
008800200529      *  CSD025 - Customer De-Activation                              *
008900200529      *  CSW037 - Additional Field Data on MT300/MT320                *
009000200529      *  CSW036 - Dual SWIFT BIC held on Client Details               *
009100200529      *  CLE025 - Credit Lines (Recompile)                            *
009200200529      *  CGL029 - Increase Account Code to 10 digits                  *
009300200529      *  CPK015 - Release 4.01 Packaging:                             *
009400200529      *           - A default timestamp string is required for WRITE. *
009500200529      *  177647 - Move DDCGCO to CG array even if DDCGCO is blank.    *
009600200529      *           This is to prevent wrong validation of the          *
009700200529      *           charge currency.                                    *
009800200529     F*  CPB001 -  'Private Banking' Module                           *
009900200529      *  163634 - Doesn't accept a reatil number. Due to wrong fix    *
010000200529      *           085799. Too much coding.                            *
010100200529     F*  146302 - ONLY VALIDATE BANK CHARGING CURRENCY ON INSERT      *
010200200529     F*  141883 - Error with setting up management fee on second      *
010300200529     F*           portfolio.                                          *
010400200529     F*  120827 - Profit Centre Accounting defaulting                 *
010500200529     F*  119507 - PROFIT CENTRE IS NOT DISPLAYED FOR CUSTOMER PORTFOLIO
010600200529     F*  CAC003 - Profit Centre Accounting Development Phase 3.       *
010700200529     F*  CPM005 - Private Banking Phase II                            *
010800200529     F*           Focus Group Changes Upgraded to DBA                 *
010900200529     F*           PBFG/1 - CHANGE PM CUSTOMER BASE CCY & PORTFOLIO CCY*
011000200529     F*           PBFG/3 - DISPLAY UNREALISED P&L ON FORWARD SE TRADES*
011100200529     F*           PBFG/5 - INSTRUMENT ASSET/LIABILITY SPLIT           *
011200200529     F*           PBFG/6 - ADDITIONAL CUSTOMER DETAILS                *
011300200529     F*  103080  -  '?' processing does not copy back selected customer  *
011400200529     F*             hence program crashes looking for customer '?'.      *
011500200529     F*  CPM003 - FF/PM Interface upgrade to Release 10                  *
011600200529     F*  S71062 - FF/PM Portfolio definition maintenance                 *
011700200529     F*           add new field 'FF' margin a/c sequence.                *
011800200529     F*  CPM004  -  Bank Portfolios                                      *S01486
011900200529     F*  085799  -  Branch code must appear on settlement account        *S01486
012000200529     F*  080674  -  Miscellanous errors on Charges checking.             *S01486
012100200529     F*  S01486  -  Portfolio management upgrade to R10                  *S01486
012200200529     F*             Including Fix 73957 & 64239                          *S01486
012300200529     F*  051784  -  WRONG MESSAGE USED WHEN CLOSURE                      *
012400200529     F*  054002  -  WRONG MSG WHEN VALUATION FREQUENCY NOT SPECIFIED     *
012500200529     F*  046909  -  ALLOW PERFORMANCE START DATE TO BE ADJUSTED TO START *
012600200529     F*             OF MONTH IN FUTURE                                   *
012700200529     F*  046461  -  SET UP CHARGE/SETTLEMENT CCY DP CORRECTLY            *
012800200529     F*  45330   -  DATE PORTFOLIO OPENED MAY NOT BE AMENDED             *
012900200529     F*  SA9108  -  POOL SECURITY TRANSACTION                            *
013000200529     F*  S01313  -  PORTFOLIO PERFORMANCE                                *
013100200529     F*  B9958   -  CHANGE MSGID PM90001 WITH PM90005 (ACTION CODE C     *
013200200529     F*             AND NOT D FOR DELETION)                              *
013300200529     F*  B08257  -  PORTFOLIO REFERENCE MAY NOT BE REUSED                *
013400200529     F*  B8275   -  Closure of Customers Portfolios.                     *
013500200529     F*  B08255  -  SPEED UP COB BY SPLITTING TOTALLING FILES            *
013600200529     F*  B08166  -  ON AMENDMENT DO NOT RESET SETTLEMENT DETAILS TO 0    *
013700200529     F*  B07916  -  WHEN CHARGE ADDED LAST ACCRUAL DATE SET TO RUN       *
013800200529     F*             DATE - 1 SO THAT ACCRUALS GENERATED FOR 1 DAY        *
013900200529     F*  R05914  -  WHEN A NEW CHARGE ENTERED LAST ACCRUAL DATE          *
014000200529     F*             SET TO RUN DATE                                      *
014100200529     F*  B5862   -  Remove message PM11403.                              *
014200200529     F*  R5556   -  A PORTFOLIO COULD BE OPENED FOR DELETED CUSTOMER     *
014300200529     F*  R5500   -  Remove the validation 402.                           *
014400200529     F*  R0974   -  FIX R00367 SHOULD NOT TEST BITS 01                   *
014500200529     F*  R00954  -  ACCOUNT VALIDATION INCORRECT                         *
014600200529     F*  S01307  -  CUSTODY FEES ENHANCEMENTS                            *
014700200529     F*  R10053  -  TERMINATE PROGRAM IF F3 TAKEN FROM NOTEPAD           *
014800200529     F*  R00367  -  PM SHOULD NOT BE ABLE TO BOOK AGAINST BLOCKED        *
014900200529     F*             RETAIL ACCOUMTS                                      *
015000200529     F*  R00300  -  Message file changes.                                *
015100200529     F*                                                                  *
015200200529     F********************************************************************
015300200529     F**
015400200529     F** DISPLAY FILE
015500200529     F**
015600200529     F**PM0110DDCF  E                    WORKSTN                          S01486
015700200529     FPM0110DFCF  E                    WORKSTN                            S01486
015800200529     F                                        RRN1  KSFILE PM0110S0
015900200529     F                                        RRN2  KSFILE PM0110S1
016000200529     F**
016100200529     F** INPUT FILES ********************************
016200200529     F**
016300200529     F**TABLETJ IF  E           K        DISK                             S01486
016400200529     F********                                      KINFSR *PSSR          S01486
016500200529     F***RECORD ID BJ                                                     S01486
016600200529     F**SDBANKL1IF  E           K        DISK                             S01486
016700200529     F********                                      KINFSR *PSSR          S01486
016800200529     F***RECORD ID BB AND QB                                              S01486
016900200529     F**SDPLCSL2IF  E           K        DISK                             S01486
017000200529     F**********                                    KINFSR *PSSR          S01486
017100200529     F***RECORD ID BB AND QB                                              S01486
017200200529     F**SDPLCSL3IF  E           K        DISK                             S01486
017300200529     F**********                                    KINFSR *PSSR          S01486
017400200529     F** RECORD ID QB                                                     B08255
017500200529     F**SDPLCSPDUF  E           K        DISK                      B08255 S01486
017600200529     FSDPLCSL1UF  E           K        DISK                               S01486
017700200529     F                                              KINFSR *PSSR          B08255
017800200529     F***RECORD ID A6                                                     S01486
017900200529     F**SDCURRL0IF  E           K        DISK                             S01486
018000200529     F**********                                    KINFSR *PSSR          S01486
018100200529     F***RECORD ID BC                                                     S01313
018200200529     F*SDALTNL1IF**E           K        DISK                              S01313
018300200529     F****                                          KINFSR *PSSR          S01313
018400200529     F* FILE ID 'PE'
018500200529     F**PMPTFTPPIF  E           K        DISK                             S01486
018600200529     FPMPTFTPDIF  E           K        DISK                               S01486
018700200529     F                                              KINFSR *PSSR
018800200529     F** RECORD ID PS
018900200529     F**PMBIPNPPIF  E           K        DISK                             S01486
019000200529     FPMBIPNPDIF  E           K        DISK                               S01486
019100200529     F                                              KINFSR *PSSR
019200200529     FACNUMA  IF  E           K        DISK
019300200529     F                                              KINFSR *PSSR
019400200529     F            ACCNTABF                          KRENAMEACNUMTBF
019500200529     FACCNT   IF  E           K        DISK
019600200529     F                                              KINFSR *PSSR
019700200529     F** FILE ID 'P5'
019800200529     F**PMCGCDPPIF  E           K        DISK                             S01486
019900200529     FPMCGCDPDIF  E           K        DISK                               S01486
020000200529     F                                              KINFSR *PSSR
020100200529     F* FILE ID 'P9'
020200200529     F**SDPORTL0IF  E           K        DISK                             S01486
020300200529     F**********                                    KINFSR *PSSR          S01486
020400200529     F**FILE*ID*'BG'                                                      S01486
020500200529     F**SDMMODL0IF  E           K        DISK                             S01486
020600200529     F**********                                    KINFSR *PSSR          S01486
020700200529     F* FILE ID 'PO'
020800200529     F**PMCHRGPPUF  E           K        DISK         KCOMIT       A      S01486
020900200529     FPMCHRGPDUF  E           K        DISK         KCOMIT       A        S01486
021000200529     F                                              KINFSR *PSSR
021100200529     FPMCHRGXXIF  E           K        DISK
021200200529     F                                              KINFSR *PSSR
021300200529     F            PMCHRGP0                          KRENAMEPMCHRGPX
021400200529     FPMCHRGL1IF  E           K        DISK                               B8275
021500200529     F                                              KINFSR *PSSR          B8275
021600200529     F            PMCHRGP0                          KRENAMEPMCHRGLF       B8275
021700200529     F* FILE ID 'PN'
021800200529     F**PMPORTPPUF  E           K        DISK         KCOMIT       A      S01486
021900200529     FPMPORTPDUF  E           K        DISK         KCOMIT       A        S01486
022000200529     F                                              KINFDS INFDS
022100200529     F                                              KINFSR *PSSR
022200200529     F* FILE ID 'SA'                                                      S01307
022300200529     F***SCICDPPDIF  E                    DISK                     S01307 S01486
022400200529     FSDSCFEPDIF  E                    DISK                               S01486
022500200529     F                                              KINFSR *PSSR          S01307
022600200529     F* FILE ID 'BF'                                                      S01307
022700200529     F**SDSECSL0IF  E           K        DISK                      S01307 S01486
022800200529     F**********                                    KINFSR *PSSR   S01307 S01486
022900200529     F* FILE ID 'SB'                                                      S01307
023000200529     F***SCCFGRPDIF**E           K        DISK                     S01307 S01486
023100200529     FSECFGRPDIF  E           K        DISK                               S01486
023200200529     F                                              KINFSR *PSSR          S01307
023300200529     F* FILE ID 'SD'                                                      S01307
023400200529     F*CSCFAPDIF  E           K        DISK                         S01307B8275
023500200529     F**SCSCFAL2IF  E           K        DISK                       B8275 S01486
023600200529     FSESCFAPDIF  E           K        DISK                               S01486
023700200529     F                                              KINFSR *PSSR          S01307
023800200529     F* FILE ID 'SE'                                                      S01307
023900200529     F*COCFSPDIF  E           K        DISK                         S01307B8275
024000200529     F***SCOCFSL3IF  E           K        DISK                      B8275 S01486
024100200529     FSEOCFSL3IF  E           K        DISK                               S01486
024200200529     F                                              KINFSR *PSSR          S01307
024300200529     FPMPPTDPDIF  E           K        DISK                               SA9108
024400200529     F                                              KINFSR *PSSR          SA9108
024500200529     FPMPPTML1IF  E           K        DISK                               SA9108
024600200529     F                                              KINFSR *PSSR          SA9108
024700200529     F/COPY WNCPYSRC,PM0110F001
024800200529     FPMPSTMQ0IF  E           K        DISK                               CPM005
024900200529     F                                              KINFSR *PSSR          CPM005
025000200529     F** ************************************
025100200529     F** OVERRIDEN FILE PM DEFINITION DETAILS
025200200529     F** ************************************
025300200529     FPMPORTXXIF  E           K        DISK
025400200529     F                                              KINFSR *PSSR
025500200529     F            PMPORTP0                          KRENAMEPMPORTPX
025600200529     F**PMPORTZZUF  E                    DISK         KCOMIT              S01486
025700200529     FPMPORTPAUF  E                    DISK         KCOMIT                S01486
025800200529     F                                              KINFSR *PSSR
025900200529     FPMPOTTPDIF  E           K        DISK         KINFSR *PSSR      UC  CPM004
026000200529     F*                                                                   CPM004
026100200529     F*****************************************************************
026200200529     F**    F U N C T I O N   O F    I N D I C A T O R S
026300200529     F*****************************************************************
026400200529     F**
026500200529     F**  KA   -   ACCESS TO PORTFOLIO DEFINITION DETAILS
026600200529     F**       -   ACCESS TO PORTFOLIO CHARGES DETAILS
026700200529     F**  KC   -   EXIT PROGRAM
026800200529     F**  KL   -   EXIT PROCESS -  START SCREEN
026900200529     F**  KY   -   ACCES TO NOTEPAD
027000200529     F**  LR   -   END OF PROGRAM
027100200529     F**  U7   -   DATA BASE ERROR
027200200529     F**  U8   -   PROGRAM RUN ERROR
027300200529     F**
027400200529     F**  07   -   FIELD FF MARGIN A/C SEQ. IN ERROR                      S71062
027500200529     F**  08   -   Chain failure in PMPOTTPD                              CPM004
027600200529     F**  10   -   START SCREEN PROCEDURE
027700200529     F**  11   -   REVIEW SCREEN PROCEDURE
027800200529     F**  12   -   UPDATE PROCEDURE
027900200529     F**  13   -   CHAIN IN FILE PF/PMPPTDPD                              SA9108
028000200529     F**  14   -   CHAIN IN FILE PF/PMPPTMPD                              SA9108
028100200529     F**  15   -   INSTRUMENT SUMMARY SECTION IN ERROR                    CPM005
028200200529     F**  20   -   FF MODULE ON -> DISPLAY FIELD FF MARG. A/C SEQ.        S71062
028300200529     F**  21   -   ROLLUP
028400200529     F**  22   -   ROLLDOWN
028500200529     F**  24   -   PROTECT DATE PORTFOLIO OPENED IN AMEND MODE
028600200529     F**  25   -   PROTECT MODE PM0110F1
028700200529     F**  26-29-   ERROR INDICATORS PM0110F1
028800200529     F**  30   -   ERROR INDICATOR PM0110C0
028900200529     F**  31   -   PROTECT MODE PM0110F2
029000200529     F**  31   -   PROTECT MODE PM0110C1
029100200529     F**  56   -   PROTECT MODE PM0110F2
029200200529     F**  58   -   PROTECT MODE PM0110F2
029300200529     F**  32-55-   ERROR INDICATORS PM0110F2
029400200529     F**  32-45-   ERROR INDICATORS PM0110C1
029500200529     F**  56-59-   PROTECT MODE PM0110F2
029600200529     F**  60   -   ANY VALID COMMAND KEY
029700200529     F**  61   -   SUBFILE DISPLAY PM0110C0
029800200529     F**  62   -   SUBFILE DISPLAY PM0110C0
029900200529     F**  63   -   SUBFILE END PM0110C0
030000200529     F**  64   -   ROLLDOWN NOT ALLOWED
030100200529     F**  69   -   ERROR INDICATOR PM0110F2 - CUSTODY GROUP CODE          S01307
030200200529     F**  70   -   FEE GROUP ALLOWED ON PORTFOLIO                         S01307
030300200529     F**  71-73-   FILE PROCESSING
030400200529     F**  75-77-   FILE PROCESSING
030500200529     F**  78   -   CURRENCY SUMMARY SECTION IN ERROR                      CPM005
030600200529     F**  79   -   FILE PROCESSING
030700200529     F**  81-89-   WORK INDICATORS
030800200529     F**  90-99-   STANDARD SUBROUTINES INDICATORS
030900200529     F**
031000200529     F******************************************************************
031100200529     E**
031200200529     E** ARRAY FOR ZDATE SUBROUTINE
031300200529      /COPY ZSRSRC,ZDATE2Z1
031400200529     E** ARRAY FOR ZFRQA SUBROUTINE
031500200529      /COPY ZSRSRC,ZFRQAZ1
031600200529     E** ALPHANUMERIC ARRAY
031700200529     E                    NUMA   36  36  1
031800200529     E**
031900200529     E** WORK ARRAY
032000200529     E                    RFNC        4  1               PORTFOLIO REFERENCE
032100200529     E**
032200200529     E                    DDAD        5  1               ALTERNATE ADDRESS
032300200529     E                    AD          5  1               ALTERNATE ADDRESS
032400200529     E                    CG         10  2               CHARGE CODES
032500200529     E** ARRAY FOR ZEDIT
032600200529      /COPY ZSRSRC,ZEDITZ1
032700200529      /COPY ZSRSRC,ZHOLE                                                  S01486
032800200529     E                    STAMP   1   1 26                                                    CPK015
032900200529      ** Array containing dummy timestamp                                                     CPK015
033000200529     E                    CPY@    1   1 80                                S01486
033100200529     I*********************************************************************
033200200529     I**
033300200529     ISCRCTL      DS
033400200529     I                                        1   1 WWREVW
033500200529     I                                        2   2 DDACTN
033600200529     I                                        3   8 DDPNP8
033700200529     I                                        9  14 WWCUS1
033800200529     I                                       15  20 WWCUS2
033900200529     I                                       21  24 DDPORT
034000200529     I                                       25  28 DDPREF
034100200529     I                                       29  32 WWPAG1
034200200529     I                                       33  36 WWPAG2
034300200529     I                                       37  46 DDCSNM
034400200529     I                                       47  62 DDDELT
034500200529     I*
034600200529     I*
034700200529     I** DATA STRUCTURE FOR RPG 01021 ERROR HANDLING
034800200529     I*
034900200529     IINFDS       DS
035000200529     I                                     *STATUS  STATUS
035100200529     I*
035200200529     I** LOCAL DATA AREA FOR DATABASE ERROR DETAILS
035300200529     I*
035400200529     ILDA         DS                            256
035500200529     I************                          132 141 WWFILE                S01486
035600200529     I************                          142 170 WWKEY                 S01486
035700200529     I************                          171 180 WWPGM                 S01486
035800200529     I************                          181 1830WWASE                 S01486
035900200529     I                                      134 141 DBFILE                S01486
036000200529     I                                      142 170 DBKEY                 S01486
036100200529     I                                      171 180 DBPGM                 S01486
036200200529     I                                      181 1830DBASE                 S01486
036300200529     I*
036400200529     I*    MIDAS 'Next Available Transaction No.' Data Area  MNATN .
036500200529     IDNATN       DS                              5
036600200529     I                                        1   50FNATN
036700200529     I*
036800200529     I** DATA STRUCTURE FOR SETUP OF COMMIT TEXT
036900200529     I*
037000200529     ICMTTXT      DS
037100200529     I                                        1   50NATN
037200200529     I                                        6   7 MDID
037300200529     I                                        8  15 PGMN
037400200529     I                                       16  18 WSIDX
037500200529     I                                       19  240MTIME
037600200529     I                                       25  25 ACTNX
037700200529     I                                       26  35 USIDX
037800200529     I*
037900200529     I** PROGRAM STATUS DATA STRUCTURE FOR WS/USER ID'S
038000200529     I*
038100200529     IPSDS       SDS
038200200529     I                                      247 249 WSID
038300200529     I                                      244 253 WSIDN
038400200529     I                                      254 263 USID
038500200529     I**
038600200529     I** DATA STRUCTURE FOR LAST UPDATE
038700200529     I**
038800200529     I            DS
038900200529     I                                        1   20WWDLUP
039000200529     I                                        3   5 WWMLUP
039100200529     I                                        6   70WWYLUP
039200200529     I                                        1   7 WWHLUP
039300200529     I**
039400200529     I** DATA STRUCTURE FOR CUSTOMER NUMBER
039500200529     I**
039600200529     I            DS
039700200529     I                                        1  10 WWCNUM
039800200529     I                                        1   6 WWCNM1
039900200529     I                                        7  10 WWCNM2
040000200529     I**
040100200529     I** DATA STRUCTURE FOR CUSTOMER ACCOUNT
040200200529     I**
040300200529     I            DS
040400200529     I**********                              1  12 WWCUSA                                    CGL029
040500200529     I                                        1  18 WWCUSA                                    CGL029
040600200529     I**********                              1   60WWCLAS                                    CSD027
040700200529     I                                        1   6 WWCLAS                                    CSD027
040800200529     I**********                              7  100WWACOD                                    CGL029
040900200529     I**********                             11  120WWACSQ                                    CGL029
041000200529     I                                        7  160WWACOD                                    CGL029
041100200529     I                                       17  180WWACSQ                                    CGL029
041200200529     I                                        1  100WWCSA1
041300200529     I                                       11  12 WWCSA2
041400200529     I**
041500200529     I** DATA STRUCTURE FOR WORK FIELDS
041600200529     I**
041700200529     I            DS
041800200529     I                                        1  140WWCGSP
041900200529     I                                       15  280WWPCL1
042000200529     I                                       29  420WWPCL2
042100200529     I                                       43  560WWPCL3
042200200529     I                                       57  700WWPCL4
042300200529     I                                       71  840WWPCL5
042400200529     I                                       85  980WWPCL6
042500200529     I                                       99 1120WWPCL7
042600200529     I                                      113 1260WWPCL8
042700200529     I                                      127 1400WWPCL9
042800200529     I                                      141 1540WWPC10
042900200529     I                                      155 1680WWPC11
043000200529     I                                      169 1820WWPC12
043100200529     I                                      183 1960WWPC13
043200200529     I                                      197 2100WWPC14
043300200529     I                                      211 2240WWPC15
043400200529     I**                                                                  S01313
043500200529     I** DATA STRUCTURE FOR RETRIEVAL OF FIRST DAY IN NEXT MONTH          S01313
043600200529     I**                                                                  S01313
043700200529     I            DS                                                      S01313
043800200529     I                                        1   60W1PSDT                S01313
043900200529     I                                        1   20W1DAY                 S01313
044000200529     I                                        3   40W1MTH                 S01313
044100200529     I                                        5   60W1YEAR                S01313
044200200529     I*                                                                   CPM004
044300200529     I** Portfolio Data Structure                                         CPM004
044400200529     I*                                                                   CPM004
044500200529     IWWPORT      DS                                                      CPM004
044600200529     I**********                              1   60WWPNP8                             CPM004 CSD027
044700200529     I                                        1   6 WWPNP8                                    CSD027
044800200529     I                                        7  10 WWPREF                CPM004
044900200529     I**                                                                  S01486
045000200529     ISDBANK    E DSSDBANKPD                                              S01486
045100200529     I** EXTERNAL DS FOR BANK DETAILS                                     S01486
045200200529     ISDSECS    E DSSDSECSPD                                              S01486
045300200529     I** EXTERNAL DS FOR SECURITIES DETAILS                               S01486
045400200529     ISDCURR    E DSSDCURRPD                                              S01486
045500200529     I** EXTERNAL DS FOR CURRENCY DETAILS                                 S01486
045600200529     ISDPORT    E DSSDPORTPD                                              S01486
045700200529     I** EXTERNAL DS FOR PORTFOLIO DETAILS                                S01486
045800200529     ISDMMOD    E DSSDMMODPD                                              S01486
045900200529     I** EXTERNAL DS FOR MODULES                                          S01486
046000200529     ISDPLCS    E DSSDPLCSPD                                              S01486
046100200529     I*>>>> PROFIT CENTRE PROCESSING  ** I SPECS BEGIN                    S01486
046200200529     ISDACOF    E DSSDACOFPD                                              S01486
046300200529     I** EXTERNAL DS FOR ACCOUNT OFFICER DETAILS                          S01486
046400200529     ISDPRFC    E DSSDPRFCPD                                              S01486
046500200529     I** EXTERNAL DS FOR PROFIT CENTRE   DETAILS                          S01486
046600200529     ISDCUST    E DSSDCUSTPD                                              S01486
046700200529     I** EXTERNAL DS FOR CUSTOMER DETAILS                                 S01486
046800200529     I*<<<< PROFIT CENTRE PROCESSING  ** I SPECS END                      S01486
046900200529     ISDGELR    E DSSDGELRPD                                              S01486
047000200529     I              QQACCD                          QQACD1                                    CGL029
047100200529     I** EXTERNAL DS FOR GENERAL LEDGER ICD                               S01486
047200200529     ISCSARD    E DSSCSARDPD                                              S01486
047300200529     I** EXTERNAL DS FOR SAR'S FILE                                       S01486
047400200529     I***/COPY ZSRSRC,ZAOZ1                                               S01486
047500200529     I***/COPY ZSRSRC,ZAOZ2                                               S01486
047600200529     IDSFDY     E DSDSFDY                                                 S01486
047700200529     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01486
047800200529     IDSSDY     E DSDSSDY                                                 S01486
047900200529     I* FIRST DS FOR ACCESS PROGRAMS, LONG  DATA STRUCTURE                S01486
048000200529     IDSLDY     E DSDSLDY                                                 CPB001
048100200529     I* THIRD DS FOR ACCESS PROGRAMS, VERY LONG  DATA STRUCTURE           CPB001
048200200529     IRUNDT       DS                                                      S01486
048300200529      **  DATA AREA RUNDAT                                                S01486
048400200529     I                                        1   7 RUNA                  S01486
048500200529     I                                    P   8  100RUND                  S01486
048600200529     I                                       11  11 SSF                   S01486
048700200529     I                                       12  12 DATF                  S01486
048800200529     I                                       13  13 MBIN                  S01486
048900200529     IZMUSER      DS                             17                       S01486
049000200529     I** DATA AREA OF MENU USER                                           S01486
049100200529     I                                       11  13 USRBCH                S01486
049200200529      /COPY ZSRSRC,ZHOLI                                                  S01486
049300200529     I**
049400200529     I/COPY WNCPYSRC,PM0110I001
049500200529     I**
049600200529     C**************************************************************************
049700200529      /EJECT
049800200529      **************************************************************************
049900200529      *                                                                        *
050000200529      * INDEX OF SUBROUTINES                                                   *
050100200529      * MAIN     - MAIN PROCESSING                                             *
050200200529      * #P1001   - TO INITIALIZE FIELDS AND ACCESS STANDING DATA               *
050300200529      * #CLOF    - TO PROCESS CLOSE OF FILES IN LOWER LEVEL PROGRAMS           *
050400200529      * #P1002   - START - TO OUTPUT AND PROCESS KEY FIELDS SCREEN             *
050500200529      * #P1003   - TO PROCESS SUBFILE SELECTION SCREEN                         *
050600200529      * #ZBAA    - TO MOVE THE APPROPRIATE VALUE IN WWAID                      *
050700200529      * #ZBAB    - TO VALIDATE KEY FIELDS FROM START SCREEN                    *
050800200529      * #ZBAC    - TO VALIDATE KEY FIELDS FROM REVIEW SCREEN                   *
050900200529      * #CUST    - TO VALIDATE CUSTOMER NUMBER/SHORTNAME                       *
051000200529      * #P1004   - TO PROCESS DETAIL SCREEN AND UPDATE FILES                   *
051100200529      * #READ    - TO FILL SUBFILE - PORTFOLIO CHARGES                         *
051200200529      * #ZED     - TO COMPUTE DECIMAL NUMBER AND ACCESS ZEDIT SR               *
051300200529      * #TRANS   - TO ACCESS FILE AND FILL DISPLAY FIELDS                      *
051400200529      * #V1004   - TO VALIDATE PORTFOLIO DEFINITION DETAILS                    *
051500200529      * #V1005   - TO VALIDATE DATE PORTFOLIO CLOSED                           *
051600200529      * #P1005   - TO PROCESS PORTFOLIO CHARGE DETAILS                         *
051700200529      * #P1006   - TO PROCESS INVESTMENT POLICY INDICATORS(AMEND)              *
051800200529      * #P1007   - TO PROCESS INVESTMENT POLICY INDICATORS(ENQUIRY)            *
051900200529      * #P1008   - TO UPDATE PORTFOLIO DEFINITION FILE                         *
052000200529      * #P1009   - TO UPDATE PORTFOLIO CHARGES DETAILS FILE                    *
052100200529      * #P1010   - TO UPDATE PORTFOLIO DEFINITION AUDIT                        *
052200200529      * #Z1009   - TO TRANSFER SCREEN FIELDS TO FILE                           *
052300200529      * #V1006   - TO VALIDATE PORTFOLIO CHARGES DETAILS                       *
052400200529      * #CBB     - TO PROCESS UPDATE BY ANOTHER WORKSTATION                    *
052500200529      * *PSSR    - TO PROCESS ABNORMAL END OF PROGRAM                          *
052600200529      * ZDATE1   - TO COMPUTE DATE IN DAY NUMBER                               *
052700200529      * ZDATE2   - TO COMPUTE DAY NUMBER IN DATE                               *
052800200529      * ZEDIT    - TO OUTPUT NUMERIC FIELDS IN ALPHA                           *
052900200529      * ZALIGN   - SR/ TO RIGHT ALIGN NUMERIC FIELDS                           *
053000200529      * ZFRQA    - TO INCREMENT A DAY NUMBER DATE BY A VALUE                   *
053100200529      * ZTNLU1   - TO LOCK AND ACCESS DATA AREA AND GET TRANSAC. NBR           *
053200200529      * ZASNMS   - SENDS MESSAGE TO PROGRAM MESSAGE QUEUE.                     *
053300200529      *                                                                        *
053400200529      * EXTERNAL ROUTINES CALLED                                               *
053500200529      * PM0600   - NOTEPAD                                                     *
053600200529      * PM0170   - INSTRUMENT INVESTMENT POLICY                                *
053700200529      * PM0180   - CURRENCY INVESTMENT POLICY                                  *
053800200529      * PM0190   - COUNTRY OF RISK INVESTMENT POLICY                           *
053900200529      * PM0200   - INDUSTRY INVESTMENT POLICY                                  *
054000200529      *******ZA0250   - TO CLEAR MESSAGE                                  R00300
054100200529      *******ZA0240   - TO ACCESS MESSAGE FILE AND SEND MESSAGE           R00300
054200200529      * Y2CLMSC  - CLEAR MESSAGE QUEUE                                    R00300
054300200529      * Y2SNMGC  - WRITE ERROR MESSAGES (VIA ZASNMS)                      R00300
054400200529      *                                                                        *
054500200529      **************************************************************************
054600200529      *                                                                        *
054700200529      *  VALIDATION SUBROUTINES #V1004 AND #V1006 ARE QUITE LONG               *
054800200529      *  TO MAKE RESEARCH EASIER INTO THESE SUBROUTINES                        *
054900200529      *  PRECEED THE FIELD YOU ARE SEARCHING FOR BY 'VAL4' OR 'VAL6' FOR       *
055000200529      *  RESPECTIVELY #V1004 AND #V1006.                                       *
055100200529      *                                                                        *
055200200529      *  FOR EXAMPLE IF YOU WANT TO ENQUIRE THE VALIDATION OF THE DATE         *
055300200529      *  PORTFOLIO OPENED IN #V1004, TYPE VAL4DDDPOP AND PRESS CMD/16          *
055400200529      *                                                                        *
055500200529      *  OR TYPE VAL4 AND PRESS CMD/16 TO ENQUIRE SEQUENTIALLY                 *
055600200529      **************************************************************************
055700200529     C*================================================================
055800200529     C** PARAMETERS LIST
055900200529     C**
056000200529     C           LIST1     PLIST
056100200529     C                     PARM           WWRTRN  1
056200200529     C                     PARM           WWCCNM  6
056300200529     C                     PARM           WWPTFR  4
056400200529     C**
056500200529     C           LIST2     PLIST
056600200529     C                     PARM           WWACTO  1
056700200529     C                     PARM           WWRTRN
056800200529     C                     PARM           WWPOLI  1
056900200529     C                     PARM           WWCCNM
057000200529     C                     PARM           WWPTFR
057100200529     C                     PARM           WWNEWT
057200200529     C                     PARM           DDPTFN
057300200529     C** KEY LIST
057400200529     C**
057500200529     C***********SDALT     KLIST                                          S01486
057600200529     C***********          KFLD           WWCCNM                          S01486
057700200529     C***********          KFLD           WWALTN  1                       S01486
057800200529     C**
057900200529     C           PMPORK    KLIST
058000200529     C**********           KFLD           WWPNP8  60                                          CSD027
058100200529     C                     KFLD           WWPNP8  6                                           CSD027
058200200529     C                     KFLD           WWPREF  4
058300200529     C**
058400200529     C           PMCHRK    KLIST
058500200529     C                     KFLD           WWPNP8
058600200529     C                     KFLD           WWPREF
058700200529     C                     KFLD           WWCGSQ  20
058800200529     C**
058900200529     C           PMACCN    KLIST
059000200529     C                     KFLD           WWCLAS
059100200529     C                     KFLD           WWCUCY  3
059200200529     C                     KFLD           WWACOD
059300200529     C                     KFLD           WWACSQ
059400200529     C                     KFLD           WWBRCA  3                       085799
059500200529     C**
059600200529     C           PMCODE    KLIST
059700200529     C                     KFLD           DDBCGY
059800200529     C                     KFLD           DDCGCO
059900200529     C**                                                                  SA9108
060000200529     C           PM1KEY    KLIST                                          SA9108
060100200529     C                     KFLD           WWCUST                          SA9108
060200200529     C                     KFLD           WWPREF                          SA9108
060300200529     C           PMPRKB    KLIST                                          S01486
060400200529     C                     KFLD           WWBRCA  3                       S01486
060500200529     C**********           KFLD           WWPNP8  60                                   S01486 CSD027
060600200529     C                     KFLD           WWPNP8  6                                           CSD027
060700200529     C                     KFLD           WWPREF  4                       S01486
060800200529     C**                                                                  CPM005
060900200529     C           PERFOK    KLIST                                          CPM005
061000200529     C                     KFLD           PNCNUM                          CPM005
061100200529     C                     KFLD           PNPTFR                          CPM005
061200200529     C                     KFLD           KFMTH   2                       CPM005
061300200529     C**                                                                  CPM005
061400200529     C*****************************************************************
061500200529     C**    P R O G R A M   S T A R T
061600200529     C*****************************************************************
061700200529     C*
061800200529     C** PERFORM SETUP OF STANDARD FIELDS
061900200529     C*
062000200529     C                     EXSR #P1001
062100200529     C*
062200200529     C** D O    U N T I L   C K 3   O R   E R R O R
062300200529     C*
062400200529     C           WWAID     DOUEQ'03'
062500200529     C*
062600200529     C           *IN10     CASEQ'1'       #P1002
062700200529     C*
062800200529     C           *IN11     CASEQ'1'       #P1003
062900200529     C*
063000200529     C           *IN12     CASEQ'1'       #P1004
063100200529     C*
063200200529     C                     END
063300200529     C*
063400200529     C                     END
063500200529     C**
063600200529     C** CLOSE ALL FILES IN LOWER LEVEL PROGRAM
063700200529     C**
063800200529     C                     EXSR #CLOF
063900200529     C*
064000200529     C** TERMINATE PROGRAM
064100200529     C*
064200200529     C                     MOVE '1'       *INLR
064300200529     C*================================================================
064400200529     C*  P R O G R A M     E N D
064500200529     C*================================================================
064600200529     C*
064700200529     C**************************************************************************
064800200529      /EJECT
064900200529      **************************************************************************
065000200529      *                                                                        *
065100200529      * #P1001   - TO INITIALIZE FIELDS AND ACCESS STANDING DATA               *
065200200529      *                                                                        *
065300200529      * SUBROUTINE CALLS:                                                      *
065400200529      * *PSSR    - TO PROCESS ABNORMAL END OF PROGRAM                          *
065500200529      *                                                                        *
065600200529      * SUBROUTINE CALLED FROM:                                                *
065700200529      * MAIN     - MAIN PROCESSING                                             *
065800200529      *                                                                        *
065900200529      **************************************************************************
066000200529     C           #P1001    BEGSR                           **#P1001 BSR **
066100200529     C*
066200200529      ***  Copyright Statement.                                           S01486
066300200529     C                     MOVEACPY@      CPY2@  80
066400200529     C**                                                                  S01486
066500200529     C           *NAMVAR   DEFN RUNDAT    RUNDT                           S01486
066600200529     C                     IN   RUNDT                                     S01486
066700200529     C           *NAMVAR   DEFN           ZMUSER                          S01486
066800200529     C                     IN   ZMUSER                                    S01486
066900200529     C           *NAMVAR   DEFN           LDA                             S01486
067000200529     C**                                                                  S01486
067100200529     C                     MOVEL'*'       DDPGMQ
067200200529     C*                                                                   R00300
067300200529     C**   Select the program MSGQ for error msg.                         R00300
067400200529     C                     MOVEL'*'       TOPQ   10                       R00300
067500200529     C                     MOVEL'*PRV'    TOPRQ   5                       R00300
067600200529     C*                                                                   R00300
067700200529     C**   Fill in fields for subroutine ZASNMS                           R00300
067800200529     C                     MOVEL*BLANK    ZAPGM  10        Message queue  R00300
067900200529     C                     MOVEL'PMUSRMSG'ZAMSGF 10        Message file   R00300
068000200529     C                     MOVEL*BLANK    ZAPGRL  5        Rel queue      R00300
068100200529     C                     MOVEL*BLANK    ZAMSID  7        Message Id.    R00300
068200200529     C                     MOVEL*BLANK    ZAMSDA132        Message data.  R00300
068300200529     C                     MOVEL*BLANK    ZAMSTP  7        Message type.  R00300
068400200529     C*                                                                   R00300
068500200529     C** INITIALIZE WORK FIELDS
068600200529     C**
068700200529     C                     Z-ADD0         WW      30
068800200529     C                     Z-ADD0         XX      30
068900200529     C                     Z-ADD0         WWVLDM  20
069000200529     C                     Z-ADD0         WWPTCY  10
069100200529     C                     Z-ADD0         WWCSCY  10
069200200529     C                     Z-ADD0         X       30
069300200529     C                     Z-ADD0         WWSAVX  30
069400200529     C                     Z-ADD0         APDA    50
069500200529     C                     Z-ADD0         WWSAVE  50
069600200529     C                     Z-ADD0         WWTNLU  50
069700200529     C                     Z-ADD0         WWTNLB  50
069800200529     C                     Z-ADD0         WWDPOP  50
069900200529     C                     Z-ADD0         WWPDGS  50
070000200529     C                     Z-ADD0         WWPDGF  50
070100200529     C                     Z-ADD0         WWVLND  50
070200200529     C                     Z-ADD0         WWDPCL  50
070300200529     C                     Z-ADD0         RRN2    40
070400200529     C                     Z-ADD0         WWCOUN  50
070500200529     C                     Z-ADD0         ZDATE   60
070600200529     C                     Z-ADD0         WWDAT1  60
070700200529     C                     Z-ADD0         WWCSA  100
070800200529     C                     Z-ADD0         WWCGSP
070900200529     C                     MOVE *BLANKS   WWACTN  1
071000200529     C                     MOVE *BLANKS   WWWORK 10
071100200529     C                     MOVE *BLANKS   WWVVDM  2
071200200529     C                     MOVE *BLANKS   WWCGCO  2
071300200529     C                     MOVE *BLANKS   WWDAT2  6
071400200529     C                     MOVEL'PM0110'  DBPGM  10
071500200529     C*
071600200529     C** PREPARE COMIT TEXT
071700200529     C*
071800200529     C                     MOVEL'PM'      MDID
071900200529     C                     MOVEL'PM0110'  PGMN
072000200529     C                     MOVELWSID      WSIDX
072100200529     C                     MOVELUSID      USIDX
072200200529     C**
072300200529     C**
072400200529     C**  SET UP PARAMETER TO RETRIEVE MESSAGE FROM MESSAGE FILE
072500200529     C           PLLANG    PLIST
072600200529     C                     PARM           MSMBR4  7
072700200529     C                     PARM           MSGER  10
072800200529     C                     PARM           MSGTXT 80
072900200529     C***********          MOVEL'MLGBMSGF'MSGER                           S01486
073000200529     C                     MOVEL'PMUSRMSG'MSGER                           S01486
073100200529     C*
073200200529     C** GET INSTALLATION CONTROL DATA RECORD 1
073300200529     C*
073400200529     C***********          READ SDBANKL1                 71               S01486
073500200529     C************IN71     IFEQ '1'                        ***************S01486
073600200529     C                     CALL 'AOBANKR0'                                S01486
073700200529     C                     PARM *BLANKS   WWRTCD  7                       S01486
073800200529     C                     PARM '*FIRST ' WWOPTN  7                       S01486
073900200529     C           SDBANK    PARM SDBANK    DSFDY                           S01486
074000200529     C           WWRTCD    IFNE *BLANKS                                   S01486
074100200529     C           *LOCK     IN   LDA                                       S01486
074200200529     C***********          Z-ADD1         DBASE   30       **DB ERROR 01**S01486
074300200529     C***********          MOVEL'SDBANKL1'DBFILE 10        ***************S01486
074400200529     C***********          MOVE *BLANKS   DBKEY  29                       S01486
074500200529     C                     Z-ADD1         DBASE            **DB ERROR 01**S01486
074600200529     C                     MOVE 'SDBANKPD'DBFILE           ***************S01486
074700200529     C                     MOVE *BLANKS   DBKEY                           S01486
074800200529     C                     OUT  LDA                                       S01486
074900200529     C                     EXSR *PSSR
075000200529     C                     END
075100200529     C*  PROFIT CENTRE PROCESSING                                         S01486
075200200529     C** GET DETAILS                                                      S01486
075300200529     C*                                                                   S01486
075400200529     C**********           CALL 'AOGELRR0'                                S01486              CGL029
075500200529     C                     CALL 'AOGELRR1'                                                    CGL029
075600200529     C                     PARM *BLANKS   WWRTCD  7                       S01486
075700200529     C                     PARM '*FIRST ' WWOPTN  7                       S01486
075800200529     C********** SDGELR    PARM SDGELR    DSFDY                           S01486              CGL029
075900200529     C           SDGELR    PARM SDGELR    DSSDY                                               CGL029
076000200529     C           WWRTCD    IFNE *BLANKS                                   S01486
076100200529     C           *LOCK     IN   LDA                                       S01486
076200200529     C*                                                    ***************S01486
076300200529     C                     Z-ADD3         DBASE            **DB ERROR 03**S01486
076400200529     C                     MOVE 'SDGELRPD'DBFILE           ***************S01486
076500200529     C                     OUT  LDA                                       S01486
076600200529     C                     EXSR *PSSR                                     S01486
076700200529     C                     END                                            S01486
076800200529     C*                                                                   S01486
076900200529     C** ACCESS SAR FILE TO CHECK SAFE CUSTODEE FEES                      S01486
077000200529     C*                                                                   S01486
077100200529     C                     MOVEL'S01464'  WWSARD  6                       S01486
077200200529     C                     CALL 'AOSARDR0'                                S01486
077300200529     C                     PARM *BLANKS   WWRTCD                          S01486
077400200529     C                     PARM '*VERIFY 'WWOPTN                          S01486
077500200529     C                     PARM           WWSARD                          S01486
077600200529     C           SCSARD    PARM SCSARD    DSFDY                           S01486
077700200529     C           WWRTCD    IFEQ *BLANKS                                   S01486
077800200529     C                     MOVEL'Y'       WWSFEE  1                       S01486
077900200529     C                     ELSE                                           S01486
078000200529     C                     MOVEL'N'       WWSFEE                          S01486
078100200529     C                     END                                            S01486
078200200529     C*                                                                   S01313
078300200529     C** CONVERT RUN DATE TO DAY NUMBER AND CALCULATE START OF MONTH      S01313
078400200529     C                     Z-ADDBJRDNB    ZDAYNO                          S01313
078500200529     C                     EXSR ZDATE2                                    S01313
078600200529     C*                                                                   CPM005
078700200529     C                     Z-ADDZYEAR     WYEAR   20                      CPM005
078800200529     C*                                                                   S01313
078900200529     C                     MOVELZDATE     WWORK4  4                       S01313
079000200529     C                     MOVELWWORK4    W1DAY                           S01313
079100200529     C                     MOVE WWORK4    W1MTH                           S01313
079200200529     C                     MOVE ZDATE     W1YEAR                          S01313
079300200529     C                     MOVELW1YEAR    W1MTHY  40                      S01313
079400200529     C                     MOVE W1MTH     W1MTHY                          S01313
079500200529     C*                                                                   S01313
079600200529     C** CALCULATE FIRST DAY OF CURRENT MONTH AND CONVERT INTO RUN DAY    S01313
079700200529     C** NUMBER FOR LATER USE                                             S01313
079800200529     C                     Z-ADD1         W1DAY                           S01313
079900200529     C                     MOVE W1PSDT    ZDATE                           S01313
080000200529     C                     EXSR ZDATE1                                    S01313
080100200529     C                     Z-ADDZDAYNO    WWSTRM  50                      S01313
080200200529     C*                                                                   S01313
080300200529     C** CALCULATE FIRST DAY OF NEXT MONTH AND CONVERT INTO RUN DAY       S01313
080400200529     C** NUMBER FOR LATER USE                                             S01313
080500200529     C           1         ADD  ZMTH      W1MTH                           S01313
080600200529     C           W1MTH     IFEQ 13                                        S01313
080700200529     C                     Z-ADD1         W1MTH                           S01313
080800200529     C**********           ADD  1         ZYEAR                     S01313CPM005
080900200529     C                     ADD  1         WYEAR                           CPM005
081000200529     C                     END                                            S01313
081100200529     C**********           Z-ADDZYEAR     W1YEAR                    S01313CPM005
081200200529     C                     Z-ADDWYEAR     W1YEAR                          CPM005
081300200529     C                     MOVE W1PSDT    ZDATE                           S01313
081400200529     C                     EXSR ZDATE1                                    S01313
081500200529     C                     Z-ADDZDAYNO    WZPSDT  50                      S01313
081600200529      *                                                                   CPM005
081700200529      **  CALCULATE LAST DAY OF CURRENT MONTH AND CONVERT INTO RUN DAY    CPM005
081800200529      **  NUMBER FOR LATER USE                                            CPM005
081900200529     C           ZDAYNO    SUB  1         WENDMT  50                      CPM005
082000200529     C*
082100200529     C           BJDFIN    IFEQ 'M'
082200200529     C                     MOVE '1'       *IN98
082300200529     C                     END
082400200529     C*
082500200529     C** GET INSTALLATION CONTROL DATA RECORD FOR CUSTODY FEES            S01307
082600200529     C           WWSFEE    IFEQ 'Y'                                       S01486
082700200529     C***********          READ SCICDPPD                 71        S01307 S01486
082800200529     C                     READ SDSCFEPD                 71               S01486
082900200529     C*                                                                   S01307
083000200529     C           *IN71     IFEQ '1'                        ***************S01307
083100200529     C                     Z-ADD6         DBASE   30       **DB ERROR 06**S01307
083200200529     C************         MOVEL'SCICDPPD'DBFILE 10        ********S01307 S01486
083300200529     C                     MOVE 'SDSCFEPD'DBFILE           ***************S01486
083400200529     C                     MOVE *BLANKS   DBKEY  29                       S01307
083500200529     C                     EXSR *PSSR                                     S01307
083600200529     C                     END                                            S01307
083700200529     C*                                                                   S01307
083800200529     C** ALLOW INPUT OF FEE GROUP CODE ON SCREEN                          S01307
083900200529     C***********SAFGCP    IFEQ 'Y'                                S01307 S01486
084000200529     C           FBFGCP    IFEQ 'Y'                                       S01486
084100200529     C                     MOVE '1'       *IN70                           S01307
084200200529     C                     END                                            S01307
084300200529     C                     END                                            S01486
084400200529     C*                                                                   S01307
084500200529     C** GET PORTFOLIO MANAGEMENT INSTALLATION DETAILS
084600200529     C*
084700200529     C************         READ SDPORTL0                 71               S01486
084800200529     C************IN71     IFEQ '1'                        ***************S01486
084900200529     C                     CALL 'AOPORTR0'                                S01486
085000200529     C                     PARM *BLANKS   WWRTCD  7                       S01486
085100200529     C                     PARM '*FIRST ' WWOPTN  7                       S01486
085200200529     C           SDPORT    PARM SDPORT    DSFDY                           S01486
085300200529     C           WWRTCD    IFNE *BLANKS                                   S01486
085400200529     C           *LOCK     IN   LDA                                       S01486
085500200529     C************         Z-ADD2         DBASE   30       **DB ERROR 02**S01486
085600200529     C************         MOVEL'SDPORTL0'DBFILE 10        ***************S01486
085700200529     C************         MOVE *BLANKS   DBKEY  29                       S01486
085800200529     C                     Z-ADD2         DBASE            **DB ERROR 02**S01486
085900200529     C                     MOVE 'SDPORTPD'DBFILE           ***************S01486
086000200529     C                     MOVE *BLANKS   DBKEY                           S01486
086100200529     C                     OUT  LDA                                       S01486
086200200529     C                     EXSR *PSSR
086300200529     C                     END
086400200529     C*                                                                   CPM004
086500200529     C           FCPORS    IFEQ 'B'                                       CPM004
086600200529     C                     OPEN PMPOTTPD                                  CPM004
086700200529     C                     ENDIF                                          CPM004
086800200529     C*
086900200529     C** GET DETAILS OF MODULES INSTALLED ON SYSTEM
087000200529     C*
087100200529     C***********          READ SDMMODL0                 71               S01486
087200200529     C************IN71     IFEQ '1'                        ***************S01486
087300200529     C                     CALL 'AOMMODR0'                                S01486
087400200529     C                     PARM *BLANKS   WWRTCD  7                       S01486
087500200529     C                     PARM '*FIRST ' WWOPTN  7                       S01486
087600200529     C           SDMMOD    PARM SDMMOD    DSFDY                           S01486
087700200529     C           WWRTCD    IFNE *BLANKS                                   S01486
087800200529     C           *LOCK     IN   LDA                                       S01486
087900200529     C***********          Z-ADD3         DBASE   30       **DB ERROR 03**S01486
088000200529     C***********          MOVEL'SDMMODL0'DBFILE 10        ***************S01486
088100200529     C***********          MOVE *BLANKS   DBKEY  29                       S01486
088200200529     C                     Z-ADD3         DBASE            **DB ERROR 03**S01486
088300200529     C                     MOVE 'SDMMODPD'DBFILE           ***************S01486
088400200529     C                     MOVE *BLANKS   DBKEY                           S01486
088500200529     C                     OUT  LDA                                       S01486
088600200529     C                     EXSR *PSSR
088700200529     C                     END
088800200529     C*                                                                   CAC003
088900200529     C** Check if Analytical Accounting and Switchable Feature            CAC003
089000200529     C** CAC003 are switched on.                                          CAC003
089100200529     C                     MOVE '0'       *IN87                           CAC003
089200200529      *                                                                   CAC003
089300200529     C                     CALL 'AOSARDR0'                                CAC003
089400200529     C                     PARM           WWRTCD                          CAC003
089500200529     C                     PARM '*VERIFY' WWOPTN                          CAC003
089600200529     C                     PARM 'CAC003'  WWSARD                          CAC003
089700200529     C           SCSARD    PARM SCSARD    DSFDY                           CAC003
089800200529      *                                                                   CAC003
089900200529     C           WWRTCD    IFEQ *BLANK                                    CAC003
090000200529     C           BGN0ST    ANDEQ'Y'                                       CAC003
090100200529     C                     MOVE '1'       *IN87                           CAC003
090200200529     C                     ENDIF                                          CAC003
090300200529      *                                                                   CAC003
090400200529     C*
090500200529     C** SET ON PLEDGE PROTECT INDICATOR IF LOMBARD CREDITS PRESENT
090600200529     C*
090700200529     C           BGLMCR    IFEQ 'Y'
090800200529     C                     MOVE '1'       *IN23
090900200529     C                     END
091000200529     C*                                                                   S71062
091100200529     C** SET ON INDICATOR IF FUTURES & OPTIONS PRESENT (FF MARG. A/C SEQ) S71062
091200200529     C*                                                                   S71062
091300200529     C           BGFUOP    IFEQ 'Y'                                       S71062
091400200529     C           FCPORS    ANDNE'B'                                       CPM003
091500200529     C** If Bank Portfolios are supported, treat as if FF off             CPM003
091600200529     C                     MOVE *ON       *IN20                           S71062
091700200529     C                     ENDIF                                          S71062
091800200529     C*
091900200529     C***********          MOVELBJMRDT    DDRUNA                          S01486
092000200529     C                     MOVE '1'       *IN10
092100200529     C/COPY WNCPYSRC,PM0110C001
092200200529     C*
092300200529     C                     ENDSR                           **#A   ENDSR**
092400200529     C*
092500200529     C**************************************************************************
092600200529      /EJECT
092700200529      **************************************************************************
092800200529      *                                                                        *
092900200529      * #CLOF    - TO PROCESS CLOSE OF FILES IN LOWER LEVEL PROGRAMS           *
093000200529      *                                                                        *
093100200529      * SUBROUTINE CALLS:                                                      *
093200200529      * PM0600   - NOTEPAD                                                     *
093300200529      * PM0170   - INSTRUMENT INVESTMENT POLICY                                *
093400200529      * PM0180   - CURRENCY INVESTMENT POLICY                                  *
093500200529      * PM0190   - COUNTRY OF RISK INVESTMENT POLICY                           *
093600200529      * PM0200   - INDUSTRY INVESTMENT POLICY                                  *
093700200529      *                                                                        *
093800200529      * SUBROUTINE CALLED FROM:                                                *
093900200529      * MAIN     - MAIN PROCESSING                                             *
094000200529      * *PSSR    - TO PROCESS ABNORMAL END OF PROGRAM                          *
094100200529      *                                                                        *
094200200529      *                                                                        *
094300200529      **************************************************************************
094400200529     C           #CLOF     BEGSR
094500200529     C*
094600200529     C** ENSURE WORKSTATION ID RESET TO BLANK IF LOCKED BY JOB
094700200529     C*
094800200529     C           WWLOCK    IFEQ 'Y'
094900200529     C**********           Z-ADDWWPNP8    WWCSSV  60                                          CSD027
095000200529     C                     MOVE WWPNP8    WWCSSV  6                                           CSD027
095100200529     C                     MOVE WWPREF    WWPRSV  4
095200200529     C***********PMPORK    CHAINPMPORTPP             71                   S01486
095300200529     C           PMPORK    CHAINPMPORTPD             71                   S01486
095400200529     C*
095500200529     C           *IN71     IFEQ '0'
095600200529     C                     MOVE *BLANKS   PNWSI1
095700200529     C                     UPDATPMPORTP0
095800200529     C                     COMIT
095900200529     C                     END
096000200529     C                     END
096100200529     C**
096200200529     C                     MOVEL'9'       WWRTRN
096300200529     C                     MOVEL*BLANK    WWACTO
096400200529     C                     MOVEL'0'       WWCCNM
096500200529     C                     MOVEL*BLANKS   WWPOLI
096600200529     C                     MOVEL*BLANKS   WWPTFR
096700200529     C**
096800200529     C** PROGRAM PM0600 ** NOTEPAD **
096900200529     C**
097000200529     C           WW0600    IFEQ 'Y'
097100200529     C                     CALL 'PMC0601' LIST1
097200200529     C                     END
097300200529     C*
097400200529     C**
097500200529     C** PROGRAM PM0170 ** INSTRUMENT POLICIES
097600200529     C**
097700200529     C           WW0170    IFEQ 'Y'
097800200529     C                     CALL 'PM0170'  LIST2
097900200529     C                     END
098000200529     C*
098100200529     C**
098200200529     C** PROGRAM PM0180  ** CURRENCY POLICIES
098300200529     C**
098400200529     C           WW0180    IFEQ 'Y'
098500200529     C                     CALL 'PM0180'  LIST2
098600200529     C                     END
098700200529     C*
098800200529     C**
098900200529     C** PROGRAM PM0190  ** COUNTRY OF RISK POLICIES
099000200529     C**
099100200529     C           WW0190    IFEQ 'Y'
099200200529     C                     CALL 'PM0190'  LIST2
099300200529     C                     END
099400200529     C*
099500200529     C**
099600200529     C** PROGRAM PM0200  ** INDUSTRY POLICIES
099700200529     C**
099800200529     C           WW0200    IFEQ 'Y'
099900200529     C                     CALL 'PM0200'  LIST2
100000200529     C                     END
100100200529     C**
100200200529     C** Close PF/PMPOTTPD                                                CPM004
100300200529     C*                                                                   CPM004
100400200529     C           FCPORS    IFEQ 'B'                                       CPM004
100500200529     C                     CLOSEPMPOTTPD                                  CPM004
100600200529     C                     ENDIF                                          CPM004
100700200529     C*                                                                   CPM004
100800200529     C                     ENDSR
100900200529     C*
101000200529     C**************************************************************************
101100200529      /EJECT
101200200529      **************************************************************************
101300200529      *                                                                        *
101400200529      * #P1002   - START - TO OUTPUT AND PROCESS KEY FIELDS SCREEN             *
101500200529      *                                                                        *
101600200529      * SUBROUTINE CALLS:                                                      *
101700200529      ********ZA0250   - TO CLEAR MESSAGE                                 R00300
101800200529      * Y2CLMSC  - CLEAR MESSAGE QUEUE                                    R00300
101900200529      * #ZBAA    - TO MOVE THE APPROPRIATE VALUE IN WWAID                      *
102000200529      * #ZBAB    - TO VALIDATE KEY FIELDS FROM START SCREEN                    *
102100200529      *                                                                        *
102200200529      * SUBROUTINE CALLED FROM:                                                *
102300200529      * MAIN     - MAIN PROCESSING                                             *
102400200529      *                                                                        *
102500200529      *                                                                        *
102600200529      **************************************************************************
102700200529     C           #P1002    BEGSR                           **#P1002 BSR **
102800200529     C*
102900200529     C** IF F12 TAKEN TO RETURN TO PREVIOUS SCREEN REMOVE ALL FILE CHANGES
103000200529     C*
103100200529     C           WWAID     IFEQ '12'
103200200529     C                     ROLBK
103300200529     C                     END
103400200529     C*
103500200529     C** ENSURE WORKSTATION ID RESET TO BLANK IF RECORD LOCKED BY JOB
103600200529     C*
103700200529     C           WWLOCK    IFEQ 'Y'
103800200529     C**********           Z-ADDWWPNP8    WWCSSV  60                                          CSD027
103900200529     C                     MOVE WWPNP8    WWCSSV  6                                           CSD027
104000200529     C                     MOVE WWPREF    WWPRSV  4
104100200529     C***********PMPORK    CHAINPMPORTPP             71                   S01486
104200200529     C           PMPORK    CHAINPMPORTPD             71                   S01486
104300200529     C*
104400200529     C           *IN71     IFEQ '0'
104500200529     C                     MOVE *BLANKS   PNWSI1
104600200529     C                     UPDATPMPORTP0
104700200529     C                     COMIT
104800200529     C                     END
104900200529     C                     END
105000200529     C*
105100200529     C** INITIALISE SCREEN DATA
105200200529     C*
105300200529     C                     MOVE '0'       *IN10
105400200529     C                     MOVE '0'       *IN25
105500200529     C                     MOVE '0'       *IN26
105600200529     C                     MOVE '0'       *IN27
105700200529     C                     MOVE '0'       *IN28
105800200529     C                     MOVE '0'       *IN29
105900200529     C                     MOVEL*BLANK    SCRCTL
106000200529     C***********          MOVEL'PM90001' MSMBR4                          B9958
106100200529     C           BGN4ST    IFEQ 'Y'                                       CPB001
106200200529     C                     MOVEL'PBUSRMSG'MSGER                           CPB001
106300200529     C                     MOVEL'PB00074' MSMBR4                          CPB001
106400200529     C                     ELSE                                           CPB001
106500200529     C                     MOVEL'PM90005' MSMBR4                          B9958
106600200529     C                     ENDIF                                          CPB001
106700200529     C                     CALL 'SDRTVTXT'PLLANG
106800200529     C                     MOVELMSGTXT    DDINFO
106900200529     C                     MOVEL'PMUSRMSG'MSGER                           CPB001
107000200529     C*
107100200529     C** CLEAR WHOLE SCREEN
107200200529     C*
107300200529     C                     WRITEPM0110F4
107400200529     C*
107500200529     C** D O    U N T I L   C H A N G E  O F  S C R E E N
107600200529     C*
107700200529     C           WWAID     DOUEQ'03'
107800200529     C           *IN10     OREQ '1'
107900200529     C           *IN11     OREQ '1'
108000200529     C           *IN12     OREQ '1'
108100200529     C*
108200200529     C** S T A R T   S C R E E N     O U T P U T
108300200529     C*
108400200529     C                     WRITEPM0110F3
108500200529     C                     EXFMTPM0110F1
108600200529     C                     MOVE '0'       *IN80
108700200529     C                     MOVE '0'       *IN81
108800200529     C*********************CALL 'ZA0250'                                  R00300
108900200529     C*                                                                   R00300
109000200529     C**  Clear program message queue.                                    R00300
109100200529     C                     CALL 'Y2CLMSC'                                 R00300
109200200529     C                     PARM           TOPQ   10                       R00300
109300200529     C                     PARM           TOPRQ   5                       R00300
109400200529     C*
109500200529     C** Call S/R to move values into WWAID
109600200529     C*
109700200529     C                     EXSR #ZBAA
109800200529     C*
109900200529     C** ENTER TAKEN VALIDATE KEY INPUT
110000200529     C*
110100200529     C           WWAID     IFEQ 'RA'
110200200529     C                     EXSR #ZBAB
110300200529     C*
110400200529     C** IF NO ERRORS, DETERMINE NEXT SCREEN
110500200529     C*
110600200529     C           *IN80     IFEQ '0'
110700200529     C*
110800200529     C** IF ACTION CODE IS BLANK, NEXT SCREEN IS REVIEW SCREEN,
110900200529     C** OTHERWISE, DISPLAY REQUESTED DETAIL SCREEN AS PER KEY INPUT
111000200529     C*
111100200529     C           DDACTN    IFEQ *BLANK
111200200529     C                     MOVE '1'       *IN11
111300200529     C                     ELSE
111400200529     C                     MOVE '1'       *IN12
111500200529     C                     END
111600200529     C*
111700200529     C                     END
111800200529     C*
111900200529     C                     END
112000200529     C*
112100200529     C                     END
112200200529     C*
112300200529     C                     ENDSR                           ** #BA   ENDSR**
112400200529     C*
112500200529     C**************************************************************************
112600200529      /EJECT
112700200529      **************************************************************************
112800200529      *                                                                        *
112900200529      * #P1003   - TO PROCESS SUBFILE SELECTION SCREEN                         *
113000200529      *                                                                        *
113100200529      * SUBROUTINE CALLS:                                                      *
113200200529      *********ZA0250   - TO CLEAR MESSAGE                                R00300
113300200529      * Y2CLMSC  - CLEAR MESSAGE QUEUE                                    R00300
113400200529      * #ZBAA    - TO MOVE THE APPROPRIATE VALUE IN WWAID                      *
113500200529      * #ZBAC    - TO VALIDATE KEY FIELDS FROM REVIEW SCREEN                   *
113600200529      *                                                                        *
113700200529      * SUBROUTINE CALLED FROM:                                                *
113800200529      * MAIN     - MAIN PROCESSING                                             *
113900200529      *                                                                        *
114000200529      *                                                                        *
114100200529      **************************************************************************
114200200529     C           #P1003    BEGSR                           **#P1003  BSR**
114300200529     C*
114400200529     C                     MOVE '0'       *IN11
114500200529     C                     MOVE '0'       *IN29
114600200529     C*
114700200529     C** SET PROCESSING FLAG TO FORCE SUBFILE REBUILD
114800200529     C*
114900200529     C                     MOVEL'RA'      WWAID   2
115000200529     C**
115100200529     C*
115200200529     C** D O    U N T I L   C H A N G E  O F  S C R E E N
115300200529     C*
115400200529     C           WWAID     DOUEQ'03'
115500200529     C           *IN10     OREQ '1'
115600200529     C           *IN11     OREQ '1'
115700200529     C           *IN12     OREQ '1'
115800200529     C*
115900200529     C** R E B U I L D   S U B F I L E
116000200529     C*
116100200529     C           WWAID     IFEQ 'DN'
116200200529     C           WWAID     OREQ 'UP'
116300200529     C           WWAID     OREQ 'RA'
116400200529     C*
116500200529     C** WRITE CONTROL RECORD
116600200529     C*
116700200529     C                     MOVE '0'       *IN61
116800200529     C                     MOVE '0'       *IN62
116900200529     C                     MOVE '0'       *IN63
117000200529     C                     Z-ADD*ZERO     RRN1
117100200529     C                     WRITEPM0110C0
117200200529     C                     MOVE '1'       *IN64
117300200529     C*
117400200529     C** SET FILE POINTER - PAGE BACK
117500200529     C*
117600200529     C           WWAID     IFEQ 'DN'
117700200529     C**********           Z-ADD0         WWPNP8                                              CSD027
117800200529     C                     MOVE *BLANKS   WWPNP8                                              CSD027
117900200529     C                     MOVEL*BLANKS   WWPREF
118000200529     C                     MOVEL*BLANKS   WWCUS2
118100200529     C                     MOVEL*BLANKS   WWPAG2
118200200529     C           PMPORK    SETLLPMPORTXX
118300200529     C*
118400200529     C** OTHERWISE        - PAGE FORWARD
118500200529     C*
118600200529     C                     ELSE
118700200529     C**
118800200529     C           *IN80     IFEQ '0'
118900200529     C           DDACTN    ANDEQ*BLANK
119000200529     C                     MOVELDDPNP8    WWCUS2
119100200529     C                     MOVELDDPORT    WWPAG2
119200200529     C                     END
119300200529     C                     MOVE WWCUS2    WWPNP8
119400200529     C                     MOVELWWPAG2    WWPREF
119500200529     C**
119600200529     C           PMPORK    SETLLPMPORTXX
119700200529     C                     END
119800200529     C*
119900200529     C** READ IN DETAILS-FILL UP SUBFILE
120000200529     C*
120100200529     C*
120200200529     C           RRN1      DOUEQ12
120300200529     C           *IN71     OREQ '1'
120400200529     C**
120500200529     C                     MOVEL*BLANK    DDACTN
120600200529     C                     MOVE '0'       *IN30
120700200529     C*
120800200529     C** READ DETAILS UNTIL SUBFILE PAGE IS FULL
120900200529     C*
121000200529     C                     READ PMPORTXX                 71
121100200529     C*
121200200529     C           *IN71     IFEQ '0'
121300200529     C           PNRECI    IFEQ '*'
121400200529     C                     MOVEL'CL'      DDSTAT
121500200529     C                     ELSE
121600200529     C           PNDPCL    IFNE 0
121700200529     C                     MOVEL'CR'      DDSTAT
121800200529     C                     ELSE
121900200529     C                     MOVEL'  '      DDSTAT
122000200529     C                     END
122100200529     C                     END
122200200529     C*
122300200529     C** LOAD SUBFILE
122400200529     C*
122500200529     C********** PNCNUM    IFNE 0                                                             CSD027
122600200529     C           PNCNUM    IFNE *BLANKS                                                       CSD027
122700200529     C                     MOVE PNCNUM    DDCNUM
122800200529     C                     MOVE PNPTFR    DDPTFR
122900200529     C                     MOVE PNPTCY    DDPCCY
123000200529     C                     MOVE PNPTFN    DDPTFN
123100200529     C           PNDPCL    IFNE 0
123200200529     C                     Z-ADDPNDPCL    ZDAYNO
123300200529     C                     EXSR ZDATE2
123400200529     C                     MOVELZDATE     DDDATE
123500200529     C                     ELSE
123600200529     C                     MOVEL*BLANKS   DDDATE
123700200529     C                     END
123800200529     C                     ADD  1         RRN1    40     64
123900200529     C*
124000200529     C** ERROR HAS BEEN DETECTED - RECOGNIZE ERROR RECORD TO POSITION
124100200529     C** CURSOR
124200200529     C*
124300200529     C           RRN1      IFEQ WWSAVE
124400200529     C                     MOVELWWACTN    DDACTN
124500200529     C                     MOVE '1'       *IN30
124600200529     C                     END
124700200529     C*
124800200529     C** WRITE RECORD TO SUBFILE
124900200529     C*
125000200529     C                     WRITEPM0110S0
125100200529     C**
125200200529     C                     END
125300200529     C**
125400200529     C                     END
125500200529     C*
125600200529     C** PAGE NOW FULL (OR EOF)
125700200529     C*
125800200529     C                     END
125900200529     C*
126000200529     C** READ ONE MORE RECORD FOR NEXT SCREEN
126100200529     C*
126200200529     C           *IN71     IFEQ '0'
126300200529     C                     READ PMPORTXX                 71
126400200529     C                     END
126500200529     C*
126600200529     C** IF NOT EOF SET NEXT 'REVIEW FROM' KEY ELSE SET IT TO BLANK
126700200529     C*
126800200529     C           *IN71     IFEQ '0'
126900200529     C                     MOVELPNCNUM    DDPNP8
127000200529     C                     MOVELPNPTFR    DDPORT
127100200529     C                     MOVE '0'       *IN63
127200200529     C                     ELSE
127300200529     C                     MOVE *BLANKS   DDPNP8
127400200529     C                     MOVE *BLANKS   DDPORT
127500200529     C                     MOVE '1'       *IN63
127600200529     C                     END
127700200529     C*
127800200529     C** FOR SUBFILE CONTROL
127900200529     C*
128000200529     C           *IN64     IFEQ '1'
128100200529     C                     MOVE '0'       *IN61
128200200529     C                     MOVE '1'       *IN62
128300200529     C                     ELSE
128400200529     C                     MOVE '1'       *IN61
128500200529     C                     MOVE '1'       *IN62
128600200529     C                     END
128700200529     C*
128800200529     C                     END
128900200529     C*
129000200529     C** R E V I E W   S C R E E N     O U T P U T
129100200529     C*
129200200529     C                     MOVEL'PM90007' MSMBR4
129300200529     C                     CALL 'SDRTVTXT'PLLANG
129400200529     C                     MOVELMSGTXT    DDINFO
129500200529     C                     WRITEPM0110F3
129600200529     C                     WRITEPM0110F1
129700200529     C                     EXFMTPM0110C0
129800200529     C                     MOVE '0'       *IN80
129900200529     C                     MOVE '0'       *IN86                           B8275
130000200529     C                     Z-ADD0         WWSAVE
130100200529     C*********************CALL 'ZA0250'                                  R00300
130200200529     C*                                                                   R00300
130300200529     C**   Clear program message queue                                    R00300
130400200529     C                     CALL 'Y2CLMSC'                                 R00300
130500200529     C                     PARM           TOPQ                            R00300
130600200529     C                     PARM           TOPRQ                           R00300
130700200529     C*
130800200529     C** Call S/R to move values into WWAID
130900200529     C*
131000200529     C                     EXSR #ZBAA
131100200529     C*
131200200529     C** CK12- INITIAL SCREEN
131300200529     C*
131400200529     C           WWAID     IFEQ '12'
131500200529     C                     MOVE '1'       *IN10
131600200529     C                     END
131700200529     C*
131800200529     C** ENTER PRESSED, PROCESS RECORD SELECTION
131900200529     C*
132000200529     C           WWAID     IFEQ 'RA'
132100200529     C                     MOVE '1'       *IN77
132200200529     C*
132300200529     C           *IN64     IFEQ '0'
132400200529     C                     READCPM0110S0                 77
132500200529     C                     END
132600200529     C*
132700200529     C** R E C O R D   S E L E C T   V A L I D A T I O N
132800200529     C*
132900200529     C           *IN77     IFEQ '0'
133000200529     C                     EXSR #ZBAC
133100200529     C*
133200200529     C** NO ERRORS, UPDATE SCREEN CAN BE PROCESSED NEXT
133300200529     C*
133400200529     C           *IN80     IFEQ '0'
133500200529     C                     MOVE '1'       *IN12
133600200529     C                     MOVEL'Y'       WWREVW
133700200529     C**
133800200529     C** ACCESS CUSTOMER FILE TO GET INFORMATIONS
133900200529     C**
134000200529     C***********DDCNUM    CHAINSDPLCSL2             75                   S01486
134100200529     C                     MOVELDDCNUM    WWCLIN 10                       S01486
134200200529     C                     CALL 'AOPLCSR0'                                S01486
134300200529     C                     PARM '*MSG    'WWRTCD  7                       S01486
134400200529     C                     PARM '*KEY    'WWOPTN  7                       S01486
134500200529     C                     PARM WWCLIN    WWKY10 10                       S01486
134600200529     C           SDPLCS    PARM SDPLCS    DSSDY                           S01486
134700200529     C**
134800200529     C                     MOVELDDCNUM    DDCSNM
134900200529     C                     MOVELDDPTFR    DDPREF
135000200529     C                     ELSE
135100200529     C                     MOVELDDACTN    WWACTN
135200200529     C                     Z-ADDRRN1      WWSAVE
135300200529     C                     END
135400200529     C**
135500200529     C                     END
135600200529     C**
135700200529     C                     END
135800200529     C**
135900200529     C                     END
136000200529     C*
136100200529     C                     ENDSR                           **#BB    ENDSR**
136200200529     C*
136300200529     C*
136400200529     C**************************************************************************
136500200529      /EJECT
136600200529      **************************************************************************
136700200529      *                                                                        *
136800200529      * #ZBAA    - TO MOVE THE APPROPRIATE VALUE IN WWAID                      *
136900200529      *                                                                        *
137000200529      * SUBROUTINE CALLS:                                                      *
137100200529      *                                                                        *
137200200529      * SUBROUTINE CALLED FROM:                                                *
137300200529      * #P1002   - START - TO OUTPUT AND PROCESS KEY FIELDS SCREEN             *
137400200529      * #P1003   - TO PROCESS SUBFILE SELECTION SCREEN                         *
137500200529      * #P1004   - TO PROCESS DETAIL SCREEN AND UPDATE FILES                   *
137600200529      * #P1005   - TO PROCESS PORTFOLIO CHARGE DETAILS                         *
137700200529      *                                                                        *
137800200529      *                                                                        *
137900200529      **************************************************************************
138000200529     C           #ZBAA     BEGSR
138100200529     C*
138200200529     C* If ENTER pressed, the VLDCMDKEY indicator will be off
138300200529     C*
138400200529     C           *IN60     IFEQ '0'
138500200529     C                     MOVE 'RA'      WWAID
138600200529     C                     END
138700200529     C*
138800200529     C* If F3
138900200529     C*
139000200529     C           *INKC     IFEQ '1'
139100200529     C                     MOVE '03'      WWAID
139200200529     C                     MOVE '0'       *INKC
139300200529     C                     END
139400200529     C*
139500200529     C* If F12
139600200529     C*
139700200529     C           *INKL     IFEQ '1'
139800200529     C                     MOVE '12'      WWAID
139900200529     C                     MOVE '0'       *INKL
140000200529     C                     END
140100200529     C*
140200200529     C* If F1
140300200529     C*
140400200529     C           *INKA     IFEQ '1'
140500200529     C                     MOVE '01'      WWAID
140600200529     C                     MOVE '0'       *INKA
140700200529     C                     END
140800200529     C*
140900200529     C* If F24
141000200529     C*
141100200529     C           *INKY     IFEQ '1'
141200200529     C                     MOVE '24'      WWAID
141300200529     C                     MOVE '0'       *INKY
141400200529     C                     END
141500200529     C*
141600200529     C* If ROLLUP pressed
141700200529     C*
141800200529     C           *IN21     IFEQ '1'
141900200529     C                     MOVE 'UP'      WWAID
142000200529     C                     MOVE '0'       *IN21
142100200529     C                     END
142200200529     C*
142300200529     C* If ROLLDOWN pressed
142400200529     C*
142500200529     C           *IN22     IFEQ '1'
142600200529     C                     MOVE 'DN'      WWAID
142700200529     C                     MOVE '0'       *IN22
142800200529     C                     END
142900200529     C*
143000200529     C                     ENDSR                           **#ZBAA  ENDSR**
143100200529     C*
143200200529     C**************************************************************************
143300200529      /EJECT
143400200529      **************************************************************************
143500200529      *                                                                        *
143600200529      * #ZBAB    - TO VALIDATE KEY FIELDS FROM START SCREEN                    *
143700200529      *                                                                        *
143800200529      * SUBROUTINE CALLS:                                                      *
143900200529      ********ZA0240   - TO ACCESS MESSAGE FILE AND SEND MESSAGE          R00300
144000200529      * ZASNMS   - WRITE ERROR MESSAGES                                   R00300
144100200529      * #CUST    - TO VALIDATE CUSTOMER NUMBER/SHORTNAME                       *
144200200529      *                                                                        *
144300200529      * SUBROUTINE CALLED FROM:                                                *
144400200529      * #P1002   - START - TO OUTPUT AND PROCESS KEY FIELDS SCREEN             *
144500200529      *                                                                        *
144600200529      *                                                                        *
144700200529      **************************************************************************
144800200529     C           #ZBAB     BEGSR                           ** #ZBAB  BSR**
144900200529     C*
145000200529     C** RESET ERROR INDICATORS
145100200529     C*
145200200529     C                     MOVE '0'       *IN26
145300200529     C                     MOVE '0'       *IN27
145400200529     C                     MOVE '0'       *IN28
145500200529     C                     MOVE '0'       *IN29
145600200529     C                     MOVELDDPNP8    WWWORK 10
145700200529     C                     MOVE DDPORT    WWWORK
145800200529     C*
145900200529     C** A C T I O N    C O D E    I N P U T - MUST BE BLANK,A,E
146000200529     C*
146100200529     C           DDACTN    IFNE *BLANK
146200200529     C***
146300200529     C           WWWORK    IFNE *BLANKS
146400200529     C*********************MOVEL'PM11114' MSGID  10                       R00300
146500200529     C*********************CALL 'ZA0240'                                  R00300
146600200529     C*********************PARM           MSGID                           R00300
146700200529     C                     MOVEL'PM11114' ZAMSID                          R00300
146800200529     C                     EXSR ZASNMS                                    R00300
146900200529     C                     MOVE '1'       *IN80
147000200529     C                     MOVE '1'       *IN26
147100200529     C                     MOVE '1'       *IN27
147200200529     C                     MOVE '1'       *IN28
147300200529     C                     END
147400200529     C***
147500200529     C           DDACTN    IFNE 'I'
147600200529     C           DDACTN    ANDNE'A'
147700200529     C           DDACTN    ANDNE'E'
147800200529     C           DDACTN    ANDNE'C'
147900200529     C*********************MOVEL'PM11100' MSGID  10                       R00300
148000200529     C*********************CALL 'ZA0240'                                  R00300
148100200529     C*********************PARM           MSGID                           R00300
148200200529     C                     MOVEL'PM11100' ZAMSID                          R00300
148300200529     C                     EXSR ZASNMS                                    R00300
148400200529     C                     MOVE '1'       *IN80
148500200529     C                     MOVE '1'       *IN26
148600200529     C                     END
148700200529     C/COPY WNCPYSRC,PM0110C002
148800200529     C** USER SHOULD BE AUTHORISED TO ACTION CODE                         S01486
148900200529     C*                                                                   S01486
149000200529     C** WHEN SINGLE BRANCH                                               S01486
149100200529     C           MBIN      IFNE 'Y'                                       S01486
149200200529     C*                                                                   S01486
149300200529     C                     CALL 'ZVACTU'                                  S01486
149400200529     C                     PARM DDACTN    @ZACTN  1                       S01486
149500200529     C                     PARM           @ERR    10                      S01486
149600200529     C           @ERR      IFNE *ZERO                                     S01486
149700200529     C                     MOVEL'PM02000' ZAMSID                          S01486
149800200529     C                     EXSR ZASNMS                                    S01486
149900200529     C                     MOVE '1'       *IN26                           S01486
150000200529     C                     MOVE '1'       *IN80                           S01486
150100200529     C                     END                                            S01486
150200200529     C*                                                                   S01486
150300200529     C                     ELSE                                           S01486
150400200529     C*                                                                   S01486
150500200529     C** WHEN MULTI-BRANCH                                                S01486
150600200529     C                     CALL 'ZVACTBU'                                 S01486
150700200529     C                     PARM DDACTN    @ZACTN  1                       S01486
150800200529     C                     PARM USRBCH    @ZBR    3                       S01486
150900200529     C                     PARM           @ERR    10                      S01486
151000200529     C           @ERR      IFNE *ZERO                                     S01486
151100200529     C                     MOVEL'PM02000' ZAMSID                          S01486
151200200529     C                     EXSR ZASNMS                                    S01486
151300200529     C                     MOVE '1'       *IN26                           S01486
151400200529     C                     MOVE '1'       *IN80                           S01486
151500200529     C                     END                                            S01486
151600200529     C                     END                                            S01486
151700200529     C*                                                                   S01486
151800200529     C**
151900200529     C           DDCSNM    IFEQ *BLANKS
152000200529     C           DDPREF    ANDEQ*BLANKS
152100200529     C*********************MOVEL'PM11115' MSGID  10                       R00300
152200200529     C*********************CALL 'ZA0240'                                  R00300
152300200529     C*********************PARM           MSGID                           R00300
152400200529     C                     MOVEL'PM11115' ZAMSID                          R00300
152500200529     C                     EXSR ZASNMS                                    R00300
152600200529     C                     MOVE '1'       *IN80
152700200529     C                     MOVE '1'       *IN27
152800200529     C                     MOVE '1'       *IN28
152900200529     C                     END
153000200529     C**
153100200529     C           DDCSNM    IFNE *BLANKS
153200200529     C           DDPREF    ANDEQ*BLANKS
153300200529     C*********************MOVEL'PM11106' MSGID  10                       R00300
153400200529     C*********************CALL 'ZA0240'                                  R00300
153500200529     C*********************PARM           MSGID                           R00300
153600200529     C                     MOVEL'PM11106' ZAMSID                          R00300
153700200529     C                     EXSR ZASNMS                                    R00300
153800200529     C                     MOVE '1'       *IN80
153900200529     C                     MOVE '1'       *IN28
154000200529     C                     END
154100200529     C*
154200200529     C           DDCSNM    IFEQ *BLANKS
154300200529     C           DDPREF    ANDNE*BLANKS
154400200529     C*********************MOVEL'PM11102' MSGID  10                       R00300
154500200529     C*********************CALL 'ZA0240'                                  R00300
154600200529     C*********************PARM           MSGID                           R00300
154700200529     C                     MOVEL'PM11102' ZAMSID                          R00300
154800200529     C                     EXSR ZASNMS                                    R00300
154900200529     C                     MOVE '1'       *IN80
155000200529     C                     MOVE '1'       *IN27
155100200529     C                     END
155200200529     C**
155300200529     C*
155400200529     C** CHECK IF CUSTOMER NUMBER OR SHORT NAME IS VALID
155500200529     C*
155600200529     C           BGN4ST    IFEQ 'Y'                                       CPB001
155700200529     C           *IN27     ANDEQ'0'                                       CPB001
155800200529     C*                                                                   CPB001
155900200529     C                     CALL 'AOCUSTR1'                                CPB001
156000200529     C                     PARM '*MSG    'WWRTCD                          CPB001
156100200529     C                     PARM '*KEY    'WWOPTN                          CPB001
156200200529     C                     PARM DDCSNM    WWKY10                          CPB001
156300200529     C                     PARM WWSORT    WWKE7                           CPB001
156400200529     C           SDCUST    PARM SDCUST    DSLDY                           CPB001
156500200529     C*                                                                   CPB001
156600200529     C                     MOVE BBCUST    WWPNP8                          CPB001
156700200529     C                     MOVELBBCUST    DDCSNM    P                     CPB001
156800200529     C                     MOVELBBCUST    WWCNUM    P                     CPB001
156900200529     C*                                                                   CPB001
157000200529     C** Input and change of a portfolio is only possible in Interface    CPB001
157100200529     C** If Private Banking Customer                                      CPB001
157200200529     C*                                                                   CPB001
157300200529     C           DDACTN    IFEQ 'I'                                       CPB001
157400200529     C           BBPRBA    ANDEQ'Y'                                       CPB001
157500200529     C           DDACTN    OREQ 'C'                                       CPB001
157600200529     C           BBPRBA    ANDEQ'Y'                                       CPB001
157700200529     C                     MOVEL'PBUSRMSG'ZAMSGF                          CPB001
157800200529     C                     MOVEL'PB00073' ZAMSID                          CPB001
157900200529     C                     MOVELDDACTN    ZAMSDA    P                     CPB001
158000200529     C                     EXSR ZASNMS                                    CPB001
158100200529     C                     MOVEL'PMUSRMSG'ZAMSGF                          CPB001
158200200529     C                     MOVE '1'       *IN80                           CPB001
158300200529     C                     MOVE '1'       *IN26                           CPB001
158400200529     C                     ENDIF                                          CPB001
158500200529     C*                                                                   CPB001
158600200529     C** In Private Banking Module all portfolio must be                  CPB001
158700200529     C** in range from 0001 to 00099                                      CPB001
158800200529     C*                                                                   CPB001
158900200529     C           DDACTN    IFEQ 'I'                                       CPB001
159000200529     C           *IN28     ANDEQ'0'                                       CPB001
159100200529     C                     TESTN          DDPREF     83                   CPB001
159200200529     C** Must be numeric                                                  CPB001
159300200529     C           *IN83     IFEQ *OFF                                      CPB001
159400200529     C                     MOVEL'PBUSRMSG'ZAMSGF                          CPB001
159500200529     C                     MOVEL'PB00115' ZAMSID                          CPB001
159600200529     C                     EXSR ZASNMS                                    CPB001
159700200529     C                     MOVEL'PMUSRMSG'ZAMSGF                          CPB001
159800200529     C                     MOVE '1'       *IN80                           CPB001
159900200529     C                     MOVE '1'       *IN28                           CPB001
160000200529     C                     ELSE                                           CPB001
160100200529     C                     MOVE DDPREF    WNPREF  40                      CPB001
160200200529     C                     ENDIF                                          CPB001
160300200529     C** Must be in range 0001 -> 0099                                    CPB001
160400200529     C           *IN83     IFEQ *ON                                       CPB001
160500200529     C           WNPREF    ANDLT1                                         CPB001
160600200529     C           *IN83     OREQ *ON                                       CPB001
160700200529     C           WNPREF    ANDGT99                                        CPB001
160800200529     C                     MOVEL'PBUSRMSG'ZAMSGF                          CPB001
160900200529     C                     MOVEL'PB00115' ZAMSID                          CPB001
161000200529     C                     EXSR ZASNMS                                    CPB001
161100200529     C                     MOVEL'PMUSRMSG'ZAMSGF                          CPB001
161200200529     C                     MOVE '1'       *IN80                           CPB001
161300200529     C                     MOVE '1'       *IN28                           CPB001
161400200529     C                     ENDIF                                          CPB001
161500200529     C                     ENDIF                                          CPB001
161600200529     C                     ENDIF                                          CPB001
161700200529     C*                                                                   CPB001
161800200529     C           BGPFMG    IFEQ 'Y'                                       CPB001
161900200529     C           BGN4ST    ANDNE'Y'                                       CPB001
162000200529     C           *IN27     ANDEQ*OFF                                      CPB001
162100200529     C           BGPFMG    OREQ 'Y'                                       CPB001
162200200529     C           BGN4ST    ANDEQ'Y'                                       CPB001
162300200529     C           BBPRBA    ANDNE'Y'                                       CPB001
162400200529     C           *IN27     ANDEQ*OFF                                      CPB001
162500200529     C                     EXSR #CUST
162600200529     C                     ENDIF                                          CPB001
162700200529     C**
162800200529     C** CHECK IF PORTFOLIO REFERENCE CONTAINS ONLY LETTERS OR
162900200529     C** NUMBERS
163000200529     C**
163100200529     C                     MOVEADDPREF    RFNC
163200200529     C                     Z-ADD0         X
163300200529     C                     MOVE '0'       *IN89
163400200529     C           X         DOUEQ4
163500200529     C**
163600200529     C                     ADD  1         X
163700200529     C**
163800200529     C           RFNC,X    LOKUPNUMA                     88
163900200529     C**
164000200529     C           *IN88     IFEQ '0'
164100200529     C           *IN89     ANDEQ'0'
164200200529     C*********************MOVEL'PM11110' MSGID                           R00300
164300200529     C*********************CALL 'ZA0240'                                  R00300
164400200529     C*********************PARM           MSGID                           R00300
164500200529     C                     MOVEL'PM11110' ZAMSID                          R00300
164600200529     C                     EXSR ZASNMS                                    R00300
164700200529     C                     MOVE '1'       *IN80
164800200529     C                     MOVE '1'       *IN89
164900200529     C                     MOVE '1'       *IN28
165000200529     C                     END
165100200529     C**
165200200529     C                     END
165300200529     C**
165400200529     C** CHECK IF PORTFOLIO REFERENCE IS VALID
165500200529     C**
165600200529     C           DDPREF    IFEQ '9997'
165700200529     C           DDPREF    OREQ '9998'
165800200529     C           DDPREF    OREQ '9999'
165900200529     C***********DDPREF    OREQ P9R997                                    S01486
166000200529     C***********DDPREF    OREQ P9R998                                    S01486
166100200529     C***********DDPREF    OREQ P9R999                                    S01486
166200200529     C           DDPREF    OREQ FCR997                                    S01486
166300200529     C           DDPREF    OREQ FCR998                                    S01486
166400200529     C           DDPREF    OREQ FCR999                                    S01486
166500200529     C*********************MOVEL'PM11110' MSGID                           R00300
166600200529     C*********************CALL 'ZA0240'                                  R00300
166700200529     C*********************PARM           MSGID                           R00300
166800200529     C                     MOVEL'PM11110' ZAMSID                          R00300
166900200529     C                     EXSR ZASNMS                                    R00300
167000200529     C                     MOVE '1'       *IN80
167100200529     C                     MOVE '1'       *IN28
167200200529     C                     END
167300200529     C**
167400200529     C** IF NO ERRORS OCCURED CHAIN ON FILES TO CHECK IF ENTRIES EXIST
167500200529     C**
167600200529     C           *IN80     IFEQ '0'
167700200529     C**
167800200529     C                     MOVE QBCUST    WWPNP8
167900200529     C                     MOVE DDPREF    WWPREF
168000200529     C*
168100200529     C** A C T I O N    C O D E    I
168200200529     C*
168300200529     C           DDACTN    IFEQ 'I'
168400200529     C*
168500200529     C** IF INSERT- RECORD CANNOT EXIST
168600200529     C*
168700200529     C           PMPORK    CHAINPMPORTXX             71
168800200529     C           *IN71     IFEQ '0'
168900200529     C****       PNRECI    ANDEQ'D'                                       B08268
169000200529     C*********************MOVEL'PM11107' MSGID                           R00300
169100200529     C*********************CALL 'ZA0240'                                  R00300
169200200529     C*********************PARM           MSGID                           R00300
169300200529     C                     MOVEL'PM11107' ZAMSID                          R00300
169400200529     C                     EXSR ZASNMS                                    R00300
169500200529     C                     MOVE '1'       *IN80
169600200529     C                     MOVE '1'       *IN26
169700200529     C                     MOVE '1'       *IN27
169800200529     C                     MOVE '1'       *IN28
169900200529     C                     END
170000200529     C*
170100200529     C                     END
170200200529     C*
170300200529     C** A C T I O N    C O D E    A
170400200529     C*
170500200529     C           DDACTN    IFEQ 'A'
170600200529     C*
170700200529     C** IF AMEND - RECORD MUST BE LIVE
170800200529     C*
170900200529     C           PMPORK    CHAINPMPORTXX             71
171000200529     C           *IN71     IFEQ '1'
171100200529     C**
171200200529     C** PORTFOLIO NOT FOUND
171300200529     C**
171400200529     C*
171500200529     C*********************MOVEL'PM11108' MSGID                           R00300
171600200529     C*********************CALL 'ZA0240'                                  R00300
171700200529     C*********************PARM           MSGID                           R00300
171800200529     C                     MOVEL'PM11108' ZAMSID                          R00300
171900200529     C                     EXSR ZASNMS                                    R00300
172000200529     C                     MOVE '1'       *IN80
172100200529     C                     MOVE '1'       *IN31
172200200529     C                     MOVE '1'       *IN32
172300200529     C                     MOVE '1'       *IN33
172400200529     C                     ELSE
172500200529     C           PNRECI    IFEQ 'D'
172600200529     C**
172700200529     C** PORTFOLIO FOUND BUT IN PROGRESS TO BE CLOSED
172800200529     C**
172900200529     C           PNDPCL    ANDNE0
173000200529     C*********************MOVEL'PM11116' MSGID                           R00300
173100200529     C*********************CALL 'ZA0240'                                  R00300
173200200529     C*********************PARM           MSGID                           R00300
173300200529     C                     MOVEL'PM11116' ZAMSID                          R00300
173400200529     C                     EXSR ZASNMS                                    R00300
173500200529     C                     MOVE '1'       *IN80
173600200529     C                     MOVE '1'       *IN31
173700200529     C                     MOVE '1'       *IN32
173800200529     C                     MOVE '1'       *IN33
173900200529     C                     END
174000200529     C**
174100200529     C** PORTFOLIO CLOSED
174200200529     C**
174300200529     C           PNRECI    IFNE 'D'
174400200529     C*********************MOVEL'PM11117' MSGID                           R00300
174500200529     C*********************CALL 'ZA0240'                                  R00300
174600200529     C*********************PARM           MSGID                           R00300
174700200529     C                     MOVEL'PM11117' ZAMSID                          R00300
174800200529     C                     EXSR ZASNMS                                    R00300
174900200529     C                     MOVE '1'       *IN80
175000200529     C                     MOVE '1'       *IN31
175100200529     C                     MOVE '1'       *IN32
175200200529     C                     MOVE '1'       *IN33
175300200529     C                     END
175400200529     C                     END
175500200529     C*
175600200529     C                     END
175700200529     C*
175800200529     C** A C T I O N    C O D E    C
175900200529     C*
176000200529     C           DDACTN    IFEQ 'C'
176100200529     C*
176200200529     C** IF CLOSURE - DATE PORTFOLIO CLOSED MUST BE AFTER RUN DATE
176300200529     C*
176400200529     C           PMPORK    CHAINPMPORTXX             71
176500200529     C**
176600200529     C** PORTFOLIO NOT FOUND
176700200529     C**
176800200529     C           *IN71     IFEQ '1'
176900200529     C*
177000200529     C*********************MOVEL'PM11108' MSGID                           R00300
177100200529     C*********************CALL 'ZA0240'                                  R00300
177200200529     C*********************PARM           MSGID                           R00300
177300200529     C                     MOVEL'PM11108' ZAMSID                          R00300
177400200529     C                     EXSR ZASNMS                                    R00300
177500200529     C                     MOVE '1'       *IN80
177600200529     C                     MOVE '1'       *IN31
177700200529     C                     MOVE '1'       *IN32
177800200529     C                     MOVE '1'       *IN33
177900200529     C                     ELSE
178000200529     C**
178100200529     C** PORTFOLIO FOUND BUT ALREADY CLOSED
178200200529     C**
178300200529     C           PNRECI    IFNE 'D'
178400200529     C*
178500200529     C*********************MOVEL'PM11117' MSGID                           R00300
178600200529     C*********************CALL 'ZA0240'                                  R00300
178700200529     C*********************PARM           MSGID                           R00300
178800200529     C                     MOVEL'PM11117' ZAMSID                          R00300
178900200529     C                     EXSR ZASNMS                                    R00300
179000200529     C                     MOVE '1'       *IN80
179100200529     C                     MOVE '1'       *IN31
179200200529     C                     MOVE '1'       *IN32
179300200529     C                     MOVE '1'       *IN33
179400200529     C*********************END                                            SA9108
179500200529     C                     ELSE                                           SA9108
179600200529     C/COPY WNCPYSRC,PM0110C005
179700200529     C*                                                                   SA9108
179800200529     C* TEST IF PORTFOLIO IS A POOL PORTFOLIO                             SA9108
179900200529     C*                                                                   SA9108
180000200529     C***********          MOVE BBCUST    WWCUST  60               SA9108 S01486
180100200529     C**********           MOVE QBCUST    WWCUST  60               S01486 CPM005
180200200529     C**********           MOVE DDCNUM    WWCUST  60                                   CPM005 CSD027
180300200529     C                     MOVE DDCNUM    WWCUST  6                                           CSD027
180400200529     C*                                                                   SA9108
180500200529     C           PM1KEY    CHAINPMPPTDPD             13                   SA9108
180600200529     C*                                                                   SA9108
180700200529     C           *IN13     IFEQ '0'                                       SA9108
180800200529     C                     MOVEL'PM11119' ZAMSID                          SA9108
180900200529     C                     EXSR ZASNMS                                    SA9108
181000200529     C                     MOVE '1'       *IN80                           SA9108
181100200529     C                     MOVE '1'       *IN31                           SA9108
181200200529     C                     MOVE '1'       *IN32                           SA9108
181300200529     C                     MOVE '1'       *IN33                           SA9108
181400200529     C                     ELSE                                           SA9108
181500200529     C*                                                                   SA9108
181600200529     C* TEST IF PORTFOLIO IS ATTACHED TO A POOL PORTFOLIO                 SA9108
181700200529     C*                                                                   SA9108
181800200529     C           PM1KEY    CHAINPMPPTML1             14                   SA9108
181900200529     C*                                                                   SA9108
182000200529     C           *IN14     IFEQ '0'                                       SA9108
182100200529     C                     MOVEL'PM11120' ZAMSID                          SA9108
182200200529     C                     EXSR ZASNMS                                    SA9108
182300200529     C                     MOVE '1'       *IN80                           SA9108
182400200529     C                     MOVE '1'       *IN31                           SA9108
182500200529     C                     MOVE '1'       *IN32                           SA9108
182600200529     C                     MOVE '1'       *IN33                           SA9108
182700200529     C                     END                                            SA9108
182800200529     C*                                                                   SA9108
182900200529     C                     END                                            SA9108
183000200529     C*                                                                   SA9108
183100200529     C                     END                                            SA9108
183200200529     C*                                                                   SA9108
183300200529     C                     END
183400200529     C*
183500200529     C** If Bank Portfolio is supported, portfolio must not have          CPM004
183600200529     C** any transactions/positions againts it.                           CPM004
183700200529     C*                                                                   CPM004
183800200529     C           FCPORS    IFEQ 'B'                                       CPM004
183900200529     C           *IN80     ANDNE*ON                                       CPM004
184000200529     C*                                                                   CPM004
184100200529     C           PMPORK    CHAINPMPOTTP0             08                   CPM004
184200200529     C*                                                                   CPM004
184300200529     C           *IN08     IFEQ *OFF                                      CPM004
184400200529     C           QCPTPA    IFNE *ZERO                                     CPM004
184500200529     C           QCPTNA    ORNE *ZERO                                     CPM004
184600200529     C           QCPTMV    ORNE *ZERO                                     CPM004
184700200529     C           QCPVPA    ORNE *ZERO                                     CPM004
184800200529     C           QCPVNA    ORNE *ZERO                                     CPM004
184900200529     C           QCPTMV    ORNE *ZERO                                     CPM004
185000200529     C           QCPTAI    ORNE *ZERO                                     CPM004
185100200529     C           QCPTNI    ORNE *ZERO                                     CPM004
185200200529     C                     MOVEL'PMA0016' ZAMSID                          CPM004
185300200529     C                     EXSR ZASNMS                                    CPM004
185400200529     C                     MOVE *ON       *IN80                           CPM004
185500200529     C                     MOVEA'111'     *IN,31                          CPM004
185600200529     C                     ENDIF                                          CPM004
185700200529     C                     ENDIF                                          CPM004
185800200529     C*                                                                   CPM004
185900200529     C                     ENDIF                                          CPM004
186000200529     C*                                                                   CPM004
186100200529     C                     END
186200200529     C*
186300200529     C** A C T I O N    C O D E    E
186400200529     C*
186500200529     C           DDACTN    IFEQ 'E'
186600200529     C           PMPORK    CHAINPMPORTXX             71
186700200529     C*
186800200529     C** IF ENQUIRY - RECORD MUST EXIST
186900200529     C*
187000200529     C           *IN71     IFEQ '1'
187100200529     C*********************MOVEL'PM11109' MSGID                           R00300
187200200529     C*********************CALL 'ZA0240'                                  R00300
187300200529     C*********************PARM           MSGID                           R00300
187400200529     C                     MOVEL'PM11109' ZAMSID                          R00300
187500200529     C                     EXSR ZASNMS                                    R00300
187600200529     C                     MOVE '1'       *IN80
187700200529     C                     MOVE '1'       *IN31
187800200529     C                     MOVE '1'       *IN32
187900200529     C                     MOVE '1'       *IN33
188000200529     C                     END
188100200529     C**
188200200529     C                     END
188300200529     C*
188400200529     C                     END
188500200529     C**
188600200529     C                     ELSE
188700200529     C** CHECK IF ONLY REVIEW FROM FIELDS ARE FILLED
188800200529     C**
188900200529     C           WWWORK    IFNE *BLANKS
189000200529     C           DDCSNM    ANDNE*BLANKS
189100200529     C*********************MOVEL'PM11114' MSGID  10                       R00300
189200200529     C*********************CALL 'ZA0240'                                  R00300
189300200529     C*********************PARM           MSGID                           R00300
189400200529     C                     MOVEL'PM11114' ZAMSID                          R00300
189500200529     C                     EXSR ZASNMS                                    R00300
189600200529     C                     MOVE '1'       *IN80
189700200529     C                     MOVE '1'       *IN27
189800200529     C                     END
189900200529     C**
190000200529     C           WWWORK    IFNE *BLANKS
190100200529     C           DDPREF    ANDNE*BLANKS
190200200529     C*********************MOVEL'PM11114' MSGID  10                       R00300
190300200529     C*********************CALL 'ZA0240'                                  R00300
190400200529     C*********************PARM           MSGID                           R00300
190500200529     C                     MOVEL'PM11114' ZAMSID                          R00300
190600200529     C                     EXSR ZASNMS                                    R00300
190700200529     C                     MOVE '1'       *IN80
190800200529     C                     MOVE '1'       *IN28
190900200529     C                     END
191000200529     C**
191100200529     C           DDACTN    IFEQ *BLANK
191200200529     C           DDCSNM    ANDNE*BLANKS
191300200529     C           DDACTN    OREQ *BLANK
191400200529     C           DDPREF    ANDNE*BLANKS
191500200529     C*********************MOVEL'PM11101' MSGID  10                       R00300
191600200529     C*********************CALL 'ZA0240'                                  R00300
191700200529     C*********************PARM           MSGID                           R00300
191800200529     C                     MOVEL'PM11101' ZAMSID                          R00300
191900200529     C                     EXSR ZASNMS                                    R00300
192000200529     C                     MOVE '1'       *IN80
192100200529     C                     MOVE '1'       *IN26
192200200529     C                     END
192300200529     C**
192400200529     C           DDPORT    IFNE *BLANKS
192500200529     C           DDPNP8    ANDEQ*BLANKS
192600200529     C*********************MOVEL'PM11102' MSGID  10                       R00300
192700200529     C*********************CALL 'ZA0240'                                  R00300
192800200529     C*********************PARM           MSGID                           R00300
192900200529     C                     MOVEL'PM11102' ZAMSID                          R00300
193000200529     C                     EXSR ZASNMS                                    R00300
193100200529     C                     MOVE '1'       *IN80
193200200529     C                     MOVE '1'       *IN29
193300200529     C                     END
193400200529     C**
193500200529     C                     END
193600200529     C*
193700200529     C** IF DETAILS FOUND AND ACTION CODE 'C' OR 'D' CHECK WHETHER
193800200529     C** PORTFOLIO DETAILS ARE ALREADY BEING UPDATED BY ANOTHER
193900200529     C** WORKSTATION
194000200529     C*
194100200529     C           DDACTN    IFEQ 'A'
194200200529     C           DDACTN    OREQ 'C'
194300200529     C           *IN80     IFEQ '0'
194400200529     C***********PMPORK    CHAINPMPORTPP             71                   S01486
194500200529     C           PMPORK    CHAINPMPORTPD             71                   S01486
194600200529     C*
194700200529     C**********           Z-ADDWWPNP8    WWCSSV  60                                          CSD027
194800200529     C                     MOVE WWPNP8    WWCSSV  6                                           CSD027
194900200529     C                     MOVE WWPREF    WWPRSV  4
195000200529     C*
195100200529     C           *IN71     IFEQ '0'
195200200529     C*
195300200529     C** IF RECORD IS NOT ALREADY BEING UPDATED FLAG IT FOR UPDATE
195400200529     C*
195500200529     C           PNWSI1    IFEQ *BLANKS
195600200529     C                     Z-ADDPNTNLU    WWTNLU
195700200529     C                     MOVE 'Y'       WWLOCK  1
195800200529     C                     MOVE WSIDN     PNWSI1
195900200529     C                     UPDATPMPORTP0
196000200529     C                     ELSE
196100200529     C*
196200200529     C** IF RECORD ALREADY BEING UPDATED FLAG SEND ERROR MESSAGE
196300200529     C*
196400200529     C                     MOVE 'N'       WWLOCK
196500200529     C*********************MOVEL'PM11118' MSGID  10                       R00300
196600200529     C*********************MOVELPNWSI1    WWDATA 45                       R00300
196700200529     C*********************CALL 'ZA0440'                                  R00300
196800200529     C*********************PARM           MSGID                           R00300
196900200529     C*********************PARM           WWDATA                          R00300
197000200529     C                     MOVEL'PM11118' ZAMSID                          R00300
197100200529     C                     MOVELPNWSI1    ZAMSDA                          R00300
197200200529     C                     EXSR ZASNMS                                    R00300
197300200529     C                     MOVE '1'       *IN80
197400200529     C                     UPDATPMPORTP0
197500200529     C                     END
197600200529     C                     COMIT
197700200529     C                     END
197800200529     C                     END
197900200529     C                     END
198000200529     C*
198100200529     C                     ENDSR
198200200529     C*
198300200529     C**************************************************************************
198400200529      /EJECT
198500200529      **************************************************************************
198600200529      *                                                                        *
198700200529      * #ZBAC    - TO VALIDATE KEY FIELDS FROM REVIEW SCREEN                   *
198800200529      *                                                                        *
198900200529      * SUBROUTINE CALLS:                                                      *
199000200529      ********ZA0240   - TO ACCESS MESSAGE FILE AND SEND MESSAGE          R00300
199100200529      * ZASNMS   - WRITE ERROR MESSAGES                                   R00300
199200200529      *                                                                        *
199300200529      * SUBROUTINE CALLED FROM:                                                *
199400200529      * #P1003   - TO PROCESS SUBFILE SELECTION SCREEN                         *
199500200529      *                                                                        *
199600200529      *                                                                        *
199700200529      **************************************************************************
199800200529     C           #ZBAC     BEGSR                           ** #ZBAC  BSR**
199900200529     C*
200000200529     C** RESET ERROR INDICATORS
200100200529     C*
200200200529     C                     MOVE '0'       *IN30
200300200529     C*                                                                   CPB001
200400200529     C           BGN4ST    IFEQ 'Y'                                       CPB001
200500200529     C                     MOVEL'PBUSRMSG'ZAMSGF                          CPB001
200600200529     C*                                                                   CPB001
200700200529     C                     CALL 'AOCUSTR1'                                CPB001
200800200529     C                     PARM '*MSG    'WWRTCD                          CPB001
200900200529     C                     PARM '*KEY    'WWOPTN                          CPB001
201000200529     C                     PARM DDCNUM    WWKY10                          CPB001
201100200529     C                     PARM WWSORT    WWKE7                           CPB001
201200200529     C           SDCUST    PARM SDCUST    DSLDY                           CPB001
201300200529     C*                                                                   CPB001
201400200529     C           DDACTN    IFEQ 'I'                                       CPB001
201500200529     C           BBPRBA    ANDEQ'Y'                                       CPB001
201600200529     C           DDACTN    OREQ 'C'                                       CPB001
201700200529     C           BBPRBA    ANDEQ'Y'                                       CPB001
201800200529     C                     MOVEL'PB00073' ZAMSID                          CPB001
201900200529     C                     MOVELDDACTN    ZAMSDA    P                     CPB001
202000200529     C                     EXSR ZASNMS                                    CPB001
202100200529     C                     MOVE '1'       *IN80                           CPB001
202200200529     C                     Z-ADDRRN1      WWSAVE                          CPB001
202300200529     C                     ELSE                                           CPB001
202400200529     C           DDACTN    IFNE 'A'                                       CPB001
202500200529     C           BBPRBA    ANDEQ'Y'                                       CPB001
202600200529     C           DDACTN    ANDNE'E'                                       CPB001
202700200529     C           BBPRBA    ANDEQ'Y'                                       CPB001
202800200529     C                     MOVEL'PB00055' ZAMSID                          CPB001
202900200529     C                     EXSR ZASNMS                                    CPB001
203000200529     C                     MOVE '1'       *IN80                           CPB001
203100200529     C                     Z-ADDRRN1      WWSAVE                          CPB001
203200200529     C                     ENDIF                                          CPB001
203300200529     C                     ENDIF                                          CPB001
203400200529     C*                                                                   CPB001
203500200529     C                     MOVEL'PMUSRMSG'ZAMSGF                          CPB001
203600200529     C                     ENDIF                                          CPB001
203700200529     C*                                                                   CPB001
203800200529     C           *IN80     IFEQ '0'                                       CPB001
203900200529     C**
204000200529     C** ACTION CODE MUST BE A, E OR C
204100200529     C**
204200200529     C           DDACTN    IFNE 'A'
204300200529     C           DDACTN    ANDNE'E'
204400200529     C           DDACTN    ANDNE'C'
204500200529     C           DDACTN    ANDNE'I'
204600200529     C*********************MOVEL'PM11111' MSGID                           R00300
204700200529     C*********************CALL 'ZA0240'                                  R00300
204800200529     C*********************PARM           MSGID                           R00300
204900200529     C                     MOVEL'PM11111' ZAMSID                          R00300
205000200529     C                     EXSR ZASNMS                                    R00300
205100200529     C                     MOVE '1'       *IN80
205200200529     C                     Z-ADDRRN1      WWSAVE
205300200529     C**
205400200529     C                     ELSE
205500200529     C/COPY WNCPYSRC,PM0110C003
205600200529     C** USER SHOULD BE AUTHORISED TO ACTION CODE                         S01486
205700200529     C*                                                                   S01486
205800200529     C** WHEN SINGLE BRANCH                                               S01486
205900200529     C           MBIN      IFNE 'Y'                                       S01486
206000200529     C*                                                                   S01486
206100200529     C                     CALL 'ZVACTU'                                  S01486
206200200529     C                     PARM DDACTN    @ZACTN  1                       S01486
206300200529     C                     PARM           @ERR    10                      S01486
206400200529     C           @ERR      IFNE *ZERO                                     S01486
206500200529     C                     MOVEL'PM02000' ZAMSID                          S01486
206600200529     C                     EXSR ZASNMS                                    S01486
206700200529     C                     MOVE '1'       *IN26                           S01486
206800200529     C                     MOVE '1'       *IN80                           S01486
206900200529     C                     END                                            S01486
207000200529     C*                                                                   S01486
207100200529     C                     ELSE                                           S01486
207200200529     C*                                                                   S01486
207300200529     C** WHEN MULTI-BRANCH                                                S01486
207400200529     C                     CALL 'ZVACTBU'                                 S01486
207500200529     C                     PARM DDACTN    @ZACTN  1                       S01486
207600200529     C                     PARM USRBCH    @ZBR    3                       S01486
207700200529     C                     PARM           @ERR    10                      S01486
207800200529     C           @ERR      IFNE *ZERO                                     S01486
207900200529     C                     MOVEL'PM02000' ZAMSID                          S01486
208000200529     C                     EXSR ZASNMS                                    S01486
208100200529     C                     MOVE '1'       *IN26                           S01486
208200200529     C                     MOVE '1'       *IN80                           S01486
208300200529     C                     END                                            S01486
208400200529     C                     END                                            S01486
208500200529     C*                                                                   S01486
208600200529     C**
208700200529     C                     MOVE DDCNUM    WWPNP8
208800200529     C                     MOVE DDPTFR    WWPREF
208900200529     C           PMPORK    CHAINPMPORTXX             72
209000200529     C**
209100200529     C           DDACTN    IFEQ 'I'
209200200529     C           PNRECI    ANDEQ'D'
209300200529     C*********************MOVEL'PM11107' MSGID                           R00300
209400200529     C*********************CALL 'ZA0240'                                  R00300
209500200529     C*********************PARM           MSGID                           R00300
209600200529     C                     MOVEL'PM11107' ZAMSID                          R00300
209700200529     C                     EXSR ZASNMS                                    R00300
209800200529     C                     MOVE '1'       *IN80
209900200529     C                     Z-ADDRRN1      WWSAVE
210000200529     C                     END
210100200529     C**
210200200529     C           DDACTN    IFEQ 'A'
210300200529     C**
210400200529     C           *IN72     IFEQ '1'
210500200529     C*********************MOVEL'PM11112' MSGID                           R00300
210600200529     C*********************CALL 'ZA0240'                                  R00300
210700200529     C*********************PARM           MSGID                           R00300
210800200529     C                     MOVEL'PM11112' ZAMSID                          R00300
210900200529     C                     EXSR ZASNMS                                    R00300
211000200529     C                     MOVE '1'       *IN80
211100200529     C                     Z-ADDRRN1      WWSAVE
211200200529     C                     ELSE
211300200529     C           PNRECI    IFEQ 'D'
211400200529     C**
211500200529     C** PORTFOLIO FOUND BUT CLOSED
211600200529     C**
211700200529     C           PNDPCL    ANDNE0
211800200529     C*********************MOVEL'PM11116' MSGID                           R00300
211900200529     C*********************CALL 'ZA0240'                                  R00300
212000200529     C*********************PARM           MSGID                           R00300
212100200529     C                     MOVEL'PM11116' ZAMSID                          R00300
212200200529     C                     EXSR ZASNMS                                    R00300
212300200529     C                     MOVE '1'       *IN80
212400200529     C                     Z-ADDRRN1      WWSAVE
212500200529     C                     END
212600200529     C           PNRECI    IFNE 'D'
212700200529     C*********************MOVEL'PM11117' MSGID                           R00300
212800200529     C*********************CALL 'ZA0240'                                  R00300
212900200529     C*********************PARM           MSGID                           R00300
213000200529     C                     MOVEL'PM11117' ZAMSID                          R00300
213100200529     C                     EXSR ZASNMS                                    R00300
213200200529     C                     MOVE '1'       *IN80
213300200529     C                     Z-ADDRRN1      WWSAVE
213400200529     C                     END
213500200529     C                     END
213600200529     C                     END
213700200529     C**
213800200529     C           DDACTN    IFEQ 'C'
213900200529     C**
214000200529     C           *IN72     IFEQ '1'
214100200529     C**
214200200529     C** PORTFOLIO NOT FOUND
214300200529     C**
214400200529     C*********************MOVEL'PM11112' MSGID                           R00300
214500200529     C*********************CALL 'ZA0240'                                  R00300
214600200529     C*********************PARM           MSGID                           R00300
214700200529     C                     MOVEL'PM11112' ZAMSID                          R00300
214800200529     C                     EXSR ZASNMS                                    R00300
214900200529     C                     MOVE '1'       *IN80
215000200529     C                     Z-ADDRRN1      WWSAVE
215100200529     C                     ELSE
215200200529     C           PNRECI    IFNE 'D'
215300200529     C*********************MOVEL'PM11117' MSGID                           R00300
215400200529     C*********************CALL 'ZA0240'                                  R00300
215500200529     C*********************PARM           MSGID                           R00300
215600200529     C                     MOVEL'PM11117' ZAMSID                          R00300
215700200529     C                     EXSR ZASNMS                                    R00300
215800200529     C                     MOVE '1'       *IN80
215900200529     C                     Z-ADDRRN1      WWSAVE
216000200529     C                     ELSE                                           S01486
216100200529     C*                                                                   S01486
216200200529     C* TEST IF PORTFOLIO IS A POOL PORTFOLIO                             S01486
216300200529     C*                                                                   S01486
216400200529     C**********           MOVE BBCUST    WWCUST  60                                   S01486 CSD027
216500200529     C                     MOVE BBCUST    WWCUST  6                                           CSD027
216600200529     C*                                                                   S01486
216700200529     C           PM1KEY    CHAINPMPPTDPD             13                   S01486
216800200529     C*                                                                   S01486
216900200529     C           *IN13     IFEQ '0'                                       S01486
217000200529     C                     MOVEL'PM11119' ZAMSID                          S01486
217100200529     C                     EXSR ZASNMS                                    S01486
217200200529     C                     MOVE '1'       *IN80                           S01486
217300200529     C                     MOVE '1'       *IN31                           S01486
217400200529     C                     MOVE '1'       *IN32                           S01486
217500200529     C                     MOVE '1'       *IN33                           S01486
217600200529     C                     ELSE                                           S01486
217700200529     C*                                                                   S01486
217800200529     C* TEST IF PORTFOLIO IS ATTACHED TO A POOL PORTFOLIO                 S01486
217900200529     C*                                                                   S01486
218000200529     C           PM1KEY    CHAINPMPPTML1             14                   S01486
218100200529     C*                                                                   S01486
218200200529     C           *IN14     IFEQ '0'                                       S01486
218300200529     C                     MOVEL'PM11120' ZAMSID                          S01486
218400200529     C                     EXSR ZASNMS                                    S01486
218500200529     C                     MOVE '1'       *IN80                           S01486
218600200529     C                     MOVE '1'       *IN31                           S01486
218700200529     C                     MOVE '1'       *IN32                           S01486
218800200529     C                     MOVE '1'       *IN33                           S01486
218900200529     C                     END                                            S01486
219000200529     C*                                                                   S01486
219100200529     C                     END                                            S01486
219200200529     C                     END
219300200529     C/COPY WNCPYSRC,PM0110C006
219400200529     C                     END
219500200529     C                     END
219600200529     C**
219700200529     C           DDACTN    IFEQ 'E'
219800200529     C**
219900200529     C           *IN72     IFEQ '1'
220000200529     C*********************MOVEL'PM11113' MSGID                           R00300
220100200529     C*********************CALL 'ZA0240'                                  R00300
220200200529     C*********************PARM           MSGID                           R00300
220300200529     C                     MOVEL'PM11113' ZAMSID                          R00300
220400200529     C                     EXSR ZASNMS                                    R00300
220500200529     C                     MOVE '1'       *IN80
220600200529     C                     Z-ADDRRN1      WWSAVE
220700200529     C                     END
220800200529     C                     END
220900200529     C**
221000200529     C                     END
221100200529     C*
221200200529     C** IF DETAILS FOUND AND ACTION CODE 'C' OR 'D' CHECK WHETHER
221300200529     C** PORTFOLIO DETAILS ARE ALREADY BEING UPDATED BY ANOTHER
221400200529     C** WORKSTATION
221500200529     C*
221600200529     C           DDACTN    IFEQ 'A'
221700200529     C           DDACTN    OREQ 'C'
221800200529     C           *IN80     IFEQ '0'
221900200529     C***********PMPORK    CHAINPMPORTPP             71                   S01486
222000200529     C           PMPORK    CHAINPMPORTPD             71                   S01486
222100200529     C*
222200200529     C**********           Z-ADDWWPNP8    WWCSSV                                              CSD027
222300200529     C                     MOVE WWPNP8    WWCSSV                                              CSD027
222400200529     C                     MOVE WWPREF    WWPRSV
222500200529     C*
222600200529     C           *IN71     IFEQ '0'
222700200529     C*
222800200529     C** IF RECORD IS NOT ALREADY BEING UPDATED FLAG IT FOR UPDATE
222900200529     C*
223000200529     C           PNWSI1    IFEQ *BLANKS
223100200529     C                     MOVE 'Y'       WWLOCK
223200200529     C                     Z-ADDPNTNLU    WWTNLU
223300200529     C                     MOVE WSIDN     PNWSI1
223400200529     C                     UPDATPMPORTP0
223500200529     C                     ELSE
223600200529     C*
223700200529     C** IF RECORD ALREADY BEING UPDATED FLAG SEND ERROR MESSAGE
223800200529     C*
223900200529     C                     MOVE 'N'       WWLOCK
224000200529     C*********************MOVEL'PM11118' MSGID  10                       R00300
224100200529     C*********************MOVELPNWSI1    WWDATA 45                       R00300
224200200529     C*********************CALL 'ZA0440'                                  R00300
224300200529     C*********************PARM           MSGID                           R00300
224400200529     C*********************PARM           WWDATA                          R00300
224500200529     C                     MOVEL'PM11118' ZAMSID                          R00300
224600200529     C                     MOVELPNWSI1    ZAMSDA                          R00300
224700200529     C                     EXSR ZASNMS                                    R00300
224800200529     C                     MOVE '1'       *IN80
224900200529     C                     UPDATPMPORTP0
225000200529     C                     END
225100200529     C                     COMIT
225200200529     C                     END
225300200529     C                     END
225400200529     C                     END
225500200529     C                     ENDIF                                          CPB001
225600200529     C**
225700200529     C                     ENDSR
225800200529     C**
225900200529     C**************************************************************************
226000200529      /EJECT
226100200529      **************************************************************************
226200200529      *                                                                        *
226300200529      * #CUST    - TO VALIDATE CUSTOMER NUMBER/SHORTNAME                       *
226400200529      *                                                                        *
226500200529      * SUBROUTINE CALLS:                                                      *
226600200529      *********ZA0240   - TO ACCESS MESSAGE FILE AND SEND MESSAGE              *
226700200529      * ZASNMS   - WRITE ERROR MESSAGES                                   R00300
226800200529      *                                                                        *
226900200529      * SUBROUTINE CALLED FROM:                                                *
227000200529      * #ZBAB    - TO VALIDATE KEY FIELDS FROM START SCREEN                    *
227100200529      *                                                                        *
227200200529      *                                                                        *
227300200529      **************************************************************************
227400200529     C           #CUST     BEGSR
227500200529     C**
227600200529     C                     MOVELDDCSNM    WWCNUM
227700200529     C           WWCNUM    IFNE *BLANKS
227800200529     C**
227900200529     C** CHECK IF SHORT NAME OR CUSTOMER NUMBER ENTERED
228000200529     C**
228100200529     C***********          TESTN          WWCNM1     83                   S01486
228200200529     C***********WWCNM2    IFEQ *BLANKS                                   S01486
228300200529     C************IN83     ANDEQ'1'                                       S01486
228400200529     C***********                                                         S01486
228500200529     C***CUSTOMER NUMBER ENTERED                                          S01486
228600200529     C***********                                                         S01486
228700200529     C***********WWCNM1    CHAINSDPLCSL2             72                   S01486
228800200529     C************IN72     IFEQ '1'                                       S01486
228900200529     C                     CALL 'AOPLCSR0'                                S01486
229000200529     C                     PARM '*MSG    'WWRTCD  7                       S01486
229100200529     C                     PARM '*KEY    'WWOPTN  7                       S01486
229200200529     C                     PARM WWCNUM    WWKY10 10                       S01486
229300200529     C           SDPLCS    PARM SDPLCS    DSSDY                           S01486
229400200529     C           WWRTCD    IFNE *BLANKS                                   S01486
229500200529     C***********QBCHTP    OREQ 'D'                                 R5556 S01486
229600200529     C           QBTYLC    OREQ 'D'                                       S01486
229700200529     C*********************MOVEL'PM11104' MSGID                           R00300
229800200529     C*********************CALL 'ZA0240'                                  R00300
229900200529     C*********************PARM           MSGID                           R00300
230000200529     C                     MOVEL'PM11104' ZAMSID                          R00300
230100200529     C                     EXSR ZASNMS                                    R00300
230200200529     C                     MOVE '1'       *IN80
230300200529     C                     MOVE '1'       *IN81
230400200529     C                     MOVE '1'       *IN27
230500200529     C                     ELSE
230600200529     C                     MOVE QBCUST    WWPNP8
230700200529     C                     MOVELQBCUST    DDCSNM    P                     103080
230800200529     C                     MOVELQBCUST    WWCNUM    P                     103080
230900200529     C                     END
231000200529     C*
231100200529     C***********          ELSE
231200200529     C***********
231300200529     C***SHORT*NAME ENTERED
231400200529     C***********
231500200529     C***********WWCNUM    CHAINSDPLCSL3             72                   S01486
231600200529     C************IN72     IFEQ '1'                                       S01486
231700200529     C***********QBCHTP    OREQ 'D'                                 R5556 S01486
231800200529     C*********************MOVEL'PM11103' MSGID                           R00300
231900200529     C*********************CALL 'ZA0240'                                  R00300
232000200529     C*********************PARM           MSGID                           R00300
232100200529     C***********          MOVEL'PM11103' ZAMSID                    R00300S01486
232200200529     C***********          EXSR ZASNMS                              R00300S01486
232300200529     C***********          MOVE '1'       *IN80                           S01486
232400200529     C***********          MOVE '1'       *IN81                           S01486
232500200529     C***********          MOVE '1'       *IN27                           S01486
232600200529     C***********          ELSE                                           S01486
232700200529     C***********          MOVE QBCUST    WWPNP8                          S01486
232800200529     C***********          END                                            S01486
232900200529     C*
233000200529     C                     END
233100200529     C**
233200200529     C***********          END                                            S01486
233300200529     C*
233400200529     C                     ENDSR
233500200529     C*
233600200529     C**************************************************************************
233700200529      /EJECT
233800200529      **************************************************************************
233900200529      *                                                                        *
234000200529      * #P1004   - TO PROCESS DETAIL SCREEN AND UPDATE FILES                   *
234100200529      *                                                                        *
234200200529      * SUBROUTINE CALLS:                                                      *
234300200529      * #TRANS   - TO ACCESS FILE AND FILL DISPLAY FIELDS                      *
234400200529      * #READ    - TO FILL SUBFILE - PORTFOLIO CHARGES                         *
234500200529      **********ZA0250   - TO CLEAR MESSAGE                               R00300
234600200529      * Y2CLMSC  - CLEAR MESSAGE QUEUE                                    R00300
234700200529      * #ZBAA    - TO MOVE THE APPROPRIATE VALUE IN WWAID                      *
234800200529      * #V1004   - TO VALIDATE PORTFOLIO DEFINITION DETAILS                    *
234900200529      * #V1005   - TO VALIDATE DATE PORTFOLIO CLOSED                           *
235000200529      * #P1006   - TO PROCESS INVESTMENT POLICY INDICATORS(AMEND)              *
235100200529      * #P1007   - TO PROCESS INVESTMENT POLICY INDICATORS(ENQUIRY)            *
235200200529      * #P1005   - TO PROCESS PORTFOLIO CHARGE DETAILS                         *
235300200529      *********ZA0240   - TO ACCESS MESSAGE FILE AND SEND MESSAGE              *
235400200529      * ZASNMS   - WRITE ERROR MESSAGES                                   R00300
235500200529      * PM0600   - NOTEPAD                                                     *
235600200529      * #P1008   - TO UPDATE PORTFOLIO DEFINITION FILE                         *
235700200529      * #P1009   - TO UPDATE PORTFOLIO CHARGES DETAILS FILE                    *
235800200529      * #P1010   - TO UPDATE PORTFOLIO DEFINITION AUDIT                        *
235900200529      *                                                                        *
236000200529      * SUBROUTINE CALLED FROM:                                                *
236100200529      * MAIN     - MAIN PROCESSING                                             *
236200200529      *                                                                        *
236300200529      *                                                                        *
236400200529      **************************************************************************
236500200529     C           #P1004    BEGSR                           **#P1004  BSR**
236600200529     C*
236700200529     C** SET SCREEN INDICATORS - PROTECT KEY, SET OFF ERROR INDS,
236800200529     C** POSITION CURSOR
236900200529     C*
237000200529     C                     MOVE *OFF      *IN07                           S71062
237100200529     C                     MOVE '0'       *IN12
237200200529     C                     MOVE '0'       *IN16                           S01313
237300200529     C                     MOVE '0'       *IN17                           S01313
237400200529     C                     MOVE '0'       *IN18                           S01313
237500200529     C                     MOVE '0'       *IN19                           S01313
237600200529     C                     MOVE '0'       *IN09                           S01313
237700200529     C                     MOVE '0'       *IN24
237800200529     C                     MOVE '1'       *IN25
237900200529     C                     MOVE '0'       *IN26
238000200529     C                     MOVE '0'       *IN27
238100200529     C                     MOVE '0'       *IN28
238200200529     C                     MOVE '0'       *IN29
238300200529     C                     MOVE '0'       *IN30
238400200529     C                     MOVE '0'       *IN31
238500200529     C                     MOVE '0'       *IN32
238600200529     C                     MOVE '0'       *IN33
238700200529     C                     MOVE '0'       *IN34
238800200529     C                     MOVE '0'       *IN35
238900200529     C                     MOVE '0'       *IN36
239000200529     C                     MOVE '0'       *IN37
239100200529     C                     MOVE '0'       *IN38
239200200529     C                     MOVE '0'       *IN39
239300200529     C                     MOVE '0'       *IN40
239400200529     C                     MOVE '0'       *IN41
239500200529     C                     MOVE '0'       *IN42
239600200529     C                     MOVE '0'       *IN43
239700200529     C                     MOVE '0'       *IN44
239800200529     C                     MOVE '0'       *IN45
239900200529     C                     MOVE '0'       *IN46
240000200529     C                     MOVE '0'       *IN47
240100200529     C                     MOVE '0'       *IN48
240200200529     C                     MOVE '0'       *IN49
240300200529     C                     MOVE '0'       *IN50
240400200529     C                     MOVE '0'       *IN51
240500200529     C                     MOVE '0'       *IN52
240600200529     C                     MOVE '0'       *IN53
240700200529     C                     MOVE '0'       *IN54
240800200529     C                     MOVE '0'       *IN55
240900200529     C                     MOVE '0'       *IN56
241000200529     C                     MOVE '0'       *IN57
241100200529     C                     MOVE '0'       *IN58
241200200529     C                     MOVE '0'       *IN74                           S01313
241300200529     C                     MOVE '0'       *IN15                           CPM005
241400200529     C                     MOVE '0'       *IN78                           CPM005
241500200529     C                     MOVE '0'       *IN84                           CPB001
241600200529     C                     MOVEL*BLANKS   DDDELT
241700200529     C                     Z-ADD0         WWTNLB
241800200529     C                     MOVE 'N'       WWCHGP  1                       B08166
241900200529     C*
242000200529     C** If Analytical Accounting is on, set off indicator.               CAC003
242100200529     C           *IN87     IFEQ '1'                                       CAC003
242200200529     C                     MOVE '0'       *IN05                           CAC003
242300200529     C                     MOVE '0'       *IN06                           CAC003
242400200529     C                     ENDIF                                          CAC003
242500200529     C*                                                                   CAC003
242600200529     C** PROTECT DATE PORTFOLIO OPENED IN AMEND MODE
242700200529     C           DDACTN    IFEQ 'A'
242800200529     C                     MOVE '1'       *IN24
242900200529     C                     END
243000200529     C*                                                                   CAC003
243100200529     C** If Analytical Accounting is on, protect the profit               CAC003
243200200529     C** centre input field if not in Insert Mode.                        CAC003
243300200529     C           *IN87     IFEQ '1'                                       CAC003
243400200529     C           DDACTN    ANDNE'I'                                       CAC003
243500200529     C                     MOVE '1'       *IN05                           CAC003
243600200529     C*                                                                   CAC003
243700200529     C** Amendment of Profit Centre is permitted only on day of input     CAC003
243800200529     C           BJRDNB    IFEQ PNLCD                                     CAC003
243900200529     C           DDACTN    ANDEQ'A'                                       CAC003
244000200529     C                     MOVE '0'       *IN05                           CAC003
244100200529     C                     ENDIF                                          CAC003
244200200529     C                     ENDIF                                          CAC003
244300200529     C**
244400200529     C** IF CLOSED  RECORD-ENQUIRY ONLY
244500200529     C** OR RECORD-CLOSE TOI MODIFY DATE PORTFOLIO CLOSED
244600200529     C**
244700200529     C           PNRECI    IFEQ '*'
244800200529     C**
244900200529     C** IF ACTION CODE 'I', NO MESSAGE
245000200529     C**
245100200529     C           DDACTN    IFNE 'I'
245200200529     C                     MOVE 'CLOSED'  DDDELT
245300200529     C                     END
245400200529     C**
245500200529     C                     ELSE
245600200529     C**
245700200529     C** IF DATE PORTFOLIO ENTERED THAN PORTFOLIO CLOSURE ASKED
245800200529     C**
245900200529     C           PNDPCL    IFNE 0
246000200529     C                     MOVEL'CLOSURE' DDDELT
246100200529     C                     MOVE 'REQUEST 'DDDELT
246200200529     C                     END
246300200529     C                     END
246400200529     C*
246500200529     C** IF ENQUIRY PROTECT FIELD INPUT ON S/PM0110C1
246600200529     C*
246700200529     C           DDACTN    IFEQ 'E'
246800200529     C                     MOVE '1'       *IN31
246900200529     C                     MOVE '1'       *IN56
247000200529     C                     MOVE '1'       *IN57
247100200529     C                     END
247200200529     C*
247300200529     C** IF CLOSE PROTECT FIELD INPUT ON S/PM0110C1
247400200529     C*
247500200529     C           DDACTN    IFEQ 'C'
247600200529     C                     MOVE '1'       *IN31
247700200529     C                     MOVE '1'       *IN57
247800200529     C                     END
247900200529     C*
248000200529     C** IF AMEND PROTECT FIELD INPUT ON S/PM0110C1
248100200529     C*
248200200529     C           DDACTN    IFEQ 'A'
248300200529     C                     MOVE '1'       *IN56
248400200529     C                     MOVE '1'       *IN57
248500200529     C           BGN4ST    IFEQ 'Y'                                       CPB001
248600200529     C                     MOVE '1'       *IN84                           CPB001
248700200529     C                     ENDIF                                          CPB001
248800200529     C                     END
248900200529     C*
249000200529     C** IF INSERT PROTECT FIELD INPUT ON S/PM0110C1
249100200529     C*
249200200529     C*
249300200529     C           DDACTN    IFEQ 'I'
249400200529     C                     MOVE '1'       *IN56
249500200529     C***********          MOVE '1'       *IN58                           S01486
249600200529     C                     END
249700200529     C**
249800200529     C** FILL DEFINITION SCREEN DETAILS
249900200529     C**
250000200529     C                     EXSR #TRANS
250100200529     C**                                                                  S01486
250200200529     C** PROFIT CENTRE PROCESSING                                         S01486
250300200529     C**                                                                  S01486
250400200529     C                     MOVEL*BLANKS   WWPRFC                          S01486
250500200529     C           BKPRCU    IFEQ 'Y'                                       S01486
250600200529     C                     EXSR #PFRC                                     S01486
250700200529     C                     ELSE                                           S01486
250800200529     C***********          MOVE '1'       *IN20                    S01486 119507
250900200529     C                     MOVE '1'       *IN03                           119507
251000200529     C                     END                                            S01486
251100200529     C**
251200200529     C** FILL SUBFILE
251300200529     C**
251400200529     C                     EXSR #READ
251500200529     C*
251600200529     C** D O    U N T I L   C H A N G E  O F  S C R E E N
251700200529     C*
251800200529     C           WWAID     DOUEQ'03'
251900200529     C           *IN10     OREQ '1'
252000200529     C           *IN11     OREQ '1'
252100200529     C           *IN12     OREQ '1'
252200200529     C**
252300200529     C** LOAD INFO MESSAGE
252400200529     C**
252500200529     C           DDACTN    IFEQ 'C'                                       B8275
252600200529     C*********************MOVEL'PM90073' MSMBR4                    B8275 051784
252700200529     C                     MOVEL'PM90015' MSMBR4                          051784
252800200529     C                     ELSE                                           B8275
252900200529     C                     MOVEL'PM90006' MSMBR4
253000200529     C                     END                                            B8275
253100200529     C                     CALL 'SDRTVTXT'PLLANG
253200200529     C                     MOVELMSGTXT    DDINFO
253300200529     C**
253400200529     C** SEND FORMAT
253500200529     C**
253600200529     C                     WRITEPM0110F3
253700200529     C                     WRITEPM0110F1
253800200529     C                     EXFMTPM0110F2
253900200529     C                     MOVE '0'       *IN80
254000200529     C*********************CALL 'ZA0250'                                  R00300
254100200529     C*                                                                   R00300
254200200529     C**   Clear program message queue                                    R00300
254300200529     C                     CALL 'Y2CLMSC'                                 R00300
254400200529     C                     PARM           TOPQ                            R00300
254500200529     C                     PARM           TOPRQ                           R00300
254600200529     C*
254700200529     C** Call S/R to move values into WWAID
254800200529     C*
254900200529     C                     EXSR #ZBAA
255000200529     C*
255100200529     C** CK12- INITIAL SCREEN
255200200529     C*
255300200529     C           WWAID     IFEQ '12'
255400200529     C                     MOVE '1'       *IN10
255500200529     C                     END
255600200529     C*
255700200529     C** V A L I D A T E   D E T A I L   S C R E E N   I N P U T
255800200529     C*
255900200529     C           WWAID     IFNE '03'
256000200529     C           WWAID     ANDNE'12'
256100200529     C**
256200200529     C** IF ACTION CODE = I OR A - VALIDATION
256300200529     C**
256400200529     C           DDACTN    IFEQ 'I'
256500200529     C           DDACTN    OREQ 'A'
256600200529     C                     EXSR #V1004
256700200529     C                     END
256800200529     C**
256900200529     C** IF ACTION CODE = C - VALIDATION PORTFOLIO CLOSED
257000200529     C**
257100200529     C           DDACTN    IFEQ 'C'
257200200529     C                     EXSR #V1005
257300200529     C                     END
257400200529     C*
257500200529     C** IF VALID DETAILS HAVE BEEN INPUT OBTAIN TNLU
257600200529     C*
257700200529     C           *IN80     IFEQ '0'
257800200529     C                     EXSR ZTNLU1
257900200529     C                     Z-ADDNATN      WWNEWT  50
258000200529     C                     END
258100200529     C**
258200200529     C** IF INPUT IS VALID PROCESS NEXT
258300200529     C**
258400200529     C**
258500200529     C** ENTER IS PRESSED
258600200529     C**
258700200529     C           WWAID     IFEQ 'RA'
258800200529     C/COPY WNCPYSRC,PM0110C004
258900200529     C** ACTION = A
259000200529     C           DDACTN    IFEQ 'A'
259100200529     C           *IN80     ANDEQ'0'
259200200529     C                     EXSR #P1006
259300200529     C                     ELSE
259400200529     C** ACTION = E
259500200529     C           DDACTN    IFEQ 'E'
259600200529     C                     EXSR #P1007
259700200529     C                     END
259800200529     C                     END
259900200529     C                     END
260000200529     C**
260100200529     C** CMD/1 HAS BEEN PRESSED
260200200529     C**
260300200529     C           WWAID     IFEQ '01'
260400200529     C           DDACTN    ANDNE'C'
260500200529     C*
260600200529     C** IF COMMAND 1 TAKEN CHECK FOR OUTSTANDING INVESTMENT POLICY CHANGES
260700200529     C           DDACTN    IFEQ 'A'
260800200529     C           *IN80     ANDEQ'0'
260900200529     C                     EXSR #P1006
261000200529     C                     END
261100200529     C           WWAID     IFEQ *BLANKS
261200200529     C           WWAID     OREQ '01'
261300200529     C           *IN80     IFEQ '0'
261400200529     C                     EXSR #P1005
261500200529     C                     ELSE
261600200529     C*********************MOVEL'PM11401' MSGID                           R00300
261700200529     C*********************CALL 'ZA0240'                                  R00300
261800200529     C*********************PARM           MSGID                           R00300
261900200529     C                     MOVEL'PM11401' ZAMSID                          R00300
262000200529     C                     EXSR ZASNMS                                    R00300
262100200529     C                     END
262200200529     C                     END
262300200529     C                     END
262400200529     C**
262500200529     C** CMD/24 HAS BEEN PRESSED
262600200529     C**
262700200529     C           WWAID     IFEQ '24'
262800200529     C**
262900200529     C** PREPARE PARAMETERS TO CALL PM0600
263000200529     C**
263100200529     C                     MOVEL'0'       WWRTRN
263200200529     C                     MOVELWWPNP8    WWCCNM
263300200529     C                     MOVELWWPREF    WWPTFR
263400200529     C**
263500200529     C                     MOVE 'Y'       WW0600  1
263600200529     C                     CALL 'PMC0601' LIST1
263700200529     C**
263800200529     C                     END
263900200529     C*
264000200529     C** RECEIVE PARAMETER RETURNED FROM INVESTMENT POLICY INPUT
264100200529     C** PROGRAM
264200200529     C*
264300200529     C           WWRTRN    IFEQ '1'                                       R10053
264400200529     C                     MOVE '03'      WWAID                           R10053
264500200529     C                     ROLBK                                          R10053
264600200529     C                     GOTO #P1049                                    R10053
264700200529     C                     END                                            R10053
264800200529     C**
264900200529     C** PROCESS UPDATE OF FILES
265000200529     C**
265100200529     C                     MOVE '0'       *IN89
265200200529     C**
265300200529     C           WWAID     IFEQ 'RA'
265400200529     C**
265500200529     C           DDACTN    IFEQ 'I'
265600200529     C           *IN80     ANDEQ'0'
265700200529     C           DDACTN    OREQ 'A'
265800200529     C           *IN80     ANDEQ'0'
265900200529     C           DDACTN    OREQ 'C'
266000200529     C           *IN80     ANDEQ'0'
266100200529     C           *IN82     ANDEQ'0'                                       B8275
266200200529     C           DDACTN    OREQ 'E'
266300200529     C           WWAID     ANDEQ'RA'
266400200529     C**
266500200529     C           DDACTN    IFEQ 'I'
266600200529     C           DDACTN    OREQ 'A'
266700200529     C           DDACTN    OREQ 'C'
266800200529     C**
266900200529     C                     EXSR #P1008
267000200529     C**
267100200529     C** UPDATE OK ?
267200200529     C           *IN89     IFEQ '0'
267300200529     C                     EXSR #P1009
267400200529     C                     ELSE
267500200529     C                     MOVE '1'       *IN10
267600200529     C                     END
267700200529     C**
267800200529     C** UPDATE OK ?
267900200529     C           *IN89     IFEQ '0'
268000200529     C**
268100200529     C** UPDATE AUDIT IF ACTION = I
268200200529     C**
268300200529     C           DDACTN    IFEQ 'I'
268400200529     C                     EXSR #P1010
268500200529     C                     END
268600200529     C**
268700200529     C                     END
268800200529     C**
268900200529     C** COMIT
269000200529     C**
269100200529     C           CMTTXT    COMIT
269200200529     C**
269300200529     C                     END
269400200529     C**
269500200529     C** UPDATE PROCESS CORRECT ?
269600200529     C**
269700200529     C           *IN89     IFEQ '0'
269800200529     C           *IN12     ANDEQ'0'
269900200529     C           *IN82     ANDEQ'0'                                       B8275
270000200529     C**
270100200529     C** DETERMINE WHICH SCREEN TO RETURN TO
270200200529     C**
270300200529     C           WWREVW    IFEQ 'Y'
270400200529     C                     MOVE '1'       *IN11
270500200529     C                     ELSE
270600200529     C                     MOVE '1'       *IN10
270700200529     C                     END
270800200529     C**
270900200529     C                     END
271000200529     C**
271100200529     C                     END
271200200529     C**
271300200529     C                     END
271400200529     C**
271500200529     C                     END
271600200529     C**
271700200529     C                     END
271800200529     C**
271900200529     C*******              ENDSR                                          R10053
272000200529     C           #P1049    ENDSR                                          R10053
272100200529     C*
272200200529     C**************************************************************************
272300200529      /EJECT
272400200529      **************************************************************************
272500200529      *                                                                        *
272600200529      * #READ    - TO FILL SUBFILE - PORTFOLIO CHARGES                         *
272700200529      *                                                                        *
272800200529      * SUBROUTINE CALLS:                                                      *
272900200529      * #ZED     - TO COMPUTE DECIMAL NUMBER AND ACCESS ZEDIT SR               *
273000200529      * ZEDIT    - TO OUTPUT NUMERIC FIELDS IN ALPHA                           *
273100200529      * ZDATE2   - TO COMPUTE DAY NUMBER IN DATE                               *
273200200529      *                                                                        *
273300200529      * SUBROUTINE CALLED FROM:                                                *
273400200529      * #P1004   - TO PROCESS DETAIL SCREEN AND UPDATE FILES                   *
273500200529      *                                                                        *
273600200529      **************************************************************************
273700200529     C           #READ     BEGSR
273800200529     C**
273900200529     C** REINITIALIZE SUBFILE RECORD NUMBER
274000200529     C**
274100200529     C                     Z-ADD1         RRN2
274200200529     C**
274300200529     C** CLEAR SUBFILE
274400200529     C**
274500200529     C                     MOVE '1'       *IN65
274600200529     C                     WRITEPM0110C1
274700200529     C                     MOVE '0'       *IN65
274800200529     C**
274900200529     C** LOAD HEADING INFORMATION
275000200529     C**
275100200529     C           DDACTN    IFNE 'I'
275200200529     C                     MOVELPNBCGY    DDBCGY
275300200529     C                     MOVELPNCSCY    DDCSCY
275400200529     C                     MOVELPNCUSA    DDCUSA
275500200529     C                     MOVELPNCUSB    DDBRCA                          085799
275600200529     C                     ELSE
275700200529     C                     MOVEL*BLANKS   DDBCGY
275800200529     C                     MOVEL*BLANKS   DDCSCY
275900200529     C                     MOVEL*BLANKS   DDCUSA
276000200529     C                     MOVEL*BLANKS   DDBRCA                          085799
276100200529     C                     END
276200200529     C**
276300200529     C** IF ACTION CODE = 'I' - READ CHARGES FILE
276400200529     C** IF CHARGES FOUND, DELETE ALL CHARGES FOR THIS PORTFOLIO
276500200529     C**
276600200529     C           DDACTN    IFEQ 'I'
276700200529     C**
276800200529     C***********PMPORK    SETLLPMCHRGPP                                  S01486
276900200529     C           PMPORK    SETLLPMCHRGPD                                  S01486
277000200529     C**
277100200529     C           *IN73     DOUEQ'1'
277200200529     C**
277300200529     C***********PMPORK    READEPMCHRGPP                 73               S01486
277400200529     C           PMPORK    READEPMCHRGPD                 73               S01486
277500200529     C**
277600200529     C           *IN73     IFEQ '0'
277700200529     C**
277800200529     C                     DELETPMCHRGP0
277900200529     C**
278000200529     C                     END
278100200529     C**
278200200529     C                     END
278300200529     C**
278400200529     C                     END
278500200529     C**
278600200529     C** LOAD SUBFILE
278700200529     C**
278800200529     C                     MOVE 'N'       WWCHRG  1
278900200529     C           RRN2      DOUEQ11
279000200529     C**
279100200529     C                     Z-ADDRRN2      WWCGSQ
279200200529     C                     Z-ADDRRN2      X
279300200529     C**
279400200529     C           PMCHRK    CHAINPMCHRGXX             73
279500200529     C**
279600200529     C** INITIALIZE SUBFILE FIELDS
279700200529     C**
279800200529     C                     Z-ADD0         DDCGSH
279900200529     C                     Z-ADD0         DDCSNH
280000200529     C                     Z-ADD0         DDCGNH
280100200529     C                     MOVEL*BLANKS   DDCGCO
280200200529     C                     MOVEL*BLANKS   DDCGCH
280300200529     C                     MOVEL*BLANKS   DDCGSP
280400200529     C                     MOVEL*BLANKS   DDCGSI
280500200529     C                     MOVEL*BLANKS   DDCGEI
280600200529     C                     MOVEL*BLANKS   DDCGFQ
280700200529     C                     MOVEL*BLANKS   DDCGFH
280800200529     C                     MOVEL*BLANKS   DDCGDY
280900200529     C                     MOVEL*BLANKS   DDCGND
281000200529     C                     MOVEL*BLANKS   DDCGST
281100200529     C                     MOVEL*BLANKS   DDCGTH
281200200529     C                     MOVEL*BLANKS   DDCSFQ
281300200529     C                     MOVEL*BLANKS   DDCSFH
281400200529     C                     MOVEL*BLANKS   DDCSDY
281500200529     C                     MOVEL*BLANKS   DDCSND
281600200529     C                     MOVE 'N'       DDVALD
281700200529     C           BKPRCU    IFEQ 'Y'                                       S01486
281800200529     C                     MOVEL*BLANKS   DDPRFC                          S01486
281900200529     C                     MOVEL*BLANKS   DDPRFH                          S01486
282000200529     C                     END                                            S01486
282100200529     C**
282200200529     C** LOAD SUBFILE IF RECORD FOUND
282300200529     C**
282400200529     C           *IN73     IFEQ '0'
282500200529     C           PORECI    ANDEQ'D'
282600200529     C**
282700200529     C                     MOVE 'Y'       WWCHRG
282800200529     C                     MOVE 'Y'       DDVALD
282900200529     C**
283000200529     C* LOAD CHARGE CODE
283100200529     C                     MOVELPOCGCO    DDCGCO
283200200529     C                     MOVELPOCGCO    DDCGCH
283300200529     C                     MOVELPOCGCO    CG,X                            080674
283400200529     C* COMPUTE ADJUSTMENT AMOUNT, LOAD IT AND CONVERT IT
283500200529     C* WITH CURRENCY DECIMAL PLACES
283600200529     C           POCGSP    IFNE 0
283700200529     C                     Z-ADDPOCGSP    WWCGSP
283800200529     C                     MOVE 'Y'       WWREAD  1
283900200529     C                     EXSR #ZED
284000200529     C                     MOVE 'N'       WWREAD
284100200529     C                     MOVE WWCGSP    ZFIELD
284200200529     C                     EXSR ZEDIT
284300200529     C                     MOVE ZFIELD    DDCGSP
284400200529     C                     Z-ADDPOCGSP    DDCGSH
284500200529     C                     END
284600200529     C* LOAD SIGN
284700200529     C                     MOVELPOCGSI    DDCGSI
284800200529     C* LOAD EFFECTIVE INDICATOR
284900200529     C                     MOVELPOCGEI    DDCGEI
285000200529     C                     MOVELPOCGEI    DDCGEH
285100200529     C                     MOVELPOCGLD    DDCGLH
285200200529     C* ACCRUAL DATE FREQUENCY
285300200529     C                     MOVELPOCGFQ    DDCGFQ
285400200529     C                     MOVELPOCGFQ    DDCGFH
285500200529     C* NEXT ACCRUAL DATE
285600200529     C           POCGND    IFNE 0
285700200529     C                     Z-ADDPOCGND    ZDAYNO
285800200529     C                     EXSR ZDATE2
285900200529     C                     MOVELZDATE     DDCGND
286000200529     C                     Z-ADDPOCGND    DDCGNH
286100200529     C                     END
286200200529     C* ACCRUAL DAY
286300200529     C           POCGDY    IFNE 0
286400200529     C                     MOVELPOCGDY    DDCGDY
286500200529     C                     MOVELPOCGDY    DDCGDH
286600200529     C                     ELSE
286700200529     C                     MOVE *BLANKS   DDCGDH
286800200529     C                     END
286900200529     C* CHARGE STOPPED
287000200529     C                     MOVELPOCGST    DDCGST
287100200529     C                     MOVELPOCGST    DDCGTH
287200200529     C* CHARGE FREQUENCY
287300200529     C                     MOVELPOCSFQ    DDCSFQ
287400200529     C                     MOVELPOCSFQ    DDCSFH
287500200529     C* SETTLE DAY
287600200529     C           POCSDY    IFNE 0
287700200529     C                     MOVELPOCSDY    DDCSDY
287800200529     C                     MOVELPOCSDY    DDCSDH
287900200529     C                     END
288000200529     C* NEXT SETTLEMENT DATE
288100200529     C           POCSND    IFNE 0
288200200529     C                     Z-ADDPOCSND    ZDAYNO
288300200529     C                     EXSR ZDATE2
288400200529     C                     MOVELZDATE     DDCSND
288500200529     C                     Z-ADDPOCSND    DDCSNH
288600200529     C                     END
288700200529     C* PROFIT CENTRE                                                     S01486
288800200529     C           BKPRCU    IFEQ 'Y'                                       S01486
288900200529     C           POPFRC    ANDNE*BLANKS                                   S01486
289000200529     C                     MOVELPOPFRC    DDPRFC                          S01486
289100200529     C                     MOVELPOPFRC    DDPRFH                          S01486
289200200529     C                     END                                            S01486
289300200529     C**
289400200529     C                     END
289500200529     C**
289600200529     C** WRITE IN SUBFILE
289700200529     C**
289800200529     C                     WRITEPM0110S1
289900200529     C                     ADD  1         RRN2
290000200529     C**
290100200529     C                     END
290200200529     C*
290300200529     C** IF CHARGES ALREADY SET UP PORTFOLIO CHARGE CURRENCY MAY NOT BE
290400200529     C** AMENDED
290500200529     C*
290600200529     C           WWCHRG    IFEQ 'Y'
290700200529     C                     MOVE '1'       *IN59
290800200529     C                     ELSE
290900200529     C                     MOVE '0'       *IN59
291000200529     C                     END
291100200529     C*
291200200529     C                     ENDSR
291300200529     C*
291400200529     C**************************************************************************
291500200529      /EJECT
291600200529      **************************************************************************
291700200529      *                                                                        *
291800200529      * #ZED     - TO COMPUTE DECIMAL NUMBER AND ACCESS ZEDIT SR               *
291900200529      *                                                                        *
292000200529      * SUBROUTINE CALLS:                                                      *
292100200529      *                                                                        *
292200200529      * SUBROUTINE CALLED FROM:                                                *
292300200529      * #READ    - TO FILL SUBFILE - PORTFOLIO CHARGES                         *
292400200529      * #V1006   - TO VALIDATE PORTFOLIO CHARGES DETAILS                       *
292500200529      *                                                                        *
292600200529      *                                                                        *
292700200529      **************************************************************************
292800200529     C           #ZED      BEGSR
292900200529     C*
293000200529     C***********PMCODE    CHAINPMCGCDPP             72                   S01486
293100200529     C           PMCODE    CHAINPMCGCDPD             72                   S01486
293200200529     C           *IN72     IFEQ '1'
293300200529     C           P5RECI    ORNE 'D'                        ***************
293400200529     C           *LOCK     IN   LDA                                       S01486
293500200529     C***********          Z-ADD4         DBASE   30       **DB ERROR 04**S01486
293600200529     C***********          MOVEL'PMCGCDPP'DBFILE 10        ***************S01486
293700200529     C                     Z-ADD4         DBASE            **DB ERROR 04**S01486
293800200529     C                     MOVE 'PMCGCDPD'DBFILE           ***************S01486
293900200529     C                     MOVELDDBCGY    WWFIVE  5
294000200529     C                     MOVE DDCGCO    WWFIVE
294100200529     C***********          MOVELWWFIVE    DBKEY  29                       S01486
294200200529     C                     MOVELWWFIVE    DBKEY                           S01486
294300200529     C                     OUT  LDA                                       S01486
294400200529     C                     EXSR *PSSR                                     S01486
294500200529     C                     END
294600200529     C*
294700200529     C** CALCULATE NUMBER OF DECIMALS AND INTEGERS FOR FLAT RATE
294800200529     C*
294900200529     C           P5CGBS    IFEQ 'F'
295000200529     C*
295100200529     C** SET UP NUMBER OF DECIMAL PLACES ACCORDING TO WHETHER CALLED
295200200529     C** FROM SR/#READ OR SR/#V1006
295300200529     C*
295400200529     C           WWREAD    IFEQ 'Y'
295500200529     C                     Z-ADDPNBCGD    ZADEC
295600200529     C                     ELSE
295700200529     C                     Z-ADDWWBCGY    ZADEC
295800200529     C                     END
295900200529     C*
296000200529     C           13        SUB  ZADEC     ZADIG
296100200529     C                     END
296200200529     C**
296300200529     C*
296400200529     C** CALCULATE NUMBER OF DECIMALS AND INTEGERS FOR PERCENTAGE RATE
296500200529     C           P5CGBS    IFEQ 'P'
296600200529     C                     Z-ADD7         ZADEC
296700200529     C                     Z-ADD6         ZADIG
296800200529     C                     END
296900200529     C**
297000200529     C                     MOVE *BLANKS   ZFIELD
297100200529     C**
297200200529     C                     ENDSR
297300200529     C*
297400200529     C**************************************************************************
297500200529      /EJECT
297600200529      **************************************************************************
297700200529      *                                                                        *
297800200529      * #TRANS   - TO ACCESS FILE AND FILL DISPLAY FIELDS                      *
297900200529      *                                                                        *
298000200529      * SUBROUTINE CALLS:                                                      *
298100200529      * ZDATE2   - TO COMPUTE DAY NUMBER IN DATE                               *
298200200529      *                                                                        *
298300200529      * SUBROUTINE CALLED FROM:                                                *
298400200529      * #P1004   - TO PROCESS DETAIL SCREEN AND UPDATE FILES                   *
298500200529      *                                                                        *
298600200529      *                                                                        *
298700200529      **************************************************************************
298800200529     C           #TRANS    BEGSR                           ** #TRANS BSR**
298900200529     C**
299000200529     C           DDACTN    IFEQ 'I'
299100200529     C                     MOVEL*BLANKS   DDPTCY
299200200529     C                     MOVEL*BLANKS   DDPTFN
299300200529     C                     MOVEL*BLANKS   DDPTFT
299400200529     C                     MOVEL*BLANKS   DDCFGC                          S01307
299500200529     C                     MOVEL*BLANKS   DDMNGI
299600200529     C                     MOVEL*BLANKS   DDDPOP
299700200529     C                     Z-ADDBJRDNB    ZDAYNO                          S01313
299800200529     C                     EXSR ZDATE2                                    S01313
299900200529     C                     MOVE ZDATE     DDDPOP                          S01313
300000200529     C                     Z-ADDBJRDNB    WWDPOP  50                      S01313
300100200529     C                     MOVEL*BLANKS   DDDPCL
300200200529     C                     MOVEL*BLANKS   DDACSQ                          S71062
300300200529     C                     MOVEL*BLANKS   DDPDGS
300400200529     C                     MOVEL*BLANKS   DDPDGF
300500200529     C                     MOVEL*BLANKS   DDVLFQ
300600200529     C                     MOVEL*BLANKS   DDVLDM
300700200529     C                     MOVEL*BLANKS   DDVLND
300800200529     C****                 MOVEL*BLANKS   DDAAD1                          S01313
300900200529     C****                 MOVEL*BLANKS   DDAAD2                          S01313
301000200529     C****                 MOVEL*BLANKS   DDAAD3                          S01313
301100200529     C****                 MOVEL*BLANKS   DDAAD4                          S01313
301200200529     C****                 MOVEL*BLANKS   DDAAD5                          S01313
301300200529     C                     MOVEL*BLANKS   DDS1VR                          S01313
301400200529     C                     MOVEL*BLANKS   DDS2VR
301500200529     C                     MOVEL*BLANKS   DDS3VR
301600200529     C                     MOVEL*BLANKS   DDS4VR
301700200529     C                     MOVEL*BLANKS   DDS5VR
301800200529     C                     MOVEL*BLANKS   DDS6VR
301900200529     C                     MOVEL*BLANKS   DDS7VR                          S01313
302000200529     C                     MOVEL*BLANKS   DDS8VR                          S01313
302100200529     C                     MOVEL*BLANKS   DDS9VR                          CPM005
302200200529     C                     MOVEL*BLANKS   DDS0VR                          CPM005
302300200529     C                     MOVEL*BLANKS   DDRPYP                          S01313
302400200529     C                     MOVE *BLANKS   DDTYSM                          S01313
302500200529     C                     MOVEL*BLANKS   DDADPP                          S01313
302600200529     C                     MOVEL*BLANKS   DDPSDT                          S01313
302700200529     C                     MOVE *BLANKS   DDPMNG                          S01313
302800200529     C                     MOVEL*BLANKS   DDCASF
302900200529     C                     MOVEL*BLANKS   DDCASD
303000200529     C                     MOVEL*BLANKS   DDCASN
303100200529     C                     MOVEL*BLANKS   DDPOLC
303200200529     C                     MOVEL'N'       DDIPIN
303300200529     C                     MOVEL'N'       DDCYIN
303400200529     C                     MOVEL'N'       DDYPIN
303500200529     C                     MOVEL'N'       DDNPIN
303600200529     C*                                                                   CAC003
303700200529     C** If Analytical Accounting is switched on;                         CAC003
303800200529     C           *IN87     IFEQ '1'                                       CAC003
303900200529     C                     MOVE *BLANKS   DDPRF2                          CAC003
304000200529     C                     ENDIF                                          CAC003
304100200529     C*                                                                   CAC003
304200200529     C** DDACTN = A, E OR C
304300200529     C                     ELSE
304400200529     C*                                                                   CAC003
304500200529     C** If Analytical Accounting is switched on;                         CAC003
304600200529     C           *IN87     IFEQ '1'                                       CAC003
304700200529     C                     MOVE PNPRFC    DDPRF2                          CAC003
304800200529     C                     ENDIF                                          CAC003
304900200529     C*                                                                   CAC003
305000200529     C                     MOVELPNPTCY    DDPTCY
305100200529     C                     MOVELPNPTFN    DDPTFN
305200200529     C                     MOVELPNPTFT    DDPTFT
305300200529     C*                                                                   S01307
305400200529     C           *IN70     IFEQ '1'                                       S01307
305500200529     C                     MOVELPNCFGC    DDCFGC                          S01307
305600200529     C                     END                                            S01307
305700200529     C*                                                                   S01307
305800200529     C           *IN20     IFEQ *ON                                       S71062
305900200529     C           PNACSQ    IFNE *ZEROS                                    S71062
306000200529     C                     MOVE PNACSQ    DDACSQ                          S71062
306100200529     C                     ELSE                                           S71062
306200200529     C                     MOVE *BLANKS   DDACSQ                          S71062
306300200529     C                     ENDIF                                          S71062
306400200529     C                     ENDIF                                          S71062
306500200529     C*                                                                   S71062
306600200529     C                     MOVELPNMNGI    DDMNGI
306700200529     C**
306800200529     C** LOAD DAY NUMBER (DATE PORTFOLIO OPENED) AND CONVERT IT
306900200529     C**
307000200529     C           PNDPOP    IFNE 0
307100200529     C                     Z-ADDPNDPOP    ZDAYNO
307200200529     C                     EXSR ZDATE2
307300200529     C                     MOVELZDATE     DDDPOP
307400200529     C                     Z-ADDPNDPOP    WWDPOP                          45330
307500200529     C                     ELSE
307600200529     C                     MOVEL*BLANKS   DDDPOP
307700200529     C                     END
307800200529     C**
307900200529     C** LOAD DAY NUMBER (DATE PORTFOLIO CLOSED) AND CONVERT IT
308000200529     C**
308100200529     C           PNDPCL    IFNE 0
308200200529     C                     Z-ADDPNDPCL    ZDAYNO
308300200529     C                     EXSR ZDATE2
308400200529     C                     MOVELZDATE     DDDPCL
308500200529     C                     ELSE
308600200529      *                                                                   B8275
308700200529     C           DDACTN    IFEQ 'C'                                       B8275
308800200529     C                     Z-ADDBJRDNB    ZDAYNO  50                      B8275
308900200529     C                     EXSR ZDATE2                                    B8275
309000200529     C                     MOVELZDATE     DDDPCL                          B8275
309100200529     C                     ELSE                                           B8275
309200200529     C                     MOVEL*BLANKS   DDDPCL                          B8275
309300200529     C                     END                                            B8275
309400200529      *                                                                   B8275
309500200529     C                     END
309600200529     C**                                                                  S71062
309700200529     C           PNACSQ    IFNE 0                                         S71062
309800200529     C                     MOVE PNACSQ    DDACSQ                          S71062
309900200529     C                     ELSE                                           S71062
310000200529     C                     MOVE *BLANKS   DDACSQ                          S71062
310100200529     C                     ENDIF                                          S71062
310200200529     C**
310300200529     C** LOAD DAY NUMBER (PLEDGE START DATE) AND CONVERT IT
310400200529     C**
310500200529     C           PNPDGS    IFNE 0
310600200529     C                     Z-ADDPNPDGS    ZDAYNO
310700200529     C                     EXSR ZDATE2
310800200529     C                     MOVELZDATE     DDPDGS
310900200529     C                     ELSE
311000200529     C                     MOVEL*BLANKS   DDPDGS
311100200529     C                     END
311200200529     C**
311300200529     C** LOAD DAY NUMBER (PLEDGE FINISH DATE) AND CONVERT IT
311400200529     C**
311500200529     C           PNPDGF    IFNE 0
311600200529     C           PNPDGF    ANDNE99999
311700200529     C                     Z-ADDPNPDGF    ZDAYNO
311800200529     C                     EXSR ZDATE2
311900200529     C                     MOVELZDATE     DDPDGF
312000200529     C                     ELSE
312100200529     C                     MOVEL*BLANKS   DDPDGF
312200200529     C                     END
312300200529     C**
312400200529     C                     MOVELPNVLFQ    DDVLFQ
312500200529     C**
312600200529     C           PNVLDM    IFEQ 0
312700200529     C                     MOVEL*BLANKS   DDVLDM
312800200529     C                     ELSE
312900200529     C                     MOVELPNVLDM    DDVLDM
313000200529     C                     END
313100200529     C**
313200200529     C** LOAD DAY NUMBER (NEXT VAL.    DATE) AND CONVERT IT
313300200529     C**
313400200529     C           PNVLND    IFNE 0
313500200529     C                     Z-ADDPNVLND    ZDAYNO
313600200529     C                     EXSR ZDATE2
313700200529     C                     MOVELZDATE     DDVLND
313800200529     C                     ELSE
313900200529     C                     MOVEL*BLANKS   DDVLND
314000200529     C                     END
314100200529     C**
314200200529     C** LOAD ADDRESSES CODES
314300200529     C**
314400200529     C****                 MOVELPNAAD1    DDAAD1                          S01313
314500200529     C****                 MOVELPNAAD2    DDAAD2                          S01313
314600200529     C****                 MOVELPNAAD3    DDAAD3                          S01313
314700200529     C****                 MOVELPNAAD4    DDAAD4                          S01313
314800200529     C****                 MOVELPNAAD5    DDAAD5                          S01313
314900200529     C**
315000200529     C                     MOVELPNS1VR    DDS1VR                          S01313
315100200529     C                     MOVELPNS2VR    DDS2VR
315200200529     C                     MOVELPNS3VR    DDS3VR
315300200529     C                     MOVELPNS4VR    DDS4VR
315400200529     C                     MOVELPNS5VR    DDS5VR
315500200529     C                     MOVELPNS6VR    DDS6VR
315600200529     C                     MOVELPNS7VR    DDS7VR                          S01313
315700200529     C                     MOVELPNS8VR    DDS8VR                          S01313
315800200529     C                     MOVELPNS9VR    DDS9VR                          CPM005
315900200529     C                     MOVELPNS0VR    DDS0VR                          CPM005
316000200529     C**                                                                  S01313
316100200529     C                     MOVELPNRPYP    DDRPYP                          S01313
316200200529     C           PNTYSM    IFNE 0                                         S01313
316300200529     C                     MOVELPNTYSM    DDTYSM                          S01313
316400200529     C                     ELSE                                           S01313
316500200529     C                     MOVE *BLANKS   DDTYSM                          S01313
316600200529     C                     END                                            S01313
316700200529     C                     MOVELPNADPP    DDADPP                          S01313
316800200529     C                     Z-ADDPNPSDT    WAPSDT  50                      S01313
316900200529     C           PNPSDT    IFNE 0                                         S01313
317000200529     C           PNPSDT    ANDNE99999                                     S01313
317100200529     C                     Z-ADDPNPSDT    ZDAYNO                          S01313
317200200529     C                     EXSR ZDATE2                                    S01313
317300200529     C                     MOVELZDATE     DDPSDT                          S01313
317400200529     C                     ELSE                                           S01313
317500200529     C                     MOVEL*BLANKS   DDPSDT                          S01313
317600200529     C                     END                                            S01313
317700200529     C                     MOVELPNPMNG    DDPMNG                          S01313
317800200529     C**
317900200529     C                     MOVELPNCASF    DDCASF
318000200529     C           PNCASD    IFNE 0
318100200529     C                     MOVE PNCASD    DDCASD
318200200529     C                     ELSE
318300200529     C                     MOVEL*BLANKS   DDCASD
318400200529     C                     END
318500200529     C**
318600200529     C           PNCASN    IFNE 0
318700200529     C                     Z-ADDPNCASN    ZDAYNO
318800200529     C                     EXSR ZDATE2
318900200529     C                     MOVELZDATE     DDCASN
319000200529     C                     ELSE
319100200529     C                     MOVEL*BLANKS   DDCASN
319200200529     C                     END
319300200529     C**
319400200529     C                     MOVELPNPOLC    DDPOLC
319500200529     C                     MOVELPNIPIN    DDIPIN
319600200529     C                     MOVELPNCYIN    DDCYIN
319700200529     C                     MOVELPNYPIN    DDYPIN
319800200529     C                     MOVELPNNPIN    DDNPIN
319900200529     C                     MOVELPNIPIN    DDIPIH
320000200529     C                     MOVELPNCYIN    DDCYIH
320100200529     C                     MOVELPNYPIN    DDYPIH
320200200529     C                     MOVELPNNPIN    DDNPIH
320300200529     C**
320400200529     C                     END
320500200529     C**
320600200529     C                     ENDSR
320700200529      **
320800200529     C*
320900200529      **************************************************************************
321000200529      /EJECT
321100200529      **************************************************************************
321200200529      *                                                                        *
321300200529      * #V1004   - TO VALIDATE PORTFOLIO DEFINITION DETAILS                    *
321400200529      *                                                                        *
321500200529      * SUBROUTINE CALLS:                                                      *
321600200529      **********ZA0240   - TO ACCESS MESSAGE FILE AND SEND MESSAGE        R00300
321700200529      * ZASNMS   - WRITE ERROR MESSAGES                                   R00300
321800200529      * ZDATE2   - TO COMPUTE DAY NUMBER IN DATE                               *
321900200529      * ZDATE1   - TO COMPUTE DATE IN DAY NUMBER                               *
322000200529      * ZFRQA    - TO INCREMENT A DAY NUMBER DATE BY A VALUE                   *
322100200529      *                                                                        *
322200200529      * SUBROUTINE CALLED FROM:                                                *
322300200529      * #P1004   - TO PROCESS DETAIL SCREEN AND UPDATE FILES                   *
322400200529      *                                                                        *
322500200529      **************************************************************************
322600200529     C           #V1004    BEGSR                           ** #V1004 BSR**
322700200529     C**
322800200529     C                     MOVE *OFF      *IN07                           S71062
322900200529     C                     MOVE '0'       *IN16                           S01313
323000200529     C                     MOVE '0'       *IN17                           S01313
323100200529     C                     MOVE '0'       *IN18                           S01313
323200200529     C                     MOVE '0'       *IN19                           S01313
323300200529     C                     MOVE '0'       *IN09                           S01313
323400200529     C                     MOVE '0'       *IN32
323500200529     C                     MOVE '0'       *IN33
323600200529     C                     MOVE '0'       *IN34
323700200529     C                     MOVE '0'       *IN35
323800200529     C                     MOVE '0'       *IN36
323900200529     C                     MOVE '0'       *IN37
324000200529     C                     MOVE '0'       *IN38
324100200529     C                     MOVE '0'       *IN39
324200200529     C                     MOVE '0'       *IN40
324300200529     C                     MOVE '0'       *IN41
324400200529     C                     MOVE '0'       *IN42
324500200529     C                     MOVE '0'       *IN43
324600200529     C                     MOVE '0'       *IN44
324700200529     C                     MOVE '0'       *IN45
324800200529     C                     MOVE '0'       *IN46
324900200529     C                     MOVE '0'       *IN47
325000200529     C                     MOVE '0'       *IN48
325100200529     C                     MOVE '0'       *IN49
325200200529     C                     MOVE '0'       *IN50
325300200529     C                     MOVE '0'       *IN51
325400200529     C                     MOVE '0'       *IN52
325500200529     C                     MOVE '0'       *IN53
325600200529     C                     MOVE '0'       *IN54
325700200529     C                     MOVE '0'       *IN55
325800200529     C                     MOVE '0'       *IN66
325900200529     C                     MOVE '0'       *IN67
326000200529     C                     MOVE '0'       *IN68
326100200529     C                     MOVE '0'       *IN69                           S01307
326200200529     C                     MOVE '0'       *IN74
326300200529     C                     MOVE '0'       *IN75
326400200529     C                     MOVE '0'       *IN76
326500200529     C                     MOVE '0'       *IN15                           CPM005
326600200529     C                     MOVE '0'       *IN78                           CPM005
326700200529     C*                                                                   CAC003
326800200529     C** If Analytical Accounting is switched on;                         CAC003
326900200529     C           *IN87     IFEQ '1'                                       CAC003
327000200529     C                     MOVE '0'       *IN06                           CAC003
327100200529     C                     ENDIF                                          CAC003
327200200529     C*
327300200529     C** SET DATE DETAILS FROM PREVIOUS SCREEN TO ZERO
327400200529     C*
327500200529     C                     Z-ADD0         PNVLND
327600200529     C                     Z-ADD0         PNPDGS
327700200529     C                     Z-ADD0         PNPDGF
327800200529     C**
327900200529     C**+++++++++++++++++++++++++++++++++++++++++++++++++++++
328000200529     C** VAL4DDPTCY    PORTFOLIO CURRENCY
328100200529     C**+++++++++++++++++++++++++++++++++++++++++++++++++++++
328200200529     C** IF NOT ENTERED DEFAULT TO BASE CURRENCY
328300200529     C**
328400200529     C           DDPTCY    IFEQ *BLANKS
328500200529     C                     MOVE QBCSBY    DDPTCY
328600200529     C                     END
328700200529     C**
328800200529     C** IF ENTERED MUST BE A VALID CURRENCY ON SDCURRL0
328900200529     C**
329000200529     C***********DDPTCY    CHAINSDCURRL0             72                   S01486
329100200529     C************IN72     IFEQ '1'                                       S01486
329200200529     C*********************MOVEL'PM11201' MSGID                           R00300
329300200529     C*********************CALL 'ZA0240'                                  R00300
329400200529     C*********************PARM           MSGID                           R00300
329500200529     C                     CALL 'AOCURRR0'                                S01486
329600200529     C                     PARM *BLANKS   WWRTCD  7                       S01486
329700200529     C                     PARM '*KEY    'WWOPTN  7                       S01486
329800200529     C                     PARM DDPTCY    WWKEY   3                       S01486
329900200529     C           SDCURR    PARM SDCURR    DSSDY                           S01486
330000200529     C           WWRTCD    IFNE *BLANKS                                   S01486
330100200529     C                     MOVEL'PM11201' ZAMSID                          R00300
330200200529     C                     EXSR ZASNMS                                    R00300
330300200529     C                     MOVE '1'       *IN80
330400200529     C                     MOVE '1'       *IN32
330500200529     C                     ELSE
330600200529     C                     Z-ADDA6NBDP    WWPTCY  10
330700200529     C                     END
330800200529     C**+++++++++++++++++++++++++++++++++++++++++++++++++++++
330900200529     C** VAL4DDPTFN   PORTFOLIO NARRATIVE
331000200529     C**+++++++++++++++++++++++++++++++++++++++++++++++++++++
331100200529     C**
331200200529     C** MUST BE ENTERED
331300200529     C**
331400200529     C           DDPTFN    IFEQ *BLANKS
331500200529     C*********************MOVEL'PM11202' MSGID                           R00300
331600200529     C*********************CALL 'ZA0240'                                  R00300
331700200529     C*********************PARM           MSGID                           R00300
331800200529     C                     MOVEL'PM11202' ZAMSID                          R00300
331900200529     C                     EXSR ZASNMS                                    R00300
332000200529     C                     MOVE '1'       *IN80
332100200529     C                     MOVE '1'       *IN33
332200200529     C                     END
332300200529     C**+++++++++++++++++++++++++++++++++++++++++++++++++++++
332400200529     C** VAL4DDPTFT   PORTFOLIO TYPE
332500200529     C**+++++++++++++++++++++++++++++++++++++++++++++++++++++
332600200529     C**
332700200529     C** MUST BE A VALID PORTFOLIO TYPE - IF ENTERED
332800200529     C**
332900200529     C           DDPTFT    IFNE *BLANKS
333000200529     C**
333100200529     C***********DDPTFT    CHAINPMPTFTPP             72                   S01486
333200200529     C           DDPTFT    CHAINPMPTFTPD             72                   S01486
333300200529     C           *IN72     IFEQ '1'
333400200529     C           PERECI    OREQ '*'
333500200529     C*********************MOVEL'PM11203' MSGID                           R00300
333600200529     C*********************CALL 'ZA0240'                                  R00300
333700200529     C*********************PARM           MSGID                           R00300
333800200529     C                     MOVEL'PM11203' ZAMSID                          R00300
333900200529     C                     EXSR ZASNMS                                    R00300
334000200529     C                     MOVE '1'       *IN80
334100200529     C                     MOVE '1'       *IN34
334200200529     C                     END
334300200529     C**
334400200529     C                     END
334500200529     C*                                                                   S01307
334600200529     C**+++++++++++++++++++++++++++++++++++++++++++++++++++++             S01307
334700200529     C** VAL4DDCFGC    CUSTODY GROUP CODE                                 S01307
334800200529     C**+++++++++++++++++++++++++++++++++++++++++++++++++++++             S01307
334900200529     C**                                                                  S01307
335000200529     C           *IN70     IFEQ '1'                                       S01307
335100200529     C           DDCFGC    ANDNE*BLANKS                                   S01307
335200200529     C                     MOVE WWPNP8    WWCUSK  6                       S01307
335300200529     C***********WWCUSK    CHAINSDSECSL0             72            S01307 S01486
335400200529     C                     CALL 'AOSECSR0'                                S01486
335500200529     C                     PARM '*MSG    'WWRTCD                          S01486
335600200529     C                     PARM '*KEY    'WWOPTN                          S01486
335700200529     C                     PARM WWCUSK    WWCFGC  6                       S01486
335800200529     C           SDSECS    PARM SDSECS    DSSDY                           S01486
335900200529     C** Customer is not subject to SC Fees                               S01307
336000200529     C***********BFSBJF    IFNE 'Y'                                S01307 S01486
336100200529     C           BFASIN    IFNE 'Y'                                S01307 S01486
336200200529     C                     MOVEL'PM11250' ZAMSID                          S01307
336300200529     C                     EXSR ZASNMS                                    S01307
336400200529     C                     MOVE '1'       *IN80                           S01307
336500200529     C                     MOVE '1'       *IN69                           S01307
336600200529     C                     ELSE                                           S01307
336700200529     C*                                                                   S01307
336800200529     C***********DDCFGC    CHAINSCCFGRPD             72            S01307 S01486
336900200529     C           DDCFGC    CHAINSECFGRPD             72                   S01486
337000200529     C*                                                                   S01307
337100200529     C** Custody Group Code entered is not valid                          S01307
337200200529     C           *IN72     IFEQ '1'                                       S01307
337300200529     C                     MOVEL'PM11251' ZAMSID                          S01307
337400200529     C                     EXSR ZASNMS                                    S01307
337500200529     C                     MOVE '1'       *IN80                           S01307
337600200529     C                     MOVE '1'       *IN69                           S01307
337700200529     C                     END                                            S01307
337800200529     C*                                                                   S01307
337900200529     C                     END                                            S01307
338000200529     C*                                                                   S01307
338100200529     C                     END                                            S01307
338200200529     C*                                                                   S01307
338300200529     C**+++++++++++++++++++++++++++++++++++++++++++++++++++++
338400200529     C** VAL4DDMNGI    MANAGED INDICATOR
338500200529     C**+++++++++++++++++++++++++++++++++++++++++++++++++++++
338600200529     C**
338700200529     C** MUST BE ENTERED AND EQUAL TO 'M' , 'P' OR 'U'
338800200529     C**
338900200529     C           DDMNGI    IFNE 'M'
339000200529     C           DDMNGI    ANDNE'P'
339100200529     C           DDMNGI    ANDNE'U'
339200200529     C*********************MOVEL'PM11204' MSGID                           R00300
339300200529     C*********************CALL 'ZA0240'                                  R00300
339400200529     C*********************PARM           MSGID                           R00300
339500200529     C                     MOVEL'PM11204' ZAMSID                          R00300
339600200529     C                     EXSR ZASNMS                                    R00300
339700200529     C                     MOVE '1'       *IN80
339800200529     C                     MOVE '1'       *IN35
339900200529     C                     END
340000200529     C****+++++++++++++++++++++++++++++++++++++++++++++++++++             S01313
340100200529     C****AL4DDDPOP    DATE PORTFOLIO OPENED                              S01313
340200200529     C****+++++++++++++++++++++++++++++++++++++++++++++++++++             S01313
340300200529     C****                                                                S01313
340400200529     C****F NOT ENTERED DEFAULT TO RUN DATE                               S01313
340500200529     C****                                                                S01313
340600200529     C****       DDDPOP    IFEQ *BLANKS                                   S01313
340700200529     C****                 Z-ADDBJRDNB    ZDAYNO  50                      S01313
340800200529     C****                 EXSR ZDATE2                                    S01313
340900200529     C****                 MOVELZDATE     DDDPOP                          S01313
341000200529     C****                 END                                            S01313
341100200529     C****                                                                S01313
341200200529     C****F ENTERED WITH DEFAULT COMPUTE DATE IN DAY NUM                  S01313
341300200529     C****THERWISE CHECK IF DATE IS VALID AND COMPUTE IT                  S01313
341400200529     C****                                                                S01313
341500200529     C****                 Z-ADD0         WWDAT1                          S01313
341600200529     C****                 MOVE *BLANKS   WWDAT2                          S01313
341700200529     C****                 MOVE DDDPOP    WWDAT1                          S01313
341800200529     C****                 MOVE WWDAT1    WWDAT2                          S01313
341900200529     C****                                                                S01313
342000200529     C****                 MOVE DDDPOP    ZDATE                           S01313
342100200529     C****                 EXSR ZDATE1                                    S01313
342200200529     C****       *IN99     IFEQ '1'                                       S01313
342300200529     C****       WWDAT2    ORNE DDDPOP                                    S01313
342400200529     C*********************MOVEL'PM11205' MSGID                           S01313
342500200529     C*********************CALL 'ZA0240'                                  S01313
342600200529     C*********************PARM           MSGID                           S01313
342700200529     C****                 MOVEL'PM11205' ZAMSID                          S01313
342800200529     C****                 EXSR ZASNMS                                    S01313
342900200529     C****                 MOVE '1'       *IN80                           S01313
343000200529     C****                 MOVE '1'       *IN36                           S01313
343100200529     C****                 ELSE                                           S01313
343200200529     C****                 Z-ADDZDAYNO    WWDPOP                          S01313
343300200529     C****                 END                                            S01313
343400200529     C**+++++++++++++++++++++++++++++++++++++++++++++++++++++             S71062
343500200529     C** VAL4DDACSQ   FF MARGIN A/C SEQUENCE                              S71062
343600200529     C**+++++++++++++++++++++++++++++++++++++++++++++++++++++             S71062
343700200529     C                     MOVE *OFF      *IN07                           S71062
343800200529     C** Test if fututre & options module is on                           S71062
343900200529     C** If Bank Portfolios are supported, treat as if FF off             CPM003
344000200529     C           BGFUOP    IFEQ 'Y'                        B1             S71062
344100200529     C           FCPORS    ANDNE'B'                                       CPM003
344200200529     C** TEST IF ENTERED                                                  S71062
344300200529     C           DDACSQ    IFEQ *BLANKS                    B2             S71062
344400200529     C                     MOVE '01'      DDACSQ                          S71062
344500200529     C                     ELSE                            X2             S71062
344600200529     C* Field entered -> must be numeric                                  S71062
344700200529     C                     TESTN          DDACSQ     83                   S71062
344800200529     C           *IN83     IFEQ *OFF                       B3             S71062
344900200529     C                     MOVEL'PM11273' ZAMSID                          S71062
345000200529     C                     EXSR ZASNMS                                    S71062
345100200529     C                     MOVE *ON       *IN80                           S71062
345200200529     C                     MOVE *ON       *IN07                           S71062
345300200529     C                     ENDIF                           E3             S71062
345400200529     C                     ENDIF                           E2             S71062
345500200529     C                     ENDIF                           E1             S71062
345600200529     C**                                                                  S71062
345700200529     C**+++++++++++++++++++++++++++++++++++++++++++++++++++++
345800200529     C** VAL4DDPDGS   PLEDGE START DATE IF LOMBARD CREDITS NOT ON SYSTEM
345900200529     C**+++++++++++++++++++++++++++++++++++++++++++++++++++++
346000200529     C**
346100200529     C           BGLMCR    IFEQ 'N'                        - B1
346200200529     C**
346300200529     C           DDPDGS    IFNE *BLANKS                    - B2
346400200529     C**
346500200529     C** IF ENTERED PLEDGE FINISH DATE MUST ALSO BEEN SPECIFIED
346600200529     C**
346700200529     C           DDPDGF    IFEQ *BLANKS                    - B3
346800200529     C*********************MOVEL'PM11206' MSGID                           R00300
346900200529     C*********************CALL 'ZA0240'                                  R00300
347000200529     C*********************PARM           MSGID                           R00300
347100200529     C                     MOVEL'PM11206' ZAMSID                          R00300
347200200529     C                     EXSR ZASNMS                                    R00300
347300200529     C                     MOVE '1'       *IN80
347400200529     C                     MOVE '1'       *IN39
347500200529     C                     END                             - E3
347600200529     C*
347700200529     C**
347800200529     C** IF ENTERED MUST BE A VALID DATE
347900200529     C**
348000200529     C                     Z-ADD0         WWDAT1
348100200529     C                     MOVE *BLANKS   WWDAT2
348200200529     C                     MOVE DDPDGS    WWDAT1
348300200529     C                     MOVE WWDAT1    WWDAT2
348400200529     C**
348500200529     C                     MOVELDDPDGS    ZDATE
348600200529     C                     EXSR ZDATE1
348700200529     C           *IN99     IFEQ '1'                        - B3
348800200529     C           DDPDGS    ORNE WWDAT2
348900200529     C*********************MOVEL'PM11207' MSGID                           R00300
349000200529     C*********************CALL 'ZA0240'                                  R00300
349100200529     C*********************PARM           MSGID                           R00300
349200200529     C                     MOVEL'PM11207' ZAMSID                          R00300
349300200529     C                     EXSR ZASNMS                                    R00300
349400200529     C                     MOVE '1'       *IN80
349500200529     C                     MOVE '1'       *IN38
349600200529     C                     ELSE                            - X3
349700200529     C                     Z-ADDZDAYNO    WWPDGS
349800200529     C                     END                             - E3
349900200529     C*
350000200529     C**
350100200529     C** IF ENTERED CANNOT BE BEFORE DATE PORTFOLIO OPEN
350200200529     C**
350300200529     C           WWPDGS    IFLT WWDPOP                     - B3
350400200529     C*********************MOVEL'PM11208' MSGID                           R00300
350500200529     C*********************CALL 'ZA0240'                                  R00300
350600200529     C*********************PARM           MSGID                           R00300
350700200529     C                     MOVEL'PM11208' ZAMSID                          R00300
350800200529     C                     EXSR ZASNMS                                    R00300
350900200529     C                     MOVE '1'       *IN80
351000200529     C                     MOVE '1'       *IN38
351100200529     C                     END                             - E3
351200200529     C*
351300200529     C                     ELSE                            - X2
351400200529     C**
351500200529     C** IF DATE BLANKED OR NOT ENTERED
351600200529     C*
351700200529     C                     Z-ADD0         WWPDGS
351800200529     C*
351900200529     C                     END                             - E2
352000200529     C**+++++++++++++++++++++++++++++++++++++++++++++++++++++
352100200529     C** VAL4DDPDGF    PLEDGE FINISH DATE
352200200529     C**+++++++++++++++++++++++++++++++++++++++++++++++++++++
352300200529     C**
352400200529     C           DDPDGF    IFNE *BLANKS                    - B2
352500200529     C**
352600200529     C** IF ENTERED PLEDGE START DATE MUST ALSO BEEN SPECIFIED
352700200529     C**
352800200529     C           DDPDGS    IFEQ *BLANKS                    - B3
352900200529     C*********************MOVEL'PM11209' MSGID                           R00300
353000200529     C*********************CALL 'ZA0240'                                  R00300
353100200529     C*********************PARM           MSGID                           R00300
353200200529     C                     MOVEL'PM11209' ZAMSID                          R00300
353300200529     C                     EXSR ZASNMS                                    R00300
353400200529     C                     MOVE '1'       *IN80
353500200529     C                     MOVE '1'       *IN38
353600200529     C                     END                             - E3
353700200529     C*
353800200529     C**
353900200529     C** IF ENTERED MUST BE A VALID DATE
354000200529     C**
354100200529     C                     Z-ADD0         WWDAT1
354200200529     C                     MOVE *BLANKS   WWDAT2
354300200529     C                     MOVE DDPDGF    WWDAT1
354400200529     C                     MOVE WWDAT1    WWDAT2
354500200529     C                     MOVELDDPDGF    ZDATE
354600200529     C**
354700200529     C                     EXSR ZDATE1
354800200529     C           *IN99     IFEQ '1'                        - B3
354900200529     C           DDPDGF    ORNE WWDAT2
355000200529     C*********************MOVEL'PM11210' MSGID                           R00300
355100200529     C*********************CALL 'ZA0240'                                  R00300
355200200529     C*********************PARM           MSGID                           R00300
355300200529     C                     MOVEL'PM11210' ZAMSID                          R00300
355400200529     C                     EXSR ZASNMS                                    R00300
355500200529     C                     MOVE '1'       *IN80
355600200529     C                     MOVE '1'       *IN39
355700200529     C                     ELSE                            - X3
355800200529     C                     Z-ADDZDAYNO    WWPDGF
355900200529     C                     END                             - E3
356000200529     C*
356100200529     C**
356200200529     C** IF ENTERED MUST BE AFTER PLEDGE START DATE
356300200529     C**
356400200529     C           WWPDGF    IFLE WWPDGS                     - B3
356500200529     C*********************MOVEL'PM11211' MSGID                           R00300
356600200529     C*********************CALL 'ZA0240'                                  R00300
356700200529     C*********************PARM           MSGID                           R00300
356800200529     C                     MOVEL'PM11211' ZAMSID                          R00300
356900200529     C                     EXSR ZASNMS                                    R00300
357000200529     C                     MOVE '1'       *IN80
357100200529     C                     MOVE '1'       *IN39
357200200529     C                     END                             - E3
357300200529     C*
357400200529     C                     ELSE                            - X2
357500200529     C**
357600200529     C** IF DATE BLANKED OR NOT ENTERED
357700200529     C*
357800200529     C                     Z-ADD0         WWPDGF
357900200529     C*
358000200529     C                     END                             - E2
358100200529     C*
358200200529     C                     END                             - E1
358300200529     C*
358400200529     C** DATE PORTFOLIO MAY NOT BE AFTER PLEDGE START DTAE
358500200529     C*
358600200529     C                     MOVE 'N'       WWDPER  1
358700200529     C           BGLMCR    IFEQ 'N'
358800200529     C           WWDPOP    IFGT WWPDGS
358900200529     C           WWPDGS    ANDNE0
359000200529     C                     MOVE 'Y'       WWDPER
359100200529     C                     END
359200200529     C                     ELSE
359300200529     C*
359400200529     C           WWDPOP    IFLT PNPDGS
359500200529     C           PNPDGS    ANDNE0
359600200529     C                     MOVE 'Y'       WWDPER
359700200529     C                     END
359800200529     C                     END
359900200529     C**
360000200529     C** IF EROR FLAG ON THEN SEND ERROR MESSAGE
360100200529     C**
360200200529     C           WWDPER    IFEQ 'Y'
360300200529     C*********************MOVEL'PM11233' MSGID                           R00300
360400200529     C*********************CALL 'ZA0240'                                  R00300
360500200529     C*********************PARM           MSGID                           R00300
360600200529     C                     MOVEL'PM11233' ZAMSID                          R00300
360700200529     C                     EXSR ZASNMS                                    R00300
360800200529     C                     MOVE '1'       *IN80
360900200529     C                     MOVE '1'       *IN36
361000200529     C                     END
361100200529     C**+++++++++++++++++++++++++++++++++++++++++++++++++++++             CAC003
361200200529     C** VAL4DDPRFC     Profit Centre                                     CAC003
361300200529     C**+++++++++++++++++++++++++++++++++++++++++++++++++++++             CAC003
361400200529     C**                                                                  CAC003
361500200529     C           *IN87     IFEQ '1'                                       CAC003
361600200529     C*                                                                   CAC003
361700200529     C           DDPRF2    IFNE *BLANKS                                   CAC003
361800200529     C                     CALL 'AOPRFCR0'                                CAC003
361900200529     C                     PARM *BLANKS   WWRTCD                          CAC003
362000200529     C                     PARM '*KEY   ' WWOPTN                          CAC003
362100200529     C                     PARM DDPRF2    WWKEY4  4                       CAC003
362200200529     C           SDPRFC    PARM SDPRFC    DSFDY                           CAC003
362300200529     C           WWRTCD    IFNE *BLANKS                                   CAC003
362400200529     C                     MOVEL'PM14206' ZAMSID                          CAC003
362500200529     C                     EXSR ZASNMS                                    CAC003
362600200529     C                     MOVE '1'       *IN06                           CAC003
362700200529     C                     MOVE '1'       *IN80                           CAC003
362800200529     C                     ELSE                                           CAC003
362900200529     C                     MOVE DSPCCD    DDPRF2                          CAC003
363000200529     C                     ENDIF                                          CAC003
363100200529     C*                                                                   CAC003
363200200529     C*  Else, if no profit centre entered;                               CAC003
363300200529     C                     ELSE                                           CAC003
363400200529     C           BKPCDU    IFEQ 'Y'                                       CAC003
363500200529     C                     EXSR #PFRC                                     CAC003
363600200529     C                     MOVE WWPRFC    DDPRF2                          CAC003
363700200529     C                     ELSE                                           CAC003
363800200529     C                     MOVEL'PM14207' ZAMSID                          CAC003
363900200529     C                     EXSR ZASNMS                                    CAC003
364000200529     C                     MOVE '1'       *IN06                           CAC003
364100200529     C                     MOVE '1'       *IN80                           CAC003
364200200529     C                     ENDIF                                          CAC003
364300200529     C                     ENDIF                                          CAC003
364400200529     C*                                                                   CAC003
364500200529     C                     ENDIF                                          CAC003
364600200529     C*                                                                   CAC003
364700200529     C**+++++++++++++++++++++++++++++++++++++++++++++++++++++
364800200529     C** VAL4DDVLFQ     VALUATION FREQUENCY
364900200529     C**+++++++++++++++++++++++++++++++++++++++++++++++++++++
365000200529     C**
365100200529     C                     MOVE 'Y'       WWVALD  1
365200200529     C           DDVLFQ    IFNE *BLANKS
365300200529     C*
365400200529     C**
365500200529     C** IF ENTERED MUST BE EQUAL TO 'M', 'Q', 'X' OR 'Y'
365600200529     C**
365700200529     C           DDVLFQ    IFNE 'M'
365800200529     C           DDVLFQ    ANDNE'Q'
365900200529     C           DDVLFQ    ANDNE'X'
366000200529     C           DDVLFQ    ANDNE'Y'
366100200529     C                     MOVE 'N'       WWVALD
366200200529     C*********************MOVEL'PM11213' MSGID                           R00300
366300200529     C*********************CALL 'ZA0240'                                  R00300
366400200529     C*********************PARM           MSGID                           R00300
366500200529     C                     MOVEL'PM11213' ZAMSID                          R00300
366600200529     C                     EXSR ZASNMS                                    R00300
366700200529     C                     MOVE '1'       *IN80
366800200529     C                     MOVE '1'       *IN40
366900200529     C                     END
367000200529     C**
367100200529     C** IF ENTERED VALUATION DAY IN MONTH MUST ALSO BE SPECIFIED
367200200529     C**
367300200529     C           DDVLDM    IFEQ *BLANKS
367400200529     C                     MOVE 'N'       WWVALD
367500200529     C*********************MOVEL'PM11212' MSGID                           R00300
367600200529     C*********************CALL 'ZA0240'                                  R00300
367700200529     C*********************PARM           MSGID                           R00300
367800200529     C                     MOVEL'PM11212' ZAMSID                          R00300
367900200529     C                     EXSR ZASNMS                                    R00300
368000200529     C                     MOVE '1'       *IN80
368100200529     C                     MOVE '1'       *IN41
368200200529     C                     END
368300200529     C*
368400200529     C                     END
368500200529     C**+++++++++++++++++++++++++++++++++++++++++++++++++++++
368600200529     C** VAL4DDVLDM      VALUATION DAY IN MONTH
368700200529     C**+++++++++++++++++++++++++++++++++++++++++++++++++++++
368800200529     C**
368900200529     C           DDVLDM    IFNE *BLANKS
369000200529     C**
369100200529     C** IF ENTERED VALUIATION FREQUENCY MUST ALSO BEEN ENTERED
369200200529     C**
369300200529     C           DDVLFQ    IFEQ *BLANKS
369400200529     C                     MOVE 'N'       WWVALD
369500200529     C*********************MOVEL'PM11214' MSGID                           R00300
369600200529     C*********************CALL 'ZA0240'                                  R00300
369700200529     C*********************PARM           MSGID                           R00300
369800200529     C                     MOVEL'PM11214' ZAMSID                          R00300
369900200529     C                     EXSR ZASNMS                                    R00300
370000200529     C                     MOVE '1'       *IN80
370100200529     C                     MOVE '1'       *IN40
370200200529     C                     END
370300200529     C*
370400200529     C**
370500200529     C** IF ENTERED MUST BE IN THE RANGE 1-31
370600200529     C**
370700200529     C                     MOVE DDVLDM    WWVLDM
370800200529     C                     MOVE WWVLDM    WWVVDM
370900200529     C           WWVVDM    IFNE DDVLDM
371000200529     C           WWVLDM    ORLT 1
371100200529     C           WWVLDM    ORGT 31
371200200529     C                     MOVE 'N'       WWVALD
371300200529     C*********************MOVEL'PM11215' MSGID                           R00300
371400200529     C*********************CALL 'ZA0240'                                  R00300
371500200529     C*********************PARM           MSGID                           R00300
371600200529     C                     MOVEL'PM11215' ZAMSID                          R00300
371700200529     C                     EXSR ZASNMS                                    R00300
371800200529     C                     MOVE '1'       *IN80
371900200529     C                     MOVE '1'       *IN41
372000200529     C                     END
372100200529     C*
372200200529     C                     END
372300200529     C**
372400200529     C**+++++++++++++++++++++++++++++++++++++++++++++++++++++
372500200529     C** VAL4DDVLND       NEXT VALUATION DATE
372600200529     C**+++++++++++++++++++++++++++++++++++++++++++++++++++++
372700200529     C**
372800200529     C                     Z-ADD0         WWVLND
372900200529     C           DDVLND    IFNE *BLANKS
373000200529     C*
373100200529     C** IF ENTERED MUST BE A VALID DATE
373200200529     C**
373300200529     C                     Z-ADD0         WWDAT1
373400200529     C                     MOVE *BLANKS   WWDAT2
373500200529     C                     MOVE DDVLND    WWDAT1
373600200529     C                     MOVE WWDAT1    WWDAT2
373700200529     C**
373800200529     C                     MOVELDDVLND    ZDATE
373900200529     C                     EXSR ZDATE1
374000200529     C           *IN99     IFEQ '1'
374100200529     C           DDVLND    ORNE WWDAT2
374200200529     C*********************MOVEL'PM11216' MSGID                           R00300
374300200529     C*********************CALL 'ZA0240'                                  R00300
374400200529     C*********************PARM           MSGID                           R00300
374500200529     C                     MOVEL'PM11216' ZAMSID                          R00300
374600200529     C                     EXSR ZASNMS                                    R00300
374700200529     C                     MOVE '1'       *IN80
374800200529     C                     MOVE '1'       *IN42
374900200529     C                     ELSE
375000200529     C                     Z-ADDZDAYNO    WWVLND
375100200529     C                     END
375200200529     C*
375300200529     C** IF ENTERED MUST NOT BE BEFORE RUN DATE
375400200529     C**
375500200529     C           WWVLND    IFLT BJRDNB
375600200529     C*********************MOVEL'PM11217' MSGID                           R00300
375700200529     C*********************CALL 'ZA0240'                                  R00300
375800200529     C*********************PARM           MSGID                           R00300
375900200529     C                     MOVEL'PM11217' ZAMSID                          R00300
376000200529     C                     EXSR ZASNMS                                    R00300
376100200529     C                     MOVE '1'       *IN80
376200200529     C                     MOVE '1'       *IN42
376300200529     C                     END
376400200529     C*
376500200529     C                     ELSE
376600200529     C** IF NOT ENTERED AND
376700200529     C** IF VALUATION FREQUENCY AND DAY IN MONTH ENTERED
376800200529     C** CALCULATE IT
376900200529     C**
377000200529     C           DDVLFQ    IFNE *BLANK
377100200529     C           DDVLDM    ANDNE*BLANK
377200200529     C           WWVALD    ANDEQ'Y'
377300200529     C                     Z-ADDBJRDNB    ZDAYNO
377400200529     C                     MOVELDDVLFQ    ZFREQ
377500200529     C                     MOVELDDVLDM    ZMDAY
377600200529     C                     MOVELBJLCCY    ZCCY
377700200529     C                     EXSR ZFRQA
377800200529     C                     Z-ADDZDAYNO    WWVLND
377900200529     C                     END
378000200529     C*
378100200529     C** IF VALUATION DAY IN MONTH SAME AS TODAYS DATE DEFAULT NEXT
378200200529     C** VALUATION DATE TO RUN DATE
378300200529     C*
378400200529     C                     MOVELBJMRDT    WWDAY   20
378500200529     C           WWVLDM    IFEQ WWDAY
378600200529     C                     Z-ADDBJRDNB    WWVLND
378700200529     C                     END
378800200529     C                     END
378900200529     C****+++++++++++++++++++++++++++++++++++++++++++++++++++             S01313
379000200529     C****AL4DDAAD       ALTERNATE ADDRESS CODES                          S01313
379100200529     C****+++++++++++++++++++++++++++++++++++++++++++++++++++             S01313
379200200529     C****                 MOVE '0'       *IN83                           S01313
379300200529     C****                 MOVE '0'       *IN84                           S01313
379400200529     C****                 MOVE DDAAD1    DDAD,1                          S01313
379500200529     C****                 MOVE DDAAD2    DDAD,2                          S01313
379600200529     C****                 MOVE DDAAD3    DDAD,3                          S01313
379700200529     C****                 MOVE DDAAD4    DDAD,4                          S01313
379800200529     C****                 MOVE DDAAD5    DDAD,5                          S01313
379900200529     C****                 MOVE 'N'       WWMSG   1                       S01313
380000200529     C****                 MOVE 'N'       WWMSG1  1                       S01313
380100200529     C****                 MOVE WWPNP8    WWCCNM                          S01313
380200200529     C****                 MOVEA*BLANKS   AD,1                            S01313
380300200529     C****                                                                S01313
380400200529     C****ALIDATE ALTERNATE NAME AND ADDRESS INFROMATION                  S01313
380500200529     C****                                                                S01313
380600200529     C****       1         DO   5         X                - B1           S01313
380700200529     C****       DDAD,X    IFNE *BLANKS                    - B2           S01313
380800200529     C****                                                                S01313
380900200529     C****HECK THAT ADDREES IS UNIQUE                                     S01313
381000200529     C****                                                                S01313
381100200529     C****       DDAD,X    LOKUPAD,1                     77               S01313
381200200529     C****                                                                S01313
381300200529     C****       *IN77     IFEQ '1'                        - B3           S01313
381400200529     C****       WWMSG     IFEQ 'N'                        - B4           S01313
381500200529     C*********************MOVEL'PM11229' MSGID                           S01313
381600200529     C*********************CALL 'ZA0240'                                  S01313
381700200529     C*********************PARM           MSGID                           S01313
381800200529     C****                 MOVEL'PM11229' ZAMSID                          S01313
381900200529     C****                 EXSR ZASNMS                                    S01313
382000200529     C****                 MOVE 'Y'       WWMSG                           S01313
382100200529     C****                 MOVE '1'       *IN80                           S01313
382200200529     C****                 END                             - E4           S01313
382300200529     C****                 Z-ADD42        WW                              S01313
382400200529     C****       WW        ADD  X         WW                              S01313
382500200529     C****                 MOVE '1'       *IN,WW                          S01313
382600200529     C****                 END                             - E3           S01313
382700200529     C****                                                                S01313
382800200529     C****TORE ADDRESS IN ARRAY OF ADDRESSES                              S01313
382900200529     C****                                                                S01313
383000200529     C****       *IN77     IFEQ '0'                        - B3           S01313
383100200529     C****                 MOVE DDAD,X    AD,X                            S01313
383200200529     C****                 END                             - E3           S01313
383300200529     C****                                                                S01313
383400200529     C****HECK THAT ALTERNATE ADDRESS EXISTS ON FILE                      S01313
383500200529     C****                                                                S01313
383600200529     C****                 MOVELDDAD,X    WWALTN                          S01313
383700200529     C****       SDALT     CHAINSDALTNL1             72                   S01313
383800200529     C****       *IN72     IFEQ '1'                        - B3           S01313
383900200529     C****                                                                S01313
384000200529     C****       WWMSG1    IFEQ 'N'                        - B4           S01313
384100200529     C*********************MOVEL'PM11230' MSGID                           S01313
384200200529     C*********************CALL 'ZA0240'                                  S01313
384300200529     C*********************PARM           MSGID                           S01313
384400200529     C****                 MOVEL'PM11230' ZAMSID                          S01313
384500200529     C****                 EXSR ZASNMS                                    S01313
384600200529     C****                 MOVE 'Y'       WWMSG                           S01313
384700200529     C****                 MOVE '1'       *IN80                           S01313
384800200529     C****                 END                             - E4           S01313
384900200529     C****                 Z-ADD42        WW                              S01313
385000200529     C****       WW        ADD  X         WW                              S01313
385100200529     C****                 MOVE '1'       *IN,WW                          S01313
385200200529     C****                 END                             - E3           S01313
385300200529     C****                 END                             - E2           S01313
385400200529     C****                 END                             - E1           S01313
385500200529     C**
385600200529     C**+++++++++++++++++++++++++++++++++++++++++++++++++++++
385700200529     C** VAL4DDS2VR  SECTIONS OF VALUATION STATEMENT REQUIRED
385800200529     C**+++++++++++++++++++++++++++++++++++++++++++++++++++++
385900200529     C**
386000200529     C** IF ANY OF VALUATION STATEMENT FREQUENCY, DAY IN MONTH OR NEXT
386100200529     C** VALUATION DATE ARE ENTERED SECTIONS MUST BE ENTERED
386200200529     C           DDVLFQ    IFNE *BLANKS
386300200529     C           DDVLDM    ORNE *BLANKS
386400200529     C           DDVLND    ORNE *BLANKS
386500200529     C*                                                                   S01313
386600200529     C                     MOVE 'N'       WWMSG                           S01313
386700200529     C           DDS1VR    IFEQ *BLANKS                                   S01313
386800200529     C                     MOVE 'Y'       DDS1VR                          S01313
386900200529     C                     ELSE                                           S01313
387000200529     C           DDS1VR    IFNE 'Y'                                       S01313
387100200529     C           DDS1VR    ANDNE'N'                                       S01313
387200200529     C                     MOVEL'PM11219' ZAMSID                          S01313
387300200529     C                     EXSR ZASNMS                                    S01313
387400200529     C                     MOVE '1'       *IN80                           S01313
387500200529     C                     MOVE '1'       *IN43                           S01313
387600200529     C                     MOVE 'Y'       WWMSG                           S01313
387700200529     C                     END                                            S01313
387800200529     C                     END                                            S01313
387900200529     C*
388000200529     C           DDS2VR    IFEQ *BLANKS
388100200529     C                     MOVE 'Y'       DDS2VR
388200200529     C                     ELSE
388300200529     C           DDS2VR    IFNE 'Y'
388400200529     C           DDS2VR    ANDNE'N'
388500200529     C*********************MOVEL'PM11219' MSGID                           R00300
388600200529     C*********************CALL 'ZA0240'                                  R00300
388700200529     C*********************PARM           MSGID                           R00300
388800200529     C           WWMSG     IFEQ 'N'                                       R00300
388900200529     C                     MOVEL'PM11219' ZAMSID                          R00300
389000200529     C                     EXSR ZASNMS                                    R00300
389100200529     C                     END                                            R00300
389200200529     C                     MOVE '1'       *IN80
389300200529     C*******              MOVE '1'       *IN48                           S01313
389400200529     C                     MOVE '1'       *IN44                           S01313
389500200529     C                     MOVE 'Y'       WWMSG                           S01313
389600200529     C                     END
389700200529     C                     END
389800200529     C**
389900200529     C           DDS3VR    IFEQ *BLANKS
390000200529     C*                                                                   S01313
390100200529     C** DEFAULT ACCORDING TO WHETHER PERFORMANCE PERIOD REQUIRED         S01313
390200200529     C           DDRPYP    IFEQ 'Y'                                       S01313
390300200529     C                     MOVE 'Y'       DDS3VR                          S01313
390400200529     C                     ELSE                                           S01313
390500200529     C                     MOVE 'N'       DDS3VR                          S01313
390600200529     C                     END                                            S01313
390700200529     C*                                                                   S01313
390800200529     C                     ELSE
390900200529     C           DDS3VR    IFNE 'Y'
391000200529     C           DDS3VR    ANDNE'N'
391100200529     C*********************MOVEL'PM11219' MSGID                           R00300
391200200529     C*********************CALL 'ZA0240'                                  R00300
391300200529     C*********************PARM           MSGID                           R00300
391400200529     C           WWMSG     IFEQ 'N'                                       R00300
391500200529     C                     MOVEL'PM11219' ZAMSID                          R00300
391600200529     C                     EXSR ZASNMS                                    R00300
391700200529     C                     END                                            R00300
391800200529     C                     MOVE '1'       *IN80
391900200529     C****                 MOVE '1'       *IN74                           S01313
392000200529     C                     MOVE '1'       *IN45                           S01313
392100200529     C                     MOVE 'Y'       WWMSG                           S01313
392200200529     C                     END
392300200529     C                     END
392400200529     C*                                                                   S01313
392500200529     C** MAY ONLY BE SET TO 'Y' IF PERFORMANCE PERIOD REQUIRED            S01313
392600200529     C           DDS3VR    IFEQ 'Y'                                       S01313
392700200529     C           DDRPYP    ANDNE'Y'                                       S01313
392800200529     C                     MOVEL'PM11261' ZAMSID                          S01313
392900200529     C                     EXSR ZASNMS                                    S01313
393000200529     C                     MOVE '1'       *IN80                           S01313
393100200529     C                     MOVE '1'       *IN45                           S01313
393200200529     C                     END                                            S01313
393300200529     C**
393400200529     C           DDS4VR    IFEQ *BLANKS
393500200529     C*                                                                   S01313
393600200529     C** DEFAULT ACCORDING TO WHETHER PERFORMANCE PERIOD REQUIRED         S01313
393700200529     C           DDTYSM    IFNE *BLANKS                                   S01313
393800200529     C                     MOVE 'Y'       DDS4VR                          S01313
393900200529     C                     ELSE                                           S01313
394000200529     C                     MOVE 'N'       DDS4VR                          S01313
394100200529     C                     END                                            S01313
394200200529     C*                                                                   S01313
394300200529     C                     ELSE
394400200529     C           DDS4VR    IFNE 'Y'
394500200529     C           DDS4VR    ANDNE'N'
394600200529     C*********************MOVEL'PM11219' MSGID                           R00300
394700200529     C*********************CALL 'ZA0240'                                  R00300
394800200529     C*********************PARM           MSGID                           R00300
394900200529     C           WWMSG     IFEQ 'N'                                       R00300
395000200529     C                     MOVEL'PM11219' ZAMSID                          R00300
395100200529     C                     EXSR ZASNMS                                    R00300
395200200529     C                     END                                            R00300
395300200529     C                     MOVE '1'       *IN80
395400200529     C****                 MOVE '1'       *IN75                           S01313
395500200529     C                     MOVE '1'       *IN46                           S01313
395600200529     C                     MOVE 'Y'       WWMSG                           S01313
395700200529     C                     END
395800200529     C                     END
395900200529     C*                                                                   S01313
396000200529     C** MAY ONLY BE SET TO 'Y' IF PERFORMANCE PERIOD REQUIRED            S01313
396100200529     C           DDS4VR    IFEQ 'Y'                                       S01313
396200200529     C           DDTYSM    ANDEQ'  '                                      S01313
396300200529     C                     MOVEL'PM11262' ZAMSID                          S01313
396400200529     C                     EXSR ZASNMS                                    S01313
396500200529     C                     MOVE '1'       *IN80                           S01313
396600200529     C                     MOVE '1'       *IN46                           S01313
396700200529     C                     END                                            S01313
396800200529     C**
396900200529     C           DDS5VR    IFEQ *BLANKS
397000200529     C*                                                                   S01313
397100200529     C** DEFAULT ACCORDING TO WHETHER PERFORMANCE PERIOD REQUIRED         S01313
397200200529     C           DDADPP    IFEQ 'Q'                                       S01313
397300200529     C           DDADPP    OREQ 'H'                                       S01313
397400200529     C                     MOVE 'Y'       DDS5VR                          S01313
397500200529     C                     ELSE                                           S01313
397600200529     C                     MOVE 'N'       DDS5VR                          S01313
397700200529     C                     END                                            S01313
397800200529     C*                                                                   S01313
397900200529     C                     ELSE
398000200529     C           DDS5VR    IFNE 'Y'
398100200529     C           DDS5VR    ANDNE'N'
398200200529     C*********************MOVEL'PM11219' MSGID                           R00300
398300200529     C*********************CALL 'ZA0240'                                  R00300
398400200529     C*********************PARM           MSGID                           R00300
398500200529     C           WWMSG     IFEQ 'N'                                       R00300
398600200529     C                     MOVEL'PM11219' ZAMSID                          R00300
398700200529     C                     EXSR ZASNMS                                    R00300
398800200529     C                     END                                            R00300
398900200529     C                     MOVE '1'       *IN80
399000200529     C****                 MOVE '1'       *IN76                           S01313
399100200529     C                     MOVE '1'       *IN47                           S01313
399200200529     C                     MOVE 'Y'       WWMSG                           S01313
399300200529     C                     END
399400200529     C                     END
399500200529     C*                                                                   S01313
399600200529     C** MAY ONLY BE SET TO 'Y' IF PERFORMANCE PERIOD REQUIRED            S01313
399700200529     C           DDS5VR    IFEQ 'Y'                                       S01313
399800200529     C           DDADPP    ANDEQ' '                                       S01313
399900200529     C                     MOVEL'PM11263' ZAMSID                          S01313
400000200529     C                     EXSR ZASNMS                                    S01313
400100200529     C                     MOVE '1'       *IN80                           S01313
400200200529     C                     MOVE '1'       *IN47                           S01313
400300200529     C                     END                                            S01313
400400200529     C*
400500200529     C           DDS6VR    IFEQ *BLANKS
400600200529     C                     MOVE 'Y'       DDS6VR
400700200529     C                     ELSE
400800200529     C           DDS6VR    IFNE 'Y'
400900200529     C           DDS6VR    ANDNE'N'
401000200529     C*********************MOVEL'PM11219' MSGID                           R00300
401100200529     C*********************CALL 'ZA0240'                                  R00300
401200200529     C*********************PARM           MSGID                           R00300
401300200529     C           WWMSG     IFEQ 'N'                                       R00300
401400200529     C                     MOVEL'PM11219' ZAMSID                          R00300
401500200529     C                     EXSR ZASNMS                                    R00300
401600200529     C                     END                                            R00300
401700200529     C                     MOVE '1'       *IN80
401800200529     C*****                MOVE '1'       *IN49                           S01313
401900200529     C                     MOVE '1'       *IN48                           S01313
402000200529     C                     MOVE 'Y'       WWMSG                           S01313
402100200529     C                     END
402200200529     C                     END
402300200529     C*                                                                   S01313
402400200529     C           DDS7VR    IFEQ *BLANKS                                   S01313
402500200529     C                     MOVE 'Y'       DDS7VR                          S01313
402600200529     C                     ELSE                                           S01313
402700200529     C           DDS7VR    IFNE 'Y'                                       S01313
402800200529     C           DDS7VR    ANDNE'N'                                       S01313
402900200529     C           WWMSG     IFEQ 'N'                                       R00300
403000200529     C                     MOVEL'PM11219' ZAMSID                          R00300
403100200529     C                     EXSR ZASNMS                                    R00300
403200200529     C                     END                                            R00300
403300200529     C                     MOVE '1'       *IN80                           S01313
403400200529     C                     MOVE '1'       *IN49                           S01313
403500200529     C                     MOVE 'Y'       WWMSG                           S01313
403600200529     C                     END                                            S01313
403700200529     C                     END                                            S01313
403800200529     C*                                                                   S01313
403900200529     C           DDS8VR    IFEQ *BLANKS                                   S01313
404000200529     C                     MOVE 'Y'       DDS8VR                          S01313
404100200529     C                     ELSE                                           S01313
404200200529     C           DDS8VR    IFNE 'Y'                                       S01313
404300200529     C           DDS8VR    ANDNE'N'                                       S01313
404400200529     C           WWMSG     IFEQ 'N'                                       R00300
404500200529     C                     MOVEL'PM11219' ZAMSID                          R00300
404600200529     C                     EXSR ZASNMS                                    R00300
404700200529     C                     END                                            R00300
404800200529     C                     MOVE '1'       *IN80                           S01313
404900200529     C                     MOVE '1'       *IN74                           S01313
405000200529     C                     END                                            S01313
405100200529     C                     END                                            S01313
405200200529     C*                                                                   CPM005
405300200529     C           DDS9VR    IFEQ *BLANKS                                   CPM005
405400200529     C                     MOVE 'Y'       DDS9VR                          CPM005
405500200529     C                     ELSE                                           CPM005
405600200529     C           DDS9VR    IFNE 'Y'                                       CPM005
405700200529     C           DDS9VR    ANDNE'N'                                       CPM005
405800200529     C           WWMSG     IFEQ 'N'                                       CPM005
405900200529     C                     MOVEL'PM11219' ZAMSID                          CPM005
406000200529     C                     EXSR ZASNMS                                    CPM005
406100200529     C                     END                                            CPM005
406200200529     C                     MOVE '1'       *IN80                           CPM005
406300200529     C                     MOVE '1'       *IN15                           CPM005
406400200529     C                     END                                            CPM005
406500200529     C                     END                                            CPM005
406600200529     C*                                                                   CPM005
406700200529     C           DDS0VR    IFEQ *BLANKS                                   CPM005
406800200529     C                     MOVE 'Y'       DDS0VR                          CPM005
406900200529     C                     ELSE                                           CPM005
407000200529     C           DDS0VR    IFNE 'Y'                                       CPM005
407100200529     C           DDS0VR    ANDNE'N'                                       CPM005
407200200529     C           WWMSG     IFEQ 'N'                                       CPM005
407300200529     C                     MOVEL'PM11219' ZAMSID                          CPM005
407400200529     C                     EXSR ZASNMS                                    CPM005
407500200529     C                     END                                            CPM005
407600200529     C                     MOVE '1'       *IN80                           CPM005
407700200529     C                     MOVE '1'       *IN07                           CPM005
407800200529     C                     END                                            CPM005
407900200529     C                     END                                            CPM005
408000200529     C                     END                                            S01313
408100200529     C**                                                                  S01313
408200200529     C           DDRPYP    IFNE 'Y'                                       S01313
408300200529     C           DDRPYP    ANDNE'N'                                       S01313
408400200529     C                     MOVEL'PM11271' ZAMSID                          S01313
408500200529     C                     EXSR ZASNMS                                    S01313
408600200529     C                     MOVE '1'       *IN80                           S01313
408700200529     C                     MOVE '1'       *IN16                           S01313
408800200529     C                     END                                            S01313
408900200529     C**                                                                  S01313
409000200529     C           DDTYSM    IFNE *BLANKS                                   S01313
409100200529     C*                                                                   S01313
409200200529     C           DDTYSM    IFLT '01'                                      S01313
409300200529     C           DDTYSM    ORGT '12'                                      S01313
409400200529     C                     MOVE '1'       *IN80                           S01313
409500200529     C                     MOVE '1'       *IN17                           S01313
409600200529     C                     MOVEL'PM11254' ZAMSID                          S01313
409700200529     C                     EXSR ZASNMS                                    S01313
409800200529     C                     END                                            S01313
409900200529     C*                                                                   S01313
410000200529     C                     END                                            S01313
410100200529     C*                                                                   S01313
410200200529     C** VALIDATE ADDITIONAL PERFORMANCE PERIOD                           S01313
410300200529     C** If entered must be 'Q' or 'H'                                    S01313
410400200529     C*                                                                   S01313
410500200529     C           DDADPP    IFNE *BLANKS                                   S01313
410600200529     C           DDADPP    ANDNE'Q'                                       S01313
410700200529     C           DDADPP    ANDNE'H'                                       S01313
410800200529     C                     MOVE '1'       *IN80                           S01313
410900200529     C                     MOVE '1'       *IN18                           S01313
411000200529     C                     MOVEL'PM11255' ZAMSID                          S01313
411100200529     C                     EXSR ZASNMS                                    S01313
411200200529     C                     END                                            S01313
411300200529     C*                                                                   S01313
411400200529     C** IF ALL PERFORMANCE PERIODS ENTERED CORRECTLY, VALIDATE           S01313
411500200529     C** PERFORMANCE START DATE                                           S01313
411600200529     C           *IN16     IFEQ '0'                        B1             S01313
411700200529     C           *IN17     ANDEQ'0'                                       S01313
411800200529     C           *IN18     ANDEQ'0'                                       S01313
411900200529     C*                                                                   S01313
412000200529     C** IF ANY OF PERFORMANCE PERIODS ENTERED, START DATE MAY NOT BE     S01313
412100200529     C** BLANK                                                            S01313
412200200529     C           DDRPYP    IFEQ 'Y'                        B2             S01313
412300200529     C           DDTYSM    ORNE '  '                                      S01313
412400200529     C           DDADPP    OREQ 'Q'                                       S01313
412500200529     C           DDADPP    OREQ 'H'                                       S01313
412600200529     C*                                                                   S01313
412700200529     C           DDPSDT    IFEQ *BLANKS                    B3             S01313
412800200529     C                     MOVEL'PM11256' ZAMSID                          S01313
412900200529     C                     EXSR ZASNMS                                    S01313
413000200529     C                     MOVE '1'       *IN80                           S01313
413100200529     C                     MOVE '1'       *IN19                           S01313
413200200529     C                     END                             E3             S01313
413300200529     C                     END                             E2             S01313
413400200529     C*                                                                   S01313
413500200529     C** IF NO PERFORMANCE PERIOD DEFINED, START DATE MUST BE BLANK       S01313
413600200529     C           DDRPYP    IFEQ 'N'                        B2             S01313
413700200529     C           DDTYSM    ANDEQ'  '                                      S01313
413800200529     C           DDADPP    ANDEQ' '                                       S01313
413900200529     C*                                                                   S01313
414000200529     C           DDPSDT    IFNE *BLANKS                    B3             S01313
414100200529     C                     MOVEL'PM11272' ZAMSID                          S01313
414200200529     C                     EXSR ZASNMS                                    S01313
414300200529     C                     MOVE '1'       *IN80                           S01313
414400200529     C                     MOVE '1'       *IN19                           S01313
414500200529     C                     END                             E3             S01313
414600200529     C                     END                             E2             S01313
414700200529     C*                                                                   S01313
414800200529     C** DATE MUST BE A VALID DATE                                        S01313
414900200529     C                     Z-ADD0         WWPSDT  50                      S01313
415000200529     C           DDPSDT    IFNE *BLANKS                    B2             S01313
415100200529     C           *IN19     ANDEQ'0'                                       S01313
415200200529     C                     MOVE DDPSDT    ZDATE                           S01313
415300200529     C                     EXSR ZDATE1                                    S01313
415400200529     C           *IN99     IFEQ '1'                        B3             S01313
415500200529     C                     MOVEL'PM11257' ZAMSID                          S01313
415600200529     C                     EXSR ZASNMS                                    S01313
415700200529     C                     MOVE '1'       *IN80                           S01313
415800200529     C                     MOVE '1'       *IN19                           S01313
415900200529     C                     ELSE                            X3             S01313
416000200529     C                     Z-ADDZDAYNO    WWPSDT                          S01313
416100200529     C                     END                             E3             S01313
416200200529     C                     END                             E2             S01313
416300200529     C**                                                                  S01313
416400200529     C** IN INSERT MODE DATE PORTFOLIO OPENED MUST BE EQUAL TO DATE       S01313
416500200529     C** PORTFOLIO OPENED OR TO A START OF MONTH IN THE FUTURE            S01313
416600200529     C           DDACTN    IFEQ 'I'                        B2             S01313
416700200529     C           *IN19     ANDEQ'0'                                       S01313
416800200529     C*                                                                   S01313
416900200529     C** CONVERT PERFORMANCE START DATE TO DATE IN FORMAT DDMMYY          S01313
417000200529     C                     MOVE '0'       *IN98                           S01313
417100200529     C                     Z-ADDWWPSDT    ZDAYNO                          S01313
417200200529     C                     EXSR ZDATE2                                    S01313
417300200529     C*                                                                   S01313
417400200529     C                     MOVELZDATE     WWORK4                          S01313
417500200529     C                     MOVELWWORK4    WFDAY   20                      S01313
417600200529     C                     MOVE WWORK4    WFMTH   20                      S01313
417700200529     C                     MOVE ZDATE     WFYEAR  20                      S01313
417800200529     C                     MOVELWFYEAR    WFMTHY  40                      S01313
417900200529     C                     MOVE WFMTH     WFMTHY                          S01313
418000200529     C*                                                                   S01313
418100200529     C           BJDFIN    IFEQ 'M'                        B3             S01313
418200200529     C                     MOVE '1'       *IN98                           S01313
418300200529     C                     END                             E3             S01313
418400200529     C*                                                                   S01313
418500200529     C           DDPSDT    IFNE *BLANKS                    B3             S01313
418600200529     C           DDPSDT    IFNE DDDPOP                     B4             S01313
418700200529      *                                                                   CPM005
418800200529      ** MUST BE GREATER THAN RUN DATE                                    CPM005
418900200529     C           WWPSDT    IFLE BJRDNB                     B4             CPM005
419000200529     C********** WFDAY     IFNE 1                          B5       S01313CPM005
419100200529     C********** WFMTHY    ORLE W1MTHY                              S01313CPM005
419200200529     C                     MOVEL'PM11267' ZAMSID                          S01313
419300200529     C                     EXSR ZASNMS                                    S01313
419400200529     C                     MOVE '1'       *IN80                           S01313
419500200529     C                     MOVE '1'       *IN19                           S01313
419600200529     C**********           END                             E5       S01313CPM005
419700200529     C                     END                             E4             CPM005
419800200529     C                     END                             E4             S01313
419900200529     C                     END                             E3             S01313
420000200529     C                     END                             E2             S01313
420100200529     C**                                                                  S01313
420200200529     C** VALIDATION FOR AMEND MODE                                        S01313
420300200529     C           DDACTN    IFEQ 'A'                        B2             S01313
420400200529     C           *IN19     ANDEQ'0'                                       S01313
420500200529     C*                                                                   S01313
420600200529     C***IN AMEND MODE MAY ONLY BE CHANGED TO ANOTHER DATE IF THE   S01313046909
420700200529     C***PERFORMANCE START DATE HAS NOT YET BEEN REACHED            S01313046909
420800200529     C********** DDPSDT    IFNE *BLANKS                    B3       S01313046909
420900200529     C********** WWPSDT    ANDNEWAPSDT                              S01313046909
421000200529     C********** WAPSDT    ANDLEBJRDNB                              S01313046909
421100200529     C********** WAPSDT    ANDNE99999                               S01313046909
421200200529     C**********           MOVEL'PM11268' ZAMSID                    S01313046909
421300200529     C**********           EXSR ZASNMS                              S01313046909
421400200529     C**********           MOVE '1'       *IN80                     S01313046909
421500200529     C**********           MOVE '1'       *IN19                     S01313046909
421600200529     C**********           END                             E3       S01313046909
421700200529     C*                                                                   S01313
421800200529     C***IF*DATE*CHANGED*MUST*BE*START*OF*MONTH*IN*THE*FUTURE       S01313CPM005
421900200529     C** IF DATE CHANGED                                                  CPM005
422000200529     C           *IN19     IFEQ '0'                        B3             S01313
422100200529     C           WWPSDT    ANDNEWAPSDT                                    S01313
422200200529     C           DDPSDT    ANDNE*BLANKS                                   S01313
422300200529     C                     MOVE '0'       *IN98                           S01313
422400200529     C                     Z-ADDWWPSDT    ZDAYNO                          S01313
422500200529     C                     EXSR ZDATE2                                    S01313
422600200529     C*                                                                   S01313
422700200529     C                     MOVELZDATE     WWORK4                          S01313
422800200529     C                     MOVELWWORK4    WFDAY   20                      S01313
422900200529     C                     MOVE WWORK4    WFMTH   20                      S01313
423000200529     C                     MOVE ZDATE     WFYEAR  20                      S01313
423100200529     C                     MOVELWFYEAR    WFMTHY  40                      S01313
423200200529     C                     MOVE WFMTH     WFMTHY                          S01313
423300200529     C*                                                                   S01313
423400200529     C           BJDFIN    IFEQ 'M'                        B4             S01313
423500200529     C                     MOVE '1'       *IN98                           S01313
423600200529     C                     END                             E4             S01313
423700200529      *                                                                   CPM005
423800200529      ** PERFORMANCE START DATE MUST BE GREATER THAN RUN DATE             CPM005
423900200529     C           WWPSDT    IFLT BJRDNB                     B4             CPM005
424000200529     C                     MOVEL'PM11260' ZAMSID                          CPM005
424100200529     C                     EXSR ZASNMS                                    CPM005
424200200529     C                     MOVE '1'       *IN80                           CPM005
424300200529     C                     MOVE '1'       *IN19                           CPM005
424400200529     C                     ELSE                            X4             CPM005
424500200529      *                                                                   CPM005
424600200529      ** PERFORMANCE START DATE CAN BE DURING CURRENT MONTH               CPM005
424700200529      ** IF PERFORMANCE NOT ALREADY ACTIVE DURING THIS MONTH              CPM005
424800200529     C           WWPSDT    IFGE BJRDNB                     B5             CPM005
424900200529     C           WWPSDT    ANDLEWENDMT                                    CPM005
425000200529     C                     MOVE WFMTH     KFMTH                           CPM005
425100200529     C           PERFOK    CHAINPMPSTMQ0             72                   CPM005
425200200529      *                                                                   CPM005
425300200529      ** IF RECORD FOUND ON PF/PMPSTMQ0                                   CPM005
425400200529     C           *IN72     IFEQ '0'                        B6             CPM005
425500200529     C                     MOVEL'PM11260' ZAMSID                          CPM005
425600200529     C                     EXSR ZASNMS                                    CPM005
425700200529     C                     MOVE '1'       *IN80                           CPM005
425800200529     C                     MOVE '1'       *IN19                           CPM005
425900200529     C                     END                             E6             CPM005
426000200529     C                     END                             E5             CPM005
426100200529     C                     END                             E4             CPM005
426200200529     C*                                                                   S01313
426300200529     C********** WFDAY     IFNE 1                          B4       S01313CPM005
426400200529     C********** WFMTHY    ORLE W1MTHY                              S01313CPM005
426500200529     C**********           MOVEL'PM11260' ZAMSID                    S01313CPM005
426600200529     C**********           EXSR ZASNMS                              S01313CPM005
426700200529     C**********           MOVE '1'       *IN80                     S01313CPM005
426800200529     C**********           MOVE '1'       *IN19                     S01313CPM005
426900200529     C**********           END                             E4       S01313CPM005
427000200529     C                     END                             E3             S01313
427100200529     C                     END                             E2             S01313
427200200529     C                     END                             E1             S01313
427300200529     C**                                                                  S01313
427400200529     C** IF ENTERED FIELD PERFORMANCE 'NET/GROSS OF TAX' SHOULD BE SET    S01313
427500200529     C** TO 'N' OR 'G'                                                    S01313
427600200529     C           DDPMNG    IFNE *BLANKS                                   S01313
427700200529     C*                                                                   S01313
427800200529     C           DDPMNG    IFNE 'N'                                       S01313
427900200529     C           DDPMNG    ANDNE'G'                                       S01313
428000200529     C                     MOVEL'PM11258' ZAMSID                          S01313
428100200529     C                     EXSR ZASNMS                                    S01313
428200200529     C                     MOVE '1'       *IN80                           S01313
428300200529     C                     MOVE '1'       *IN09                           S01313
428400200529     C                     END                                            S01313
428500200529     C                     END                                            S01313
428600200529     C**                                                                  S01313
428700200529     C** IF ANY OF PERFORMANCE PERIODS ENTERED THE FIELD 'PERFORMANCE     S01313
428800200529     C** NET/GROSS OF TAX' SHOULD ALSO BE DEFINED                         S01313
428900200529     C           DDPMNG    IFEQ *BLANKS                                   S01313
429000200529     C*                                                                   S01313
429100200529     C           DDRPYP    IFEQ 'Y'                                       S01313
429200200529     C           DDTYSM    ORNE *BLANKS                                   S01313
429300200529     C           DDADPP    OREQ 'H'                                       S01313
429400200529     C           DDADPP    OREQ 'Q'                                       S01313
429500200529     C                     MOVEL'PM11269' ZAMSID                          S01313
429600200529     C                     EXSR ZASNMS                                    S01313
429700200529     C                     MOVE '1'       *IN80                           S01313
429800200529     C                     MOVE '1'       *IN09                           S01313
429900200529     C                     END                                            S01313
430000200529     C                     END                                            S01313
430100200529     C*
430200200529     C** IF ALL VALUATION STATEMENT DETAILS BLANK THEN VALUATION STATEMENT
430300200529     C** SECTION INDICATORS MUST ALSO BE BLANK
430400200529     C           DDVLFQ    IFEQ *BLANKS
430500200529     C           DDVLDM    ANDEQ*BLANKS
430600200529     C           DDVLND    ANDEQ*BLANKS
430700200529     C*                                                                   S01313
430800200529     C                     MOVE 'N'       WWMSG                           S01313
430900200529     C           DDS1VR    IFNE *BLANKS                                   S01313
431000200529     C                     MOVEL'PM11219' ZAMSID                          S01313
431100200529     C                     EXSR ZASNMS                                    S01313
431200200529     C                     MOVE '1'       *IN80                           S01313
431300200529     C                     MOVE '1'       *IN43                           S01313
431400200529     C                     MOVE 'Y'       WWMSG                           S01313
431500200529     C                     END                                            S01313
431600200529     C*
431700200529     C           DDS2VR    IFNE *BLANKS
431800200529     C*********************MOVEL'PM11219' MSGID                           R00300
431900200529     C*********************CALL 'ZA0240'                                  R00300
432000200529     C*********************PARM           MSGID                           R00300
432100200529     C           WWMSG     IFEQ 'N'                                       S01313
432200200529     C                     MOVEL'PM11219' ZAMSID                          R00300
432300200529     C                     EXSR ZASNMS                                    R00300
432400200529     C                     END                                            S01313
432500200529     C                     MOVE '1'       *IN80
432600200529     C****                 MOVE '1'       *IN48                           S01313
432700200529     C                     MOVE '1'       *IN44                           S01313
432800200529     C                     MOVE 'Y'       WWMSG                           S01313
432900200529     C                     END
433000200529     C*
433100200529     C           DDS3VR    IFNE *BLANKS
433200200529     C*********************MOVEL'PM11219' MSGID                           R00300
433300200529     C*********************CALL 'ZA0240'                                  R00300
433400200529     C*********************PARM           MSGID                           R00300
433500200529     C           WWMSG     IFEQ 'N'                                       S01313
433600200529     C*******************  MOVEL'PM11219' ZAMSID                   R00300 054002
433700200529     C                     MOVEL'PM11214' ZAMSID                          054002
433800200529     C                     EXSR ZASNMS                                    R00300
433900200529     C                     END                                            S01313
434000200529     C                     MOVE '1'       *IN80
434100200529     C****                 MOVE '1'       *IN74                           S01313
434200200529     C                     MOVE '1'       *IN45                           S01313
434300200529     C                     MOVE 'Y'       WWMSG                           S01313
434400200529     C                     END
434500200529     C*
434600200529     C           DDS4VR    IFNE *BLANKS
434700200529     C*********************MOVEL'PM11219' MSGID                           R00300
434800200529     C*********************CALL 'ZA0240'                                  R00300
434900200529     C*********************PARM           MSGID                           R00300
435000200529     C           WWMSG     IFEQ 'N'                                       S01313
435100200529     C******************** MOVEL'PM11219' ZAMSID                   R00300 054002
435200200529     C                     MOVEL'PM11214' ZAMSID                          054002
435300200529     C                     EXSR ZASNMS                                    R00300
435400200529     C                     END                                            S01313
435500200529     C                     MOVE '1'       *IN80
435600200529     C****                 MOVE '1'       *IN75                           S01313
435700200529     C                     MOVE '1'       *IN46                           S01313
435800200529     C                     MOVE 'Y'       WWMSG                           S01313
435900200529     C                     END
436000200529     C*
436100200529     C           DDS5VR    IFNE *BLANKS
436200200529     C*********************MOVEL'PM11219' MSGID                           R00300
436300200529     C*********************CALL 'ZA0240'                                  R00300
436400200529     C*********************PARM           MSGID                           R00300
436500200529     C           WWMSG     IFEQ 'N'                                       S01313
436600200529     C******************** MOVEL'PM11219' ZAMSID                   R00300 054002
436700200529     C                     MOVEL'PM11214' ZAMSID                          054002
436800200529     C                     EXSR ZASNMS                                    R00300
436900200529     C                     END                                            S01313
437000200529     C                     MOVE '1'       *IN80
437100200529     C****                 MOVE '1'       *IN76                           S01313
437200200529     C                     MOVE '1'       *IN47                           S01313
437300200529     C                     MOVE 'Y'       WWMSG                           S01313
437400200529     C                     END
437500200529     C*
437600200529     C           DDS6VR    IFNE *BLANKS
437700200529     C*********************MOVEL'PM11219' MSGID                           R00300
437800200529     C*********************CALL 'ZA0240'                                  R00300
437900200529     C*********************PARM           MSGID                           R00300
438000200529     C           WWMSG     IFEQ 'N'                                       S01313
438100200529     C******************** MOVEL'PM11219' ZAMSID                   R00300 054002
438200200529     C                     MOVEL'PM11214' ZAMSID                          054002
438300200529     C                     EXSR ZASNMS                                    R00300
438400200529     C                     END                                            S01313
438500200529     C                     MOVE '1'       *IN80
438600200529     C****                 MOVE '1'       *IN49                           S01313
438700200529     C                     MOVE '1'       *IN48                           S01313
438800200529     C                     MOVE 'Y'       WWMSG                           S01313
438900200529     C                     END
439000200529     C*                                                                   S01313
439100200529     C           DDS7VR    IFNE *BLANKS                                   S01313
439200200529     C           WWMSG     IFEQ 'N'                                       S01313
439300200529     C******************** MOVEL'PM11219' ZAMSID                   S01313 054002
439400200529     C                     MOVEL'PM11214' ZAMSID                          054002
439500200529     C                     EXSR ZASNMS                                    S01313
439600200529     C                     END                                            S01313
439700200529     C                     MOVE '1'       *IN80                           S01313
439800200529     C                     MOVE '1'       *IN49                           S01313
439900200529     C                     MOVE 'Y'       WWMSG                           S01313
440000200529     C                     END                                            S01313
440100200529     C*                                                                   S01313
440200200529     C           DDS8VR    IFNE *BLANKS                                   S01313
440300200529     C           WWMSG     IFEQ 'N'                                       S01313
440400200529     C******************** MOVEL'PM11219' ZAMSID                   S01313 054002
440500200529     C                     MOVEL'PM11214' ZAMSID                          054002
440600200529     C                     EXSR ZASNMS                                    S01313
440700200529     C                     END                                            S01313
440800200529     C                     MOVE '1'       *IN80                           S01313
440900200529     C                     MOVE '1'       *IN74                           S01313
441000200529     C                     MOVE 'Y'       WWMSG                           S01313
441100200529     C                     END                                            S01313
441200200529     C*                                                                   CPM005
441300200529     C           DDS9VR    IFNE *BLANKS                                   CPM005
441400200529     C           WWMSG     IFEQ 'N'                                       CPM005
441500200529     C                     MOVEL'PM11219' ZAMSID                          CPM005
441600200529     C                     EXSR ZASNMS                                    CPM005
441700200529     C                     END                                            CPM005
441800200529     C                     MOVE '1'       *IN80                           CPM005
441900200529     C                     MOVE '1'       *IN15                           CPM005
442000200529     C                     MOVE 'Y'       WWMSG                           CPM005
442100200529     C                     END                                            CPM005
442200200529     C*                                                                   CPM005
442300200529     C           DDS0VR    IFNE *BLANKS                                   CPM005
442400200529     C           WWMSG     IFEQ 'N'                                       CPM005
442500200529     C                     MOVEL'PM11219' ZAMSID                          CPM005
442600200529     C                     EXSR ZASNMS                                    CPM005
442700200529     C                     END                                            CPM005
442800200529     C                     MOVE '1'       *IN80                           CPM005
442900200529     C                     MOVE '1'       *IN07                           CPM005
443000200529     C                     MOVE 'Y'       WWMSG                           CPM005
443100200529     C                     END                                            CPM005
443200200529     C                     END
443300200529     C**+++++++++++++++++++++++++++++++++++++++++++++++++++++
443400200529     C** VAL4DDCASF - CASHFLOW REPORT FREQUENCY
443500200529     C**+++++++++++++++++++++++++++++++++++++++++++++++++++++
443600200529     C**
443700200529     C** IF ENTERED , REPORT DAY IN MONTH MUST BE SPECIFIED
443800200529     C**
443900200529     C           DDCASF    IFNE *BLANK
444000200529     C           DDCASF    IFNE 'W'
444100200529     C           DDCASD    ANDEQ*BLANKS
444200200529     C*********************MOVEL'PM11234' MSGID                           R00300
444300200529     C*********************CALL 'ZA0240'                                  R00300
444400200529     C*********************PARM           MSGID                           R00300
444500200529     C                     MOVEL'PM11234' ZAMSID                          R00300
444600200529     C                     EXSR ZASNMS                                    R00300
444700200529     C                     MOVE '1'       *IN80
444800200529     C                     MOVE '1'       *IN66
444900200529     C                     END
445000200529     C                     END
445100200529     C**
445200200529     C** IF ENTERED ,MUST BE 'W' 'M' 'Q' 'X' OR 'Y'
445300200529     C**
445400200529     C           DDCASF    IFNE *BLANK
445500200529     C           DDCASF    ANDNE'W'
445600200529     C           DDCASF    ANDNE'M'
445700200529     C           DDCASF    ANDNE'Q'
445800200529     C           DDCASF    ANDNE'X'
445900200529     C           DDCASF    ANDNE'Y'
446000200529     C*********************MOVEL'PM11235' MSGID                           R00300
446100200529     C*********************CALL 'ZA0240'                                  R00300
446200200529     C*********************PARM           MSGID                           R00300
446300200529     C                     MOVEL'PM11235' ZAMSID                          R00300
446400200529     C                     EXSR ZASNMS                                    R00300
446500200529     C                     MOVE '1'       *IN80
446600200529     C                     MOVE '1'       *IN66
446700200529     C                     END
446800200529     C**+++++++++++++++++++++++++++++++++++++++++++++++++++++
446900200529     C** VAL4DDCASD - CASHFLOW REPORT DAY
447000200529     C**+++++++++++++++++++++++++++++++++++++++++++++++++++++
447100200529     C**
447200200529     C** IF ENTERED , REPORT FREQUENCY MUST BE SPECIFIED
447300200529     C**
447400200529     C           DDCASD    IFNE *BLANK
447500200529     C           DDCASF    ANDEQ*BLANKS
447600200529     C*********************MOVEL'PM11236' MSGID                           R00300
447700200529     C*********************CALL 'ZA0240'                                  R00300
447800200529     C*********************PARM           MSGID                           R00300
447900200529     C                     MOVEL'PM11236' ZAMSID                          R00300
448000200529     C                     EXSR ZASNMS                                    R00300
448100200529     C                     MOVE '1'       *IN80
448200200529     C                     MOVE '1'       *IN67
448300200529     C                     END
448400200529     C**
448500200529     C** IF ENTERED ,MUST BE BETWEEN 1 AND 31
448600200529     C**
448700200529     C           DDCASD    IFNE *BLANK
448800200529     C                     MOVE DDCASD    WWVLDM
448900200529     C                     MOVE WWVLDM    WWVVDM
449000200529     C           DDCASD    IFNE WWVVDM
449100200529     C           WWVLDM    ORLT 1
449200200529     C           WWVLDM    ORGT 31
449300200529     C*********************MOVEL'PM11237' MSGID                           R00300
449400200529     C*********************CALL 'ZA0240'                                  R00300
449500200529     C*********************PARM           MSGID                           R00300
449600200529     C                     MOVEL'PM11237' ZAMSID                          R00300
449700200529     C                     EXSR ZASNMS                                    R00300
449800200529     C                     MOVE '1'       *IN80
449900200529     C                     MOVE '1'       *IN67
450000200529     C                     END
450100200529     C                     END
450200200529     C**
450300200529     C** IF FREQUENCY 'W' ENTERED, DAY MUST BE BLANK
450400200529     C**
450500200529     C           DDCASD    IFNE *BLANKS
450600200529     C           DDCASF    ANDEQ'W'
450700200529     C*********************MOVEL'PM11240' MSGID                           R00300
450800200529     C*********************CALL 'ZA0240'                                  R00300
450900200529     C*********************PARM           MSGID                           R00300
451000200529     C                     MOVEL'PM11240' ZAMSID                          R00300
451100200529     C                     EXSR ZASNMS                                    R00300
451200200529     C                     MOVE '1'       *IN80
451300200529     C                     MOVE '1'       *IN67
451400200529     C                     END
451500200529     C**
451600200529     C**+++++++++++++++++++++++++++++++++++++++++++++++++++++
451700200529     C** VAL4DDCASN - CASHFLOW NEXT REPORT DATE
451800200529     C**+++++++++++++++++++++++++++++++++++++++++++++++++++++
451900200529     C**
452000200529     C** IF ENTERED MUST BE A VALID DATE
452100200529     C**
452200200529     C                     Z-ADD0         WWCASN
452300200529     C           DDCASN    IFNE *BLANKS
452400200529     C                     MOVE DDCASN    ZDATE
452500200529     C                     EXSR ZDATE1
452600200529     C           *IN99     IFEQ '1'
452700200529     C*********************MOVEL'PM11238' MSGID                           R00300
452800200529     C*********************CALL 'ZA0240'                                  R00300
452900200529     C*********************PARM           MSGID                           R00300
453000200529     C                     MOVEL'PM11238' ZAMSID                          R00300
453100200529     C                     EXSR ZASNMS                                    R00300
453200200529     C                     MOVE '1'       *IN80
453300200529     C                     MOVE '1'       *IN68
453400200529     C                     ELSE
453500200529     C                     Z-ADDZDAYNO    WWCASN  50
453600200529     C                     END
453700200529     C                     END
453800200529     C**
453900200529     C** IF ENTERED MUST NOT BE BEFORE RUN DATE
454000200529     C**
454100200529     C           DDCASN    IFNE *BLANKS
454200200529     C           *IN99     ANDEQ'0'
454300200529     C           WWCASN    ANDLTBJRDNB
454400200529     C*********************MOVEL'PM11239' MSGID                           R00300
454500200529     C*********************CALL 'ZA0240'                                  R00300
454600200529     C*********************PARM           MSGID                           R00300
454700200529     C                     MOVEL'PM11239' ZAMSID                          R00300
454800200529     C                     EXSR ZASNMS                                    R00300
454900200529     C                     MOVE '1'       *IN80
455000200529     C                     MOVE '1'       *IN68
455100200529     C                     END
455200200529     C**+++++++++++++++++++++++++++++++++++++++++++++++++++++
455300200529     C** VAL4DDPOLC    BANK INVESTMENT POLICY CODE
455400200529     C**+++++++++++++++++++++++++++++++++++++++++++++++++++++
455500200529     C**
455600200529     C           DDPOLC    IFNE *BLANKS
455700200529     C**
455800200529     C** IF ENTERED INDIVIDUAL INDICATORS MUST BE 'N'
455900200529     C**
456000200529     C           DDIPIN    IFNE 'N'
456100200529     C           DDCYIN    ORNE 'N'
456200200529     C           DDYPIN    ORNE 'N'
456300200529     C           DDNPIN    ORNE 'N'
456400200529     C*********************MOVEL'PM11220' MSGID                           R00300
456500200529     C*********************CALL 'ZA0240'                                  R00300
456600200529     C*********************PARM           MSGID                           R00300
456700200529     C                     MOVEL'PM11220' ZAMSID                          R00300
456800200529     C                     EXSR ZASNMS                                    R00300
456900200529     C                     MOVE '1'       *IN80
457000200529     C                     MOVE '1'       *IN51
457100200529     C           DDIPIN    IFNE 'N'
457200200529     C                     MOVE '1'       *IN52
457300200529     C                     END
457400200529     C           DDCYIN    IFNE 'N'
457500200529     C                     MOVE '1'       *IN53
457600200529     C                     END
457700200529     C           DDYPIN    IFNE 'N'
457800200529     C                     MOVE '1'       *IN54
457900200529     C                     END
458000200529     C           DDNPIN    IFNE 'N'
458100200529     C                     MOVE '1'       *IN55
458200200529     C                     END
458300200529     C                     END
458400200529     C**
458500200529     C** IF ENTERED MUST BE VALID
458600200529     C**
458700200529     C***********DDPOLC    CHAINPMBIPNPP             72                   S01486
458800200529     C           DDPOLC    CHAINPMBIPNPD             72                   S01486
458900200529     C           *IN72     IFEQ '1'
459000200529     C           PSRECI    ORNE 'D'
459100200529     C*********************MOVEL'PM11221' MSGID                           R00300
459200200529     C*********************CALL 'ZA0240'                                  R00300
459300200529     C*********************PARM           MSGID                           R00300
459400200529     C                     MOVEL'PM11221' ZAMSID                          R00300
459500200529     C                     EXSR ZASNMS                                    R00300
459600200529     C                     MOVE '1'       *IN80
459700200529     C                     MOVE '1'       *IN51
459800200529     C                     END
459900200529     C*
460000200529     C                     END
460100200529     C**
460200200529     C**+++++++++++++++++++++++++++++++++++++++++++++++++++++
460300200529     C** VAL4DDIPIN     INSTRUMENT INVESTMENT POLICY
460400200529     C**+++++++++++++++++++++++++++++++++++++++++++++++++++++
460500200529     C**
460600200529     C           DDIPIN    IFEQ *BLANKS
460700200529     C**
460800200529     C** IF NOT ENTERED SET DEFAULT TO 'N'
460900200529     C**
461000200529     C                     MOVEL'N'       DDIPIN
461100200529     C                     ELSE
461200200529     C**
461300200529     C** IF ENTERED MUST BE 'Y', 'N' OR 'A'
461400200529     C**
461500200529     C           DDIPIN    IFNE 'Y'
461600200529     C           DDIPIN    ANDNE'N'
461700200529     C           DDIPIN    ANDNE'A'
461800200529     C*********************MOVEL'PM11222' MSGID                           R00300
461900200529     C*********************CALL 'ZA0240'                                  R00300
462000200529     C*********************PARM           MSGID                           R00300
462100200529     C                     MOVEL'PM11222' ZAMSID                          R00300
462200200529     C                     EXSR ZASNMS                                    R00300
462300200529     C                     MOVE '1'       *IN80
462400200529     C                     MOVE '1'       *IN51
462500200529     C                     END
462600200529     C*
462700200529     C                     END
462800200529     C*
462900200529     C**+++++++++++++++++++++++++++++++++++++++++++++++++++++
463000200529     C** VAL4DDCYIN        CURRENCY   INVESTMENT POLICY
463100200529     C**+++++++++++++++++++++++++++++++++++++++++++++++++++++
463200200529     C**
463300200529     C           DDCYIN    IFEQ *BLANKS
463400200529     C**
463500200529     C** IF NOT ENTERED SET DEFAULT TO 'N'
463600200529     C**
463700200529     C                     MOVEL'N'       DDCYIN
463800200529     C                     ELSE
463900200529     C**
464000200529     C** IF ENTERED MUST BE 'Y', 'N' OR 'A'
464100200529     C**
464200200529     C           DDCYIN    IFNE 'Y'
464300200529     C           DDCYIN    ANDNE'N'
464400200529     C           DDCYIN    ANDNE'A'
464500200529     C*********************MOVEL'PM11223' MSGID                           R00300
464600200529     C*********************CALL 'ZA0240'                                  R00300
464700200529     C*********************PARM           MSGID                           R00300
464800200529     C                     MOVEL'PM11223' ZAMSID                          R00300
464900200529     C                     EXSR ZASNMS                                    R00300
465000200529     C                     MOVE '1'       *IN80
465100200529     C                     MOVE '1'       *IN52
465200200529     C                     END
465300200529     C*
465400200529     C                     END
465500200529     C*
465600200529     C**+++++++++++++++++++++++++++++++++++++++++++++++++++++
465700200529     C** VAL4DDYPIN     COUNTRY OF RISK INVESTMENT POLICY
465800200529     C**+++++++++++++++++++++++++++++++++++++++++++++++++++++
465900200529     C**
466000200529     C           DDYPIN    IFEQ *BLANKS
466100200529     C**
466200200529     C** IF NOT ENTERED SET DEFAULT TO 'N'
466300200529     C**
466400200529     C                     MOVEL'N'       DDYPIN
466500200529     C                     ELSE
466600200529     C**
466700200529     C** IF ENTERED MUST BE 'Y', 'N' OR 'A'
466800200529     C**
466900200529     C           DDYPIN    IFNE 'Y'
467000200529     C           DDYPIN    ANDNE'N'
467100200529     C           DDYPIN    ANDNE'A'
467200200529     C*********************MOVEL'PM11224' MSGID                           R00300
467300200529     C*********************CALL 'ZA0240'                                  R00300
467400200529     C*********************PARM           MSGID                           R00300
467500200529     C                     MOVEL'PM11224' ZAMSID                          R00300
467600200529     C                     EXSR ZASNMS                                    R00300
467700200529     C                     MOVE '1'       *IN80
467800200529     C                     MOVE '1'       *IN53
467900200529     C                     END
468000200529     C*
468100200529     C                     END
468200200529     C*
468300200529     C**+++++++++++++++++++++++++++++++++++++++++++++++++++++
468400200529     C** VAL4DDNPIN      INDUSTRY INVESTMENT POLICY
468500200529     C**+++++++++++++++++++++++++++++++++++++++++++++++++++++
468600200529     C**
468700200529     C           DDNPIN    IFEQ *BLANKS
468800200529     C**
468900200529     C** IF NOT ENTERED SET DEFAULT TO 'N'
469000200529     C**
469100200529     C                     MOVEL'N'       DDNPIN
469200200529     C                     ELSE
469300200529     C**
469400200529     C** IF ENTERED MUST BE 'Y', 'N' OR 'A'
469500200529     C**
469600200529     C           DDNPIN    IFNE 'Y'
469700200529     C           DDNPIN    ANDNE'N'
469800200529     C           DDNPIN    ANDNE'A'
469900200529     C*********************MOVEL'PM11225' MSGID                           R00300
470000200529     C*********************CALL 'ZA0240'                                  R00300
470100200529     C*********************PARM           MSGID                           R00300
470200200529     C                     MOVEL'PM11225' ZAMSID                          R00300
470300200529     C                     EXSR ZASNMS                                    R00300
470400200529     C                     MOVE '1'       *IN80
470500200529     C                     MOVE '1'       *IN54
470600200529     C                     END
470700200529     C*
470800200529     C                     END
470900200529     C**
471000200529     C                     ENDSR
471100200529     C*
471200200529     C**************************************************************************
471300200529      /EJECT
471400200529      **************************************************************************
471500200529      *                                                                        *
471600200529      * #V1005   - TO VALIDATE DATE PORTFOLIO CLOSED                           *
471700200529      *                                                                        *
471800200529      * SUBROUTINE CALLS:                                                      *
471900200529      * ZDATE1   - TO COMPUTE DATE IN DAY NUMBER                               *
472000200529      *********ZA0240   - TO ACCESS MESSAGE FILE AND SEND MESSAGE         R00300
472100200529      * ZASNMS   - WRITE ERROR MESSAGES                                   R00300
472200200529      *                                                                        *
472300200529      * SUBROUTINE CALLED FROM:                                                *
472400200529      * #P1004   - TO PROCESS DETAIL SCREEN AND UPDATE FILES                   *
472500200529      *                                                                        *
472600200529      *                                                                        *
472700200529      **************************************************************************
472800200529     C           #V1005    BEGSR                           ** #V1005 BSR**
472900200529     C**
473000200529     C                     MOVE '0'       *IN37
473100200529     C                     MOVE '0'       *IN82                           B8275
473200200529     C** VAL5DDDPCL
473300200529     C           DDDPCL    IFNE *BLANKS                    - B1
473400200529     C**
473500200529     C** IF ENTERED MUST BE VALID
473600200529     C**
473700200529     C                     Z-ADD0         WWDAT1
473800200529     C                     MOVE *BLANKS   WWDAT2
473900200529     C                     MOVE DDDPCL    WWDAT1
474000200529     C                     MOVE WWDAT1    WWDAT2
474100200529     C**
474200200529     C                     MOVELDDDPCL    ZDATE
474300200529     C                     EXSR ZDATE1
474400200529     C           *IN99     IFEQ '1'                        - B2
474500200529     C           DDDPCL    ORNE WWDAT2
474600200529     C*********************MOVEL'PM11226' MSGID                           R00300
474700200529     C*********************CALL 'ZA0240'                                  R00300
474800200529     C*********************PARM           MSGID                           R00300
474900200529     C                     MOVEL'PM11226' ZAMSID                          R00300
475000200529     C                     EXSR ZASNMS                                    R00300
475100200529     C                     MOVE '1'       *IN80
475200200529     C                     MOVE '1'       *IN37
475300200529     C                     ELSE                            - X2
475400200529     C                     Z-ADDZDAYNO    WWDPCL
475500200529     C                     END                             -E2
475600200529     C*
475700200529     C**
475800200529     C** IF ENTERED MUST NOT BE BEFORE RUN DATE
475900200529     C**
476000200529     C****       WWDPCL    IFLT BJRDNB                     - B2           B08257
476100200529     C           WWDPCL    IFNE BJRDNB                     - B2           B08257
476200200529     C*********************MOVEL'PM11227' MSGID                           R00300
476300200529     C*********************CALL 'ZA0240'                                  R00300
476400200529     C*********************PARM           MSGID                           R00300
476500200529     C                     MOVEL'PM11227' ZAMSID                          R00300
476600200529     C                     EXSR ZASNMS                                    R00300
476700200529     C                     MOVE '1'       *IN80
476800200529     C                     MOVE '1'       *IN37
476900200529     C                     END                             - E2
477000200529     C*
477100200529     C** IF ENTERED MUST NOT BE BEFORE DATE PORTFOLIO OPENED
477200200529     C**
477300200529     C           WWDPCL    IFLE PNDPOP                     - B2
477400200529     C*********************MOVEL'PM11228' MSGID                           R00300
477500200529     C*********************CALL 'ZA0240'                                  R00300
477600200529     C*********************PARM           MSGID                           R00300
477700200529     C                     MOVEL'PM11228' ZAMSID                          R00300
477800200529     C                     EXSR ZASNMS                                    R00300
477900200529     C                     MOVE '1'       *IN80
478000200529     C                     MOVE '1'       *IN37
478100200529     C                     END                             - E2
478200200529     C*
478300200529     C** CHECK THAT DATE PORTFOLIO CLOSED IS NOT BEFOR PLEDGE FINISH DATE
478400200529     C*
478500200529     C           PNPDGF    IFNE 0                          - B2
478600200529     C           WWDPCL    ANDLTPNPDGF
478700200529     C           WWDPCL    ANDNE0
478800200529     C*********************MOVEL'PM11232' MSGID                           R00300
478900200529     C*********************CALL 'ZA0240'                                  R00300
479000200529     C*********************PARM           MSGID                           R00300
479100200529     C                     MOVEL'PM11232' ZAMSID                          R00300
479200200529     C                     EXSR ZASNMS                                    R00300
479300200529     C                     MOVE '1'       *IN80
479400200529     C                     MOVE '1'       *IN37
479500200529     C                     END                             - E2
479600200529     C*                                                                   S01307
479700200529     C***Portfolio*can*not*be*closed*if*Accruals*or*Outstanding*****S01307B8275
479800200529     C***Settlements*remain*on*it***********************************S01307B8275
479900200529     C**         PMPORK    CHAINSCSCFAPD             72             S01307B8275
480000200529     C**                                                            S01307B8275
480100200529     C**         *IN72     IFEQ '0'                        - B2     S01307B8275
480200200529     C**         SDRECI    ANDEQ'D'                                 S01307B8275
480300200529     C**                   MOVEL'PM11252' ZAMSID                    S01307B8275
480400200529     C**                   EXSR ZASNMS                              R01307B8275
480500200529     C**                   MOVE '1'       *IN80                     S01307B8275
480600200529     C**                   MOVE '1'       *IN37                     S01307B8275
480700200529     C**                   ELSE                            - X2     S01307B8275
480800200529     C**         PMPORK    CHAINSCOCFSPD             72             S01307B8275
480900200529     C**                                                            S01307B8275
481000200529     C**         *IN72     IFEQ '0'                        - B3     S01307B8275
481100200529     C**         SERECI    ANDEQ'D'                                 S01307B8275
481200200529     C**                   MOVEL'PM11252' ZAMSID                    S01307B8275
481300200529     C**                   EXSR ZASNMS                              S01307B8275
481400200529     C**                   MOVE '1'       *IN80                     S01307B8275
481500200529     C**                   MOVE '1'       *IN37                     S01307B8275
481600200529     C**                   END                             - E3     S01307B8275
481700200529     C**                                                            S01307B8275
481800200529     C**                   END                             - E2     S01307B8275
481900200529      *  Send a WARNING message if Accruals or Outstanding                B8275
482000200529      *  Settlements remain on it                                         B8275
482100200529     C  N86                DO                              - B2           B8275
482200200529     C***********PMPORK    CHAINSCSCFAP0             72             B8275 S01486
482300200529     C                     MOVE BBBRCD    WWBRCA                          S01486
482400200529     C           PMPRKB    CHAINSESCFAPD             72                   S01486
482500200529     C           *IN72     DOWEQ'0'                        - B3           B8275
482600200529     C           SDCFAC    IFNE 0                          - B4           B8275
482700200529     C           SDOSAJ    ORNE 0                                         B8275
482800200529     C                     MOVEL'PM11252' ZAMSID                          B8275
482900200529     C                     EXSR ZASNMS                                    B8275
483000200529     C                     MOVE '1'       *IN82                           B8275
483100200529     C                     MOVE '1'       *IN37                           B8275
483200200529     C                     MOVE '1'       *IN72                           B8275
483300200529     C                     END                             - E4           B8275
483400200529     C**N72******PMPORK    READESCSCFAP0                 72         B8275 S01486
483500200529     C  N72      PMPRKB    READESESCFAPD                 72               S01486
483600200529     C                     END                             - E3           B8275
483700200529      *                                                                   B8275
483800200529     C***********PMPORK    CHAINSCOCFSP0             72             B8275 S01486
483900200529     C           PMPORK    CHAINSEOCFSL3             72                   S01486
484000200529     C           *IN72     DOWEQ'0'                        - B3           B8275
484100200529     C           SECFAC    IFNE 0                          - B4           B8275
484200200529     C                     MOVEL'PM11252' ZAMSID                          B8275
484300200529     C                     EXSR ZASNMS                                    B8275
484400200529     C                     MOVE '1'       *IN82                           B8275
484500200529     C                     MOVE '1'       *IN37                           B8275
484600200529     C                     MOVE '1'       *IN72                           B8275
484700200529     C                     END                             - E4           B8275
484800200529     C**N72******PMPORK    READESCOCFSP0                 72         B8275 S01486
484900200529     C  N72      PMPORK    READESEOCFSL3                 72               S01486
485000200529     C                     END                             - E3           B8275
485100200529      *                                                                   B8275
485200200529     C           PMPORK    CHAINPMCHRGLF             72                   B8275
485300200529     C           *IN72     DOWEQ'0'                        - B3           B8275
485400200529     C           POCGAJ    IFNE 0                          - B4           B8275
485500200529     C           POCGAD    ORNE 0                                         B8275
485600200529     C                     MOVEL'PM11253' ZAMSID                          B8275
485700200529     C                     EXSR ZASNMS                                    B8275
485800200529     C                     MOVE '1'       *IN82                           B8275
485900200529     C                     MOVE '1'       *IN37                           B8275
486000200529     C                     MOVE '1'       *IN72                           B8275
486100200529     C                     END                             - E4           B8275
486200200529     C  N72      PMPORK    READEPMCHRGLF                 72               B8275
486300200529     C                     END                             - E3           B8275
486400200529     C                     END                             - E2           B8275
486500200529     C*                                                                   S01307
486600200529     C                     ELSE                            - X1
486700200529     C                     Z-ADD0         WWDPCL
486800200529     C                     END                             - E1
486900200529      *                                                                   B8275
487000200529     C                     SETOF                     86                   B8275
487100200529     C   82                SETON                     86                   B8275
487200200529     C**
487300200529     C                     ENDSR
487400200529     C*
487500200529     C**************************************************************************
487600200529      /EJECT
487700200529      **************************************************************************
487800200529      *                                                                        *
487900200529      * #P1005   - TO PROCESS PORTFOLIO CHARGE DETAILS                         *
488000200529      *                                                                        *
488100200529      * SUBROUTINE CALLS:                                                      *
488200200529      **********ZA0250   - TO CLEAR MESSAGE                               R00300
488300200529      * Y2CLMSC  - CLEAR MESSAGE QUEUE                                    R00300
488400200529      * #ZBAA    - TO MOVE THE APPROPRIATE VALUE IN WWAID                      *
488500200529      * PM0600   - NOTEPAD                                                     *
488600200529      * #V1006   - TO VALIDATE PORTFOLIO CHARGES DETAILS                       *
488700200529      * ZASNMS   - WRITE ERROR MESSAGES                                   R00300
488800200529      *                                                                        *
488900200529      * SUBROUTINE CALLED FROM:                                                *
489000200529      * #P1004   - TO PROCESS DETAIL SCREEN AND UPDATE FILES                   *
489100200529      *                                                                        *
489200200529      **************************************************************************
489300200529     C           #P1005    BEGSR                           ** #P1005 BSR**
489400200529     C*
489500200529     C*
489600200529     C** SET SCREEN INDICATORS - PROTECT KEY, SET OFF ERROR INDS,
489700200529     C** POSITION CURSOR
489800200529     C*
489900200529     C                     MOVE '0'       *IN31
490000200529     C                     MOVE '0'       *IN32
490100200529     C                     MOVE '0'       *IN33
490200200529     C                     MOVE '0'       *IN34
490300200529     C                     MOVE '0'       *IN35
490400200529     C                     MOVE '0'       *IN36
490500200529     C                     MOVE '0'       *IN37
490600200529     C                     MOVE '0'       *IN38
490700200529     C                     MOVE '0'       *IN39
490800200529     C                     MOVE '0'       *IN40
490900200529     C                     MOVE '0'       *IN41
491000200529     C                     MOVE '0'       *IN42
491100200529     C                     MOVE '0'       *IN43
491200200529     C                     MOVE '0'       *IN44
491300200529     C                     MOVE '0'       *IN45
491400200529     C                     MOVE '0'       *IN85
491500200529     C**
491600200529     C*
491700200529     C** IF ENQUIRY PROTECT FIELD INPUT ON S/PM0110C1
491800200529     C*
491900200529     C           DDACTN    IFEQ 'E'
492000200529     C           DDACTN    OREQ 'C'
492100200529     C                     MOVE '1'       *IN31
492200200529     C                     END
492300200529     C*
492400200529     C                     MOVEL'PM90008' MSMBR4
492500200529     C                     CALL 'SDRTVTXT'PLLANG
492600200529     C                     MOVELMSGTXT    DDINFO
492700200529     C*
492800200529     C** D O    U N T I L   C H A N G E  O F  S C R E E N
492900200529     C*
493000200529     C           WWAID     DOUEQ'03'
493100200529     C           *IN10     OREQ '1'
493200200529     C           *IN11     OREQ '1'
493300200529     C           *IN12     OREQ '1'
493400200529     C           *IN85     OREQ '1'
493500200529     C**
493600200529     C*
493700200529     C** D E T A I L   S C R E E N     O U T P U T
493800200529     C*
493900200529     C                     WRITEPM0110F3
494000200529     C**
494100200529     C                     WRITEPM0110F1
494200200529     C                     EXFMTPM0110C1
494300200529     C**
494400200529     C                     MOVE '0'       *IN80
494500200529     C*********************CALL 'ZA0250'                                  R00300
494600200529     C*                                                                   R00300
494700200529     C**   Clear program message queue                                    R00300
494800200529     C                     CALL 'Y2CLMSC'                                 R00300
494900200529     C                     PARM           TOPQ                            R00300
495000200529     C                     PARM           TOPRQ                           R00300
495100200529     C*
495200200529     C** Call S/R to move values into WWAID
495300200529     C*
495400200529     C                     EXSR #ZBAA
495500200529     C*
495600200529     C** CK12- INITIAL SCREEN
495700200529     C*
495800200529     C           WWAID     IFEQ '12'
495900200529     C                     MOVE '1'       *IN10
496000200529     C                     END
496100200529     C*
496200200529     C**     CMD/24 TAKEN
496300200529     C*
496400200529     C           WWAID     IFEQ '24'
496500200529     C                     MOVEL'0'       WWRTRN
496600200529     C                     MOVELWWPNP8    WWCCNM
496700200529     C                     MOVELWWPREF    WWPTFR
496800200529     C                     MOVE 'Y'       WW0600
496900200529     C                     CALL 'PMC0601' LIST1
497000200529     C**
497100200529     C                     END
497200200529     C*
497300200529     C** RECEIVE PARAMETER RETURNED FROM INVESTMENT POLICY INPUT
497400200529     C** PROGRAM
497500200529     C*
497600200529     C           WWRTRN    IFEQ '1'                                       R10053
497700200529     C                     MOVE '03'      WWAID                           R10053
497800200529     C                     END                                            R10053
497900200529     C**
498000200529     C*
498100200529     C** V A L I D A T E   D E T A I L   S C R E E N   I N P U T
498200200529     C*
498300200529     C           WWAID     IFNE '03'
498400200529     C           WWAID     ANDNE'12'
498500200529     C           WWAID     ANDNE'24'
498600200529     C**
498700200529     C                     MOVE '0'       *IN79
498800200529     C**
498900200529     C** CHECK IF CHANGES OCCURED
499000200529     C**
499100200529     C           DDACTN    IFEQ 'I'
499200200529     C           DDACTN    OREQ 'A'
499300200529     C**
499400200529     C                     Z-ADD0         X                               S01486
499500200529     C           *IN79     DOWEQ'0'
499600200529     C                     READCPM0110S1                 79
499700200529     C* SAVE THEM INTO AN ARRAY
499800200529     C*
499900200529     C           *IN79     IFEQ '0'
500000200529     C                     Z-ADDRRN2      X
500100200529     C                     END
500200200529     C                     END
500300200529     C*
500400200529     C* VALIDATION
500500200529     C                     EXSR #V1006
500600200529     C                     MOVE 'Y'       WWCHGP                          B08166
500700200529     C                     END
500800200529     C*
500900200529     C** N O    D E T A I L   S C R E E N    E R R O R S
501000200529     C*
501100200529     C**
501200200529     C**     ENTER PRESSED
501300200529     C**
501400200529     C           WWAID     IFEQ 'RA'
501500200529     C           *IN80     ANDEQ'0'
501600200529     C                     MOVE '0'       *IN46
501700200529     C                     MOVE '1'       *IN85
501800200529     C                     END
501900200529     C*
502000200529     C**     CMD/1 TAKEN
502100200529     C*
502200200529     C           WWAID     IFEQ '01'
502300200529     C           *IN80     IFEQ '0'
502400200529     C                     MOVE '1'       *IN85
502500200529     C                     ELSE
502600200529     C*********************MOVEL'PM11401' MSGID                           R00300
502700200529     C*********************CALL 'ZA0240'                                  R00300
502800200529     C*********************PARM           MSGID                           R00300
502900200529     C                     MOVEL'PM11401' ZAMSID                          R00300
503000200529     C                     EXSR ZASNMS                                    R00300
503100200529     C                     END
503200200529     C                     END
503300200529     C*
503400200529     C                     END
503500200529     C*
503600200529     C                     END
503700200529     C*
503800200529     C** IF F3 OR F12 TAKEN REMOVE FILE CHANGES FOR INVESTMENT POLICY
503900200529     C*
504000200529     C           WWAID     IFEQ '03'
504100200529     C           WWAID     OREQ '12'
504200200529     C                     ROLBK
504300200529     C                     END
504400200529     C*
504500200529     C                     ENDSR
504600200529     C*
504700200529     C**************************************************************************
504800200529      /EJECT
504900200529      **************************************************************************
505000200529      *                                                                        *
505100200529      * #P1006   - TO PROCESS INVESTMENT POLICY INDICATORS(AMEND)              *
505200200529      *                                                                        *
505300200529      * SUBROUTINE CALLS:                                                      *
505400200529      * M0170    -                                                             *
505500200529      * PM0170   - INSTRUMENT INVESTMENT POLICY                                *
505600200529      * PM0180   - CURRENCY INVESTMENT POLICY                                  *
505700200529      * PM0190   - COUNTRY OF RISK INVESTMENT POLICY                           *
505800200529      * PM0200   - INDUSTRY INVESTMENT POLICY                                  *
505900200529      *                                                                        *
506000200529      * SUBROUTINE CALLED FROM:                                                *
506100200529      * #P1004   - TO PROCESS DETAIL SCREEN AND UPDATE FILES                   *
506200200529      *                                                                        *
506300200529      **************************************************************************
506400200529     C           #P1006    BEGSR                           ** #P1006 BSR**
506500200529     C*
506600200529     C** SET UP COMMON PARAMETERS TO BE PASSED TO CUSTOMER
506700200529     C** INVESTMENT POLICY DEFINITION PROGRAMS
506800200529     C*
506900200529     C                     MOVEL'0'       WWRTRN
507000200529     C                     MOVEL*BLANK    WWPOLI
507100200529     C                     MOVELWWPNP8    WWCCNM
507200200529     C                     MOVELWWPREF    WWPTFR
507300200529     C                     MOVE *BLANKS   WWACTO
507400200529     C**
507500200529     C** SET UP ACTION CODE TO BE PASSED TO PM0170
507600200529     C** IF POLICY REQUIRED INDICATOR CHANGED FROM 'Y' TO 'N' SET
507700200529     C** ACTION CODE TO 'D' TO INDICATE POLICY TO BE DELETED
507800200529     C*
507900200529     C           DDIPIN    IFEQ 'N'
508000200529     C           DDIPIH    ANDEQ'Y'
508100200529     C                     MOVEL'D'       WWACTO
508200200529     C                     END
508300200529     C*
508400200529     C** IF INSTRUMENT POLICY INDICATOR HAS CHNGED 'N' TO 'Y'
508500200529     C** OR SET TO 'A' PASS ACTION CODE OF 'A'
508600200529     C*
508700200529     C           DDIPIH    IFEQ 'N'
508800200529     C           DDIPIN    ANDEQ'Y'
508900200529     C           DDIPIN    OREQ 'A'
509000200529     C                     MOVE 'A'       WWACTO
509100200529     C                     END
509200200529     C*
509300200529     C** CALL PM0170 TO ALLOW INPUT OF INSTRUMENT INVESTMENT POLICY
509400200529     C*
509500200529     C           WWACTO    IFNE *BLANK
509600200529     C                     MOVE 'Y'       WW0170  1
509700200529     C                     CALL 'PM0170'  LIST2
509800200529     C*
509900200529     C** RECEIVE PARAMETER RETURNED FROM INVESTMENT POLICY INPUT
510000200529     C** PROGRAM
510100200529     C*
510200200529     C           WWRTRN    IFEQ '1'
510300200529     C                     MOVE '03'      WWAID
510400200529     C                     ROLBK
510500200529     C                     GOTO #P1069
510600200529     C                     END
510700200529     C*
510800200529     C** F12 PRESSED IN CALLED PROGRAM
510900200529     C*
511000200529     C           WWRTRN    IFEQ '2'
511100200529     C                     MOVE '12'      WWAID
511200200529     C                     MOVE '1'       *IN10
511300200529     C                     GOTO #P1069
511400200529     C                     END
511500200529     C*
511600200529     C** ENTER PRESSED
511700200529     C*
511800200529     C                     MOVELWWPOLI    DDIPIN
511900200529     C                     MOVELWWPOLI    DDIPIH
512000200529     C                     MOVEL*BLANKS   WWAID
512100200529     C                     END
512200200529     C**
512300200529     C** SET UP ACTION CODE TO BE PASSED TO PM0180
512400200529     C*
512500200529     C                     MOVE *BLANKS   WWACTO
512600200529     C           DDCYIN    IFEQ 'N'
512700200529     C           DDCYIH    ANDEQ'Y'
512800200529     C                     MOVEL'D'       WWACTO
512900200529     C                     END
513000200529     C*
513100200529     C           DDCYIH    IFEQ 'N'
513200200529     C           DDCYIN    ANDEQ'Y'
513300200529     C           DDCYIN    OREQ 'A'
513400200529     C                     MOVE 'A'       WWACTO
513500200529     C                     END
513600200529     C*
513700200529     C** CALL PM0180 TO ALLOW INPUT OF INSTRUMENT INVESTMENT POLICY
513800200529     C*
513900200529     C           WWACTO    IFNE *BLANK
514000200529     C                     MOVE 'Y'       WW0180  1
514100200529     C                     CALL 'PM0180'  LIST2
514200200529     C*
514300200529     C** RECEIVE PARAMETER RETURNED FROM INVESTMENT POLICY INPUT
514400200529     C** PROGRAM
514500200529     C*
514600200529     C           WWRTRN    IFEQ '1'
514700200529     C                     MOVE '03'      WWAID
514800200529     C                     ROLBK
514900200529     C                     GOTO #P1069
515000200529     C                     END
515100200529     C*
515200200529     C** F12 PRESSED IN CALLED PROGRAM
515300200529     C*
515400200529     C           WWRTRN    IFEQ '2'
515500200529     C                     MOVE '12'      WWAID
515600200529     C                     MOVE '1'       *IN10
515700200529     C                     GOTO #P1069
515800200529     C                     END
515900200529     C*
516000200529     C** ENTER PRESSED
516100200529     C*
516200200529     C                     MOVELWWPOLI    DDCYIN
516300200529     C                     MOVELWWPOLI    DDCYIH
516400200529     C                     MOVEL*BLANKS   WWAID
516500200529     C                     END
516600200529     C**
516700200529     C** SET UP ACTION CODE TO BE PASSED TO PM0190
516800200529     C*
516900200529     C                     MOVE *BLANKS   WWACTO
517000200529     C           DDYPIN    IFEQ 'N'
517100200529     C           DDYPIH    ANDEQ'Y'
517200200529     C                     MOVEL'D'       WWACTO
517300200529     C                     END
517400200529     C*
517500200529     C           DDYPIH    IFEQ 'N'
517600200529     C           DDYPIN    ANDEQ'Y'
517700200529     C           DDYPIN    OREQ 'A'
517800200529     C                     MOVE 'A'       WWACTO
517900200529     C                     END
518000200529     C*
518100200529     C** CALL PM0190 TO ALLOW INPUT OF INSTRUMENT INVESTMENT POLICY
518200200529     C*
518300200529     C           WWACTO    IFNE *BLANK
518400200529     C                     MOVE 'Y'       WW0190  1
518500200529     C                     CALL 'PM0190'  LIST2
518600200529     C*
518700200529     C** RECEIVE PARAMETER RETURNED FROM INVESTMENT POLICY INPUT
518800200529     C** PROGRAM
518900200529     C*
519000200529     C           WWRTRN    IFEQ '1'
519100200529     C                     MOVE '03'      WWAID
519200200529     C                     ROLBK
519300200529     C                     GOTO #P1069
519400200529     C                     END
519500200529     C*
519600200529     C** F12 PRESSED IN CALLED PROGRAM
519700200529     C*
519800200529     C           WWRTRN    IFEQ '2'
519900200529     C                     MOVE '1'       *IN10
520000200529     C                     MOVE '12'      WWAID
520100200529     C                     GOTO #P1069
520200200529     C                     END
520300200529     C*
520400200529     C** ENTER PRESSED
520500200529     C*
520600200529     C                     MOVELWWPOLI    DDYPIN
520700200529     C                     MOVELWWPOLI    DDYPIH
520800200529     C                     MOVEL*BLANKS   WWAID
520900200529     C                     END
521000200529     C**
521100200529     C** SET UP ACTION CODE TO BE PASSED TO PM0200
521200200529     C*
521300200529     C                     MOVE *BLANKS   WWACTO
521400200529     C           DDNPIN    IFEQ 'N'
521500200529     C           DDNPIH    ANDEQ'Y'
521600200529     C                     MOVEL'D'       WWACTO
521700200529     C                     END
521800200529     C*
521900200529     C           DDNPIH    IFEQ 'N'
522000200529     C           DDNPIN    ANDEQ'Y'
522100200529     C           DDNPIN    OREQ 'A'
522200200529     C                     MOVE 'A'       WWACTO
522300200529     C                     END
522400200529     C*
522500200529     C** CALL PM0200 TO ALLOW INPUT OF INSTRUMENT INVESTMENT POLICY
522600200529     C*
522700200529     C           WWACTO    IFNE *BLANK
522800200529     C                     MOVE 'Y'       WW0200  1
522900200529     C                     CALL 'PM0200'  LIST2
523000200529     C*
523100200529     C** RECEIVE PARAMETER RETURNED FROM INVESTMENT POLICY INPUT
523200200529     C** PROGRAM
523300200529     C*
523400200529     C           WWRTRN    IFEQ '1'
523500200529     C                     MOVE '03'      WWAID
523600200529     C                     ROLBK
523700200529     C                     GOTO #P1069
523800200529     C                     END
523900200529     C*
524000200529     C** F12 PRESSED IN CALLED PROGRAM
524100200529     C*
524200200529     C           WWRTRN    IFEQ '2'
524300200529     C                     MOVE '12'      WWAID
524400200529     C                     MOVE '1'       *IN10
524500200529     C                     GOTO #P1069
524600200529     C                     END
524700200529     C*
524800200529     C** ENTER PRESSED
524900200529     C*
525000200529     C                     MOVELWWPOLI    DDNPIN
525100200529     C                     MOVELWWPOLI    DDNPIH
525200200529     C                     MOVEL*BLANKS   WWAID
525300200529     C                     END
525400200529     C**
525500200529     C           #P1069    ENDSR
525600200529     C*
525700200529     C**************************************************************************
525800200529      /EJECT
525900200529      **************************************************************************
526000200529      *                                                                        *
526100200529      * #P1007   - TO PROCESS INVESTMENT POLICY INDICATORS(ENQUIRY)            *
526200200529      *                                                                        *
526300200529      * SUBROUTINE CALLS:                                                      *
526400200529      * PM0170   - INSTRUMENT INVESTMENT POLICY                                *
526500200529      * PM0180   - CURRENCY INVESTMENT POLICY                                  *
526600200529      * PM0190   - COUNTRY OF RISK INVESTMENT POLICY                           *
526700200529      * PM0200   - INDUSTRY INVESTMENT POLICY                                  *
526800200529      *                                                                        *
526900200529      * SUBROUTINE CALLED FROM:                                                *
527000200529      * #P1004   - TO PROCESS DETAIL SCREEN AND UPDATE FILES                   *
527100200529      *                                                                        *
527200200529      **************************************************************************
527300200529     C           #P1007    BEGSR                           ** #P1007 BSR**
527400200529     C*
527500200529     C** SET UP PARAMETERS PASSED TO INVESTMENT POLICY INPUT PROGRAMS
527600200529     C*
527700200529     C                     MOVEL'E'       WWACTO
527800200529     C                     MOVEL'0'       WWRTRN
527900200529     C                     MOVEL*BLANK    WWPOLI
528000200529     C                     MOVELWWPNP8    WWCCNM
528100200529     C                     MOVELWWPREF    WWPTFR
528200200529     C**
528300200529     C** IF INSTRUMENT POLICY INDICATOR IS 'Y' - CALL PM0170
528400200529     C**
528500200529     C           DDIPIN    IFEQ 'Y'
528600200529     C                     MOVE 'Y'       WW0170
528700200529     C                     CALL 'PM0170'  LIST2
528800200529     C**
528900200529     C** PROCESS PARAMETER RETURNED FORM PM0170
529000200529     C**
529100200529     C                     MOVE *BLANKS   WWAID
529200200529     C           WWRTRN    IFEQ '1'
529300200529     C                     MOVE '03'      WWAID
529400200529     C                     GOTO #P1079
529500200529     C                     END
529600200529     C**
529700200529     C           WWRTRN    IFEQ '2'
529800200529     C                     MOVEL*BLANKS   WWAID
529900200529     C                     MOVE '1'       *IN10
530000200529     C                     GOTO #P1079
530100200529     C                     END
530200200529     C                     END
530300200529     C**
530400200529     C** IF CURRENCY POLICY INDICATOR IS 'Y' - CALL PM0180
530500200529     C**
530600200529     C           DDCYIN    IFEQ 'Y'
530700200529     C                     MOVE 'Y'       WW0180
530800200529     C                     CALL 'PM0180'  LIST2
530900200529     C**
531000200529     C** PROCESS PARAMETER RETURNED FORM PM0180
531100200529     C**
531200200529     C                     MOVE *BLANKS   WWAID
531300200529     C           WWRTRN    IFEQ '1'
531400200529     C                     MOVE '03'      WWAID
531500200529     C                     GOTO #P1079
531600200529     C                     END
531700200529     C**
531800200529     C           WWRTRN    IFEQ '2'
531900200529     C                     MOVEL*BLANKS   WWAID
532000200529     C                     MOVE '1'       *IN10
532100200529     C                     GOTO #P1079
532200200529     C                     END
532300200529     C                     END
532400200529     C**
532500200529     C** IF COUNTRY POLICY INDICATOR IS 'Y' - CALL PM0190
532600200529     C**
532700200529     C           DDYPIN    IFEQ 'Y'
532800200529     C                     MOVE 'Y'       WW0190
532900200529     C                     CALL 'PM0190'  LIST2
533000200529     C**
533100200529     C** PROCESS PARAMETER RETURNED FORM PM0180
533200200529     C**
533300200529     C                     MOVE *BLANKS   WWAID
533400200529     C           WWRTRN    IFEQ '1'
533500200529     C                     MOVE '03'      WWAID
533600200529     C                     GOTO #P1079
533700200529     C                     END
533800200529     C**
533900200529     C           WWRTRN    IFEQ '2'
534000200529     C                     MOVEL*BLANKS   WWAID
534100200529     C                     MOVE '1'       *IN10
534200200529     C                     GOTO #P1079
534300200529     C                     END
534400200529     C                     END
534500200529     C**
534600200529     C** IF INDUSTRY POLICY INDICATOR IS 'Y' - CALL PM0200
534700200529     C**
534800200529     C           DDNPIN    IFEQ 'Y'
534900200529     C                     MOVE 'Y'       WW0200
535000200529     C                     CALL 'PM0200'  LIST2
535100200529     C**
535200200529     C** PROCESS PARAMETER RETURNED FORM PM0200
535300200529     C**
535400200529     C                     MOVE *BLANKS   WWAID
535500200529     C           WWRTRN    IFEQ '1'
535600200529     C                     MOVE '03'      WWAID
535700200529     C                     GOTO #P1079
535800200529     C                     END
535900200529     C**
536000200529     C           WWRTRN    IFEQ '2'
536100200529     C                     MOVEL*BLANKS   WWAID
536200200529     C                     MOVE '1'       *IN10
536300200529     C                     GOTO #P1079
536400200529     C                     END
536500200529     C                     END
536600200529     C**
536700200529     C           #P1079    ENDSR
536800200529     C*
536900200529     C**************************************************************************
537000200529      /EJECT
537100200529      **************************************************************************
537200200529      *                                                                        *
537300200529      * #P1008   - TO UPDATE PORTFOLIO DEFINITION FILE                         *
537400200529      *                                                                        *
537500200529      * SUBROUTINE CALLS:                                                      *
537600200529      * ZTNLU1   - TO LOCK AND ACCESS DATA AREA AND GET TRANSAC. NBR           *
537700200529      * #CBB     - TO PROCESS UPDATE BY ANOTHER WORKSTATION                    *
537800200529      * *PSSR    - TO PROCESS ABNORMAL END OF PROGRAM                          *
537900200529      *                                                                        *
538000200529      * SUBROUTINE CALLED FROM:                                                *
538100200529      * #P1004   - TO PROCESS DETAIL SCREEN AND UPDATE FILES                   *
538200200529      *                                                                        *
538300200529      **************************************************************************
538400200529     C           #P1008    BEGSR                           ** #P1008 BSR**
538500200529     C**
538600200529     C**  ACTION CODE I
538700200529     C**
538800200529     C           DDACTN    IFEQ 'I'                        B1
538900200529     C***********PMPORK    CHAINPMPORTPP             72                   S01486
539000200529     C           PMPORK    CHAINPMPORTPD             72                   S01486
539100200529     C**
539200200529     C           *IN72     IFEQ '0'                        B2
539300200529     C*
539400200529     C** RECORD UPDATED BY ANOTHER WORKSTATION
539500200529     C*
539600200529     C           PNRECI    ANDEQ'D'
539700200529     C                     EXSR #CBB
539800200529     C                     GOTO XTUPDF
539900200529     C                     END                             E2
540000200529     C*
540100200529     C** TRANSLATE RECORD DETAILS FROM SCREEN LAYOUT TO FILE LAYOUT
540200200529     C*
540300200529     C                     MOVEL'D'       PNRECI
540400200529     C                     MOVE BJMRDT    WWHLUP
540500200529     C                     Z-ADDWWDLUP    PNDLUP
540600200529     C                     MOVE WWMLUP    PNMLUP
540700200529     C                     Z-ADDWWYLUP    PNYLUP
540800200529     C                     TIME           PNTLUP
540900200529     C                     MOVEL'I'       PNCHTP
541000200529     C                     Z-ADDBJRDNB    PNLCD
541100200529     C                     MOVELQBCUST    PNCNUM
541200200529     C                     MOVELDDPREF    PNPTFR
541300200529     C                     MOVELDDPTCY    PNPTCY
541400200529     C                     Z-ADDWWPTCY    PNPCDP
541500200529     C                     MOVELDDPTFN    PNPTFN
541600200529     C                     MOVELDDPTFT    PNPTFT
541700200529     C                     MOVELDDCFGC    PNCFGC                          S01307
541800200529     C                     MOVELDDMNGI    PNMNGI
541900200529     C                     Z-ADDWWDPOP    PNDPOP
542000200529     C                     Z-ADD0         PNDPCL
542100200529     C           BGFUOP    IFEQ 'Y'                        B2             S71062
542200200529     C           FCPORS    ANDNE'B'                                       CPM003
542300200529     C** If Bank Portfolios are supported, treat as if FF off             CPM003
542400200529     C                     MOVE DDACSQ    PNACSQ                          S71062
542500200529     C                     ELSE                            X2             S71062
542600200529     C                     MOVE *ZEROS    PNACSQ                          S71062
542700200529     C                     END                             E2             S71062
542800200529     C           BGLMCR    IFEQ 'N'                        B2
542900200529     C                     Z-ADDWWPDGS    PNPDGS
543000200529     C                     Z-ADDWWPDGF    PNPDGF
543100200529     C                     END                             E2
543200200529     C                     MOVELDDVLFQ    PNVLFQ
543300200529     C                     MOVELDDVLDM    PNVLDM
543400200529     C                     Z-ADDWWVLND    PNVLND
543500200529     C****                 MOVELDDAAD1    PNAAD1                          S01313
543600200529     C****                 MOVELDDAAD2    PNAAD2                          S01313
543700200529     C****                 MOVELDDAAD3    PNAAD3                          S01313
543800200529     C****                 MOVELDDAAD4    PNAAD4                          S01313
543900200529     C****                 MOVELDDAAD5    PNAAD5                          S01313
544000200529     C                     MOVELDDS1VR    PNS1VR                          S01313
544100200529     C                     MOVELDDS2VR    PNS2VR
544200200529     C                     MOVELDDS3VR    PNS3VR
544300200529     C                     MOVELDDS4VR    PNS4VR
544400200529     C                     MOVELDDS5VR    PNS5VR
544500200529     C                     MOVELDDS6VR    PNS6VR
544600200529     C                     MOVELDDS7VR    PNS7VR                          S01313
544700200529     C                     MOVELDDS8VR    PNS8VR                          S01313
544800200529     C                     MOVELDDS9VR    PNS9VR                          CPM005
544900200529     C                     MOVELDDS0VR    PNS0VR                          CPM005
545000200529     C           DDTYSM    IFNE *BLANKS                                   S01313
545100200529     C                     MOVE DDTYSM    PNTYSM                          S01313
545200200529     C                     ELSE                                           S01313
545300200529     C                     Z-ADD0         PNTYSM                          S01313
545400200529     C                     END                                            S01313
545500200529     C*                                                                   S01313
545600200529     C                     MOVE DDADPP    PNADPP                          S01313
545700200529     C                     MOVE DDRPYP    PNRPYP                          S01313
545800200529     C                     MOVE DDPMNG    PNPMNG                          S01313
545900200529     C                     MOVELDDCASF    PNCASF
546000200529     C                     MOVE DDCASD    PNCASD
546100200529     C**
546200200529     C** FOLLOWING VALIDATION TO DETERMINE NEXT REPORT DATE
546300200529     C** IF REPORT DAY AND REPORT FREQUENCY ENTERED
546400200529     C** IF REPORT DAY EQUAL TO DAY OF RUN DATE THEN DEFAULT TO
546500200529     C** RUN DATE
546600200529     C** OTHERWISE CALCULATE IT BY THE MEAN OF SUBROUTINE ZFRQA
546700200529     C**
546800200529     C           DDCASN    IFEQ *BLANKS                    B2
546900200529     C           DDCASD    ANDNE*BLANKS
547000200529     C           DDCASF    ANDNE*BLANKS
547100200529     C                     MOVELBJMRDT    WWDAYN  20
547200200529     C                     MOVE DDCASD    WWCASD  20
547300200529     C           WWCASD    IFEQ WWDAYN                     B3
547400200529     C                     Z-ADDBJRDNB    PNCASN
547500200529     C                     ELSE                            X3
547600200529     C                     MOVE DDCASF    ZFREQ
547700200529     C                     Z-ADDBJRDNB    ZDAYNO
547800200529     C                     MOVE DDCASD    ZMDAY
547900200529     C                     MOVE BJLCCY    ZCCY
548000200529     C                     EXSR ZFRQA
548100200529     C                     Z-ADDZDAYNO    PNCASN
548200200529     C                     END                             E3
548300200529     C                     ELSE                            X2
548400200529     C                     Z-ADDWWCASN    PNCASN
548500200529     C                     END                             E2
548600200529     C                     MOVELDDPOLC    PNPOLC
548700200529     C                     MOVELDDIPIN    PNIPIN
548800200529     C                     MOVELDDCYIN    PNCYIN
548900200529     C                     MOVELDDYPIN    PNYPIN
549000200529     C                     MOVELDDNPIN    PNNPIN
549100200529     C                     Z-ADDWWNEWT    PNTNLU
549200200529     C***********          Z-ADD0         PNCUSB                          S01486
549300200529     C                     MOVE *BLANKS   PNCUSB                          S01486
549400200529     C****                 MOVE *BLANKS   PNVLNT                          S01313
549500200529     C****                 Z-ADD0         PNVLOR                          S01313
549600200529     C                     MOVE *BLANKS   PNWSI1
549700200529     C           DDPSDT    IFEQ *BLANKS                                   S01313
549800200529     C                     Z-ADD99999     PNPSDT                          S01313
549900200529     C                     ELSE                                           S01313
550000200529     C                     Z-ADDWWPSDT    PNPSDT                          S01313
550100200529     C                     END                                            S01313
550200200529     C*
550300200529     C           *IN72     IFEQ '1'                        B2
550400200529     C*                                                                   CAC003
550500200529     C** If Analytical Accounting is switched on;                         CAC003
550600200529     C           *IN87     IFEQ '1'                                       CAC003
550700200529     C                     MOVE DDPRF2    PNPRFC                          CAC003
550800200529     C                     ENDIF                                          CAC003
550900200529     C*                                                                   CAC003
551000200529     C**
551100200529     C                     MOVEASTAMP,1   PNTMST           Default Timestamp                  CPK015
551200200529     C                     WRITEPMPORTP0               79
551300200529     C*
551400200529     C** TEST FOR UPDATE BY ANOTHER W/S, OR A TERMINAL ERROR
551500200529     C*
551600200529     C           *IN79     IFEQ '1'                        B3
551700200529     C           STATUS    ANDEQ01021
551800200529     C           PMPORK    CHAINPMPORTXX             72
551900200529     C*
552000200529     C           *IN72     IFEQ '0'                        B4
552100200529     C                     EXSR #CBB
552200200529     C                     GOTO XTUPDF
552300200529     C                     END                             E4
552400200529     C*
552500200529     C                     END                             E3
552600200529     C*
552700200529     C           *IN79     IFEQ '1'                        B3
552800200529     C                     EXSR *PSSR
552900200529     C                     END                             E3
553000200529     C*
553100200529     C                     ELSE                            X2
553200200529     C**
553300200529     C                     UPDATPMPORTP0
553400200529     C*
553500200529     C                     END                             E2
553600200529     C*                                                                   B08255
553700200529     C** IF CURRENCY WRITTEN TO PF/PMPORTPP DIFFERENT TO CUSTOMER         S01313
553800200529     C***BASE*CURRENCY*UPDATE DIFFERENCE INDICATOR ON SDPLCSPD     B08255 S01486
553900200529     C** BASE CURRENCY UPDATE DIFFERENCE INDICATOR ON SDPLCSL1            S01486
554000200529     C                     MOVE PNCNUM    WSCNUM  6                S01313 S01486
554100200529     C***********WSCNUM    CHAINSDPLCSPD             72            S01313 S01486
554200200529     C           WSCNUM    CHAINSDPLCSL1             72                   S01486
554300200529     C           *IN72     IFEQ '1'                                       S01313
554400200529     C           *LOCK     IN   LDA                        ***************S01486
554500200529     C                     Z-ADD6         DBASE   30       **DB ERROR 06**S01313
554600200529     C***********          MOVEL'SDPLCSPD'DBFILE 10        ********S01313 S01486
554700200529     C                     MOVE 'SDPLCSPD'DBFILE           ***************S01486
554800200529     C                     MOVELPNCNUM    DBKEY  29                       S01313
554900200529     C                     OUT  LDA                                       S01486
555000200529     C                     EXSR *PSSR                                     S01313
555100200529     C                     END                             E2             S01313
555200200529     C           PNPTCY    IFNE QBCSBY                     B2             S01313
555300200529     C                     MOVE 'N'       QBAPBC                          B08255
555400200529     C                     END                             E2             S01313
555500200529     C***********          UPDATSDPLCSP0                           S01313 S01486
555600200529     C                     UPDAT@PLCSL1                                   S01486
555700200529     C                     END                             E1             S01313
555800200529     C**
555900200529     C** ACTION CODE A  OR C
556000200529     C**
556100200529     C           DDACTN    IFEQ 'A'
556200200529     C           DDACTN    OREQ 'C'
556300200529     C**
556400200529     C** ACCESS FILE
556500200529     C**
556600200529     C***********PMPORK    CHAINPMPORTPP             72                   S01486
556700200529     C           PMPORK    CHAINPMPORTPD             72                   S01486
556800200529     C**
556900200529     C           *IN72     IFEQ '0'
557000200529     C**
557100200529     C** RECORD UPDATED BY ANOTHER WORKSTATION
557200200529     C**
557300200529     C           PNTNLU    IFNE WWTNLU
557400200529     C                     EXSR #CBB
557500200529     C                     GOTO XTUPDF
557600200529     C                     END
557700200529     C**
557800200529     C                     MOVE BJMRDT    WWHLUP
557900200529     C                     Z-ADDWWDLUP    PNDLUP
558000200529     C                     MOVE WWMLUP    PNMLUP
558100200529     C                     Z-ADDWWYLUP    PNYLUP
558200200529     C                     TIME           PNTLUP
558300200529     C           DDACTN    IFEQ 'A'
558400200529     C           PNLCD     IFNE BJRDNB
558500200529     C                     MOVEL'A'       PNCHTP
558600200529     C                     END
558700200529     C                     MOVELDDPTFN    PNPTFN
558800200529     C                     MOVELDDPTFT    PNPTFT
558900200529     C                     MOVELDDCFGC    PNCFGC                          S01307
559000200529     C                     MOVELDDMNGI    PNMNGI
559100200529     C                     MOVE DDACSQ    PNACSQ                          S71062
559200200529     C****                 Z-ADDWWDPOP    PNDPOP                          45330
559300200529     C           BGLMCR    IFEQ 'N'
559400200529     C                     Z-ADDWWPDGS    PNPDGS
559500200529     C                     Z-ADDWWPDGF    PNPDGF
559600200529     C                     END
559700200529     C                     MOVELDDVLFQ    PNVLFQ
559800200529     C                     MOVELDDVLDM    PNVLDM
559900200529     C                     Z-ADDWWVLND    PNVLND
560000200529     C****                 MOVELDDAAD1    PNAAD1                          S01313
560100200529     C****                 MOVELDDAAD2    PNAAD2                          S01313
560200200529     C****                 MOVELDDAAD3    PNAAD3                          S01313
560300200529     C****                 MOVELDDAAD4    PNAAD4                          S01313
560400200529     C****                 MOVELDDAAD5    PNAAD5                          S01313
560500200529     C                     MOVELDDS1VR    PNS1VR                          S01313
560600200529     C                     MOVELDDS2VR    PNS2VR
560700200529     C                     MOVELDDS3VR    PNS3VR
560800200529     C                     MOVELDDS4VR    PNS4VR
560900200529     C                     MOVELDDS5VR    PNS5VR
561000200529     C                     MOVELDDS6VR    PNS6VR
561100200529     C                     MOVELDDS7VR    PNS7VR                          S01313
561200200529     C                     MOVELDDS8VR    PNS8VR                          S01313
561300200529     C                     MOVELDDS9VR    PNS9VR                          CPM005
561400200529     C                     MOVELDDS0VR    PNS0VR                          CPM005
561500200529     C           DDTYSM    IFNE *BLANKS                                   S01313
561600200529     C                     MOVE DDTYSM    PNTYSM                          S01313
561700200529     C                     ELSE                                           S01313
561800200529     C                     Z-ADD0         PNTYSM                          S01313
561900200529     C                     END                                            S01313
562000200529     C*                                                                   S01313
562100200529     C                     MOVE DDADPP    PNADPP                          S01313
562200200529     C                     MOVE DDRPYP    PNRPYP                          S01313
562300200529     C           DDRPYP    IFEQ 'N'                                       S01313
562400200529     C           DDTYSM    ANDEQ'  '                                      S01313
562500200529     C           DDADPP    ANDEQ'  '                                      S01313
562600200529     C                     Z-ADD99999     PNPSDT                          S01313
562700200529     C                     ELSE                                           S01313
562800200529     C                     Z-ADDWWPSDT    PNPSDT                          S01313
562900200529     C                     END                                            S01313
563000200529     C                     MOVE DDPMNG    PNPMNG                          S01313
563100200529     C                     MOVELDDCASF    PNCASF
563200200529     C                     MOVE DDCASD    PNCASD
563300200529     C**
563400200529     C** FOLLOWING VALIDATION TO DETERMINE NEXT REPORT DATE
563500200529     C** IF REPORT DAY AND REPORT FREQUENCY ENTERED
563600200529     C** IF REPORT DAY EQUAL TO DAY OF RUN DATE THEN DEFAULT TO
563700200529     C** RUN DATE
563800200529     C** OTHERWISE CALCULATE IT BY THE MEAN OF SUBROUTINE ZFRQA
563900200529     C**
564000200529     C           DDCASN    IFEQ *BLANKS
564100200529     C           DDCASD    ANDNE*BLANKS
564200200529     C           DDCASF    ANDNE*BLANKS
564300200529     C                     MOVELBJMRDT    WWDAYN
564400200529     C                     MOVE DDCASD    WWCASD  20
564500200529     C           WWCASD    IFEQ WWDAYN
564600200529     C                     Z-ADDBJRDNB    PNCASN
564700200529     C                     ELSE
564800200529     C                     MOVE DDCASF    ZFREQ
564900200529     C                     Z-ADDBJRDNB    ZDAYNO
565000200529     C                     MOVE DDCASD    ZMDAY
565100200529     C                     MOVE BJLCCY    ZCCY
565200200529     C                     EXSR ZFRQA
565300200529     C                     Z-ADDZDAYNO    PNCASN
565400200529     C                     END
565500200529     C                     ELSE
565600200529     C                     Z-ADDWWCASN    PNCASN
565700200529     C                     END
565800200529     C                     MOVELDDPOLC    PNPOLC
565900200529     C                     MOVELDDIPIN    PNIPIN
566000200529     C                     MOVELDDCYIN    PNCYIN
566100200529     C                     MOVELDDYPIN    PNYPIN
566200200529     C                     MOVELDDNPIN    PNNPIN
566300200529     C                     ELSE
566400200529     C           DDACTN    IFEQ 'C'
566500200529     C           WWDPCL    IFNE 0
566600200529     C                     MOVEL'C'       PNCHTP
566700200529     C                     ELSE
566800200529     C                     MOVEL'A'       PNCHTP
566900200529     C                     END
567000200529     C                     Z-ADDWWDPCL    PNDPCL
567100200529     C                     END
567200200529     C                     END
567300200529     C                     Z-ADDBJRDNB    PNLCD
567400200529     C                     Z-ADDWWNEWT    PNTNLU
567500200529     C                     END
567600200529     C*                                                                   CAC003
567700200529     C** If Analytical Accounting is switched on;                         CAC003
567800200529     C           *IN87     IFEQ '1'                                       CAC003
567900200529     C                     MOVE DDPRF2    PNPRFC                          CAC003
568000200529     C                     ENDIF                                          CAC003
568100200529     C*                                                                   CAC003
568200200529     C**
568300200529     C** RESET FIELD
568400200529     C**
568500200529     C                     MOVEL*BLANKS   PNWSI1
568600200529     C**
568700200529     C                     UPDATPMPORTP0
568800200529     C**
568900200529     C                     END
569000200529     C*
569100200529     C           XTUPDF    ENDSR
569200200529     C*
569300200529     C**************************************************************************
569400200529      /EJECT
569500200529      **************************************************************************
569600200529      *                                                                        *
569700200529      * #P1009   - TO UPDATE PORTFOLIO CHARGES DETAILS FILE                    *
569800200529      *                                                                        *
569900200529      * SUBROUTINE CALLS:                                                      *
570000200529      * #CBB     - TO PROCESS UPDATE BY ANOTHER WORKSTATION                    *
570100200529      * #Z1009   - TO TRANSFER SCREEN FIELDS TO FILE                           *
570200200529      *                                                                        *
570300200529      * SUBROUTINE CALLED FROM:                                                *
570400200529      * #P1004   - TO PROCESS DETAIL SCREEN AND UPDATE FILES                   *
570500200529      *                                                                        *
570600200529      **************************************************************************
570700200529     C           #P1009    BEGSR                           **#P1009  BSR**
570800200529     C*
570900200529     C*
571000200529     C                     MOVE 'N'       WWCHUP  1
571100200529     C                     MOVE '0'       *IN75
571200200529     C                     MOVE '0'       *IN76
571300200529     C                     MOVE '0'       *IN89
571400200529     C                     Z-ADD1         X
571500200529     C**
571600200529     C** READ THROUGH ALL CHARGE RECORDS ON SUBFILE
571700200529     C**
571800200529     C           X         DOUGT10
571900200529     C           *IN89     OREQ '1'
572000200529     C                     Z-ADDX         WWCGSQ
572100200529     C***********PMCHRK    CHAINPMCHRGPP             76                   S01486
572200200529     C           PMCHRK    CHAINPMCHRGPD             76                   S01486
572300200529     C           X         CHAINPM0110S1             75
572400200529     C**
572500200529     C** RECORD FOUND ON SUBFILE AND NOT BLANKED
572600200529     C**
572700200529     C           *IN75     IFEQ '0'
572800200529     C           DDCGCO    ANDNE*BLANKS
572900200529     C**
573000200529     C***RECORD*FOUND ON PMCHRGPP                                         S01486
573100200529     C** RECORD FOUND ON PMCHRGPD                                         S01486
573200200529     C**
573300200529     C**
573400200529     C* ACCESS LAST TRANSACTION NUMBER TO CHECK IF RECORD
573500200529     C* HAS BEEN UPDATED BY ANOTHER WORKSTATION
573600200529     C**
573700200529     C                     EXSR #Z1009
573800200529     C**
573900200529     C                     END
574000200529     C*
574100200529     C**                   END
574200200529     C*
574300200529     C                     ADD  1         X
574400200529     C*
574500200529     C                     END
574600200529     C**
574700200529     C** UPDATE CHARGE INFORMATION HELD ON PF/PMPORTPP
574800200529     C**
574900200529     C***********PMPORK    CHAINPMPORTPP             72                   S01486
575000200529     C           PMPORK    CHAINPMPORTPD             72                   S01486
575100200529     C**
575200200529     C           *IN72     IFEQ '0'
575300200529     C*
575400200529     C***IF*ANY*CHARGE*DETAILS INPUT TO PF/PMCHRGPP UPDATE CHARGE         S01486
575500200529     C***INFORMATION*ON PF/PMPORTPP                                       S01486
575600200529     C** IF ANY CHARGE DETAILS INPUT TO PF/PMCHRGPD UPDATE CHARGE         S01486
575700200529     C** INFORMATION ON PF/PMPORTPD                                       S01486
575800200529     C*
575900200529     C                     MOVELDDBCGY    PNBCGY
576000200529     C                     MOVELDDCSCY    PNCSCY
576100200529     C                     MOVELDDCUSA    PNCUSA
576200200529     C*
576300200529     C** DO NOT UPDATE WORKFIELDS FOR PORTFOLIO CLOSURE
576400200529     C           DDACTN    IFNE 'C'
576500200529     C           WWCHGP    ANDEQ'Y'                                       B08166
576600200529     C                     Z-ADDWWBCGY    PNBCGD
576700200529     C                     Z-ADDWWCSCY    PNCSDP
576800200529     C**********           Z-ADDWWCUSB    PNCUSB                          S01486
576900200529     C                     MOVE WWCUSB    PNCUSB                          S01486
577000200529     C                     END
577100200529     C*
577200200529     C                     UPDATPMPORTP0
577300200529     C*
577400200529     C** RESET CHARGE DETAILS
577500200529     C*
577600200529     C                     MOVE *BLANKS   PNBCGY
577700200529     C                     Z-ADD0         PNBCGD
577800200529     C                     MOVE *BLANKS   PNCSCY
577900200529     C                     Z-ADD0         PNCSDP
578000200529     C                     MOVE *BLANKS   PNCUSA
578100200529     C***********          Z-ADD0         WWCUSB                          085799
578200200529     C                     MOVE *BLANKS   WWCUSB                          085799
578300200529     C                     END
578400200529     C*
578500200529     C                     MOVE '0'       *IN76
578600200529     C*
578700200529     C                     ENDSR
578800200529     C*
578900200529     C**************************************************************************
579000200529      /EJECT
579100200529      **************************************************************************
579200200529      *                                                                        *
579300200529      * #P1010   - TO UPDATE PORTFOLIO DEFINITION AUDIT                        *
579400200529      *                                                                        *
579500200529      * SUBROUTINE CALLS:                                                      *
579600200529      * *PSSR    - TO PROCESS ABNORMAL END OF PROGRAM                          *
579700200529      *                                                                        *
579800200529      * SUBROUTINE CALLED FROM:                                                *
579900200529      * #P1004   - TO PROCESS DETAIL SCREEN AND UPDATE FILES                   *
580000200529      *                                                                        *
580100200529      *                                                                        *
580200200529      **************************************************************************
580300200529     C           #P1010    BEGSR                           **#P1010  BSR**
580400200529     C**
580500200529     C**
580600200529     C** ACCESS PORTFOLIO AUDIT RECORD
580700200529     C**
580800200529     C***********1         CHAINPMPORTZZ             72                   S01486
580900200529     C           1         CHAINPMPORTPA             72                   S01486
581000200529     C**
581100200529     C*** RECORD FOUND
581200200529     C**
581300200529     C           *IN72     IFEQ '0'
581400200529     C                     ADD  1         PNNORE
581500200529     C                     UPDATPMPORTZ0
581600200529     C                     ELSE
581700200529     C           *LOCK     IN   LDA                                       S01486
581800200529     C*                                                    ***************
581900200529     C                     Z-ADD5         DBASE            **DB ERROR 05**
582000200529     C************         MOVEL'PMPORTZZ'DBFILE           ***************S01486
582100200529     C                     MOVEL'PMPORTPA'DBFILE           ***************S01486
582200200529     C                     MOVE *BLANKS   DBKEY
582300200529     C                     OUT  LDA                                       S01486
582400200529     C                     EXSR *PSSR
582500200529     C                     END
582600200529     C**
582700200529     C                     ENDSR
582800200529     C*
582900200529     C**************************************************************************
583000200529      /EJECT
583100200529      **************************************************************************
583200200529      *                                                                        *
583300200529      * #Z1009   - TO TRANSFER SCREEN FIELDS TO FILE                           *
583400200529      *                                                                        *
583500200529      * SUBROUTINE CALLS:                                                      *
583600200529      *                                                                        *
583700200529      * SUBROUTINE CALLED FROM:                                                *
583800200529      * #P1009   - TO UPDATE PORTFOLIO CHARGES DETAILS FILE                    *
583900200529      *                                                                        *
584000200529      **************************************************************************
584100200529     C           #Z1009    BEGSR                           **#Z1009  BSR**
584200200529     C*
584300200529     C                     MOVEL'D'       PORECI
584400200529     C                     MOVE BJMRDT    WWHLUP
584500200529     C                     Z-ADDWWDLUP    PODLUP
584600200529     C                     MOVE WWMLUP    POMLUP
584700200529     C                     Z-ADDWWYLUP    POYLUP
584800200529     C                     TIME           POTLUP
584900200529     C                     Z-ADDWWNEWT    POTNLU
585000200529     C                     Z-ADDBJRDNB    POLCD
585100200529     C                     Z-ADDRRN2      POCGSQ
585200200529     C**
585300200529     C                     MOVELDDCGCO    POCGCO
585400200529     C                     Z-ADDDDCGSH    POCGSP
585500200529     C                     MOVELDDCGSI    POCGSI
585600200529     C                     MOVELDDCGEI    POCGEI
585700200529     C                     MOVELDDCGFQ    POCGFQ
585800200529     C                     MOVELDDCGDY    POCGDY
585900200529     C                     Z-ADDDDCGNH    POCGND
586000200529     C                     MOVELDDCGST    POCGST
586100200529     C**
586200200529     C                     MOVELDDCSFQ    POCSFQ
586300200529     C                     MOVELDDCSDY    POCSDY
586400200529     C                     Z-ADDDDCSNH    POCSND
586500200529     C*                                                                   S01486
586600200529     C           BKPRCU    IFEQ 'Y'                                       S01486
586700200529     C                     MOVELDDPRFC    POPFRC                          S01486
586800200529     C                     END                                            S01486
586900200529     C**
587000200529     C** FIELDS FILLED WHEN INSERT OTHERWISE NOT UPDATED
587100200529     C**
587200200529     C           *IN76     IFEQ '1'
587300200529     C                     MOVEL'I'       POCHTP
587400200529     C                     MOVE WWPNP8    POCNUM
587500200529     C                     MOVELDDPREF    POPTFR
587600200529     C                     Z-ADD0         POCGAD
587700200529     C                     Z-ADD0         POCGLD
587800200529     C                     MOVEL*BLANK    POCSIS
587900200529     C                     MOVEL*BLANKS   POCCSP
588000200529     C                     Z-ADD0         POCSSP
588100200529     C                     MOVEL*BLANK    POCISP
588200200529     C                     Z-ADD0         POCGAJ
588300200529     C                     MOVEL*BLANK    POCGAS
588400200529     C                     MOVEL*BLANKS   POCGAP
588500200529     C                     MOVEL*BLANKS   POCSPR
588600200529     C                     Z-ADD0         POCGAT
588700200529     C                     Z-ADD0         POCSTT
588800200529     C*
588900200529     C** SET UP LAST ACCRUAL DATE. WHEN A NEW PORTFOLIO IS OPENED THE
589000200529     C** LAST ACCRUAL DATE SHOULD BE SET TO DATE PORTFOLIO OPENED
589100200529     C** IF CHARGES EFFECTIVE INDICATOR IS 'C'
589200200529     C** OTHERWISE SET TO 'NEXT ACCRUAL DATE
589300200529     C*
589400200529     C           PNCHTP    IFEQ 'I'
589500200529     C*
589600200529     C***********POCGEI    IFEQ 'C'
589700200529     C***********          Z-ADDPNDPOP    POCGLD                          R05914
589800200529     C*******              Z-ADDBJRDNB    POCGLD                    B07916R05914
589900200529     C           BJRDNB    SUB  1         POCGLD                          B07916
590000200529     C***********          ELSE
590100200529     C***********          Z-ADDPOCGND    POCGLD
590200200529     C***********          END
590300200529     C                     ELSE
590400200529     C*
590500200529     C** IF A PORTFOLIO DEFINITION IS BEING AMENDED TO INCLUDE AN
590600200529     C** EXTRA CHARGE CODE AND PORTFOLIO DEFINED ON A PREVIOUS DATE
590700200529     C** SET LAST ACCRUAL DATE TO TODAY
590800200529     C*
590900200529     C           DDACTN    IFEQ 'A'
591000200529     C*
591100200529     C***********POCGEI    IFEQ 'C'
591200200529     C*******              Z-ADDBJRDNB    POCGLD                    B07916R05914
591300200529     C           BJRDNB    SUB  1         POCGLD                          B07916
591400200529     C***********          ELSE
591500200529     C***********          Z-ADDPOCGND    POCGLD
591600200529     C***********          END
591700200529     C                     END
591800200529     C                     END
591900200529     C*
592000200529     C                     WRITEPMCHRGP0
592100200529     C                     ELSE
592200200529     C** RECORD DOES EXIST AND WILL BE AMENDED
592300200529     C**
592400200529     C                     MOVEL'A'       POCHTP
592500200529     C                     UPDATPMCHRGP0
592600200529     C                     END
592700200529     C**
592800200529     C                     ENDSR
592900200529     C*
593000200529     C**************************************************************************
593100200529      /EJECT
593200200529      **************************************************************************
593300200529      *                                                                        *
593400200529      * #V1006   - TO VALIDATE PORTFOLIO CHARGES DETAILS                       *
593500200529      *                                                                        *
593600200529      * SUBROUTINE CALLS:                                                      *
593700200529      ********ZA0240   - TO ACCESS MESSAGE FILE AND SEND MESSAGE          R00300
593800200529      * ZASNMS   - WRITE ERROR MESSAGES                                   R00300
593900200529      * #ZED     - TO COMPUTE DECIMAL NUMBER AND ACCESS ZEDIT SR               *
594000200529      * ZALIGN   - SR/ TO RIGHT ALIGN NUMERIC FIELDS                           *
594100200529      * ZDATE1   - TO COMPUTE DATE IN DAY NUMBER                               *
594200200529      *                                                                        *
594300200529      * SUBROUTINE CALLED FROM:                                                *
594400200529      * #P1005   - TO PROCESS PORTFOLIO CHARGE DETAILS                         *
594500200529      *                                                                        *
594600200529      **************************************************************************
594700200529     C           #V1006    BEGSR                           ** #V1006 BSR**
594800200529     C**
594900200529     C** RESET ERROR INDICATORS
595000200529     C**
595100200529     C                     MOVE '0'       *IN32
595200200529     C                     MOVE '0'       *IN33
595300200529     C                     MOVE '0'       *IN34
595400200529     C                     MOVE '0'       *IN54                           S01486
595500200529     C*
595600200529     C**+++++++++++++++++++++++++++++++++++++++++++++++++++++
595700200529     C** VAL6DDBCGY    BANK CHARGING CURRENCY
595800200529     C**+++++++++++++++++++++++++++++++++++++++++++++++++++++
595900200529     C**
596000200529     C                     MOVE 'N'       DDBCDF  1
596100200529     C           DDBCGY    IFEQ *BLANKS
596200200529     C**
596300200529     C** IF NOT ENTERED SET DEFAULT TO BASE CURRENCY
596400200529     C**
596500200529     C                     MOVE 'Y'       DDBCDF
596600200529     C                     MOVE BJCYCD    DDBCGY
596700200529     C                     END
596800200529     C**
596900200529     C** IF  ENTERED MUST BE VALID ON SDCURRL0
597000200529     C** LOOK UP FOR NUMBER OF DECIMALS
597100200529     C**
597200200529     C***********DDBCGY    CHAINSDCURRL0             72                   S01486
597300200529     C************IN72     IFEQ '1'                                       S01486
597400200529     C*********************MOVEL'PM11300' MSGID                           R00300
597500200529     C*********************CALL 'ZA0240'                                  R00300
597600200529     C*********************PARM           MSGID                           R00300
597700200529     C                     CALL 'AOCURRR0'                                S01486
597800200529     C                     PARM *BLANKS   WWRTCD  7                       S01486
597900200529     C                     PARM '*KEY    'WWOPTN  7                       S01486
598000200529     C                     PARM DDBCGY    WWKEY   3                       S01486
598100200529     C           SDCURR    PARM SDCURR    DSSDY                           S01486
598200200529     C           WWRTCD    IFNE *BLANKS                                   S01486
598300200529     C                     MOVEL'PM11300' ZAMSID                          R00300
598400200529     C                     EXSR ZASNMS                                    R00300
598500200529     C                     MOVE '1'       *IN80
598600200529     C                     MOVE '1'       *IN32
598700200529     C                     ELSE
598800200529     C*********************Z-ADDA6DPBF    WWBCGY  10                      046461
598900200529     C                     Z-ADDA6NBDP    WWBCGY  10                      046461
599000200529     C                     END
599100200529     C**
599200200529     C**+++++++++++++++++++++++++++++++++++++++++++++++++++++
599300200529     C** VAL6DDCSCY     CUSTOMER SETTLEMENT CURRENCY
599400200529     C**+++++++++++++++++++++++++++++++++++++++++++++++++++++
599500200529     C**
599600200529     C                     MOVE 'N'       DDCSDF  1
599700200529     C           DDCSCY    IFEQ *BLANKS
599800200529     C**
599900200529     C** IF NOT ENTERED SET DEFAULT TO BASE CURRENCY
600000200529     C**
600100200529     C                     MOVE 'Y'       DDCSDF
600200200529     C                     MOVE QBCSBY    DDCSCY
600300200529     C                     END
600400200529     C**
600500200529     C** IF ENTERED MUST BE VALID ON SDCURRL0
600600200529     C**
600700200529     C***********DDCSCY    CHAINSDCURRL0             72                   S01486
600800200529     C************IN72     IFEQ '1'                                       S01486
600900200529     C*********************MOVEL'PM11301' MSGID                           R00300
601000200529     C*********************CALL 'ZA0240'                                  R00300
601100200529     C*********************PARM           MSGID                           R00300
601200200529     C                     CALL 'AOCURRR0'                                S01486
601300200529     C                     PARM *BLANKS   WWRTCD  7                       S01486
601400200529     C                     PARM '*KEY    'WWOPTN  7                       S01486
601500200529     C                     PARM DDCSCY    WWKEY   3                       S01486
601600200529     C           SDCURR    PARM SDCURR    DSSDY                           S01486
601700200529     C           WWRTCD    IFNE *BLANKS                                   S01486
601800200529     C                     MOVEL'PM11301' ZAMSID                          R00300
601900200529     C                     EXSR ZASNMS                                    R00300
602000200529     C                     MOVE '1'       *IN80
602100200529     C                     MOVE '1'       *IN33
602200200529     C                     ELSE
602300200529     C******************** Z-ADDA6DPBF    WWCSCY                          046461
602400200529     C                     Z-ADDA6NBDP    WWCSCY                          046461
602500200529     C                     END
602600200529     C**
602700200529     C**+++++++++++++++++++++++++++++++++++++++++++++++++++++
602800200529     C** VAL6DDCUSA     CUSTOMER SETTLEMENT ACCOUNT
602900200529     C**+++++++++++++++++++++++++++++++++++++++++++++++++++++
603000200529     C**
603100200529     C                     MOVE 'N'       WWCUSV  1
603200200529     C           DDCUSA    IFEQ *BLANKS
603300200529     C**
603400200529     C** MUST BE ENTERED IF ANY CHARGE DETAILS HAVE BEEN ENTERED
603500200529     C**
603600200529     C                     Z-ADD1         X
603700200529     C           X         DOUEQ10
603800200529     C           X         CHAINPM0110S1             72
603900200529     C           *IN72     IFEQ '0'
604000200529     C           DDCGCO    ANDNE*BLANKS
604100200529     C*********************MOVEL'PM11302' MSGID                           R00300
604200200529     C*********************CALL 'ZA0240'                                  R00300
604300200529     C*********************PARM           MSGID                           R00300
604400200529     C                     MOVEL'PM11302' ZAMSID                          R00300
604500200529     C                     EXSR ZASNMS                                    R00300
604600200529     C                     MOVE '1'       *IN80
604700200529     C                     MOVE '1'       *IN34
604800200529     C                     END
604900200529     C                     ADD  1         X
605000200529     C                     END
605100200529     C**
605200200529     C                     ELSE
605300200529     C**
605400200529     C** IF RETAIL ACCOUNT ENTERED - MUST BE VALID
605500200529     C**
605600200529     C                     MOVELDDCUSA    WWCUSA
605700200529     C           WWCSA2    IFEQ *BLANKS
605800200529     C           WWCSA1    CHAINACNUMTBF             73
605900200529     C*                                                                   R00954
606000200529     C** IF VALID ACCOUNT FOUND TEST RETAIL INDICATORS                    R00954
606100200529     C           *IN73     IFEQ '0'                                       R00954
606200200529     C           RECI      ANDEQ'D'                                       R00954
606300200529     C                     EXSR TESTRI                                    R00954
606400200529     C                     END                                            R00954
606500200529     C*                                                                   R00954
606600200529     C           *IN73     IFEQ '1'
606700200529     C           RECI      ORNE 'D'
606800200529     C           *IN66     OREQ '0'                                       R00954
606900200529     C*********************MOVEL'PM11303' MSGID                           R00300
607000200529     C*********************CALL 'ZA0240'                                  R00300
607100200529     C*********************PARM           MSGID                           R00300
607200200529     C                     MOVEL'PM11303' ZAMSID                          R00300
607300200529     C                     EXSR ZASNMS                                    R00300
607400200529     C                     MOVE '1'       *IN80
607500200529     C                     MOVE '1'       *IN34
607600200529     C***********          ELSE                                           163634
607700200529     C***********          MOVELDDCSCY    WWCUCY                   085799 163634
607800200529     C***********          MOVELDDBRCA    WWBRCA                   085799 163634
607900200529     C***********PMACCN    CHAINACCNTABF             73            085799 163634
608000200529     C***********                                                  085799 163634
608100200529     C************IN73     IFEQ '1'                                085799 163634
608200200529     C***********RECI      ORNE 'D'                                085799 163634
608300200529     C***********          MOVEL'PM11304' ZAMSID                   085799 163634
608400200529     C***********          EXSR ZASNMS                             085799 163634
608500200529     C***********          MOVE '1'       *IN80                    085799 163634
608600200529     C***********          MOVE '1'       *IN34                    085799 163634
608700200529     C***********          ELSE                                    085799 163634
608800200529     C************         MOVE BRCD      WWCUSB  30                      S01486
608900200529     C***********          MOVE BRCA      WWCUSB  30                S01486085799
609000200529     C***********          MOVE BRCA      WWCUSB  3                085799 163634
609100200529     C***********          MOVE 'Y'       WWCUSV                          163634
609200200529     C***********          END                                     085799 163634
609300200529     C                     END
609400200529     C**
609500200529     C                     ELSE
609600200529     C**
609700200529     C** IF 12 ALPHA ACCOUNT ENTERED - MUST BE VALID
609800200529     C** WHEN COMBINED WITH CURRENCY
609900200529     C**
610000200529     C                     MOVELDDCSCY    WWCUCY
610100200529     C                     MOVELDDBRCA    WWBRCA                          085799
610200200529     C           PMACCN    CHAINACCNTABF             73
610300200529     C*                                                                   R00954
610400200529     C** IF VALID ACCOUNT FOUND TEST RETAIL INDICATORS                    R00954
610500200529     C           *IN73     IFEQ '0'                                       R00954
610600200529     C           RECI      ANDEQ'D'                                       R00954
610700200529     C                     EXSR TESTRI                                    R00954
610800200529     C                     END                                            R00954
610900200529     C*                                                                   R00954
611000200529     C           *IN73     IFEQ '1'
611100200529     C           RECI      ORNE 'D'
611200200529     C           *IN66     OREQ '0'                                       R00954
611300200529     C******                                                              R00954
611400200529     C** TEST RETAIL INDICATORS TO SEE IF ACCOUNT IS BLOCKED              R00954
611500200529     C******               EXSR TESTRI                                    R00954
611600200529     C******     *IN66     IFEQ '0'                                       R00954
611700200529     C*********************MOVEL'PM11304' MSGID                           R00300
611800200529     C*********************CALL 'ZA0240'                                  R00300
611900200529     C*********************PARM           MSGID                           R00300
612000200529     C                     MOVEL'PM11304' ZAMSID                          R00300
612100200529     C                     EXSR ZASNMS                                    R00300
612200200529     C                     MOVE '1'       *IN80
612300200529     C                     MOVE '1'       *IN34
612400200529     C                     ELSE
612500200529     C********             MOVE BRCD      WWCUSB  30                      S01486
612600200529     C***********          MOVE BRCA      WWCUSB  30                S01486085799
612700200529     C                     MOVE BRCA      WWCUSB  3                       085799
612800200529     C                     MOVE 'Y'       WWCUSV
612900200529     C********             END                                            R00954
613000200529     C                     END                                            R00367
613100200529     C*
613200200529     C                     END
613300200529     C**
613400200529     C** IF CUSTOMER ACCOUNT ENTERED, CUSTOMER SETTLEMENT CURRENCY
613500200529     C** MUST BE VALID
613600200529     C**
613700200529     C           CCY       IFNE DDCSCY
613800200529     C           WWCUSV    ANDEQ'Y'
613900200529     C*********************MOVEL'PM11338' MSGID                           R00300
614000200529     C*********************CALL 'ZA0240'                                  R00300
614100200529     C*********************PARM           MSGID                           R00300
614200200529     C                     MOVEL'PM11338' ZAMSID                          R00300
614300200529     C                     EXSR ZASNMS                                    R00300
614400200529     C                     MOVE '1'       *IN80
614500200529     C                     MOVE '1'       *IN33
614600200529     C                     MOVE '1'       *IN34
614700200529     C                     END
614800200529     C*                                                                   085799
614900200529     C** If BGMBIN = N, branch on ACNUM file must equal Single Branch     085799
615000200529     C** code on SDBANKPD                                                 085799
615100200529     C*                                                                   085799
615200200529     C           BGMBIN    IFEQ 'N'                                       085799
615300200529     C           BJSBRC    ANDNEDDBRCA                                    085799
615400200529     C           WWCUSV    ANDEQ'Y'                                       085799
615500200529     C                     MOVEL'PM11304' ZAMSID                          085799
615600200529     C                     EXSR ZASNMS                                    085799
615700200529     C                     MOVE '1'       *IN80                           085799
615800200529     C                     MOVE '1'       *IN34                           085799
615900200529     C                     END                                            085799
616000200529     C*
616100200529     C                     END
616200200529     C**
616300200529     C***********          MOVEA*BLANKS   CG,1                            S01486
616400200529     C           DDACTN    IFEQ 'I'                                       146302
616500200529     C                     MOVEA*BLANKS   CG,1                            141883
616600200529     C                     END                                            146302
616700200529     C***********          Z-ADD1         X                               S01486
616800200529     C***********X         DOUGT10                                        S01486
616900200529     C                     Z-ADD1         Z       40                      S01486
617000200529     C           Z         DOWLEX                                         S01486
617100200529     C*
617200200529     C** RESET SCREEN ERROR INDICATORS
617300200529     C*
617400200529     C                     MOVE '0'       *IN35
617500200529     C                     MOVE '0'       *IN36
617600200529     C                     MOVE '0'       *IN37
617700200529     C                     MOVE '0'       *IN38
617800200529     C                     MOVE '0'       *IN39
617900200529     C                     MOVE '0'       *IN40
618000200529     C                     MOVE '0'       *IN41
618100200529     C                     MOVE '0'       *IN42
618200200529     C                     MOVE '0'       *IN43
618300200529     C                     MOVE '0'       *IN44
618400200529     C                     MOVE '0'       *IN45
618500200529     C                     MOVE '0'       *IN54                           S01486
618600200529     C**
618700200529     C** RESET WORK FIELDS
618800200529     C**
618900200529     C                     Z-ADD0         WWCGSP
619000200529     C                     Z-ADD0         WWCGND
619100200529     C                     Z-ADD0         WWCSND
619200200529     C                     MOVE 'N'       WWMSG   1
619300200529     C                     MOVE 'Y'       WWVALD
619400200529     C**
619500200529     C***********X         CHAINPM0110S1             75                   S01486
619600200529     C           Z         CHAINPM0110S1             75                   S01486
619700200529     C**
619800200529     C           *IN75     IFEQ '0'
619900200529     C*
620000200529     C** ONCE CHARGE INFORMATION HAS BEEN OUTPUT TO CHARGE DETAILS
620100200529     C** FILE IT MAY NOT BE BLANKED OUT
620200200529     C           DDVALD    IFEQ 'Y'
620300200529     C           DDCGCO    IFEQ *BLANKS
620400200529     C           DDCGCH    ANDNE*BLANKS
620500200529     C                     MOVE '1'       *IN35
620600200529     C                     MOVE DDCGCH    DDCGCO
620700200529     C                     END
620800200529     C*
620900200529     C           DDCGEI    IFEQ *BLANKS
621000200529     C           DDCGEH    ANDNE*BLANKS
621100200529     C                     MOVE DDCGEH    DDCGEI
621200200529     C                     MOVE '1'       *IN38
621300200529     C                     END
621400200529     C*
621500200529     C           DDCGFQ    IFEQ *BLANKS
621600200529     C           DDCGFH    ANDNE*BLANKS
621700200529     C                     MOVE DDCGFH    DDCGFQ
621800200529     C                     MOVE '1'       *IN39
621900200529     C                     END
622000200529     C*
622100200529     C           DDCGDY    IFEQ *BLANKS
622200200529     C           DDCGDH    ANDNE*BLANKS
622300200529     C           DDCGFQ    ANDNE'W'                                       080674
622400200529     C           DDCGFQ    ANDNE'F'                                       080674
622500200529     C                     MOVE DDCGDH    DDCGDY
622600200529     C                     MOVE '1'       *IN40
622700200529     C                     END
622800200529     C*
622900200529     C           DDCGST    IFEQ *BLANKS
623000200529     C           DDCGTH    ANDNE*BLANKS
623100200529     C                     MOVE DDCGTH    DDCGST
623200200529     C                     MOVE '1'       *IN42
623300200529     C                     END
623400200529     C*
623500200529     C           DDCSFQ    IFEQ *BLANKS
623600200529     C           DDCSFH    ANDNE*BLANKS
623700200529     C                     MOVE DDCSFH    DDCSFQ
623800200529     C                     MOVE '1'       *IN43
623900200529     C                     END
624000200529     C*
624100200529     C           DDCSDY    IFEQ *BLANKS
624200200529     C           DDCSDH    ANDNE*BLANKS
624300200529     C                     MOVE DDCSDH    DDCSDY
624400200529     C                     MOVE '1'       *IN44
624500200529     C                     END
624600200529     C*
624700200529     C** IF ANY OF ERROR INDICATORS ARE ON SEND ERROR MESSAGE
624800200529     C*
624900200529     C           *IN35     IFEQ '1'
625000200529     C           *IN38     OREQ '1'
625100200529     C           *IN39     OREQ '1'
625200200529     C           *IN40     OREQ '1'
625300200529     C           *IN42     OREQ '1'
625400200529     C           *IN43     OREQ '1'
625500200529     C           *IN44     OREQ '1'
625600200529     C           *IN54     OREQ '1'                                       S01486
625700200529     C*********************MOVEL'PM11320' MSGID                           R00300
625800200529     C*********************CALL 'ZA0240'                                  R00300
625900200529     C*********************PARM           MSGID                           R00300
626000200529     C                     MOVEL'PM11320' ZAMSID                          R00300
626100200529     C                     EXSR ZASNMS                                    R00300
626200200529     C                     MOVE '1'       *IN80
626300200529     C                     END
626400200529     C                     END
626500200529     C*
626600200529     C**+++++++++++++++++++++++++++++++++++++++++++++++++++++
626700200529     C** VAL6DDCGCO       CHARGE CODE
626800200529     C**+++++++++++++++++++++++++++++++++++++++++++++++++++++
626900200529     C**
627000200529     C           DDCGCO    IFNE *BLANKS
627100200529     C**
627200200529     C** IF ENTERED MUST BE A VALID CHARGE CODE
627300200529     C**
627400200529     C***********PMCODE    CHAINPMCGCDPP             72                   S01486
627500200529     C           PMCODE    CHAINPMCGCDPD             72                   S01486
627600200529     C           *IN72     IFEQ '1'
627700200529     C           P5RECI    ORNE 'D'
627800200529     C                     MOVE 'N'       WWVALD
627900200529     C*********************MOVEL'PM11305' MSGID                           R00300
628000200529     C*********************CALL 'ZA0240'                                  R00300
628100200529     C*********************PARM           MSGID                           R00300
628200200529     C                     MOVEL'PM11305' ZAMSID                          R00300
628300200529     C                     EXSR ZASNMS                                    R00300
628400200529     C                     MOVE '1'       *IN80
628500200529     C                     MOVE '1'       *IN35
628600200529     C                     END
628700200529     C**
628800200529     C** CHARGE SEQUENCE MUST BE UNIQUE
628900200529     C*
629000200529     C           DDCGCO    IFNE DDCGCH                                    080674
629100200529     C           DDCGCO    LOKUPCG,1                     75
629200200529     C**
629300200529     C           *IN75     IFEQ '1'
629400200529     C           WWMSG     ANDEQ'N'
629500200529     C                     MOVE 'N'       WWVALD
629600200529     C*********************MOVEL'PM11306' MSGID                           R00300
629700200529     C*********************CALL 'ZA0240'                                  R00300
629800200529     C*********************PARM           MSGID                           R00300
629900200529     C                     MOVEL'PM11306' ZAMSID                          R00300
630000200529     C                     EXSR ZASNMS                                    R00300
630100200529     C                     MOVE '1'       *IN80
630200200529     C                     MOVE '1'       *IN35
630300200529     C                     MOVE 'Y'       WWMSG
630400200529     C                     ELSE
630500200529     C                     MOVE DDCGCO    CG,X
630600200529     C                     END
630700200529     C                     END                                            080674
630800200529     C**
630900200529     C                     ELSE
631000200529     C**
631100200529     C** MUST BE ENTERED IF ANY CHARGE DETAILS HAVE BEEN ENTERED
631200200529     C**
631300200529     C                     MOVE DDCGCO    CG,X                            177647
631400200529      *                                                                   177647
631500200529     C           DDCGSP    IFNE *BLANKS
631600200529     C           DDCGSI    ORNE *BLANKS
631700200529     C           DDCGEI    ORNE *BLANKS
631800200529     C           DDCGFQ    ORNE *BLANKS
631900200529     C           DDCGDY    ORNE *BLANKS
632000200529     C           DDCGND    ORNE *BLANKS
632100200529     C           DDCGST    ORNE *BLANKS
632200200529     C           DDCSFQ    ORNE *BLANKS
632300200529     C           DDCSDY    ORNE *BLANKS
632400200529     C           DDCSND    ORNE *BLANKS
632500200529     C*********************MOVEL'PM11308' MSGID                           R00300
632600200529     C*********************CALL 'ZA0240'                                  R00300
632700200529     C*********************PARM           MSGID                           R00300
632800200529     C                     MOVEL'PM11308' ZAMSID                          R00300
632900200529     C                     EXSR ZASNMS                                    R00300
633000200529     C                     MOVE '1'       *IN80
633100200529     C                     MOVE '1'       *IN35
633200200529     C                     END
633300200529     C                     END
633400200529     C**
633500200529     C**+++++++++++++++++++++++++++++++++++++++++++++++++++++
633600200529     C** VAL6DDCGSP      CHARGE SPREAD
633700200529     C**+++++++++++++++++++++++++++++++++++++++++++++++++++++
633800200529     C**
633900200529     C           DDCGSP    IFNE *BLANKS
634000200529     C           WWVALD    ANDEQ'Y'
634100200529     C**
634200200529     C** MUST NOT BE ENTERED IF CHARGE CODE IS BLANK
634300200529     C**
634400200529     C           DDCGCO    IFEQ *BLANKS
634500200529     C*********************MOVEL'PM11309' MSGID                           R00300
634600200529     C*********************CALL 'ZA0240'                                  R00300
634700200529     C*********************PARM           MSGID                           R00300
634800200529     C                     MOVEL'PM11309' ZAMSID                          R00300
634900200529     C                     EXSR ZASNMS                                    R00300
635000200529     C                     MOVE '1'       *IN80
635100200529     C                     MOVE '1'       *IN36
635200200529     C                     END
635300200529     C**
635400200529     C** MUST BE A VALID AMOUNT
635500200529     C**
635600200529     C           DDCGCO    IFNE *BLANKS
635700200529     C                     EXSR #ZED
635800200529     C           P5CGBS    IFEQ 'F'
635900200529     C                     MOVE DDCGSP    ZFIELD
636000200529     C                     EXSR ZALIGN
636100200529     C           *IN99     IFEQ '1'
636200200529     C*********************MOVEL'PM11310' MSGID                           R00300
636300200529     C*********************CALL 'ZA0240'                                  R00300
636400200529     C*********************PARM           MSGID                           R00300
636500200529     C                     MOVEL'PM11310' ZAMSID                          R00300
636600200529     C                     EXSR ZASNMS                                    R00300
636700200529     C                     MOVE '1'       *IN80
636800200529     C                     MOVE '1'       *IN36
636900200529     C                     ELSE
637000200529     C                     MOVE ZFIELD    WWCGSP
637100200529     C                     Z-ADDWWCGSP    DDCGSH
637200200529     C*
637300200529     C**
637400200529     C** IF ENTERED AND CHARGE BASIS IS FLAT AND CHARGE SPREAD
637500200529     C** INDICATOR IS '-' MUST BE LESS OR EQUAL TO THE SMALLEST
637600200529     C** OF THE FLAT CHARGE LEVEL ON PMCGCDPP
637700200529     C**
637800200529     C**
637900200529     C           DDCGSI    IFEQ '-'
638000200529     C           P5FLC1    IFLT WWCGSP
638100200529     C           P5CRU1    ORNE 0
638200200529     C           P5FLC2    ANDLTWWCGSP
638300200529     C           P5CRU2    ORNE 0
638400200529     C           P5FLC3    ANDLTWWCGSP
638500200529     C           P5CRU3    ORNE 0
638600200529     C           P5FLC4    ANDLTWWCGSP
638700200529     C           P5CRU4    ORNE 0
638800200529     C           P5FLC5    ANDLTWWCGSP
638900200529     C           P5CRU5    ORNE 0
639000200529     C           P5FLC6    ANDLTWWCGSP
639100200529     C           P5CRU6    ORNE 0
639200200529     C           P5FLC7    ANDLTWWCGSP
639300200529     C           P5CRU7    ORNE 0
639400200529     C           P5FLC8    ANDLTWWCGSP
639500200529     C           P5CRU8    ORNE 0
639600200529     C           P5FLC9    ANDLTWWCGSP
639700200529     C           P5CRU9    ORNE 0
639800200529     C           P5FL10    ANDLTWWCGSP
639900200529     C           P5CR10    ORNE 0
640000200529     C           P5FL11    ANDLTWWCGSP
640100200529     C           P5CR11    ORNE 0
640200200529     C           P5FL12    ANDLTWWCGSP
640300200529     C           P5CR12    ORNE 0
640400200529     C           P5FL13    ANDLTWWCGSP
640500200529     C           P5CR13    ORNE 0
640600200529     C           P5FL14    ANDLTWWCGSP
640700200529     C           P5CR14    ORNE 0
640800200529     C           P5FL15    ANDLTWWCGSP
640900200529     C*********************MOVEL'PM11311' MSGID                           R00300
641000200529     C*********************CALL 'ZA0240'                                  R00300
641100200529     C*********************PARM           MSGID                           R00300
641200200529     C                     MOVEL'PM11311' ZAMSID                          R00300
641300200529     C                     EXSR ZASNMS                                    R00300
641400200529     C                     MOVE '1'       *IN80
641500200529     C                     MOVE '1'       *IN36
641600200529     C                     END
641700200529     C**
641800200529     C                     END
641900200529     C**
642000200529     C                     END
642100200529     C**
642200200529     C                     END
642300200529     C**
642400200529     C           P5CGBS    IFEQ 'P'
642500200529     C**
642600200529     C** MUST BE A VALID AMOUNT
642700200529     C**
642800200529     C                     MOVE DDCGSP    ZFIELD
642900200529     C                     EXSR ZALIGN
643000200529     C           *IN99     IFEQ '1'
643100200529     C*********************MOVEL'PM11312' MSGID                           R00300
643200200529     C*********************CALL 'ZA0240'                                  R00300
643300200529     C*********************PARM           MSGID                           R00300
643400200529     C                     MOVEL'PM11312' ZAMSID                          R00300
643500200529     C                     EXSR ZASNMS                                    R00300
643600200529     C                     MOVE '1'       *IN80
643700200529     C                     MOVE '1'       *IN36
643800200529     C                     ELSE
643900200529     C                     MOVE ZFIELD    WWCGSP
644000200529     C                     Z-ADDWWCGSP    DDCGSH
644100200529     C**
644200200529     C** IF ENTERED AND CHARGE BASIS IS PERCENTAGE AND CHARGE SPREAD
644300200529     C** INDICATOR IS '-' MUST BE LESS OR EQUAL TO THE SMALLEST
644400200529     C***OF*THE*PERCENTAGE LEVEL ON PMCGCDPP                              S01486
644500200529     C** OF THE PERCENTAGE LEVEL ON PMCGCDPD                              S01486
644600200529     C**
644700200529     C           DDCGSI    IFEQ '-'
644800200529     C*
644900200529     C** FIRST CONVERT PERCENTAGE LEVEL  FIELDS
645000200529     C**
645100200529     C           P5PCL1    MULT 10000000  WWPCL1
645200200529     C           P5PCL2    MULT 10000000  WWPCL2
645300200529     C           P5PCL3    MULT 10000000  WWPCL3
645400200529     C           P5PCL4    MULT 10000000  WWPCL4
645500200529     C           P5PCL5    MULT 10000000  WWPCL5
645600200529     C           P5PCL6    MULT 10000000  WWPCL6
645700200529     C           P5PCL7    MULT 10000000  WWPCL7
645800200529     C           P5PCL8    MULT 10000000  WWPCL8
645900200529     C           P5PCL9    MULT 10000000  WWPCL9
646000200529     C           P5PC10    MULT 10000000  WWPC10
646100200529     C           P5PC11    MULT 10000000  WWPC11
646200200529     C           P5PC12    MULT 10000000  WWPC12
646300200529     C           P5PC13    MULT 10000000  WWPC13
646400200529     C           P5PC14    MULT 10000000  WWPC14
646500200529     C           P5PC15    MULT 10000000  WWPC15
646600200529     C*
646700200529     C           WWPCL1    IFLT WWCGSP
646800200529     C           P5CRU1    ORNE 0
646900200529     C           WWPCL2    ANDLTWWCGSP
647000200529     C           P5CRU2    ORNE 0
647100200529     C           WWPCL3    ANDLTWWCGSP
647200200529     C           P5CRU3    ORNE 0
647300200529     C           WWPCL4    ANDLTWWCGSP
647400200529     C           P5CRU4    ORNE 0
647500200529     C           WWPCL5    ANDLTWWCGSP
647600200529     C           P5CRU5    ORNE 0
647700200529     C           WWPCL6    ANDLTWWCGSP
647800200529     C           P5CRU6    ORNE 0
647900200529     C           WWPCL7    ANDLTWWCGSP
648000200529     C           P5CRU7    ORNE 0
648100200529     C           WWPCL8    ANDLTWWCGSP
648200200529     C           P5CRU8    ORNE 0
648300200529     C           WWPCL9    ANDLTWWCGSP
648400200529     C           P5CRU9    ORNE 0
648500200529     C           WWPC10    ANDLTWWCGSP
648600200529     C           P5CR10    ORNE 0
648700200529     C           WWPC11    ANDLTWWCGSP
648800200529     C           P5CR11    ORNE 0
648900200529     C           WWPC12    ANDLTWWCGSP
649000200529     C           P5CR12    ORNE 0
649100200529     C           WWPC13    ANDLTWWCGSP
649200200529     C           P5CR13    ORNE 0
649300200529     C           WWPC14    ANDLTWWCGSP
649400200529     C           P5CR14    ORNE 0
649500200529     C           WWPC15    ANDLTWWCGSP
649600200529     C*********************MOVEL'PM11313' MSGID                           R00300
649700200529     C*********************CALL 'ZA0240'                                  R00300
649800200529     C*********************PARM           MSGID                           R00300
649900200529     C                     MOVEL'PM11313' ZAMSID                          R00300
650000200529     C                     EXSR ZASNMS                                    R00300
650100200529     C                     MOVE '1'       *IN80
650200200529     C                     MOVE '1'       *IN36
650300200529     C                     ELSE
650400200529     C                     Z-ADDWWCGSP    DDCGSH
650500200529     C                     END
650600200529     C**
650700200529     C                     END
650800200529     C**
650900200529     C                     END
651000200529     C                     END
651100200529     C**
651200200529     C                     END
651300200529     C**
651400200529     C                     ELSE
651500200529     C                     Z-ADD0         DDCGSH
651600200529     C                     END
651700200529     C**
651800200529     C**+++++++++++++++++++++++++++++++++++++++++++++++++++++
651900200529     C** VAL6DDCGSI   CHARGE SPREAD INDICATOR
652000200529     C**+++++++++++++++++++++++++++++++++++++++++++++++++++++
652100200529     C**
652200200529     C** CANNOT BE ENTERED IF CHARGE SPREAD NON ENTERED
652300200529     C**
652400200529     C           DDCGSI    IFNE *BLANKS
652500200529     C**
652600200529     C           DDCGSP    IFEQ *BLANKS
652700200529     C*********************MOVEL'PM11336' MSGID                           R00300
652800200529     C*********************CALL 'ZA0240'                                  R00300
652900200529     C*********************PARM           MSGID                           R00300
653000200529     C                     MOVEL'PM11336' ZAMSID                          R00300
653100200529     C                     EXSR ZASNMS                                    R00300
653200200529     C                     MOVE '1'       *IN80
653300200529     C                     MOVE '1'       *IN37
653400200529     C                     END
653500200529     C**
653600200529     C** IF ENTERED MUST BE '+' OR '-'
653700200529     C**
653800200529     C           DDCGSI    IFNE '+'
653900200529     C           DDCGSI    ANDNE'-'
654000200529     C*********************MOVEL'PM11315' MSGID                           R00300
654100200529     C*********************CALL 'ZA0240'                                  R00300
654200200529     C*********************PARM           MSGID                           R00300
654300200529     C                     MOVEL'PM11315' ZAMSID                          R00300
654400200529     C                     EXSR ZASNMS                                    R00300
654500200529     C                     MOVE '1'       *IN80
654600200529     C                     MOVE '1'       *IN37
654700200529     C                     END
654800200529     C**
654900200529     C                     ELSE
655000200529     C**
655100200529     C** MUST BE ENTERED IF CHARGE SPREAD SPECIFIED
655200200529     C**
655300200529     C           DDCGSP    IFNE *BLANKS
655400200529     C*********************MOVEL'PM11314' MSGID                           R00300
655500200529     C*********************CALL 'ZA0240'                                  R00300
655600200529     C*********************PARM           MSGID                           R00300
655700200529     C                     MOVEL'PM11314' ZAMSID                          R00300
655800200529     C                     EXSR ZASNMS                                    R00300
655900200529     C                     MOVE '1'       *IN80
656000200529     C                     MOVE '1'       *IN37
656100200529     C                     END
656200200529     C**
656300200529     C                     END
656400200529     C**
656500200529     C**+++++++++++++++++++++++++++++++++++++++++++++++++++++
656600200529     C** VAL6DDCGEI     CHARGE EFFECTIVE INDICATOR
656700200529     C**+++++++++++++++++++++++++++++++++++++++++++++++++++++
656800200529     C**
656900200529     C           DDCGCO    IFNE *BLANKS
657000200529     C**
657100200529     C** MUST BE EQUAL TO 'C' OR 'N'
657200200529     C**
657300200529     C           DDCGEI    IFNE 'C'
657400200529     C           DDCGEI    ANDNE'N'
657500200529     C*********************MOVEL'PM11316' MSGID                           R00300
657600200529     C*********************CALL 'ZA0240'                                  R00300
657700200529     C*********************PARM           MSGID                           R00300
657800200529     C                     MOVEL'PM11316' ZAMSID                          R00300
657900200529     C                     EXSR ZASNMS                                    R00300
658000200529     C                     MOVE '1'       *IN80
658100200529     C                     MOVE '1'       *IN38
658200200529     C                     END
658300200529     C**
658400200529     C                     END
658500200529     C**
658600200529     C**+++++++++++++++++++++++++++++++++++++++++++++++++++++
658700200529     C** VAL6DDCGFQ     CHARGE FREQUENCY
658800200529     C**+++++++++++++++++++++++++++++++++++++++++++++++++++++
658900200529     C**
659000200529     C                     MOVE 'Y'       WWCGFQ  1
659100200529     C           DDCGFQ    IFEQ *BLANKS
659200200529     C**
659300200529     C** MUST BE ENTERED IF CHARGE CODE SPECIFIED
659400200529     C**
659500200529     C           DDCGCO    IFNE *BLANKS
659600200529     C*********************MOVEL'PM11317' MSGID                           R00300
659700200529     C*********************CALL 'ZA0240'                                  R00300
659800200529     C*********************PARM           MSGID                           R00300
659900200529     C                     MOVEL'PM11317' ZAMSID                          R00300
660000200529     C                     EXSR ZASNMS                                    R00300
660100200529     C                     MOVE '1'       *IN80
660200200529     C                     MOVE '1'       *IN39
660300200529     C                     END
660400200529     C********
660500200529     C***ONCE PRESENT ON PF/PMCHRGXX FOR THIS CHARGE SEQUENCE,THIS FIELD
660600200529     C***CANNOT BE SET TO BLANK
660700200529     C********
660800200529     C********   DDCGFH    IFNE *BLANKS
660900200529     C********             MOVE 'N'       WWCGFQ
661000200529     C********             MOVEL'PM11320' MSGID
661100200529     C********             CALL 'ZA0240'
661200200529     C********             PARM           MSGID
661300200529     C********             MOVE '1'       *IN80
661400200529     C********             MOVE '1'       *IN39
661500200529     C********             MOVELDDCGFH    DDCGFQ
661600200529     C********             END
661700200529     C                     ELSE
661800200529     C**
661900200529     C** IF ENTERED MUST BE 'W', 'F', 'M', 'Q', 'X' OR 'Y'
662000200529     C**
662100200529     C           DDCGFQ    IFNE 'W'
662200200529     C           DDCGFQ    ANDNE'F'
662300200529     C           DDCGFQ    ANDNE'M'
662400200529     C           DDCGFQ    ANDNE'Q'
662500200529     C           DDCGFQ    ANDNE'X'
662600200529     C           DDCGFQ    ANDNE'Y'
662700200529     C                     MOVE 'N'       WWCGFQ
662800200529     C*********************MOVEL'PM11318' MSGID                           R00300
662900200529     C*********************CALL 'ZA0240'                                  R00300
663000200529     C*********************PARM           MSGID                           R00300
663100200529     C                     MOVEL'PM11318' ZAMSID                          R00300
663200200529     C                     EXSR ZASNMS                                    R00300
663300200529     C                     MOVE '1'       *IN80
663400200529     C                     MOVE '1'       *IN39
663500200529     C                     END
663600200529     C**
663700200529     C** IF ENTERED AS 'M', 'Q', 'X' OR 'Y' CHARGE DAY IN MONTH
663800200529     C** MUST ALSO BE SPECIFIED
663900200529     C**
664000200529     C           DDCGDY    IFEQ *BLANKS
664100200529     C           DDCGFQ    IFEQ 'M'
664200200529     C           DDCGFQ    OREQ 'Q'
664300200529     C           DDCGFQ    OREQ 'X'
664400200529     C           DDCGFQ    OREQ 'Y'
664500200529     C                     MOVE 'N'       WWCGFQ
664600200529     C*********************MOVEL'PM11319' MSGID                           R00300
664700200529     C*********************CALL 'ZA0240'                                  R00300
664800200529     C*********************PARM           MSGID                           R00300
664900200529     C                     MOVEL'PM11319' ZAMSID                          R00300
665000200529     C                     EXSR ZASNMS                                    R00300
665100200529     C                     MOVE '1'       *IN80
665200200529     C                     MOVE '1'       *IN40
665300200529     C                     END
665400200529     C                     END
665500200529     C                     END
665600200529     C**+++++++++++++++++++++++++++++++++++++++++++++++++++++
665700200529     C** VAL6DDCGDY      CHARGE DAY IN MONTH
665800200529     C**+++++++++++++++++++++++++++++++++++++++++++++++++++++
665900200529     C**
666000200529     C                     MOVE 'Y'       WWCGDV  1
666100200529     C           DDCGDY    IFNE *BLANKS
666200200529     C**
666300200529     C** IF ENTERED CHARGE FREQUENCY MUST BE 'M', 'Q', 'X' OR 'Y'
666400200529     C**
666500200529     C           DDCGFQ    IFNE 'M'
666600200529     C           DDCGFQ    ANDNE'Q'
666700200529     C           DDCGFQ    ANDNE'X'
666800200529     C           DDCGFQ    ANDNE'Y'
666900200529     C                     MOVE 'N'       WWCGDV
667000200529     C*********************MOVEL'PM11321' MSGID                           R00300
667100200529     C*********************CALL 'ZA0240'                                  R00300
667200200529     C*********************PARM           MSGID                           R00300
667300200529     C                     MOVEL'PM11321' ZAMSID                          R00300
667400200529     C                     EXSR ZASNMS                                    R00300
667500200529     C                     MOVE '1'       *IN80
667600200529     C                     MOVE '1'       *IN40
667700200529     C                     END
667800200529     C**
667900200529     C** IF ENTERED MUST BE A NUMBER IN THE RANGE 1-31
668000200529     C**
668100200529     C                     MOVE DDCGDY    WWCGDY  20
668200200529     C                     MOVE WWCGDY    WWCCDY  2
668300200529     C           WWCCDY    IFNE DDCGDY
668400200529     C           WWCGDY    ORLT 1
668500200529     C           WWCGDY    ORGT 31
668600200529     C                     MOVE 'N'       WWCGDV
668700200529     C*********************MOVEL'PM11322' MSGID                           R00300
668800200529     C*********************CALL 'ZA0240'                                  R00300
668900200529     C*********************PARM           MSGID                           R00300
669000200529     C                     MOVEL'PM11322' ZAMSID                          R00300
669100200529     C                     EXSR ZASNMS                                    R00300
669200200529     C                     MOVE '1'       *IN80
669300200529     C                     MOVE '1'       *IN40
669400200529     C                     END
669500200529     C                     END
669600200529     C**+++++++++++++++++++++++++++++++++++++++++++++++++++++
669700200529     C** VAL6DDCGND       NEXT ACCRUAL DATE
669800200529     C**+++++++++++++++++++++++++++++++++++++++++++++++++++++
669900200529     C**
670000200529     C** IF ENTERED MUST BE A VALID DATE
670100200529     C**
670200200529     C           DDCGND    IFNE *BLANKS                    - B1
670300200529     C**
670400200529     C                     Z-ADD0         WWDAT1
670500200529     C                     MOVE *BLANKS   WWDAT2
670600200529     C                     MOVE DDCGND    WWDAT1
670700200529     C                     MOVE WWDAT1    WWDAT2
670800200529     C**
670900200529     C                     MOVELDDCGND    ZDATE
671000200529     C                     EXSR ZDATE1
671100200529     C           *IN99     IFEQ '1'                        - B2
671200200529     C           DDCGND    ORNE WWDAT2
671300200529     C*********************MOVEL'PM11323' MSGID                           R00300
671400200529     C*********************CALL 'ZA0240'                                  R00300
671500200529     C*********************PARM           MSGID                           R00300
671600200529     C                     MOVEL'PM11323' ZAMSID                          R00300
671700200529     C                     EXSR ZASNMS                                    R00300
671800200529     C                     MOVE '1'       *IN80
671900200529     C                     MOVE '1'       *IN41
672000200529     C                     ELSE                            - X2
672100200529     C                     Z-ADDZDAYNO    WWCGND  50
672200200529     C                     END                             - E2
672300200529     C*
672400200529     C**
672500200529     C** IF ENTERED CANNOT BE BEFORE DATE PORTFOLIO OPENED
672600200529     C**
672700200529     C           WWCGND    IFLT BJRDNB                     - B2
672800200529     C*********************MOVEL'PM11324' MSGID                           R00300
672900200529     C*********************CALL 'ZA0240'                                  R00300
673000200529     C*********************PARM           MSGID                           R00300
673100200529     C                     MOVEL'PM11324' ZAMSID                          R00300
673200200529     C                     EXSR ZASNMS                                    R00300
673300200529     C                     MOVE '1'       *IN80
673400200529     C                     MOVE '1'       *IN41
673500200529     C                     ELSE                            - X2
673600200529     C                     Z-ADDWWCGND    DDCGNH
673700200529     C                     END                             - E2
673800200529     C**
673900200529     C                     ELSE                            - X1
674000200529     C**
674100200529     C** IF NEXT ACCRUAL DATE NOT ENTERED GENERATE IT FROM DETAILS ENTERED
674200200529     C**
674300200529     C           WWCGDV    IFEQ 'Y'
674400200529     C           WWCGFQ    ANDEQ'Y'
674500200529     C                     Z-ADDBJRDNB    ZDAYNO
674600200529     C                     MOVELDDCGFQ    ZFREQ
674700200529     C                     MOVELDDCGDY    ZMDAY
674800200529     C                     MOVELBJCYCD    ZCCY
674900200529     C                     EXSR ZFRQA
675000200529     C                     Z-ADDZDAYNO    WWCGND
675100200529     C                     Z-ADDZDAYNO    DDCGNH
675200200529     C                     END
675300200529     C*
675400200529     C** IF NEXT ACCRUAL DATE DAY IN MONTH SAME AS TODAYS DATE DEFAULT
675500200529     C** NEXT ACCRUAL DATE TO RUN DATE
675600200529     C*
675700200529     C                     MOVELBJMRDT    WWDAY   20
675800200529     C           WWCGDY    IFEQ WWDAY
675900200529     C           DDCGDY    OREQ *BLANKS
676000200529     C           DDCGFQ    ANDEQ'W'
676100200529     C                     Z-ADDBJRDNB    WWCGND
676200200529     C                     Z-ADDWWCGND    DDCGNH
676300200529     C                     END
676400200529     C                     END
676500200529     C**+++++++++++++++++++++++++++++++++++++++++++++++++++++
676600200529     C** VAL6DDCGST        CHARGE STOPPED
676700200529     C**+++++++++++++++++++++++++++++++++++++++++++++++++++++
676800200529     C*
676900200529     C** DEFAULT CHARGE STOPPED INDICATOR TO 'N'
677000200529     C*
677100200529     C           DDCGST    IFEQ *BLANK
677200200529     C                     MOVE 'N'       DDCGST
677300200529     C                     END
677400200529     C**
677500200529     C** IF ENTERED MUST BE 'Y' OR 'N'
677600200529     C**
677700200529     C           DDCGST    IFNE 'Y'
677800200529     C           DDCGST    ANDNE'N'
677900200529     C*********************MOVEL'PM11325' MSGID                           R00300
678000200529     C*********************CALL 'ZA0240'                                  R00300
678100200529     C*********************PARM           MSGID                           R00300
678200200529     C                     MOVEL'PM11325' ZAMSID                          R00300
678300200529     C                     EXSR ZASNMS                                    R00300
678400200529     C                     MOVE '1'       *IN80
678500200529     C                     MOVE '1'       *IN42
678600200529     C                     END
678700200529     C**+++++++++++++++++++++++++++++++++++++++++++++++++++++
678800200529     C** VAL6DDCSFQ        CHARGE SETTLEMENT FREQUENCY
678900200529     C**+++++++++++++++++++++++++++++++++++++++++++++++++++++
679000200529     C**
679100200529     C                     MOVE 'Y'       WWCSFQ  1
679200200529     C           DDCSFQ    IFEQ *BLANKS
679300200529     C**
679400200529     C** MUST BE ENTERED IF CHARGE FREQUENCY HAS BEEN SPECIFIED
679500200529     C**
679600200529     C           DDCGCO    IFNE *BLANKS
679700200529     C                     MOVE 'N'       WWCSFQ
679800200529     C*********************MOVEL'PM11328' MSGID                           R00300
679900200529     C*********************CALL 'ZA0240'                                  R00300
680000200529     C*********************PARM           MSGID                           R00300
680100200529     C                     MOVEL'PM11328' ZAMSID                          R00300
680200200529     C                     EXSR ZASNMS                                    R00300
680300200529     C                     MOVE '1'       *IN80
680400200529     C                     MOVE '1'       *IN43
680500200529     C                     END
680600200529     C*******
680700200529     C***ONCE PRESENT ON PF/PMCHRGXX FOR THIS CHARGE SEQUENCE,THIS FIELD
680800200529     C***CANNOT BE SET TO BLANK
680900200529     C*******
681000200529     C*******    DDCSFH    IFNE *BLANKS
681100200529     C*******              MOVE 'N'       WWCSFQ
681200200529     C*******              MOVEL'PM11329' MSGID
681300200529     C*******              CALL 'ZA0240'
681400200529     C*******              PARM           MSGID
681500200529     C*******              MOVE '1'       *IN80
681600200529     C*******              MOVE '1'       *IN43
681700200529     C*******              MOVELDDCSFH    DDCSFQ
681800200529     C*******              END
681900200529     C**
682000200529     C                     ELSE
682100200529     C**
682200200529     C** IF ENTERED MUST BE  'M', 'Q', 'X' OR 'Y'
682300200529     C**
682400200529     C           DDCSFQ    IFNE 'M'
682500200529     C           DDCSFQ    ANDNE'Q'
682600200529     C           DDCSFQ    ANDNE'X'
682700200529     C           DDCSFQ    ANDNE'Y'
682800200529     C                     MOVE 'N'       WWCSFQ
682900200529     C*********************MOVEL'PM11327' MSGID                           R00300
683000200529     C*********************CALL 'ZA0240'                                  R00300
683100200529     C*********************PARM           MSGID                           R00300
683200200529     C                     MOVEL'PM11327' ZAMSID                          R00300
683300200529     C                     EXSR ZASNMS                                    R00300
683400200529     C                     MOVE '1'       *IN80
683500200529     C                     MOVE '1'       *IN43
683600200529     C                     END
683700200529     C**
683800200529     C** IF ENTERED CHARGE SETTLEMENT DAY MUST ALSO BE SPECIFIED
683900200529     C**
684000200529     C           DDCSDY    IFEQ *BLANKS
684100200529     C                     MOVE 'N'       WWCSFQ
684200200529     C*********************MOVEL'PM11326' MSGID                           R00300
684300200529     C*********************CALL 'ZA0240'                                  R00300
684400200529     C*********************PARM           MSGID                           R00300
684500200529     C                     MOVEL'PM11326' ZAMSID                          R00300
684600200529     C                     EXSR ZASNMS                                    R00300
684700200529     C                     MOVE '1'       *IN80
684800200529     C                     MOVE '1'       *IN44
684900200529     C                     END
685000200529     C**
685100200529     C** ACCRUALS MUST OCCUR AS FREQUENTLY OR MORE FREQUENTLY
685200200529     C** THAN SETTLEMENTS
685300200529     C**
685400200529     C           DDCGFQ    IFEQ 'Q'
685500200529     C           DDCSFQ    ANDNE'Q'
685600200529     C           DDCSFQ    ANDNE'X'
685700200529     C           DDCSFQ    ANDNE'Y'
685800200529     C                     MOVE 'N'       WWCSFQ
685900200529     C*********************MOVEL'PM11330' MSGID                           R00300
686000200529     C*********************CALL 'ZA0240'                                  R00300
686100200529     C*********************PARM           MSGID                           R00300
686200200529     C                     MOVEL'PM11330' ZAMSID                          R00300
686300200529     C                     EXSR ZASNMS                                    R00300
686400200529     C                     MOVE '1'       *IN80
686500200529     C                     MOVE '1'       *IN43
686600200529     C                     END
686700200529     C**
686800200529     C           DDCSFQ    IFEQ 'X'
686900200529     C           DDCSFQ    ANDNE'X'
687000200529     C           DDCSFQ    ANDNE'Y'
687100200529     C                     MOVE 'N'       WWCSFQ
687200200529     C*********************MOVEL'PM11330' MSGID                           R00300
687300200529     C*********************CALL 'ZA0240'                                  R00300
687400200529     C*********************PARM           MSGID                           R00300
687500200529     C                     MOVEL'PM11330' ZAMSID                          R00300
687600200529     C                     EXSR ZASNMS                                    R00300
687700200529     C                     MOVE '1'       *IN80
687800200529     C                     MOVE '1'       *IN43
687900200529     C                     END
688000200529     C**
688100200529     C           DDCSFQ    IFEQ 'Y'
688200200529     C           DDCSFQ    ANDNE'Y'
688300200529     C                     MOVE 'N'       WWCSFQ
688400200529     C*********************MOVEL'PM11330' MSGID                           R00300
688500200529     C*********************CALL 'ZA0240'                                  R00300
688600200529     C*********************PARM           MSGID                           R00300
688700200529     C                     MOVEL'PM11330' ZAMSID                          R00300
688800200529     C                     EXSR ZASNMS                                    R00300
688900200529     C                     MOVE '1'       *IN80
689000200529     C                     MOVE '1'       *IN43
689100200529     C                     END
689200200529     C**
689300200529     C                     END
689400200529     C**+++++++++++++++++++++++++++++++++++++++++++++++++++++
689500200529     C** VAL6DDCSDY     CHARGE SETTLEMENT DAY IN MONTH
689600200529     C**+++++++++++++++++++++++++++++++++++++++++++++++++++++
689700200529     C**
689800200529     C                     MOVE 'Y'       WWCSDV  1
689900200529     C           DDCSDY    IFNE *BLANKS
690000200529     C**
690100200529     C** IF ENTERED CHARGE SETTLEMENT FREQUENCY MUST ALSO BE
690200200529     C** SPECIFIED
690300200529     C**
690400200529     C           DDCSFQ    IFEQ *BLANKS
690500200529     C                     MOVE 'N'       WWCSDV
690600200529     C*********************MOVEL'PM11331' MSGID                           R00300
690700200529     C*********************CALL 'ZA0240'                                  R00300
690800200529     C*********************PARM           MSGID                           R00300
690900200529     C                     MOVEL'PM11331' ZAMSID                          R00300
691000200529     C                     EXSR ZASNMS                                    R00300
691100200529     C                     MOVE '1'       *IN80
691200200529     C                     MOVE '1'       *IN43
691300200529     C                     END
691400200529     C**
691500200529     C** IF ENTERED MUST BE A NUMBER IN THE RANGE 1-31
691600200529     C**
691700200529     C                     MOVE DDCSDY    WWCSDY  20
691800200529     C                     MOVE WWCSDY    WWSSDY  2
691900200529     C           WWSSDY    IFNE DDCSDY
692000200529     C           WWCSDY    ORLT 1
692100200529     C           WWCSDY    ORGT 31
692200200529     C                     MOVE 'N'       WWCSDV
692300200529     C*********************MOVEL'PM11332' MSGID                           R00300
692400200529     C*********************CALL 'ZA0240'                                  R00300
692500200529     C*********************PARM           MSGID                           R00300
692600200529     C                     MOVEL'PM11332' ZAMSID                          R00300
692700200529     C                     EXSR ZASNMS                                    R00300
692800200529     C                     MOVE '1'       *IN80
692900200529     C                     MOVE '1'       *IN44
693000200529     C                     END
693100200529     C                     END
693200200529     C**+++++++++++++++++++++++++++++++++++++++++++++++++++++
693300200529     C** VAL6DDCSND      NEXT SETTLEMENT DATE
693400200529     C**+++++++++++++++++++++++++++++++++++++++++++++++++++++
693500200529     C**
693600200529     C**
693700200529     C** IF ENTERED MUST BE A VALID DATE
693800200529     C**
693900200529     C           DDCSND    IFNE *BLANKS
694000200529     C**
694100200529     C                     Z-ADD0         WWDAT1
694200200529     C                     MOVE *BLANKS   WWDAT2
694300200529     C                     MOVE DDCSND    WWDAT1
694400200529     C                     MOVE WWDAT1    WWDAT2
694500200529     C**
694600200529     C                     MOVELDDCSND    ZDATE
694700200529     C                     EXSR ZDATE1
694800200529     C           *IN99     IFEQ '1'
694900200529     C           DDCSND    ORNE WWDAT2
695000200529     C*********************MOVEL'PM11333' MSGID                           R00300
695100200529     C*********************CALL 'ZA0240'                                  R00300
695200200529     C*********************PARM           MSGID                           R00300
695300200529     C                     MOVEL'PM11333' ZAMSID                          R00300
695400200529     C                     EXSR ZASNMS                                    R00300
695500200529     C                     MOVE '1'       *IN80
695600200529     C                     MOVE '1'       *IN45
695700200529     C                     ELSE
695800200529     C                     Z-ADDZDAYNO    WWCSND  50
695900200529     C                     END
696000200529     C*
696100200529     C**
696200200529     C** IF ENTERED CANNOT BE BEFORE DATE PORTFOLIO OPENED
696300200529     C**
696400200529     C           WWCSND    IFLT BJRDNB
696500200529     C*********************MOVEL'PM11334' MSGID                           R00300
696600200529     C*********************CALL 'ZA0240'                                  R00300
696700200529     C*********************PARM           MSGID                           R00300
696800200529     C                     MOVEL'PM11334' ZAMSID                          R00300
696900200529     C                     EXSR ZASNMS                                    R00300
697000200529     C                     MOVE '1'       *IN80
697100200529     C                     MOVE '1'       *IN45
697200200529     C                     ELSE
697300200529     C                     Z-ADDWWCSND    DDCSNH
697400200529     C                     END
697500200529     C**
697600200529     C                     ELSE
697700200529     C**
697800200529     C** IF NEXT SETTLEMENT DATE NOT ENTERED GENERATE IT FROM DETAILS ENTERED
697900200529     C**
698000200529     C           WWCSFQ    IFEQ 'Y'
698100200529     C           WWCSDV    ANDEQ'Y'
698200200529     C                     Z-ADDBJRDNB    ZDAYNO
698300200529     C                     MOVELDDCSFQ    ZFREQ
698400200529     C                     MOVELDDCSDY    ZMDAY
698500200529     C                     MOVELBJCYCD    ZCCY
698600200529     C                     EXSR ZFRQA
698700200529     C                     Z-ADDZDAYNO    WWCSND
698800200529     C                     Z-ADDZDAYNO    DDCSNH
698900200529     C                     END
699000200529     C*
699100200529     C** IF NEXT SETLEMENT DAY IN MONTH SAME AS TODAYS DATE DEFAULT
699200200529     C** NEXT ACCRUAL DATE TO RUN DATE
699300200529     C*
699400200529     C                     MOVELBJMRDT    WWDAY   20
699500200529     C           WWCSDY    IFEQ WWDAY
699600200529     C                     Z-ADDBJRDNB    WWCSND
699700200529     C                     Z-ADDBJRDNB    DDCSNH
699800200529     C                     END
699900200529     C                     END
700000200529     C**+++++++++++++++++++++++++++++++++++++++++++++++++++++             S01486
700100200529     C** VAL6DDPRFC       PROFIT CENTRE                                   S01486
700200200529     C**+++++++++++++++++++++++++++++++++++++++++++++++++++++             S01486
700300200529     C**                                                                  S01486
700400200529     C           DDPRFC    IFNE *BLANKS                                   S01486
700500200529     C           BGN0ST    OREQ 'Y'                                       120827
700600200529     C**                                                                  S01486
700700200529     C** IF ENTERED MUST BE A VALID PROFIT CENTRE                         S01486
700800200529     C**                                                                  S01486
700900200529     C                     CALL 'AOPRFCR0'                                S01486
701000200529     C                     PARM *BLANKS   WWRTCD                          S01486
701100200529     C                     PARM '*KEY   ' WWOPTN                          S01486
701200200529     C                     PARM DDPRFC    WWKEY4  4                       S01486
701300200529     C           SDPRFC    PARM SDPRFC    DSFDY                           S01486
701400200529     C           WWRTCD    IFNE *BLANKS                                   S01486
701500200529     C                     MOVEL'PM14206' ZAMSID                          S01486
701600200529     C                     EXSR ZASNMS                                    S01486
701700200529     C                     MOVE '1'       *IN54                           S01486
701800200529     C                     MOVE '1'       *IN80                           S01486
701900200529     C                     ELSE                                           S01486
702000200529     C                     MOVELWWKEY4    DDPRFC                          S01486
702100200529     C                     END                                            S01486
702200200529     C                     ELSE                                           S01486
702300200529     C           EPRFC     IFEQ '2'                                       120827
702400200529     C                     MOVEL'PM14206' ZAMSID                          120827
702500200529     C                     EXSR ZASNMS                                    120827
702600200529     C                     MOVE '1'       *IN54                           120827
702700200529     C                     MOVE '1'       *IN80                           120827
702800200529     C                     ELSE                                           120827
702900200529     C** SET DEFAULT IF ANY OTHER DETAILS ENTERED                         S01486
703000200529     C           DDCGCO    IFNE *BLANKS                                   080674
703100200529     C           BKPRCU    ANDEQ'Y'                                       080674
703200200529     C*                                                                   CAC003
703300200529     C** Additional condition to enable profit centre defaulting          CAC003
703400200529     C** only when Analytical Accounting and CAC003 are not               CAC003
703500200529     C** available.                                                       CAC003
703600200529     C           *IN87     ANDEQ'0'                                       CAC003
703700200529     C                     MOVELWWPRFC    DDPRFC                          S01486
703800200529     C                     MOVEL'PM14205' ZAMSID                          S01486
703900200529     C                     EXSR ZASNMS                                    S01486
704000200529     C                     MOVE '1'       *IN54                           S01486
704100200529     C                     MOVE '1'       *IN80                           S01486
704200200529     C                     END                                            080674
704300200529     C                     END                                            120827
704400200529     C                     END                                            S01486
704500200529     C*
704600200529     C** IF ALL DETAILS OTHER THAN CHARGE STOPPED ARE SET TO BLANK
704700200529     C** RESET CHARGE STOPPED TO BLANK
704800200529     C*
704900200529     C           DDCGCO    IFEQ *BLANKS
705000200529     C           DDCGSP    ANDEQ*BLANKS
705100200529     C           DDCGSI    ANDEQ*BLANKS
705200200529     C           DDCGEI    ANDEQ*BLANKS
705300200529     C           DDCGFQ    ANDEQ*BLANKS
705400200529     C           DDCGDY    ANDEQ*BLANKS
705500200529     C           DDCGND    ANDEQ*BLANKS
705600200529     C           DDCSFQ    ANDEQ*BLANKS
705700200529     C           DDCSDY    ANDEQ*BLANKS
705800200529     C           DDCSND    ANDEQ*BLANKS
705900200529     C           DDPRFC    ANDEQ*BLANKS                                   S01486
706000200529     C                     MOVE *BLANKS   DDCGST
706100200529     C                     END
706200200529     C**
706300200529     C** UPDATE RECORD OF SUBFILE
706400200529     C**
706500200529     C                     UPDATPM0110S1
706600200529     C**
706700200529     C                     END
706800200529     C**
706900200529     C***********          ADD  1         X                               S01486
707000200529     C                     ADD  1         Z                               S01486
707100200529     C*
707200200529     C                     END
707300200529     C*
707400200529     C**  BANK CHARGE CCY MAY NOT BE ENTERED IF NO CHARGE CODES DEFINED
707500200529     C*
707600200529     C                     MOVE 'N'       WWCGCF  1
707700200529     C           1         DO   10        Y       30
707800200529     C           CG,Y      IFNE *BLANKS
707900200529     C                     MOVE 'Y'       WWCGCF
708000200529     C                     END
708100200529     C                     END
708200200529     C**
708300200529     C           WWCGCF    IFEQ 'N'
708400200529     C           DDBCDF    IFEQ 'N'
708500200529     C*********************MOVEL'PM11339' MSGID                           R00300
708600200529     C*********************CALL 'ZA0240'                                  R00300
708700200529     C*********************PARM           MSGID                           R00300
708800200529     C                     MOVEL'PM11339' ZAMSID                          R00300
708900200529     C                     EXSR ZASNMS                                    R00300
709000200529     C                     MOVE '1'       *IN80
709100200529     C                     MOVE '1'       *IN32
709200200529     C                     ELSE
709300200529     C*
709400200529     C                     MOVE *BLANKS   DDBCGY
709500200529     C                     Z-ADD0         WWBCGY
709600200529     C                     END
709700200529     C                     END
709800200529     C*
709900200529     C**  CUSTOMER SETTLE CCY MAY NOT BE ENTERED IF NO CHARGE CODES DEFINED
710000200529     C*
710100200529     C**
710200200529     C           WWCGCF    IFEQ 'N'
710300200529     C           DDCSDF    IFEQ 'N'
710400200529     C*********************MOVEL'PM11402' MSGID                           R00300
710500200529     C*********************CALL 'ZA0240'                                  R00300
710600200529     C*********************PARM           MSGID                           R00300
710700200529     C*                    MOVEL'PM11402' ZAMSID                    R00300R5500
710800200529     C*                    EXSR ZASNMS                              R00300R5500
710900200529     C*                    MOVE '1'       *IN80                           R5500
711000200529     C*                    MOVE '1'       *IN33                           R5500
711100200529     C                     ELSE
711200200529     C*
711300200529     C                     MOVE *BLANKS   DDCSCY
711400200529     C                     Z-ADD0         WWCSCY
711500200529     C                     END
711600200529     C                     END
711700200529     C*
711800200529     C**  CUSTOMER SETTLE A/C MAY NOT BE ENTERED IF NO CHARGE CODES DEFINED
711900200529     C*
712000200529     C**         WWCGCF    IFEQ 'N'                                       B5862
712100200529     C**         DDCUSA    IFNE *BLANKS                                   B5862
712200200529     C*********************MOVEL'PM11403' MSGID                           R00300
712300200529     C*********************CALL 'ZA0240'                                  R00300
712400200529     C*********************PARM           MSGID                           R00300
712500200529     C**                   MOVEL'PM11403' ZAMSID                    R00300B5862
712600200529     C**                   EXSR ZASNMS                              R00300B5862
712700200529     C**                   MOVE '1'       *IN80                           B5862
712800200529     C**                   MOVE '1'       *IN34                           B5862
712900200529     C**                   Z-ADD0         WWCUSB                          B5862
713000200529     C**                   END                                            B5862
713100200529     C**                   END                                            B5862
713200200529     C*
713300200529     C                     ENDSR
713400200529     C**************************************************************************
713500200529      /EJECT                                                              R00367
713600200529      ******************************************************************* R00367
713700200529      *                                                                 * R00367
713800200529      * TESTRI   - TEST BIT SETTINGS FOR RETAIL INDICATORS FOR ACCOUNT  * R00367
713900200529      *            USED FOR CUSTOMER CHARGES                            * R00367
714000200529      *                                                                 * R00367
714100200529      ******************************************************************* R00367
714200200529      *                                                                   R00367
714300200529     C           TESTRI    BEGSR                                          R00367
714400200529     C*                                                                   R00367
714500200529     C                     MOVE '0'       *IN66                           R00367
714600200529     C******************** TESTB'0123'    RETB       66            R0974  R00367
714700200529     C                     TESTB'23'      RETB       66                   R0974
714800200529     C*                                                                   R00367
714900200529     C                     ENDSR                                          R00367
715000200529      ********************************************************************R00367
715100200529      /EJECT
715200200529      **************************************************************************
715300200529      *                                                                        *
715400200529      * #CBB     - TO PROCESS UPDATE BY ANOTHER WORKSTATION                    *
715500200529      *                                                                        *
715600200529      * SUBROUTINE CALLS:                                                      *
715700200529      *********ZA0240   - TO ACCESS MESSAGE FILE AND SEND MESSAGE         R00300
715800200529      * ZASNMS   - WRITE ERROR MESSAGES                                   R00300
715900200529      *                                                                        *
716000200529      * SUBROUTINE CALLED FROM:                                                *
716100200529      * #P1008   - TO UPDATE PORTFOLIO DEFINITION FILE                         *
716200200529      * #P1009   - TO UPDATE PORTFOLIO CHARGES DETAILS FILE                    *
716300200529      *                                                                        *
716400200529      *                                                                        *
716500200529      **************************************************************************
716600200529     C           #CBB      BEGSR                           ** #CBB   BSR**
716700200529     C**
716800200529     C                     MOVE '0'       *IN11
716900200529     C                     MOVE '0'       *IN12
717000200529     C                     MOVE '1'       *IN10
717100200529     C                     MOVE '1'       *IN80
717200200529     C                     MOVE '1'       *IN89
717300200529     C*********************MOVEL'PM11400' MSGID                           R00300
717400200529     C*********************CALL 'ZA0240'                                  R00300
717500200529     C*********************PARM           MSGID                           R00300
717600200529     C                     MOVEL'PM11400' ZAMSID                          R00300
717700200529     C                     EXSR ZASNMS                                    R00300
717800200529     C                     ROLBK
717900200529     C**
718000200529     C                     ENDSR
718100200529     C**************************************************************************
718200200529      /EJECT
718300200529     C*****************************************************************   R00300
718400200529     C*                                                               *   R00300
718500200529     C* ZASNMS   - Send message to program message queue              *   R00300
718600200529     C*                                                               *   R00300
718700200529     C* CALLS    Y2SNMSGC                                             *   R00300
718800200529     C*                                                               *   R00300
718900200529     C* CALLED BY  #ZBAB  - Validate key fields from start screen.    *   R00300
719000200529     C*            #ZBAC  - Validate key fields from Review screen.   *   R00300
719100200529     C*            #CUST  - Validate customer number/shortname.       *   R00300
719200200529     C*            #P1004 - Process detail screen and update files.   *   R00300
719300200529     C*            #V1004 - Validate portfolio definition details.    *   R00300
719400200529     C*            #V1005 - Validate portfolio closed.                *   R00300
719500200529     C*            #P1005 - To process portfolio charge details.      *   R00300
719600200529     C*            #V1006 - To validate portfolio charge details.     *   R00300
719700200529     C*            #CBB   - To process update by another workstation. *   R00300
719800200529     C*                                                               *   R00300
719900200529     C*****************************************************************   R00300
720000200529     C           ZASNMS    BEGSR                                          R00300
720100200529     C*                                                                   R00300
720200200529     C                     CALL 'Y2SNMGC'                                 R00300
720300200529     C                     PARM           ZAPGM            Program queue  R00300
720400200529     C                     PARM           ZAPGRL           Rel queue      R00300
720500200529     C                     PARM           ZAMSID           Message Id.    R00300
720600200529     C                     PARM           ZAMSGF           Message file.  R00300
720700200529     C                     PARM           ZAMSDA           Message data.  R00300
720800200529     C                     PARM           ZAMSTP           Message type.  R00300
720900200529     C*                                                                   R00300
721000200529     C** Clear all fields for default mechanism next time.                R00300
721100200529     C                     MOVEL*BLANK    ZAPGM            Message queue  R00300
721200200529     C                     MOVEL*BLANK    ZAPGRL           Rel queue      R00300
721300200529     C                     MOVEL*BLANK    ZAMSDA           Message data.  R00300
721400200529     C                     MOVEL*BLANK    ZAMSTP           Message type.  R00300
721500200529     C*                                                                   R00300
721600200529     C           ZASNM9    ENDSR                           ZASNM9 TAG     R00300
721700200529     C*                                                                   R00300
721800200529     C*****************************************************************   R00300
721900200529      /EJECT
722000200529      **************************************************************************
722100200529      *                                                                        *
722200200529      * *PSSR    - TO PROCESS ABNORMAL END OF PROGRAM                          *
722300200529      *                                                                        *
722400200529      * SUBROUTINE CALLS:                                                      *
722500200529      * #CLOF    - TO PROCESS CLOSE OF FILES IN LOWER LEVEL PROGRAMS           *
722600200529      *                                                                        *
722700200529      * SUBROUTINE CALLED FROM:                                                *
722800200529      * #P1001   - TO INITIALIZE FIELDS AND ACCESS STANDING DATA               *
722900200529      * #P1008   - TO UPDATE PORTFOLIO DEFINITION FILE                         *
723000200529      * #P1010   - TO UPDATE PORTFOLIO DEFINITION AUDIT                        *
723100200529      *                                                                        *
723200200529      *                                                                        *
723300200529      **************************************************************************
723400200529     C           *PSSR     BEGSR
723500200529     C*
723600200529     C** UPDATE LDA WITH ERROR INFORMATION
723700200529     C*
723800200529     C************NAMVAR   DEFN           LDA                             S01486
723900200529     C************LOCK     IN   LDA                                       S01486
724000200529     C***********          MOVELDBFILE    WWFILE                          S01486
724100200529     C***********          MOVELDBKEY     WWKEY                           S01486
724200200529     C***********          MOVELDBPGM     WWPGM                           S01486
724300200529     C***********          MOVELDBASE     WWASE                           S01486
724400200529     C***********          OUT  LDA                                       S01486
724500200529     C*
724600200529     C                     MOVE '1'       *INU7
724700200529     C                     MOVE '1'       *INU8
724800200529     C                     MOVE '1'       *INLR
724900200529     C**
725000200529     C** ROLL BACK CHANGES, PRINT DUMP AND CANCEL PROGRAM
725100200529     C**
725200200529     C                     ROLBK
725300200529     C                     DUMP
725400200529     C                     CALL 'DBERRCTL'                                S01486
725500200529     C**
725600200529     C                     RETRN
725700200529     C**
725800200529     C                     ENDSR
725900200529     C**
726000200529     C********************************************************************
726100200529     C/EJECT
726200200529      /COPY ZSRSRC,ZDATE1Z2
726300200529     C/EJECT
726400200529      /COPY ZSRSRC,ZDATE2Z2
726500200529      /EJECT
726600200529      /COPY ZSRSRC,ZEDITZ2
726700200529      /EJECT
726800200529      /COPY ZSRSRC,ZALIGNZ2
726900200529      /EJECT
727000200529      /COPY ZSRSRC,ZFRQAZ2
727100200529      /EJECT
727200200529      /COPY ZSRSRC,ZCHKH                                                  S01486
727300200529      /EJECT                                                              S01486
727400200529      /COPY ZSRSRC,ZACCH                                                  S01486
727500200529      /EJECT                                                              S01486
727600200529      ********************************************************************S01486
727700200529      *            PROFIT CENTRE PROCESSING                               S01486
727800200529      * #PFRC    - TO RETRIEVE PROFIT CENTRE DEFAULTS                     S01486
727900200529      *                                                                   S01486
728000200529      * SUBROUTINE CALLS:                                                 S01486
728100200529      *                                                                   S01486
728200200529      * SUBROUTINE CALLED FROM:                                           S01486
728300200529      * #TRANS   - TO FILL SCREEN DETAILS                                 S01486
728400200529      *                                                                   S01486
728500200529      * ROUTINE USES VARIABLES:                                           S01486
728600200529      *                                                                   S01486
728700200529      ********************************************************************S01486
728800200529     C           #PFRC     BEGSR                                          S01486
728900200529     C*                                                                   S01486
729000200529     C**   PROFIT CENTRE PROCESSING :                                     S01486
729100200529     C**   IF DEFAULT MATRIX IS REQUIRED          BKPCDU=Y                S01486
729200200529     C** CHECK IF DEFAULT MATRIX USED                                     S01486
729300200529     C           BKPCDU    IFEQ 'Y'                                       S01486
729400200529     C**  LOOK UP FOR CUSTOMER AND ACCOUNT OFFICER DETAILS                S01486
729500200529     C**                                                                  S01486
729600200529     C                     EXSR #CSAC                                     S01486
729700200529     C**                                                                  S01486
729800200529     C                     MOVE BBCUST    WWKEY6  6                       S01486
729900200529     C**                                                                  S01486
730000200529     C                     CALL 'AOPRFMR0'                                S01486
730100200529     C                     PARM           WWRTC1  1                       S01486
730200200529     C                     PARM '  '      WWBOOK  2                       S01486
730300200529     C                     PARM 'PM   '   WWTRTP  5                       S01486
730400200529     C                     PARM 'PM'      WWSUBT  2                       S01486
730500200529     C                     PARM BBBRCD    WWBRCA  3                       S01486
730600200529     C                     PARM WWDEPT    WWDEPA  3                       S01486
730700200529     C                     PARM USID      WWUSER 10                       S01486
730800200529     C                     PARM WWACOF    WWAOFR  2                       S01486
730900200529     C                     PARM WWKEY6    WWCLIE  6                       S01486
731000200529     C                     PARM '    '    WWPROF  4                       S01486
731100200529     C**                                                                  S01486
731200200529     C           WWRTC1    IFEQ '0'                                       S01486
731300200529     C** STORE DEFAULT PROFIT CENTRE                                      S01486
731400200529     C                     MOVELWWPROF    WWPRFC  4                       S01486
731500200529     C                     END                                            S01486
731600200529     C**                                                                  S01486
731700200529     C           WWRTC1    IFEQ '2'                                       120827
731800200529     C                     MOVE 'Y'       EPRFC   1                       120827
731900200529     C                     END                                            120827
732000200529      *                                                                   120827
732100200529     C                     END                                            S01486
732200200529     C*                                                                   S01486
732300200529     C                     ENDSR                                          S01486
732400200529      ********************************************************************S01486
732500200529      *            PROFIT CENTRE PROCESSING                               S01486
732600200529      * #CSAC    - TO RETRIEVE CUSTOMER AND ACCOUNT OFFICER DETAILS       S01486
732700200529      *                                                                   S01486
732800200529      * SUBROUTINE CALLS:                                                 S01486
732900200529      *                                                                   S01486
733000200529      * SUBROUTINE CALLED FROM:                                           S01486
733100200529      * #PFRC    - TO FILL SCREEN DETAILS                                 S01486
733200200529      *                                                                   S01486
733300200529      * ROUTINE USES VARIABLES:                                           S01486
733400200529      *                                                                   S01486
733500200529      ********************************************************************S01486
733600200529     C           #CSAC     BEGSR                                          S01486
733700200529     C*                                                                   S01486
733800200529     C** ACCESS CUSTOMER DETAILS                                          S01486
733900200529     C*                                                                   S01486
734000200529     C**                                                                  S01486
734100200529     C** CHECK IF SHORT NAME OR CUSTOMER NUMBER ENTERED                   S01486
734200200529     C**                                                                  S01486
734300200529     C                     MOVELDDCSNM    WWCNUM                          S01486
734400200529     C**********           TESTN          WWCNM1     83                                S01486 CSD027
734500200529     C           WWCNM2    IFEQ *BLANKS                    B2             S01486
734600200529     C********** *IN83     ANDEQ'1'                                                    S01486 CSD027
734700200529     C                     MOVEL'*CNUM  ' WWSORT  7                       S01486
734800200529     C                     ELSE                                           S01486
734900200529     C                     MOVEL'*CSHT  ' WWSORT                          S01486
735000200529     C                     END                                            S01486
735100200529     C                     MOVEL*BLANKS   WWCNUM                          S01486
735200200529     C**                                                                  S01486
735300200529     C                     MOVELDDCSNM    WWCSNM 10                       S01486
735400200529     C                     CALL 'AOCUSTR0'                                S01486
735500200529     C                     PARM '*MSG    'WWRTCD  7                       S01486
735600200529     C                     PARM '*KEY    'WWOPTN  7                       S01486
735700200529     C                     PARM WWCSNM    WWKY10 10                       S01486
735800200529     C                     PARM WWSORT    WWKE7   7                       S01486
735900200529     C           SDCUST    PARM SDCUST    DSSDY                           S01486
736000200529     C           WWRTCD    IFNE *BLANKS                                   S01486
736100200529     C           *LOCK     IN   LDA                                       S01486
736200200529     C                     Z-ADD4         DBASE                           S01486
736300200529     C                     MOVE 'SDCUSTPD'DBFILE                          S01486
736400200529     C                     MOVELDDCSNM    DBKEY                           S01486
736500200529     C                     OUT  LDA                                       S01486
736600200529     C                     EXSR *PSSR                                     S01486
736700200529     C                     END                                            S01486
736800200529     C*                                                                   S01486
736900200529     C                     MOVEL*BLANKS   WWACOF  2                       S01486
737000200529     C                     MOVEL*BLANKS   WWDEPT  3                       S01486
737100200529     C           BBACOC    IFNE *BLANKS                                   S01486
737200200529     C                     MOVELBBACOC    WWACOF                          S01486
737300200529     C*                                                                   S01486
737400200529     C** ACCESS ACCOUNT OFFICER DETAILS                                   S01486
737500200529     C*                                                                   S01486
737600200529     C                     CALL 'AOACOFR0'                                S01486
737700200529     C                     PARM '*MSG    'WWRTCD  7                       S01486
737800200529     C                     PARM '*KEY    'WWOPTN  7                       S01486
737900200529     C                     PARM BBACOC    WWKEY2  2                       S01486
738000200529     C           SDACOF    PARM SDACOF    DSSDY                           S01486
738100200529     C           WWRTCD    IFNE *BLANKS                                   S01486
738200200529     C           *LOCK     IN   LDA                                       S01486
738300200529     C                     Z-ADD5         DBASE                           S01486
738400200529     C                     MOVE 'SDACOFPD'DBFILE                          S01486
738500200529     C                     MOVELBBACOC    DBKEY                           S01486
738600200529     C                     OUT  LDA                                       S01486
738700200529     C                     EXSR *PSSR                                     S01486
738800200529     C                     END                                            S01486
738900200529     C                     MOVELAZDPCD    WWDEPT                          S01486
739000200529     C                     END                                            S01486
739100200529     C**                                                                  S01486
739200200529     C                     ENDSR                                          S01486
739300200529      **************************************************************************
739400200529      *                                                                        *
739500200529      * ZTNLU1   - TO LOCK AND ACCESS DATA AREA AND GET TRANSAC. NBR           *
739600200529      *                                                                        *
739700200529      * SUBROUTINE CALLS:                                                      *
739800200529      *                                                                        *
739900200529      * SUBROUTINE CALLED FROM:                                                *
740000200529      * #P1008   - TO UPDATE PORTFOLIO DEFINITION FILE                         *
740100200529      *                                                                        *
740200200529      *                                                                        *
740300200529      **************************************************************************
740400200529     C           ZTNLU1    BEGSR
740500200529     C**
740600200529     C           *NAMVAR   DEFN MNATN     DNATN
740700200529     C           *LOCK     IN   DNATN
740800200529     C                     MOVE FNATN     NATN    50
740900200529     C                     MOVE FNATN     ZZWK05  50
741000200529     C                     ADD  1         ZZWK05
741100200529     C                     MOVE ZZWK05    FNATN
741200200529     C                     OUT  DNATN
741300200529     C**
741400200529     C                     ENDSR
741500200529     C*================================================================
741600200529**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
7417002005290366073110961461
741800200529**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
741900200529000031059090120151181212243273304334365
742000200529**   ZMNM - MONTHS SHORT NAMES
742100200529JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
742200200529**   ZFMD  -  NUMBER OF DAYS IN THE MONTH
742300200529312831303130313130313031
742400200529** NUMA
742500200529ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789
742600200529** STAMP - Dummy timestamp                                                                    CPK015
7427002005290001-01-01-00.00.00.000000                                                                    CPK015
742800200529**  CPY@
742900200529(c) Finastra International Limited 2001
