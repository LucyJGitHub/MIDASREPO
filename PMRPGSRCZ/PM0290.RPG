     H        1                                                           S01486
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas PM Portfolio Details report')
     H***********                                                         S01486
     F*****************************************************************
     F*                                                               *
     F*  Midas - Portfolio Management Module                      *
     F*                                                               *
     F*  PM0290 - PORTFOLIO DETAILS REPORT                            *
     F*                                                               *
      *  (c) Misys International Banking Systems Ltd. 2001            *
     F*                                                               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *  Last Amend No. CRE026             Date 24May06               *
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *  Prev Amend No. CSD031             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 BUG3644            Date 12Jul04               *
      *                 CLE025             Date 20Oct03               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 CAC003             Date 25Feb97               *
      *                 CPM005             Date 03Jul96               *
     F*                 CPM003             Date 02May96               *
     F*                 S71062             Date 27Nov95               *
     F*                 085794             DATE 23FEB95               *
     F*                 081342             DATE 29DEC94               *
     F*                 S01486             DATE 22AUG94               *
     F*                 47335              DATE 18NOV92               *
     F*                 S01313             DATE 07MAY92               *
     F*                 R01155             DATE 12JAN91               *
     F*                 R00824             DATE 12DEC90               *
     F*                 S01307             DATE 08OCT90               *
     F*                                                               *
     F*---------------------------------------------------------------*
     F*                                                               *
      *  CRE026 - Consumer Banking                                    *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  BUG3644 - Serious Error in Collateralised Lending (Recompile)*
      *  CLE025 - Credit Lines (Recompile)                            *
     F*  CAC003 - Profit Centre Accounting Development Phase 3.       *
     F*  CPM005 - Private Banking Phase II                            *
     F*           Focus Group Changes Upgraded to DBA                 *
     F*           PBFG/5 - INSTRUMENT ASSET/LIABILITY SPLIT           *
     F*           PBFG/7 - NET COMMITMENT BY CURRENCY                 *
     F*           PBFG/8 - DISPLAY POSITIONS SPLIT BY CURRENCY        *
     F*  CPM003 - FF/PM Interface upgrade to Release 10               *
     F*  S71062 - FF/PM Portfolio Definition Maintenance              *
     F*           Add new field FF Margin A/c sequence.               *
     F*  085794 - If no records, do not write End of Report           *
     F*  081342 - Printer file not opened when level S.               *
     F*  S01486 - Portfolio Management Upgrade to R10                 *
     F*  47335  - INCORRECT TITLE OUTPUT ON REPORT                    *
     F*  S01313 - PORTFOLIO PERFORMANCE                               *
     F*  R01155 - IF BOTH MIN AND MAX RANGE 0 OUTPUT ONLY MAX RANGE   *
     F*  R00824 - IF MINIMUM RANGE 100% OUTPUT BLANK MAXIMUM RANGE    *
     F*  S01307 - CUSTODY FEES ENHANCEMENT                            *
     F*                                                               *
     F*****************************************************************
     F*                                                               *
     F*  C R E A T I O N     P A R A M E T E R S                      *
     F*                                                               *
     F*                                                               *
     F*****************************************************************
     F***PMACCUPOIF**E                    DISK         KINFSR *PSSR       S01486
     FPMACCUQ0IF  E                    DISK         KINFSR *PSSR          S01486
     F*      PREFIX PN, BB, & AZ
     F**
     F***PMPORTZZIF**E                    DISK         KINFSR *PSSR       S01486
     FPMPORTPAIF  E                    DISK         KINFSR *PSSR          S01486
     F*      PREFIX PN
     F***PMCHRGPPIF**E           K        DISK         KINFSR *PSSR       S01486
     FPMCHRGPDIF  E           K        DISK         KINFSR *PSSR          S01486
     F*      PREFIX PO
     F***PMBIPNPPIF**E           K        DISK         KINFSR *PSSR       S01486
     FPMBIPNPDIF  E           K        DISK         KINFSR *PSSR          S01486
     F*      PREFIX PS
     FPMCIIPLLIF  E           K        DISK         KINFSR *PSSR
     F*      PREFIX PY
     F***PMPGHIPPIF**E           K        DISK         KINFSR *PSSR       S01486
     FPMPGHIPDIF  E           K        DISK         KINFSR *PSSR          S01486
     F*      PREFIX PF
     F***SDPLINPDIF  E           K        DISK         KINFSR *PSSR       S01486
     F*******PREFIX PD                                                    S01486
     FPMCCIPLLIF  E           K        DISK         KINFSR *PSSR
     F*      PREFIX PZ
     F***PMPGHCPPIF**E           K        DISK         KINFSR *PSSR       S01486
     FPMPGHCPDIF  E           K        DISK         KINFSR *PSSR          S01486
     F*      PREFIX PH
     F***SDCURRL0IF**E           K        DISK         KINFSR *PSSR       S01486
     F*******PREFIX A6                                                    S01486
     FPMCRIPLLIF  E           K        DISK         KINFSR *PSSR
     F*      PREFIX P2
     F***PMPGHRPPIF**E           K        DISK         KINFSR *PSSR       S01486
     FPMPGHRPDIF  E           K        DISK         KINFSR *PSSR          S01486
     F*      PREFIX PJ
     F***SDCTRYL1IF**E           K        DISK         KINFSR *PSSR       S01486
     F*******PREFIX*A4                                                    S01486
     FPMCDIPLLIF  E           K        DISK         KINFSR *PSSR
     F*      PREFIX P1
     F***PMPGHDPPIF**E           K        DISK         KINFSR *PSSR       S01486
     FPMPGHDPDIF  E           K        DISK         KINFSR *PSSR          S01486
     F*      PREFIX PL
     F***SDINDSL1IF**E           K        DISK         KINFSR *PSSR       S01486
     F*******PREFIX AO                                                    S01486
     FPMBIIPLLIF  E           K        DISK         KINFSR *PSSR
     F*      PREFIX PT
     FPMBCIPLLIF  E           K        DISK         KINFSR *PSSR
     F*      PREFIX PU
     FPMBRIPLLIF  E           K        DISK         KINFSR *PSSR
     F*      PREFIX PX
     FPMBDIPLLIF  E           K        DISK         KINFSR *PSSR
     F*      PREFIX PW
     F**SDBANKL1IF  E                    DISK         KINFSR *PSSR        S01486
     F*******PREFIX BJ                                                    S01486
     F***PMCGCDPPIF  E           K        DISK         KINFSR *PSSR       S01486
     FPMCGCDPDIF  E           K        DISK         KINFSR *PSSR          S01486
     F*      PREFIX P5
     F**
     F/COPY WNCPYSRC,PM0290F001
     F***PM0290P1O***E             70     PRINTER                       UCS01486
     F***PM0290AUO***E                    PRINTER                         S01486
     FPM0290P1O   E             70     PRINTER      KINFDS SPOOL      UC  S01486
     FPM0290AUO   E                    PRINTER      KINFDS SPOOLU         S01486
     F**
     F*==================================================================
     F**                FUNCTION OF INDICATORS
     F**
     F**  20      - MODULE FF ON                                          S71062
     F****21******- ACCESS PMPORTZZ                                       S01486
     F**  21      - ACCESS PMPORTPA                                       S01486
     F**  22      - ACCESS PMBIIPLL
     F**  23      - ACCESS PMBCIPLL
     F**  24      - ACCESS PMBRIPLL
     F**  25      - ACCESS PMBDIPLL
     F**
     F**  27      - SYSTEM LEVEL INDICATOR                                S01486
     F**  28      - DEPARTMENT LEVEL INDICATOR                            S01486
     F**  29      - ACCOUNT OFFICER INDICATOR                             S01486
     F**                                                                  S01486
     F**  39      - OUTPUT 'PORTFOLIO CLOSED' TEXT
     F**  40      - OUTPUT HEADING WHEN NO DETAILS TO REPORT
     F**  41      - INPUT PARAMETER 'MODE' IS '1'
     F**  42      - INPUT PARAMETER 'MODE' IS '2'
     F**  43      - PRINT 'YES' FOR 'PLEDGED' ACCORDING TO RUND & PLEDGE
     F**                  START AND FINISH DATES VALUES
     F**  44      - PRINT POLICIES INFORMATIONS ACCORDING TO
     F**                  BANK INVESTMENT POLICY CODE VALUE
     F**  45      - PRINT 'GROUPS' FOR INSTRUMENT POLICY
     F**  46      - PRINT 'INSTRUMENTS' FOR INSTRUMENT POLICY
     F**  47      - PRINT 'GROUPS' FOR CURRENCY POLICY
     F**  48      - PRINT 'CURRENCIES' FOR CURRENCY POLICY
     F**  49      - PRINT 'GROUPS' FOR COUNTRY POLICY
     F**  50      - PRINT 'COUNTRIES' FOR COUNTRY POLICY
     F**  51      - PRINT 'GROUPS' FOR INDUSTRY POLICY
     F**  52      - PRINT 'INDUSTRIES' FOR INDUSTRY POLICY
     F**  53      - PRINT BANK POLICY DETAILS ON 2ND PAGE
     F**  54      - PRINT '*** DIFFERENCE ***' LEGEND
     F**  56      - PRINT 'INSERT' WITHIN FORMAT CHARGE
     F**  57      - PRINT 'AMEND ' WITHIN FORMAT CHARGE
     F**  58      - PRINT 'INSERT' WITHIN FORMAT INST
     F**  59      - PRINT 'AMEND ' WITHIN FORMAT INST
     F**  60      - PRINT 'INSERT' WITHIN FORMAT CURR
     F**  61      - PRINT 'AMEND ' WITHIN FORMAT CURR
     F**  62      - PRINT 'INSERT' WITHIN FORMAT COUN
     F**  63      - PRINT 'AMEND ' WITHIN FORMAT COUN
     F**  64      - PRINT 'INSERT' WITHIN FORMAT INDU
     F**  65      - PRINT 'AMEND ' WITHIN FORMAT INDU
     F**  66      - NO CHARGES DEFINED
     F**  67      - NO INVESTMENT POLICIES DEFINED
     F**
     F**  70      - PAGE OVERFLOW
     F**
     F****71******- ACCESS SDBANKL1                                       S01486
     F****72******- ACCESS PMACCUPO                                       S01486
     F****73******- ACCESS PMCHRGPP                                       S01486
     F****74******- ACCESS PMCGCDPP                                       S01486
     F****75******- ACCESS PMBIPNPP                                       S01486
     F**  72      - ACCESS PMACCUQ0                                       S01486
     F**  73      - ACCESS PMCHRGPD                                       S01486
     F**  74      - ACCESS PMCGCDPD                                       S01486
     F**  75      - ACCESS PMBIPNPD                                       S01486
     F**  76      - ACCESS PMCIIPLL
     F****77******- ACCESS PMPGHIPP                                       S01486
     F**  77      - ACCESS PMPGHIPD                                       S01486
     F****78******- ACCESS SDPLINPD                                       S01486
     F**  79      - ACCESS PMCCIPLL
     F****80******- ACCESS PMPGHCPP                                       S01486
     F**  80      - ACCESS PMPGHCPD                                       S01486
     F****81******- ACCESS SDCURRL0                                       S01486
     F**  82      - ACCESS PMCRIPLL
     F****83******- ACCESS PMPGHRPP                                       S01486
     F**  83      - ACCESS PMPGHRPD                                       S01486
     F****84******- ACCESS SDCTRYL1                                       S01486
     F**  85      - ACCESS PMCDIPLL
     F****86******- ACCESS PMPGHDPP                                       S01486
     F**  86      - ACCESS PMPGHDPD                                       S01486
     F****87******- ACCESS SDINDSL1                                       S01486
     F**  88      - FIRST RECORD PROCESSED
     F**
     F**  98      - SYSTEM DATE FORMAT
     F**
     F**  U8      - FILE OUT OF BALANCE
     F**  U7 U8   - DATABASE ERROR / DATABASE CONTROL ERROR
     F**
     F**  LR      - LAST RECORD ON FILE
     F**
     F**                 *************************
     F**                 ** INDICATORS NOT USED **
     F**                 *************************
     F**
     F**      ***************************************************
     F**      * 01   02   03   04   05   06   07   08   09   10 *
     F**      * 11   12   13   14   15   16   17   18   19   20 *
     F**      * --   --   --   --   --   26   27   28   29   30 *
     F**      * 31   32   33   34   35   36   --   --   --   -- *
     F**      * --   --   --   --   --   --   --   --   --   -- *
     F**      * --   --   --   --   --   --   --   --   --   -- *
     F**      * --   --   --   --   --   --   --   --   --   -- *
     F**      * --   --   --   --   --   --   --   --   --   -- *
     F**      * --   --   --   --   --   --   --   --   ..   90 *         S01486
     F**      * 91   92   93   94   95   96   97   --   99      *
     F**      ***************************************************
     F**
     F*==================================================================
     F/EJECT
     E*==================================================================
     E**
     E                    CPY@    1   1 80
     E**
      /COPY ZSRSRC,ZDATE2Z1
     E**
     E************        CMD     1   1 39               QCMDEXC ARRAY    S01486
     E**
      /COPY ZSRSRC,ZSEDITZ1
     E                    TXT     4  10 18               TEXT ARRAY
     E**
     E*==================================================================
     E/EJECT
     I*==================================================================
      /EJECT
     I**
     I** RENAME INVESTMENT POLICY FIELDS TO HAVE COMMON NAMES
     IPMCIIPP0
     I              PYDLUP                          RNDLUP
     I              PYMLUP                          RNMLUP
     I              PYYLUP                          RNYLUP
     I              PYTLUP                          RNTLUP
     I              PYCHTP                          RNCHTP
     I              PYINNR                          RNTYPE
     I              PYINTG                          RNGRUP
     I              PYMINR                          RNMINR
     I              PYMAXR                          RNMAXR
     I**
     IPMPGHIP0
     I              PFINTG                          RNGPCO
     I              PFINGN                          RNGPNR
     I**
     IPMCCIPP0
     I              PZDLUP                          RNDLUP
     I              PZMLUP                          RNMLUP
     I              PZYLUP                          RNYLUP
     I              PZTLUP                          RNTLUP
     I              PZCHTP                          RNCHTP
     I              PZCCY                           RNTYPE
     I              PZCCYG                          RNGRUP
     I              PZMINR                          RNMINR
     I              PZMAXR                          RNMAXR
     I**
     IPMPGHCP0
     I              PHCCYG                          RNGPCO
     I              PHCCGN                          RNGPNR
     I**
     IPMCRIPP0
     I              P2DLUP                          RNDLUP
     I              P2MLUP                          RNMLUP
     I              P2YLUP                          RNYLUP
     I              P2TLUP                          RNTLUP
     I              P2CHTP                          RNCHTP
     I              P2CCOD                          RNTYP1
     I              P2CCDG                          RNGRUP
     I              P2MINR                          RNMINR
     I              P2MAXR                          RNMAXR
     I**
     IPMPGHRP0
     I              PJCCDG                          RNGPCO
     I              PJCOGN                          RNGPNR
     I**
     IPMCDIPP0
     I              P1DLUP                          RNDLUP
     I              P1MLUP                          RNMLUP
     I              P1YLUP                          RNYLUP
     I              P1TLUP                          RNTLUP
     I              P1CHTP                          RNCHTP
     I              P1LING                          RNGRUP
     I              P1MINR                          RNMINR
     I              P1MAXR                          RNMAXR
     I**
     IPMPGHDP0
     I              PLLING                          RNGPCO
     I              PLLINN                          RNGPNR
     I**
     IPMBIIPP0
     I              PTDLUP                          RNDLUP
     I              PTMLUP                          RNMLUP
     I              PTYLUP                          RNYLUP
     I              PTTLUP                          RNTLUP
     I              PTCHTP                          RNCHTP
     I              PTINNR                          RNTYPE
     I              PTINTG                          RNGRUP
     I              PTMINR                          RNMINR
     I              PTMAXR                          RNMAXR
     I**
     IPMBCIPP0
     I              PUDLUP                          RNDLUP
     I              PUMLUP                          RNMLUP
     I              PUYLUP                          RNYLUP
     I              PUTLUP                          RNTLUP
     I              PUCHTP                          RNCHTP
     I              PUCCY                           RNTYPE
     I              PUCCYG                          RNGRUP
     I              PUMINR                          RNMINR
     I              PUMAXR                          RNMAXR
     I**
     IPMBRIPP0
     I              PXDLUP                          RNDLUP
     I              PXMLUP                          RNMLUP
     I              PXYLUP                          RNYLUP
     I              PXTLUP                          RNTLUP
     I              PXCHTP                          RNCHTP
     I              PXCCOD                          RNTYP1
     I              PXCCDG                          RNGRUP
     I              PXMINR                          RNMINR
     I              PXMAXR                          RNMAXR
     I**
     IPMBDIPP0
     I              PWDLUP                          RNDLUP
     I              PWMLUP                          RNMLUP
     I              PWYLUP                          RNYLUP
     I              PWTLUP                          RNTLUP
     I              PWCHTP                          RNCHTP
     I              PWLING                          RNGRUP
     I              PWMINR                          RNMINR
     I              PWMAXR                          RNMAXR
     I**
     I**  LOCAL DATA AREA FOR DATA BASE ERRORS:
     I**
     I**LDA        UDS                            256                     S01486
     I*************                         132 183 DBLOT                 S01486
     I*************                         132 141 DBFILE                S01486
     ILDA         DS                            256                       S01486
     I                                      134 183 DBLOT                 S01486
     I                                      134 141 DBFILE                S01486
     I                                      142 170 DBKEY
     I                                      171 180 DBPGM
     I**********                            181 183 DBASE                 S71062
     I                                      181 1830DBASE                 S71062
     ISDBANK    E DSSDBANKPD                                              S01486
     I** EXTERNAL DS FOR BANK DETAILS                                     S01486
     ISDINDS    E DSSDINDSPD                                              S01486
     I** EXTERNAL DS FOR INDUSTRY DETAILS                                 S01486
     ISDCURR    E DSSDCURRPD                                              S01486
     I** EXTERNAL DS FOR CURRENCY DETAILS                                 S01486
     ISDPLIN    E DSSDPLINPD                                              S01486
     I** EXTERNAL DS FOR INSTRUMENT TYPES                                 S01486
     ISDCTRY    E DSSDCTRYPD                                              S01486
     I** EXTERNAL DS FOR COUNTRY DETAILS                                  S01486
     ISDDEPT    E DSSDDEPTPD                                              S01486
     I** EXTERNAL DS FOR DEPATMENT DETAILS                                S01486
     ISDMMOD    E DSSDMMODPD                                              S71062
     I** EXTERNAL DS FOR MODULES   DETAILS                                S71062
     I*                                                                   CPM003
     ISDPORT    E DSSDPORTPD                                              CPM003
     I** Portfolio Management ICD                                         CPM003
     I**                                                                  CAC003
     ISCSARD    E DSSCSARDPD                                              CAC003
     I** External DS for SAR's File                                       CAC003
      *                                                                   S01486
     IDSFDY     E DSDSFDY                                                 S01486
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01486
     IDSSDY     E DSDSSDY                                                 S01486
     I* FIRST DS FOR ACCESS PROGRAMS, LONG  DATA STRUCTURE                S01486
     ISPOOL       DS                                                      S01486
     I                                       83  92 SFILE                 S01486
     I                                    B 123 1240SFNUM                 S01486
     ISPOOLU      DS                                                      S01486
     I                                       83  92 SFILEU                S01486
     I                                    B 123 1240SFNUMU                S01486
     I**
     I**  DATA STRUCTURE FOR ZSEDIT:
     I**
      /COPY ZSRSRC,ZSEDITZ2
     I**
     I**  DATA STRUCTURE FOR COMPILATION  - COPYRIGHT INSERTION:
     I**
     ICPYR@#      DS
     I                                        1  80 CPY@
     I                                        1  20 CPY@##
     I**
     I*=================================================================
     I/EJECT
     C*=================================================================
     C**
     C**  DEFINE KLISTS:
     C**
     C           POKEY     KLIST
     C                     KFLD           PNCNUM
     C                     KFLD           PNPTFR
     C**
     C           CHKEY     KLIST
     C                     KFLD           PNBCGY
     C                     KFLD           WWCGCO
     C**
     C**================================================================
     C**           PROGRAM  START
     C**================================================================
     C**
     C**  DEFINE INPUT PARAMETERS:
     C**
     C           *ENTRY    PLIST
     C                     PARM           MODE    1
     C***********          PARM           ACOF    4                       S01486
     C                     PARM           IND     1
     C                     PARM           RLVL    1                       S01486
     C                     PARM           RSEQ    5                       S01486
     C**
     C**  INITIALIZATION:
     C**
     C                     EXSR #INIT
     C**
     C**  PROCESS AUDIT REPORT:
     C**
     C           MODE      IFEQ '1'                        - B1           S01486
     C                     EXSR #PA01                                     S01486
     C                     ELSE                            - X1           S01486
     C**
     C**  READ DETAILS FOR FULL LIST:
     C**
     C                     EXSR #PL01
     C                     END                             - X2           S01486
     C**
     C**  PROCESS AUDIT:
     C**
     C                     EXSR #AU01
     C                     MOVE '1'       *INLR
     C**
     C******************************************************************
     C/EJECT
     C******************************************************************
      **                INDEX TO SUBROUTINES
      **
      ** #INIT    -        INITIALIZE STANDARD FIELDS AND ACCESS OF
      **                              STANDING DATA
      **
      **
      ** #PA01    -        AUDIT REPORT (MODE = '1')
      ** #TYPE    -        DETERMINE CHANGE TYPE AND COMPUTE RECORDS
      ** #PREF    -        DETERMINE PORTFOLIO REFERENCE
      ** #DATF1   -        SET UP DATE FORMATS / PORTFOLIO REFERENCE
      ** #PDET    -        DETERMINE PORTFOLIO DETAILS
      ** #DATF2   -        SET UP DATE FORMATS / CHARGES DETAILS
      ** #CDET    -        DETERMINE CHARGES DETAILS
      ** #POLI    -        DETERMINE BANK INVESTMENT POLICY
      ** #PODET   -        DETERMINE POLICIES DETAILS
      **
      **
      ** #PR02    -        PRINT PORTFOLIO CUSTOMER INVESTMENT POLICY
      **                         DETAILS
      ** #PR04    -        PRINT CUSTOMER INSTRUMENT POLICY DETAILS
      ** #INSTG   -        DETERMINE INSTRUMENT POLICY GROUPS DETAILS
      ** #INSTT   -        DETERMINE INSTRUMENT POLICY TYPES DETAILS
      ** #INSTA   -        DETERMINE INSTRUMENT POLICY GROUPS & TYPES
      **                             DETAILS
      **
      ** #PR05    -        PRINT CUSTOMER CURRENCY POLICY DETAILS
      ** #CURRC   -        DETERMINE CURRENCY POLICY CODES DETAILS
      ** #CURRA   -        DETERMINE CURRENCY POLICY GROUPS & CODES
      **                             DETAILS
      **
      ** #PR06    -        PRINT CUSTOMER COUNTRY POLICY DETAILS
      ** #COUNC   -        DETERMINE COUNTRY POLICY CODES DETAILS
      ** #COUNA   -        DETERMINE COUNTRY POLICY GROUPS & CODES
      **                             DETAILS
      **
      ** #PR07    -        PRINT CUSTOMER INDUSTRY POLICY DETAILS
      ** #INDUC   -        DETERMINE INDUSTRY POLICY CODES DETAILS
      ** #INDUA   -        DETERMINE INDUSTRY POLICY GROUPS & CODES
      **                             DETAILS
      **
      **
      ** #PR03    -        PRINT PORTFOLIO BANK INVESTMENT POLICY DETAILS
      ** #PR08    -        PRINT BANK INSTRUMENT POLICY DETAILS
      ** #INSTH   -        DETERMINE INSTRUMENT POLICY GROUPS DETAILS
      ** #INSTU   -        DETERMINE INSTRUMENT POLICY TYPES DETAILS
      ** #INSTB   -        DETERMINE INSTRUMENT POLICY GROUPS & TYPES
      **                             DETAILS
      **
      ** #PR09    -        PRINT BANK CURRENCY POLICY DETAILS
      ** #CURRH   -        DETERMINE CURRENCY POLICY GROUPS DETAILS
      ** #CURRD   -        DETERMINE CURRENCY POLICY CODES DETAILS
      ** #CURRB   -        DETERMINE CURRENCY POLICY GROUPS & CODES
      **                             DETAILS
      **
      ** #PR10    -        PRINT BANK COUNTRY POLICY DETAILS
      ** #COUNH   -        DETERMINE COUNTRY POLICY GROUPS DETAILS
      ** #COUND   -        DETERMINE COUNTRY POLICY CODES DETAILS
      ** #COUNB   -        DETERMINE COUNTRY POLICY GROUPS & CODES
      **                             DETAILS
      **
      ** #PR11    -        PRINT BANK INDUSTRY POLICY DETAILS
      ** #INDUH   -        DETERMINE INDUSTRY POLICY GROUPS DETAILS
      ** #INDUD   -        DETERMINE INDUSTRY POLICY CODES DETAILS
      ** #INDUB   -        DETERMINE INDUSTRY POLICY GROUPS & CODES
      **                             DETAILS
      **
      **
      ** #PL01    -        READ DETAILS FOR FULL LIST (MODE = '2')
      **
      ** #PR01    -        PRINT PORTFOLIO CUSTOMER DETAILS
      **
      ** #AU01    -        CHAIN ON TRAILER FILE
      ** #REPOR   -        PRINT AUDIT REPORT
      **
      ** ZDATE2   -        CONVERT DAY NUMBER TO DATE FORMAT DDMMMYY
      **
      ** ZSEDIT   -        INSERT DECIMAL POINT & SIGN IN NUMERIC FIELD;
      **                   BLANK OUT LEADING ZEROES;
      **                   INSERT COMMAS
      **
      ** *PSSR    -        DATABASE ERROR
      **
     C**=================================================================
     C/EJECT
     C**=================================================================
      **
      **  #INIT       SUBROUTINE TO INITIALIZE STATIC FIELDS AND TO ACCESS
      **                            STANDING DATA
     C**
      **     CALLED BY PROGRAM (ONCE AT START, FROM MAIN LINE)
      **     CALLS     *PSSR
      **
     C**=================================================================
     C**                                                   ***************
     C           #INIT     BEGSR                           * #INIT BEGSR *
     C**                                                   ***************
     C**  PREPARE LDA:
     C**
     C           *NAMVAR   DEFN           LDA                             S01486
     C           *LOCK     IN   LDA                                       S01486
     C                     MOVEL*BLANK    DBLOT
     C                     MOVEL'PM0290'  DBPGM
     C                     OUT  LDA                                       S01486
     C**
     C**  INITIALIZE INDICATORS:
     C**
     C                     MOVE '0'       *IN
     C                     MOVE 'N'       OPEN    1                       085794
     C**
     C**  GET INSTALLATION CONTROL DATA RECORD 1:
     C**
     C***********1         SETLLSDBANKL1                                  S01486
     C***********                                                         S01486
     C***********          READ SDBANKL1                 71               S01486
     C                     CALL 'AOBANKR0'                                S01486
     C                     PARM '*MSG   ' WWRTCD  7                       S01486
     C                     PARM '*FIRST ' WWOPTN  7                       S01486
     C           SDBANK    PARM SDBANK    DSFDY                           S01486
     C**
     C**  IF RECORD FOUND:
     C**
     C           WWRTCD    IFEQ *BLANKS                                   S01486
     C************IN71     IFEQ '0'                        - B1           S01486
     C**
     C**  CHECK SYSTEM DATE FORMAT (DDMMYY OR MMDDYY):
     C**
     C           BJDFIN    IFEQ 'M'                        - B2
     C                     MOVE '1'       *IN98            ON => MMDDYY
     C                     END                             - E2
     C                     ELSE                            - X1
     C**
     C**  OTHERWISE DB ERROR:
     C**
     C           *LOCK     IN   LDA                                       S01486
     C***********          MOVEL'001'     DBASE            ***************S71062
     C                     Z-ADD1         DBASE                           S71062
     C************         MOVEL'SDBANKL1'DBFILE           * DB ERROR 01 *S01486
     C                     MOVE 'SDBANKPD'DBFILE           * DB ERROR 01 *S01486
     C                     MOVEL' NONE '  DBKEY            ***************
     C                     OUT  LDA                                       S01486
     C                     EXSR *PSSR
     C                     END                             - E1
     C**                                                                  S71062
     C**   Access SDMMODPD to check if F&O is switched on.                S71062
     C**                                                                  S71062
     C                     CALL 'AOMMODR0'                                S71062
     C                     PARM *BLANKS   WWRTCD                          S71062
     C                     PARM '*FIRST ' WWOPTN                          S71062
     C           SDMMOD    PARM SDMMOD    DSFDY                           S71062
     C           WWRTCD    IFNE *BLANKS                                   S71062
     C           *LOCK     IN   LDA                                       S71062
     C                     Z-ADD25        DBASE            ***************S71062
     C                     MOVE 'SDMMODPD'DBFILE           * DB ERROR 25 *S71062
     C                     MOVEL'*NONE '  DBKEY            ***************S71062
     C                     EXSR *PSSR                                     S71062
     C                     END                             - E1           S71062
     C*                                                                   CAC003
     C** Check if Analytical Accounting and Switchable Feature            CAC003
     C** CAC003 are switched on.                                          CAC003
     C                     MOVE '0'       *IN26                           CAC003
     C*                                                                   CAC003
     C                     CALL 'AOSARDR0'                                CAC003
     C                     PARM           WWRTCD                          CAC003
     C                     PARM '*VERIFY' WWOPTN                          CAC003
     C                     PARM 'CAC003'  WWSARD  6                       CAC003
     C           SCSARD    PARM SCSARD    DSFDY                           CAC003
      *                                                                   CAC003
     C           WWRTCD    IFEQ *BLANK                                    CAC003
     C           BGN0ST    ANDEQ'Y'                                       CAC003
     C                     MOVE '1'       *IN26                           CAC003
     C                     ENDIF                                          CAC003
     C*                                                                   CPM003
     C           BGFUOP    IFEQ 'Y'                                       CPM003
     C** Access PM ICD for FCPORS, Type of Portfolios supported           CPM003
     C                     CALL 'AOPORTR0'                                CPM003
     C                     PARM *BLANKS   WWRTCD                          CPM003
     C                     PARM '*FIRST ' WWOPTN                          CPM003
     C           SDPORT    PARM SDPORT    DSFDY                           CPM003
     C           WWRTCD    IFNE *BLANKS                                   CPM003
     C           *LOCK     IN   LDA                                       CPM003
     C                     MOVE *BLANKS   DBKEY            ***************CPM003
     C                     Z-ADD26        DBASE            * DB ERROR 26 *CPM003
     C                     MOVE 'SDPORTPD'DBFILE           ***************CPM003
     C                     EXSR *PSSR                                     CPM003
     C                     END                                            CPM003
     C                     END                                            CPM003
     C*                                                                   CPM003
     C           BGFUOP    IFEQ 'Y'                        - B1           S71062
     C           FCPORS    ANDNE'B'                                       CPM003
     C** If Bank Portfolios are supported, treat as if FF off             CPM003
     C                     MOVE *ON       *IN20                           S71062
     C                     ELSE                                           S71062
     C                     MOVE *OFF      *IN20                           S71062
     C                     ENDIF                           - E1           S71062
     C**
     C**  BUILT COMMAND EXPRESSION FOR QCMDEXC:
     C**
     C***********          MOVELCMD,1     WWCMD  43                       S01486
     C***********          MOVE ')'       WWPRTL  4                       S01486
     C***********                                                         S01486
     C****INITIALIZE SAVPRT:                                              S01486
     C***********                                                         S01486
     C***********          MOVE *LOVAL    SAVPRT  3                       S01486
     C*                                                                   S01486
     C**   Ensure audit spool file is recorded by RCF.                    S01486
     C*                                                                   S01486
     C                     MOVE RSEQ      SEQ                             S01486
     C                     Z-ADDSFNUMU    ZSNUMU  60                      S01486
     C                     CALL 'ZSFILE'                                  S01486
     C                     PARM           SEQ     5                       S01486
     C                     PARM *BLANKS   SENTY   3                       S01486
     C                     PARM           SFILEU                          S01486
     C                     PARM           ZSNUMU                          S01486
     C                     PARM *BLANK    ZSERR   1                       S01486
     C           RLVL      IFEQ 'S'                                       S01486
     C                     MOVE '1'       *IN27                           S01486
     C                     END                                            S01486
     C**                                                                  S01486
     C           RLVL      IFEQ 'D'                                       S01486
     C                     MOVE '1'       *IN28                           S01486
     C                     END                                            S01486
     C**                                                                  S01486
     C           RLVL      IFEQ 'A'                                       S01486
     C                     MOVE '1'       *IN29                           S01486
     C                     END                                            S01486
     C**                                                                  S01486
     C/COPY WNCPYSRC,PM0290C001
     C**                                                   ***************
     C                     ENDSR                           * #INIT ENDSR *
     C**                                                   ***************
     C**=================================================================
     C/EJECT
     C**=================================================================
     C**
     C** #PA01       SUBROUTINE TO PRINT PORTFOLIO INSERTED, AMENDED
     C**             OR DELETED DURING DAY.
     C**
     C**     CALLED BY PROGRAM
     C**     CALLS     #TYPE, #PREF, #DATF1, #PDET, *PSSR, ZSEDIT, #DATF2,
     C**               #CDET, #POLI, #PODET, #PR02, #PR03
     C**
     C**=================================================================
     C**                                                   ***************
     C           #PA01     BEGSR                           * #PA01 BEGSR *
     C*
     C                     MOVE '1'       *IN41                           47335
     C**
     C****ACCESS PMACCUPO:                                                S01486
     C**  ACCESS PMACCUQ0:                                                S01486
     C**
     C**********           READ PMACCUPO                 72               S01486
     C                     READ PMACCUQ0                 72               S01486
     C**********                                                          S01486
     C****OVRPRTF TO PRINTER FILE PM0290PXXX (XXX = PRINTER LOCATION CODE)S01486
     C**********                                                          S01486
     C**********           MOVELAZPRTL    WWPRTL                          S01486
     C**********           MOVE WWPRTL    WWCMD                           S01486
     C**********           CALL 'QCMDEXC'                                 S01486
     C**********           PARM WWCMD     QCAA   43                       S01486
     C**********           PARM 43        QCAN   155                      S01486
     C**********                                                          S01486
     C****OPEN PRINTER FILE:                                              S01486
     C**********                                                          S01486
     C**********           OPEN PM0290P1                                  S01486
     C**********           MOVE AZPRTL    SAVPRT                          S01486
     C**********                                                          S01486
     C****IF*EOF ON PMACCUPO REACHED OUTPUT NO DETAILS TO REPORT COMMENT  S01486
     C**********                                                          S01486
     C************IN72     IFEQ '1'                                       S01486
     C***********          WRITEHEADRE                                    S01486
     C***********          WRITENODET                                     S01486
     C***********          END                                            S01486
     C***********          EXSR #OPEN                                     S01486
     C***********                                                         S01486
     C***********RLVL      IFEQ 'D'                                       S01486
     C***********          MOVE AZDPCD    SVDPCD  3                       S01486
     C***********          END                                            S01486
     C***********                                                         S01486
     C***********RLVL      IFEQ 'A'                                       S01486
     C***********          MOVE AZACOC    SVACOC  2                       S01486
     C***********          END                                            S01486
     C           *IN72     IFEQ '0'                                       081342
     C                     EXSR #OPEN                                     081342
     C           RLVL      IFEQ 'D'                                       081342
     C                     MOVE AZDPCD    SVDPCD  3                       081342
     C                     END                                            081342
     C**                                                                  081342
     C           RLVL      IFEQ 'A'                                       081342
     C                     MOVE AZACOC    SVACOC  2                       081342
     C                     END                                            081342
     C                     END                                            081342
     C**
     C**  SO LONG AS LAST CHANGE DATE = RUN DATE:
     C**
     C           *IN72     DOWEQ'0'                        - B1
     C**
     C**  DETERMINE CHANGE TYPE AND COMPUTE RECORDS:
     C**
     C                     EXSR #TYPE
     C***********                                                         S01486
     C****ON*EACH CHANGE OF ACCOUNTER OFFICER PRINTER LOCATION CODE:      S01486
     C***********                                                         S01486
     C***********AZPRTL    IFNE SAVPRT                     - B2           S01486
     C           RLVL      IFEQ 'D'                                       S01486
     C           AZDPCD    ANDNESVDPCD                                    S01486
     C                     WRITEENDRE                                     S01486
     C                     CLOSEPM0290P1                                  S01486
     C                     EXSR #OPEN                                     S01486
     C                     MOVE AZDPCD    SVDPCD                          S01486
     C                     END                                            S01486
     C**                                                                  S01486
     C           RLVL      IFEQ 'A'                                       S01486
     C           AZACOC    ANDNESVACOC                                    S01486
     C                     WRITEENDRE                                     S01486
     C                     CLOSEPM0290P1                                  S01486
     C                     EXSR #OPEN                                     S01486
     C                     MOVE AZACOC    SVACOC                          S01486
     C                     END                                            S01486
     C***********                                                         S01486
     C*****RINT*REPORT END:                                               S01486
     C***********                                                         S01486
     C***********          WRITEENDRE                                     S01486
     C***********                                                         S01486
     C****CLOSE*THE OLD PRINTER FILE:                                     S01486
     C***********                                                         S01486
     C***********          CLOSEPM0290P1                                  S01486
     C***********                                                         S01486
     C****OVRPRTF TO THE NEW PRINTER FILE PM0290PXXX:                     S01486
     C***********                                                         S01486
     C***********          MOVELAZPRTL    WWPRTL                          S01486
     C***********          MOVE WWPRTL    WWCMD                           S01486
     C***********          CALL 'QCMDEXC'                                 S01486
     C***********          PARM WWCMD     QCAA   43                       S01486
     C***********          PARM 43        QCAN   155                      S01486
     C***********                                                         S01486
     C**  OPEN THE NEW PRINTER FILE:                                      S01486
     C***********                                                         S01486
     C***********          OPEN PM0290P1                                  S01486
     C***********          MOVE AZPRTL    SAVPRT                          S01486
     C***********          END                             - E2           S01486
     C**
     C**  SET UP REPORT HEADER:
     C**
     C                     EXSR #PREF
     C**
     C**  PRINT REPORT HEADER:
     C**
     C                     MOVE '1'       *IN41
     C                     WRITEHEADRE
     C                     WRITEDETFP
     C**
     C**  SET UP DATE FORMATS FOR PORTFOLIO DETAILS:
     C**
     C                     EXSR #DATF1
     C**
     C**  SET UP PORTFOLIO DETAILS:
     C**
     C                     EXSR #PDET
     C**
     C**  CONDITIONNING " PLEDGED : 'YES' ":
     C**
     C           PNPDGS    IFLE BJRDNB                     - B2
     C           BJRDNB    ANDLEPNPDGF
     C                     MOVE '1'       *IN43
     C                     END                             - E2
     C**
     C**  PRINT PORTFOLIO DETAILS:
     C**
     C                     WRITEDETAIL
     C**
     C                     MOVE '0'       *IN43
     C**
     C**  PRINT CHARGES HEADER::
     C**
     C                     WRITEHEADCH
     C**
     C****ACCESS PMCHRGPP:                                                S01486
     C**  ACCESS PMCHRGPD:                                                S01486
     C**
     C                     MOVE '0'       *IN66
     C***********POKEY     SETLLPMCHRGPP                                  S01486
     C***********POKEY     READEPMCHRGPP                 73               S01486
     C           POKEY     SETLLPMCHRGPD                                  S01486
     C           POKEY     READEPMCHRGPD                 73               S01486
     C**
     C**  SO LONG AS CUSTOMER AND PORTFOLIO ARE SAME:
     C**
     C           *IN73     DOWEQ'0'                        - B2
     C**
     C**  FOR EACH LIVE RECORD READ:
     C**
     C           PORECI    IFEQ 'D'                        - B3
     C                     MOVE '1'       *IN66
     C**
     C** DETERMINE WHICH OF CHARGE DETAILS TO BE USED DEPENDING
     C** UPON CHARGE EFFECTIVE INDICATOR
     C**
     C           POCGEI    IFEQ 'C'
     C                     MOVE POCGCO    WWCGCO  2
     C                     Z-ADDPOCGSP    WWCGSP 130
     C                     MOVE POCGSI    WWCGSI  1
     C                     MOVE 'C'       RRCGEI
     C                     END
     C**
     C           POCGEI    IFEQ 'N'
     C           POCCSP    ANDNE*BLANKS
     C                     MOVE POCCSP    WWCGCO
     C                     Z-ADDPOCSSP    WWCGSP
     C                     MOVE POCISP    WWCGSI
     C                     MOVE 'C'       RRCGEI
     C                     END
     C**
     C           POCGEI    IFEQ 'N'
     C           POCCSP    ANDEQ*BLANKS
     C                     MOVE POCGCO    WWCGCO  2
     C                     Z-ADDPOCGSP    WWCGSP 130
     C                     MOVE POCGSI    WWCGSI  1
     C                     MOVE 'N'       RRCGEI
     C                     END
     C**
     C****ACCESS*PMCGCDPP TO OBTAIN CHARGE BASIS:                         S01486
     C**  ACCESS PMCGCDPD TO OBTAIN CHARGE BASIS:                         S01486
     C**
     C           WWCGCO    IFNE *BLANKS                    - B4
     C*
     C***********CHKEY     CHAINPMCGCDPP             74                   S01486
     C           CHKEY     CHAINPMCGCDPD             74                   S01486
     C**
     C**  IF RECORD NOT FOUND THEN DATABASE ERROR
     C**
     C           *IN74     IFEQ '1'                        - B5
     C           P5RECI    OREQ '*'
     C           *LOCK     IN   LDA                                       S01486
     C***********          MOVEL'002'     DBASE            ***************S71062
     C                     Z-ADD2         DBASE                           S71062
     C***********          MOVEL'PMCGCDPP'DBFILE           * DB ERROR 02 *S01486
     C                     MOVE 'PMCGCDPD'DBFILE           * DB ERROR 02 *S01486
     C                     MOVELWWCGCO    DBKEY            ***************
     C                     OUT  LDA                                       S01486
     C                     EXSR *PSSR
     C                     END                             - E5
     C**
     C**  DETERMINE 'ADJUSTMENT' ACCORDING TO WHETHER
     C**  CHARGE BASIS VALUE IS 'P' OR 'F':
     C**
     C           P5CGBS    IFEQ 'P'                        - B5
     C**
     C                     Z-ADDWWCGSP    ZFLD15 150
     C                     Z-ADD7         ZDECS   10
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    RRCGSP
     C                     MOVE '%'       RRCGSP
     C**
     C                     ELSE                            - X5
     C                     Z-ADDWWCGSP    ZFLD15 150
     C                     Z-ADDPNBCGD    ZDECS   10
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    RRCGSP
     C                     END                             - E5
     C*
     C** IF SPREAD IS ZERO SET ADJUSTMENT DETAILS TO BLANK
     C           WWCGSP    IFEQ 0                          - B5
     C                     MOVE *BLANKS   RRCGSP
     C                     END                             - E5
     C*
     C                     ELSE                            - X4
     C                     MOVE *BLANKS   RRCGCO
     C                     MOVE *BLANKS   RRCGSP
     C                     MOVE *BLANKS   RRCGAS
     C                     END                             - E4
     C**
     C**  SET UP DATE FORMATS FOR CHARGES DETAILS:
     C**
     C                     EXSR #DATF2
     C**
     C**  SET UP CHARGES DETAILS:
     C**
     C                     EXSR #CDET
     C**
     C**  PRINT CHARGES DETAILS:
     C**
     C           POCHTP    IFEQ 'I'                        - B4
     C                     MOVE '1'       *IN56
     C                     ELSE                            - X4
     C           POCHTP    IFEQ 'A'                        - B5
     C                     MOVE '1'       *IN57
     C                     END                             - E5
     C**
     C                     END                             - E4
     C**
     C                     WRITECHARGE
     C                     MOVE '0'       *IN56
     C                     MOVE '0'       *IN57
     C                     END                             - E3
     C**
     C****ACCESS PMCHRGPP AGAIN:                                          S01486
     C**  ACCESS PMCHRGPD AGAIN:                                          S01486
     C**
     C***********POKEY     READEPMCHRGPP                 73               S01486
     C           POKEY     READEPMCHRGPD                 73               S01486
     C                     END                             - E2
     C**
     C** IF NO CHARGE DETAILS HAVE BEEN OUTPUT WRITE NO CHARGE TEXT
     C**
     C           *IN66     IFEQ '0'
     C                     WRITENOCHR
     C                     END
     C**
     C**  WHEN BANK INVESTMENT POLICY CODE NOT BLANK:
     C**
     C                     MOVE '0'       *IN44
     C                     MOVE '0'       *IN67
     C                     MOVE 'N'       WWPOLC  1
     C           PNPOLC    IFNE '  '                       - B2
     C                     MOVE '1'       *IN44
     C                     MOVE 'Y'       WWPOLC
     C**
     C****ACCESS*PMBIPNPP*TO*OBTAIN*BANK*INVESTMENT*POLICY*NARRATIVE:**   S01486
     C**  Access PMBIPNPD to obtain bank investment policy narrative:     S01486
     C**
     C***********PNPOLC    CHAINPMBIPNPP             75                   S01486
     C           PNPOLC    CHAINPMBIPNPD             75                   S01486
     C**
     C**  IF RECORD NOT FOUND:
     C**
     C           *IN75     IFEQ '1'                        - B3
     C           P5RECI    OREQ '*'
     C           *LOCK     IN   LDA                                       S01486
     C***********          MOVEL'003'     DBASE            ***************S71062
     C                     Z-ADD3         DBASE                           S71062
     C***********          MOVEL'PMBIPNPP'DBFILE           * DB ERROR 03 *S01486
     C                     MOVE 'PMBIPNPD'DBFILE           * DB ERROR 03 *S01486
     C                     MOVELPNPOLC    DBKEY            ***************
     C                     OUT  LDA                                       S01486
     C                     EXSR *PSSR
     C                     END                             - E3
     C**
     C**  SET UP BANK INVESTMENT POLICY:
     C**
     C                     EXSR #POLI
     C**
     C                     END                             - E2
     C**
     C**  SET UP INSTRUMENT, CURRENCY, COUNTRY & INDUSTRY POLICIES DETAILS:
     C**
     C                     EXSR #PODET
     C**
     C**  PRINT THESE FURTHER INFORMATIONS:
     C**
     C                     WRITEINFO
     C**
     C** IF NEITHER BANK NOR PORTFOLIO INVESTMENT POLICY DEFINED OUTPUT
     C** 'NO INVESTMENT POLICY DEFINED' COMMENT
     C**
     C           WWPOLC    IFEQ 'N'
     C                     WRITENOPOL
     C                     END
     C**
     C                     MOVE '0'       *IN44
     C**
     C**  IF FULL PORTFOLIO DETAILS REQUIRED (FROM SELECTION PROMPT)
     C**  AND ANY OF THE POLICY INDICATORS SET TO 'Y' OR BANK INVESTMENT
     C**  POLICY NOT BLANK OUTPUT SECOND PAGE OF REPORT SHOWING
     C**  INVESTMENT POLICY DETAILS
     C**
     C           IND       IFEQ 'F'                        - B2
     C*
     C           PNIPIN    IFEQ 'Y'                        - B3
     C           PNCYIN    OREQ 'Y'
     C           PNYPIN    OREQ 'Y'
     C           PNNPIN    OREQ 'Y'
     C           PNPOLC    ORNE '  '
     C**
     C**  PRINT REPORT HEADER:
     C**
     C                     WRITEHEADRE
     C                     MOVE '0'       *IN70
     C                     END                             - E3
     C**
     C**  IF ANY OF THE POLICY CUSTOMER INDICATORS IS 'Y':
     C**
     C           PNIPIN    IFEQ 'Y'                        - B3
     C           PNCYIN    OREQ 'Y'
     C           PNYPIN    OREQ 'Y'
     C           PNNPIN    OREQ 'Y'
     C**
     C**  PROCESS PORTFOLIO CUSTOMER INVESTMENT POLICY DETAILS:
     C**
     C                     EXSR #PR02
     C                     END                             - E3
     C**
     C**  IF THE BANK INVESTMENT POLICY CODE IS NOT BLANK:
     C**
     C           PNPOLC    IFNE '  '                       - B3
     C**
     C**  PROCESS BANK INVESTMENT POLICY DETAILS:
     C**
     C                     EXSR #PR03
     C                     END                             - E3
     C**
     C                     END                             - E2
     C/COPY WNCPYSRC,PM0290C002
     C**
     C****ACCESS PMACCUPO AGAIN:
     C**  ACCESS PMACCUQ0 AGAIN:
     C**
     C***********          READ PMACCUPO                 72               S01486
     C                     READ PMACCUQ0                 72               S01486
     C                     END                             - E1
     C*
     C** WRITE END OF REPORT COMMENT
     C           OPEN      IFEQ 'Y'                                       085794
     C                     WRITEENDRE
     C                     END                                            085794
     C**                                                   ***************
     C                     ENDSR                           * #PA01 ENDSR *
     C**                                                   ***************
     C**=================================================================
     C/EJECT
     C**================================================================= S01486
     C**                                                                  S01486
     C** #OPEN       SUBROUTINE TO OPEN PRINTER FILE                      S01486
     C**                                                                  S01486
     C**                                                                  S01486
     C**    CALLED BY #PA01, #PL01                                        S01486
     C**    CALLS     -                                                   S01486
     C**                                                                  S01486
     C**================================================================= S01486
     C           #OPEN     BEGSR                                          S01486
     C**                                                                  S01486
     C                     OPEN PM0290P1                                  S01486
     C                     MOVE 'Y'       OPEN                            085794
     C*                                                                   S01486
     C**  ENSURE REPORT SPOOL FILE RECORDED BY RCF                        S01486
     C*                                                                   S01486
     C           RLVL      IFEQ 'S'                                       S01486
     C                     MOVEL*BLANKS   WWENTY  3                       S01486
     C                     END                                            S01486
     C**                                                                  S01486
     C           RLVL      IFEQ 'A'                                       S01486
     C                     MOVELAZACOC    WWENTY                          S01486
     C                     END                                            S01486
     C**                                                                  S01486
     C           RLVL      IFEQ 'D'                                       S01486
     C                     MOVELAZDPCD    WWENTY  3                       S01486
     C                     END                                            S01486
     C**                                                                  S01486
     C                     Z-ADDSFNUM     ZSNUM   60                      S01486
     C*                                                                   S01486
     C                     CALL 'ZSFILE'                                  S01486
     C                     PARM           SEQ     5                       S01486
     C                     PARM WWENTY    SENTY   3                       S01486
     C                     PARM           SFILE                           S01486
     C                     PARM           ZSNUM                           S01486
     C                     PARM           ZSERR   1                       S01486
     C*                                                                   S01486
     C           ZSERR     IFEQ 'Y'                                       S01486
     C*                                                                   S01486
     C**  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM       S01486
     C*                                                                   S01486
     C           *LOCK     IN   LDA                                       S01486
     C                     SETON                     U7U8LR               S01486
     C                     RETRN                                          S01486
     C                     END                                            S0148T
     C                     ENDSR                                          S01486
     C**=================================================================
     C**
     C** #TYPE       SUBROUTINE TO DETERMINE CHANGE TYPE AND COMPUTE
     C**             RECORDS.
     C**
     C**    CALLED BY #PA01, #PR01
     C**    CALLS     -
     C**
     C**=================================================================
     C**                                                   ***************
     C           #TYPE     BEGSR                           * #TYPE BEGSR *
     C**                                                   ***************
     C**  IF THE LAST CHANGE TYPE IS 'I', ADD 1 TO NUMBER OF INSERTS:
     C**
     C           PNCHTP    IFEQ 'I'                        - B1
     C                     ADD  1         WWNOIN  50
     C                     MOVEL'INSERT'  W1CHTP  6
     C                     END                             - E1
     C**
     C**  IF THE LAST CHANGE TYPE IS 'A', ADD 1 TO NUMBER OF AMENDS:
     C**
     C           PNCHTP    IFEQ 'A'                        - B1
     C                     ADD  1         WWNOAM  50
     C                     MOVEL'AMEND '  W1CHTP
     C                     END                             - E1
     C**
     C**  IF THE LAST CHANGE TYPE IS 'D', ADD 1 TO NUMBER OF DELETES:
     C**
     C           PNCHTP    IFEQ 'C'                        - B1
     C                     ADD  1         WWNODE  50
     C                     MOVEL'CLOSED'  W1CHTP
     C                     END                             - E1
     C**                                                   ***************
     C                     ENDSR                           * #TYPE ENDSR *
     C**                                                   ***************
     C**=================================================================
     C/EJECT
     C**=================================================================
     C**
     C** #PREF       SUBROUTINE TO DETERMINE PORTFOLIO REFERENCE
     C**
     C**    CALLED BY #PA01, #PR01
     C**    CALLS     -
     C**
     C**=================================================================
     C**                                                   ***************
     C           #PREF     BEGSR                           * #PREF BEGSR *
     C**                                                   ***************
     C                     MOVE PNPTFR    RRPTFR
     C                     MOVE PNPTFN    RRPTFN
     C*                                                                   CAC003
     C** If Analytical Accounting and CAC003 are available                CAC003
     C** move profit cntr. field from the file to its printer             CAC003
     C** file field.                                                      CAC003
     C           *IN26     IFEQ '1'                                       CAC003
     C                     MOVE PNPRFC    RRPRFC                          CAC003
     C                     ENDIF                                          CAC003
     C*
     C** IF PORTFOLIO HAS BEEN CLOSED OUTPUT TEXT PORTFOLIO CLOSED
     C           PNRECI    IFNE 'D'
     C                     MOVE '1'       *IN69
     C                     ELSE
     C                     MOVE '0'       *IN69
     C                     END
     C*                                                                   S01486
     C**  Get department name using access object                         S01486
     C*                                                                   S01486
     C                     CALL 'AODEPTR0'                                S01486
     C                     PARM *BLANKS   WWRTCD                          S01486
     C                     PARM '*KEY   ' WWOPTN                          S01486
     C                     PARM AZDPCD    WWDPCD  3                       S01486
     C           SDDEPT    PARM SDDEPT    DSFDY                           S01486
     C*                                                                   S01486
     C           WWRTCD    IFNE *BLANKS                                   S01486
     C           *LOCK     IN   LDA                                       S01486
     C******************** Z-ADD23        DBASE            ***************S01486
     C***********          MOVEL'023'     DBASE      ***************S01486S71062
     C                     Z-ADD23        DBASE            ***************S71062
     C                     MOVE 'SDDEPTPD'DBFILE           * DB ERROR 23 *S01486
     C                     MOVELAZDPCD    DBKEY            ***************S01486
     C                     OUT  LDA                                       S01486
     C                     EXSR *PSSR                                     S01486
     C                     END                                            S01486
     C**                                                   ***************
     C                     ENDSR                           * #PREF ENDSR *
     C**                                                   ***************
     C**=================================================================
     C/EJECT
     C**=================================================================
     C**
     C** #DATF1      SUBROUTINE TO SET UP DATE FORMATS/PORTFOLIO DETAILS
     C**
     C**    CALLED BY #PA01, #PR01
     C**    CALLS     ZDATE2
     C**
     C**=================================================================
     C**                                                   ***************
     C           #DATF1    BEGSR                           * #DATF1 BEGS *
     C**                                                   ***************
     C           PNDPOP    IFNE 0
     C                     Z-ADDPNDPOP    ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVELZADATE    WWCHK1  1
     C           WWCHK1    IFEQ *BLANK
     C                     MOVEL'0'       ZADATE
     C                     END
     C                     MOVE ZADATE    RRDPOP
     C                     ELSE
     C                     MOVE *BLANKS   RRDPOP
     C                     END
     C**
     C           PNDPCL    IFNE 0
     C                     Z-ADDPNDPCL    ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVELZADATE    WWCHK1  1
     C           WWCHK1    IFEQ *BLANK
     C                     MOVEL'0'       ZADATE
     C                     END
     C                     MOVE ZADATE    RRDPCL
     C                     ELSE
     C                     MOVE *BLANKS   RRDPCL
     C                     END
     C**
     C** FF MARGIN ACCOUNT SEQ.                                           S71062
     C           *IN20     IFEQ *ON                                       S71062
     C           PNACSQ    IFEQ *ZEROS                                    S71062
     C                     MOVE *BLANKS   RRACSQ                          S71062
     C                     ELSE                                           S71062
     C                     MOVE PNACSQ    RRACSQ                          S71062
     C                     ENDIF                                          S71062
     C                     ENDIF                                          S71062
     C**                                                                  S71062
     C           PNVLND    IFNE 0
     C                     Z-ADDPNVLND    ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVELZADATE    WWCHK1  1
     C           WWCHK1    IFEQ *BLANK
     C                     MOVEL'0'       ZADATE
     C                     END
     C                     MOVE ZADATE    RRVLND
     C                     ELSE
     C                     MOVE *BLANKS   RRVLND
     C                     END
     C**
     C           PNCASN    IFNE 0
     C                     Z-ADDPNCASN    ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVELZADATE    WWCHK1  1
     C           WWCHK1    IFEQ *BLANK
     C                     MOVEL'0'       ZADATE
     C                     END
     C                     MOVE ZADATE    RRCASN
     C                     ELSE
     C                     MOVE *BLANKS   RRCASN
     C                     END
     C**
     C           PNPDGS    IFNE 0
     C           PNPDGF    ANDGEBJRDNB
     C                     Z-ADDPNPDGS    ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVELZADATE    WWCHK1  1
     C           WWCHK1    IFEQ *BLANK
     C                     MOVEL'0'       ZADATE
     C                     END
     C                     MOVE ZADATE    RRPDGS
     C                     ELSE
     C                     MOVE *BLANKS   RRPDGS
     C                     END
     C**
     C           PNPDGF    IFGE BJRDNB
     C           PNPDGF    ANDNE99999
     C                     Z-ADDPNPDGF    ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVELZADATE    WWCHK1  1
     C           WWCHK1    IFEQ *BLANK
     C                     MOVEL'0'       ZADATE
     C                     END
     C                     MOVE ZADATE    RRPDGF
     C                     ELSE
     C                     MOVE *BLANKS   RRPDGF
     C                     END
     C*
     C           PNPDGF    IFEQ 99999
     C                     MOVE '1'       *IN89
     C                     ELSE
     C                     MOVE '0'       *IN89
     C                     END
     C**                                                   ***************
     C                     ENDSR                           * #DATF1 ENDS *
     C**                                                   ***************
     C**=================================================================
     C/EJECT
     C**=================================================================
     C**
     C** #PDET       SUBROUTINE TO DETERMINE PORTFOLIO DETAILS.
     C**
     C**    CALLED BY #PA01, #PR01
     C**    CALLS     -
     C**
     C**=================================================================
     C**                                                   ***************
     C           #PDET     BEGSR                           * #PDET BEGSR *
     C**                                                   ***************
     C                     MOVE PNPTCY    RRPTCY
     C                     MOVE PNPTFT    RRPTFT
     C                     MOVE PNMNGI    RRMNGI
     C                     MOVE PNCFGC    RRCFGC                          S01307
     C                     MOVE PNVLFQ    RRVLFQ
     C           PNVLDM    IFNE 0
     C                     MOVE PNVLDM    RRVLDM
     C                     ELSE
     C                     MOVE *BLANKS   RRVLDM
     C                     END
     C*
     C                     MOVE PNCASF    RRCASF
     C           PNCASD    IFNE 0
     C                     MOVE PNCASD    RRCASD
     C                     ELSE
     C                     MOVE *BLANKS   RRCASD
     C                     END
     C*                                                                   S01313
     C** SET UP PERFORMANCE INFORMATION                                   S01313
     C                     MOVE PNRPYP    RRRPYP                          S01313
     C*                                                                   S01313
     C           PNTYSM    IFNE 0                                         S01313
     C                     MOVE PNTYSM    RRTYSM                          S01313
     C                     ELSE                                           S01313
     C                     MOVE *BLANKS   RRTYSM                          S01313
     C                     END                                            S01313
     C*                                                                   S01313
     C                     MOVE PNADPP    RRADPP                          S01313
     C                     MOVE PNPMNG    RRPMNG                          S01313
     C*                                                                   S01313
     C           PNPSDT    IFNE 0                                         S01313
     C           PNPSDT    ANDNE99999                                     S01313
     C                     Z-ADDPNPSDT    ZDAYNO                          S01313
     C                     EXSR ZDATE2                                    S01313
     C                     MOVELZADATE    WWCHK1  1                       S01313
     C           WWCHK1    IFEQ *BLANK                                    S01313
     C                     MOVEL'0'       ZADATE                          S01313
     C                     END                                            S01313
     C                     MOVE ZADATE    RRPSDT                          S01313
     C                     ELSE                                           S01313
     C                     MOVE *BLANKS   RRPSDT                          S01313
     C                     END                                            S01313
     C*
     C                     MOVE W1CHTP    R1CHTP
     C                     Z-ADDPNDLUP    R1DLUP
     C                     MOVE PNMLUP    R1MLUP
     C                     Z-ADDPNYLUP    R1YLUP
     C                     Z-ADDPNTLUP    R1TLUP
     C****                 MOVE PNAAD1    RRAAD1                          S01313
     C****                 MOVE PNAAD2    RRAAD2                          S01313
     C****                 MOVE PNAAD3    RRAAD3                          S01313
     C****                 MOVE PNAAD4    RRAAD4                          S01313
     C****                 MOVE PNAAD5    RRAAD5                          S01313
     C                     MOVE PNS1VR    RRS1VR                          S01313
     C                     MOVE PNS2VR    RRS2VR
     C                     MOVE PNS3VR    RRS3VR
     C                     MOVE PNS4VR    RRS4VR
     C                     MOVE PNS5VR    RRS5VR
     C                     MOVE PNS6VR    RRS6VR
     C                     MOVE PNS7VR    RRS7VR                          S01313
     C                     MOVE PNS8VR    RRS8VR                          S01313
     C                     MOVE PNS0VR    RRS0VR                          CPM005
     C                     MOVE PNS9VR    RRS9VR                          CPM005
     C**                                                   ***************
     C                     ENDSR                           * #PDET ENDSR *
     C**                                                   ***************
     C**=================================================================
     C/EJECT
     C**=================================================================
     C**
     C** #DATF2      SUBROUTINE TO SET UP DATE FORMATS/CHARGES DETAILS
     C**
     C**    CALLED BY #PA01, #PR01
     C**    CALLS     ZDATE2
     C**
     C**=================================================================
     C**                                                   ***************
     C           #DATF2    BEGSR                           * #DATF2 BEGS *
     C**                                                   ***************
     C                     Z-ADDPOCGND    ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVELZADATE    WWCHK1  1
     C           WWCHK1    IFEQ *BLANK
     C                     MOVEL'0'       ZADATE
     C                     END
     C                     MOVE ZADATE    RRCGND
     C**
     C                     Z-ADDPOCSND    ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVELZADATE    WWCHK1  1
     C           WWCHK1    IFEQ *BLANK
     C                     MOVEL'0'       ZADATE
     C                     END
     C                     MOVE ZADATE    RRCSND
     C**                                                   ***************
     C                     ENDSR                           * #DATF2 ENDS *
     C**                                                   ***************
     C**=================================================================
     C/EJECT
     C**=================================================================
     C**
     C** #CDET       SUBROUTINE TO DETERMINE CHARGES DETAILS.
     C**
     C**    CALLED BY #PA01, #PR01
     C**    CALLS     -
     C**
     C**=================================================================
     C**                                                   ***************
     C           #CDET     BEGSR                           * #CDET BEGSR *
     C**                                                   ***************
     C                     MOVE WWCGCO    RRCGCO
     C                     MOVE WWCGSI    RRCGAS
     C                     MOVE POCGFQ    RRCGFQ
     C*
     C** IF FREQUENCY IS WEEKLY SET DAY IN MONTH TO BLANK
     C           POCGFQ    IFEQ 'W'
     C                     MOVE *BLANKS   RRCGDY
     C                     ELSE
     C****                 Z-ADDPOCGDY    RRCGDY                          DAVE2
     C                     MOVE POCGDY    RRCGDY                          DAVE2
     C                     END
     C*
     C                     MOVE POCGST    RRCGST
     C                     MOVE POCSFQ    RRCSFQ
     C                     Z-ADDPOCSDY    RRCSDY
     C                     Z-ADDPODLUP    R2DLUP
     C                     MOVE POMLUP    R2MLUP
     C                     Z-ADDPOYLUP    R2YLUP
     C                     Z-ADDPOTLUP    R2TLUP
     C                     MOVELPOPFRC    RRPFRC                          S01486
     C**                                                   ***************
     C                     ENDSR                           * #CDET ENDSR *
     C**                                                   ***************
     C**=================================================================
     C/EJECT
     C**=================================================================
     C**
     C** #POLI       SUBROUTINE TO DETERMINE BANK INVESTMENT POLICY
     C**
     C**    CALLED BY #PA01, #PR01
     C**    CALLS     -
     C**
     C**=================================================================
     C**                                                   ***************
     C           #POLI     BEGSR                           * #POLI BEGSR *
     C**                                                   ***************
     C                     MOVE PNPOLC    RRPOLC
     C                     MOVE PSPOLN    RRPOLN
     C**                                                   ***************
     C                     ENDSR                           * #POLI ENDSR *
     C**                                                   ***************
     C**=================================================================
     C/EJECT
     C**=================================================================
     C**
     C** #PODET      SUBROUTINE TO DETERMINE POLICIES DETAILS
     C**
     C**    CALLED BY #PA01, #PR01
     C**    CALLS     -
     C**
     C**=================================================================
     C**                                                   ***************
     C           #PODET    BEGSR                           * #PODET BEGS *
     C**                                                   ***************
     C                     MOVE PNBCGY    RRBCGY
     C                     MOVE PNCSCY    RRCSCY
     C                     MOVE PNCUSA    RRCUSA
     C                     MOVE PNIPIN    RRIPIN
     C                     MOVE PNCYIN    RRCYIN
     C                     MOVE PNYPIN    RRYPIN
     C                     MOVE PNNPIN    RRNPIN
     C**
     C** IF ANY OF POLICY INDICATORS NOT Y OUTPUT POLICY DETAILS
     C**
     C           PNIPIN    IFEQ 'Y'
     C           PNCYIN    OREQ 'Y'
     C           PNYPIN    OREQ 'Y'
     C           PNNPIN    OREQ 'Y'
     C                     MOVE '1'       *IN67
     C                     MOVE 'Y'       WWPOLC
     C                     END
     C**                                                   ***************
     C                     ENDSR                           * #PODET ENDS *
     C**                                                   ***************
     C**=================================================================
     C/EJECT
     C**=================================================================
     C**
     C** #PR02       SUBROUTINE TO PRINT PORTFOLIO CUSTOMER INVESTMENT
     C**                           POLICY DETAILS
     C**
     C**    CALLED BY #PA01, #PR01
     C**    CALLS     #PR04, #PR05, #PR06, #PR07
     C**
     C**=================================================================
     C**                                                   ***************
     C           #PR02     BEGSR                           * #PR02 BEGSR *
     C**                                                   ***************
     C**  WRITE REPORT DETAILS FOR SECOND PAGE:
     C**
     C                     WRITEDETSP
     C**
     C**  WHEN INSTRUMENT POLICY INDICATOR IS 'Y':
     C**
     C           PNIPIN    IFEQ 'Y'                        - B1
     C**
     C**  PRINT INSTRUMENT POLICY DETAILS:
     C**
     C                     EXSR #PR04
     C                     END                             - E1
     C**
     C**  WHEN CURRENCY POLICY INDICATOR IS 'Y':
     C**
     C           PNCYIN    IFEQ 'Y'                        - B1
     C**
     C**  PRINT CURRENCY POLICY DETAILS:
     C**
     C                     EXSR #PR05
     C                     END                             - E1
     C**
     C**  WHEN COUNTRY POLICY INDICATOR IS 'Y':
     C**
     C           PNYPIN    IFEQ 'Y'                        - B1
     C**
     C**  PRINT COUNTRY POLICY DETAILS:
     C**
     C                     EXSR #PR06
     C                     END                             - E1
     C**
     C**  WHEN INDUSTRY POLICY INDICATOR IS 'Y':
     C**
     C           PNNPIN    IFEQ 'Y'                        - B1
     C**
     C**  PRINT INDUSTRY POLICY DETAILS:
     C**
     C                     EXSR #PR07
     C                     END                             - E1
     C**                                                   ***************
     C                     ENDSR                           * #PR02 ENDSR *
     C**                                                   ***************
     C**=================================================================
     C/EJECT
     C**=================================================================
     C**
     C** #PR04       SUBROUTINE TO PRINT CUSTOMER INSTRUMENT POLICY DETAILS
     C**
     C**    CALLED BY #PR02
     C**    CALLS     *PSSR, #INSTG, #INSTT, #INSTA
     C**
     C**=================================================================
     C**                                                   ***************
     C           #PR04     BEGSR                           * #PR04 BEGSR *
     C**
     C                     MOVE TXT,1     RRPOLT
     C                     MOVE TXT,1     RRPOL1
     C                     MOVE 'Y'       WWFGRP  1
     C                     MOVE 'Y'       WWFIND  1
     C**
     C**  ACCESS PMCIIPLL:
     C**
     C           POKEY     SETLLPMCIIPLL
     C           POKEY     READEPMCIIPLL                 76
     C**
     C**  SO LONG AS CUSTOMER NUMBER & PORTFOLIO REFERENCE ARE SAME:
     C**
     C           *IN76     DOWEQ'0'                        - B1
     C**
     C**  FOR EACH LIVE RECORD READ:
     C**
     C           PYRECI    IFEQ 'D'                        - B2
     C**
     C** WRITE NEW PAGE HEADING ON OVERFLOW
     C**
     C           *IN70     IFEQ '1'
     C                     WRITEHEADRE
     C                     WRITEDETSP
     C                     MOVE 'Y'       WWFGRP  1
     C                     MOVE 'Y'       WWFIND  1
     C                     MOVE TXT,1     RRPOLT
     C                     MOVE TXT,1     RRPOL1
     C                     MOVE '0'       *IN70
     C                     MOVE '1'       *IN55
     C                     END
     C**
     C** IF INSTRUMENT TYPE CODE IS BLANK:
     C**
     C           RNTYPE    IFEQ '   '                      - B3
     C**
     C** IF FIRST INSTRUMENT GROUP SET UP GROUPS TEXT
     C**
     C           WWFGRP    IFEQ 'Y'
     C                     MOVE TXT,5     RRTYPE
     C                     MOVE '1'       *IN55
     C                     ELSE
     C                     MOVE *BLANKS   RRTYPE
     C                     MOVE '0'       *IN55
     C                     END
     C                     MOVE 'N'       WWFGRP
     C**
     C***ACCESS*PMPGHIPP*TO*GET*INSTRUMENT*GROUP*CODE*NARRATIVE:*******   S01486
     C** Access PMPGHIPD to get instrument group code narrative:          S01486
     C**
     C***********RNGRUP    CHAINPMPGHIPP             77                   S01486
     C           RNGRUP    CHAINPMPGHIPD             77                   S01486
     C**
     C**  IF RECORD NOT FOUND:
     C**
     C           *IN77     IFEQ '1'                        - B4
     C           PFRECI    OREQ '*'
     C           *LOCK     IN   LDA                                       S01486
     C***********          MOVEL'004'     DBASE            ***************S71062
     C                     Z-ADD4         DBASE                           S71062
     C***********          MOVEL'PMPGHIPP'DBFILE           * DB ERROR 04 *S01486
     C                     MOVE 'PMPGHIPD'DBFILE           * DB ERROR 04 *S01486
     C                     MOVELRNGRUP    DBKEY            ***************
     C                     OUT  LDA                                       S01486
     C                     EXSR *PSSR
     C                     END                             - E4
     C**
     C** SET UP INSTRUMENT POLICY GROUPS DETAILS:
     C**
     C                     EXSR #INSTG
     C**
     C** SET UP INSTRUMENT POLICY GROUPS & TYPES DETAILS:
     C**
     C                     EXSR #INSTA
     C**
     C                     WRITEINVPOL
     C                     MOVE *BLANKS   RRPOLT
     C                     MOVE *BLANKS   RRPOL1
     C**
     C** OTHERWISE:
     C**
     C                     ELSE                            - X3
     C**
     C** IF FIRST INSTRUMENT SET UP INSTRUMENT TEXT
     C**
     C           WWFIND    IFEQ 'Y'
     C                     MOVE TXT,6     RRTYPE
     C                     MOVE '1'       *IN55
     C                     ELSE
     C                     MOVE '0'       *IN55
     C                     MOVE *BLANKS   RRTYPE
     C                     END
     C                     MOVE 'N'       WWFIND
     C**
     C** ACCESS SDPLINPD TO GET INSTRUMENT NAME:
     C**
     C***********RNTYPE    CHAINSDPLINPD             78                   S01486
     C**
     C**  IF RECORD NOT FOUND:
     C**
     C************IN78     IFEQ '1'                        - B4           S01486
     C                     CALL 'AOPLINR0'                                S01486
     C                     PARM '*MSG    'WWRTCD  7                       S01486
     C                     PARM '*KEY    'WWOPTN  7                       S01486
     C                     PARM RNTYPE    WWKEY   3                       S01486
     C           SDPLIN    PARM SDPLIN    DSFDY                           S01486
     C           WWRTCD    IFNE *BLANKS                                   S01486
     C           PDRECI    OREQ '*'
     C           *LOCK     IN   LDA                                       S01486
     C***********          MOVEL'005'     DBASE            ***************S71062
     C                     Z-ADD5         DBASE                           S71062
     C***********          MOVEL'SDPLINPD'DBFILE           * DB ERROR 05 *S01486
     C                     MOVE 'SDPLINPD'DBFILE           * DB ERROR 05 *S01486
     C                     MOVELRNTYPE    DBKEY            ***************
     C                     OUT  LDA                                       S01486
     C                     EXSR *PSSR
     C                     END                             - E4
     C**
     C** SET UP INSTRUMENT POLICY TYPES DETAILS:
     C**
     C                     MOVE *BLANKS   RRGPCO
     C                     MOVE *BLANKS   RRGPNR
     C                     MOVELPDINNR    RRGPCO
     C                     MOVELPDISTN    RRGPNR
     C**
     C** SET UP INSTRUMENT POLICY GROUPS & TYPES DETAILS:
     C**
     C                     EXSR #INSTA
     C**
     C** PRINT INSTRUMENT POLICY TYPES DETAILS:
     C**
     C                     WRITEINVPOL
     C                     MOVE *BLANKS   RRPOLT
     C                     MOVE *BLANKS   RRPOL1
     C**
     C                     END                             - E3
     C**
     C                     END                             - E2
     C**
     C** ACCESS PMCIIPLL AGAIN:
     C**
     C           POKEY     READEPMCIIPLL                 76
     C                     END                             - E1
     C**                                                   ***************
     C                     ENDSR                           * #PR04 ENDSR *
     C**                                                   ***************
     C**=================================================================
     C/EJECT
     C**=================================================================
     C**
     C** #INSTG      SUBROUTINE TO SET UP GROUP DETAILS
     C**
     C**    CALLED BY #PR04
     C**    CALLS     -
     C**
     C**=================================================================
     C**                                                   ***************
     C           #INSTG    BEGSR                           * #INSTG BEGS *
     C**                                                   ***************
     C                     MOVE *BLANKS   RRGPCO
     C                     MOVE *BLANKS   RRGPNR
     C                     MOVELRNGPCO    RRGPCO
     C                     MOVELRNGPNR    RRGPNR
     C**                                                   ***************
     C                     ENDSR                           * #INSTG ENDS *
     C**                                                   ***************
     C**=================================================================
     C/EJECT
     C**=================================================================
     C**
     C** #INSTA      SUBROUTINE TO DETERMINE CUSTOMER INSTRUMENT POLICY
     C**                                     GROUPS & TYPES DETAILS
     C**
     C**    CALLED BY #PR04
     C**    CALLS     -
     C**
     C**=================================================================
     C**                                                   ***************
     C           #INSTA    BEGSR                           * #INSTA BEGS *
     C**                                                   ***************
     C                     Z-ADDRNMINR    RRMINR
     C                     Z-ADDRNMAXR    RRMAXR
     C           RNMINR    IFEQ 100                                       R00824
     C                     MOVE '0'       *IN38                           R00824
     C                     ELSE                                           R00824
     C                     MOVE '1'       *IN38                           R00824
     C                     END                                            R00824
     C           RNMINR    IFEQ 0                                         R01155
     C           RNMAXR    ANDEQ0                                         R01155
     C                     MOVE '0'       *IN37                           R01155
     C                     ELSE                                           R01155
     C                     MOVE '1'       *IN37                           R01155
     C                     END                                            R01155
     C                     Z-ADDRNDLUP    RRDLUP
     C                     MOVE RNMLUP    RRMLUP
     C                     Z-ADDRNYLUP    RRYLUP
     C                     Z-ADDRNTLUP    RRTLUP
     C**
     C** PRINT INSTRUMENT POLICY GROUPS & TYPES DETAILS:
     C**
     C           RNCHTP    IFEQ 'I'
     C                     MOVE '1'       *IN58
     C                     END
     C           RNCHTP    IFEQ 'A'
     C                     MOVE '1'       *IN59
     C                     END
     C           RNCHTP    IFEQ 'D'
     C                     MOVE '0'       *IN58
     C                     MOVE '0'       *IN59
     C                     END
     C**                                                   ***************
     C                     ENDSR                           * #INSTA ENDS *
     C**                                                   ***************
     C**=================================================================
     C/EJECT
     C**=================================================================
     C**
     C** #PR05       SUBROUTINE TO PRINT CUSTOMER CURRENCY POLICY DETAILS
     C**
     C**    CALLED BY #PR02
     C**    CALLS     *PSSR, #INSTG, #CURRC, #CURRA
     C**
     C**=================================================================
     C**                                                   ***************
     C           #PR05     BEGSR                           * #PR05 BEGSR *
     C**
     C                     MOVE TXT,2     RRPOLT
     C                     MOVE TXT,2     RRPOL1
     C                     MOVE 'Y'       WWFGRP  1
     C                     MOVE 'Y'       WWFIND  1
     C**
     C** ACCESS PMCCIPLL:
     C**
     C           POKEY     SETLLPMCCIPLL
     C           POKEY     READEPMCCIPLL                 79
     C**
     C** SO LONG AS CUSTOMER NUMBER & PORTFOLIO REFERENCE ARE SAME:
     C**
     C           *IN79     DOWEQ'0'                        - B1
     C**
     C** FOR EACH LIVE RECORD READ:
     C**
     C           PZRECI    IFEQ 'D'                        - B2
     C**
     C** WRITE NEW PAGE HEADING ON OVERFLOW
     C**
     C           *IN70     IFEQ '1'
     C                     WRITEHEADRE
     C                     WRITEDETSP
     C                     MOVE 'Y'       WWFGRP  1
     C                     MOVE 'Y'       WWFIND  1
     C                     MOVE TXT,2     RRPOLT
     C                     MOVE TXT,2     RRPOL1
     C                     MOVE '0'       *IN70
     C                     MOVE '1'       *IN55
     C                     END
     C**
     C** IF CURRENCY CODE IS BLANK:
     C**
     C           RNTYPE    IFEQ '   '                      - B3
     C**
     C** IF FIRST INSTRUMENT GROUP SET UP GROUPS TEXT
     C**
     C           WWFGRP    IFEQ 'Y'
     C                     MOVE '1'       *IN55
     C                     MOVE TXT,5     RRTYPE
     C                     ELSE
     C                     MOVE '0'       *IN55
     C                     MOVE *BLANKS   RRTYPE
     C                     END
     C                     MOVE 'N'       WWFGRP
     C**
     C***ACCESS*PMPGHCPP*TO*GET*CURRENCY*GROUP*CODE*NARRATIVE:*********   S01486
     C** Access PMPGHCPD to get currency group code narrative:            S01486
     C**
     C***********RNGRUP    CHAINPMPGHCPP             80                   S01486
     C           RNGRUP    CHAINPMPGHCPD             80                   S01486
     C**
     C**  IF RECORD NOT FOUND:
     C**
     C           *IN80     IFEQ '1'                        - B4
     C           PHRECI    OREQ '*'
     C           *LOCK     IN   LDA                                       S01486
     C***********          MOVEL'006'     DBASE            ***************S71062
     C                     Z-ADD6         DBASE                           S71062
     C***********          MOVEL'PMPGHCPP'DBFILE           * DB ERROR 06 *S01486
     C                     MOVE 'PMPGHCPD'DBFILE           * DB ERROR 06 *S01486
     C                     MOVELRNGRUP    DBKEY            ***************
     C                     OUT  LDA                                       S01486
     C                     EXSR *PSSR
     C                     END                             - E4
     C**
     C** SET UP CURRENCY POLICY GROUPS DETAILS:
     C**
     C                     EXSR #INSTG
     C                     EXSR #INSTA
     C**
     C                     WRITEINVPOL
     C                     MOVE *BLANKS   RRPOLT
     C                     MOVE *BLANKS   RRPOL1
     C**
     C** SET UP CURRENCY DETAILS
     C**
     C                     ELSE                            - X3
     C**
     C** IF FIRST INSTRUMENT SET UP INSTRUMENT TEXT
     C**
     C           WWFIND    IFEQ 'Y'
     C                     MOVE '1'       *IN55
     C                     MOVE TXT,7     RRTYPE
     C                     ELSE
     C                     MOVE '0'       *IN55
     C                     MOVE *BLANKS   RRTYPE
     C                     END
     C                     MOVE 'N'       WWFIND
     C**
     C** ACCESS SDCURRL0 TO GET CURRENCY NAME:
     C**
     C***********RNTYPE    CHAINSDCURRL0             81                   S01486
     C**
     C**  IF RECORD NOT FOUND:
     C**
     C************IN81     IFEQ '1'                        - B4           S01486
     C                     CALL 'AOCURRR0'                                S01486
     C                     PARM '*MSG    'WWRTCD  7                       S01486
     C                     PARM '*KEY    'WWOPTN  7                       S01486
     C                     PARM RNTYPE    WWKEY   3                       S01486
     C           SDCURR    PARM SDCURR    DSSDY                           S01486
     C           WWRTCD    IFNE *BLANKS                                   S01486
     C           *LOCK     IN   LDA                                       S01486
     C***********          MOVEL'007'     DBASE            ***************S71062
     C                     Z-ADD7         DBASE                           S71062
     C************         MOVEL'SDCURRL0'DBFILE           * DB ERROR 07 *S01486
     C                     MOVE 'SDCURRPD'DBFILE           * DB ERROR 07 *S01486
     C                     MOVELRNTYPE    DBKEY            ***************
     C                     OUT  LDA                                       S01486
     C                     EXSR *PSSR
     C                     END                             - E4
     C**
     C** SET UP CURRENCY POLICY CODES DETAILS:
     C**
     C                     MOVE RNTYPE    RRGPCO
     C                     MOVE *BLANKS   RRGPNR
     C                     MOVELA6CYNM    RRGPNR
     C**
     C** SET UP CURRENCY POLICY GROUPS & CODES DETAILS:
     C**
     C                     EXSR #INSTA
     C**
     C                     WRITEINVPOL
     C**
     C                     END                             - E3
     C**
     C                     END                             - E2
     C**
     C** ACCESS PMCCIPLL AGAIN:
     C**
     C           POKEY     READEPMCCIPLL                 79
     C                     END                             - E1
     C**                                                   ***************
     C                     ENDSR                           * #PR05 ENDSR *
     C**                                                   ***************
     C**=================================================================
     C/EJECT
     C**=================================================================
     C**
     C** #PR06       SUBROUTINE TO PRINT CUSTOMER COUNTRY POLICY DETAILS
     C**
     C**    CALLED BY #PR02
     C**    CALLS     *PSSR, #INSTG, #COUNC, #COUNA
     C**
     C**=================================================================
     C**                                                   ***************
     C           #PR06     BEGSR                           * #PR06 BEGSR *
     C**
     C                     MOVE TXT,3     RRPOLT
     C                     MOVE TXT,3     RRPOL1
     C                     MOVE 'Y'       WWFGRP  1
     C                     MOVE 'Y'       WWFIND  1
     C**
     C** ACCESS PMCRIPLL:
     C**
     C           POKEY     SETLLPMCRIPLL
     C           POKEY     READEPMCRIPLL                 82
     C**
     C** SO LONG AS CUSTOMER NUMBER & PORTFOLIO REFERENCE ARE SAME:
     C**
     C           *IN82     DOWEQ'0'                        - B1
     C**
     C** FOR EACH LIVE RECORD READ:
     C**
     C           P2RECI    IFEQ 'D'                        - B2
     C**
     C** WRITE NEW PAGE HEADING ON OVERFLOW
     C**
     C           *IN70     IFEQ '1'
     C                     WRITEHEADRE
     C                     WRITEDETSP
     C                     MOVE 'Y'       WWFGRP  1
     C                     MOVE 'Y'       WWFIND  1
     C                     MOVE TXT,3     RRPOLT
     C                     MOVE TXT,3     RRPOL1
     C                     MOVE '0'       *IN70
     C                     MOVE '1'       *IN55
     C                     END
     C**
     C** IF COUNTRY CODE IS BLANK:
     C**
     C           RNTYP1    IFEQ '  '                       - B3
     C**
     C** IF FIRST INSTRUMENT GROUP SET UP GROUPS TEXT
     C**
     C           WWFGRP    IFEQ 'Y'
     C                     MOVE TXT,5     RRTYPE
     C                     MOVE '1'       *IN55
     C                     ELSE
     C                     MOVE '0'       *IN55
     C                     MOVE *BLANKS   RRTYPE
     C                     END
     C                     MOVE 'N'       WWFGRP
     C**
     C***ACCESS*PMPGHRPP*TO*GET*COUNTRY*GROUP*CODE*NARRATIVE:**********   S01486
     C** Access PMPGHRPD to get country group code narrative:             S01486
     C**
     C***********RNGRUP    CHAINPMPGHRPP             83                   S01486
     C           RNGRUP    CHAINPMPGHRPD             83                   S01486
     C**
     C**  IF RECORD NOT FOUND:
     C**
     C           *IN83     IFEQ '1'                        - B4
     C           PJRECI    OREQ '*'
     C           *LOCK     IN   LDA                                       S01486
     C***********          MOVEL'008'     DBASE            ***************S71062
     C                     Z-ADD8         DBASE                           S71062
     C***********          MOVEL'PMPGHRPP'DBFILE           * DB ERROR 08 *S01486
     C                     MOVE 'PMPGHRPD'DBFILE           * DB ERROR 08 *S01486
     C                     MOVELRNGRUP    DBKEY            ***************
     C                     OUT  LDA                                       S01486
     C                     EXSR *PSSR
     C                     END                             - E4
     C**
     C** SET UP COUNTRY POLICY GROUPS DETAILS:
     C**
     C                     EXSR #INSTG
     C**
     C** SET UP COUNTRY POLICY GROUPS & CODES DETAILS:
     C**
     C                     EXSR #INSTA
     C**
     C                     WRITEINVPOL
     C                     MOVE *BLANKS   RRPOLT
     C                     MOVE *BLANKS   RRPOL1
     C**
     C** OTHERWISE COUNTRY CODE ENTERED
     C**
     C                     ELSE                            - X3
     C**
     C** IF FIRST INSTRUMENT SET UP INSTRUMENT TEXT
     C**
     C           WWFIND    IFEQ 'Y'
     C                     MOVE '1'       *IN55
     C                     MOVE TXT,8     RRTYPE
     C                     ELSE
     C                     MOVE '0'       *IN55
     C                     MOVE *BLANKS   RRTYPE
     C                     END
     C                     MOVE 'N'       WWFIND
     C**
     C** ACCESS SDCTRYL1 TO GET COUNTRY NAME:
     C**
     C***********RNTYP1    CHAINSDCTRYL1             84                   S01486
     C**
     C**  IF RECORD NOT FOUND DATABASE ERROR
     C**
     C************IN84     IFEQ '1'                        - B4           S01486
     C                     CALL 'AOCTRYR0'                                S01486
     C                     PARM '*MSG    'WWRTCD  7                       S01486
     C                     PARM '*KEY    'WWOPTN  7                       S01486
     C                     PARM RNTYP1    WWKEY2  2                       S01486
     C           SDCTRY    PARM SDCTRY    DSFDY                           S01486
     C           WWRTCD    IFNE *BLANKS                                   S01486
     C           *LOCK     IN   LDA                                       S01486
     C***********          MOVEL'009'     DBASE            ***************S71062
     C                     Z-ADD9         DBASE                           S71062
     C************         MOVEL'SDCTRYL1'DBFILE           * DB ERROR 09 *S01486
     C                     MOVE 'SDCTRYPD'DBFILE           * DB ERROR 09 *S01486
     C                     MOVELRNTYP1    DBKEY            ***************
     C                     OUT  LDA                                       S01486
     C                     EXSR *PSSR
     C                     END                             - E4
     C**
     C** SET UP COUNTRY POLICY CODES DETAILS:
     C**
     C                     EXSR #INSTA
     C**
     C** SET UP COUNTRY POLICY GROUPS & CODES DETAILS:
     C**
     C                     MOVE *BLANKS   RRGPCO
     C                     MOVE *BLANKS   RRGPNR
     C                     MOVELRNTYP1    RRGPCO
     C                     MOVELA4CNNM    RRGPNR
     C**
     C** PRINT INSTRUMENT POLICY TYPES DETAILS:
     C**
     C                     WRITEINVPOL
     C                     MOVE *BLANKS   RRPOLT
     C                     MOVE *BLANKS   RRPOL1
     C**
     C                     END                             - E3
     C**
     C                     END                             - E2
     C**
     C** ACCESS PMCRIPLL AGAIN:
     C**
     C           POKEY     READEPMCRIPLL                 82
     C                     END                             - E1
     C**                                                   ***************
     C                     ENDSR                           * #PR06 ENDSR *
     C**                                                   ***************
     C**=================================================================
     C/EJECT
     C**=================================================================
     C**
     C** #PR07       SUBROUTINE TO PRINT CUSTOMER INDUSTRY POLICY DETAILS
     C**
     C**    CALLED BY #PR02
     C**    CALLS     *PSSR, #INSTG, #INDUC, #INDUA
     C**
     C**=================================================================
     C**                                                   ***************
     C           #PR07     BEGSR                           * #PR07 BEGSR *
     C**
     C                     MOVE TXT,4     RRPOLT
     C                     MOVE TXT,4     RRPOL1
     C                     MOVE 'Y'       WWFGRP  1
     C                     MOVE 'Y'       WWFIND  1
     C**
     C** ACCESS PMCDIPLL:
     C**
     C           POKEY     SETLLPMCDIPLL
     C           POKEY     READEPMCDIPLL                 85
     C**
     C** SO LONG AS CUSTOMER NUMBER & PORTFOLIO REFERENCE ARE SAME:
     C**
     C           *IN85     DOWEQ'0'                        - B1
     C**
     C** FOR EACH LIVE RECORD READ:
     C**
     C           P1RECI    IFEQ 'D'                        - B2
     C**
     C** WRITE NEW PAGE HEADING ON OVERFLOW
     C**
     C           *IN70     IFEQ '1'
     C                     WRITEHEADRE
     C                     WRITEDETSP
     C                     MOVE 'Y'       WWFGRP  1
     C                     MOVE 'Y'       WWFIND  1
     C                     MOVE TXT,4     RRPOLT
     C                     MOVE TXT,4     RRPOL1
     C                     MOVE '0'       *IN70
     C                     MOVE '1'       *IN55
     C                     END
     C**
     C** IF LOCAL INDUSTRY CODE IS BLANK:
     C**
     C           P1LIND    IFEQ *ZERO                      - B3
     C**
     C** IF FIRST INSTRUMENT GROUP SET UP GROUPS TEXT
     C**
     C           WWFGRP    IFEQ 'Y'
     C                     MOVE TXT,5     RRTYPE
     C                     MOVE '1'       *IN55
     C                     ELSE
     C                     MOVE '0'       *IN55
     C                     MOVE *BLANKS   RRTYPE
     C                     END
     C                     MOVE 'N'       WWFGRP
     C**
     C***ACCESS*PMPGHDPP*TO*GET*INDUSTRY*GROUP*CODE*NARRATIVE:*********   S01486
     C** Access PMPGHDPD to get industry group code narrative:            S01486
     C**
     C***********RNGRUP    CHAINPMPGHDPP             86                   S01486
     C           RNGRUP    CHAINPMPGHDPD             86                   S01486
     C**
     C**  IF RECORD NOT FOUND THEN DATABASE ERROR
     C**
     C           *IN86     IFEQ '1'                        - B4
     C           PLRECI    OREQ '*'
     C           *LOCK     IN   LDA                                       S01486
     C***********          MOVEL'010'     DBASE            ***************S71062
     C                     Z-ADD10        DBASE                           S71062
     C***********          MOVEL'PMPGHDPP'DBFILE           * DB ERROR 10 *S01486
     C                     MOVE 'PMPGHDPD'DBFILE           * DB ERROR 10 *S01486
     C                     MOVELRNGRUP    DBKEY            ***************
     C                     OUT  LDA                                       S01486
     C                     EXSR *PSSR
     C                     END                             - E4
     C**
     C** SET UP INDUSTRY POLICY GROUPS DETAILS:
     C**
     C                     EXSR #INSTG
     C**
     C** SET UP INDUSTRY POLICY GROUPS & CODES DETAILS:
     C**
     C                     EXSR #INSTA
     C**
     C                     WRITEINVPOL
     C                     MOVE *BLANKS   RRPOLT
     C                     MOVE *BLANKS   RRPOL1
     C**
     C** OTHERWISE FORMAT INDUSTRY DETAILS FOR OUTPUT
     C**
     C                     ELSE                            - X3
     C**
     C** IF FIRST INSTRUMENT SET UP INSTRUMENT TEXT
     C**
     C           WWFIND    IFEQ 'Y'
     C                     MOVE '1'       *IN55
     C                     MOVE TXT,9     RRTYPE
     C                     ELSE
     C                     MOVE '0'       *IN55
     C                     MOVE *BLANKS   RRTYPE
     C                     END
     C                     MOVE 'N'       WWFIND
     C**
     C** ACCESS SDINDSL1 TO GET LOCAL INDUSTRY NAME:
     C**
     C                     MOVE P1LIND    WWLICD  3
     C***********WWLICD    CHAINSDINDSL1             87                   S01486
     C                     CALL 'AOINDSR0'                                S01486
     C                     PARM '*MSG    'WWRTCD  7                       S01486
     C                     PARM '*KEY    'WWOPTN  7                       S01486
     C                     PARM WWLICD    WWKEY   3                       S01486
     C           SDINDS    PARM SDINDS    DSFDY                           S01486
     C**
     C**  IF RECORD NOT FOUND THEN DATABASE ERROR
     C**
     C************IN87     IFEQ '1'                        - B4           S01486
     C           WWRTCD    IFNE *BLANKS                                   S01486
     C           *LOCK     IN   LDA                                       S01486
     C***********          MOVEL'011'     DBASE            ***************S71062
     C                     Z-ADD11        DBASE                           S71062
     C***********          MOVEL'SDINDSL1'DBFILE           * DB ERROR 11 *S01486
     C                     MOVE 'SDINDSPD'DBFILE           * DB ERROR 11 *S01486
     C                     MOVELWWLICD    DBKEY            ***************
     C                     OUT  LDA                                       S01486
     C                     EXSR *PSSR
     C                     END                             - E4
     C**
     C** SET UP INDUSTRY POLICY CODES DETAILS:
     C**
     C                     EXSR #INSTA
     C**
     C** SET UP INDUSTRY POLICY GROUPS & CODES DETAILS:
     C**
     C                     MOVE *BLANKS   RRGPCO
     C                     MOVE *BLANKS   RRGPNR
     C                     MOVELAOLICD    RRGPCO
     C                     MOVELAOLINA    RRGPNR
     C**
     C                     WRITEINVPOL
     C                     MOVE *BLANKS   RRPOLT
     C                     MOVE *BLANKS   RRPOL1
     C                     END                             - E3
     C**
     C                     END                             - E2
     C**
     C** ACCESS PMCDIPLL AGAIN:
     C**
     C           POKEY     READEPMCDIPLL                 85
     C                     END                             - E1
     C**
     C** SET OFF GROUPS & INDUSTRIES PRINTING INDICATORS:
     C**
     C                     MOVE '0'       *IN51
     C                     MOVE '0'       *IN52
     C**                                                   ***************
     C                     ENDSR                           * #PR07 ENDSR *
     C**                                                   ***************
     C**=================================================================
     C/EJECT
     C**=================================================================
     C**
     C** #PR03       SUBROUTINE TO PRINT PORTFOLIO BANK INVESTMENT
     C**                                 POLICY DETAILS
     C**
     C**    CALLED BY #PA01, #PR01
     C**    CALLS     #PR08, #PR09, #PR10, #PR11
     C**
     C**=================================================================
     C**                                                   ***************
     C           #PR03     BEGSR                           * #PR03 BEGSR *
     C**                                                   ***************
     C** WRITE REPORT DETAILS FOR SECOND PAGE:
     C**
     C                     MOVE '1'       *IN53
     C                     WRITEDETSP
     C                     MOVE '0'       *IN53
     C**
     C** WHEN INSTRUMENT POLICY INDICATOR IS 'Y':
     C**
     C           PSIPIN    IFEQ 'Y'                        - B1
     C**
     C** PRINT INSTRUMENT POLICY DETAILS:
     C**
     C                     EXSR #PR08
     C                     END                             - E1
     C**
     C** WHEN CURRENCY POLICY INDICATOR IS 'Y':
     C**
     C           PSCYIN    IFEQ 'Y'                        - B1
     C**
     C** PRINT CURRENCY POLICY DETAILS:
     C**
     C                     EXSR #PR09
     C                     END                             - E1
     C**
     C** WHEN COUNTRY POLICY INDICATOR IS 'Y':
     C**
     C           PSYPIN    IFEQ 'Y'                        - B1
     C**
     C** PRINT COUNTRY POLICY DETAILS:
     C**
     C                     EXSR #PR10
     C                     END                             - E1
     C**
     C** WHEN INDUSTRY POLICY INDICATOR IS 'Y':
     C**
     C           PSNPIN    IFEQ 'Y'                        - B1
     C**
     C** PRINT INDUSTRY POLICY DETAILS:
     C**
     C                     EXSR #PR11
     C                     END                             - E1
     C**                                                   ***************
     C                     ENDSR                           * #PR03 ENDSR *
     C**                                                   ***************
     C**=================================================================
     C/EJECT
     C**=================================================================
     C**
     C** #PR08       SUBROUTINE TO PRINT BANK INSTRUMENT POLICY DETAILS
     C**
     C**    CALLED BY #PR03
     C**    CALLS     *PSSR, #INSTH, #INSTU, #INSTB
     C**
     C**=================================================================
     C**                                                   ***************
     C           #PR08     BEGSR                           * #PR08 BEGSR *
     C**
     C                     MOVE TXT,1     RRPOLT
     C                     MOVE TXT,1     RRPOL1
     C                     MOVE 'Y'       WWFGRP  1
     C                     MOVE 'Y'       WWFIND  1
     C**
     C** ACCESS PMBIIPLL:
     C**
     C           PNPOLC    SETLLPMBIIPLL
     C           PNPOLC    READEPMBIIPLL                 22
     C**
     C** SO LONG AS BANK INVESTMENT POLICY CODE IS SAME:
     C**
     C           *IN22     DOWEQ'0'                        - B1
     C**
     C** FOR EACH LIVE RECORD READ:
     C**
     C           PTRECI    IFEQ 'D'                        - B2
     C**
     C** WRITE NEW PAGE HEADING ON OVERFLOW
     C**
     C           *IN70     IFEQ '1'
     C                     WRITEHEADRE
     C                     WRITEDETSP
     C                     MOVE 'Y'       WWFGRP  1
     C                     MOVE 'Y'       WWFIND  1
     C                     MOVE TXT,1     RRPOLT
     C                     MOVE TXT,1     RRPOL1
     C                     MOVE '0'       *IN70
     C                     MOVE '1'       *IN55
     C                     END
     C**
     C** IF INSTRUMENT TYPE CODE IS BLANK:
     C**
     C           RNTYPE    IFEQ '   '                      - B3
     C**
     C** IF FIRST INSTRUMENT GROUP SET UP GROUPS TEXT
     C**
     C           WWFGRP    IFEQ 'Y'
     C                     MOVE TXT,5     RRTYPE
     C                     MOVE '1'       *IN55
     C                     ELSE
     C                     MOVE '0'       *IN55
     C                     MOVE *BLANKS   RRTYPE
     C                     END
     C                     MOVE 'N'       WWFGRP
     C**
     C***ACCESS*PMPGHIPP*TO*GET*INSTRUMENT*GROUP*CODE*NARRATIVE:*******   S01486
     C** Access PMPGHIPD to get instrument group code narrative:          S01486
     C**
     C***********RNGRUP    CHAINPMPGHIPP             77                   S01486
     C           RNGRUP    CHAINPMPGHIPD             77                   S01486
     C**
     C**  IF RECORD NOT FOUND THEN DATABASE ERROR
     C**
     C           *IN77     IFEQ '1'                        - B4
     C           PFRECI    OREQ '*'
     C           *LOCK     IN   LDA                                       S01486
     C***********          MOVEL'012'     DBASE            ***************S71062
     C                     Z-ADD12        DBASE                           S71062
     C***********          MOVEL'PMPGHIPP'DBFILE           * DB ERROR 12 *S01486
     C                     MOVE 'PMPGHIPD'DBFILE           * DB ERROR 12 *S01486
     C                     MOVELRNGRUP    DBKEY            ***************
     C                     OUT  LDA                                       S01486
     C                     EXSR *PSSR
     C                     END                             - E4
     C**
     C** SET UP INSTRUMENT POLICY GROUPS DETAILS:
     C**
     C                     EXSR #INSTG
     C**
     C** SET UP INSTRUMENT POLICY GROUPS & TYPES DETAILS:
     C**
     C                     EXSR #INSTA
     C**
     C                     WRITEINVPOL
     C                     MOVE *BLANKS   RRPOLT
     C                     MOVE *BLANKS   RRPOL1
     C**
     C** OTHERWISE FORMAT INSTRUMENT DETAILS
     C**
     C                     ELSE                            - X3
     C**
     C** IF FIRST INSTRUMENT SET UP INSTRUMENT TEXT
     C**
     C           WWFIND    IFEQ 'Y'
     C                     MOVE TXT,6     RRTYPE
     C                     MOVE '1'       *IN55
     C                     ELSE
     C                     MOVE '0'       *IN55
     C                     MOVE *BLANKS   RRTYPE
     C                     END
     C                     MOVE 'N'       WWFIND
     C**
     C** ACCESS SDPLINPD TO GET INSTRUMENT NAME:
     C**
     C***********RNTYPE    CHAINSDPLINPD             78                   S01486
     C**
     C**  IF RECORD NOT FOUND THEN DATABASE ERROR
     C**
     C************IN78     IFEQ '1'                        - B4           S01486
     C                     CALL 'AOPLINR0'                                S01486
     C                     PARM '*MSG    'WWRTCD  7                       S01486
     C                     PARM '*KEY    'WWOPTN  7                       S01486
     C                     PARM RNTYPE    WWKEY   3                       S01486
     C           SDPLIN    PARM SDPLIN    DSFDY                           S01486
     C           WWRTCD    IFNE *BLANKS                                   S01486
     C           PDRECI    OREQ '*'
     C           *LOCK     IN   LDA                                       S01486
     C***********          MOVEL'013'     DBASE            ***************S71062
     C                     Z-ADD13        DBASE                           S71062
     C***********          MOVEL'SDPLINPD'DBFILE           * DB ERROR 13 *S01486
     C                     MOVE 'SDPLINPD'DBFILE           * DB ERROR 13 *S01486
     C                     MOVELRNTYPE    DBKEY            ***************
     C                     OUT  LDA                                       S01486
     C                     EXSR *PSSR
     C                     END                             - E4
     C**
     C** SET UP INSTRUMENT POLICY TYPES DETAILS:
     C**
     C                     MOVE *BLANKS   RRGPCO
     C                     MOVE *BLANKS   RRGPNR
     C                     MOVELPDINNR    RRGPCO
     C                     MOVELPDISTN    RRGPNR
     C**
     C** SET UP INSTRUMENT POLICY GROUPS & TYPES DETAILS:
     C**
     C                     EXSR #INSTA
     C**
     C** PRINT INSTRUMENT POLICY TYPES DETAILS:
     C**
     C                     WRITEINVPOL
     C                     MOVE *BLANKS   RRPOLT
     C                     MOVE *BLANKS   RRPOL1
     C**
     C                     END                             - E3
     C**
     C                     END                             - E2
     C**
     C** ACCESS PMBIIPLL AGAIN:
     C**
     C           PNPOLC    READEPMBIIPLL                 22
     C                     END                             - E1
     C**                                                   ***************
     C                     ENDSR                           * #PR08 ENDSR *
     C**=================================================================
     C/EJECT
     C**=================================================================
     C**
     C** #PR09       SUBROUTINE TO PRINT BANK CURRENCY POLICY DETAILS
     C**
     C**    CALLED BY #PR03
     C**    CALLS     *PSSR, #CURRH, #CURRD, #CURRB
     C**
     C**=================================================================
     C**                                                   ***************
     C           #PR09     BEGSR                           * #PR09 BEGSR *
     C**
     C                     MOVE TXT,2     RRPOLT
     C                     MOVE TXT,2     RRPOL1
     C                     MOVE 'Y'       WWFGRP  1
     C                     MOVE 'Y'       WWFIND  1
     C**
     C** ACCESS PMBCIPLL:
     C**
     C           PNPOLC    SETLLPMBCIPLL
     C           PNPOLC    READEPMBCIPLL                 23
     C**
     C** SO LONG AS BANK INVESTMENT POLICY CODE IS SAME:
     C**
     C           *IN23     DOWEQ'0'                        - B1
     C**
     C** FOR EACH LIVE RECORD READ:
     C**
     C           PURECI    IFEQ 'D'                        - B2
     C**
     C** WRITE NEW PAGE HEADING ON OVERFLOW
     C**
     C           *IN70     IFEQ '1'
     C                     WRITEHEADRE
     C                     WRITEDETSP
     C                     MOVE 'Y'       WWFGRP  1
     C                     MOVE 'Y'       WWFIND  1
     C                     MOVE TXT,2     RRPOLT
     C                     MOVE TXT,2     RRPOL1
     C                     MOVE '0'       *IN70
     C                     MOVE '1'       *IN55
     C                     END
     C**
     C** IF CURRENCY CODE IS BLANK:
     C**
     C           RNTYPE    IFEQ '   '                      - B3
     C**
     C** IF FIRST INSTRUMENT GROUP SET UP GROUPS TEXT
     C**
     C           WWFGRP    IFEQ 'Y'
     C                     MOVE '1'       *IN55
     C                     MOVE TXT,5     RRTYPE
     C                     ELSE
     C                     MOVE '0'       *IN55
     C                     MOVE *BLANKS   RRTYPE
     C                     END
     C                     MOVE 'N'       WWFGRP
     C**
     C***ACCESS*PMPGHCPP*TO*GET*CURRENCY*GROUP*CODE*NARRATIVE:*********   S01486
     C** Access PMPGHCPD to get currency group code narrative:            S01486
     C**
     C***********RNGRUP    CHAINPMPGHCPP             80                   S01486
     C           RNGRUP    CHAINPMPGHCPD             80                   S01486
     C**
     C**  IF RECORD NOT FOUND THEN DATABASE ERROR
     C**
     C           *IN80     IFEQ '1'                        - B4
     C           PHRECI    OREQ '*'
     C           *LOCK     IN   LDA                                       S01486
     C***********          MOVEL'014'     DBASE            ***************S71062
     C                     Z-ADD14        DBASE                           S71062
     C***********          MOVEL'PMPGHCPP'DBFILE           * DB ERROR 14 *S01486
     C                     MOVE 'PMPGHCPD'DBFILE           * DB ERROR 14 *S01486
     C                     MOVELRNGRUP    DBKEY            ***************
     C                     OUT  LDA                                       S01486
     C                     EXSR *PSSR
     C                     END                             - E4
     C**
     C** SET UP CURRENCY POLICY GROUPS DETAILS:
     C**
     C                     EXSR #INSTG
     C                     EXSR #INSTA
     C**
     C                     WRITEINVPOL
     C                     MOVE *BLANKS   RRPOLT
     C                     MOVE *BLANKS   RRPOL1
     C                     ELSE                            - X3
     C**
     C** IF FIRST INSTRUMENT SET UP INSTRUMENT TEXT
     C**
     C           WWFIND    IFEQ 'Y'
     C                     MOVE '1'       *IN55
     C                     MOVE TXT,7     RRTYPE
     C                     ELSE
     C                     MOVE '0'       *IN55
     C                     MOVE *BLANKS   RRTYPE
     C                     END
     C                     MOVE 'N'       WWFIND
     C**
     C** ACCESS SDCURRL0 TO GET CURRENCY NAME:
     C**
     C***********RNTYPE    CHAINSDCURRL0             81
     C**
     C**  IF RECORD NOT FOUND THEN DATABASE ERROR
     C**
     C************IN81     IFEQ '1'                        - B4
     C                     CALL 'AOCURRR0'                                S01486
     C                     PARM '*MSG    'WWRTCD  7                       S01486
     C                     PARM '*KEY    'WWOPTN  7                       S01486
     C                     PARM RNTYPE    WWKEY   3                       S01486
     C           SDCURR    PARM SDCURR    DSSDY                           S01486
     C           WWRTCD    IFNE *BLANKS                                   S01486
     C           *LOCK     IN   LDA                                       S01486
     C***********          MOVEL'015'     DBASE            ***************S71062
     C                     Z-ADD15        DBASE                           S71062
     C************         MOVEL'SDCURRL0'DBFILE           * DB ERROR 15 *S01486
     C                     MOVE 'SDCURRPD'DBFILE           * DB ERROR 15 *S01486
     C                     MOVELRNTYPE    DBKEY            ***************
     C                     OUT  LDA                                       S01486
     C                     EXSR *PSSR
     C                     END                             - E4
     C**
     C** SET UP CURRENCY POLICY CODES DETAILS:
     C**
     C                     MOVE RNTYPE    RRGPCO
     C                     MOVE *BLANKS   RRGPNR
     C                     MOVELA6CYNM    RRGPNR
     C**
     C** SET UP CURRENCY POLICY GROUPS & CODES DETAILS:
     C**
     C                     EXSR #INSTA
     C**
     C                     WRITEINVPOL
     C**
     C                     END                             - E3
     C**
     C                     END                             - E2
     C**
     C** ACCESS PMBCIPLL AGAIN:
     C**
     C           PNPOLC    READEPMBCIPLL                 23
     C                     END                             - E1
     C**                                                   ***************
     C                     ENDSR                           * #PR09 ENDSR *
     C**                                                   ***************
     C**=================================================================
     C/EJECT
     C**=================================================================
     C**
     C** #PR10       SUBROUTINE TO PRINT BANK COUNTRY POLICY DETAILS
     C**
     C**    CALLED BY #PR03
     C**    CALLS     *PSSR, #COUNH, #COUND, #COUNB
     C**
     C**=================================================================
     C**                                                   ***************
     C           #PR10     BEGSR                           * #PR10 BEGSR *
     C**
     C                     MOVE TXT,3     RRPOLT
     C                     MOVE TXT,3     RRPOL1
     C                     MOVE 'Y'       WWFGRP  1
     C                     MOVE 'Y'       WWFIND  1
     C**
     C** ACCESS PMBRIPLL:
     C**
     C           PNPOLC    SETLLPMBRIPLL
     C           PNPOLC    READEPMBRIPLL                 24
     C**
     C** SO LONG AS BANK INVESTMENT POLICY CODE IS SAME:
     C**
     C           *IN24     DOWEQ'0'                        - B1
     C**
     C** FOR EACH LIVE RECORD READ:
     C**
     C           PXRECI    IFEQ 'D'                        - B2
     C**
     C** WRITE NEW PAGE HEADING ON OVERFLOW
     C**
     C           *IN70     IFEQ '1'
     C                     WRITEHEADRE
     C                     WRITEDETSP
     C                     MOVE 'Y'       WWFGRP  1
     C                     MOVE 'Y'       WWFIND  1
     C                     MOVE TXT,3     RRPOLT
     C                     MOVE TXT,3     RRPOL1
     C                     MOVE '0'       *IN70
     C                     MOVE '1'       *IN55
     C                     END
     C**
     C** IF COUNTRY CODE IS BLANK:
     C**
     C           RNTYP1    IFEQ '  '                       - B3
     C**
     C** IF FIRST INSTRUMENT GROUP SET UP GROUPS TEXT
     C**
     C           WWFGRP    IFEQ 'Y'
     C                     MOVE TXT,5     RRTYPE
     C                     MOVE '1'       *IN55
     C                     ELSE
     C                     MOVE '0'       *IN55
     C                     MOVE *BLANKS   RRTYPE
     C                     END
     C                     MOVE 'N'       WWFGRP
     C**
     C***ACCESS*PMPGHRPP TO GET COUNTRY GROUP CODE NARRATIVE:
     C** ACCESS PMPGHRPD TO GET COUNTRY GROUP CODE NARRATIVE:
     C**
     C***********RNGRUP    CHAINPMPGHRPP             83                   S01486
     C           RNGRUP    CHAINPMPGHRPD             83                   S01486
     C**
     C**  IF RECORD NOT FOUND THEN DATABASE ERROR
     C**
     C           *IN83     IFEQ '1'                        - B4
     C           PJRECI    OREQ '*'
     C           *LOCK     IN   LDA                                       S01486
     C***********          MOVEL'016'     DBASE            ***************S71062
     C                     Z-ADD16        DBASE                           S71062
     C***********          MOVEL'PMPGHRPP'DBFILE           * DB ERROR 16 *S01486
     C                     MOVE 'PMPGHRPD'DBFILE           * DB ERROR 16 *S01486
     C                     MOVELRNGRUP    DBKEY            ***************
     C                     OUT  LDA                                       S01486
     C                     EXSR *PSSR
     C                     END                             - E4
     C**
     C** SET UP COUNTRY POLICY GROUPS DETAILS:
     C**
     C                     EXSR #INSTG
     C**
     C** SET UP COUNTRY POLICY GROUPS & CODES DETAILS:
     C**
     C                     EXSR #INSTA
     C**
     C                     WRITEINVPOL
     C                     MOVE *BLANKS   RRPOLT
     C                     MOVE *BLANKS   RRPOL1
     C**
     C** OTHERWISE FORMAT COUNTRY DETAILS FOR OUTPUT
     C**
     C                     ELSE                            - X3
     C**
     C** IF FIRST INSTRUMENT SET UP INSTRUMENT TEXT
     C**
     C           WWFIND    IFEQ 'Y'
     C                     MOVE '1'       *IN55
     C                     MOVE TXT,8     RRTYPE
     C                     ELSE
     C                     MOVE '0'       *IN55
     C                     MOVE *BLANKS   RRTYPE
     C                     END
     C                     MOVE 'N'       WWFIND
     C**
     C** ACCESS SDCTRYL1 TO GET COUNTRY NAME:
     C**
     C***********RNTYP1    CHAINSDCTRYL1             84
     C**
     C**  IF RECORD NOT FOUND THEN DATABASE ERROR
     C**
     C************IN84     IFEQ '1'                        - B4
     C                     CALL 'AOCTRYR0'                                S01486
     C                     PARM '*MSG    'WWRTCD  7                       S01486
     C                     PARM '*KEY    'WWOPTN  7                       S01486
     C                     PARM RNTYP1    WWKEY2  2                       S01486
     C           SDCTRY    PARM SDCTRY    DSFDY                           S01486
     C           WWRTCD    IFNE *BLANKS                                   S01486
     C           *LOCK     IN   LDA                                       S01486
     C***********          MOVEL'017'     DBASE            ***************S71062
     C                     Z-ADD17        DBASE                           S71062
     C************         MOVEL'SDCTRYL1'DBFILE           * DB ERROR 17 *S01486
     C                     MOVE 'SDCTRYPD'DBFILE           * DB ERROR 17 *S01486
     C                     MOVELRNTYP1    DBKEY            ***************
     C                     OUT  LDA                                       S01486
     C                     EXSR *PSSR
     C                     END                             - E4
     C**
     C** SET UP COUNTRY POLICY CODES DETAILS:
     C**
     C                     EXSR #INSTA
     C**
     C** SET UP COUNTRY POLICY GROUPS & CODES DETAILS:
     C**
     C                     MOVE *BLANKS   RRGPCO
     C                     MOVE *BLANKS   RRGPNR
     C                     MOVELRNTYP1    RRGPCO
     C                     MOVELA4CNNM    RRGPNR
     C**
     C** PRINT INSTRUMENT POLICY TYPES DETAILS:
     C**
     C                     WRITEINVPOL
     C                     MOVE *BLANKS   RRPOLT
     C                     MOVE *BLANKS   RRPOL1
     C**
     C                     END                             - E3
     C**
     C                     END                             - E2
     C**
     C** ACCESS PMBRIPLL AGAIN:
     C**
     C           PNPOLC    READEPMBRIPLL                 24
     C                     END                             - E1
     C**                                                   **************
     C                     ENDSR                           * #PR10 ENDS *
     C**                                                   **************
     C**=================================================================
     C/EJECT
     C**=================================================================
     C**
     C** #PR11       SUBROUTINE TO PRINT BANK INDUSTRY POLICY DETAILS
     C**
     C**    CALLED BY #PR03
     C**    CALLS     *PSSR, #INDUH, #INDUD, #INDUB
     C**
     C**=================================================================
     C**                                                   ***************
     C           #PR11     BEGSR                           * #PR11 BEGSR *
     C**
     C                     MOVE TXT,4     RRPOLT
     C                     MOVE TXT,4     RRPOL1
     C                     MOVE 'Y'       WWFGRP  1
     C                     MOVE 'Y'       WWFIND  1
     C**
     C** ACCESS PMBDIPLL:
     C**
     C           PNPOLC    SETLLPMBDIPLL
     C           PNPOLC    READEPMBDIPLL                 25
     C**
     C** SO LONG AS BANK INVESTMENT POLICY CODE IS SAME:
     C**
     C           *IN25     DOWEQ'0'                        - B1
     C**
     C** FOR EACH LIVE RECORD READ:
     C**
     C           PWRECI    IFEQ 'D'                        - B2
     C**
     C** WRITE NEW PAGE HEADING ON OVERFLOW
     C**
     C           *IN70     IFEQ '1'
     C                     WRITEHEADRE
     C                     WRITEDETSP
     C                     MOVE 'Y'       WWFGRP  1
     C                     MOVE 'Y'       WWFIND  1
     C                     MOVE TXT,4     RRPOLT
     C                     MOVE TXT,4     RRPOL1
     C                     MOVE '0'       *IN70
     C                     MOVE '1'       *IN55
     C                     END
     C**
     C** IF LOCAL INDUSTRY CODE IS BLANK:
     C**
     C           PWLIND    IFEQ *ZERO                      - B3
     C**
     C** IF FIRST INSTRUMENT GROUP SET UP GROUPS TEXT
     C**
     C           WWFGRP    IFEQ 'Y'
     C                     MOVE '1'       *IN55
     C                     MOVE TXT,5     RRTYPE
     C                     ELSE
     C                     MOVE *BLANKS   RRTYPE
     C                     MOVE '0'       *IN55
     C                     END
     C                     MOVE 'N'       WWFGRP
     C**
     C***ACCESS*PMPGHDPP*TO*GET*INDUSTRY*GROUP*CODE*NARRATIVE:*********   S01486
     C** Access PMPGHDPD to get industry group code narrative:            S01486
     C**
     C***********RNGRUP    CHAINPMPGHDPP             86                   S01486
     C           RNGRUP    CHAINPMPGHDPD             86                   S01486
     C**
     C**  IF RECORD NOT FOUND THEN DATABASE ERROR
     C**
     C           *IN86     IFEQ '1'                        - B4
     C           PLRECI    OREQ '*'
     C           *LOCK     IN   LDA                                       S01486
     C***********          MOVEL'018'     DBASE            ***************S71062
     C                     Z-ADD18        DBASE                           S71062
     C************         MOVEL'PMPGHDPP'DBFILE           * DB ERROR 18 *S01486
     C                     MOVE 'PMPGHDPD'DBFILE           * DB ERROR 18 *S01486
     C                     MOVELRNGRUP    DBKEY            ***************
     C                     OUT  LDA                                       S01486
     C                     EXSR *PSSR
     C                     END                             - E4
     C**
     C** SET UP INDUSTRY POLICY GROUPS DETAILS:
     C**
     C                     EXSR #INSTG
     C**
     C** SET UP INDUSTRY POLICY GROUPS & CODES DETAILS:
     C**
     C                     EXSR #INSTA
     C**
     C                     WRITEINVPOL
     C                     MOVE *BLANKS   RRPOLT
     C                     MOVE *BLANKS   RRPOL1
     C**
     C** OTHERWISE FORMAT INDUSTRY FOR OUTPUT
     C**
     C                     ELSE                            - X3
     C**
     C** IF FIRST INSTRUMENT SET UP INSTRUMENT TEXT
     C**
     C           WWFIND    IFEQ 'Y'
     C                     MOVE '1'       *IN55
     C                     MOVE TXT,9     RRTYPE
     C                     ELSE
     C                     MOVE '0'       *IN55
     C                     MOVE *BLANKS   RRTYPE
     C                     END
     C                     MOVE 'N'       WWFIND
     C**
     C** ACCESS SDINDSL1 TO GET LOCAL INDUSTRY NAME:
     C**
     C                     MOVE PWLIND    WWSRC1  3
     C***********WWSRC1    CHAINSDINDSL1             87                   S01486
     C**
     C**  IF RECORD NOT FOUND THEN DATABASE ERROR
     C**
     C************IN87     IFEQ '1'                        - B4           S01486
     C                     CALL 'AOINDSR0'                                S01486
     C                     PARM '*MSG    'WWRTCD  7                       S01486
     C                     PARM '*KEY    'WWOPTN  7                       S01486
     C                     PARM WWSRC1    WWKEY   3                       S01486
     C           SDINDS    PARM SDINDS    DSFDY                           S01486
     C           WWRTCD    IFNE *BLANKS                                   S01486
     C           *LOCK     IN   LDA                                       S01486
     C***********          MOVEL'019'     DBASE            ***************S71062
     C                     Z-ADD19        DBASE                           S71062
     C************         MOVEL'SDINDSL1'DBFILE           * DB ERROR 19 *S01486
     C                     MOVE 'SDINDSPD'DBFILE           * DB ERROR 19 *S01486
     C                     MOVELWWSRC1    DBKEY            ***************
     C                     OUT  LDA                                       S01486
     C                     EXSR *PSSR
     C                     END                             - E4
     C**
     C** SET UP INDUSTRY POLICY CODES DETAILS:
     C**
     C                     EXSR #INSTA
     C**
     C** SET UP INDUSTRY POLICY GROUPS & CODES DETAILS:
     C**
     C                     MOVE *BLANKS   RRGPCO
     C                     MOVE *BLANKS   RRGPNR
     C                     MOVELAOLICD    RRGPCO
     C                     MOVELAOLINA    RRGPNR
     C**
     C                     WRITEINVPOL
     C                     MOVE *BLANKS   RRPOLT
     C                     MOVE *BLANKS   RRPOL1
     C                     END                             - E3
     C**
     C                     END                             - E2
     C**
     C** ACCESS PMBDIPLL AGAIN:
     C**
     C           PNPOLC    READEPMBDIPLL                 25
     C                     END                             - E1
     C**                                                   ***************
     C                     ENDSR                           * #PR11 ENDSR *
     C**                                                   ***************
     C**=================================================================
     C/EJECT
     C**=================================================================
     C**
     C** #PL01       SUBROUTINE TO READ DETAILS FOR FULL LIST
     C**
     C**    CALLED BY PROGRAM
     C**    CALLS     #PR01
     C**
     C**=================================================================
     C**                                                   ***************
     C           #PL01     BEGSR                           * #PL01 BEGSR *
     C**                                                   ***************
     C****ACCESS PMACCUPO:                                                S01486
     C**  ACCESS PMACCUQ0:                                                S01486
     C**
     C************         READ PMACCUPO                 72               S01486
     C                     READ PMACCUQ0                 72               S01486
     C**
     C** IF NO RECORDS READ FROM PMACCUPO WRITE NO DETAILS TO
     C** REPORT FORMAT
     C**
     C************IN72     IFEQ '1'                        - B1           S01486
     C************         MOVELAZPRTL    WWPRTL                          S01486
     C************         MOVE WWPRTL    WWCMD                           S01486
     C************         CALL 'QCMDEXC'                                 S01486
     C************         PARM WWCMD     QCAA   43                       S01486
     C************         PARM 43        QCAN   155                      S01486
     C************                                                        S01486
     C****OPEN*PRINTER FILE:                                              S01486
     C************                                                        S01486
     C************         OPEN PM0290P1                                  S01486
     C************                                                        S01486
     C************         MOVE '1'       *IN40                           S01486
     C************         MOVE '1'       *IN42                           S01486
     C************         MOVELACOF      AZACOC                          S01486
     C***********ACOF      IFEQ '*ALL'                                    S01486
     C************         MOVELTXT,10    AZACON                          S01486
     C************         END                                            S01486
     C************         END                                            S01486
     C************         WRITEHEADRE                                    S01486
     C************         WRITENODET                                     S01486
     C************         END                             - E1           S01486
     C***********          EXSR #OPEN                                     S01486
     C***********RLVL      IFEQ 'D'                                       S01486
     C***********          MOVE AZDPCD    SVDPCD  3                       S01486
     C***********          END                                            S01486
     C***********                                                         S01486
     C***********RLVL      IFEQ 'A'                                       S01486
     C***********          MOVE AZACOC    SVACOC  2                       S01486
     C***********          END                                            S01486
     C           *IN72     IFEQ '0'                                       081342
     C                     EXSR #OPEN                                     081342
     C           RLVL      IFEQ 'D'                                       081342
     C                     MOVE AZDPCD    SVDPCD  3                       081342
     C                     END                                            081342
     C**                                                                  081342
     C           RLVL      IFEQ 'A'                                       081342
     C                     MOVE AZACOC    SVACOC  2                       081342
     C                     END                                            081342
     C                     END                                            081342
     C**
     C**
     C**  SO LONG AS END OF FILE NOT REACHED:
     C**
     C           *IN72     DOWEQ'0'                        - B1
     C           RLVL      IFEQ 'D'                                       S01486
     C           AZDPCD    ANDNESVDPCD                                    S01486
     C                     WRITEENDRE                                     S01486
     C                     CLOSEPM0290P1                                  S01486
     C                     EXSR #OPEN                                     S01486
     C                     MOVE AZDPCD    SVDPCD                          S01486
     C                     END                                            S01486
     C**                                                                  S01486
     C           RLVL      IFEQ 'A'                                       S01486
     C           AZACOC    ANDNESVACOC                                    S01486
     C                     WRITEENDRE                                     S01486
     C                     CLOSEPM0290P1                                  S01486
     C                     EXSR #OPEN                                     S01486
     C                     MOVE AZACOC    SVACOC                          S01486
     C                     END                                            S01486
     C**
     C**  PRINT PORTFOLIO CUSTOMER DETAILS:
     C**
     C                     EXSR #PR01
     C**
     C****ACCESS PMACCUPO AGAIN:                                          S01486
     C**  ACCESS PMACCUQ0 AGAIN:                                          S01486
     C**
     C***********          READ PMACCUPO                 72               S01486
     C                     READ PMACCUQ0                 72               S01486
     C                     END                             - E1
     C*
     C** WRITE END OF REPORT COMMENT
     C           OPEN      IFEQ 'Y'                                       085794
     C                     WRITEENDRE
     C                     END                                            085794
     C**                                                   ***************
     C                     ENDSR                           * #PL01 ENDSR *
     C**                                                   ***************
     C**=================================================================
     C/EJECT
     C**=================================================================
     C**
     C** #PR01       SUBROUTINE TO PRINT PORTFOLIO CUSTOMER DETAILS
     C**
     C**    CALLED BY #PL01
     C**    CALLS     #TYPE, #PREF, #DATF1, #PDET, *PSSR, ZSEDIT, #DATF2,
     C**              #CDET, #POLI, #PODET, #PR02, #PR03
     C**
     C**=================================================================
     C**                                                   ***************
     C           #PR01     BEGSR                           * #PR01 BEGSR *
     C**
     C**  IF RECORD HAS BEEN DELETED OUTPUT 'PORTFOLIO CLOSED' TEXT
     C**
     C           PNRECI    IFNE 'D'
     C                     MOVE '1'       *IN39
     C                     ELSE
     C                     MOVE '0'       *IN39
     C                     END
     C**
     C**  IF THIS IS THE FIRST RECORD PROCESSED:
     C**
     C           *IN88     IFEQ '0'                        - B1
     C**
     C**  OVRPRTF TO PRINTER FILE PM0290PXXX (XXX = PRINTER LOCATION CODE):
     C**
     C***********AZPRTL    IFNE SAVPRT                     - B2           S01486
     C***********          MOVELAZPRTL    WWPRTL                          S01486
     C***********          MOVE WWPRTL    WWCMD                           S01486
     C***********          CALL 'QCMDEXC'                                 S01486
     C***********          PARM WWCMD     QCAA   43                       S01486
     C***********          PARM 43        QCAN   155                      S01486
     C***********                                                         S01486
     C****OPEN*PRINTER FILE:                                              S01486
     C***********                                                         S01486
     C***********          OPEN PM0290P1                                  S01486
     C***********          MOVE AZPRTL    SAVPRT                          S01486
     C***********          END                             - E2           S01486
     C**
     C                     MOVE '1'       *IN88
     C                     END                             - E1
     C************                                                        S01486
     C****ON*EACH*CHANGE OF ACCOUNTER OFFICER PRINTER LOCATION CODE:      S01486
     C************                                                        S01486
     C***********AZPRTL    IFNE SAVPRT                     - B1           S01486
     C***********                                                         S01486
     C****PRINT*REPORT END:                                               S01486
     C***********                                                         S01486
     C***********          WRITEENDRE                                     S01486
     C***********                                                         S01486
     C****CLOSE*THE OLD PRINTER FILE:                                     S01486
     C***********                                                         S01486
     C***********          CLOSEPM0290P1                                  S01486
     C***********                                                         S01486
     C****OVRPRTF TO THE NEW PRINTER FILE PM0290PXXX:                     S01486
     C***********                                                         S01486
     C***********          MOVELAZPRTL    WWPRTL                          S01486
     C***********          MOVE WWPRTL    WWCMD                           S01486
     C***********          CALL 'QCMDEXC'                                 S01486
     C***********          PARM WWCMD     QCAA   43                       S01486
     C***********          PARM 43        QCAN   155                      S01486
     C***********                                                         S01486
     C****OPEN*THE NEW PRINTER FILE:                                      S01486
     C***********                                                         S01486
     C***********          OPEN PM0290P1                                  S01486
     C***********          MOVE AZPRTL    SAVPRT                          S01486
     C***********          END                             - E1           S01486
     C**
     C**  ADD 1 TO NUMBER OF RECORDS READ:
     C**
     C                     ADD  1         WWNORE  50
     C**
     C**  DETERMINE CHANGE TYPE AND COMPUTE RECORDS:
     C**
     C                     EXSR #TYPE
     C**
     C**  SET UP REPORT HEADER:
     C**
     C                     EXSR #PREF
     C**
     C**  PRINT REPORT HEADER:
     C**
     C                     MOVE '1'       *IN42
     C                     WRITEHEADRE
     C                     WRITEDETFP
     C**
     C**  SET UP DATE FORMATS FOR PORTFOLIO DETAILS:
     C**
     C                     EXSR #DATF1
     C**
     C**  SET UP PORTFOLIO DETAILS:
     C**
     C                     EXSR #PDET
     C**
     C**  CONDITIONNING " PLEDGED : 'YES' ":
     C**
     C           PNPDGS    IFLE BJRDNB                     - B1
     C           BJRDNB    ANDLEPNPDGF
     C                     MOVE '1'       *IN43
     C                     END                             - E1
     C**
     C**  PRINT PORTFOLIO DETAILS:
     C**
     C                     WRITEDETAIL
     C**
     C                     MOVE '0'       *IN43
     C**
     C**  PRINT CHARGES HEADER::
     C**
     C                     WRITEHEADCH
     C**
     C****ACCESS*PMCHRGPP:*********************************************   S01486
     C**  Access PMCHRGPD:                                                S01486
     C**
     C                     MOVE '0'       *IN66
     C***********POKEY     SETLLPMCHRGPP                                  S01486
     C***********POKEY     READEPMCHRGPP                 73               S01486
     C           POKEY     SETLLPMCHRGPD                                  S01486
     C           POKEY     READEPMCHRGPD                 73               S01486
     C**
     C**  SO LONG AS PORTFOLIO REFERENCE IS SAME:
     C**
     C           *IN73     DOWEQ'0'                        - B1
     C**
     C**  FOR EACH LIVE RECORD READ:
     C**
     C           PORECI    IFEQ 'D'                        - B2
     C**
     C** DETERMINE WHICH OF CHARGE DETAILS TO BE USED DEPENDING
     C** UPON CHARGE EFFECTIVE INDICATOR
     C**
     C**
     C           POCGEI    IFEQ 'C'
     C                     MOVE POCGCO    WWCGCO  2
     C                     Z-ADDPOCGSP    WWCGSP 130
     C                     MOVE POCGSI    WWCGSI  1
     C                     MOVE 'C'       RRCGEI
     C                     END
     C**
     C           POCGEI    IFEQ 'N'
     C           POCCSP    ANDNE*BLANKS
     C                     MOVE POCCSP    WWCGCO
     C                     Z-ADDPOCSSP    WWCGSP
     C                     MOVE POCISP    WWCGSI
     C                     MOVE 'C'       RRCGEI
     C                     END
     C**
     C           POCGEI    IFEQ 'N'
     C           POCCSP    ANDEQ*BLANKS
     C                     MOVE POCGCO    WWCGCO  2
     C                     Z-ADDPOCGSP    WWCGSP 130
     C                     MOVE POCGSI    WWCGSI  1
     C                     MOVE 'N'       RRCGEI
     C                     END
     C                     MOVE '1'       *IN66
     C**
     C****ACCESS*PMCGCDPP*TO*OBTAIN*CHARGE*BASIS:**********************   S01486
     C**  Access PMCGCDPD to obtain charge basis:                         S01486
     C**
     C           WWCGCO    IFNE *BLANKS                    - B4
     C***********CHKEY     CHAINPMCGCDPP             74                   S01486
     C           CHKEY     CHAINPMCGCDPD             74                   S01486
     C**
     C**  IF RECORD NOT FOUND:
     C**
     C           *IN74     IFEQ '1'                        - B5
     C           P5RECI    OREQ '*'
     C           *LOCK     IN   LDA                                       S01486
     C***********          MOVEL'020'     DBASE            ***************S71062
     C                     Z-ADD20        DBASE                           S71062
     C***********          MOVEL'PMCGCDPP'DBFILE           * DB ERROR 20 *S01486
     C                     MOVE 'PMCGCDPD'DBFILE           * DB ERROR 20 *S01486
     C                     MOVELWWCGCO    DBKEY            ***************
     C                     OUT  LDA                                       S01486
     C                     EXSR *PSSR
     C                     END                             - E5
     C**
     C**  DETERMINE 'ADJUSTMENT' ACCORDING TO WHETHER
     C**  CHARGE BASIS VALUE IS 'P' OR 'F':
     C**
     C           P5CGBS    IFEQ 'P'                        - B5
     C**
     C                     Z-ADDWWCGSP    ZFLD15 150
     C                     Z-ADD7         ZDECS   10
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    RRCGSP
     C                     MOVE '%'       RRCGSP
     C**
     C                     ELSE                            - X5
     C**
     C                     Z-ADDWWCGSP    ZFLD15 150
     C                     Z-ADDPNBCGD    ZDECS   10
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    RRCGSP
     C                     END                             - E5
     C*
     C** IF SPREAD IS ZERO SET ADJUSTMENT DETAILS TO BLANK
     C           WWCGSP    IFEQ 0                          - B5
     C                     MOVE *BLANKS   RRCGSP
     C                     END                             - E5
     C*
     C                     ELSE                            - X4
     C                     MOVE *BLANKS   RRCGCO
     C                     MOVE *BLANKS   RRCGSP
     C                     MOVE *BLANKS   RRCGAS
     C                     END                             - E4
     C**
     C**  SET UP DATE FORMATS FOR CHARGES DETAILS:
     C**
     C                     EXSR #DATF2
     C**
     C**  SET UP CHARGES DETAILS:
     C**
     C                     EXSR #CDET
     C**
     C**  PRINT CHARGES DETAILS:
     C**
     C           POCHTP    IFEQ 'I'                        - B4
     C                     MOVE '1'       *IN56
     C                     ELSE                            - X4
     C           POCHTP    IFEQ 'A'                        - B5
     C                     MOVE '1'       *IN57
     C                     END                             - E5
     C**
     C                     END                             - E4
     C**
     C                     WRITECHARGE
     C                     MOVE '0'       *IN56
     C                     MOVE '0'       *IN57
     C**
     C                     END                             - E3
     C**
     C****ACCESS*PMCHRGPP*AGAIN:***************************************   S01486
     C**  Access PMCHRGPD again:                                          S01486
     C**
     C***********POKEY     READEPMCHRGPP                 73               S01486
     C           POKEY     READEPMCHRGPD                 73               S01486
     C                     END                             - E2
     C**
     C** IF NO CHARGE DETAILS HAVE BEEN OUTPUT WRITE NO CHARGE TEXT
     C**
     C           *IN66     IFEQ '0'
     C                     WRITENOCHR
     C                     END
     C**
     C**  WHEN BANK INVESTMENT POLICY CODE NOT BLANK:
     C**
     C                     MOVE '0'       *IN44
     C                     MOVE '0'       *IN67
     C                     MOVE 'N'       WWPOLC  1
     C           PNPOLC    IFNE '  '                       - B2
     C                     MOVE '1'       *IN44
     C                     MOVE 'Y'       WWPOLC
     C**
     C****ACCESS*PMBIPNPP*TO*OBTAIN*BANK*INVESTMENT*POLICY*NARRATIVE:**   S01486
     C**  Access PMBIPNPD to obtain bank investment policy narrative:     S01486
     C**
     C***********PNPOLC    CHAINPMBIPNPP             75                   S01486
     C           PNPOLC    CHAINPMBIPNPD             75                   S01486
     C**
     C**  IF RECORD NOT FOUND THEN DATABASE ERROR
     C**
     C           *IN75     IFEQ '1'                        - B3
     C           PSRECI    OREQ '*'
     C           *LOCK     IN   LDA                                       S01486
     C***********          MOVEL'21'      DBASE            ***************S71062
     C                     Z-ADD21        DBASE                           S71062
     C***********          MOVEL'PMBIPNPP'DBFILE           * DB ERROR 21 *S01486
     C                     MOVE 'PMBIPNPD'DBFILE           * DB ERROR 21 *S01486
     C                     MOVELPNPOLC    DBKEY            ***************
     C                     OUT  LDA                                       S01486
     C                     EXSR *PSSR
     C                     END                             - E3
     C**
     C**  SET UP BANK INVESTMENT POLICY:
     C**
     C                     EXSR #POLI
     C                     END                             - E2
     C**
     C**  SET UP INSTRUMENT, CURRENCY, COUNTRY & INDUSTRY POLICIES DETAILS:
     C**
     C                     EXSR #PODET
     C**
     C**  PRINT THESE FURTHER INFORMATIONS:
     C**
     C                     WRITEINFO
     C**
     C** IF NEITHER BANK NOR PORTFOLIO INVESTMENT POLICY DEFINED OUTPUT
     C** 'NO INVESTMENT POLICY DEFINED' COMMENT
     C**
     C           WWPOLC    IFEQ 'N'
     C                     WRITENOPOL
     C                     END
     C**
     C                     MOVE '0'       *IN44
     C**
     C**  IF 'DETAILS TO BE REPORTED' PARAMETER PASSED TO THE PROGRAM
     C**     IS 'F':
     C**
     C           IND       IFEQ 'F'                        - B2
     C**
     C**  WHEN ANY OF THE POLICY CUSTOMER INDICATORS SET TO 'Y'
     C**  OR   THE BANK INVESTMENT POLICY CODE NOT BLANK:
     C**
     C           PNIPIN    IFEQ 'Y'                        - B3
     C           PNCYIN    OREQ 'Y'
     C           PNYPIN    OREQ 'Y'
     C           PNNPIN    OREQ 'Y'
     C           PNPOLC    ORNE '  '
     C**
     C**  EXECUTE PAGE OVERFLOW:
     C**
     C                     MOVE '1'       *IN70
     C**
     C**  PRINT REPORT HEADER:
     C**
     C                     WRITEHEADRE
     C                     MOVE '0'       *IN70
     C                     END                             - E3
     C**
     C**  IF ANY OF THE POLICY CUSTOMER INDICATORS IS 'Y':
     C**
     C           PNIPIN    IFEQ 'Y'                        - B3
     C           PNCYIN    OREQ 'Y'
     C           PNYPIN    OREQ 'Y'
     C           PNNPIN    OREQ 'Y'
     C**
     C**  PROCESS PORTFOLIO CUSTOMER INVESTMENT POLICY DETAILS:
     C**
     C                     EXSR #PR02
     C                     END                             - E3
     C**
     C**  IF THE BANK INVESTMENT POLICY CODE IS NOT BLANK:
     C**
     C           PNPOLC    IFNE '  '                       - B3
     C**
     C**  PROCESS BANK INVESTMENT POLICY DETAILS:
     C**
     C                     EXSR #PR03
     C                     END                             - E3
     C**
     C                     END                             - E2
     C/COPY WNCPYSRC,PM0290C003
     C**                                                   ***************
     C                     ENDSR                           * #PR01 ENDSR *
     C**                                                   ***************
     C**=================================================================
     C/EJECT
     C**=================================================================
     C**
     C** #AU01       SUBROUTINE TO CHAIN ON TRAILER FILE.
     C**
     C**    CALLED BY PROGRAM
     C**    CALLS     #REPOR, *PSSR
     C**
     C**=================================================================
     C**                                                   ***************
     C           #AU01     BEGSR                           * #AU01 BEGSR *
     C**                                                   ***************
     C****ACCESS*PMPORTZZ:                                                S01486
     C**  ACCESS PMPORTPA:                                                S01486
     C**
     C***********          READ PMPORTZZ                 21               S01486
     C                     READ PMPORTPA                 21               S01486
     C**
     C**  IF AUDIT RECORD NOT FOUND THEN DATABASE ERROR
     C**
     C           *IN21     IFEQ '1'                        - B1
     C           *LOCK     IN   LDA                                       S01486
     C***********          MOVEL'22'      DBASE            ***************S71062
     C                     Z-ADD22        DBASE                           S71062
     C***********          MOVEL'PMPORTZZ'DBFILE           * DB ERROR 22 *S01486
     C                     MOVE 'PMPORTPA'DBFILE           * DB ERROR 22 *S01486
     C                     MOVEL'AUDIT'   DBKEY            ***************
     C                     OUT  LDA                                       S01486
     C                     EXSR *PSSR
     C                     END                             - E1
     C**
     C**  IF ALL DETAILS ON FILE REPORTED CHECK THAT COUNT OF NUMBER
     C**  OF RECORDS FROM PMPORTZZ EQUAL TO RECORDS READ INTO PROGRAM
     C**
     C                     MOVE '0'       *IN68
     C***********ACOF      IFEQ '*ALL'                     - B1           S01486
     C***********MODE      ANDEQ'2'                                       S01486
     C           MODE      IFEQ '2'                                       S01486
     C                     MOVE '1'       *IN68
     C**
     C           PNNORE    IFNE WWNORE                     - B2
     C                     MOVE '1'       *IN54
     C                     MOVE '1'       *INU8
     C                     END                             - E2
     C                     END                             - E1
     C**
     C**  PRINT AUDIT REPORT:
     C**
     C                     EXSR #REPOR
     C**                                                   ***************
     C                     ENDSR                           * #AU01 ENDSR *
     C**                                                   ***************
     C**=================================================================
     C/EJECT
     C**=================================================================
     C**
     C** #REPOR      SUBROUTINE TO PRINT AUDIT REPORT.
     C**
     C**    CALLED BY #AU01
     C**    CALLS     -
     C**
     C**=================================================================
     C**                                                   ***************
     C           #REPOR    BEGSR                           * #REPOR BEGS *
     C**                                                   ***************S01486
     C**  WHEN MODE IS '1':
     C**
     C           MODE      IFEQ '1'                        - B1
     C                     Z-ADDWWNOIN    RRNOIN
     C                     Z-ADDWWNOAM    RRNOAM
     C                     Z-ADDWWNODE    RRNODE
     C                     Z-ADDPNNORE    R1NORE
     C**
     C**  PRINT AUDIT REPORT:
     C**
     C                     MOVE '1'       *IN41
     C                     WRITEHEADAU
     C                     WRITECONTROL1
     C***********          WRITEENDAU                                     S01486
     C**
     C**  WHEN MODE IS '2':
     C**
     C                     ELSE                            - X1
     C**
     C                     Z-ADDPNNORE    R1NORE
     C                     Z-ADDWWNORE    R2NORE
     C**
     C**  PRINT AUDIT REPORT:
     C**
     C                     MOVE '1'       *IN42
     C                     WRITEHEADAU
     C                     WRITECONTROL2
     C***********          WRITEENDAU                                     S01486
     C                     END                             - E1
     C**                                                   ***************
     C                     ENDSR                           * #REPOR ENDS *
     C**                                                   ***************
     C**=================================================================
     C/EJECT
     C**=================================================================
     C**
     C**  ZDATE2     SUBROUTINE TO CONVERT A DAY NUMBER TO DATE FORMATS.
     C**
     C**    CALLED BY #DATF1, #DATF2
     C**    CALLS     -
     C**
     C**=================================================================
      /COPY ZSRSRC,ZDATE2Z2
     C/EJECT
     C**=================================================================
     C**
     C**  ZSEDIT       SUBROUTINE TO INSERT A DECIMAL POINT AND A SIGN
     C**               INTO A NUMERIC FIELD AND TO BLANK OUT LEADING
     C**               ZEROES (OPTIONALY INSERTING COMMAS).
     C**
     C**    CALLED BY #PA01, #PR01
     C**    CALLS     -
     C**
     C**=================================================================
      /COPY ZSRSRC,ZSEDITZ3
     C/EJECT
     C**=================================================================
     C**
     C**  *PSSR       SUBROUTINE TO OUTPUT DATABASE ERROR.
     C**
     C**     CALLED BY PROGRAM, #INIT, #PA01, #PR04, #PR05, #PR06, #PR07,
     C**               #PR08, #PR09, #PR10, #PR11, #PR01, #AU01
     C**     CALLS     -
     C**
     C**=================================================================
     C**                                                   ***************
     C           *PSSR     BEGSR                           * *PSSR BEGSR *
     C**                                                   ***************
     C           WWERRO    IFEQ ' '                        - B1
     C                     MOVE 'Y'       WWERRO  1
     C**
     C***********DBASE     IFGT '000'                      - B2           S71062
     C           DBASE     IFGT 0                          - B2           S71062
     C**
     C**  PRINT ERROR MESSAGE:
     C**
     C                     MOVE '1'       *IN41
     C                     WRITEHEADAU
     C                     WRITEERRORAU
     C***********          WRITEENDAU                                     S01486
     C                     ELSE                            - X2
     C**
     C***********          MOVE '999'     DBASE                           S71062
     C                     Z-ADD999       DBASE                           S71062
     C                     END                             - E2
     C**
     C                     DUMP
     C                     END                             - E1
     C**
     C                     MOVE '1'       *INU7
     C                     MOVE '1'       *INU8
     C                     MOVE '1'       *INLR
     C**
     C                     RETRN
     C**                                                   ***************
     C                     ENDSR                           * *PSSR ENDSR *
     C**                                                   ***************
     C**=================================================================
     C/EJECT
**  CPY@
(c) Misys International Banking Systems Ltd. 2001
**  ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**  ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**  ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
**  TXT  - TEXT ARRAY
INSTRUMENT POLICY:CURRENCY POLICY:  COUNTRY POLICY:   INDUSTRY POLICY:
           GROUPS:      INSTRUMENTS:       CURRENCIES:        COUNTRIES:
       INDUSTRIES:ALL A/C OFFICERS
